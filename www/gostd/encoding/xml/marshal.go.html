<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6034943">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6034998">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6035052">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6035103">package</span>&nbsp;<span class="ident" id="6035111">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6035116">import</span>&nbsp;<span class="op" id="6035123">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035126">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035135">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035144">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035156">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035163">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035169">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035180">&#34;strconv&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6035191">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="6035201">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6035204">const</span>&nbsp;<span class="op" id="6035210">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6035213">//&nbsp;A&nbsp;generic&nbsp;XML&nbsp;header&nbsp;suitable&nbsp;for&nbsp;use&nbsp;with&nbsp;the&nbsp;output&nbsp;of&nbsp;Marshal.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6035283">//&nbsp;This&nbsp;is&nbsp;not&nbsp;automatically&nbsp;added&nbsp;to&nbsp;any&nbsp;output&nbsp;of&nbsp;this&nbsp;package,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6035350">//&nbsp;it&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;convenience.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6035387">Header</span>&nbsp;<span class="op" id="6035394">=</span>&nbsp;<span class="string" id="6035396">`&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;`</span>&nbsp;<span class="op" id="6035437">+</span>&nbsp;<span class="string" id="6035439">&#34;\n&#34;</span><br>
<span class="lineno"></span><span class="op" id="6035444">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="6035447">//&nbsp;Marshal&nbsp;returns&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v.</span><br>
<span class="lineno"></span><span class="comment" id="6035489">//</span><br>
<span class="lineno"></span><span class="comment" id="6035492">//&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;array&nbsp;or&nbsp;slice&nbsp;by&nbsp;marshalling&nbsp;each&nbsp;of&nbsp;the&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6035566">//&nbsp;Marshal&nbsp;handles&nbsp;a&nbsp;pointer&nbsp;by&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;points&nbsp;at&nbsp;or,&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6035644">//&nbsp;pointer&nbsp;is&nbsp;nil,&nbsp;by&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;an&nbsp;interface&nbsp;value&nbsp;by</span><br>
<span class="lineno">30</span><span class="comment" id="6035722">//&nbsp;marshalling&nbsp;the&nbsp;value&nbsp;it&nbsp;contains&nbsp;or,&nbsp;if&nbsp;the&nbsp;interface&nbsp;value&nbsp;is&nbsp;nil,&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="6035797">//&nbsp;writing&nbsp;nothing.&nbsp;&nbsp;Marshal&nbsp;handles&nbsp;all&nbsp;other&nbsp;data&nbsp;by&nbsp;writing&nbsp;one&nbsp;or&nbsp;more&nbsp;XML</span><br>
<span class="lineno"></span><span class="comment" id="6035876">//&nbsp;elements&nbsp;containing&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6035909">//</span><br>
<span class="lineno"></span><span class="comment" id="6035912">//&nbsp;The&nbsp;name&nbsp;for&nbsp;the&nbsp;XML&nbsp;elements&nbsp;is&nbsp;taken&nbsp;from,&nbsp;in&nbsp;order&nbsp;of&nbsp;preference:</span><br>
<span class="lineno">35</span><span class="comment" id="6035984">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;on&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;if&nbsp;the&nbsp;data&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="6036047">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;XMLName&nbsp;field&nbsp;of&nbsp;type&nbsp;xml.Name</span><br>
<span class="lineno"></span><span class="comment" id="6036104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;tag&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6036165">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;struct&nbsp;field&nbsp;used&nbsp;to&nbsp;obtain&nbsp;the&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6036227">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;marshalled&nbsp;type</span><br>
<span class="lineno">40</span><span class="comment" id="6036268">//</span><br>
<span class="lineno"></span><span class="comment" id="6036271">//&nbsp;The&nbsp;XML&nbsp;element&nbsp;for&nbsp;a&nbsp;struct&nbsp;contains&nbsp;marshalled&nbsp;elements&nbsp;for&nbsp;each&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6036348">//&nbsp;exported&nbsp;fields&nbsp;of&nbsp;the&nbsp;struct,&nbsp;with&nbsp;these&nbsp;exceptions:</span><br>
<span class="lineno"></span><span class="comment" id="6036405">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;XMLName&nbsp;field,&nbsp;described&nbsp;above,&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="comment" id="6036462">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;-&#34;&nbsp;is&nbsp;omitted.</span><br>
<span class="lineno">45</span><span class="comment" id="6036504">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;name,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6036568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;given&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6036612">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,attr&#34;&nbsp;becomes&nbsp;an&nbsp;attribute&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6036676">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;field&nbsp;name&nbsp;in&nbsp;the&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6036716">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,chardata&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;character&nbsp;data,</span><br>
<span class="lineno">50</span><span class="comment" id="6036784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;as&nbsp;an&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6036816">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,innerxml&#34;&nbsp;is&nbsp;written&nbsp;verbatim,&nbsp;not&nbsp;subject</span><br>
<span class="lineno"></span><span class="comment" id="6036887">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.</span><br>
<span class="lineno"></span><span class="comment" id="6036932">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;tag&nbsp;&#34;,comment&#34;&nbsp;is&nbsp;written&nbsp;as&nbsp;an&nbsp;XML&nbsp;comment,&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6037003">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subject&nbsp;to&nbsp;the&nbsp;usual&nbsp;marshalling&nbsp;procedure.&nbsp;It&nbsp;must&nbsp;not&nbsp;contain</span><br>
<span class="lineno">55</span><span class="comment" id="6037076">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;&#34;--&#34;&nbsp;string&nbsp;within&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6037112">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;including&nbsp;the&nbsp;&#34;omitempty&#34;&nbsp;option&nbsp;is&nbsp;omitted</span><br>
<span class="lineno"></span><span class="comment" id="6037184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;the&nbsp;field&nbsp;value&nbsp;is&nbsp;empty.&nbsp;The&nbsp;empty&nbsp;values&nbsp;are&nbsp;false,&nbsp;0,&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="6037257">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nil&nbsp;pointer&nbsp;or&nbsp;interface&nbsp;value,&nbsp;and&nbsp;any&nbsp;array,&nbsp;slice,&nbsp;map,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6037328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string&nbsp;of&nbsp;length&nbsp;zero.</span><br>
<span class="lineno">60</span><span class="comment" id="6037360">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;an&nbsp;anonymous&nbsp;struct&nbsp;field&nbsp;is&nbsp;handled&nbsp;as&nbsp;if&nbsp;the&nbsp;fields&nbsp;of&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6037430">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;were&nbsp;part&nbsp;of&nbsp;the&nbsp;outer&nbsp;struct.</span><br>
<span class="lineno"></span><span class="comment" id="6037476">//</span><br>
<span class="lineno"></span><span class="comment" id="6037479">//&nbsp;If&nbsp;a&nbsp;field&nbsp;uses&nbsp;a&nbsp;tag&nbsp;&#34;a&gt;b&gt;c&#34;,&nbsp;then&nbsp;the&nbsp;element&nbsp;c&nbsp;will&nbsp;be&nbsp;nested&nbsp;inside</span><br>
<span class="lineno"></span><span class="comment" id="6037554">//&nbsp;parent&nbsp;elements&nbsp;a&nbsp;and&nbsp;b.&nbsp;&nbsp;Fields&nbsp;that&nbsp;appear&nbsp;next&nbsp;to&nbsp;each&nbsp;other&nbsp;that&nbsp;name</span><br>
<span class="lineno">65</span><span class="comment" id="6037631">//&nbsp;the&nbsp;same&nbsp;parent&nbsp;will&nbsp;be&nbsp;enclosed&nbsp;in&nbsp;one&nbsp;XML&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="6037687">//</span><br>
<span class="lineno"></span><span class="comment" id="6037690">//&nbsp;See&nbsp;MarshalIndent&nbsp;for&nbsp;an&nbsp;example.</span><br>
<span class="lineno"></span><span class="comment" id="6037727">//</span><br>
<span class="lineno"></span><span class="comment" id="6037730">//&nbsp;Marshal&nbsp;will&nbsp;return&nbsp;an&nbsp;error&nbsp;if&nbsp;asked&nbsp;to&nbsp;marshal&nbsp;a&nbsp;channel,&nbsp;function,&nbsp;or&nbsp;map.</span><br>
<span class="lineno">70</span><span class="keyword" id="6037811">func</span>&nbsp;<span class="ident" id="6037816">Marshal</span><span class="op" id="6037823">(</span><span class="ident" id="6037824">v</span>&nbsp;<span class="keyword" id="6037826">interface</span><span class="op" id="6037835">{</span><span class="op" id="6037836">}</span><span class="op" id="6037837">)</span>&nbsp;<span class="op" id="6037839">(</span><span class="op" id="6037840">[</span><span class="op" id="6037841">]</span><span class="builtintype" id="6037842">byte</span><span class="op" id="6037846">,</span>&nbsp;<span class="builtintype" id="6037848">error</span><span class="op" id="6037853">)</span>&nbsp;<span class="op" id="6037855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6037858">var</span>&nbsp;<span class="ident" id="6037862">b</span>&nbsp;<span class="ident" id="6037864">bytes</span><span class="op" id="6037869">.</span><span class="ident" id="6037870">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6037878">if</span>&nbsp;<span class="ident" id="6037881">err</span>&nbsp;<span class="op" id="6037885">:=</span>&nbsp;<span class="ident" id="6037888">NewEncoder</span><span class="op" id="6037898">(</span><span class="op" id="6037899">&amp;</span><span class="ident" id="6037900">b</span><span class="op" id="6037901">)</span><span class="op" id="6037902">.</span><span class="ident" id="6037903">Encode</span><span class="op" id="6037909">(</span><span class="ident" id="6037910">v</span><span class="op" id="6037911">)</span><span class="op" id="6037912">;</span>&nbsp;<span class="ident" id="6037914">err</span>&nbsp;<span class="op" id="6037918">!=</span>&nbsp;<span class="ident" id="6037921">nil</span>&nbsp;<span class="op" id="6037925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6037929">return</span>&nbsp;<span class="ident" id="6037936">nil</span><span class="op" id="6037939">,</span>&nbsp;<span class="ident" id="6037941">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6037946">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6037949">return</span>&nbsp;<span class="ident" id="6037956">b</span><span class="op" id="6037957">.</span><span class="ident" id="6037958">Bytes</span><span class="op" id="6037963">(</span><span class="op" id="6037964">)</span><span class="op" id="6037965">,</span>&nbsp;<span class="ident" id="6037967">nil</span><br>
<span class="lineno"></span><span class="op" id="6037971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6037974">//&nbsp;Marshaler&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6038044">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno">80</span><span class="comment" id="6038083">//</span><br>
<span class="lineno"></span><span class="comment" id="6038086">//&nbsp;MarshalXML&nbsp;encodes&nbsp;the&nbsp;receiver&nbsp;as&nbsp;zero&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="6038151">//&nbsp;By&nbsp;convention,&nbsp;arrays&nbsp;or&nbsp;slices&nbsp;are&nbsp;typically&nbsp;encoded&nbsp;as&nbsp;a&nbsp;sequence</span><br>
<span class="lineno"></span><span class="comment" id="6038222">//&nbsp;of&nbsp;elements,&nbsp;one&nbsp;per&nbsp;entry.</span><br>
<span class="lineno"></span><span class="comment" id="6038253">//&nbsp;Using&nbsp;start&nbsp;as&nbsp;the&nbsp;element&nbsp;tag&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno">85</span><span class="comment" id="6038317">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;XML&nbsp;elements&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6038383">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="6038400">//&nbsp;One&nbsp;common&nbsp;implementation&nbsp;strategy&nbsp;is&nbsp;to&nbsp;construct&nbsp;a&nbsp;separate</span><br>
<span class="lineno"></span><span class="comment" id="6038465">//&nbsp;value&nbsp;with&nbsp;a&nbsp;layout&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;desired&nbsp;XML&nbsp;and&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6038530">//&nbsp;to&nbsp;encode&nbsp;it&nbsp;using&nbsp;e.EncodeElement.</span><br>
<span class="lineno">90</span><span class="comment" id="6038569">//&nbsp;Another&nbsp;common&nbsp;strategy&nbsp;is&nbsp;to&nbsp;use&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;e.EncodeToken</span><br>
<span class="lineno"></span><span class="comment" id="6038638">//&nbsp;to&nbsp;generate&nbsp;the&nbsp;XML&nbsp;output&nbsp;one&nbsp;token&nbsp;at&nbsp;a&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="6038689">//&nbsp;The&nbsp;sequence&nbsp;of&nbsp;encoded&nbsp;tokens&nbsp;must&nbsp;make&nbsp;up&nbsp;zero&nbsp;or&nbsp;more&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="6038755">//&nbsp;XML&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="6038772">type</span>&nbsp;<span class="ident" id="6038777">Marshaler</span>&nbsp;<span class="keyword" id="6038787">interface</span>&nbsp;<span class="op" id="6038797">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6038800">MarshalXML</span><span class="op" id="6038810">(</span><span class="ident" id="6038811">e</span>&nbsp;<span class="op" id="6038813">*</span><span class="ident" id="6038814">Encoder</span><span class="op" id="6038821">,</span>&nbsp;<span class="ident" id="6038823">start</span>&nbsp;<span class="ident" id="6038829">StartElement</span><span class="op" id="6038841">)</span>&nbsp;<span class="builtintype" id="6038843">error</span><br>
<span class="lineno"></span><span class="op" id="6038849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6038852">//&nbsp;MarshalerAttr&nbsp;is&nbsp;the&nbsp;interface&nbsp;implemented&nbsp;by&nbsp;objects&nbsp;that&nbsp;can&nbsp;marshal</span><br>
<span class="lineno"></span><span class="comment" id="6038926">//&nbsp;themselves&nbsp;into&nbsp;valid&nbsp;XML&nbsp;attributes.</span><br>
<span class="lineno">100</span><span class="comment" id="6038967">//</span><br>
<span class="lineno"></span><span class="comment" id="6038970">//&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;an&nbsp;XML&nbsp;attribute&nbsp;with&nbsp;the&nbsp;encoded&nbsp;value&nbsp;of&nbsp;the&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="comment" id="6039053">//&nbsp;Using&nbsp;name&nbsp;as&nbsp;the&nbsp;attribute&nbsp;name&nbsp;is&nbsp;not&nbsp;required,&nbsp;but&nbsp;doing&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="6039119">//&nbsp;will&nbsp;enable&nbsp;Unmarshal&nbsp;to&nbsp;match&nbsp;the&nbsp;attribute&nbsp;to&nbsp;the&nbsp;correct</span><br>
<span class="lineno"></span><span class="comment" id="6039182">//&nbsp;struct&nbsp;field.</span><br>
<span class="lineno">105</span><span class="comment" id="6039199">//&nbsp;If&nbsp;MarshalXMLAttr&nbsp;returns&nbsp;the&nbsp;zero&nbsp;attribute&nbsp;Attr{},&nbsp;no&nbsp;attribute</span><br>
<span class="lineno"></span><span class="comment" id="6039268">//&nbsp;will&nbsp;be&nbsp;generated&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="6039304">//&nbsp;MarshalXMLAttr&nbsp;is&nbsp;used&nbsp;only&nbsp;for&nbsp;struct&nbsp;fields&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6039362">//&nbsp;&#34;attr&#34;&nbsp;option&nbsp;in&nbsp;the&nbsp;field&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="6039397">type</span>&nbsp;<span class="ident" id="6039402">MarshalerAttr</span>&nbsp;<span class="keyword" id="6039416">interface</span>&nbsp;<span class="op" id="6039426">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6039429">MarshalXMLAttr</span><span class="op" id="6039443">(</span><span class="ident" id="6039444">name</span>&nbsp;<span class="ident" id="6039449">Name</span><span class="op" id="6039453">)</span>&nbsp;<span class="op" id="6039455">(</span><span class="ident" id="6039456">Attr</span><span class="op" id="6039460">,</span>&nbsp;<span class="builtintype" id="6039462">error</span><span class="op" id="6039467">)</span><br>
<span class="lineno"></span><span class="op" id="6039469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6039472">//&nbsp;MarshalIndent&nbsp;works&nbsp;like&nbsp;Marshal,&nbsp;but&nbsp;each&nbsp;XML&nbsp;element&nbsp;begins&nbsp;on&nbsp;a&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="6039546">//&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;one&nbsp;or&nbsp;more</span><br>
<span class="lineno">115</span><span class="comment" id="6039618">//&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6039670">func</span>&nbsp;<span class="ident" id="6039675">MarshalIndent</span><span class="op" id="6039688">(</span><span class="ident" id="6039689">v</span>&nbsp;<span class="keyword" id="6039691">interface</span><span class="op" id="6039700">{</span><span class="op" id="6039701">}</span><span class="op" id="6039702">,</span>&nbsp;<span class="ident" id="6039704">prefix</span><span class="op" id="6039710">,</span>&nbsp;<span class="ident" id="6039712">indent</span>&nbsp;<span class="builtintype" id="6039719">string</span><span class="op" id="6039725">)</span>&nbsp;<span class="op" id="6039727">(</span><span class="op" id="6039728">[</span><span class="op" id="6039729">]</span><span class="builtintype" id="6039730">byte</span><span class="op" id="6039734">,</span>&nbsp;<span class="builtintype" id="6039736">error</span><span class="op" id="6039741">)</span>&nbsp;<span class="op" id="6039743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6039746">var</span>&nbsp;<span class="ident" id="6039750">b</span>&nbsp;<span class="ident" id="6039752">bytes</span><span class="op" id="6039757">.</span><span class="ident" id="6039758">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6039766">enc</span>&nbsp;<span class="op" id="6039770">:=</span>&nbsp;<span class="ident" id="6039773">NewEncoder</span><span class="op" id="6039783">(</span><span class="op" id="6039784">&amp;</span><span class="ident" id="6039785">b</span><span class="op" id="6039786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6039789">enc</span><span class="op" id="6039792">.</span><span class="ident" id="6039793">Indent</span><span class="op" id="6039799">(</span><span class="ident" id="6039800">prefix</span><span class="op" id="6039806">,</span>&nbsp;<span class="ident" id="6039808">indent</span><span class="op" id="6039814">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6039817">if</span>&nbsp;<span class="ident" id="6039820">err</span>&nbsp;<span class="op" id="6039824">:=</span>&nbsp;<span class="ident" id="6039827">enc</span><span class="op" id="6039830">.</span><span class="ident" id="6039831">Encode</span><span class="op" id="6039837">(</span><span class="ident" id="6039838">v</span><span class="op" id="6039839">)</span><span class="op" id="6039840">;</span>&nbsp;<span class="ident" id="6039842">err</span>&nbsp;<span class="op" id="6039846">!=</span>&nbsp;<span class="ident" id="6039849">nil</span>&nbsp;<span class="op" id="6039853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6039857">return</span>&nbsp;<span class="ident" id="6039864">nil</span><span class="op" id="6039867">,</span>&nbsp;<span class="ident" id="6039869">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6039874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6039877">return</span>&nbsp;<span class="ident" id="6039884">b</span><span class="op" id="6039885">.</span><span class="ident" id="6039886">Bytes</span><span class="op" id="6039891">(</span><span class="op" id="6039892">)</span><span class="op" id="6039893">,</span>&nbsp;<span class="ident" id="6039895">nil</span><br>
<span class="lineno"></span><span class="op" id="6039899">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="6039902">//&nbsp;An&nbsp;Encoder&nbsp;writes&nbsp;XML&nbsp;data&nbsp;to&nbsp;an&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6039953">type</span>&nbsp;<span class="ident" id="6039958">Encoder</span>&nbsp;<span class="keyword" id="6039966">struct</span>&nbsp;<span class="op" id="6039973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6039976">p</span>&nbsp;<span class="ident" id="6039978">printer</span><br>
<span class="lineno"></span><span class="op" id="6039986">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="6039989">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;encoder&nbsp;that&nbsp;writes&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6040043">func</span>&nbsp;<span class="ident" id="6040048">NewEncoder</span><span class="op" id="6040058">(</span><span class="ident" id="6040059">w</span>&nbsp;<span class="ident" id="6040061">io</span><span class="op" id="6040063">.</span><span class="ident" id="6040064">Writer</span><span class="op" id="6040070">)</span>&nbsp;<span class="op" id="6040072">*</span><span class="ident" id="6040073">Encoder</span>&nbsp;<span class="op" id="6040081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6040084">e</span>&nbsp;<span class="op" id="6040086">:=</span>&nbsp;<span class="op" id="6040089">&amp;</span><span class="ident" id="6040090">Encoder</span><span class="op" id="6040097">{</span><span class="ident" id="6040098">printer</span><span class="op" id="6040105">{</span><span class="ident" id="6040106">Writer</span><span class="op" id="6040112">:</span>&nbsp;<span class="ident" id="6040114">bufio</span><span class="op" id="6040119">.</span><span class="ident" id="6040120">NewWriter</span><span class="op" id="6040129">(</span><span class="ident" id="6040130">w</span><span class="op" id="6040131">)</span><span class="op" id="6040132">}</span><span class="op" id="6040133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6040136">e</span><span class="op" id="6040137">.</span><span class="ident" id="6040138">p</span><span class="op" id="6040139">.</span><span class="ident" id="6040140">encoder</span>&nbsp;<span class="op" id="6040148">=</span>&nbsp;<span class="ident" id="6040150">e</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6040153">return</span>&nbsp;<span class="ident" id="6040160">e</span><br>
<span class="lineno"></span><span class="op" id="6040162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6040165">//&nbsp;Indent&nbsp;sets&nbsp;the&nbsp;encoder&nbsp;to&nbsp;generate&nbsp;XML&nbsp;in&nbsp;which&nbsp;each&nbsp;element</span><br>
<span class="lineno"></span><span class="comment" id="6040230">//&nbsp;begins&nbsp;on&nbsp;a&nbsp;new&nbsp;indented&nbsp;line&nbsp;that&nbsp;starts&nbsp;with&nbsp;prefix&nbsp;and&nbsp;is&nbsp;followed&nbsp;by</span><br>
<span class="lineno">140</span><span class="comment" id="6040306">//&nbsp;one&nbsp;or&nbsp;more&nbsp;copies&nbsp;of&nbsp;indent&nbsp;according&nbsp;to&nbsp;the&nbsp;nesting&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="6040370">func</span>&nbsp;<span class="op" id="6040375">(</span><span class="ident" id="6040376">enc</span>&nbsp;<span class="op" id="6040380">*</span><span class="ident" id="6040381">Encoder</span><span class="op" id="6040388">)</span>&nbsp;<span class="ident" id="6040390">Indent</span><span class="op" id="6040396">(</span><span class="ident" id="6040397">prefix</span><span class="op" id="6040403">,</span>&nbsp;<span class="ident" id="6040405">indent</span>&nbsp;<span class="builtintype" id="6040412">string</span><span class="op" id="6040418">)</span>&nbsp;<span class="op" id="6040420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6040423">enc</span><span class="op" id="6040426">.</span><span class="ident" id="6040427">p</span><span class="op" id="6040428">.</span><span class="ident" id="6040429">prefix</span>&nbsp;<span class="op" id="6040436">=</span>&nbsp;<span class="ident" id="6040438">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6040446">enc</span><span class="op" id="6040449">.</span><span class="ident" id="6040450">p</span><span class="op" id="6040451">.</span><span class="ident" id="6040452">indent</span>&nbsp;<span class="op" id="6040459">=</span>&nbsp;<span class="ident" id="6040461">indent</span><br>
<span class="lineno"></span><span class="op" id="6040468">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="6040471">//&nbsp;Encode&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6040525">//</span><br>
<span class="lineno"></span><span class="comment" id="6040528">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6040598">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">150</span><span class="comment" id="6040622">//</span><br>
<span class="lineno"></span><span class="comment" id="6040625">//&nbsp;Encode&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6040665">func</span>&nbsp;<span class="op" id="6040670">(</span><span class="ident" id="6040671">enc</span>&nbsp;<span class="op" id="6040675">*</span><span class="ident" id="6040676">Encoder</span><span class="op" id="6040683">)</span>&nbsp;<span class="ident" id="6040685">Encode</span><span class="op" id="6040691">(</span><span class="ident" id="6040692">v</span>&nbsp;<span class="keyword" id="6040694">interface</span><span class="op" id="6040703">{</span><span class="op" id="6040704">}</span><span class="op" id="6040705">)</span>&nbsp;<span class="builtintype" id="6040707">error</span>&nbsp;<span class="op" id="6040713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6040716">err</span>&nbsp;<span class="op" id="6040720">:=</span>&nbsp;<span class="ident" id="6040723">enc</span><span class="op" id="6040726">.</span><span class="ident" id="6040727">p</span><span class="op" id="6040728">.</span><span class="ident" id="6040729">marshalValue</span><span class="op" id="6040741">(</span><span class="ident" id="6040742">reflect</span><span class="op" id="6040749">.</span><span class="ident" id="6040750">ValueOf</span><span class="op" id="6040757">(</span><span class="ident" id="6040758">v</span><span class="op" id="6040759">)</span><span class="op" id="6040760">,</span>&nbsp;<span class="ident" id="6040762">nil</span><span class="op" id="6040765">,</span>&nbsp;<span class="ident" id="6040767">nil</span><span class="op" id="6040770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6040773">if</span>&nbsp;<span class="ident" id="6040776">err</span>&nbsp;<span class="op" id="6040780">!=</span>&nbsp;<span class="ident" id="6040783">nil</span>&nbsp;<span class="op" id="6040787">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6040791">return</span>&nbsp;<span class="ident" id="6040798">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6040803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6040806">return</span>&nbsp;<span class="ident" id="6040813">enc</span><span class="op" id="6040816">.</span><span class="ident" id="6040817">p</span><span class="op" id="6040818">.</span><span class="ident" id="6040819">Flush</span><span class="op" id="6040824">(</span><span class="op" id="6040825">)</span><br>
<span class="lineno"></span><span class="op" id="6040827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6040830">//&nbsp;EncodeElement&nbsp;writes&nbsp;the&nbsp;XML&nbsp;encoding&nbsp;of&nbsp;v&nbsp;to&nbsp;the&nbsp;stream,</span><br>
<span class="lineno"></span><span class="comment" id="6040891">//&nbsp;using&nbsp;start&nbsp;as&nbsp;the&nbsp;outermost&nbsp;tag&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="comment" id="6040944">//</span><br>
<span class="lineno"></span><span class="comment" id="6040947">//&nbsp;See&nbsp;the&nbsp;documentation&nbsp;for&nbsp;Marshal&nbsp;for&nbsp;details&nbsp;about&nbsp;the&nbsp;conversion</span><br>
<span class="lineno"></span><span class="comment" id="6041017">//&nbsp;of&nbsp;Go&nbsp;values&nbsp;to&nbsp;XML.</span><br>
<span class="lineno">165</span><span class="comment" id="6041041">//</span><br>
<span class="lineno"></span><span class="comment" id="6041044">//&nbsp;EncodeElement&nbsp;calls&nbsp;Flush&nbsp;before&nbsp;returning.</span><br>
<span class="lineno"></span><span class="keyword" id="6041091">func</span>&nbsp;<span class="op" id="6041096">(</span><span class="ident" id="6041097">enc</span>&nbsp;<span class="op" id="6041101">*</span><span class="ident" id="6041102">Encoder</span><span class="op" id="6041109">)</span>&nbsp;<span class="ident" id="6041111">EncodeElement</span><span class="op" id="6041124">(</span><span class="ident" id="6041125">v</span>&nbsp;<span class="keyword" id="6041127">interface</span><span class="op" id="6041136">{</span><span class="op" id="6041137">}</span><span class="op" id="6041138">,</span>&nbsp;<span class="ident" id="6041140">start</span>&nbsp;<span class="ident" id="6041146">StartElement</span><span class="op" id="6041158">)</span>&nbsp;<span class="builtintype" id="6041160">error</span>&nbsp;<span class="op" id="6041166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6041169">err</span>&nbsp;<span class="op" id="6041173">:=</span>&nbsp;<span class="ident" id="6041176">enc</span><span class="op" id="6041179">.</span><span class="ident" id="6041180">p</span><span class="op" id="6041181">.</span><span class="ident" id="6041182">marshalValue</span><span class="op" id="6041194">(</span><span class="ident" id="6041195">reflect</span><span class="op" id="6041202">.</span><span class="ident" id="6041203">ValueOf</span><span class="op" id="6041210">(</span><span class="ident" id="6041211">v</span><span class="op" id="6041212">)</span><span class="op" id="6041213">,</span>&nbsp;<span class="ident" id="6041215">nil</span><span class="op" id="6041218">,</span>&nbsp;<span class="op" id="6041220">&amp;</span><span class="ident" id="6041221">start</span><span class="op" id="6041226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6041229">if</span>&nbsp;<span class="ident" id="6041232">err</span>&nbsp;<span class="op" id="6041236">!=</span>&nbsp;<span class="ident" id="6041239">nil</span>&nbsp;<span class="op" id="6041243">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6041247">return</span>&nbsp;<span class="ident" id="6041254">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6041259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6041262">return</span>&nbsp;<span class="ident" id="6041269">enc</span><span class="op" id="6041272">.</span><span class="ident" id="6041273">p</span><span class="op" id="6041274">.</span><span class="ident" id="6041275">Flush</span><span class="op" id="6041280">(</span><span class="op" id="6041281">)</span><br>
<span class="lineno"></span><span class="op" id="6041283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6041286">var</span>&nbsp;<span class="op" id="6041290">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6041293">endComment</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6041306">=</span>&nbsp;<span class="op" id="6041308">[</span><span class="op" id="6041309">]</span><span class="builtintype" id="6041310">byte</span><span class="op" id="6041314">(</span><span class="string" id="6041315">&#34;--&gt;&#34;</span><span class="op" id="6041320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6041323">endProcInst</span>&nbsp;&nbsp;<span class="op" id="6041336">=</span>&nbsp;<span class="op" id="6041338">[</span><span class="op" id="6041339">]</span><span class="builtintype" id="6041340">byte</span><span class="op" id="6041344">(</span><span class="string" id="6041345">&#34;?&gt;&#34;</span><span class="op" id="6041349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6041352">endDirective</span>&nbsp;<span class="op" id="6041365">=</span>&nbsp;<span class="op" id="6041367">[</span><span class="op" id="6041368">]</span><span class="builtintype" id="6041369">byte</span><span class="op" id="6041373">(</span><span class="string" id="6041374">&#34;&gt;&#34;</span><span class="op" id="6041377">)</span><br>
<span class="lineno"></span><span class="op" id="6041379">)</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="6041382">//&nbsp;EncodeToken&nbsp;writes&nbsp;the&nbsp;given&nbsp;XML&nbsp;token&nbsp;to&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="6041439">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;StartElement&nbsp;and&nbsp;EndElement&nbsp;tokens&nbsp;are&nbsp;not&nbsp;properly&nbsp;matched.</span><br>
<span class="lineno"></span><span class="comment" id="6041526">//</span><br>
<span class="lineno"></span><span class="comment" id="6041529">//&nbsp;EncodeToken&nbsp;does&nbsp;not&nbsp;call&nbsp;Flush,&nbsp;because&nbsp;usually&nbsp;it&nbsp;is&nbsp;part&nbsp;of&nbsp;a&nbsp;larger&nbsp;operation</span><br>
<span class="lineno">185</span><span class="comment" id="6041614">//&nbsp;such&nbsp;as&nbsp;Encode&nbsp;or&nbsp;EncodeElement&nbsp;(or&nbsp;a&nbsp;custom&nbsp;Marshaler&#39;s&nbsp;MarshalXML&nbsp;invoked</span><br>
<span class="lineno"></span><span class="comment" id="6041693">//&nbsp;during&nbsp;those),&nbsp;and&nbsp;those&nbsp;will&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="6041752">//&nbsp;Callers&nbsp;that&nbsp;create&nbsp;an&nbsp;Encoder&nbsp;and&nbsp;then&nbsp;invoke&nbsp;EncodeToken&nbsp;directly,&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="6041832">//&nbsp;using&nbsp;Encode&nbsp;or&nbsp;EncodeElement,&nbsp;need&nbsp;to&nbsp;call&nbsp;Flush&nbsp;when&nbsp;finished&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="6041909">//&nbsp;that&nbsp;the&nbsp;XML&nbsp;is&nbsp;written&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">190</span><span class="comment" id="6041962">//</span><br>
<span class="lineno"></span><span class="comment" id="6041965">//&nbsp;EncodeToken&nbsp;allows&nbsp;writing&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;Target&nbsp;set&nbsp;to&nbsp;&#34;xml&#34;&nbsp;only&nbsp;as&nbsp;the&nbsp;first&nbsp;token</span><br>
<span class="lineno"></span><span class="comment" id="6042055">//&nbsp;in&nbsp;the&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6042073">func</span>&nbsp;<span class="op" id="6042078">(</span><span class="ident" id="6042079">enc</span>&nbsp;<span class="op" id="6042083">*</span><span class="ident" id="6042084">Encoder</span><span class="op" id="6042091">)</span>&nbsp;<span class="ident" id="6042093">EncodeToken</span><span class="op" id="6042104">(</span><span class="ident" id="6042105">t</span>&nbsp;<span class="ident" id="6042107">Token</span><span class="op" id="6042112">)</span>&nbsp;<span class="builtintype" id="6042114">error</span>&nbsp;<span class="op" id="6042120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042123">p</span>&nbsp;<span class="op" id="6042125">:=</span>&nbsp;<span class="op" id="6042128">&amp;</span><span class="ident" id="6042129">enc</span><span class="op" id="6042132">.</span><span class="ident" id="6042133">p</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042136">switch</span>&nbsp;<span class="ident" id="6042143">t</span>&nbsp;<span class="op" id="6042145">:=</span>&nbsp;<span class="ident" id="6042148">t</span><span class="op" id="6042149">.</span><span class="op" id="6042150">(</span><span class="keyword" id="6042151">type</span><span class="op" id="6042155">)</span>&nbsp;<span class="op" id="6042157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042160">case</span>&nbsp;<span class="ident" id="6042165">StartElement</span><span class="op" id="6042177">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042181">if</span>&nbsp;<span class="ident" id="6042184">err</span>&nbsp;<span class="op" id="6042188">:=</span>&nbsp;<span class="ident" id="6042191">p</span><span class="op" id="6042192">.</span><span class="ident" id="6042193">writeStart</span><span class="op" id="6042203">(</span><span class="op" id="6042204">&amp;</span><span class="ident" id="6042205">t</span><span class="op" id="6042206">)</span><span class="op" id="6042207">;</span>&nbsp;<span class="ident" id="6042209">err</span>&nbsp;<span class="op" id="6042213">!=</span>&nbsp;<span class="ident" id="6042216">nil</span>&nbsp;<span class="op" id="6042220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042225">return</span>&nbsp;<span class="ident" id="6042232">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6042238">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042241">case</span>&nbsp;<span class="ident" id="6042246">EndElement</span><span class="op" id="6042256">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042260">if</span>&nbsp;<span class="ident" id="6042263">err</span>&nbsp;<span class="op" id="6042267">:=</span>&nbsp;<span class="ident" id="6042270">p</span><span class="op" id="6042271">.</span><span class="ident" id="6042272">writeEnd</span><span class="op" id="6042280">(</span><span class="ident" id="6042281">t</span><span class="op" id="6042282">.</span><span class="ident" id="6042283">Name</span><span class="op" id="6042287">)</span><span class="op" id="6042288">;</span>&nbsp;<span class="ident" id="6042290">err</span>&nbsp;<span class="op" id="6042294">!=</span>&nbsp;<span class="ident" id="6042297">nil</span>&nbsp;<span class="op" id="6042301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042306">return</span>&nbsp;<span class="ident" id="6042313">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6042319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042322">case</span>&nbsp;<span class="ident" id="6042327">CharData</span><span class="op" id="6042335">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042339">EscapeText</span><span class="op" id="6042349">(</span><span class="ident" id="6042350">p</span><span class="op" id="6042351">,</span>&nbsp;<span class="ident" id="6042353">t</span><span class="op" id="6042354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042357">case</span>&nbsp;<span class="ident" id="6042362">Comment</span><span class="op" id="6042369">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042373">if</span>&nbsp;<span class="ident" id="6042376">bytes</span><span class="op" id="6042381">.</span><span class="ident" id="6042382">Contains</span><span class="op" id="6042390">(</span><span class="ident" id="6042391">t</span><span class="op" id="6042392">,</span>&nbsp;<span class="ident" id="6042394">endComment</span><span class="op" id="6042404">)</span>&nbsp;<span class="op" id="6042406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042411">return</span>&nbsp;<span class="ident" id="6042418">fmt</span><span class="op" id="6042421">.</span><span class="ident" id="6042422">Errorf</span><span class="op" id="6042428">(</span><span class="string" id="6042429">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Comment&nbsp;containing&nbsp;--&gt;&nbsp;marker&#34;</span><span class="op" id="6042480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6042484">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042488">p</span><span class="op" id="6042489">.</span><span class="ident" id="6042490">WriteString</span><span class="op" id="6042501">(</span><span class="string" id="6042502">&#34;&lt;!--&#34;</span><span class="op" id="6042508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042512">p</span><span class="op" id="6042513">.</span><span class="ident" id="6042514">Write</span><span class="op" id="6042519">(</span><span class="ident" id="6042520">t</span><span class="op" id="6042521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6042525">p</span><span class="op" id="6042526">.</span><span class="ident" id="6042527">WriteString</span><span class="op" id="6042538">(</span><span class="string" id="6042539">&#34;--&gt;&#34;</span><span class="op" id="6042544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042548">return</span>&nbsp;<span class="ident" id="6042555">p</span><span class="op" id="6042556">.</span><span class="ident" id="6042557">cachedWriteError</span><span class="op" id="6042573">(</span><span class="op" id="6042574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042577">case</span>&nbsp;<span class="ident" id="6042582">ProcInst</span><span class="op" id="6042590">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6042594">//&nbsp;First&nbsp;token&nbsp;to&nbsp;be&nbsp;encoded&nbsp;which&nbsp;is&nbsp;also&nbsp;a&nbsp;ProcInst&nbsp;with&nbsp;target&nbsp;of&nbsp;xml</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6042669">//&nbsp;is&nbsp;the&nbsp;xml&nbsp;declaration.&nbsp;&nbsp;The&nbsp;only&nbsp;ProcInst&nbsp;where&nbsp;target&nbsp;of&nbsp;xml&nbsp;is&nbsp;allowed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042749">if</span>&nbsp;<span class="ident" id="6042752">t</span><span class="op" id="6042753">.</span><span class="ident" id="6042754">Target</span>&nbsp;<span class="op" id="6042761">==</span>&nbsp;<span class="string" id="6042764">&#34;xml&#34;</span>&nbsp;<span class="op" id="6042770">&amp;&amp;</span>&nbsp;<span class="ident" id="6042773">p</span><span class="op" id="6042774">.</span><span class="ident" id="6042775">Buffered</span><span class="op" id="6042783">(</span><span class="op" id="6042784">)</span>&nbsp;<span class="op" id="6042786">!=</span>&nbsp;<span class="num" id="6042789">0</span>&nbsp;<span class="op" id="6042791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042796">return</span>&nbsp;<span class="ident" id="6042803">fmt</span><span class="op" id="6042806">.</span><span class="ident" id="6042807">Errorf</span><span class="op" id="6042813">(</span><span class="string" id="6042814">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;xml&nbsp;target&nbsp;only&nbsp;valid&nbsp;for&nbsp;xml&nbsp;declaration,&nbsp;first&nbsp;token&nbsp;encoded&#34;</span><span class="op" id="6042907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6042911">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042915">if</span>&nbsp;<span class="op" id="6042918">!</span><span class="ident" id="6042919">isNameString</span><span class="op" id="6042931">(</span><span class="ident" id="6042932">t</span><span class="op" id="6042933">.</span><span class="ident" id="6042934">Target</span><span class="op" id="6042940">)</span>&nbsp;<span class="op" id="6042942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6042947">return</span>&nbsp;<span class="ident" id="6042954">fmt</span><span class="op" id="6042957">.</span><span class="ident" id="6042958">Errorf</span><span class="op" id="6042964">(</span><span class="string" id="6042965">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;with&nbsp;invalid&nbsp;Target&#34;</span><span class="op" id="6043015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043023">if</span>&nbsp;<span class="ident" id="6043026">bytes</span><span class="op" id="6043031">.</span><span class="ident" id="6043032">Contains</span><span class="op" id="6043040">(</span><span class="ident" id="6043041">t</span><span class="op" id="6043042">.</span><span class="ident" id="6043043">Inst</span><span class="op" id="6043047">,</span>&nbsp;<span class="ident" id="6043049">endProcInst</span><span class="op" id="6043060">)</span>&nbsp;<span class="op" id="6043062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043067">return</span>&nbsp;<span class="ident" id="6043074">fmt</span><span class="op" id="6043077">.</span><span class="ident" id="6043078">Errorf</span><span class="op" id="6043084">(</span><span class="string" id="6043085">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;ProcInst&nbsp;containing&nbsp;?&gt;&nbsp;marker&#34;</span><span class="op" id="6043136">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043144">p</span><span class="op" id="6043145">.</span><span class="ident" id="6043146">WriteString</span><span class="op" id="6043157">(</span><span class="string" id="6043158">&#34;&lt;?&#34;</span><span class="op" id="6043162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043166">p</span><span class="op" id="6043167">.</span><span class="ident" id="6043168">WriteString</span><span class="op" id="6043179">(</span><span class="ident" id="6043180">t</span><span class="op" id="6043181">.</span><span class="ident" id="6043182">Target</span><span class="op" id="6043188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043192">if</span>&nbsp;<span class="builtinfunc" id="6043195">len</span><span class="op" id="6043198">(</span><span class="ident" id="6043199">t</span><span class="op" id="6043200">.</span><span class="ident" id="6043201">Inst</span><span class="op" id="6043205">)</span>&nbsp;<span class="op" id="6043207">&gt;</span>&nbsp;<span class="num" id="6043209">0</span>&nbsp;<span class="op" id="6043211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043216">p</span><span class="op" id="6043217">.</span><span class="ident" id="6043218">WriteByte</span><span class="op" id="6043227">(</span><span class="string" id="6043228">&#39;&nbsp;&#39;</span><span class="op" id="6043231">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043236">p</span><span class="op" id="6043237">.</span><span class="ident" id="6043238">Write</span><span class="op" id="6043243">(</span><span class="ident" id="6043244">t</span><span class="op" id="6043245">.</span><span class="ident" id="6043246">Inst</span><span class="op" id="6043250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043258">p</span><span class="op" id="6043259">.</span><span class="ident" id="6043260">WriteString</span><span class="op" id="6043271">(</span><span class="string" id="6043272">&#34;?&gt;&#34;</span><span class="op" id="6043276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043279">case</span>&nbsp;<span class="ident" id="6043284">Directive</span><span class="op" id="6043293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043297">if</span>&nbsp;<span class="ident" id="6043300">bytes</span><span class="op" id="6043305">.</span><span class="ident" id="6043306">Contains</span><span class="op" id="6043314">(</span><span class="ident" id="6043315">t</span><span class="op" id="6043316">,</span>&nbsp;<span class="ident" id="6043318">endDirective</span><span class="op" id="6043330">)</span>&nbsp;<span class="op" id="6043332">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043337">return</span>&nbsp;<span class="ident" id="6043344">fmt</span><span class="op" id="6043347">.</span><span class="ident" id="6043348">Errorf</span><span class="op" id="6043354">(</span><span class="string" id="6043355">&#34;xml:&nbsp;EncodeToken&nbsp;of&nbsp;Directive&nbsp;containing&nbsp;&gt;&nbsp;marker&#34;</span><span class="op" id="6043406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043414">p</span><span class="op" id="6043415">.</span><span class="ident" id="6043416">WriteString</span><span class="op" id="6043427">(</span><span class="string" id="6043428">&#34;&lt;!&#34;</span><span class="op" id="6043432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043436">p</span><span class="op" id="6043437">.</span><span class="ident" id="6043438">Write</span><span class="op" id="6043443">(</span><span class="ident" id="6043444">t</span><span class="op" id="6043445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043449">p</span><span class="op" id="6043450">.</span><span class="ident" id="6043451">WriteString</span><span class="op" id="6043462">(</span><span class="string" id="6043463">&#34;&gt;&#34;</span><span class="op" id="6043466">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043472">return</span>&nbsp;<span class="ident" id="6043479">p</span><span class="op" id="6043480">.</span><span class="ident" id="6043481">cachedWriteError</span><span class="op" id="6043497">(</span><span class="op" id="6043498">)</span><br>
<span class="lineno"></span><span class="op" id="6043500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6043503">//&nbsp;Flush&nbsp;flushes&nbsp;any&nbsp;buffered&nbsp;XML&nbsp;to&nbsp;the&nbsp;underlying&nbsp;writer.</span><br>
<span class="lineno">245</span><span class="comment" id="6043563">//&nbsp;See&nbsp;the&nbsp;EncodeToken&nbsp;documentation&nbsp;for&nbsp;details&nbsp;about&nbsp;when&nbsp;it&nbsp;is&nbsp;necessary.</span><br>
<span class="lineno"></span><span class="keyword" id="6043640">func</span>&nbsp;<span class="op" id="6043645">(</span><span class="ident" id="6043646">enc</span>&nbsp;<span class="op" id="6043650">*</span><span class="ident" id="6043651">Encoder</span><span class="op" id="6043658">)</span>&nbsp;<span class="ident" id="6043660">Flush</span><span class="op" id="6043665">(</span><span class="op" id="6043666">)</span>&nbsp;<span class="builtintype" id="6043668">error</span>&nbsp;<span class="op" id="6043674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6043677">return</span>&nbsp;<span class="ident" id="6043684">enc</span><span class="op" id="6043687">.</span><span class="ident" id="6043688">p</span><span class="op" id="6043689">.</span><span class="ident" id="6043690">Flush</span><span class="op" id="6043695">(</span><span class="op" id="6043696">)</span><br>
<span class="lineno"></span><span class="op" id="6043698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="6043701">type</span>&nbsp;<span class="ident" id="6043706">printer</span>&nbsp;<span class="keyword" id="6043714">struct</span>&nbsp;<span class="op" id="6043721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6043724">*</span><span class="ident" id="6043725">bufio</span><span class="op" id="6043730">.</span><span class="ident" id="6043731">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043739">encoder</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6043750">*</span><span class="ident" id="6043751">Encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043760">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6043771">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043776">indent</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6043787">string</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043795">prefix</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6043806">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043814">depth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6043825">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043830">indentedIn</span>&nbsp;<span class="builtintype" id="6043841">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043847">putNewline</span>&nbsp;<span class="builtintype" id="6043858">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043864">attrNS</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6043875">map</span><span class="op" id="6043878">[</span><span class="builtintype" id="6043879">string</span><span class="op" id="6043885">]</span><span class="builtintype" id="6043886">string</span>&nbsp;<span class="comment" id="6043893">//&nbsp;map&nbsp;prefix&nbsp;-&gt;&nbsp;name&nbsp;space</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043922">attrPrefix</span>&nbsp;<span class="keyword" id="6043933">map</span><span class="op" id="6043936">[</span><span class="builtintype" id="6043937">string</span><span class="op" id="6043943">]</span><span class="builtintype" id="6043944">string</span>&nbsp;<span class="comment" id="6043951">//&nbsp;map&nbsp;name&nbsp;space&nbsp;-&gt;&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6043980">prefixes</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6043991">[</span><span class="op" id="6043992">]</span><span class="builtintype" id="6043993">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044001">tags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6044012">[</span><span class="op" id="6044013">]</span><span class="ident" id="6044014">Name</span><br>
<span class="lineno"></span><span class="op" id="6044019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="6044022">//&nbsp;createAttrPrefix&nbsp;finds&nbsp;the&nbsp;name&nbsp;space&nbsp;prefix&nbsp;attribute&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;given&nbsp;name&nbsp;space,</span><br>
<span class="lineno"></span><span class="comment" id="6044113">//&nbsp;defining&nbsp;a&nbsp;new&nbsp;prefix&nbsp;if&nbsp;necessary.&nbsp;It&nbsp;returns&nbsp;the&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6044175">func</span>&nbsp;<span class="op" id="6044180">(</span><span class="ident" id="6044181">p</span>&nbsp;<span class="op" id="6044183">*</span><span class="ident" id="6044184">printer</span><span class="op" id="6044191">)</span>&nbsp;<span class="ident" id="6044193">createAttrPrefix</span><span class="op" id="6044209">(</span><span class="ident" id="6044210">url</span>&nbsp;<span class="builtintype" id="6044214">string</span><span class="op" id="6044220">)</span>&nbsp;<span class="builtintype" id="6044222">string</span>&nbsp;<span class="op" id="6044229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044232">if</span>&nbsp;<span class="ident" id="6044235">prefix</span>&nbsp;<span class="op" id="6044242">:=</span>&nbsp;<span class="ident" id="6044245">p</span><span class="op" id="6044246">.</span><span class="ident" id="6044247">attrPrefix</span><span class="op" id="6044257">[</span><span class="ident" id="6044258">url</span><span class="op" id="6044261">]</span><span class="op" id="6044262">;</span>&nbsp;<span class="ident" id="6044264">prefix</span>&nbsp;<span class="op" id="6044271">!=</span>&nbsp;<span class="string" id="6044274">&#34;&#34;</span>&nbsp;<span class="op" id="6044277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044281">return</span>&nbsp;<span class="ident" id="6044288">prefix</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044300">//&nbsp;The&nbsp;&#34;http://www.w3.org/XML/1998/namespace&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;predefined&nbsp;as&nbsp;&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044381">//&nbsp;and&nbsp;must&nbsp;be&nbsp;referred&nbsp;to&nbsp;that&nbsp;way.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044419">//&nbsp;(The&nbsp;&#34;http://www.w3.org/2000/xmlns/&#34;&nbsp;name&nbsp;space&nbsp;is&nbsp;also&nbsp;predefined&nbsp;as&nbsp;&#34;xmlns&#34;,</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044502">//&nbsp;but&nbsp;users&nbsp;should&nbsp;not&nbsp;be&nbsp;trying&nbsp;to&nbsp;use&nbsp;that&nbsp;one&nbsp;directly&nbsp;-&nbsp;that&#39;s&nbsp;our&nbsp;job.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044581">if</span>&nbsp;<span class="ident" id="6044584">url</span>&nbsp;<span class="op" id="6044588">==</span>&nbsp;<span class="ident" id="6044591">xmlURL</span>&nbsp;<span class="op" id="6044598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044602">return</span>&nbsp;<span class="string" id="6044609">&#34;xml&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044620">//&nbsp;Need&nbsp;to&nbsp;define&nbsp;a&nbsp;new&nbsp;name&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044657">if</span>&nbsp;<span class="ident" id="6044660">p</span><span class="op" id="6044661">.</span><span class="ident" id="6044662">attrPrefix</span>&nbsp;<span class="op" id="6044673">==</span>&nbsp;<span class="ident" id="6044676">nil</span>&nbsp;<span class="op" id="6044680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044684">p</span><span class="op" id="6044685">.</span><span class="ident" id="6044686">attrPrefix</span>&nbsp;<span class="op" id="6044697">=</span>&nbsp;<span class="builtinfunc" id="6044699">make</span><span class="op" id="6044703">(</span><span class="keyword" id="6044704">map</span><span class="op" id="6044707">[</span><span class="builtintype" id="6044708">string</span><span class="op" id="6044714">]</span><span class="builtintype" id="6044715">string</span><span class="op" id="6044721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044725">p</span><span class="op" id="6044726">.</span><span class="ident" id="6044727">attrNS</span>&nbsp;<span class="op" id="6044734">=</span>&nbsp;<span class="builtinfunc" id="6044736">make</span><span class="op" id="6044740">(</span><span class="keyword" id="6044741">map</span><span class="op" id="6044744">[</span><span class="builtintype" id="6044745">string</span><span class="op" id="6044751">]</span><span class="builtintype" id="6044752">string</span><span class="op" id="6044758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044761">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044765">//&nbsp;Pick&nbsp;a&nbsp;name.&nbsp;We&nbsp;try&nbsp;to&nbsp;use&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;the&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6044826">//&nbsp;but&nbsp;fall&nbsp;back&nbsp;to&nbsp;_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044850">prefix</span>&nbsp;<span class="op" id="6044857">:=</span>&nbsp;<span class="ident" id="6044860">strings</span><span class="op" id="6044867">.</span><span class="ident" id="6044868">TrimRight</span><span class="op" id="6044877">(</span><span class="ident" id="6044878">url</span><span class="op" id="6044881">,</span>&nbsp;<span class="string" id="6044883">&#34;/&#34;</span><span class="op" id="6044886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044889">if</span>&nbsp;<span class="ident" id="6044892">i</span>&nbsp;<span class="op" id="6044894">:=</span>&nbsp;<span class="ident" id="6044897">strings</span><span class="op" id="6044904">.</span><span class="ident" id="6044905">LastIndex</span><span class="op" id="6044914">(</span><span class="ident" id="6044915">prefix</span><span class="op" id="6044921">,</span>&nbsp;<span class="string" id="6044923">&#34;/&#34;</span><span class="op" id="6044926">)</span><span class="op" id="6044927">;</span>&nbsp;<span class="ident" id="6044929">i</span>&nbsp;<span class="op" id="6044931">&gt;=</span>&nbsp;<span class="num" id="6044934">0</span>&nbsp;<span class="op" id="6044936">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6044940">prefix</span>&nbsp;<span class="op" id="6044947">=</span>&nbsp;<span class="ident" id="6044949">prefix</span><span class="op" id="6044955">[</span><span class="ident" id="6044956">i</span><span class="op" id="6044957">+</span><span class="num" id="6044958">1</span><span class="op" id="6044959">:</span><span class="op" id="6044960">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6044963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6044966">if</span>&nbsp;<span class="ident" id="6044969">prefix</span>&nbsp;<span class="op" id="6044976">==</span>&nbsp;<span class="string" id="6044979">&#34;&#34;</span>&nbsp;<span class="op" id="6044982">||</span>&nbsp;<span class="op" id="6044985">!</span><span class="ident" id="6044986">isName</span><span class="op" id="6044992">(</span><span class="op" id="6044993">[</span><span class="op" id="6044994">]</span><span class="builtintype" id="6044995">byte</span><span class="op" id="6044999">(</span><span class="ident" id="6045000">prefix</span><span class="op" id="6045006">)</span><span class="op" id="6045007">)</span>&nbsp;<span class="op" id="6045009">||</span>&nbsp;<span class="ident" id="6045012">strings</span><span class="op" id="6045019">.</span><span class="ident" id="6045020">Contains</span><span class="op" id="6045028">(</span><span class="ident" id="6045029">prefix</span><span class="op" id="6045035">,</span>&nbsp;<span class="string" id="6045037">&#34;:&#34;</span><span class="op" id="6045040">)</span>&nbsp;<span class="op" id="6045042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045046">prefix</span>&nbsp;<span class="op" id="6045053">=</span>&nbsp;<span class="string" id="6045055">&#34;_&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6045060">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045063">if</span>&nbsp;<span class="ident" id="6045066">strings</span><span class="op" id="6045073">.</span><span class="ident" id="6045074">HasPrefix</span><span class="op" id="6045083">(</span><span class="ident" id="6045084">prefix</span><span class="op" id="6045090">,</span>&nbsp;<span class="string" id="6045092">&#34;xml&#34;</span><span class="op" id="6045097">)</span>&nbsp;<span class="op" id="6045099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6045103">//&nbsp;xmlanything&nbsp;is&nbsp;reserved.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045133">prefix</span>&nbsp;<span class="op" id="6045140">=</span>&nbsp;<span class="string" id="6045142">&#34;_&#34;</span>&nbsp;<span class="op" id="6045146">+</span>&nbsp;<span class="ident" id="6045148">prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6045156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045159">if</span>&nbsp;<span class="ident" id="6045162">p</span><span class="op" id="6045163">.</span><span class="ident" id="6045164">attrNS</span><span class="op" id="6045170">[</span><span class="ident" id="6045171">prefix</span><span class="op" id="6045177">]</span>&nbsp;<span class="op" id="6045179">!=</span>&nbsp;<span class="string" id="6045182">&#34;&#34;</span>&nbsp;<span class="op" id="6045185">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6045189">//&nbsp;Name&nbsp;is&nbsp;taken.&nbsp;Find&nbsp;a&nbsp;better&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045228">for</span>&nbsp;<span class="ident" id="6045232">p</span><span class="op" id="6045233">.</span><span class="ident" id="6045234">seq</span><span class="op" id="6045237">++</span><span class="op" id="6045239">;</span>&nbsp;<span class="op" id="6045241">;</span>&nbsp;<span class="ident" id="6045243">p</span><span class="op" id="6045244">.</span><span class="ident" id="6045245">seq</span><span class="op" id="6045248">++</span>&nbsp;<span class="op" id="6045251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045256">if</span>&nbsp;<span class="ident" id="6045259">id</span>&nbsp;<span class="op" id="6045262">:=</span>&nbsp;<span class="ident" id="6045265">prefix</span>&nbsp;<span class="op" id="6045272">+</span>&nbsp;<span class="string" id="6045274">&#34;_&#34;</span>&nbsp;<span class="op" id="6045278">+</span>&nbsp;<span class="ident" id="6045280">strconv</span><span class="op" id="6045287">.</span><span class="ident" id="6045288">Itoa</span><span class="op" id="6045292">(</span><span class="ident" id="6045293">p</span><span class="op" id="6045294">.</span><span class="ident" id="6045295">seq</span><span class="op" id="6045298">)</span><span class="op" id="6045299">;</span>&nbsp;<span class="ident" id="6045301">p</span><span class="op" id="6045302">.</span><span class="ident" id="6045303">attrNS</span><span class="op" id="6045309">[</span><span class="ident" id="6045310">id</span><span class="op" id="6045312">]</span>&nbsp;<span class="op" id="6045314">==</span>&nbsp;<span class="string" id="6045317">&#34;&#34;</span>&nbsp;<span class="op" id="6045320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045326">prefix</span>&nbsp;<span class="op" id="6045333">=</span>&nbsp;<span class="ident" id="6045335">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045342">break</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6045351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6045355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6045358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045362">p</span><span class="op" id="6045363">.</span><span class="ident" id="6045364">attrPrefix</span><span class="op" id="6045374">[</span><span class="ident" id="6045375">url</span><span class="op" id="6045378">]</span>&nbsp;<span class="op" id="6045380">=</span>&nbsp;<span class="ident" id="6045382">prefix</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045390">p</span><span class="op" id="6045391">.</span><span class="ident" id="6045392">attrNS</span><span class="op" id="6045398">[</span><span class="ident" id="6045399">prefix</span><span class="op" id="6045405">]</span>&nbsp;<span class="op" id="6045407">=</span>&nbsp;<span class="ident" id="6045409">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045415">p</span><span class="op" id="6045416">.</span><span class="ident" id="6045417">WriteString</span><span class="op" id="6045428">(</span><span class="string" id="6045429">`xmlns:`</span><span class="op" id="6045437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045440">p</span><span class="op" id="6045441">.</span><span class="ident" id="6045442">WriteString</span><span class="op" id="6045453">(</span><span class="ident" id="6045454">prefix</span><span class="op" id="6045460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045463">p</span><span class="op" id="6045464">.</span><span class="ident" id="6045465">WriteString</span><span class="op" id="6045476">(</span><span class="string" id="6045477">`=&#34;`</span><span class="op" id="6045481">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045484">EscapeText</span><span class="op" id="6045494">(</span><span class="ident" id="6045495">p</span><span class="op" id="6045496">,</span>&nbsp;<span class="op" id="6045498">[</span><span class="op" id="6045499">]</span><span class="builtintype" id="6045500">byte</span><span class="op" id="6045504">(</span><span class="ident" id="6045505">url</span><span class="op" id="6045508">)</span><span class="op" id="6045509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045512">p</span><span class="op" id="6045513">.</span><span class="ident" id="6045514">WriteString</span><span class="op" id="6045525">(</span><span class="string" id="6045526">`&#34;&nbsp;`</span><span class="op" id="6045530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045534">p</span><span class="op" id="6045535">.</span><span class="ident" id="6045536">prefixes</span>&nbsp;<span class="op" id="6045545">=</span>&nbsp;<span class="builtinfunc" id="6045547">append</span><span class="op" id="6045553">(</span><span class="ident" id="6045554">p</span><span class="op" id="6045555">.</span><span class="ident" id="6045556">prefixes</span><span class="op" id="6045564">,</span>&nbsp;<span class="ident" id="6045566">prefix</span><span class="op" id="6045572">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045576">return</span>&nbsp;<span class="ident" id="6045583">prefix</span><br>
<span class="lineno"></span><span class="op" id="6045590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6045593">//&nbsp;deleteAttrPrefix&nbsp;removes&nbsp;an&nbsp;attribute&nbsp;name&nbsp;space&nbsp;prefix.</span><br>
<span class="lineno"></span><span class="keyword" id="6045653">func</span>&nbsp;<span class="op" id="6045658">(</span><span class="ident" id="6045659">p</span>&nbsp;<span class="op" id="6045661">*</span><span class="ident" id="6045662">printer</span><span class="op" id="6045669">)</span>&nbsp;<span class="ident" id="6045671">deleteAttrPrefix</span><span class="op" id="6045687">(</span><span class="ident" id="6045688">prefix</span>&nbsp;<span class="builtintype" id="6045695">string</span><span class="op" id="6045701">)</span>&nbsp;<span class="op" id="6045703">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6045706">delete</span><span class="op" id="6045712">(</span><span class="ident" id="6045713">p</span><span class="op" id="6045714">.</span><span class="ident" id="6045715">attrPrefix</span><span class="op" id="6045725">,</span>&nbsp;<span class="ident" id="6045727">p</span><span class="op" id="6045728">.</span><span class="ident" id="6045729">attrNS</span><span class="op" id="6045735">[</span><span class="ident" id="6045736">prefix</span><span class="op" id="6045742">]</span><span class="op" id="6045743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6045746">delete</span><span class="op" id="6045752">(</span><span class="ident" id="6045753">p</span><span class="op" id="6045754">.</span><span class="ident" id="6045755">attrNS</span><span class="op" id="6045761">,</span>&nbsp;<span class="ident" id="6045763">prefix</span><span class="op" id="6045769">)</span><br>
<span class="lineno"></span><span class="op" id="6045771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6045774">func</span>&nbsp;<span class="op" id="6045779">(</span><span class="ident" id="6045780">p</span>&nbsp;<span class="op" id="6045782">*</span><span class="ident" id="6045783">printer</span><span class="op" id="6045790">)</span>&nbsp;<span class="ident" id="6045792">markPrefix</span><span class="op" id="6045802">(</span><span class="op" id="6045803">)</span>&nbsp;<span class="op" id="6045805">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045808">p</span><span class="op" id="6045809">.</span><span class="ident" id="6045810">prefixes</span>&nbsp;<span class="op" id="6045819">=</span>&nbsp;<span class="builtinfunc" id="6045821">append</span><span class="op" id="6045827">(</span><span class="ident" id="6045828">p</span><span class="op" id="6045829">.</span><span class="ident" id="6045830">prefixes</span><span class="op" id="6045838">,</span>&nbsp;<span class="string" id="6045840">&#34;&#34;</span><span class="op" id="6045842">)</span><br>
<span class="lineno"></span><span class="op" id="6045844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6045847">func</span>&nbsp;<span class="op" id="6045852">(</span><span class="ident" id="6045853">p</span>&nbsp;<span class="op" id="6045855">*</span><span class="ident" id="6045856">printer</span><span class="op" id="6045863">)</span>&nbsp;<span class="ident" id="6045865">popPrefix</span><span class="op" id="6045874">(</span><span class="op" id="6045875">)</span>&nbsp;<span class="op" id="6045877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045880">for</span>&nbsp;<span class="builtinfunc" id="6045884">len</span><span class="op" id="6045887">(</span><span class="ident" id="6045888">p</span><span class="op" id="6045889">.</span><span class="ident" id="6045890">prefixes</span><span class="op" id="6045898">)</span>&nbsp;<span class="op" id="6045900">&gt;</span>&nbsp;<span class="num" id="6045902">0</span>&nbsp;<span class="op" id="6045904">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045908">prefix</span>&nbsp;<span class="op" id="6045915">:=</span>&nbsp;<span class="ident" id="6045918">p</span><span class="op" id="6045919">.</span><span class="ident" id="6045920">prefixes</span><span class="op" id="6045928">[</span><span class="builtinfunc" id="6045929">len</span><span class="op" id="6045932">(</span><span class="ident" id="6045933">p</span><span class="op" id="6045934">.</span><span class="ident" id="6045935">prefixes</span><span class="op" id="6045943">)</span><span class="op" id="6045944">-</span><span class="num" id="6045945">1</span><span class="op" id="6045946">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6045950">p</span><span class="op" id="6045951">.</span><span class="ident" id="6045952">prefixes</span>&nbsp;<span class="op" id="6045961">=</span>&nbsp;<span class="ident" id="6045963">p</span><span class="op" id="6045964">.</span><span class="ident" id="6045965">prefixes</span><span class="op" id="6045973">[</span><span class="op" id="6045974">:</span><span class="builtinfunc" id="6045975">len</span><span class="op" id="6045978">(</span><span class="ident" id="6045979">p</span><span class="op" id="6045980">.</span><span class="ident" id="6045981">prefixes</span><span class="op" id="6045989">)</span><span class="op" id="6045990">-</span><span class="num" id="6045991">1</span><span class="op" id="6045992">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6045996">if</span>&nbsp;<span class="ident" id="6045999">prefix</span>&nbsp;<span class="op" id="6046006">==</span>&nbsp;<span class="string" id="6046009">&#34;&#34;</span>&nbsp;<span class="op" id="6046012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046017">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6046025">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6046029">p</span><span class="op" id="6046030">.</span><span class="ident" id="6046031">deleteAttrPrefix</span><span class="op" id="6046047">(</span><span class="ident" id="6046048">prefix</span><span class="op" id="6046054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6046057">}</span><br>
<span class="lineno"></span><span class="op" id="6046059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6046062">var</span>&nbsp;<span class="op" id="6046066">(</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6046069">marshalerType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6046087">=</span>&nbsp;<span class="ident" id="6046089">reflect</span><span class="op" id="6046096">.</span><span class="ident" id="6046097">TypeOf</span><span class="op" id="6046103">(</span><span class="op" id="6046104">(</span><span class="op" id="6046105">*</span><span class="ident" id="6046106">Marshaler</span><span class="op" id="6046115">)</span><span class="op" id="6046116">(</span><span class="ident" id="6046117">nil</span><span class="op" id="6046120">)</span><span class="op" id="6046121">)</span><span class="op" id="6046122">.</span><span class="ident" id="6046123">Elem</span><span class="op" id="6046127">(</span><span class="op" id="6046128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6046131">marshalerAttrType</span>&nbsp;<span class="op" id="6046149">=</span>&nbsp;<span class="ident" id="6046151">reflect</span><span class="op" id="6046158">.</span><span class="ident" id="6046159">TypeOf</span><span class="op" id="6046165">(</span><span class="op" id="6046166">(</span><span class="op" id="6046167">*</span><span class="ident" id="6046168">MarshalerAttr</span><span class="op" id="6046181">)</span><span class="op" id="6046182">(</span><span class="ident" id="6046183">nil</span><span class="op" id="6046186">)</span><span class="op" id="6046187">)</span><span class="op" id="6046188">.</span><span class="ident" id="6046189">Elem</span><span class="op" id="6046193">(</span><span class="op" id="6046194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6046197">textMarshalerType</span>&nbsp;<span class="op" id="6046215">=</span>&nbsp;<span class="ident" id="6046217">reflect</span><span class="op" id="6046224">.</span><span class="ident" id="6046225">TypeOf</span><span class="op" id="6046231">(</span><span class="op" id="6046232">(</span><span class="op" id="6046233">*</span><span class="ident" id="6046234">encoding</span><span class="op" id="6046242">.</span><span class="ident" id="6046243">TextMarshaler</span><span class="op" id="6046256">)</span><span class="op" id="6046257">(</span><span class="ident" id="6046258">nil</span><span class="op" id="6046261">)</span><span class="op" id="6046262">)</span><span class="op" id="6046263">.</span><span class="ident" id="6046264">Elem</span><span class="op" id="6046268">(</span><span class="op" id="6046269">)</span><br>
<span class="lineno"></span><span class="op" id="6046271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="comment" id="6046274">//&nbsp;marshalValue&nbsp;writes&nbsp;one&nbsp;or&nbsp;more&nbsp;XML&nbsp;elements&nbsp;representing&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="6046340">//&nbsp;If&nbsp;val&nbsp;was&nbsp;obtained&nbsp;from&nbsp;a&nbsp;struct&nbsp;field,&nbsp;finfo&nbsp;must&nbsp;have&nbsp;its&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="6046413">func</span>&nbsp;<span class="op" id="6046418">(</span><span class="ident" id="6046419">p</span>&nbsp;<span class="op" id="6046421">*</span><span class="ident" id="6046422">printer</span><span class="op" id="6046429">)</span>&nbsp;<span class="ident" id="6046431">marshalValue</span><span class="op" id="6046443">(</span><span class="ident" id="6046444">val</span>&nbsp;<span class="ident" id="6046448">reflect</span><span class="op" id="6046455">.</span><span class="ident" id="6046456">Value</span><span class="op" id="6046461">,</span>&nbsp;<span class="ident" id="6046463">finfo</span>&nbsp;<span class="op" id="6046469">*</span><span class="ident" id="6046470">fieldInfo</span><span class="op" id="6046479">,</span>&nbsp;<span class="ident" id="6046481">startTemplate</span>&nbsp;<span class="op" id="6046495">*</span><span class="ident" id="6046496">StartElement</span><span class="op" id="6046508">)</span>&nbsp;<span class="builtintype" id="6046510">error</span>&nbsp;<span class="op" id="6046516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046519">if</span>&nbsp;<span class="ident" id="6046522">startTemplate</span>&nbsp;<span class="op" id="6046536">!=</span>&nbsp;<span class="ident" id="6046539">nil</span>&nbsp;<span class="op" id="6046543">&amp;&amp;</span>&nbsp;<span class="ident" id="6046546">startTemplate</span><span class="op" id="6046559">.</span><span class="ident" id="6046560">Name</span><span class="op" id="6046564">.</span><span class="ident" id="6046565">Local</span>&nbsp;<span class="op" id="6046571">==</span>&nbsp;<span class="string" id="6046574">&#34;&#34;</span>&nbsp;<span class="op" id="6046577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046581">return</span>&nbsp;<span class="ident" id="6046588">fmt</span><span class="op" id="6046591">.</span><span class="ident" id="6046592">Errorf</span><span class="op" id="6046598">(</span><span class="string" id="6046599">&#34;xml:&nbsp;EncodeElement&nbsp;of&nbsp;StartElement&nbsp;with&nbsp;missing&nbsp;name&#34;</span><span class="op" id="6046653">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6046656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046660">if</span>&nbsp;<span class="op" id="6046663">!</span><span class="ident" id="6046664">val</span><span class="op" id="6046667">.</span><span class="ident" id="6046668">IsValid</span><span class="op" id="6046675">(</span><span class="op" id="6046676">)</span>&nbsp;<span class="op" id="6046678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046682">return</span>&nbsp;<span class="ident" id="6046689">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6046694">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046697">if</span>&nbsp;<span class="ident" id="6046700">finfo</span>&nbsp;<span class="op" id="6046706">!=</span>&nbsp;<span class="ident" id="6046709">nil</span>&nbsp;<span class="op" id="6046713">&amp;&amp;</span>&nbsp;<span class="ident" id="6046716">finfo</span><span class="op" id="6046721">.</span><span class="ident" id="6046722">flags</span><span class="op" id="6046727">&amp;</span><span class="ident" id="6046728">fOmitEmpty</span>&nbsp;<span class="op" id="6046739">!=</span>&nbsp;<span class="num" id="6046742">0</span>&nbsp;<span class="op" id="6046744">&amp;&amp;</span>&nbsp;<span class="ident" id="6046747">isEmptyValue</span><span class="op" id="6046759">(</span><span class="ident" id="6046760">val</span><span class="op" id="6046763">)</span>&nbsp;<span class="op" id="6046765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046769">return</span>&nbsp;<span class="ident" id="6046776">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6046781">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6046785">//&nbsp;Drill&nbsp;into&nbsp;interfaces&nbsp;and&nbsp;pointers.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6046825">//&nbsp;This&nbsp;can&nbsp;turn&nbsp;into&nbsp;an&nbsp;infinite&nbsp;loop&nbsp;given&nbsp;a&nbsp;cyclic&nbsp;chain,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6046887">//&nbsp;but&nbsp;it&nbsp;matches&nbsp;the&nbsp;Go&nbsp;1&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046925">for</span>&nbsp;<span class="ident" id="6046929">val</span><span class="op" id="6046932">.</span><span class="ident" id="6046933">Kind</span><span class="op" id="6046937">(</span><span class="op" id="6046938">)</span>&nbsp;<span class="op" id="6046940">==</span>&nbsp;<span class="ident" id="6046943">reflect</span><span class="op" id="6046950">.</span><span class="ident" id="6046951">Interface</span>&nbsp;<span class="op" id="6046961">||</span>&nbsp;<span class="ident" id="6046964">val</span><span class="op" id="6046967">.</span><span class="ident" id="6046968">Kind</span><span class="op" id="6046972">(</span><span class="op" id="6046973">)</span>&nbsp;<span class="op" id="6046975">==</span>&nbsp;<span class="ident" id="6046978">reflect</span><span class="op" id="6046985">.</span><span class="ident" id="6046986">Ptr</span>&nbsp;<span class="op" id="6046990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6046994">if</span>&nbsp;<span class="ident" id="6046997">val</span><span class="op" id="6047000">.</span><span class="ident" id="6047001">IsNil</span><span class="op" id="6047006">(</span><span class="op" id="6047007">)</span>&nbsp;<span class="op" id="6047009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047014">return</span>&nbsp;<span class="ident" id="6047021">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6047031">val</span>&nbsp;<span class="op" id="6047035">=</span>&nbsp;<span class="ident" id="6047037">val</span><span class="op" id="6047040">.</span><span class="ident" id="6047041">Elem</span><span class="op" id="6047045">(</span><span class="op" id="6047046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6047053">kind</span>&nbsp;<span class="op" id="6047058">:=</span>&nbsp;<span class="ident" id="6047061">val</span><span class="op" id="6047064">.</span><span class="ident" id="6047065">Kind</span><span class="op" id="6047069">(</span><span class="op" id="6047070">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6047073">typ</span>&nbsp;<span class="op" id="6047077">:=</span>&nbsp;<span class="ident" id="6047080">val</span><span class="op" id="6047083">.</span><span class="ident" id="6047084">Type</span><span class="op" id="6047088">(</span><span class="op" id="6047089">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6047093">//&nbsp;Check&nbsp;for&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047118">if</span>&nbsp;<span class="ident" id="6047121">val</span><span class="op" id="6047124">.</span><span class="ident" id="6047125">CanInterface</span><span class="op" id="6047137">(</span><span class="op" id="6047138">)</span>&nbsp;<span class="op" id="6047140">&amp;&amp;</span>&nbsp;<span class="ident" id="6047143">typ</span><span class="op" id="6047146">.</span><span class="ident" id="6047147">Implements</span><span class="op" id="6047157">(</span><span class="ident" id="6047158">marshalerType</span><span class="op" id="6047171">)</span>&nbsp;<span class="op" id="6047173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047177">return</span>&nbsp;<span class="ident" id="6047184">p</span><span class="op" id="6047185">.</span><span class="ident" id="6047186">marshalInterface</span><span class="op" id="6047202">(</span><span class="ident" id="6047203">val</span><span class="op" id="6047206">.</span><span class="ident" id="6047207">Interface</span><span class="op" id="6047216">(</span><span class="op" id="6047217">)</span><span class="op" id="6047218">.</span><span class="op" id="6047219">(</span><span class="ident" id="6047220">Marshaler</span><span class="op" id="6047229">)</span><span class="op" id="6047230">,</span>&nbsp;<span class="ident" id="6047232">defaultStart</span><span class="op" id="6047244">(</span><span class="ident" id="6047245">typ</span><span class="op" id="6047248">,</span>&nbsp;<span class="ident" id="6047250">finfo</span><span class="op" id="6047255">,</span>&nbsp;<span class="ident" id="6047257">startTemplate</span><span class="op" id="6047270">)</span><span class="op" id="6047271">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047277">if</span>&nbsp;<span class="ident" id="6047280">val</span><span class="op" id="6047283">.</span><span class="ident" id="6047284">CanAddr</span><span class="op" id="6047291">(</span><span class="op" id="6047292">)</span>&nbsp;<span class="op" id="6047294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6047298">pv</span>&nbsp;<span class="op" id="6047301">:=</span>&nbsp;<span class="ident" id="6047304">val</span><span class="op" id="6047307">.</span><span class="ident" id="6047308">Addr</span><span class="op" id="6047312">(</span><span class="op" id="6047313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047317">if</span>&nbsp;<span class="ident" id="6047320">pv</span><span class="op" id="6047322">.</span><span class="ident" id="6047323">CanInterface</span><span class="op" id="6047335">(</span><span class="op" id="6047336">)</span>&nbsp;<span class="op" id="6047338">&amp;&amp;</span>&nbsp;<span class="ident" id="6047341">pv</span><span class="op" id="6047343">.</span><span class="ident" id="6047344">Type</span><span class="op" id="6047348">(</span><span class="op" id="6047349">)</span><span class="op" id="6047350">.</span><span class="ident" id="6047351">Implements</span><span class="op" id="6047361">(</span><span class="ident" id="6047362">marshalerType</span><span class="op" id="6047375">)</span>&nbsp;<span class="op" id="6047377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047382">return</span>&nbsp;<span class="ident" id="6047389">p</span><span class="op" id="6047390">.</span><span class="ident" id="6047391">marshalInterface</span><span class="op" id="6047407">(</span><span class="ident" id="6047408">pv</span><span class="op" id="6047410">.</span><span class="ident" id="6047411">Interface</span><span class="op" id="6047420">(</span><span class="op" id="6047421">)</span><span class="op" id="6047422">.</span><span class="op" id="6047423">(</span><span class="ident" id="6047424">Marshaler</span><span class="op" id="6047433">)</span><span class="op" id="6047434">,</span>&nbsp;<span class="ident" id="6047436">defaultStart</span><span class="op" id="6047448">(</span><span class="ident" id="6047449">pv</span><span class="op" id="6047451">.</span><span class="ident" id="6047452">Type</span><span class="op" id="6047456">(</span><span class="op" id="6047457">)</span><span class="op" id="6047458">,</span>&nbsp;<span class="ident" id="6047460">finfo</span><span class="op" id="6047465">,</span>&nbsp;<span class="ident" id="6047467">startTemplate</span><span class="op" id="6047480">)</span><span class="op" id="6047481">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6047492">//&nbsp;Check&nbsp;for&nbsp;text&nbsp;marshaler.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047522">if</span>&nbsp;<span class="ident" id="6047525">val</span><span class="op" id="6047528">.</span><span class="ident" id="6047529">CanInterface</span><span class="op" id="6047541">(</span><span class="op" id="6047542">)</span>&nbsp;<span class="op" id="6047544">&amp;&amp;</span>&nbsp;<span class="ident" id="6047547">typ</span><span class="op" id="6047550">.</span><span class="ident" id="6047551">Implements</span><span class="op" id="6047561">(</span><span class="ident" id="6047562">textMarshalerType</span><span class="op" id="6047579">)</span>&nbsp;<span class="op" id="6047581">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047585">return</span>&nbsp;<span class="ident" id="6047592">p</span><span class="op" id="6047593">.</span><span class="ident" id="6047594">marshalTextInterface</span><span class="op" id="6047614">(</span><span class="ident" id="6047615">val</span><span class="op" id="6047618">.</span><span class="ident" id="6047619">Interface</span><span class="op" id="6047628">(</span><span class="op" id="6047629">)</span><span class="op" id="6047630">.</span><span class="op" id="6047631">(</span><span class="ident" id="6047632">encoding</span><span class="op" id="6047640">.</span><span class="ident" id="6047641">TextMarshaler</span><span class="op" id="6047654">)</span><span class="op" id="6047655">,</span>&nbsp;<span class="ident" id="6047657">defaultStart</span><span class="op" id="6047669">(</span><span class="ident" id="6047670">typ</span><span class="op" id="6047673">,</span>&nbsp;<span class="ident" id="6047675">finfo</span><span class="op" id="6047680">,</span>&nbsp;<span class="ident" id="6047682">startTemplate</span><span class="op" id="6047695">)</span><span class="op" id="6047696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047702">if</span>&nbsp;<span class="ident" id="6047705">val</span><span class="op" id="6047708">.</span><span class="ident" id="6047709">CanAddr</span><span class="op" id="6047716">(</span><span class="op" id="6047717">)</span>&nbsp;<span class="op" id="6047719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6047723">pv</span>&nbsp;<span class="op" id="6047726">:=</span>&nbsp;<span class="ident" id="6047729">val</span><span class="op" id="6047732">.</span><span class="ident" id="6047733">Addr</span><span class="op" id="6047737">(</span><span class="op" id="6047738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047742">if</span>&nbsp;<span class="ident" id="6047745">pv</span><span class="op" id="6047747">.</span><span class="ident" id="6047748">CanInterface</span><span class="op" id="6047760">(</span><span class="op" id="6047761">)</span>&nbsp;<span class="op" id="6047763">&amp;&amp;</span>&nbsp;<span class="ident" id="6047766">pv</span><span class="op" id="6047768">.</span><span class="ident" id="6047769">Type</span><span class="op" id="6047773">(</span><span class="op" id="6047774">)</span><span class="op" id="6047775">.</span><span class="ident" id="6047776">Implements</span><span class="op" id="6047786">(</span><span class="ident" id="6047787">textMarshalerType</span><span class="op" id="6047804">)</span>&nbsp;<span class="op" id="6047806">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6047811">return</span>&nbsp;<span class="ident" id="6047818">p</span><span class="op" id="6047819">.</span><span class="ident" id="6047820">marshalTextInterface</span><span class="op" id="6047840">(</span><span class="ident" id="6047841">pv</span><span class="op" id="6047843">.</span><span class="ident" id="6047844">Interface</span><span class="op" id="6047853">(</span><span class="op" id="6047854">)</span><span class="op" id="6047855">.</span><span class="op" id="6047856">(</span><span class="ident" id="6047857">encoding</span><span class="op" id="6047865">.</span><span class="ident" id="6047866">TextMarshaler</span><span class="op" id="6047879">)</span><span class="op" id="6047880">,</span>&nbsp;<span class="ident" id="6047882">defaultStart</span><span class="op" id="6047894">(</span><span class="ident" id="6047895">pv</span><span class="op" id="6047897">.</span><span class="ident" id="6047898">Type</span><span class="op" id="6047902">(</span><span class="op" id="6047903">)</span><span class="op" id="6047904">,</span>&nbsp;<span class="ident" id="6047906">finfo</span><span class="op" id="6047911">,</span>&nbsp;<span class="ident" id="6047913">startTemplate</span><span class="op" id="6047926">)</span><span class="op" id="6047927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6047934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6047938">//&nbsp;Slices&nbsp;and&nbsp;arrays&nbsp;iterate&nbsp;over&nbsp;the&nbsp;elements.&nbsp;They&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;enclosing&nbsp;tag.</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048022">if</span>&nbsp;<span class="op" id="6048025">(</span><span class="ident" id="6048026">kind</span>&nbsp;<span class="op" id="6048031">==</span>&nbsp;<span class="ident" id="6048034">reflect</span><span class="op" id="6048041">.</span><span class="ident" id="6048042">Slice</span>&nbsp;<span class="op" id="6048048">||</span>&nbsp;<span class="ident" id="6048051">kind</span>&nbsp;<span class="op" id="6048056">==</span>&nbsp;<span class="ident" id="6048059">reflect</span><span class="op" id="6048066">.</span><span class="ident" id="6048067">Array</span><span class="op" id="6048072">)</span>&nbsp;<span class="op" id="6048074">&amp;&amp;</span>&nbsp;<span class="ident" id="6048077">typ</span><span class="op" id="6048080">.</span><span class="ident" id="6048081">Elem</span><span class="op" id="6048085">(</span><span class="op" id="6048086">)</span><span class="op" id="6048087">.</span><span class="ident" id="6048088">Kind</span><span class="op" id="6048092">(</span><span class="op" id="6048093">)</span>&nbsp;<span class="op" id="6048095">!=</span>&nbsp;<span class="ident" id="6048098">reflect</span><span class="op" id="6048105">.</span><span class="ident" id="6048106">Uint8</span>&nbsp;<span class="op" id="6048112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048116">for</span>&nbsp;<span class="ident" id="6048120">i</span><span class="op" id="6048121">,</span>&nbsp;<span class="ident" id="6048123">n</span>&nbsp;<span class="op" id="6048125">:=</span>&nbsp;<span class="num" id="6048128">0</span><span class="op" id="6048129">,</span>&nbsp;<span class="ident" id="6048131">val</span><span class="op" id="6048134">.</span><span class="ident" id="6048135">Len</span><span class="op" id="6048138">(</span><span class="op" id="6048139">)</span><span class="op" id="6048140">;</span>&nbsp;<span class="ident" id="6048142">i</span>&nbsp;<span class="op" id="6048144">&lt;</span>&nbsp;<span class="ident" id="6048146">n</span><span class="op" id="6048147">;</span>&nbsp;<span class="ident" id="6048149">i</span><span class="op" id="6048150">++</span>&nbsp;<span class="op" id="6048153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048158">if</span>&nbsp;<span class="ident" id="6048161">err</span>&nbsp;<span class="op" id="6048165">:=</span>&nbsp;<span class="ident" id="6048168">p</span><span class="op" id="6048169">.</span><span class="ident" id="6048170">marshalValue</span><span class="op" id="6048182">(</span><span class="ident" id="6048183">val</span><span class="op" id="6048186">.</span><span class="ident" id="6048187">Index</span><span class="op" id="6048192">(</span><span class="ident" id="6048193">i</span><span class="op" id="6048194">)</span><span class="op" id="6048195">,</span>&nbsp;<span class="ident" id="6048197">finfo</span><span class="op" id="6048202">,</span>&nbsp;<span class="ident" id="6048204">startTemplate</span><span class="op" id="6048217">)</span><span class="op" id="6048218">;</span>&nbsp;<span class="ident" id="6048220">err</span>&nbsp;<span class="op" id="6048224">!=</span>&nbsp;<span class="ident" id="6048227">nil</span>&nbsp;<span class="op" id="6048231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048237">return</span>&nbsp;<span class="ident" id="6048244">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048251">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048259">return</span>&nbsp;<span class="ident" id="6048266">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048275">tinfo</span><span class="op" id="6048280">,</span>&nbsp;<span class="ident" id="6048282">err</span>&nbsp;<span class="op" id="6048286">:=</span>&nbsp;<span class="ident" id="6048289">getTypeInfo</span><span class="op" id="6048300">(</span><span class="ident" id="6048301">typ</span><span class="op" id="6048304">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048307">if</span>&nbsp;<span class="ident" id="6048310">err</span>&nbsp;<span class="op" id="6048314">!=</span>&nbsp;<span class="ident" id="6048317">nil</span>&nbsp;<span class="op" id="6048321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048325">return</span>&nbsp;<span class="ident" id="6048332">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048341">//&nbsp;Create&nbsp;start&nbsp;element.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048367">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048411">//&nbsp;0.&nbsp;startTemplate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048432">//&nbsp;1.&nbsp;XMLName&nbsp;field&nbsp;in&nbsp;underlying&nbsp;struct;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048475">//&nbsp;2.&nbsp;field&nbsp;name/tag&nbsp;in&nbsp;the&nbsp;struct&nbsp;field;&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6048522">//&nbsp;3.&nbsp;type&nbsp;name</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048539">var</span>&nbsp;<span class="ident" id="6048543">start</span>&nbsp;<span class="ident" id="6048549">StartElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048564">if</span>&nbsp;<span class="ident" id="6048567">startTemplate</span>&nbsp;<span class="op" id="6048581">!=</span>&nbsp;<span class="ident" id="6048584">nil</span>&nbsp;<span class="op" id="6048588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048592">start</span><span class="op" id="6048597">.</span><span class="ident" id="6048598">Name</span>&nbsp;<span class="op" id="6048603">=</span>&nbsp;<span class="ident" id="6048605">startTemplate</span><span class="op" id="6048618">.</span><span class="ident" id="6048619">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048626">start</span><span class="op" id="6048631">.</span><span class="ident" id="6048632">Attr</span>&nbsp;<span class="op" id="6048637">=</span>&nbsp;<span class="builtinfunc" id="6048639">append</span><span class="op" id="6048645">(</span><span class="ident" id="6048646">start</span><span class="op" id="6048651">.</span><span class="ident" id="6048652">Attr</span><span class="op" id="6048656">,</span>&nbsp;<span class="ident" id="6048658">startTemplate</span><span class="op" id="6048671">.</span><span class="ident" id="6048672">Attr</span><span class="op" id="6048676">...</span><span class="op" id="6048679">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048682">}</span>&nbsp;<span class="keyword" id="6048684">else</span>&nbsp;<span class="keyword" id="6048689">if</span>&nbsp;<span class="ident" id="6048692">tinfo</span><span class="op" id="6048697">.</span><span class="ident" id="6048698">xmlname</span>&nbsp;<span class="op" id="6048706">!=</span>&nbsp;<span class="ident" id="6048709">nil</span>&nbsp;<span class="op" id="6048713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048717">xmlname</span>&nbsp;<span class="op" id="6048725">:=</span>&nbsp;<span class="ident" id="6048728">tinfo</span><span class="op" id="6048733">.</span><span class="ident" id="6048734">xmlname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048744">if</span>&nbsp;<span class="ident" id="6048747">xmlname</span><span class="op" id="6048754">.</span><span class="ident" id="6048755">name</span>&nbsp;<span class="op" id="6048760">!=</span>&nbsp;<span class="string" id="6048763">&#34;&#34;</span>&nbsp;<span class="op" id="6048766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048771">start</span><span class="op" id="6048776">.</span><span class="ident" id="6048777">Name</span><span class="op" id="6048781">.</span><span class="ident" id="6048782">Space</span><span class="op" id="6048787">,</span>&nbsp;<span class="ident" id="6048789">start</span><span class="op" id="6048794">.</span><span class="ident" id="6048795">Name</span><span class="op" id="6048799">.</span><span class="ident" id="6048800">Local</span>&nbsp;<span class="op" id="6048806">=</span>&nbsp;<span class="ident" id="6048808">xmlname</span><span class="op" id="6048815">.</span><span class="ident" id="6048816">xmlns</span><span class="op" id="6048821">,</span>&nbsp;<span class="ident" id="6048823">xmlname</span><span class="op" id="6048830">.</span><span class="ident" id="6048831">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048838">}</span>&nbsp;<span class="keyword" id="6048840">else</span>&nbsp;<span class="keyword" id="6048845">if</span>&nbsp;<span class="ident" id="6048848">v</span><span class="op" id="6048849">,</span>&nbsp;<span class="ident" id="6048851">ok</span>&nbsp;<span class="op" id="6048854">:=</span>&nbsp;<span class="ident" id="6048857">xmlname</span><span class="op" id="6048864">.</span><span class="ident" id="6048865">value</span><span class="op" id="6048870">(</span><span class="ident" id="6048871">val</span><span class="op" id="6048874">)</span><span class="op" id="6048875">.</span><span class="ident" id="6048876">Interface</span><span class="op" id="6048885">(</span><span class="op" id="6048886">)</span><span class="op" id="6048887">.</span><span class="op" id="6048888">(</span><span class="ident" id="6048889">Name</span><span class="op" id="6048893">)</span><span class="op" id="6048894">;</span>&nbsp;<span class="ident" id="6048896">ok</span>&nbsp;<span class="op" id="6048899">&amp;&amp;</span>&nbsp;<span class="ident" id="6048902">v</span><span class="op" id="6048903">.</span><span class="ident" id="6048904">Local</span>&nbsp;<span class="op" id="6048910">!=</span>&nbsp;<span class="string" id="6048913">&#34;&#34;</span>&nbsp;<span class="op" id="6048916">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048921">start</span><span class="op" id="6048926">.</span><span class="ident" id="6048927">Name</span>&nbsp;<span class="op" id="6048932">=</span>&nbsp;<span class="ident" id="6048934">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6048941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6048944">if</span>&nbsp;<span class="ident" id="6048947">start</span><span class="op" id="6048952">.</span><span class="ident" id="6048953">Name</span><span class="op" id="6048957">.</span><span class="ident" id="6048958">Local</span>&nbsp;<span class="op" id="6048964">==</span>&nbsp;<span class="string" id="6048967">&#34;&#34;</span>&nbsp;<span class="op" id="6048970">&amp;&amp;</span>&nbsp;<span class="ident" id="6048973">finfo</span>&nbsp;<span class="op" id="6048979">!=</span>&nbsp;<span class="ident" id="6048982">nil</span>&nbsp;<span class="op" id="6048986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6048990">start</span><span class="op" id="6048995">.</span><span class="ident" id="6048996">Name</span><span class="op" id="6049000">.</span><span class="ident" id="6049001">Space</span><span class="op" id="6049006">,</span>&nbsp;<span class="ident" id="6049008">start</span><span class="op" id="6049013">.</span><span class="ident" id="6049014">Name</span><span class="op" id="6049018">.</span><span class="ident" id="6049019">Local</span>&nbsp;<span class="op" id="6049025">=</span>&nbsp;<span class="ident" id="6049027">finfo</span><span class="op" id="6049032">.</span><span class="ident" id="6049033">xmlns</span><span class="op" id="6049038">,</span>&nbsp;<span class="ident" id="6049040">finfo</span><span class="op" id="6049045">.</span><span class="ident" id="6049046">name</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049055">if</span>&nbsp;<span class="ident" id="6049058">start</span><span class="op" id="6049063">.</span><span class="ident" id="6049064">Name</span><span class="op" id="6049068">.</span><span class="ident" id="6049069">Local</span>&nbsp;<span class="op" id="6049075">==</span>&nbsp;<span class="string" id="6049078">&#34;&#34;</span>&nbsp;<span class="op" id="6049081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049085">name</span>&nbsp;<span class="op" id="6049090">:=</span>&nbsp;<span class="ident" id="6049093">typ</span><span class="op" id="6049096">.</span><span class="ident" id="6049097">Name</span><span class="op" id="6049101">(</span><span class="op" id="6049102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049106">if</span>&nbsp;<span class="ident" id="6049109">name</span>&nbsp;<span class="op" id="6049114">==</span>&nbsp;<span class="string" id="6049117">&#34;&#34;</span>&nbsp;<span class="op" id="6049120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049125">return</span>&nbsp;<span class="op" id="6049132">&amp;</span><span class="ident" id="6049133">UnsupportedTypeError</span><span class="op" id="6049153">{</span><span class="ident" id="6049154">typ</span><span class="op" id="6049157">}</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049165">start</span><span class="op" id="6049170">.</span><span class="ident" id="6049171">Name</span><span class="op" id="6049175">.</span><span class="ident" id="6049176">Local</span>&nbsp;<span class="op" id="6049182">=</span>&nbsp;<span class="ident" id="6049184">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6049194">//&nbsp;Attributes</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049209">for</span>&nbsp;<span class="ident" id="6049213">i</span>&nbsp;<span class="op" id="6049215">:=</span>&nbsp;<span class="keyword" id="6049218">range</span>&nbsp;<span class="ident" id="6049224">tinfo</span><span class="op" id="6049229">.</span><span class="ident" id="6049230">fields</span>&nbsp;<span class="op" id="6049237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049241">finfo</span>&nbsp;<span class="op" id="6049247">:=</span>&nbsp;<span class="op" id="6049250">&amp;</span><span class="ident" id="6049251">tinfo</span><span class="op" id="6049256">.</span><span class="ident" id="6049257">fields</span><span class="op" id="6049263">[</span><span class="ident" id="6049264">i</span><span class="op" id="6049265">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049269">if</span>&nbsp;<span class="ident" id="6049272">finfo</span><span class="op" id="6049277">.</span><span class="ident" id="6049278">flags</span><span class="op" id="6049283">&amp;</span><span class="ident" id="6049284">fAttr</span>&nbsp;<span class="op" id="6049290">==</span>&nbsp;<span class="num" id="6049293">0</span>&nbsp;<span class="op" id="6049295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049300">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049311">}</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049315">fv</span>&nbsp;<span class="op" id="6049318">:=</span>&nbsp;<span class="ident" id="6049321">finfo</span><span class="op" id="6049326">.</span><span class="ident" id="6049327">value</span><span class="op" id="6049332">(</span><span class="ident" id="6049333">val</span><span class="op" id="6049336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049340">name</span>&nbsp;<span class="op" id="6049345">:=</span>&nbsp;<span class="ident" id="6049348">Name</span><span class="op" id="6049352">{</span><span class="ident" id="6049353">Space</span><span class="op" id="6049358">:</span>&nbsp;<span class="ident" id="6049360">finfo</span><span class="op" id="6049365">.</span><span class="ident" id="6049366">xmlns</span><span class="op" id="6049371">,</span>&nbsp;<span class="ident" id="6049373">Local</span><span class="op" id="6049378">:</span>&nbsp;<span class="ident" id="6049380">finfo</span><span class="op" id="6049385">.</span><span class="ident" id="6049386">name</span><span class="op" id="6049390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049395">if</span>&nbsp;<span class="ident" id="6049398">finfo</span><span class="op" id="6049403">.</span><span class="ident" id="6049404">flags</span><span class="op" id="6049409">&amp;</span><span class="ident" id="6049410">fOmitEmpty</span>&nbsp;<span class="op" id="6049421">!=</span>&nbsp;<span class="num" id="6049424">0</span>&nbsp;<span class="op" id="6049426">&amp;&amp;</span>&nbsp;<span class="ident" id="6049429">isEmptyValue</span><span class="op" id="6049441">(</span><span class="ident" id="6049442">fv</span><span class="op" id="6049444">)</span>&nbsp;<span class="op" id="6049446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049451">continue</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049467">if</span>&nbsp;<span class="ident" id="6049470">fv</span><span class="op" id="6049472">.</span><span class="ident" id="6049473">Kind</span><span class="op" id="6049477">(</span><span class="op" id="6049478">)</span>&nbsp;<span class="op" id="6049480">==</span>&nbsp;<span class="ident" id="6049483">reflect</span><span class="op" id="6049490">.</span><span class="ident" id="6049491">Interface</span>&nbsp;<span class="op" id="6049501">&amp;&amp;</span>&nbsp;<span class="ident" id="6049504">fv</span><span class="op" id="6049506">.</span><span class="ident" id="6049507">IsNil</span><span class="op" id="6049512">(</span><span class="op" id="6049513">)</span>&nbsp;<span class="op" id="6049515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049520">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049531">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049536">if</span>&nbsp;<span class="ident" id="6049539">fv</span><span class="op" id="6049541">.</span><span class="ident" id="6049542">CanInterface</span><span class="op" id="6049554">(</span><span class="op" id="6049555">)</span>&nbsp;<span class="op" id="6049557">&amp;&amp;</span>&nbsp;<span class="ident" id="6049560">fv</span><span class="op" id="6049562">.</span><span class="ident" id="6049563">Type</span><span class="op" id="6049567">(</span><span class="op" id="6049568">)</span><span class="op" id="6049569">.</span><span class="ident" id="6049570">Implements</span><span class="op" id="6049580">(</span><span class="ident" id="6049581">marshalerAttrType</span><span class="op" id="6049598">)</span>&nbsp;<span class="op" id="6049600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049605">attr</span><span class="op" id="6049609">,</span>&nbsp;<span class="ident" id="6049611">err</span>&nbsp;<span class="op" id="6049615">:=</span>&nbsp;<span class="ident" id="6049618">fv</span><span class="op" id="6049620">.</span><span class="ident" id="6049621">Interface</span><span class="op" id="6049630">(</span><span class="op" id="6049631">)</span><span class="op" id="6049632">.</span><span class="op" id="6049633">(</span><span class="ident" id="6049634">MarshalerAttr</span><span class="op" id="6049647">)</span><span class="op" id="6049648">.</span><span class="ident" id="6049649">MarshalXMLAttr</span><span class="op" id="6049663">(</span><span class="ident" id="6049664">name</span><span class="op" id="6049668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049673">if</span>&nbsp;<span class="ident" id="6049676">err</span>&nbsp;<span class="op" id="6049680">!=</span>&nbsp;<span class="ident" id="6049683">nil</span>&nbsp;<span class="op" id="6049687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049693">return</span>&nbsp;<span class="ident" id="6049700">err</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049712">if</span>&nbsp;<span class="ident" id="6049715">attr</span><span class="op" id="6049719">.</span><span class="ident" id="6049720">Name</span><span class="op" id="6049724">.</span><span class="ident" id="6049725">Local</span>&nbsp;<span class="op" id="6049731">!=</span>&nbsp;<span class="string" id="6049734">&#34;&#34;</span>&nbsp;<span class="op" id="6049737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049743">start</span><span class="op" id="6049748">.</span><span class="ident" id="6049749">Attr</span>&nbsp;<span class="op" id="6049754">=</span>&nbsp;<span class="builtinfunc" id="6049756">append</span><span class="op" id="6049762">(</span><span class="ident" id="6049763">start</span><span class="op" id="6049768">.</span><span class="ident" id="6049769">Attr</span><span class="op" id="6049773">,</span>&nbsp;<span class="ident" id="6049775">attr</span><span class="op" id="6049779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049789">continue</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6049800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049805">if</span>&nbsp;<span class="ident" id="6049808">fv</span><span class="op" id="6049810">.</span><span class="ident" id="6049811">CanAddr</span><span class="op" id="6049818">(</span><span class="op" id="6049819">)</span>&nbsp;<span class="op" id="6049821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049826">pv</span>&nbsp;<span class="op" id="6049829">:=</span>&nbsp;<span class="ident" id="6049832">fv</span><span class="op" id="6049834">.</span><span class="ident" id="6049835">Addr</span><span class="op" id="6049839">(</span><span class="op" id="6049840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049845">if</span>&nbsp;<span class="ident" id="6049848">pv</span><span class="op" id="6049850">.</span><span class="ident" id="6049851">CanInterface</span><span class="op" id="6049863">(</span><span class="op" id="6049864">)</span>&nbsp;<span class="op" id="6049866">&amp;&amp;</span>&nbsp;<span class="ident" id="6049869">pv</span><span class="op" id="6049871">.</span><span class="ident" id="6049872">Type</span><span class="op" id="6049876">(</span><span class="op" id="6049877">)</span><span class="op" id="6049878">.</span><span class="ident" id="6049879">Implements</span><span class="op" id="6049889">(</span><span class="ident" id="6049890">marshalerAttrType</span><span class="op" id="6049907">)</span>&nbsp;<span class="op" id="6049909">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6049915">attr</span><span class="op" id="6049919">,</span>&nbsp;<span class="ident" id="6049921">err</span>&nbsp;<span class="op" id="6049925">:=</span>&nbsp;<span class="ident" id="6049928">pv</span><span class="op" id="6049930">.</span><span class="ident" id="6049931">Interface</span><span class="op" id="6049940">(</span><span class="op" id="6049941">)</span><span class="op" id="6049942">.</span><span class="op" id="6049943">(</span><span class="ident" id="6049944">MarshalerAttr</span><span class="op" id="6049957">)</span><span class="op" id="6049958">.</span><span class="ident" id="6049959">MarshalXMLAttr</span><span class="op" id="6049973">(</span><span class="ident" id="6049974">name</span><span class="op" id="6049978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6049984">if</span>&nbsp;<span class="ident" id="6049987">err</span>&nbsp;<span class="op" id="6049991">!=</span>&nbsp;<span class="ident" id="6049994">nil</span>&nbsp;<span class="op" id="6049998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050005">return</span>&nbsp;<span class="ident" id="6050012">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050026">if</span>&nbsp;<span class="ident" id="6050029">attr</span><span class="op" id="6050033">.</span><span class="ident" id="6050034">Name</span><span class="op" id="6050038">.</span><span class="ident" id="6050039">Local</span>&nbsp;<span class="op" id="6050045">!=</span>&nbsp;<span class="string" id="6050048">&#34;&#34;</span>&nbsp;<span class="op" id="6050051">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050058">start</span><span class="op" id="6050063">.</span><span class="ident" id="6050064">Attr</span>&nbsp;<span class="op" id="6050069">=</span>&nbsp;<span class="builtinfunc" id="6050071">append</span><span class="op" id="6050077">(</span><span class="ident" id="6050078">start</span><span class="op" id="6050083">.</span><span class="ident" id="6050084">Attr</span><span class="op" id="6050088">,</span>&nbsp;<span class="ident" id="6050090">attr</span><span class="op" id="6050094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050106">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050122">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050127">if</span>&nbsp;<span class="ident" id="6050130">fv</span><span class="op" id="6050132">.</span><span class="ident" id="6050133">CanInterface</span><span class="op" id="6050145">(</span><span class="op" id="6050146">)</span>&nbsp;<span class="op" id="6050148">&amp;&amp;</span>&nbsp;<span class="ident" id="6050151">fv</span><span class="op" id="6050153">.</span><span class="ident" id="6050154">Type</span><span class="op" id="6050158">(</span><span class="op" id="6050159">)</span><span class="op" id="6050160">.</span><span class="ident" id="6050161">Implements</span><span class="op" id="6050171">(</span><span class="ident" id="6050172">textMarshalerType</span><span class="op" id="6050189">)</span>&nbsp;<span class="op" id="6050191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050196">text</span><span class="op" id="6050200">,</span>&nbsp;<span class="ident" id="6050202">err</span>&nbsp;<span class="op" id="6050206">:=</span>&nbsp;<span class="ident" id="6050209">fv</span><span class="op" id="6050211">.</span><span class="ident" id="6050212">Interface</span><span class="op" id="6050221">(</span><span class="op" id="6050222">)</span><span class="op" id="6050223">.</span><span class="op" id="6050224">(</span><span class="ident" id="6050225">encoding</span><span class="op" id="6050233">.</span><span class="ident" id="6050234">TextMarshaler</span><span class="op" id="6050247">)</span><span class="op" id="6050248">.</span><span class="ident" id="6050249">MarshalText</span><span class="op" id="6050260">(</span><span class="op" id="6050261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050266">if</span>&nbsp;<span class="ident" id="6050269">err</span>&nbsp;<span class="op" id="6050273">!=</span>&nbsp;<span class="ident" id="6050276">nil</span>&nbsp;<span class="op" id="6050280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050286">return</span>&nbsp;<span class="ident" id="6050293">err</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050305">start</span><span class="op" id="6050310">.</span><span class="ident" id="6050311">Attr</span>&nbsp;<span class="op" id="6050316">=</span>&nbsp;<span class="builtinfunc" id="6050318">append</span><span class="op" id="6050324">(</span><span class="ident" id="6050325">start</span><span class="op" id="6050330">.</span><span class="ident" id="6050331">Attr</span><span class="op" id="6050335">,</span>&nbsp;<span class="ident" id="6050337">Attr</span><span class="op" id="6050341">{</span><span class="ident" id="6050342">name</span><span class="op" id="6050346">,</span>&nbsp;<span class="builtintype" id="6050348">string</span><span class="op" id="6050354">(</span><span class="ident" id="6050355">text</span><span class="op" id="6050359">)</span><span class="op" id="6050360">}</span><span class="op" id="6050361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050366">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050382">if</span>&nbsp;<span class="ident" id="6050385">fv</span><span class="op" id="6050387">.</span><span class="ident" id="6050388">CanAddr</span><span class="op" id="6050395">(</span><span class="op" id="6050396">)</span>&nbsp;<span class="op" id="6050398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050403">pv</span>&nbsp;<span class="op" id="6050406">:=</span>&nbsp;<span class="ident" id="6050409">fv</span><span class="op" id="6050411">.</span><span class="ident" id="6050412">Addr</span><span class="op" id="6050416">(</span><span class="op" id="6050417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050422">if</span>&nbsp;<span class="ident" id="6050425">pv</span><span class="op" id="6050427">.</span><span class="ident" id="6050428">CanInterface</span><span class="op" id="6050440">(</span><span class="op" id="6050441">)</span>&nbsp;<span class="op" id="6050443">&amp;&amp;</span>&nbsp;<span class="ident" id="6050446">pv</span><span class="op" id="6050448">.</span><span class="ident" id="6050449">Type</span><span class="op" id="6050453">(</span><span class="op" id="6050454">)</span><span class="op" id="6050455">.</span><span class="ident" id="6050456">Implements</span><span class="op" id="6050466">(</span><span class="ident" id="6050467">textMarshalerType</span><span class="op" id="6050484">)</span>&nbsp;<span class="op" id="6050486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050492">text</span><span class="op" id="6050496">,</span>&nbsp;<span class="ident" id="6050498">err</span>&nbsp;<span class="op" id="6050502">:=</span>&nbsp;<span class="ident" id="6050505">pv</span><span class="op" id="6050507">.</span><span class="ident" id="6050508">Interface</span><span class="op" id="6050517">(</span><span class="op" id="6050518">)</span><span class="op" id="6050519">.</span><span class="op" id="6050520">(</span><span class="ident" id="6050521">encoding</span><span class="op" id="6050529">.</span><span class="ident" id="6050530">TextMarshaler</span><span class="op" id="6050543">)</span><span class="op" id="6050544">.</span><span class="ident" id="6050545">MarshalText</span><span class="op" id="6050556">(</span><span class="op" id="6050557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050563">if</span>&nbsp;<span class="ident" id="6050566">err</span>&nbsp;<span class="op" id="6050570">!=</span>&nbsp;<span class="ident" id="6050573">nil</span>&nbsp;<span class="op" id="6050577">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050584">return</span>&nbsp;<span class="ident" id="6050591">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050605">start</span><span class="op" id="6050610">.</span><span class="ident" id="6050611">Attr</span>&nbsp;<span class="op" id="6050616">=</span>&nbsp;<span class="builtinfunc" id="6050618">append</span><span class="op" id="6050624">(</span><span class="ident" id="6050625">start</span><span class="op" id="6050630">.</span><span class="ident" id="6050631">Attr</span><span class="op" id="6050635">,</span>&nbsp;<span class="ident" id="6050637">Attr</span><span class="op" id="6050641">{</span><span class="ident" id="6050642">name</span><span class="op" id="6050646">,</span>&nbsp;<span class="builtintype" id="6050648">string</span><span class="op" id="6050654">(</span><span class="ident" id="6050655">text</span><span class="op" id="6050659">)</span><span class="op" id="6050660">}</span><span class="op" id="6050661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050667">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050679">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6050688">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050744">switch</span>&nbsp;<span class="ident" id="6050751">fv</span><span class="op" id="6050753">.</span><span class="ident" id="6050754">Kind</span><span class="op" id="6050758">(</span><span class="op" id="6050759">)</span>&nbsp;<span class="op" id="6050761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050765">case</span>&nbsp;<span class="ident" id="6050770">reflect</span><span class="op" id="6050777">.</span><span class="ident" id="6050778">Ptr</span><span class="op" id="6050781">,</span>&nbsp;<span class="ident" id="6050783">reflect</span><span class="op" id="6050790">.</span><span class="ident" id="6050791">Interface</span><span class="op" id="6050800">:</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050805">if</span>&nbsp;<span class="ident" id="6050808">fv</span><span class="op" id="6050810">.</span><span class="ident" id="6050811">IsNil</span><span class="op" id="6050816">(</span><span class="op" id="6050817">)</span>&nbsp;<span class="op" id="6050819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050825">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050842">fv</span>&nbsp;<span class="op" id="6050845">=</span>&nbsp;<span class="ident" id="6050847">fv</span><span class="op" id="6050849">.</span><span class="ident" id="6050850">Elem</span><span class="op" id="6050854">(</span><span class="op" id="6050855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050859">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050864">s</span><span class="op" id="6050865">,</span>&nbsp;<span class="ident" id="6050867">b</span><span class="op" id="6050868">,</span>&nbsp;<span class="ident" id="6050870">err</span>&nbsp;<span class="op" id="6050874">:=</span>&nbsp;<span class="ident" id="6050877">p</span><span class="op" id="6050878">.</span><span class="ident" id="6050879">marshalSimple</span><span class="op" id="6050892">(</span><span class="ident" id="6050893">fv</span><span class="op" id="6050895">.</span><span class="ident" id="6050896">Type</span><span class="op" id="6050900">(</span><span class="op" id="6050901">)</span><span class="op" id="6050902">,</span>&nbsp;<span class="ident" id="6050904">fv</span><span class="op" id="6050906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050910">if</span>&nbsp;<span class="ident" id="6050913">err</span>&nbsp;<span class="op" id="6050917">!=</span>&nbsp;<span class="ident" id="6050920">nil</span>&nbsp;<span class="op" id="6050924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050929">return</span>&nbsp;<span class="ident" id="6050936">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050942">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6050946">if</span>&nbsp;<span class="ident" id="6050949">b</span>&nbsp;<span class="op" id="6050951">!=</span>&nbsp;<span class="ident" id="6050954">nil</span>&nbsp;<span class="op" id="6050958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050963">s</span>&nbsp;<span class="op" id="6050965">=</span>&nbsp;<span class="builtintype" id="6050967">string</span><span class="op" id="6050973">(</span><span class="ident" id="6050974">b</span><span class="op" id="6050975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6050979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6050983">start</span><span class="op" id="6050988">.</span><span class="ident" id="6050989">Attr</span>&nbsp;<span class="op" id="6050994">=</span>&nbsp;<span class="builtinfunc" id="6050996">append</span><span class="op" id="6051002">(</span><span class="ident" id="6051003">start</span><span class="op" id="6051008">.</span><span class="ident" id="6051009">Attr</span><span class="op" id="6051013">,</span>&nbsp;<span class="ident" id="6051015">Attr</span><span class="op" id="6051019">{</span><span class="ident" id="6051020">name</span><span class="op" id="6051024">,</span>&nbsp;<span class="ident" id="6051026">s</span><span class="op" id="6051027">}</span><span class="op" id="6051028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051031">}</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051035">if</span>&nbsp;<span class="ident" id="6051038">err</span>&nbsp;<span class="op" id="6051042">:=</span>&nbsp;<span class="ident" id="6051045">p</span><span class="op" id="6051046">.</span><span class="ident" id="6051047">writeStart</span><span class="op" id="6051057">(</span><span class="op" id="6051058">&amp;</span><span class="ident" id="6051059">start</span><span class="op" id="6051064">)</span><span class="op" id="6051065">;</span>&nbsp;<span class="ident" id="6051067">err</span>&nbsp;<span class="op" id="6051071">!=</span>&nbsp;<span class="ident" id="6051074">nil</span>&nbsp;<span class="op" id="6051078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051082">return</span>&nbsp;<span class="ident" id="6051089">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051098">if</span>&nbsp;<span class="ident" id="6051101">val</span><span class="op" id="6051104">.</span><span class="ident" id="6051105">Kind</span><span class="op" id="6051109">(</span><span class="op" id="6051110">)</span>&nbsp;<span class="op" id="6051112">==</span>&nbsp;<span class="ident" id="6051115">reflect</span><span class="op" id="6051122">.</span><span class="ident" id="6051123">Struct</span>&nbsp;<span class="op" id="6051130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051134">err</span>&nbsp;<span class="op" id="6051138">=</span>&nbsp;<span class="ident" id="6051140">p</span><span class="op" id="6051141">.</span><span class="ident" id="6051142">marshalStruct</span><span class="op" id="6051155">(</span><span class="ident" id="6051156">tinfo</span><span class="op" id="6051161">,</span>&nbsp;<span class="ident" id="6051163">val</span><span class="op" id="6051166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051169">}</span>&nbsp;<span class="keyword" id="6051171">else</span>&nbsp;<span class="op" id="6051176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051180">s</span><span class="op" id="6051181">,</span>&nbsp;<span class="ident" id="6051183">b</span><span class="op" id="6051184">,</span>&nbsp;<span class="ident" id="6051186">err1</span>&nbsp;<span class="op" id="6051191">:=</span>&nbsp;<span class="ident" id="6051194">p</span><span class="op" id="6051195">.</span><span class="ident" id="6051196">marshalSimple</span><span class="op" id="6051209">(</span><span class="ident" id="6051210">typ</span><span class="op" id="6051213">,</span>&nbsp;<span class="ident" id="6051215">val</span><span class="op" id="6051218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051222">if</span>&nbsp;<span class="ident" id="6051225">err1</span>&nbsp;<span class="op" id="6051230">!=</span>&nbsp;<span class="ident" id="6051233">nil</span>&nbsp;<span class="op" id="6051237">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051242">err</span>&nbsp;<span class="op" id="6051246">=</span>&nbsp;<span class="ident" id="6051248">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051255">}</span>&nbsp;<span class="keyword" id="6051257">else</span>&nbsp;<span class="keyword" id="6051262">if</span>&nbsp;<span class="ident" id="6051265">b</span>&nbsp;<span class="op" id="6051267">!=</span>&nbsp;<span class="ident" id="6051270">nil</span>&nbsp;<span class="op" id="6051274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051279">EscapeText</span><span class="op" id="6051289">(</span><span class="ident" id="6051290">p</span><span class="op" id="6051291">,</span>&nbsp;<span class="ident" id="6051293">b</span><span class="op" id="6051294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051298">}</span>&nbsp;<span class="keyword" id="6051300">else</span>&nbsp;<span class="op" id="6051305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051310">p</span><span class="op" id="6051311">.</span><span class="ident" id="6051312">EscapeString</span><span class="op" id="6051324">(</span><span class="ident" id="6051325">s</span><span class="op" id="6051326">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051336">if</span>&nbsp;<span class="ident" id="6051339">err</span>&nbsp;<span class="op" id="6051343">!=</span>&nbsp;<span class="ident" id="6051346">nil</span>&nbsp;<span class="op" id="6051350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051354">return</span>&nbsp;<span class="ident" id="6051361">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051366">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051370">if</span>&nbsp;<span class="ident" id="6051373">err</span>&nbsp;<span class="op" id="6051377">:=</span>&nbsp;<span class="ident" id="6051380">p</span><span class="op" id="6051381">.</span><span class="ident" id="6051382">writeEnd</span><span class="op" id="6051390">(</span><span class="ident" id="6051391">start</span><span class="op" id="6051396">.</span><span class="ident" id="6051397">Name</span><span class="op" id="6051401">)</span><span class="op" id="6051402">;</span>&nbsp;<span class="ident" id="6051404">err</span>&nbsp;<span class="op" id="6051408">!=</span>&nbsp;<span class="ident" id="6051411">nil</span>&nbsp;<span class="op" id="6051415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051419">return</span>&nbsp;<span class="ident" id="6051426">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051435">return</span>&nbsp;<span class="ident" id="6051442">p</span><span class="op" id="6051443">.</span><span class="ident" id="6051444">cachedWriteError</span><span class="op" id="6051460">(</span><span class="op" id="6051461">)</span><br>
<span class="lineno"></span><span class="op" id="6051463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6051466">//&nbsp;defaultStart&nbsp;returns&nbsp;the&nbsp;default&nbsp;start&nbsp;element&nbsp;to&nbsp;use,</span><br>
<span class="lineno"></span><span class="comment" id="6051524">//&nbsp;given&nbsp;the&nbsp;reflect&nbsp;type,&nbsp;field&nbsp;info,&nbsp;and&nbsp;start&nbsp;template.</span><br>
<span class="lineno">555</span><span class="keyword" id="6051583">func</span>&nbsp;<span class="ident" id="6051588">defaultStart</span><span class="op" id="6051600">(</span><span class="ident" id="6051601">typ</span>&nbsp;<span class="ident" id="6051605">reflect</span><span class="op" id="6051612">.</span><span class="ident" id="6051613">Type</span><span class="op" id="6051617">,</span>&nbsp;<span class="ident" id="6051619">finfo</span>&nbsp;<span class="op" id="6051625">*</span><span class="ident" id="6051626">fieldInfo</span><span class="op" id="6051635">,</span>&nbsp;<span class="ident" id="6051637">startTemplate</span>&nbsp;<span class="op" id="6051651">*</span><span class="ident" id="6051652">StartElement</span><span class="op" id="6051664">)</span>&nbsp;<span class="ident" id="6051666">StartElement</span>&nbsp;<span class="op" id="6051679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051682">var</span>&nbsp;<span class="ident" id="6051686">start</span>&nbsp;<span class="ident" id="6051692">StartElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051706">//&nbsp;Precedence&nbsp;for&nbsp;the&nbsp;XML&nbsp;element&nbsp;name&nbsp;is&nbsp;as&nbsp;above,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6051759">//&nbsp;except&nbsp;that&nbsp;we&nbsp;do&nbsp;not&nbsp;look&nbsp;inside&nbsp;structs&nbsp;for&nbsp;the&nbsp;first&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6051826">if</span>&nbsp;<span class="ident" id="6051829">startTemplate</span>&nbsp;<span class="op" id="6051843">!=</span>&nbsp;<span class="ident" id="6051846">nil</span>&nbsp;<span class="op" id="6051850">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051854">start</span><span class="op" id="6051859">.</span><span class="ident" id="6051860">Name</span>&nbsp;<span class="op" id="6051865">=</span>&nbsp;<span class="ident" id="6051867">startTemplate</span><span class="op" id="6051880">.</span><span class="ident" id="6051881">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051888">start</span><span class="op" id="6051893">.</span><span class="ident" id="6051894">Attr</span>&nbsp;<span class="op" id="6051899">=</span>&nbsp;<span class="builtinfunc" id="6051901">append</span><span class="op" id="6051907">(</span><span class="ident" id="6051908">start</span><span class="op" id="6051913">.</span><span class="ident" id="6051914">Attr</span><span class="op" id="6051918">,</span>&nbsp;<span class="ident" id="6051920">startTemplate</span><span class="op" id="6051933">.</span><span class="ident" id="6051934">Attr</span><span class="op" id="6051938">...</span><span class="op" id="6051941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6051944">}</span>&nbsp;<span class="keyword" id="6051946">else</span>&nbsp;<span class="keyword" id="6051951">if</span>&nbsp;<span class="ident" id="6051954">finfo</span>&nbsp;<span class="op" id="6051960">!=</span>&nbsp;<span class="ident" id="6051963">nil</span>&nbsp;<span class="op" id="6051967">&amp;&amp;</span>&nbsp;<span class="ident" id="6051970">finfo</span><span class="op" id="6051975">.</span><span class="ident" id="6051976">name</span>&nbsp;<span class="op" id="6051981">!=</span>&nbsp;<span class="string" id="6051984">&#34;&#34;</span>&nbsp;<span class="op" id="6051987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6051991">start</span><span class="op" id="6051996">.</span><span class="ident" id="6051997">Name</span><span class="op" id="6052001">.</span><span class="ident" id="6052002">Local</span>&nbsp;<span class="op" id="6052008">=</span>&nbsp;<span class="ident" id="6052010">finfo</span><span class="op" id="6052015">.</span><span class="ident" id="6052016">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052023">start</span><span class="op" id="6052028">.</span><span class="ident" id="6052029">Name</span><span class="op" id="6052033">.</span><span class="ident" id="6052034">Space</span>&nbsp;<span class="op" id="6052040">=</span>&nbsp;<span class="ident" id="6052042">finfo</span><span class="op" id="6052047">.</span><span class="ident" id="6052048">xmlns</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052055">}</span>&nbsp;<span class="keyword" id="6052057">else</span>&nbsp;<span class="keyword" id="6052062">if</span>&nbsp;<span class="ident" id="6052065">typ</span><span class="op" id="6052068">.</span><span class="ident" id="6052069">Name</span><span class="op" id="6052073">(</span><span class="op" id="6052074">)</span>&nbsp;<span class="op" id="6052076">!=</span>&nbsp;<span class="string" id="6052079">&#34;&#34;</span>&nbsp;<span class="op" id="6052082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052086">start</span><span class="op" id="6052091">.</span><span class="ident" id="6052092">Name</span><span class="op" id="6052096">.</span><span class="ident" id="6052097">Local</span>&nbsp;<span class="op" id="6052103">=</span>&nbsp;<span class="ident" id="6052105">typ</span><span class="op" id="6052108">.</span><span class="ident" id="6052109">Name</span><span class="op" id="6052113">(</span><span class="op" id="6052114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052117">}</span>&nbsp;<span class="keyword" id="6052119">else</span>&nbsp;<span class="op" id="6052124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6052128">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;pointer&nbsp;to&nbsp;a&nbsp;named&nbsp;type,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6052168">//&nbsp;since&nbsp;it&nbsp;has&nbsp;the&nbsp;Marshaler&nbsp;methods.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052209">start</span><span class="op" id="6052214">.</span><span class="ident" id="6052215">Name</span><span class="op" id="6052219">.</span><span class="ident" id="6052220">Local</span>&nbsp;<span class="op" id="6052226">=</span>&nbsp;<span class="ident" id="6052228">typ</span><span class="op" id="6052231">.</span><span class="ident" id="6052232">Elem</span><span class="op" id="6052236">(</span><span class="op" id="6052237">)</span><span class="op" id="6052238">.</span><span class="ident" id="6052239">Name</span><span class="op" id="6052243">(</span><span class="op" id="6052244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052250">return</span>&nbsp;<span class="ident" id="6052257">start</span><br>
<span class="lineno"></span><span class="op" id="6052263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="6052266">//&nbsp;marshalInterface&nbsp;marshals&nbsp;a&nbsp;Marshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6052324">func</span>&nbsp;<span class="op" id="6052329">(</span><span class="ident" id="6052330">p</span>&nbsp;<span class="op" id="6052332">*</span><span class="ident" id="6052333">printer</span><span class="op" id="6052340">)</span>&nbsp;<span class="ident" id="6052342">marshalInterface</span><span class="op" id="6052358">(</span><span class="ident" id="6052359">val</span>&nbsp;<span class="ident" id="6052363">Marshaler</span><span class="op" id="6052372">,</span>&nbsp;<span class="ident" id="6052374">start</span>&nbsp;<span class="ident" id="6052380">StartElement</span><span class="op" id="6052392">)</span>&nbsp;<span class="builtintype" id="6052394">error</span>&nbsp;<span class="op" id="6052400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6052403">//&nbsp;Push&nbsp;a&nbsp;marker&nbsp;onto&nbsp;the&nbsp;tag&nbsp;stack&nbsp;so&nbsp;that&nbsp;MarshalXML</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6052459">//&nbsp;cannot&nbsp;close&nbsp;the&nbsp;XML&nbsp;tags&nbsp;that&nbsp;it&nbsp;did&nbsp;not&nbsp;open.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052511">p</span><span class="op" id="6052512">.</span><span class="ident" id="6052513">tags</span>&nbsp;<span class="op" id="6052518">=</span>&nbsp;<span class="builtinfunc" id="6052520">append</span><span class="op" id="6052526">(</span><span class="ident" id="6052527">p</span><span class="op" id="6052528">.</span><span class="ident" id="6052529">tags</span><span class="op" id="6052533">,</span>&nbsp;<span class="ident" id="6052535">Name</span><span class="op" id="6052539">{</span><span class="op" id="6052540">}</span><span class="op" id="6052541">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052544">n</span>&nbsp;<span class="op" id="6052546">:=</span>&nbsp;<span class="builtinfunc" id="6052549">len</span><span class="op" id="6052552">(</span><span class="ident" id="6052553">p</span><span class="op" id="6052554">.</span><span class="ident" id="6052555">tags</span><span class="op" id="6052559">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052563">err</span>&nbsp;<span class="op" id="6052567">:=</span>&nbsp;<span class="ident" id="6052570">val</span><span class="op" id="6052573">.</span><span class="ident" id="6052574">MarshalXML</span><span class="op" id="6052584">(</span><span class="ident" id="6052585">p</span><span class="op" id="6052586">.</span><span class="ident" id="6052587">encoder</span><span class="op" id="6052594">,</span>&nbsp;<span class="ident" id="6052596">start</span><span class="op" id="6052601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052604">if</span>&nbsp;<span class="ident" id="6052607">err</span>&nbsp;<span class="op" id="6052611">!=</span>&nbsp;<span class="ident" id="6052614">nil</span>&nbsp;<span class="op" id="6052618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052622">return</span>&nbsp;<span class="ident" id="6052629">err</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6052638">//&nbsp;Make&nbsp;sure&nbsp;MarshalXML&nbsp;closed&nbsp;all&nbsp;its&nbsp;tags.&nbsp;p.tags[n-1]&nbsp;is&nbsp;the&nbsp;mark.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052709">if</span>&nbsp;<span class="builtinfunc" id="6052712">len</span><span class="op" id="6052715">(</span><span class="ident" id="6052716">p</span><span class="op" id="6052717">.</span><span class="ident" id="6052718">tags</span><span class="op" id="6052722">)</span>&nbsp;<span class="op" id="6052724">&gt;</span>&nbsp;<span class="ident" id="6052726">n</span>&nbsp;<span class="op" id="6052728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052732">return</span>&nbsp;<span class="ident" id="6052739">fmt</span><span class="op" id="6052742">.</span><span class="ident" id="6052743">Errorf</span><span class="op" id="6052749">(</span><span class="string" id="6052750">&#34;xml:&nbsp;%s.MarshalXML&nbsp;wrote&nbsp;invalid&nbsp;XML:&nbsp;&lt;%s&gt;&nbsp;not&nbsp;closed&#34;</span><span class="op" id="6052805">,</span>&nbsp;<span class="ident" id="6052807">receiverType</span><span class="op" id="6052819">(</span><span class="ident" id="6052820">val</span><span class="op" id="6052823">)</span><span class="op" id="6052824">,</span>&nbsp;<span class="ident" id="6052826">p</span><span class="op" id="6052827">.</span><span class="ident" id="6052828">tags</span><span class="op" id="6052832">[</span><span class="builtinfunc" id="6052833">len</span><span class="op" id="6052836">(</span><span class="ident" id="6052837">p</span><span class="op" id="6052838">.</span><span class="ident" id="6052839">tags</span><span class="op" id="6052843">)</span><span class="op" id="6052844">-</span><span class="num" id="6052845">1</span><span class="op" id="6052846">]</span><span class="op" id="6052847">.</span><span class="ident" id="6052848">Local</span><span class="op" id="6052853">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6052856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6052859">p</span><span class="op" id="6052860">.</span><span class="ident" id="6052861">tags</span>&nbsp;<span class="op" id="6052866">=</span>&nbsp;<span class="ident" id="6052868">p</span><span class="op" id="6052869">.</span><span class="ident" id="6052870">tags</span><span class="op" id="6052874">[</span><span class="op" id="6052875">:</span><span class="ident" id="6052876">n</span><span class="op" id="6052877">-</span><span class="num" id="6052878">1</span><span class="op" id="6052879">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6052882">return</span>&nbsp;<span class="ident" id="6052889">nil</span><br>
<span class="lineno"></span><span class="op" id="6052893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="6052896">//&nbsp;marshalTextInterface&nbsp;marshals&nbsp;a&nbsp;TextMarshaler&nbsp;interface&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="6052962">func</span>&nbsp;<span class="op" id="6052967">(</span><span class="ident" id="6052968">p</span>&nbsp;<span class="op" id="6052970">*</span><span class="ident" id="6052971">printer</span><span class="op" id="6052978">)</span>&nbsp;<span class="ident" id="6052980">marshalTextInterface</span><span class="op" id="6053000">(</span><span class="ident" id="6053001">val</span>&nbsp;<span class="ident" id="6053005">encoding</span><span class="op" id="6053013">.</span><span class="ident" id="6053014">TextMarshaler</span><span class="op" id="6053027">,</span>&nbsp;<span class="ident" id="6053029">start</span>&nbsp;<span class="ident" id="6053035">StartElement</span><span class="op" id="6053047">)</span>&nbsp;<span class="builtintype" id="6053049">error</span>&nbsp;<span class="op" id="6053055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053058">if</span>&nbsp;<span class="ident" id="6053061">err</span>&nbsp;<span class="op" id="6053065">:=</span>&nbsp;<span class="ident" id="6053068">p</span><span class="op" id="6053069">.</span><span class="ident" id="6053070">writeStart</span><span class="op" id="6053080">(</span><span class="op" id="6053081">&amp;</span><span class="ident" id="6053082">start</span><span class="op" id="6053087">)</span><span class="op" id="6053088">;</span>&nbsp;<span class="ident" id="6053090">err</span>&nbsp;<span class="op" id="6053094">!=</span>&nbsp;<span class="ident" id="6053097">nil</span>&nbsp;<span class="op" id="6053101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053105">return</span>&nbsp;<span class="ident" id="6053112">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053117">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053120">text</span><span class="op" id="6053124">,</span>&nbsp;<span class="ident" id="6053126">err</span>&nbsp;<span class="op" id="6053130">:=</span>&nbsp;<span class="ident" id="6053133">val</span><span class="op" id="6053136">.</span><span class="ident" id="6053137">MarshalText</span><span class="op" id="6053148">(</span><span class="op" id="6053149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053152">if</span>&nbsp;<span class="ident" id="6053155">err</span>&nbsp;<span class="op" id="6053159">!=</span>&nbsp;<span class="ident" id="6053162">nil</span>&nbsp;<span class="op" id="6053166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053170">return</span>&nbsp;<span class="ident" id="6053177">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053185">EscapeText</span><span class="op" id="6053195">(</span><span class="ident" id="6053196">p</span><span class="op" id="6053197">,</span>&nbsp;<span class="ident" id="6053199">text</span><span class="op" id="6053203">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053206">return</span>&nbsp;<span class="ident" id="6053213">p</span><span class="op" id="6053214">.</span><span class="ident" id="6053215">writeEnd</span><span class="op" id="6053223">(</span><span class="ident" id="6053224">start</span><span class="op" id="6053229">.</span><span class="ident" id="6053230">Name</span><span class="op" id="6053234">)</span><br>
<span class="lineno"></span><span class="op" id="6053236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6053239">//&nbsp;writeStart&nbsp;writes&nbsp;the&nbsp;given&nbsp;start&nbsp;element.</span><br>
<span class="lineno"></span><span class="keyword" id="6053285">func</span>&nbsp;<span class="op" id="6053290">(</span><span class="ident" id="6053291">p</span>&nbsp;<span class="op" id="6053293">*</span><span class="ident" id="6053294">printer</span><span class="op" id="6053301">)</span>&nbsp;<span class="ident" id="6053303">writeStart</span><span class="op" id="6053313">(</span><span class="ident" id="6053314">start</span>&nbsp;<span class="op" id="6053320">*</span><span class="ident" id="6053321">StartElement</span><span class="op" id="6053333">)</span>&nbsp;<span class="builtintype" id="6053335">error</span>&nbsp;<span class="op" id="6053341">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053344">if</span>&nbsp;<span class="ident" id="6053347">start</span><span class="op" id="6053352">.</span><span class="ident" id="6053353">Name</span><span class="op" id="6053357">.</span><span class="ident" id="6053358">Local</span>&nbsp;<span class="op" id="6053364">==</span>&nbsp;<span class="string" id="6053367">&#34;&#34;</span>&nbsp;<span class="op" id="6053370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053374">return</span>&nbsp;<span class="ident" id="6053381">fmt</span><span class="op" id="6053384">.</span><span class="ident" id="6053385">Errorf</span><span class="op" id="6053391">(</span><span class="string" id="6053392">&#34;xml:&nbsp;start&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6053421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053428">p</span><span class="op" id="6053429">.</span><span class="ident" id="6053430">tags</span>&nbsp;<span class="op" id="6053435">=</span>&nbsp;<span class="builtinfunc" id="6053437">append</span><span class="op" id="6053443">(</span><span class="ident" id="6053444">p</span><span class="op" id="6053445">.</span><span class="ident" id="6053446">tags</span><span class="op" id="6053450">,</span>&nbsp;<span class="ident" id="6053452">start</span><span class="op" id="6053457">.</span><span class="ident" id="6053458">Name</span><span class="op" id="6053462">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053465">p</span><span class="op" id="6053466">.</span><span class="ident" id="6053467">markPrefix</span><span class="op" id="6053477">(</span><span class="op" id="6053478">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053482">p</span><span class="op" id="6053483">.</span><span class="ident" id="6053484">writeIndent</span><span class="op" id="6053495">(</span><span class="num" id="6053496">1</span><span class="op" id="6053497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053500">p</span><span class="op" id="6053501">.</span><span class="ident" id="6053502">WriteByte</span><span class="op" id="6053511">(</span><span class="string" id="6053512">&#39;&lt;&#39;</span><span class="op" id="6053515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053518">p</span><span class="op" id="6053519">.</span><span class="ident" id="6053520">WriteString</span><span class="op" id="6053531">(</span><span class="ident" id="6053532">start</span><span class="op" id="6053537">.</span><span class="ident" id="6053538">Name</span><span class="op" id="6053542">.</span><span class="ident" id="6053543">Local</span><span class="op" id="6053548">)</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053552">if</span>&nbsp;<span class="ident" id="6053555">start</span><span class="op" id="6053560">.</span><span class="ident" id="6053561">Name</span><span class="op" id="6053565">.</span><span class="ident" id="6053566">Space</span>&nbsp;<span class="op" id="6053572">!=</span>&nbsp;<span class="string" id="6053575">&#34;&#34;</span>&nbsp;<span class="op" id="6053578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053582">p</span><span class="op" id="6053583">.</span><span class="ident" id="6053584">WriteString</span><span class="op" id="6053595">(</span><span class="string" id="6053596">`&nbsp;xmlns=&#34;`</span><span class="op" id="6053606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053610">p</span><span class="op" id="6053611">.</span><span class="ident" id="6053612">EscapeString</span><span class="op" id="6053624">(</span><span class="ident" id="6053625">start</span><span class="op" id="6053630">.</span><span class="ident" id="6053631">Name</span><span class="op" id="6053635">.</span><span class="ident" id="6053636">Space</span><span class="op" id="6053641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053645">p</span><span class="op" id="6053646">.</span><span class="ident" id="6053647">WriteByte</span><span class="op" id="6053656">(</span><span class="string" id="6053657">&#39;&#34;&#39;</span><span class="op" id="6053660">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6053667">//&nbsp;Attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053682">for</span>&nbsp;<span class="ident" id="6053686">_</span><span class="op" id="6053687">,</span>&nbsp;<span class="ident" id="6053689">attr</span>&nbsp;<span class="op" id="6053694">:=</span>&nbsp;<span class="keyword" id="6053697">range</span>&nbsp;<span class="ident" id="6053703">start</span><span class="op" id="6053708">.</span><span class="ident" id="6053709">Attr</span>&nbsp;<span class="op" id="6053714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053718">name</span>&nbsp;<span class="op" id="6053723">:=</span>&nbsp;<span class="ident" id="6053726">attr</span><span class="op" id="6053730">.</span><span class="ident" id="6053731">Name</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053738">if</span>&nbsp;<span class="ident" id="6053741">name</span><span class="op" id="6053745">.</span><span class="ident" id="6053746">Local</span>&nbsp;<span class="op" id="6053752">==</span>&nbsp;<span class="string" id="6053755">&#34;&#34;</span>&nbsp;<span class="op" id="6053758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053763">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053778">p</span><span class="op" id="6053779">.</span><span class="ident" id="6053780">WriteByte</span><span class="op" id="6053789">(</span><span class="string" id="6053790">&#39;&nbsp;&#39;</span><span class="op" id="6053793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6053797">if</span>&nbsp;<span class="ident" id="6053800">name</span><span class="op" id="6053804">.</span><span class="ident" id="6053805">Space</span>&nbsp;<span class="op" id="6053811">!=</span>&nbsp;<span class="string" id="6053814">&#34;&#34;</span>&nbsp;<span class="op" id="6053817">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053822">p</span><span class="op" id="6053823">.</span><span class="ident" id="6053824">WriteString</span><span class="op" id="6053835">(</span><span class="ident" id="6053836">p</span><span class="op" id="6053837">.</span><span class="ident" id="6053838">createAttrPrefix</span><span class="op" id="6053854">(</span><span class="ident" id="6053855">name</span><span class="op" id="6053859">.</span><span class="ident" id="6053860">Space</span><span class="op" id="6053865">)</span><span class="op" id="6053866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053871">p</span><span class="op" id="6053872">.</span><span class="ident" id="6053873">WriteByte</span><span class="op" id="6053882">(</span><span class="string" id="6053883">&#39;:&#39;</span><span class="op" id="6053886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053894">p</span><span class="op" id="6053895">.</span><span class="ident" id="6053896">WriteString</span><span class="op" id="6053907">(</span><span class="ident" id="6053908">name</span><span class="op" id="6053912">.</span><span class="ident" id="6053913">Local</span><span class="op" id="6053918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053922">p</span><span class="op" id="6053923">.</span><span class="ident" id="6053924">WriteString</span><span class="op" id="6053935">(</span><span class="string" id="6053936">`=&#34;`</span><span class="op" id="6053940">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053944">p</span><span class="op" id="6053945">.</span><span class="ident" id="6053946">EscapeString</span><span class="op" id="6053958">(</span><span class="ident" id="6053959">attr</span><span class="op" id="6053963">.</span><span class="ident" id="6053964">Value</span><span class="op" id="6053969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053973">p</span><span class="op" id="6053974">.</span><span class="ident" id="6053975">WriteByte</span><span class="op" id="6053984">(</span><span class="string" id="6053985">&#39;&#34;&#39;</span><span class="op" id="6053988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6053991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6053994">p</span><span class="op" id="6053995">.</span><span class="ident" id="6053996">WriteByte</span><span class="op" id="6054005">(</span><span class="string" id="6054006">&#39;&gt;&#39;</span><span class="op" id="6054009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054012">return</span>&nbsp;<span class="ident" id="6054019">nil</span><br>
<span class="lineno">645</span><span class="op" id="6054023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6054026">func</span>&nbsp;<span class="op" id="6054031">(</span><span class="ident" id="6054032">p</span>&nbsp;<span class="op" id="6054034">*</span><span class="ident" id="6054035">printer</span><span class="op" id="6054042">)</span>&nbsp;<span class="ident" id="6054044">writeEnd</span><span class="op" id="6054052">(</span><span class="ident" id="6054053">name</span>&nbsp;<span class="ident" id="6054058">Name</span><span class="op" id="6054062">)</span>&nbsp;<span class="builtintype" id="6054064">error</span>&nbsp;<span class="op" id="6054070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054073">if</span>&nbsp;<span class="ident" id="6054076">name</span><span class="op" id="6054080">.</span><span class="ident" id="6054081">Local</span>&nbsp;<span class="op" id="6054087">==</span>&nbsp;<span class="string" id="6054090">&#34;&#34;</span>&nbsp;<span class="op" id="6054093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054097">return</span>&nbsp;<span class="ident" id="6054104">fmt</span><span class="op" id="6054107">.</span><span class="ident" id="6054108">Errorf</span><span class="op" id="6054114">(</span><span class="string" id="6054115">&#34;xml:&nbsp;end&nbsp;tag&nbsp;with&nbsp;no&nbsp;name&#34;</span><span class="op" id="6054142">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054148">if</span>&nbsp;<span class="builtinfunc" id="6054151">len</span><span class="op" id="6054154">(</span><span class="ident" id="6054155">p</span><span class="op" id="6054156">.</span><span class="ident" id="6054157">tags</span><span class="op" id="6054161">)</span>&nbsp;<span class="op" id="6054163">==</span>&nbsp;<span class="num" id="6054166">0</span>&nbsp;<span class="op" id="6054168">||</span>&nbsp;<span class="ident" id="6054171">p</span><span class="op" id="6054172">.</span><span class="ident" id="6054173">tags</span><span class="op" id="6054177">[</span><span class="builtinfunc" id="6054178">len</span><span class="op" id="6054181">(</span><span class="ident" id="6054182">p</span><span class="op" id="6054183">.</span><span class="ident" id="6054184">tags</span><span class="op" id="6054188">)</span><span class="op" id="6054189">-</span><span class="num" id="6054190">1</span><span class="op" id="6054191">]</span><span class="op" id="6054192">.</span><span class="ident" id="6054193">Local</span>&nbsp;<span class="op" id="6054199">==</span>&nbsp;<span class="string" id="6054202">&#34;&#34;</span>&nbsp;<span class="op" id="6054205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054209">return</span>&nbsp;<span class="ident" id="6054216">fmt</span><span class="op" id="6054219">.</span><span class="ident" id="6054220">Errorf</span><span class="op" id="6054226">(</span><span class="string" id="6054227">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;without&nbsp;start&nbsp;tag&#34;</span><span class="op" id="6054265">,</span>&nbsp;<span class="ident" id="6054267">name</span><span class="op" id="6054271">.</span><span class="ident" id="6054272">Local</span><span class="op" id="6054277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054283">if</span>&nbsp;<span class="ident" id="6054286">top</span>&nbsp;<span class="op" id="6054290">:=</span>&nbsp;<span class="ident" id="6054293">p</span><span class="op" id="6054294">.</span><span class="ident" id="6054295">tags</span><span class="op" id="6054299">[</span><span class="builtinfunc" id="6054300">len</span><span class="op" id="6054303">(</span><span class="ident" id="6054304">p</span><span class="op" id="6054305">.</span><span class="ident" id="6054306">tags</span><span class="op" id="6054310">)</span><span class="op" id="6054311">-</span><span class="num" id="6054312">1</span><span class="op" id="6054313">]</span><span class="op" id="6054314">;</span>&nbsp;<span class="ident" id="6054316">top</span>&nbsp;<span class="op" id="6054320">!=</span>&nbsp;<span class="ident" id="6054323">name</span>&nbsp;<span class="op" id="6054328">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054332">if</span>&nbsp;<span class="ident" id="6054335">top</span><span class="op" id="6054338">.</span><span class="ident" id="6054339">Local</span>&nbsp;<span class="op" id="6054345">!=</span>&nbsp;<span class="ident" id="6054348">name</span><span class="op" id="6054352">.</span><span class="ident" id="6054353">Local</span>&nbsp;<span class="op" id="6054359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054364">return</span>&nbsp;<span class="ident" id="6054371">fmt</span><span class="op" id="6054374">.</span><span class="ident" id="6054375">Errorf</span><span class="op" id="6054381">(</span><span class="string" id="6054382">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&#34;</span><span class="op" id="6054432">,</span>&nbsp;<span class="ident" id="6054434">name</span><span class="op" id="6054438">.</span><span class="ident" id="6054439">Local</span><span class="op" id="6054444">,</span>&nbsp;<span class="ident" id="6054446">top</span><span class="op" id="6054449">.</span><span class="ident" id="6054450">Local</span><span class="op" id="6054455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054463">return</span>&nbsp;<span class="ident" id="6054470">fmt</span><span class="op" id="6054473">.</span><span class="ident" id="6054474">Errorf</span><span class="op" id="6054480">(</span><span class="string" id="6054481">&#34;xml:&nbsp;end&nbsp;tag&nbsp;&lt;/%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&nbsp;does&nbsp;not&nbsp;match&nbsp;start&nbsp;tag&nbsp;&lt;%s&gt;&nbsp;in&nbsp;namespace&nbsp;%s&#34;</span><span class="op" id="6054563">,</span>&nbsp;<span class="ident" id="6054565">name</span><span class="op" id="6054569">.</span><span class="ident" id="6054570">Local</span><span class="op" id="6054575">,</span>&nbsp;<span class="ident" id="6054577">name</span><span class="op" id="6054581">.</span><span class="ident" id="6054582">Space</span><span class="op" id="6054587">,</span>&nbsp;<span class="ident" id="6054589">top</span><span class="op" id="6054592">.</span><span class="ident" id="6054593">Local</span><span class="op" id="6054598">,</span>&nbsp;<span class="ident" id="6054600">top</span><span class="op" id="6054603">.</span><span class="ident" id="6054604">Space</span><span class="op" id="6054609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6054612">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054615">p</span><span class="op" id="6054616">.</span><span class="ident" id="6054617">tags</span>&nbsp;<span class="op" id="6054622">=</span>&nbsp;<span class="ident" id="6054624">p</span><span class="op" id="6054625">.</span><span class="ident" id="6054626">tags</span><span class="op" id="6054630">[</span><span class="op" id="6054631">:</span><span class="builtinfunc" id="6054632">len</span><span class="op" id="6054635">(</span><span class="ident" id="6054636">p</span><span class="op" id="6054637">.</span><span class="ident" id="6054638">tags</span><span class="op" id="6054642">)</span><span class="op" id="6054643">-</span><span class="num" id="6054644">1</span><span class="op" id="6054645">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054649">p</span><span class="op" id="6054650">.</span><span class="ident" id="6054651">writeIndent</span><span class="op" id="6054662">(</span><span class="op" id="6054663">-</span><span class="num" id="6054664">1</span><span class="op" id="6054665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054668">p</span><span class="op" id="6054669">.</span><span class="ident" id="6054670">WriteByte</span><span class="op" id="6054679">(</span><span class="string" id="6054680">&#39;&lt;&#39;</span><span class="op" id="6054683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054686">p</span><span class="op" id="6054687">.</span><span class="ident" id="6054688">WriteByte</span><span class="op" id="6054697">(</span><span class="string" id="6054698">&#39;/&#39;</span><span class="op" id="6054701">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054704">p</span><span class="op" id="6054705">.</span><span class="ident" id="6054706">WriteString</span><span class="op" id="6054717">(</span><span class="ident" id="6054718">name</span><span class="op" id="6054722">.</span><span class="ident" id="6054723">Local</span><span class="op" id="6054728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054731">p</span><span class="op" id="6054732">.</span><span class="ident" id="6054733">WriteByte</span><span class="op" id="6054742">(</span><span class="string" id="6054743">&#39;&gt;&#39;</span><span class="op" id="6054746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6054749">p</span><span class="op" id="6054750">.</span><span class="ident" id="6054751">popPrefix</span><span class="op" id="6054760">(</span><span class="op" id="6054761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054764">return</span>&nbsp;<span class="ident" id="6054771">nil</span><br>
<span class="lineno"></span><span class="op" id="6054775">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="keyword" id="6054778">func</span>&nbsp;<span class="op" id="6054783">(</span><span class="ident" id="6054784">p</span>&nbsp;<span class="op" id="6054786">*</span><span class="ident" id="6054787">printer</span><span class="op" id="6054794">)</span>&nbsp;<span class="ident" id="6054796">marshalSimple</span><span class="op" id="6054809">(</span><span class="ident" id="6054810">typ</span>&nbsp;<span class="ident" id="6054814">reflect</span><span class="op" id="6054821">.</span><span class="ident" id="6054822">Type</span><span class="op" id="6054826">,</span>&nbsp;<span class="ident" id="6054828">val</span>&nbsp;<span class="ident" id="6054832">reflect</span><span class="op" id="6054839">.</span><span class="ident" id="6054840">Value</span><span class="op" id="6054845">)</span>&nbsp;<span class="op" id="6054847">(</span><span class="builtintype" id="6054848">string</span><span class="op" id="6054854">,</span>&nbsp;<span class="op" id="6054856">[</span><span class="op" id="6054857">]</span><span class="builtintype" id="6054858">byte</span><span class="op" id="6054862">,</span>&nbsp;<span class="builtintype" id="6054864">error</span><span class="op" id="6054869">)</span>&nbsp;<span class="op" id="6054871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054874">switch</span>&nbsp;<span class="ident" id="6054881">val</span><span class="op" id="6054884">.</span><span class="ident" id="6054885">Kind</span><span class="op" id="6054889">(</span><span class="op" id="6054890">)</span>&nbsp;<span class="op" id="6054892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054895">case</span>&nbsp;<span class="ident" id="6054900">reflect</span><span class="op" id="6054907">.</span><span class="ident" id="6054908">Int</span><span class="op" id="6054911">,</span>&nbsp;<span class="ident" id="6054913">reflect</span><span class="op" id="6054920">.</span><span class="ident" id="6054921">Int8</span><span class="op" id="6054925">,</span>&nbsp;<span class="ident" id="6054927">reflect</span><span class="op" id="6054934">.</span><span class="ident" id="6054935">Int16</span><span class="op" id="6054940">,</span>&nbsp;<span class="ident" id="6054942">reflect</span><span class="op" id="6054949">.</span><span class="ident" id="6054950">Int32</span><span class="op" id="6054955">,</span>&nbsp;<span class="ident" id="6054957">reflect</span><span class="op" id="6054964">.</span><span class="ident" id="6054965">Int64</span><span class="op" id="6054970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6054974">return</span>&nbsp;<span class="ident" id="6054981">strconv</span><span class="op" id="6054988">.</span><span class="ident" id="6054989">FormatInt</span><span class="op" id="6054998">(</span><span class="ident" id="6054999">val</span><span class="op" id="6055002">.</span><span class="ident" id="6055003">Int</span><span class="op" id="6055006">(</span><span class="op" id="6055007">)</span><span class="op" id="6055008">,</span>&nbsp;<span class="num" id="6055010">10</span><span class="op" id="6055012">)</span><span class="op" id="6055013">,</span>&nbsp;<span class="ident" id="6055015">nil</span><span class="op" id="6055018">,</span>&nbsp;<span class="ident" id="6055020">nil</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055025">case</span>&nbsp;<span class="ident" id="6055030">reflect</span><span class="op" id="6055037">.</span><span class="ident" id="6055038">Uint</span><span class="op" id="6055042">,</span>&nbsp;<span class="ident" id="6055044">reflect</span><span class="op" id="6055051">.</span><span class="ident" id="6055052">Uint8</span><span class="op" id="6055057">,</span>&nbsp;<span class="ident" id="6055059">reflect</span><span class="op" id="6055066">.</span><span class="ident" id="6055067">Uint16</span><span class="op" id="6055073">,</span>&nbsp;<span class="ident" id="6055075">reflect</span><span class="op" id="6055082">.</span><span class="ident" id="6055083">Uint32</span><span class="op" id="6055089">,</span>&nbsp;<span class="ident" id="6055091">reflect</span><span class="op" id="6055098">.</span><span class="ident" id="6055099">Uint64</span><span class="op" id="6055105">,</span>&nbsp;<span class="ident" id="6055107">reflect</span><span class="op" id="6055114">.</span><span class="ident" id="6055115">Uintptr</span><span class="op" id="6055122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055126">return</span>&nbsp;<span class="ident" id="6055133">strconv</span><span class="op" id="6055140">.</span><span class="ident" id="6055141">FormatUint</span><span class="op" id="6055151">(</span><span class="ident" id="6055152">val</span><span class="op" id="6055155">.</span><span class="ident" id="6055156">Uint</span><span class="op" id="6055160">(</span><span class="op" id="6055161">)</span><span class="op" id="6055162">,</span>&nbsp;<span class="num" id="6055164">10</span><span class="op" id="6055166">)</span><span class="op" id="6055167">,</span>&nbsp;<span class="ident" id="6055169">nil</span><span class="op" id="6055172">,</span>&nbsp;<span class="ident" id="6055174">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055179">case</span>&nbsp;<span class="ident" id="6055184">reflect</span><span class="op" id="6055191">.</span><span class="ident" id="6055192">Float32</span><span class="op" id="6055199">,</span>&nbsp;<span class="ident" id="6055201">reflect</span><span class="op" id="6055208">.</span><span class="ident" id="6055209">Float64</span><span class="op" id="6055216">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055220">return</span>&nbsp;<span class="ident" id="6055227">strconv</span><span class="op" id="6055234">.</span><span class="ident" id="6055235">FormatFloat</span><span class="op" id="6055246">(</span><span class="ident" id="6055247">val</span><span class="op" id="6055250">.</span><span class="ident" id="6055251">Float</span><span class="op" id="6055256">(</span><span class="op" id="6055257">)</span><span class="op" id="6055258">,</span>&nbsp;<span class="string" id="6055260">&#39;g&#39;</span><span class="op" id="6055263">,</span>&nbsp;<span class="op" id="6055265">-</span><span class="num" id="6055266">1</span><span class="op" id="6055267">,</span>&nbsp;<span class="ident" id="6055269">val</span><span class="op" id="6055272">.</span><span class="ident" id="6055273">Type</span><span class="op" id="6055277">(</span><span class="op" id="6055278">)</span><span class="op" id="6055279">.</span><span class="ident" id="6055280">Bits</span><span class="op" id="6055284">(</span><span class="op" id="6055285">)</span><span class="op" id="6055286">)</span><span class="op" id="6055287">,</span>&nbsp;<span class="ident" id="6055289">nil</span><span class="op" id="6055292">,</span>&nbsp;<span class="ident" id="6055294">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055299">case</span>&nbsp;<span class="ident" id="6055304">reflect</span><span class="op" id="6055311">.</span><span class="ident" id="6055312">String</span><span class="op" id="6055318">:</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055322">return</span>&nbsp;<span class="ident" id="6055329">val</span><span class="op" id="6055332">.</span><span class="ident" id="6055333">String</span><span class="op" id="6055339">(</span><span class="op" id="6055340">)</span><span class="op" id="6055341">,</span>&nbsp;<span class="ident" id="6055343">nil</span><span class="op" id="6055346">,</span>&nbsp;<span class="ident" id="6055348">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055353">case</span>&nbsp;<span class="ident" id="6055358">reflect</span><span class="op" id="6055365">.</span><span class="ident" id="6055366">Bool</span><span class="op" id="6055370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055374">return</span>&nbsp;<span class="ident" id="6055381">strconv</span><span class="op" id="6055388">.</span><span class="ident" id="6055389">FormatBool</span><span class="op" id="6055399">(</span><span class="ident" id="6055400">val</span><span class="op" id="6055403">.</span><span class="ident" id="6055404">Bool</span><span class="op" id="6055408">(</span><span class="op" id="6055409">)</span><span class="op" id="6055410">)</span><span class="op" id="6055411">,</span>&nbsp;<span class="ident" id="6055413">nil</span><span class="op" id="6055416">,</span>&nbsp;<span class="ident" id="6055418">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055423">case</span>&nbsp;<span class="ident" id="6055428">reflect</span><span class="op" id="6055435">.</span><span class="ident" id="6055436">Array</span><span class="op" id="6055441">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055445">if</span>&nbsp;<span class="ident" id="6055448">typ</span><span class="op" id="6055451">.</span><span class="ident" id="6055452">Elem</span><span class="op" id="6055456">(</span><span class="op" id="6055457">)</span><span class="op" id="6055458">.</span><span class="ident" id="6055459">Kind</span><span class="op" id="6055463">(</span><span class="op" id="6055464">)</span>&nbsp;<span class="op" id="6055466">!=</span>&nbsp;<span class="ident" id="6055469">reflect</span><span class="op" id="6055476">.</span><span class="ident" id="6055477">Uint8</span>&nbsp;<span class="op" id="6055483">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055488">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6055500">//&nbsp;[...]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055515">var</span>&nbsp;<span class="ident" id="6055519">bytes</span>&nbsp;<span class="op" id="6055525">[</span><span class="op" id="6055526">]</span><span class="builtintype" id="6055527">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055534">if</span>&nbsp;<span class="ident" id="6055537">val</span><span class="op" id="6055540">.</span><span class="ident" id="6055541">CanAddr</span><span class="op" id="6055548">(</span><span class="op" id="6055549">)</span>&nbsp;<span class="op" id="6055551">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055556">bytes</span>&nbsp;<span class="op" id="6055562">=</span>&nbsp;<span class="ident" id="6055564">val</span><span class="op" id="6055567">.</span><span class="ident" id="6055568">Slice</span><span class="op" id="6055573">(</span><span class="num" id="6055574">0</span><span class="op" id="6055575">,</span>&nbsp;<span class="ident" id="6055577">val</span><span class="op" id="6055580">.</span><span class="ident" id="6055581">Len</span><span class="op" id="6055584">(</span><span class="op" id="6055585">)</span><span class="op" id="6055586">)</span><span class="op" id="6055587">.</span><span class="ident" id="6055588">Bytes</span><span class="op" id="6055593">(</span><span class="op" id="6055594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055598">}</span>&nbsp;<span class="keyword" id="6055600">else</span>&nbsp;<span class="op" id="6055605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055610">bytes</span>&nbsp;<span class="op" id="6055616">=</span>&nbsp;<span class="builtinfunc" id="6055618">make</span><span class="op" id="6055622">(</span><span class="op" id="6055623">[</span><span class="op" id="6055624">]</span><span class="builtintype" id="6055625">byte</span><span class="op" id="6055629">,</span>&nbsp;<span class="ident" id="6055631">val</span><span class="op" id="6055634">.</span><span class="ident" id="6055635">Len</span><span class="op" id="6055638">(</span><span class="op" id="6055639">)</span><span class="op" id="6055640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055645">reflect</span><span class="op" id="6055652">.</span><span class="ident" id="6055653">Copy</span><span class="op" id="6055657">(</span><span class="ident" id="6055658">reflect</span><span class="op" id="6055665">.</span><span class="ident" id="6055666">ValueOf</span><span class="op" id="6055673">(</span><span class="ident" id="6055674">bytes</span><span class="op" id="6055679">)</span><span class="op" id="6055680">,</span>&nbsp;<span class="ident" id="6055682">val</span><span class="op" id="6055685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055689">}</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055693">return</span>&nbsp;<span class="string" id="6055700">&#34;&#34;</span><span class="op" id="6055702">,</span>&nbsp;<span class="ident" id="6055704">bytes</span><span class="op" id="6055709">,</span>&nbsp;<span class="ident" id="6055711">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055716">case</span>&nbsp;<span class="ident" id="6055721">reflect</span><span class="op" id="6055728">.</span><span class="ident" id="6055729">Slice</span><span class="op" id="6055734">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055738">if</span>&nbsp;<span class="ident" id="6055741">typ</span><span class="op" id="6055744">.</span><span class="ident" id="6055745">Elem</span><span class="op" id="6055749">(</span><span class="op" id="6055750">)</span><span class="op" id="6055751">.</span><span class="ident" id="6055752">Kind</span><span class="op" id="6055756">(</span><span class="op" id="6055757">)</span>&nbsp;<span class="op" id="6055759">!=</span>&nbsp;<span class="ident" id="6055762">reflect</span><span class="op" id="6055769">.</span><span class="ident" id="6055770">Uint8</span>&nbsp;<span class="op" id="6055776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055781">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055789">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6055793">//&nbsp;[]byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055805">return</span>&nbsp;<span class="string" id="6055812">&#34;&#34;</span><span class="op" id="6055814">,</span>&nbsp;<span class="ident" id="6055816">val</span><span class="op" id="6055819">.</span><span class="ident" id="6055820">Bytes</span><span class="op" id="6055825">(</span><span class="op" id="6055826">)</span><span class="op" id="6055827">,</span>&nbsp;<span class="ident" id="6055829">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6055834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6055837">return</span>&nbsp;<span class="string" id="6055844">&#34;&#34;</span><span class="op" id="6055846">,</span>&nbsp;<span class="ident" id="6055848">nil</span><span class="op" id="6055851">,</span>&nbsp;<span class="op" id="6055853">&amp;</span><span class="ident" id="6055854">UnsupportedTypeError</span><span class="op" id="6055874">{</span><span class="ident" id="6055875">typ</span><span class="op" id="6055878">}</span><br>
<span class="lineno"></span><span class="op" id="6055880">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="6055883">var</span>&nbsp;<span class="ident" id="6055887">ddBytes</span>&nbsp;<span class="op" id="6055895">=</span>&nbsp;<span class="op" id="6055897">[</span><span class="op" id="6055898">]</span><span class="builtintype" id="6055899">byte</span><span class="op" id="6055903">(</span><span class="string" id="6055904">&#34;--&#34;</span><span class="op" id="6055908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6055911">func</span>&nbsp;<span class="op" id="6055916">(</span><span class="ident" id="6055917">p</span>&nbsp;<span class="op" id="6055919">*</span><span class="ident" id="6055920">printer</span><span class="op" id="6055927">)</span>&nbsp;<span class="ident" id="6055929">marshalStruct</span><span class="op" id="6055942">(</span><span class="ident" id="6055943">tinfo</span>&nbsp;<span class="op" id="6055949">*</span><span class="ident" id="6055950">typeInfo</span><span class="op" id="6055958">,</span>&nbsp;<span class="ident" id="6055960">val</span>&nbsp;<span class="ident" id="6055964">reflect</span><span class="op" id="6055971">.</span><span class="ident" id="6055972">Value</span><span class="op" id="6055977">)</span>&nbsp;<span class="builtintype" id="6055979">error</span>&nbsp;<span class="op" id="6055985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6055988">s</span>&nbsp;<span class="op" id="6055990">:=</span>&nbsp;<span class="ident" id="6055993">parentStack</span><span class="op" id="6056004">{</span><span class="ident" id="6056005">p</span><span class="op" id="6056006">:</span>&nbsp;<span class="ident" id="6056008">p</span><span class="op" id="6056009">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056012">for</span>&nbsp;<span class="ident" id="6056016">i</span>&nbsp;<span class="op" id="6056018">:=</span>&nbsp;<span class="keyword" id="6056021">range</span>&nbsp;<span class="ident" id="6056027">tinfo</span><span class="op" id="6056032">.</span><span class="ident" id="6056033">fields</span>&nbsp;<span class="op" id="6056040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056044">finfo</span>&nbsp;<span class="op" id="6056050">:=</span>&nbsp;<span class="op" id="6056053">&amp;</span><span class="ident" id="6056054">tinfo</span><span class="op" id="6056059">.</span><span class="ident" id="6056060">fields</span><span class="op" id="6056066">[</span><span class="ident" id="6056067">i</span><span class="op" id="6056068">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056072">if</span>&nbsp;<span class="ident" id="6056075">finfo</span><span class="op" id="6056080">.</span><span class="ident" id="6056081">flags</span><span class="op" id="6056086">&amp;</span><span class="ident" id="6056087">fAttr</span>&nbsp;<span class="op" id="6056093">!=</span>&nbsp;<span class="num" id="6056096">0</span>&nbsp;<span class="op" id="6056098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056103">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056114">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056118">vf</span>&nbsp;<span class="op" id="6056121">:=</span>&nbsp;<span class="ident" id="6056124">finfo</span><span class="op" id="6056129">.</span><span class="ident" id="6056130">value</span><span class="op" id="6056135">(</span><span class="ident" id="6056136">val</span><span class="op" id="6056139">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6056144">//&nbsp;Dereference&nbsp;or&nbsp;skip&nbsp;nil&nbsp;pointer,&nbsp;interface&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056200">switch</span>&nbsp;<span class="ident" id="6056207">vf</span><span class="op" id="6056209">.</span><span class="ident" id="6056210">Kind</span><span class="op" id="6056214">(</span><span class="op" id="6056215">)</span>&nbsp;<span class="op" id="6056217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056221">case</span>&nbsp;<span class="ident" id="6056226">reflect</span><span class="op" id="6056233">.</span><span class="ident" id="6056234">Ptr</span><span class="op" id="6056237">,</span>&nbsp;<span class="ident" id="6056239">reflect</span><span class="op" id="6056246">.</span><span class="ident" id="6056247">Interface</span><span class="op" id="6056256">:</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056261">if</span>&nbsp;<span class="op" id="6056264">!</span><span class="ident" id="6056265">vf</span><span class="op" id="6056267">.</span><span class="ident" id="6056268">IsNil</span><span class="op" id="6056273">(</span><span class="op" id="6056274">)</span>&nbsp;<span class="op" id="6056276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056282">vf</span>&nbsp;<span class="op" id="6056285">=</span>&nbsp;<span class="ident" id="6056287">vf</span><span class="op" id="6056289">.</span><span class="ident" id="6056290">Elem</span><span class="op" id="6056294">(</span><span class="op" id="6056295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056309">switch</span>&nbsp;<span class="ident" id="6056316">finfo</span><span class="op" id="6056321">.</span><span class="ident" id="6056322">flags</span>&nbsp;<span class="op" id="6056328">&amp;</span>&nbsp;<span class="ident" id="6056330">fMode</span>&nbsp;<span class="op" id="6056336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056340">case</span>&nbsp;<span class="ident" id="6056345">fCharData</span><span class="op" id="6056354">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056359">if</span>&nbsp;<span class="ident" id="6056362">vf</span><span class="op" id="6056364">.</span><span class="ident" id="6056365">CanInterface</span><span class="op" id="6056377">(</span><span class="op" id="6056378">)</span>&nbsp;<span class="op" id="6056380">&amp;&amp;</span>&nbsp;<span class="ident" id="6056383">vf</span><span class="op" id="6056385">.</span><span class="ident" id="6056386">Type</span><span class="op" id="6056390">(</span><span class="op" id="6056391">)</span><span class="op" id="6056392">.</span><span class="ident" id="6056393">Implements</span><span class="op" id="6056403">(</span><span class="ident" id="6056404">textMarshalerType</span><span class="op" id="6056421">)</span>&nbsp;<span class="op" id="6056423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056429">data</span><span class="op" id="6056433">,</span>&nbsp;<span class="ident" id="6056435">err</span>&nbsp;<span class="op" id="6056439">:=</span>&nbsp;<span class="ident" id="6056442">vf</span><span class="op" id="6056444">.</span><span class="ident" id="6056445">Interface</span><span class="op" id="6056454">(</span><span class="op" id="6056455">)</span><span class="op" id="6056456">.</span><span class="op" id="6056457">(</span><span class="ident" id="6056458">encoding</span><span class="op" id="6056466">.</span><span class="ident" id="6056467">TextMarshaler</span><span class="op" id="6056480">)</span><span class="op" id="6056481">.</span><span class="ident" id="6056482">MarshalText</span><span class="op" id="6056493">(</span><span class="op" id="6056494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056500">if</span>&nbsp;<span class="ident" id="6056503">err</span>&nbsp;<span class="op" id="6056507">!=</span>&nbsp;<span class="ident" id="6056510">nil</span>&nbsp;<span class="op" id="6056514">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056521">return</span>&nbsp;<span class="ident" id="6056528">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056542">Escape</span><span class="op" id="6056548">(</span><span class="ident" id="6056549">p</span><span class="op" id="6056550">,</span>&nbsp;<span class="ident" id="6056552">data</span><span class="op" id="6056556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056562">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056574">}</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056579">if</span>&nbsp;<span class="ident" id="6056582">vf</span><span class="op" id="6056584">.</span><span class="ident" id="6056585">CanAddr</span><span class="op" id="6056592">(</span><span class="op" id="6056593">)</span>&nbsp;<span class="op" id="6056595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056601">pv</span>&nbsp;<span class="op" id="6056604">:=</span>&nbsp;<span class="ident" id="6056607">vf</span><span class="op" id="6056609">.</span><span class="ident" id="6056610">Addr</span><span class="op" id="6056614">(</span><span class="op" id="6056615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056621">if</span>&nbsp;<span class="ident" id="6056624">pv</span><span class="op" id="6056626">.</span><span class="ident" id="6056627">CanInterface</span><span class="op" id="6056639">(</span><span class="op" id="6056640">)</span>&nbsp;<span class="op" id="6056642">&amp;&amp;</span>&nbsp;<span class="ident" id="6056645">pv</span><span class="op" id="6056647">.</span><span class="ident" id="6056648">Type</span><span class="op" id="6056652">(</span><span class="op" id="6056653">)</span><span class="op" id="6056654">.</span><span class="ident" id="6056655">Implements</span><span class="op" id="6056665">(</span><span class="ident" id="6056666">textMarshalerType</span><span class="op" id="6056683">)</span>&nbsp;<span class="op" id="6056685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056692">data</span><span class="op" id="6056696">,</span>&nbsp;<span class="ident" id="6056698">err</span>&nbsp;<span class="op" id="6056702">:=</span>&nbsp;<span class="ident" id="6056705">pv</span><span class="op" id="6056707">.</span><span class="ident" id="6056708">Interface</span><span class="op" id="6056717">(</span><span class="op" id="6056718">)</span><span class="op" id="6056719">.</span><span class="op" id="6056720">(</span><span class="ident" id="6056721">encoding</span><span class="op" id="6056729">.</span><span class="ident" id="6056730">TextMarshaler</span><span class="op" id="6056743">)</span><span class="op" id="6056744">.</span><span class="ident" id="6056745">MarshalText</span><span class="op" id="6056756">(</span><span class="op" id="6056757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056764">if</span>&nbsp;<span class="ident" id="6056767">err</span>&nbsp;<span class="op" id="6056771">!=</span>&nbsp;<span class="ident" id="6056774">nil</span>&nbsp;<span class="op" id="6056778">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056786">return</span>&nbsp;<span class="ident" id="6056793">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056809">Escape</span><span class="op" id="6056815">(</span><span class="ident" id="6056816">p</span><span class="op" id="6056817">,</span>&nbsp;<span class="ident" id="6056819">data</span><span class="op" id="6056823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056830">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056843">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6056848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056853">var</span>&nbsp;<span class="ident" id="6056857">scratch</span>&nbsp;<span class="op" id="6056865">[</span><span class="num" id="6056866">64</span><span class="op" id="6056868">]</span><span class="builtintype" id="6056869">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056877">switch</span>&nbsp;<span class="ident" id="6056884">vf</span><span class="op" id="6056886">.</span><span class="ident" id="6056887">Kind</span><span class="op" id="6056891">(</span><span class="op" id="6056892">)</span>&nbsp;<span class="op" id="6056894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6056899">case</span>&nbsp;<span class="ident" id="6056904">reflect</span><span class="op" id="6056911">.</span><span class="ident" id="6056912">Int</span><span class="op" id="6056915">,</span>&nbsp;<span class="ident" id="6056917">reflect</span><span class="op" id="6056924">.</span><span class="ident" id="6056925">Int8</span><span class="op" id="6056929">,</span>&nbsp;<span class="ident" id="6056931">reflect</span><span class="op" id="6056938">.</span><span class="ident" id="6056939">Int16</span><span class="op" id="6056944">,</span>&nbsp;<span class="ident" id="6056946">reflect</span><span class="op" id="6056953">.</span><span class="ident" id="6056954">Int32</span><span class="op" id="6056959">,</span>&nbsp;<span class="ident" id="6056961">reflect</span><span class="op" id="6056968">.</span><span class="ident" id="6056969">Int64</span><span class="op" id="6056974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6056980">Escape</span><span class="op" id="6056986">(</span><span class="ident" id="6056987">p</span><span class="op" id="6056988">,</span>&nbsp;<span class="ident" id="6056990">strconv</span><span class="op" id="6056997">.</span><span class="ident" id="6056998">AppendInt</span><span class="op" id="6057007">(</span><span class="ident" id="6057008">scratch</span><span class="op" id="6057015">[</span><span class="op" id="6057016">:</span><span class="num" id="6057017">0</span><span class="op" id="6057018">]</span><span class="op" id="6057019">,</span>&nbsp;<span class="ident" id="6057021">vf</span><span class="op" id="6057023">.</span><span class="ident" id="6057024">Int</span><span class="op" id="6057027">(</span><span class="op" id="6057028">)</span><span class="op" id="6057029">,</span>&nbsp;<span class="num" id="6057031">10</span><span class="op" id="6057033">)</span><span class="op" id="6057034">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057039">case</span>&nbsp;<span class="ident" id="6057044">reflect</span><span class="op" id="6057051">.</span><span class="ident" id="6057052">Uint</span><span class="op" id="6057056">,</span>&nbsp;<span class="ident" id="6057058">reflect</span><span class="op" id="6057065">.</span><span class="ident" id="6057066">Uint8</span><span class="op" id="6057071">,</span>&nbsp;<span class="ident" id="6057073">reflect</span><span class="op" id="6057080">.</span><span class="ident" id="6057081">Uint16</span><span class="op" id="6057087">,</span>&nbsp;<span class="ident" id="6057089">reflect</span><span class="op" id="6057096">.</span><span class="ident" id="6057097">Uint32</span><span class="op" id="6057103">,</span>&nbsp;<span class="ident" id="6057105">reflect</span><span class="op" id="6057112">.</span><span class="ident" id="6057113">Uint64</span><span class="op" id="6057119">,</span>&nbsp;<span class="ident" id="6057121">reflect</span><span class="op" id="6057128">.</span><span class="ident" id="6057129">Uintptr</span><span class="op" id="6057136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057142">Escape</span><span class="op" id="6057148">(</span><span class="ident" id="6057149">p</span><span class="op" id="6057150">,</span>&nbsp;<span class="ident" id="6057152">strconv</span><span class="op" id="6057159">.</span><span class="ident" id="6057160">AppendUint</span><span class="op" id="6057170">(</span><span class="ident" id="6057171">scratch</span><span class="op" id="6057178">[</span><span class="op" id="6057179">:</span><span class="num" id="6057180">0</span><span class="op" id="6057181">]</span><span class="op" id="6057182">,</span>&nbsp;<span class="ident" id="6057184">vf</span><span class="op" id="6057186">.</span><span class="ident" id="6057187">Uint</span><span class="op" id="6057191">(</span><span class="op" id="6057192">)</span><span class="op" id="6057193">,</span>&nbsp;<span class="num" id="6057195">10</span><span class="op" id="6057197">)</span><span class="op" id="6057198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057203">case</span>&nbsp;<span class="ident" id="6057208">reflect</span><span class="op" id="6057215">.</span><span class="ident" id="6057216">Float32</span><span class="op" id="6057223">,</span>&nbsp;<span class="ident" id="6057225">reflect</span><span class="op" id="6057232">.</span><span class="ident" id="6057233">Float64</span><span class="op" id="6057240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057246">Escape</span><span class="op" id="6057252">(</span><span class="ident" id="6057253">p</span><span class="op" id="6057254">,</span>&nbsp;<span class="ident" id="6057256">strconv</span><span class="op" id="6057263">.</span><span class="ident" id="6057264">AppendFloat</span><span class="op" id="6057275">(</span><span class="ident" id="6057276">scratch</span><span class="op" id="6057283">[</span><span class="op" id="6057284">:</span><span class="num" id="6057285">0</span><span class="op" id="6057286">]</span><span class="op" id="6057287">,</span>&nbsp;<span class="ident" id="6057289">vf</span><span class="op" id="6057291">.</span><span class="ident" id="6057292">Float</span><span class="op" id="6057297">(</span><span class="op" id="6057298">)</span><span class="op" id="6057299">,</span>&nbsp;<span class="string" id="6057301">&#39;g&#39;</span><span class="op" id="6057304">,</span>&nbsp;<span class="op" id="6057306">-</span><span class="num" id="6057307">1</span><span class="op" id="6057308">,</span>&nbsp;<span class="ident" id="6057310">vf</span><span class="op" id="6057312">.</span><span class="ident" id="6057313">Type</span><span class="op" id="6057317">(</span><span class="op" id="6057318">)</span><span class="op" id="6057319">.</span><span class="ident" id="6057320">Bits</span><span class="op" id="6057324">(</span><span class="op" id="6057325">)</span><span class="op" id="6057326">)</span><span class="op" id="6057327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057332">case</span>&nbsp;<span class="ident" id="6057337">reflect</span><span class="op" id="6057344">.</span><span class="ident" id="6057345">Bool</span><span class="op" id="6057349">:</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057355">Escape</span><span class="op" id="6057361">(</span><span class="ident" id="6057362">p</span><span class="op" id="6057363">,</span>&nbsp;<span class="ident" id="6057365">strconv</span><span class="op" id="6057372">.</span><span class="ident" id="6057373">AppendBool</span><span class="op" id="6057383">(</span><span class="ident" id="6057384">scratch</span><span class="op" id="6057391">[</span><span class="op" id="6057392">:</span><span class="num" id="6057393">0</span><span class="op" id="6057394">]</span><span class="op" id="6057395">,</span>&nbsp;<span class="ident" id="6057397">vf</span><span class="op" id="6057399">.</span><span class="ident" id="6057400">Bool</span><span class="op" id="6057404">(</span><span class="op" id="6057405">)</span><span class="op" id="6057406">)</span><span class="op" id="6057407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057412">case</span>&nbsp;<span class="ident" id="6057417">reflect</span><span class="op" id="6057424">.</span><span class="ident" id="6057425">String</span><span class="op" id="6057431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057437">if</span>&nbsp;<span class="ident" id="6057440">err</span>&nbsp;<span class="op" id="6057444">:=</span>&nbsp;<span class="ident" id="6057447">EscapeText</span><span class="op" id="6057457">(</span><span class="ident" id="6057458">p</span><span class="op" id="6057459">,</span>&nbsp;<span class="op" id="6057461">[</span><span class="op" id="6057462">]</span><span class="builtintype" id="6057463">byte</span><span class="op" id="6057467">(</span><span class="ident" id="6057468">vf</span><span class="op" id="6057470">.</span><span class="ident" id="6057471">String</span><span class="op" id="6057477">(</span><span class="op" id="6057478">)</span><span class="op" id="6057479">)</span><span class="op" id="6057480">)</span><span class="op" id="6057481">;</span>&nbsp;<span class="ident" id="6057483">err</span>&nbsp;<span class="op" id="6057487">!=</span>&nbsp;<span class="ident" id="6057490">nil</span>&nbsp;<span class="op" id="6057494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057501">return</span>&nbsp;<span class="ident" id="6057508">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057516">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057521">case</span>&nbsp;<span class="ident" id="6057526">reflect</span><span class="op" id="6057533">.</span><span class="ident" id="6057534">Slice</span><span class="op" id="6057539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057545">if</span>&nbsp;<span class="ident" id="6057548">elem</span><span class="op" id="6057552">,</span>&nbsp;<span class="ident" id="6057554">ok</span>&nbsp;<span class="op" id="6057557">:=</span>&nbsp;<span class="ident" id="6057560">vf</span><span class="op" id="6057562">.</span><span class="ident" id="6057563">Interface</span><span class="op" id="6057572">(</span><span class="op" id="6057573">)</span><span class="op" id="6057574">.</span><span class="op" id="6057575">(</span><span class="op" id="6057576">[</span><span class="op" id="6057577">]</span><span class="builtintype" id="6057578">byte</span><span class="op" id="6057582">)</span><span class="op" id="6057583">;</span>&nbsp;<span class="ident" id="6057585">ok</span>&nbsp;<span class="op" id="6057588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057595">if</span>&nbsp;<span class="ident" id="6057598">err</span>&nbsp;<span class="op" id="6057602">:=</span>&nbsp;<span class="ident" id="6057605">EscapeText</span><span class="op" id="6057615">(</span><span class="ident" id="6057616">p</span><span class="op" id="6057617">,</span>&nbsp;<span class="ident" id="6057619">elem</span><span class="op" id="6057623">)</span><span class="op" id="6057624">;</span>&nbsp;<span class="ident" id="6057626">err</span>&nbsp;<span class="op" id="6057630">!=</span>&nbsp;<span class="ident" id="6057633">nil</span>&nbsp;<span class="op" id="6057637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057645">return</span>&nbsp;<span class="ident" id="6057652">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057661">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057677">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057689">case</span>&nbsp;<span class="ident" id="6057694">fComment</span><span class="op" id="6057702">:</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057707">k</span>&nbsp;<span class="op" id="6057709">:=</span>&nbsp;<span class="ident" id="6057712">vf</span><span class="op" id="6057714">.</span><span class="ident" id="6057715">Kind</span><span class="op" id="6057719">(</span><span class="op" id="6057720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057725">if</span>&nbsp;<span class="op" id="6057728">!</span><span class="op" id="6057729">(</span><span class="ident" id="6057730">k</span>&nbsp;<span class="op" id="6057732">==</span>&nbsp;<span class="ident" id="6057735">reflect</span><span class="op" id="6057742">.</span><span class="ident" id="6057743">String</span>&nbsp;<span class="op" id="6057750">||</span>&nbsp;<span class="ident" id="6057753">k</span>&nbsp;<span class="op" id="6057755">==</span>&nbsp;<span class="ident" id="6057758">reflect</span><span class="op" id="6057765">.</span><span class="ident" id="6057766">Slice</span>&nbsp;<span class="op" id="6057772">&amp;&amp;</span>&nbsp;<span class="ident" id="6057775">vf</span><span class="op" id="6057777">.</span><span class="ident" id="6057778">Type</span><span class="op" id="6057782">(</span><span class="op" id="6057783">)</span><span class="op" id="6057784">.</span><span class="ident" id="6057785">Elem</span><span class="op" id="6057789">(</span><span class="op" id="6057790">)</span><span class="op" id="6057791">.</span><span class="ident" id="6057792">Kind</span><span class="op" id="6057796">(</span><span class="op" id="6057797">)</span>&nbsp;<span class="op" id="6057799">==</span>&nbsp;<span class="ident" id="6057802">reflect</span><span class="op" id="6057809">.</span><span class="ident" id="6057810">Uint8</span><span class="op" id="6057815">)</span>&nbsp;<span class="op" id="6057817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057823">return</span>&nbsp;<span class="ident" id="6057830">fmt</span><span class="op" id="6057833">.</span><span class="ident" id="6057834">Errorf</span><span class="op" id="6057840">(</span><span class="string" id="6057841">&#34;xml:&nbsp;bad&nbsp;type&nbsp;for&nbsp;comment&nbsp;field&nbsp;of&nbsp;%s&#34;</span><span class="op" id="6057880">,</span>&nbsp;<span class="ident" id="6057882">val</span><span class="op" id="6057885">.</span><span class="ident" id="6057886">Type</span><span class="op" id="6057890">(</span><span class="op" id="6057891">)</span><span class="op" id="6057892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057902">if</span>&nbsp;<span class="ident" id="6057905">vf</span><span class="op" id="6057907">.</span><span class="ident" id="6057908">Len</span><span class="op" id="6057911">(</span><span class="op" id="6057912">)</span>&nbsp;<span class="op" id="6057914">==</span>&nbsp;<span class="num" id="6057917">0</span>&nbsp;<span class="op" id="6057919">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6057925">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6057937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057942">p</span><span class="op" id="6057943">.</span><span class="ident" id="6057944">writeIndent</span><span class="op" id="6057955">(</span><span class="num" id="6057956">0</span><span class="op" id="6057957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057962">p</span><span class="op" id="6057963">.</span><span class="ident" id="6057964">WriteString</span><span class="op" id="6057975">(</span><span class="string" id="6057976">&#34;&lt;!--&#34;</span><span class="op" id="6057982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6057987">dashDash</span>&nbsp;<span class="op" id="6057996">:=</span>&nbsp;<span class="builtintype" id="6057999">false</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058008">dashLast</span>&nbsp;<span class="op" id="6058017">:=</span>&nbsp;<span class="builtintype" id="6058020">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058029">switch</span>&nbsp;<span class="ident" id="6058036">k</span>&nbsp;<span class="op" id="6058038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058043">case</span>&nbsp;<span class="ident" id="6058048">reflect</span><span class="op" id="6058055">.</span><span class="ident" id="6058056">String</span><span class="op" id="6058062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058068">s</span>&nbsp;<span class="op" id="6058070">:=</span>&nbsp;<span class="ident" id="6058073">vf</span><span class="op" id="6058075">.</span><span class="ident" id="6058076">String</span><span class="op" id="6058082">(</span><span class="op" id="6058083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058089">dashDash</span>&nbsp;<span class="op" id="6058098">=</span>&nbsp;<span class="ident" id="6058100">strings</span><span class="op" id="6058107">.</span><span class="ident" id="6058108">Index</span><span class="op" id="6058113">(</span><span class="ident" id="6058114">s</span><span class="op" id="6058115">,</span>&nbsp;<span class="string" id="6058117">&#34;--&#34;</span><span class="op" id="6058121">)</span>&nbsp;<span class="op" id="6058123">&gt;=</span>&nbsp;<span class="num" id="6058126">0</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058132">dashLast</span>&nbsp;<span class="op" id="6058141">=</span>&nbsp;<span class="ident" id="6058143">s</span><span class="op" id="6058144">[</span><span class="builtinfunc" id="6058145">len</span><span class="op" id="6058148">(</span><span class="ident" id="6058149">s</span><span class="op" id="6058150">)</span><span class="op" id="6058151">-</span><span class="num" id="6058152">1</span><span class="op" id="6058153">]</span>&nbsp;<span class="op" id="6058155">==</span>&nbsp;<span class="string" id="6058158">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058166">if</span>&nbsp;<span class="op" id="6058169">!</span><span class="ident" id="6058170">dashDash</span>&nbsp;<span class="op" id="6058179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058186">p</span><span class="op" id="6058187">.</span><span class="ident" id="6058188">WriteString</span><span class="op" id="6058199">(</span><span class="ident" id="6058200">s</span><span class="op" id="6058201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058212">case</span>&nbsp;<span class="ident" id="6058217">reflect</span><span class="op" id="6058224">.</span><span class="ident" id="6058225">Slice</span><span class="op" id="6058230">:</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058236">b</span>&nbsp;<span class="op" id="6058238">:=</span>&nbsp;<span class="ident" id="6058241">vf</span><span class="op" id="6058243">.</span><span class="ident" id="6058244">Bytes</span><span class="op" id="6058249">(</span><span class="op" id="6058250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058256">dashDash</span>&nbsp;<span class="op" id="6058265">=</span>&nbsp;<span class="ident" id="6058267">bytes</span><span class="op" id="6058272">.</span><span class="ident" id="6058273">Index</span><span class="op" id="6058278">(</span><span class="ident" id="6058279">b</span><span class="op" id="6058280">,</span>&nbsp;<span class="ident" id="6058282">ddBytes</span><span class="op" id="6058289">)</span>&nbsp;<span class="op" id="6058291">&gt;=</span>&nbsp;<span class="num" id="6058294">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058300">dashLast</span>&nbsp;<span class="op" id="6058309">=</span>&nbsp;<span class="ident" id="6058311">b</span><span class="op" id="6058312">[</span><span class="builtinfunc" id="6058313">len</span><span class="op" id="6058316">(</span><span class="ident" id="6058317">b</span><span class="op" id="6058318">)</span><span class="op" id="6058319">-</span><span class="num" id="6058320">1</span><span class="op" id="6058321">]</span>&nbsp;<span class="op" id="6058323">==</span>&nbsp;<span class="string" id="6058326">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058334">if</span>&nbsp;<span class="op" id="6058337">!</span><span class="ident" id="6058338">dashDash</span>&nbsp;<span class="op" id="6058347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058354">p</span><span class="op" id="6058355">.</span><span class="ident" id="6058356">Write</span><span class="op" id="6058361">(</span><span class="ident" id="6058362">b</span><span class="op" id="6058363">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058374">default</span><span class="op" id="6058381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6058387">panic</span><span class="op" id="6058392">(</span><span class="string" id="6058393">&#34;can&#39;t&nbsp;happen&#34;</span><span class="op" id="6058407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058417">if</span>&nbsp;<span class="ident" id="6058420">dashDash</span>&nbsp;<span class="op" id="6058429">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058435">return</span>&nbsp;<span class="ident" id="6058442">fmt</span><span class="op" id="6058445">.</span><span class="ident" id="6058446">Errorf</span><span class="op" id="6058452">(</span><span class="string" id="6058453">`xml:&nbsp;comments&nbsp;must&nbsp;not&nbsp;contain&nbsp;&#34;--&#34;`</span><span class="op" id="6058490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058500">if</span>&nbsp;<span class="ident" id="6058503">dashLast</span>&nbsp;<span class="op" id="6058512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6058518">//&nbsp;&#34;---&gt;&#34;&nbsp;is&nbsp;invalid&nbsp;grammar.&nbsp;Make&nbsp;it&nbsp;&#34;-&nbsp;--&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058568">p</span><span class="op" id="6058569">.</span><span class="ident" id="6058570">WriteByte</span><span class="op" id="6058579">(</span><span class="string" id="6058580">&#39;&nbsp;&#39;</span><span class="op" id="6058583">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058593">p</span><span class="op" id="6058594">.</span><span class="ident" id="6058595">WriteString</span><span class="op" id="6058606">(</span><span class="string" id="6058607">&#34;--&gt;&#34;</span><span class="op" id="6058612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058617">continue</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058629">case</span>&nbsp;<span class="ident" id="6058634">fInnerXml</span><span class="op" id="6058643">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058648">iface</span>&nbsp;<span class="op" id="6058654">:=</span>&nbsp;<span class="ident" id="6058657">vf</span><span class="op" id="6058659">.</span><span class="ident" id="6058660">Interface</span><span class="op" id="6058669">(</span><span class="op" id="6058670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058675">switch</span>&nbsp;<span class="ident" id="6058682">raw</span>&nbsp;<span class="op" id="6058686">:=</span>&nbsp;<span class="ident" id="6058689">iface</span><span class="op" id="6058694">.</span><span class="op" id="6058695">(</span><span class="keyword" id="6058696">type</span><span class="op" id="6058700">)</span>&nbsp;<span class="op" id="6058702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058707">case</span>&nbsp;<span class="op" id="6058712">[</span><span class="op" id="6058713">]</span><span class="builtintype" id="6058714">byte</span><span class="op" id="6058718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058724">p</span><span class="op" id="6058725">.</span><span class="ident" id="6058726">Write</span><span class="op" id="6058731">(</span><span class="ident" id="6058732">raw</span><span class="op" id="6058735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058741">continue</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058753">case</span>&nbsp;<span class="builtintype" id="6058758">string</span><span class="op" id="6058764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6058770">p</span><span class="op" id="6058771">.</span><span class="ident" id="6058772">WriteString</span><span class="op" id="6058783">(</span><span class="ident" id="6058784">raw</span><span class="op" id="6058787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058793">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058810">case</span>&nbsp;<span class="ident" id="6058815">fElement</span><span class="op" id="6058823">,</span>&nbsp;<span class="ident" id="6058825">fElement</span>&nbsp;<span class="op" id="6058834">|</span>&nbsp;<span class="ident" id="6058836">fAny</span><span class="op" id="6058840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058845">if</span>&nbsp;<span class="ident" id="6058848">err</span>&nbsp;<span class="op" id="6058852">:=</span>&nbsp;<span class="ident" id="6058855">s</span><span class="op" id="6058856">.</span><span class="ident" id="6058857">trim</span><span class="op" id="6058861">(</span><span class="ident" id="6058862">finfo</span><span class="op" id="6058867">.</span><span class="ident" id="6058868">parents</span><span class="op" id="6058875">)</span><span class="op" id="6058876">;</span>&nbsp;<span class="ident" id="6058878">err</span>&nbsp;<span class="op" id="6058882">!=</span>&nbsp;<span class="ident" id="6058885">nil</span>&nbsp;<span class="op" id="6058889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058895">return</span>&nbsp;<span class="ident" id="6058902">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6058909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058914">if</span>&nbsp;<span class="builtinfunc" id="6058917">len</span><span class="op" id="6058920">(</span><span class="ident" id="6058921">finfo</span><span class="op" id="6058926">.</span><span class="ident" id="6058927">parents</span><span class="op" id="6058934">)</span>&nbsp;<span class="op" id="6058936">&gt;</span>&nbsp;<span class="builtinfunc" id="6058938">len</span><span class="op" id="6058941">(</span><span class="ident" id="6058942">s</span><span class="op" id="6058943">.</span><span class="ident" id="6058944">stack</span><span class="op" id="6058949">)</span>&nbsp;<span class="op" id="6058951">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6058957">if</span>&nbsp;<span class="ident" id="6058960">vf</span><span class="op" id="6058962">.</span><span class="ident" id="6058963">Kind</span><span class="op" id="6058967">(</span><span class="op" id="6058968">)</span>&nbsp;<span class="op" id="6058970">!=</span>&nbsp;<span class="ident" id="6058973">reflect</span><span class="op" id="6058980">.</span><span class="ident" id="6058981">Ptr</span>&nbsp;<span class="op" id="6058985">&amp;&amp;</span>&nbsp;<span class="ident" id="6058988">vf</span><span class="op" id="6058990">.</span><span class="ident" id="6058991">Kind</span><span class="op" id="6058995">(</span><span class="op" id="6058996">)</span>&nbsp;<span class="op" id="6058998">!=</span>&nbsp;<span class="ident" id="6059001">reflect</span><span class="op" id="6059008">.</span><span class="ident" id="6059009">Interface</span>&nbsp;<span class="op" id="6059019">||</span>&nbsp;<span class="op" id="6059022">!</span><span class="ident" id="6059023">vf</span><span class="op" id="6059025">.</span><span class="ident" id="6059026">IsNil</span><span class="op" id="6059031">(</span><span class="op" id="6059032">)</span>&nbsp;<span class="op" id="6059034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059041">if</span>&nbsp;<span class="ident" id="6059044">err</span>&nbsp;<span class="op" id="6059048">:=</span>&nbsp;<span class="ident" id="6059051">s</span><span class="op" id="6059052">.</span><span class="ident" id="6059053">push</span><span class="op" id="6059057">(</span><span class="ident" id="6059058">finfo</span><span class="op" id="6059063">.</span><span class="ident" id="6059064">parents</span><span class="op" id="6059071">[</span><span class="builtinfunc" id="6059072">len</span><span class="op" id="6059075">(</span><span class="ident" id="6059076">s</span><span class="op" id="6059077">.</span><span class="ident" id="6059078">stack</span><span class="op" id="6059083">)</span><span class="op" id="6059084">:</span><span class="op" id="6059085">]</span><span class="op" id="6059086">)</span><span class="op" id="6059087">;</span>&nbsp;<span class="ident" id="6059089">err</span>&nbsp;<span class="op" id="6059093">!=</span>&nbsp;<span class="ident" id="6059096">nil</span>&nbsp;<span class="op" id="6059100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059108">return</span>&nbsp;<span class="ident" id="6059115">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059130">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059143">if</span>&nbsp;<span class="ident" id="6059146">err</span>&nbsp;<span class="op" id="6059150">:=</span>&nbsp;<span class="ident" id="6059153">p</span><span class="op" id="6059154">.</span><span class="ident" id="6059155">marshalValue</span><span class="op" id="6059167">(</span><span class="ident" id="6059168">vf</span><span class="op" id="6059170">,</span>&nbsp;<span class="ident" id="6059172">finfo</span><span class="op" id="6059177">,</span>&nbsp;<span class="ident" id="6059179">nil</span><span class="op" id="6059182">)</span><span class="op" id="6059183">;</span>&nbsp;<span class="ident" id="6059185">err</span>&nbsp;<span class="op" id="6059189">!=</span>&nbsp;<span class="ident" id="6059192">nil</span>&nbsp;<span class="op" id="6059196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059201">return</span>&nbsp;<span class="ident" id="6059208">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059214">}</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059220">s</span><span class="op" id="6059221">.</span><span class="ident" id="6059222">trim</span><span class="op" id="6059226">(</span><span class="ident" id="6059227">nil</span><span class="op" id="6059230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059233">return</span>&nbsp;<span class="ident" id="6059240">p</span><span class="op" id="6059241">.</span><span class="ident" id="6059242">cachedWriteError</span><span class="op" id="6059258">(</span><span class="op" id="6059259">)</span><br>
<span class="lineno"></span><span class="op" id="6059261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="6059264">//&nbsp;return&nbsp;the&nbsp;bufio&nbsp;Writer&#39;s&nbsp;cached&nbsp;write&nbsp;error</span><br>
<span class="lineno"></span><span class="keyword" id="6059312">func</span>&nbsp;<span class="op" id="6059317">(</span><span class="ident" id="6059318">p</span>&nbsp;<span class="op" id="6059320">*</span><span class="ident" id="6059321">printer</span><span class="op" id="6059328">)</span>&nbsp;<span class="ident" id="6059330">cachedWriteError</span><span class="op" id="6059346">(</span><span class="op" id="6059347">)</span>&nbsp;<span class="builtintype" id="6059349">error</span>&nbsp;<span class="op" id="6059355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059358">_</span><span class="op" id="6059359">,</span>&nbsp;<span class="ident" id="6059361">err</span>&nbsp;<span class="op" id="6059365">:=</span>&nbsp;<span class="ident" id="6059368">p</span><span class="op" id="6059369">.</span><span class="ident" id="6059370">Write</span><span class="op" id="6059375">(</span><span class="ident" id="6059376">nil</span><span class="op" id="6059379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059382">return</span>&nbsp;<span class="ident" id="6059389">err</span><br>
<span class="lineno"></span><span class="op" id="6059393">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span><span class="keyword" id="6059396">func</span>&nbsp;<span class="op" id="6059401">(</span><span class="ident" id="6059402">p</span>&nbsp;<span class="op" id="6059404">*</span><span class="ident" id="6059405">printer</span><span class="op" id="6059412">)</span>&nbsp;<span class="ident" id="6059414">writeIndent</span><span class="op" id="6059425">(</span><span class="ident" id="6059426">depthDelta</span>&nbsp;<span class="builtintype" id="6059437">int</span><span class="op" id="6059440">)</span>&nbsp;<span class="op" id="6059442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059445">if</span>&nbsp;<span class="builtinfunc" id="6059448">len</span><span class="op" id="6059451">(</span><span class="ident" id="6059452">p</span><span class="op" id="6059453">.</span><span class="ident" id="6059454">prefix</span><span class="op" id="6059460">)</span>&nbsp;<span class="op" id="6059462">==</span>&nbsp;<span class="num" id="6059465">0</span>&nbsp;<span class="op" id="6059467">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6059470">len</span><span class="op" id="6059473">(</span><span class="ident" id="6059474">p</span><span class="op" id="6059475">.</span><span class="ident" id="6059476">indent</span><span class="op" id="6059482">)</span>&nbsp;<span class="op" id="6059484">==</span>&nbsp;<span class="num" id="6059487">0</span>&nbsp;<span class="op" id="6059489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059501">}</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059504">if</span>&nbsp;<span class="ident" id="6059507">depthDelta</span>&nbsp;<span class="op" id="6059518">&lt;</span>&nbsp;<span class="num" id="6059520">0</span>&nbsp;<span class="op" id="6059522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059526">p</span><span class="op" id="6059527">.</span><span class="ident" id="6059528">depth</span><span class="op" id="6059533">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059538">if</span>&nbsp;<span class="ident" id="6059541">p</span><span class="op" id="6059542">.</span><span class="ident" id="6059543">indentedIn</span>&nbsp;<span class="op" id="6059554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059559">p</span><span class="op" id="6059560">.</span><span class="ident" id="6059561">indentedIn</span>&nbsp;<span class="op" id="6059572">=</span>&nbsp;<span class="builtintype" id="6059574">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059583">return</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059596">p</span><span class="op" id="6059597">.</span><span class="ident" id="6059598">indentedIn</span>&nbsp;<span class="op" id="6059609">=</span>&nbsp;<span class="builtintype" id="6059611">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059621">if</span>&nbsp;<span class="ident" id="6059624">p</span><span class="op" id="6059625">.</span><span class="ident" id="6059626">putNewline</span>&nbsp;<span class="op" id="6059637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059641">p</span><span class="op" id="6059642">.</span><span class="ident" id="6059643">WriteByte</span><span class="op" id="6059652">(</span><span class="string" id="6059653">&#39;\n&#39;</span><span class="op" id="6059657">)</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059660">}</span>&nbsp;<span class="keyword" id="6059662">else</span>&nbsp;<span class="op" id="6059667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059671">p</span><span class="op" id="6059672">.</span><span class="ident" id="6059673">putNewline</span>&nbsp;<span class="op" id="6059684">=</span>&nbsp;<span class="builtintype" id="6059686">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059695">if</span>&nbsp;<span class="builtinfunc" id="6059698">len</span><span class="op" id="6059701">(</span><span class="ident" id="6059702">p</span><span class="op" id="6059703">.</span><span class="ident" id="6059704">prefix</span><span class="op" id="6059710">)</span>&nbsp;<span class="op" id="6059712">&gt;</span>&nbsp;<span class="num" id="6059714">0</span>&nbsp;<span class="op" id="6059716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059720">p</span><span class="op" id="6059721">.</span><span class="ident" id="6059722">WriteString</span><span class="op" id="6059733">(</span><span class="ident" id="6059734">p</span><span class="op" id="6059735">.</span><span class="ident" id="6059736">prefix</span><span class="op" id="6059742">)</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059748">if</span>&nbsp;<span class="builtinfunc" id="6059751">len</span><span class="op" id="6059754">(</span><span class="ident" id="6059755">p</span><span class="op" id="6059756">.</span><span class="ident" id="6059757">indent</span><span class="op" id="6059763">)</span>&nbsp;<span class="op" id="6059765">&gt;</span>&nbsp;<span class="num" id="6059767">0</span>&nbsp;<span class="op" id="6059769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059773">for</span>&nbsp;<span class="ident" id="6059777">i</span>&nbsp;<span class="op" id="6059779">:=</span>&nbsp;<span class="num" id="6059782">0</span><span class="op" id="6059783">;</span>&nbsp;<span class="ident" id="6059785">i</span>&nbsp;<span class="op" id="6059787">&lt;</span>&nbsp;<span class="ident" id="6059789">p</span><span class="op" id="6059790">.</span><span class="ident" id="6059791">depth</span><span class="op" id="6059796">;</span>&nbsp;<span class="ident" id="6059798">i</span><span class="op" id="6059799">++</span>&nbsp;<span class="op" id="6059802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059807">p</span><span class="op" id="6059808">.</span><span class="ident" id="6059809">WriteString</span><span class="op" id="6059820">(</span><span class="ident" id="6059821">p</span><span class="op" id="6059822">.</span><span class="ident" id="6059823">indent</span><span class="op" id="6059829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059833">}</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6059839">if</span>&nbsp;<span class="ident" id="6059842">depthDelta</span>&nbsp;<span class="op" id="6059853">&gt;</span>&nbsp;<span class="num" id="6059855">0</span>&nbsp;<span class="op" id="6059857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059861">p</span><span class="op" id="6059862">.</span><span class="ident" id="6059863">depth</span><span class="op" id="6059868">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059873">p</span><span class="op" id="6059874">.</span><span class="ident" id="6059875">indentedIn</span>&nbsp;<span class="op" id="6059886">=</span>&nbsp;<span class="builtintype" id="6059888">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6059894">}</span><br>
<span class="lineno">875</span><span class="op" id="6059896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6059899">type</span>&nbsp;<span class="ident" id="6059904">parentStack</span>&nbsp;<span class="keyword" id="6059916">struct</span>&nbsp;<span class="op" id="6059923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059926">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6059932">*</span><span class="ident" id="6059933">printer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6059942">stack</span>&nbsp;<span class="op" id="6059948">[</span><span class="op" id="6059949">]</span><span class="builtintype" id="6059950">string</span><br>
<span class="lineno">880</span><span class="op" id="6059957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6059960">//&nbsp;trim&nbsp;updates&nbsp;the&nbsp;XML&nbsp;context&nbsp;to&nbsp;match&nbsp;the&nbsp;longest&nbsp;common&nbsp;prefix&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="6060040">//&nbsp;and&nbsp;the&nbsp;given&nbsp;parents.&nbsp;&nbsp;A&nbsp;closing&nbsp;tag&nbsp;will&nbsp;be&nbsp;written&nbsp;for&nbsp;every&nbsp;parent</span><br>
<span class="lineno"></span><span class="comment" id="6060114">//&nbsp;popped.&nbsp;&nbsp;Passing&nbsp;a&nbsp;zero&nbsp;slice&nbsp;or&nbsp;nil&nbsp;will&nbsp;close&nbsp;all&nbsp;the&nbsp;elements.</span><br>
<span class="lineno">885</span><span class="keyword" id="6060183">func</span>&nbsp;<span class="op" id="6060188">(</span><span class="ident" id="6060189">s</span>&nbsp;<span class="op" id="6060191">*</span><span class="ident" id="6060192">parentStack</span><span class="op" id="6060203">)</span>&nbsp;<span class="ident" id="6060205">trim</span><span class="op" id="6060209">(</span><span class="ident" id="6060210">parents</span>&nbsp;<span class="op" id="6060218">[</span><span class="op" id="6060219">]</span><span class="builtintype" id="6060220">string</span><span class="op" id="6060226">)</span>&nbsp;<span class="builtintype" id="6060228">error</span>&nbsp;<span class="op" id="6060234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6060237">split</span>&nbsp;<span class="op" id="6060243">:=</span>&nbsp;<span class="num" id="6060246">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060249">for</span>&nbsp;<span class="op" id="6060253">;</span>&nbsp;<span class="ident" id="6060255">split</span>&nbsp;<span class="op" id="6060261">&lt;</span>&nbsp;<span class="builtinfunc" id="6060263">len</span><span class="op" id="6060266">(</span><span class="ident" id="6060267">parents</span><span class="op" id="6060274">)</span>&nbsp;<span class="op" id="6060276">&amp;&amp;</span>&nbsp;<span class="ident" id="6060279">split</span>&nbsp;<span class="op" id="6060285">&lt;</span>&nbsp;<span class="builtinfunc" id="6060287">len</span><span class="op" id="6060290">(</span><span class="ident" id="6060291">s</span><span class="op" id="6060292">.</span><span class="ident" id="6060293">stack</span><span class="op" id="6060298">)</span><span class="op" id="6060299">;</span>&nbsp;<span class="ident" id="6060301">split</span><span class="op" id="6060306">++</span>&nbsp;<span class="op" id="6060309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060313">if</span>&nbsp;<span class="ident" id="6060316">parents</span><span class="op" id="6060323">[</span><span class="ident" id="6060324">split</span><span class="op" id="6060329">]</span>&nbsp;<span class="op" id="6060331">!=</span>&nbsp;<span class="ident" id="6060334">s</span><span class="op" id="6060335">.</span><span class="ident" id="6060336">stack</span><span class="op" id="6060341">[</span><span class="ident" id="6060342">split</span><span class="op" id="6060347">]</span>&nbsp;<span class="op" id="6060349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060354">break</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060368">for</span>&nbsp;<span class="ident" id="6060372">i</span>&nbsp;<span class="op" id="6060374">:=</span>&nbsp;<span class="builtinfunc" id="6060377">len</span><span class="op" id="6060380">(</span><span class="ident" id="6060381">s</span><span class="op" id="6060382">.</span><span class="ident" id="6060383">stack</span><span class="op" id="6060388">)</span>&nbsp;<span class="op" id="6060390">-</span>&nbsp;<span class="num" id="6060392">1</span><span class="op" id="6060393">;</span>&nbsp;<span class="ident" id="6060395">i</span>&nbsp;<span class="op" id="6060397">&gt;=</span>&nbsp;<span class="ident" id="6060400">split</span><span class="op" id="6060405">;</span>&nbsp;<span class="ident" id="6060407">i</span><span class="op" id="6060408">--</span>&nbsp;<span class="op" id="6060411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060415">if</span>&nbsp;<span class="ident" id="6060418">err</span>&nbsp;<span class="op" id="6060422">:=</span>&nbsp;<span class="ident" id="6060425">s</span><span class="op" id="6060426">.</span><span class="ident" id="6060427">p</span><span class="op" id="6060428">.</span><span class="ident" id="6060429">writeEnd</span><span class="op" id="6060437">(</span><span class="ident" id="6060438">Name</span><span class="op" id="6060442">{</span><span class="ident" id="6060443">Local</span><span class="op" id="6060448">:</span>&nbsp;<span class="ident" id="6060450">s</span><span class="op" id="6060451">.</span><span class="ident" id="6060452">stack</span><span class="op" id="6060457">[</span><span class="ident" id="6060458">i</span><span class="op" id="6060459">]</span><span class="op" id="6060460">}</span><span class="op" id="6060461">)</span><span class="op" id="6060462">;</span>&nbsp;<span class="ident" id="6060464">err</span>&nbsp;<span class="op" id="6060468">!=</span>&nbsp;<span class="ident" id="6060471">nil</span>&nbsp;<span class="op" id="6060475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060480">return</span>&nbsp;<span class="ident" id="6060487">err</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6060499">s</span><span class="op" id="6060500">.</span><span class="ident" id="6060501">stack</span>&nbsp;<span class="op" id="6060507">=</span>&nbsp;<span class="ident" id="6060509">parents</span><span class="op" id="6060516">[</span><span class="op" id="6060517">:</span><span class="ident" id="6060518">split</span><span class="op" id="6060523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060526">return</span>&nbsp;<span class="ident" id="6060533">nil</span><br>
<span class="lineno"></span><span class="op" id="6060537">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span><span class="comment" id="6060540">//&nbsp;push&nbsp;adds&nbsp;parent&nbsp;elements&nbsp;to&nbsp;the&nbsp;stack&nbsp;and&nbsp;writes&nbsp;open&nbsp;tags.</span><br>
<span class="lineno"></span><span class="keyword" id="6060604">func</span>&nbsp;<span class="op" id="6060609">(</span><span class="ident" id="6060610">s</span>&nbsp;<span class="op" id="6060612">*</span><span class="ident" id="6060613">parentStack</span><span class="op" id="6060624">)</span>&nbsp;<span class="ident" id="6060626">push</span><span class="op" id="6060630">(</span><span class="ident" id="6060631">parents</span>&nbsp;<span class="op" id="6060639">[</span><span class="op" id="6060640">]</span><span class="builtintype" id="6060641">string</span><span class="op" id="6060647">)</span>&nbsp;<span class="builtintype" id="6060649">error</span>&nbsp;<span class="op" id="6060655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060658">for</span>&nbsp;<span class="ident" id="6060662">i</span>&nbsp;<span class="op" id="6060664">:=</span>&nbsp;<span class="num" id="6060667">0</span><span class="op" id="6060668">;</span>&nbsp;<span class="ident" id="6060670">i</span>&nbsp;<span class="op" id="6060672">&lt;</span>&nbsp;<span class="builtinfunc" id="6060674">len</span><span class="op" id="6060677">(</span><span class="ident" id="6060678">parents</span><span class="op" id="6060685">)</span><span class="op" id="6060686">;</span>&nbsp;<span class="ident" id="6060688">i</span><span class="op" id="6060689">++</span>&nbsp;<span class="op" id="6060692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060696">if</span>&nbsp;<span class="ident" id="6060699">err</span>&nbsp;<span class="op" id="6060703">:=</span>&nbsp;<span class="ident" id="6060706">s</span><span class="op" id="6060707">.</span><span class="ident" id="6060708">p</span><span class="op" id="6060709">.</span><span class="ident" id="6060710">writeStart</span><span class="op" id="6060720">(</span><span class="op" id="6060721">&amp;</span><span class="ident" id="6060722">StartElement</span><span class="op" id="6060734">{</span><span class="ident" id="6060735">Name</span><span class="op" id="6060739">:</span>&nbsp;<span class="ident" id="6060741">Name</span><span class="op" id="6060745">{</span><span class="ident" id="6060746">Local</span><span class="op" id="6060751">:</span>&nbsp;<span class="ident" id="6060753">parents</span><span class="op" id="6060760">[</span><span class="ident" id="6060761">i</span><span class="op" id="6060762">]</span><span class="op" id="6060763">}</span><span class="op" id="6060764">}</span><span class="op" id="6060765">)</span><span class="op" id="6060766">;</span>&nbsp;<span class="ident" id="6060768">err</span>&nbsp;<span class="op" id="6060772">!=</span>&nbsp;<span class="ident" id="6060775">nil</span>&nbsp;<span class="op" id="6060779">{</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060784">return</span>&nbsp;<span class="ident" id="6060791">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6060800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6060803">s</span><span class="op" id="6060804">.</span><span class="ident" id="6060805">stack</span>&nbsp;<span class="op" id="6060811">=</span>&nbsp;<span class="builtinfunc" id="6060813">append</span><span class="op" id="6060819">(</span><span class="ident" id="6060820">s</span><span class="op" id="6060821">.</span><span class="ident" id="6060822">stack</span><span class="op" id="6060827">,</span>&nbsp;<span class="ident" id="6060829">parents</span><span class="op" id="6060836">...</span><span class="op" id="6060839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6060842">return</span>&nbsp;<span class="ident" id="6060849">nil</span><br>
<span class="lineno">910</span><span class="op" id="6060853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6060856">//&nbsp;A&nbsp;MarshalXMLError&nbsp;is&nbsp;returned&nbsp;when&nbsp;Marshal&nbsp;encounters&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6060920">//&nbsp;that&nbsp;cannot&nbsp;be&nbsp;converted&nbsp;into&nbsp;XML.</span><br>
<span class="lineno"></span><span class="keyword" id="6060958">type</span>&nbsp;<span class="ident" id="6060963">UnsupportedTypeError</span>&nbsp;<span class="keyword" id="6060984">struct</span>&nbsp;<span class="op" id="6060991">{</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6060994">Type</span>&nbsp;<span class="ident" id="6060999">reflect</span><span class="op" id="6061006">.</span><span class="ident" id="6061007">Type</span><br>
<span class="lineno"></span><span class="op" id="6061012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6061015">func</span>&nbsp;<span class="op" id="6061020">(</span><span class="ident" id="6061021">e</span>&nbsp;<span class="op" id="6061023">*</span><span class="ident" id="6061024">UnsupportedTypeError</span><span class="op" id="6061044">)</span>&nbsp;<span class="ident" id="6061046">Error</span><span class="op" id="6061051">(</span><span class="op" id="6061052">)</span>&nbsp;<span class="builtintype" id="6061054">string</span>&nbsp;<span class="op" id="6061061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061064">return</span>&nbsp;<span class="string" id="6061071">&#34;xml:&nbsp;unsupported&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="6061097">+</span>&nbsp;<span class="ident" id="6061099">e</span><span class="op" id="6061100">.</span><span class="ident" id="6061101">Type</span><span class="op" id="6061105">.</span><span class="ident" id="6061106">String</span><span class="op" id="6061112">(</span><span class="op" id="6061113">)</span><br>
<span class="lineno">920</span><span class="op" id="6061115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6061118">func</span>&nbsp;<span class="ident" id="6061123">isEmptyValue</span><span class="op" id="6061135">(</span><span class="ident" id="6061136">v</span>&nbsp;<span class="ident" id="6061138">reflect</span><span class="op" id="6061145">.</span><span class="ident" id="6061146">Value</span><span class="op" id="6061151">)</span>&nbsp;<span class="builtintype" id="6061153">bool</span>&nbsp;<span class="op" id="6061158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061161">switch</span>&nbsp;<span class="ident" id="6061168">v</span><span class="op" id="6061169">.</span><span class="ident" id="6061170">Kind</span><span class="op" id="6061174">(</span><span class="op" id="6061175">)</span>&nbsp;<span class="op" id="6061177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061180">case</span>&nbsp;<span class="ident" id="6061185">reflect</span><span class="op" id="6061192">.</span><span class="ident" id="6061193">Array</span><span class="op" id="6061198">,</span>&nbsp;<span class="ident" id="6061200">reflect</span><span class="op" id="6061207">.</span><span class="ident" id="6061208">Map</span><span class="op" id="6061211">,</span>&nbsp;<span class="ident" id="6061213">reflect</span><span class="op" id="6061220">.</span><span class="ident" id="6061221">Slice</span><span class="op" id="6061226">,</span>&nbsp;<span class="ident" id="6061228">reflect</span><span class="op" id="6061235">.</span><span class="ident" id="6061236">String</span><span class="op" id="6061242">:</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061246">return</span>&nbsp;<span class="ident" id="6061253">v</span><span class="op" id="6061254">.</span><span class="ident" id="6061255">Len</span><span class="op" id="6061258">(</span><span class="op" id="6061259">)</span>&nbsp;<span class="op" id="6061261">==</span>&nbsp;<span class="num" id="6061264">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061267">case</span>&nbsp;<span class="ident" id="6061272">reflect</span><span class="op" id="6061279">.</span><span class="ident" id="6061280">Bool</span><span class="op" id="6061284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061288">return</span>&nbsp;<span class="op" id="6061295">!</span><span class="ident" id="6061296">v</span><span class="op" id="6061297">.</span><span class="ident" id="6061298">Bool</span><span class="op" id="6061302">(</span><span class="op" id="6061303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061306">case</span>&nbsp;<span class="ident" id="6061311">reflect</span><span class="op" id="6061318">.</span><span class="ident" id="6061319">Int</span><span class="op" id="6061322">,</span>&nbsp;<span class="ident" id="6061324">reflect</span><span class="op" id="6061331">.</span><span class="ident" id="6061332">Int8</span><span class="op" id="6061336">,</span>&nbsp;<span class="ident" id="6061338">reflect</span><span class="op" id="6061345">.</span><span class="ident" id="6061346">Int16</span><span class="op" id="6061351">,</span>&nbsp;<span class="ident" id="6061353">reflect</span><span class="op" id="6061360">.</span><span class="ident" id="6061361">Int32</span><span class="op" id="6061366">,</span>&nbsp;<span class="ident" id="6061368">reflect</span><span class="op" id="6061375">.</span><span class="ident" id="6061376">Int64</span><span class="op" id="6061381">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061385">return</span>&nbsp;<span class="ident" id="6061392">v</span><span class="op" id="6061393">.</span><span class="ident" id="6061394">Int</span><span class="op" id="6061397">(</span><span class="op" id="6061398">)</span>&nbsp;<span class="op" id="6061400">==</span>&nbsp;<span class="num" id="6061403">0</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061406">case</span>&nbsp;<span class="ident" id="6061411">reflect</span><span class="op" id="6061418">.</span><span class="ident" id="6061419">Uint</span><span class="op" id="6061423">,</span>&nbsp;<span class="ident" id="6061425">reflect</span><span class="op" id="6061432">.</span><span class="ident" id="6061433">Uint8</span><span class="op" id="6061438">,</span>&nbsp;<span class="ident" id="6061440">reflect</span><span class="op" id="6061447">.</span><span class="ident" id="6061448">Uint16</span><span class="op" id="6061454">,</span>&nbsp;<span class="ident" id="6061456">reflect</span><span class="op" id="6061463">.</span><span class="ident" id="6061464">Uint32</span><span class="op" id="6061470">,</span>&nbsp;<span class="ident" id="6061472">reflect</span><span class="op" id="6061479">.</span><span class="ident" id="6061480">Uint64</span><span class="op" id="6061486">,</span>&nbsp;<span class="ident" id="6061488">reflect</span><span class="op" id="6061495">.</span><span class="ident" id="6061496">Uintptr</span><span class="op" id="6061503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061507">return</span>&nbsp;<span class="ident" id="6061514">v</span><span class="op" id="6061515">.</span><span class="ident" id="6061516">Uint</span><span class="op" id="6061520">(</span><span class="op" id="6061521">)</span>&nbsp;<span class="op" id="6061523">==</span>&nbsp;<span class="num" id="6061526">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061529">case</span>&nbsp;<span class="ident" id="6061534">reflect</span><span class="op" id="6061541">.</span><span class="ident" id="6061542">Float32</span><span class="op" id="6061549">,</span>&nbsp;<span class="ident" id="6061551">reflect</span><span class="op" id="6061558">.</span><span class="ident" id="6061559">Float64</span><span class="op" id="6061566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061570">return</span>&nbsp;<span class="ident" id="6061577">v</span><span class="op" id="6061578">.</span><span class="ident" id="6061579">Float</span><span class="op" id="6061584">(</span><span class="op" id="6061585">)</span>&nbsp;<span class="op" id="6061587">==</span>&nbsp;<span class="num" id="6061590">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061593">case</span>&nbsp;<span class="ident" id="6061598">reflect</span><span class="op" id="6061605">.</span><span class="ident" id="6061606">Interface</span><span class="op" id="6061615">,</span>&nbsp;<span class="ident" id="6061617">reflect</span><span class="op" id="6061624">.</span><span class="ident" id="6061625">Ptr</span><span class="op" id="6061628">:</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061632">return</span>&nbsp;<span class="ident" id="6061639">v</span><span class="op" id="6061640">.</span><span class="ident" id="6061641">IsNil</span><span class="op" id="6061646">(</span><span class="op" id="6061647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6061650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6061653">return</span>&nbsp;<span class="builtintype" id="6061660">false</span><br>
<span class="lineno"></span><span class="op" id="6061666">}</span>
</div>
</body>
</html>
