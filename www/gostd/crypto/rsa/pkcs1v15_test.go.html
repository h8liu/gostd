<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rsa</h2>
<ul>
<li><a href="/gostd/crypto/rsa/pkcs1v15.go.html">pkcs1v15.go</a></li>
<li><a href="/gostd/crypto/rsa/pkcs1v15_test.go.html" class="current">pkcs1v15_test.go</a></li>
<li><a href="/gostd/crypto/rsa/pss.go.html">pss.go</a></li>
<li><a href="/gostd/crypto/rsa/pss_test.go.html">pss_test.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa.go.html">rsa.go</a></li>
<li><a href="/gostd/crypto/rsa/rsa_test.go.html">rsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6794553">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6794608">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6794662">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6794713">package</span>&nbsp;<span class="ident" id="6794721">rsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6794726">import</span>&nbsp;<span class="op" id="6794733">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794736">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794745">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794755">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794770">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794785">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794804">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794820">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794826">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794838">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6794849">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="6794865">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6794868">func</span>&nbsp;<span class="ident" id="6794873">decodeBase64</span><span class="op" id="6794885">(</span><span class="ident" id="6794886">in</span>&nbsp;<span class="builtintype" id="6794889">string</span><span class="op" id="6794895">)</span>&nbsp;<span class="op" id="6794897">[</span><span class="op" id="6794898">]</span><span class="builtintype" id="6794899">byte</span>&nbsp;<span class="op" id="6794904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794907">out</span>&nbsp;<span class="op" id="6794911">:=</span>&nbsp;<span class="builtinfunc" id="6794914">make</span><span class="op" id="6794918">(</span><span class="op" id="6794919">[</span><span class="op" id="6794920">]</span><span class="builtintype" id="6794921">byte</span><span class="op" id="6794925">,</span>&nbsp;<span class="ident" id="6794927">base64</span><span class="op" id="6794933">.</span><span class="ident" id="6794934">StdEncoding</span><span class="op" id="6794945">.</span><span class="ident" id="6794946">DecodedLen</span><span class="op" id="6794956">(</span><span class="builtinfunc" id="6794957">len</span><span class="op" id="6794960">(</span><span class="ident" id="6794961">in</span><span class="op" id="6794963">)</span><span class="op" id="6794964">)</span><span class="op" id="6794965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6794968">n</span><span class="op" id="6794969">,</span>&nbsp;<span class="ident" id="6794971">err</span>&nbsp;<span class="op" id="6794975">:=</span>&nbsp;<span class="ident" id="6794978">base64</span><span class="op" id="6794984">.</span><span class="ident" id="6794985">StdEncoding</span><span class="op" id="6794996">.</span><span class="ident" id="6794997">Decode</span><span class="op" id="6795003">(</span><span class="ident" id="6795004">out</span><span class="op" id="6795007">,</span>&nbsp;<span class="op" id="6795009">[</span><span class="op" id="6795010">]</span><span class="builtintype" id="6795011">byte</span><span class="op" id="6795015">(</span><span class="ident" id="6795016">in</span><span class="op" id="6795018">)</span><span class="op" id="6795019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795022">if</span>&nbsp;<span class="ident" id="6795025">err</span>&nbsp;<span class="op" id="6795029">!=</span>&nbsp;<span class="builtintype" id="6795032">nil</span>&nbsp;<span class="op" id="6795036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795040">return</span>&nbsp;<span class="builtintype" id="6795047">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795055">return</span>&nbsp;<span class="ident" id="6795062">out</span><span class="op" id="6795065">[</span><span class="num" id="6795066">0</span><span class="op" id="6795067">:</span><span class="ident" id="6795068">n</span><span class="op" id="6795069">]</span><br>
<span class="lineno"></span><span class="op" id="6795071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6795074">type</span>&nbsp;<span class="ident" id="6795079">DecryptPKCS1v15Test</span>&nbsp;<span class="keyword" id="6795099">struct</span>&nbsp;<span class="op" id="6795106">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795109">in</span><span class="op" id="6795111">,</span>&nbsp;<span class="ident" id="6795113">out</span>&nbsp;<span class="builtintype" id="6795117">string</span><br>
<span class="lineno"></span><span class="op" id="6795124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6795127">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="6795201">var</span>&nbsp;<span class="ident" id="6795205">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="6795226">=</span>&nbsp;<span class="op" id="6795228">[</span><span class="op" id="6795229">]</span><span class="ident" id="6795230">DecryptPKCS1v15Test</span><span class="op" id="6795249">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795256">&#34;gIcUIoVkD6ATMBk/u/nlCZCCWRKdkfjCgFdo35VpRXLduiKXhNz1XupLLzTXAybEq15juc+EgY5o0DHv/nt3yg==&#34;</span><span class="op" id="6795346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795350">&#34;x&#34;</span><span class="op" id="6795353">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795356">}</span><span class="op" id="6795357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795360">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795364">&#34;Y7TOCSqofGhkRb+jaVRLzK8xw2cSo1IVES19utzv6hwvx+M8kFsoWQm5DzBeJCZTCVDPkTpavUuEbgp8hnUGDw==&#34;</span><span class="op" id="6795454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795458">&#34;testing.&#34;</span><span class="op" id="6795468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795471">}</span><span class="op" id="6795472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795479">&#34;arReP9DJtEVyV2Dg3dDp4c/PSk1O6lxkoJ8HcFupoRorBZG+7+1fDAwT1olNddFnQMjmkb8vxwmNMoTAT/BFjQ==&#34;</span><span class="op" id="6795569">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795573">&#34;testing.\n&#34;</span><span class="op" id="6795585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795588">}</span><span class="op" id="6795589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795596">&#34;WtaBXIoGC54+vH0NH0CHHE+dRDOsMc/6BrfFu2lEqcKL9+uDuWaf+Xj9mrbQCjjZcpQuX733zyok/jsnqe/Ftw==&#34;</span><span class="op" id="6795686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6795690">&#34;01234567890123456789012345678901234567890123456789012&#34;</span><span class="op" id="6795745">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795748">}</span><span class="op" id="6795749">,</span><br>
<span class="lineno"></span><span class="op" id="6795751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6795754">func</span>&nbsp;<span class="ident" id="6795759">TestDecryptPKCS1v15</span><span class="op" id="6795778">(</span><span class="ident" id="6795779">t</span>&nbsp;<span class="op" id="6795781">*</span><span class="ident" id="6795782">testing</span><span class="op" id="6795789">.</span><span class="ident" id="6795790">T</span><span class="op" id="6795791">)</span>&nbsp;<span class="op" id="6795793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795796">for</span>&nbsp;<span class="ident" id="6795800">i</span><span class="op" id="6795801">,</span>&nbsp;<span class="ident" id="6795803">test</span>&nbsp;<span class="op" id="6795808">:=</span>&nbsp;<span class="keyword" id="6795811">range</span>&nbsp;<span class="ident" id="6795817">decryptPKCS1v15Tests</span>&nbsp;<span class="op" id="6795838">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795842">out</span><span class="op" id="6795845">,</span>&nbsp;<span class="ident" id="6795847">err</span>&nbsp;<span class="op" id="6795851">:=</span>&nbsp;<span class="ident" id="6795854">DecryptPKCS1v15</span><span class="op" id="6795869">(</span><span class="builtintype" id="6795870">nil</span><span class="op" id="6795873">,</span>&nbsp;<span class="ident" id="6795875">rsaPrivateKey</span><span class="op" id="6795888">,</span>&nbsp;<span class="ident" id="6795890">decodeBase64</span><span class="op" id="6795902">(</span><span class="ident" id="6795903">test</span><span class="op" id="6795907">.</span><span class="ident" id="6795908">in</span><span class="op" id="6795910">)</span><span class="op" id="6795911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6795915">if</span>&nbsp;<span class="ident" id="6795918">err</span>&nbsp;<span class="op" id="6795922">!=</span>&nbsp;<span class="builtintype" id="6795925">nil</span>&nbsp;<span class="op" id="6795929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795934">t</span><span class="op" id="6795935">.</span><span class="ident" id="6795936">Errorf</span><span class="op" id="6795942">(</span><span class="string" id="6795943">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="6795965">,</span>&nbsp;<span class="ident" id="6795967">i</span><span class="op" id="6795968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6795972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6795976">want</span>&nbsp;<span class="op" id="6795981">:=</span>&nbsp;<span class="op" id="6795984">[</span><span class="op" id="6795985">]</span><span class="builtintype" id="6795986">byte</span><span class="op" id="6795990">(</span><span class="ident" id="6795991">test</span><span class="op" id="6795995">.</span><span class="ident" id="6795996">out</span><span class="op" id="6795999">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796003">if</span>&nbsp;<span class="op" id="6796006">!</span><span class="ident" id="6796007">bytes</span><span class="op" id="6796012">.</span><span class="ident" id="6796013">Equal</span><span class="op" id="6796018">(</span><span class="ident" id="6796019">out</span><span class="op" id="6796022">,</span>&nbsp;<span class="ident" id="6796024">want</span><span class="op" id="6796028">)</span>&nbsp;<span class="op" id="6796030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796035">t</span><span class="op" id="6796036">.</span><span class="ident" id="6796037">Errorf</span><span class="op" id="6796043">(</span><span class="string" id="6796044">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6796066">,</span>&nbsp;<span class="ident" id="6796068">i</span><span class="op" id="6796069">,</span>&nbsp;<span class="ident" id="6796071">out</span><span class="op" id="6796074">,</span>&nbsp;<span class="ident" id="6796076">want</span><span class="op" id="6796080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796087">}</span><br>
<span class="lineno"></span><span class="op" id="6796089">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="6796092">func</span>&nbsp;<span class="ident" id="6796097">TestEncryptPKCS1v15</span><span class="op" id="6796116">(</span><span class="ident" id="6796117">t</span>&nbsp;<span class="op" id="6796119">*</span><span class="ident" id="6796120">testing</span><span class="op" id="6796127">.</span><span class="ident" id="6796128">T</span><span class="op" id="6796129">)</span>&nbsp;<span class="op" id="6796131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796134">random</span>&nbsp;<span class="op" id="6796141">:=</span>&nbsp;<span class="ident" id="6796144">rand</span><span class="op" id="6796148">.</span><span class="ident" id="6796149">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796157">k</span>&nbsp;<span class="op" id="6796159">:=</span>&nbsp;<span class="op" id="6796162">(</span><span class="ident" id="6796163">rsaPrivateKey</span><span class="op" id="6796176">.</span><span class="ident" id="6796177">N</span><span class="op" id="6796178">.</span><span class="ident" id="6796179">BitLen</span><span class="op" id="6796185">(</span><span class="op" id="6796186">)</span>&nbsp;<span class="op" id="6796188">+</span>&nbsp;<span class="num" id="6796190">7</span><span class="op" id="6796191">)</span>&nbsp;<span class="op" id="6796193">/</span>&nbsp;<span class="num" id="6796195">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796199">tryEncryptDecrypt</span>&nbsp;<span class="op" id="6796217">:=</span>&nbsp;<span class="keyword" id="6796220">func</span><span class="op" id="6796224">(</span><span class="ident" id="6796225">in</span>&nbsp;<span class="op" id="6796228">[</span><span class="op" id="6796229">]</span><span class="builtintype" id="6796230">byte</span><span class="op" id="6796234">,</span>&nbsp;<span class="ident" id="6796236">blind</span>&nbsp;<span class="builtintype" id="6796242">bool</span><span class="op" id="6796246">)</span>&nbsp;<span class="builtintype" id="6796248">bool</span>&nbsp;<span class="op" id="6796253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796257">if</span>&nbsp;<span class="builtinfunc" id="6796260">len</span><span class="op" id="6796263">(</span><span class="ident" id="6796264">in</span><span class="op" id="6796266">)</span>&nbsp;<span class="op" id="6796268">&gt;</span>&nbsp;<span class="ident" id="6796270">k</span><span class="op" id="6796271">-</span><span class="num" id="6796272">11</span>&nbsp;<span class="op" id="6796275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796280">in</span>&nbsp;<span class="op" id="6796283">=</span>&nbsp;<span class="ident" id="6796285">in</span><span class="op" id="6796287">[</span><span class="num" id="6796288">0</span>&nbsp;<span class="op" id="6796290">:</span>&nbsp;<span class="ident" id="6796292">k</span><span class="op" id="6796293">-</span><span class="num" id="6796294">11</span><span class="op" id="6796296">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796305">ciphertext</span><span class="op" id="6796315">,</span>&nbsp;<span class="ident" id="6796317">err</span>&nbsp;<span class="op" id="6796321">:=</span>&nbsp;<span class="ident" id="6796324">EncryptPKCS1v15</span><span class="op" id="6796339">(</span><span class="ident" id="6796340">random</span><span class="op" id="6796346">,</span>&nbsp;<span class="op" id="6796348">&amp;</span><span class="ident" id="6796349">rsaPrivateKey</span><span class="op" id="6796362">.</span><span class="ident" id="6796363">PublicKey</span><span class="op" id="6796372">,</span>&nbsp;<span class="ident" id="6796374">in</span><span class="op" id="6796376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796380">if</span>&nbsp;<span class="ident" id="6796383">err</span>&nbsp;<span class="op" id="6796387">!=</span>&nbsp;<span class="builtintype" id="6796390">nil</span>&nbsp;<span class="op" id="6796394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796399">t</span><span class="op" id="6796400">.</span><span class="ident" id="6796401">Errorf</span><span class="op" id="6796407">(</span><span class="string" id="6796408">&#34;error&nbsp;encrypting:&nbsp;%s&#34;</span><span class="op" id="6796430">,</span>&nbsp;<span class="ident" id="6796432">err</span><span class="op" id="6796435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796440">return</span>&nbsp;<span class="builtintype" id="6796447">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796455">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796460">var</span>&nbsp;<span class="ident" id="6796464">rand</span>&nbsp;<span class="ident" id="6796469">io</span><span class="op" id="6796471">.</span><span class="ident" id="6796472">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796481">if</span>&nbsp;<span class="op" id="6796484">!</span><span class="ident" id="6796485">blind</span>&nbsp;<span class="op" id="6796491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796496">rand</span>&nbsp;<span class="op" id="6796501">=</span>&nbsp;<span class="builtintype" id="6796503">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796509">}</span>&nbsp;<span class="keyword" id="6796511">else</span>&nbsp;<span class="op" id="6796516">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796521">rand</span>&nbsp;<span class="op" id="6796526">=</span>&nbsp;<span class="ident" id="6796528">random</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796541">plaintext</span><span class="op" id="6796550">,</span>&nbsp;<span class="ident" id="6796552">err</span>&nbsp;<span class="op" id="6796556">:=</span>&nbsp;<span class="ident" id="6796559">DecryptPKCS1v15</span><span class="op" id="6796574">(</span><span class="ident" id="6796575">rand</span><span class="op" id="6796579">,</span>&nbsp;<span class="ident" id="6796581">rsaPrivateKey</span><span class="op" id="6796594">,</span>&nbsp;<span class="ident" id="6796596">ciphertext</span><span class="op" id="6796606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796610">if</span>&nbsp;<span class="ident" id="6796613">err</span>&nbsp;<span class="op" id="6796617">!=</span>&nbsp;<span class="builtintype" id="6796620">nil</span>&nbsp;<span class="op" id="6796624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796629">t</span><span class="op" id="6796630">.</span><span class="ident" id="6796631">Errorf</span><span class="op" id="6796637">(</span><span class="string" id="6796638">&#34;error&nbsp;decrypting:&nbsp;%s&#34;</span><span class="op" id="6796660">,</span>&nbsp;<span class="ident" id="6796662">err</span><span class="op" id="6796665">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796670">return</span>&nbsp;<span class="builtintype" id="6796677">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796690">if</span>&nbsp;<span class="op" id="6796693">!</span><span class="ident" id="6796694">bytes</span><span class="op" id="6796699">.</span><span class="ident" id="6796700">Equal</span><span class="op" id="6796705">(</span><span class="ident" id="6796706">plaintext</span><span class="op" id="6796715">,</span>&nbsp;<span class="ident" id="6796717">in</span><span class="op" id="6796719">)</span>&nbsp;<span class="op" id="6796721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796726">t</span><span class="op" id="6796727">.</span><span class="ident" id="6796728">Errorf</span><span class="op" id="6796734">(</span><span class="string" id="6796735">&#34;output&nbsp;mismatch:&nbsp;%#v&nbsp;%#v&#34;</span><span class="op" id="6796761">,</span>&nbsp;<span class="ident" id="6796763">plaintext</span><span class="op" id="6796772">,</span>&nbsp;<span class="ident" id="6796774">in</span><span class="op" id="6796776">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796781">return</span>&nbsp;<span class="builtintype" id="6796788">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796800">return</span>&nbsp;<span class="builtintype" id="6796807">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796817">config</span>&nbsp;<span class="op" id="6796824">:=</span>&nbsp;<span class="builtinfunc" id="6796827">new</span><span class="op" id="6796830">(</span><span class="ident" id="6796831">quick</span><span class="op" id="6796836">.</span><span class="ident" id="6796837">Config</span><span class="op" id="6796843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6796846">if</span>&nbsp;<span class="ident" id="6796849">testing</span><span class="op" id="6796856">.</span><span class="ident" id="6796857">Short</span><span class="op" id="6796862">(</span><span class="op" id="6796863">)</span>&nbsp;<span class="op" id="6796865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796869">config</span><span class="op" id="6796875">.</span><span class="ident" id="6796876">MaxCount</span>&nbsp;<span class="op" id="6796885">=</span>&nbsp;<span class="num" id="6796887">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6796891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6796894">quick</span><span class="op" id="6796899">.</span><span class="ident" id="6796900">Check</span><span class="op" id="6796905">(</span><span class="ident" id="6796906">tryEncryptDecrypt</span><span class="op" id="6796923">,</span>&nbsp;<span class="ident" id="6796925">config</span><span class="op" id="6796931">)</span><br>
<span class="lineno">105</span><span class="op" id="6796933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6796936">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;with&nbsp;`openssl&nbsp;rsautl&nbsp;-pkcs&nbsp;-encrypt`</span><br>
<span class="lineno"></span><span class="keyword" id="6797010">var</span>&nbsp;<span class="ident" id="6797014">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="6797045">=</span>&nbsp;<span class="op" id="6797047">[</span><span class="op" id="6797048">]</span><span class="ident" id="6797049">DecryptPKCS1v15Test</span><span class="op" id="6797068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797071">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797075">&#34;e6ukkae6Gykq0fKzYwULpZehX+UPXYzMoB5mHQUDEiclRbOTqas4Y0E6nwns1BBpdvEJcilhl5zsox/6DtGsYg==&#34;</span><span class="op" id="6797165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797169">&#34;1234&#34;</span><span class="op" id="6797175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797178">}</span><span class="op" id="6797179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797186">&#34;Dtis4uk/q/LQGGqGk97P59K03hkCIVFMEFZRgVWOAAhxgYpCRG0MX2adptt92l67IqMki6iVQyyt0TtX3IdtEw==&#34;</span><span class="op" id="6797276">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797280">&#34;FAIL&#34;</span><span class="op" id="6797286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797289">}</span><span class="op" id="6797290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797297">&#34;LIyFyCYCptPxrvTxpol8F3M7ZivlMsf53zs0vHRAv+rDIh2YsHS69ePMoPMe3TkOMZ3NupiL3takPxIs1sK+dw==&#34;</span><span class="op" id="6797387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797391">&#34;abcd&#34;</span><span class="op" id="6797397">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797400">}</span><span class="op" id="6797401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797408">&#34;bafnobel46bKy76JzqU/RIVOH0uAYvzUtauKmIidKgM0sMlvobYVAVQPeUQ/oTGjbIZ1v/6Gyi5AO4DtHruGdw==&#34;</span><span class="op" id="6797498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6797502">&#34;FAIL&#34;</span><span class="op" id="6797508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797511">}</span><span class="op" id="6797512">,</span><br>
<span class="lineno">125</span><span class="op" id="6797514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6797517">func</span>&nbsp;<span class="ident" id="6797522">TestEncryptPKCS1v15SessionKey</span><span class="op" id="6797551">(</span><span class="ident" id="6797552">t</span>&nbsp;<span class="op" id="6797554">*</span><span class="ident" id="6797555">testing</span><span class="op" id="6797562">.</span><span class="ident" id="6797563">T</span><span class="op" id="6797564">)</span>&nbsp;<span class="op" id="6797566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797569">for</span>&nbsp;<span class="ident" id="6797573">i</span><span class="op" id="6797574">,</span>&nbsp;<span class="ident" id="6797576">test</span>&nbsp;<span class="op" id="6797581">:=</span>&nbsp;<span class="keyword" id="6797584">range</span>&nbsp;<span class="ident" id="6797590">decryptPKCS1v15SessionKeyTests</span>&nbsp;<span class="op" id="6797621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797625">key</span>&nbsp;<span class="op" id="6797629">:=</span>&nbsp;<span class="op" id="6797632">[</span><span class="op" id="6797633">]</span><span class="builtintype" id="6797634">byte</span><span class="op" id="6797638">(</span><span class="string" id="6797639">&#34;FAIL&#34;</span><span class="op" id="6797645">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797649">err</span>&nbsp;<span class="op" id="6797653">:=</span>&nbsp;<span class="ident" id="6797656">DecryptPKCS1v15SessionKey</span><span class="op" id="6797681">(</span><span class="builtintype" id="6797682">nil</span><span class="op" id="6797685">,</span>&nbsp;<span class="ident" id="6797687">rsaPrivateKey</span><span class="op" id="6797700">,</span>&nbsp;<span class="ident" id="6797702">decodeBase64</span><span class="op" id="6797714">(</span><span class="ident" id="6797715">test</span><span class="op" id="6797719">.</span><span class="ident" id="6797720">in</span><span class="op" id="6797722">)</span><span class="op" id="6797723">,</span>&nbsp;<span class="ident" id="6797725">key</span><span class="op" id="6797728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797732">if</span>&nbsp;<span class="ident" id="6797735">err</span>&nbsp;<span class="op" id="6797739">!=</span>&nbsp;<span class="builtintype" id="6797742">nil</span>&nbsp;<span class="op" id="6797746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797751">t</span><span class="op" id="6797752">.</span><span class="ident" id="6797753">Errorf</span><span class="op" id="6797759">(</span><span class="string" id="6797760">&#34;#%d&nbsp;error&nbsp;decrypting&#34;</span><span class="op" id="6797782">,</span>&nbsp;<span class="ident" id="6797784">i</span><span class="op" id="6797785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797793">want</span>&nbsp;<span class="op" id="6797798">:=</span>&nbsp;<span class="op" id="6797801">[</span><span class="op" id="6797802">]</span><span class="builtintype" id="6797803">byte</span><span class="op" id="6797807">(</span><span class="ident" id="6797808">test</span><span class="op" id="6797812">.</span><span class="ident" id="6797813">out</span><span class="op" id="6797816">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6797820">if</span>&nbsp;<span class="op" id="6797823">!</span><span class="ident" id="6797824">bytes</span><span class="op" id="6797829">.</span><span class="ident" id="6797830">Equal</span><span class="op" id="6797835">(</span><span class="ident" id="6797836">key</span><span class="op" id="6797839">,</span>&nbsp;<span class="ident" id="6797841">want</span><span class="op" id="6797845">)</span>&nbsp;<span class="op" id="6797847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797852">t</span><span class="op" id="6797853">.</span><span class="ident" id="6797854">Errorf</span><span class="op" id="6797860">(</span><span class="string" id="6797861">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6797883">,</span>&nbsp;<span class="ident" id="6797885">i</span><span class="op" id="6797886">,</span>&nbsp;<span class="ident" id="6797888">key</span><span class="op" id="6797891">,</span>&nbsp;<span class="ident" id="6797893">want</span><span class="op" id="6797897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6797904">}</span><br>
<span class="lineno"></span><span class="op" id="6797906">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="6797909">func</span>&nbsp;<span class="ident" id="6797914">TestNonZeroRandomBytes</span><span class="op" id="6797936">(</span><span class="ident" id="6797937">t</span>&nbsp;<span class="op" id="6797939">*</span><span class="ident" id="6797940">testing</span><span class="op" id="6797947">.</span><span class="ident" id="6797948">T</span><span class="op" id="6797949">)</span>&nbsp;<span class="op" id="6797951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797954">random</span>&nbsp;<span class="op" id="6797961">:=</span>&nbsp;<span class="ident" id="6797964">rand</span><span class="op" id="6797968">.</span><span class="ident" id="6797969">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6797978">b</span>&nbsp;<span class="op" id="6797980">:=</span>&nbsp;<span class="builtinfunc" id="6797983">make</span><span class="op" id="6797987">(</span><span class="op" id="6797988">[</span><span class="op" id="6797989">]</span><span class="builtintype" id="6797990">byte</span><span class="op" id="6797994">,</span>&nbsp;<span class="num" id="6797996">512</span><span class="op" id="6797999">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798002">err</span>&nbsp;<span class="op" id="6798006">:=</span>&nbsp;<span class="ident" id="6798009">nonZeroRandomBytes</span><span class="op" id="6798027">(</span><span class="ident" id="6798028">b</span><span class="op" id="6798029">,</span>&nbsp;<span class="ident" id="6798031">random</span><span class="op" id="6798037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798040">if</span>&nbsp;<span class="ident" id="6798043">err</span>&nbsp;<span class="op" id="6798047">!=</span>&nbsp;<span class="builtintype" id="6798050">nil</span>&nbsp;<span class="op" id="6798054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798058">t</span><span class="op" id="6798059">.</span><span class="ident" id="6798060">Errorf</span><span class="op" id="6798066">(</span><span class="string" id="6798067">&#34;returned&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6798087">,</span>&nbsp;<span class="ident" id="6798089">err</span><span class="op" id="6798092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798098">for</span>&nbsp;<span class="ident" id="6798102">_</span><span class="op" id="6798103">,</span>&nbsp;<span class="ident" id="6798105">b</span>&nbsp;<span class="op" id="6798107">:=</span>&nbsp;<span class="keyword" id="6798110">range</span>&nbsp;<span class="ident" id="6798116">b</span>&nbsp;<span class="op" id="6798118">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798122">if</span>&nbsp;<span class="ident" id="6798125">b</span>&nbsp;<span class="op" id="6798127">==</span>&nbsp;<span class="num" id="6798130">0</span>&nbsp;<span class="op" id="6798132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798137">t</span><span class="op" id="6798138">.</span><span class="ident" id="6798139">Errorf</span><span class="op" id="6798145">(</span><span class="string" id="6798146">&#34;Zero&nbsp;octet&nbsp;found&#34;</span><span class="op" id="6798164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798169">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798181">}</span><br>
<span class="lineno">155</span><span class="op" id="6798183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6798186">type</span>&nbsp;<span class="ident" id="6798191">signPKCS1v15Test</span>&nbsp;<span class="keyword" id="6798208">struct</span>&nbsp;<span class="op" id="6798215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798218">in</span><span class="op" id="6798220">,</span>&nbsp;<span class="ident" id="6798222">out</span>&nbsp;<span class="builtintype" id="6798226">string</span><br>
<span class="lineno"></span><span class="op" id="6798233">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="comment" id="6798236">//&nbsp;These&nbsp;vectors&nbsp;have&nbsp;been&nbsp;tested&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6798275">//&nbsp;&nbsp;&nbsp;`openssl&nbsp;rsautl&nbsp;-verify&nbsp;-inkey&nbsp;pk&nbsp;-in&nbsp;signature&nbsp;|&nbsp;hexdump&nbsp;-C`</span><br>
<span class="lineno"></span><span class="keyword" id="6798342">var</span>&nbsp;<span class="ident" id="6798346">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6798364">=</span>&nbsp;<span class="op" id="6798366">[</span><span class="op" id="6798367">]</span><span class="ident" id="6798368">signPKCS1v15Test</span><span class="op" id="6798384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798387">{</span><span class="string" id="6798388">&#34;Test.\n&#34;</span><span class="op" id="6798397">,</span>&nbsp;<span class="string" id="6798399">&#34;a4f3fa6ea93bcdd0c57be020c1193ecbfd6f200a3d95c409769b029578fa0e336ad9a347600e40d3ae823b8c7e6bad88cc07c1d54c3a1523cbbb6d58efc362ae&#34;</span><span class="op" id="6798529">}</span><span class="op" id="6798530">,</span><br>
<span class="lineno">165</span><span class="op" id="6798532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6798535">func</span>&nbsp;<span class="ident" id="6798540">TestSignPKCS1v15</span><span class="op" id="6798556">(</span><span class="ident" id="6798557">t</span>&nbsp;<span class="op" id="6798559">*</span><span class="ident" id="6798560">testing</span><span class="op" id="6798567">.</span><span class="ident" id="6798568">T</span><span class="op" id="6798569">)</span>&nbsp;<span class="op" id="6798571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798574">for</span>&nbsp;<span class="ident" id="6798578">i</span><span class="op" id="6798579">,</span>&nbsp;<span class="ident" id="6798581">test</span>&nbsp;<span class="op" id="6798586">:=</span>&nbsp;<span class="keyword" id="6798589">range</span>&nbsp;<span class="ident" id="6798595">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6798613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798617">h</span>&nbsp;<span class="op" id="6798619">:=</span>&nbsp;<span class="ident" id="6798622">sha1</span><span class="op" id="6798626">.</span><span class="ident" id="6798627">New</span><span class="op" id="6798630">(</span><span class="op" id="6798631">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798635">h</span><span class="op" id="6798636">.</span><span class="ident" id="6798637">Write</span><span class="op" id="6798642">(</span><span class="op" id="6798643">[</span><span class="op" id="6798644">]</span><span class="builtintype" id="6798645">byte</span><span class="op" id="6798649">(</span><span class="ident" id="6798650">test</span><span class="op" id="6798654">.</span><span class="ident" id="6798655">in</span><span class="op" id="6798657">)</span><span class="op" id="6798658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798662">digest</span>&nbsp;<span class="op" id="6798669">:=</span>&nbsp;<span class="ident" id="6798672">h</span><span class="op" id="6798673">.</span><span class="ident" id="6798674">Sum</span><span class="op" id="6798677">(</span><span class="builtintype" id="6798678">nil</span><span class="op" id="6798681">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798686">s</span><span class="op" id="6798687">,</span>&nbsp;<span class="ident" id="6798689">err</span>&nbsp;<span class="op" id="6798693">:=</span>&nbsp;<span class="ident" id="6798696">SignPKCS1v15</span><span class="op" id="6798708">(</span><span class="builtintype" id="6798709">nil</span><span class="op" id="6798712">,</span>&nbsp;<span class="ident" id="6798714">rsaPrivateKey</span><span class="op" id="6798727">,</span>&nbsp;<span class="ident" id="6798729">crypto</span><span class="op" id="6798735">.</span><span class="ident" id="6798736">SHA1</span><span class="op" id="6798740">,</span>&nbsp;<span class="ident" id="6798742">digest</span><span class="op" id="6798748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798752">if</span>&nbsp;<span class="ident" id="6798755">err</span>&nbsp;<span class="op" id="6798759">!=</span>&nbsp;<span class="builtintype" id="6798762">nil</span>&nbsp;<span class="op" id="6798766">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798771">t</span><span class="op" id="6798772">.</span><span class="ident" id="6798773">Errorf</span><span class="op" id="6798779">(</span><span class="string" id="6798780">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="6798788">,</span>&nbsp;<span class="ident" id="6798790">i</span><span class="op" id="6798791">,</span>&nbsp;<span class="ident" id="6798793">err</span><span class="op" id="6798796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798805">expected</span><span class="op" id="6798813">,</span>&nbsp;<span class="ident" id="6798815">_</span>&nbsp;<span class="op" id="6798817">:=</span>&nbsp;<span class="ident" id="6798820">hex</span><span class="op" id="6798823">.</span><span class="ident" id="6798824">DecodeString</span><span class="op" id="6798836">(</span><span class="ident" id="6798837">test</span><span class="op" id="6798841">.</span><span class="ident" id="6798842">out</span><span class="op" id="6798845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798849">if</span>&nbsp;<span class="op" id="6798852">!</span><span class="ident" id="6798853">bytes</span><span class="op" id="6798858">.</span><span class="ident" id="6798859">Equal</span><span class="op" id="6798864">(</span><span class="ident" id="6798865">s</span><span class="op" id="6798866">,</span>&nbsp;<span class="ident" id="6798868">expected</span><span class="op" id="6798876">)</span>&nbsp;<span class="op" id="6798878">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6798883">t</span><span class="op" id="6798884">.</span><span class="ident" id="6798885">Errorf</span><span class="op" id="6798891">(</span><span class="string" id="6798892">&#34;#%d&nbsp;got:&nbsp;%x&nbsp;want:&nbsp;%x&#34;</span><span class="op" id="6798914">,</span>&nbsp;<span class="ident" id="6798916">i</span><span class="op" id="6798917">,</span>&nbsp;<span class="ident" id="6798919">s</span><span class="op" id="6798920">,</span>&nbsp;<span class="ident" id="6798922">expected</span><span class="op" id="6798930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6798937">}</span><br>
<span class="lineno"></span><span class="op" id="6798939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="6798942">func</span>&nbsp;<span class="ident" id="6798947">TestVerifyPKCS1v15</span><span class="op" id="6798965">(</span><span class="ident" id="6798966">t</span>&nbsp;<span class="op" id="6798968">*</span><span class="ident" id="6798969">testing</span><span class="op" id="6798976">.</span><span class="ident" id="6798977">T</span><span class="op" id="6798978">)</span>&nbsp;<span class="op" id="6798980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6798983">for</span>&nbsp;<span class="ident" id="6798987">i</span><span class="op" id="6798988">,</span>&nbsp;<span class="ident" id="6798990">test</span>&nbsp;<span class="op" id="6798995">:=</span>&nbsp;<span class="keyword" id="6798998">range</span>&nbsp;<span class="ident" id="6799004">signPKCS1v15Tests</span>&nbsp;<span class="op" id="6799022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799026">h</span>&nbsp;<span class="op" id="6799028">:=</span>&nbsp;<span class="ident" id="6799031">sha1</span><span class="op" id="6799035">.</span><span class="ident" id="6799036">New</span><span class="op" id="6799039">(</span><span class="op" id="6799040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799044">h</span><span class="op" id="6799045">.</span><span class="ident" id="6799046">Write</span><span class="op" id="6799051">(</span><span class="op" id="6799052">[</span><span class="op" id="6799053">]</span><span class="builtintype" id="6799054">byte</span><span class="op" id="6799058">(</span><span class="ident" id="6799059">test</span><span class="op" id="6799063">.</span><span class="ident" id="6799064">in</span><span class="op" id="6799066">)</span><span class="op" id="6799067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799071">digest</span>&nbsp;<span class="op" id="6799078">:=</span>&nbsp;<span class="ident" id="6799081">h</span><span class="op" id="6799082">.</span><span class="ident" id="6799083">Sum</span><span class="op" id="6799086">(</span><span class="builtintype" id="6799087">nil</span><span class="op" id="6799090">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799095">sig</span><span class="op" id="6799098">,</span>&nbsp;<span class="ident" id="6799100">_</span>&nbsp;<span class="op" id="6799102">:=</span>&nbsp;<span class="ident" id="6799105">hex</span><span class="op" id="6799108">.</span><span class="ident" id="6799109">DecodeString</span><span class="op" id="6799121">(</span><span class="ident" id="6799122">test</span><span class="op" id="6799126">.</span><span class="ident" id="6799127">out</span><span class="op" id="6799130">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799135">err</span>&nbsp;<span class="op" id="6799139">:=</span>&nbsp;<span class="ident" id="6799142">VerifyPKCS1v15</span><span class="op" id="6799156">(</span><span class="op" id="6799157">&amp;</span><span class="ident" id="6799158">rsaPrivateKey</span><span class="op" id="6799171">.</span><span class="ident" id="6799172">PublicKey</span><span class="op" id="6799181">,</span>&nbsp;<span class="ident" id="6799183">crypto</span><span class="op" id="6799189">.</span><span class="ident" id="6799190">SHA1</span><span class="op" id="6799194">,</span>&nbsp;<span class="ident" id="6799196">digest</span><span class="op" id="6799202">,</span>&nbsp;<span class="ident" id="6799204">sig</span><span class="op" id="6799207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799211">if</span>&nbsp;<span class="ident" id="6799214">err</span>&nbsp;<span class="op" id="6799218">!=</span>&nbsp;<span class="builtintype" id="6799221">nil</span>&nbsp;<span class="op" id="6799225">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799230">t</span><span class="op" id="6799231">.</span><span class="ident" id="6799232">Errorf</span><span class="op" id="6799238">(</span><span class="string" id="6799239">&#34;#%d&nbsp;%s&#34;</span><span class="op" id="6799247">,</span>&nbsp;<span class="ident" id="6799249">i</span><span class="op" id="6799250">,</span>&nbsp;<span class="ident" id="6799252">err</span><span class="op" id="6799255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799262">}</span><br>
<span class="lineno"></span><span class="op" id="6799264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="6799267">func</span>&nbsp;<span class="ident" id="6799272">TestOverlongMessagePKCS1v15</span><span class="op" id="6799299">(</span><span class="ident" id="6799300">t</span>&nbsp;<span class="op" id="6799302">*</span><span class="ident" id="6799303">testing</span><span class="op" id="6799310">.</span><span class="ident" id="6799311">T</span><span class="op" id="6799312">)</span>&nbsp;<span class="op" id="6799314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799317">ciphertext</span>&nbsp;<span class="op" id="6799328">:=</span>&nbsp;<span class="ident" id="6799331">decodeBase64</span><span class="op" id="6799343">(</span><span class="string" id="6799344">&#34;fjOVdirUzFoLlukv80dBllMLjXythIf22feqPrNo0YoIjzyzyoMFiLjAc/Y4krkeZ11XFThIrEvw\nkRiZcCq5ng==&#34;</span><span class="op" id="6799436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799439">_</span><span class="op" id="6799440">,</span>&nbsp;<span class="ident" id="6799442">err</span>&nbsp;<span class="op" id="6799446">:=</span>&nbsp;<span class="ident" id="6799449">DecryptPKCS1v15</span><span class="op" id="6799464">(</span><span class="builtintype" id="6799465">nil</span><span class="op" id="6799468">,</span>&nbsp;<span class="ident" id="6799470">rsaPrivateKey</span><span class="op" id="6799483">,</span>&nbsp;<span class="ident" id="6799485">ciphertext</span><span class="op" id="6799495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6799498">if</span>&nbsp;<span class="ident" id="6799501">err</span>&nbsp;<span class="op" id="6799505">==</span>&nbsp;<span class="builtintype" id="6799508">nil</span>&nbsp;<span class="op" id="6799512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799516">t</span><span class="op" id="6799517">.</span><span class="ident" id="6799518">Error</span><span class="op" id="6799523">(</span><span class="string" id="6799524">&#34;RSA&nbsp;decrypted&nbsp;a&nbsp;message&nbsp;that&nbsp;was&nbsp;too&nbsp;long.&#34;</span><span class="op" id="6799568">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6799571">}</span><br>
<span class="lineno"></span><span class="op" id="6799573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6799576">func</span>&nbsp;<span class="ident" id="6799581">TestUnpaddedSignature</span><span class="op" id="6799602">(</span><span class="ident" id="6799603">t</span>&nbsp;<span class="op" id="6799605">*</span><span class="ident" id="6799606">testing</span><span class="op" id="6799613">.</span><span class="ident" id="6799614">T</span><span class="op" id="6799615">)</span>&nbsp;<span class="op" id="6799617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799620">msg</span>&nbsp;<span class="op" id="6799624">:=</span>&nbsp;<span class="op" id="6799627">[</span><span class="op" id="6799628">]</span><span class="builtintype" id="6799629">byte</span><span class="op" id="6799633">(</span><span class="string" id="6799634">&#34;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013\n&#34;</span><span class="op" id="6799666">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799669">//&nbsp;This&nbsp;base64&nbsp;value&nbsp;was&nbsp;generated&nbsp;with:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799711">//&nbsp;%&nbsp;echo&nbsp;Thu&nbsp;Dec&nbsp;19&nbsp;18:06:16&nbsp;EST&nbsp;2013&nbsp;&gt;&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799762">//&nbsp;%&nbsp;openssl&nbsp;rsautl&nbsp;-sign&nbsp;-inkey&nbsp;key&nbsp;-out&nbsp;/tmp/sig&nbsp;-in&nbsp;/tmp/msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799827">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799831">//&nbsp;Where&nbsp;&#34;key&#34;&nbsp;contains&nbsp;the&nbsp;RSA&nbsp;private&nbsp;key&nbsp;given&nbsp;at&nbsp;the&nbsp;bottom&nbsp;of&nbsp;this</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6799904">//&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6799914">expectedSig</span>&nbsp;<span class="op" id="6799926">:=</span>&nbsp;<span class="ident" id="6799929">decodeBase64</span><span class="op" id="6799941">(</span><span class="string" id="6799942">&#34;pX4DR8azytjdQ1rtUiC040FjkepuQut5q2ZFX1pTjBrOVKNjgsCDyiJDGZTCNoh9qpXYbhl7iEym30BWWwuiZg==&#34;</span><span class="op" id="6800032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800036">sig</span><span class="op" id="6800039">,</span>&nbsp;<span class="ident" id="6800041">err</span>&nbsp;<span class="op" id="6800045">:=</span>&nbsp;<span class="ident" id="6800048">SignPKCS1v15</span><span class="op" id="6800060">(</span><span class="builtintype" id="6800061">nil</span><span class="op" id="6800064">,</span>&nbsp;<span class="ident" id="6800066">rsaPrivateKey</span><span class="op" id="6800079">,</span>&nbsp;<span class="ident" id="6800081">crypto</span><span class="op" id="6800087">.</span><span class="ident" id="6800088">Hash</span><span class="op" id="6800092">(</span><span class="num" id="6800093">0</span><span class="op" id="6800094">)</span><span class="op" id="6800095">,</span>&nbsp;<span class="ident" id="6800097">msg</span><span class="op" id="6800100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800103">if</span>&nbsp;<span class="ident" id="6800106">err</span>&nbsp;<span class="op" id="6800110">!=</span>&nbsp;<span class="builtintype" id="6800113">nil</span>&nbsp;<span class="op" id="6800117">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800121">t</span><span class="op" id="6800122">.</span><span class="ident" id="6800123">Fatalf</span><span class="op" id="6800129">(</span><span class="string" id="6800130">&#34;SignPKCS1v15&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6800155">,</span>&nbsp;<span class="ident" id="6800157">err</span><span class="op" id="6800160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6800163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800166">if</span>&nbsp;<span class="op" id="6800169">!</span><span class="ident" id="6800170">bytes</span><span class="op" id="6800175">.</span><span class="ident" id="6800176">Equal</span><span class="op" id="6800181">(</span><span class="ident" id="6800182">sig</span><span class="op" id="6800185">,</span>&nbsp;<span class="ident" id="6800187">expectedSig</span><span class="op" id="6800198">)</span>&nbsp;<span class="op" id="6800200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800204">t</span><span class="op" id="6800205">.</span><span class="ident" id="6800206">Fatalf</span><span class="op" id="6800212">(</span><span class="string" id="6800213">&#34;signature&nbsp;is&nbsp;not&nbsp;expected&nbsp;value:&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6800263">,</span>&nbsp;<span class="ident" id="6800265">sig</span><span class="op" id="6800268">,</span>&nbsp;<span class="ident" id="6800270">expectedSig</span><span class="op" id="6800281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6800284">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800287">if</span>&nbsp;<span class="ident" id="6800290">err</span>&nbsp;<span class="op" id="6800294">:=</span>&nbsp;<span class="ident" id="6800297">VerifyPKCS1v15</span><span class="op" id="6800311">(</span><span class="op" id="6800312">&amp;</span><span class="ident" id="6800313">rsaPrivateKey</span><span class="op" id="6800326">.</span><span class="ident" id="6800327">PublicKey</span><span class="op" id="6800336">,</span>&nbsp;<span class="ident" id="6800338">crypto</span><span class="op" id="6800344">.</span><span class="ident" id="6800345">Hash</span><span class="op" id="6800349">(</span><span class="num" id="6800350">0</span><span class="op" id="6800351">)</span><span class="op" id="6800352">,</span>&nbsp;<span class="ident" id="6800354">msg</span><span class="op" id="6800357">,</span>&nbsp;<span class="ident" id="6800359">sig</span><span class="op" id="6800362">)</span><span class="op" id="6800363">;</span>&nbsp;<span class="ident" id="6800365">err</span>&nbsp;<span class="op" id="6800369">!=</span>&nbsp;<span class="builtintype" id="6800372">nil</span>&nbsp;<span class="op" id="6800376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800380">t</span><span class="op" id="6800381">.</span><span class="ident" id="6800382">Fatalf</span><span class="op" id="6800388">(</span><span class="string" id="6800389">&#34;signature&nbsp;failed&nbsp;to&nbsp;verify:&nbsp;%s&#34;</span><span class="op" id="6800421">,</span>&nbsp;<span class="ident" id="6800423">err</span><span class="op" id="6800426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6800429">}</span><br>
<span class="lineno"></span><span class="op" id="6800431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6800434">func</span>&nbsp;<span class="ident" id="6800439">TestShortSessionKey</span><span class="op" id="6800458">(</span><span class="ident" id="6800459">t</span>&nbsp;<span class="op" id="6800461">*</span><span class="ident" id="6800462">testing</span><span class="op" id="6800469">.</span><span class="ident" id="6800470">T</span><span class="op" id="6800471">)</span>&nbsp;<span class="op" id="6800473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6800476">//&nbsp;This&nbsp;tests&nbsp;that&nbsp;attempting&nbsp;to&nbsp;decrypt&nbsp;a&nbsp;session&nbsp;key&nbsp;where&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6800542">//&nbsp;ciphertext&nbsp;is&nbsp;too&nbsp;small&nbsp;doesn&#39;t&nbsp;run&nbsp;outside&nbsp;the&nbsp;array&nbsp;bounds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800608">ciphertext</span><span class="op" id="6800618">,</span>&nbsp;<span class="ident" id="6800620">err</span>&nbsp;<span class="op" id="6800624">:=</span>&nbsp;<span class="ident" id="6800627">EncryptPKCS1v15</span><span class="op" id="6800642">(</span><span class="ident" id="6800643">rand</span><span class="op" id="6800647">.</span><span class="ident" id="6800648">Reader</span><span class="op" id="6800654">,</span>&nbsp;<span class="op" id="6800656">&amp;</span><span class="ident" id="6800657">rsaPrivateKey</span><span class="op" id="6800670">.</span><span class="ident" id="6800671">PublicKey</span><span class="op" id="6800680">,</span>&nbsp;<span class="op" id="6800682">[</span><span class="op" id="6800683">]</span><span class="builtintype" id="6800684">byte</span><span class="op" id="6800688">{</span><span class="num" id="6800689">1</span><span class="op" id="6800690">}</span><span class="op" id="6800691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800694">if</span>&nbsp;<span class="ident" id="6800697">err</span>&nbsp;<span class="op" id="6800701">!=</span>&nbsp;<span class="builtintype" id="6800704">nil</span>&nbsp;<span class="op" id="6800708">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800712">t</span><span class="op" id="6800713">.</span><span class="ident" id="6800714">Fatalf</span><span class="op" id="6800720">(</span><span class="string" id="6800721">&#34;Failed&nbsp;to&nbsp;encrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="6800758">,</span>&nbsp;<span class="ident" id="6800760">err</span><span class="op" id="6800763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6800766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800770">var</span>&nbsp;<span class="ident" id="6800774">key</span>&nbsp;<span class="op" id="6800778">[</span><span class="num" id="6800779">32</span><span class="op" id="6800781">]</span><span class="builtintype" id="6800782">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800788">if</span>&nbsp;<span class="ident" id="6800791">err</span>&nbsp;<span class="op" id="6800795">:=</span>&nbsp;<span class="ident" id="6800798">DecryptPKCS1v15SessionKey</span><span class="op" id="6800823">(</span><span class="builtintype" id="6800824">nil</span><span class="op" id="6800827">,</span>&nbsp;<span class="ident" id="6800829">rsaPrivateKey</span><span class="op" id="6800842">,</span>&nbsp;<span class="ident" id="6800844">ciphertext</span><span class="op" id="6800854">,</span>&nbsp;<span class="ident" id="6800856">key</span><span class="op" id="6800859">[</span><span class="op" id="6800860">:</span><span class="op" id="6800861">]</span><span class="op" id="6800862">)</span><span class="op" id="6800863">;</span>&nbsp;<span class="ident" id="6800865">err</span>&nbsp;<span class="op" id="6800869">!=</span>&nbsp;<span class="builtintype" id="6800872">nil</span>&nbsp;<span class="op" id="6800876">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800880">t</span><span class="op" id="6800881">.</span><span class="ident" id="6800882">Fatalf</span><span class="op" id="6800888">(</span><span class="string" id="6800889">&#34;Failed&nbsp;to&nbsp;decrypt&nbsp;short&nbsp;message:&nbsp;%s&#34;</span><span class="op" id="6800926">,</span>&nbsp;<span class="ident" id="6800928">err</span><span class="op" id="6800931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6800934">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800938">for</span>&nbsp;<span class="ident" id="6800942">_</span><span class="op" id="6800943">,</span>&nbsp;<span class="ident" id="6800945">v</span>&nbsp;<span class="op" id="6800947">:=</span>&nbsp;<span class="keyword" id="6800950">range</span>&nbsp;<span class="ident" id="6800956">key</span>&nbsp;<span class="op" id="6800960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6800964">if</span>&nbsp;<span class="ident" id="6800967">v</span>&nbsp;<span class="op" id="6800969">!=</span>&nbsp;<span class="num" id="6800972">0</span>&nbsp;<span class="op" id="6800974">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6800979">t</span><span class="op" id="6800980">.</span><span class="ident" id="6800981">Fatal</span><span class="op" id="6800986">(</span><span class="string" id="6800987">&#34;key&nbsp;was&nbsp;modified&nbsp;when&nbsp;ciphertext&nbsp;was&nbsp;invalid&#34;</span><span class="op" id="6801033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6801037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6801040">}</span><br>
<span class="lineno"></span><span class="op" id="6801042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="6801045">//&nbsp;In&nbsp;order&nbsp;to&nbsp;generate&nbsp;new&nbsp;test&nbsp;vectors&nbsp;you&#39;ll&nbsp;need&nbsp;the&nbsp;PEM&nbsp;form&nbsp;of&nbsp;this&nbsp;key:</span><br>
<span class="lineno"></span><span class="comment" id="6801124">//&nbsp;-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno"></span><span class="comment" id="6801159">//&nbsp;MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0</span><br>
<span class="lineno"></span><span class="comment" id="6801227">//&nbsp;fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu</span><br>
<span class="lineno"></span><span class="comment" id="6801295">//&nbsp;/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu</span><br>
<span class="lineno">255</span><span class="comment" id="6801363">//&nbsp;RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/</span><br>
<span class="lineno"></span><span class="comment" id="6801431">//&nbsp;EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A</span><br>
<span class="lineno"></span><span class="comment" id="6801499">//&nbsp;IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS</span><br>
<span class="lineno"></span><span class="comment" id="6801567">//&nbsp;tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V</span><br>
<span class="lineno"></span><span class="comment" id="6801611">//&nbsp;-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="6801645">var</span>&nbsp;<span class="ident" id="6801649">rsaPrivateKey</span>&nbsp;<span class="op" id="6801663">=</span>&nbsp;<span class="op" id="6801665">&amp;</span><span class="ident" id="6801666">PrivateKey</span><span class="op" id="6801676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6801679">PublicKey</span><span class="op" id="6801688">:</span>&nbsp;<span class="ident" id="6801690">PublicKey</span><span class="op" id="6801699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6801703">N</span><span class="op" id="6801704">:</span>&nbsp;<span class="ident" id="6801706">fromBase10</span><span class="op" id="6801716">(</span><span class="string" id="6801717">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6801873">)</span><span class="op" id="6801874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6801878">E</span><span class="op" id="6801879">:</span>&nbsp;<span class="num" id="6801881">65537</span><span class="op" id="6801886">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6801889">}</span><span class="op" id="6801890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6801893">D</span><span class="op" id="6801894">:</span>&nbsp;<span class="ident" id="6801896">fromBase10</span><span class="op" id="6801906">(</span><span class="string" id="6801907">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6802063">)</span><span class="op" id="6802064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802067">Primes</span><span class="op" id="6802073">:</span>&nbsp;<span class="op" id="6802075">[</span><span class="op" id="6802076">]</span><span class="op" id="6802077">*</span><span class="ident" id="6802078">big</span><span class="op" id="6802081">.</span><span class="ident" id="6802082">Int</span><span class="op" id="6802085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802089">fromBase10</span><span class="op" id="6802099">(</span><span class="string" id="6802100">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6802179">)</span><span class="op" id="6802180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6802184">fromBase10</span><span class="op" id="6802194">(</span><span class="string" id="6802195">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6802274">)</span><span class="op" id="6802275">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6802278">}</span><span class="op" id="6802279">,</span><br>
<span class="lineno"></span><span class="op" id="6802281">}</span>
</div>
</body>
</html>
