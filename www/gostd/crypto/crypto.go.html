<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2957098">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2957153">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2957207">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2957258">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="2957317">package</span>&nbsp;<span class="ident" id="2957325">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2957333">import</span>&nbsp;<span class="op" id="2957340">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2957343">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2957351">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2957357">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="2957367">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2957370">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="2957450">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="2957462">type</span>&nbsp;<span class="ident" id="2957467">Hash</span>&nbsp;<span class="builtintype" id="2957472">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2957478">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="2957556">func</span>&nbsp;<span class="op" id="2957561">(</span><span class="ident" id="2957562">h</span>&nbsp;<span class="ident" id="2957564">Hash</span><span class="op" id="2957568">)</span>&nbsp;<span class="ident" id="2957570">HashFunc</span><span class="op" id="2957578">(</span><span class="op" id="2957579">)</span>&nbsp;<span class="ident" id="2957581">Hash</span>&nbsp;<span class="op" id="2957586">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957589">return</span>&nbsp;<span class="ident" id="2957596">h</span><br>
<span class="lineno"></span><span class="op" id="2957598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2957601">const</span>&nbsp;<span class="op" id="2957607">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957610">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957620">Hash</span>&nbsp;<span class="op" id="2957625">=</span>&nbsp;<span class="num" id="2957627">1</span>&nbsp;<span class="op" id="2957629">+</span>&nbsp;<span class="ident" id="2957631">iota</span>&nbsp;<span class="comment" id="2957636">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957671">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957697">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957719">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957745">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957768">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957794">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957819">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957845">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957870">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957896">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957921">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957947">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2957972">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2957998">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958047">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958073">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958114">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958140">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958176">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958202">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958238">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958264">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958300">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2958326">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958362">maxHash</span><br>
<span class="lineno"></span><span class="op" id="2958370">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2958373">var</span>&nbsp;<span class="ident" id="2958377">digestSizes</span>&nbsp;<span class="op" id="2958389">=</span>&nbsp;<span class="op" id="2958391">[</span><span class="op" id="2958392">]</span><span class="builtintype" id="2958393">uint8</span><span class="op" id="2958398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958401">MD4</span><span class="op" id="2958404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958412">16</span><span class="op" id="2958414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958417">MD5</span><span class="op" id="2958420">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958428">16</span><span class="op" id="2958430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958433">SHA1</span><span class="op" id="2958437">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958444">20</span><span class="op" id="2958446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958449">SHA224</span><span class="op" id="2958455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958460">28</span><span class="op" id="2958462">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958465">SHA256</span><span class="op" id="2958471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958476">32</span><span class="op" id="2958478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958481">SHA384</span><span class="op" id="2958487">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958492">48</span><span class="op" id="2958494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958497">SHA512</span><span class="op" id="2958503">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2958508">64</span><span class="op" id="2958510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958513">SHA3_224</span><span class="op" id="2958521">:</span>&nbsp;&nbsp;<span class="num" id="2958524">28</span><span class="op" id="2958526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958529">SHA3_256</span><span class="op" id="2958537">:</span>&nbsp;&nbsp;<span class="num" id="2958540">32</span><span class="op" id="2958542">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958545">SHA3_384</span><span class="op" id="2958553">:</span>&nbsp;&nbsp;<span class="num" id="2958556">48</span><span class="op" id="2958558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958561">SHA3_512</span><span class="op" id="2958569">:</span>&nbsp;&nbsp;<span class="num" id="2958572">64</span><span class="op" id="2958574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958577">MD5SHA1</span><span class="op" id="2958584">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="2958588">36</span><span class="op" id="2958590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958593">RIPEMD160</span><span class="op" id="2958602">:</span>&nbsp;<span class="num" id="2958604">20</span><span class="op" id="2958606">,</span><br>
<span class="lineno"></span><span class="op" id="2958608">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2958611">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="2958691">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="2958768">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="2958789">func</span>&nbsp;<span class="op" id="2958794">(</span><span class="ident" id="2958795">h</span>&nbsp;<span class="ident" id="2958797">Hash</span><span class="op" id="2958801">)</span>&nbsp;<span class="ident" id="2958803">Size</span><span class="op" id="2958807">(</span><span class="op" id="2958808">)</span>&nbsp;<span class="builtintype" id="2958810">int</span>&nbsp;<span class="op" id="2958814">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958817">if</span>&nbsp;<span class="ident" id="2958820">h</span>&nbsp;<span class="op" id="2958822">&gt;</span>&nbsp;<span class="num" id="2958824">0</span>&nbsp;<span class="op" id="2958826">&amp;&amp;</span>&nbsp;<span class="ident" id="2958829">h</span>&nbsp;<span class="op" id="2958831">&lt;</span>&nbsp;<span class="ident" id="2958833">maxHash</span>&nbsp;<span class="op" id="2958841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958845">return</span>&nbsp;<span class="builtintype" id="2958852">int</span><span class="op" id="2958855">(</span><span class="ident" id="2958856">digestSizes</span><span class="op" id="2958867">[</span><span class="ident" id="2958868">h</span><span class="op" id="2958869">]</span><span class="op" id="2958870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2958876">panic</span><span class="op" id="2958881">(</span><span class="string" id="2958882">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="2958921">)</span><br>
<span class="lineno"></span><span class="op" id="2958923">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2958926">var</span>&nbsp;<span class="ident" id="2958930">hashes</span>&nbsp;<span class="op" id="2958937">=</span>&nbsp;<span class="builtinfunc" id="2958939">make</span><span class="op" id="2958943">(</span><span class="op" id="2958944">[</span><span class="op" id="2958945">]</span><span class="keyword" id="2958946">func</span><span class="op" id="2958950">(</span><span class="op" id="2958951">)</span>&nbsp;<span class="ident" id="2958953">hash</span><span class="op" id="2958957">.</span><span class="ident" id="2958958">Hash</span><span class="op" id="2958962">,</span>&nbsp;<span class="ident" id="2958964">maxHash</span><span class="op" id="2958971">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2958974">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="2959053">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="2959108">func</span>&nbsp;<span class="op" id="2959113">(</span><span class="ident" id="2959114">h</span>&nbsp;<span class="ident" id="2959116">Hash</span><span class="op" id="2959120">)</span>&nbsp;<span class="ident" id="2959122">New</span><span class="op" id="2959125">(</span><span class="op" id="2959126">)</span>&nbsp;<span class="ident" id="2959128">hash</span><span class="op" id="2959132">.</span><span class="ident" id="2959133">Hash</span>&nbsp;<span class="op" id="2959138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959141">if</span>&nbsp;<span class="ident" id="2959144">h</span>&nbsp;<span class="op" id="2959146">&gt;</span>&nbsp;<span class="num" id="2959148">0</span>&nbsp;<span class="op" id="2959150">&amp;&amp;</span>&nbsp;<span class="ident" id="2959153">h</span>&nbsp;<span class="op" id="2959155">&lt;</span>&nbsp;<span class="ident" id="2959157">maxHash</span>&nbsp;<span class="op" id="2959165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2959169">f</span>&nbsp;<span class="op" id="2959171">:=</span>&nbsp;<span class="ident" id="2959174">hashes</span><span class="op" id="2959180">[</span><span class="ident" id="2959181">h</span><span class="op" id="2959182">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959186">if</span>&nbsp;<span class="ident" id="2959189">f</span>&nbsp;<span class="op" id="2959191">!=</span>&nbsp;<span class="builtintype" id="2959194">nil</span>&nbsp;<span class="op" id="2959198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959203">return</span>&nbsp;<span class="ident" id="2959210">f</span><span class="op" id="2959211">(</span><span class="op" id="2959212">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2959222">panic</span><span class="op" id="2959227">(</span><span class="string" id="2959228">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="2959264">+</span>&nbsp;<span class="ident" id="2959266">strconv</span><span class="op" id="2959273">.</span><span class="ident" id="2959274">Itoa</span><span class="op" id="2959278">(</span><span class="builtintype" id="2959279">int</span><span class="op" id="2959282">(</span><span class="ident" id="2959283">h</span><span class="op" id="2959284">)</span><span class="op" id="2959285">)</span>&nbsp;<span class="op" id="2959287">+</span>&nbsp;<span class="string" id="2959289">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="2959306">)</span><br>
<span class="lineno"></span><span class="op" id="2959308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="2959311">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="2959391">func</span>&nbsp;<span class="op" id="2959396">(</span><span class="ident" id="2959397">h</span>&nbsp;<span class="ident" id="2959399">Hash</span><span class="op" id="2959403">)</span>&nbsp;<span class="ident" id="2959405">Available</span><span class="op" id="2959414">(</span><span class="op" id="2959415">)</span>&nbsp;<span class="builtintype" id="2959417">bool</span>&nbsp;<span class="op" id="2959422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959425">return</span>&nbsp;<span class="ident" id="2959432">h</span>&nbsp;<span class="op" id="2959434">&lt;</span>&nbsp;<span class="ident" id="2959436">maxHash</span>&nbsp;<span class="op" id="2959444">&amp;&amp;</span>&nbsp;<span class="ident" id="2959447">hashes</span><span class="op" id="2959453">[</span><span class="ident" id="2959454">h</span><span class="op" id="2959455">]</span>&nbsp;<span class="op" id="2959457">!=</span>&nbsp;<span class="builtintype" id="2959460">nil</span><br>
<span class="lineno"></span><span class="op" id="2959464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="2959467">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="2959545">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="2959619">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="2959662">func</span>&nbsp;<span class="ident" id="2959667">RegisterHash</span><span class="op" id="2959679">(</span><span class="ident" id="2959680">h</span>&nbsp;<span class="ident" id="2959682">Hash</span><span class="op" id="2959686">,</span>&nbsp;<span class="ident" id="2959688">f</span>&nbsp;<span class="keyword" id="2959690">func</span><span class="op" id="2959694">(</span><span class="op" id="2959695">)</span>&nbsp;<span class="ident" id="2959697">hash</span><span class="op" id="2959701">.</span><span class="ident" id="2959702">Hash</span><span class="op" id="2959706">)</span>&nbsp;<span class="op" id="2959708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959711">if</span>&nbsp;<span class="ident" id="2959714">h</span>&nbsp;<span class="op" id="2959716">&gt;=</span>&nbsp;<span class="ident" id="2959719">maxHash</span>&nbsp;<span class="op" id="2959727">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2959731">panic</span><span class="op" id="2959736">(</span><span class="string" id="2959737">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="2959784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2959790">hashes</span><span class="op" id="2959796">[</span><span class="ident" id="2959797">h</span><span class="op" id="2959798">]</span>&nbsp;<span class="op" id="2959800">=</span>&nbsp;<span class="ident" id="2959802">f</span><br>
<span class="lineno"></span><span class="op" id="2959804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="2959807">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2959876">type</span>&nbsp;<span class="ident" id="2959881">PublicKey</span>&nbsp;<span class="keyword" id="2959891">interface</span><span class="op" id="2959900">{</span><span class="op" id="2959901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2959904">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="2959975">type</span>&nbsp;<span class="ident" id="2959980">PrivateKey</span>&nbsp;<span class="keyword" id="2959991">interface</span><span class="op" id="2960000">{</span><span class="op" id="2960001">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="2960004">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="2960077">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="2960151">type</span>&nbsp;<span class="ident" id="2960156">Signer</span>&nbsp;<span class="keyword" id="2960163">interface</span>&nbsp;<span class="op" id="2960173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960176">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960239">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960256">Public</span><span class="op" id="2960262">(</span><span class="op" id="2960263">)</span>&nbsp;<span class="ident" id="2960265">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960277">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960346">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960415">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960487">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960554">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960558">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960631">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960704">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960772">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960844">Sign</span><span class="op" id="2960848">(</span><span class="ident" id="2960849">rand</span>&nbsp;<span class="ident" id="2960854">io</span><span class="op" id="2960856">.</span><span class="ident" id="2960857">Reader</span><span class="op" id="2960863">,</span>&nbsp;<span class="ident" id="2960865">msg</span>&nbsp;<span class="op" id="2960869">[</span><span class="op" id="2960870">]</span><span class="builtintype" id="2960871">byte</span><span class="op" id="2960875">,</span>&nbsp;<span class="ident" id="2960877">opts</span>&nbsp;<span class="ident" id="2960882">SignerOpts</span><span class="op" id="2960892">)</span>&nbsp;<span class="op" id="2960894">(</span><span class="ident" id="2960895">signature</span>&nbsp;<span class="op" id="2960905">[</span><span class="op" id="2960906">]</span><span class="builtintype" id="2960907">byte</span><span class="op" id="2960911">,</span>&nbsp;<span class="ident" id="2960913">err</span>&nbsp;<span class="builtintype" id="2960917">error</span><span class="op" id="2960922">)</span><br>
<span class="lineno"></span><span class="op" id="2960924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="2960927">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="2960985">type</span>&nbsp;<span class="ident" id="2960990">SignerOpts</span>&nbsp;<span class="keyword" id="2961001">interface</span>&nbsp;<span class="op" id="2961011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961014">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961087">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961159">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961181">HashFunc</span><span class="op" id="2961189">(</span><span class="op" id="2961190">)</span>&nbsp;<span class="ident" id="2961192">Hash</span><br>
<span class="lineno"></span><span class="op" id="2961197">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
