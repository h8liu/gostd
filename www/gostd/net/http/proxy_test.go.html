<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html" class="current">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7705611">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7705666">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7705720">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7705771">package</span>&nbsp;<span class="ident" id="7705779">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7705785">import</span>&nbsp;<span class="op" id="7705792">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7705795">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7705806">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7705812">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7705822">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7705825">//&nbsp;TODO(mattn):</span><br>
<span class="lineno"></span><span class="comment" id="7705841">//&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;ProxyAuth</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7705860">var</span>&nbsp;<span class="ident" id="7705864">UseProxyTests</span>&nbsp;<span class="op" id="7705878">=</span>&nbsp;<span class="op" id="7705880">[</span><span class="op" id="7705881">]</span><span class="keyword" id="7705882">struct</span>&nbsp;<span class="op" id="7705889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7705892">host</span>&nbsp;&nbsp;<span class="builtintype" id="7705898">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7705906">match</span>&nbsp;<span class="builtintype" id="7705912">bool</span><br>
<span class="lineno"></span><span class="op" id="7705917">}</span><span class="op" id="7705918">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7705921">//&nbsp;Never&nbsp;proxy&nbsp;localhost:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7705948">{</span><span class="string" id="7705949">&#34;localhost:80&#34;</span><span class="op" id="7705963">,</span>&nbsp;<span class="builtintype" id="7705965">false</span><span class="op" id="7705970">}</span><span class="op" id="7705971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7705974">{</span><span class="string" id="7705975">&#34;127.0.0.1&#34;</span><span class="op" id="7705986">,</span>&nbsp;<span class="builtintype" id="7705988">false</span><span class="op" id="7705993">}</span><span class="op" id="7705994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7705997">{</span><span class="string" id="7705998">&#34;127.0.0.2&#34;</span><span class="op" id="7706009">,</span>&nbsp;<span class="builtintype" id="7706011">false</span><span class="op" id="7706016">}</span><span class="op" id="7706017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706020">{</span><span class="string" id="7706021">&#34;[::1]&#34;</span><span class="op" id="7706028">,</span>&nbsp;<span class="builtintype" id="7706030">false</span><span class="op" id="7706035">}</span><span class="op" id="7706036">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706039">{</span><span class="string" id="7706040">&#34;[::2]&#34;</span><span class="op" id="7706047">,</span>&nbsp;<span class="builtintype" id="7706049">true</span><span class="op" id="7706053">}</span><span class="op" id="7706054">,</span>&nbsp;<span class="comment" id="7706056">//&nbsp;not&nbsp;a&nbsp;loopback&nbsp;address</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706084">{</span><span class="string" id="7706085">&#34;barbaz.net&#34;</span><span class="op" id="7706097">,</span>&nbsp;<span class="builtintype" id="7706099">false</span><span class="op" id="7706104">}</span><span class="op" id="7706105">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7706111">//&nbsp;match&nbsp;as&nbsp;.barbaz.net</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706136">{</span><span class="string" id="7706137">&#34;foobar.com&#34;</span><span class="op" id="7706149">,</span>&nbsp;<span class="builtintype" id="7706151">false</span><span class="op" id="7706156">}</span><span class="op" id="7706157">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7706163">//&nbsp;have&nbsp;a&nbsp;port&nbsp;but&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706189">{</span><span class="string" id="7706190">&#34;foofoobar.com&#34;</span><span class="op" id="7706205">,</span>&nbsp;<span class="builtintype" id="7706207">true</span><span class="op" id="7706211">}</span><span class="op" id="7706212">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7706216">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;foobar.com</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706254">{</span><span class="string" id="7706255">&#34;baz.com&#34;</span><span class="op" id="7706264">,</span>&nbsp;<span class="builtintype" id="7706266">true</span><span class="op" id="7706270">}</span><span class="op" id="7706271">,</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7706281">//&nbsp;not&nbsp;match&nbsp;as&nbsp;a&nbsp;part&nbsp;of&nbsp;barbaz.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706319">{</span><span class="string" id="7706320">&#34;localhost.net&#34;</span><span class="op" id="7706335">,</span>&nbsp;<span class="builtintype" id="7706337">true</span><span class="op" id="7706341">}</span><span class="op" id="7706342">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7706346">//&nbsp;not&nbsp;match&nbsp;as&nbsp;suffix&nbsp;of&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706381">{</span><span class="string" id="7706382">&#34;local.localhost&#34;</span><span class="op" id="7706399">,</span>&nbsp;<span class="builtintype" id="7706401">true</span><span class="op" id="7706405">}</span><span class="op" id="7706406">,</span>&nbsp;<span class="comment" id="7706408">//&nbsp;not&nbsp;match&nbsp;as&nbsp;prefix&nbsp;as&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706443">{</span><span class="string" id="7706444">&#34;barbarbaz.net&#34;</span><span class="op" id="7706459">,</span>&nbsp;<span class="builtintype" id="7706461">true</span><span class="op" id="7706465">}</span><span class="op" id="7706466">,</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7706470">//&nbsp;not&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;have&nbsp;a&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706512">{</span><span class="string" id="7706513">&#34;www.foobar.com&#34;</span><span class="op" id="7706529">,</span>&nbsp;<span class="builtintype" id="7706531">false</span><span class="op" id="7706536">}</span><span class="op" id="7706537">,</span>&nbsp;<span class="comment" id="7706539">//&nbsp;match&nbsp;because&nbsp;NO_PROXY&nbsp;includes&nbsp;&#34;foobar.com&#34;</span><br>
<span class="lineno">35</span><span class="op" id="7706587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7706590">func</span>&nbsp;<span class="ident" id="7706595">TestUseProxy</span><span class="op" id="7706607">(</span><span class="ident" id="7706608">t</span>&nbsp;<span class="op" id="7706610">*</span><span class="ident" id="7706611">testing</span><span class="op" id="7706618">.</span><span class="ident" id="7706619">T</span><span class="op" id="7706620">)</span>&nbsp;<span class="op" id="7706622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706625">ResetProxyEnv</span><span class="op" id="7706638">(</span><span class="op" id="7706639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706642">os</span><span class="op" id="7706644">.</span><span class="ident" id="7706645">Setenv</span><span class="op" id="7706651">(</span><span class="string" id="7706652">&#34;NO_PROXY&#34;</span><span class="op" id="7706662">,</span>&nbsp;<span class="string" id="7706664">&#34;foobar.com,&nbsp;.barbaz.net&#34;</span><span class="op" id="7706689">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7706692">for</span>&nbsp;<span class="ident" id="7706696">_</span><span class="op" id="7706697">,</span>&nbsp;<span class="ident" id="7706699">test</span>&nbsp;<span class="op" id="7706704">:=</span>&nbsp;<span class="keyword" id="7706707">range</span>&nbsp;<span class="ident" id="7706713">UseProxyTests</span>&nbsp;<span class="op" id="7706727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7706731">if</span>&nbsp;<span class="ident" id="7706734">useProxy</span><span class="op" id="7706742">(</span><span class="ident" id="7706743">test</span><span class="op" id="7706747">.</span><span class="ident" id="7706748">host</span><span class="op" id="7706752">+</span><span class="string" id="7706753">&#34;:80&#34;</span><span class="op" id="7706758">)</span>&nbsp;<span class="op" id="7706760">!=</span>&nbsp;<span class="ident" id="7706763">test</span><span class="op" id="7706767">.</span><span class="ident" id="7706768">match</span>&nbsp;<span class="op" id="7706774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706779">t</span><span class="op" id="7706780">.</span><span class="ident" id="7706781">Errorf</span><span class="op" id="7706787">(</span><span class="string" id="7706788">&#34;useProxy(%v)&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7706816">,</span>&nbsp;<span class="ident" id="7706818">test</span><span class="op" id="7706822">.</span><span class="ident" id="7706823">host</span><span class="op" id="7706827">,</span>&nbsp;<span class="op" id="7706829">!</span><span class="ident" id="7706830">test</span><span class="op" id="7706834">.</span><span class="ident" id="7706835">match</span><span class="op" id="7706840">,</span>&nbsp;<span class="ident" id="7706842">test</span><span class="op" id="7706846">.</span><span class="ident" id="7706847">match</span><span class="op" id="7706852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706859">}</span><br>
<span class="lineno">45</span><span class="op" id="7706861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7706864">var</span>&nbsp;<span class="ident" id="7706868">cacheKeysTests</span>&nbsp;<span class="op" id="7706883">=</span>&nbsp;<span class="op" id="7706885">[</span><span class="op" id="7706886">]</span><span class="keyword" id="7706887">struct</span>&nbsp;<span class="op" id="7706894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706897">proxy</span>&nbsp;&nbsp;<span class="builtintype" id="7706904">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706912">scheme</span>&nbsp;<span class="builtintype" id="7706919">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706927">addr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7706934">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7706942">key</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7706949">string</span><br>
<span class="lineno"></span><span class="op" id="7706956">}</span><span class="op" id="7706957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7706960">{</span><span class="string" id="7706961">&#34;&#34;</span><span class="op" id="7706963">,</span>&nbsp;<span class="string" id="7706965">&#34;http&#34;</span><span class="op" id="7706971">,</span>&nbsp;<span class="string" id="7706973">&#34;foo.com&#34;</span><span class="op" id="7706982">,</span>&nbsp;<span class="string" id="7706984">&#34;|http|foo.com&#34;</span><span class="op" id="7706999">}</span><span class="op" id="7707000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707003">{</span><span class="string" id="7707004">&#34;&#34;</span><span class="op" id="7707006">,</span>&nbsp;<span class="string" id="7707008">&#34;https&#34;</span><span class="op" id="7707015">,</span>&nbsp;<span class="string" id="7707017">&#34;foo.com&#34;</span><span class="op" id="7707026">,</span>&nbsp;<span class="string" id="7707028">&#34;|https|foo.com&#34;</span><span class="op" id="7707044">}</span><span class="op" id="7707045">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707048">{</span><span class="string" id="7707049">&#34;http://foo.com&#34;</span><span class="op" id="7707065">,</span>&nbsp;<span class="string" id="7707067">&#34;http&#34;</span><span class="op" id="7707073">,</span>&nbsp;<span class="string" id="7707075">&#34;foo.com&#34;</span><span class="op" id="7707084">,</span>&nbsp;<span class="string" id="7707086">&#34;http://foo.com|http|&#34;</span><span class="op" id="7707108">}</span><span class="op" id="7707109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707112">{</span><span class="string" id="7707113">&#34;http://foo.com&#34;</span><span class="op" id="7707129">,</span>&nbsp;<span class="string" id="7707131">&#34;https&#34;</span><span class="op" id="7707138">,</span>&nbsp;<span class="string" id="7707140">&#34;foo.com&#34;</span><span class="op" id="7707149">,</span>&nbsp;<span class="string" id="7707151">&#34;http://foo.com|https|foo.com&#34;</span><span class="op" id="7707181">}</span><span class="op" id="7707182">,</span><br>
<span class="lineno"></span><span class="op" id="7707184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7707187">func</span>&nbsp;<span class="ident" id="7707192">TestCacheKeys</span><span class="op" id="7707205">(</span><span class="ident" id="7707206">t</span>&nbsp;<span class="op" id="7707208">*</span><span class="ident" id="7707209">testing</span><span class="op" id="7707216">.</span><span class="ident" id="7707217">T</span><span class="op" id="7707218">)</span>&nbsp;<span class="op" id="7707220">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707223">for</span>&nbsp;<span class="ident" id="7707227">_</span><span class="op" id="7707228">,</span>&nbsp;<span class="ident" id="7707230">tt</span>&nbsp;<span class="op" id="7707233">:=</span>&nbsp;<span class="keyword" id="7707236">range</span>&nbsp;<span class="ident" id="7707242">cacheKeysTests</span>&nbsp;<span class="op" id="7707257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707261">var</span>&nbsp;<span class="ident" id="7707265">proxy</span>&nbsp;<span class="op" id="7707271">*</span><span class="ident" id="7707272">url</span><span class="op" id="7707275">.</span><span class="ident" id="7707276">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707282">if</span>&nbsp;<span class="ident" id="7707285">tt</span><span class="op" id="7707287">.</span><span class="ident" id="7707288">proxy</span>&nbsp;<span class="op" id="7707294">!=</span>&nbsp;<span class="string" id="7707297">&#34;&#34;</span>&nbsp;<span class="op" id="7707300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707305">u</span><span class="op" id="7707306">,</span>&nbsp;<span class="ident" id="7707308">err</span>&nbsp;<span class="op" id="7707312">:=</span>&nbsp;<span class="ident" id="7707315">url</span><span class="op" id="7707318">.</span><span class="ident" id="7707319">Parse</span><span class="op" id="7707324">(</span><span class="ident" id="7707325">tt</span><span class="op" id="7707327">.</span><span class="ident" id="7707328">proxy</span><span class="op" id="7707333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707338">if</span>&nbsp;<span class="ident" id="7707341">err</span>&nbsp;<span class="op" id="7707345">!=</span>&nbsp;<span class="builtintype" id="7707348">nil</span>&nbsp;<span class="op" id="7707352">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707358">t</span><span class="op" id="7707359">.</span><span class="ident" id="7707360">Fatal</span><span class="op" id="7707365">(</span><span class="ident" id="7707366">err</span><span class="op" id="7707369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707379">proxy</span>&nbsp;<span class="op" id="7707385">=</span>&nbsp;<span class="ident" id="7707387">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707395">cm</span>&nbsp;<span class="op" id="7707398">:=</span>&nbsp;<span class="ident" id="7707401">connectMethod</span><span class="op" id="7707414">{</span><span class="ident" id="7707415">proxy</span><span class="op" id="7707420">,</span>&nbsp;<span class="ident" id="7707422">tt</span><span class="op" id="7707424">.</span><span class="ident" id="7707425">scheme</span><span class="op" id="7707431">,</span>&nbsp;<span class="ident" id="7707433">tt</span><span class="op" id="7707435">.</span><span class="ident" id="7707436">addr</span><span class="op" id="7707440">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707444">if</span>&nbsp;<span class="ident" id="7707447">got</span>&nbsp;<span class="op" id="7707451">:=</span>&nbsp;<span class="ident" id="7707454">cm</span><span class="op" id="7707456">.</span><span class="ident" id="7707457">key</span><span class="op" id="7707460">(</span><span class="op" id="7707461">)</span><span class="op" id="7707462">.</span><span class="ident" id="7707463">String</span><span class="op" id="7707469">(</span><span class="op" id="7707470">)</span><span class="op" id="7707471">;</span>&nbsp;<span class="ident" id="7707473">got</span>&nbsp;<span class="op" id="7707477">!=</span>&nbsp;<span class="ident" id="7707480">tt</span><span class="op" id="7707482">.</span><span class="ident" id="7707483">key</span>&nbsp;<span class="op" id="7707487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707492">t</span><span class="op" id="7707493">.</span><span class="ident" id="7707494">Fatalf</span><span class="op" id="7707500">(</span><span class="string" id="7707501">&#34;{%q,&nbsp;%q,&nbsp;%q}&nbsp;cache&nbsp;key&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7707539">,</span>&nbsp;<span class="ident" id="7707541">tt</span><span class="op" id="7707543">.</span><span class="ident" id="7707544">proxy</span><span class="op" id="7707549">,</span>&nbsp;<span class="ident" id="7707551">tt</span><span class="op" id="7707553">.</span><span class="ident" id="7707554">scheme</span><span class="op" id="7707560">,</span>&nbsp;<span class="ident" id="7707562">tt</span><span class="op" id="7707564">.</span><span class="ident" id="7707565">addr</span><span class="op" id="7707569">,</span>&nbsp;<span class="ident" id="7707571">got</span><span class="op" id="7707574">,</span>&nbsp;<span class="ident" id="7707576">tt</span><span class="op" id="7707578">.</span><span class="ident" id="7707579">key</span><span class="op" id="7707582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707589">}</span><br>
<span class="lineno"></span><span class="op" id="7707591">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7707594">func</span>&nbsp;<span class="ident" id="7707599">ResetProxyEnv</span><span class="op" id="7707612">(</span><span class="op" id="7707613">)</span>&nbsp;<span class="op" id="7707615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7707618">for</span>&nbsp;<span class="ident" id="7707622">_</span><span class="op" id="7707623">,</span>&nbsp;<span class="ident" id="7707625">v</span>&nbsp;<span class="op" id="7707627">:=</span>&nbsp;<span class="keyword" id="7707630">range</span>&nbsp;<span class="op" id="7707636">[</span><span class="op" id="7707637">]</span><span class="builtintype" id="7707638">string</span><span class="op" id="7707644">{</span><span class="string" id="7707645">&#34;HTTP_PROXY&#34;</span><span class="op" id="7707657">,</span>&nbsp;<span class="string" id="7707659">&#34;http_proxy&#34;</span><span class="op" id="7707671">,</span>&nbsp;<span class="string" id="7707673">&#34;NO_PROXY&#34;</span><span class="op" id="7707683">,</span>&nbsp;<span class="string" id="7707685">&#34;no_proxy&#34;</span><span class="op" id="7707695">}</span>&nbsp;<span class="op" id="7707697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707701">os</span><span class="op" id="7707703">.</span><span class="ident" id="7707704">Setenv</span><span class="op" id="7707710">(</span><span class="ident" id="7707711">v</span><span class="op" id="7707712">,</span>&nbsp;<span class="string" id="7707714">&#34;&#34;</span><span class="op" id="7707716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7707719">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7707722">ResetCachedEnvironment</span><span class="op" id="7707744">(</span><span class="op" id="7707745">)</span><br>
<span class="lineno"></span><span class="op" id="7707747">}</span>
</div>
</body>
</html>
