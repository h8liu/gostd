<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>expvar</h2>
<ul>
<li><a href="/gostd/expvar/expvar.go.html" class="current">expvar.go</a></li>
<li><a href="/gostd/expvar/expvar_test.go.html">expvar_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4063890">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4063945">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4063999">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4064050">//&nbsp;Package&nbsp;expvar&nbsp;provides&nbsp;a&nbsp;standardized&nbsp;interface&nbsp;to&nbsp;public&nbsp;variables,&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4064128">//&nbsp;as&nbsp;operation&nbsp;counters&nbsp;in&nbsp;servers.&nbsp;It&nbsp;exposes&nbsp;these&nbsp;variables&nbsp;via&nbsp;HTTP&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4064204">//&nbsp;/debug/vars&nbsp;in&nbsp;JSON&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="4064235">//</span><br>
<span class="lineno"></span><span class="comment" id="4064238">//&nbsp;Operations&nbsp;to&nbsp;set&nbsp;or&nbsp;modify&nbsp;these&nbsp;public&nbsp;variables&nbsp;are&nbsp;atomic.</span><br>
<span class="lineno">10</span><span class="comment" id="4064304">//</span><br>
<span class="lineno"></span><span class="comment" id="4064307">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;adding&nbsp;the&nbsp;HTTP&nbsp;handler,&nbsp;this&nbsp;package&nbsp;registers&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4064377">//&nbsp;following&nbsp;variables:</span><br>
<span class="lineno"></span><span class="comment" id="4064401">//</span><br>
<span class="lineno"></span><span class="comment" id="4064404">//&nbsp;&nbsp;&nbsp;&nbsp;cmdline&nbsp;&nbsp;&nbsp;os.Args</span><br>
<span class="lineno">15</span><span class="comment" id="4064425">//&nbsp;&nbsp;&nbsp;&nbsp;memstats&nbsp;&nbsp;runtime.Memstats</span><br>
<span class="lineno"></span><span class="comment" id="4064455">//</span><br>
<span class="lineno"></span><span class="comment" id="4064458">//&nbsp;The&nbsp;package&nbsp;is&nbsp;sometimes&nbsp;only&nbsp;imported&nbsp;for&nbsp;the&nbsp;side&nbsp;effect&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4064523">//&nbsp;registering&nbsp;its&nbsp;HTTP&nbsp;handler&nbsp;and&nbsp;the&nbsp;above&nbsp;variables.&nbsp;&nbsp;To&nbsp;use&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4064591">//&nbsp;this&nbsp;way,&nbsp;link&nbsp;this&nbsp;package&nbsp;into&nbsp;your&nbsp;program:</span><br>
<span class="lineno">20</span><span class="comment" id="4064641">//&nbsp;&nbsp;&nbsp;&nbsp;import&nbsp;_&nbsp;&#34;expvar&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4064662">//</span><br>
<span class="lineno"></span><span class="keyword" id="4064665">package</span>&nbsp;<span class="ident" id="4064673">expvar</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4064681">import</span>&nbsp;<span class="op" id="4064688">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064691">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064700">&#34;encoding/json&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064717">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064724">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064731">&#34;net/http&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064743">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064749">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064760">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064768">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4064779">&#34;sync&#34;</span><br>
<span class="lineno">35</span><span class="op" id="4064786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4064789">//&nbsp;Var&nbsp;is&nbsp;an&nbsp;abstract&nbsp;type&nbsp;for&nbsp;all&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="4064844">type</span>&nbsp;<span class="ident" id="4064849">Var</span>&nbsp;<span class="keyword" id="4064853">interface</span>&nbsp;<span class="op" id="4064863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064866">String</span><span class="op" id="4064872">(</span><span class="op" id="4064873">)</span>&nbsp;<span class="builtintype" id="4064875">string</span><br>
<span class="lineno">40</span><span class="op" id="4064882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4064885">//&nbsp;Int&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;integer&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4064955">type</span>&nbsp;<span class="ident" id="4064960">Int</span>&nbsp;<span class="keyword" id="4064964">struct</span>&nbsp;<span class="op" id="4064971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064974">mu</span>&nbsp;<span class="ident" id="4064977"><a href="/gostd/expvar/expvar.go.html#4064779">sync</a></span><span class="op" id="4064981">.</span><span class="ident" id="4064982"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064991">i</span>&nbsp;&nbsp;<span class="builtintype" id="4064994">int64</span><br>
<span class="lineno"></span><span class="op" id="4065000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065003">func</span>&nbsp;<span class="op" id="4065008">(</span><span class="ident" id="4065009">v</span>&nbsp;<span class="op" id="4065011">*</span><span class="ident" id="4065012"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4065015">)</span>&nbsp;<span class="ident" id="4065017">String</span><span class="op" id="4065023">(</span><span class="op" id="4065024">)</span>&nbsp;<span class="builtintype" id="4065026">string</span>&nbsp;<span class="op" id="4065033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065036"><a href="/gostd/expvar/expvar.go.html#4065009">v</a></span><span class="op" id="4065037">.</span><span class="ident" id="4065038"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065040">.</span><span class="ident" id="4065041"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4065046">(</span><span class="op" id="4065047">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065050">defer</span>&nbsp;<span class="ident" id="4065056"><a href="/gostd/expvar/expvar.go.html#4065009">v</a></span><span class="op" id="4065057">.</span><span class="ident" id="4065058"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065060">.</span><span class="ident" id="4065061"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4065068">(</span><span class="op" id="4065069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065072">return</span>&nbsp;<span class="ident" id="4065079"><a href="/gostd/expvar/expvar.go.html#4064768">strconv</a></span><span class="op" id="4065086">.</span><span class="ident" id="4065087"><a href="/gostd/strconv/itoa.go.html#2407133">FormatInt</a></span><span class="op" id="4065096">(</span><span class="ident" id="4065097"><a href="/gostd/expvar/expvar.go.html#4065009">v</a></span><span class="op" id="4065098">.</span><span class="ident" id="4065099"><a href="/gostd/expvar/expvar.go.html#4064991">i</a></span><span class="op" id="4065100">,</span>&nbsp;<span class="num" id="4065102">10</span><span class="op" id="4065104">)</span><br>
<span class="lineno"></span><span class="op" id="4065106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065109">func</span>&nbsp;<span class="op" id="4065114">(</span><span class="ident" id="4065115">v</span>&nbsp;<span class="op" id="4065117">*</span><span class="ident" id="4065118"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4065121">)</span>&nbsp;<span class="ident" id="4065123">Add</span><span class="op" id="4065126">(</span><span class="ident" id="4065127">delta</span>&nbsp;<span class="builtintype" id="4065133">int64</span><span class="op" id="4065138">)</span>&nbsp;<span class="op" id="4065140">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065143"><a href="/gostd/expvar/expvar.go.html#4065115">v</a></span><span class="op" id="4065144">.</span><span class="ident" id="4065145"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065147">.</span><span class="ident" id="4065148"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4065152">(</span><span class="op" id="4065153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065156">defer</span>&nbsp;<span class="ident" id="4065162"><a href="/gostd/expvar/expvar.go.html#4065115">v</a></span><span class="op" id="4065163">.</span><span class="ident" id="4065164"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065166">.</span><span class="ident" id="4065167"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4065173">(</span><span class="op" id="4065174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065177"><a href="/gostd/expvar/expvar.go.html#4065115">v</a></span><span class="op" id="4065178">.</span><span class="ident" id="4065179"><a href="/gostd/expvar/expvar.go.html#4064991">i</a></span>&nbsp;<span class="op" id="4065181">+=</span>&nbsp;<span class="ident" id="4065184"><a href="/gostd/expvar/expvar.go.html#4065127">delta</a></span><br>
<span class="lineno"></span><span class="op" id="4065190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="4065193">func</span>&nbsp;<span class="op" id="4065198">(</span><span class="ident" id="4065199">v</span>&nbsp;<span class="op" id="4065201">*</span><span class="ident" id="4065202"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4065205">)</span>&nbsp;<span class="ident" id="4065207">Set</span><span class="op" id="4065210">(</span><span class="ident" id="4065211">value</span>&nbsp;<span class="builtintype" id="4065217">int64</span><span class="op" id="4065222">)</span>&nbsp;<span class="op" id="4065224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065227"><a href="/gostd/expvar/expvar.go.html#4065199">v</a></span><span class="op" id="4065228">.</span><span class="ident" id="4065229"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065231">.</span><span class="ident" id="4065232"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4065236">(</span><span class="op" id="4065237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065240">defer</span>&nbsp;<span class="ident" id="4065246"><a href="/gostd/expvar/expvar.go.html#4065199">v</a></span><span class="op" id="4065247">.</span><span class="ident" id="4065248"><a href="/gostd/expvar/expvar.go.html#4064974">mu</a></span><span class="op" id="4065250">.</span><span class="ident" id="4065251"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4065257">(</span><span class="op" id="4065258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065261"><a href="/gostd/expvar/expvar.go.html#4065199">v</a></span><span class="op" id="4065262">.</span><span class="ident" id="4065263"><a href="/gostd/expvar/expvar.go.html#4064991">i</a></span>&nbsp;<span class="op" id="4065265">=</span>&nbsp;<span class="ident" id="4065267"><a href="/gostd/expvar/expvar.go.html#4065211">value</a></span><br>
<span class="lineno"></span><span class="op" id="4065273">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="4065276">//&nbsp;Float&nbsp;is&nbsp;a&nbsp;64-bit&nbsp;float&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4065346">type</span>&nbsp;<span class="ident" id="4065351">Float</span>&nbsp;<span class="keyword" id="4065357">struct</span>&nbsp;<span class="op" id="4065364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065367">mu</span>&nbsp;<span class="ident" id="4065370"><a href="/gostd/expvar/expvar.go.html#4064779">sync</a></span><span class="op" id="4065374">.</span><span class="ident" id="4065375"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065384">f</span>&nbsp;&nbsp;<span class="builtintype" id="4065387">float64</span><br>
<span class="lineno">70</span><span class="op" id="4065395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4065398">func</span>&nbsp;<span class="op" id="4065403">(</span><span class="ident" id="4065404">v</span>&nbsp;<span class="op" id="4065406">*</span><span class="ident" id="4065407"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4065412">)</span>&nbsp;<span class="ident" id="4065414">String</span><span class="op" id="4065420">(</span><span class="op" id="4065421">)</span>&nbsp;<span class="builtintype" id="4065423">string</span>&nbsp;<span class="op" id="4065430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065433"><a href="/gostd/expvar/expvar.go.html#4065404">v</a></span><span class="op" id="4065434">.</span><span class="ident" id="4065435"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065437">.</span><span class="ident" id="4065438"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4065443">(</span><span class="op" id="4065444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065447">defer</span>&nbsp;<span class="ident" id="4065453"><a href="/gostd/expvar/expvar.go.html#4065404">v</a></span><span class="op" id="4065454">.</span><span class="ident" id="4065455"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065457">.</span><span class="ident" id="4065458"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4065465">(</span><span class="op" id="4065466">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065469">return</span>&nbsp;<span class="ident" id="4065476"><a href="/gostd/expvar/expvar.go.html#4064768">strconv</a></span><span class="op" id="4065483">.</span><span class="ident" id="4065484"><a href="/gostd/strconv/ftoa.go.html#2386940">FormatFloat</a></span><span class="op" id="4065495">(</span><span class="ident" id="4065496"><a href="/gostd/expvar/expvar.go.html#4065404">v</a></span><span class="op" id="4065497">.</span><span class="ident" id="4065498"><a href="/gostd/expvar/expvar.go.html#4065384">f</a></span><span class="op" id="4065499">,</span>&nbsp;<span class="string" id="4065501">&#39;g&#39;</span><span class="op" id="4065504">,</span>&nbsp;<span class="op" id="4065506">-</span><span class="num" id="4065507">1</span><span class="op" id="4065508">,</span>&nbsp;<span class="num" id="4065510">64</span><span class="op" id="4065512">)</span><br>
<span class="lineno"></span><span class="op" id="4065514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4065517">//&nbsp;Add&nbsp;adds&nbsp;delta&nbsp;to&nbsp;v.</span><br>
<span class="lineno"></span><span class="keyword" id="4065541">func</span>&nbsp;<span class="op" id="4065546">(</span><span class="ident" id="4065547">v</span>&nbsp;<span class="op" id="4065549">*</span><span class="ident" id="4065550"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4065555">)</span>&nbsp;<span class="ident" id="4065557">Add</span><span class="op" id="4065560">(</span><span class="ident" id="4065561">delta</span>&nbsp;<span class="builtintype" id="4065567">float64</span><span class="op" id="4065574">)</span>&nbsp;<span class="op" id="4065576">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065579"><a href="/gostd/expvar/expvar.go.html#4065547">v</a></span><span class="op" id="4065580">.</span><span class="ident" id="4065581"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065583">.</span><span class="ident" id="4065584"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4065588">(</span><span class="op" id="4065589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065592">defer</span>&nbsp;<span class="ident" id="4065598"><a href="/gostd/expvar/expvar.go.html#4065547">v</a></span><span class="op" id="4065599">.</span><span class="ident" id="4065600"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065602">.</span><span class="ident" id="4065603"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4065609">(</span><span class="op" id="4065610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065613"><a href="/gostd/expvar/expvar.go.html#4065547">v</a></span><span class="op" id="4065614">.</span><span class="ident" id="4065615"><a href="/gostd/expvar/expvar.go.html#4065384">f</a></span>&nbsp;<span class="op" id="4065617">+=</span>&nbsp;<span class="ident" id="4065620"><a href="/gostd/expvar/expvar.go.html#4065561">delta</a></span><br>
<span class="lineno"></span><span class="op" id="4065626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4065629">//&nbsp;Set&nbsp;sets&nbsp;v&nbsp;to&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4065653">func</span>&nbsp;<span class="op" id="4065658">(</span><span class="ident" id="4065659">v</span>&nbsp;<span class="op" id="4065661">*</span><span class="ident" id="4065662"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4065667">)</span>&nbsp;<span class="ident" id="4065669">Set</span><span class="op" id="4065672">(</span><span class="ident" id="4065673">value</span>&nbsp;<span class="builtintype" id="4065679">float64</span><span class="op" id="4065686">)</span>&nbsp;<span class="op" id="4065688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065691"><a href="/gostd/expvar/expvar.go.html#4065659">v</a></span><span class="op" id="4065692">.</span><span class="ident" id="4065693"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065695">.</span><span class="ident" id="4065696"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4065700">(</span><span class="op" id="4065701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065704">defer</span>&nbsp;<span class="ident" id="4065710"><a href="/gostd/expvar/expvar.go.html#4065659">v</a></span><span class="op" id="4065711">.</span><span class="ident" id="4065712"><a href="/gostd/expvar/expvar.go.html#4065367">mu</a></span><span class="op" id="4065714">.</span><span class="ident" id="4065715"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4065721">(</span><span class="op" id="4065722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065725"><a href="/gostd/expvar/expvar.go.html#4065659">v</a></span><span class="op" id="4065726">.</span><span class="ident" id="4065727"><a href="/gostd/expvar/expvar.go.html#4065384">f</a></span>&nbsp;<span class="op" id="4065729">=</span>&nbsp;<span class="ident" id="4065731"><a href="/gostd/expvar/expvar.go.html#4065673">value</a></span><br>
<span class="lineno">90</span><span class="op" id="4065737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4065740">//&nbsp;Map&nbsp;is&nbsp;a&nbsp;string-to-Var&nbsp;map&nbsp;variable&nbsp;that&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4065813">type</span>&nbsp;<span class="ident" id="4065818">Map</span>&nbsp;<span class="keyword" id="4065822">struct</span>&nbsp;<span class="op" id="4065829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065832">mu</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4065837"><a href="/gostd/expvar/expvar.go.html#4064779">sync</a></span><span class="op" id="4065841">.</span><span class="ident" id="4065842"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065851">m</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065856">map</span><span class="op" id="4065859">[</span><span class="builtintype" id="4065860">string</span><span class="op" id="4065866">]</span><span class="ident" id="4065867"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065872">keys</span>&nbsp;<span class="op" id="4065877">[</span><span class="op" id="4065878">]</span><span class="builtintype" id="4065879">string</span>&nbsp;<span class="comment" id="4065886">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="4065896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4065899">//&nbsp;KeyValue&nbsp;represents&nbsp;a&nbsp;single&nbsp;entry&nbsp;in&nbsp;a&nbsp;Map.</span><br>
<span class="lineno">100</span><span class="keyword" id="4065947">type</span>&nbsp;<span class="ident" id="4065952">KeyValue</span>&nbsp;<span class="keyword" id="4065961">struct</span>&nbsp;<span class="op" id="4065968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065971">Key</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4065977">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065985">Value</span>&nbsp;<span class="ident" id="4065991"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><br>
<span class="lineno"></span><span class="op" id="4065995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4065998">func</span>&nbsp;<span class="op" id="4066003">(</span><span class="ident" id="4066004">v</span>&nbsp;<span class="op" id="4066006">*</span><span class="ident" id="4066007"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066010">)</span>&nbsp;<span class="ident" id="4066012">String</span><span class="op" id="4066018">(</span><span class="op" id="4066019">)</span>&nbsp;<span class="builtintype" id="4066021">string</span>&nbsp;<span class="op" id="4066028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066031"><a href="/gostd/expvar/expvar.go.html#4066004">v</a></span><span class="op" id="4066032">.</span><span class="ident" id="4066033"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066035">.</span><span class="ident" id="4066036"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4066041">(</span><span class="op" id="4066042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066045">defer</span>&nbsp;<span class="ident" id="4066051"><a href="/gostd/expvar/expvar.go.html#4066004">v</a></span><span class="op" id="4066052">.</span><span class="ident" id="4066053"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066055">.</span><span class="ident" id="4066056"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4066063">(</span><span class="op" id="4066064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066067">var</span>&nbsp;<span class="ident" id="4066071">b</span>&nbsp;<span class="ident" id="4066073"><a href="/gostd/expvar/expvar.go.html#4064691">bytes</a></span><span class="op" id="4066078">.</span><span class="ident" id="4066079"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066087"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4066090">.</span><span class="ident" id="4066091"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4066098">(</span><span class="op" id="4066099">&amp;</span><span class="ident" id="4066100"><a href="/gostd/expvar/expvar.go.html#4066071">b</a></span><span class="op" id="4066101">,</span>&nbsp;<span class="string" id="4066103">&#34;{&#34;</span><span class="op" id="4066106">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066109">first</span>&nbsp;<span class="op" id="4066115">:=</span>&nbsp;<span class="builtintype" id="4066118">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066124"><a href="/gostd/expvar/expvar.go.html#4066004">v</a></span><span class="op" id="4066125">.</span><span class="ident" id="4066126"><a href="/gostd/expvar/expvar.go.html#4067965">doLocked</a></span><span class="op" id="4066134">(</span><span class="keyword" id="4066135">func</span><span class="op" id="4066139">(</span><span class="ident" id="4066140">kv</span>&nbsp;<span class="ident" id="4066143"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4066151">)</span>&nbsp;<span class="op" id="4066153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066157">if</span>&nbsp;<span class="op" id="4066160">!</span><span class="ident" id="4066161"><a href="/gostd/expvar/expvar.go.html#4066109">first</a></span>&nbsp;<span class="op" id="4066167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066172"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4066175">.</span><span class="ident" id="4066176"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4066183">(</span><span class="op" id="4066184">&amp;</span><span class="ident" id="4066185"><a href="/gostd/expvar/expvar.go.html#4066071">b</a></span><span class="op" id="4066186">,</span>&nbsp;<span class="string" id="4066188">&#34;,&nbsp;&#34;</span><span class="op" id="4066192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066196">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066200"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4066203">.</span><span class="ident" id="4066204"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4066211">(</span><span class="op" id="4066212">&amp;</span><span class="ident" id="4066213"><a href="/gostd/expvar/expvar.go.html#4066071">b</a></span><span class="op" id="4066214">,</span>&nbsp;<span class="string" id="4066216">&#34;%q:&nbsp;%v&#34;</span><span class="op" id="4066224">,</span>&nbsp;<span class="ident" id="4066226"><a href="/gostd/expvar/expvar.go.html#4066140">kv</a></span><span class="op" id="4066228">.</span><span class="ident" id="4066229"><a href="/gostd/expvar/expvar.go.html#4065971">Key</a></span><span class="op" id="4066232">,</span>&nbsp;<span class="ident" id="4066234"><a href="/gostd/expvar/expvar.go.html#4066140">kv</a></span><span class="op" id="4066236">.</span><span class="ident" id="4066237"><a href="/gostd/expvar/expvar.go.html#4065985">Value</a></span><span class="op" id="4066242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066246"><a href="/gostd/expvar/expvar.go.html#4066109">first</a></span>&nbsp;<span class="op" id="4066252">=</span>&nbsp;<span class="builtintype" id="4066254">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066261">}</span><span class="op" id="4066262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066265"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4066268">.</span><span class="ident" id="4066269"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4066276">(</span><span class="op" id="4066277">&amp;</span><span class="ident" id="4066278"><a href="/gostd/expvar/expvar.go.html#4066071">b</a></span><span class="op" id="4066279">,</span>&nbsp;<span class="string" id="4066281">&#34;}&#34;</span><span class="op" id="4066284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066287">return</span>&nbsp;<span class="ident" id="4066294"><a href="/gostd/expvar/expvar.go.html#4066071">b</a></span><span class="op" id="4066295">.</span><span class="ident" id="4066296"><a href="/gostd/bytes/buffer.go.html#1384648">String</a></span><span class="op" id="4066302">(</span><span class="op" id="4066303">)</span><br>
<span class="lineno">120</span><span class="op" id="4066305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066308">func</span>&nbsp;<span class="op" id="4066313">(</span><span class="ident" id="4066314">v</span>&nbsp;<span class="op" id="4066316">*</span><span class="ident" id="4066317"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066320">)</span>&nbsp;<span class="ident" id="4066322">Init</span><span class="op" id="4066326">(</span><span class="op" id="4066327">)</span>&nbsp;<span class="op" id="4066329">*</span><span class="ident" id="4066330"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span>&nbsp;<span class="op" id="4066334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066337"><a href="/gostd/expvar/expvar.go.html#4066314">v</a></span><span class="op" id="4066338">.</span><span class="ident" id="4066339"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span>&nbsp;<span class="op" id="4066341">=</span>&nbsp;<span class="builtinfunc" id="4066343">make</span><span class="op" id="4066347">(</span><span class="keyword" id="4066348">map</span><span class="op" id="4066351">[</span><span class="builtintype" id="4066352">string</span><span class="op" id="4066358">]</span><span class="ident" id="4066359"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><span class="op" id="4066362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066365">return</span>&nbsp;<span class="ident" id="4066372"><a href="/gostd/expvar/expvar.go.html#4066314">v</a></span><br>
<span class="lineno">125</span><span class="op" id="4066374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4066377">//&nbsp;updateKeys&nbsp;updates&nbsp;the&nbsp;sorted&nbsp;list&nbsp;of&nbsp;keys&nbsp;in&nbsp;v.keys.</span><br>
<span class="lineno"></span><span class="comment" id="4066434">//&nbsp;must&nbsp;be&nbsp;called&nbsp;with&nbsp;v.mu&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="4066468">func</span>&nbsp;<span class="op" id="4066473">(</span><span class="ident" id="4066474">v</span>&nbsp;<span class="op" id="4066476">*</span><span class="ident" id="4066477"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066480">)</span>&nbsp;<span class="ident" id="4066482">updateKeys</span><span class="op" id="4066492">(</span><span class="op" id="4066493">)</span>&nbsp;<span class="op" id="4066495">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066498">if</span>&nbsp;<span class="builtinfunc" id="4066501">len</span><span class="op" id="4066504">(</span><span class="ident" id="4066505"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066506">.</span><span class="ident" id="4066507"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4066508">)</span>&nbsp;<span class="op" id="4066510">==</span>&nbsp;<span class="builtinfunc" id="4066513">len</span><span class="op" id="4066516">(</span><span class="ident" id="4066517"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066518">.</span><span class="ident" id="4066519"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span><span class="op" id="4066523">)</span>&nbsp;<span class="op" id="4066525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4066529">//&nbsp;No&nbsp;new&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066546">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066557"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066558">.</span><span class="ident" id="4066559"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span>&nbsp;<span class="op" id="4066564">=</span>&nbsp;<span class="ident" id="4066566"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066567">.</span><span class="ident" id="4066568"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span><span class="op" id="4066572">[</span><span class="op" id="4066573">:</span><span class="num" id="4066574">0</span><span class="op" id="4066575">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066578">for</span>&nbsp;<span class="ident" id="4066582">k</span>&nbsp;<span class="op" id="4066584">:=</span>&nbsp;<span class="keyword" id="4066587">range</span>&nbsp;<span class="ident" id="4066593"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066594">.</span><span class="ident" id="4066595"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span>&nbsp;<span class="op" id="4066597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066601"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066602">.</span><span class="ident" id="4066603"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span>&nbsp;<span class="op" id="4066608">=</span>&nbsp;<span class="builtinfunc" id="4066610">append</span><span class="op" id="4066616">(</span><span class="ident" id="4066617"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066618">.</span><span class="ident" id="4066619"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span><span class="op" id="4066623">,</span>&nbsp;<span class="ident" id="4066625"><a href="/gostd/expvar/expvar.go.html#4066582">k</a></span><span class="op" id="4066626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066632"><a href="/gostd/expvar/expvar.go.html#4064760">sort</a></span><span class="op" id="4066636">.</span><span class="ident" id="4066637"><a href="/gostd/sort/sort.go.html#2017831">Strings</a></span><span class="op" id="4066644">(</span><span class="ident" id="4066645"><a href="/gostd/expvar/expvar.go.html#4066474">v</a></span><span class="op" id="4066646">.</span><span class="ident" id="4066647"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span><span class="op" id="4066651">)</span><br>
<span class="lineno"></span><span class="op" id="4066653">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="4066656">func</span>&nbsp;<span class="op" id="4066661">(</span><span class="ident" id="4066662">v</span>&nbsp;<span class="op" id="4066664">*</span><span class="ident" id="4066665"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066668">)</span>&nbsp;<span class="ident" id="4066670">Get</span><span class="op" id="4066673">(</span><span class="ident" id="4066674">key</span>&nbsp;<span class="builtintype" id="4066678">string</span><span class="op" id="4066684">)</span>&nbsp;<span class="ident" id="4066686"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span>&nbsp;<span class="op" id="4066690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066693"><a href="/gostd/expvar/expvar.go.html#4066662">v</a></span><span class="op" id="4066694">.</span><span class="ident" id="4066695"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066697">.</span><span class="ident" id="4066698"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4066703">(</span><span class="op" id="4066704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066707">defer</span>&nbsp;<span class="ident" id="4066713"><a href="/gostd/expvar/expvar.go.html#4066662">v</a></span><span class="op" id="4066714">.</span><span class="ident" id="4066715"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066717">.</span><span class="ident" id="4066718"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4066725">(</span><span class="op" id="4066726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066729">return</span>&nbsp;<span class="ident" id="4066736"><a href="/gostd/expvar/expvar.go.html#4066662">v</a></span><span class="op" id="4066737">.</span><span class="ident" id="4066738"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4066739">[</span><span class="ident" id="4066740"><a href="/gostd/expvar/expvar.go.html#4066674">key</a></span><span class="op" id="4066743">]</span><br>
<span class="lineno">145</span><span class="op" id="4066745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066748">func</span>&nbsp;<span class="op" id="4066753">(</span><span class="ident" id="4066754">v</span>&nbsp;<span class="op" id="4066756">*</span><span class="ident" id="4066757"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066760">)</span>&nbsp;<span class="ident" id="4066762">Set</span><span class="op" id="4066765">(</span><span class="ident" id="4066766">key</span>&nbsp;<span class="builtintype" id="4066770">string</span><span class="op" id="4066776">,</span>&nbsp;<span class="ident" id="4066778">av</span>&nbsp;<span class="ident" id="4066781"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><span class="op" id="4066784">)</span>&nbsp;<span class="op" id="4066786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066789"><a href="/gostd/expvar/expvar.go.html#4066754">v</a></span><span class="op" id="4066790">.</span><span class="ident" id="4066791"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066793">.</span><span class="ident" id="4066794"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4066798">(</span><span class="op" id="4066799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066802">defer</span>&nbsp;<span class="ident" id="4066808"><a href="/gostd/expvar/expvar.go.html#4066754">v</a></span><span class="op" id="4066809">.</span><span class="ident" id="4066810"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066812">.</span><span class="ident" id="4066813"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4066819">(</span><span class="op" id="4066820">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066823"><a href="/gostd/expvar/expvar.go.html#4066754">v</a></span><span class="op" id="4066824">.</span><span class="ident" id="4066825"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4066826">[</span><span class="ident" id="4066827"><a href="/gostd/expvar/expvar.go.html#4066766">key</a></span><span class="op" id="4066830">]</span>&nbsp;<span class="op" id="4066832">=</span>&nbsp;<span class="ident" id="4066834"><a href="/gostd/expvar/expvar.go.html#4066778">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066838"><a href="/gostd/expvar/expvar.go.html#4066754">v</a></span><span class="op" id="4066839">.</span><span class="ident" id="4066840"><a href="/gostd/expvar/expvar.go.html#4066482">updateKeys</a></span><span class="op" id="4066850">(</span><span class="op" id="4066851">)</span><br>
<span class="lineno"></span><span class="op" id="4066853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4066856">func</span>&nbsp;<span class="op" id="4066861">(</span><span class="ident" id="4066862">v</span>&nbsp;<span class="op" id="4066864">*</span><span class="ident" id="4066865"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4066868">)</span>&nbsp;<span class="ident" id="4066870">Add</span><span class="op" id="4066873">(</span><span class="ident" id="4066874">key</span>&nbsp;<span class="builtintype" id="4066878">string</span><span class="op" id="4066884">,</span>&nbsp;<span class="ident" id="4066886">delta</span>&nbsp;<span class="builtintype" id="4066892">int64</span><span class="op" id="4066897">)</span>&nbsp;<span class="op" id="4066899">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066902"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4066903">.</span><span class="ident" id="4066904"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066906">.</span><span class="ident" id="4066907"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4066912">(</span><span class="op" id="4066913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066916">av</span><span class="op" id="4066918">,</span>&nbsp;<span class="ident" id="4066920">ok</span>&nbsp;<span class="op" id="4066923">:=</span>&nbsp;<span class="ident" id="4066926"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4066927">.</span><span class="ident" id="4066928"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4066929">[</span><span class="ident" id="4066930"><a href="/gostd/expvar/expvar.go.html#4066874">key</a></span><span class="op" id="4066933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066936"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4066937">.</span><span class="ident" id="4066938"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4066940">.</span><span class="ident" id="4066941"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4066948">(</span><span class="op" id="4066949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066952">if</span>&nbsp;<span class="op" id="4066955">!</span><span class="ident" id="4066956"><a href="/gostd/expvar/expvar.go.html#4066920">ok</a></span>&nbsp;<span class="op" id="4066959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4066963">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067001"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4067002">.</span><span class="ident" id="4067003"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067005">.</span><span class="ident" id="4067006"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4067010">(</span><span class="op" id="4067011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067015"><a href="/gostd/expvar/expvar.go.html#4066916">av</a></span><span class="op" id="4067017">,</span>&nbsp;<span class="ident" id="4067019"><a href="/gostd/expvar/expvar.go.html#4066920">ok</a></span>&nbsp;<span class="op" id="4067022">=</span>&nbsp;<span class="ident" id="4067024"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4067025">.</span><span class="ident" id="4067026"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4067027">[</span><span class="ident" id="4067028"><a href="/gostd/expvar/expvar.go.html#4066874">key</a></span><span class="op" id="4067031">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067035">if</span>&nbsp;<span class="op" id="4067038">!</span><span class="ident" id="4067039"><a href="/gostd/expvar/expvar.go.html#4066920">ok</a></span>&nbsp;<span class="op" id="4067042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067047"><a href="/gostd/expvar/expvar.go.html#4066916">av</a></span>&nbsp;<span class="op" id="4067050">=</span>&nbsp;<span class="builtinfunc" id="4067052">new</span><span class="op" id="4067055">(</span><span class="ident" id="4067056"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4067059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067064"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4067065">.</span><span class="ident" id="4067066"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4067067">[</span><span class="ident" id="4067068"><a href="/gostd/expvar/expvar.go.html#4066874">key</a></span><span class="op" id="4067071">]</span>&nbsp;<span class="op" id="4067073">=</span>&nbsp;<span class="ident" id="4067075"><a href="/gostd/expvar/expvar.go.html#4066916">av</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067081"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4067082">.</span><span class="ident" id="4067083"><a href="/gostd/expvar/expvar.go.html#4066482">updateKeys</a></span><span class="op" id="4067093">(</span><span class="op" id="4067094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067102"><a href="/gostd/expvar/expvar.go.html#4066862">v</a></span><span class="op" id="4067103">.</span><span class="ident" id="4067104"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067106">.</span><span class="ident" id="4067107"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4067113">(</span><span class="op" id="4067114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4067121">//&nbsp;Add&nbsp;to&nbsp;Int;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067155">if</span>&nbsp;<span class="ident" id="4067158">iv</span><span class="op" id="4067160">,</span>&nbsp;<span class="ident" id="4067162">ok</span>&nbsp;<span class="op" id="4067165">:=</span>&nbsp;<span class="ident" id="4067168"><a href="/gostd/expvar/expvar.go.html#4066916">av</a></span><span class="op" id="4067170">.</span><span class="op" id="4067171">(</span><span class="op" id="4067172">*</span><span class="ident" id="4067173"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4067176">)</span><span class="op" id="4067177">;</span>&nbsp;<span class="ident" id="4067179"><a href="/gostd/expvar/expvar.go.html#4067162">ok</a></span>&nbsp;<span class="op" id="4067182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067186"><a href="/gostd/expvar/expvar.go.html#4067158">iv</a></span><span class="op" id="4067188">.</span><span class="ident" id="4067189"><a href="/gostd/expvar/expvar.go.html#4065123">Add</a></span><span class="op" id="4067192">(</span><span class="ident" id="4067193"><a href="/gostd/expvar/expvar.go.html#4066886">delta</a></span><span class="op" id="4067198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067201">}</span><br>
<span class="lineno"></span><span class="op" id="4067203">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="4067206">//&nbsp;AddFloat&nbsp;adds&nbsp;delta&nbsp;to&nbsp;the&nbsp;*Float&nbsp;value&nbsp;stored&nbsp;under&nbsp;the&nbsp;given&nbsp;map&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4067281">func</span>&nbsp;<span class="op" id="4067286">(</span><span class="ident" id="4067287">v</span>&nbsp;<span class="op" id="4067289">*</span><span class="ident" id="4067290"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4067293">)</span>&nbsp;<span class="ident" id="4067295">AddFloat</span><span class="op" id="4067303">(</span><span class="ident" id="4067304">key</span>&nbsp;<span class="builtintype" id="4067308">string</span><span class="op" id="4067314">,</span>&nbsp;<span class="ident" id="4067316">delta</span>&nbsp;<span class="builtintype" id="4067322">float64</span><span class="op" id="4067329">)</span>&nbsp;<span class="op" id="4067331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067334"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067335">.</span><span class="ident" id="4067336"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067338">.</span><span class="ident" id="4067339"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4067344">(</span><span class="op" id="4067345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067348">av</span><span class="op" id="4067350">,</span>&nbsp;<span class="ident" id="4067352">ok</span>&nbsp;<span class="op" id="4067355">:=</span>&nbsp;<span class="ident" id="4067358"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067359">.</span><span class="ident" id="4067360"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4067361">[</span><span class="ident" id="4067362"><a href="/gostd/expvar/expvar.go.html#4067304">key</a></span><span class="op" id="4067365">]</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067368"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067369">.</span><span class="ident" id="4067370"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067372">.</span><span class="ident" id="4067373"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4067380">(</span><span class="op" id="4067381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067384">if</span>&nbsp;<span class="op" id="4067387">!</span><span class="ident" id="4067388"><a href="/gostd/expvar/expvar.go.html#4067352">ok</a></span>&nbsp;<span class="op" id="4067391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4067395">//&nbsp;check&nbsp;again&nbsp;under&nbsp;the&nbsp;write&nbsp;lock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067433"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067434">.</span><span class="ident" id="4067435"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067437">.</span><span class="ident" id="4067438"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4067442">(</span><span class="op" id="4067443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067447"><a href="/gostd/expvar/expvar.go.html#4067348">av</a></span><span class="op" id="4067449">,</span>&nbsp;<span class="ident" id="4067451"><a href="/gostd/expvar/expvar.go.html#4067352">ok</a></span>&nbsp;<span class="op" id="4067454">=</span>&nbsp;<span class="ident" id="4067456"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067457">.</span><span class="ident" id="4067458"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4067459">[</span><span class="ident" id="4067460"><a href="/gostd/expvar/expvar.go.html#4067304">key</a></span><span class="op" id="4067463">]</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067467">if</span>&nbsp;<span class="op" id="4067470">!</span><span class="ident" id="4067471"><a href="/gostd/expvar/expvar.go.html#4067352">ok</a></span>&nbsp;<span class="op" id="4067474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067479"><a href="/gostd/expvar/expvar.go.html#4067348">av</a></span>&nbsp;<span class="op" id="4067482">=</span>&nbsp;<span class="builtinfunc" id="4067484">new</span><span class="op" id="4067487">(</span><span class="ident" id="4067488"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4067493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067498"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067499">.</span><span class="ident" id="4067500"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4067501">[</span><span class="ident" id="4067502"><a href="/gostd/expvar/expvar.go.html#4067304">key</a></span><span class="op" id="4067505">]</span>&nbsp;<span class="op" id="4067507">=</span>&nbsp;<span class="ident" id="4067509"><a href="/gostd/expvar/expvar.go.html#4067348">av</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067515"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067516">.</span><span class="ident" id="4067517"><a href="/gostd/expvar/expvar.go.html#4066482">updateKeys</a></span><span class="op" id="4067527">(</span><span class="op" id="4067528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067532">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067536"><a href="/gostd/expvar/expvar.go.html#4067287">v</a></span><span class="op" id="4067537">.</span><span class="ident" id="4067538"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067540">.</span><span class="ident" id="4067541"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4067547">(</span><span class="op" id="4067548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4067555">//&nbsp;Add&nbsp;to&nbsp;Float;&nbsp;ignore&nbsp;otherwise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067591">if</span>&nbsp;<span class="ident" id="4067594">iv</span><span class="op" id="4067596">,</span>&nbsp;<span class="ident" id="4067598">ok</span>&nbsp;<span class="op" id="4067601">:=</span>&nbsp;<span class="ident" id="4067604"><a href="/gostd/expvar/expvar.go.html#4067348">av</a></span><span class="op" id="4067606">.</span><span class="op" id="4067607">(</span><span class="op" id="4067608">*</span><span class="ident" id="4067609"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4067614">)</span><span class="op" id="4067615">;</span>&nbsp;<span class="ident" id="4067617"><a href="/gostd/expvar/expvar.go.html#4067598">ok</a></span>&nbsp;<span class="op" id="4067620">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067624"><a href="/gostd/expvar/expvar.go.html#4067594">iv</a></span><span class="op" id="4067626">.</span><span class="ident" id="4067627"><a href="/gostd/expvar/expvar.go.html#4065557">Add</a></span><span class="op" id="4067630">(</span><span class="ident" id="4067631"><a href="/gostd/expvar/expvar.go.html#4067316">delta</a></span><span class="op" id="4067636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067639">}</span><br>
<span class="lineno"></span><span class="op" id="4067641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067644">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno">200</span><span class="comment" id="4067685">//&nbsp;The&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="4067728">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno"></span><span class="keyword" id="4067781">func</span>&nbsp;<span class="op" id="4067786">(</span><span class="ident" id="4067787">v</span>&nbsp;<span class="op" id="4067789">*</span><span class="ident" id="4067790"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4067793">)</span>&nbsp;<span class="ident" id="4067795">Do</span><span class="op" id="4067797">(</span><span class="ident" id="4067798">f</span>&nbsp;<span class="keyword" id="4067800">func</span><span class="op" id="4067804">(</span><span class="ident" id="4067805"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4067813">)</span><span class="op" id="4067814">)</span>&nbsp;<span class="op" id="4067816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067819"><a href="/gostd/expvar/expvar.go.html#4067787">v</a></span><span class="op" id="4067820">.</span><span class="ident" id="4067821"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067823">.</span><span class="ident" id="4067824"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4067829">(</span><span class="op" id="4067830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067833">defer</span>&nbsp;<span class="ident" id="4067839"><a href="/gostd/expvar/expvar.go.html#4067787">v</a></span><span class="op" id="4067840">.</span><span class="ident" id="4067841"><a href="/gostd/expvar/expvar.go.html#4065832">mu</a></span><span class="op" id="4067843">.</span><span class="ident" id="4067844"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4067851">(</span><span class="op" id="4067852">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067855"><a href="/gostd/expvar/expvar.go.html#4067787">v</a></span><span class="op" id="4067856">.</span><span class="ident" id="4067857"><a href="/gostd/expvar/expvar.go.html#4067965">doLocked</a></span><span class="op" id="4067865">(</span><span class="ident" id="4067866"><a href="/gostd/expvar/expvar.go.html#4067798">f</a></span><span class="op" id="4067867">)</span><br>
<span class="lineno"></span><span class="op" id="4067869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4067872">//&nbsp;doLocked&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;entry&nbsp;in&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4067919">//&nbsp;v.mu&nbsp;must&nbsp;be&nbsp;held&nbsp;for&nbsp;reads.</span><br>
<span class="lineno">210</span><span class="keyword" id="4067951">func</span>&nbsp;<span class="op" id="4067956">(</span><span class="ident" id="4067957">v</span>&nbsp;<span class="op" id="4067959">*</span><span class="ident" id="4067960"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4067963">)</span>&nbsp;<span class="ident" id="4067965">doLocked</span><span class="op" id="4067973">(</span><span class="ident" id="4067974">f</span>&nbsp;<span class="keyword" id="4067976">func</span><span class="op" id="4067980">(</span><span class="ident" id="4067981"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4067989">)</span><span class="op" id="4067990">)</span>&nbsp;<span class="op" id="4067992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067995">for</span>&nbsp;<span class="ident" id="4067999">_</span><span class="op" id="4068000">,</span>&nbsp;<span class="ident" id="4068002">k</span>&nbsp;<span class="op" id="4068004">:=</span>&nbsp;<span class="keyword" id="4068007">range</span>&nbsp;<span class="ident" id="4068013"><a href="/gostd/expvar/expvar.go.html#4067957">v</a></span><span class="op" id="4068014">.</span><span class="ident" id="4068015"><a href="/gostd/expvar/expvar.go.html#4065872">keys</a></span>&nbsp;<span class="op" id="4068020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068024"><a href="/gostd/expvar/expvar.go.html#4067974">f</a></span><span class="op" id="4068025">(</span><span class="ident" id="4068026"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4068034">{</span><span class="ident" id="4068035"><a href="/gostd/expvar/expvar.go.html#4068002">k</a></span><span class="op" id="4068036">,</span>&nbsp;<span class="ident" id="4068038"><a href="/gostd/expvar/expvar.go.html#4067957">v</a></span><span class="op" id="4068039">.</span><span class="ident" id="4068040"><a href="/gostd/expvar/expvar.go.html#4065851">m</a></span><span class="op" id="4068041">[</span><span class="ident" id="4068042"><a href="/gostd/expvar/expvar.go.html#4068002">k</a></span><span class="op" id="4068043">]</span><span class="op" id="4068044">}</span><span class="op" id="4068045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4068048">}</span><br>
<span class="lineno"></span><span class="op" id="4068050">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="4068053">//&nbsp;String&nbsp;is&nbsp;a&nbsp;string&nbsp;variable,&nbsp;and&nbsp;satisfies&nbsp;the&nbsp;Var&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="4068118">type</span>&nbsp;<span class="ident" id="4068123">String</span>&nbsp;<span class="keyword" id="4068130">struct</span>&nbsp;<span class="op" id="4068137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068140">mu</span>&nbsp;<span class="ident" id="4068143"><a href="/gostd/expvar/expvar.go.html#4064779">sync</a></span><span class="op" id="4068147">.</span><span class="ident" id="4068148"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068157">s</span>&nbsp;&nbsp;<span class="builtintype" id="4068160">string</span><br>
<span class="lineno">220</span><span class="op" id="4068167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4068170">func</span>&nbsp;<span class="op" id="4068175">(</span><span class="ident" id="4068176">v</span>&nbsp;<span class="op" id="4068178">*</span><span class="ident" id="4068179"><a href="/gostd/expvar/expvar.go.html#4068123">String</a></span><span class="op" id="4068185">)</span>&nbsp;<span class="ident" id="4068187">String</span><span class="op" id="4068193">(</span><span class="op" id="4068194">)</span>&nbsp;<span class="builtintype" id="4068196">string</span>&nbsp;<span class="op" id="4068203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068206"><a href="/gostd/expvar/expvar.go.html#4068176">v</a></span><span class="op" id="4068207">.</span><span class="ident" id="4068208"><a href="/gostd/expvar/expvar.go.html#4068140">mu</a></span><span class="op" id="4068210">.</span><span class="ident" id="4068211"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4068216">(</span><span class="op" id="4068217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068220">defer</span>&nbsp;<span class="ident" id="4068226"><a href="/gostd/expvar/expvar.go.html#4068176">v</a></span><span class="op" id="4068227">.</span><span class="ident" id="4068228"><a href="/gostd/expvar/expvar.go.html#4068140">mu</a></span><span class="op" id="4068230">.</span><span class="ident" id="4068231"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4068238">(</span><span class="op" id="4068239">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068242">return</span>&nbsp;<span class="ident" id="4068249"><a href="/gostd/expvar/expvar.go.html#4064768">strconv</a></span><span class="op" id="4068256">.</span><span class="ident" id="4068257"><a href="/gostd/strconv/quote.go.html#2412032">Quote</a></span><span class="op" id="4068262">(</span><span class="ident" id="4068263"><a href="/gostd/expvar/expvar.go.html#4068176">v</a></span><span class="op" id="4068264">.</span><span class="ident" id="4068265"><a href="/gostd/expvar/expvar.go.html#4068157">s</a></span><span class="op" id="4068266">)</span><br>
<span class="lineno"></span><span class="op" id="4068268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4068271">func</span>&nbsp;<span class="op" id="4068276">(</span><span class="ident" id="4068277">v</span>&nbsp;<span class="op" id="4068279">*</span><span class="ident" id="4068280"><a href="/gostd/expvar/expvar.go.html#4068123">String</a></span><span class="op" id="4068286">)</span>&nbsp;<span class="ident" id="4068288">Set</span><span class="op" id="4068291">(</span><span class="ident" id="4068292">value</span>&nbsp;<span class="builtintype" id="4068298">string</span><span class="op" id="4068304">)</span>&nbsp;<span class="op" id="4068306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068309"><a href="/gostd/expvar/expvar.go.html#4068277">v</a></span><span class="op" id="4068310">.</span><span class="ident" id="4068311"><a href="/gostd/expvar/expvar.go.html#4068140">mu</a></span><span class="op" id="4068313">.</span><span class="ident" id="4068314"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4068318">(</span><span class="op" id="4068319">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068322">defer</span>&nbsp;<span class="ident" id="4068328"><a href="/gostd/expvar/expvar.go.html#4068277">v</a></span><span class="op" id="4068329">.</span><span class="ident" id="4068330"><a href="/gostd/expvar/expvar.go.html#4068140">mu</a></span><span class="op" id="4068332">.</span><span class="ident" id="4068333"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4068339">(</span><span class="op" id="4068340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068343"><a href="/gostd/expvar/expvar.go.html#4068277">v</a></span><span class="op" id="4068344">.</span><span class="ident" id="4068345"><a href="/gostd/expvar/expvar.go.html#4068157">s</a></span>&nbsp;<span class="op" id="4068347">=</span>&nbsp;<span class="ident" id="4068349"><a href="/gostd/expvar/expvar.go.html#4068292">value</a></span><br>
<span class="lineno"></span><span class="op" id="4068355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068358">//&nbsp;Func&nbsp;implements&nbsp;Var&nbsp;by&nbsp;calling&nbsp;the&nbsp;function</span><br>
<span class="lineno">235</span><span class="comment" id="4068405">//&nbsp;and&nbsp;formatting&nbsp;the&nbsp;returned&nbsp;value&nbsp;using&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="4068454">type</span>&nbsp;<span class="ident" id="4068459">Func</span>&nbsp;<span class="keyword" id="4068464">func</span><span class="op" id="4068468">(</span><span class="op" id="4068469">)</span>&nbsp;<span class="keyword" id="4068471">interface</span><span class="op" id="4068480">{</span><span class="op" id="4068481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4068484">func</span>&nbsp;<span class="op" id="4068489">(</span><span class="ident" id="4068490">f</span>&nbsp;<span class="ident" id="4068492"><a href="/gostd/expvar/expvar.go.html#4068459">Func</a></span><span class="op" id="4068496">)</span>&nbsp;<span class="ident" id="4068498">String</span><span class="op" id="4068504">(</span><span class="op" id="4068505">)</span>&nbsp;<span class="builtintype" id="4068507">string</span>&nbsp;<span class="op" id="4068514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068517">v</span><span class="op" id="4068518">,</span>&nbsp;<span class="ident" id="4068520">_</span>&nbsp;<span class="op" id="4068522">:=</span>&nbsp;<span class="ident" id="4068525"><a href="/gostd/expvar/expvar.go.html#4064700">json</a></span><span class="op" id="4068529">.</span><span class="ident" id="4068530"><a href="/gostd/encoding/json/encode.go.html#3995033">Marshal</a></span><span class="op" id="4068537">(</span><span class="ident" id="4068538"><a href="/gostd/expvar/expvar.go.html#4068490">f</a></span><span class="op" id="4068539">(</span><span class="op" id="4068540">)</span><span class="op" id="4068541">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068544">return</span>&nbsp;<span class="builtintype" id="4068551">string</span><span class="op" id="4068557">(</span><span class="ident" id="4068558"><a href="/gostd/expvar/expvar.go.html#4068517">v</a></span><span class="op" id="4068559">)</span><br>
<span class="lineno"></span><span class="op" id="4068561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4068564">//&nbsp;All&nbsp;published&nbsp;variables.</span><br>
<span class="lineno"></span><span class="keyword" id="4068592">var</span>&nbsp;<span class="op" id="4068596">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068599">mutex</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4068607"><a href="/gostd/expvar/expvar.go.html#4064779">sync</a></span><span class="op" id="4068611">.</span><span class="ident" id="4068612"><a href="/gostd/sync/rwmutex.go.html#1456076">RWMutex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068621">vars</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4068629">=</span>&nbsp;<span class="builtinfunc" id="4068631">make</span><span class="op" id="4068635">(</span><span class="keyword" id="4068636">map</span><span class="op" id="4068639">[</span><span class="builtintype" id="4068640">string</span><span class="op" id="4068646">]</span><span class="ident" id="4068647"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><span class="op" id="4068650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068653">varKeys</span>&nbsp;<span class="op" id="4068661">[</span><span class="op" id="4068662">]</span><span class="builtintype" id="4068663">string</span>&nbsp;<span class="comment" id="4068670">//&nbsp;sorted</span><br>
<span class="lineno"></span><span class="op" id="4068680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="4068683">//&nbsp;Publish&nbsp;declares&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.&nbsp;This&nbsp;should&nbsp;be&nbsp;called&nbsp;from&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4068759">//&nbsp;package&#39;s&nbsp;init&nbsp;function&nbsp;when&nbsp;it&nbsp;creates&nbsp;its&nbsp;Vars.&nbsp;If&nbsp;the&nbsp;name&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="4068835">//&nbsp;registered&nbsp;then&nbsp;this&nbsp;will&nbsp;log.Panic.</span><br>
<span class="lineno"></span><span class="keyword" id="4068875">func</span>&nbsp;<span class="ident" id="4068880">Publish</span><span class="op" id="4068887">(</span><span class="ident" id="4068888">name</span>&nbsp;<span class="builtintype" id="4068893">string</span><span class="op" id="4068899">,</span>&nbsp;<span class="ident" id="4068901">v</span>&nbsp;<span class="ident" id="4068903"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span><span class="op" id="4068906">)</span>&nbsp;<span class="op" id="4068908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068911"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4068916">.</span><span class="ident" id="4068917"><a href="/gostd/sync/rwmutex.go.html#1457713">Lock</a></span><span class="op" id="4068921">(</span><span class="op" id="4068922">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068925">defer</span>&nbsp;<span class="ident" id="4068931"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4068936">.</span><span class="ident" id="4068937"><a href="/gostd/sync/rwmutex.go.html#1458554">Unlock</a></span><span class="op" id="4068943">(</span><span class="op" id="4068944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068947">if</span>&nbsp;<span class="ident" id="4068950">_</span><span class="op" id="4068951">,</span>&nbsp;<span class="ident" id="4068953">existing</span>&nbsp;<span class="op" id="4068962">:=</span>&nbsp;<span class="ident" id="4068965"><a href="/gostd/expvar/expvar.go.html#4068621">vars</a></span><span class="op" id="4068969">[</span><span class="ident" id="4068970"><a href="/gostd/expvar/expvar.go.html#4068888">name</a></span><span class="op" id="4068974">]</span><span class="op" id="4068975">;</span>&nbsp;<span class="ident" id="4068977"><a href="/gostd/expvar/expvar.go.html#4068953">existing</a></span>&nbsp;<span class="op" id="4068986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068990"><a href="/gostd/expvar/expvar.go.html#4064724">log</a></span><span class="op" id="4068993">.</span><span class="ident" id="4068994"><a href="/gostd/log/log.go.html#4079811">Panicln</a></span><span class="op" id="4069001">(</span><span class="string" id="4069002">&#34;Reuse&nbsp;of&nbsp;exported&nbsp;var&nbsp;name:&#34;</span><span class="op" id="4069031">,</span>&nbsp;<span class="ident" id="4069033"><a href="/gostd/expvar/expvar.go.html#4068888">name</a></span><span class="op" id="4069037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069043"><a href="/gostd/expvar/expvar.go.html#4068621">vars</a></span><span class="op" id="4069047">[</span><span class="ident" id="4069048"><a href="/gostd/expvar/expvar.go.html#4068888">name</a></span><span class="op" id="4069052">]</span>&nbsp;<span class="op" id="4069054">=</span>&nbsp;<span class="ident" id="4069056"><a href="/gostd/expvar/expvar.go.html#4068901">v</a></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069059"><a href="/gostd/expvar/expvar.go.html#4068653">varKeys</a></span>&nbsp;<span class="op" id="4069067">=</span>&nbsp;<span class="builtinfunc" id="4069069">append</span><span class="op" id="4069075">(</span><span class="ident" id="4069076"><a href="/gostd/expvar/expvar.go.html#4068653">varKeys</a></span><span class="op" id="4069083">,</span>&nbsp;<span class="ident" id="4069085"><a href="/gostd/expvar/expvar.go.html#4068888">name</a></span><span class="op" id="4069089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069092"><a href="/gostd/expvar/expvar.go.html#4064760">sort</a></span><span class="op" id="4069096">.</span><span class="ident" id="4069097"><a href="/gostd/sort/sort.go.html#2017831">Strings</a></span><span class="op" id="4069104">(</span><span class="ident" id="4069105"><a href="/gostd/expvar/expvar.go.html#4068653">varKeys</a></span><span class="op" id="4069112">)</span><br>
<span class="lineno"></span><span class="op" id="4069114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4069117">//&nbsp;Get&nbsp;retrieves&nbsp;a&nbsp;named&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno">265</span><span class="keyword" id="4069161">func</span>&nbsp;<span class="ident" id="4069166">Get</span><span class="op" id="4069169">(</span><span class="ident" id="4069170">name</span>&nbsp;<span class="builtintype" id="4069175">string</span><span class="op" id="4069181">)</span>&nbsp;<span class="ident" id="4069183"><a href="/gostd/expvar/expvar.go.html#4064849">Var</a></span>&nbsp;<span class="op" id="4069187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069190"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4069195">.</span><span class="ident" id="4069196"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4069201">(</span><span class="op" id="4069202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069205">defer</span>&nbsp;<span class="ident" id="4069211"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4069216">.</span><span class="ident" id="4069217"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4069224">(</span><span class="op" id="4069225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069228">return</span>&nbsp;<span class="ident" id="4069235"><a href="/gostd/expvar/expvar.go.html#4068621">vars</a></span><span class="op" id="4069239">[</span><span class="ident" id="4069240"><a href="/gostd/expvar/expvar.go.html#4069170">name</a></span><span class="op" id="4069244">]</span><br>
<span class="lineno"></span><span class="op" id="4069246">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4069249">//&nbsp;Convenience&nbsp;functions&nbsp;for&nbsp;creating&nbsp;new&nbsp;exported&nbsp;variables.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069312">func</span>&nbsp;<span class="ident" id="4069317">NewInt</span><span class="op" id="4069323">(</span><span class="ident" id="4069324">name</span>&nbsp;<span class="builtintype" id="4069329">string</span><span class="op" id="4069335">)</span>&nbsp;<span class="op" id="4069337">*</span><span class="ident" id="4069338"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span>&nbsp;<span class="op" id="4069342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069345">v</span>&nbsp;<span class="op" id="4069347">:=</span>&nbsp;<span class="builtinfunc" id="4069350">new</span><span class="op" id="4069353">(</span><span class="ident" id="4069354"><a href="/gostd/expvar/expvar.go.html#4064960">Int</a></span><span class="op" id="4069357">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069360"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4069367">(</span><span class="ident" id="4069368"><a href="/gostd/expvar/expvar.go.html#4069324">name</a></span><span class="op" id="4069372">,</span>&nbsp;<span class="ident" id="4069374"><a href="/gostd/expvar/expvar.go.html#4069345">v</a></span><span class="op" id="4069375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069378">return</span>&nbsp;<span class="ident" id="4069385"><a href="/gostd/expvar/expvar.go.html#4069345">v</a></span><br>
<span class="lineno"></span><span class="op" id="4069387">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069390">func</span>&nbsp;<span class="ident" id="4069395">NewFloat</span><span class="op" id="4069403">(</span><span class="ident" id="4069404">name</span>&nbsp;<span class="builtintype" id="4069409">string</span><span class="op" id="4069415">)</span>&nbsp;<span class="op" id="4069417">*</span><span class="ident" id="4069418"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span>&nbsp;<span class="op" id="4069424">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069427">v</span>&nbsp;<span class="op" id="4069429">:=</span>&nbsp;<span class="builtinfunc" id="4069432">new</span><span class="op" id="4069435">(</span><span class="ident" id="4069436"><a href="/gostd/expvar/expvar.go.html#4065351">Float</a></span><span class="op" id="4069441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069444"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4069451">(</span><span class="ident" id="4069452"><a href="/gostd/expvar/expvar.go.html#4069404">name</a></span><span class="op" id="4069456">,</span>&nbsp;<span class="ident" id="4069458"><a href="/gostd/expvar/expvar.go.html#4069427">v</a></span><span class="op" id="4069459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069462">return</span>&nbsp;<span class="ident" id="4069469"><a href="/gostd/expvar/expvar.go.html#4069427">v</a></span><br>
<span class="lineno"></span><span class="op" id="4069471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4069474">func</span>&nbsp;<span class="ident" id="4069479">NewMap</span><span class="op" id="4069485">(</span><span class="ident" id="4069486">name</span>&nbsp;<span class="builtintype" id="4069491">string</span><span class="op" id="4069497">)</span>&nbsp;<span class="op" id="4069499">*</span><span class="ident" id="4069500"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span>&nbsp;<span class="op" id="4069504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069507">v</span>&nbsp;<span class="op" id="4069509">:=</span>&nbsp;<span class="builtinfunc" id="4069512">new</span><span class="op" id="4069515">(</span><span class="ident" id="4069516"><a href="/gostd/expvar/expvar.go.html#4065818">Map</a></span><span class="op" id="4069519">)</span><span class="op" id="4069520">.</span><span class="ident" id="4069521"><a href="/gostd/expvar/expvar.go.html#4066322">Init</a></span><span class="op" id="4069525">(</span><span class="op" id="4069526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069529"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4069536">(</span><span class="ident" id="4069537"><a href="/gostd/expvar/expvar.go.html#4069486">name</a></span><span class="op" id="4069541">,</span>&nbsp;<span class="ident" id="4069543"><a href="/gostd/expvar/expvar.go.html#4069507">v</a></span><span class="op" id="4069544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069547">return</span>&nbsp;<span class="ident" id="4069554"><a href="/gostd/expvar/expvar.go.html#4069507">v</a></span><br>
<span class="lineno"></span><span class="op" id="4069556">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="keyword" id="4069559">func</span>&nbsp;<span class="ident" id="4069564">NewString</span><span class="op" id="4069573">(</span><span class="ident" id="4069574">name</span>&nbsp;<span class="builtintype" id="4069579">string</span><span class="op" id="4069585">)</span>&nbsp;<span class="op" id="4069587">*</span><span class="ident" id="4069588"><a href="/gostd/expvar/expvar.go.html#4068123">String</a></span>&nbsp;<span class="op" id="4069595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069598">v</span>&nbsp;<span class="op" id="4069600">:=</span>&nbsp;<span class="builtinfunc" id="4069603">new</span><span class="op" id="4069606">(</span><span class="ident" id="4069607"><a href="/gostd/expvar/expvar.go.html#4068123">String</a></span><span class="op" id="4069613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069616"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4069623">(</span><span class="ident" id="4069624"><a href="/gostd/expvar/expvar.go.html#4069574">name</a></span><span class="op" id="4069628">,</span>&nbsp;<span class="ident" id="4069630"><a href="/gostd/expvar/expvar.go.html#4069598">v</a></span><span class="op" id="4069631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069634">return</span>&nbsp;<span class="ident" id="4069641"><a href="/gostd/expvar/expvar.go.html#4069598">v</a></span><br>
<span class="lineno">295</span><span class="op" id="4069643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4069646">//&nbsp;Do&nbsp;calls&nbsp;f&nbsp;for&nbsp;each&nbsp;exported&nbsp;variable.</span><br>
<span class="lineno"></span><span class="comment" id="4069688">//&nbsp;The&nbsp;global&nbsp;variable&nbsp;map&nbsp;is&nbsp;locked&nbsp;during&nbsp;the&nbsp;iteration,</span><br>
<span class="lineno"></span><span class="comment" id="4069747">//&nbsp;but&nbsp;existing&nbsp;entries&nbsp;may&nbsp;be&nbsp;concurrently&nbsp;updated.</span><br>
<span class="lineno">300</span><span class="keyword" id="4069800">func</span>&nbsp;<span class="ident" id="4069805">Do</span><span class="op" id="4069807">(</span><span class="ident" id="4069808">f</span>&nbsp;<span class="keyword" id="4069810">func</span><span class="op" id="4069814">(</span><span class="ident" id="4069815"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4069823">)</span><span class="op" id="4069824">)</span>&nbsp;<span class="op" id="4069826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069829"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4069834">.</span><span class="ident" id="4069835"><a href="/gostd/sync/rwmutex.go.html#1456490">RLock</a></span><span class="op" id="4069840">(</span><span class="op" id="4069841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069844">defer</span>&nbsp;<span class="ident" id="4069850"><a href="/gostd/expvar/expvar.go.html#4068599">mutex</a></span><span class="op" id="4069855">.</span><span class="ident" id="4069856"><a href="/gostd/sync/rwmutex.go.html#1456952">RUnlock</a></span><span class="op" id="4069863">(</span><span class="op" id="4069864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069867">for</span>&nbsp;<span class="ident" id="4069871">_</span><span class="op" id="4069872">,</span>&nbsp;<span class="ident" id="4069874">k</span>&nbsp;<span class="op" id="4069876">:=</span>&nbsp;<span class="keyword" id="4069879">range</span>&nbsp;<span class="ident" id="4069885"><a href="/gostd/expvar/expvar.go.html#4068653">varKeys</a></span>&nbsp;<span class="op" id="4069893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069897"><a href="/gostd/expvar/expvar.go.html#4069808">f</a></span><span class="op" id="4069898">(</span><span class="ident" id="4069899"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4069907">{</span><span class="ident" id="4069908"><a href="/gostd/expvar/expvar.go.html#4069874">k</a></span><span class="op" id="4069909">,</span>&nbsp;<span class="ident" id="4069911"><a href="/gostd/expvar/expvar.go.html#4068621">vars</a></span><span class="op" id="4069915">[</span><span class="ident" id="4069916"><a href="/gostd/expvar/expvar.go.html#4069874">k</a></span><span class="op" id="4069917">]</span><span class="op" id="4069918">}</span><span class="op" id="4069919">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069922">}</span><br>
<span class="lineno"></span><span class="op" id="4069924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4069927">func</span>&nbsp;<span class="ident" id="4069932">expvarHandler</span><span class="op" id="4069945">(</span><span class="ident" id="4069946">w</span>&nbsp;<span class="ident" id="4069948"><a href="/gostd/expvar/expvar.go.html#4064731">http</a></span><span class="op" id="4069952">.</span><span class="ident" id="4069953"><a href="/gostd/net/http/server.go.html#4170569">ResponseWriter</a></span><span class="op" id="4069967">,</span>&nbsp;<span class="ident" id="4069969">r</span>&nbsp;<span class="op" id="4069971">*</span><span class="ident" id="4069972"><a href="/gostd/expvar/expvar.go.html#4064731">http</a></span><span class="op" id="4069976">.</span><span class="ident" id="4069977"><a href="/gostd/net/http/request.go.html#4135954">Request</a></span><span class="op" id="4069984">)</span>&nbsp;<span class="op" id="4069986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069989"><a href="/gostd/expvar/expvar.go.html#4069946">w</a></span><span class="op" id="4069990">.</span><span class="ident" id="4069991"><a href="/gostd/net/http/server.go.html#4170747">Header</a></span><span class="op" id="4069997">(</span><span class="op" id="4069998">)</span><span class="op" id="4069999">.</span><span class="ident" id="4070000"><a href="/gostd/net/http/header.go.html#4126491">Set</a></span><span class="op" id="4070003">(</span><span class="string" id="4070004">&#34;Content-Type&#34;</span><span class="op" id="4070018">,</span>&nbsp;<span class="string" id="4070020">&#34;application/json;&nbsp;charset=utf-8&#34;</span><span class="op" id="4070053">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070056"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4070059">.</span><span class="ident" id="4070060"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4070067">(</span><span class="ident" id="4070068"><a href="/gostd/expvar/expvar.go.html#4069946">w</a></span><span class="op" id="4070069">,</span>&nbsp;<span class="string" id="4070071">&#34;{\n&#34;</span><span class="op" id="4070076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070079">first</span>&nbsp;<span class="op" id="4070085">:=</span>&nbsp;<span class="builtintype" id="4070088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070094"><a href="/gostd/expvar/expvar.go.html#4069805">Do</a></span><span class="op" id="4070096">(</span><span class="keyword" id="4070097">func</span><span class="op" id="4070101">(</span><span class="ident" id="4070102">kv</span>&nbsp;<span class="ident" id="4070105"><a href="/gostd/expvar/expvar.go.html#4065952">KeyValue</a></span><span class="op" id="4070113">)</span>&nbsp;<span class="op" id="4070115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070119">if</span>&nbsp;<span class="op" id="4070122">!</span><span class="ident" id="4070123"><a href="/gostd/expvar/expvar.go.html#4070079">first</a></span>&nbsp;<span class="op" id="4070129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070134"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4070137">.</span><span class="ident" id="4070138"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4070145">(</span><span class="ident" id="4070146"><a href="/gostd/expvar/expvar.go.html#4069946">w</a></span><span class="op" id="4070147">,</span>&nbsp;<span class="string" id="4070149">&#34;,\n&#34;</span><span class="op" id="4070154">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070162"><a href="/gostd/expvar/expvar.go.html#4070079">first</a></span>&nbsp;<span class="op" id="4070168">=</span>&nbsp;<span class="builtintype" id="4070170">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070178"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4070181">.</span><span class="ident" id="4070182"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4070189">(</span><span class="ident" id="4070190"><a href="/gostd/expvar/expvar.go.html#4069946">w</a></span><span class="op" id="4070191">,</span>&nbsp;<span class="string" id="4070193">&#34;%q:&nbsp;%s&#34;</span><span class="op" id="4070201">,</span>&nbsp;<span class="ident" id="4070203"><a href="/gostd/expvar/expvar.go.html#4070102">kv</a></span><span class="op" id="4070205">.</span><span class="ident" id="4070206"><a href="/gostd/expvar/expvar.go.html#4065971">Key</a></span><span class="op" id="4070209">,</span>&nbsp;<span class="ident" id="4070211"><a href="/gostd/expvar/expvar.go.html#4070102">kv</a></span><span class="op" id="4070213">.</span><span class="ident" id="4070214"><a href="/gostd/expvar/expvar.go.html#4065985">Value</a></span><span class="op" id="4070219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070222">}</span><span class="op" id="4070223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070226"><a href="/gostd/expvar/expvar.go.html#4064717">fmt</a></span><span class="op" id="4070229">.</span><span class="ident" id="4070230"><a href="/gostd/fmt/print.go.html#2143118">Fprintf</a></span><span class="op" id="4070237">(</span><span class="ident" id="4070238"><a href="/gostd/expvar/expvar.go.html#4069946">w</a></span><span class="op" id="4070239">,</span>&nbsp;<span class="string" id="4070241">&#34;\n}\n&#34;</span><span class="op" id="4070248">)</span><br>
<span class="lineno">320</span><span class="op" id="4070250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070253">func</span>&nbsp;<span class="ident" id="4070258">cmdline</span><span class="op" id="4070265">(</span><span class="op" id="4070266">)</span>&nbsp;<span class="keyword" id="4070268">interface</span><span class="op" id="4070277">{</span><span class="op" id="4070278">}</span>&nbsp;<span class="op" id="4070280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070283">return</span>&nbsp;<span class="ident" id="4070290"><a href="/gostd/expvar/expvar.go.html#4064743">os</a></span><span class="op" id="4070292">.</span><span class="ident" id="4070293"><a href="/gostd/os/proc.go.html#2468733">Args</a></span><br>
<span class="lineno"></span><span class="op" id="4070298">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="4070301">func</span>&nbsp;<span class="ident" id="4070306">memstats</span><span class="op" id="4070314">(</span><span class="op" id="4070315">)</span>&nbsp;<span class="keyword" id="4070317">interface</span><span class="op" id="4070326">{</span><span class="op" id="4070327">}</span>&nbsp;<span class="op" id="4070329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070332">stats</span>&nbsp;<span class="op" id="4070338">:=</span>&nbsp;<span class="builtinfunc" id="4070341">new</span><span class="op" id="4070344">(</span><span class="ident" id="4070345"><a href="/gostd/expvar/expvar.go.html#4064749">runtime</a></span><span class="op" id="4070352">.</span><span class="ident" id="4070353"><a href="/gostd/runtime/mem.go.html#1613431">MemStats</a></span><span class="op" id="4070361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070364"><a href="/gostd/expvar/expvar.go.html#4064749">runtime</a></span><span class="op" id="4070371">.</span><span class="ident" id="4070372"><a href="/gostd/runtime/mem.go.html#1615506">ReadMemStats</a></span><span class="op" id="4070384">(</span><span class="ident" id="4070385"><a href="/gostd/expvar/expvar.go.html#4070332">stats</a></span><span class="op" id="4070390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070393">return</span>&nbsp;<span class="op" id="4070400">*</span><span class="ident" id="4070401"><a href="/gostd/expvar/expvar.go.html#4070332">stats</a></span><br>
<span class="lineno">330</span><span class="op" id="4070407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4070410">func</span>&nbsp;<span class="ident" id="4070415">init</span><span class="op" id="4070419">(</span><span class="op" id="4070420">)</span>&nbsp;<span class="op" id="4070422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070425"><a href="/gostd/expvar/expvar.go.html#4064731">http</a></span><span class="op" id="4070429">.</span><span class="ident" id="4070430"><a href="/gostd/net/http/server.go.html#4215953">HandleFunc</a></span><span class="op" id="4070440">(</span><span class="string" id="4070441">&#34;/debug/vars&#34;</span><span class="op" id="4070454">,</span>&nbsp;<span class="ident" id="4070456"><a href="/gostd/expvar/expvar.go.html#4069932">expvarHandler</a></span><span class="op" id="4070469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070472"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4070479">(</span><span class="string" id="4070480">&#34;cmdline&#34;</span><span class="op" id="4070489">,</span>&nbsp;<span class="ident" id="4070491"><a href="/gostd/expvar/expvar.go.html#4068459">Func</a></span><span class="op" id="4070495">(</span><span class="ident" id="4070496"><a href="/gostd/expvar/expvar.go.html#4070258">cmdline</a></span><span class="op" id="4070503">)</span><span class="op" id="4070504">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070507"><a href="/gostd/expvar/expvar.go.html#4068880">Publish</a></span><span class="op" id="4070514">(</span><span class="string" id="4070515">&#34;memstats&#34;</span><span class="op" id="4070525">,</span>&nbsp;<span class="ident" id="4070527"><a href="/gostd/expvar/expvar.go.html#4068459">Func</a></span><span class="op" id="4070531">(</span><span class="ident" id="4070532"><a href="/gostd/expvar/expvar.go.html#4070306">memstats</a></span><span class="op" id="4070540">)</span><span class="op" id="4070541">)</span><br>
<span class="lineno"></span><span class="op" id="4070543">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
