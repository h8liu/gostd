<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7625306">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7625361">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7625415">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7625466">package</span>&nbsp;<span class="ident" id="7625474">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7625480">import</span>&nbsp;<span class="op" id="7625487">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7625490">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7625500">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7625503">var</span>&nbsp;<span class="ident" id="7625507">typeTests</span>&nbsp;<span class="op" id="7625517">=</span>&nbsp;<span class="ident" id="7625519">initMimeForTests</span><span class="op" id="7625535">(</span><span class="op" id="7625536">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7625539">func</span>&nbsp;<span class="ident" id="7625544">TestTypeByExtension</span><span class="op" id="7625563">(</span><span class="ident" id="7625564">t</span>&nbsp;<span class="op" id="7625566">*</span><span class="ident" id="7625567">testing</span><span class="op" id="7625574">.</span><span class="ident" id="7625575">T</span><span class="op" id="7625576">)</span>&nbsp;<span class="op" id="7625578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625581">for</span>&nbsp;<span class="ident" id="7625585">ext</span><span class="op" id="7625588">,</span>&nbsp;<span class="ident" id="7625590">want</span>&nbsp;<span class="op" id="7625595">:=</span>&nbsp;<span class="keyword" id="7625598">range</span>&nbsp;<span class="ident" id="7625604">typeTests</span>&nbsp;<span class="op" id="7625614">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7625618">val</span>&nbsp;<span class="op" id="7625622">:=</span>&nbsp;<span class="ident" id="7625625">TypeByExtension</span><span class="op" id="7625640">(</span><span class="ident" id="7625641">ext</span><span class="op" id="7625644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625648">if</span>&nbsp;<span class="ident" id="7625651">val</span>&nbsp;<span class="op" id="7625655">!=</span>&nbsp;<span class="ident" id="7625658">want</span>&nbsp;<span class="op" id="7625663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7625668">t</span><span class="op" id="7625669">.</span><span class="ident" id="7625670">Errorf</span><span class="op" id="7625676">(</span><span class="string" id="7625677">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7625712">,</span>&nbsp;<span class="ident" id="7625714">ext</span><span class="op" id="7625717">,</span>&nbsp;<span class="ident" id="7625719">val</span><span class="op" id="7625722">,</span>&nbsp;<span class="ident" id="7625724">want</span><span class="op" id="7625728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7625732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7625735">}</span><br>
<span class="lineno">20</span><span class="op" id="7625737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7625740">func</span>&nbsp;<span class="ident" id="7625745">TestTypeByExtensionCase</span><span class="op" id="7625768">(</span><span class="ident" id="7625769">t</span>&nbsp;<span class="op" id="7625771">*</span><span class="ident" id="7625772">testing</span><span class="op" id="7625779">.</span><span class="ident" id="7625780">T</span><span class="op" id="7625781">)</span>&nbsp;<span class="op" id="7625783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625786">const</span>&nbsp;<span class="ident" id="7625792">custom</span>&nbsp;<span class="op" id="7625799">=</span>&nbsp;<span class="string" id="7625801">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625834">const</span>&nbsp;<span class="ident" id="7625840">caps</span>&nbsp;<span class="op" id="7625845">=</span>&nbsp;<span class="string" id="7625847">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625873">if</span>&nbsp;<span class="ident" id="7625876">err</span>&nbsp;<span class="op" id="7625880">:=</span>&nbsp;<span class="ident" id="7625883">AddExtensionType</span><span class="op" id="7625899">(</span><span class="string" id="7625900">&#34;.TEST&#34;</span><span class="op" id="7625907">,</span>&nbsp;<span class="ident" id="7625909">caps</span><span class="op" id="7625913">)</span><span class="op" id="7625914">;</span>&nbsp;<span class="ident" id="7625916">err</span>&nbsp;<span class="op" id="7625920">!=</span>&nbsp;<span class="ident" id="7625923">nil</span>&nbsp;<span class="op" id="7625927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7625931">t</span><span class="op" id="7625932">.</span><span class="ident" id="7625933">Fatalf</span><span class="op" id="7625939">(</span><span class="string" id="7625940">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7625971">,</span>&nbsp;<span class="ident" id="7625973">err</span><span class="op" id="7625976">,</span>&nbsp;<span class="ident" id="7625978">custom</span><span class="op" id="7625984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7625987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7625990">if</span>&nbsp;<span class="ident" id="7625993">err</span>&nbsp;<span class="op" id="7625997">:=</span>&nbsp;<span class="ident" id="7626000">AddExtensionType</span><span class="op" id="7626016">(</span><span class="string" id="7626017">&#34;.tesT&#34;</span><span class="op" id="7626024">,</span>&nbsp;<span class="ident" id="7626026">custom</span><span class="op" id="7626032">)</span><span class="op" id="7626033">;</span>&nbsp;<span class="ident" id="7626035">err</span>&nbsp;<span class="op" id="7626039">!=</span>&nbsp;<span class="ident" id="7626042">nil</span>&nbsp;<span class="op" id="7626046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626050">t</span><span class="op" id="7626051">.</span><span class="ident" id="7626052">Fatalf</span><span class="op" id="7626058">(</span><span class="string" id="7626059">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7626090">,</span>&nbsp;<span class="ident" id="7626092">err</span><span class="op" id="7626095">,</span>&nbsp;<span class="ident" id="7626097">custom</span><span class="op" id="7626103">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7626110">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7626136">if</span>&nbsp;<span class="ident" id="7626139">got</span>&nbsp;<span class="op" id="7626143">:=</span>&nbsp;<span class="ident" id="7626146">TypeByExtension</span><span class="op" id="7626161">(</span><span class="string" id="7626162">&#34;.tesT&#34;</span><span class="op" id="7626169">)</span><span class="op" id="7626170">;</span>&nbsp;<span class="ident" id="7626172">got</span>&nbsp;<span class="op" id="7626176">!=</span>&nbsp;<span class="ident" id="7626179">custom</span>&nbsp;<span class="op" id="7626186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626190">t</span><span class="op" id="7626191">.</span><span class="ident" id="7626192">Fatalf</span><span class="op" id="7626198">(</span><span class="string" id="7626199">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7626227">,</span>&nbsp;<span class="ident" id="7626229">got</span><span class="op" id="7626232">,</span>&nbsp;<span class="ident" id="7626234">custom</span><span class="op" id="7626240">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7626246">if</span>&nbsp;<span class="ident" id="7626249">got</span>&nbsp;<span class="op" id="7626253">:=</span>&nbsp;<span class="ident" id="7626256">TypeByExtension</span><span class="op" id="7626271">(</span><span class="string" id="7626272">&#34;.TEST&#34;</span><span class="op" id="7626279">)</span><span class="op" id="7626280">;</span>&nbsp;<span class="ident" id="7626282">got</span>&nbsp;<span class="op" id="7626286">!=</span>&nbsp;<span class="ident" id="7626289">caps</span>&nbsp;<span class="op" id="7626294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626298">t</span><span class="op" id="7626299">.</span><span class="ident" id="7626300">Fatalf</span><span class="op" id="7626306">(</span><span class="string" id="7626307">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7626335">,</span>&nbsp;<span class="ident" id="7626337">got</span><span class="op" id="7626340">,</span>&nbsp;<span class="ident" id="7626342">caps</span><span class="op" id="7626346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7626353">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7626374">if</span>&nbsp;<span class="ident" id="7626377">got</span>&nbsp;<span class="op" id="7626381">:=</span>&nbsp;<span class="ident" id="7626384">TypeByExtension</span><span class="op" id="7626399">(</span><span class="string" id="7626400">&#34;.TesT&#34;</span><span class="op" id="7626407">)</span><span class="op" id="7626408">;</span>&nbsp;<span class="ident" id="7626410">got</span>&nbsp;<span class="op" id="7626414">!=</span>&nbsp;<span class="ident" id="7626417">custom</span>&nbsp;<span class="op" id="7626424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626428">t</span><span class="op" id="7626429">.</span><span class="ident" id="7626430">Fatalf</span><span class="op" id="7626436">(</span><span class="string" id="7626437">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7626465">,</span>&nbsp;<span class="ident" id="7626467">got</span><span class="op" id="7626470">,</span>&nbsp;<span class="ident" id="7626472">custom</span><span class="op" id="7626478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626481">}</span><br>
<span class="lineno"></span><span class="op" id="7626483">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7626486">func</span>&nbsp;<span class="ident" id="7626491">TestLookupMallocs</span><span class="op" id="7626508">(</span><span class="ident" id="7626509">t</span>&nbsp;<span class="op" id="7626511">*</span><span class="ident" id="7626512">testing</span><span class="op" id="7626519">.</span><span class="ident" id="7626520">T</span><span class="op" id="7626521">)</span>&nbsp;<span class="op" id="7626523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626526">n</span>&nbsp;<span class="op" id="7626528">:=</span>&nbsp;<span class="ident" id="7626531">testing</span><span class="op" id="7626538">.</span><span class="ident" id="7626539">AllocsPerRun</span><span class="op" id="7626551">(</span><span class="num" id="7626552">10000</span><span class="op" id="7626557">,</span>&nbsp;<span class="keyword" id="7626559">func</span><span class="op" id="7626563">(</span><span class="op" id="7626564">)</span>&nbsp;<span class="op" id="7626566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626570">TypeByExtension</span><span class="op" id="7626585">(</span><span class="string" id="7626586">&#34;.html&#34;</span><span class="op" id="7626593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626597">TypeByExtension</span><span class="op" id="7626612">(</span><span class="string" id="7626613">&#34;.HtML&#34;</span><span class="op" id="7626620">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626623">}</span><span class="op" id="7626624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7626627">if</span>&nbsp;<span class="ident" id="7626630">n</span>&nbsp;<span class="op" id="7626632">&gt;</span>&nbsp;<span class="num" id="7626634">0</span>&nbsp;<span class="op" id="7626636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7626640">t</span><span class="op" id="7626641">.</span><span class="ident" id="7626642">Errorf</span><span class="op" id="7626648">(</span><span class="string" id="7626649">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7626670">,</span>&nbsp;<span class="ident" id="7626672">n</span><span class="op" id="7626673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7626676">}</span><br>
<span class="lineno"></span><span class="op" id="7626678">}</span>
</div>
</body>
</html>
