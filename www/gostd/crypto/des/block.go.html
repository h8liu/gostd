<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4321019">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4321074">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4321128">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4321179">package</span>&nbsp;<span class="ident" id="4321187">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4321192">import</span>&nbsp;<span class="op" id="4321199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4321202">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4321220">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4321223">func</span>&nbsp;<span class="ident" id="4321228">cryptBlock</span><span class="op" id="4321238">(</span><span class="ident" id="4321239">subkeys</span>&nbsp;<span class="op" id="4321247">[</span><span class="op" id="4321248">]</span><span class="builtintype" id="4321249">uint64</span><span class="op" id="4321255">,</span>&nbsp;<span class="ident" id="4321257">dst</span><span class="op" id="4321260">,</span>&nbsp;<span class="ident" id="4321262">src</span>&nbsp;<span class="op" id="4321266">[</span><span class="op" id="4321267">]</span><span class="builtintype" id="4321268">byte</span><span class="op" id="4321272">,</span>&nbsp;<span class="ident" id="4321274">decrypt</span>&nbsp;<span class="builtintype" id="4321282">bool</span><span class="op" id="4321286">)</span>&nbsp;<span class="op" id="4321288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321291">b</span>&nbsp;<span class="op" id="4321293">:=</span>&nbsp;<span class="ident" id="4321296">binary</span><span class="op" id="4321302">.</span><span class="ident" id="4321303">BigEndian</span><span class="op" id="4321312">.</span><span class="ident" id="4321313">Uint64</span><span class="op" id="4321319">(</span><span class="ident" id="4321320">src</span><span class="op" id="4321323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321326">b</span>&nbsp;<span class="op" id="4321328">=</span>&nbsp;<span class="ident" id="4321330">permuteInitialBlock</span><span class="op" id="4321349">(</span><span class="ident" id="4321350">b</span><span class="op" id="4321351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321354">left</span><span class="op" id="4321358">,</span>&nbsp;<span class="ident" id="4321360">right</span>&nbsp;<span class="op" id="4321366">:=</span>&nbsp;<span class="builtintype" id="4321369">uint32</span><span class="op" id="4321375">(</span><span class="ident" id="4321376">b</span><span class="op" id="4321377">&gt;&gt;</span><span class="num" id="4321379">32</span><span class="op" id="4321381">)</span><span class="op" id="4321382">,</span>&nbsp;<span class="builtintype" id="4321384">uint32</span><span class="op" id="4321390">(</span><span class="ident" id="4321391">b</span><span class="op" id="4321392">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321396">var</span>&nbsp;<span class="ident" id="4321400">subkey</span>&nbsp;<span class="builtintype" id="4321407">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321415">for</span>&nbsp;<span class="ident" id="4321419">i</span>&nbsp;<span class="op" id="4321421">:=</span>&nbsp;<span class="num" id="4321424">0</span><span class="op" id="4321425">;</span>&nbsp;<span class="ident" id="4321427">i</span>&nbsp;<span class="op" id="4321429">&lt;</span>&nbsp;<span class="num" id="4321431">16</span><span class="op" id="4321433">;</span>&nbsp;<span class="ident" id="4321435">i</span><span class="op" id="4321436">++</span>&nbsp;<span class="op" id="4321439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4321443">if</span>&nbsp;<span class="ident" id="4321446">decrypt</span>&nbsp;<span class="op" id="4321454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321459">subkey</span>&nbsp;<span class="op" id="4321466">=</span>&nbsp;<span class="ident" id="4321468">subkeys</span><span class="op" id="4321475">[</span><span class="num" id="4321476">15</span><span class="op" id="4321478">-</span><span class="ident" id="4321479">i</span><span class="op" id="4321480">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321484">}</span>&nbsp;<span class="keyword" id="4321486">else</span>&nbsp;<span class="op" id="4321491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321496">subkey</span>&nbsp;<span class="op" id="4321503">=</span>&nbsp;<span class="ident" id="4321505">subkeys</span><span class="op" id="4321512">[</span><span class="ident" id="4321513">i</span><span class="op" id="4321514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321523">left</span><span class="op" id="4321527">,</span>&nbsp;<span class="ident" id="4321529">right</span>&nbsp;<span class="op" id="4321535">=</span>&nbsp;<span class="ident" id="4321537">right</span><span class="op" id="4321542">,</span>&nbsp;<span class="ident" id="4321544">left</span><span class="op" id="4321548">^</span><span class="ident" id="4321549">feistel</span><span class="op" id="4321556">(</span><span class="ident" id="4321557">right</span><span class="op" id="4321562">,</span>&nbsp;<span class="ident" id="4321564">subkey</span><span class="op" id="4321570">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4321573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4321576">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321630">preOutput</span>&nbsp;<span class="op" id="4321640">:=</span>&nbsp;<span class="op" id="4321643">(</span><span class="builtintype" id="4321644">uint64</span><span class="op" id="4321650">(</span><span class="ident" id="4321651">right</span><span class="op" id="4321656">)</span>&nbsp;<span class="op" id="4321658">&lt;&lt;</span>&nbsp;<span class="num" id="4321661">32</span><span class="op" id="4321663">)</span>&nbsp;<span class="op" id="4321665">|</span>&nbsp;<span class="builtintype" id="4321667">uint64</span><span class="op" id="4321673">(</span><span class="ident" id="4321674">left</span><span class="op" id="4321678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321681">binary</span><span class="op" id="4321687">.</span><span class="ident" id="4321688">BigEndian</span><span class="op" id="4321697">.</span><span class="ident" id="4321698">PutUint64</span><span class="op" id="4321707">(</span><span class="ident" id="4321708">dst</span><span class="op" id="4321711">,</span>&nbsp;<span class="ident" id="4321713">permuteFinalBlock</span><span class="op" id="4321730">(</span><span class="ident" id="4321731">preOutput</span><span class="op" id="4321740">)</span><span class="op" id="4321741">)</span><br>
<span class="lineno"></span><span class="op" id="4321743">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4321746">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4321805">func</span>&nbsp;<span class="ident" id="4321810">encryptBlock</span><span class="op" id="4321822">(</span><span class="ident" id="4321823">subkeys</span>&nbsp;<span class="op" id="4321831">[</span><span class="op" id="4321832">]</span><span class="builtintype" id="4321833">uint64</span><span class="op" id="4321839">,</span>&nbsp;<span class="ident" id="4321841">dst</span><span class="op" id="4321844">,</span>&nbsp;<span class="ident" id="4321846">src</span>&nbsp;<span class="op" id="4321850">[</span><span class="op" id="4321851">]</span><span class="builtintype" id="4321852">byte</span><span class="op" id="4321856">)</span>&nbsp;<span class="op" id="4321858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4321861">cryptBlock</span><span class="op" id="4321871">(</span><span class="ident" id="4321872">subkeys</span><span class="op" id="4321879">,</span>&nbsp;<span class="ident" id="4321881">dst</span><span class="op" id="4321884">,</span>&nbsp;<span class="ident" id="4321886">src</span><span class="op" id="4321889">,</span>&nbsp;<span class="builtintype" id="4321891">false</span><span class="op" id="4321896">)</span><br>
<span class="lineno"></span><span class="op" id="4321898">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4321901">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4321960">func</span>&nbsp;<span class="ident" id="4321965">decryptBlock</span><span class="op" id="4321977">(</span><span class="ident" id="4321978">subkeys</span>&nbsp;<span class="op" id="4321986">[</span><span class="op" id="4321987">]</span><span class="builtintype" id="4321988">uint64</span><span class="op" id="4321994">,</span>&nbsp;<span class="ident" id="4321996">dst</span><span class="op" id="4321999">,</span>&nbsp;<span class="ident" id="4322001">src</span>&nbsp;<span class="op" id="4322005">[</span><span class="op" id="4322006">]</span><span class="builtintype" id="4322007">byte</span><span class="op" id="4322011">)</span>&nbsp;<span class="op" id="4322013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322016">cryptBlock</span><span class="op" id="4322026">(</span><span class="ident" id="4322027">subkeys</span><span class="op" id="4322034">,</span>&nbsp;<span class="ident" id="4322036">dst</span><span class="op" id="4322039">,</span>&nbsp;<span class="ident" id="4322041">src</span><span class="op" id="4322044">,</span>&nbsp;<span class="builtintype" id="4322046">true</span><span class="op" id="4322050">)</span><br>
<span class="lineno"></span><span class="op" id="4322052">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4322055">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4322079">func</span>&nbsp;<span class="ident" id="4322084">feistel</span><span class="op" id="4322091">(</span><span class="ident" id="4322092">right</span>&nbsp;<span class="builtintype" id="4322098">uint32</span><span class="op" id="4322104">,</span>&nbsp;<span class="ident" id="4322106">key</span>&nbsp;<span class="builtintype" id="4322110">uint64</span><span class="op" id="4322116">)</span>&nbsp;<span class="op" id="4322118">(</span><span class="ident" id="4322119">result</span>&nbsp;<span class="builtintype" id="4322126">uint32</span><span class="op" id="4322132">)</span>&nbsp;<span class="op" id="4322134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322137">sBoxLocations</span>&nbsp;<span class="op" id="4322151">:=</span>&nbsp;<span class="ident" id="4322154">key</span>&nbsp;<span class="op" id="4322158">^</span>&nbsp;<span class="ident" id="4322160">expandBlock</span><span class="op" id="4322171">(</span><span class="ident" id="4322172">right</span><span class="op" id="4322177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322180">var</span>&nbsp;<span class="ident" id="4322184">sBoxResult</span>&nbsp;<span class="builtintype" id="4322195">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322203">for</span>&nbsp;<span class="ident" id="4322207">i</span>&nbsp;<span class="op" id="4322209">:=</span>&nbsp;<span class="builtintype" id="4322212">uint8</span><span class="op" id="4322217">(</span><span class="num" id="4322218">0</span><span class="op" id="4322219">)</span><span class="op" id="4322220">;</span>&nbsp;<span class="ident" id="4322222">i</span>&nbsp;<span class="op" id="4322224">&lt;</span>&nbsp;<span class="num" id="4322226">8</span><span class="op" id="4322227">;</span>&nbsp;<span class="ident" id="4322229">i</span><span class="op" id="4322230">++</span>&nbsp;<span class="op" id="4322233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322237">sBoxLocation</span>&nbsp;<span class="op" id="4322250">:=</span>&nbsp;<span class="builtintype" id="4322253">uint8</span><span class="op" id="4322258">(</span><span class="ident" id="4322259">sBoxLocations</span><span class="op" id="4322272">&gt;&gt;</span><span class="num" id="4322274">42</span><span class="op" id="4322276">)</span>&nbsp;<span class="op" id="4322278">&amp;</span>&nbsp;<span class="num" id="4322280">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322287">sBoxLocations</span>&nbsp;<span class="op" id="4322301">&lt;&lt;=</span>&nbsp;<span class="num" id="4322305">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4322309">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4322348">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322380">row</span>&nbsp;<span class="op" id="4322384">:=</span>&nbsp;<span class="op" id="4322387">(</span><span class="ident" id="4322388">sBoxLocation</span>&nbsp;<span class="op" id="4322401">&amp;</span>&nbsp;<span class="num" id="4322403">0x1</span><span class="op" id="4322406">)</span>&nbsp;<span class="op" id="4322408">|</span>&nbsp;<span class="op" id="4322410">(</span><span class="op" id="4322411">(</span><span class="ident" id="4322412">sBoxLocation</span>&nbsp;<span class="op" id="4322425">&amp;</span>&nbsp;<span class="num" id="4322427">0x20</span><span class="op" id="4322431">)</span>&nbsp;<span class="op" id="4322433">&gt;&gt;</span>&nbsp;<span class="num" id="4322436">4</span><span class="op" id="4322437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322441">column</span>&nbsp;<span class="op" id="4322448">:=</span>&nbsp;<span class="op" id="4322451">(</span><span class="ident" id="4322452">sBoxLocation</span>&nbsp;<span class="op" id="4322465">&gt;&gt;</span>&nbsp;<span class="num" id="4322468">1</span><span class="op" id="4322469">)</span>&nbsp;<span class="op" id="4322471">&amp;</span>&nbsp;<span class="num" id="4322473">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322479">sBoxResult</span>&nbsp;<span class="op" id="4322490">^=</span>&nbsp;<span class="ident" id="4322493">feistelBox</span><span class="op" id="4322503">[</span><span class="ident" id="4322504">i</span><span class="op" id="4322505">]</span><span class="op" id="4322506">[</span><span class="num" id="4322507">16</span><span class="op" id="4322509">*</span><span class="ident" id="4322510">row</span><span class="op" id="4322513">+</span><span class="ident" id="4322514">column</span><span class="op" id="4322520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322526">return</span>&nbsp;<span class="ident" id="4322533">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="4322544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4322547">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4322615">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4322649">var</span>&nbsp;<span class="ident" id="4322653">feistelBox</span>&nbsp;<span class="op" id="4322664">[</span><span class="num" id="4322665">8</span><span class="op" id="4322666">]</span><span class="op" id="4322667">[</span><span class="num" id="4322668">64</span><span class="op" id="4322670">]</span><span class="builtintype" id="4322671">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4322679">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4322741">func</span>&nbsp;<span class="ident" id="4322746">permuteBlock</span><span class="op" id="4322758">(</span><span class="ident" id="4322759">src</span>&nbsp;<span class="builtintype" id="4322763">uint64</span><span class="op" id="4322769">,</span>&nbsp;<span class="ident" id="4322771">permutation</span>&nbsp;<span class="op" id="4322783">[</span><span class="op" id="4322784">]</span><span class="builtintype" id="4322785">uint8</span><span class="op" id="4322790">)</span>&nbsp;<span class="op" id="4322792">(</span><span class="ident" id="4322793">block</span>&nbsp;<span class="builtintype" id="4322799">uint64</span><span class="op" id="4322805">)</span>&nbsp;<span class="op" id="4322807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322810">for</span>&nbsp;<span class="ident" id="4322814">position</span><span class="op" id="4322822">,</span>&nbsp;<span class="ident" id="4322824">n</span>&nbsp;<span class="op" id="4322826">:=</span>&nbsp;<span class="keyword" id="4322829">range</span>&nbsp;<span class="ident" id="4322835">permutation</span>&nbsp;<span class="op" id="4322847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322851">bit</span>&nbsp;<span class="op" id="4322855">:=</span>&nbsp;<span class="op" id="4322858">(</span><span class="ident" id="4322859">src</span>&nbsp;<span class="op" id="4322863">&gt;&gt;</span>&nbsp;<span class="ident" id="4322866">n</span><span class="op" id="4322867">)</span>&nbsp;<span class="op" id="4322869">&amp;</span>&nbsp;<span class="num" id="4322871">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4322875">block</span>&nbsp;<span class="op" id="4322881">|=</span>&nbsp;<span class="ident" id="4322884">bit</span>&nbsp;<span class="op" id="4322888">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4322891">uint</span><span class="op" id="4322895">(</span><span class="op" id="4322896">(</span><span class="builtinfunc" id="4322897">len</span><span class="op" id="4322900">(</span><span class="ident" id="4322901">permutation</span><span class="op" id="4322912">)</span><span class="op" id="4322913">-</span><span class="num" id="4322914">1</span><span class="op" id="4322915">)</span><span class="op" id="4322916">-</span><span class="ident" id="4322917">position</span><span class="op" id="4322925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4322928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322931">return</span><br>
<span class="lineno"></span><span class="op" id="4322938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4322941">func</span>&nbsp;<span class="ident" id="4322946">init</span><span class="op" id="4322950">(</span><span class="op" id="4322951">)</span>&nbsp;<span class="op" id="4322953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322956">for</span>&nbsp;<span class="ident" id="4322960">s</span>&nbsp;<span class="op" id="4322962">:=</span>&nbsp;<span class="keyword" id="4322965">range</span>&nbsp;<span class="ident" id="4322971">sBoxes</span>&nbsp;<span class="op" id="4322978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4322982">for</span>&nbsp;<span class="ident" id="4322986">i</span>&nbsp;<span class="op" id="4322988">:=</span>&nbsp;<span class="num" id="4322991">0</span><span class="op" id="4322992">;</span>&nbsp;<span class="ident" id="4322994">i</span>&nbsp;<span class="op" id="4322996">&lt;</span>&nbsp;<span class="num" id="4322998">4</span><span class="op" id="4322999">;</span>&nbsp;<span class="ident" id="4323001">i</span><span class="op" id="4323002">++</span>&nbsp;<span class="op" id="4323005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323010">for</span>&nbsp;<span class="ident" id="4323014">j</span>&nbsp;<span class="op" id="4323016">:=</span>&nbsp;<span class="num" id="4323019">0</span><span class="op" id="4323020">;</span>&nbsp;<span class="ident" id="4323022">j</span>&nbsp;<span class="op" id="4323024">&lt;</span>&nbsp;<span class="num" id="4323026">16</span><span class="op" id="4323028">;</span>&nbsp;<span class="ident" id="4323030">j</span><span class="op" id="4323031">++</span>&nbsp;<span class="op" id="4323034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323040">f</span>&nbsp;<span class="op" id="4323042">:=</span>&nbsp;<span class="builtintype" id="4323045">uint64</span><span class="op" id="4323051">(</span><span class="ident" id="4323052">sBoxes</span><span class="op" id="4323058">[</span><span class="ident" id="4323059">s</span><span class="op" id="4323060">]</span><span class="op" id="4323061">[</span><span class="ident" id="4323062">i</span><span class="op" id="4323063">]</span><span class="op" id="4323064">[</span><span class="ident" id="4323065">j</span><span class="op" id="4323066">]</span><span class="op" id="4323067">)</span>&nbsp;<span class="op" id="4323069">&lt;&lt;</span>&nbsp;<span class="op" id="4323072">(</span><span class="num" id="4323073">4</span>&nbsp;<span class="op" id="4323075">*</span>&nbsp;<span class="op" id="4323077">(</span><span class="num" id="4323078">7</span>&nbsp;<span class="op" id="4323080">-</span>&nbsp;<span class="builtintype" id="4323082">uint</span><span class="op" id="4323086">(</span><span class="ident" id="4323087">s</span><span class="op" id="4323088">)</span><span class="op" id="4323089">)</span><span class="op" id="4323090">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323096">f</span>&nbsp;<span class="op" id="4323098">=</span>&nbsp;<span class="ident" id="4323100">permuteBlock</span><span class="op" id="4323112">(</span><span class="builtintype" id="4323113">uint64</span><span class="op" id="4323119">(</span><span class="ident" id="4323120">f</span><span class="op" id="4323121">)</span><span class="op" id="4323122">,</span>&nbsp;<span class="ident" id="4323124">permutationFunction</span><span class="op" id="4323143">[</span><span class="op" id="4323144">:</span><span class="op" id="4323145">]</span><span class="op" id="4323146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323152">feistelBox</span><span class="op" id="4323162">[</span><span class="ident" id="4323163">s</span><span class="op" id="4323164">]</span><span class="op" id="4323165">[</span><span class="num" id="4323166">16</span><span class="op" id="4323168">*</span><span class="ident" id="4323169">i</span><span class="op" id="4323170">+</span><span class="ident" id="4323171">j</span><span class="op" id="4323172">]</span>&nbsp;<span class="op" id="4323174">=</span>&nbsp;<span class="builtintype" id="4323176">uint32</span><span class="op" id="4323182">(</span><span class="ident" id="4323183">f</span><span class="op" id="4323184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323196">}</span><br>
<span class="lineno">80</span><span class="op" id="4323198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4323201">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4323251">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4323292">func</span>&nbsp;<span class="ident" id="4323297">expandBlock</span><span class="op" id="4323308">(</span><span class="ident" id="4323309">src</span>&nbsp;<span class="builtintype" id="4323313">uint32</span><span class="op" id="4323319">)</span>&nbsp;<span class="op" id="4323321">(</span><span class="ident" id="4323322">block</span>&nbsp;<span class="builtintype" id="4323328">uint64</span><span class="op" id="4323334">)</span>&nbsp;<span class="op" id="4323336">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323339">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323383">src</span>&nbsp;<span class="op" id="4323387">=</span>&nbsp;<span class="op" id="4323389">(</span><span class="ident" id="4323390">src</span>&nbsp;<span class="op" id="4323394">&lt;&lt;</span>&nbsp;<span class="num" id="4323397">5</span><span class="op" id="4323398">)</span>&nbsp;<span class="op" id="4323400">|</span>&nbsp;<span class="op" id="4323402">(</span><span class="ident" id="4323403">src</span>&nbsp;<span class="op" id="4323407">&gt;&gt;</span>&nbsp;<span class="num" id="4323410">27</span><span class="op" id="4323412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323415">for</span>&nbsp;<span class="ident" id="4323419">i</span>&nbsp;<span class="op" id="4323421">:=</span>&nbsp;<span class="num" id="4323424">0</span><span class="op" id="4323425">;</span>&nbsp;<span class="ident" id="4323427">i</span>&nbsp;<span class="op" id="4323429">&lt;</span>&nbsp;<span class="num" id="4323431">8</span><span class="op" id="4323432">;</span>&nbsp;<span class="ident" id="4323434">i</span><span class="op" id="4323435">++</span>&nbsp;<span class="op" id="4323438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323442">block</span>&nbsp;<span class="op" id="4323448">&lt;&lt;=</span>&nbsp;<span class="num" id="4323452">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323456">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323490">block</span>&nbsp;<span class="op" id="4323496">|=</span>&nbsp;<span class="builtintype" id="4323499">uint64</span><span class="op" id="4323505">(</span><span class="ident" id="4323506">src</span><span class="op" id="4323509">)</span>&nbsp;<span class="op" id="4323511">&amp;</span>&nbsp;<span class="op" id="4323513">(</span><span class="num" id="4323514">1</span><span class="op" id="4323515">&lt;&lt;</span><span class="num" id="4323517">6</span>&nbsp;<span class="op" id="4323519">-</span>&nbsp;<span class="num" id="4323521">1</span><span class="op" id="4323522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323526">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323550">src</span>&nbsp;<span class="op" id="4323554">=</span>&nbsp;<span class="op" id="4323556">(</span><span class="ident" id="4323557">src</span>&nbsp;<span class="op" id="4323561">&lt;&lt;</span>&nbsp;<span class="num" id="4323564">4</span><span class="op" id="4323565">)</span>&nbsp;<span class="op" id="4323567">|</span>&nbsp;<span class="op" id="4323569">(</span><span class="ident" id="4323570">src</span>&nbsp;<span class="op" id="4323574">&gt;&gt;</span>&nbsp;<span class="num" id="4323577">28</span><span class="op" id="4323579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4323582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4323585">return</span><br>
<span class="lineno">95</span><span class="op" id="4323592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4323595">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4323659">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4323685">func</span>&nbsp;<span class="ident" id="4323690">permuteInitialBlock</span><span class="op" id="4323709">(</span><span class="ident" id="4323710">block</span>&nbsp;<span class="builtintype" id="4323716">uint64</span><span class="op" id="4323722">)</span>&nbsp;<span class="builtintype" id="4323724">uint64</span>&nbsp;<span class="op" id="4323731">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323734">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323780">b1</span>&nbsp;<span class="op" id="4323783">:=</span>&nbsp;<span class="ident" id="4323786">block</span>&nbsp;<span class="op" id="4323792">&gt;&gt;</span>&nbsp;<span class="num" id="4323795">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323799">b2</span>&nbsp;<span class="op" id="4323802">:=</span>&nbsp;<span class="ident" id="4323805">block</span>&nbsp;<span class="op" id="4323811">&lt;&lt;</span>&nbsp;<span class="num" id="4323814">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323818">block</span>&nbsp;<span class="op" id="4323824">^=</span>&nbsp;<span class="ident" id="4323827">b1</span>&nbsp;<span class="op" id="4323830">^</span>&nbsp;<span class="ident" id="4323832">b2</span>&nbsp;<span class="op" id="4323835">^</span>&nbsp;<span class="ident" id="4323837">b1</span><span class="op" id="4323839">&lt;&lt;</span><span class="num" id="4323841">48</span>&nbsp;<span class="op" id="4323844">^</span>&nbsp;<span class="ident" id="4323846">b2</span><span class="op" id="4323848">&gt;&gt;</span><span class="num" id="4323850">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4323855">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323891">b1</span>&nbsp;<span class="op" id="4323894">=</span>&nbsp;<span class="ident" id="4323896">block</span>&nbsp;<span class="op" id="4323902">&gt;&gt;</span>&nbsp;<span class="num" id="4323905">32</span>&nbsp;<span class="op" id="4323908">&amp;</span>&nbsp;<span class="num" id="4323910">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323920">b2</span>&nbsp;<span class="op" id="4323923">=</span>&nbsp;<span class="op" id="4323925">(</span><span class="ident" id="4323926">block</span>&nbsp;<span class="op" id="4323932">&amp;</span>&nbsp;<span class="num" id="4323934">0xff00ff00</span><span class="op" id="4323944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4323947">block</span>&nbsp;<span class="op" id="4323953">^=</span>&nbsp;<span class="ident" id="4323956">b1</span><span class="op" id="4323958">&lt;&lt;</span><span class="num" id="4323960">32</span>&nbsp;<span class="op" id="4323963">^</span>&nbsp;<span class="ident" id="4323965">b2</span>&nbsp;<span class="op" id="4323968">^</span>&nbsp;<span class="ident" id="4323970">b1</span><span class="op" id="4323972">&lt;&lt;</span><span class="num" id="4323974">8</span>&nbsp;<span class="op" id="4323976">^</span>&nbsp;<span class="ident" id="4323978">b2</span><span class="op" id="4323980">&lt;&lt;</span><span class="num" id="4323982">24</span>&nbsp;<span class="comment" id="4323985">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324016">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324075">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324131">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324159">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324187">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324215">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324243">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324271">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324300">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324343">b1</span>&nbsp;<span class="op" id="4324346">=</span>&nbsp;<span class="ident" id="4324348">block</span>&nbsp;<span class="op" id="4324354">&amp;</span>&nbsp;<span class="num" id="4324356">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324376">b2</span>&nbsp;<span class="op" id="4324379">=</span>&nbsp;<span class="ident" id="4324381">block</span>&nbsp;<span class="op" id="4324387">&amp;</span>&nbsp;<span class="num" id="4324389">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324409">block</span>&nbsp;<span class="op" id="4324415">^=</span>&nbsp;<span class="ident" id="4324418">b1</span>&nbsp;<span class="op" id="4324421">^</span>&nbsp;<span class="ident" id="4324423">b2</span>&nbsp;<span class="op" id="4324426">^</span>&nbsp;<span class="ident" id="4324428">b1</span><span class="op" id="4324430">&gt;&gt;</span><span class="num" id="4324432">12</span>&nbsp;<span class="op" id="4324435">^</span>&nbsp;<span class="ident" id="4324437">b2</span><span class="op" id="4324439">&lt;&lt;</span><span class="num" id="4324441">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324446">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324476">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324480">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324505">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324509">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324525">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324541">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324557">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324583">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324621">b1</span>&nbsp;<span class="op" id="4324624">=</span>&nbsp;<span class="ident" id="4324626">block</span>&nbsp;<span class="op" id="4324632">&amp;</span>&nbsp;<span class="num" id="4324634">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324654">b2</span>&nbsp;<span class="op" id="4324657">=</span>&nbsp;<span class="ident" id="4324659">block</span>&nbsp;<span class="op" id="4324665">&amp;</span>&nbsp;<span class="num" id="4324667">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324687">block</span>&nbsp;<span class="op" id="4324693">^=</span>&nbsp;<span class="ident" id="4324696">b1</span>&nbsp;<span class="op" id="4324699">^</span>&nbsp;<span class="ident" id="4324701">b2</span>&nbsp;<span class="op" id="4324704">^</span>&nbsp;<span class="ident" id="4324706">b1</span><span class="op" id="4324708">&gt;&gt;</span><span class="num" id="4324710">6</span>&nbsp;<span class="op" id="4324712">^</span>&nbsp;<span class="ident" id="4324714">b2</span><span class="op" id="4324716">&lt;&lt;</span><span class="num" id="4324718">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324722">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324752">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324762">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324772">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324782">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324792">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324802">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324812">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324822">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324851">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324889">b1</span>&nbsp;<span class="op" id="4324892">=</span>&nbsp;<span class="ident" id="4324894">block</span>&nbsp;<span class="op" id="4324900">&amp;</span>&nbsp;<span class="num" id="4324902">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4324922">block</span>&nbsp;<span class="op" id="4324928">^=</span>&nbsp;<span class="ident" id="4324931">b1</span>&nbsp;<span class="op" id="4324934">^</span>&nbsp;<span class="ident" id="4324936">b1</span><span class="op" id="4324938">&gt;&gt;</span><span class="num" id="4324940">33</span>&nbsp;<span class="op" id="4324943">^</span>&nbsp;<span class="ident" id="4324945">b1</span><span class="op" id="4324947">&lt;&lt;</span><span class="num" id="4324949">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324954">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4324984">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325011">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325038">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325065">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325092">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325119">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325146">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325173">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325200">return</span>&nbsp;<span class="ident" id="4325207">block</span><br>
<span class="lineno"></span><span class="op" id="4325213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4325216">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4325280">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4325304">func</span>&nbsp;<span class="ident" id="4325309">permuteFinalBlock</span><span class="op" id="4325326">(</span><span class="ident" id="4325327">block</span>&nbsp;<span class="builtintype" id="4325333">uint64</span><span class="op" id="4325339">)</span>&nbsp;<span class="builtintype" id="4325341">uint64</span>&nbsp;<span class="op" id="4325348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325351">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4325409">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325435">b1</span>&nbsp;<span class="op" id="4325438">:=</span>&nbsp;<span class="ident" id="4325441">block</span>&nbsp;<span class="op" id="4325447">&amp;</span>&nbsp;<span class="num" id="4325449">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325469">block</span>&nbsp;<span class="op" id="4325475">^=</span>&nbsp;<span class="ident" id="4325478">b1</span>&nbsp;<span class="op" id="4325481">^</span>&nbsp;<span class="ident" id="4325483">b1</span><span class="op" id="4325485">&gt;&gt;</span><span class="num" id="4325487">33</span>&nbsp;<span class="op" id="4325490">^</span>&nbsp;<span class="ident" id="4325492">b1</span><span class="op" id="4325494">&lt;&lt;</span><span class="num" id="4325496">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325501">b1</span>&nbsp;<span class="op" id="4325504">=</span>&nbsp;<span class="ident" id="4325506">block</span>&nbsp;<span class="op" id="4325512">&amp;</span>&nbsp;<span class="num" id="4325514">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325534">b2</span>&nbsp;<span class="op" id="4325537">:=</span>&nbsp;<span class="ident" id="4325540">block</span>&nbsp;<span class="op" id="4325546">&amp;</span>&nbsp;<span class="num" id="4325548">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325568">block</span>&nbsp;<span class="op" id="4325574">^=</span>&nbsp;<span class="ident" id="4325577">b1</span>&nbsp;<span class="op" id="4325580">^</span>&nbsp;<span class="ident" id="4325582">b2</span>&nbsp;<span class="op" id="4325585">^</span>&nbsp;<span class="ident" id="4325587">b1</span><span class="op" id="4325589">&gt;&gt;</span><span class="num" id="4325591">6</span>&nbsp;<span class="op" id="4325593">^</span>&nbsp;<span class="ident" id="4325595">b2</span><span class="op" id="4325597">&lt;&lt;</span><span class="num" id="4325599">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325603">b1</span>&nbsp;<span class="op" id="4325606">=</span>&nbsp;<span class="ident" id="4325608">block</span>&nbsp;<span class="op" id="4325614">&amp;</span>&nbsp;<span class="num" id="4325616">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325636">b2</span>&nbsp;<span class="op" id="4325639">=</span>&nbsp;<span class="ident" id="4325641">block</span>&nbsp;<span class="op" id="4325647">&amp;</span>&nbsp;<span class="num" id="4325649">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325669">block</span>&nbsp;<span class="op" id="4325675">^=</span>&nbsp;<span class="ident" id="4325678">b1</span>&nbsp;<span class="op" id="4325681">^</span>&nbsp;<span class="ident" id="4325683">b2</span>&nbsp;<span class="op" id="4325686">^</span>&nbsp;<span class="ident" id="4325688">b1</span><span class="op" id="4325690">&gt;&gt;</span><span class="num" id="4325692">12</span>&nbsp;<span class="op" id="4325695">^</span>&nbsp;<span class="ident" id="4325697">b2</span><span class="op" id="4325699">&lt;&lt;</span><span class="num" id="4325701">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325706">b1</span>&nbsp;<span class="op" id="4325709">=</span>&nbsp;<span class="ident" id="4325711">block</span>&nbsp;<span class="op" id="4325717">&gt;&gt;</span>&nbsp;<span class="num" id="4325720">32</span>&nbsp;<span class="op" id="4325723">&amp;</span>&nbsp;<span class="num" id="4325725">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325735">b2</span>&nbsp;<span class="op" id="4325738">=</span>&nbsp;<span class="op" id="4325740">(</span><span class="ident" id="4325741">block</span>&nbsp;<span class="op" id="4325747">&amp;</span>&nbsp;<span class="num" id="4325749">0xff00ff00</span><span class="op" id="4325759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325762">block</span>&nbsp;<span class="op" id="4325768">^=</span>&nbsp;<span class="ident" id="4325771">b1</span><span class="op" id="4325773">&lt;&lt;</span><span class="num" id="4325775">32</span>&nbsp;<span class="op" id="4325778">^</span>&nbsp;<span class="ident" id="4325780">b2</span>&nbsp;<span class="op" id="4325783">^</span>&nbsp;<span class="ident" id="4325785">b1</span><span class="op" id="4325787">&lt;&lt;</span><span class="num" id="4325789">8</span>&nbsp;<span class="op" id="4325791">^</span>&nbsp;<span class="ident" id="4325793">b2</span><span class="op" id="4325795">&lt;&lt;</span><span class="num" id="4325797">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325802">b1</span>&nbsp;<span class="op" id="4325805">=</span>&nbsp;<span class="ident" id="4325807">block</span>&nbsp;<span class="op" id="4325813">&gt;&gt;</span>&nbsp;<span class="num" id="4325816">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325820">b2</span>&nbsp;<span class="op" id="4325823">=</span>&nbsp;<span class="ident" id="4325825">block</span>&nbsp;<span class="op" id="4325831">&lt;&lt;</span>&nbsp;<span class="num" id="4325834">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4325838">block</span>&nbsp;<span class="op" id="4325844">^=</span>&nbsp;<span class="ident" id="4325847">b1</span>&nbsp;<span class="op" id="4325850">^</span>&nbsp;<span class="ident" id="4325852">b2</span>&nbsp;<span class="op" id="4325855">^</span>&nbsp;<span class="ident" id="4325857">b1</span><span class="op" id="4325859">&lt;&lt;</span><span class="num" id="4325861">48</span>&nbsp;<span class="op" id="4325864">^</span>&nbsp;<span class="ident" id="4325866">b2</span><span class="op" id="4325868">&gt;&gt;</span><span class="num" id="4325870">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4325874">return</span>&nbsp;<span class="ident" id="4325881">block</span><br>
<span class="lineno"></span><span class="op" id="4325887">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4325890">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4325936">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4325964">func</span>&nbsp;<span class="ident" id="4325969">ksRotate</span><span class="op" id="4325977">(</span><span class="ident" id="4325978">in</span>&nbsp;<span class="builtintype" id="4325981">uint32</span><span class="op" id="4325987">)</span>&nbsp;<span class="op" id="4325989">(</span><span class="ident" id="4325990">out</span>&nbsp;<span class="op" id="4325994">[</span><span class="op" id="4325995">]</span><span class="builtintype" id="4325996">uint32</span><span class="op" id="4326002">)</span>&nbsp;<span class="op" id="4326004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326007">out</span>&nbsp;<span class="op" id="4326011">=</span>&nbsp;<span class="builtinfunc" id="4326013">make</span><span class="op" id="4326017">(</span><span class="op" id="4326018">[</span><span class="op" id="4326019">]</span><span class="builtintype" id="4326020">uint32</span><span class="op" id="4326026">,</span>&nbsp;<span class="num" id="4326028">16</span><span class="op" id="4326030">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326033">last</span>&nbsp;<span class="op" id="4326038">:=</span>&nbsp;<span class="ident" id="4326041">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326045">for</span>&nbsp;<span class="ident" id="4326049">i</span>&nbsp;<span class="op" id="4326051">:=</span>&nbsp;<span class="num" id="4326054">0</span><span class="op" id="4326055">;</span>&nbsp;<span class="ident" id="4326057">i</span>&nbsp;<span class="op" id="4326059">&lt;</span>&nbsp;<span class="num" id="4326061">16</span><span class="op" id="4326063">;</span>&nbsp;<span class="ident" id="4326065">i</span><span class="op" id="4326066">++</span>&nbsp;<span class="op" id="4326069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326073">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326105">left</span>&nbsp;<span class="op" id="4326110">:=</span>&nbsp;<span class="op" id="4326113">(</span><span class="ident" id="4326114">last</span>&nbsp;<span class="op" id="4326119">&lt;&lt;</span>&nbsp;<span class="op" id="4326122">(</span><span class="num" id="4326123">4</span>&nbsp;<span class="op" id="4326125">+</span>&nbsp;<span class="ident" id="4326127">ksRotations</span><span class="op" id="4326138">[</span><span class="ident" id="4326139">i</span><span class="op" id="4326140">]</span><span class="op" id="4326141">)</span><span class="op" id="4326142">)</span>&nbsp;<span class="op" id="4326144">&gt;&gt;</span>&nbsp;<span class="num" id="4326147">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326151">right</span>&nbsp;<span class="op" id="4326157">:=</span>&nbsp;<span class="op" id="4326160">(</span><span class="ident" id="4326161">last</span>&nbsp;<span class="op" id="4326166">&lt;&lt;</span>&nbsp;<span class="num" id="4326169">4</span><span class="op" id="4326170">)</span>&nbsp;<span class="op" id="4326172">&gt;&gt;</span>&nbsp;<span class="op" id="4326175">(</span><span class="num" id="4326176">32</span>&nbsp;<span class="op" id="4326179">-</span>&nbsp;<span class="ident" id="4326181">ksRotations</span><span class="op" id="4326192">[</span><span class="ident" id="4326193">i</span><span class="op" id="4326194">]</span><span class="op" id="4326195">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326199">out</span><span class="op" id="4326202">[</span><span class="ident" id="4326203">i</span><span class="op" id="4326204">]</span>&nbsp;<span class="op" id="4326206">=</span>&nbsp;<span class="ident" id="4326208">left</span>&nbsp;<span class="op" id="4326213">|</span>&nbsp;<span class="ident" id="4326215">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326223">last</span>&nbsp;<span class="op" id="4326228">=</span>&nbsp;<span class="ident" id="4326230">out</span><span class="op" id="4326233">[</span><span class="ident" id="4326234">i</span><span class="op" id="4326235">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326241">return</span><br>
<span class="lineno"></span><span class="op" id="4326248">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4326251">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4326302">func</span>&nbsp;<span class="op" id="4326307">(</span><span class="ident" id="4326308">c</span>&nbsp;<span class="op" id="4326310">*</span><span class="ident" id="4326311">desCipher</span><span class="op" id="4326320">)</span>&nbsp;<span class="ident" id="4326322">generateSubkeys</span><span class="op" id="4326337">(</span><span class="ident" id="4326338">keyBytes</span>&nbsp;<span class="op" id="4326347">[</span><span class="op" id="4326348">]</span><span class="builtintype" id="4326349">byte</span><span class="op" id="4326353">)</span>&nbsp;<span class="op" id="4326355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326358">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326391">key</span>&nbsp;<span class="op" id="4326395">:=</span>&nbsp;<span class="ident" id="4326398">binary</span><span class="op" id="4326404">.</span><span class="ident" id="4326405">BigEndian</span><span class="op" id="4326414">.</span><span class="ident" id="4326415">Uint64</span><span class="op" id="4326421">(</span><span class="ident" id="4326422">keyBytes</span><span class="op" id="4326430">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326433">permutedKey</span>&nbsp;<span class="op" id="4326445">:=</span>&nbsp;<span class="ident" id="4326448">permuteBlock</span><span class="op" id="4326460">(</span><span class="ident" id="4326461">key</span><span class="op" id="4326464">,</span>&nbsp;<span class="ident" id="4326466">permutedChoice1</span><span class="op" id="4326481">[</span><span class="op" id="4326482">:</span><span class="op" id="4326483">]</span><span class="op" id="4326484">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326488">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326557">leftRotations</span>&nbsp;<span class="op" id="4326571">:=</span>&nbsp;<span class="ident" id="4326574">ksRotate</span><span class="op" id="4326582">(</span><span class="builtintype" id="4326583">uint32</span><span class="op" id="4326589">(</span><span class="ident" id="4326590">permutedKey</span>&nbsp;<span class="op" id="4326602">&gt;&gt;</span>&nbsp;<span class="num" id="4326605">28</span><span class="op" id="4326607">)</span><span class="op" id="4326608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326611">rightRotations</span>&nbsp;<span class="op" id="4326626">:=</span>&nbsp;<span class="ident" id="4326629">ksRotate</span><span class="op" id="4326637">(</span><span class="builtintype" id="4326638">uint32</span><span class="op" id="4326644">(</span><span class="ident" id="4326645">permutedKey</span><span class="op" id="4326656">&lt;&lt;</span><span class="num" id="4326658">4</span><span class="op" id="4326659">)</span>&nbsp;<span class="op" id="4326661">&gt;&gt;</span>&nbsp;<span class="num" id="4326664">4</span><span class="op" id="4326665">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326669">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4326690">for</span>&nbsp;<span class="ident" id="4326694">i</span>&nbsp;<span class="op" id="4326696">:=</span>&nbsp;<span class="num" id="4326699">0</span><span class="op" id="4326700">;</span>&nbsp;<span class="ident" id="4326702">i</span>&nbsp;<span class="op" id="4326704">&lt;</span>&nbsp;<span class="num" id="4326706">16</span><span class="op" id="4326708">;</span>&nbsp;<span class="ident" id="4326710">i</span><span class="op" id="4326711">++</span>&nbsp;<span class="op" id="4326714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326718">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326766">pc2Input</span>&nbsp;<span class="op" id="4326775">:=</span>&nbsp;<span class="builtintype" id="4326778">uint64</span><span class="op" id="4326784">(</span><span class="ident" id="4326785">leftRotations</span><span class="op" id="4326798">[</span><span class="ident" id="4326799">i</span><span class="op" id="4326800">]</span><span class="op" id="4326801">)</span><span class="op" id="4326802">&lt;&lt;</span><span class="num" id="4326804">28</span>&nbsp;<span class="op" id="4326807">|</span>&nbsp;<span class="builtintype" id="4326809">uint64</span><span class="op" id="4326815">(</span><span class="ident" id="4326816">rightRotations</span><span class="op" id="4326830">[</span><span class="ident" id="4326831">i</span><span class="op" id="4326832">]</span><span class="op" id="4326833">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4326837">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4326880">c</span><span class="op" id="4326881">.</span><span class="ident" id="4326882">subkeys</span><span class="op" id="4326889">[</span><span class="ident" id="4326890">i</span><span class="op" id="4326891">]</span>&nbsp;<span class="op" id="4326893">=</span>&nbsp;<span class="ident" id="4326895">permuteBlock</span><span class="op" id="4326907">(</span><span class="ident" id="4326908">pc2Input</span><span class="op" id="4326916">,</span>&nbsp;<span class="ident" id="4326918">permutedChoice2</span><span class="op" id="4326933">[</span><span class="op" id="4326934">:</span><span class="op" id="4326935">]</span><span class="op" id="4326936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4326939">}</span><br>
<span class="lineno"></span><span class="op" id="4326941">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
