<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3352281">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3352337">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3352391">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3352442">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3352507">package</span>&nbsp;<span class="ident" id="3352515">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3352520">import</span>&nbsp;<span class="op" id="3352527">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3352530">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3352540">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3352547">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3352550">var</span>&nbsp;<span class="ident" id="3352554">onceReadProtocols</span>&nbsp;<span class="ident" id="3352572">sync</span><span class="op" id="3352576">.</span><span class="ident" id="3352577">Once</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3352583">//&nbsp;readProtocols&nbsp;loads&nbsp;contents&nbsp;of&nbsp;/etc/protocols&nbsp;into&nbsp;protocols&nbsp;map</span><br>
<span class="lineno"></span><span class="comment" id="3352652">//&nbsp;for&nbsp;quick&nbsp;access.</span><br>
<span class="lineno"></span><span class="keyword" id="3352673">func</span>&nbsp;<span class="ident" id="3352678">readProtocols</span><span class="op" id="3352691">(</span><span class="op" id="3352692">)</span>&nbsp;<span class="op" id="3352694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3352697">if</span>&nbsp;<span class="ident" id="3352700">file</span><span class="op" id="3352704">,</span>&nbsp;<span class="ident" id="3352706">err</span>&nbsp;<span class="op" id="3352710">:=</span>&nbsp;<span class="ident" id="3352713">open</span><span class="op" id="3352717">(</span><span class="string" id="3352718">&#34;/etc/protocols&#34;</span><span class="op" id="3352734">)</span><span class="op" id="3352735">;</span>&nbsp;<span class="ident" id="3352737">err</span>&nbsp;<span class="op" id="3352741">==</span>&nbsp;<span class="ident" id="3352744">nil</span>&nbsp;<span class="op" id="3352748">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3352752">for</span>&nbsp;<span class="ident" id="3352756">line</span><span class="op" id="3352760">,</span>&nbsp;<span class="ident" id="3352762">ok</span>&nbsp;<span class="op" id="3352765">:=</span>&nbsp;<span class="ident" id="3352768">file</span><span class="op" id="3352772">.</span><span class="ident" id="3352773">readLine</span><span class="op" id="3352781">(</span><span class="op" id="3352782">)</span><span class="op" id="3352783">;</span>&nbsp;<span class="ident" id="3352785">ok</span><span class="op" id="3352787">;</span>&nbsp;<span class="ident" id="3352789">line</span><span class="op" id="3352793">,</span>&nbsp;<span class="ident" id="3352795">ok</span>&nbsp;<span class="op" id="3352798">=</span>&nbsp;<span class="ident" id="3352800">file</span><span class="op" id="3352804">.</span><span class="ident" id="3352805">readLine</span><span class="op" id="3352813">(</span><span class="op" id="3352814">)</span>&nbsp;<span class="op" id="3352816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3352821">//&nbsp;tcp&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;TCP&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transmission&nbsp;control&nbsp;protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3352877">if</span>&nbsp;<span class="ident" id="3352880">i</span>&nbsp;<span class="op" id="3352882">:=</span>&nbsp;<span class="ident" id="3352885">byteIndex</span><span class="op" id="3352894">(</span><span class="ident" id="3352895">line</span><span class="op" id="3352899">,</span>&nbsp;<span class="string" id="3352901">&#39;#&#39;</span><span class="op" id="3352904">)</span><span class="op" id="3352905">;</span>&nbsp;<span class="ident" id="3352907">i</span>&nbsp;<span class="op" id="3352909">&gt;=</span>&nbsp;<span class="num" id="3352912">0</span>&nbsp;<span class="op" id="3352914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3352920">line</span>&nbsp;<span class="op" id="3352925">=</span>&nbsp;<span class="ident" id="3352927">line</span><span class="op" id="3352931">[</span><span class="num" id="3352932">0</span><span class="op" id="3352933">:</span><span class="ident" id="3352934">i</span><span class="op" id="3352935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3352940">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3352945">f</span>&nbsp;<span class="op" id="3352947">:=</span>&nbsp;<span class="ident" id="3352950">getFields</span><span class="op" id="3352959">(</span><span class="ident" id="3352960">line</span><span class="op" id="3352964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3352969">if</span>&nbsp;<span class="builtinfunc" id="3352972">len</span><span class="op" id="3352975">(</span><span class="ident" id="3352976">f</span><span class="op" id="3352977">)</span>&nbsp;<span class="op" id="3352979">&lt;</span>&nbsp;<span class="num" id="3352981">2</span>&nbsp;<span class="op" id="3352983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3352989">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353006">if</span>&nbsp;<span class="ident" id="3353009">proto</span><span class="op" id="3353014">,</span>&nbsp;<span class="ident" id="3353016">_</span><span class="op" id="3353017">,</span>&nbsp;<span class="ident" id="3353019">ok</span>&nbsp;<span class="op" id="3353022">:=</span>&nbsp;<span class="ident" id="3353025">dtoi</span><span class="op" id="3353029">(</span><span class="ident" id="3353030">f</span><span class="op" id="3353031">[</span><span class="num" id="3353032">1</span><span class="op" id="3353033">]</span><span class="op" id="3353034">,</span>&nbsp;<span class="num" id="3353036">0</span><span class="op" id="3353037">)</span><span class="op" id="3353038">;</span>&nbsp;<span class="ident" id="3353040">ok</span>&nbsp;<span class="op" id="3353043">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353049">if</span>&nbsp;<span class="ident" id="3353052">_</span><span class="op" id="3353053">,</span>&nbsp;<span class="ident" id="3353055">ok</span>&nbsp;<span class="op" id="3353058">:=</span>&nbsp;<span class="ident" id="3353061">protocols</span><span class="op" id="3353070">[</span><span class="ident" id="3353071">f</span><span class="op" id="3353072">[</span><span class="num" id="3353073">0</span><span class="op" id="3353074">]</span><span class="op" id="3353075">]</span><span class="op" id="3353076">;</span>&nbsp;<span class="op" id="3353078">!</span><span class="ident" id="3353079">ok</span>&nbsp;<span class="op" id="3353082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353089">protocols</span><span class="op" id="3353098">[</span><span class="ident" id="3353099">f</span><span class="op" id="3353100">[</span><span class="num" id="3353101">0</span><span class="op" id="3353102">]</span><span class="op" id="3353103">]</span>&nbsp;<span class="op" id="3353105">=</span>&nbsp;<span class="ident" id="3353107">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353123">for</span>&nbsp;<span class="ident" id="3353127">_</span><span class="op" id="3353128">,</span>&nbsp;<span class="ident" id="3353130">alias</span>&nbsp;<span class="op" id="3353136">:=</span>&nbsp;<span class="keyword" id="3353139">range</span>&nbsp;<span class="ident" id="3353145">f</span><span class="op" id="3353146">[</span><span class="num" id="3353147">2</span><span class="op" id="3353148">:</span><span class="op" id="3353149">]</span>&nbsp;<span class="op" id="3353151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353158">if</span>&nbsp;<span class="ident" id="3353161">_</span><span class="op" id="3353162">,</span>&nbsp;<span class="ident" id="3353164">ok</span>&nbsp;<span class="op" id="3353167">:=</span>&nbsp;<span class="ident" id="3353170">protocols</span><span class="op" id="3353179">[</span><span class="ident" id="3353180">alias</span><span class="op" id="3353185">]</span><span class="op" id="3353186">;</span>&nbsp;<span class="op" id="3353188">!</span><span class="ident" id="3353189">ok</span>&nbsp;<span class="op" id="3353192">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353200">protocols</span><span class="op" id="3353209">[</span><span class="ident" id="3353210">alias</span><span class="op" id="3353215">]</span>&nbsp;<span class="op" id="3353217">=</span>&nbsp;<span class="ident" id="3353219">proto</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353245">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353249">file</span><span class="op" id="3353253">.</span><span class="builtinfunc" id="3353254">close</span><span class="op" id="3353259">(</span><span class="op" id="3353260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353263">}</span><br>
<span class="lineno"></span><span class="op" id="3353265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3353268">//&nbsp;lookupProtocol&nbsp;looks&nbsp;up&nbsp;IP&nbsp;protocol&nbsp;name&nbsp;in&nbsp;/etc/protocols&nbsp;and</span><br>
<span class="lineno">45</span><span class="comment" id="3353334">//&nbsp;returns&nbsp;correspondent&nbsp;protocol&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="3353376">func</span>&nbsp;<span class="ident" id="3353381">lookupProtocol</span><span class="op" id="3353395">(</span><span class="ident" id="3353396">name</span>&nbsp;<span class="builtintype" id="3353401">string</span><span class="op" id="3353407">)</span>&nbsp;<span class="op" id="3353409">(</span><span class="ident" id="3353410">proto</span>&nbsp;<span class="builtintype" id="3353416">int</span><span class="op" id="3353419">,</span>&nbsp;<span class="ident" id="3353421">err</span>&nbsp;<span class="builtintype" id="3353425">error</span><span class="op" id="3353430">)</span>&nbsp;<span class="op" id="3353432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353435">onceReadProtocols</span><span class="op" id="3353452">.</span><span class="ident" id="3353453">Do</span><span class="op" id="3353455">(</span><span class="ident" id="3353456">readProtocols</span><span class="op" id="3353469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353472">proto</span><span class="op" id="3353477">,</span>&nbsp;<span class="ident" id="3353479">found</span>&nbsp;<span class="op" id="3353485">:=</span>&nbsp;<span class="ident" id="3353488">protocols</span><span class="op" id="3353497">[</span><span class="ident" id="3353498">name</span><span class="op" id="3353502">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353505">if</span>&nbsp;<span class="op" id="3353508">!</span><span class="ident" id="3353509">found</span>&nbsp;<span class="op" id="3353515">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353519">return</span>&nbsp;<span class="num" id="3353526">0</span><span class="op" id="3353527">,</span>&nbsp;<span class="ident" id="3353529">errors</span><span class="op" id="3353535">.</span><span class="ident" id="3353536">New</span><span class="op" id="3353539">(</span><span class="string" id="3353540">&#34;unknown&nbsp;IP&nbsp;protocol&nbsp;specified:&nbsp;&#34;</span>&nbsp;<span class="op" id="3353574">+</span>&nbsp;<span class="ident" id="3353576">name</span><span class="op" id="3353580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353586">return</span><br>
<span class="lineno"></span><span class="op" id="3353593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3353596">func</span>&nbsp;<span class="ident" id="3353601">lookupHost</span><span class="op" id="3353611">(</span><span class="ident" id="3353612">host</span>&nbsp;<span class="builtintype" id="3353617">string</span><span class="op" id="3353623">)</span>&nbsp;<span class="op" id="3353625">(</span><span class="ident" id="3353626">addrs</span>&nbsp;<span class="op" id="3353632">[</span><span class="op" id="3353633">]</span><span class="builtintype" id="3353634">string</span><span class="op" id="3353640">,</span>&nbsp;<span class="ident" id="3353642">err</span>&nbsp;<span class="builtintype" id="3353646">error</span><span class="op" id="3353651">)</span>&nbsp;<span class="op" id="3353653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353656">addrs</span><span class="op" id="3353661">,</span>&nbsp;<span class="ident" id="3353663">err</span><span class="op" id="3353666">,</span>&nbsp;<span class="ident" id="3353668">ok</span>&nbsp;<span class="op" id="3353671">:=</span>&nbsp;<span class="ident" id="3353674">cgoLookupHost</span><span class="op" id="3353687">(</span><span class="ident" id="3353688">host</span><span class="op" id="3353692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353695">if</span>&nbsp;<span class="op" id="3353698">!</span><span class="ident" id="3353699">ok</span>&nbsp;<span class="op" id="3353702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353706">addrs</span><span class="op" id="3353711">,</span>&nbsp;<span class="ident" id="3353713">err</span>&nbsp;<span class="op" id="3353717">=</span>&nbsp;<span class="ident" id="3353719">goLookupHost</span><span class="op" id="3353731">(</span><span class="ident" id="3353732">host</span><span class="op" id="3353736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353739">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353742">return</span><br>
<span class="lineno"></span><span class="op" id="3353749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3353752">func</span>&nbsp;<span class="ident" id="3353757">lookupIP</span><span class="op" id="3353765">(</span><span class="ident" id="3353766">host</span>&nbsp;<span class="builtintype" id="3353771">string</span><span class="op" id="3353777">)</span>&nbsp;<span class="op" id="3353779">(</span><span class="ident" id="3353780">addrs</span>&nbsp;<span class="op" id="3353786">[</span><span class="op" id="3353787">]</span><span class="ident" id="3353788">IP</span><span class="op" id="3353790">,</span>&nbsp;<span class="ident" id="3353792">err</span>&nbsp;<span class="builtintype" id="3353796">error</span><span class="op" id="3353801">)</span>&nbsp;<span class="op" id="3353803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353806">addrs</span><span class="op" id="3353811">,</span>&nbsp;<span class="ident" id="3353813">err</span><span class="op" id="3353816">,</span>&nbsp;<span class="ident" id="3353818">ok</span>&nbsp;<span class="op" id="3353821">:=</span>&nbsp;<span class="ident" id="3353824">cgoLookupIP</span><span class="op" id="3353835">(</span><span class="ident" id="3353836">host</span><span class="op" id="3353840">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353843">if</span>&nbsp;<span class="op" id="3353846">!</span><span class="ident" id="3353847">ok</span>&nbsp;<span class="op" id="3353850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353854">addrs</span><span class="op" id="3353859">,</span>&nbsp;<span class="ident" id="3353861">err</span>&nbsp;<span class="op" id="3353865">=</span>&nbsp;<span class="ident" id="3353867">goLookupIP</span><span class="op" id="3353877">(</span><span class="ident" id="3353878">host</span><span class="op" id="3353882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3353885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3353888">return</span><br>
<span class="lineno"></span><span class="op" id="3353895">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="3353898">func</span>&nbsp;<span class="ident" id="3353903">lookupPort</span><span class="op" id="3353913">(</span><span class="ident" id="3353914">network</span><span class="op" id="3353921">,</span>&nbsp;<span class="ident" id="3353923">service</span>&nbsp;<span class="builtintype" id="3353931">string</span><span class="op" id="3353937">)</span>&nbsp;<span class="op" id="3353939">(</span><span class="ident" id="3353940">port</span>&nbsp;<span class="builtintype" id="3353945">int</span><span class="op" id="3353948">,</span>&nbsp;<span class="ident" id="3353950">err</span>&nbsp;<span class="builtintype" id="3353954">error</span><span class="op" id="3353959">)</span>&nbsp;<span class="op" id="3353961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3353964">port</span><span class="op" id="3353968">,</span>&nbsp;<span class="ident" id="3353970">err</span><span class="op" id="3353973">,</span>&nbsp;<span class="ident" id="3353975">ok</span>&nbsp;<span class="op" id="3353978">:=</span>&nbsp;<span class="ident" id="3353981">cgoLookupPort</span><span class="op" id="3353994">(</span><span class="ident" id="3353995">network</span><span class="op" id="3354002">,</span>&nbsp;<span class="ident" id="3354004">service</span><span class="op" id="3354011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354014">if</span>&nbsp;<span class="op" id="3354017">!</span><span class="ident" id="3354018">ok</span>&nbsp;<span class="op" id="3354021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354025">port</span><span class="op" id="3354029">,</span>&nbsp;<span class="ident" id="3354031">err</span>&nbsp;<span class="op" id="3354035">=</span>&nbsp;<span class="ident" id="3354037">goLookupPort</span><span class="op" id="3354049">(</span><span class="ident" id="3354050">network</span><span class="op" id="3354057">,</span>&nbsp;<span class="ident" id="3354059">service</span><span class="op" id="3354066">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354072">return</span><br>
<span class="lineno"></span><span class="op" id="3354079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3354082">func</span>&nbsp;<span class="ident" id="3354087">lookupCNAME</span><span class="op" id="3354098">(</span><span class="ident" id="3354099">name</span>&nbsp;<span class="builtintype" id="3354104">string</span><span class="op" id="3354110">)</span>&nbsp;<span class="op" id="3354112">(</span><span class="ident" id="3354113">cname</span>&nbsp;<span class="builtintype" id="3354119">string</span><span class="op" id="3354125">,</span>&nbsp;<span class="ident" id="3354127">err</span>&nbsp;<span class="builtintype" id="3354131">error</span><span class="op" id="3354136">)</span>&nbsp;<span class="op" id="3354138">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354141">cname</span><span class="op" id="3354146">,</span>&nbsp;<span class="ident" id="3354148">err</span><span class="op" id="3354151">,</span>&nbsp;<span class="ident" id="3354153">ok</span>&nbsp;<span class="op" id="3354156">:=</span>&nbsp;<span class="ident" id="3354159">cgoLookupCNAME</span><span class="op" id="3354173">(</span><span class="ident" id="3354174">name</span><span class="op" id="3354178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354181">if</span>&nbsp;<span class="op" id="3354184">!</span><span class="ident" id="3354185">ok</span>&nbsp;<span class="op" id="3354188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354192">cname</span><span class="op" id="3354197">,</span>&nbsp;<span class="ident" id="3354199">err</span>&nbsp;<span class="op" id="3354203">=</span>&nbsp;<span class="ident" id="3354205">goLookupCNAME</span><span class="op" id="3354218">(</span><span class="ident" id="3354219">name</span><span class="op" id="3354223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354229">return</span><br>
<span class="lineno">85</span><span class="op" id="3354236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3354239">func</span>&nbsp;<span class="ident" id="3354244">lookupSRV</span><span class="op" id="3354253">(</span><span class="ident" id="3354254">service</span><span class="op" id="3354261">,</span>&nbsp;<span class="ident" id="3354263">proto</span><span class="op" id="3354268">,</span>&nbsp;<span class="ident" id="3354270">name</span>&nbsp;<span class="builtintype" id="3354275">string</span><span class="op" id="3354281">)</span>&nbsp;<span class="op" id="3354283">(</span><span class="ident" id="3354284">cname</span>&nbsp;<span class="builtintype" id="3354290">string</span><span class="op" id="3354296">,</span>&nbsp;<span class="ident" id="3354298">addrs</span>&nbsp;<span class="op" id="3354304">[</span><span class="op" id="3354305">]</span><span class="op" id="3354306">*</span><span class="ident" id="3354307">SRV</span><span class="op" id="3354310">,</span>&nbsp;<span class="ident" id="3354312">err</span>&nbsp;<span class="builtintype" id="3354316">error</span><span class="op" id="3354321">)</span>&nbsp;<span class="op" id="3354323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354326">var</span>&nbsp;<span class="ident" id="3354330">target</span>&nbsp;<span class="builtintype" id="3354337">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354345">if</span>&nbsp;<span class="ident" id="3354348">service</span>&nbsp;<span class="op" id="3354356">==</span>&nbsp;<span class="string" id="3354359">&#34;&#34;</span>&nbsp;<span class="op" id="3354362">&amp;&amp;</span>&nbsp;<span class="ident" id="3354365">proto</span>&nbsp;<span class="op" id="3354371">==</span>&nbsp;<span class="string" id="3354374">&#34;&#34;</span>&nbsp;<span class="op" id="3354377">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354381">target</span>&nbsp;<span class="op" id="3354388">=</span>&nbsp;<span class="ident" id="3354390">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354396">}</span>&nbsp;<span class="keyword" id="3354398">else</span>&nbsp;<span class="op" id="3354403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354407">target</span>&nbsp;<span class="op" id="3354414">=</span>&nbsp;<span class="string" id="3354416">&#34;_&#34;</span>&nbsp;<span class="op" id="3354420">+</span>&nbsp;<span class="ident" id="3354422">service</span>&nbsp;<span class="op" id="3354430">+</span>&nbsp;<span class="string" id="3354432">&#34;._&#34;</span>&nbsp;<span class="op" id="3354437">+</span>&nbsp;<span class="ident" id="3354439">proto</span>&nbsp;<span class="op" id="3354445">+</span>&nbsp;<span class="string" id="3354447">&#34;.&#34;</span>&nbsp;<span class="op" id="3354451">+</span>&nbsp;<span class="ident" id="3354453">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354462">var</span>&nbsp;<span class="ident" id="3354466">records</span>&nbsp;<span class="op" id="3354474">[</span><span class="op" id="3354475">]</span><span class="ident" id="3354476">dnsRR</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354483">cname</span><span class="op" id="3354488">,</span>&nbsp;<span class="ident" id="3354490">records</span><span class="op" id="3354497">,</span>&nbsp;<span class="ident" id="3354499">err</span>&nbsp;<span class="op" id="3354503">=</span>&nbsp;<span class="ident" id="3354505">lookup</span><span class="op" id="3354511">(</span><span class="ident" id="3354512">target</span><span class="op" id="3354518">,</span>&nbsp;<span class="ident" id="3354520">dnsTypeSRV</span><span class="op" id="3354530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354533">if</span>&nbsp;<span class="ident" id="3354536">err</span>&nbsp;<span class="op" id="3354540">!=</span>&nbsp;<span class="ident" id="3354543">nil</span>&nbsp;<span class="op" id="3354547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354551">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354562">addrs</span>&nbsp;<span class="op" id="3354568">=</span>&nbsp;<span class="builtinfunc" id="3354570">make</span><span class="op" id="3354574">(</span><span class="op" id="3354575">[</span><span class="op" id="3354576">]</span><span class="op" id="3354577">*</span><span class="ident" id="3354578">SRV</span><span class="op" id="3354581">,</span>&nbsp;<span class="builtinfunc" id="3354583">len</span><span class="op" id="3354586">(</span><span class="ident" id="3354587">records</span><span class="op" id="3354594">)</span><span class="op" id="3354595">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354598">for</span>&nbsp;<span class="ident" id="3354602">i</span><span class="op" id="3354603">,</span>&nbsp;<span class="ident" id="3354605">rr</span>&nbsp;<span class="op" id="3354608">:=</span>&nbsp;<span class="keyword" id="3354611">range</span>&nbsp;<span class="ident" id="3354617">records</span>&nbsp;<span class="op" id="3354625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354629">r</span>&nbsp;<span class="op" id="3354631">:=</span>&nbsp;<span class="ident" id="3354634">rr</span><span class="op" id="3354636">.</span><span class="op" id="3354637">(</span><span class="op" id="3354638">*</span><span class="ident" id="3354639">dnsRR_SRV</span><span class="op" id="3354648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354652">addrs</span><span class="op" id="3354657">[</span><span class="ident" id="3354658">i</span><span class="op" id="3354659">]</span>&nbsp;<span class="op" id="3354661">=</span>&nbsp;<span class="op" id="3354663">&amp;</span><span class="ident" id="3354664">SRV</span><span class="op" id="3354667">{</span><span class="ident" id="3354668">r</span><span class="op" id="3354669">.</span><span class="ident" id="3354670">Target</span><span class="op" id="3354676">,</span>&nbsp;<span class="ident" id="3354678">r</span><span class="op" id="3354679">.</span><span class="ident" id="3354680">Port</span><span class="op" id="3354684">,</span>&nbsp;<span class="ident" id="3354686">r</span><span class="op" id="3354687">.</span><span class="ident" id="3354688">Priority</span><span class="op" id="3354696">,</span>&nbsp;<span class="ident" id="3354698">r</span><span class="op" id="3354699">.</span><span class="ident" id="3354700">Weight</span><span class="op" id="3354706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354712">byPriorityWeight</span><span class="op" id="3354728">(</span><span class="ident" id="3354729">addrs</span><span class="op" id="3354734">)</span><span class="op" id="3354735">.</span><span class="ident" id="3354736">sort</span><span class="op" id="3354740">(</span><span class="op" id="3354741">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354744">return</span><br>
<span class="lineno"></span><span class="op" id="3354751">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3354754">func</span>&nbsp;<span class="ident" id="3354759">lookupMX</span><span class="op" id="3354767">(</span><span class="ident" id="3354768">name</span>&nbsp;<span class="builtintype" id="3354773">string</span><span class="op" id="3354779">)</span>&nbsp;<span class="op" id="3354781">(</span><span class="ident" id="3354782">mx</span>&nbsp;<span class="op" id="3354785">[</span><span class="op" id="3354786">]</span><span class="op" id="3354787">*</span><span class="ident" id="3354788">MX</span><span class="op" id="3354790">,</span>&nbsp;<span class="ident" id="3354792">err</span>&nbsp;<span class="builtintype" id="3354796">error</span><span class="op" id="3354801">)</span>&nbsp;<span class="op" id="3354803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354806">_</span><span class="op" id="3354807">,</span>&nbsp;<span class="ident" id="3354809">records</span><span class="op" id="3354816">,</span>&nbsp;<span class="ident" id="3354818">err</span>&nbsp;<span class="op" id="3354822">:=</span>&nbsp;<span class="ident" id="3354825">lookup</span><span class="op" id="3354831">(</span><span class="ident" id="3354832">name</span><span class="op" id="3354836">,</span>&nbsp;<span class="ident" id="3354838">dnsTypeMX</span><span class="op" id="3354847">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354850">if</span>&nbsp;<span class="ident" id="3354853">err</span>&nbsp;<span class="op" id="3354857">!=</span>&nbsp;<span class="ident" id="3354860">nil</span>&nbsp;<span class="op" id="3354864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354868">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354879">mx</span>&nbsp;<span class="op" id="3354882">=</span>&nbsp;<span class="builtinfunc" id="3354884">make</span><span class="op" id="3354888">(</span><span class="op" id="3354889">[</span><span class="op" id="3354890">]</span><span class="op" id="3354891">*</span><span class="ident" id="3354892">MX</span><span class="op" id="3354894">,</span>&nbsp;<span class="builtinfunc" id="3354896">len</span><span class="op" id="3354899">(</span><span class="ident" id="3354900">records</span><span class="op" id="3354907">)</span><span class="op" id="3354908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3354911">for</span>&nbsp;<span class="ident" id="3354915">i</span><span class="op" id="3354916">,</span>&nbsp;<span class="ident" id="3354918">rr</span>&nbsp;<span class="op" id="3354921">:=</span>&nbsp;<span class="keyword" id="3354924">range</span>&nbsp;<span class="ident" id="3354930">records</span>&nbsp;<span class="op" id="3354938">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354942">r</span>&nbsp;<span class="op" id="3354944">:=</span>&nbsp;<span class="ident" id="3354947">rr</span><span class="op" id="3354949">.</span><span class="op" id="3354950">(</span><span class="op" id="3354951">*</span><span class="ident" id="3354952">dnsRR_MX</span><span class="op" id="3354960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354964">mx</span><span class="op" id="3354966">[</span><span class="ident" id="3354967">i</span><span class="op" id="3354968">]</span>&nbsp;<span class="op" id="3354970">=</span>&nbsp;<span class="op" id="3354972">&amp;</span><span class="ident" id="3354973">MX</span><span class="op" id="3354975">{</span><span class="ident" id="3354976">r</span><span class="op" id="3354977">.</span><span class="ident" id="3354978">Mx</span><span class="op" id="3354980">,</span>&nbsp;<span class="ident" id="3354982">r</span><span class="op" id="3354983">.</span><span class="ident" id="3354984">Pref</span><span class="op" id="3354988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3354991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3354994">byPref</span><span class="op" id="3355000">(</span><span class="ident" id="3355001">mx</span><span class="op" id="3355003">)</span><span class="op" id="3355004">.</span><span class="ident" id="3355005">sort</span><span class="op" id="3355009">(</span><span class="op" id="3355010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355013">return</span><br>
<span class="lineno">120</span><span class="op" id="3355020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3355023">func</span>&nbsp;<span class="ident" id="3355028">lookupNS</span><span class="op" id="3355036">(</span><span class="ident" id="3355037">name</span>&nbsp;<span class="builtintype" id="3355042">string</span><span class="op" id="3355048">)</span>&nbsp;<span class="op" id="3355050">(</span><span class="ident" id="3355051">ns</span>&nbsp;<span class="op" id="3355054">[</span><span class="op" id="3355055">]</span><span class="op" id="3355056">*</span><span class="ident" id="3355057">NS</span><span class="op" id="3355059">,</span>&nbsp;<span class="ident" id="3355061">err</span>&nbsp;<span class="builtintype" id="3355065">error</span><span class="op" id="3355070">)</span>&nbsp;<span class="op" id="3355072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355075">_</span><span class="op" id="3355076">,</span>&nbsp;<span class="ident" id="3355078">records</span><span class="op" id="3355085">,</span>&nbsp;<span class="ident" id="3355087">err</span>&nbsp;<span class="op" id="3355091">:=</span>&nbsp;<span class="ident" id="3355094">lookup</span><span class="op" id="3355100">(</span><span class="ident" id="3355101">name</span><span class="op" id="3355105">,</span>&nbsp;<span class="ident" id="3355107">dnsTypeNS</span><span class="op" id="3355116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355119">if</span>&nbsp;<span class="ident" id="3355122">err</span>&nbsp;<span class="op" id="3355126">!=</span>&nbsp;<span class="ident" id="3355129">nil</span>&nbsp;<span class="op" id="3355133">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355137">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355148">ns</span>&nbsp;<span class="op" id="3355151">=</span>&nbsp;<span class="builtinfunc" id="3355153">make</span><span class="op" id="3355157">(</span><span class="op" id="3355158">[</span><span class="op" id="3355159">]</span><span class="op" id="3355160">*</span><span class="ident" id="3355161">NS</span><span class="op" id="3355163">,</span>&nbsp;<span class="builtinfunc" id="3355165">len</span><span class="op" id="3355168">(</span><span class="ident" id="3355169">records</span><span class="op" id="3355176">)</span><span class="op" id="3355177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355180">for</span>&nbsp;<span class="ident" id="3355184">i</span><span class="op" id="3355185">,</span>&nbsp;<span class="ident" id="3355187">r</span>&nbsp;<span class="op" id="3355189">:=</span>&nbsp;<span class="keyword" id="3355192">range</span>&nbsp;<span class="ident" id="3355198">records</span>&nbsp;<span class="op" id="3355206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355210">r</span>&nbsp;<span class="op" id="3355212">:=</span>&nbsp;<span class="ident" id="3355215">r</span><span class="op" id="3355216">.</span><span class="op" id="3355217">(</span><span class="op" id="3355218">*</span><span class="ident" id="3355219">dnsRR_NS</span><span class="op" id="3355227">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355231">ns</span><span class="op" id="3355233">[</span><span class="ident" id="3355234">i</span><span class="op" id="3355235">]</span>&nbsp;<span class="op" id="3355237">=</span>&nbsp;<span class="op" id="3355239">&amp;</span><span class="ident" id="3355240">NS</span><span class="op" id="3355242">{</span><span class="ident" id="3355243">r</span><span class="op" id="3355244">.</span><span class="ident" id="3355245">Ns</span><span class="op" id="3355247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355253">return</span><br>
<span class="lineno"></span><span class="op" id="3355260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3355263">func</span>&nbsp;<span class="ident" id="3355268">lookupTXT</span><span class="op" id="3355277">(</span><span class="ident" id="3355278">name</span>&nbsp;<span class="builtintype" id="3355283">string</span><span class="op" id="3355289">)</span>&nbsp;<span class="op" id="3355291">(</span><span class="ident" id="3355292">txt</span>&nbsp;<span class="op" id="3355296">[</span><span class="op" id="3355297">]</span><span class="builtintype" id="3355298">string</span><span class="op" id="3355304">,</span>&nbsp;<span class="ident" id="3355306">err</span>&nbsp;<span class="builtintype" id="3355310">error</span><span class="op" id="3355315">)</span>&nbsp;<span class="op" id="3355317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355320">_</span><span class="op" id="3355321">,</span>&nbsp;<span class="ident" id="3355323">records</span><span class="op" id="3355330">,</span>&nbsp;<span class="ident" id="3355332">err</span>&nbsp;<span class="op" id="3355336">:=</span>&nbsp;<span class="ident" id="3355339">lookup</span><span class="op" id="3355345">(</span><span class="ident" id="3355346">name</span><span class="op" id="3355350">,</span>&nbsp;<span class="ident" id="3355352">dnsTypeTXT</span><span class="op" id="3355362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355365">if</span>&nbsp;<span class="ident" id="3355368">err</span>&nbsp;<span class="op" id="3355372">!=</span>&nbsp;<span class="ident" id="3355375">nil</span>&nbsp;<span class="op" id="3355379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355383">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355391">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355394">txt</span>&nbsp;<span class="op" id="3355398">=</span>&nbsp;<span class="builtinfunc" id="3355400">make</span><span class="op" id="3355404">(</span><span class="op" id="3355405">[</span><span class="op" id="3355406">]</span><span class="builtintype" id="3355407">string</span><span class="op" id="3355413">,</span>&nbsp;<span class="builtinfunc" id="3355415">len</span><span class="op" id="3355418">(</span><span class="ident" id="3355419">records</span><span class="op" id="3355426">)</span><span class="op" id="3355427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355430">for</span>&nbsp;<span class="ident" id="3355434">i</span><span class="op" id="3355435">,</span>&nbsp;<span class="ident" id="3355437">r</span>&nbsp;<span class="op" id="3355439">:=</span>&nbsp;<span class="keyword" id="3355442">range</span>&nbsp;<span class="ident" id="3355448">records</span>&nbsp;<span class="op" id="3355456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355460">txt</span><span class="op" id="3355463">[</span><span class="ident" id="3355464">i</span><span class="op" id="3355465">]</span>&nbsp;<span class="op" id="3355467">=</span>&nbsp;<span class="ident" id="3355469">r</span><span class="op" id="3355470">.</span><span class="op" id="3355471">(</span><span class="op" id="3355472">*</span><span class="ident" id="3355473">dnsRR_TXT</span><span class="op" id="3355482">)</span><span class="op" id="3355483">.</span><span class="ident" id="3355484">Txt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355492">return</span><br>
<span class="lineno">145</span><span class="op" id="3355499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3355502">func</span>&nbsp;<span class="ident" id="3355507">lookupAddr</span><span class="op" id="3355517">(</span><span class="ident" id="3355518">addr</span>&nbsp;<span class="builtintype" id="3355523">string</span><span class="op" id="3355529">)</span>&nbsp;<span class="op" id="3355531">(</span><span class="ident" id="3355532">name</span>&nbsp;<span class="op" id="3355537">[</span><span class="op" id="3355538">]</span><span class="builtintype" id="3355539">string</span><span class="op" id="3355545">,</span>&nbsp;<span class="ident" id="3355547">err</span>&nbsp;<span class="builtintype" id="3355551">error</span><span class="op" id="3355556">)</span>&nbsp;<span class="op" id="3355558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355561">name</span>&nbsp;<span class="op" id="3355566">=</span>&nbsp;<span class="ident" id="3355568">lookupStaticAddr</span><span class="op" id="3355584">(</span><span class="ident" id="3355585">addr</span><span class="op" id="3355589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355592">if</span>&nbsp;<span class="builtinfunc" id="3355595">len</span><span class="op" id="3355598">(</span><span class="ident" id="3355599">name</span><span class="op" id="3355603">)</span>&nbsp;<span class="op" id="3355605">&gt;</span>&nbsp;<span class="num" id="3355607">0</span>&nbsp;<span class="op" id="3355609">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355613">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355621">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355624">var</span>&nbsp;<span class="ident" id="3355628">arpa</span>&nbsp;<span class="builtintype" id="3355633">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355641">arpa</span><span class="op" id="3355645">,</span>&nbsp;<span class="ident" id="3355647">err</span>&nbsp;<span class="op" id="3355651">=</span>&nbsp;<span class="ident" id="3355653">reverseaddr</span><span class="op" id="3355664">(</span><span class="ident" id="3355665">addr</span><span class="op" id="3355669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355672">if</span>&nbsp;<span class="ident" id="3355675">err</span>&nbsp;<span class="op" id="3355679">!=</span>&nbsp;<span class="ident" id="3355682">nil</span>&nbsp;<span class="op" id="3355686">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355701">var</span>&nbsp;<span class="ident" id="3355705">records</span>&nbsp;<span class="op" id="3355713">[</span><span class="op" id="3355714">]</span><span class="ident" id="3355715">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355722">_</span><span class="op" id="3355723">,</span>&nbsp;<span class="ident" id="3355725">records</span><span class="op" id="3355732">,</span>&nbsp;<span class="ident" id="3355734">err</span>&nbsp;<span class="op" id="3355738">=</span>&nbsp;<span class="ident" id="3355740">lookup</span><span class="op" id="3355746">(</span><span class="ident" id="3355747">arpa</span><span class="op" id="3355751">,</span>&nbsp;<span class="ident" id="3355753">dnsTypePTR</span><span class="op" id="3355763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355766">if</span>&nbsp;<span class="ident" id="3355769">err</span>&nbsp;<span class="op" id="3355773">!=</span>&nbsp;<span class="ident" id="3355776">nil</span>&nbsp;<span class="op" id="3355780">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355784">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355795">name</span>&nbsp;<span class="op" id="3355800">=</span>&nbsp;<span class="builtinfunc" id="3355802">make</span><span class="op" id="3355806">(</span><span class="op" id="3355807">[</span><span class="op" id="3355808">]</span><span class="builtintype" id="3355809">string</span><span class="op" id="3355815">,</span>&nbsp;<span class="builtinfunc" id="3355817">len</span><span class="op" id="3355820">(</span><span class="ident" id="3355821">records</span><span class="op" id="3355828">)</span><span class="op" id="3355829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355832">for</span>&nbsp;<span class="ident" id="3355836">i</span>&nbsp;<span class="op" id="3355838">:=</span>&nbsp;<span class="keyword" id="3355841">range</span>&nbsp;<span class="ident" id="3355847">records</span>&nbsp;<span class="op" id="3355855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355859">r</span>&nbsp;<span class="op" id="3355861">:=</span>&nbsp;<span class="ident" id="3355864">records</span><span class="op" id="3355871">[</span><span class="ident" id="3355872">i</span><span class="op" id="3355873">]</span><span class="op" id="3355874">.</span><span class="op" id="3355875">(</span><span class="op" id="3355876">*</span><span class="ident" id="3355877">dnsRR_PTR</span><span class="op" id="3355886">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3355890">name</span><span class="op" id="3355894">[</span><span class="ident" id="3355895">i</span><span class="op" id="3355896">]</span>&nbsp;<span class="op" id="3355898">=</span>&nbsp;<span class="ident" id="3355900">r</span><span class="op" id="3355901">.</span><span class="ident" id="3355902">Ptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3355907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3355910">return</span><br>
<span class="lineno"></span><span class="op" id="3355917">}</span>
</div>
</body>
</html>
