<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>compress/zlib</h2>
<ul>
<li><a href="/gostd/compress/zlib/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/compress/zlib/reader.go.html" class="current">reader.go</a></li>
<li><a href="/gostd/compress/zlib/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/compress/zlib/writer.go.html">writer.go</a></li>
<li><a href="/gostd/compress/zlib/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4813972">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4814027">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4814081">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4814132">/*<br>
<span class="lineno"></span>Package&nbsp;zlib&nbsp;implements&nbsp;reading&nbsp;and&nbsp;writing&nbsp;of&nbsp;zlib&nbsp;format&nbsp;compressed&nbsp;data,<br>
<span class="lineno"></span>as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;1950.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>The&nbsp;implementation&nbsp;provides&nbsp;filters&nbsp;that&nbsp;uncompress&nbsp;during&nbsp;reading<br>
<span class="lineno">10</span>and&nbsp;compress&nbsp;during&nbsp;writing.&nbsp;&nbsp;For&nbsp;example,&nbsp;to&nbsp;write&nbsp;compressed&nbsp;data<br>
<span class="lineno"></span>to&nbsp;a&nbsp;buffer:<br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;b&nbsp;bytes.Buffer<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;:=&nbsp;zlib.NewWriter(&amp;b)<br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;w.Write([]byte(&#34;hello,&nbsp;world\n&#34;))<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;w.Close()<br>
<span class="lineno"></span><br>
<span class="lineno"></span>and&nbsp;to&nbsp;read&nbsp;that&nbsp;data&nbsp;back:<br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;r,&nbsp;err&nbsp;:=&nbsp;zlib.NewReader(&amp;b)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;io.Copy(os.Stdout,&nbsp;r)<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;r.Close()<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="4814575">package</span>&nbsp;<span class="ident" id="4814583">zlib</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="4814589">import</span>&nbsp;<span class="op" id="4814596">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814599">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814608">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814626">&#34;errors&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814636">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814644">&#34;hash/adler32&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4814660">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="4814665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="4814668">const</span>&nbsp;<span class="ident" id="4814674">zlibDeflate</span>&nbsp;<span class="op" id="4814686">=</span>&nbsp;<span class="num" id="4814688">8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4814691">var</span>&nbsp;<span class="op" id="4814695">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4814698">//&nbsp;ErrChecksum&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4814779">ErrChecksum</span>&nbsp;<span class="op" id="4814791">=</span>&nbsp;<span class="ident" id="4814793">errors</span><span class="op" id="4814799">.</span><span class="ident" id="4814800">New</span><span class="op" id="4814803">(</span><span class="string" id="4814804">&#34;zlib:&nbsp;invalid&nbsp;checksum&#34;</span><span class="op" id="4814828">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4814831">//&nbsp;ErrDictionary&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;dictionary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4814916">ErrDictionary</span>&nbsp;<span class="op" id="4814930">=</span>&nbsp;<span class="ident" id="4814932">errors</span><span class="op" id="4814938">.</span><span class="ident" id="4814939">New</span><span class="op" id="4814942">(</span><span class="string" id="4814943">&#34;zlib:&nbsp;invalid&nbsp;dictionary&#34;</span><span class="op" id="4814969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4814972">//&nbsp;ErrHeader&nbsp;is&nbsp;returned&nbsp;when&nbsp;reading&nbsp;ZLIB&nbsp;data&nbsp;that&nbsp;has&nbsp;an&nbsp;invalid&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815049">ErrHeader</span>&nbsp;<span class="op" id="4815059">=</span>&nbsp;<span class="ident" id="4815061">errors</span><span class="op" id="4815067">.</span><span class="ident" id="4815068">New</span><span class="op" id="4815071">(</span><span class="string" id="4815072">&#34;zlib:&nbsp;invalid&nbsp;header&#34;</span><span class="op" id="4815094">)</span><br>
<span class="lineno"></span><span class="op" id="4815096">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="4815099">type</span>&nbsp;<span class="ident" id="4815104">reader</span>&nbsp;<span class="keyword" id="4815111">struct</span>&nbsp;<span class="op" id="4815118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815121">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815134">flate</span><span class="op" id="4815139">.</span><span class="ident" id="4815140">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815148">decompressor</span>&nbsp;<span class="ident" id="4815161">io</span><span class="op" id="4815163">.</span><span class="ident" id="4815164">ReadCloser</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815176">digest</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815189">hash</span><span class="op" id="4815193">.</span><span class="ident" id="4815194">Hash32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815202">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4815215">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815222">scratch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4815235">[</span><span class="num" id="4815236">4</span><span class="op" id="4815237">]</span><span class="builtintype" id="4815238">byte</span><br>
<span class="lineno"></span><span class="op" id="4815243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4815246">//&nbsp;Resetter&nbsp;resets&nbsp;a&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;or&nbsp;NewReaderDict&nbsp;to</span><br>
<span class="lineno">55</span><span class="comment" id="4815320">//&nbsp;to&nbsp;switch&nbsp;to&nbsp;a&nbsp;new&nbsp;underlying&nbsp;Reader.&nbsp;This&nbsp;permits&nbsp;reusing&nbsp;a&nbsp;ReadCloser</span><br>
<span class="lineno"></span><span class="comment" id="4815395">//&nbsp;instead&nbsp;of&nbsp;allocating&nbsp;a&nbsp;new&nbsp;one.</span><br>
<span class="lineno"></span><span class="keyword" id="4815431">type</span>&nbsp;<span class="ident" id="4815436">Resetter</span>&nbsp;<span class="keyword" id="4815445">interface</span>&nbsp;<span class="op" id="4815455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4815458">//&nbsp;Reset&nbsp;discards&nbsp;any&nbsp;buffered&nbsp;data&nbsp;and&nbsp;resets&nbsp;the&nbsp;Resetter&nbsp;as&nbsp;if&nbsp;it&nbsp;was</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4815532">//&nbsp;newly&nbsp;initialized&nbsp;with&nbsp;the&nbsp;given&nbsp;reader.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4815577">Reset</span><span class="op" id="4815582">(</span><span class="ident" id="4815583">r</span>&nbsp;<span class="ident" id="4815585">io</span><span class="op" id="4815587">.</span><span class="ident" id="4815588">Reader</span><span class="op" id="4815594">,</span>&nbsp;<span class="ident" id="4815596">dict</span>&nbsp;<span class="op" id="4815601">[</span><span class="op" id="4815602">]</span><span class="builtintype" id="4815603">byte</span><span class="op" id="4815607">)</span>&nbsp;<span class="builtintype" id="4815609">error</span><br>
<span class="lineno"></span><span class="op" id="4815615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4815618">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="4815657">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">65</span><span class="comment" id="4815728">//&nbsp;The&nbsp;implementation&nbsp;buffers&nbsp;input&nbsp;and&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4815810">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when&nbsp;done.</span><br>
<span class="lineno"></span><span class="comment" id="4815890">//</span><br>
<span class="lineno"></span><span class="comment" id="4815893">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReader&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4815959">func</span>&nbsp;<span class="ident" id="4815964">NewReader</span><span class="op" id="4815973">(</span><span class="ident" id="4815974">r</span>&nbsp;<span class="ident" id="4815976">io</span><span class="op" id="4815978">.</span><span class="ident" id="4815979">Reader</span><span class="op" id="4815985">)</span>&nbsp;<span class="op" id="4815987">(</span><span class="ident" id="4815988">io</span><span class="op" id="4815990">.</span><span class="ident" id="4815991">ReadCloser</span><span class="op" id="4816001">,</span>&nbsp;<span class="builtintype" id="4816003">error</span><span class="op" id="4816008">)</span>&nbsp;<span class="op" id="4816010">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816013">return</span>&nbsp;<span class="ident" id="4816020">NewReaderDict</span><span class="op" id="4816033">(</span><span class="ident" id="4816034">r</span><span class="op" id="4816035">,</span>&nbsp;<span class="builtintype" id="4816037">nil</span><span class="op" id="4816040">)</span><br>
<span class="lineno"></span><span class="op" id="4816042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4816045">//&nbsp;NewReaderDict&nbsp;is&nbsp;like&nbsp;NewReader&nbsp;but&nbsp;uses&nbsp;a&nbsp;preset&nbsp;dictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4816110">//&nbsp;NewReaderDict&nbsp;ignores&nbsp;the&nbsp;dictionary&nbsp;if&nbsp;the&nbsp;compressed&nbsp;data&nbsp;does&nbsp;not&nbsp;refer&nbsp;to&nbsp;it.</span><br>
<span class="lineno">75</span><span class="comment" id="4816195">//&nbsp;If&nbsp;the&nbsp;compressed&nbsp;data&nbsp;refers&nbsp;to&nbsp;a&nbsp;different&nbsp;dictionary,&nbsp;NewReaderDict&nbsp;returns&nbsp;ErrDictionary.</span><br>
<span class="lineno"></span><span class="comment" id="4816292">//</span><br>
<span class="lineno"></span><span class="comment" id="4816295">//&nbsp;The&nbsp;ReadCloser&nbsp;returned&nbsp;by&nbsp;NewReaderDict&nbsp;also&nbsp;implements&nbsp;Resetter.</span><br>
<span class="lineno"></span><span class="keyword" id="4816365">func</span>&nbsp;<span class="ident" id="4816370">NewReaderDict</span><span class="op" id="4816383">(</span><span class="ident" id="4816384">r</span>&nbsp;<span class="ident" id="4816386">io</span><span class="op" id="4816388">.</span><span class="ident" id="4816389">Reader</span><span class="op" id="4816395">,</span>&nbsp;<span class="ident" id="4816397">dict</span>&nbsp;<span class="op" id="4816402">[</span><span class="op" id="4816403">]</span><span class="builtintype" id="4816404">byte</span><span class="op" id="4816408">)</span>&nbsp;<span class="op" id="4816410">(</span><span class="ident" id="4816411">io</span><span class="op" id="4816413">.</span><span class="ident" id="4816414">ReadCloser</span><span class="op" id="4816424">,</span>&nbsp;<span class="builtintype" id="4816426">error</span><span class="op" id="4816431">)</span>&nbsp;<span class="op" id="4816433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816436">z</span>&nbsp;<span class="op" id="4816438">:=</span>&nbsp;<span class="builtinfunc" id="4816441">new</span><span class="op" id="4816444">(</span><span class="ident" id="4816445">reader</span><span class="op" id="4816451">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816454">err</span>&nbsp;<span class="op" id="4816458">:=</span>&nbsp;<span class="ident" id="4816461">z</span><span class="op" id="4816462">.</span><span class="ident" id="4816463">Reset</span><span class="op" id="4816468">(</span><span class="ident" id="4816469">r</span><span class="op" id="4816470">,</span>&nbsp;<span class="ident" id="4816472">dict</span><span class="op" id="4816476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816479">if</span>&nbsp;<span class="ident" id="4816482">err</span>&nbsp;<span class="op" id="4816486">!=</span>&nbsp;<span class="builtintype" id="4816489">nil</span>&nbsp;<span class="op" id="4816493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816497">return</span>&nbsp;<span class="builtintype" id="4816504">nil</span><span class="op" id="4816507">,</span>&nbsp;<span class="ident" id="4816509">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816517">return</span>&nbsp;<span class="ident" id="4816524">z</span><span class="op" id="4816525">,</span>&nbsp;<span class="builtintype" id="4816527">nil</span><br>
<span class="lineno">85</span><span class="op" id="4816531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4816534">func</span>&nbsp;<span class="op" id="4816539">(</span><span class="ident" id="4816540">z</span>&nbsp;<span class="op" id="4816542">*</span><span class="ident" id="4816543">reader</span><span class="op" id="4816549">)</span>&nbsp;<span class="ident" id="4816551">Read</span><span class="op" id="4816555">(</span><span class="ident" id="4816556">p</span>&nbsp;<span class="op" id="4816558">[</span><span class="op" id="4816559">]</span><span class="builtintype" id="4816560">byte</span><span class="op" id="4816564">)</span>&nbsp;<span class="op" id="4816566">(</span><span class="ident" id="4816567">n</span>&nbsp;<span class="builtintype" id="4816569">int</span><span class="op" id="4816572">,</span>&nbsp;<span class="ident" id="4816574">err</span>&nbsp;<span class="builtintype" id="4816578">error</span><span class="op" id="4816583">)</span>&nbsp;<span class="op" id="4816585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816588">if</span>&nbsp;<span class="ident" id="4816591">z</span><span class="op" id="4816592">.</span><span class="ident" id="4816593">err</span>&nbsp;<span class="op" id="4816597">!=</span>&nbsp;<span class="builtintype" id="4816600">nil</span>&nbsp;<span class="op" id="4816604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816608">return</span>&nbsp;<span class="num" id="4816615">0</span><span class="op" id="4816616">,</span>&nbsp;<span class="ident" id="4816618">z</span><span class="op" id="4816619">.</span><span class="ident" id="4816620">err</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816628">if</span>&nbsp;<span class="builtinfunc" id="4816631">len</span><span class="op" id="4816634">(</span><span class="ident" id="4816635">p</span><span class="op" id="4816636">)</span>&nbsp;<span class="op" id="4816638">==</span>&nbsp;<span class="num" id="4816641">0</span>&nbsp;<span class="op" id="4816643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816647">return</span>&nbsp;<span class="num" id="4816654">0</span><span class="op" id="4816655">,</span>&nbsp;<span class="builtintype" id="4816657">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816666">n</span><span class="op" id="4816667">,</span>&nbsp;<span class="ident" id="4816669">err</span>&nbsp;<span class="op" id="4816673">=</span>&nbsp;<span class="ident" id="4816675">z</span><span class="op" id="4816676">.</span><span class="ident" id="4816677">decompressor</span><span class="op" id="4816689">.</span><span class="ident" id="4816690">Read</span><span class="op" id="4816694">(</span><span class="ident" id="4816695">p</span><span class="op" id="4816696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816699">z</span><span class="op" id="4816700">.</span><span class="ident" id="4816701">digest</span><span class="op" id="4816707">.</span><span class="ident" id="4816708">Write</span><span class="op" id="4816713">(</span><span class="ident" id="4816714">p</span><span class="op" id="4816715">[</span><span class="num" id="4816716">0</span><span class="op" id="4816717">:</span><span class="ident" id="4816718">n</span><span class="op" id="4816719">]</span><span class="op" id="4816720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816723">if</span>&nbsp;<span class="ident" id="4816726">n</span>&nbsp;<span class="op" id="4816728">!=</span>&nbsp;<span class="num" id="4816731">0</span>&nbsp;<span class="op" id="4816733">||</span>&nbsp;<span class="ident" id="4816736">err</span>&nbsp;<span class="op" id="4816740">!=</span>&nbsp;<span class="ident" id="4816743">io</span><span class="op" id="4816745">.</span><span class="ident" id="4816746">EOF</span>&nbsp;<span class="op" id="4816750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816754">z</span><span class="op" id="4816755">.</span><span class="ident" id="4816756">err</span>&nbsp;<span class="op" id="4816760">=</span>&nbsp;<span class="ident" id="4816762">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816768">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4816780">//&nbsp;Finished&nbsp;file;&nbsp;check&nbsp;checksum.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816815">if</span>&nbsp;<span class="ident" id="4816818">_</span><span class="op" id="4816819">,</span>&nbsp;<span class="ident" id="4816821">err</span>&nbsp;<span class="op" id="4816825">:=</span>&nbsp;<span class="ident" id="4816828">io</span><span class="op" id="4816830">.</span><span class="ident" id="4816831">ReadFull</span><span class="op" id="4816839">(</span><span class="ident" id="4816840">z</span><span class="op" id="4816841">.</span><span class="ident" id="4816842">r</span><span class="op" id="4816843">,</span>&nbsp;<span class="ident" id="4816845">z</span><span class="op" id="4816846">.</span><span class="ident" id="4816847">scratch</span><span class="op" id="4816854">[</span><span class="num" id="4816855">0</span><span class="op" id="4816856">:</span><span class="num" id="4816857">4</span><span class="op" id="4816858">]</span><span class="op" id="4816859">)</span><span class="op" id="4816860">;</span>&nbsp;<span class="ident" id="4816862">err</span>&nbsp;<span class="op" id="4816866">!=</span>&nbsp;<span class="builtintype" id="4816869">nil</span>&nbsp;<span class="op" id="4816873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816877">z</span><span class="op" id="4816878">.</span><span class="ident" id="4816879">err</span>&nbsp;<span class="op" id="4816883">=</span>&nbsp;<span class="ident" id="4816885">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4816891">return</span>&nbsp;<span class="num" id="4816898">0</span><span class="op" id="4816899">,</span>&nbsp;<span class="ident" id="4816901">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4816906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4816909">//&nbsp;ZLIB&nbsp;(RFC&nbsp;1950)&nbsp;is&nbsp;big-endian,&nbsp;unlike&nbsp;GZIP&nbsp;(RFC&nbsp;1952).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4816968">checksum</span>&nbsp;<span class="op" id="4816977">:=</span>&nbsp;<span class="builtintype" id="4816980">uint32</span><span class="op" id="4816986">(</span><span class="ident" id="4816987">z</span><span class="op" id="4816988">.</span><span class="ident" id="4816989">scratch</span><span class="op" id="4816996">[</span><span class="num" id="4816997">0</span><span class="op" id="4816998">]</span><span class="op" id="4816999">)</span><span class="op" id="4817000">&lt;&lt;</span><span class="num" id="4817002">24</span>&nbsp;<span class="op" id="4817005">|</span>&nbsp;<span class="builtintype" id="4817007">uint32</span><span class="op" id="4817013">(</span><span class="ident" id="4817014">z</span><span class="op" id="4817015">.</span><span class="ident" id="4817016">scratch</span><span class="op" id="4817023">[</span><span class="num" id="4817024">1</span><span class="op" id="4817025">]</span><span class="op" id="4817026">)</span><span class="op" id="4817027">&lt;&lt;</span><span class="num" id="4817029">16</span>&nbsp;<span class="op" id="4817032">|</span>&nbsp;<span class="builtintype" id="4817034">uint32</span><span class="op" id="4817040">(</span><span class="ident" id="4817041">z</span><span class="op" id="4817042">.</span><span class="ident" id="4817043">scratch</span><span class="op" id="4817050">[</span><span class="num" id="4817051">2</span><span class="op" id="4817052">]</span><span class="op" id="4817053">)</span><span class="op" id="4817054">&lt;&lt;</span><span class="num" id="4817056">8</span>&nbsp;<span class="op" id="4817058">|</span>&nbsp;<span class="builtintype" id="4817060">uint32</span><span class="op" id="4817066">(</span><span class="ident" id="4817067">z</span><span class="op" id="4817068">.</span><span class="ident" id="4817069">scratch</span><span class="op" id="4817076">[</span><span class="num" id="4817077">3</span><span class="op" id="4817078">]</span><span class="op" id="4817079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817082">if</span>&nbsp;<span class="ident" id="4817085">checksum</span>&nbsp;<span class="op" id="4817094">!=</span>&nbsp;<span class="ident" id="4817097">z</span><span class="op" id="4817098">.</span><span class="ident" id="4817099">digest</span><span class="op" id="4817105">.</span><span class="ident" id="4817106">Sum32</span><span class="op" id="4817111">(</span><span class="op" id="4817112">)</span>&nbsp;<span class="op" id="4817114">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817118">z</span><span class="op" id="4817119">.</span><span class="ident" id="4817120">err</span>&nbsp;<span class="op" id="4817124">=</span>&nbsp;<span class="ident" id="4817126">ErrChecksum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817140">return</span>&nbsp;<span class="num" id="4817147">0</span><span class="op" id="4817148">,</span>&nbsp;<span class="ident" id="4817150">z</span><span class="op" id="4817151">.</span><span class="ident" id="4817152">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817160">return</span><br>
<span class="lineno"></span><span class="op" id="4817167">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4817170">//&nbsp;Calling&nbsp;Close&nbsp;does&nbsp;not&nbsp;close&nbsp;the&nbsp;wrapped&nbsp;io.Reader&nbsp;originally&nbsp;passed&nbsp;to&nbsp;NewReader.</span><br>
<span class="lineno"></span><span class="keyword" id="4817256">func</span>&nbsp;<span class="op" id="4817261">(</span><span class="ident" id="4817262">z</span>&nbsp;<span class="op" id="4817264">*</span><span class="ident" id="4817265">reader</span><span class="op" id="4817271">)</span>&nbsp;<span class="ident" id="4817273">Close</span><span class="op" id="4817278">(</span><span class="op" id="4817279">)</span>&nbsp;<span class="builtintype" id="4817281">error</span>&nbsp;<span class="op" id="4817287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817290">if</span>&nbsp;<span class="ident" id="4817293">z</span><span class="op" id="4817294">.</span><span class="ident" id="4817295">err</span>&nbsp;<span class="op" id="4817299">!=</span>&nbsp;<span class="builtintype" id="4817302">nil</span>&nbsp;<span class="op" id="4817306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817310">return</span>&nbsp;<span class="ident" id="4817317">z</span><span class="op" id="4817318">.</span><span class="ident" id="4817319">err</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817327">z</span><span class="op" id="4817328">.</span><span class="ident" id="4817329">err</span>&nbsp;<span class="op" id="4817333">=</span>&nbsp;<span class="ident" id="4817335">z</span><span class="op" id="4817336">.</span><span class="ident" id="4817337">decompressor</span><span class="op" id="4817349">.</span><span class="ident" id="4817350">Close</span><span class="op" id="4817355">(</span><span class="op" id="4817356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817359">return</span>&nbsp;<span class="ident" id="4817366">z</span><span class="op" id="4817367">.</span><span class="ident" id="4817368">err</span><br>
<span class="lineno"></span><span class="op" id="4817372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="4817375">func</span>&nbsp;<span class="op" id="4817380">(</span><span class="ident" id="4817381">z</span>&nbsp;<span class="op" id="4817383">*</span><span class="ident" id="4817384">reader</span><span class="op" id="4817390">)</span>&nbsp;<span class="ident" id="4817392">Reset</span><span class="op" id="4817397">(</span><span class="ident" id="4817398">r</span>&nbsp;<span class="ident" id="4817400">io</span><span class="op" id="4817402">.</span><span class="ident" id="4817403">Reader</span><span class="op" id="4817409">,</span>&nbsp;<span class="ident" id="4817411">dict</span>&nbsp;<span class="op" id="4817416">[</span><span class="op" id="4817417">]</span><span class="builtintype" id="4817418">byte</span><span class="op" id="4817422">)</span>&nbsp;<span class="builtintype" id="4817424">error</span>&nbsp;<span class="op" id="4817430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817433">if</span>&nbsp;<span class="ident" id="4817436">fr</span><span class="op" id="4817438">,</span>&nbsp;<span class="ident" id="4817440">ok</span>&nbsp;<span class="op" id="4817443">:=</span>&nbsp;<span class="ident" id="4817446">r</span><span class="op" id="4817447">.</span><span class="op" id="4817448">(</span><span class="ident" id="4817449">flate</span><span class="op" id="4817454">.</span><span class="ident" id="4817455">Reader</span><span class="op" id="4817461">)</span><span class="op" id="4817462">;</span>&nbsp;<span class="ident" id="4817464">ok</span>&nbsp;<span class="op" id="4817467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817471">z</span><span class="op" id="4817472">.</span><span class="ident" id="4817473">r</span>&nbsp;<span class="op" id="4817475">=</span>&nbsp;<span class="ident" id="4817477">fr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817481">}</span>&nbsp;<span class="keyword" id="4817483">else</span>&nbsp;<span class="op" id="4817488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817492">z</span><span class="op" id="4817493">.</span><span class="ident" id="4817494">r</span>&nbsp;<span class="op" id="4817496">=</span>&nbsp;<span class="ident" id="4817498">bufio</span><span class="op" id="4817503">.</span><span class="ident" id="4817504">NewReader</span><span class="op" id="4817513">(</span><span class="ident" id="4817514">r</span><span class="op" id="4817515">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817521">_</span><span class="op" id="4817522">,</span>&nbsp;<span class="ident" id="4817524">err</span>&nbsp;<span class="op" id="4817528">:=</span>&nbsp;<span class="ident" id="4817531">io</span><span class="op" id="4817533">.</span><span class="ident" id="4817534">ReadFull</span><span class="op" id="4817542">(</span><span class="ident" id="4817543">z</span><span class="op" id="4817544">.</span><span class="ident" id="4817545">r</span><span class="op" id="4817546">,</span>&nbsp;<span class="ident" id="4817548">z</span><span class="op" id="4817549">.</span><span class="ident" id="4817550">scratch</span><span class="op" id="4817557">[</span><span class="num" id="4817558">0</span><span class="op" id="4817559">:</span><span class="num" id="4817560">2</span><span class="op" id="4817561">]</span><span class="op" id="4817562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817565">if</span>&nbsp;<span class="ident" id="4817568">err</span>&nbsp;<span class="op" id="4817572">!=</span>&nbsp;<span class="builtintype" id="4817575">nil</span>&nbsp;<span class="op" id="4817579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817583">return</span>&nbsp;<span class="ident" id="4817590">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817595">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817598">h</span>&nbsp;<span class="op" id="4817600">:=</span>&nbsp;<span class="builtintype" id="4817603">uint</span><span class="op" id="4817607">(</span><span class="ident" id="4817608">z</span><span class="op" id="4817609">.</span><span class="ident" id="4817610">scratch</span><span class="op" id="4817617">[</span><span class="num" id="4817618">0</span><span class="op" id="4817619">]</span><span class="op" id="4817620">)</span><span class="op" id="4817621">&lt;&lt;</span><span class="num" id="4817623">8</span>&nbsp;<span class="op" id="4817625">|</span>&nbsp;<span class="builtintype" id="4817627">uint</span><span class="op" id="4817631">(</span><span class="ident" id="4817632">z</span><span class="op" id="4817633">.</span><span class="ident" id="4817634">scratch</span><span class="op" id="4817641">[</span><span class="num" id="4817642">1</span><span class="op" id="4817643">]</span><span class="op" id="4817644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817647">if</span>&nbsp;<span class="op" id="4817650">(</span><span class="ident" id="4817651">z</span><span class="op" id="4817652">.</span><span class="ident" id="4817653">scratch</span><span class="op" id="4817660">[</span><span class="num" id="4817661">0</span><span class="op" id="4817662">]</span><span class="op" id="4817663">&amp;</span><span class="num" id="4817664">0x0f</span>&nbsp;<span class="op" id="4817669">!=</span>&nbsp;<span class="ident" id="4817672">zlibDeflate</span><span class="op" id="4817683">)</span>&nbsp;<span class="op" id="4817685">||</span>&nbsp;<span class="op" id="4817688">(</span><span class="ident" id="4817689">h</span><span class="op" id="4817690">%</span><span class="num" id="4817691">31</span>&nbsp;<span class="op" id="4817694">!=</span>&nbsp;<span class="num" id="4817697">0</span><span class="op" id="4817698">)</span>&nbsp;<span class="op" id="4817700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817704">return</span>&nbsp;<span class="ident" id="4817711">ErrHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817725">haveDict</span>&nbsp;<span class="op" id="4817734">:=</span>&nbsp;<span class="ident" id="4817737">z</span><span class="op" id="4817738">.</span><span class="ident" id="4817739">scratch</span><span class="op" id="4817746">[</span><span class="num" id="4817747">1</span><span class="op" id="4817748">]</span><span class="op" id="4817749">&amp;</span><span class="num" id="4817750">0x20</span>&nbsp;<span class="op" id="4817755">!=</span>&nbsp;<span class="num" id="4817758">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817761">if</span>&nbsp;<span class="ident" id="4817764">haveDict</span>&nbsp;<span class="op" id="4817773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817777">_</span><span class="op" id="4817778">,</span>&nbsp;<span class="ident" id="4817780">err</span>&nbsp;<span class="op" id="4817784">=</span>&nbsp;<span class="ident" id="4817786">io</span><span class="op" id="4817788">.</span><span class="ident" id="4817789">ReadFull</span><span class="op" id="4817797">(</span><span class="ident" id="4817798">z</span><span class="op" id="4817799">.</span><span class="ident" id="4817800">r</span><span class="op" id="4817801">,</span>&nbsp;<span class="ident" id="4817803">z</span><span class="op" id="4817804">.</span><span class="ident" id="4817805">scratch</span><span class="op" id="4817812">[</span><span class="num" id="4817813">0</span><span class="op" id="4817814">:</span><span class="num" id="4817815">4</span><span class="op" id="4817816">]</span><span class="op" id="4817817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817821">if</span>&nbsp;<span class="ident" id="4817824">err</span>&nbsp;<span class="op" id="4817828">!=</span>&nbsp;<span class="builtintype" id="4817831">nil</span>&nbsp;<span class="op" id="4817835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817840">return</span>&nbsp;<span class="ident" id="4817847">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4817853">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4817857">checksum</span>&nbsp;<span class="op" id="4817866">:=</span>&nbsp;<span class="builtintype" id="4817869">uint32</span><span class="op" id="4817875">(</span><span class="ident" id="4817876">z</span><span class="op" id="4817877">.</span><span class="ident" id="4817878">scratch</span><span class="op" id="4817885">[</span><span class="num" id="4817886">0</span><span class="op" id="4817887">]</span><span class="op" id="4817888">)</span><span class="op" id="4817889">&lt;&lt;</span><span class="num" id="4817891">24</span>&nbsp;<span class="op" id="4817894">|</span>&nbsp;<span class="builtintype" id="4817896">uint32</span><span class="op" id="4817902">(</span><span class="ident" id="4817903">z</span><span class="op" id="4817904">.</span><span class="ident" id="4817905">scratch</span><span class="op" id="4817912">[</span><span class="num" id="4817913">1</span><span class="op" id="4817914">]</span><span class="op" id="4817915">)</span><span class="op" id="4817916">&lt;&lt;</span><span class="num" id="4817918">16</span>&nbsp;<span class="op" id="4817921">|</span>&nbsp;<span class="builtintype" id="4817923">uint32</span><span class="op" id="4817929">(</span><span class="ident" id="4817930">z</span><span class="op" id="4817931">.</span><span class="ident" id="4817932">scratch</span><span class="op" id="4817939">[</span><span class="num" id="4817940">2</span><span class="op" id="4817941">]</span><span class="op" id="4817942">)</span><span class="op" id="4817943">&lt;&lt;</span><span class="num" id="4817945">8</span>&nbsp;<span class="op" id="4817947">|</span>&nbsp;<span class="builtintype" id="4817949">uint32</span><span class="op" id="4817955">(</span><span class="ident" id="4817956">z</span><span class="op" id="4817957">.</span><span class="ident" id="4817958">scratch</span><span class="op" id="4817965">[</span><span class="num" id="4817966">3</span><span class="op" id="4817967">]</span><span class="op" id="4817968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4817972">if</span>&nbsp;<span class="ident" id="4817975">checksum</span>&nbsp;<span class="op" id="4817984">!=</span>&nbsp;<span class="ident" id="4817987">adler32</span><span class="op" id="4817994">.</span><span class="ident" id="4817995">Checksum</span><span class="op" id="4818003">(</span><span class="ident" id="4818004">dict</span><span class="op" id="4818008">)</span>&nbsp;<span class="op" id="4818010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4818015">return</span>&nbsp;<span class="ident" id="4818022">ErrDictionary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818041">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4818044">if</span>&nbsp;<span class="ident" id="4818047">z</span><span class="op" id="4818048">.</span><span class="ident" id="4818049">decompressor</span>&nbsp;<span class="op" id="4818062">==</span>&nbsp;<span class="builtintype" id="4818065">nil</span>&nbsp;<span class="op" id="4818069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4818073">if</span>&nbsp;<span class="ident" id="4818076">haveDict</span>&nbsp;<span class="op" id="4818085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818090">z</span><span class="op" id="4818091">.</span><span class="ident" id="4818092">decompressor</span>&nbsp;<span class="op" id="4818105">=</span>&nbsp;<span class="ident" id="4818107">flate</span><span class="op" id="4818112">.</span><span class="ident" id="4818113">NewReaderDict</span><span class="op" id="4818126">(</span><span class="ident" id="4818127">z</span><span class="op" id="4818128">.</span><span class="ident" id="4818129">r</span><span class="op" id="4818130">,</span>&nbsp;<span class="ident" id="4818132">dict</span><span class="op" id="4818136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818140">}</span>&nbsp;<span class="keyword" id="4818142">else</span>&nbsp;<span class="op" id="4818147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818152">z</span><span class="op" id="4818153">.</span><span class="ident" id="4818154">decompressor</span>&nbsp;<span class="op" id="4818167">=</span>&nbsp;<span class="ident" id="4818169">flate</span><span class="op" id="4818174">.</span><span class="ident" id="4818175">NewReader</span><span class="op" id="4818184">(</span><span class="ident" id="4818185">z</span><span class="op" id="4818186">.</span><span class="ident" id="4818187">r</span><span class="op" id="4818188">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818195">}</span>&nbsp;<span class="keyword" id="4818197">else</span>&nbsp;<span class="op" id="4818202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818206">z</span><span class="op" id="4818207">.</span><span class="ident" id="4818208">decompressor</span><span class="op" id="4818220">.</span><span class="op" id="4818221">(</span><span class="ident" id="4818222">flate</span><span class="op" id="4818227">.</span><span class="ident" id="4818228">Resetter</span><span class="op" id="4818236">)</span><span class="op" id="4818237">.</span><span class="ident" id="4818238">Reset</span><span class="op" id="4818243">(</span><span class="ident" id="4818244">z</span><span class="op" id="4818245">.</span><span class="ident" id="4818246">r</span><span class="op" id="4818247">,</span>&nbsp;<span class="ident" id="4818249">dict</span><span class="op" id="4818253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4818256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4818259">z</span><span class="op" id="4818260">.</span><span class="ident" id="4818261">digest</span>&nbsp;<span class="op" id="4818268">=</span>&nbsp;<span class="ident" id="4818270">adler32</span><span class="op" id="4818277">.</span><span class="ident" id="4818278">New</span><span class="op" id="4818281">(</span><span class="op" id="4818282">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4818285">return</span>&nbsp;<span class="builtintype" id="4818292">nil</span><br>
<span class="lineno"></span><span class="op" id="4818296">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
