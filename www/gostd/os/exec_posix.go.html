<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2320112">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2320167">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2320221">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2320272">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2320350">package</span>&nbsp;<span class="ident" id="2320358">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2320362">import</span>&nbsp;<span class="op" id="2320369">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2320372">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2320382">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2320385">//&nbsp;The&nbsp;only&nbsp;signal&nbsp;values&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;present&nbsp;on&nbsp;all&nbsp;systems</span><br>
<span class="lineno"></span><span class="comment" id="2320451">//&nbsp;are&nbsp;Interrupt&nbsp;(send&nbsp;the&nbsp;process&nbsp;an&nbsp;interrupt)&nbsp;and&nbsp;Kill&nbsp;(force</span><br>
<span class="lineno">15</span><span class="comment" id="2320516">//&nbsp;the&nbsp;process&nbsp;to&nbsp;exit).</span><br>
<span class="lineno"></span><span class="keyword" id="2320541">var</span>&nbsp;<span class="op" id="2320545">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320548">Interrupt</span>&nbsp;<span class="ident" id="2320558">Signal</span>&nbsp;<span class="op" id="2320565">=</span>&nbsp;<span class="ident" id="2320567">syscall</span><span class="op" id="2320574">.</span><span class="ident" id="2320575">SIGINT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320583">Kill</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2320593">Signal</span>&nbsp;<span class="op" id="2320600">=</span>&nbsp;<span class="ident" id="2320602">syscall</span><span class="op" id="2320609">.</span><span class="ident" id="2320610">SIGKILL</span><br>
<span class="lineno"></span><span class="op" id="2320618">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="2320621">func</span>&nbsp;<span class="ident" id="2320626">startProcess</span><span class="op" id="2320638">(</span><span class="ident" id="2320639">name</span>&nbsp;<span class="builtintype" id="2320644">string</span><span class="op" id="2320650">,</span>&nbsp;<span class="ident" id="2320652">argv</span>&nbsp;<span class="op" id="2320657">[</span><span class="op" id="2320658">]</span><span class="builtintype" id="2320659">string</span><span class="op" id="2320665">,</span>&nbsp;<span class="ident" id="2320667">attr</span>&nbsp;<span class="op" id="2320672">*</span><span class="ident" id="2320673">ProcAttr</span><span class="op" id="2320681">)</span>&nbsp;<span class="op" id="2320683">(</span><span class="ident" id="2320684">p</span>&nbsp;<span class="op" id="2320686">*</span><span class="ident" id="2320687">Process</span><span class="op" id="2320694">,</span>&nbsp;<span class="ident" id="2320696">err</span>&nbsp;<span class="builtintype" id="2320700">error</span><span class="op" id="2320705">)</span>&nbsp;<span class="op" id="2320707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320710">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;SysProcAttr&nbsp;(ie.&nbsp;no&nbsp;Chroot&nbsp;or&nbsp;changed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320767">//&nbsp;UID/GID),&nbsp;double-check&nbsp;existence&nbsp;of&nbsp;the&nbsp;directory&nbsp;we&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2320829">//&nbsp;to&nbsp;chdir&nbsp;into.&nbsp;&nbsp;We&nbsp;can&nbsp;make&nbsp;the&nbsp;error&nbsp;clearer&nbsp;this&nbsp;way.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320889">if</span>&nbsp;<span class="ident" id="2320892">attr</span>&nbsp;<span class="op" id="2320897">!=</span>&nbsp;<span class="ident" id="2320900">nil</span>&nbsp;<span class="op" id="2320904">&amp;&amp;</span>&nbsp;<span class="ident" id="2320907">attr</span><span class="op" id="2320911">.</span><span class="ident" id="2320912">Sys</span>&nbsp;<span class="op" id="2320916">==</span>&nbsp;<span class="ident" id="2320919">nil</span>&nbsp;<span class="op" id="2320923">&amp;&amp;</span>&nbsp;<span class="ident" id="2320926">attr</span><span class="op" id="2320930">.</span><span class="ident" id="2320931">Dir</span>&nbsp;<span class="op" id="2320935">!=</span>&nbsp;<span class="string" id="2320938">&#34;&#34;</span>&nbsp;<span class="op" id="2320941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2320945">if</span>&nbsp;<span class="ident" id="2320948">_</span><span class="op" id="2320949">,</span>&nbsp;<span class="ident" id="2320951">err</span>&nbsp;<span class="op" id="2320955">:=</span>&nbsp;<span class="ident" id="2320958">Stat</span><span class="op" id="2320962">(</span><span class="ident" id="2320963">attr</span><span class="op" id="2320967">.</span><span class="ident" id="2320968">Dir</span><span class="op" id="2320971">)</span><span class="op" id="2320972">;</span>&nbsp;<span class="ident" id="2320974">err</span>&nbsp;<span class="op" id="2320978">!=</span>&nbsp;<span class="ident" id="2320981">nil</span>&nbsp;<span class="op" id="2320985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2320990">pe</span>&nbsp;<span class="op" id="2320993">:=</span>&nbsp;<span class="ident" id="2320996">err</span><span class="op" id="2320999">.</span><span class="op" id="2321000">(</span><span class="op" id="2321001">*</span><span class="ident" id="2321002">PathError</span><span class="op" id="2321011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321016">pe</span><span class="op" id="2321018">.</span><span class="ident" id="2321019">Op</span>&nbsp;<span class="op" id="2321022">=</span>&nbsp;<span class="string" id="2321024">&#34;chdir&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321035">return</span>&nbsp;<span class="ident" id="2321042">nil</span><span class="op" id="2321045">,</span>&nbsp;<span class="ident" id="2321047">pe</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321059">sysattr</span>&nbsp;<span class="op" id="2321067">:=</span>&nbsp;<span class="op" id="2321070">&amp;</span><span class="ident" id="2321071">syscall</span><span class="op" id="2321078">.</span><span class="ident" id="2321079">ProcAttr</span><span class="op" id="2321087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321091">Dir</span><span class="op" id="2321094">:</span>&nbsp;<span class="ident" id="2321096">attr</span><span class="op" id="2321100">.</span><span class="ident" id="2321101">Dir</span><span class="op" id="2321104">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321108">Env</span><span class="op" id="2321111">:</span>&nbsp;<span class="ident" id="2321113">attr</span><span class="op" id="2321117">.</span><span class="ident" id="2321118">Env</span><span class="op" id="2321121">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321125">Sys</span><span class="op" id="2321128">:</span>&nbsp;<span class="ident" id="2321130">attr</span><span class="op" id="2321134">.</span><span class="ident" id="2321135">Sys</span><span class="op" id="2321138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321144">if</span>&nbsp;<span class="ident" id="2321147">sysattr</span><span class="op" id="2321154">.</span><span class="ident" id="2321155">Env</span>&nbsp;<span class="op" id="2321159">==</span>&nbsp;<span class="ident" id="2321162">nil</span>&nbsp;<span class="op" id="2321166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321170">sysattr</span><span class="op" id="2321177">.</span><span class="ident" id="2321178">Env</span>&nbsp;<span class="op" id="2321182">=</span>&nbsp;<span class="ident" id="2321184">Environ</span><span class="op" id="2321191">(</span><span class="op" id="2321192">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321198">for</span>&nbsp;<span class="ident" id="2321202">_</span><span class="op" id="2321203">,</span>&nbsp;<span class="ident" id="2321205">f</span>&nbsp;<span class="op" id="2321207">:=</span>&nbsp;<span class="keyword" id="2321210">range</span>&nbsp;<span class="ident" id="2321216">attr</span><span class="op" id="2321220">.</span><span class="ident" id="2321221">Files</span>&nbsp;<span class="op" id="2321227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321231">sysattr</span><span class="op" id="2321238">.</span><span class="ident" id="2321239">Files</span>&nbsp;<span class="op" id="2321245">=</span>&nbsp;<span class="builtinfunc" id="2321247">append</span><span class="op" id="2321253">(</span><span class="ident" id="2321254">sysattr</span><span class="op" id="2321261">.</span><span class="ident" id="2321262">Files</span><span class="op" id="2321267">,</span>&nbsp;<span class="ident" id="2321269">f</span><span class="op" id="2321270">.</span><span class="ident" id="2321271">Fd</span><span class="op" id="2321273">(</span><span class="op" id="2321274">)</span><span class="op" id="2321275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321282">pid</span><span class="op" id="2321285">,</span>&nbsp;<span class="ident" id="2321287">h</span><span class="op" id="2321288">,</span>&nbsp;<span class="ident" id="2321290">e</span>&nbsp;<span class="op" id="2321292">:=</span>&nbsp;<span class="ident" id="2321295">syscall</span><span class="op" id="2321302">.</span><span class="ident" id="2321303">StartProcess</span><span class="op" id="2321315">(</span><span class="ident" id="2321316">name</span><span class="op" id="2321320">,</span>&nbsp;<span class="ident" id="2321322">argv</span><span class="op" id="2321326">,</span>&nbsp;<span class="ident" id="2321328">sysattr</span><span class="op" id="2321335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321338">if</span>&nbsp;<span class="ident" id="2321341">e</span>&nbsp;<span class="op" id="2321343">!=</span>&nbsp;<span class="ident" id="2321346">nil</span>&nbsp;<span class="op" id="2321350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321354">return</span>&nbsp;<span class="ident" id="2321361">nil</span><span class="op" id="2321364">,</span>&nbsp;<span class="op" id="2321366">&amp;</span><span class="ident" id="2321367">PathError</span><span class="op" id="2321376">{</span><span class="string" id="2321377">&#34;fork/exec&#34;</span><span class="op" id="2321388">,</span>&nbsp;<span class="ident" id="2321390">name</span><span class="op" id="2321394">,</span>&nbsp;<span class="ident" id="2321396">e</span><span class="op" id="2321397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2321400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321403">return</span>&nbsp;<span class="ident" id="2321410">newProcess</span><span class="op" id="2321420">(</span><span class="ident" id="2321421">pid</span><span class="op" id="2321424">,</span>&nbsp;<span class="ident" id="2321426">h</span><span class="op" id="2321427">)</span><span class="op" id="2321428">,</span>&nbsp;<span class="ident" id="2321430">nil</span><br>
<span class="lineno">50</span><span class="op" id="2321434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2321437">func</span>&nbsp;<span class="op" id="2321442">(</span><span class="ident" id="2321443">p</span>&nbsp;<span class="op" id="2321445">*</span><span class="ident" id="2321446">Process</span><span class="op" id="2321453">)</span>&nbsp;<span class="ident" id="2321455">kill</span><span class="op" id="2321459">(</span><span class="op" id="2321460">)</span>&nbsp;<span class="builtintype" id="2321462">error</span>&nbsp;<span class="op" id="2321468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321471">return</span>&nbsp;<span class="ident" id="2321478">p</span><span class="op" id="2321479">.</span><span class="ident" id="2321480">Signal</span><span class="op" id="2321486">(</span><span class="ident" id="2321487">Kill</span><span class="op" id="2321491">)</span><br>
<span class="lineno"></span><span class="op" id="2321493">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="2321496">//&nbsp;ProcessState&nbsp;stores&nbsp;information&nbsp;about&nbsp;a&nbsp;process,&nbsp;as&nbsp;reported&nbsp;by&nbsp;Wait.</span><br>
<span class="lineno"></span><span class="keyword" id="2321569">type</span>&nbsp;<span class="ident" id="2321574">ProcessState</span>&nbsp;<span class="keyword" id="2321587">struct</span>&nbsp;<span class="op" id="2321594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321597">pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2321604">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2321623">//&nbsp;The&nbsp;process&#39;s&nbsp;id.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321645">status</span>&nbsp;<span class="ident" id="2321652">syscall</span><span class="op" id="2321659">.</span><span class="ident" id="2321660">WaitStatus</span>&nbsp;<span class="comment" id="2321671">//&nbsp;System-dependent&nbsp;status&nbsp;info.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2321705">rusage</span>&nbsp;<span class="op" id="2321712">*</span><span class="ident" id="2321713">syscall</span><span class="op" id="2321720">.</span><span class="ident" id="2321721">Rusage</span><br>
<span class="lineno"></span><span class="op" id="2321728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2321731">//&nbsp;Pid&nbsp;returns&nbsp;the&nbsp;process&nbsp;id&nbsp;of&nbsp;the&nbsp;exited&nbsp;process.</span><br>
<span class="lineno"></span><span class="keyword" id="2321784">func</span>&nbsp;<span class="op" id="2321789">(</span><span class="ident" id="2321790">p</span>&nbsp;<span class="op" id="2321792">*</span><span class="ident" id="2321793">ProcessState</span><span class="op" id="2321805">)</span>&nbsp;<span class="ident" id="2321807">Pid</span><span class="op" id="2321810">(</span><span class="op" id="2321811">)</span>&nbsp;<span class="builtintype" id="2321813">int</span>&nbsp;<span class="op" id="2321817">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321820">return</span>&nbsp;<span class="ident" id="2321827">p</span><span class="op" id="2321828">.</span><span class="ident" id="2321829">pid</span><br>
<span class="lineno"></span><span class="op" id="2321833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2321836">func</span>&nbsp;<span class="op" id="2321841">(</span><span class="ident" id="2321842">p</span>&nbsp;<span class="op" id="2321844">*</span><span class="ident" id="2321845">ProcessState</span><span class="op" id="2321857">)</span>&nbsp;<span class="ident" id="2321859">exited</span><span class="op" id="2321865">(</span><span class="op" id="2321866">)</span>&nbsp;<span class="builtintype" id="2321868">bool</span>&nbsp;<span class="op" id="2321873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321876">return</span>&nbsp;<span class="ident" id="2321883">p</span><span class="op" id="2321884">.</span><span class="ident" id="2321885">status</span><span class="op" id="2321891">.</span><span class="ident" id="2321892">Exited</span><span class="op" id="2321898">(</span><span class="op" id="2321899">)</span><br>
<span class="lineno">70</span><span class="op" id="2321901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2321904">func</span>&nbsp;<span class="op" id="2321909">(</span><span class="ident" id="2321910">p</span>&nbsp;<span class="op" id="2321912">*</span><span class="ident" id="2321913">ProcessState</span><span class="op" id="2321925">)</span>&nbsp;<span class="ident" id="2321927">success</span><span class="op" id="2321934">(</span><span class="op" id="2321935">)</span>&nbsp;<span class="builtintype" id="2321937">bool</span>&nbsp;<span class="op" id="2321942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2321945">return</span>&nbsp;<span class="ident" id="2321952">p</span><span class="op" id="2321953">.</span><span class="ident" id="2321954">status</span><span class="op" id="2321960">.</span><span class="ident" id="2321961">ExitStatus</span><span class="op" id="2321971">(</span><span class="op" id="2321972">)</span>&nbsp;<span class="op" id="2321974">==</span>&nbsp;<span class="num" id="2321977">0</span><br>
<span class="lineno"></span><span class="op" id="2321979">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="2321982">func</span>&nbsp;<span class="op" id="2321987">(</span><span class="ident" id="2321988">p</span>&nbsp;<span class="op" id="2321990">*</span><span class="ident" id="2321991">ProcessState</span><span class="op" id="2322003">)</span>&nbsp;<span class="ident" id="2322005">sys</span><span class="op" id="2322008">(</span><span class="op" id="2322009">)</span>&nbsp;<span class="keyword" id="2322011">interface</span><span class="op" id="2322020">{</span><span class="op" id="2322021">}</span>&nbsp;<span class="op" id="2322023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322026">return</span>&nbsp;<span class="ident" id="2322033">p</span><span class="op" id="2322034">.</span><span class="ident" id="2322035">status</span><br>
<span class="lineno"></span><span class="op" id="2322042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="2322045">func</span>&nbsp;<span class="op" id="2322050">(</span><span class="ident" id="2322051">p</span>&nbsp;<span class="op" id="2322053">*</span><span class="ident" id="2322054">ProcessState</span><span class="op" id="2322066">)</span>&nbsp;<span class="ident" id="2322068">sysUsage</span><span class="op" id="2322076">(</span><span class="op" id="2322077">)</span>&nbsp;<span class="keyword" id="2322079">interface</span><span class="op" id="2322088">{</span><span class="op" id="2322089">}</span>&nbsp;<span class="op" id="2322091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322094">return</span>&nbsp;<span class="ident" id="2322101">p</span><span class="op" id="2322102">.</span><span class="ident" id="2322103">rusage</span><br>
<span class="lineno"></span><span class="op" id="2322110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2322113">//&nbsp;Convert&nbsp;i&nbsp;to&nbsp;decimal&nbsp;string.</span><br>
<span class="lineno">85</span><span class="keyword" id="2322145">func</span>&nbsp;<span class="ident" id="2322150">itod</span><span class="op" id="2322154">(</span><span class="ident" id="2322155">i</span>&nbsp;<span class="builtintype" id="2322157">int</span><span class="op" id="2322160">)</span>&nbsp;<span class="builtintype" id="2322162">string</span>&nbsp;<span class="op" id="2322169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322172">if</span>&nbsp;<span class="ident" id="2322175">i</span>&nbsp;<span class="op" id="2322177">==</span>&nbsp;<span class="num" id="2322180">0</span>&nbsp;<span class="op" id="2322182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322186">return</span>&nbsp;<span class="string" id="2322193">&#34;0&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322202">u</span>&nbsp;<span class="op" id="2322204">:=</span>&nbsp;<span class="ident" id="2322207">uint64</span><span class="op" id="2322213">(</span><span class="ident" id="2322214">i</span><span class="op" id="2322215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322218">if</span>&nbsp;<span class="ident" id="2322221">i</span>&nbsp;<span class="op" id="2322223">&lt;</span>&nbsp;<span class="num" id="2322225">0</span>&nbsp;<span class="op" id="2322227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322231">u</span>&nbsp;<span class="op" id="2322233">=</span>&nbsp;<span class="op" id="2322235">-</span><span class="ident" id="2322236">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322239">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2322243">//&nbsp;Assemble&nbsp;decimal&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322282">var</span>&nbsp;<span class="ident" id="2322286">b</span>&nbsp;<span class="op" id="2322288">[</span><span class="num" id="2322289">32</span><span class="op" id="2322291">]</span><span class="builtintype" id="2322292">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322298">bp</span>&nbsp;<span class="op" id="2322301">:=</span>&nbsp;<span class="builtinfunc" id="2322304">len</span><span class="op" id="2322307">(</span><span class="ident" id="2322308">b</span><span class="op" id="2322309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322312">for</span>&nbsp;<span class="op" id="2322316">;</span>&nbsp;<span class="ident" id="2322318">u</span>&nbsp;<span class="op" id="2322320">&gt;</span>&nbsp;<span class="num" id="2322322">0</span><span class="op" id="2322323">;</span>&nbsp;<span class="ident" id="2322325">u</span>&nbsp;<span class="op" id="2322327">/=</span>&nbsp;<span class="num" id="2322330">10</span>&nbsp;<span class="op" id="2322333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322337">bp</span><span class="op" id="2322339">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322344">b</span><span class="op" id="2322345">[</span><span class="ident" id="2322346">bp</span><span class="op" id="2322348">]</span>&nbsp;<span class="op" id="2322350">=</span>&nbsp;<span class="builtintype" id="2322352">byte</span><span class="op" id="2322356">(</span><span class="ident" id="2322357">u</span><span class="op" id="2322358">%</span><span class="num" id="2322359">10</span><span class="op" id="2322361">)</span>&nbsp;<span class="op" id="2322363">+</span>&nbsp;<span class="string" id="2322365">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322374">if</span>&nbsp;<span class="ident" id="2322377">i</span>&nbsp;<span class="op" id="2322379">&lt;</span>&nbsp;<span class="num" id="2322381">0</span>&nbsp;<span class="op" id="2322383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322387">bp</span><span class="op" id="2322389">--</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322394">b</span><span class="op" id="2322395">[</span><span class="ident" id="2322396">bp</span><span class="op" id="2322398">]</span>&nbsp;<span class="op" id="2322400">=</span>&nbsp;<span class="string" id="2322402">&#39;-&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322411">return</span>&nbsp;<span class="builtintype" id="2322418">string</span><span class="op" id="2322424">(</span><span class="ident" id="2322425">b</span><span class="op" id="2322426">[</span><span class="ident" id="2322427">bp</span><span class="op" id="2322429">:</span><span class="op" id="2322430">]</span><span class="op" id="2322431">)</span><br>
<span class="lineno"></span><span class="op" id="2322433">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="keyword" id="2322436">func</span>&nbsp;<span class="op" id="2322441">(</span><span class="ident" id="2322442">p</span>&nbsp;<span class="op" id="2322444">*</span><span class="ident" id="2322445">ProcessState</span><span class="op" id="2322457">)</span>&nbsp;<span class="ident" id="2322459">String</span><span class="op" id="2322465">(</span><span class="op" id="2322466">)</span>&nbsp;<span class="builtintype" id="2322468">string</span>&nbsp;<span class="op" id="2322475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322478">if</span>&nbsp;<span class="ident" id="2322481">p</span>&nbsp;<span class="op" id="2322483">==</span>&nbsp;<span class="ident" id="2322486">nil</span>&nbsp;<span class="op" id="2322490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322494">return</span>&nbsp;<span class="string" id="2322501">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322510">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322513">status</span>&nbsp;<span class="op" id="2322520">:=</span>&nbsp;<span class="ident" id="2322523">p</span><span class="op" id="2322524">.</span><span class="ident" id="2322525">Sys</span><span class="op" id="2322528">(</span><span class="op" id="2322529">)</span><span class="op" id="2322530">.</span><span class="op" id="2322531">(</span><span class="ident" id="2322532">syscall</span><span class="op" id="2322539">.</span><span class="ident" id="2322540">WaitStatus</span><span class="op" id="2322550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322553">res</span>&nbsp;<span class="op" id="2322557">:=</span>&nbsp;<span class="string" id="2322560">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322564">switch</span>&nbsp;<span class="op" id="2322571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322574">case</span>&nbsp;<span class="ident" id="2322579">status</span><span class="op" id="2322585">.</span><span class="ident" id="2322586">Exited</span><span class="op" id="2322592">(</span><span class="op" id="2322593">)</span><span class="op" id="2322594">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322598">res</span>&nbsp;<span class="op" id="2322602">=</span>&nbsp;<span class="string" id="2322604">&#34;exit&nbsp;status&nbsp;&#34;</span>&nbsp;<span class="op" id="2322619">+</span>&nbsp;<span class="ident" id="2322621">itod</span><span class="op" id="2322625">(</span><span class="ident" id="2322626">status</span><span class="op" id="2322632">.</span><span class="ident" id="2322633">ExitStatus</span><span class="op" id="2322643">(</span><span class="op" id="2322644">)</span><span class="op" id="2322645">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322648">case</span>&nbsp;<span class="ident" id="2322653">status</span><span class="op" id="2322659">.</span><span class="ident" id="2322660">Signaled</span><span class="op" id="2322668">(</span><span class="op" id="2322669">)</span><span class="op" id="2322670">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322674">res</span>&nbsp;<span class="op" id="2322678">=</span>&nbsp;<span class="string" id="2322680">&#34;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2322691">+</span>&nbsp;<span class="ident" id="2322693">status</span><span class="op" id="2322699">.</span><span class="ident" id="2322700">Signal</span><span class="op" id="2322706">(</span><span class="op" id="2322707">)</span><span class="op" id="2322708">.</span><span class="ident" id="2322709">String</span><span class="op" id="2322715">(</span><span class="op" id="2322716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322719">case</span>&nbsp;<span class="ident" id="2322724">status</span><span class="op" id="2322730">.</span><span class="ident" id="2322731">Stopped</span><span class="op" id="2322738">(</span><span class="op" id="2322739">)</span><span class="op" id="2322740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322744">res</span>&nbsp;<span class="op" id="2322748">=</span>&nbsp;<span class="string" id="2322750">&#34;stop&nbsp;signal:&nbsp;&#34;</span>&nbsp;<span class="op" id="2322766">+</span>&nbsp;<span class="ident" id="2322768">status</span><span class="op" id="2322774">.</span><span class="ident" id="2322775">StopSignal</span><span class="op" id="2322785">(</span><span class="op" id="2322786">)</span><span class="op" id="2322787">.</span><span class="ident" id="2322788">String</span><span class="op" id="2322794">(</span><span class="op" id="2322795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322799">if</span>&nbsp;<span class="ident" id="2322802">status</span><span class="op" id="2322808">.</span><span class="ident" id="2322809">StopSignal</span><span class="op" id="2322819">(</span><span class="op" id="2322820">)</span>&nbsp;<span class="op" id="2322822">==</span>&nbsp;<span class="ident" id="2322825">syscall</span><span class="op" id="2322832">.</span><span class="ident" id="2322833">SIGTRAP</span>&nbsp;<span class="op" id="2322841">&amp;&amp;</span>&nbsp;<span class="ident" id="2322844">status</span><span class="op" id="2322850">.</span><span class="ident" id="2322851">TrapCause</span><span class="op" id="2322860">(</span><span class="op" id="2322861">)</span>&nbsp;<span class="op" id="2322863">!=</span>&nbsp;<span class="num" id="2322866">0</span>&nbsp;<span class="op" id="2322868">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322873">res</span>&nbsp;<span class="op" id="2322877">+=</span>&nbsp;<span class="string" id="2322880">&#34;&nbsp;(trap&nbsp;&#34;</span>&nbsp;<span class="op" id="2322890">+</span>&nbsp;<span class="ident" id="2322892">itod</span><span class="op" id="2322896">(</span><span class="ident" id="2322897">status</span><span class="op" id="2322903">.</span><span class="ident" id="2322904">TrapCause</span><span class="op" id="2322913">(</span><span class="op" id="2322914">)</span><span class="op" id="2322915">)</span>&nbsp;<span class="op" id="2322917">+</span>&nbsp;<span class="string" id="2322919">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322928">case</span>&nbsp;<span class="ident" id="2322933">status</span><span class="op" id="2322939">.</span><span class="ident" id="2322940">Continued</span><span class="op" id="2322949">(</span><span class="op" id="2322950">)</span><span class="op" id="2322951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2322955">res</span>&nbsp;<span class="op" id="2322959">=</span>&nbsp;<span class="string" id="2322961">&#34;continued&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2322974">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2322977">if</span>&nbsp;<span class="ident" id="2322980">status</span><span class="op" id="2322986">.</span><span class="ident" id="2322987">CoreDump</span><span class="op" id="2322995">(</span><span class="op" id="2322996">)</span>&nbsp;<span class="op" id="2322998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2323002">res</span>&nbsp;<span class="op" id="2323006">+=</span>&nbsp;<span class="string" id="2323009">&#34;&nbsp;(core&nbsp;dumped)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2323027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2323030">return</span>&nbsp;<span class="ident" id="2323037">res</span><br>
<span class="lineno"></span><span class="op" id="2323041">}</span>
</div>
</body>
</html>
