<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5761615">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5761670">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5761724">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5761775">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5761821">package</span>&nbsp;<span class="ident" id="5761829">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5761834">import</span>&nbsp;<span class="op" id="5761841">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761844">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761854">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761866">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761874">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761884">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761892">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761903">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761914">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5761925">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5761940">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5761943">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5762013">type</span>&nbsp;<span class="ident" id="5762018">Example</span>&nbsp;<span class="keyword" id="5762026">struct</span>&nbsp;<span class="op" id="5762033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762036">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5762048">string</span>&nbsp;<span class="comment" id="5762055">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762094">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5762106">string</span>&nbsp;<span class="comment" id="5762113">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762145">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5762157">ast</span><span class="op" id="5762160">.</span><span class="ident" id="5762161">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762167">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5762179">*</span><span class="ident" id="5762180">ast</span><span class="op" id="5762183">.</span><span class="ident" id="5762184">File</span>&nbsp;<span class="comment" id="5762189">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762232">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5762244">[</span><span class="op" id="5762245">]</span><span class="op" id="5762246">*</span><span class="ident" id="5762247">ast</span><span class="op" id="5762250">.</span><span class="ident" id="5762251">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762265">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5762277">string</span>&nbsp;<span class="comment" id="5762284">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762304">EmptyOutput</span>&nbsp;<span class="builtintype" id="5762316">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5762323">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5762347">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5762359">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5762366">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="5762396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5762399">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5762474">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="5762551">//</span><br>
<span class="lineno"></span><span class="comment" id="5762554">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5762624">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5762699">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="5762717">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="5762793">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5762869">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="5762932">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5763006">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5763082">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="5763155">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="5763189">func</span>&nbsp;<span class="ident" id="5763194">Examples</span><span class="op" id="5763202">(</span><span class="ident" id="5763203">files</span>&nbsp;<span class="op" id="5763209">...</span><span class="op" id="5763212">*</span><span class="ident" id="5763213">ast</span><span class="op" id="5763216">.</span><span class="ident" id="5763217">File</span><span class="op" id="5763221">)</span>&nbsp;<span class="op" id="5763223">[</span><span class="op" id="5763224">]</span><span class="op" id="5763225">*</span><span class="ident" id="5763226">Example</span>&nbsp;<span class="op" id="5763234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763237">var</span>&nbsp;<span class="ident" id="5763241">list</span>&nbsp;<span class="op" id="5763246">[</span><span class="op" id="5763247">]</span><span class="op" id="5763248">*</span><span class="ident" id="5763249">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763258">for</span>&nbsp;<span class="ident" id="5763262">_</span><span class="op" id="5763263">,</span>&nbsp;<span class="ident" id="5763265">file</span>&nbsp;<span class="op" id="5763270">:=</span>&nbsp;<span class="keyword" id="5763273">range</span>&nbsp;<span class="ident" id="5763279">files</span>&nbsp;<span class="op" id="5763285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763289">hasTests</span>&nbsp;<span class="op" id="5763298">:=</span>&nbsp;<span class="builtintype" id="5763301">false</span>&nbsp;<span class="comment" id="5763307">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763346">numDecl</span>&nbsp;<span class="op" id="5763354">:=</span>&nbsp;<span class="num" id="5763357">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5763364">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763415">var</span>&nbsp;<span class="ident" id="5763419">flist</span>&nbsp;<span class="op" id="5763425">[</span><span class="op" id="5763426">]</span><span class="op" id="5763427">*</span><span class="ident" id="5763428">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763438">for</span>&nbsp;<span class="ident" id="5763442">_</span><span class="op" id="5763443">,</span>&nbsp;<span class="ident" id="5763445">decl</span>&nbsp;<span class="op" id="5763450">:=</span>&nbsp;<span class="keyword" id="5763453">range</span>&nbsp;<span class="ident" id="5763459">file</span><span class="op" id="5763463">.</span><span class="ident" id="5763464">Decls</span>&nbsp;<span class="op" id="5763470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763475">if</span>&nbsp;<span class="ident" id="5763478">g</span><span class="op" id="5763479">,</span>&nbsp;<span class="ident" id="5763481">ok</span>&nbsp;<span class="op" id="5763484">:=</span>&nbsp;<span class="ident" id="5763487">decl</span><span class="op" id="5763491">.</span><span class="op" id="5763492">(</span><span class="op" id="5763493">*</span><span class="ident" id="5763494">ast</span><span class="op" id="5763497">.</span><span class="ident" id="5763498">GenDecl</span><span class="op" id="5763505">)</span><span class="op" id="5763506">;</span>&nbsp;<span class="ident" id="5763508">ok</span>&nbsp;<span class="op" id="5763511">&amp;&amp;</span>&nbsp;<span class="ident" id="5763514">g</span><span class="op" id="5763515">.</span><span class="ident" id="5763516">Tok</span>&nbsp;<span class="op" id="5763520">!=</span>&nbsp;<span class="ident" id="5763523">token</span><span class="op" id="5763528">.</span><span class="ident" id="5763529">IMPORT</span>&nbsp;<span class="op" id="5763536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763542">numDecl</span><span class="op" id="5763549">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763556">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763573">f</span><span class="op" id="5763574">,</span>&nbsp;<span class="ident" id="5763576">ok</span>&nbsp;<span class="op" id="5763579">:=</span>&nbsp;<span class="ident" id="5763582">decl</span><span class="op" id="5763586">.</span><span class="op" id="5763587">(</span><span class="op" id="5763588">*</span><span class="ident" id="5763589">ast</span><span class="op" id="5763592">.</span><span class="ident" id="5763593">FuncDecl</span><span class="op" id="5763601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763606">if</span>&nbsp;<span class="op" id="5763609">!</span><span class="ident" id="5763610">ok</span>&nbsp;<span class="op" id="5763613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763619">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763636">numDecl</span><span class="op" id="5763643">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763649">name</span>&nbsp;<span class="op" id="5763654">:=</span>&nbsp;<span class="ident" id="5763657">f</span><span class="op" id="5763658">.</span><span class="ident" id="5763659">Name</span><span class="op" id="5763663">.</span><span class="ident" id="5763664">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763672">if</span>&nbsp;<span class="ident" id="5763675">isTest</span><span class="op" id="5763681">(</span><span class="ident" id="5763682">name</span><span class="op" id="5763686">,</span>&nbsp;<span class="string" id="5763688">&#34;Test&#34;</span><span class="op" id="5763694">)</span>&nbsp;<span class="op" id="5763696">||</span>&nbsp;<span class="ident" id="5763699">isTest</span><span class="op" id="5763705">(</span><span class="ident" id="5763706">name</span><span class="op" id="5763710">,</span>&nbsp;<span class="string" id="5763712">&#34;Benchmark&#34;</span><span class="op" id="5763723">)</span>&nbsp;<span class="op" id="5763725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763731">hasTests</span>&nbsp;<span class="op" id="5763740">=</span>&nbsp;<span class="builtintype" id="5763742">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763751">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763768">if</span>&nbsp;<span class="op" id="5763771">!</span><span class="ident" id="5763772">isTest</span><span class="op" id="5763778">(</span><span class="ident" id="5763779">name</span><span class="op" id="5763783">,</span>&nbsp;<span class="string" id="5763785">&#34;Example&#34;</span><span class="op" id="5763794">)</span>&nbsp;<span class="op" id="5763796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763802">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763814">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763819">var</span>&nbsp;<span class="ident" id="5763823">doc</span>&nbsp;<span class="builtintype" id="5763827">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5763837">if</span>&nbsp;<span class="ident" id="5763840">f</span><span class="op" id="5763841">.</span><span class="ident" id="5763842">Doc</span>&nbsp;<span class="op" id="5763846">!=</span>&nbsp;<span class="ident" id="5763849">nil</span>&nbsp;<span class="op" id="5763853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763859">doc</span>&nbsp;<span class="op" id="5763863">=</span>&nbsp;<span class="ident" id="5763865">f</span><span class="op" id="5763866">.</span><span class="ident" id="5763867">Doc</span><span class="op" id="5763870">.</span><span class="ident" id="5763871">Text</span><span class="op" id="5763875">(</span><span class="op" id="5763876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5763881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763886">output</span><span class="op" id="5763892">,</span>&nbsp;<span class="ident" id="5763894">hasOutput</span>&nbsp;<span class="op" id="5763904">:=</span>&nbsp;<span class="ident" id="5763907">exampleOutput</span><span class="op" id="5763920">(</span><span class="ident" id="5763921">f</span><span class="op" id="5763922">.</span><span class="ident" id="5763923">Body</span><span class="op" id="5763927">,</span>&nbsp;<span class="ident" id="5763929">file</span><span class="op" id="5763933">.</span><span class="ident" id="5763934">Comments</span><span class="op" id="5763942">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763947">flist</span>&nbsp;<span class="op" id="5763953">=</span>&nbsp;<span class="builtinfunc" id="5763955">append</span><span class="op" id="5763961">(</span><span class="ident" id="5763962">flist</span><span class="op" id="5763967">,</span>&nbsp;<span class="op" id="5763969">&amp;</span><span class="ident" id="5763970">Example</span><span class="op" id="5763977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5763983">Name</span><span class="op" id="5763987">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5763996">name</span><span class="op" id="5764000">[</span><span class="builtinfunc" id="5764001">len</span><span class="op" id="5764004">(</span><span class="string" id="5764005">&#34;Example&#34;</span><span class="op" id="5764014">)</span><span class="op" id="5764015">:</span><span class="op" id="5764016">]</span><span class="op" id="5764017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764023">Doc</span><span class="op" id="5764026">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5764036">doc</span><span class="op" id="5764039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764045">Code</span><span class="op" id="5764049">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5764058">f</span><span class="op" id="5764059">.</span><span class="ident" id="5764060">Body</span><span class="op" id="5764064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764070">Play</span><span class="op" id="5764074">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5764083">playExample</span><span class="op" id="5764094">(</span><span class="ident" id="5764095">file</span><span class="op" id="5764099">,</span>&nbsp;<span class="ident" id="5764101">f</span><span class="op" id="5764102">.</span><span class="ident" id="5764103">Body</span><span class="op" id="5764107">)</span><span class="op" id="5764108">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764114">Comments</span><span class="op" id="5764122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5764127">file</span><span class="op" id="5764131">.</span><span class="ident" id="5764132">Comments</span><span class="op" id="5764140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764146">Output</span><span class="op" id="5764152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5764159">output</span><span class="op" id="5764165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764171">EmptyOutput</span><span class="op" id="5764182">:</span>&nbsp;<span class="ident" id="5764184">output</span>&nbsp;<span class="op" id="5764191">==</span>&nbsp;<span class="string" id="5764194">&#34;&#34;</span>&nbsp;<span class="op" id="5764197">&amp;&amp;</span>&nbsp;<span class="ident" id="5764200">hasOutput</span><span class="op" id="5764209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764215">Order</span><span class="op" id="5764220">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5764228">len</span><span class="op" id="5764231">(</span><span class="ident" id="5764232">flist</span><span class="op" id="5764237">)</span><span class="op" id="5764238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764243">}</span><span class="op" id="5764244">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764252">if</span>&nbsp;<span class="op" id="5764255">!</span><span class="ident" id="5764256">hasTests</span>&nbsp;<span class="op" id="5764265">&amp;&amp;</span>&nbsp;<span class="ident" id="5764268">numDecl</span>&nbsp;<span class="op" id="5764276">&gt;</span>&nbsp;<span class="num" id="5764278">1</span>&nbsp;<span class="op" id="5764280">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5764283">len</span><span class="op" id="5764286">(</span><span class="ident" id="5764287">flist</span><span class="op" id="5764292">)</span>&nbsp;<span class="op" id="5764294">==</span>&nbsp;<span class="num" id="5764297">1</span>&nbsp;<span class="op" id="5764299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764304">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764359">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764411">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764464">flist</span><span class="op" id="5764469">[</span><span class="num" id="5764470">0</span><span class="op" id="5764471">]</span><span class="op" id="5764472">.</span><span class="ident" id="5764473">Code</span>&nbsp;<span class="op" id="5764478">=</span>&nbsp;<span class="ident" id="5764480">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764488">flist</span><span class="op" id="5764493">[</span><span class="num" id="5764494">0</span><span class="op" id="5764495">]</span><span class="op" id="5764496">.</span><span class="ident" id="5764497">Play</span>&nbsp;<span class="op" id="5764502">=</span>&nbsp;<span class="ident" id="5764504">playExampleFile</span><span class="op" id="5764519">(</span><span class="ident" id="5764520">file</span><span class="op" id="5764524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764532">list</span>&nbsp;<span class="op" id="5764537">=</span>&nbsp;<span class="builtinfunc" id="5764539">append</span><span class="op" id="5764545">(</span><span class="ident" id="5764546">list</span><span class="op" id="5764550">,</span>&nbsp;<span class="ident" id="5764552">flist</span><span class="op" id="5764557">...</span><span class="op" id="5764560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5764563">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764566">sort</span><span class="op" id="5764570">.</span><span class="ident" id="5764571">Sort</span><span class="op" id="5764575">(</span><span class="ident" id="5764576">exampleByName</span><span class="op" id="5764589">(</span><span class="ident" id="5764590">list</span><span class="op" id="5764594">)</span><span class="op" id="5764595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764598">return</span>&nbsp;<span class="ident" id="5764605">list</span><br>
<span class="lineno"></span><span class="op" id="5764610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5764613">var</span>&nbsp;<span class="ident" id="5764617">outputPrefix</span>&nbsp;<span class="op" id="5764630">=</span>&nbsp;<span class="ident" id="5764632">regexp</span><span class="op" id="5764638">.</span><span class="ident" id="5764639">MustCompile</span><span class="op" id="5764650">(</span><span class="string" id="5764651">`(?i)^[[:space:]]*output:`</span><span class="op" id="5764677">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5764680">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="5764757">func</span>&nbsp;<span class="ident" id="5764762">exampleOutput</span><span class="op" id="5764775">(</span><span class="ident" id="5764776">b</span>&nbsp;<span class="op" id="5764778">*</span><span class="ident" id="5764779">ast</span><span class="op" id="5764782">.</span><span class="ident" id="5764783">BlockStmt</span><span class="op" id="5764792">,</span>&nbsp;<span class="ident" id="5764794">comments</span>&nbsp;<span class="op" id="5764803">[</span><span class="op" id="5764804">]</span><span class="op" id="5764805">*</span><span class="ident" id="5764806">ast</span><span class="op" id="5764809">.</span><span class="ident" id="5764810">CommentGroup</span><span class="op" id="5764822">)</span>&nbsp;<span class="op" id="5764824">(</span><span class="ident" id="5764825">output</span>&nbsp;<span class="builtintype" id="5764832">string</span><span class="op" id="5764838">,</span>&nbsp;<span class="ident" id="5764840">ok</span>&nbsp;<span class="builtintype" id="5764843">bool</span><span class="op" id="5764847">)</span>&nbsp;<span class="op" id="5764849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764852">if</span>&nbsp;<span class="ident" id="5764855">_</span><span class="op" id="5764856">,</span>&nbsp;<span class="ident" id="5764858">last</span>&nbsp;<span class="op" id="5764863">:=</span>&nbsp;<span class="ident" id="5764866">lastComment</span><span class="op" id="5764877">(</span><span class="ident" id="5764878">b</span><span class="op" id="5764879">,</span>&nbsp;<span class="ident" id="5764881">comments</span><span class="op" id="5764889">)</span><span class="op" id="5764890">;</span>&nbsp;<span class="ident" id="5764892">last</span>&nbsp;<span class="op" id="5764897">!=</span>&nbsp;<span class="ident" id="5764900">nil</span>&nbsp;<span class="op" id="5764904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5764908">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5764957">text</span>&nbsp;<span class="op" id="5764962">:=</span>&nbsp;<span class="ident" id="5764965">last</span><span class="op" id="5764969">.</span><span class="ident" id="5764970">Text</span><span class="op" id="5764974">(</span><span class="op" id="5764975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5764979">if</span>&nbsp;<span class="ident" id="5764982">loc</span>&nbsp;<span class="op" id="5764986">:=</span>&nbsp;<span class="ident" id="5764989">outputPrefix</span><span class="op" id="5765001">.</span><span class="ident" id="5765002">FindStringIndex</span><span class="op" id="5765017">(</span><span class="ident" id="5765018">text</span><span class="op" id="5765022">)</span><span class="op" id="5765023">;</span>&nbsp;<span class="ident" id="5765025">loc</span>&nbsp;<span class="op" id="5765029">!=</span>&nbsp;<span class="ident" id="5765032">nil</span>&nbsp;<span class="op" id="5765036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765041">text</span>&nbsp;<span class="op" id="5765046">=</span>&nbsp;<span class="ident" id="5765048">text</span><span class="op" id="5765052">[</span><span class="ident" id="5765053">loc</span><span class="op" id="5765056">[</span><span class="num" id="5765057">1</span><span class="op" id="5765058">]</span><span class="op" id="5765059">:</span><span class="op" id="5765060">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5765065">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765131">text</span>&nbsp;<span class="op" id="5765136">=</span>&nbsp;<span class="ident" id="5765138">strings</span><span class="op" id="5765145">.</span><span class="ident" id="5765146">TrimLeft</span><span class="op" id="5765154">(</span><span class="ident" id="5765155">text</span><span class="op" id="5765159">,</span>&nbsp;<span class="string" id="5765161">&#34;&nbsp;&#34;</span><span class="op" id="5765164">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765169">if</span>&nbsp;<span class="builtinfunc" id="5765172">len</span><span class="op" id="5765175">(</span><span class="ident" id="5765176">text</span><span class="op" id="5765180">)</span>&nbsp;<span class="op" id="5765182">&gt;</span>&nbsp;<span class="num" id="5765184">0</span>&nbsp;<span class="op" id="5765186">&amp;&amp;</span>&nbsp;<span class="ident" id="5765189">text</span><span class="op" id="5765193">[</span><span class="num" id="5765194">0</span><span class="op" id="5765195">]</span>&nbsp;<span class="op" id="5765197">==</span>&nbsp;<span class="string" id="5765200">&#39;\n&#39;</span>&nbsp;<span class="op" id="5765205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5765211">text</span>&nbsp;<span class="op" id="5765216">=</span>&nbsp;<span class="ident" id="5765218">text</span><span class="op" id="5765222">[</span><span class="num" id="5765223">1</span><span class="op" id="5765224">:</span><span class="op" id="5765225">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765235">return</span>&nbsp;<span class="ident" id="5765242">text</span><span class="op" id="5765246">,</span>&nbsp;<span class="builtintype" id="5765248">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765255">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765261">return</span>&nbsp;<span class="string" id="5765268">&#34;&#34;</span><span class="op" id="5765270">,</span>&nbsp;<span class="builtintype" id="5765272">false</span>&nbsp;<span class="comment" id="5765278">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="5765307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5765310">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="5765381">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5765452">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="5765501">func</span>&nbsp;<span class="ident" id="5765506">isTest</span><span class="op" id="5765512">(</span><span class="ident" id="5765513">name</span><span class="op" id="5765517">,</span>&nbsp;<span class="ident" id="5765519">prefix</span>&nbsp;<span class="builtintype" id="5765526">string</span><span class="op" id="5765532">)</span>&nbsp;<span class="builtintype" id="5765534">bool</span>&nbsp;<span class="op" id="5765539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765542">if</span>&nbsp;<span class="op" id="5765545">!</span><span class="ident" id="5765546">strings</span><span class="op" id="5765553">.</span><span class="ident" id="5765554">HasPrefix</span><span class="op" id="5765563">(</span><span class="ident" id="5765564">name</span><span class="op" id="5765568">,</span>&nbsp;<span class="ident" id="5765570">prefix</span><span class="op" id="5765576">)</span>&nbsp;<span class="op" id="5765578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765582">return</span>&nbsp;<span class="builtintype" id="5765589">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765599">if</span>&nbsp;<span class="builtinfunc" id="5765602">len</span><span class="op" id="5765605">(</span><span class="ident" id="5765606">name</span><span class="op" id="5765610">)</span>&nbsp;<span class="op" id="5765612">==</span>&nbsp;<span class="builtinfunc" id="5765615">len</span><span class="op" id="5765618">(</span><span class="ident" id="5765619">prefix</span><span class="op" id="5765625">)</span>&nbsp;<span class="op" id="5765627">{</span>&nbsp;<span class="comment" id="5765629">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765647">return</span>&nbsp;<span class="builtintype" id="5765654">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5765660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5765663">rune</span><span class="op" id="5765667">,</span>&nbsp;<span class="ident" id="5765669">_</span>&nbsp;<span class="op" id="5765671">:=</span>&nbsp;<span class="ident" id="5765674">utf8</span><span class="op" id="5765678">.</span><span class="ident" id="5765679">DecodeRuneInString</span><span class="op" id="5765697">(</span><span class="ident" id="5765698">name</span><span class="op" id="5765702">[</span><span class="builtinfunc" id="5765703">len</span><span class="op" id="5765706">(</span><span class="ident" id="5765707">prefix</span><span class="op" id="5765713">)</span><span class="op" id="5765714">:</span><span class="op" id="5765715">]</span><span class="op" id="5765716">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5765719">return</span>&nbsp;<span class="op" id="5765726">!</span><span class="ident" id="5765727">unicode</span><span class="op" id="5765734">.</span><span class="ident" id="5765735">IsLower</span><span class="op" id="5765742">(</span><span class="builtintype" id="5765743">rune</span><span class="op" id="5765747">)</span><br>
<span class="lineno"></span><span class="op" id="5765749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5765752">type</span>&nbsp;<span class="ident" id="5765757">exampleByName</span>&nbsp;<span class="op" id="5765771">[</span><span class="op" id="5765772">]</span><span class="op" id="5765773">*</span><span class="ident" id="5765774">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5765783">func</span>&nbsp;<span class="op" id="5765788">(</span><span class="ident" id="5765789">s</span>&nbsp;<span class="ident" id="5765791">exampleByName</span><span class="op" id="5765804">)</span>&nbsp;<span class="ident" id="5765806">Len</span><span class="op" id="5765809">(</span><span class="op" id="5765810">)</span>&nbsp;<span class="builtintype" id="5765812">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5765826">{</span>&nbsp;<span class="keyword" id="5765828">return</span>&nbsp;<span class="builtinfunc" id="5765835">len</span><span class="op" id="5765838">(</span><span class="ident" id="5765839">s</span><span class="op" id="5765840">)</span>&nbsp;<span class="op" id="5765842">}</span><br>
<span class="lineno"></span><span class="keyword" id="5765844">func</span>&nbsp;<span class="op" id="5765849">(</span><span class="ident" id="5765850">s</span>&nbsp;<span class="ident" id="5765852">exampleByName</span><span class="op" id="5765865">)</span>&nbsp;<span class="ident" id="5765867">Swap</span><span class="op" id="5765871">(</span><span class="ident" id="5765872">i</span><span class="op" id="5765873">,</span>&nbsp;<span class="ident" id="5765875">j</span>&nbsp;<span class="builtintype" id="5765877">int</span><span class="op" id="5765880">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5765887">{</span>&nbsp;<span class="ident" id="5765889">s</span><span class="op" id="5765890">[</span><span class="ident" id="5765891">i</span><span class="op" id="5765892">]</span><span class="op" id="5765893">,</span>&nbsp;<span class="ident" id="5765895">s</span><span class="op" id="5765896">[</span><span class="ident" id="5765897">j</span><span class="op" id="5765898">]</span>&nbsp;<span class="op" id="5765900">=</span>&nbsp;<span class="ident" id="5765902">s</span><span class="op" id="5765903">[</span><span class="ident" id="5765904">j</span><span class="op" id="5765905">]</span><span class="op" id="5765906">,</span>&nbsp;<span class="ident" id="5765908">s</span><span class="op" id="5765909">[</span><span class="ident" id="5765910">i</span><span class="op" id="5765911">]</span>&nbsp;<span class="op" id="5765913">}</span><br>
<span class="lineno"></span><span class="keyword" id="5765915">func</span>&nbsp;<span class="op" id="5765920">(</span><span class="ident" id="5765921">s</span>&nbsp;<span class="ident" id="5765923">exampleByName</span><span class="op" id="5765936">)</span>&nbsp;<span class="ident" id="5765938">Less</span><span class="op" id="5765942">(</span><span class="ident" id="5765943">i</span><span class="op" id="5765944">,</span>&nbsp;<span class="ident" id="5765946">j</span>&nbsp;<span class="builtintype" id="5765948">int</span><span class="op" id="5765951">)</span>&nbsp;<span class="builtintype" id="5765953">bool</span>&nbsp;<span class="op" id="5765958">{</span>&nbsp;<span class="keyword" id="5765960">return</span>&nbsp;<span class="ident" id="5765967">s</span><span class="op" id="5765968">[</span><span class="ident" id="5765969">i</span><span class="op" id="5765970">]</span><span class="op" id="5765971">.</span><span class="ident" id="5765972">Name</span>&nbsp;<span class="op" id="5765977">&lt;</span>&nbsp;<span class="ident" id="5765979">s</span><span class="op" id="5765980">[</span><span class="ident" id="5765981">j</span><span class="op" id="5765982">]</span><span class="op" id="5765983">.</span><span class="ident" id="5765984">Name</span>&nbsp;<span class="op" id="5765989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5765992">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="5766057">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5766118">func</span>&nbsp;<span class="ident" id="5766123">playExample</span><span class="op" id="5766134">(</span><span class="ident" id="5766135">file</span>&nbsp;<span class="op" id="5766140">*</span><span class="ident" id="5766141">ast</span><span class="op" id="5766144">.</span><span class="ident" id="5766145">File</span><span class="op" id="5766149">,</span>&nbsp;<span class="ident" id="5766151">body</span>&nbsp;<span class="op" id="5766156">*</span><span class="ident" id="5766157">ast</span><span class="op" id="5766160">.</span><span class="ident" id="5766161">BlockStmt</span><span class="op" id="5766170">)</span>&nbsp;<span class="op" id="5766172">*</span><span class="ident" id="5766173">ast</span><span class="op" id="5766176">.</span><span class="ident" id="5766177">File</span>&nbsp;<span class="op" id="5766182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766185">if</span>&nbsp;<span class="op" id="5766188">!</span><span class="ident" id="5766189">strings</span><span class="op" id="5766196">.</span><span class="ident" id="5766197">HasSuffix</span><span class="op" id="5766206">(</span><span class="ident" id="5766207">file</span><span class="op" id="5766211">.</span><span class="ident" id="5766212">Name</span><span class="op" id="5766216">.</span><span class="ident" id="5766217">Name</span><span class="op" id="5766221">,</span>&nbsp;<span class="string" id="5766223">&#34;_test&#34;</span><span class="op" id="5766230">)</span>&nbsp;<span class="op" id="5766232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766236">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766288">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766316">return</span>&nbsp;<span class="ident" id="5766323">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766332">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766377">topDecls</span>&nbsp;<span class="op" id="5766386">:=</span>&nbsp;<span class="builtinfunc" id="5766389">make</span><span class="op" id="5766393">(</span><span class="keyword" id="5766394">map</span><span class="op" id="5766397">[</span><span class="op" id="5766398">*</span><span class="ident" id="5766399">ast</span><span class="op" id="5766402">.</span><span class="ident" id="5766403">Object</span><span class="op" id="5766409">]</span><span class="builtintype" id="5766410">bool</span><span class="op" id="5766414">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766417">for</span>&nbsp;<span class="ident" id="5766421">_</span><span class="op" id="5766422">,</span>&nbsp;<span class="ident" id="5766424">decl</span>&nbsp;<span class="op" id="5766429">:=</span>&nbsp;<span class="keyword" id="5766432">range</span>&nbsp;<span class="ident" id="5766438">file</span><span class="op" id="5766442">.</span><span class="ident" id="5766443">Decls</span>&nbsp;<span class="op" id="5766449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766453">switch</span>&nbsp;<span class="ident" id="5766460">d</span>&nbsp;<span class="op" id="5766462">:=</span>&nbsp;<span class="ident" id="5766465">decl</span><span class="op" id="5766469">.</span><span class="op" id="5766470">(</span><span class="keyword" id="5766471">type</span><span class="op" id="5766475">)</span>&nbsp;<span class="op" id="5766477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766481">case</span>&nbsp;<span class="op" id="5766486">*</span><span class="ident" id="5766487">ast</span><span class="op" id="5766490">.</span><span class="ident" id="5766491">FuncDecl</span><span class="op" id="5766499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766504">topDecls</span><span class="op" id="5766512">[</span><span class="ident" id="5766513">d</span><span class="op" id="5766514">.</span><span class="ident" id="5766515">Name</span><span class="op" id="5766519">.</span><span class="ident" id="5766520">Obj</span><span class="op" id="5766523">]</span>&nbsp;<span class="op" id="5766525">=</span>&nbsp;<span class="builtintype" id="5766527">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766534">case</span>&nbsp;<span class="op" id="5766539">*</span><span class="ident" id="5766540">ast</span><span class="op" id="5766543">.</span><span class="ident" id="5766544">GenDecl</span><span class="op" id="5766551">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766556">for</span>&nbsp;<span class="ident" id="5766560">_</span><span class="op" id="5766561">,</span>&nbsp;<span class="ident" id="5766563">spec</span>&nbsp;<span class="op" id="5766568">:=</span>&nbsp;<span class="keyword" id="5766571">range</span>&nbsp;<span class="ident" id="5766577">d</span><span class="op" id="5766578">.</span><span class="ident" id="5766579">Specs</span>&nbsp;<span class="op" id="5766585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766591">switch</span>&nbsp;<span class="ident" id="5766598">s</span>&nbsp;<span class="op" id="5766600">:=</span>&nbsp;<span class="ident" id="5766603">spec</span><span class="op" id="5766607">.</span><span class="op" id="5766608">(</span><span class="keyword" id="5766609">type</span><span class="op" id="5766613">)</span>&nbsp;<span class="op" id="5766615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766621">case</span>&nbsp;<span class="op" id="5766626">*</span><span class="ident" id="5766627">ast</span><span class="op" id="5766630">.</span><span class="ident" id="5766631">TypeSpec</span><span class="op" id="5766639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766646">topDecls</span><span class="op" id="5766654">[</span><span class="ident" id="5766655">s</span><span class="op" id="5766656">.</span><span class="ident" id="5766657">Name</span><span class="op" id="5766661">.</span><span class="ident" id="5766662">Obj</span><span class="op" id="5766665">]</span>&nbsp;<span class="op" id="5766667">=</span>&nbsp;<span class="builtintype" id="5766669">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766678">case</span>&nbsp;<span class="op" id="5766683">*</span><span class="ident" id="5766684">ast</span><span class="op" id="5766687">.</span><span class="ident" id="5766688">ValueSpec</span><span class="op" id="5766697">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766704">for</span>&nbsp;<span class="ident" id="5766708">_</span><span class="op" id="5766709">,</span>&nbsp;<span class="ident" id="5766711">id</span>&nbsp;<span class="op" id="5766714">:=</span>&nbsp;<span class="keyword" id="5766717">range</span>&nbsp;<span class="ident" id="5766723">s</span><span class="op" id="5766724">.</span><span class="ident" id="5766725">Names</span>&nbsp;<span class="op" id="5766731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766739">topDecls</span><span class="op" id="5766747">[</span><span class="ident" id="5766748">id</span><span class="op" id="5766750">.</span><span class="ident" id="5766751">Obj</span><span class="op" id="5766754">]</span>&nbsp;<span class="op" id="5766756">=</span>&nbsp;<span class="builtintype" id="5766758">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766779">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5766786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766790">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766858">unresolved</span>&nbsp;<span class="op" id="5766869">:=</span>&nbsp;<span class="builtinfunc" id="5766872">make</span><span class="op" id="5766876">(</span><span class="keyword" id="5766877">map</span><span class="op" id="5766880">[</span><span class="builtintype" id="5766881">string</span><span class="op" id="5766887">]</span><span class="builtintype" id="5766888">bool</span><span class="op" id="5766892">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766895">usesTopDecl</span>&nbsp;<span class="op" id="5766907">:=</span>&nbsp;<span class="builtintype" id="5766910">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5766917">var</span>&nbsp;<span class="ident" id="5766921">inspectFunc</span>&nbsp;<span class="keyword" id="5766933">func</span><span class="op" id="5766937">(</span><span class="ident" id="5766938">ast</span><span class="op" id="5766941">.</span><span class="ident" id="5766942">Node</span><span class="op" id="5766946">)</span>&nbsp;<span class="builtintype" id="5766948">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5766954">inspectFunc</span>&nbsp;<span class="op" id="5766966">=</span>&nbsp;<span class="keyword" id="5766968">func</span><span class="op" id="5766972">(</span><span class="ident" id="5766973">n</span>&nbsp;<span class="ident" id="5766975">ast</span><span class="op" id="5766978">.</span><span class="ident" id="5766979">Node</span><span class="op" id="5766983">)</span>&nbsp;<span class="builtintype" id="5766985">bool</span>&nbsp;<span class="op" id="5766990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5766994">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767058">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767122">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767168">if</span>&nbsp;<span class="ident" id="5767171">e</span><span class="op" id="5767172">,</span>&nbsp;<span class="ident" id="5767174">ok</span>&nbsp;<span class="op" id="5767177">:=</span>&nbsp;<span class="ident" id="5767180">n</span><span class="op" id="5767181">.</span><span class="op" id="5767182">(</span><span class="op" id="5767183">*</span><span class="ident" id="5767184">ast</span><span class="op" id="5767187">.</span><span class="ident" id="5767188">SelectorExpr</span><span class="op" id="5767200">)</span><span class="op" id="5767201">;</span>&nbsp;<span class="ident" id="5767203">ok</span>&nbsp;<span class="op" id="5767206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767211">ast</span><span class="op" id="5767214">.</span><span class="ident" id="5767215">Inspect</span><span class="op" id="5767222">(</span><span class="ident" id="5767223">e</span><span class="op" id="5767224">.</span><span class="ident" id="5767225">X</span><span class="op" id="5767226">,</span>&nbsp;<span class="ident" id="5767228">inspectFunc</span><span class="op" id="5767239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767244">return</span>&nbsp;<span class="builtintype" id="5767251">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767259">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767263">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767318">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767372">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767396">if</span>&nbsp;<span class="ident" id="5767399">e</span><span class="op" id="5767400">,</span>&nbsp;<span class="ident" id="5767402">ok</span>&nbsp;<span class="op" id="5767405">:=</span>&nbsp;<span class="ident" id="5767408">n</span><span class="op" id="5767409">.</span><span class="op" id="5767410">(</span><span class="op" id="5767411">*</span><span class="ident" id="5767412">ast</span><span class="op" id="5767415">.</span><span class="ident" id="5767416">KeyValueExpr</span><span class="op" id="5767428">)</span><span class="op" id="5767429">;</span>&nbsp;<span class="ident" id="5767431">ok</span>&nbsp;<span class="op" id="5767434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767439">ast</span><span class="op" id="5767442">.</span><span class="ident" id="5767443">Inspect</span><span class="op" id="5767450">(</span><span class="ident" id="5767451">e</span><span class="op" id="5767452">.</span><span class="ident" id="5767453">Value</span><span class="op" id="5767458">,</span>&nbsp;<span class="ident" id="5767460">inspectFunc</span><span class="op" id="5767471">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767476">return</span>&nbsp;<span class="builtintype" id="5767483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767495">if</span>&nbsp;<span class="ident" id="5767498">id</span><span class="op" id="5767500">,</span>&nbsp;<span class="ident" id="5767502">ok</span>&nbsp;<span class="op" id="5767505">:=</span>&nbsp;<span class="ident" id="5767508">n</span><span class="op" id="5767509">.</span><span class="op" id="5767510">(</span><span class="op" id="5767511">*</span><span class="ident" id="5767512">ast</span><span class="op" id="5767515">.</span><span class="ident" id="5767516">Ident</span><span class="op" id="5767521">)</span><span class="op" id="5767522">;</span>&nbsp;<span class="ident" id="5767524">ok</span>&nbsp;<span class="op" id="5767527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767532">if</span>&nbsp;<span class="ident" id="5767535">id</span><span class="op" id="5767537">.</span><span class="ident" id="5767538">Obj</span>&nbsp;<span class="op" id="5767542">==</span>&nbsp;<span class="ident" id="5767545">nil</span>&nbsp;<span class="op" id="5767549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767555">unresolved</span><span class="op" id="5767565">[</span><span class="ident" id="5767566">id</span><span class="op" id="5767568">.</span><span class="ident" id="5767569">Name</span><span class="op" id="5767573">]</span>&nbsp;<span class="op" id="5767575">=</span>&nbsp;<span class="builtintype" id="5767577">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767585">}</span>&nbsp;<span class="keyword" id="5767587">else</span>&nbsp;<span class="keyword" id="5767592">if</span>&nbsp;<span class="ident" id="5767595">topDecls</span><span class="op" id="5767603">[</span><span class="ident" id="5767604">id</span><span class="op" id="5767606">.</span><span class="ident" id="5767607">Obj</span><span class="op" id="5767610">]</span>&nbsp;<span class="op" id="5767612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767618">usesTopDecl</span>&nbsp;<span class="op" id="5767630">=</span>&nbsp;<span class="builtintype" id="5767632">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767648">return</span>&nbsp;<span class="builtintype" id="5767655">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5767664">ast</span><span class="op" id="5767667">.</span><span class="ident" id="5767668">Inspect</span><span class="op" id="5767675">(</span><span class="ident" id="5767676">body</span><span class="op" id="5767680">,</span>&nbsp;<span class="ident" id="5767682">inspectFunc</span><span class="op" id="5767693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767696">if</span>&nbsp;<span class="ident" id="5767699">usesTopDecl</span>&nbsp;<span class="op" id="5767711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767715">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767781">return</span>&nbsp;<span class="ident" id="5767788">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767797">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767854">for</span>&nbsp;<span class="ident" id="5767858">n</span>&nbsp;<span class="op" id="5767860">:=</span>&nbsp;<span class="keyword" id="5767863">range</span>&nbsp;<span class="ident" id="5767869">unresolved</span>&nbsp;<span class="op" id="5767880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5767884">if</span>&nbsp;<span class="ident" id="5767887">predeclaredTypes</span><span class="op" id="5767903">[</span><span class="ident" id="5767904">n</span><span class="op" id="5767905">]</span>&nbsp;<span class="op" id="5767907">||</span>&nbsp;<span class="ident" id="5767910">predeclaredConstants</span><span class="op" id="5767930">[</span><span class="ident" id="5767931">n</span><span class="op" id="5767932">]</span>&nbsp;<span class="op" id="5767934">||</span>&nbsp;<span class="ident" id="5767937">predeclaredFuncs</span><span class="op" id="5767953">[</span><span class="ident" id="5767954">n</span><span class="op" id="5767955">]</span>&nbsp;<span class="op" id="5767957">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5767962">delete</span><span class="op" id="5767968">(</span><span class="ident" id="5767969">unresolved</span><span class="op" id="5767979">,</span>&nbsp;<span class="ident" id="5767981">n</span><span class="op" id="5767982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5767989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5767993">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768062">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768129">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768205">namedImports</span>&nbsp;<span class="op" id="5768218">:=</span>&nbsp;<span class="builtinfunc" id="5768221">make</span><span class="op" id="5768225">(</span><span class="keyword" id="5768226">map</span><span class="op" id="5768229">[</span><span class="builtintype" id="5768230">string</span><span class="op" id="5768236">]</span><span class="builtintype" id="5768237">string</span><span class="op" id="5768243">)</span>&nbsp;<span class="comment" id="5768245">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768260">var</span>&nbsp;<span class="ident" id="5768264">blankImports</span>&nbsp;<span class="op" id="5768277">[</span><span class="op" id="5768278">]</span><span class="ident" id="5768279">ast</span><span class="op" id="5768282">.</span><span class="ident" id="5768283">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5768300">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768314">for</span>&nbsp;<span class="ident" id="5768318">_</span><span class="op" id="5768319">,</span>&nbsp;<span class="ident" id="5768321">s</span>&nbsp;<span class="op" id="5768323">:=</span>&nbsp;<span class="keyword" id="5768326">range</span>&nbsp;<span class="ident" id="5768332">file</span><span class="op" id="5768336">.</span><span class="ident" id="5768337">Imports</span>&nbsp;<span class="op" id="5768345">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768349">p</span><span class="op" id="5768350">,</span>&nbsp;<span class="ident" id="5768352">err</span>&nbsp;<span class="op" id="5768356">:=</span>&nbsp;<span class="ident" id="5768359">strconv</span><span class="op" id="5768366">.</span><span class="ident" id="5768367">Unquote</span><span class="op" id="5768374">(</span><span class="ident" id="5768375">s</span><span class="op" id="5768376">.</span><span class="ident" id="5768377">Path</span><span class="op" id="5768381">.</span><span class="ident" id="5768382">Value</span><span class="op" id="5768387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768391">if</span>&nbsp;<span class="ident" id="5768394">err</span>&nbsp;<span class="op" id="5768398">!=</span>&nbsp;<span class="ident" id="5768401">nil</span>&nbsp;<span class="op" id="5768405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768410">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768425">n</span>&nbsp;<span class="op" id="5768427">:=</span>&nbsp;<span class="ident" id="5768430">path</span><span class="op" id="5768434">.</span><span class="ident" id="5768435">Base</span><span class="op" id="5768439">(</span><span class="ident" id="5768440">p</span><span class="op" id="5768441">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768445">if</span>&nbsp;<span class="ident" id="5768448">s</span><span class="op" id="5768449">.</span><span class="ident" id="5768450">Name</span>&nbsp;<span class="op" id="5768455">!=</span>&nbsp;<span class="ident" id="5768458">nil</span>&nbsp;<span class="op" id="5768462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768467">n</span>&nbsp;<span class="op" id="5768469">=</span>&nbsp;<span class="ident" id="5768471">s</span><span class="op" id="5768472">.</span><span class="ident" id="5768473">Name</span><span class="op" id="5768477">.</span><span class="ident" id="5768478">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768486">switch</span>&nbsp;<span class="ident" id="5768493">n</span>&nbsp;<span class="op" id="5768495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768500">case</span>&nbsp;<span class="string" id="5768505">&#34;_&#34;</span><span class="op" id="5768508">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768514">blankImports</span>&nbsp;<span class="op" id="5768527">=</span>&nbsp;<span class="builtinfunc" id="5768529">append</span><span class="op" id="5768535">(</span><span class="ident" id="5768536">blankImports</span><span class="op" id="5768548">,</span>&nbsp;<span class="ident" id="5768550">s</span><span class="op" id="5768551">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768557">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768569">case</span>&nbsp;<span class="string" id="5768574">&#34;.&#34;</span><span class="op" id="5768577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768583">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768626">return</span>&nbsp;<span class="ident" id="5768633">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768640">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768648">if</span>&nbsp;<span class="ident" id="5768651">unresolved</span><span class="op" id="5768661">[</span><span class="ident" id="5768662">n</span><span class="op" id="5768663">]</span>&nbsp;<span class="op" id="5768665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5768670">namedImports</span><span class="op" id="5768682">[</span><span class="ident" id="5768683">n</span><span class="op" id="5768684">]</span>&nbsp;<span class="op" id="5768686">=</span>&nbsp;<span class="ident" id="5768688">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5768693">delete</span><span class="op" id="5768699">(</span><span class="ident" id="5768700">unresolved</span><span class="op" id="5768710">,</span>&nbsp;<span class="ident" id="5768712">n</span><span class="op" id="5768713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768717">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768724">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768792">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768836">if</span>&nbsp;<span class="builtinfunc" id="5768839">len</span><span class="op" id="5768842">(</span><span class="ident" id="5768843">unresolved</span><span class="op" id="5768853">)</span>&nbsp;<span class="op" id="5768855">&gt;</span>&nbsp;<span class="num" id="5768857">0</span>&nbsp;<span class="op" id="5768859">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768863">return</span>&nbsp;<span class="ident" id="5768870">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5768875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5768879">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768933">var</span>&nbsp;<span class="ident" id="5768937">comments</span>&nbsp;<span class="op" id="5768946">[</span><span class="op" id="5768947">]</span><span class="op" id="5768948">*</span><span class="ident" id="5768949">ast</span><span class="op" id="5768952">.</span><span class="ident" id="5768953">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5768967">for</span>&nbsp;<span class="ident" id="5768971">_</span><span class="op" id="5768972">,</span>&nbsp;<span class="ident" id="5768974">s</span>&nbsp;<span class="op" id="5768976">:=</span>&nbsp;<span class="keyword" id="5768979">range</span>&nbsp;<span class="ident" id="5768985">blankImports</span>&nbsp;<span class="op" id="5768998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5769002">if</span>&nbsp;<span class="ident" id="5769005">c</span>&nbsp;<span class="op" id="5769007">:=</span>&nbsp;<span class="ident" id="5769010">s</span><span class="op" id="5769011">.</span><span class="op" id="5769012">(</span><span class="op" id="5769013">*</span><span class="ident" id="5769014">ast</span><span class="op" id="5769017">.</span><span class="ident" id="5769018">ImportSpec</span><span class="op" id="5769028">)</span><span class="op" id="5769029">.</span><span class="ident" id="5769030">Doc</span><span class="op" id="5769033">;</span>&nbsp;<span class="ident" id="5769035">c</span>&nbsp;<span class="op" id="5769037">!=</span>&nbsp;<span class="ident" id="5769040">nil</span>&nbsp;<span class="op" id="5769044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769049">comments</span>&nbsp;<span class="op" id="5769058">=</span>&nbsp;<span class="builtinfunc" id="5769060">append</span><span class="op" id="5769066">(</span><span class="ident" id="5769067">comments</span><span class="op" id="5769075">,</span>&nbsp;<span class="ident" id="5769077">c</span><span class="op" id="5769078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769085">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769089">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5769145">for</span>&nbsp;<span class="ident" id="5769149">_</span><span class="op" id="5769150">,</span>&nbsp;<span class="ident" id="5769152">c</span>&nbsp;<span class="op" id="5769154">:=</span>&nbsp;<span class="keyword" id="5769157">range</span>&nbsp;<span class="ident" id="5769163">file</span><span class="op" id="5769167">.</span><span class="ident" id="5769168">Comments</span>&nbsp;<span class="op" id="5769177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5769181">if</span>&nbsp;<span class="ident" id="5769184">body</span><span class="op" id="5769188">.</span><span class="ident" id="5769189">Pos</span><span class="op" id="5769192">(</span><span class="op" id="5769193">)</span>&nbsp;<span class="op" id="5769195">&lt;=</span>&nbsp;<span class="ident" id="5769198">c</span><span class="op" id="5769199">.</span><span class="ident" id="5769200">Pos</span><span class="op" id="5769203">(</span><span class="op" id="5769204">)</span>&nbsp;<span class="op" id="5769206">&amp;&amp;</span>&nbsp;<span class="ident" id="5769209">c</span><span class="op" id="5769210">.</span><span class="ident" id="5769211">End</span><span class="op" id="5769214">(</span><span class="op" id="5769215">)</span>&nbsp;<span class="op" id="5769217">&lt;=</span>&nbsp;<span class="ident" id="5769220">body</span><span class="op" id="5769224">.</span><span class="ident" id="5769225">End</span><span class="op" id="5769228">(</span><span class="op" id="5769229">)</span>&nbsp;<span class="op" id="5769231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769236">comments</span>&nbsp;<span class="op" id="5769245">=</span>&nbsp;<span class="builtinfunc" id="5769247">append</span><span class="op" id="5769253">(</span><span class="ident" id="5769254">comments</span><span class="op" id="5769262">,</span>&nbsp;<span class="ident" id="5769264">c</span><span class="op" id="5769265">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769276">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769334">body</span><span class="op" id="5769338">,</span>&nbsp;<span class="ident" id="5769340">comments</span>&nbsp;<span class="op" id="5769349">=</span>&nbsp;<span class="ident" id="5769351">stripOutputComment</span><span class="op" id="5769369">(</span><span class="ident" id="5769370">body</span><span class="op" id="5769374">,</span>&nbsp;<span class="ident" id="5769376">comments</span><span class="op" id="5769384">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769388">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769423">importDecl</span>&nbsp;<span class="op" id="5769434">:=</span>&nbsp;<span class="op" id="5769437">&amp;</span><span class="ident" id="5769438">ast</span><span class="op" id="5769441">.</span><span class="ident" id="5769442">GenDecl</span><span class="op" id="5769449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769453">Tok</span><span class="op" id="5769456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5769461">token</span><span class="op" id="5769466">.</span><span class="ident" id="5769467">IMPORT</span><span class="op" id="5769473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769477">Lparen</span><span class="op" id="5769483">:</span>&nbsp;<span class="num" id="5769485">1</span><span class="op" id="5769486">,</span>&nbsp;<span class="comment" id="5769488">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769541">Rparen</span><span class="op" id="5769547">:</span>&nbsp;<span class="num" id="5769549">1</span><span class="op" id="5769550">,</span>&nbsp;<span class="comment" id="5769552">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5769593">for</span>&nbsp;<span class="ident" id="5769597">n</span><span class="op" id="5769598">,</span>&nbsp;<span class="ident" id="5769600">p</span>&nbsp;<span class="op" id="5769602">:=</span>&nbsp;<span class="keyword" id="5769605">range</span>&nbsp;<span class="ident" id="5769611">namedImports</span>&nbsp;<span class="op" id="5769624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769628">s</span>&nbsp;<span class="op" id="5769630">:=</span>&nbsp;<span class="op" id="5769633">&amp;</span><span class="ident" id="5769634">ast</span><span class="op" id="5769637">.</span><span class="ident" id="5769638">ImportSpec</span><span class="op" id="5769648">{</span><span class="ident" id="5769649">Path</span><span class="op" id="5769653">:</span>&nbsp;<span class="op" id="5769655">&amp;</span><span class="ident" id="5769656">ast</span><span class="op" id="5769659">.</span><span class="ident" id="5769660">BasicLit</span><span class="op" id="5769668">{</span><span class="ident" id="5769669">Value</span><span class="op" id="5769674">:</span>&nbsp;<span class="ident" id="5769676">strconv</span><span class="op" id="5769683">.</span><span class="ident" id="5769684">Quote</span><span class="op" id="5769689">(</span><span class="ident" id="5769690">p</span><span class="op" id="5769691">)</span><span class="op" id="5769692">}</span><span class="op" id="5769693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5769697">if</span>&nbsp;<span class="ident" id="5769700">path</span><span class="op" id="5769704">.</span><span class="ident" id="5769705">Base</span><span class="op" id="5769709">(</span><span class="ident" id="5769710">p</span><span class="op" id="5769711">)</span>&nbsp;<span class="op" id="5769713">!=</span>&nbsp;<span class="ident" id="5769716">n</span>&nbsp;<span class="op" id="5769718">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769723">s</span><span class="op" id="5769724">.</span><span class="ident" id="5769725">Name</span>&nbsp;<span class="op" id="5769730">=</span>&nbsp;<span class="ident" id="5769732">ast</span><span class="op" id="5769735">.</span><span class="ident" id="5769736">NewIdent</span><span class="op" id="5769744">(</span><span class="ident" id="5769745">n</span><span class="op" id="5769746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769750">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769754">importDecl</span><span class="op" id="5769764">.</span><span class="ident" id="5769765">Specs</span>&nbsp;<span class="op" id="5769771">=</span>&nbsp;<span class="builtinfunc" id="5769773">append</span><span class="op" id="5769779">(</span><span class="ident" id="5769780">importDecl</span><span class="op" id="5769790">.</span><span class="ident" id="5769791">Specs</span><span class="op" id="5769796">,</span>&nbsp;<span class="ident" id="5769798">s</span><span class="op" id="5769799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5769802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769805">importDecl</span><span class="op" id="5769815">.</span><span class="ident" id="5769816">Specs</span>&nbsp;<span class="op" id="5769822">=</span>&nbsp;<span class="builtinfunc" id="5769824">append</span><span class="op" id="5769830">(</span><span class="ident" id="5769831">importDecl</span><span class="op" id="5769841">.</span><span class="ident" id="5769842">Specs</span><span class="op" id="5769847">,</span>&nbsp;<span class="ident" id="5769849">blankImports</span><span class="op" id="5769861">...</span><span class="op" id="5769864">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5769868">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769898">funcDecl</span>&nbsp;<span class="op" id="5769907">:=</span>&nbsp;<span class="op" id="5769910">&amp;</span><span class="ident" id="5769911">ast</span><span class="op" id="5769914">.</span><span class="ident" id="5769915">FuncDecl</span><span class="op" id="5769923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769927">Name</span><span class="op" id="5769931">:</span>&nbsp;<span class="ident" id="5769933">ast</span><span class="op" id="5769936">.</span><span class="ident" id="5769937">NewIdent</span><span class="op" id="5769945">(</span><span class="string" id="5769946">&#34;main&#34;</span><span class="op" id="5769952">)</span><span class="op" id="5769953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5769957">Type</span><span class="op" id="5769961">:</span>&nbsp;<span class="op" id="5769963">&amp;</span><span class="ident" id="5769964">ast</span><span class="op" id="5769967">.</span><span class="ident" id="5769968">FuncType</span><span class="op" id="5769976">{</span><span class="ident" id="5769977">Params</span><span class="op" id="5769983">:</span>&nbsp;<span class="op" id="5769985">&amp;</span><span class="ident" id="5769986">ast</span><span class="op" id="5769989">.</span><span class="ident" id="5769990">FieldList</span><span class="op" id="5769999">{</span><span class="op" id="5770000">}</span><span class="op" id="5770001">}</span><span class="op" id="5770002">,</span>&nbsp;<span class="comment" id="5770004">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770041">Body</span><span class="op" id="5770045">:</span>&nbsp;<span class="ident" id="5770047">body</span><span class="op" id="5770051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5770054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5770058">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770079">return</span>&nbsp;<span class="op" id="5770086">&amp;</span><span class="ident" id="5770087">ast</span><span class="op" id="5770090">.</span><span class="ident" id="5770091">File</span><span class="op" id="5770095">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770099">Name</span><span class="op" id="5770103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5770109">ast</span><span class="op" id="5770112">.</span><span class="ident" id="5770113">NewIdent</span><span class="op" id="5770121">(</span><span class="string" id="5770122">&#34;main&#34;</span><span class="op" id="5770128">)</span><span class="op" id="5770129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770133">Decls</span><span class="op" id="5770138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5770143">[</span><span class="op" id="5770144">]</span><span class="ident" id="5770145">ast</span><span class="op" id="5770148">.</span><span class="ident" id="5770149">Decl</span><span class="op" id="5770153">{</span><span class="ident" id="5770154">importDecl</span><span class="op" id="5770164">,</span>&nbsp;<span class="ident" id="5770166">funcDecl</span><span class="op" id="5770174">}</span><span class="op" id="5770175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770179">Comments</span><span class="op" id="5770187">:</span>&nbsp;<span class="ident" id="5770189">comments</span><span class="op" id="5770197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5770200">}</span><br>
<span class="lineno"></span><span class="op" id="5770202">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="5770205">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="5770283">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5770342">func</span>&nbsp;<span class="ident" id="5770347">playExampleFile</span><span class="op" id="5770362">(</span><span class="ident" id="5770363">file</span>&nbsp;<span class="op" id="5770368">*</span><span class="ident" id="5770369">ast</span><span class="op" id="5770372">.</span><span class="ident" id="5770373">File</span><span class="op" id="5770377">)</span>&nbsp;<span class="op" id="5770379">*</span><span class="ident" id="5770380">ast</span><span class="op" id="5770383">.</span><span class="ident" id="5770384">File</span>&nbsp;<span class="op" id="5770389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5770392">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770432">comments</span>&nbsp;<span class="op" id="5770441">:=</span>&nbsp;<span class="ident" id="5770444">file</span><span class="op" id="5770448">.</span><span class="ident" id="5770449">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770459">if</span>&nbsp;<span class="builtinfunc" id="5770462">len</span><span class="op" id="5770465">(</span><span class="ident" id="5770466">comments</span><span class="op" id="5770474">)</span>&nbsp;<span class="op" id="5770476">&gt;</span>&nbsp;<span class="num" id="5770478">0</span>&nbsp;<span class="op" id="5770480">&amp;&amp;</span>&nbsp;<span class="ident" id="5770483">strings</span><span class="op" id="5770490">.</span><span class="ident" id="5770491">HasPrefix</span><span class="op" id="5770500">(</span><span class="ident" id="5770501">comments</span><span class="op" id="5770509">[</span><span class="num" id="5770510">0</span><span class="op" id="5770511">]</span><span class="op" id="5770512">.</span><span class="ident" id="5770513">Text</span><span class="op" id="5770517">(</span><span class="op" id="5770518">)</span><span class="op" id="5770519">,</span>&nbsp;<span class="string" id="5770521">&#34;Copyright&#34;</span><span class="op" id="5770532">)</span>&nbsp;<span class="op" id="5770534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770538">comments</span>&nbsp;<span class="op" id="5770547">=</span>&nbsp;<span class="ident" id="5770549">comments</span><span class="op" id="5770557">[</span><span class="num" id="5770558">1</span><span class="op" id="5770559">:</span><span class="op" id="5770560">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5770563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5770567">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770636">var</span>&nbsp;<span class="ident" id="5770640">decls</span>&nbsp;<span class="op" id="5770646">[</span><span class="op" id="5770647">]</span><span class="ident" id="5770648">ast</span><span class="op" id="5770651">.</span><span class="ident" id="5770652">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770658">for</span>&nbsp;<span class="ident" id="5770662">_</span><span class="op" id="5770663">,</span>&nbsp;<span class="ident" id="5770665">d</span>&nbsp;<span class="op" id="5770667">:=</span>&nbsp;<span class="keyword" id="5770670">range</span>&nbsp;<span class="ident" id="5770676">file</span><span class="op" id="5770680">.</span><span class="ident" id="5770681">Decls</span>&nbsp;<span class="op" id="5770687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5770691">if</span>&nbsp;<span class="ident" id="5770694">f</span><span class="op" id="5770695">,</span>&nbsp;<span class="ident" id="5770697">ok</span>&nbsp;<span class="op" id="5770700">:=</span>&nbsp;<span class="ident" id="5770703">d</span><span class="op" id="5770704">.</span><span class="op" id="5770705">(</span><span class="op" id="5770706">*</span><span class="ident" id="5770707">ast</span><span class="op" id="5770710">.</span><span class="ident" id="5770711">FuncDecl</span><span class="op" id="5770719">)</span><span class="op" id="5770720">;</span>&nbsp;<span class="ident" id="5770722">ok</span>&nbsp;<span class="op" id="5770725">&amp;&amp;</span>&nbsp;<span class="ident" id="5770728">isTest</span><span class="op" id="5770734">(</span><span class="ident" id="5770735">f</span><span class="op" id="5770736">.</span><span class="ident" id="5770737">Name</span><span class="op" id="5770741">.</span><span class="ident" id="5770742">Name</span><span class="op" id="5770746">,</span>&nbsp;<span class="string" id="5770748">&#34;Example&#34;</span><span class="op" id="5770757">)</span>&nbsp;<span class="op" id="5770759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5770764">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770818">newF</span>&nbsp;<span class="op" id="5770823">:=</span>&nbsp;<span class="op" id="5770826">*</span><span class="ident" id="5770827">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770832">newF</span><span class="op" id="5770836">.</span><span class="ident" id="5770837">Name</span>&nbsp;<span class="op" id="5770842">=</span>&nbsp;<span class="ident" id="5770844">ast</span><span class="op" id="5770847">.</span><span class="ident" id="5770848">NewIdent</span><span class="op" id="5770856">(</span><span class="string" id="5770857">&#34;main&#34;</span><span class="op" id="5770863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770868">newF</span><span class="op" id="5770872">.</span><span class="ident" id="5770873">Body</span><span class="op" id="5770877">,</span>&nbsp;<span class="ident" id="5770879">comments</span>&nbsp;<span class="op" id="5770888">=</span>&nbsp;<span class="ident" id="5770890">stripOutputComment</span><span class="op" id="5770908">(</span><span class="ident" id="5770909">f</span><span class="op" id="5770910">.</span><span class="ident" id="5770911">Body</span><span class="op" id="5770915">,</span>&nbsp;<span class="ident" id="5770917">comments</span><span class="op" id="5770925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770930">d</span>&nbsp;<span class="op" id="5770932">=</span>&nbsp;<span class="op" id="5770934">&amp;</span><span class="ident" id="5770935">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5770942">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5770946">decls</span>&nbsp;<span class="op" id="5770952">=</span>&nbsp;<span class="builtinfunc" id="5770954">append</span><span class="op" id="5770960">(</span><span class="ident" id="5770961">decls</span><span class="op" id="5770966">,</span>&nbsp;<span class="ident" id="5770968">d</span><span class="op" id="5770969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5770972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5770976">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771024">f</span>&nbsp;<span class="op" id="5771026">:=</span>&nbsp;<span class="op" id="5771029">*</span><span class="ident" id="5771030">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771036">f</span><span class="op" id="5771037">.</span><span class="ident" id="5771038">Name</span>&nbsp;<span class="op" id="5771043">=</span>&nbsp;<span class="ident" id="5771045">ast</span><span class="op" id="5771048">.</span><span class="ident" id="5771049">NewIdent</span><span class="op" id="5771057">(</span><span class="string" id="5771058">&#34;main&#34;</span><span class="op" id="5771064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771067">f</span><span class="op" id="5771068">.</span><span class="ident" id="5771069">Decls</span>&nbsp;<span class="op" id="5771075">=</span>&nbsp;<span class="ident" id="5771077">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771084">f</span><span class="op" id="5771085">.</span><span class="ident" id="5771086">Comments</span>&nbsp;<span class="op" id="5771095">=</span>&nbsp;<span class="ident" id="5771097">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771107">return</span>&nbsp;<span class="op" id="5771114">&amp;</span><span class="ident" id="5771115">f</span><br>
<span class="lineno"></span><span class="op" id="5771117">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5771120">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="5771191">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5771251">func</span>&nbsp;<span class="ident" id="5771256">stripOutputComment</span><span class="op" id="5771274">(</span><span class="ident" id="5771275">body</span>&nbsp;<span class="op" id="5771280">*</span><span class="ident" id="5771281">ast</span><span class="op" id="5771284">.</span><span class="ident" id="5771285">BlockStmt</span><span class="op" id="5771294">,</span>&nbsp;<span class="ident" id="5771296">comments</span>&nbsp;<span class="op" id="5771305">[</span><span class="op" id="5771306">]</span><span class="op" id="5771307">*</span><span class="ident" id="5771308">ast</span><span class="op" id="5771311">.</span><span class="ident" id="5771312">CommentGroup</span><span class="op" id="5771324">)</span>&nbsp;<span class="op" id="5771326">(</span><span class="op" id="5771327">*</span><span class="ident" id="5771328">ast</span><span class="op" id="5771331">.</span><span class="ident" id="5771332">BlockStmt</span><span class="op" id="5771341">,</span>&nbsp;<span class="op" id="5771343">[</span><span class="op" id="5771344">]</span><span class="op" id="5771345">*</span><span class="ident" id="5771346">ast</span><span class="op" id="5771349">.</span><span class="ident" id="5771350">CommentGroup</span><span class="op" id="5771362">)</span>&nbsp;<span class="op" id="5771364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5771367">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771413">i</span><span class="op" id="5771414">,</span>&nbsp;<span class="ident" id="5771416">last</span>&nbsp;<span class="op" id="5771421">:=</span>&nbsp;<span class="ident" id="5771424">lastComment</span><span class="op" id="5771435">(</span><span class="ident" id="5771436">body</span><span class="op" id="5771440">,</span>&nbsp;<span class="ident" id="5771442">comments</span><span class="op" id="5771450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771453">if</span>&nbsp;<span class="ident" id="5771456">last</span>&nbsp;<span class="op" id="5771461">==</span>&nbsp;<span class="ident" id="5771464">nil</span>&nbsp;<span class="op" id="5771468">||</span>&nbsp;<span class="op" id="5771471">!</span><span class="ident" id="5771472">outputPrefix</span><span class="op" id="5771484">.</span><span class="ident" id="5771485">MatchString</span><span class="op" id="5771496">(</span><span class="ident" id="5771497">last</span><span class="op" id="5771501">.</span><span class="ident" id="5771502">Text</span><span class="op" id="5771506">(</span><span class="op" id="5771507">)</span><span class="op" id="5771508">)</span>&nbsp;<span class="op" id="5771510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771514">return</span>&nbsp;<span class="ident" id="5771521">body</span><span class="op" id="5771525">,</span>&nbsp;<span class="ident" id="5771527">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5771537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5771541">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771609">newBody</span>&nbsp;<span class="op" id="5771617">:=</span>&nbsp;<span class="op" id="5771620">&amp;</span><span class="ident" id="5771621">ast</span><span class="op" id="5771624">.</span><span class="ident" id="5771625">BlockStmt</span><span class="op" id="5771634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771638">Lbrace</span><span class="op" id="5771644">:</span>&nbsp;<span class="ident" id="5771646">body</span><span class="op" id="5771650">.</span><span class="ident" id="5771651">Lbrace</span><span class="op" id="5771657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771661">List</span><span class="op" id="5771665">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5771669">body</span><span class="op" id="5771673">.</span><span class="ident" id="5771674">List</span><span class="op" id="5771678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771682">Rbrace</span><span class="op" id="5771688">:</span>&nbsp;<span class="ident" id="5771690">last</span><span class="op" id="5771694">.</span><span class="ident" id="5771695">Pos</span><span class="op" id="5771698">(</span><span class="op" id="5771699">)</span><span class="op" id="5771700">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5771703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5771706">newComments</span>&nbsp;<span class="op" id="5771718">:=</span>&nbsp;<span class="builtinfunc" id="5771721">make</span><span class="op" id="5771725">(</span><span class="op" id="5771726">[</span><span class="op" id="5771727">]</span><span class="op" id="5771728">*</span><span class="ident" id="5771729">ast</span><span class="op" id="5771732">.</span><span class="ident" id="5771733">CommentGroup</span><span class="op" id="5771745">,</span>&nbsp;<span class="builtinfunc" id="5771747">len</span><span class="op" id="5771750">(</span><span class="ident" id="5771751">comments</span><span class="op" id="5771759">)</span><span class="op" id="5771760">-</span><span class="num" id="5771761">1</span><span class="op" id="5771762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5771765">copy</span><span class="op" id="5771769">(</span><span class="ident" id="5771770">newComments</span><span class="op" id="5771781">,</span>&nbsp;<span class="ident" id="5771783">comments</span><span class="op" id="5771791">[</span><span class="op" id="5771792">:</span><span class="ident" id="5771793">i</span><span class="op" id="5771794">]</span><span class="op" id="5771795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5771798">copy</span><span class="op" id="5771802">(</span><span class="ident" id="5771803">newComments</span><span class="op" id="5771814">[</span><span class="ident" id="5771815">i</span><span class="op" id="5771816">:</span><span class="op" id="5771817">]</span><span class="op" id="5771818">,</span>&nbsp;<span class="ident" id="5771820">comments</span><span class="op" id="5771828">[</span><span class="ident" id="5771829">i</span><span class="op" id="5771830">+</span><span class="num" id="5771831">1</span><span class="op" id="5771832">:</span><span class="op" id="5771833">]</span><span class="op" id="5771834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5771837">return</span>&nbsp;<span class="ident" id="5771844">newBody</span><span class="op" id="5771851">,</span>&nbsp;<span class="ident" id="5771853">newComments</span><br>
<span class="lineno">340</span><span class="op" id="5771865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5771868">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="5771935">func</span>&nbsp;<span class="ident" id="5771940">lastComment</span><span class="op" id="5771951">(</span><span class="ident" id="5771952">b</span>&nbsp;<span class="op" id="5771954">*</span><span class="ident" id="5771955">ast</span><span class="op" id="5771958">.</span><span class="ident" id="5771959">BlockStmt</span><span class="op" id="5771968">,</span>&nbsp;<span class="ident" id="5771970">c</span>&nbsp;<span class="op" id="5771972">[</span><span class="op" id="5771973">]</span><span class="op" id="5771974">*</span><span class="ident" id="5771975">ast</span><span class="op" id="5771978">.</span><span class="ident" id="5771979">CommentGroup</span><span class="op" id="5771991">)</span>&nbsp;<span class="op" id="5771993">(</span><span class="ident" id="5771994">i</span>&nbsp;<span class="builtintype" id="5771996">int</span><span class="op" id="5771999">,</span>&nbsp;<span class="ident" id="5772001">last</span>&nbsp;<span class="op" id="5772006">*</span><span class="ident" id="5772007">ast</span><span class="op" id="5772010">.</span><span class="ident" id="5772011">CommentGroup</span><span class="op" id="5772023">)</span>&nbsp;<span class="op" id="5772025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772028">pos</span><span class="op" id="5772031">,</span>&nbsp;<span class="ident" id="5772033">end</span>&nbsp;<span class="op" id="5772037">:=</span>&nbsp;<span class="ident" id="5772040">b</span><span class="op" id="5772041">.</span><span class="ident" id="5772042">Pos</span><span class="op" id="5772045">(</span><span class="op" id="5772046">)</span><span class="op" id="5772047">,</span>&nbsp;<span class="ident" id="5772049">b</span><span class="op" id="5772050">.</span><span class="ident" id="5772051">End</span><span class="op" id="5772054">(</span><span class="op" id="5772055">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772058">for</span>&nbsp;<span class="ident" id="5772062">j</span><span class="op" id="5772063">,</span>&nbsp;<span class="ident" id="5772065">cg</span>&nbsp;<span class="op" id="5772068">:=</span>&nbsp;<span class="keyword" id="5772071">range</span>&nbsp;<span class="ident" id="5772077">c</span>&nbsp;<span class="op" id="5772079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772083">if</span>&nbsp;<span class="ident" id="5772086">cg</span><span class="op" id="5772088">.</span><span class="ident" id="5772089">Pos</span><span class="op" id="5772092">(</span><span class="op" id="5772093">)</span>&nbsp;<span class="op" id="5772095">&lt;</span>&nbsp;<span class="ident" id="5772097">pos</span>&nbsp;<span class="op" id="5772101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772106">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5772117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772121">if</span>&nbsp;<span class="ident" id="5772124">cg</span><span class="op" id="5772126">.</span><span class="ident" id="5772127">End</span><span class="op" id="5772130">(</span><span class="op" id="5772131">)</span>&nbsp;<span class="op" id="5772133">&gt;</span>&nbsp;<span class="ident" id="5772135">end</span>&nbsp;<span class="op" id="5772139">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772144">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5772152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5772156">i</span><span class="op" id="5772157">,</span>&nbsp;<span class="ident" id="5772159">last</span>&nbsp;<span class="op" id="5772164">=</span>&nbsp;<span class="ident" id="5772166">j</span><span class="op" id="5772167">,</span>&nbsp;<span class="ident" id="5772169">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5772173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5772176">return</span><br>
<span class="lineno">355</span><span class="op" id="5772183">}</span>
</div>
</body>
</html>
