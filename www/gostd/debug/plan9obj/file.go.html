<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4764363">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4764419">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4764473">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4764524">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4764592">package</span>&nbsp;<span class="ident" id="4764600">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4764610">import</span>&nbsp;<span class="op" id="4764617">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4764620">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4764639">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4764649">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4764656">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4764662">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="4764667">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="4764670">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4764725">type</span>&nbsp;<span class="ident" id="4764730">FileHeader</span>&nbsp;<span class="keyword" id="4764741">struct</span>&nbsp;<span class="op" id="4764748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764751">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4764763">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764771">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4764783">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764791">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4764803">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764811">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4764823">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764828">LoadAddress</span>&nbsp;<span class="builtintype" id="4764840">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764848">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4764860">uint64</span><br>
<span class="lineno"></span><span class="op" id="4764867">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4764870">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4764918">type</span>&nbsp;<span class="ident" id="4764923">File</span>&nbsp;<span class="keyword" id="4764928">struct</span>&nbsp;<span class="op" id="4764935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764938">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764950">Sections</span>&nbsp;<span class="op" id="4764959">[</span><span class="op" id="4764960">]</span><span class="op" id="4764961">*</span><span class="ident" id="4764962">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764971">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4764980">io</span><span class="op" id="4764982">.</span><span class="ident" id="4764983">Closer</span><br>
<span class="lineno"></span><span class="op" id="4764990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4764993">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="4765061">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="4765123">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4765151">type</span>&nbsp;<span class="ident" id="4765156">SectionHeader</span>&nbsp;<span class="keyword" id="4765170">struct</span>&nbsp;<span class="op" id="4765177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765180">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4765187">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765195">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4765202">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765210">Offset</span>&nbsp;<span class="builtintype" id="4765217">uint32</span><br>
<span class="lineno">40</span><span class="op" id="4765224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4765227">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4765292">type</span>&nbsp;<span class="ident" id="4765297">Section</span>&nbsp;<span class="keyword" id="4765305">struct</span>&nbsp;<span class="op" id="4765312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765315">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765331">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765369">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765409">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765444">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765492">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4765542">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765566">io</span><span class="op" id="4765568">.</span><span class="ident" id="4765569">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765579">sr</span>&nbsp;<span class="op" id="4765582">*</span><span class="ident" id="4765583">io</span><span class="op" id="4765585">.</span><span class="ident" id="4765586">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4765600">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4765603">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4765671">func</span>&nbsp;<span class="op" id="4765676">(</span><span class="ident" id="4765677">s</span>&nbsp;<span class="op" id="4765679">*</span><span class="ident" id="4765680">Section</span><span class="op" id="4765687">)</span>&nbsp;<span class="ident" id="4765689">Data</span><span class="op" id="4765693">(</span><span class="op" id="4765694">)</span>&nbsp;<span class="op" id="4765696">(</span><span class="op" id="4765697">[</span><span class="op" id="4765698">]</span><span class="builtintype" id="4765699">byte</span><span class="op" id="4765703">,</span>&nbsp;<span class="builtintype" id="4765705">error</span><span class="op" id="4765710">)</span>&nbsp;<span class="op" id="4765712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765715">dat</span>&nbsp;<span class="op" id="4765719">:=</span>&nbsp;<span class="builtinfunc" id="4765722">make</span><span class="op" id="4765726">(</span><span class="op" id="4765727">[</span><span class="op" id="4765728">]</span><span class="builtintype" id="4765729">byte</span><span class="op" id="4765733">,</span>&nbsp;<span class="ident" id="4765735">s</span><span class="op" id="4765736">.</span><span class="ident" id="4765737">sr</span><span class="op" id="4765739">.</span><span class="ident" id="4765740">Size</span><span class="op" id="4765744">(</span><span class="op" id="4765745">)</span><span class="op" id="4765746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765749">n</span><span class="op" id="4765750">,</span>&nbsp;<span class="ident" id="4765752">err</span>&nbsp;<span class="op" id="4765756">:=</span>&nbsp;<span class="ident" id="4765759">s</span><span class="op" id="4765760">.</span><span class="ident" id="4765761">sr</span><span class="op" id="4765763">.</span><span class="ident" id="4765764">ReadAt</span><span class="op" id="4765770">(</span><span class="ident" id="4765771">dat</span><span class="op" id="4765774">,</span>&nbsp;<span class="num" id="4765776">0</span><span class="op" id="4765777">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765780">if</span>&nbsp;<span class="ident" id="4765783">n</span>&nbsp;<span class="op" id="4765785">==</span>&nbsp;<span class="builtinfunc" id="4765788">len</span><span class="op" id="4765791">(</span><span class="ident" id="4765792">dat</span><span class="op" id="4765795">)</span>&nbsp;<span class="op" id="4765797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4765801">err</span>&nbsp;<span class="op" id="4765805">=</span>&nbsp;<span class="builtintype" id="4765807">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4765812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4765815">return</span>&nbsp;<span class="ident" id="4765822">dat</span><span class="op" id="4765825">[</span><span class="num" id="4765826">0</span><span class="op" id="4765827">:</span><span class="ident" id="4765828">n</span><span class="op" id="4765829">]</span><span class="op" id="4765830">,</span>&nbsp;<span class="ident" id="4765832">err</span><br>
<span class="lineno"></span><span class="op" id="4765836">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="4765839">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4765906">func</span>&nbsp;<span class="op" id="4765911">(</span><span class="ident" id="4765912">s</span>&nbsp;<span class="op" id="4765914">*</span><span class="ident" id="4765915">Section</span><span class="op" id="4765922">)</span>&nbsp;<span class="ident" id="4765924">Open</span><span class="op" id="4765928">(</span><span class="op" id="4765929">)</span>&nbsp;<span class="ident" id="4765931">io</span><span class="op" id="4765933">.</span><span class="ident" id="4765934">ReadSeeker</span>&nbsp;<span class="op" id="4765945">{</span>&nbsp;<span class="keyword" id="4765947">return</span>&nbsp;<span class="ident" id="4765954">io</span><span class="op" id="4765956">.</span><span class="ident" id="4765957">NewSectionReader</span><span class="op" id="4765973">(</span><span class="ident" id="4765974">s</span><span class="op" id="4765975">.</span><span class="ident" id="4765976">sr</span><span class="op" id="4765978">,</span>&nbsp;<span class="num" id="4765980">0</span><span class="op" id="4765981">,</span>&nbsp;<span class="num" id="4765983">1</span><span class="op" id="4765984">&lt;&lt;</span><span class="num" id="4765986">63</span><span class="op" id="4765988">-</span><span class="num" id="4765989">1</span><span class="op" id="4765990">)</span>&nbsp;<span class="op" id="4765992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4765995">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="4766067">type</span>&nbsp;<span class="ident" id="4766072">Sym</span>&nbsp;<span class="keyword" id="4766076">struct</span>&nbsp;<span class="op" id="4766083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766086">Value</span>&nbsp;<span class="builtintype" id="4766092">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766100">Type</span>&nbsp;&nbsp;<span class="builtintype" id="4766106">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766112">Name</span>&nbsp;&nbsp;<span class="builtintype" id="4766118">string</span><br>
<span class="lineno"></span><span class="op" id="4766125">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="4766128">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4766159">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="4766222">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4766273">type</span>&nbsp;<span class="ident" id="4766278">formatError</span>&nbsp;<span class="keyword" id="4766290">struct</span>&nbsp;<span class="op" id="4766297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766300">off</span>&nbsp;<span class="builtintype" id="4766304">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766309">msg</span>&nbsp;<span class="builtintype" id="4766313">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766321">val</span>&nbsp;<span class="keyword" id="4766325">interface</span><span class="op" id="4766334">{</span><span class="op" id="4766335">}</span><br>
<span class="lineno"></span><span class="op" id="4766337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4766340">func</span>&nbsp;<span class="op" id="4766345">(</span><span class="ident" id="4766346">e</span>&nbsp;<span class="op" id="4766348">*</span><span class="ident" id="4766349">formatError</span><span class="op" id="4766360">)</span>&nbsp;<span class="ident" id="4766362">Error</span><span class="op" id="4766367">(</span><span class="op" id="4766368">)</span>&nbsp;<span class="builtintype" id="4766370">string</span>&nbsp;<span class="op" id="4766377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766380">msg</span>&nbsp;<span class="op" id="4766384">:=</span>&nbsp;<span class="ident" id="4766387">e</span><span class="op" id="4766388">.</span><span class="ident" id="4766389">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766394">if</span>&nbsp;<span class="ident" id="4766397">e</span><span class="op" id="4766398">.</span><span class="ident" id="4766399">val</span>&nbsp;<span class="op" id="4766403">!=</span>&nbsp;<span class="builtintype" id="4766406">nil</span>&nbsp;<span class="op" id="4766410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766414">msg</span>&nbsp;<span class="op" id="4766418">+=</span>&nbsp;<span class="ident" id="4766421">fmt</span><span class="op" id="4766424">.</span><span class="ident" id="4766425">Sprintf</span><span class="op" id="4766432">(</span><span class="string" id="4766433">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="4766440">,</span>&nbsp;<span class="ident" id="4766442">e</span><span class="op" id="4766443">.</span><span class="ident" id="4766444">val</span><span class="op" id="4766447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766453">msg</span>&nbsp;<span class="op" id="4766457">+=</span>&nbsp;<span class="ident" id="4766460">fmt</span><span class="op" id="4766463">.</span><span class="ident" id="4766464">Sprintf</span><span class="op" id="4766471">(</span><span class="string" id="4766472">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="4766496">,</span>&nbsp;<span class="ident" id="4766498">e</span><span class="op" id="4766499">.</span><span class="ident" id="4766500">off</span><span class="op" id="4766503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766506">return</span>&nbsp;<span class="ident" id="4766513">msg</span><br>
<span class="lineno">95</span><span class="op" id="4766517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4766520">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4766613">func</span>&nbsp;<span class="ident" id="4766618">Open</span><span class="op" id="4766622">(</span><span class="ident" id="4766623">name</span>&nbsp;<span class="builtintype" id="4766628">string</span><span class="op" id="4766634">)</span>&nbsp;<span class="op" id="4766636">(</span><span class="op" id="4766637">*</span><span class="ident" id="4766638">File</span><span class="op" id="4766642">,</span>&nbsp;<span class="builtintype" id="4766644">error</span><span class="op" id="4766649">)</span>&nbsp;<span class="op" id="4766651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766654">f</span><span class="op" id="4766655">,</span>&nbsp;<span class="ident" id="4766657">err</span>&nbsp;<span class="op" id="4766661">:=</span>&nbsp;<span class="ident" id="4766664">os</span><span class="op" id="4766666">.</span><span class="ident" id="4766667">Open</span><span class="op" id="4766671">(</span><span class="ident" id="4766672">name</span><span class="op" id="4766676">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766679">if</span>&nbsp;<span class="ident" id="4766682">err</span>&nbsp;<span class="op" id="4766686">!=</span>&nbsp;<span class="builtintype" id="4766689">nil</span>&nbsp;<span class="op" id="4766693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766697">return</span>&nbsp;<span class="builtintype" id="4766704">nil</span><span class="op" id="4766707">,</span>&nbsp;<span class="ident" id="4766709">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766717">ff</span><span class="op" id="4766719">,</span>&nbsp;<span class="ident" id="4766721">err</span>&nbsp;<span class="op" id="4766725">:=</span>&nbsp;<span class="ident" id="4766728">NewFile</span><span class="op" id="4766735">(</span><span class="ident" id="4766736">f</span><span class="op" id="4766737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766740">if</span>&nbsp;<span class="ident" id="4766743">err</span>&nbsp;<span class="op" id="4766747">!=</span>&nbsp;<span class="builtintype" id="4766750">nil</span>&nbsp;<span class="op" id="4766754">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766758">f</span><span class="op" id="4766759">.</span><span class="ident" id="4766760">Close</span><span class="op" id="4766765">(</span><span class="op" id="4766766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766770">return</span>&nbsp;<span class="builtintype" id="4766777">nil</span><span class="op" id="4766780">,</span>&nbsp;<span class="ident" id="4766782">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4766787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4766790">ff</span><span class="op" id="4766792">.</span><span class="ident" id="4766793">closer</span>&nbsp;<span class="op" id="4766800">=</span>&nbsp;<span class="ident" id="4766802">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766805">return</span>&nbsp;<span class="ident" id="4766812">ff</span><span class="op" id="4766814">,</span>&nbsp;<span class="builtintype" id="4766816">nil</span><br>
<span class="lineno">110</span><span class="op" id="4766820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4766823">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="4766849">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="4766916">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="4766940">func</span>&nbsp;<span class="op" id="4766945">(</span><span class="ident" id="4766946">f</span>&nbsp;<span class="op" id="4766948">*</span><span class="ident" id="4766949">File</span><span class="op" id="4766953">)</span>&nbsp;<span class="ident" id="4766955">Close</span><span class="op" id="4766960">(</span><span class="op" id="4766961">)</span>&nbsp;<span class="builtintype" id="4766963">error</span>&nbsp;<span class="op" id="4766969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766972">var</span>&nbsp;<span class="ident" id="4766976">err</span>&nbsp;<span class="builtintype" id="4766980">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4766987">if</span>&nbsp;<span class="ident" id="4766990">f</span><span class="op" id="4766991">.</span><span class="ident" id="4766992">closer</span>&nbsp;<span class="op" id="4766999">!=</span>&nbsp;<span class="builtintype" id="4767002">nil</span>&nbsp;<span class="op" id="4767006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767010">err</span>&nbsp;<span class="op" id="4767014">=</span>&nbsp;<span class="ident" id="4767016">f</span><span class="op" id="4767017">.</span><span class="ident" id="4767018">closer</span><span class="op" id="4767024">.</span><span class="ident" id="4767025">Close</span><span class="op" id="4767030">(</span><span class="op" id="4767031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767035">f</span><span class="op" id="4767036">.</span><span class="ident" id="4767037">closer</span>&nbsp;<span class="op" id="4767044">=</span>&nbsp;<span class="builtintype" id="4767046">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767054">return</span>&nbsp;<span class="ident" id="4767061">err</span><br>
<span class="lineno"></span><span class="op" id="4767065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4767068">func</span>&nbsp;<span class="ident" id="4767073">parseMagic</span><span class="op" id="4767083">(</span><span class="ident" id="4767084">magic</span>&nbsp;<span class="op" id="4767090">[</span><span class="op" id="4767091">]</span><span class="builtintype" id="4767092">byte</span><span class="op" id="4767096">)</span>&nbsp;<span class="op" id="4767098">(</span><span class="builtintype" id="4767099">uint32</span><span class="op" id="4767105">,</span>&nbsp;<span class="builtintype" id="4767107">error</span><span class="op" id="4767112">)</span>&nbsp;<span class="op" id="4767114">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767117">m</span>&nbsp;<span class="op" id="4767119">:=</span>&nbsp;<span class="ident" id="4767122">binary</span><span class="op" id="4767128">.</span><span class="ident" id="4767129">BigEndian</span><span class="op" id="4767138">.</span><span class="ident" id="4767139">Uint32</span><span class="op" id="4767145">(</span><span class="ident" id="4767146">magic</span><span class="op" id="4767151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767154">switch</span>&nbsp;<span class="ident" id="4767161">m</span>&nbsp;<span class="op" id="4767163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767166">case</span>&nbsp;<span class="ident" id="4767171">Magic386</span><span class="op" id="4767179">,</span>&nbsp;<span class="ident" id="4767181">MagicAMD64</span><span class="op" id="4767191">,</span>&nbsp;<span class="ident" id="4767193">MagicARM</span><span class="op" id="4767201">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767205">return</span>&nbsp;<span class="ident" id="4767212">m</span><span class="op" id="4767213">,</span>&nbsp;<span class="builtintype" id="4767215">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767220">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767223">return</span>&nbsp;<span class="num" id="4767230">0</span><span class="op" id="4767231">,</span>&nbsp;<span class="op" id="4767233">&amp;</span><span class="ident" id="4767234">formatError</span><span class="op" id="4767245">{</span><span class="num" id="4767246">0</span><span class="op" id="4767247">,</span>&nbsp;<span class="string" id="4767249">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="4767267">,</span>&nbsp;<span class="ident" id="4767269">magic</span><span class="op" id="4767274">}</span><br>
<span class="lineno"></span><span class="op" id="4767276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4767279">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="4767364">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="4767437">func</span>&nbsp;<span class="ident" id="4767442">NewFile</span><span class="op" id="4767449">(</span><span class="ident" id="4767450">r</span>&nbsp;<span class="ident" id="4767452">io</span><span class="op" id="4767454">.</span><span class="ident" id="4767455">ReaderAt</span><span class="op" id="4767463">)</span>&nbsp;<span class="op" id="4767465">(</span><span class="op" id="4767466">*</span><span class="ident" id="4767467">File</span><span class="op" id="4767471">,</span>&nbsp;<span class="builtintype" id="4767473">error</span><span class="op" id="4767478">)</span>&nbsp;<span class="op" id="4767480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767483">sr</span>&nbsp;<span class="op" id="4767486">:=</span>&nbsp;<span class="ident" id="4767489">io</span><span class="op" id="4767491">.</span><span class="ident" id="4767492">NewSectionReader</span><span class="op" id="4767508">(</span><span class="ident" id="4767509">r</span><span class="op" id="4767510">,</span>&nbsp;<span class="num" id="4767512">0</span><span class="op" id="4767513">,</span>&nbsp;<span class="num" id="4767515">1</span><span class="op" id="4767516">&lt;&lt;</span><span class="num" id="4767518">63</span><span class="op" id="4767520">-</span><span class="num" id="4767521">1</span><span class="op" id="4767522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4767525">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767558">var</span>&nbsp;<span class="ident" id="4767562">magic</span>&nbsp;<span class="op" id="4767568">[</span><span class="num" id="4767569">4</span><span class="op" id="4767570">]</span><span class="builtintype" id="4767571">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767577">if</span>&nbsp;<span class="ident" id="4767580">_</span><span class="op" id="4767581">,</span>&nbsp;<span class="ident" id="4767583">err</span>&nbsp;<span class="op" id="4767587">:=</span>&nbsp;<span class="ident" id="4767590">r</span><span class="op" id="4767591">.</span><span class="ident" id="4767592">ReadAt</span><span class="op" id="4767598">(</span><span class="ident" id="4767599">magic</span><span class="op" id="4767604">[</span><span class="op" id="4767605">:</span><span class="op" id="4767606">]</span><span class="op" id="4767607">,</span>&nbsp;<span class="num" id="4767609">0</span><span class="op" id="4767610">)</span><span class="op" id="4767611">;</span>&nbsp;<span class="ident" id="4767613">err</span>&nbsp;<span class="op" id="4767617">!=</span>&nbsp;<span class="builtintype" id="4767620">nil</span>&nbsp;<span class="op" id="4767624">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767628">return</span>&nbsp;<span class="builtintype" id="4767635">nil</span><span class="op" id="4767638">,</span>&nbsp;<span class="ident" id="4767640">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767648">_</span><span class="op" id="4767649">,</span>&nbsp;<span class="ident" id="4767651">err</span>&nbsp;<span class="op" id="4767655">:=</span>&nbsp;<span class="ident" id="4767658">parseMagic</span><span class="op" id="4767668">(</span><span class="ident" id="4767669">magic</span><span class="op" id="4767674">[</span><span class="op" id="4767675">:</span><span class="op" id="4767676">]</span><span class="op" id="4767677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767680">if</span>&nbsp;<span class="ident" id="4767683">err</span>&nbsp;<span class="op" id="4767687">!=</span>&nbsp;<span class="builtintype" id="4767690">nil</span>&nbsp;<span class="op" id="4767694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767698">return</span>&nbsp;<span class="builtintype" id="4767705">nil</span><span class="op" id="4767708">,</span>&nbsp;<span class="ident" id="4767710">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767719">ph</span>&nbsp;<span class="op" id="4767722">:=</span>&nbsp;<span class="builtinfunc" id="4767725">new</span><span class="op" id="4767728">(</span><span class="ident" id="4767729">prog</span><span class="op" id="4767733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767736">if</span>&nbsp;<span class="ident" id="4767739">err</span>&nbsp;<span class="op" id="4767743">:=</span>&nbsp;<span class="ident" id="4767746">binary</span><span class="op" id="4767752">.</span><span class="ident" id="4767753">Read</span><span class="op" id="4767757">(</span><span class="ident" id="4767758">sr</span><span class="op" id="4767760">,</span>&nbsp;<span class="ident" id="4767762">binary</span><span class="op" id="4767768">.</span><span class="ident" id="4767769">BigEndian</span><span class="op" id="4767778">,</span>&nbsp;<span class="ident" id="4767780">ph</span><span class="op" id="4767782">)</span><span class="op" id="4767783">;</span>&nbsp;<span class="ident" id="4767785">err</span>&nbsp;<span class="op" id="4767789">!=</span>&nbsp;<span class="builtintype" id="4767792">nil</span>&nbsp;<span class="op" id="4767796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4767800">return</span>&nbsp;<span class="builtintype" id="4767807">nil</span><span class="op" id="4767810">,</span>&nbsp;<span class="ident" id="4767812">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4767817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767821">f</span>&nbsp;<span class="op" id="4767823">:=</span>&nbsp;<span class="op" id="4767826">&amp;</span><span class="ident" id="4767827">File</span><span class="op" id="4767831">{</span><span class="ident" id="4767832">FileHeader</span><span class="op" id="4767842">:</span>&nbsp;<span class="ident" id="4767844">FileHeader</span><span class="op" id="4767854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767858">Magic</span><span class="op" id="4767863">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767871">ph</span><span class="op" id="4767873">.</span><span class="ident" id="4767874">Magic</span><span class="op" id="4767879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767883">Bss</span><span class="op" id="4767886">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767896">ph</span><span class="op" id="4767898">.</span><span class="ident" id="4767899">Bss</span><span class="op" id="4767902">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767906">Entry</span><span class="op" id="4767911">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4767919">uint64</span><span class="op" id="4767925">(</span><span class="ident" id="4767926">ph</span><span class="op" id="4767928">.</span><span class="ident" id="4767929">Entry</span><span class="op" id="4767934">)</span><span class="op" id="4767935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767939">PtrSize</span><span class="op" id="4767946">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4767952">4</span><span class="op" id="4767953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767957">LoadAddress</span><span class="op" id="4767968">:</span>&nbsp;<span class="num" id="4767970">0x1000</span><span class="op" id="4767976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4767980">HdrSize</span><span class="op" id="4767987">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4767993">4</span>&nbsp;<span class="op" id="4767995">*</span>&nbsp;<span class="num" id="4767997">8</span><span class="op" id="4767998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768001">}</span><span class="op" id="4768002">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768006">if</span>&nbsp;<span class="ident" id="4768009">ph</span><span class="op" id="4768011">.</span><span class="ident" id="4768012">Magic</span><span class="op" id="4768017">&amp;</span><span class="ident" id="4768018">Magic64</span>&nbsp;<span class="op" id="4768026">!=</span>&nbsp;<span class="num" id="4768029">0</span>&nbsp;<span class="op" id="4768031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768035">if</span>&nbsp;<span class="ident" id="4768038">err</span>&nbsp;<span class="op" id="4768042">:=</span>&nbsp;<span class="ident" id="4768045">binary</span><span class="op" id="4768051">.</span><span class="ident" id="4768052">Read</span><span class="op" id="4768056">(</span><span class="ident" id="4768057">sr</span><span class="op" id="4768059">,</span>&nbsp;<span class="ident" id="4768061">binary</span><span class="op" id="4768067">.</span><span class="ident" id="4768068">BigEndian</span><span class="op" id="4768077">,</span>&nbsp;<span class="op" id="4768079">&amp;</span><span class="ident" id="4768080">f</span><span class="op" id="4768081">.</span><span class="ident" id="4768082">Entry</span><span class="op" id="4768087">)</span><span class="op" id="4768088">;</span>&nbsp;<span class="ident" id="4768090">err</span>&nbsp;<span class="op" id="4768094">!=</span>&nbsp;<span class="builtintype" id="4768097">nil</span>&nbsp;<span class="op" id="4768101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768106">return</span>&nbsp;<span class="builtintype" id="4768113">nil</span><span class="op" id="4768116">,</span>&nbsp;<span class="ident" id="4768118">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768124">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768128">f</span><span class="op" id="4768129">.</span><span class="ident" id="4768130">PtrSize</span>&nbsp;<span class="op" id="4768138">=</span>&nbsp;<span class="num" id="4768140">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768144">f</span><span class="op" id="4768145">.</span><span class="ident" id="4768146">LoadAddress</span>&nbsp;<span class="op" id="4768158">=</span>&nbsp;<span class="num" id="4768160">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768171">f</span><span class="op" id="4768172">.</span><span class="ident" id="4768173">HdrSize</span>&nbsp;<span class="op" id="4768181">+=</span>&nbsp;<span class="num" id="4768184">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768191">var</span>&nbsp;<span class="ident" id="4768195">sects</span>&nbsp;<span class="op" id="4768201">=</span>&nbsp;<span class="op" id="4768203">[</span><span class="op" id="4768204">]</span><span class="keyword" id="4768205">struct</span>&nbsp;<span class="op" id="4768212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768216">name</span>&nbsp;<span class="builtintype" id="4768221">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768230">size</span>&nbsp;<span class="builtintype" id="4768235">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768243">}</span><span class="op" id="4768244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768248">{</span><span class="string" id="4768249">&#34;text&#34;</span><span class="op" id="4768255">,</span>&nbsp;<span class="ident" id="4768257">ph</span><span class="op" id="4768259">.</span><span class="ident" id="4768260">Text</span><span class="op" id="4768264">}</span><span class="op" id="4768265">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768269">{</span><span class="string" id="4768270">&#34;data&#34;</span><span class="op" id="4768276">,</span>&nbsp;<span class="ident" id="4768278">ph</span><span class="op" id="4768280">.</span><span class="ident" id="4768281">Data</span><span class="op" id="4768285">}</span><span class="op" id="4768286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768290">{</span><span class="string" id="4768291">&#34;syms&#34;</span><span class="op" id="4768297">,</span>&nbsp;<span class="ident" id="4768299">ph</span><span class="op" id="4768301">.</span><span class="ident" id="4768302">Syms</span><span class="op" id="4768306">}</span><span class="op" id="4768307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768311">{</span><span class="string" id="4768312">&#34;spsz&#34;</span><span class="op" id="4768318">,</span>&nbsp;<span class="ident" id="4768320">ph</span><span class="op" id="4768322">.</span><span class="ident" id="4768323">Spsz</span><span class="op" id="4768327">}</span><span class="op" id="4768328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768332">{</span><span class="string" id="4768333">&#34;pcsz&#34;</span><span class="op" id="4768339">,</span>&nbsp;<span class="ident" id="4768341">ph</span><span class="op" id="4768343">.</span><span class="ident" id="4768344">Pcsz</span><span class="op" id="4768348">}</span><span class="op" id="4768349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768352">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768356">f</span><span class="op" id="4768357">.</span><span class="ident" id="4768358">Sections</span>&nbsp;<span class="op" id="4768367">=</span>&nbsp;<span class="builtinfunc" id="4768369">make</span><span class="op" id="4768373">(</span><span class="op" id="4768374">[</span><span class="op" id="4768375">]</span><span class="op" id="4768376">*</span><span class="ident" id="4768377">Section</span><span class="op" id="4768384">,</span>&nbsp;<span class="num" id="4768386">5</span><span class="op" id="4768387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768391">off</span>&nbsp;<span class="op" id="4768395">:=</span>&nbsp;<span class="builtintype" id="4768398">uint32</span><span class="op" id="4768404">(</span><span class="ident" id="4768405">f</span><span class="op" id="4768406">.</span><span class="ident" id="4768407">HdrSize</span><span class="op" id="4768414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768418">for</span>&nbsp;<span class="ident" id="4768422">i</span><span class="op" id="4768423">,</span>&nbsp;<span class="ident" id="4768425">sect</span>&nbsp;<span class="op" id="4768430">:=</span>&nbsp;<span class="keyword" id="4768433">range</span>&nbsp;<span class="ident" id="4768439">sects</span>&nbsp;<span class="op" id="4768445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768449">s</span>&nbsp;<span class="op" id="4768451">:=</span>&nbsp;<span class="builtinfunc" id="4768454">new</span><span class="op" id="4768457">(</span><span class="ident" id="4768458">Section</span><span class="op" id="4768465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768469">s</span><span class="op" id="4768470">.</span><span class="ident" id="4768471">SectionHeader</span>&nbsp;<span class="op" id="4768485">=</span>&nbsp;<span class="ident" id="4768487">SectionHeader</span><span class="op" id="4768500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768505">Name</span><span class="op" id="4768509">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4768513">sect</span><span class="op" id="4768517">.</span><span class="ident" id="4768518">name</span><span class="op" id="4768522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768527">Size</span><span class="op" id="4768531">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4768535">sect</span><span class="op" id="4768539">.</span><span class="ident" id="4768540">size</span><span class="op" id="4768544">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768549">Offset</span><span class="op" id="4768555">:</span>&nbsp;<span class="ident" id="4768557">off</span><span class="op" id="4768560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768568">off</span>&nbsp;<span class="op" id="4768572">+=</span>&nbsp;<span class="ident" id="4768575">sect</span><span class="op" id="4768579">.</span><span class="ident" id="4768580">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768587">s</span><span class="op" id="4768588">.</span><span class="ident" id="4768589">sr</span>&nbsp;<span class="op" id="4768592">=</span>&nbsp;<span class="ident" id="4768594">io</span><span class="op" id="4768596">.</span><span class="ident" id="4768597">NewSectionReader</span><span class="op" id="4768613">(</span><span class="ident" id="4768614">r</span><span class="op" id="4768615">,</span>&nbsp;<span class="builtintype" id="4768617">int64</span><span class="op" id="4768622">(</span><span class="ident" id="4768623">s</span><span class="op" id="4768624">.</span><span class="ident" id="4768625">Offset</span><span class="op" id="4768631">)</span><span class="op" id="4768632">,</span>&nbsp;<span class="builtintype" id="4768634">int64</span><span class="op" id="4768639">(</span><span class="ident" id="4768640">s</span><span class="op" id="4768641">.</span><span class="ident" id="4768642">Size</span><span class="op" id="4768646">)</span><span class="op" id="4768647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768651">s</span><span class="op" id="4768652">.</span><span class="ident" id="4768653">ReaderAt</span>&nbsp;<span class="op" id="4768662">=</span>&nbsp;<span class="ident" id="4768664">s</span><span class="op" id="4768665">.</span><span class="ident" id="4768666">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768671">f</span><span class="op" id="4768672">.</span><span class="ident" id="4768673">Sections</span><span class="op" id="4768681">[</span><span class="ident" id="4768682">i</span><span class="op" id="4768683">]</span>&nbsp;<span class="op" id="4768685">=</span>&nbsp;<span class="ident" id="4768687">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768694">return</span>&nbsp;<span class="ident" id="4768701">f</span><span class="op" id="4768702">,</span>&nbsp;<span class="builtintype" id="4768704">nil</span><br>
<span class="lineno"></span><span class="op" id="4768708">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4768711">func</span>&nbsp;<span class="ident" id="4768716">walksymtab</span><span class="op" id="4768726">(</span><span class="ident" id="4768727">data</span>&nbsp;<span class="op" id="4768732">[</span><span class="op" id="4768733">]</span><span class="builtintype" id="4768734">byte</span><span class="op" id="4768738">,</span>&nbsp;<span class="ident" id="4768740">ptrsz</span>&nbsp;<span class="builtintype" id="4768746">int</span><span class="op" id="4768749">,</span>&nbsp;<span class="ident" id="4768751">fn</span>&nbsp;<span class="keyword" id="4768754">func</span><span class="op" id="4768758">(</span><span class="ident" id="4768759">sym</span><span class="op" id="4768762">)</span>&nbsp;<span class="builtintype" id="4768764">error</span><span class="op" id="4768769">)</span>&nbsp;<span class="builtintype" id="4768771">error</span>&nbsp;<span class="op" id="4768777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768780">var</span>&nbsp;<span class="ident" id="4768784">order</span>&nbsp;<span class="ident" id="4768790">binary</span><span class="op" id="4768796">.</span><span class="ident" id="4768797">ByteOrder</span>&nbsp;<span class="op" id="4768807">=</span>&nbsp;<span class="ident" id="4768809">binary</span><span class="op" id="4768815">.</span><span class="ident" id="4768816">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768827">var</span>&nbsp;<span class="ident" id="4768831">s</span>&nbsp;<span class="ident" id="4768833">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4768838">p</span>&nbsp;<span class="op" id="4768840">:=</span>&nbsp;<span class="ident" id="4768843">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768849">for</span>&nbsp;<span class="builtinfunc" id="4768853">len</span><span class="op" id="4768856">(</span><span class="ident" id="4768857">p</span><span class="op" id="4768858">)</span>&nbsp;<span class="op" id="4768860">&gt;=</span>&nbsp;<span class="num" id="4768863">4</span>&nbsp;<span class="op" id="4768865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4768869">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768894">if</span>&nbsp;<span class="builtinfunc" id="4768897">len</span><span class="op" id="4768900">(</span><span class="ident" id="4768901">p</span><span class="op" id="4768902">)</span>&nbsp;<span class="op" id="4768904">&lt;</span>&nbsp;<span class="ident" id="4768906">ptrsz</span>&nbsp;<span class="op" id="4768912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4768917">return</span>&nbsp;<span class="op" id="4768924">&amp;</span><span class="ident" id="4768925">formatError</span><span class="op" id="4768936">{</span><span class="builtinfunc" id="4768937">len</span><span class="op" id="4768940">(</span><span class="ident" id="4768941">data</span><span class="op" id="4768945">)</span><span class="op" id="4768946">,</span>&nbsp;<span class="string" id="4768948">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="4768964">,</span>&nbsp;<span class="builtintype" id="4768966">nil</span><span class="op" id="4768969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4768973">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4768977">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769000">if</span>&nbsp;<span class="ident" id="4769003">ptrsz</span>&nbsp;<span class="op" id="4769009">==</span>&nbsp;<span class="num" id="4769012">8</span>&nbsp;<span class="op" id="4769014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769019">s</span><span class="op" id="4769020">.</span><span class="ident" id="4769021">value</span>&nbsp;<span class="op" id="4769027">=</span>&nbsp;<span class="ident" id="4769029">order</span><span class="op" id="4769034">.</span><span class="ident" id="4769035">Uint64</span><span class="op" id="4769041">(</span><span class="ident" id="4769042">p</span><span class="op" id="4769043">[</span><span class="num" id="4769044">0</span><span class="op" id="4769045">:</span><span class="num" id="4769046">8</span><span class="op" id="4769047">]</span><span class="op" id="4769048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769053">p</span>&nbsp;<span class="op" id="4769055">=</span>&nbsp;<span class="ident" id="4769057">p</span><span class="op" id="4769058">[</span><span class="num" id="4769059">8</span><span class="op" id="4769060">:</span><span class="op" id="4769061">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769065">}</span>&nbsp;<span class="keyword" id="4769067">else</span>&nbsp;<span class="op" id="4769072">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769077">s</span><span class="op" id="4769078">.</span><span class="ident" id="4769079">value</span>&nbsp;<span class="op" id="4769085">=</span>&nbsp;<span class="builtintype" id="4769087">uint64</span><span class="op" id="4769093">(</span><span class="ident" id="4769094">order</span><span class="op" id="4769099">.</span><span class="ident" id="4769100">Uint32</span><span class="op" id="4769106">(</span><span class="ident" id="4769107">p</span><span class="op" id="4769108">[</span><span class="num" id="4769109">0</span><span class="op" id="4769110">:</span><span class="num" id="4769111">4</span><span class="op" id="4769112">]</span><span class="op" id="4769113">)</span><span class="op" id="4769114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769119">p</span>&nbsp;<span class="op" id="4769121">=</span>&nbsp;<span class="ident" id="4769123">p</span><span class="op" id="4769124">[</span><span class="num" id="4769125">4</span><span class="op" id="4769126">:</span><span class="op" id="4769127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769136">var</span>&nbsp;<span class="ident" id="4769140">typ</span>&nbsp;<span class="builtintype" id="4769144">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769151">typ</span>&nbsp;<span class="op" id="4769155">=</span>&nbsp;<span class="ident" id="4769157">p</span><span class="op" id="4769158">[</span><span class="num" id="4769159">0</span><span class="op" id="4769160">]</span>&nbsp;<span class="op" id="4769162">&amp;</span>&nbsp;<span class="num" id="4769164">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769171">s</span><span class="op" id="4769172">.</span><span class="ident" id="4769173">typ</span>&nbsp;<span class="op" id="4769177">=</span>&nbsp;<span class="ident" id="4769179">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769185">p</span>&nbsp;<span class="op" id="4769187">=</span>&nbsp;<span class="ident" id="4769189">p</span><span class="op" id="4769190">[</span><span class="num" id="4769191">1</span><span class="op" id="4769192">:</span><span class="op" id="4769193">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4769198">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769209">var</span>&nbsp;<span class="ident" id="4769213">i</span>&nbsp;<span class="builtintype" id="4769215">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769221">var</span>&nbsp;<span class="ident" id="4769225">nnul</span>&nbsp;<span class="builtintype" id="4769230">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769236">for</span>&nbsp;<span class="ident" id="4769240">i</span>&nbsp;<span class="op" id="4769242">=</span>&nbsp;<span class="num" id="4769244">0</span><span class="op" id="4769245">;</span>&nbsp;<span class="ident" id="4769247">i</span>&nbsp;<span class="op" id="4769249">&lt;</span>&nbsp;<span class="builtinfunc" id="4769251">len</span><span class="op" id="4769254">(</span><span class="ident" id="4769255">p</span><span class="op" id="4769256">)</span><span class="op" id="4769257">;</span>&nbsp;<span class="ident" id="4769259">i</span><span class="op" id="4769260">++</span>&nbsp;<span class="op" id="4769263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769268">if</span>&nbsp;<span class="ident" id="4769271">p</span><span class="op" id="4769272">[</span><span class="ident" id="4769273">i</span><span class="op" id="4769274">]</span>&nbsp;<span class="op" id="4769276">==</span>&nbsp;<span class="num" id="4769279">0</span>&nbsp;<span class="op" id="4769281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769287">nnul</span>&nbsp;<span class="op" id="4769292">=</span>&nbsp;<span class="num" id="4769294">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769300">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769317">switch</span>&nbsp;<span class="ident" id="4769324">typ</span>&nbsp;<span class="op" id="4769328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769332">case</span>&nbsp;<span class="string" id="4769337">&#39;z&#39;</span><span class="op" id="4769340">,</span>&nbsp;<span class="string" id="4769342">&#39;Z&#39;</span><span class="op" id="4769345">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769350">p</span>&nbsp;<span class="op" id="4769352">=</span>&nbsp;<span class="ident" id="4769354">p</span><span class="op" id="4769355">[</span><span class="ident" id="4769356">i</span><span class="op" id="4769357">+</span><span class="ident" id="4769358">nnul</span><span class="op" id="4769362">:</span><span class="op" id="4769363">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769368">for</span>&nbsp;<span class="ident" id="4769372">i</span>&nbsp;<span class="op" id="4769374">=</span>&nbsp;<span class="num" id="4769376">0</span><span class="op" id="4769377">;</span>&nbsp;<span class="ident" id="4769379">i</span><span class="op" id="4769380">+</span><span class="num" id="4769381">2</span>&nbsp;<span class="op" id="4769383">&lt;=</span>&nbsp;<span class="builtinfunc" id="4769386">len</span><span class="op" id="4769389">(</span><span class="ident" id="4769390">p</span><span class="op" id="4769391">)</span><span class="op" id="4769392">;</span>&nbsp;<span class="ident" id="4769394">i</span>&nbsp;<span class="op" id="4769396">+=</span>&nbsp;<span class="num" id="4769399">2</span>&nbsp;<span class="op" id="4769401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769407">if</span>&nbsp;<span class="ident" id="4769410">p</span><span class="op" id="4769411">[</span><span class="ident" id="4769412">i</span><span class="op" id="4769413">]</span>&nbsp;<span class="op" id="4769415">==</span>&nbsp;<span class="num" id="4769418">0</span>&nbsp;<span class="op" id="4769420">&amp;&amp;</span>&nbsp;<span class="ident" id="4769423">p</span><span class="op" id="4769424">[</span><span class="ident" id="4769425">i</span><span class="op" id="4769426">+</span><span class="num" id="4769427">1</span><span class="op" id="4769428">]</span>&nbsp;<span class="op" id="4769430">==</span>&nbsp;<span class="num" id="4769433">0</span>&nbsp;<span class="op" id="4769435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769442">nnul</span>&nbsp;<span class="op" id="4769447">=</span>&nbsp;<span class="num" id="4769449">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769456">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769479">if</span>&nbsp;<span class="builtinfunc" id="4769482">len</span><span class="op" id="4769485">(</span><span class="ident" id="4769486">p</span><span class="op" id="4769487">)</span>&nbsp;<span class="op" id="4769489">&lt;</span>&nbsp;<span class="ident" id="4769491">i</span><span class="op" id="4769492">+</span><span class="ident" id="4769493">nnul</span>&nbsp;<span class="op" id="4769498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769503">return</span>&nbsp;<span class="op" id="4769510">&amp;</span><span class="ident" id="4769511">formatError</span><span class="op" id="4769522">{</span><span class="builtinfunc" id="4769523">len</span><span class="op" id="4769526">(</span><span class="ident" id="4769527">data</span><span class="op" id="4769531">)</span><span class="op" id="4769532">,</span>&nbsp;<span class="string" id="4769534">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="4769550">,</span>&nbsp;<span class="builtintype" id="4769552">nil</span><span class="op" id="4769555">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769563">s</span><span class="op" id="4769564">.</span><span class="ident" id="4769565">name</span>&nbsp;<span class="op" id="4769570">=</span>&nbsp;<span class="ident" id="4769572">p</span><span class="op" id="4769573">[</span><span class="num" id="4769574">0</span><span class="op" id="4769575">:</span><span class="ident" id="4769576">i</span><span class="op" id="4769577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769581">i</span>&nbsp;<span class="op" id="4769583">+=</span>&nbsp;<span class="ident" id="4769586">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769593">p</span>&nbsp;<span class="op" id="4769595">=</span>&nbsp;<span class="ident" id="4769597">p</span><span class="op" id="4769598">[</span><span class="ident" id="4769599">i</span><span class="op" id="4769600">:</span><span class="op" id="4769601">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769606">fn</span><span class="op" id="4769608">(</span><span class="ident" id="4769609">s</span><span class="op" id="4769610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769616">return</span>&nbsp;<span class="builtintype" id="4769623">nil</span><br>
<span class="lineno"></span><span class="op" id="4769627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4769630">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="4769679">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="4769721">func</span>&nbsp;<span class="ident" id="4769726">newTable</span><span class="op" id="4769734">(</span><span class="ident" id="4769735">symtab</span>&nbsp;<span class="op" id="4769742">[</span><span class="op" id="4769743">]</span><span class="builtintype" id="4769744">byte</span><span class="op" id="4769748">,</span>&nbsp;<span class="ident" id="4769750">ptrsz</span>&nbsp;<span class="builtintype" id="4769756">int</span><span class="op" id="4769759">)</span>&nbsp;<span class="op" id="4769761">(</span><span class="op" id="4769762">[</span><span class="op" id="4769763">]</span><span class="ident" id="4769764">Sym</span><span class="op" id="4769767">,</span>&nbsp;<span class="builtintype" id="4769769">error</span><span class="op" id="4769774">)</span>&nbsp;<span class="op" id="4769776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769779">var</span>&nbsp;<span class="ident" id="4769783">n</span>&nbsp;<span class="builtintype" id="4769785">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769790">err</span>&nbsp;<span class="op" id="4769794">:=</span>&nbsp;<span class="ident" id="4769797">walksymtab</span><span class="op" id="4769807">(</span><span class="ident" id="4769808">symtab</span><span class="op" id="4769814">,</span>&nbsp;<span class="ident" id="4769816">ptrsz</span><span class="op" id="4769821">,</span>&nbsp;<span class="keyword" id="4769823">func</span><span class="op" id="4769827">(</span><span class="ident" id="4769828">s</span>&nbsp;<span class="ident" id="4769830">sym</span><span class="op" id="4769833">)</span>&nbsp;<span class="builtintype" id="4769835">error</span>&nbsp;<span class="op" id="4769841">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769845">n</span><span class="op" id="4769846">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769851">return</span>&nbsp;<span class="builtintype" id="4769858">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769863">}</span><span class="op" id="4769864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769867">if</span>&nbsp;<span class="ident" id="4769870">err</span>&nbsp;<span class="op" id="4769874">!=</span>&nbsp;<span class="builtintype" id="4769877">nil</span>&nbsp;<span class="op" id="4769881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4769885">return</span>&nbsp;<span class="builtintype" id="4769892">nil</span><span class="op" id="4769895">,</span>&nbsp;<span class="ident" id="4769897">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4769902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769906">fname</span>&nbsp;<span class="op" id="4769912">:=</span>&nbsp;<span class="builtinfunc" id="4769915">make</span><span class="op" id="4769919">(</span><span class="keyword" id="4769920">map</span><span class="op" id="4769923">[</span><span class="builtintype" id="4769924">uint16</span><span class="op" id="4769930">]</span><span class="builtintype" id="4769931">string</span><span class="op" id="4769937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769940">syms</span>&nbsp;<span class="op" id="4769945">:=</span>&nbsp;<span class="builtinfunc" id="4769948">make</span><span class="op" id="4769952">(</span><span class="op" id="4769953">[</span><span class="op" id="4769954">]</span><span class="ident" id="4769955">Sym</span><span class="op" id="4769958">,</span>&nbsp;<span class="num" id="4769960">0</span><span class="op" id="4769961">,</span>&nbsp;<span class="ident" id="4769963">n</span><span class="op" id="4769964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4769967">err</span>&nbsp;<span class="op" id="4769971">=</span>&nbsp;<span class="ident" id="4769973">walksymtab</span><span class="op" id="4769983">(</span><span class="ident" id="4769984">symtab</span><span class="op" id="4769990">,</span>&nbsp;<span class="ident" id="4769992">ptrsz</span><span class="op" id="4769997">,</span>&nbsp;<span class="keyword" id="4769999">func</span><span class="op" id="4770003">(</span><span class="ident" id="4770004">s</span>&nbsp;<span class="ident" id="4770006">sym</span><span class="op" id="4770009">)</span>&nbsp;<span class="builtintype" id="4770011">error</span>&nbsp;<span class="op" id="4770017">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770021">n</span>&nbsp;<span class="op" id="4770023">:=</span>&nbsp;<span class="builtinfunc" id="4770026">len</span><span class="op" id="4770029">(</span><span class="ident" id="4770030">syms</span><span class="op" id="4770034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770038">syms</span>&nbsp;<span class="op" id="4770043">=</span>&nbsp;<span class="ident" id="4770045">syms</span><span class="op" id="4770049">[</span><span class="num" id="4770050">0</span>&nbsp;<span class="op" id="4770052">:</span>&nbsp;<span class="ident" id="4770054">n</span><span class="op" id="4770055">+</span><span class="num" id="4770056">1</span><span class="op" id="4770057">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770061">ts</span>&nbsp;<span class="op" id="4770064">:=</span>&nbsp;<span class="op" id="4770067">&amp;</span><span class="ident" id="4770068">syms</span><span class="op" id="4770072">[</span><span class="ident" id="4770073">n</span><span class="op" id="4770074">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770078">ts</span><span class="op" id="4770080">.</span><span class="ident" id="4770081">Type</span>&nbsp;<span class="op" id="4770086">=</span>&nbsp;<span class="builtintype" id="4770088">rune</span><span class="op" id="4770092">(</span><span class="ident" id="4770093">s</span><span class="op" id="4770094">.</span><span class="ident" id="4770095">typ</span><span class="op" id="4770098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770102">ts</span><span class="op" id="4770104">.</span><span class="ident" id="4770105">Value</span>&nbsp;<span class="op" id="4770111">=</span>&nbsp;<span class="ident" id="4770113">s</span><span class="op" id="4770114">.</span><span class="ident" id="4770115">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770123">switch</span>&nbsp;<span class="ident" id="4770130">s</span><span class="op" id="4770131">.</span><span class="ident" id="4770132">typ</span>&nbsp;<span class="op" id="4770136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770140">default</span><span class="op" id="4770147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770152">ts</span><span class="op" id="4770154">.</span><span class="ident" id="4770155">Name</span>&nbsp;<span class="op" id="4770160">=</span>&nbsp;<span class="builtintype" id="4770162">string</span><span class="op" id="4770168">(</span><span class="ident" id="4770169">s</span><span class="op" id="4770170">.</span><span class="ident" id="4770171">name</span><span class="op" id="4770175">[</span><span class="op" id="4770176">:</span><span class="op" id="4770177">]</span><span class="op" id="4770178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770182">case</span>&nbsp;<span class="string" id="4770187">&#39;z&#39;</span><span class="op" id="4770190">,</span>&nbsp;<span class="string" id="4770192">&#39;Z&#39;</span><span class="op" id="4770195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770200">for</span>&nbsp;<span class="ident" id="4770204">i</span>&nbsp;<span class="op" id="4770206">:=</span>&nbsp;<span class="num" id="4770209">0</span><span class="op" id="4770210">;</span>&nbsp;<span class="ident" id="4770212">i</span>&nbsp;<span class="op" id="4770214">&lt;</span>&nbsp;<span class="builtinfunc" id="4770216">len</span><span class="op" id="4770219">(</span><span class="ident" id="4770220">s</span><span class="op" id="4770221">.</span><span class="ident" id="4770222">name</span><span class="op" id="4770226">)</span><span class="op" id="4770227">;</span>&nbsp;<span class="ident" id="4770229">i</span>&nbsp;<span class="op" id="4770231">+=</span>&nbsp;<span class="num" id="4770234">2</span>&nbsp;<span class="op" id="4770236">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770242">eltIdx</span>&nbsp;<span class="op" id="4770249">:=</span>&nbsp;<span class="ident" id="4770252">binary</span><span class="op" id="4770258">.</span><span class="ident" id="4770259">BigEndian</span><span class="op" id="4770268">.</span><span class="ident" id="4770269">Uint16</span><span class="op" id="4770275">(</span><span class="ident" id="4770276">s</span><span class="op" id="4770277">.</span><span class="ident" id="4770278">name</span><span class="op" id="4770282">[</span><span class="ident" id="4770283">i</span>&nbsp;<span class="op" id="4770285">:</span>&nbsp;<span class="ident" id="4770287">i</span><span class="op" id="4770288">+</span><span class="num" id="4770289">2</span><span class="op" id="4770290">]</span><span class="op" id="4770291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770297">elt</span><span class="op" id="4770300">,</span>&nbsp;<span class="ident" id="4770302">ok</span>&nbsp;<span class="op" id="4770305">:=</span>&nbsp;<span class="ident" id="4770308">fname</span><span class="op" id="4770313">[</span><span class="ident" id="4770314">eltIdx</span><span class="op" id="4770320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770326">if</span>&nbsp;<span class="op" id="4770329">!</span><span class="ident" id="4770330">ok</span>&nbsp;<span class="op" id="4770333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770340">return</span>&nbsp;<span class="op" id="4770347">&amp;</span><span class="ident" id="4770348">formatError</span><span class="op" id="4770359">{</span><span class="op" id="4770360">-</span><span class="num" id="4770361">1</span><span class="op" id="4770362">,</span>&nbsp;<span class="string" id="4770364">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="4770383">,</span>&nbsp;<span class="ident" id="4770385">eltIdx</span><span class="op" id="4770391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770397">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770403">if</span>&nbsp;<span class="ident" id="4770406">n</span>&nbsp;<span class="op" id="4770408">:=</span>&nbsp;<span class="builtinfunc" id="4770411">len</span><span class="op" id="4770414">(</span><span class="ident" id="4770415">ts</span><span class="op" id="4770417">.</span><span class="ident" id="4770418">Name</span><span class="op" id="4770422">)</span><span class="op" id="4770423">;</span>&nbsp;<span class="ident" id="4770425">n</span>&nbsp;<span class="op" id="4770427">&gt;</span>&nbsp;<span class="num" id="4770429">0</span>&nbsp;<span class="op" id="4770431">&amp;&amp;</span>&nbsp;<span class="ident" id="4770434">ts</span><span class="op" id="4770436">.</span><span class="ident" id="4770437">Name</span><span class="op" id="4770441">[</span><span class="ident" id="4770442">n</span><span class="op" id="4770443">-</span><span class="num" id="4770444">1</span><span class="op" id="4770445">]</span>&nbsp;<span class="op" id="4770447">!=</span>&nbsp;<span class="string" id="4770450">&#39;/&#39;</span>&nbsp;<span class="op" id="4770454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770461">ts</span><span class="op" id="4770463">.</span><span class="ident" id="4770464">Name</span>&nbsp;<span class="op" id="4770469">+=</span>&nbsp;<span class="string" id="4770472">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770486">ts</span><span class="op" id="4770488">.</span><span class="ident" id="4770489">Name</span>&nbsp;<span class="op" id="4770494">+=</span>&nbsp;<span class="ident" id="4770497">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770504">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770512">switch</span>&nbsp;<span class="ident" id="4770519">s</span><span class="op" id="4770520">.</span><span class="ident" id="4770521">typ</span>&nbsp;<span class="op" id="4770525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770529">case</span>&nbsp;<span class="string" id="4770534">&#39;f&#39;</span><span class="op" id="4770537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770542">fname</span><span class="op" id="4770547">[</span><span class="builtintype" id="4770548">uint16</span><span class="op" id="4770554">(</span><span class="ident" id="4770555">s</span><span class="op" id="4770556">.</span><span class="ident" id="4770557">value</span><span class="op" id="4770562">)</span><span class="op" id="4770563">]</span>&nbsp;<span class="op" id="4770565">=</span>&nbsp;<span class="ident" id="4770567">ts</span><span class="op" id="4770569">.</span><span class="ident" id="4770570">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770577">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770581">return</span>&nbsp;<span class="builtintype" id="4770588">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770593">}</span><span class="op" id="4770594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770597">if</span>&nbsp;<span class="ident" id="4770600">err</span>&nbsp;<span class="op" id="4770604">!=</span>&nbsp;<span class="builtintype" id="4770607">nil</span>&nbsp;<span class="op" id="4770611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770615">return</span>&nbsp;<span class="builtintype" id="4770622">nil</span><span class="op" id="4770625">,</span>&nbsp;<span class="ident" id="4770627">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770632">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770636">return</span>&nbsp;<span class="ident" id="4770643">syms</span><span class="op" id="4770647">,</span>&nbsp;<span class="builtintype" id="4770649">nil</span><br>
<span class="lineno"></span><span class="op" id="4770653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4770656">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="4770699">func</span>&nbsp;<span class="op" id="4770704">(</span><span class="ident" id="4770705">f</span>&nbsp;<span class="op" id="4770707">*</span><span class="ident" id="4770708">File</span><span class="op" id="4770712">)</span>&nbsp;<span class="ident" id="4770714">Symbols</span><span class="op" id="4770721">(</span><span class="op" id="4770722">)</span>&nbsp;<span class="op" id="4770724">(</span><span class="op" id="4770725">[</span><span class="op" id="4770726">]</span><span class="ident" id="4770727">Sym</span><span class="op" id="4770730">,</span>&nbsp;<span class="builtintype" id="4770732">error</span><span class="op" id="4770737">)</span>&nbsp;<span class="op" id="4770739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770742">symtabSection</span>&nbsp;<span class="op" id="4770756">:=</span>&nbsp;<span class="ident" id="4770759">f</span><span class="op" id="4770760">.</span><span class="ident" id="4770761">Section</span><span class="op" id="4770768">(</span><span class="string" id="4770769">&#34;syms&#34;</span><span class="op" id="4770775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770778">if</span>&nbsp;<span class="ident" id="4770781">symtabSection</span>&nbsp;<span class="op" id="4770795">==</span>&nbsp;<span class="builtintype" id="4770798">nil</span>&nbsp;<span class="op" id="4770802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770806">return</span>&nbsp;<span class="builtintype" id="4770813">nil</span><span class="op" id="4770816">,</span>&nbsp;<span class="ident" id="4770818">errors</span><span class="op" id="4770824">.</span><span class="ident" id="4770825">New</span><span class="op" id="4770828">(</span><span class="string" id="4770829">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4770848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770851">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4770855">symtab</span><span class="op" id="4770861">,</span>&nbsp;<span class="ident" id="4770863">err</span>&nbsp;<span class="op" id="4770867">:=</span>&nbsp;<span class="ident" id="4770870">symtabSection</span><span class="op" id="4770883">.</span><span class="ident" id="4770884">Data</span><span class="op" id="4770888">(</span><span class="op" id="4770889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770892">if</span>&nbsp;<span class="ident" id="4770895">err</span>&nbsp;<span class="op" id="4770899">!=</span>&nbsp;<span class="builtintype" id="4770902">nil</span>&nbsp;<span class="op" id="4770906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770910">return</span>&nbsp;<span class="builtintype" id="4770917">nil</span><span class="op" id="4770920">,</span>&nbsp;<span class="ident" id="4770922">errors</span><span class="op" id="4770928">.</span><span class="ident" id="4770929">New</span><span class="op" id="4770932">(</span><span class="string" id="4770933">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4770961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4770964">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4770968">return</span>&nbsp;<span class="ident" id="4770975">newTable</span><span class="op" id="4770983">(</span><span class="ident" id="4770984">symtab</span><span class="op" id="4770990">,</span>&nbsp;<span class="ident" id="4770992">f</span><span class="op" id="4770993">.</span><span class="ident" id="4770994">PtrSize</span><span class="op" id="4771001">)</span><br>
<span class="lineno"></span><span class="op" id="4771003">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4771006">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="4771074">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="4771093">func</span>&nbsp;<span class="op" id="4771098">(</span><span class="ident" id="4771099">f</span>&nbsp;<span class="op" id="4771101">*</span><span class="ident" id="4771102">File</span><span class="op" id="4771106">)</span>&nbsp;<span class="ident" id="4771108">Section</span><span class="op" id="4771115">(</span><span class="ident" id="4771116">name</span>&nbsp;<span class="builtintype" id="4771121">string</span><span class="op" id="4771127">)</span>&nbsp;<span class="op" id="4771129">*</span><span class="ident" id="4771130">Section</span>&nbsp;<span class="op" id="4771138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771141">for</span>&nbsp;<span class="ident" id="4771145">_</span><span class="op" id="4771146">,</span>&nbsp;<span class="ident" id="4771148">s</span>&nbsp;<span class="op" id="4771150">:=</span>&nbsp;<span class="keyword" id="4771153">range</span>&nbsp;<span class="ident" id="4771159">f</span><span class="op" id="4771160">.</span><span class="ident" id="4771161">Sections</span>&nbsp;<span class="op" id="4771170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771174">if</span>&nbsp;<span class="ident" id="4771177">s</span><span class="op" id="4771178">.</span><span class="ident" id="4771179">Name</span>&nbsp;<span class="op" id="4771184">==</span>&nbsp;<span class="ident" id="4771187">name</span>&nbsp;<span class="op" id="4771192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771197">return</span>&nbsp;<span class="ident" id="4771204">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4771211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4771214">return</span>&nbsp;<span class="builtintype" id="4771221">nil</span><br>
<span class="lineno"></span><span class="op" id="4771225">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
