<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html" class="current">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3892261">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3892316">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3892370">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3892421">//&nbsp;+build&nbsp;amd64&nbsp;amd64p32&nbsp;arm,!nacl&nbsp;386</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3892461">package</span>&nbsp;<span class="ident" id="3892469">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3892474">func</span>&nbsp;<span class="ident" id="3892479">xorKeyStream</span><span class="op" id="3892491">(</span><span class="ident" id="3892492">dst</span><span class="op" id="3892495">,</span>&nbsp;<span class="ident" id="3892497">src</span>&nbsp;<span class="op" id="3892501">*</span><span class="builtintype" id="3892502">byte</span><span class="op" id="3892506">,</span>&nbsp;<span class="ident" id="3892508">n</span>&nbsp;<span class="builtintype" id="3892510">int</span><span class="op" id="3892513">,</span>&nbsp;<span class="ident" id="3892515">state</span>&nbsp;<span class="op" id="3892521">*</span><span class="op" id="3892522">[</span><span class="num" id="3892523">256</span><span class="op" id="3892526">]</span><span class="builtintype" id="3892527">uint32</span><span class="op" id="3892533">,</span>&nbsp;<span class="ident" id="3892535">i</span><span class="op" id="3892536">,</span>&nbsp;<span class="ident" id="3892538">j</span>&nbsp;<span class="op" id="3892540">*</span><span class="builtintype" id="3892541">uint8</span><span class="op" id="3892546">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3892549">//&nbsp;XORKeyStream&nbsp;sets&nbsp;dst&nbsp;to&nbsp;the&nbsp;result&nbsp;of&nbsp;XORing&nbsp;src&nbsp;with&nbsp;the&nbsp;key&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="3892623">//&nbsp;Dst&nbsp;and&nbsp;src&nbsp;may&nbsp;be&nbsp;the&nbsp;same&nbsp;slice&nbsp;but&nbsp;otherwise&nbsp;should&nbsp;not&nbsp;overlap.</span><br>
<span class="lineno"></span><span class="keyword" id="3892694">func</span>&nbsp;<span class="op" id="3892699">(</span><span class="ident" id="3892700">c</span>&nbsp;<span class="op" id="3892702">*</span><span class="ident" id="3892703">Cipher</span><span class="op" id="3892709">)</span>&nbsp;<span class="ident" id="3892711">XORKeyStream</span><span class="op" id="3892723">(</span><span class="ident" id="3892724">dst</span><span class="op" id="3892727">,</span>&nbsp;<span class="ident" id="3892729">src</span>&nbsp;<span class="op" id="3892733">[</span><span class="op" id="3892734">]</span><span class="builtintype" id="3892735">byte</span><span class="op" id="3892739">)</span>&nbsp;<span class="op" id="3892741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3892744">if</span>&nbsp;<span class="builtinfunc" id="3892747">len</span><span class="op" id="3892750">(</span><span class="ident" id="3892751">src</span><span class="op" id="3892754">)</span>&nbsp;<span class="op" id="3892756">==</span>&nbsp;<span class="num" id="3892759">0</span>&nbsp;<span class="op" id="3892761">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3892765">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3892773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3892776">xorKeyStream</span><span class="op" id="3892788">(</span><span class="op" id="3892789">&amp;</span><span class="ident" id="3892790">dst</span><span class="op" id="3892793">[</span><span class="num" id="3892794">0</span><span class="op" id="3892795">]</span><span class="op" id="3892796">,</span>&nbsp;<span class="op" id="3892798">&amp;</span><span class="ident" id="3892799">src</span><span class="op" id="3892802">[</span><span class="num" id="3892803">0</span><span class="op" id="3892804">]</span><span class="op" id="3892805">,</span>&nbsp;<span class="builtinfunc" id="3892807">len</span><span class="op" id="3892810">(</span><span class="ident" id="3892811">src</span><span class="op" id="3892814">)</span><span class="op" id="3892815">,</span>&nbsp;<span class="op" id="3892817">&amp;</span><span class="ident" id="3892818">c</span><span class="op" id="3892819">.</span><span class="ident" id="3892820">s</span><span class="op" id="3892821">,</span>&nbsp;<span class="op" id="3892823">&amp;</span><span class="ident" id="3892824">c</span><span class="op" id="3892825">.</span><span class="ident" id="3892826">i</span><span class="op" id="3892827">,</span>&nbsp;<span class="op" id="3892829">&amp;</span><span class="ident" id="3892830">c</span><span class="op" id="3892831">.</span><span class="ident" id="3892832">j</span><span class="op" id="3892833">)</span><br>
<span class="lineno"></span><span class="op" id="3892835">}</span>
</div>
</body>
</html>
