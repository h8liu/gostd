<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3302793">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3302849">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3302903">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3302954">package</span>&nbsp;<span class="ident" id="3302962">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3302967">import</span>&nbsp;<span class="op" id="3302974">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3302977">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3302983">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3302994">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3303003">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3303006">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3303072">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3303141">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3303155">func</span>&nbsp;<span class="ident" id="3303160">interfaceTable</span><span class="op" id="3303174">(</span><span class="ident" id="3303175">ifindex</span>&nbsp;<span class="builtintype" id="3303183">int</span><span class="op" id="3303186">)</span>&nbsp;<span class="op" id="3303188">(</span><span class="op" id="3303189">[</span><span class="op" id="3303190">]</span><span class="ident" id="3303191">Interface</span><span class="op" id="3303200">,</span>&nbsp;<span class="builtintype" id="3303202">error</span><span class="op" id="3303207">)</span>&nbsp;<span class="op" id="3303209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303212">tab</span><span class="op" id="3303215">,</span>&nbsp;<span class="ident" id="3303217">err</span>&nbsp;<span class="op" id="3303221">:=</span>&nbsp;<span class="ident" id="3303224">syscall</span><span class="op" id="3303231">.</span><span class="ident" id="3303232">NetlinkRIB</span><span class="op" id="3303242">(</span><span class="ident" id="3303243">syscall</span><span class="op" id="3303250">.</span><span class="ident" id="3303251">RTM_GETLINK</span><span class="op" id="3303262">,</span>&nbsp;<span class="ident" id="3303264">syscall</span><span class="op" id="3303271">.</span><span class="ident" id="3303272">AF_UNSPEC</span><span class="op" id="3303281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303284">if</span>&nbsp;<span class="ident" id="3303287">err</span>&nbsp;<span class="op" id="3303291">!=</span>&nbsp;<span class="ident" id="3303294">nil</span>&nbsp;<span class="op" id="3303298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303302">return</span>&nbsp;<span class="ident" id="3303309">nil</span><span class="op" id="3303312">,</span>&nbsp;<span class="ident" id="3303314">os</span><span class="op" id="3303316">.</span><span class="ident" id="3303317">NewSyscallError</span><span class="op" id="3303332">(</span><span class="string" id="3303333">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3303346">,</span>&nbsp;<span class="ident" id="3303348">err</span><span class="op" id="3303351">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303357">msgs</span><span class="op" id="3303361">,</span>&nbsp;<span class="ident" id="3303363">err</span>&nbsp;<span class="op" id="3303367">:=</span>&nbsp;<span class="ident" id="3303370">syscall</span><span class="op" id="3303377">.</span><span class="ident" id="3303378">ParseNetlinkMessage</span><span class="op" id="3303397">(</span><span class="ident" id="3303398">tab</span><span class="op" id="3303401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303404">if</span>&nbsp;<span class="ident" id="3303407">err</span>&nbsp;<span class="op" id="3303411">!=</span>&nbsp;<span class="ident" id="3303414">nil</span>&nbsp;<span class="op" id="3303418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303422">return</span>&nbsp;<span class="ident" id="3303429">nil</span><span class="op" id="3303432">,</span>&nbsp;<span class="ident" id="3303434">os</span><span class="op" id="3303436">.</span><span class="ident" id="3303437">NewSyscallError</span><span class="op" id="3303452">(</span><span class="string" id="3303453">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3303470">,</span>&nbsp;<span class="ident" id="3303472">err</span><span class="op" id="3303475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303478">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303481">var</span>&nbsp;<span class="ident" id="3303485">ift</span>&nbsp;<span class="op" id="3303489">[</span><span class="op" id="3303490">]</span><span class="ident" id="3303491">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3303501">loop</span><span class="op" id="3303505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303508">for</span>&nbsp;<span class="ident" id="3303512">_</span><span class="op" id="3303513">,</span>&nbsp;<span class="ident" id="3303515">m</span>&nbsp;<span class="op" id="3303517">:=</span>&nbsp;<span class="keyword" id="3303520">range</span>&nbsp;<span class="ident" id="3303526">msgs</span>&nbsp;<span class="op" id="3303531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303535">switch</span>&nbsp;<span class="ident" id="3303542">m</span><span class="op" id="3303543">.</span><span class="ident" id="3303544">Header</span><span class="op" id="3303550">.</span><span class="ident" id="3303551">Type</span>&nbsp;<span class="op" id="3303556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303560">case</span>&nbsp;<span class="ident" id="3303565">syscall</span><span class="op" id="3303572">.</span><span class="ident" id="3303573">NLMSG_DONE</span><span class="op" id="3303583">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303588">break</span>&nbsp;<span class="ident" id="3303594">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303601">case</span>&nbsp;<span class="ident" id="3303606">syscall</span><span class="op" id="3303613">.</span><span class="ident" id="3303614">RTM_NEWLINK</span><span class="op" id="3303625">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303630">ifim</span>&nbsp;<span class="op" id="3303635">:=</span>&nbsp;<span class="op" id="3303638">(</span><span class="op" id="3303639">*</span><span class="ident" id="3303640">syscall</span><span class="op" id="3303647">.</span><span class="ident" id="3303648">IfInfomsg</span><span class="op" id="3303657">)</span><span class="op" id="3303658">(</span><span class="ident" id="3303659">unsafe</span><span class="op" id="3303665">.</span><span class="ident" id="3303666">Pointer</span><span class="op" id="3303673">(</span><span class="op" id="3303674">&amp;</span><span class="ident" id="3303675">m</span><span class="op" id="3303676">.</span><span class="ident" id="3303677">Data</span><span class="op" id="3303681">[</span><span class="num" id="3303682">0</span><span class="op" id="3303683">]</span><span class="op" id="3303684">)</span><span class="op" id="3303685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303690">if</span>&nbsp;<span class="ident" id="3303693">ifindex</span>&nbsp;<span class="op" id="3303701">==</span>&nbsp;<span class="num" id="3303704">0</span>&nbsp;<span class="op" id="3303706">||</span>&nbsp;<span class="ident" id="3303709">ifindex</span>&nbsp;<span class="op" id="3303717">==</span>&nbsp;<span class="builtintype" id="3303720">int</span><span class="op" id="3303723">(</span><span class="ident" id="3303724">ifim</span><span class="op" id="3303728">.</span><span class="ident" id="3303729">Index</span><span class="op" id="3303734">)</span>&nbsp;<span class="op" id="3303736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303742">attrs</span><span class="op" id="3303747">,</span>&nbsp;<span class="ident" id="3303749">err</span>&nbsp;<span class="op" id="3303753">:=</span>&nbsp;<span class="ident" id="3303756">syscall</span><span class="op" id="3303763">.</span><span class="ident" id="3303764">ParseNetlinkRouteAttr</span><span class="op" id="3303785">(</span><span class="op" id="3303786">&amp;</span><span class="ident" id="3303787">m</span><span class="op" id="3303788">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303794">if</span>&nbsp;<span class="ident" id="3303797">err</span>&nbsp;<span class="op" id="3303801">!=</span>&nbsp;<span class="ident" id="3303804">nil</span>&nbsp;<span class="op" id="3303808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303815">return</span>&nbsp;<span class="ident" id="3303822">nil</span><span class="op" id="3303825">,</span>&nbsp;<span class="ident" id="3303827">os</span><span class="op" id="3303829">.</span><span class="ident" id="3303830">NewSyscallError</span><span class="op" id="3303845">(</span><span class="string" id="3303846">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3303865">,</span>&nbsp;<span class="ident" id="3303867">err</span><span class="op" id="3303870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303882">ift</span>&nbsp;<span class="op" id="3303886">=</span>&nbsp;<span class="builtinfunc" id="3303888">append</span><span class="op" id="3303894">(</span><span class="ident" id="3303895">ift</span><span class="op" id="3303898">,</span>&nbsp;<span class="op" id="3303900">*</span><span class="ident" id="3303901">newLink</span><span class="op" id="3303908">(</span><span class="ident" id="3303909">ifim</span><span class="op" id="3303913">,</span>&nbsp;<span class="ident" id="3303915">attrs</span><span class="op" id="3303920">)</span><span class="op" id="3303921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303927">if</span>&nbsp;<span class="ident" id="3303930">ifindex</span>&nbsp;<span class="op" id="3303938">==</span>&nbsp;<span class="builtintype" id="3303941">int</span><span class="op" id="3303944">(</span><span class="ident" id="3303945">ifim</span><span class="op" id="3303949">.</span><span class="ident" id="3303950">Index</span><span class="op" id="3303955">)</span>&nbsp;<span class="op" id="3303957">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303964">break</span>&nbsp;<span class="ident" id="3303970">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303991">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303994">return</span>&nbsp;<span class="ident" id="3304001">ift</span><span class="op" id="3304004">,</span>&nbsp;<span class="ident" id="3304006">nil</span><br>
<span class="lineno"></span><span class="op" id="3304010">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304013">const</span>&nbsp;<span class="op" id="3304019">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304022">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304046">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304108">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3304131">=</span>&nbsp;<span class="num" id="3304133">768</span>&nbsp;<span class="comment" id="3304137">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304166">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3304189">=</span>&nbsp;<span class="num" id="3304191">769</span>&nbsp;<span class="comment" id="3304195">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304224">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3304247">=</span>&nbsp;<span class="num" id="3304249">776</span>&nbsp;<span class="comment" id="3304253">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304282">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3304305">=</span>&nbsp;<span class="num" id="3304307">778</span>&nbsp;<span class="comment" id="3304311">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304348">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3304371">=</span>&nbsp;<span class="num" id="3304373">823</span>&nbsp;<span class="comment" id="3304377">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3304413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3304416">func</span>&nbsp;<span class="ident" id="3304421">newLink</span><span class="op" id="3304428">(</span><span class="ident" id="3304429">ifim</span>&nbsp;<span class="op" id="3304434">*</span><span class="ident" id="3304435">syscall</span><span class="op" id="3304442">.</span><span class="ident" id="3304443">IfInfomsg</span><span class="op" id="3304452">,</span>&nbsp;<span class="ident" id="3304454">attrs</span>&nbsp;<span class="op" id="3304460">[</span><span class="op" id="3304461">]</span><span class="ident" id="3304462">syscall</span><span class="op" id="3304469">.</span><span class="ident" id="3304470">NetlinkRouteAttr</span><span class="op" id="3304486">)</span>&nbsp;<span class="op" id="3304488">*</span><span class="ident" id="3304489">Interface</span>&nbsp;<span class="op" id="3304499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3304502">ifi</span>&nbsp;<span class="op" id="3304506">:=</span>&nbsp;<span class="op" id="3304509">&amp;</span><span class="ident" id="3304510">Interface</span><span class="op" id="3304519">{</span><span class="ident" id="3304520">Index</span><span class="op" id="3304525">:</span>&nbsp;<span class="builtintype" id="3304527">int</span><span class="op" id="3304530">(</span><span class="ident" id="3304531">ifim</span><span class="op" id="3304535">.</span><span class="ident" id="3304536">Index</span><span class="op" id="3304541">)</span><span class="op" id="3304542">,</span>&nbsp;<span class="ident" id="3304544">Flags</span><span class="op" id="3304549">:</span>&nbsp;<span class="ident" id="3304551">linkFlags</span><span class="op" id="3304560">(</span><span class="ident" id="3304561">ifim</span><span class="op" id="3304565">.</span><span class="ident" id="3304566">Flags</span><span class="op" id="3304571">)</span><span class="op" id="3304572">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304575">for</span>&nbsp;<span class="ident" id="3304579">_</span><span class="op" id="3304580">,</span>&nbsp;<span class="ident" id="3304582">a</span>&nbsp;<span class="op" id="3304584">:=</span>&nbsp;<span class="keyword" id="3304587">range</span>&nbsp;<span class="ident" id="3304593">attrs</span>&nbsp;<span class="op" id="3304599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304603">switch</span>&nbsp;<span class="ident" id="3304610">a</span><span class="op" id="3304611">.</span><span class="ident" id="3304612">Attr</span><span class="op" id="3304616">.</span><span class="ident" id="3304617">Type</span>&nbsp;<span class="op" id="3304622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304626">case</span>&nbsp;<span class="ident" id="3304631">syscall</span><span class="op" id="3304638">.</span><span class="ident" id="3304639">IFLA_ADDRESS</span><span class="op" id="3304651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304656">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304705">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3304752">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304776">switch</span>&nbsp;<span class="builtinfunc" id="3304783">len</span><span class="op" id="3304786">(</span><span class="ident" id="3304787">a</span><span class="op" id="3304788">.</span><span class="ident" id="3304789">Value</span><span class="op" id="3304794">)</span>&nbsp;<span class="op" id="3304796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304801">case</span>&nbsp;<span class="ident" id="3304806">IPv4len</span><span class="op" id="3304813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304819">switch</span>&nbsp;<span class="ident" id="3304826">ifim</span><span class="op" id="3304830">.</span><span class="ident" id="3304831">Type</span>&nbsp;<span class="op" id="3304836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304842">case</span>&nbsp;<span class="ident" id="3304847">sysARPHardwareIPv4IPv4</span><span class="op" id="3304869">,</span>&nbsp;<span class="ident" id="3304871">sysARPHardwareGREIPv4</span><span class="op" id="3304892">,</span>&nbsp;<span class="ident" id="3304894">sysARPHardwareIPv6IPv4</span><span class="op" id="3304916">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304923">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3304936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304941">case</span>&nbsp;<span class="ident" id="3304946">IPv6len</span><span class="op" id="3304953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304959">switch</span>&nbsp;<span class="ident" id="3304966">ifim</span><span class="op" id="3304970">.</span><span class="ident" id="3304971">Type</span>&nbsp;<span class="op" id="3304976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3304982">case</span>&nbsp;<span class="ident" id="3304987">sysARPHardwareIPv6IPv6</span><span class="op" id="3305009">,</span>&nbsp;<span class="ident" id="3305011">sysARPHardwareGREIPv6</span><span class="op" id="3305032">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305039">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305062">var</span>&nbsp;<span class="ident" id="3305066">nonzero</span>&nbsp;<span class="builtintype" id="3305074">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305082">for</span>&nbsp;<span class="ident" id="3305086">_</span><span class="op" id="3305087">,</span>&nbsp;<span class="ident" id="3305089">b</span>&nbsp;<span class="op" id="3305091">:=</span>&nbsp;<span class="keyword" id="3305094">range</span>&nbsp;<span class="ident" id="3305100">a</span><span class="op" id="3305101">.</span><span class="ident" id="3305102">Value</span>&nbsp;<span class="op" id="3305108">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305114">if</span>&nbsp;<span class="ident" id="3305117">b</span>&nbsp;<span class="op" id="3305119">!=</span>&nbsp;<span class="num" id="3305122">0</span>&nbsp;<span class="op" id="3305124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305131">nonzero</span>&nbsp;<span class="op" id="3305139">=</span>&nbsp;<span class="builtintype" id="3305141">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305151">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305166">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305171">if</span>&nbsp;<span class="ident" id="3305174">nonzero</span>&nbsp;<span class="op" id="3305182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305188">ifi</span><span class="op" id="3305191">.</span><span class="ident" id="3305192">HardwareAddr</span>&nbsp;<span class="op" id="3305205">=</span>&nbsp;<span class="ident" id="3305207">a</span><span class="op" id="3305208">.</span><span class="ident" id="3305209">Value</span><span class="op" id="3305214">[</span><span class="op" id="3305215">:</span><span class="op" id="3305216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305225">case</span>&nbsp;<span class="ident" id="3305230">syscall</span><span class="op" id="3305237">.</span><span class="ident" id="3305238">IFLA_IFNAME</span><span class="op" id="3305249">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305254">ifi</span><span class="op" id="3305257">.</span><span class="ident" id="3305258">Name</span>&nbsp;<span class="op" id="3305263">=</span>&nbsp;<span class="builtintype" id="3305265">string</span><span class="op" id="3305271">(</span><span class="ident" id="3305272">a</span><span class="op" id="3305273">.</span><span class="ident" id="3305274">Value</span><span class="op" id="3305279">[</span><span class="op" id="3305280">:</span><span class="builtinfunc" id="3305281">len</span><span class="op" id="3305284">(</span><span class="ident" id="3305285">a</span><span class="op" id="3305286">.</span><span class="ident" id="3305287">Value</span><span class="op" id="3305292">)</span><span class="op" id="3305293">-</span><span class="num" id="3305294">1</span><span class="op" id="3305295">]</span><span class="op" id="3305296">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305300">case</span>&nbsp;<span class="ident" id="3305305">syscall</span><span class="op" id="3305312">.</span><span class="ident" id="3305313">IFLA_MTU</span><span class="op" id="3305321">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305326">ifi</span><span class="op" id="3305329">.</span><span class="ident" id="3305330">MTU</span>&nbsp;<span class="op" id="3305334">=</span>&nbsp;<span class="builtintype" id="3305336">int</span><span class="op" id="3305339">(</span><span class="op" id="3305340">*</span><span class="op" id="3305341">(</span><span class="op" id="3305342">*</span><span class="builtintype" id="3305343">uint32</span><span class="op" id="3305349">)</span><span class="op" id="3305350">(</span><span class="ident" id="3305351">unsafe</span><span class="op" id="3305357">.</span><span class="ident" id="3305358">Pointer</span><span class="op" id="3305365">(</span><span class="op" id="3305366">&amp;</span><span class="ident" id="3305367">a</span><span class="op" id="3305368">.</span><span class="ident" id="3305369">Value</span><span class="op" id="3305374">[</span><span class="op" id="3305375">:</span><span class="num" id="3305376">4</span><span class="op" id="3305377">]</span><span class="op" id="3305378">[</span><span class="num" id="3305379">0</span><span class="op" id="3305380">]</span><span class="op" id="3305381">)</span><span class="op" id="3305382">)</span><span class="op" id="3305383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305393">return</span>&nbsp;<span class="ident" id="3305400">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3305404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3305407">func</span>&nbsp;<span class="ident" id="3305412">linkFlags</span><span class="op" id="3305421">(</span><span class="ident" id="3305422">rawFlags</span>&nbsp;<span class="builtintype" id="3305431">uint32</span><span class="op" id="3305437">)</span>&nbsp;<span class="ident" id="3305439">Flags</span>&nbsp;<span class="op" id="3305445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305448">var</span>&nbsp;<span class="ident" id="3305452">f</span>&nbsp;<span class="ident" id="3305454">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305461">if</span>&nbsp;<span class="ident" id="3305464">rawFlags</span><span class="op" id="3305472">&amp;</span><span class="ident" id="3305473">syscall</span><span class="op" id="3305480">.</span><span class="ident" id="3305481">IFF_UP</span>&nbsp;<span class="op" id="3305488">!=</span>&nbsp;<span class="num" id="3305491">0</span>&nbsp;<span class="op" id="3305493">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305497">f</span>&nbsp;<span class="op" id="3305499">|=</span>&nbsp;<span class="ident" id="3305502">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305513">if</span>&nbsp;<span class="ident" id="3305516">rawFlags</span><span class="op" id="3305524">&amp;</span><span class="ident" id="3305525">syscall</span><span class="op" id="3305532">.</span><span class="ident" id="3305533">IFF_BROADCAST</span>&nbsp;<span class="op" id="3305547">!=</span>&nbsp;<span class="num" id="3305550">0</span>&nbsp;<span class="op" id="3305552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305556">f</span>&nbsp;<span class="op" id="3305558">|=</span>&nbsp;<span class="ident" id="3305561">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305576">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305579">if</span>&nbsp;<span class="ident" id="3305582">rawFlags</span><span class="op" id="3305590">&amp;</span><span class="ident" id="3305591">syscall</span><span class="op" id="3305598">.</span><span class="ident" id="3305599">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3305612">!=</span>&nbsp;<span class="num" id="3305615">0</span>&nbsp;<span class="op" id="3305617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305621">f</span>&nbsp;<span class="op" id="3305623">|=</span>&nbsp;<span class="ident" id="3305626">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305643">if</span>&nbsp;<span class="ident" id="3305646">rawFlags</span><span class="op" id="3305654">&amp;</span><span class="ident" id="3305655">syscall</span><span class="op" id="3305662">.</span><span class="ident" id="3305663">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3305679">!=</span>&nbsp;<span class="num" id="3305682">0</span>&nbsp;<span class="op" id="3305684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305688">f</span>&nbsp;<span class="op" id="3305690">|=</span>&nbsp;<span class="ident" id="3305693">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305714">if</span>&nbsp;<span class="ident" id="3305717">rawFlags</span><span class="op" id="3305725">&amp;</span><span class="ident" id="3305726">syscall</span><span class="op" id="3305733">.</span><span class="ident" id="3305734">IFF_MULTICAST</span>&nbsp;<span class="op" id="3305748">!=</span>&nbsp;<span class="num" id="3305751">0</span>&nbsp;<span class="op" id="3305753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3305757">f</span>&nbsp;<span class="op" id="3305759">|=</span>&nbsp;<span class="ident" id="3305762">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3305777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3305780">return</span>&nbsp;<span class="ident" id="3305787">f</span><br>
<span class="lineno">115</span><span class="op" id="3305789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3305792">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3305859">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3305929">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3305943">func</span>&nbsp;<span class="ident" id="3305948">interfaceAddrTable</span><span class="op" id="3305966">(</span><span class="ident" id="3305967">ifi</span>&nbsp;<span class="op" id="3305971">*</span><span class="ident" id="3305972">Interface</span><span class="op" id="3305981">)</span>&nbsp;<span class="op" id="3305983">(</span><span class="op" id="3305984">[</span><span class="op" id="3305985">]</span><span class="ident" id="3305986">Addr</span><span class="op" id="3305990">,</span>&nbsp;<span class="builtintype" id="3305992">error</span><span class="op" id="3305997">)</span>&nbsp;<span class="op" id="3305999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306002">tab</span><span class="op" id="3306005">,</span>&nbsp;<span class="ident" id="3306007">err</span>&nbsp;<span class="op" id="3306011">:=</span>&nbsp;<span class="ident" id="3306014">syscall</span><span class="op" id="3306021">.</span><span class="ident" id="3306022">NetlinkRIB</span><span class="op" id="3306032">(</span><span class="ident" id="3306033">syscall</span><span class="op" id="3306040">.</span><span class="ident" id="3306041">RTM_GETADDR</span><span class="op" id="3306052">,</span>&nbsp;<span class="ident" id="3306054">syscall</span><span class="op" id="3306061">.</span><span class="ident" id="3306062">AF_UNSPEC</span><span class="op" id="3306071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306074">if</span>&nbsp;<span class="ident" id="3306077">err</span>&nbsp;<span class="op" id="3306081">!=</span>&nbsp;<span class="ident" id="3306084">nil</span>&nbsp;<span class="op" id="3306088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306092">return</span>&nbsp;<span class="ident" id="3306099">nil</span><span class="op" id="3306102">,</span>&nbsp;<span class="ident" id="3306104">os</span><span class="op" id="3306106">.</span><span class="ident" id="3306107">NewSyscallError</span><span class="op" id="3306122">(</span><span class="string" id="3306123">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3306136">,</span>&nbsp;<span class="ident" id="3306138">err</span><span class="op" id="3306141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306144">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306147">msgs</span><span class="op" id="3306151">,</span>&nbsp;<span class="ident" id="3306153">err</span>&nbsp;<span class="op" id="3306157">:=</span>&nbsp;<span class="ident" id="3306160">syscall</span><span class="op" id="3306167">.</span><span class="ident" id="3306168">ParseNetlinkMessage</span><span class="op" id="3306187">(</span><span class="ident" id="3306188">tab</span><span class="op" id="3306191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306194">if</span>&nbsp;<span class="ident" id="3306197">err</span>&nbsp;<span class="op" id="3306201">!=</span>&nbsp;<span class="ident" id="3306204">nil</span>&nbsp;<span class="op" id="3306208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306212">return</span>&nbsp;<span class="ident" id="3306219">nil</span><span class="op" id="3306222">,</span>&nbsp;<span class="ident" id="3306224">os</span><span class="op" id="3306226">.</span><span class="ident" id="3306227">NewSyscallError</span><span class="op" id="3306242">(</span><span class="string" id="3306243">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3306260">,</span>&nbsp;<span class="ident" id="3306262">err</span><span class="op" id="3306265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306271">var</span>&nbsp;<span class="ident" id="3306275">ift</span>&nbsp;<span class="op" id="3306279">[</span><span class="op" id="3306280">]</span><span class="ident" id="3306281">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306292">if</span>&nbsp;<span class="ident" id="3306295">ifi</span>&nbsp;<span class="op" id="3306299">==</span>&nbsp;<span class="ident" id="3306302">nil</span>&nbsp;<span class="op" id="3306306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306310">var</span>&nbsp;<span class="ident" id="3306314">err</span>&nbsp;<span class="builtintype" id="3306318">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306326">ift</span><span class="op" id="3306329">,</span>&nbsp;<span class="ident" id="3306331">err</span>&nbsp;<span class="op" id="3306335">=</span>&nbsp;<span class="ident" id="3306337">interfaceTable</span><span class="op" id="3306351">(</span><span class="num" id="3306352">0</span><span class="op" id="3306353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306357">if</span>&nbsp;<span class="ident" id="3306360">err</span>&nbsp;<span class="op" id="3306364">!=</span>&nbsp;<span class="ident" id="3306367">nil</span>&nbsp;<span class="op" id="3306371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306376">return</span>&nbsp;<span class="ident" id="3306383">nil</span><span class="op" id="3306386">,</span>&nbsp;<span class="ident" id="3306388">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306400">ifat</span><span class="op" id="3306404">,</span>&nbsp;<span class="ident" id="3306406">err</span>&nbsp;<span class="op" id="3306410">:=</span>&nbsp;<span class="ident" id="3306413">addrTable</span><span class="op" id="3306422">(</span><span class="ident" id="3306423">ift</span><span class="op" id="3306426">,</span>&nbsp;<span class="ident" id="3306428">ifi</span><span class="op" id="3306431">,</span>&nbsp;<span class="ident" id="3306433">msgs</span><span class="op" id="3306437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306440">if</span>&nbsp;<span class="ident" id="3306443">err</span>&nbsp;<span class="op" id="3306447">!=</span>&nbsp;<span class="ident" id="3306450">nil</span>&nbsp;<span class="op" id="3306454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306458">return</span>&nbsp;<span class="ident" id="3306465">nil</span><span class="op" id="3306468">,</span>&nbsp;<span class="ident" id="3306470">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306478">return</span>&nbsp;<span class="ident" id="3306485">ifat</span><span class="op" id="3306489">,</span>&nbsp;<span class="ident" id="3306491">nil</span><br>
<span class="lineno"></span><span class="op" id="3306495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3306498">func</span>&nbsp;<span class="ident" id="3306503">addrTable</span><span class="op" id="3306512">(</span><span class="ident" id="3306513">ift</span>&nbsp;<span class="op" id="3306517">[</span><span class="op" id="3306518">]</span><span class="ident" id="3306519">Interface</span><span class="op" id="3306528">,</span>&nbsp;<span class="ident" id="3306530">ifi</span>&nbsp;<span class="op" id="3306534">*</span><span class="ident" id="3306535">Interface</span><span class="op" id="3306544">,</span>&nbsp;<span class="ident" id="3306546">msgs</span>&nbsp;<span class="op" id="3306551">[</span><span class="op" id="3306552">]</span><span class="ident" id="3306553">syscall</span><span class="op" id="3306560">.</span><span class="ident" id="3306561">NetlinkMessage</span><span class="op" id="3306575">)</span>&nbsp;<span class="op" id="3306577">(</span><span class="op" id="3306578">[</span><span class="op" id="3306579">]</span><span class="ident" id="3306580">Addr</span><span class="op" id="3306584">,</span>&nbsp;<span class="builtintype" id="3306586">error</span><span class="op" id="3306591">)</span>&nbsp;<span class="op" id="3306593">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306596">var</span>&nbsp;<span class="ident" id="3306600">ifat</span>&nbsp;<span class="op" id="3306605">[</span><span class="op" id="3306606">]</span><span class="ident" id="3306607">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3306612">loop</span><span class="op" id="3306616">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306619">for</span>&nbsp;<span class="ident" id="3306623">_</span><span class="op" id="3306624">,</span>&nbsp;<span class="ident" id="3306626">m</span>&nbsp;<span class="op" id="3306628">:=</span>&nbsp;<span class="keyword" id="3306631">range</span>&nbsp;<span class="ident" id="3306637">msgs</span>&nbsp;<span class="op" id="3306642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306646">switch</span>&nbsp;<span class="ident" id="3306653">m</span><span class="op" id="3306654">.</span><span class="ident" id="3306655">Header</span><span class="op" id="3306661">.</span><span class="ident" id="3306662">Type</span>&nbsp;<span class="op" id="3306667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306671">case</span>&nbsp;<span class="ident" id="3306676">syscall</span><span class="op" id="3306683">.</span><span class="ident" id="3306684">NLMSG_DONE</span><span class="op" id="3306694">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306699">break</span>&nbsp;<span class="ident" id="3306705">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306712">case</span>&nbsp;<span class="ident" id="3306717">syscall</span><span class="op" id="3306724">.</span><span class="ident" id="3306725">RTM_NEWADDR</span><span class="op" id="3306736">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306741">ifam</span>&nbsp;<span class="op" id="3306746">:=</span>&nbsp;<span class="op" id="3306749">(</span><span class="op" id="3306750">*</span><span class="ident" id="3306751">syscall</span><span class="op" id="3306758">.</span><span class="ident" id="3306759">IfAddrmsg</span><span class="op" id="3306768">)</span><span class="op" id="3306769">(</span><span class="ident" id="3306770">unsafe</span><span class="op" id="3306776">.</span><span class="ident" id="3306777">Pointer</span><span class="op" id="3306784">(</span><span class="op" id="3306785">&amp;</span><span class="ident" id="3306786">m</span><span class="op" id="3306787">.</span><span class="ident" id="3306788">Data</span><span class="op" id="3306792">[</span><span class="num" id="3306793">0</span><span class="op" id="3306794">]</span><span class="op" id="3306795">)</span><span class="op" id="3306796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306801">if</span>&nbsp;<span class="builtinfunc" id="3306804">len</span><span class="op" id="3306807">(</span><span class="ident" id="3306808">ift</span><span class="op" id="3306811">)</span>&nbsp;<span class="op" id="3306813">!=</span>&nbsp;<span class="num" id="3306816">0</span>&nbsp;<span class="op" id="3306818">||</span>&nbsp;<span class="ident" id="3306821">ifi</span><span class="op" id="3306824">.</span><span class="ident" id="3306825">Index</span>&nbsp;<span class="op" id="3306831">==</span>&nbsp;<span class="builtintype" id="3306834">int</span><span class="op" id="3306837">(</span><span class="ident" id="3306838">ifam</span><span class="op" id="3306842">.</span><span class="ident" id="3306843">Index</span><span class="op" id="3306848">)</span>&nbsp;<span class="op" id="3306850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306856">if</span>&nbsp;<span class="builtinfunc" id="3306859">len</span><span class="op" id="3306862">(</span><span class="ident" id="3306863">ift</span><span class="op" id="3306866">)</span>&nbsp;<span class="op" id="3306868">!=</span>&nbsp;<span class="num" id="3306871">0</span>&nbsp;<span class="op" id="3306873">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306880">var</span>&nbsp;<span class="ident" id="3306884">err</span>&nbsp;<span class="builtintype" id="3306888">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3306899">ifi</span><span class="op" id="3306902">,</span>&nbsp;<span class="ident" id="3306904">err</span>&nbsp;<span class="op" id="3306908">=</span>&nbsp;<span class="ident" id="3306910">interfaceByIndex</span><span class="op" id="3306926">(</span><span class="ident" id="3306927">ift</span><span class="op" id="3306930">,</span>&nbsp;<span class="builtintype" id="3306932">int</span><span class="op" id="3306935">(</span><span class="ident" id="3306936">ifam</span><span class="op" id="3306940">.</span><span class="ident" id="3306941">Index</span><span class="op" id="3306946">)</span><span class="op" id="3306947">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306954">if</span>&nbsp;<span class="ident" id="3306957">err</span>&nbsp;<span class="op" id="3306961">!=</span>&nbsp;<span class="ident" id="3306964">nil</span>&nbsp;<span class="op" id="3306968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3306976">return</span>&nbsp;<span class="ident" id="3306983">nil</span><span class="op" id="3306986">,</span>&nbsp;<span class="ident" id="3306988">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3306997">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307009">attrs</span><span class="op" id="3307014">,</span>&nbsp;<span class="ident" id="3307016">err</span>&nbsp;<span class="op" id="3307020">:=</span>&nbsp;<span class="ident" id="3307023">syscall</span><span class="op" id="3307030">.</span><span class="ident" id="3307031">ParseNetlinkRouteAttr</span><span class="op" id="3307052">(</span><span class="op" id="3307053">&amp;</span><span class="ident" id="3307054">m</span><span class="op" id="3307055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307061">if</span>&nbsp;<span class="ident" id="3307064">err</span>&nbsp;<span class="op" id="3307068">!=</span>&nbsp;<span class="ident" id="3307071">nil</span>&nbsp;<span class="op" id="3307075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307082">return</span>&nbsp;<span class="ident" id="3307089">nil</span><span class="op" id="3307092">,</span>&nbsp;<span class="ident" id="3307094">os</span><span class="op" id="3307096">.</span><span class="ident" id="3307097">NewSyscallError</span><span class="op" id="3307112">(</span><span class="string" id="3307113">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3307132">,</span>&nbsp;<span class="ident" id="3307134">err</span><span class="op" id="3307137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307143">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307149">ifa</span>&nbsp;<span class="op" id="3307153">:=</span>&nbsp;<span class="ident" id="3307156">newAddr</span><span class="op" id="3307163">(</span><span class="ident" id="3307164">ifi</span><span class="op" id="3307167">,</span>&nbsp;<span class="ident" id="3307169">ifam</span><span class="op" id="3307173">,</span>&nbsp;<span class="ident" id="3307175">attrs</span><span class="op" id="3307180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307186">if</span>&nbsp;<span class="ident" id="3307189">ifa</span>&nbsp;<span class="op" id="3307193">!=</span>&nbsp;<span class="ident" id="3307196">nil</span>&nbsp;<span class="op" id="3307200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307207">ifat</span>&nbsp;<span class="op" id="3307212">=</span>&nbsp;<span class="builtinfunc" id="3307214">append</span><span class="op" id="3307220">(</span><span class="ident" id="3307221">ifat</span><span class="op" id="3307225">,</span>&nbsp;<span class="ident" id="3307227">ifa</span><span class="op" id="3307230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307241">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307251">return</span>&nbsp;<span class="ident" id="3307258">ifat</span><span class="op" id="3307262">,</span>&nbsp;<span class="ident" id="3307264">nil</span><br>
<span class="lineno"></span><span class="op" id="3307268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3307271">func</span>&nbsp;<span class="ident" id="3307276">newAddr</span><span class="op" id="3307283">(</span><span class="ident" id="3307284">ifi</span>&nbsp;<span class="op" id="3307288">*</span><span class="ident" id="3307289">Interface</span><span class="op" id="3307298">,</span>&nbsp;<span class="ident" id="3307300">ifam</span>&nbsp;<span class="op" id="3307305">*</span><span class="ident" id="3307306">syscall</span><span class="op" id="3307313">.</span><span class="ident" id="3307314">IfAddrmsg</span><span class="op" id="3307323">,</span>&nbsp;<span class="ident" id="3307325">attrs</span>&nbsp;<span class="op" id="3307331">[</span><span class="op" id="3307332">]</span><span class="ident" id="3307333">syscall</span><span class="op" id="3307340">.</span><span class="ident" id="3307341">NetlinkRouteAttr</span><span class="op" id="3307357">)</span>&nbsp;<span class="ident" id="3307359">Addr</span>&nbsp;<span class="op" id="3307364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307367">var</span>&nbsp;<span class="ident" id="3307371">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3307386">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307392">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307453">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3307516">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307571">if</span>&nbsp;<span class="ident" id="3307574">ifi</span><span class="op" id="3307577">.</span><span class="ident" id="3307578">Flags</span><span class="op" id="3307583">&amp;</span><span class="ident" id="3307584">FlagPointToPoint</span>&nbsp;<span class="op" id="3307601">!=</span>&nbsp;<span class="num" id="3307604">0</span>&nbsp;<span class="op" id="3307606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307610">for</span>&nbsp;<span class="ident" id="3307614">_</span><span class="op" id="3307615">,</span>&nbsp;<span class="ident" id="3307617">a</span>&nbsp;<span class="op" id="3307619">:=</span>&nbsp;<span class="keyword" id="3307622">range</span>&nbsp;<span class="ident" id="3307628">attrs</span>&nbsp;<span class="op" id="3307634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307639">if</span>&nbsp;<span class="ident" id="3307642">a</span><span class="op" id="3307643">.</span><span class="ident" id="3307644">Attr</span><span class="op" id="3307648">.</span><span class="ident" id="3307649">Type</span>&nbsp;<span class="op" id="3307654">==</span>&nbsp;<span class="ident" id="3307657">syscall</span><span class="op" id="3307664">.</span><span class="ident" id="3307665">IFA_LOCAL</span>&nbsp;<span class="op" id="3307675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3307681">ipPointToPoint</span>&nbsp;<span class="op" id="3307696">=</span>&nbsp;<span class="builtintype" id="3307698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307707">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307726">for</span>&nbsp;<span class="ident" id="3307730">_</span><span class="op" id="3307731">,</span>&nbsp;<span class="ident" id="3307733">a</span>&nbsp;<span class="op" id="3307735">:=</span>&nbsp;<span class="keyword" id="3307738">range</span>&nbsp;<span class="ident" id="3307744">attrs</span>&nbsp;<span class="op" id="3307750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307754">if</span>&nbsp;<span class="ident" id="3307757">ipPointToPoint</span>&nbsp;<span class="op" id="3307772">&amp;&amp;</span>&nbsp;<span class="ident" id="3307775">a</span><span class="op" id="3307776">.</span><span class="ident" id="3307777">Attr</span><span class="op" id="3307781">.</span><span class="ident" id="3307782">Type</span>&nbsp;<span class="op" id="3307787">==</span>&nbsp;<span class="ident" id="3307790">syscall</span><span class="op" id="3307797">.</span><span class="ident" id="3307798">IFA_ADDRESS</span>&nbsp;<span class="op" id="3307810">||</span>&nbsp;<span class="op" id="3307813">!</span><span class="ident" id="3307814">ipPointToPoint</span>&nbsp;<span class="op" id="3307829">&amp;&amp;</span>&nbsp;<span class="ident" id="3307832">a</span><span class="op" id="3307833">.</span><span class="ident" id="3307834">Attr</span><span class="op" id="3307838">.</span><span class="ident" id="3307839">Type</span>&nbsp;<span class="op" id="3307844">==</span>&nbsp;<span class="ident" id="3307847">syscall</span><span class="op" id="3307854">.</span><span class="ident" id="3307855">IFA_LOCAL</span>&nbsp;<span class="op" id="3307865">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3307881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307885">switch</span>&nbsp;<span class="ident" id="3307892">ifam</span><span class="op" id="3307896">.</span><span class="ident" id="3307897">Family</span>&nbsp;<span class="op" id="3307904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307908">case</span>&nbsp;<span class="ident" id="3307913">syscall</span><span class="op" id="3307920">.</span><span class="ident" id="3307921">AF_INET</span><span class="op" id="3307928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3307933">return</span>&nbsp;<span class="op" id="3307940">&amp;</span><span class="ident" id="3307941">IPNet</span><span class="op" id="3307946">{</span><span class="ident" id="3307947">IP</span><span class="op" id="3307949">:</span>&nbsp;<span class="ident" id="3307951">IPv4</span><span class="op" id="3307955">(</span><span class="ident" id="3307956">a</span><span class="op" id="3307957">.</span><span class="ident" id="3307958">Value</span><span class="op" id="3307963">[</span><span class="num" id="3307964">0</span><span class="op" id="3307965">]</span><span class="op" id="3307966">,</span>&nbsp;<span class="ident" id="3307968">a</span><span class="op" id="3307969">.</span><span class="ident" id="3307970">Value</span><span class="op" id="3307975">[</span><span class="num" id="3307976">1</span><span class="op" id="3307977">]</span><span class="op" id="3307978">,</span>&nbsp;<span class="ident" id="3307980">a</span><span class="op" id="3307981">.</span><span class="ident" id="3307982">Value</span><span class="op" id="3307987">[</span><span class="num" id="3307988">2</span><span class="op" id="3307989">]</span><span class="op" id="3307990">,</span>&nbsp;<span class="ident" id="3307992">a</span><span class="op" id="3307993">.</span><span class="ident" id="3307994">Value</span><span class="op" id="3307999">[</span><span class="num" id="3308000">3</span><span class="op" id="3308001">]</span><span class="op" id="3308002">)</span><span class="op" id="3308003">,</span>&nbsp;<span class="ident" id="3308005">Mask</span><span class="op" id="3308009">:</span>&nbsp;<span class="ident" id="3308011">CIDRMask</span><span class="op" id="3308019">(</span><span class="builtintype" id="3308020">int</span><span class="op" id="3308023">(</span><span class="ident" id="3308024">ifam</span><span class="op" id="3308028">.</span><span class="ident" id="3308029">Prefixlen</span><span class="op" id="3308038">)</span><span class="op" id="3308039">,</span>&nbsp;<span class="num" id="3308041">8</span><span class="op" id="3308042">*</span><span class="ident" id="3308043">IPv4len</span><span class="op" id="3308050">)</span><span class="op" id="3308051">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308055">case</span>&nbsp;<span class="ident" id="3308060">syscall</span><span class="op" id="3308067">.</span><span class="ident" id="3308068">AF_INET6</span><span class="op" id="3308076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308081">ifa</span>&nbsp;<span class="op" id="3308085">:=</span>&nbsp;<span class="op" id="3308088">&amp;</span><span class="ident" id="3308089">IPNet</span><span class="op" id="3308094">{</span><span class="ident" id="3308095">IP</span><span class="op" id="3308097">:</span>&nbsp;<span class="builtinfunc" id="3308099">make</span><span class="op" id="3308103">(</span><span class="ident" id="3308104">IP</span><span class="op" id="3308106">,</span>&nbsp;<span class="ident" id="3308108">IPv6len</span><span class="op" id="3308115">)</span><span class="op" id="3308116">,</span>&nbsp;<span class="ident" id="3308118">Mask</span><span class="op" id="3308122">:</span>&nbsp;<span class="ident" id="3308124">CIDRMask</span><span class="op" id="3308132">(</span><span class="builtintype" id="3308133">int</span><span class="op" id="3308136">(</span><span class="ident" id="3308137">ifam</span><span class="op" id="3308141">.</span><span class="ident" id="3308142">Prefixlen</span><span class="op" id="3308151">)</span><span class="op" id="3308152">,</span>&nbsp;<span class="num" id="3308154">8</span><span class="op" id="3308155">*</span><span class="ident" id="3308156">IPv6len</span><span class="op" id="3308163">)</span><span class="op" id="3308164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3308169">copy</span><span class="op" id="3308173">(</span><span class="ident" id="3308174">ifa</span><span class="op" id="3308177">.</span><span class="ident" id="3308178">IP</span><span class="op" id="3308180">,</span>&nbsp;<span class="ident" id="3308182">a</span><span class="op" id="3308183">.</span><span class="ident" id="3308184">Value</span><span class="op" id="3308189">[</span><span class="op" id="3308190">:</span><span class="op" id="3308191">]</span><span class="op" id="3308192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308197">return</span>&nbsp;<span class="ident" id="3308204">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308210">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308216">return</span>&nbsp;<span class="ident" id="3308223">nil</span><br>
<span class="lineno"></span><span class="op" id="3308227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3308230">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3308294">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3308308">func</span>&nbsp;<span class="ident" id="3308313">interfaceMulticastAddrTable</span><span class="op" id="3308340">(</span><span class="ident" id="3308341">ifi</span>&nbsp;<span class="op" id="3308345">*</span><span class="ident" id="3308346">Interface</span><span class="op" id="3308355">)</span>&nbsp;<span class="op" id="3308357">(</span><span class="op" id="3308358">[</span><span class="op" id="3308359">]</span><span class="ident" id="3308360">Addr</span><span class="op" id="3308364">,</span>&nbsp;<span class="builtintype" id="3308366">error</span><span class="op" id="3308371">)</span>&nbsp;<span class="op" id="3308373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308376">ifmat4</span>&nbsp;<span class="op" id="3308383">:=</span>&nbsp;<span class="ident" id="3308386">parseProcNetIGMP</span><span class="op" id="3308402">(</span><span class="string" id="3308403">&#34;/proc/net/igmp&#34;</span><span class="op" id="3308419">,</span>&nbsp;<span class="ident" id="3308421">ifi</span><span class="op" id="3308424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308427">ifmat6</span>&nbsp;<span class="op" id="3308434">:=</span>&nbsp;<span class="ident" id="3308437">parseProcNetIGMP6</span><span class="op" id="3308454">(</span><span class="string" id="3308455">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3308472">,</span>&nbsp;<span class="ident" id="3308474">ifi</span><span class="op" id="3308477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308480">return</span>&nbsp;<span class="builtinfunc" id="3308487">append</span><span class="op" id="3308493">(</span><span class="ident" id="3308494">ifmat4</span><span class="op" id="3308500">,</span>&nbsp;<span class="ident" id="3308502">ifmat6</span><span class="op" id="3308508">...</span><span class="op" id="3308511">)</span><span class="op" id="3308512">,</span>&nbsp;<span class="ident" id="3308514">nil</span><br>
<span class="lineno">210</span><span class="op" id="3308518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3308521">func</span>&nbsp;<span class="ident" id="3308526">parseProcNetIGMP</span><span class="op" id="3308542">(</span><span class="ident" id="3308543">path</span>&nbsp;<span class="builtintype" id="3308548">string</span><span class="op" id="3308554">,</span>&nbsp;<span class="ident" id="3308556">ifi</span>&nbsp;<span class="op" id="3308560">*</span><span class="ident" id="3308561">Interface</span><span class="op" id="3308570">)</span>&nbsp;<span class="op" id="3308572">[</span><span class="op" id="3308573">]</span><span class="ident" id="3308574">Addr</span>&nbsp;<span class="op" id="3308579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308582">fd</span><span class="op" id="3308584">,</span>&nbsp;<span class="ident" id="3308586">err</span>&nbsp;<span class="op" id="3308590">:=</span>&nbsp;<span class="ident" id="3308593">open</span><span class="op" id="3308597">(</span><span class="ident" id="3308598">path</span><span class="op" id="3308602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308605">if</span>&nbsp;<span class="ident" id="3308608">err</span>&nbsp;<span class="op" id="3308612">!=</span>&nbsp;<span class="ident" id="3308615">nil</span>&nbsp;<span class="op" id="3308619">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308623">return</span>&nbsp;<span class="ident" id="3308630">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308638">defer</span>&nbsp;<span class="ident" id="3308644">fd</span><span class="op" id="3308646">.</span><span class="builtinfunc" id="3308647">close</span><span class="op" id="3308652">(</span><span class="op" id="3308653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308656">var</span>&nbsp;<span class="op" id="3308660">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308664">ifmat</span>&nbsp;<span class="op" id="3308670">[</span><span class="op" id="3308671">]</span><span class="ident" id="3308672">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308679">name</span>&nbsp;&nbsp;<span class="builtintype" id="3308685">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308696">fd</span><span class="op" id="3308698">.</span><span class="ident" id="3308699">readLine</span><span class="op" id="3308707">(</span><span class="op" id="3308708">)</span>&nbsp;<span class="comment" id="3308710">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308730">b</span>&nbsp;<span class="op" id="3308732">:=</span>&nbsp;<span class="builtinfunc" id="3308735">make</span><span class="op" id="3308739">(</span><span class="op" id="3308740">[</span><span class="op" id="3308741">]</span><span class="builtintype" id="3308742">byte</span><span class="op" id="3308746">,</span>&nbsp;<span class="ident" id="3308748">IPv4len</span><span class="op" id="3308755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308758">for</span>&nbsp;<span class="ident" id="3308762">l</span><span class="op" id="3308763">,</span>&nbsp;<span class="ident" id="3308765">ok</span>&nbsp;<span class="op" id="3308768">:=</span>&nbsp;<span class="ident" id="3308771">fd</span><span class="op" id="3308773">.</span><span class="ident" id="3308774">readLine</span><span class="op" id="3308782">(</span><span class="op" id="3308783">)</span><span class="op" id="3308784">;</span>&nbsp;<span class="ident" id="3308786">ok</span><span class="op" id="3308788">;</span>&nbsp;<span class="ident" id="3308790">l</span><span class="op" id="3308791">,</span>&nbsp;<span class="ident" id="3308793">ok</span>&nbsp;<span class="op" id="3308796">=</span>&nbsp;<span class="ident" id="3308798">fd</span><span class="op" id="3308800">.</span><span class="ident" id="3308801">readLine</span><span class="op" id="3308809">(</span><span class="op" id="3308810">)</span>&nbsp;<span class="op" id="3308812">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308816">f</span>&nbsp;<span class="op" id="3308818">:=</span>&nbsp;<span class="ident" id="3308821">splitAtBytes</span><span class="op" id="3308833">(</span><span class="ident" id="3308834">l</span><span class="op" id="3308835">,</span>&nbsp;<span class="string" id="3308837">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3308847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308851">if</span>&nbsp;<span class="builtinfunc" id="3308854">len</span><span class="op" id="3308857">(</span><span class="ident" id="3308858">f</span><span class="op" id="3308859">)</span>&nbsp;<span class="op" id="3308861">&lt;</span>&nbsp;<span class="num" id="3308863">4</span>&nbsp;<span class="op" id="3308865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308870">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3308881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308885">switch</span>&nbsp;<span class="op" id="3308892">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308896">case</span>&nbsp;<span class="ident" id="3308901">l</span><span class="op" id="3308902">[</span><span class="num" id="3308903">0</span><span class="op" id="3308904">]</span>&nbsp;<span class="op" id="3308906">!=</span>&nbsp;<span class="string" id="3308909">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3308913">&amp;&amp;</span>&nbsp;<span class="ident" id="3308916">l</span><span class="op" id="3308917">[</span><span class="num" id="3308918">0</span><span class="op" id="3308919">]</span>&nbsp;<span class="op" id="3308921">!=</span>&nbsp;<span class="string" id="3308924">&#39;\t&#39;</span><span class="op" id="3308928">:</span>&nbsp;<span class="comment" id="3308930">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3308955">name</span>&nbsp;<span class="op" id="3308960">=</span>&nbsp;<span class="ident" id="3308962">f</span><span class="op" id="3308963">[</span><span class="num" id="3308964">1</span><span class="op" id="3308965">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308969">case</span>&nbsp;<span class="builtinfunc" id="3308974">len</span><span class="op" id="3308977">(</span><span class="ident" id="3308978">f</span><span class="op" id="3308979">[</span><span class="num" id="3308980">0</span><span class="op" id="3308981">]</span><span class="op" id="3308982">)</span>&nbsp;<span class="op" id="3308984">==</span>&nbsp;<span class="num" id="3308987">8</span><span class="op" id="3308988">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3308993">if</span>&nbsp;<span class="ident" id="3308996">ifi</span>&nbsp;<span class="op" id="3309000">==</span>&nbsp;<span class="ident" id="3309003">nil</span>&nbsp;<span class="op" id="3309007">||</span>&nbsp;<span class="ident" id="3309010">name</span>&nbsp;<span class="op" id="3309015">==</span>&nbsp;<span class="ident" id="3309018">ifi</span><span class="op" id="3309021">.</span><span class="ident" id="3309022">Name</span>&nbsp;<span class="op" id="3309027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309033">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309069">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3309112">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309131">for</span>&nbsp;<span class="ident" id="3309135">i</span>&nbsp;<span class="op" id="3309137">:=</span>&nbsp;<span class="num" id="3309140">0</span><span class="op" id="3309141">;</span>&nbsp;<span class="ident" id="3309143">i</span><span class="op" id="3309144">+</span><span class="num" id="3309145">1</span>&nbsp;<span class="op" id="3309147">&lt;</span>&nbsp;<span class="builtinfunc" id="3309149">len</span><span class="op" id="3309152">(</span><span class="ident" id="3309153">f</span><span class="op" id="3309154">[</span><span class="num" id="3309155">0</span><span class="op" id="3309156">]</span><span class="op" id="3309157">)</span><span class="op" id="3309158">;</span>&nbsp;<span class="ident" id="3309160">i</span>&nbsp;<span class="op" id="3309162">+=</span>&nbsp;<span class="num" id="3309165">2</span>&nbsp;<span class="op" id="3309167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309174">b</span><span class="op" id="3309175">[</span><span class="ident" id="3309176">i</span><span class="op" id="3309177">/</span><span class="num" id="3309178">2</span><span class="op" id="3309179">]</span><span class="op" id="3309180">,</span>&nbsp;<span class="ident" id="3309182">_</span>&nbsp;<span class="op" id="3309184">=</span>&nbsp;<span class="ident" id="3309186">xtoi2</span><span class="op" id="3309191">(</span><span class="ident" id="3309192">f</span><span class="op" id="3309193">[</span><span class="num" id="3309194">0</span><span class="op" id="3309195">]</span><span class="op" id="3309196">[</span><span class="ident" id="3309197">i</span><span class="op" id="3309198">:</span><span class="ident" id="3309199">i</span><span class="op" id="3309200">+</span><span class="num" id="3309201">2</span><span class="op" id="3309202">]</span><span class="op" id="3309203">,</span>&nbsp;<span class="num" id="3309205">0</span><span class="op" id="3309206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309212">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309218">i</span>&nbsp;<span class="op" id="3309220">:=</span>&nbsp;<span class="op" id="3309223">*</span><span class="op" id="3309224">(</span><span class="op" id="3309225">*</span><span class="builtintype" id="3309226">uint32</span><span class="op" id="3309232">)</span><span class="op" id="3309233">(</span><span class="ident" id="3309234">unsafe</span><span class="op" id="3309240">.</span><span class="ident" id="3309241">Pointer</span><span class="op" id="3309248">(</span><span class="op" id="3309249">&amp;</span><span class="ident" id="3309250">b</span><span class="op" id="3309251">[</span><span class="op" id="3309252">:</span><span class="num" id="3309253">4</span><span class="op" id="3309254">]</span><span class="op" id="3309255">[</span><span class="num" id="3309256">0</span><span class="op" id="3309257">]</span><span class="op" id="3309258">)</span><span class="op" id="3309259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309265">ifma</span>&nbsp;<span class="op" id="3309270">:=</span>&nbsp;<span class="ident" id="3309273">IPAddr</span><span class="op" id="3309279">{</span><span class="ident" id="3309280">IP</span><span class="op" id="3309282">:</span>&nbsp;<span class="ident" id="3309284">IPv4</span><span class="op" id="3309288">(</span><span class="builtintype" id="3309289">byte</span><span class="op" id="3309293">(</span><span class="ident" id="3309294">i</span><span class="op" id="3309295">&gt;&gt;</span><span class="num" id="3309297">24</span><span class="op" id="3309299">)</span><span class="op" id="3309300">,</span>&nbsp;<span class="builtintype" id="3309302">byte</span><span class="op" id="3309306">(</span><span class="ident" id="3309307">i</span><span class="op" id="3309308">&gt;&gt;</span><span class="num" id="3309310">16</span><span class="op" id="3309312">)</span><span class="op" id="3309313">,</span>&nbsp;<span class="builtintype" id="3309315">byte</span><span class="op" id="3309319">(</span><span class="ident" id="3309320">i</span><span class="op" id="3309321">&gt;&gt;</span><span class="num" id="3309323">8</span><span class="op" id="3309324">)</span><span class="op" id="3309325">,</span>&nbsp;<span class="builtintype" id="3309327">byte</span><span class="op" id="3309331">(</span><span class="ident" id="3309332">i</span><span class="op" id="3309333">)</span><span class="op" id="3309334">)</span><span class="op" id="3309335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309341">ifmat</span>&nbsp;<span class="op" id="3309347">=</span>&nbsp;<span class="builtinfunc" id="3309349">append</span><span class="op" id="3309355">(</span><span class="ident" id="3309356">ifmat</span><span class="op" id="3309361">,</span>&nbsp;<span class="ident" id="3309363">ifma</span><span class="op" id="3309367">.</span><span class="ident" id="3309368">toAddr</span><span class="op" id="3309374">(</span><span class="op" id="3309375">)</span><span class="op" id="3309376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309385">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309391">return</span>&nbsp;<span class="ident" id="3309398">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3309404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3309407">func</span>&nbsp;<span class="ident" id="3309412">parseProcNetIGMP6</span><span class="op" id="3309429">(</span><span class="ident" id="3309430">path</span>&nbsp;<span class="builtintype" id="3309435">string</span><span class="op" id="3309441">,</span>&nbsp;<span class="ident" id="3309443">ifi</span>&nbsp;<span class="op" id="3309447">*</span><span class="ident" id="3309448">Interface</span><span class="op" id="3309457">)</span>&nbsp;<span class="op" id="3309459">[</span><span class="op" id="3309460">]</span><span class="ident" id="3309461">Addr</span>&nbsp;<span class="op" id="3309466">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309469">fd</span><span class="op" id="3309471">,</span>&nbsp;<span class="ident" id="3309473">err</span>&nbsp;<span class="op" id="3309477">:=</span>&nbsp;<span class="ident" id="3309480">open</span><span class="op" id="3309484">(</span><span class="ident" id="3309485">path</span><span class="op" id="3309489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309492">if</span>&nbsp;<span class="ident" id="3309495">err</span>&nbsp;<span class="op" id="3309499">!=</span>&nbsp;<span class="ident" id="3309502">nil</span>&nbsp;<span class="op" id="3309506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309510">return</span>&nbsp;<span class="ident" id="3309517">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309525">defer</span>&nbsp;<span class="ident" id="3309531">fd</span><span class="op" id="3309533">.</span><span class="builtinfunc" id="3309534">close</span><span class="op" id="3309539">(</span><span class="op" id="3309540">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309543">var</span>&nbsp;<span class="ident" id="3309547">ifmat</span>&nbsp;<span class="op" id="3309553">[</span><span class="op" id="3309554">]</span><span class="ident" id="3309555">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309561">b</span>&nbsp;<span class="op" id="3309563">:=</span>&nbsp;<span class="builtinfunc" id="3309566">make</span><span class="op" id="3309570">(</span><span class="op" id="3309571">[</span><span class="op" id="3309572">]</span><span class="builtintype" id="3309573">byte</span><span class="op" id="3309577">,</span>&nbsp;<span class="ident" id="3309579">IPv6len</span><span class="op" id="3309586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309589">for</span>&nbsp;<span class="ident" id="3309593">l</span><span class="op" id="3309594">,</span>&nbsp;<span class="ident" id="3309596">ok</span>&nbsp;<span class="op" id="3309599">:=</span>&nbsp;<span class="ident" id="3309602">fd</span><span class="op" id="3309604">.</span><span class="ident" id="3309605">readLine</span><span class="op" id="3309613">(</span><span class="op" id="3309614">)</span><span class="op" id="3309615">;</span>&nbsp;<span class="ident" id="3309617">ok</span><span class="op" id="3309619">;</span>&nbsp;<span class="ident" id="3309621">l</span><span class="op" id="3309622">,</span>&nbsp;<span class="ident" id="3309624">ok</span>&nbsp;<span class="op" id="3309627">=</span>&nbsp;<span class="ident" id="3309629">fd</span><span class="op" id="3309631">.</span><span class="ident" id="3309632">readLine</span><span class="op" id="3309640">(</span><span class="op" id="3309641">)</span>&nbsp;<span class="op" id="3309643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309647">f</span>&nbsp;<span class="op" id="3309649">:=</span>&nbsp;<span class="ident" id="3309652">splitAtBytes</span><span class="op" id="3309664">(</span><span class="ident" id="3309665">l</span><span class="op" id="3309666">,</span>&nbsp;<span class="string" id="3309668">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3309677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309681">if</span>&nbsp;<span class="builtinfunc" id="3309684">len</span><span class="op" id="3309687">(</span><span class="ident" id="3309688">f</span><span class="op" id="3309689">)</span>&nbsp;<span class="op" id="3309691">&lt;</span>&nbsp;<span class="num" id="3309693">6</span>&nbsp;<span class="op" id="3309695">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309700">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309715">if</span>&nbsp;<span class="ident" id="3309718">ifi</span>&nbsp;<span class="op" id="3309722">==</span>&nbsp;<span class="ident" id="3309725">nil</span>&nbsp;<span class="op" id="3309729">||</span>&nbsp;<span class="ident" id="3309732">f</span><span class="op" id="3309733">[</span><span class="num" id="3309734">1</span><span class="op" id="3309735">]</span>&nbsp;<span class="op" id="3309737">==</span>&nbsp;<span class="ident" id="3309740">ifi</span><span class="op" id="3309743">.</span><span class="ident" id="3309744">Name</span>&nbsp;<span class="op" id="3309749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3309754">for</span>&nbsp;<span class="ident" id="3309758">i</span>&nbsp;<span class="op" id="3309760">:=</span>&nbsp;<span class="num" id="3309763">0</span><span class="op" id="3309764">;</span>&nbsp;<span class="ident" id="3309766">i</span><span class="op" id="3309767">+</span><span class="num" id="3309768">1</span>&nbsp;<span class="op" id="3309770">&lt;</span>&nbsp;<span class="builtinfunc" id="3309772">len</span><span class="op" id="3309775">(</span><span class="ident" id="3309776">f</span><span class="op" id="3309777">[</span><span class="num" id="3309778">2</span><span class="op" id="3309779">]</span><span class="op" id="3309780">)</span><span class="op" id="3309781">;</span>&nbsp;<span class="ident" id="3309783">i</span>&nbsp;<span class="op" id="3309785">+=</span>&nbsp;<span class="num" id="3309788">2</span>&nbsp;<span class="op" id="3309790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309796">b</span><span class="op" id="3309797">[</span><span class="ident" id="3309798">i</span><span class="op" id="3309799">/</span><span class="num" id="3309800">2</span><span class="op" id="3309801">]</span><span class="op" id="3309802">,</span>&nbsp;<span class="ident" id="3309804">_</span>&nbsp;<span class="op" id="3309806">=</span>&nbsp;<span class="ident" id="3309808">xtoi2</span><span class="op" id="3309813">(</span><span class="ident" id="3309814">f</span><span class="op" id="3309815">[</span><span class="num" id="3309816">2</span><span class="op" id="3309817">]</span><span class="op" id="3309818">[</span><span class="ident" id="3309819">i</span><span class="op" id="3309820">:</span><span class="ident" id="3309821">i</span><span class="op" id="3309822">+</span><span class="num" id="3309823">2</span><span class="op" id="3309824">]</span><span class="op" id="3309825">,</span>&nbsp;<span class="num" id="3309827">0</span><span class="op" id="3309828">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3309833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309838">ifma</span>&nbsp;<span class="op" id="3309843">:=</span>&nbsp;<span class="ident" id="3309846">IPAddr</span><span class="op" id="3309852">{</span><span class="ident" id="3309853">IP</span><span class="op" id="3309855">:</span>&nbsp;<span class="ident" id="3309857">IP</span><span class="op" id="3309859">{</span><span class="ident" id="3309860">b</span><span class="op" id="3309861">[</span><span class="num" id="3309862">0</span><span class="op" id="3309863">]</span><span class="op" id="3309864">,</span>&nbsp;<span class="ident" id="3309866">b</span><span class="op" id="3309867">[</span><span class="num" id="3309868">1</span><span class="op" id="3309869">]</span><span class="op" id="3309870">,</span>&nbsp;<span class="ident" id="3309872">b</span><span class="op" id="3309873">[</span><span class="num" id="3309874">2</span><span class="op" id="3309875">]</span><span class="op" id="3309876">,</span>&nbsp;<span class="ident" id="3309878">b</span><span class="op" id="3309879">[</span><span class="num" id="3309880">3</span><span class="op" id="3309881">]</span><span class="op" id="3309882">,</span>&nbsp;<span class="ident" id="3309884">b</span><span class="op" id="3309885">[</span><span class="num" id="3309886">4</span><span class="op" id="3309887">]</span><span class="op" id="3309888">,</span>&nbsp;<span class="ident" id="3309890">b</span><span class="op" id="3309891">[</span><span class="num" id="3309892">5</span><span class="op" id="3309893">]</span><span class="op" id="3309894">,</span>&nbsp;<span class="ident" id="3309896">b</span><span class="op" id="3309897">[</span><span class="num" id="3309898">6</span><span class="op" id="3309899">]</span><span class="op" id="3309900">,</span>&nbsp;<span class="ident" id="3309902">b</span><span class="op" id="3309903">[</span><span class="num" id="3309904">7</span><span class="op" id="3309905">]</span><span class="op" id="3309906">,</span>&nbsp;<span class="ident" id="3309908">b</span><span class="op" id="3309909">[</span><span class="num" id="3309910">8</span><span class="op" id="3309911">]</span><span class="op" id="3309912">,</span>&nbsp;<span class="ident" id="3309914">b</span><span class="op" id="3309915">[</span><span class="num" id="3309916">9</span><span class="op" id="3309917">]</span><span class="op" id="3309918">,</span>&nbsp;<span class="ident" id="3309920">b</span><span class="op" id="3309921">[</span><span class="num" id="3309922">10</span><span class="op" id="3309924">]</span><span class="op" id="3309925">,</span>&nbsp;<span class="ident" id="3309927">b</span><span class="op" id="3309928">[</span><span class="num" id="3309929">11</span><span class="op" id="3309931">]</span><span class="op" id="3309932">,</span>&nbsp;<span class="ident" id="3309934">b</span><span class="op" id="3309935">[</span><span class="num" id="3309936">12</span><span class="op" id="3309938">]</span><span class="op" id="3309939">,</span>&nbsp;<span class="ident" id="3309941">b</span><span class="op" id="3309942">[</span><span class="num" id="3309943">13</span><span class="op" id="3309945">]</span><span class="op" id="3309946">,</span>&nbsp;<span class="ident" id="3309948">b</span><span class="op" id="3309949">[</span><span class="num" id="3309950">14</span><span class="op" id="3309952">]</span><span class="op" id="3309953">,</span>&nbsp;<span class="ident" id="3309955">b</span><span class="op" id="3309956">[</span><span class="num" id="3309957">15</span><span class="op" id="3309959">]</span><span class="op" id="3309960">}</span><span class="op" id="3309961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3309966">ifmat</span>&nbsp;<span class="op" id="3309972">=</span>&nbsp;<span class="builtinfunc" id="3309974">append</span><span class="op" id="3309980">(</span><span class="ident" id="3309981">ifmat</span><span class="op" id="3309986">,</span>&nbsp;<span class="ident" id="3309988">ifma</span><span class="op" id="3309992">.</span><span class="ident" id="3309993">toAddr</span><span class="op" id="3309999">(</span><span class="op" id="3310000">)</span><span class="op" id="3310001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3310008">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3310011">return</span>&nbsp;<span class="ident" id="3310018">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3310024">}</span>
</div>
</body>
</html>
