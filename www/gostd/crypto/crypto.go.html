<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto</h2>
<ul>
<li><a href="/gostd/crypto/crypto.go.html" class="current">crypto.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3793673">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3793728">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3793782">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3793833">//&nbsp;Package&nbsp;crypto&nbsp;collects&nbsp;common&nbsp;cryptographic&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3793892">package</span>&nbsp;<span class="ident" id="3793900">crypto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3793908">import</span>&nbsp;<span class="op" id="3793915">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3793918">&#34;hash&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3793926">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3793932">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="3793942">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3793945">//&nbsp;Hash&nbsp;identifies&nbsp;a&nbsp;cryptographic&nbsp;hash&nbsp;function&nbsp;that&nbsp;is&nbsp;implemented&nbsp;in&nbsp;another</span><br>
<span class="lineno">15</span><span class="comment" id="3794025">//&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="3794037">type</span>&nbsp;<span class="ident" id="3794042">Hash</span>&nbsp;<span class="builtintype" id="3794047">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3794053">//&nbsp;HashFunc&nbsp;simply&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;h&nbsp;so&nbsp;that&nbsp;Hash&nbsp;implements&nbsp;SignerOpts.</span><br>
<span class="lineno"></span><span class="keyword" id="3794131">func</span>&nbsp;<span class="op" id="3794136">(</span><span class="ident" id="3794137">h</span>&nbsp;<span class="ident" id="3794139">Hash</span><span class="op" id="3794143">)</span>&nbsp;<span class="ident" id="3794145">HashFunc</span><span class="op" id="3794153">(</span><span class="op" id="3794154">)</span>&nbsp;<span class="ident" id="3794156">Hash</span>&nbsp;<span class="op" id="3794161">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794164">return</span>&nbsp;<span class="ident" id="3794171">h</span><br>
<span class="lineno"></span><span class="op" id="3794173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3794176">const</span>&nbsp;<span class="op" id="3794182">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794185">MD4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3794195">Hash</span>&nbsp;<span class="op" id="3794200">=</span>&nbsp;<span class="num" id="3794202">1</span>&nbsp;<span class="op" id="3794204">+</span>&nbsp;<span class="ident" id="3794206">iota</span>&nbsp;<span class="comment" id="3794211">//&nbsp;import&nbsp;golang.org/x/crypto/md4</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794246">MD5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794272">//&nbsp;import&nbsp;crypto/md5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794294">SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794320">//&nbsp;import&nbsp;crypto/sha1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794343">SHA224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794369">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794394">SHA256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794420">//&nbsp;import&nbsp;crypto/sha256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794445">SHA384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794471">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794496">SHA512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794522">//&nbsp;import&nbsp;crypto/sha512</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794547">MD5SHA1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794573">//&nbsp;no&nbsp;implementation;&nbsp;MD5+SHA1&nbsp;used&nbsp;for&nbsp;TLS&nbsp;RSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794622">RIPEMD160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794648">//&nbsp;import&nbsp;golang.org/x/crypto/ripemd160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794689">SHA3_224</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794715">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794751">SHA3_256</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794777">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794813">SHA3_384</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794839">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794875">SHA3_512</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3794901">//&nbsp;import&nbsp;golang.org/x/crypto/sha3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794937">maxHash</span><br>
<span class="lineno"></span><span class="op" id="3794945">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3794948">var</span>&nbsp;<span class="ident" id="3794952">digestSizes</span>&nbsp;<span class="op" id="3794964">=</span>&nbsp;<span class="op" id="3794966">[</span><span class="op" id="3794967">]</span><span class="builtintype" id="3794968">uint8</span><span class="op" id="3794973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794976">MD4</span><span class="op" id="3794979">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3794987">16</span><span class="op" id="3794989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794992">MD5</span><span class="op" id="3794995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795003">16</span><span class="op" id="3795005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795008">SHA1</span><span class="op" id="3795012">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795019">20</span><span class="op" id="3795021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795024">SHA224</span><span class="op" id="3795030">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795035">28</span><span class="op" id="3795037">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795040">SHA256</span><span class="op" id="3795046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795051">32</span><span class="op" id="3795053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795056">SHA384</span><span class="op" id="3795062">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795067">48</span><span class="op" id="3795069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795072">SHA512</span><span class="op" id="3795078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3795083">64</span><span class="op" id="3795085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795088">SHA3_224</span><span class="op" id="3795096">:</span>&nbsp;&nbsp;<span class="num" id="3795099">28</span><span class="op" id="3795101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795104">SHA3_256</span><span class="op" id="3795112">:</span>&nbsp;&nbsp;<span class="num" id="3795115">32</span><span class="op" id="3795117">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795120">SHA3_384</span><span class="op" id="3795128">:</span>&nbsp;&nbsp;<span class="num" id="3795131">48</span><span class="op" id="3795133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795136">SHA3_512</span><span class="op" id="3795144">:</span>&nbsp;&nbsp;<span class="num" id="3795147">64</span><span class="op" id="3795149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795152">MD5SHA1</span><span class="op" id="3795159">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="3795163">36</span><span class="op" id="3795165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795168">RIPEMD160</span><span class="op" id="3795177">:</span>&nbsp;<span class="num" id="3795179">20</span><span class="op" id="3795181">,</span><br>
<span class="lineno"></span><span class="op" id="3795183">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="3795186">//&nbsp;Size&nbsp;returns&nbsp;the&nbsp;length,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;a&nbsp;digest&nbsp;resulting&nbsp;from&nbsp;the&nbsp;given&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3795266">//&nbsp;function.&nbsp;It&nbsp;doesn&#39;t&nbsp;require&nbsp;that&nbsp;the&nbsp;hash&nbsp;function&nbsp;in&nbsp;question&nbsp;be&nbsp;linked</span><br>
<span class="lineno"></span><span class="comment" id="3795343">//&nbsp;into&nbsp;the&nbsp;program.</span><br>
<span class="lineno"></span><span class="keyword" id="3795364">func</span>&nbsp;<span class="op" id="3795369">(</span><span class="ident" id="3795370">h</span>&nbsp;<span class="ident" id="3795372">Hash</span><span class="op" id="3795376">)</span>&nbsp;<span class="ident" id="3795378">Size</span><span class="op" id="3795382">(</span><span class="op" id="3795383">)</span>&nbsp;<span class="builtintype" id="3795385">int</span>&nbsp;<span class="op" id="3795389">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795392">if</span>&nbsp;<span class="ident" id="3795395">h</span>&nbsp;<span class="op" id="3795397">&gt;</span>&nbsp;<span class="num" id="3795399">0</span>&nbsp;<span class="op" id="3795401">&amp;&amp;</span>&nbsp;<span class="ident" id="3795404">h</span>&nbsp;<span class="op" id="3795406">&lt;</span>&nbsp;<span class="ident" id="3795408">maxHash</span>&nbsp;<span class="op" id="3795416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795420">return</span>&nbsp;<span class="builtintype" id="3795427">int</span><span class="op" id="3795430">(</span><span class="ident" id="3795431">digestSizes</span><span class="op" id="3795442">[</span><span class="ident" id="3795443">h</span><span class="op" id="3795444">]</span><span class="op" id="3795445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3795451">panic</span><span class="op" id="3795456">(</span><span class="string" id="3795457">&#34;crypto:&nbsp;Size&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3795496">)</span><br>
<span class="lineno"></span><span class="op" id="3795498">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3795501">var</span>&nbsp;<span class="ident" id="3795505">hashes</span>&nbsp;<span class="op" id="3795512">=</span>&nbsp;<span class="builtinfunc" id="3795514">make</span><span class="op" id="3795518">(</span><span class="op" id="3795519">[</span><span class="op" id="3795520">]</span><span class="keyword" id="3795521">func</span><span class="op" id="3795525">(</span><span class="op" id="3795526">)</span>&nbsp;<span class="ident" id="3795528">hash</span><span class="op" id="3795532">.</span><span class="ident" id="3795533">Hash</span><span class="op" id="3795537">,</span>&nbsp;<span class="ident" id="3795539">maxHash</span><span class="op" id="3795546">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3795549">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;calculating&nbsp;the&nbsp;given&nbsp;hash&nbsp;function.&nbsp;New&nbsp;panics</span><br>
<span class="lineno"></span><span class="comment" id="3795628">//&nbsp;if&nbsp;the&nbsp;hash&nbsp;function&nbsp;is&nbsp;not&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno">70</span><span class="keyword" id="3795683">func</span>&nbsp;<span class="op" id="3795688">(</span><span class="ident" id="3795689">h</span>&nbsp;<span class="ident" id="3795691">Hash</span><span class="op" id="3795695">)</span>&nbsp;<span class="ident" id="3795697">New</span><span class="op" id="3795700">(</span><span class="op" id="3795701">)</span>&nbsp;<span class="ident" id="3795703">hash</span><span class="op" id="3795707">.</span><span class="ident" id="3795708">Hash</span>&nbsp;<span class="op" id="3795713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795716">if</span>&nbsp;<span class="ident" id="3795719">h</span>&nbsp;<span class="op" id="3795721">&gt;</span>&nbsp;<span class="num" id="3795723">0</span>&nbsp;<span class="op" id="3795725">&amp;&amp;</span>&nbsp;<span class="ident" id="3795728">h</span>&nbsp;<span class="op" id="3795730">&lt;</span>&nbsp;<span class="ident" id="3795732">maxHash</span>&nbsp;<span class="op" id="3795740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795744">f</span>&nbsp;<span class="op" id="3795746">:=</span>&nbsp;<span class="ident" id="3795749">hashes</span><span class="op" id="3795755">[</span><span class="ident" id="3795756">h</span><span class="op" id="3795757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795761">if</span>&nbsp;<span class="ident" id="3795764">f</span>&nbsp;<span class="op" id="3795766">!=</span>&nbsp;<span class="ident" id="3795769">nil</span>&nbsp;<span class="op" id="3795773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795778">return</span>&nbsp;<span class="ident" id="3795785">f</span><span class="op" id="3795786">(</span><span class="op" id="3795787">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3795797">panic</span><span class="op" id="3795802">(</span><span class="string" id="3795803">&#34;crypto:&nbsp;requested&nbsp;hash&nbsp;function&nbsp;#&#34;</span>&nbsp;<span class="op" id="3795839">+</span>&nbsp;<span class="ident" id="3795841">strconv</span><span class="op" id="3795848">.</span><span class="ident" id="3795849">Itoa</span><span class="op" id="3795853">(</span><span class="builtintype" id="3795854">int</span><span class="op" id="3795857">(</span><span class="ident" id="3795858">h</span><span class="op" id="3795859">)</span><span class="op" id="3795860">)</span>&nbsp;<span class="op" id="3795862">+</span>&nbsp;<span class="string" id="3795864">&#34;&nbsp;is&nbsp;unavailable&#34;</span><span class="op" id="3795881">)</span><br>
<span class="lineno"></span><span class="op" id="3795883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3795886">//&nbsp;Available&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;hash&nbsp;function&nbsp;is&nbsp;linked&nbsp;into&nbsp;the&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="3795966">func</span>&nbsp;<span class="op" id="3795971">(</span><span class="ident" id="3795972">h</span>&nbsp;<span class="ident" id="3795974">Hash</span><span class="op" id="3795978">)</span>&nbsp;<span class="ident" id="3795980">Available</span><span class="op" id="3795989">(</span><span class="op" id="3795990">)</span>&nbsp;<span class="builtintype" id="3795992">bool</span>&nbsp;<span class="op" id="3795997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796000">return</span>&nbsp;<span class="ident" id="3796007">h</span>&nbsp;<span class="op" id="3796009">&lt;</span>&nbsp;<span class="ident" id="3796011">maxHash</span>&nbsp;<span class="op" id="3796019">&amp;&amp;</span>&nbsp;<span class="ident" id="3796022">hashes</span><span class="op" id="3796028">[</span><span class="ident" id="3796029">h</span><span class="op" id="3796030">]</span>&nbsp;<span class="op" id="3796032">!=</span>&nbsp;<span class="ident" id="3796035">nil</span><br>
<span class="lineno"></span><span class="op" id="3796039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3796042">//&nbsp;RegisterHash&nbsp;registers&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;a&nbsp;new&nbsp;instance&nbsp;of&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="3796120">//&nbsp;hash&nbsp;function.&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;be&nbsp;called&nbsp;from&nbsp;the&nbsp;init&nbsp;function&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3796194">//&nbsp;packages&nbsp;that&nbsp;implement&nbsp;hash&nbsp;functions.</span><br>
<span class="lineno"></span><span class="keyword" id="3796237">func</span>&nbsp;<span class="ident" id="3796242">RegisterHash</span><span class="op" id="3796254">(</span><span class="ident" id="3796255">h</span>&nbsp;<span class="ident" id="3796257">Hash</span><span class="op" id="3796261">,</span>&nbsp;<span class="ident" id="3796263">f</span>&nbsp;<span class="keyword" id="3796265">func</span><span class="op" id="3796269">(</span><span class="op" id="3796270">)</span>&nbsp;<span class="ident" id="3796272">hash</span><span class="op" id="3796276">.</span><span class="ident" id="3796277">Hash</span><span class="op" id="3796281">)</span>&nbsp;<span class="op" id="3796283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796286">if</span>&nbsp;<span class="ident" id="3796289">h</span>&nbsp;<span class="op" id="3796291">&gt;=</span>&nbsp;<span class="ident" id="3796294">maxHash</span>&nbsp;<span class="op" id="3796302">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3796306">panic</span><span class="op" id="3796311">(</span><span class="string" id="3796312">&#34;crypto:&nbsp;RegisterHash&nbsp;of&nbsp;unknown&nbsp;hash&nbsp;function&#34;</span><span class="op" id="3796359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796365">hashes</span><span class="op" id="3796371">[</span><span class="ident" id="3796372">h</span><span class="op" id="3796373">]</span>&nbsp;<span class="op" id="3796375">=</span>&nbsp;<span class="ident" id="3796377">f</span><br>
<span class="lineno"></span><span class="op" id="3796379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="3796382">//&nbsp;PublicKey&nbsp;represents&nbsp;a&nbsp;public&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3796451">type</span>&nbsp;<span class="ident" id="3796456">PublicKey</span>&nbsp;<span class="keyword" id="3796466">interface</span><span class="op" id="3796475">{</span><span class="op" id="3796476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3796479">//&nbsp;PrivateKey&nbsp;represents&nbsp;a&nbsp;private&nbsp;key&nbsp;using&nbsp;an&nbsp;unspecified&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="3796550">type</span>&nbsp;<span class="ident" id="3796555">PrivateKey</span>&nbsp;<span class="keyword" id="3796566">interface</span><span class="op" id="3796575">{</span><span class="op" id="3796576">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3796579">//&nbsp;Signer&nbsp;is&nbsp;an&nbsp;interface&nbsp;for&nbsp;an&nbsp;opaque&nbsp;private&nbsp;key&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;for</span><br>
<span class="lineno"></span><span class="comment" id="3796652">//&nbsp;signing&nbsp;operations.&nbsp;For&nbsp;example,&nbsp;an&nbsp;RSA&nbsp;key&nbsp;kept&nbsp;in&nbsp;a&nbsp;hardware&nbsp;module.</span><br>
<span class="lineno"></span><span class="keyword" id="3796726">type</span>&nbsp;<span class="ident" id="3796731">Signer</span>&nbsp;<span class="keyword" id="3796738">interface</span>&nbsp;<span class="op" id="3796748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796751">//&nbsp;Public&nbsp;returns&nbsp;the&nbsp;public&nbsp;key&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;opaque,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796814">//&nbsp;private&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796831">Public</span><span class="op" id="3796837">(</span><span class="op" id="3796838">)</span>&nbsp;<span class="ident" id="3796840">PublicKey</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796852">//&nbsp;Sign&nbsp;signs&nbsp;msg&nbsp;with&nbsp;the&nbsp;private&nbsp;key,&nbsp;possibly&nbsp;using&nbsp;entropy&nbsp;from</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796921">//&nbsp;rand.&nbsp;For&nbsp;an&nbsp;RSA&nbsp;key,&nbsp;the&nbsp;resulting&nbsp;signature&nbsp;should&nbsp;be&nbsp;either&nbsp;a</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796990">//&nbsp;PKCS#1&nbsp;v1.5&nbsp;or&nbsp;PSS&nbsp;signature&nbsp;(as&nbsp;indicated&nbsp;by&nbsp;opts).&nbsp;For&nbsp;an&nbsp;(EC)DSA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797062">//&nbsp;key,&nbsp;it&nbsp;should&nbsp;be&nbsp;a&nbsp;DER-serialised,&nbsp;ASN.1&nbsp;signature&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797129">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797133">//&nbsp;Hash&nbsp;implements&nbsp;the&nbsp;SignerOpts&nbsp;interface&nbsp;and,&nbsp;in&nbsp;most&nbsp;cases,&nbsp;one&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797206">//&nbsp;simply&nbsp;pass&nbsp;in&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;as&nbsp;opts.&nbsp;Sign&nbsp;may&nbsp;also&nbsp;attempt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797279">//&nbsp;to&nbsp;type&nbsp;assert&nbsp;opts&nbsp;to&nbsp;other&nbsp;types&nbsp;in&nbsp;order&nbsp;to&nbsp;obtain&nbsp;algorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797347">//&nbsp;specific&nbsp;values.&nbsp;See&nbsp;the&nbsp;documentation&nbsp;in&nbsp;each&nbsp;package&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797419">Sign</span><span class="op" id="3797423">(</span><span class="ident" id="3797424">rand</span>&nbsp;<span class="ident" id="3797429">io</span><span class="op" id="3797431">.</span><span class="ident" id="3797432">Reader</span><span class="op" id="3797438">,</span>&nbsp;<span class="ident" id="3797440">msg</span>&nbsp;<span class="op" id="3797444">[</span><span class="op" id="3797445">]</span><span class="builtintype" id="3797446">byte</span><span class="op" id="3797450">,</span>&nbsp;<span class="ident" id="3797452">opts</span>&nbsp;<span class="ident" id="3797457">SignerOpts</span><span class="op" id="3797467">)</span>&nbsp;<span class="op" id="3797469">(</span><span class="ident" id="3797470">signature</span>&nbsp;<span class="op" id="3797480">[</span><span class="op" id="3797481">]</span><span class="builtintype" id="3797482">byte</span><span class="op" id="3797486">,</span>&nbsp;<span class="ident" id="3797488">err</span>&nbsp;<span class="builtintype" id="3797492">error</span><span class="op" id="3797497">)</span><br>
<span class="lineno"></span><span class="op" id="3797499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3797502">//&nbsp;SignerOpts&nbsp;contains&nbsp;options&nbsp;for&nbsp;signing&nbsp;with&nbsp;a&nbsp;Signer.</span><br>
<span class="lineno"></span><span class="keyword" id="3797560">type</span>&nbsp;<span class="ident" id="3797565">SignerOpts</span>&nbsp;<span class="keyword" id="3797576">interface</span>&nbsp;<span class="op" id="3797586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797589">//&nbsp;HashFunc&nbsp;returns&nbsp;an&nbsp;identifier&nbsp;for&nbsp;the&nbsp;hash&nbsp;function&nbsp;used&nbsp;to&nbsp;produce</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797662">//&nbsp;the&nbsp;message&nbsp;passed&nbsp;to&nbsp;Signer.Sign,&nbsp;or&nbsp;else&nbsp;zero&nbsp;to&nbsp;indicate&nbsp;that&nbsp;no</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797734">//&nbsp;hashing&nbsp;was&nbsp;done.</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797756">HashFunc</span><span class="op" id="3797764">(</span><span class="op" id="3797765">)</span>&nbsp;<span class="ident" id="3797767">Hash</span><br>
<span class="lineno"></span><span class="op" id="3797772">}</span>
</div>
</body>
</html>
