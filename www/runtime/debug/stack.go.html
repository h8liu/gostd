<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2974509">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2974564">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2974618">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2974669">//&nbsp;Package&nbsp;debug&nbsp;contains&nbsp;facilities&nbsp;for&nbsp;programs&nbsp;to&nbsp;debug&nbsp;themselves&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="2974745">//&nbsp;they&nbsp;are&nbsp;running.</span><br>
<span class="lineno"></span><span class="keyword" id="2974766">package</span>&nbsp;<span class="ident" id="2974774">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974781">import</span>&nbsp;<span class="op" id="2974788">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2974791">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2974800">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2974807">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2974820">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2974826">&#34;runtime&#34;</span><br>
<span class="lineno">15</span><span class="op" id="2974836">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2974839">var</span>&nbsp;<span class="op" id="2974843">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974846">dunno</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974856">=</span>&nbsp;<span class="op" id="2974858">[</span><span class="op" id="2974859">]</span><span class="builtintype" id="2974860">byte</span><span class="op" id="2974864">(</span><span class="string" id="2974865">&#34;???&#34;</span><span class="op" id="2974870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974873">centerDot</span>&nbsp;<span class="op" id="2974883">=</span>&nbsp;<span class="op" id="2974885">[</span><span class="op" id="2974886">]</span><span class="builtintype" id="2974887">byte</span><span class="op" id="2974891">(</span><span class="string" id="2974892">&#34;Â·&#34;</span><span class="op" id="2974896">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974899">dot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974909">=</span>&nbsp;<span class="op" id="2974911">[</span><span class="op" id="2974912">]</span><span class="builtintype" id="2974913">byte</span><span class="op" id="2974917">(</span><span class="string" id="2974918">&#34;.&#34;</span><span class="op" id="2974921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2974924">slash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2974934">=</span>&nbsp;<span class="op" id="2974936">[</span><span class="op" id="2974937">]</span><span class="builtintype" id="2974938">byte</span><span class="op" id="2974942">(</span><span class="string" id="2974943">&#34;/&#34;</span><span class="op" id="2974946">)</span><br>
<span class="lineno"></span><span class="op" id="2974948">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2974951">//&nbsp;PrintStack&nbsp;prints&nbsp;to&nbsp;standard&nbsp;error&nbsp;the&nbsp;stack&nbsp;trace&nbsp;returned&nbsp;by&nbsp;Stack.</span><br>
<span class="lineno">25</span><span class="keyword" id="2975025">func</span>&nbsp;<span class="ident" id="2975030">PrintStack</span><span class="op" id="2975040">(</span><span class="op" id="2975041">)</span>&nbsp;<span class="op" id="2975043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975046">os</span><span class="op" id="2975048">.</span><span class="ident" id="2975049">Stderr</span><span class="op" id="2975055">.</span><span class="ident" id="2975056">Write</span><span class="op" id="2975061">(</span><span class="ident" id="2975062">stack</span><span class="op" id="2975067">(</span><span class="op" id="2975068">)</span><span class="op" id="2975069">)</span><br>
<span class="lineno"></span><span class="op" id="2975071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2975074">//&nbsp;Stack&nbsp;returns&nbsp;a&nbsp;formatted&nbsp;stack&nbsp;trace&nbsp;of&nbsp;the&nbsp;goroutine&nbsp;that&nbsp;calls&nbsp;it.</span><br>
<span class="lineno">30</span><span class="comment" id="2975147">//&nbsp;For&nbsp;each&nbsp;routine,&nbsp;it&nbsp;includes&nbsp;the&nbsp;source&nbsp;line&nbsp;information&nbsp;and&nbsp;PC&nbsp;value,</span><br>
<span class="lineno"></span><span class="comment" id="2975222">//&nbsp;then&nbsp;attempts&nbsp;to&nbsp;discover,&nbsp;for&nbsp;Go&nbsp;functions,&nbsp;the&nbsp;calling&nbsp;function&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2975294">//&nbsp;method&nbsp;and&nbsp;the&nbsp;text&nbsp;of&nbsp;the&nbsp;line&nbsp;containing&nbsp;the&nbsp;invocation.</span><br>
<span class="lineno"></span><span class="comment" id="2975356">//</span><br>
<span class="lineno"></span><span class="comment" id="2975359">//&nbsp;This&nbsp;function&nbsp;is&nbsp;deprecated.&nbsp;Use&nbsp;package&nbsp;runtime&#39;s&nbsp;Stack&nbsp;instead.</span><br>
<span class="lineno">35</span><span class="keyword" id="2975428">func</span>&nbsp;<span class="ident" id="2975433">Stack</span><span class="op" id="2975438">(</span><span class="op" id="2975439">)</span>&nbsp;<span class="op" id="2975441">[</span><span class="op" id="2975442">]</span><span class="builtintype" id="2975443">byte</span>&nbsp;<span class="op" id="2975448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975451">return</span>&nbsp;<span class="ident" id="2975458">stack</span><span class="op" id="2975463">(</span><span class="op" id="2975464">)</span><br>
<span class="lineno"></span><span class="op" id="2975466">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2975469">//&nbsp;stack&nbsp;implements&nbsp;Stack,&nbsp;skipping&nbsp;2&nbsp;frames</span><br>
<span class="lineno">40</span><span class="keyword" id="2975514">func</span>&nbsp;<span class="ident" id="2975519">stack</span><span class="op" id="2975524">(</span><span class="op" id="2975525">)</span>&nbsp;<span class="op" id="2975527">[</span><span class="op" id="2975528">]</span><span class="builtintype" id="2975529">byte</span>&nbsp;<span class="op" id="2975534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975537">buf</span>&nbsp;<span class="op" id="2975541">:=</span>&nbsp;<span class="builtinfunc" id="2975544">new</span><span class="op" id="2975547">(</span><span class="ident" id="2975548">bytes</span><span class="op" id="2975553">.</span><span class="ident" id="2975554">Buffer</span><span class="op" id="2975560">)</span>&nbsp;<span class="comment" id="2975562">//&nbsp;the&nbsp;returned&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2975584">//&nbsp;As&nbsp;we&nbsp;loop,&nbsp;we&nbsp;open&nbsp;files&nbsp;and&nbsp;read&nbsp;them.&nbsp;These&nbsp;variables&nbsp;record&nbsp;the&nbsp;currently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2975666">//&nbsp;loaded&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975683">var</span>&nbsp;<span class="ident" id="2975687">lines</span>&nbsp;<span class="op" id="2975693">[</span><span class="op" id="2975694">]</span><span class="op" id="2975695">[</span><span class="op" id="2975696">]</span><span class="builtintype" id="2975697">byte</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975703">var</span>&nbsp;<span class="ident" id="2975707">lastFile</span>&nbsp;<span class="builtintype" id="2975716">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975724">for</span>&nbsp;<span class="ident" id="2975728">i</span>&nbsp;<span class="op" id="2975730">:=</span>&nbsp;<span class="num" id="2975733">2</span><span class="op" id="2975734">;</span>&nbsp;<span class="op" id="2975736">;</span>&nbsp;<span class="ident" id="2975738">i</span><span class="op" id="2975739">++</span>&nbsp;<span class="op" id="2975742">{</span>&nbsp;<span class="comment" id="2975744">//&nbsp;Caller&nbsp;we&nbsp;care&nbsp;about&nbsp;is&nbsp;the&nbsp;user,&nbsp;2&nbsp;frames&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975795">pc</span><span class="op" id="2975797">,</span>&nbsp;<span class="ident" id="2975799">file</span><span class="op" id="2975803">,</span>&nbsp;<span class="ident" id="2975805">line</span><span class="op" id="2975809">,</span>&nbsp;<span class="ident" id="2975811">ok</span>&nbsp;<span class="op" id="2975814">:=</span>&nbsp;<span class="ident" id="2975817">runtime</span><span class="op" id="2975824">.</span><span class="ident" id="2975825">Caller</span><span class="op" id="2975831">(</span><span class="ident" id="2975832">i</span><span class="op" id="2975833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975837">if</span>&nbsp;<span class="op" id="2975840">!</span><span class="ident" id="2975841">ok</span>&nbsp;<span class="op" id="2975844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975849">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2975857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2975861">//&nbsp;Print&nbsp;this&nbsp;much&nbsp;at&nbsp;least.&nbsp;&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;find&nbsp;the&nbsp;source,&nbsp;it&nbsp;won&#39;t&nbsp;show.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2975937">fmt</span><span class="op" id="2975940">.</span><span class="ident" id="2975941">Fprintf</span><span class="op" id="2975948">(</span><span class="ident" id="2975949">buf</span><span class="op" id="2975952">,</span>&nbsp;<span class="string" id="2975954">&#34;%s:%d&nbsp;(0x%x)\n&#34;</span><span class="op" id="2975970">,</span>&nbsp;<span class="ident" id="2975972">file</span><span class="op" id="2975976">,</span>&nbsp;<span class="ident" id="2975978">line</span><span class="op" id="2975982">,</span>&nbsp;<span class="ident" id="2975984">pc</span><span class="op" id="2975986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2975990">if</span>&nbsp;<span class="ident" id="2975993">file</span>&nbsp;<span class="op" id="2975998">!=</span>&nbsp;<span class="ident" id="2976001">lastFile</span>&nbsp;<span class="op" id="2976010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976015">data</span><span class="op" id="2976019">,</span>&nbsp;<span class="ident" id="2976021">err</span>&nbsp;<span class="op" id="2976025">:=</span>&nbsp;<span class="ident" id="2976028">ioutil</span><span class="op" id="2976034">.</span><span class="ident" id="2976035">ReadFile</span><span class="op" id="2976043">(</span><span class="ident" id="2976044">file</span><span class="op" id="2976048">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976053">if</span>&nbsp;<span class="ident" id="2976056">err</span>&nbsp;<span class="op" id="2976060">!=</span>&nbsp;<span class="ident" id="2976063">nil</span>&nbsp;<span class="op" id="2976067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976073">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2976085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976090">lines</span>&nbsp;<span class="op" id="2976096">=</span>&nbsp;<span class="ident" id="2976098">bytes</span><span class="op" id="2976103">.</span><span class="ident" id="2976104">Split</span><span class="op" id="2976109">(</span><span class="ident" id="2976110">data</span><span class="op" id="2976114">,</span>&nbsp;<span class="op" id="2976116">[</span><span class="op" id="2976117">]</span><span class="builtintype" id="2976118">byte</span><span class="op" id="2976122">{</span><span class="string" id="2976123">&#39;\n&#39;</span><span class="op" id="2976127">}</span><span class="op" id="2976128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976133">lastFile</span>&nbsp;<span class="op" id="2976142">=</span>&nbsp;<span class="ident" id="2976144">file</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2976151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976155">line</span><span class="op" id="2976159">--</span>&nbsp;<span class="comment" id="2976162">//&nbsp;in&nbsp;stack&nbsp;trace,&nbsp;lines&nbsp;are&nbsp;1-indexed&nbsp;but&nbsp;our&nbsp;array&nbsp;is&nbsp;0-indexed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976230">fmt</span><span class="op" id="2976233">.</span><span class="ident" id="2976234">Fprintf</span><span class="op" id="2976241">(</span><span class="ident" id="2976242">buf</span><span class="op" id="2976245">,</span>&nbsp;<span class="string" id="2976247">&#34;\t%s:&nbsp;%s\n&#34;</span><span class="op" id="2976259">,</span>&nbsp;<span class="ident" id="2976261">function</span><span class="op" id="2976269">(</span><span class="ident" id="2976270">pc</span><span class="op" id="2976272">)</span><span class="op" id="2976273">,</span>&nbsp;<span class="ident" id="2976275">source</span><span class="op" id="2976281">(</span><span class="ident" id="2976282">lines</span><span class="op" id="2976287">,</span>&nbsp;<span class="ident" id="2976289">line</span><span class="op" id="2976293">)</span><span class="op" id="2976294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2976297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976300">return</span>&nbsp;<span class="ident" id="2976307">buf</span><span class="op" id="2976310">.</span><span class="ident" id="2976311">Bytes</span><span class="op" id="2976316">(</span><span class="op" id="2976317">)</span><br>
<span class="lineno">65</span><span class="op" id="2976319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2976322">//&nbsp;source&nbsp;returns&nbsp;a&nbsp;space-trimmed&nbsp;slice&nbsp;of&nbsp;the&nbsp;n&#39;th&nbsp;line.</span><br>
<span class="lineno"></span><span class="keyword" id="2976380">func</span>&nbsp;<span class="ident" id="2976385">source</span><span class="op" id="2976391">(</span><span class="ident" id="2976392">lines</span>&nbsp;<span class="op" id="2976398">[</span><span class="op" id="2976399">]</span><span class="op" id="2976400">[</span><span class="op" id="2976401">]</span><span class="builtintype" id="2976402">byte</span><span class="op" id="2976406">,</span>&nbsp;<span class="ident" id="2976408">n</span>&nbsp;<span class="builtintype" id="2976410">int</span><span class="op" id="2976413">)</span>&nbsp;<span class="op" id="2976415">[</span><span class="op" id="2976416">]</span><span class="builtintype" id="2976417">byte</span>&nbsp;<span class="op" id="2976422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976425">if</span>&nbsp;<span class="ident" id="2976428">n</span>&nbsp;<span class="op" id="2976430">&lt;</span>&nbsp;<span class="num" id="2976432">0</span>&nbsp;<span class="op" id="2976434">||</span>&nbsp;<span class="ident" id="2976437">n</span>&nbsp;<span class="op" id="2976439">&gt;=</span>&nbsp;<span class="builtinfunc" id="2976442">len</span><span class="op" id="2976445">(</span><span class="ident" id="2976446">lines</span><span class="op" id="2976451">)</span>&nbsp;<span class="op" id="2976453">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976457">return</span>&nbsp;<span class="ident" id="2976464">dunno</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2976471">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976474">return</span>&nbsp;<span class="ident" id="2976481">bytes</span><span class="op" id="2976486">.</span><span class="ident" id="2976487">Trim</span><span class="op" id="2976491">(</span><span class="ident" id="2976492">lines</span><span class="op" id="2976497">[</span><span class="ident" id="2976498">n</span><span class="op" id="2976499">]</span><span class="op" id="2976500">,</span>&nbsp;<span class="string" id="2976502">&#34;&nbsp;\t&#34;</span><span class="op" id="2976507">)</span><br>
<span class="lineno"></span><span class="op" id="2976509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="2976512">//&nbsp;function&nbsp;returns,&nbsp;if&nbsp;possible,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;function&nbsp;containing&nbsp;the&nbsp;PC.</span><br>
<span class="lineno"></span><span class="keyword" id="2976590">func</span>&nbsp;<span class="ident" id="2976595">function</span><span class="op" id="2976603">(</span><span class="ident" id="2976604">pc</span>&nbsp;<span class="builtintype" id="2976607">uintptr</span><span class="op" id="2976614">)</span>&nbsp;<span class="op" id="2976616">[</span><span class="op" id="2976617">]</span><span class="builtintype" id="2976618">byte</span>&nbsp;<span class="op" id="2976623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976626">fn</span>&nbsp;<span class="op" id="2976629">:=</span>&nbsp;<span class="ident" id="2976632">runtime</span><span class="op" id="2976639">.</span><span class="ident" id="2976640">FuncForPC</span><span class="op" id="2976649">(</span><span class="ident" id="2976650">pc</span><span class="op" id="2976652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976655">if</span>&nbsp;<span class="ident" id="2976658">fn</span>&nbsp;<span class="op" id="2976661">==</span>&nbsp;<span class="ident" id="2976664">nil</span>&nbsp;<span class="op" id="2976668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2976672">return</span>&nbsp;<span class="ident" id="2976679">dunno</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2976686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2976689">name</span>&nbsp;<span class="op" id="2976694">:=</span>&nbsp;<span class="op" id="2976697">[</span><span class="op" id="2976698">]</span><span class="builtintype" id="2976699">byte</span><span class="op" id="2976703">(</span><span class="ident" id="2976704">fn</span><span class="op" id="2976706">.</span><span class="ident" id="2976707">Name</span><span class="op" id="2976711">(</span><span class="op" id="2976712">)</span><span class="op" id="2976713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976716">//&nbsp;The&nbsp;name&nbsp;includes&nbsp;the&nbsp;path&nbsp;name&nbsp;to&nbsp;the&nbsp;package,&nbsp;which&nbsp;is&nbsp;unnecessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976789">//&nbsp;since&nbsp;the&nbsp;file&nbsp;name&nbsp;is&nbsp;already&nbsp;included.&nbsp;&nbsp;Plus,&nbsp;it&nbsp;has&nbsp;center&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976861">//&nbsp;That&nbsp;is,&nbsp;we&nbsp;see</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976881">//&nbsp;&nbsp;&nbsp;&nbspruntime/debug.*TÂ·ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976913">//&nbsp;and&nbsp;want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976926">//&nbsp;&nbsp;&nbsp;&nbsp*T.ptrmethod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2976943">//&nbsp;Since&nbsp;the&nbsp;package&nbsp;path&nbsp;might&nbsp;contains&nbsp;dots&nbsp;(e.g.&nbsp;code.google.com/...),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2977018">//&nbsp;we&nbsp;first&nbsp;remove&nbsp;the&nbsp;path&nbsp;prefix&nbsp;if&nbsp;there&nbsp;is&nbsp;one.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977071">if</span>&nbsp;<span class="ident" id="2977074">lastslash</span>&nbsp;<span class="op" id="2977084">:=</span>&nbsp;<span class="ident" id="2977087">bytes</span><span class="op" id="2977092">.</span><span class="ident" id="2977093">LastIndex</span><span class="op" id="2977102">(</span><span class="ident" id="2977103">name</span><span class="op" id="2977107">,</span>&nbsp;<span class="ident" id="2977109">slash</span><span class="op" id="2977114">)</span><span class="op" id="2977115">;</span>&nbsp;<span class="ident" id="2977117">lastslash</span>&nbsp;<span class="op" id="2977127">&gt;=</span>&nbsp;<span class="num" id="2977130">0</span>&nbsp;<span class="op" id="2977132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977136">name</span>&nbsp;<span class="op" id="2977141">=</span>&nbsp;<span class="ident" id="2977143">name</span><span class="op" id="2977147">[</span><span class="ident" id="2977148">lastslash</span><span class="op" id="2977157">+</span><span class="num" id="2977158">1</span><span class="op" id="2977159">:</span><span class="op" id="2977160">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2977163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977166">if</span>&nbsp;<span class="ident" id="2977169">period</span>&nbsp;<span class="op" id="2977176">:=</span>&nbsp;<span class="ident" id="2977179">bytes</span><span class="op" id="2977184">.</span><span class="ident" id="2977185">Index</span><span class="op" id="2977190">(</span><span class="ident" id="2977191">name</span><span class="op" id="2977195">,</span>&nbsp;<span class="ident" id="2977197">dot</span><span class="op" id="2977200">)</span><span class="op" id="2977201">;</span>&nbsp;<span class="ident" id="2977203">period</span>&nbsp;<span class="op" id="2977210">&gt;=</span>&nbsp;<span class="num" id="2977213">0</span>&nbsp;<span class="op" id="2977215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977219">name</span>&nbsp;<span class="op" id="2977224">=</span>&nbsp;<span class="ident" id="2977226">name</span><span class="op" id="2977230">[</span><span class="ident" id="2977231">period</span><span class="op" id="2977237">+</span><span class="num" id="2977238">1</span><span class="op" id="2977239">:</span><span class="op" id="2977240">]</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2977243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2977246">name</span>&nbsp;<span class="op" id="2977251">=</span>&nbsp;<span class="ident" id="2977253">bytes</span><span class="op" id="2977258">.</span><span class="ident" id="2977259">Replace</span><span class="op" id="2977266">(</span><span class="ident" id="2977267">name</span><span class="op" id="2977271">,</span>&nbsp;<span class="ident" id="2977273">centerDot</span><span class="op" id="2977282">,</span>&nbsp;<span class="ident" id="2977284">dot</span><span class="op" id="2977287">,</span>&nbsp;<span class="op" id="2977289">-</span><span class="num" id="2977290">1</span><span class="op" id="2977291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2977294">return</span>&nbsp;<span class="ident" id="2977301">name</span><br>
<span class="lineno"></span><span class="op" id="2977306">}</span>
</div>
</body>
</html>
