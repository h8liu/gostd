<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2931757">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2931812">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2931866">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2931917">//&nbsp;Package&nbsp;filepath&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;filename&nbsp;paths</span><br>
<span class="lineno"></span><span class="comment" id="2931997">//&nbsp;in&nbsp;a&nbsp;way&nbsp;compatible&nbsp;with&nbsp;the&nbsp;target&nbsp;operating&nbsp;system-defined&nbsp;file&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="2932073">package</span>&nbsp;<span class="ident" id="2932081">filepath</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2932091">import</span>&nbsp;<span class="op" id="2932098">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2932101">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2932111">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2932117">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="2932125">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="2932135">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2932138">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="2932188">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="2932246">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="2932312">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno">20</span><span class="keyword" id="2932369">type</span>&nbsp;<span class="ident" id="2932374">lazybuf</span>&nbsp;<span class="keyword" id="2932382">struct</span>&nbsp;<span class="op" id="2932389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932392">path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2932403">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932411">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2932422">[</span><span class="op" id="2932423">]</span><span class="builtintype" id="2932424">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932430">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2932441">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932446">volAndPath</span>&nbsp;<span class="builtintype" id="2932457">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932465">volLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2932476">int</span><br>
<span class="lineno"></span><span class="op" id="2932480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2932483">func</span>&nbsp;<span class="op" id="2932488">(</span><span class="ident" id="2932489">b</span>&nbsp;<span class="op" id="2932491">*</span><span class="ident" id="2932492">lazybuf</span><span class="op" id="2932499">)</span>&nbsp;<span class="ident" id="2932501">index</span><span class="op" id="2932506">(</span><span class="ident" id="2932507">i</span>&nbsp;<span class="builtintype" id="2932509">int</span><span class="op" id="2932512">)</span>&nbsp;<span class="builtintype" id="2932514">byte</span>&nbsp;<span class="op" id="2932519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932522">if</span>&nbsp;<span class="ident" id="2932525">b</span><span class="op" id="2932526">.</span><span class="ident" id="2932527">buf</span>&nbsp;<span class="op" id="2932531">!=</span>&nbsp;<span class="ident" id="2932534">nil</span>&nbsp;<span class="op" id="2932538">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932542">return</span>&nbsp;<span class="ident" id="2932549">b</span><span class="op" id="2932550">.</span><span class="ident" id="2932551">buf</span><span class="op" id="2932554">[</span><span class="ident" id="2932555">i</span><span class="op" id="2932556">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932562">return</span>&nbsp;<span class="ident" id="2932569">b</span><span class="op" id="2932570">.</span><span class="ident" id="2932571">path</span><span class="op" id="2932575">[</span><span class="ident" id="2932576">i</span><span class="op" id="2932577">]</span><br>
<span class="lineno"></span><span class="op" id="2932579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2932582">func</span>&nbsp;<span class="op" id="2932587">(</span><span class="ident" id="2932588">b</span>&nbsp;<span class="op" id="2932590">*</span><span class="ident" id="2932591">lazybuf</span><span class="op" id="2932598">)</span>&nbsp;<span class="builtinfunc" id="2932600">append</span><span class="op" id="2932606">(</span><span class="ident" id="2932607">c</span>&nbsp;<span class="builtintype" id="2932609">byte</span><span class="op" id="2932613">)</span>&nbsp;<span class="op" id="2932615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932618">if</span>&nbsp;<span class="ident" id="2932621">b</span><span class="op" id="2932622">.</span><span class="ident" id="2932623">buf</span>&nbsp;<span class="op" id="2932627">==</span>&nbsp;<span class="ident" id="2932630">nil</span>&nbsp;<span class="op" id="2932634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932638">if</span>&nbsp;<span class="ident" id="2932641">b</span><span class="op" id="2932642">.</span><span class="ident" id="2932643">w</span>&nbsp;<span class="op" id="2932645">&lt;</span>&nbsp;<span class="builtinfunc" id="2932647">len</span><span class="op" id="2932650">(</span><span class="ident" id="2932651">b</span><span class="op" id="2932652">.</span><span class="ident" id="2932653">path</span><span class="op" id="2932657">)</span>&nbsp;<span class="op" id="2932659">&amp;&amp;</span>&nbsp;<span class="ident" id="2932662">b</span><span class="op" id="2932663">.</span><span class="ident" id="2932664">path</span><span class="op" id="2932668">[</span><span class="ident" id="2932669">b</span><span class="op" id="2932670">.</span><span class="ident" id="2932671">w</span><span class="op" id="2932672">]</span>&nbsp;<span class="op" id="2932674">==</span>&nbsp;<span class="ident" id="2932677">c</span>&nbsp;<span class="op" id="2932679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932684">b</span><span class="op" id="2932685">.</span><span class="ident" id="2932686">w</span><span class="op" id="2932687">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932693">return</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932706">b</span><span class="op" id="2932707">.</span><span class="ident" id="2932708">buf</span>&nbsp;<span class="op" id="2932712">=</span>&nbsp;<span class="builtinfunc" id="2932714">make</span><span class="op" id="2932718">(</span><span class="op" id="2932719">[</span><span class="op" id="2932720">]</span><span class="builtintype" id="2932721">byte</span><span class="op" id="2932725">,</span>&nbsp;<span class="builtinfunc" id="2932727">len</span><span class="op" id="2932730">(</span><span class="ident" id="2932731">b</span><span class="op" id="2932732">.</span><span class="ident" id="2932733">path</span><span class="op" id="2932737">)</span><span class="op" id="2932738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2932742">copy</span><span class="op" id="2932746">(</span><span class="ident" id="2932747">b</span><span class="op" id="2932748">.</span><span class="ident" id="2932749">buf</span><span class="op" id="2932752">,</span>&nbsp;<span class="ident" id="2932754">b</span><span class="op" id="2932755">.</span><span class="ident" id="2932756">path</span><span class="op" id="2932760">[</span><span class="op" id="2932761">:</span><span class="ident" id="2932762">b</span><span class="op" id="2932763">.</span><span class="ident" id="2932764">w</span><span class="op" id="2932765">]</span><span class="op" id="2932766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932772">b</span><span class="op" id="2932773">.</span><span class="ident" id="2932774">buf</span><span class="op" id="2932777">[</span><span class="ident" id="2932778">b</span><span class="op" id="2932779">.</span><span class="ident" id="2932780">w</span><span class="op" id="2932781">]</span>&nbsp;<span class="op" id="2932783">=</span>&nbsp;<span class="ident" id="2932785">c</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932788">b</span><span class="op" id="2932789">.</span><span class="ident" id="2932790">w</span><span class="op" id="2932791">++</span><br>
<span class="lineno"></span><span class="op" id="2932794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2932797">func</span>&nbsp;<span class="op" id="2932802">(</span><span class="ident" id="2932803">b</span>&nbsp;<span class="op" id="2932805">*</span><span class="ident" id="2932806">lazybuf</span><span class="op" id="2932813">)</span>&nbsp;<span class="builtintype" id="2932815">string</span><span class="op" id="2932821">(</span><span class="op" id="2932822">)</span>&nbsp;<span class="builtintype" id="2932824">string</span>&nbsp;<span class="op" id="2932831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932834">if</span>&nbsp;<span class="ident" id="2932837">b</span><span class="op" id="2932838">.</span><span class="ident" id="2932839">buf</span>&nbsp;<span class="op" id="2932843">==</span>&nbsp;<span class="ident" id="2932846">nil</span>&nbsp;<span class="op" id="2932850">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932854">return</span>&nbsp;<span class="ident" id="2932861">b</span><span class="op" id="2932862">.</span><span class="ident" id="2932863">volAndPath</span><span class="op" id="2932873">[</span><span class="op" id="2932874">:</span><span class="ident" id="2932875">b</span><span class="op" id="2932876">.</span><span class="ident" id="2932877">volLen</span><span class="op" id="2932883">+</span><span class="ident" id="2932884">b</span><span class="op" id="2932885">.</span><span class="ident" id="2932886">w</span><span class="op" id="2932887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2932890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2932893">return</span>&nbsp;<span class="ident" id="2932900">b</span><span class="op" id="2932901">.</span><span class="ident" id="2932902">volAndPath</span><span class="op" id="2932912">[</span><span class="op" id="2932913">:</span><span class="ident" id="2932914">b</span><span class="op" id="2932915">.</span><span class="ident" id="2932916">volLen</span><span class="op" id="2932922">]</span>&nbsp;<span class="op" id="2932924">+</span>&nbsp;<span class="builtintype" id="2932926">string</span><span class="op" id="2932932">(</span><span class="ident" id="2932933">b</span><span class="op" id="2932934">.</span><span class="ident" id="2932935">buf</span><span class="op" id="2932938">[</span><span class="op" id="2932939">:</span><span class="ident" id="2932940">b</span><span class="op" id="2932941">.</span><span class="ident" id="2932942">w</span><span class="op" id="2932943">]</span><span class="op" id="2932944">)</span><br>
<span class="lineno"></span><span class="op" id="2932946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="2932949">const</span>&nbsp;<span class="op" id="2932955">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932958">Separator</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2932972">=</span>&nbsp;<span class="ident" id="2932974">os</span><span class="op" id="2932976">.</span><span class="ident" id="2932977">PathSeparator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2932992">ListSeparator</span>&nbsp;<span class="op" id="2933006">=</span>&nbsp;<span class="ident" id="2933008">os</span><span class="op" id="2933010">.</span><span class="ident" id="2933011">PathListSeparator</span><br>
<span class="lineno"></span><span class="op" id="2933029">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="2933032">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="2933091">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="2933156">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="2933212">//</span><br>
<span class="lineno"></span><span class="comment" id="2933215">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;Separator&nbsp;elements&nbsp;with&nbsp;a&nbsp;single&nbsp;one.</span><br>
<span class="lineno">65</span><span class="comment" id="2933276">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="2933342">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="2933413">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2933467">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="2933521">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path,</span><br>
<span class="lineno">70</span><span class="comment" id="2933585">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;assuming&nbsp;Separator&nbsp;is&nbsp;&#39;/&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2933618">//</span><br>
<span class="lineno"></span><span class="comment" id="2933621">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;represents&nbsp;a&nbsp;root&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="2933698">//&nbsp;such&nbsp;as&nbsp;&#34;/&#34;&nbsp;on&nbsp;Unix&nbsp;or&nbsp;`C:\`&nbsp;on&nbsp;Windows.</span><br>
<span class="lineno"></span><span class="comment" id="2933742">//</span><br>
<span class="lineno">75</span><span class="comment" id="2933745">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="2933804">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2933831">//</span><br>
<span class="lineno"></span><span class="comment" id="2933834">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2933890">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno">80</span><span class="comment" id="2933918">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="2933970">func</span>&nbsp;<span class="ident" id="2933975">Clean</span><span class="op" id="2933980">(</span><span class="ident" id="2933981">path</span>&nbsp;<span class="builtintype" id="2933986">string</span><span class="op" id="2933992">)</span>&nbsp;<span class="builtintype" id="2933994">string</span>&nbsp;<span class="op" id="2934001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934004">originalPath</span>&nbsp;<span class="op" id="2934017">:=</span>&nbsp;<span class="ident" id="2934020">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934026">volLen</span>&nbsp;<span class="op" id="2934033">:=</span>&nbsp;<span class="ident" id="2934036">volumeNameLen</span><span class="op" id="2934049">(</span><span class="ident" id="2934050">path</span><span class="op" id="2934054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934057">path</span>&nbsp;<span class="op" id="2934062">=</span>&nbsp;<span class="ident" id="2934064">path</span><span class="op" id="2934068">[</span><span class="ident" id="2934069">volLen</span><span class="op" id="2934075">:</span><span class="op" id="2934076">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934079">if</span>&nbsp;<span class="ident" id="2934082">path</span>&nbsp;<span class="op" id="2934087">==</span>&nbsp;<span class="string" id="2934090">&#34;&#34;</span>&nbsp;<span class="op" id="2934093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934097">if</span>&nbsp;<span class="ident" id="2934100">volLen</span>&nbsp;<span class="op" id="2934107">&gt;</span>&nbsp;<span class="num" id="2934109">1</span>&nbsp;<span class="op" id="2934111">&amp;&amp;</span>&nbsp;<span class="ident" id="2934114">originalPath</span><span class="op" id="2934126">[</span><span class="num" id="2934127">1</span><span class="op" id="2934128">]</span>&nbsp;<span class="op" id="2934130">!=</span>&nbsp;<span class="string" id="2934133">&#39;:&#39;</span>&nbsp;<span class="op" id="2934137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934142">//&nbsp;should&nbsp;be&nbsp;UNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934162">return</span>&nbsp;<span class="ident" id="2934169">FromSlash</span><span class="op" id="2934178">(</span><span class="ident" id="2934179">originalPath</span><span class="op" id="2934191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934195">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934199">return</span>&nbsp;<span class="ident" id="2934206">originalPath</span>&nbsp;<span class="op" id="2934219">+</span>&nbsp;<span class="string" id="2934221">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934229">rooted</span>&nbsp;<span class="op" id="2934236">:=</span>&nbsp;<span class="ident" id="2934239">os</span><span class="op" id="2934241">.</span><span class="ident" id="2934242">IsPathSeparator</span><span class="op" id="2934257">(</span><span class="ident" id="2934258">path</span><span class="op" id="2934262">[</span><span class="num" id="2934263">0</span><span class="op" id="2934264">]</span><span class="op" id="2934265">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934269">//&nbsp;Invariants:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934285">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934344">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934398">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934460">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934525">n</span>&nbsp;<span class="op" id="2934527">:=</span>&nbsp;<span class="builtinfunc" id="2934530">len</span><span class="op" id="2934533">(</span><span class="ident" id="2934534">path</span><span class="op" id="2934538">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934541">out</span>&nbsp;<span class="op" id="2934545">:=</span>&nbsp;<span class="ident" id="2934548">lazybuf</span><span class="op" id="2934555">{</span><span class="ident" id="2934556">path</span><span class="op" id="2934560">:</span>&nbsp;<span class="ident" id="2934562">path</span><span class="op" id="2934566">,</span>&nbsp;<span class="ident" id="2934568">volAndPath</span><span class="op" id="2934578">:</span>&nbsp;<span class="ident" id="2934580">originalPath</span><span class="op" id="2934592">,</span>&nbsp;<span class="ident" id="2934594">volLen</span><span class="op" id="2934600">:</span>&nbsp;<span class="ident" id="2934602">volLen</span><span class="op" id="2934608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934611">r</span><span class="op" id="2934612">,</span>&nbsp;<span class="ident" id="2934614">dotdot</span>&nbsp;<span class="op" id="2934621">:=</span>&nbsp;<span class="num" id="2934624">0</span><span class="op" id="2934625">,</span>&nbsp;<span class="num" id="2934627">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934630">if</span>&nbsp;<span class="ident" id="2934633">rooted</span>&nbsp;<span class="op" id="2934640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934644">out</span><span class="op" id="2934647">.</span><span class="builtinfunc" id="2934648">append</span><span class="op" id="2934654">(</span><span class="ident" id="2934655">Separator</span><span class="op" id="2934664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934668">r</span><span class="op" id="2934669">,</span>&nbsp;<span class="ident" id="2934671">dotdot</span>&nbsp;<span class="op" id="2934678">=</span>&nbsp;<span class="num" id="2934680">1</span><span class="op" id="2934681">,</span>&nbsp;<span class="num" id="2934683">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2934686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934690">for</span>&nbsp;<span class="ident" id="2934694">r</span>&nbsp;<span class="op" id="2934696">&lt;</span>&nbsp;<span class="ident" id="2934698">n</span>&nbsp;<span class="op" id="2934700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934704">switch</span>&nbsp;<span class="op" id="2934711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934715">case</span>&nbsp;<span class="ident" id="2934720">os</span><span class="op" id="2934722">.</span><span class="ident" id="2934723">IsPathSeparator</span><span class="op" id="2934738">(</span><span class="ident" id="2934739">path</span><span class="op" id="2934743">[</span><span class="ident" id="2934744">r</span><span class="op" id="2934745">]</span><span class="op" id="2934746">)</span><span class="op" id="2934747">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934752">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934777">r</span><span class="op" id="2934778">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934783">case</span>&nbsp;<span class="ident" id="2934788">path</span><span class="op" id="2934792">[</span><span class="ident" id="2934793">r</span><span class="op" id="2934794">]</span>&nbsp;<span class="op" id="2934796">==</span>&nbsp;<span class="string" id="2934799">&#39;.&#39;</span>&nbsp;<span class="op" id="2934803">&amp;&amp;</span>&nbsp;<span class="op" id="2934806">(</span><span class="ident" id="2934807">r</span><span class="op" id="2934808">+</span><span class="num" id="2934809">1</span>&nbsp;<span class="op" id="2934811">==</span>&nbsp;<span class="ident" id="2934814">n</span>&nbsp;<span class="op" id="2934816">||</span>&nbsp;<span class="ident" id="2934819">os</span><span class="op" id="2934821">.</span><span class="ident" id="2934822">IsPathSeparator</span><span class="op" id="2934837">(</span><span class="ident" id="2934838">path</span><span class="op" id="2934842">[</span><span class="ident" id="2934843">r</span><span class="op" id="2934844">+</span><span class="num" id="2934845">1</span><span class="op" id="2934846">]</span><span class="op" id="2934847">)</span><span class="op" id="2934848">)</span><span class="op" id="2934849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934854">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2934870">r</span><span class="op" id="2934871">++</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2934876">case</span>&nbsp;<span class="ident" id="2934881">path</span><span class="op" id="2934885">[</span><span class="ident" id="2934886">r</span><span class="op" id="2934887">]</span>&nbsp;<span class="op" id="2934889">==</span>&nbsp;<span class="string" id="2934892">&#39;.&#39;</span>&nbsp;<span class="op" id="2934896">&amp;&amp;</span>&nbsp;<span class="ident" id="2934899">path</span><span class="op" id="2934903">[</span><span class="ident" id="2934904">r</span><span class="op" id="2934905">+</span><span class="num" id="2934906">1</span><span class="op" id="2934907">]</span>&nbsp;<span class="op" id="2934909">==</span>&nbsp;<span class="string" id="2934912">&#39;.&#39;</span>&nbsp;<span class="op" id="2934916">&amp;&amp;</span>&nbsp;<span class="op" id="2934919">(</span><span class="ident" id="2934920">r</span><span class="op" id="2934921">+</span><span class="num" id="2934922">2</span>&nbsp;<span class="op" id="2934924">==</span>&nbsp;<span class="ident" id="2934927">n</span>&nbsp;<span class="op" id="2934929">||</span>&nbsp;<span class="ident" id="2934932">os</span><span class="op" id="2934934">.</span><span class="ident" id="2934935">IsPathSeparator</span><span class="op" id="2934950">(</span><span class="ident" id="2934951">path</span><span class="op" id="2934955">[</span><span class="ident" id="2934956">r</span><span class="op" id="2934957">+</span><span class="num" id="2934958">2</span><span class="op" id="2934959">]</span><span class="op" id="2934960">)</span><span class="op" id="2934961">)</span><span class="op" id="2934962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2934967">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935010">r</span>&nbsp;<span class="op" id="2935012">+=</span>&nbsp;<span class="num" id="2935015">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935020">switch</span>&nbsp;<span class="op" id="2935027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935032">case</span>&nbsp;<span class="ident" id="2935037">out</span><span class="op" id="2935040">.</span><span class="ident" id="2935041">w</span>&nbsp;<span class="op" id="2935043">&gt;</span>&nbsp;<span class="ident" id="2935045">dotdot</span><span class="op" id="2935051">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935057">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935078">out</span><span class="op" id="2935081">.</span><span class="ident" id="2935082">w</span><span class="op" id="2935083">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935090">for</span>&nbsp;<span class="ident" id="2935094">out</span><span class="op" id="2935097">.</span><span class="ident" id="2935098">w</span>&nbsp;<span class="op" id="2935100">&gt;</span>&nbsp;<span class="ident" id="2935102">dotdot</span>&nbsp;<span class="op" id="2935109">&amp;&amp;</span>&nbsp;<span class="op" id="2935112">!</span><span class="ident" id="2935113">os</span><span class="op" id="2935115">.</span><span class="ident" id="2935116">IsPathSeparator</span><span class="op" id="2935131">(</span><span class="ident" id="2935132">out</span><span class="op" id="2935135">.</span><span class="ident" id="2935136">index</span><span class="op" id="2935141">(</span><span class="ident" id="2935142">out</span><span class="op" id="2935145">.</span><span class="ident" id="2935146">w</span><span class="op" id="2935147">)</span><span class="op" id="2935148">)</span>&nbsp;<span class="op" id="2935150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935157">out</span><span class="op" id="2935160">.</span><span class="ident" id="2935161">w</span><span class="op" id="2935162">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935169">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935174">case</span>&nbsp;<span class="op" id="2935179">!</span><span class="ident" id="2935180">rooted</span><span class="op" id="2935186">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935192">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935255">if</span>&nbsp;<span class="ident" id="2935258">out</span><span class="op" id="2935261">.</span><span class="ident" id="2935262">w</span>&nbsp;<span class="op" id="2935264">&gt;</span>&nbsp;<span class="num" id="2935266">0</span>&nbsp;<span class="op" id="2935268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935275">out</span><span class="op" id="2935278">.</span><span class="builtinfunc" id="2935279">append</span><span class="op" id="2935285">(</span><span class="ident" id="2935286">Separator</span><span class="op" id="2935295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935301">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935307">out</span><span class="op" id="2935310">.</span><span class="builtinfunc" id="2935311">append</span><span class="op" id="2935317">(</span><span class="string" id="2935318">&#39;.&#39;</span><span class="op" id="2935321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935327">out</span><span class="op" id="2935330">.</span><span class="builtinfunc" id="2935331">append</span><span class="op" id="2935337">(</span><span class="string" id="2935338">&#39;.&#39;</span><span class="op" id="2935341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935347">dotdot</span>&nbsp;<span class="op" id="2935354">=</span>&nbsp;<span class="ident" id="2935356">out</span><span class="op" id="2935359">.</span><span class="ident" id="2935360">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935369">default</span><span class="op" id="2935376">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935381">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935406">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935432">if</span>&nbsp;<span class="ident" id="2935435">rooted</span>&nbsp;<span class="op" id="2935442">&amp;&amp;</span>&nbsp;<span class="ident" id="2935445">out</span><span class="op" id="2935448">.</span><span class="ident" id="2935449">w</span>&nbsp;<span class="op" id="2935451">!=</span>&nbsp;<span class="num" id="2935454">1</span>&nbsp;<span class="op" id="2935456">||</span>&nbsp;<span class="op" id="2935459">!</span><span class="ident" id="2935460">rooted</span>&nbsp;<span class="op" id="2935467">&amp;&amp;</span>&nbsp;<span class="ident" id="2935470">out</span><span class="op" id="2935473">.</span><span class="ident" id="2935474">w</span>&nbsp;<span class="op" id="2935476">!=</span>&nbsp;<span class="num" id="2935479">0</span>&nbsp;<span class="op" id="2935481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935487">out</span><span class="op" id="2935490">.</span><span class="builtinfunc" id="2935491">append</span><span class="op" id="2935497">(</span><span class="ident" id="2935498">Separator</span><span class="op" id="2935507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935512">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935517">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935536">for</span>&nbsp;<span class="op" id="2935540">;</span>&nbsp;<span class="ident" id="2935542">r</span>&nbsp;<span class="op" id="2935544">&lt;</span>&nbsp;<span class="ident" id="2935546">n</span>&nbsp;<span class="op" id="2935548">&amp;&amp;</span>&nbsp;<span class="op" id="2935551">!</span><span class="ident" id="2935552">os</span><span class="op" id="2935554">.</span><span class="ident" id="2935555">IsPathSeparator</span><span class="op" id="2935570">(</span><span class="ident" id="2935571">path</span><span class="op" id="2935575">[</span><span class="ident" id="2935576">r</span><span class="op" id="2935577">]</span><span class="op" id="2935578">)</span><span class="op" id="2935579">;</span>&nbsp;<span class="ident" id="2935581">r</span><span class="op" id="2935582">++</span>&nbsp;<span class="op" id="2935585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935591">out</span><span class="op" id="2935594">.</span><span class="builtinfunc" id="2935595">append</span><span class="op" id="2935601">(</span><span class="ident" id="2935602">path</span><span class="op" id="2935606">[</span><span class="ident" id="2935607">r</span><span class="op" id="2935608">]</span><span class="op" id="2935609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935618">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2935625">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935656">if</span>&nbsp;<span class="ident" id="2935659">out</span><span class="op" id="2935662">.</span><span class="ident" id="2935663">w</span>&nbsp;<span class="op" id="2935665">==</span>&nbsp;<span class="num" id="2935668">0</span>&nbsp;<span class="op" id="2935670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2935674">out</span><span class="op" id="2935677">.</span><span class="builtinfunc" id="2935678">append</span><span class="op" id="2935684">(</span><span class="string" id="2935685">&#39;.&#39;</span><span class="op" id="2935688">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935695">return</span>&nbsp;<span class="ident" id="2935702">FromSlash</span><span class="op" id="2935711">(</span><span class="ident" id="2935712">out</span><span class="op" id="2935715">.</span><span class="builtintype" id="2935716">string</span><span class="op" id="2935722">(</span><span class="op" id="2935723">)</span><span class="op" id="2935724">)</span><br>
<span class="lineno"></span><span class="op" id="2935726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="2935729">//&nbsp;ToSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;separator&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="2935797">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character.&nbsp;Multiple&nbsp;separators&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2935862">//&nbsp;replaced&nbsp;by&nbsp;multiple&nbsp;slashes.</span><br>
<span class="lineno"></span><span class="keyword" id="2935895">func</span>&nbsp;<span class="ident" id="2935900">ToSlash</span><span class="op" id="2935907">(</span><span class="ident" id="2935908">path</span>&nbsp;<span class="builtintype" id="2935913">string</span><span class="op" id="2935919">)</span>&nbsp;<span class="builtintype" id="2935921">string</span>&nbsp;<span class="op" id="2935928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935931">if</span>&nbsp;<span class="ident" id="2935934">Separator</span>&nbsp;<span class="op" id="2935944">==</span>&nbsp;<span class="string" id="2935947">&#39;/&#39;</span>&nbsp;<span class="op" id="2935951">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935955">return</span>&nbsp;<span class="ident" id="2935962">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2935968">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2935971">return</span>&nbsp;<span class="ident" id="2935978">strings</span><span class="op" id="2935985">.</span><span class="ident" id="2935986">Replace</span><span class="op" id="2935993">(</span><span class="ident" id="2935994">path</span><span class="op" id="2935998">,</span>&nbsp;<span class="builtintype" id="2936000">string</span><span class="op" id="2936006">(</span><span class="ident" id="2936007">Separator</span><span class="op" id="2936016">)</span><span class="op" id="2936017">,</span>&nbsp;<span class="string" id="2936019">&#34;/&#34;</span><span class="op" id="2936022">,</span>&nbsp;<span class="op" id="2936024">-</span><span class="num" id="2936025">1</span><span class="op" id="2936026">)</span><br>
<span class="lineno"></span><span class="op" id="2936028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2936031">//&nbsp;FromSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="2936103">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;separator&nbsp;character.&nbsp;Multiple&nbsp;slashes&nbsp;are&nbsp;replaced</span><br>
<span class="lineno"></span><span class="comment" id="2936172">//&nbsp;by&nbsp;multiple&nbsp;separators.</span><br>
<span class="lineno"></span><span class="keyword" id="2936199">func</span>&nbsp;<span class="ident" id="2936204">FromSlash</span><span class="op" id="2936213">(</span><span class="ident" id="2936214">path</span>&nbsp;<span class="builtintype" id="2936219">string</span><span class="op" id="2936225">)</span>&nbsp;<span class="builtintype" id="2936227">string</span>&nbsp;<span class="op" id="2936234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2936237">if</span>&nbsp;<span class="ident" id="2936240">Separator</span>&nbsp;<span class="op" id="2936250">==</span>&nbsp;<span class="string" id="2936253">&#39;/&#39;</span>&nbsp;<span class="op" id="2936257">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2936261">return</span>&nbsp;<span class="ident" id="2936268">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2936274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2936277">return</span>&nbsp;<span class="ident" id="2936284">strings</span><span class="op" id="2936291">.</span><span class="ident" id="2936292">Replace</span><span class="op" id="2936299">(</span><span class="ident" id="2936300">path</span><span class="op" id="2936304">,</span>&nbsp;<span class="string" id="2936306">&#34;/&#34;</span><span class="op" id="2936309">,</span>&nbsp;<span class="builtintype" id="2936311">string</span><span class="op" id="2936317">(</span><span class="ident" id="2936318">Separator</span><span class="op" id="2936327">)</span><span class="op" id="2936328">,</span>&nbsp;<span class="op" id="2936330">-</span><span class="num" id="2936331">1</span><span class="op" id="2936332">)</span><br>
<span class="lineno"></span><span class="op" id="2936334">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2936337">//&nbsp;SplitList&nbsp;splits&nbsp;a&nbsp;list&nbsp;of&nbsp;paths&nbsp;joined&nbsp;by&nbsp;the&nbsp;OS-specific&nbsp;ListSeparator,</span><br>
<span class="lineno"></span><span class="comment" id="2936414">//&nbsp;usually&nbsp;found&nbsp;in&nbsp;PATH&nbsp;or&nbsp;GOPATH&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><span class="comment" id="2936472">//&nbsp;Unlike&nbsp;strings.Split,&nbsp;SplitList&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;when&nbsp;passed&nbsp;an&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2936559">func</span>&nbsp;<span class="ident" id="2936564">SplitList</span><span class="op" id="2936573">(</span><span class="ident" id="2936574">path</span>&nbsp;<span class="builtintype" id="2936579">string</span><span class="op" id="2936585">)</span>&nbsp;<span class="op" id="2936587">[</span><span class="op" id="2936588">]</span><span class="builtintype" id="2936589">string</span>&nbsp;<span class="op" id="2936596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2936599">return</span>&nbsp;<span class="ident" id="2936606">splitList</span><span class="op" id="2936615">(</span><span class="ident" id="2936616">path</span><span class="op" id="2936620">)</span><br>
<span class="lineno">180</span><span class="op" id="2936622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2936625">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;Separator,</span><br>
<span class="lineno"></span><span class="comment" id="2936689">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="2936748">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;Separator&nbsp;in&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir</span><br>
<span class="lineno">185</span><span class="comment" id="2936812">//&nbsp;and&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2936837">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="2936900">func</span>&nbsp;<span class="ident" id="2936905">Split</span><span class="op" id="2936910">(</span><span class="ident" id="2936911">path</span>&nbsp;<span class="builtintype" id="2936916">string</span><span class="op" id="2936922">)</span>&nbsp;<span class="op" id="2936924">(</span><span class="ident" id="2936925">dir</span><span class="op" id="2936928">,</span>&nbsp;<span class="ident" id="2936930">file</span>&nbsp;<span class="builtintype" id="2936935">string</span><span class="op" id="2936941">)</span>&nbsp;<span class="op" id="2936943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936946">vol</span>&nbsp;<span class="op" id="2936950">:=</span>&nbsp;<span class="ident" id="2936953">VolumeName</span><span class="op" id="2936963">(</span><span class="ident" id="2936964">path</span><span class="op" id="2936968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2936971">i</span>&nbsp;<span class="op" id="2936973">:=</span>&nbsp;<span class="builtinfunc" id="2936976">len</span><span class="op" id="2936979">(</span><span class="ident" id="2936980">path</span><span class="op" id="2936984">)</span>&nbsp;<span class="op" id="2936986">-</span>&nbsp;<span class="num" id="2936988">1</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2936991">for</span>&nbsp;<span class="ident" id="2936995">i</span>&nbsp;<span class="op" id="2936997">&gt;=</span>&nbsp;<span class="builtinfunc" id="2937000">len</span><span class="op" id="2937003">(</span><span class="ident" id="2937004">vol</span><span class="op" id="2937007">)</span>&nbsp;<span class="op" id="2937009">&amp;&amp;</span>&nbsp;<span class="op" id="2937012">!</span><span class="ident" id="2937013">os</span><span class="op" id="2937015">.</span><span class="ident" id="2937016">IsPathSeparator</span><span class="op" id="2937031">(</span><span class="ident" id="2937032">path</span><span class="op" id="2937036">[</span><span class="ident" id="2937037">i</span><span class="op" id="2937038">]</span><span class="op" id="2937039">)</span>&nbsp;<span class="op" id="2937041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2937045">i</span><span class="op" id="2937046">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2937050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937053">return</span>&nbsp;<span class="ident" id="2937060">path</span><span class="op" id="2937064">[</span><span class="op" id="2937065">:</span><span class="ident" id="2937066">i</span><span class="op" id="2937067">+</span><span class="num" id="2937068">1</span><span class="op" id="2937069">]</span><span class="op" id="2937070">,</span>&nbsp;<span class="ident" id="2937072">path</span><span class="op" id="2937076">[</span><span class="ident" id="2937077">i</span><span class="op" id="2937078">+</span><span class="num" id="2937079">1</span><span class="op" id="2937080">:</span><span class="op" id="2937081">]</span><br>
<span class="lineno"></span><span class="op" id="2937083">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="2937086">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding</span><br>
<span class="lineno"></span><span class="comment" id="2937155">//&nbsp;a&nbsp;Separator&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned,&nbsp;in&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="2937221">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="2937255">func</span>&nbsp;<span class="ident" id="2937260">Join</span><span class="op" id="2937264">(</span><span class="ident" id="2937265">elem</span>&nbsp;<span class="op" id="2937270">...</span><span class="builtintype" id="2937273">string</span><span class="op" id="2937279">)</span>&nbsp;<span class="builtintype" id="2937281">string</span>&nbsp;<span class="op" id="2937288">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937291">for</span>&nbsp;<span class="ident" id="2937295">i</span><span class="op" id="2937296">,</span>&nbsp;<span class="ident" id="2937298">e</span>&nbsp;<span class="op" id="2937300">:=</span>&nbsp;<span class="keyword" id="2937303">range</span>&nbsp;<span class="ident" id="2937309">elem</span>&nbsp;<span class="op" id="2937314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937318">if</span>&nbsp;<span class="ident" id="2937321">e</span>&nbsp;<span class="op" id="2937323">!=</span>&nbsp;<span class="string" id="2937326">&#34;&#34;</span>&nbsp;<span class="op" id="2937329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937334">return</span>&nbsp;<span class="ident" id="2937341">Clean</span><span class="op" id="2937346">(</span><span class="ident" id="2937347">strings</span><span class="op" id="2937354">.</span><span class="ident" id="2937355">Join</span><span class="op" id="2937359">(</span><span class="ident" id="2937360">elem</span><span class="op" id="2937364">[</span><span class="ident" id="2937365">i</span><span class="op" id="2937366">:</span><span class="op" id="2937367">]</span><span class="op" id="2937368">,</span>&nbsp;<span class="builtintype" id="2937370">string</span><span class="op" id="2937376">(</span><span class="ident" id="2937377">Separator</span><span class="op" id="2937386">)</span><span class="op" id="2937387">)</span><span class="op" id="2937388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2937392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2937395">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937398">return</span>&nbsp;<span class="string" id="2937405">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2937408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2937411">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2937464">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno">210</span><span class="comment" id="2937522">//&nbsp;in&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;path;&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2937579">//&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="2937590">func</span>&nbsp;<span class="ident" id="2937595">Ext</span><span class="op" id="2937598">(</span><span class="ident" id="2937599">path</span>&nbsp;<span class="builtintype" id="2937604">string</span><span class="op" id="2937610">)</span>&nbsp;<span class="builtintype" id="2937612">string</span>&nbsp;<span class="op" id="2937619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937622">for</span>&nbsp;<span class="ident" id="2937626">i</span>&nbsp;<span class="op" id="2937628">:=</span>&nbsp;<span class="builtinfunc" id="2937631">len</span><span class="op" id="2937634">(</span><span class="ident" id="2937635">path</span><span class="op" id="2937639">)</span>&nbsp;<span class="op" id="2937641">-</span>&nbsp;<span class="num" id="2937643">1</span><span class="op" id="2937644">;</span>&nbsp;<span class="ident" id="2937646">i</span>&nbsp;<span class="op" id="2937648">&gt;=</span>&nbsp;<span class="num" id="2937651">0</span>&nbsp;<span class="op" id="2937653">&amp;&amp;</span>&nbsp;<span class="op" id="2937656">!</span><span class="ident" id="2937657">os</span><span class="op" id="2937659">.</span><span class="ident" id="2937660">IsPathSeparator</span><span class="op" id="2937675">(</span><span class="ident" id="2937676">path</span><span class="op" id="2937680">[</span><span class="ident" id="2937681">i</span><span class="op" id="2937682">]</span><span class="op" id="2937683">)</span><span class="op" id="2937684">;</span>&nbsp;<span class="ident" id="2937686">i</span><span class="op" id="2937687">--</span>&nbsp;<span class="op" id="2937690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937694">if</span>&nbsp;<span class="ident" id="2937697">path</span><span class="op" id="2937701">[</span><span class="ident" id="2937702">i</span><span class="op" id="2937703">]</span>&nbsp;<span class="op" id="2937705">==</span>&nbsp;<span class="string" id="2937708">&#39;.&#39;</span>&nbsp;<span class="op" id="2937712">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937717">return</span>&nbsp;<span class="ident" id="2937724">path</span><span class="op" id="2937728">[</span><span class="ident" id="2937729">i</span><span class="op" id="2937730">:</span><span class="op" id="2937731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2937735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2937738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2937741">return</span>&nbsp;<span class="string" id="2937748">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2937751">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2937754">//&nbsp;EvalSymlinks&nbsp;returns&nbsp;the&nbsp;path&nbsp;name&nbsp;after&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;any&nbsp;symbolic</span><br>
<span class="lineno"></span><span class="comment" id="2937829">//&nbsp;links.</span><br>
<span class="lineno"></span><span class="comment" id="2937839">//&nbsp;If&nbsp;path&nbsp;is&nbsp;relative&nbsp;the&nbsp;result&nbsp;will&nbsp;be&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="2937916">//&nbsp;unless&nbsp;one&nbsp;of&nbsp;the&nbsp;components&nbsp;is&nbsp;an&nbsp;absolute&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno">225</span><span class="keyword" id="2937978">func</span>&nbsp;<span class="ident" id="2937983">EvalSymlinks</span><span class="op" id="2937995">(</span><span class="ident" id="2937996">path</span>&nbsp;<span class="builtintype" id="2938001">string</span><span class="op" id="2938007">)</span>&nbsp;<span class="op" id="2938009">(</span><span class="builtintype" id="2938010">string</span><span class="op" id="2938016">,</span>&nbsp;<span class="builtintype" id="2938018">error</span><span class="op" id="2938023">)</span>&nbsp;<span class="op" id="2938025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938028">return</span>&nbsp;<span class="ident" id="2938035">evalSymlinks</span><span class="op" id="2938047">(</span><span class="ident" id="2938048">path</span><span class="op" id="2938052">)</span><br>
<span class="lineno"></span><span class="op" id="2938054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2938057">//&nbsp;Abs&nbsp;returns&nbsp;an&nbsp;absolute&nbsp;representation&nbsp;of&nbsp;path.</span><br>
<span class="lineno">230</span><span class="comment" id="2938108">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;not&nbsp;absolute&nbsp;it&nbsp;will&nbsp;be&nbsp;joined&nbsp;with&nbsp;the&nbsp;current</span><br>
<span class="lineno"></span><span class="comment" id="2938174">//&nbsp;working&nbsp;directory&nbsp;to&nbsp;turn&nbsp;it&nbsp;into&nbsp;an&nbsp;absolute&nbsp;path.&nbsp;&nbsp;The&nbsp;absolute</span><br>
<span class="lineno"></span><span class="comment" id="2938243">//&nbsp;path&nbsp;name&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique.</span><br>
<span class="lineno"></span><span class="keyword" id="2938305">func</span>&nbsp;<span class="ident" id="2938310">Abs</span><span class="op" id="2938313">(</span><span class="ident" id="2938314">path</span>&nbsp;<span class="builtintype" id="2938319">string</span><span class="op" id="2938325">)</span>&nbsp;<span class="op" id="2938327">(</span><span class="builtintype" id="2938328">string</span><span class="op" id="2938334">,</span>&nbsp;<span class="builtintype" id="2938336">error</span><span class="op" id="2938341">)</span>&nbsp;<span class="op" id="2938343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938346">return</span>&nbsp;<span class="ident" id="2938353">abs</span><span class="op" id="2938356">(</span><span class="ident" id="2938357">path</span><span class="op" id="2938361">)</span><br>
<span class="lineno">235</span><span class="op" id="2938363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2938366">func</span>&nbsp;<span class="ident" id="2938371">unixAbs</span><span class="op" id="2938378">(</span><span class="ident" id="2938379">path</span>&nbsp;<span class="builtintype" id="2938384">string</span><span class="op" id="2938390">)</span>&nbsp;<span class="op" id="2938392">(</span><span class="builtintype" id="2938393">string</span><span class="op" id="2938399">,</span>&nbsp;<span class="builtintype" id="2938401">error</span><span class="op" id="2938406">)</span>&nbsp;<span class="op" id="2938408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938411">if</span>&nbsp;<span class="ident" id="2938414">IsAbs</span><span class="op" id="2938419">(</span><span class="ident" id="2938420">path</span><span class="op" id="2938424">)</span>&nbsp;<span class="op" id="2938426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938430">return</span>&nbsp;<span class="ident" id="2938437">Clean</span><span class="op" id="2938442">(</span><span class="ident" id="2938443">path</span><span class="op" id="2938447">)</span><span class="op" id="2938448">,</span>&nbsp;<span class="ident" id="2938450">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2938455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2938458">wd</span><span class="op" id="2938460">,</span>&nbsp;<span class="ident" id="2938462">err</span>&nbsp;<span class="op" id="2938466">:=</span>&nbsp;<span class="ident" id="2938469">os</span><span class="op" id="2938471">.</span><span class="ident" id="2938472">Getwd</span><span class="op" id="2938477">(</span><span class="op" id="2938478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938481">if</span>&nbsp;<span class="ident" id="2938484">err</span>&nbsp;<span class="op" id="2938488">!=</span>&nbsp;<span class="ident" id="2938491">nil</span>&nbsp;<span class="op" id="2938495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938499">return</span>&nbsp;<span class="string" id="2938506">&#34;&#34;</span><span class="op" id="2938508">,</span>&nbsp;<span class="ident" id="2938510">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2938515">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2938518">return</span>&nbsp;<span class="ident" id="2938525">Join</span><span class="op" id="2938529">(</span><span class="ident" id="2938530">wd</span><span class="op" id="2938532">,</span>&nbsp;<span class="ident" id="2938534">path</span><span class="op" id="2938538">)</span><span class="op" id="2938539">,</span>&nbsp;<span class="ident" id="2938541">nil</span><br>
<span class="lineno"></span><span class="op" id="2938545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2938548">//&nbsp;Rel&nbsp;returns&nbsp;a&nbsp;relative&nbsp;path&nbsp;that&nbsp;is&nbsp;lexically&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="2938625">//&nbsp;joined&nbsp;to&nbsp;basepath&nbsp;with&nbsp;an&nbsp;intervening&nbsp;separator.&nbsp;That&nbsp;is,</span><br>
<span class="lineno">250</span><span class="comment" id="2938687">//&nbsp;Join(basepath,&nbsp;Rel(basepath,&nbsp;targpath))&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="2938764">//&nbsp;On&nbsp;success,&nbsp;the&nbsp;returned&nbsp;path&nbsp;will&nbsp;always&nbsp;be&nbsp;relative&nbsp;to&nbsp;basepath,</span><br>
<span class="lineno"></span><span class="comment" id="2938834">//&nbsp;even&nbsp;if&nbsp;basepath&nbsp;and&nbsp;targpath&nbsp;share&nbsp;no&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="2938886">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;targpath&nbsp;can&#39;t&nbsp;be&nbsp;made&nbsp;relative&nbsp;to&nbsp;basepath&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2938963">//&nbsp;knowing&nbsp;the&nbsp;current&nbsp;working&nbsp;directory&nbsp;would&nbsp;be&nbsp;necessary&nbsp;to&nbsp;compute&nbsp;it.</span><br>
<span class="lineno">255</span><span class="keyword" id="2939038">func</span>&nbsp;<span class="ident" id="2939043">Rel</span><span class="op" id="2939046">(</span><span class="ident" id="2939047">basepath</span><span class="op" id="2939055">,</span>&nbsp;<span class="ident" id="2939057">targpath</span>&nbsp;<span class="builtintype" id="2939066">string</span><span class="op" id="2939072">)</span>&nbsp;<span class="op" id="2939074">(</span><span class="builtintype" id="2939075">string</span><span class="op" id="2939081">,</span>&nbsp;<span class="builtintype" id="2939083">error</span><span class="op" id="2939088">)</span>&nbsp;<span class="op" id="2939090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939093">baseVol</span>&nbsp;<span class="op" id="2939101">:=</span>&nbsp;<span class="ident" id="2939104">VolumeName</span><span class="op" id="2939114">(</span><span class="ident" id="2939115">basepath</span><span class="op" id="2939123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939126">targVol</span>&nbsp;<span class="op" id="2939134">:=</span>&nbsp;<span class="ident" id="2939137">VolumeName</span><span class="op" id="2939147">(</span><span class="ident" id="2939148">targpath</span><span class="op" id="2939156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939159">base</span>&nbsp;<span class="op" id="2939164">:=</span>&nbsp;<span class="ident" id="2939167">Clean</span><span class="op" id="2939172">(</span><span class="ident" id="2939173">basepath</span><span class="op" id="2939181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939184">targ</span>&nbsp;<span class="op" id="2939189">:=</span>&nbsp;<span class="ident" id="2939192">Clean</span><span class="op" id="2939197">(</span><span class="ident" id="2939198">targpath</span><span class="op" id="2939206">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939209">if</span>&nbsp;<span class="ident" id="2939212">targ</span>&nbsp;<span class="op" id="2939217">==</span>&nbsp;<span class="ident" id="2939220">base</span>&nbsp;<span class="op" id="2939225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939229">return</span>&nbsp;<span class="string" id="2939236">&#34;.&#34;</span><span class="op" id="2939239">,</span>&nbsp;<span class="ident" id="2939241">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939249">base</span>&nbsp;<span class="op" id="2939254">=</span>&nbsp;<span class="ident" id="2939256">base</span><span class="op" id="2939260">[</span><span class="builtinfunc" id="2939261">len</span><span class="op" id="2939264">(</span><span class="ident" id="2939265">baseVol</span><span class="op" id="2939272">)</span><span class="op" id="2939273">:</span><span class="op" id="2939274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939277">targ</span>&nbsp;<span class="op" id="2939282">=</span>&nbsp;<span class="ident" id="2939284">targ</span><span class="op" id="2939288">[</span><span class="builtinfunc" id="2939289">len</span><span class="op" id="2939292">(</span><span class="ident" id="2939293">targVol</span><span class="op" id="2939300">)</span><span class="op" id="2939301">:</span><span class="op" id="2939302">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939305">if</span>&nbsp;<span class="ident" id="2939308">base</span>&nbsp;<span class="op" id="2939313">==</span>&nbsp;<span class="string" id="2939316">&#34;.&#34;</span>&nbsp;<span class="op" id="2939320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939324">base</span>&nbsp;<span class="op" id="2939329">=</span>&nbsp;<span class="string" id="2939331">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939338">//&nbsp;Can&#39;t&nbsp;use&nbsp;IsAbs&nbsp;-&nbsp;`\a`&nbsp;and&nbsp;`a`&nbsp;are&nbsp;both&nbsp;relative&nbsp;in&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939403">baseSlashed</span>&nbsp;<span class="op" id="2939415">:=</span>&nbsp;<span class="builtinfunc" id="2939418">len</span><span class="op" id="2939421">(</span><span class="ident" id="2939422">base</span><span class="op" id="2939426">)</span>&nbsp;<span class="op" id="2939428">&gt;</span>&nbsp;<span class="num" id="2939430">0</span>&nbsp;<span class="op" id="2939432">&amp;&amp;</span>&nbsp;<span class="ident" id="2939435">base</span><span class="op" id="2939439">[</span><span class="num" id="2939440">0</span><span class="op" id="2939441">]</span>&nbsp;<span class="op" id="2939443">==</span>&nbsp;<span class="ident" id="2939446">Separator</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939457">targSlashed</span>&nbsp;<span class="op" id="2939469">:=</span>&nbsp;<span class="builtinfunc" id="2939472">len</span><span class="op" id="2939475">(</span><span class="ident" id="2939476">targ</span><span class="op" id="2939480">)</span>&nbsp;<span class="op" id="2939482">&gt;</span>&nbsp;<span class="num" id="2939484">0</span>&nbsp;<span class="op" id="2939486">&amp;&amp;</span>&nbsp;<span class="ident" id="2939489">targ</span><span class="op" id="2939493">[</span><span class="num" id="2939494">0</span><span class="op" id="2939495">]</span>&nbsp;<span class="op" id="2939497">==</span>&nbsp;<span class="ident" id="2939500">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939511">if</span>&nbsp;<span class="ident" id="2939514">baseSlashed</span>&nbsp;<span class="op" id="2939526">!=</span>&nbsp;<span class="ident" id="2939529">targSlashed</span>&nbsp;<span class="op" id="2939541">||</span>&nbsp;<span class="ident" id="2939544">baseVol</span>&nbsp;<span class="op" id="2939552">!=</span>&nbsp;<span class="ident" id="2939555">targVol</span>&nbsp;<span class="op" id="2939563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939567">return</span>&nbsp;<span class="string" id="2939574">&#34;&#34;</span><span class="op" id="2939576">,</span>&nbsp;<span class="ident" id="2939578">errors</span><span class="op" id="2939584">.</span><span class="ident" id="2939585">New</span><span class="op" id="2939588">(</span><span class="string" id="2939589">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="2939608">+</span>&nbsp;<span class="ident" id="2939610">targ</span>&nbsp;<span class="op" id="2939615">+</span>&nbsp;<span class="string" id="2939617">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="2939633">+</span>&nbsp;<span class="ident" id="2939635">base</span><span class="op" id="2939639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2939645">//&nbsp;Position&nbsp;base[b0:bi]&nbsp;and&nbsp;targ[t0:ti]&nbsp;at&nbsp;the&nbsp;first&nbsp;differing&nbsp;elements.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939719">bl</span>&nbsp;<span class="op" id="2939722">:=</span>&nbsp;<span class="builtinfunc" id="2939725">len</span><span class="op" id="2939728">(</span><span class="ident" id="2939729">base</span><span class="op" id="2939733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939736">tl</span>&nbsp;<span class="op" id="2939739">:=</span>&nbsp;<span class="builtinfunc" id="2939742">len</span><span class="op" id="2939745">(</span><span class="ident" id="2939746">targ</span><span class="op" id="2939750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939753">var</span>&nbsp;<span class="ident" id="2939757">b0</span><span class="op" id="2939759">,</span>&nbsp;<span class="ident" id="2939761">bi</span><span class="op" id="2939763">,</span>&nbsp;<span class="ident" id="2939765">t0</span><span class="op" id="2939767">,</span>&nbsp;<span class="ident" id="2939769">ti</span>&nbsp;<span class="builtintype" id="2939772">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939777">for</span>&nbsp;<span class="op" id="2939781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939785">for</span>&nbsp;<span class="ident" id="2939789">bi</span>&nbsp;<span class="op" id="2939792">&lt;</span>&nbsp;<span class="ident" id="2939794">bl</span>&nbsp;<span class="op" id="2939797">&amp;&amp;</span>&nbsp;<span class="ident" id="2939800">base</span><span class="op" id="2939804">[</span><span class="ident" id="2939805">bi</span><span class="op" id="2939807">]</span>&nbsp;<span class="op" id="2939809">!=</span>&nbsp;<span class="ident" id="2939812">Separator</span>&nbsp;<span class="op" id="2939822">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939827">bi</span><span class="op" id="2939829">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939838">for</span>&nbsp;<span class="ident" id="2939842">ti</span>&nbsp;<span class="op" id="2939845">&lt;</span>&nbsp;<span class="ident" id="2939847">tl</span>&nbsp;<span class="op" id="2939850">&amp;&amp;</span>&nbsp;<span class="ident" id="2939853">targ</span><span class="op" id="2939857">[</span><span class="ident" id="2939858">ti</span><span class="op" id="2939860">]</span>&nbsp;<span class="op" id="2939862">!=</span>&nbsp;<span class="ident" id="2939865">Separator</span>&nbsp;<span class="op" id="2939875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939880">ti</span><span class="op" id="2939882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939887">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939891">if</span>&nbsp;<span class="ident" id="2939894">targ</span><span class="op" id="2939898">[</span><span class="ident" id="2939899">t0</span><span class="op" id="2939901">:</span><span class="ident" id="2939902">ti</span><span class="op" id="2939904">]</span>&nbsp;<span class="op" id="2939906">!=</span>&nbsp;<span class="ident" id="2939909">base</span><span class="op" id="2939913">[</span><span class="ident" id="2939914">b0</span><span class="op" id="2939916">:</span><span class="ident" id="2939917">bi</span><span class="op" id="2939919">]</span>&nbsp;<span class="op" id="2939921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939926">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939938">if</span>&nbsp;<span class="ident" id="2939941">bi</span>&nbsp;<span class="op" id="2939944">&lt;</span>&nbsp;<span class="ident" id="2939946">bl</span>&nbsp;<span class="op" id="2939949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939954">bi</span><span class="op" id="2939956">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2939965">if</span>&nbsp;<span class="ident" id="2939968">ti</span>&nbsp;<span class="op" id="2939971">&lt;</span>&nbsp;<span class="ident" id="2939973">tl</span>&nbsp;<span class="op" id="2939976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939981">ti</span><span class="op" id="2939983">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2939988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2939992">b0</span>&nbsp;<span class="op" id="2939995">=</span>&nbsp;<span class="ident" id="2939997">bi</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940002">t0</span>&nbsp;<span class="op" id="2940005">=</span>&nbsp;<span class="ident" id="2940007">ti</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940014">if</span>&nbsp;<span class="ident" id="2940017">base</span><span class="op" id="2940021">[</span><span class="ident" id="2940022">b0</span><span class="op" id="2940024">:</span><span class="ident" id="2940025">bi</span><span class="op" id="2940027">]</span>&nbsp;<span class="op" id="2940029">==</span>&nbsp;<span class="string" id="2940032">&#34;..&#34;</span>&nbsp;<span class="op" id="2940037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940041">return</span>&nbsp;<span class="string" id="2940048">&#34;&#34;</span><span class="op" id="2940050">,</span>&nbsp;<span class="ident" id="2940052">errors</span><span class="op" id="2940058">.</span><span class="ident" id="2940059">New</span><span class="op" id="2940062">(</span><span class="string" id="2940063">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="2940082">+</span>&nbsp;<span class="ident" id="2940084">targ</span>&nbsp;<span class="op" id="2940089">+</span>&nbsp;<span class="string" id="2940091">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="2940107">+</span>&nbsp;<span class="ident" id="2940109">base</span><span class="op" id="2940113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940116">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940119">if</span>&nbsp;<span class="ident" id="2940122">b0</span>&nbsp;<span class="op" id="2940125">!=</span>&nbsp;<span class="ident" id="2940128">bl</span>&nbsp;<span class="op" id="2940131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2940135">//&nbsp;Base&nbsp;elements&nbsp;left.&nbsp;Must&nbsp;go&nbsp;up&nbsp;before&nbsp;going&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940190">seps</span>&nbsp;<span class="op" id="2940195">:=</span>&nbsp;<span class="ident" id="2940198">strings</span><span class="op" id="2940205">.</span><span class="ident" id="2940206">Count</span><span class="op" id="2940211">(</span><span class="ident" id="2940212">base</span><span class="op" id="2940216">[</span><span class="ident" id="2940217">b0</span><span class="op" id="2940219">:</span><span class="ident" id="2940220">bl</span><span class="op" id="2940222">]</span><span class="op" id="2940223">,</span>&nbsp;<span class="builtintype" id="2940225">string</span><span class="op" id="2940231">(</span><span class="ident" id="2940232">Separator</span><span class="op" id="2940241">)</span><span class="op" id="2940242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940246">size</span>&nbsp;<span class="op" id="2940251">:=</span>&nbsp;<span class="num" id="2940254">2</span>&nbsp;<span class="op" id="2940256">+</span>&nbsp;<span class="ident" id="2940258">seps</span><span class="op" id="2940262">*</span><span class="num" id="2940263">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940267">if</span>&nbsp;<span class="ident" id="2940270">tl</span>&nbsp;<span class="op" id="2940273">!=</span>&nbsp;<span class="ident" id="2940276">t0</span>&nbsp;<span class="op" id="2940279">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940284">size</span>&nbsp;<span class="op" id="2940289">+=</span>&nbsp;<span class="num" id="2940292">1</span>&nbsp;<span class="op" id="2940294">+</span>&nbsp;<span class="ident" id="2940296">tl</span>&nbsp;<span class="op" id="2940299">-</span>&nbsp;<span class="ident" id="2940301">t0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940310">buf</span>&nbsp;<span class="op" id="2940314">:=</span>&nbsp;<span class="builtinfunc" id="2940317">make</span><span class="op" id="2940321">(</span><span class="op" id="2940322">[</span><span class="op" id="2940323">]</span><span class="builtintype" id="2940324">byte</span><span class="op" id="2940328">,</span>&nbsp;<span class="ident" id="2940330">size</span><span class="op" id="2940334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940338">n</span>&nbsp;<span class="op" id="2940340">:=</span>&nbsp;<span class="builtinfunc" id="2940343">copy</span><span class="op" id="2940347">(</span><span class="ident" id="2940348">buf</span><span class="op" id="2940351">,</span>&nbsp;<span class="string" id="2940353">&#34;..&#34;</span><span class="op" id="2940357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940361">for</span>&nbsp;<span class="ident" id="2940365">i</span>&nbsp;<span class="op" id="2940367">:=</span>&nbsp;<span class="num" id="2940370">0</span><span class="op" id="2940371">;</span>&nbsp;<span class="ident" id="2940373">i</span>&nbsp;<span class="op" id="2940375">&lt;</span>&nbsp;<span class="ident" id="2940377">seps</span><span class="op" id="2940381">;</span>&nbsp;<span class="ident" id="2940383">i</span><span class="op" id="2940384">++</span>&nbsp;<span class="op" id="2940387">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940392">buf</span><span class="op" id="2940395">[</span><span class="ident" id="2940396">n</span><span class="op" id="2940397">]</span>&nbsp;<span class="op" id="2940399">=</span>&nbsp;<span class="ident" id="2940401">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2940414">copy</span><span class="op" id="2940418">(</span><span class="ident" id="2940419">buf</span><span class="op" id="2940422">[</span><span class="ident" id="2940423">n</span><span class="op" id="2940424">+</span><span class="num" id="2940425">1</span><span class="op" id="2940426">:</span><span class="op" id="2940427">]</span><span class="op" id="2940428">,</span>&nbsp;<span class="string" id="2940430">&#34;..&#34;</span><span class="op" id="2940434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940439">n</span>&nbsp;<span class="op" id="2940441">+=</span>&nbsp;<span class="num" id="2940444">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940452">if</span>&nbsp;<span class="ident" id="2940455">t0</span>&nbsp;<span class="op" id="2940458">!=</span>&nbsp;<span class="ident" id="2940461">tl</span>&nbsp;<span class="op" id="2940464">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2940469">buf</span><span class="op" id="2940472">[</span><span class="ident" id="2940473">n</span><span class="op" id="2940474">]</span>&nbsp;<span class="op" id="2940476">=</span>&nbsp;<span class="ident" id="2940478">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2940491">copy</span><span class="op" id="2940495">(</span><span class="ident" id="2940496">buf</span><span class="op" id="2940499">[</span><span class="ident" id="2940500">n</span><span class="op" id="2940501">+</span><span class="num" id="2940502">1</span><span class="op" id="2940503">:</span><span class="op" id="2940504">]</span><span class="op" id="2940505">,</span>&nbsp;<span class="ident" id="2940507">targ</span><span class="op" id="2940511">[</span><span class="ident" id="2940512">t0</span><span class="op" id="2940514">:</span><span class="op" id="2940515">]</span><span class="op" id="2940516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940524">return</span>&nbsp;<span class="builtintype" id="2940531">string</span><span class="op" id="2940537">(</span><span class="ident" id="2940538">buf</span><span class="op" id="2940541">)</span><span class="op" id="2940542">,</span>&nbsp;<span class="ident" id="2940544">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2940549">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2940552">return</span>&nbsp;<span class="ident" id="2940559">targ</span><span class="op" id="2940563">[</span><span class="ident" id="2940564">t0</span><span class="op" id="2940566">:</span><span class="op" id="2940567">]</span><span class="op" id="2940568">,</span>&nbsp;<span class="ident" id="2940570">nil</span><br>
<span class="lineno"></span><span class="op" id="2940574">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2940577">//&nbsp;SkipDir&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;return&nbsp;value&nbsp;from&nbsp;WalkFuncs&nbsp;to&nbsp;indicate&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2940646">//&nbsp;the&nbsp;directory&nbsp;named&nbsp;in&nbsp;the&nbsp;call&nbsp;is&nbsp;to&nbsp;be&nbsp;skipped.&nbsp;It&nbsp;is&nbsp;not&nbsp;returned</span><br>
<span class="lineno">325</span><span class="comment" id="2940718">//&nbsp;as&nbsp;an&nbsp;error&nbsp;by&nbsp;any&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2940750">var</span>&nbsp;<span class="ident" id="2940754">SkipDir</span>&nbsp;<span class="op" id="2940762">=</span>&nbsp;<span class="ident" id="2940764">errors</span><span class="op" id="2940770">.</span><span class="ident" id="2940771">New</span><span class="op" id="2940774">(</span><span class="string" id="2940775">&#34;skip&nbsp;this&nbsp;directory&#34;</span><span class="op" id="2940796">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2940799">//&nbsp;WalkFunc&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;function&nbsp;called&nbsp;for&nbsp;each&nbsp;file&nbsp;or&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="2940873">//&nbsp;visited&nbsp;by&nbsp;Walk.&nbsp;The&nbsp;path&nbsp;argument&nbsp;contains&nbsp;the&nbsp;argument&nbsp;to&nbsp;Walk&nbsp;as&nbsp;a</span><br>
<span class="lineno">330</span><span class="comment" id="2940946">//&nbsp;prefix;&nbsp;that&nbsp;is,&nbsp;if&nbsp;Walk&nbsp;is&nbsp;called&nbsp;with&nbsp;&#34;dir&#34;,&nbsp;which&nbsp;is&nbsp;a&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="2941017">//&nbsp;containing&nbsp;the&nbsp;file&nbsp;&#34;a&#34;,&nbsp;the&nbsp;walk&nbsp;function&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment" id="2941092">//&nbsp;&#34;dir/a&#34;.&nbsp;The&nbsp;info&nbsp;argument&nbsp;is&nbsp;the&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;named&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2941161">//</span><br>
<span class="lineno"></span><span class="comment" id="2941164">//&nbsp;If&nbsp;there&nbsp;was&nbsp;a&nbsp;problem&nbsp;walking&nbsp;to&nbsp;the&nbsp;file&nbsp;or&nbsp;directory&nbsp;named&nbsp;by&nbsp;path,&nbsp;the</span><br>
<span class="lineno">335</span><span class="comment" id="2941242">//&nbsp;incoming&nbsp;error&nbsp;will&nbsp;describe&nbsp;the&nbsp;problem&nbsp;and&nbsp;the&nbsp;function&nbsp;can&nbsp;decide&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="2941318">//&nbsp;to&nbsp;handle&nbsp;that&nbsp;error&nbsp;(and&nbsp;Walk&nbsp;will&nbsp;not&nbsp;descend&nbsp;into&nbsp;that&nbsp;directory).&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="2941394">//&nbsp;an&nbsp;error&nbsp;is&nbsp;returned,&nbsp;processing&nbsp;stops.&nbsp;The&nbsp;sole&nbsp;exception&nbsp;is&nbsp;that&nbsp;if&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="2941472">//&nbsp;is&nbsp;a&nbsp;directory&nbsp;and&nbsp;the&nbsp;function&nbsp;returns&nbsp;the&nbsp;special&nbsp;value&nbsp;SkipDir,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2941546">//&nbsp;contents&nbsp;of&nbsp;the&nbsp;directory&nbsp;are&nbsp;skipped&nbsp;and&nbsp;processing&nbsp;continues&nbsp;as&nbsp;usual&nbsp;on</span><br>
<span class="lineno">340</span><span class="comment" id="2941624">//&nbsp;the&nbsp;next&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="2941642">type</span>&nbsp;<span class="ident" id="2941647">WalkFunc</span>&nbsp;<span class="keyword" id="2941656">func</span><span class="op" id="2941660">(</span><span class="ident" id="2941661">path</span>&nbsp;<span class="builtintype" id="2941666">string</span><span class="op" id="2941672">,</span>&nbsp;<span class="ident" id="2941674">info</span>&nbsp;<span class="ident" id="2941679">os</span><span class="op" id="2941681">.</span><span class="ident" id="2941682">FileInfo</span><span class="op" id="2941690">,</span>&nbsp;<span class="ident" id="2941692">err</span>&nbsp;<span class="builtintype" id="2941696">error</span><span class="op" id="2941701">)</span>&nbsp;<span class="builtintype" id="2941703">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2941710">var</span>&nbsp;<span class="ident" id="2941714">lstat</span>&nbsp;<span class="op" id="2941720">=</span>&nbsp;<span class="ident" id="2941722">os</span><span class="op" id="2941724">.</span><span class="ident" id="2941725">Lstat</span>&nbsp;<span class="comment" id="2941731">//&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="2941747">//&nbsp;walk&nbsp;recursively&nbsp;descends&nbsp;path,&nbsp;calling&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="2941793">func</span>&nbsp;<span class="ident" id="2941798">walk</span><span class="op" id="2941802">(</span><span class="ident" id="2941803">path</span>&nbsp;<span class="builtintype" id="2941808">string</span><span class="op" id="2941814">,</span>&nbsp;<span class="ident" id="2941816">info</span>&nbsp;<span class="ident" id="2941821">os</span><span class="op" id="2941823">.</span><span class="ident" id="2941824">FileInfo</span><span class="op" id="2941832">,</span>&nbsp;<span class="ident" id="2941834">walkFn</span>&nbsp;<span class="ident" id="2941841">WalkFunc</span><span class="op" id="2941849">)</span>&nbsp;<span class="builtintype" id="2941851">error</span>&nbsp;<span class="op" id="2941857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2941860">err</span>&nbsp;<span class="op" id="2941864">:=</span>&nbsp;<span class="ident" id="2941867">walkFn</span><span class="op" id="2941873">(</span><span class="ident" id="2941874">path</span><span class="op" id="2941878">,</span>&nbsp;<span class="ident" id="2941880">info</span><span class="op" id="2941884">,</span>&nbsp;<span class="ident" id="2941886">nil</span><span class="op" id="2941889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941892">if</span>&nbsp;<span class="ident" id="2941895">err</span>&nbsp;<span class="op" id="2941899">!=</span>&nbsp;<span class="ident" id="2941902">nil</span>&nbsp;<span class="op" id="2941906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941910">if</span>&nbsp;<span class="ident" id="2941913">info</span><span class="op" id="2941917">.</span><span class="ident" id="2941918">IsDir</span><span class="op" id="2941923">(</span><span class="op" id="2941924">)</span>&nbsp;<span class="op" id="2941926">&amp;&amp;</span>&nbsp;<span class="ident" id="2941929">err</span>&nbsp;<span class="op" id="2941933">==</span>&nbsp;<span class="ident" id="2941936">SkipDir</span>&nbsp;<span class="op" id="2941944">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941949">return</span>&nbsp;<span class="ident" id="2941956">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941966">return</span>&nbsp;<span class="ident" id="2941973">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2941978">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2941982">if</span>&nbsp;<span class="op" id="2941985">!</span><span class="ident" id="2941986">info</span><span class="op" id="2941990">.</span><span class="ident" id="2941991">IsDir</span><span class="op" id="2941996">(</span><span class="op" id="2941997">)</span>&nbsp;<span class="op" id="2941999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942003">return</span>&nbsp;<span class="ident" id="2942010">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942019">names</span><span class="op" id="2942024">,</span>&nbsp;<span class="ident" id="2942026">err</span>&nbsp;<span class="op" id="2942030">:=</span>&nbsp;<span class="ident" id="2942033">readDirNames</span><span class="op" id="2942045">(</span><span class="ident" id="2942046">path</span><span class="op" id="2942050">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942053">if</span>&nbsp;<span class="ident" id="2942056">err</span>&nbsp;<span class="op" id="2942060">!=</span>&nbsp;<span class="ident" id="2942063">nil</span>&nbsp;<span class="op" id="2942067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942071">return</span>&nbsp;<span class="ident" id="2942078">walkFn</span><span class="op" id="2942084">(</span><span class="ident" id="2942085">path</span><span class="op" id="2942089">,</span>&nbsp;<span class="ident" id="2942091">info</span><span class="op" id="2942095">,</span>&nbsp;<span class="ident" id="2942097">err</span><span class="op" id="2942100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942107">for</span>&nbsp;<span class="ident" id="2942111">_</span><span class="op" id="2942112">,</span>&nbsp;<span class="ident" id="2942114">name</span>&nbsp;<span class="op" id="2942119">:=</span>&nbsp;<span class="keyword" id="2942122">range</span>&nbsp;<span class="ident" id="2942128">names</span>&nbsp;<span class="op" id="2942134">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942138">filename</span>&nbsp;<span class="op" id="2942147">:=</span>&nbsp;<span class="ident" id="2942150">Join</span><span class="op" id="2942154">(</span><span class="ident" id="2942155">path</span><span class="op" id="2942159">,</span>&nbsp;<span class="ident" id="2942161">name</span><span class="op" id="2942165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942169">fileInfo</span><span class="op" id="2942177">,</span>&nbsp;<span class="ident" id="2942179">err</span>&nbsp;<span class="op" id="2942183">:=</span>&nbsp;<span class="ident" id="2942186">lstat</span><span class="op" id="2942191">(</span><span class="ident" id="2942192">filename</span><span class="op" id="2942200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942204">if</span>&nbsp;<span class="ident" id="2942207">err</span>&nbsp;<span class="op" id="2942211">!=</span>&nbsp;<span class="ident" id="2942214">nil</span>&nbsp;<span class="op" id="2942218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942223">if</span>&nbsp;<span class="ident" id="2942226">err</span>&nbsp;<span class="op" id="2942230">:=</span>&nbsp;<span class="ident" id="2942233">walkFn</span><span class="op" id="2942239">(</span><span class="ident" id="2942240">filename</span><span class="op" id="2942248">,</span>&nbsp;<span class="ident" id="2942250">fileInfo</span><span class="op" id="2942258">,</span>&nbsp;<span class="ident" id="2942260">err</span><span class="op" id="2942263">)</span><span class="op" id="2942264">;</span>&nbsp;<span class="ident" id="2942266">err</span>&nbsp;<span class="op" id="2942270">!=</span>&nbsp;<span class="ident" id="2942273">nil</span>&nbsp;<span class="op" id="2942277">&amp;&amp;</span>&nbsp;<span class="ident" id="2942280">err</span>&nbsp;<span class="op" id="2942284">!=</span>&nbsp;<span class="ident" id="2942287">SkipDir</span>&nbsp;<span class="op" id="2942295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942301">return</span>&nbsp;<span class="ident" id="2942308">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942319">}</span>&nbsp;<span class="keyword" id="2942321">else</span>&nbsp;<span class="op" id="2942326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942331">err</span>&nbsp;<span class="op" id="2942335">=</span>&nbsp;<span class="ident" id="2942337">walk</span><span class="op" id="2942341">(</span><span class="ident" id="2942342">filename</span><span class="op" id="2942350">,</span>&nbsp;<span class="ident" id="2942352">fileInfo</span><span class="op" id="2942360">,</span>&nbsp;<span class="ident" id="2942362">walkFn</span><span class="op" id="2942368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942373">if</span>&nbsp;<span class="ident" id="2942376">err</span>&nbsp;<span class="op" id="2942380">!=</span>&nbsp;<span class="ident" id="2942383">nil</span>&nbsp;<span class="op" id="2942387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942393">if</span>&nbsp;<span class="op" id="2942396">!</span><span class="ident" id="2942397">fileInfo</span><span class="op" id="2942405">.</span><span class="ident" id="2942406">IsDir</span><span class="op" id="2942411">(</span><span class="op" id="2942412">)</span>&nbsp;<span class="op" id="2942414">||</span>&nbsp;<span class="ident" id="2942417">err</span>&nbsp;<span class="op" id="2942421">!=</span>&nbsp;<span class="ident" id="2942424">SkipDir</span>&nbsp;<span class="op" id="2942432">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942439">return</span>&nbsp;<span class="ident" id="2942446">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942466">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942469">return</span>&nbsp;<span class="ident" id="2942476">nil</span><br>
<span class="lineno"></span><span class="op" id="2942480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2942483">//&nbsp;Walk&nbsp;walks&nbsp;the&nbsp;file&nbsp;tree&nbsp;rooted&nbsp;at&nbsp;root,&nbsp;calling&nbsp;walkFn&nbsp;for&nbsp;each&nbsp;file&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2942559">//&nbsp;directory&nbsp;in&nbsp;the&nbsp;tree,&nbsp;including&nbsp;root.&nbsp;All&nbsp;errors&nbsp;that&nbsp;arise&nbsp;visiting&nbsp;files</span><br>
<span class="lineno">385</span><span class="comment" id="2942638">//&nbsp;and&nbsp;directories&nbsp;are&nbsp;filtered&nbsp;by&nbsp;walkFn.&nbsp;The&nbsp;files&nbsp;are&nbsp;walked&nbsp;in&nbsp;lexical</span><br>
<span class="lineno"></span><span class="comment" id="2942713">//&nbsp;order,&nbsp;which&nbsp;makes&nbsp;the&nbsp;output&nbsp;deterministic&nbsp;but&nbsp;means&nbsp;that&nbsp;for&nbsp;very</span><br>
<span class="lineno"></span><span class="comment" id="2942784">//&nbsp;large&nbsp;directories&nbsp;Walk&nbsp;can&nbsp;be&nbsp;inefficient.</span><br>
<span class="lineno"></span><span class="comment" id="2942830">//&nbsp;Walk&nbsp;does&nbsp;not&nbsp;follow&nbsp;symbolic&nbsp;links.</span><br>
<span class="lineno"></span><span class="keyword" id="2942870">func</span>&nbsp;<span class="ident" id="2942875">Walk</span><span class="op" id="2942879">(</span><span class="ident" id="2942880">root</span>&nbsp;<span class="builtintype" id="2942885">string</span><span class="op" id="2942891">,</span>&nbsp;<span class="ident" id="2942893">walkFn</span>&nbsp;<span class="ident" id="2942900">WalkFunc</span><span class="op" id="2942908">)</span>&nbsp;<span class="builtintype" id="2942910">error</span>&nbsp;<span class="op" id="2942916">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2942919">info</span><span class="op" id="2942923">,</span>&nbsp;<span class="ident" id="2942925">err</span>&nbsp;<span class="op" id="2942929">:=</span>&nbsp;<span class="ident" id="2942932">os</span><span class="op" id="2942934">.</span><span class="ident" id="2942935">Lstat</span><span class="op" id="2942940">(</span><span class="ident" id="2942941">root</span><span class="op" id="2942945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942948">if</span>&nbsp;<span class="ident" id="2942951">err</span>&nbsp;<span class="op" id="2942955">!=</span>&nbsp;<span class="ident" id="2942958">nil</span>&nbsp;<span class="op" id="2942962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2942966">return</span>&nbsp;<span class="ident" id="2942973">walkFn</span><span class="op" id="2942979">(</span><span class="ident" id="2942980">root</span><span class="op" id="2942984">,</span>&nbsp;<span class="ident" id="2942986">nil</span><span class="op" id="2942989">,</span>&nbsp;<span class="ident" id="2942991">err</span><span class="op" id="2942994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2942997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943000">return</span>&nbsp;<span class="ident" id="2943007">walk</span><span class="op" id="2943011">(</span><span class="ident" id="2943012">root</span><span class="op" id="2943016">,</span>&nbsp;<span class="ident" id="2943018">info</span><span class="op" id="2943022">,</span>&nbsp;<span class="ident" id="2943024">walkFn</span><span class="op" id="2943030">)</span><br>
<span class="lineno">395</span><span class="op" id="2943032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2943035">//&nbsp;readDirNames&nbsp;reads&nbsp;the&nbsp;directory&nbsp;named&nbsp;by&nbsp;dirname&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2943100">//&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;directory&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="2943139">func</span>&nbsp;<span class="ident" id="2943144">readDirNames</span><span class="op" id="2943156">(</span><span class="ident" id="2943157">dirname</span>&nbsp;<span class="builtintype" id="2943165">string</span><span class="op" id="2943171">)</span>&nbsp;<span class="op" id="2943173">(</span><span class="op" id="2943174">[</span><span class="op" id="2943175">]</span><span class="builtintype" id="2943176">string</span><span class="op" id="2943182">,</span>&nbsp;<span class="builtintype" id="2943184">error</span><span class="op" id="2943189">)</span>&nbsp;<span class="op" id="2943191">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943194">f</span><span class="op" id="2943195">,</span>&nbsp;<span class="ident" id="2943197">err</span>&nbsp;<span class="op" id="2943201">:=</span>&nbsp;<span class="ident" id="2943204">os</span><span class="op" id="2943206">.</span><span class="ident" id="2943207">Open</span><span class="op" id="2943211">(</span><span class="ident" id="2943212">dirname</span><span class="op" id="2943219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943222">if</span>&nbsp;<span class="ident" id="2943225">err</span>&nbsp;<span class="op" id="2943229">!=</span>&nbsp;<span class="ident" id="2943232">nil</span>&nbsp;<span class="op" id="2943236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943240">return</span>&nbsp;<span class="ident" id="2943247">nil</span><span class="op" id="2943250">,</span>&nbsp;<span class="ident" id="2943252">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943260">names</span><span class="op" id="2943265">,</span>&nbsp;<span class="ident" id="2943267">err</span>&nbsp;<span class="op" id="2943271">:=</span>&nbsp;<span class="ident" id="2943274">f</span><span class="op" id="2943275">.</span><span class="ident" id="2943276">Readdirnames</span><span class="op" id="2943288">(</span><span class="op" id="2943289">-</span><span class="num" id="2943290">1</span><span class="op" id="2943291">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943294">f</span><span class="op" id="2943295">.</span><span class="ident" id="2943296">Close</span><span class="op" id="2943301">(</span><span class="op" id="2943302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943305">if</span>&nbsp;<span class="ident" id="2943308">err</span>&nbsp;<span class="op" id="2943312">!=</span>&nbsp;<span class="ident" id="2943315">nil</span>&nbsp;<span class="op" id="2943319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943323">return</span>&nbsp;<span class="ident" id="2943330">nil</span><span class="op" id="2943333">,</span>&nbsp;<span class="ident" id="2943335">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943343">sort</span><span class="op" id="2943347">.</span><span class="ident" id="2943348">Strings</span><span class="op" id="2943355">(</span><span class="ident" id="2943356">names</span><span class="op" id="2943361">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943364">return</span>&nbsp;<span class="ident" id="2943371">names</span><span class="op" id="2943376">,</span>&nbsp;<span class="ident" id="2943378">nil</span><br>
<span class="lineno"></span><span class="op" id="2943382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2943385">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2943427">//&nbsp;Trailing&nbsp;path&nbsp;separators&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno">415</span><span class="comment" id="2943503">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2943546">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Base&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="keyword" id="2943627">func</span>&nbsp;<span class="ident" id="2943632">Base</span><span class="op" id="2943636">(</span><span class="ident" id="2943637">path</span>&nbsp;<span class="builtintype" id="2943642">string</span><span class="op" id="2943648">)</span>&nbsp;<span class="builtintype" id="2943650">string</span>&nbsp;<span class="op" id="2943657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943660">if</span>&nbsp;<span class="ident" id="2943663">path</span>&nbsp;<span class="op" id="2943668">==</span>&nbsp;<span class="string" id="2943671">&#34;&#34;</span>&nbsp;<span class="op" id="2943674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943678">return</span>&nbsp;<span class="string" id="2943685">&#34;.&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943693">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943721">for</span>&nbsp;<span class="builtinfunc" id="2943725">len</span><span class="op" id="2943728">(</span><span class="ident" id="2943729">path</span><span class="op" id="2943733">)</span>&nbsp;<span class="op" id="2943735">&gt;</span>&nbsp;<span class="num" id="2943737">0</span>&nbsp;<span class="op" id="2943739">&amp;&amp;</span>&nbsp;<span class="ident" id="2943742">os</span><span class="op" id="2943744">.</span><span class="ident" id="2943745">IsPathSeparator</span><span class="op" id="2943760">(</span><span class="ident" id="2943761">path</span><span class="op" id="2943765">[</span><span class="builtinfunc" id="2943766">len</span><span class="op" id="2943769">(</span><span class="ident" id="2943770">path</span><span class="op" id="2943774">)</span><span class="op" id="2943775">-</span><span class="num" id="2943776">1</span><span class="op" id="2943777">]</span><span class="op" id="2943778">)</span>&nbsp;<span class="op" id="2943780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943784">path</span>&nbsp;<span class="op" id="2943789">=</span>&nbsp;<span class="ident" id="2943791">path</span><span class="op" id="2943795">[</span><span class="num" id="2943796">0</span>&nbsp;<span class="op" id="2943798">:</span>&nbsp;<span class="builtinfunc" id="2943800">len</span><span class="op" id="2943803">(</span><span class="ident" id="2943804">path</span><span class="op" id="2943808">)</span><span class="op" id="2943809">-</span><span class="num" id="2943810">1</span><span class="op" id="2943811">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943814">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943817">//&nbsp;Throw&nbsp;away&nbsp;volume&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943844">path</span>&nbsp;<span class="op" id="2943849">=</span>&nbsp;<span class="ident" id="2943851">path</span><span class="op" id="2943855">[</span><span class="builtinfunc" id="2943856">len</span><span class="op" id="2943859">(</span><span class="ident" id="2943860">VolumeName</span><span class="op" id="2943870">(</span><span class="ident" id="2943871">path</span><span class="op" id="2943875">)</span><span class="op" id="2943876">)</span><span class="op" id="2943877">:</span><span class="op" id="2943878">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2943881">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943907">i</span>&nbsp;<span class="op" id="2943909">:=</span>&nbsp;<span class="builtinfunc" id="2943912">len</span><span class="op" id="2943915">(</span><span class="ident" id="2943916">path</span><span class="op" id="2943920">)</span>&nbsp;<span class="op" id="2943922">-</span>&nbsp;<span class="num" id="2943924">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943927">for</span>&nbsp;<span class="ident" id="2943931">i</span>&nbsp;<span class="op" id="2943933">&gt;=</span>&nbsp;<span class="num" id="2943936">0</span>&nbsp;<span class="op" id="2943938">&amp;&amp;</span>&nbsp;<span class="op" id="2943941">!</span><span class="ident" id="2943942">os</span><span class="op" id="2943944">.</span><span class="ident" id="2943945">IsPathSeparator</span><span class="op" id="2943960">(</span><span class="ident" id="2943961">path</span><span class="op" id="2943965">[</span><span class="ident" id="2943966">i</span><span class="op" id="2943967">]</span><span class="op" id="2943968">)</span>&nbsp;<span class="op" id="2943970">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943974">i</span><span class="op" id="2943975">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2943979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2943982">if</span>&nbsp;<span class="ident" id="2943985">i</span>&nbsp;<span class="op" id="2943987">&gt;=</span>&nbsp;<span class="num" id="2943990">0</span>&nbsp;<span class="op" id="2943992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2943996">path</span>&nbsp;<span class="op" id="2944001">=</span>&nbsp;<span class="ident" id="2944003">path</span><span class="op" id="2944007">[</span><span class="ident" id="2944008">i</span><span class="op" id="2944009">+</span><span class="num" id="2944010">1</span><span class="op" id="2944011">:</span><span class="op" id="2944012">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944015">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2944018">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944057">if</span>&nbsp;<span class="ident" id="2944060">path</span>&nbsp;<span class="op" id="2944065">==</span>&nbsp;<span class="string" id="2944068">&#34;&#34;</span>&nbsp;<span class="op" id="2944071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944075">return</span>&nbsp;<span class="builtintype" id="2944082">string</span><span class="op" id="2944088">(</span><span class="ident" id="2944089">Separator</span><span class="op" id="2944098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944104">return</span>&nbsp;<span class="ident" id="2944111">path</span><br>
<span class="lineno">440</span><span class="op" id="2944116">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2944119">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="2944200">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2944270">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno">445</span><span class="comment" id="2944294">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2944336">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Dir&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="comment" id="2944416">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a&nbsp;separator&nbsp;unless&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="2944498">func</span>&nbsp;<span class="ident" id="2944503">Dir</span><span class="op" id="2944506">(</span><span class="ident" id="2944507">path</span>&nbsp;<span class="builtintype" id="2944512">string</span><span class="op" id="2944518">)</span>&nbsp;<span class="builtintype" id="2944520">string</span>&nbsp;<span class="op" id="2944527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2944530">vol</span>&nbsp;<span class="op" id="2944534">:=</span>&nbsp;<span class="ident" id="2944537">VolumeName</span><span class="op" id="2944547">(</span><span class="ident" id="2944548">path</span><span class="op" id="2944552">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2944555">i</span>&nbsp;<span class="op" id="2944557">:=</span>&nbsp;<span class="builtinfunc" id="2944560">len</span><span class="op" id="2944563">(</span><span class="ident" id="2944564">path</span><span class="op" id="2944568">)</span>&nbsp;<span class="op" id="2944570">-</span>&nbsp;<span class="num" id="2944572">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944575">for</span>&nbsp;<span class="ident" id="2944579">i</span>&nbsp;<span class="op" id="2944581">&gt;=</span>&nbsp;<span class="builtinfunc" id="2944584">len</span><span class="op" id="2944587">(</span><span class="ident" id="2944588">vol</span><span class="op" id="2944591">)</span>&nbsp;<span class="op" id="2944593">&amp;&amp;</span>&nbsp;<span class="op" id="2944596">!</span><span class="ident" id="2944597">os</span><span class="op" id="2944599">.</span><span class="ident" id="2944600">IsPathSeparator</span><span class="op" id="2944615">(</span><span class="ident" id="2944616">path</span><span class="op" id="2944620">[</span><span class="ident" id="2944621">i</span><span class="op" id="2944622">]</span><span class="op" id="2944623">)</span>&nbsp;<span class="op" id="2944625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2944629">i</span><span class="op" id="2944630">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2944634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2944637">dir</span>&nbsp;<span class="op" id="2944641">:=</span>&nbsp;<span class="ident" id="2944644">Clean</span><span class="op" id="2944649">(</span><span class="ident" id="2944650">path</span><span class="op" id="2944654">[</span><span class="builtinfunc" id="2944655">len</span><span class="op" id="2944658">(</span><span class="ident" id="2944659">vol</span><span class="op" id="2944662">)</span>&nbsp;<span class="op" id="2944664">:</span>&nbsp;<span class="ident" id="2944666">i</span><span class="op" id="2944667">+</span><span class="num" id="2944668">1</span><span class="op" id="2944669">]</span><span class="op" id="2944670">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944673">return</span>&nbsp;<span class="ident" id="2944680">vol</span>&nbsp;<span class="op" id="2944684">+</span>&nbsp;<span class="ident" id="2944686">dir</span><br>
<span class="lineno"></span><span class="op" id="2944690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2944693">//&nbsp;VolumeName&nbsp;returns&nbsp;leading&nbsp;volume&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="2944736">//&nbsp;Given&nbsp;&#34;C:\foo\bar&#34;&nbsp;it&nbsp;returns&nbsp;&#34;C:&#34;&nbsp;under&nbsp;windows.</span><br>
<span class="lineno">460</span><span class="comment" id="2944789">//&nbsp;Given&nbsp;&#34;\\host\share\foo&#34;&nbsp;it&nbsp;returns&nbsp;&#34;\\host\share&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2944844">//&nbsp;On&nbsp;other&nbsp;platforms&nbsp;it&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2944881">func</span>&nbsp;<span class="ident" id="2944886">VolumeName</span><span class="op" id="2944896">(</span><span class="ident" id="2944897">path</span>&nbsp;<span class="builtintype" id="2944902">string</span><span class="op" id="2944908">)</span>&nbsp;<span class="op" id="2944910">(</span><span class="ident" id="2944911">v</span>&nbsp;<span class="builtintype" id="2944913">string</span><span class="op" id="2944919">)</span>&nbsp;<span class="op" id="2944921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2944924">return</span>&nbsp;<span class="ident" id="2944931">path</span><span class="op" id="2944935">[</span><span class="op" id="2944936">:</span><span class="ident" id="2944937">volumeNameLen</span><span class="op" id="2944950">(</span><span class="ident" id="2944951">path</span><span class="op" id="2944955">)</span><span class="op" id="2944956">]</span><br>
<span class="lineno"></span><span class="op" id="2944958">}</span>
</div>
</body>
</html>
