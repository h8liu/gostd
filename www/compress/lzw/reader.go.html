<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6272548">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6272603">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6272657">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6272708">//&nbsp;Package&nbsp;lzw&nbsp;implements&nbsp;the&nbsp;Lempel-Ziv-Welch&nbsp;compressed&nbsp;data&nbsp;format,</span><br>
<span class="lineno"></span><span class="comment" id="6272779">//&nbsp;described&nbsp;in&nbsp;T.&nbsp;A.&nbsp;Welch,&nbsp;``A&nbsp;Technique&nbsp;for&nbsp;High-Performance&nbsp;Data</span><br>
<span class="lineno"></span><span class="comment" id="6272848">//&nbsp;Compression&#39;&#39;,&nbsp;Computer,&nbsp;17(6)&nbsp;(June&nbsp;1984),&nbsp;pp&nbsp;8-19.</span><br>
<span class="lineno"></span><span class="comment" id="6272904">//</span><br>
<span class="lineno"></span><span class="comment" id="6272907">//&nbsp;In&nbsp;particular,&nbsp;it&nbsp;implements&nbsp;LZW&nbsp;as&nbsp;used&nbsp;by&nbsp;the&nbsp;GIF&nbsp;and&nbsp;PDF&nbsp;file</span><br>
<span class="lineno">10</span><span class="comment" id="6272975">//&nbsp;formats,&nbsp;which&nbsp;means&nbsp;variable-width&nbsp;codes&nbsp;up&nbsp;to&nbsp;12&nbsp;bits&nbsp;and&nbsp;the&nbsp;first</span><br>
<span class="lineno"></span><span class="comment" id="6273048">//&nbsp;two&nbsp;non-literal&nbsp;codes&nbsp;are&nbsp;a&nbsp;clear&nbsp;code&nbsp;and&nbsp;an&nbsp;EOF&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="6273107">//</span><br>
<span class="lineno"></span><span class="comment" id="6273110">//&nbsp;The&nbsp;TIFF&nbsp;file&nbsp;format&nbsp;uses&nbsp;a&nbsp;similar&nbsp;but&nbsp;incompatible&nbsp;version&nbsp;of&nbsp;the&nbsp;LZW</span><br>
<span class="lineno"></span><span class="comment" id="6273185">//&nbsp;algorithm.&nbsp;See&nbsp;the&nbsp;golang.org/x/image/tiff/lzw&nbsp;package&nbsp;for&nbsp;an</span><br>
<span class="lineno">15</span><span class="comment" id="6273250">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="6273269">package</span>&nbsp;<span class="ident" id="6273277">lzw</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6273282">//&nbsp;TODO(nigeltao):&nbsp;check&nbsp;that&nbsp;PDF&nbsp;uses&nbsp;LZW&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;as&nbsp;GIF,</span><br>
<span class="lineno"></span><span class="comment" id="6273349">//&nbsp;modulo&nbsp;LSB/MSB&nbsp;packing&nbsp;order.</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6273383">import</span>&nbsp;<span class="op" id="6273390">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6273393">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6273402">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6273412">&#34;fmt&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6273419">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6273424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6273427">//&nbsp;Order&nbsp;specifies&nbsp;the&nbsp;bit&nbsp;ordering&nbsp;in&nbsp;an&nbsp;LZW&nbsp;data&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6273486">type</span>&nbsp;<span class="ident" id="6273491">Order</span>&nbsp;<span class="builtintype" id="6273497">int</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6273502">const</span>&nbsp;<span class="op" id="6273508">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273511">//&nbsp;LSB&nbsp;means&nbsp;Least&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;GIF&nbsp;file&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273587">LSB</span>&nbsp;<span class="ident" id="6273591"><a href="/compress/lzw/reader.go.html#6273491">Order</a></span>&nbsp;<span class="op" id="6273597">=</span>&nbsp;<span class="ident" id="6273599">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273605">//&nbsp;MSB&nbsp;means&nbsp;Most&nbsp;Significant&nbsp;Bits&nbsp;first,&nbsp;as&nbsp;used&nbsp;in&nbsp;the&nbsp;TIFF&nbsp;and&nbsp;PDF</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6273676">//&nbsp;file&nbsp;formats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273694">MSB</span><br>
<span class="lineno"></span><span class="op" id="6273698">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6273701">const</span>&nbsp;<span class="op" id="6273707">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273710">maxWidth</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6273729">=</span>&nbsp;<span class="num" id="6273731">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273735">decoderInvalidCode</span>&nbsp;<span class="op" id="6273754">=</span>&nbsp;<span class="num" id="6273756">0xffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273764">flushBuffer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6273783">=</span>&nbsp;<span class="num" id="6273785">1</span>&nbsp;<span class="op" id="6273787">&lt;&lt;</span>&nbsp;<span class="ident" id="6273790"><a href="/compress/lzw/reader.go.html#6273710">maxWidth</a></span><br>
<span class="lineno"></span><span class="op" id="6273799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6273802">//&nbsp;decoder&nbsp;is&nbsp;the&nbsp;state&nbsp;from&nbsp;which&nbsp;the&nbsp;readXxx&nbsp;method&nbsp;converts&nbsp;a&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="6273872">//&nbsp;stream&nbsp;into&nbsp;a&nbsp;code&nbsp;stream.</span><br>
<span class="lineno"></span><span class="keyword" id="6273902">type</span>&nbsp;<span class="ident" id="6273907">decoder</span>&nbsp;<span class="keyword" id="6273915">struct</span>&nbsp;<span class="op" id="6273922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273925">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6273934"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6273936">.</span><span class="ident" id="6273937">ByteReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273949">bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6273958">uint32</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273966">nBits</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6273975">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273981">width</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6273990">uint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6273996">read</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6274005">func</span><span class="op" id="6274009">(</span><span class="op" id="6274010">*</span><span class="ident" id="6274011"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6274018">)</span>&nbsp;<span class="op" id="6274020">(</span><span class="builtintype" id="6274021">uint16</span><span class="op" id="6274027">,</span>&nbsp;<span class="builtintype" id="6274029">error</span><span class="op" id="6274034">)</span>&nbsp;<span class="comment" id="6274036">//&nbsp;readLSB&nbsp;or&nbsp;readMSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274059">litWidth</span>&nbsp;<span class="builtintype" id="6274068">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6274099">//&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274134">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6274143">error</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274151">//&nbsp;The&nbsp;first&nbsp;1&lt;&lt;litWidth&nbsp;codes&nbsp;are&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274202">//&nbsp;The&nbsp;next&nbsp;two&nbsp;codes&nbsp;mean&nbsp;clear&nbsp;and&nbsp;EOF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274245">//&nbsp;Other&nbsp;valid&nbsp;codes&nbsp;are&nbsp;in&nbsp;the&nbsp;range&nbsp;[lo,&nbsp;hi]&nbsp;where&nbsp;lo&nbsp;:=&nbsp;clear&nbsp;+&nbsp;2,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274316">//&nbsp;with&nbsp;the&nbsp;upper&nbsp;bound&nbsp;incrementing&nbsp;on&nbsp;each&nbsp;code&nbsp;seen.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274373">//&nbsp;overflow&nbsp;is&nbsp;the&nbsp;code&nbsp;at&nbsp;which&nbsp;hi&nbsp;overflows&nbsp;the&nbsp;code&nbsp;width.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274436">//&nbsp;last&nbsp;is&nbsp;the&nbsp;most&nbsp;recently&nbsp;seen&nbsp;code,&nbsp;or&nbsp;decoderInvalidCode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274500">clear</span><span class="op" id="6274505">,</span>&nbsp;<span class="ident" id="6274507">eof</span><span class="op" id="6274510">,</span>&nbsp;<span class="ident" id="6274512">hi</span><span class="op" id="6274514">,</span>&nbsp;<span class="ident" id="6274516">overflow</span><span class="op" id="6274524">,</span>&nbsp;<span class="ident" id="6274526">last</span>&nbsp;<span class="builtintype" id="6274531">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274540">//&nbsp;Each&nbsp;code&nbsp;c&nbsp;in&nbsp;[lo,&nbsp;hi]&nbsp;expands&nbsp;to&nbsp;two&nbsp;or&nbsp;more&nbsp;bytes.&nbsp;For&nbsp;c&nbsp;!=&nbsp;hi:</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274611">//&nbsp;&nbsp;&nbsp;suffix[c]&nbsp;is&nbsp;the&nbsp;last&nbsp;of&nbsp;these&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274655">//&nbsp;&nbsp;&nbsp;prefix[c]&nbsp;is&nbsp;the&nbsp;code&nbsp;for&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274710">//&nbsp;&nbsp;&nbsp;This&nbsp;code&nbsp;can&nbsp;either&nbsp;be&nbsp;a&nbsp;literal&nbsp;code&nbsp;or&nbsp;another&nbsp;code&nbsp;in&nbsp;[lo,&nbsp;c).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274783">//&nbsp;The&nbsp;c&nbsp;==&nbsp;hi&nbsp;case&nbsp;is&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274823">suffix</span>&nbsp;<span class="op" id="6274830">[</span><span class="num" id="6274831">1</span>&nbsp;<span class="op" id="6274833">&lt;&lt;</span>&nbsp;<span class="ident" id="6274836"><a href="/compress/lzw/reader.go.html#6273710">maxWidth</a></span><span class="op" id="6274844">]</span><span class="builtintype" id="6274845">uint8</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6274852">prefix</span>&nbsp;<span class="op" id="6274859">[</span><span class="num" id="6274860">1</span>&nbsp;<span class="op" id="6274862">&lt;&lt;</span>&nbsp;<span class="ident" id="6274865"><a href="/compress/lzw/reader.go.html#6273710">maxWidth</a></span><span class="op" id="6274873">]</span><span class="builtintype" id="6274874">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274883">//&nbsp;output&nbsp;is&nbsp;the&nbsp;temporary&nbsp;output&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274926">//&nbsp;Literal&nbsp;codes&nbsp;are&nbsp;accumulated&nbsp;from&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6274990">//&nbsp;Non-literal&nbsp;codes&nbsp;decode&nbsp;to&nbsp;a&nbsp;sequence&nbsp;of&nbsp;suffixes&nbsp;that&nbsp;are&nbsp;first</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275060">//&nbsp;written&nbsp;right-to-left&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;buffer&nbsp;before&nbsp;being&nbsp;copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275133">//&nbsp;to&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275165">//&nbsp;It&nbsp;is&nbsp;flushed&nbsp;when&nbsp;it&nbsp;contains&nbsp;&gt;=&nbsp;1&lt;&lt;maxWidth&nbsp;bytes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6275222">//&nbsp;so&nbsp;that&nbsp;there&nbsp;is&nbsp;always&nbsp;room&nbsp;to&nbsp;decode&nbsp;an&nbsp;entire&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275281">output</span>&nbsp;<span class="op" id="6275288">[</span><span class="num" id="6275289">2</span>&nbsp;<span class="op" id="6275291">*</span>&nbsp;<span class="num" id="6275293">1</span>&nbsp;<span class="op" id="6275295">&lt;&lt;</span>&nbsp;<span class="ident" id="6275298"><a href="/compress/lzw/reader.go.html#6273710">maxWidth</a></span><span class="op" id="6275306">]</span><span class="builtintype" id="6275307">byte</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275313">o</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6275320">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6275327">//&nbsp;write&nbsp;index&nbsp;into&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275355">toRead</span>&nbsp;<span class="op" id="6275362">[</span><span class="op" id="6275363">]</span><span class="builtintype" id="6275364">byte</span>&nbsp;<span class="comment" id="6275369">//&nbsp;bytes&nbsp;to&nbsp;return&nbsp;from&nbsp;Read</span><br>
<span class="lineno"></span><span class="op" id="6275398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6275401">//&nbsp;readLSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Least&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno">85</span><span class="keyword" id="6275475">func</span>&nbsp;<span class="op" id="6275480">(</span><span class="ident" id="6275481">d</span>&nbsp;<span class="op" id="6275483">*</span><span class="ident" id="6275484"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6275491">)</span>&nbsp;<span class="ident" id="6275493">readLSB</span><span class="op" id="6275500">(</span><span class="op" id="6275501">)</span>&nbsp;<span class="op" id="6275503">(</span><span class="builtintype" id="6275504">uint16</span><span class="op" id="6275510">,</span>&nbsp;<span class="builtintype" id="6275512">error</span><span class="op" id="6275517">)</span>&nbsp;<span class="op" id="6275519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275522">for</span>&nbsp;<span class="ident" id="6275526"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275527">.</span><span class="ident" id="6275528">nBits</span>&nbsp;<span class="op" id="6275534">&lt;</span>&nbsp;<span class="ident" id="6275536"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275537">.</span><span class="ident" id="6275538">width</span>&nbsp;<span class="op" id="6275544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275548">x</span><span class="op" id="6275549">,</span>&nbsp;<span class="ident" id="6275551">err</span>&nbsp;<span class="op" id="6275555">:=</span>&nbsp;<span class="ident" id="6275558"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275559">.</span><span class="ident" id="6275560">r</span><span class="op" id="6275561">.</span><span class="ident" id="6275562">ReadByte</span><span class="op" id="6275570">(</span><span class="op" id="6275571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275575">if</span>&nbsp;<span class="ident" id="6275578"><a href="/compress/lzw/reader.go.html#6275551">err</a></span>&nbsp;<span class="op" id="6275582">!=</span>&nbsp;<span class="ident" id="6275585">nil</span>&nbsp;<span class="op" id="6275589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275594">return</span>&nbsp;<span class="num" id="6275601">0</span><span class="op" id="6275602">,</span>&nbsp;<span class="ident" id="6275604"><a href="/compress/lzw/reader.go.html#6275551">err</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275614"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275615">.</span><span class="ident" id="6275616">bits</span>&nbsp;<span class="op" id="6275621">|=</span>&nbsp;<span class="builtintype" id="6275624">uint32</span><span class="op" id="6275630">(</span><span class="ident" id="6275631"><a href="/compress/lzw/reader.go.html#6275548">x</a></span><span class="op" id="6275632">)</span>&nbsp;<span class="op" id="6275634">&lt;&lt;</span>&nbsp;<span class="ident" id="6275637"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275638">.</span><span class="ident" id="6275639">nBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275647"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275648">.</span><span class="ident" id="6275649">nBits</span>&nbsp;<span class="op" id="6275655">+=</span>&nbsp;<span class="num" id="6275658">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275664">code</span>&nbsp;<span class="op" id="6275669">:=</span>&nbsp;<span class="builtintype" id="6275672">uint16</span><span class="op" id="6275678">(</span><span class="ident" id="6275679"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275680">.</span><span class="ident" id="6275681">bits</span>&nbsp;<span class="op" id="6275686">&amp;</span>&nbsp;<span class="op" id="6275688">(</span><span class="num" id="6275689">1</span><span class="op" id="6275690">&lt;&lt;</span><span class="ident" id="6275692"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275693">.</span><span class="ident" id="6275694">width</span>&nbsp;<span class="op" id="6275700">-</span>&nbsp;<span class="num" id="6275702">1</span><span class="op" id="6275703">)</span><span class="op" id="6275704">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275707"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275708">.</span><span class="ident" id="6275709">bits</span>&nbsp;<span class="op" id="6275714">&gt;&gt;=</span>&nbsp;<span class="ident" id="6275718"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275719">.</span><span class="ident" id="6275720">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275727"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275728">.</span><span class="ident" id="6275729">nBits</span>&nbsp;<span class="op" id="6275735">-=</span>&nbsp;<span class="ident" id="6275738"><a href="/compress/lzw/reader.go.html#6275481">d</a></span><span class="op" id="6275739">.</span><span class="ident" id="6275740">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275747">return</span>&nbsp;<span class="ident" id="6275754"><a href="/compress/lzw/reader.go.html#6275664">code</a></span><span class="op" id="6275758">,</span>&nbsp;<span class="ident" id="6275760">nil</span><br>
<span class="lineno"></span><span class="op" id="6275764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="6275767">//&nbsp;readMSB&nbsp;returns&nbsp;the&nbsp;next&nbsp;code&nbsp;for&nbsp;&#34;Most&nbsp;Significant&nbsp;Bits&nbsp;first&#34;&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="6275840">func</span>&nbsp;<span class="op" id="6275845">(</span><span class="ident" id="6275846">d</span>&nbsp;<span class="op" id="6275848">*</span><span class="ident" id="6275849"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6275856">)</span>&nbsp;<span class="ident" id="6275858">readMSB</span><span class="op" id="6275865">(</span><span class="op" id="6275866">)</span>&nbsp;<span class="op" id="6275868">(</span><span class="builtintype" id="6275869">uint16</span><span class="op" id="6275875">,</span>&nbsp;<span class="builtintype" id="6275877">error</span><span class="op" id="6275882">)</span>&nbsp;<span class="op" id="6275884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275887">for</span>&nbsp;<span class="ident" id="6275891"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6275892">.</span><span class="ident" id="6275893">nBits</span>&nbsp;<span class="op" id="6275899">&lt;</span>&nbsp;<span class="ident" id="6275901"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6275902">.</span><span class="ident" id="6275903">width</span>&nbsp;<span class="op" id="6275909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275913">x</span><span class="op" id="6275914">,</span>&nbsp;<span class="ident" id="6275916">err</span>&nbsp;<span class="op" id="6275920">:=</span>&nbsp;<span class="ident" id="6275923"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6275924">.</span><span class="ident" id="6275925">r</span><span class="op" id="6275926">.</span><span class="ident" id="6275927">ReadByte</span><span class="op" id="6275935">(</span><span class="op" id="6275936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275940">if</span>&nbsp;<span class="ident" id="6275943"><a href="/compress/lzw/reader.go.html#6275916">err</a></span>&nbsp;<span class="op" id="6275947">!=</span>&nbsp;<span class="ident" id="6275950">nil</span>&nbsp;<span class="op" id="6275954">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6275959">return</span>&nbsp;<span class="num" id="6275966">0</span><span class="op" id="6275967">,</span>&nbsp;<span class="ident" id="6275969"><a href="/compress/lzw/reader.go.html#6275916">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6275975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6275979"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6275980">.</span><span class="ident" id="6275981">bits</span>&nbsp;<span class="op" id="6275986">|=</span>&nbsp;<span class="builtintype" id="6275989">uint32</span><span class="op" id="6275995">(</span><span class="ident" id="6275996"><a href="/compress/lzw/reader.go.html#6275913">x</a></span><span class="op" id="6275997">)</span>&nbsp;<span class="op" id="6275999">&lt;&lt;</span>&nbsp;<span class="op" id="6276002">(</span><span class="num" id="6276003">24</span>&nbsp;<span class="op" id="6276006">-</span>&nbsp;<span class="ident" id="6276008"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276009">.</span><span class="ident" id="6276010">nBits</span><span class="op" id="6276015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276019"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276020">.</span><span class="ident" id="6276021">nBits</span>&nbsp;<span class="op" id="6276027">+=</span>&nbsp;<span class="num" id="6276030">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276033">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276036">code</span>&nbsp;<span class="op" id="6276041">:=</span>&nbsp;<span class="builtintype" id="6276044">uint16</span><span class="op" id="6276050">(</span><span class="ident" id="6276051"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276052">.</span><span class="ident" id="6276053">bits</span>&nbsp;<span class="op" id="6276058">&gt;&gt;</span>&nbsp;<span class="op" id="6276061">(</span><span class="num" id="6276062">32</span>&nbsp;<span class="op" id="6276065">-</span>&nbsp;<span class="ident" id="6276067"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276068">.</span><span class="ident" id="6276069">width</span><span class="op" id="6276074">)</span><span class="op" id="6276075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276078"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276079">.</span><span class="ident" id="6276080">bits</span>&nbsp;<span class="op" id="6276085">&lt;&lt;=</span>&nbsp;<span class="ident" id="6276089"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276090">.</span><span class="ident" id="6276091">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276098"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276099">.</span><span class="ident" id="6276100">nBits</span>&nbsp;<span class="op" id="6276106">-=</span>&nbsp;<span class="ident" id="6276109"><a href="/compress/lzw/reader.go.html#6275846">d</a></span><span class="op" id="6276110">.</span><span class="ident" id="6276111">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276118">return</span>&nbsp;<span class="ident" id="6276125"><a href="/compress/lzw/reader.go.html#6276036">code</a></span><span class="op" id="6276129">,</span>&nbsp;<span class="ident" id="6276131">nil</span><br>
<span class="lineno"></span><span class="op" id="6276135">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="keyword" id="6276138">func</span>&nbsp;<span class="op" id="6276143">(</span><span class="ident" id="6276144">d</span>&nbsp;<span class="op" id="6276146">*</span><span class="ident" id="6276147"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6276154">)</span>&nbsp;<span class="ident" id="6276156">Read</span><span class="op" id="6276160">(</span><span class="ident" id="6276161">b</span>&nbsp;<span class="op" id="6276163">[</span><span class="op" id="6276164">]</span><span class="builtintype" id="6276165">byte</span><span class="op" id="6276169">)</span>&nbsp;<span class="op" id="6276171">(</span><span class="builtintype" id="6276172">int</span><span class="op" id="6276175">,</span>&nbsp;<span class="builtintype" id="6276177">error</span><span class="op" id="6276182">)</span>&nbsp;<span class="op" id="6276184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276187">for</span>&nbsp;<span class="op" id="6276191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276195">if</span>&nbsp;<span class="builtinfunc" id="6276198">len</span><span class="op" id="6276201">(</span><span class="ident" id="6276202"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276203">.</span><span class="ident" id="6276204">toRead</span><span class="op" id="6276210">)</span>&nbsp;<span class="op" id="6276212">&gt;</span>&nbsp;<span class="num" id="6276214">0</span>&nbsp;<span class="op" id="6276216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276221">n</span>&nbsp;<span class="op" id="6276223">:=</span>&nbsp;<span class="builtinfunc" id="6276226">copy</span><span class="op" id="6276230">(</span><span class="ident" id="6276231"><a href="/compress/lzw/reader.go.html#6276161">b</a></span><span class="op" id="6276232">,</span>&nbsp;<span class="ident" id="6276234"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276235">.</span><span class="ident" id="6276236">toRead</span><span class="op" id="6276242">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276247"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276248">.</span><span class="ident" id="6276249">toRead</span>&nbsp;<span class="op" id="6276256">=</span>&nbsp;<span class="ident" id="6276258"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276259">.</span><span class="ident" id="6276260">toRead</span><span class="op" id="6276266">[</span><span class="ident" id="6276267"><a href="/compress/lzw/reader.go.html#6276221">n</a></span><span class="op" id="6276268">:</span><span class="op" id="6276269">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276274">return</span>&nbsp;<span class="ident" id="6276281"><a href="/compress/lzw/reader.go.html#6276221">n</a></span><span class="op" id="6276282">,</span>&nbsp;<span class="ident" id="6276284">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276294">if</span>&nbsp;<span class="ident" id="6276297"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276298">.</span><span class="ident" id="6276299">err</span>&nbsp;<span class="op" id="6276303">!=</span>&nbsp;<span class="ident" id="6276306">nil</span>&nbsp;<span class="op" id="6276310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276315">return</span>&nbsp;<span class="num" id="6276322">0</span><span class="op" id="6276323">,</span>&nbsp;<span class="ident" id="6276325"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276326">.</span><span class="ident" id="6276327">err</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276337"><a href="/compress/lzw/reader.go.html#6276144">d</a></span><span class="op" id="6276338">.</span><span class="ident" id="6276339">decode</span><span class="op" id="6276345">(</span><span class="op" id="6276346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276349">}</span><br>
<span class="lineno"></span><span class="op" id="6276351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="6276354">//&nbsp;decode&nbsp;decompresses&nbsp;bytes&nbsp;from&nbsp;r&nbsp;and&nbsp;leaves&nbsp;them&nbsp;in&nbsp;d.toRead.</span><br>
<span class="lineno"></span><span class="comment" id="6276419">//&nbsp;read&nbsp;specifies&nbsp;how&nbsp;to&nbsp;decode&nbsp;bytes&nbsp;into&nbsp;codes.</span><br>
<span class="lineno"></span><span class="comment" id="6276469">//&nbsp;litWidth&nbsp;is&nbsp;the&nbsp;width&nbsp;in&nbsp;bits&nbsp;of&nbsp;literal&nbsp;codes.</span><br>
<span class="lineno"></span><span class="keyword" id="6276520">func</span>&nbsp;<span class="op" id="6276525">(</span><span class="ident" id="6276526">d</span>&nbsp;<span class="op" id="6276528">*</span><span class="ident" id="6276529"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6276536">)</span>&nbsp;<span class="ident" id="6276538">decode</span><span class="op" id="6276544">(</span><span class="op" id="6276545">)</span>&nbsp;<span class="op" id="6276547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6276550">//&nbsp;Loop&nbsp;over&nbsp;the&nbsp;code&nbsp;stream,&nbsp;converting&nbsp;codes&nbsp;into&nbsp;decompressed&nbsp;bytes.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276623">for</span>&nbsp;<span class="op" id="6276627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276631">code</span><span class="op" id="6276635">,</span>&nbsp;<span class="ident" id="6276637">err</span>&nbsp;<span class="op" id="6276641">:=</span>&nbsp;<span class="ident" id="6276644"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276645">.</span><span class="ident" id="6276646">read</span><span class="op" id="6276650">(</span><span class="ident" id="6276651"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276656">if</span>&nbsp;<span class="ident" id="6276659"><a href="/compress/lzw/reader.go.html#6276637">err</a></span>&nbsp;<span class="op" id="6276663">!=</span>&nbsp;<span class="ident" id="6276666">nil</span>&nbsp;<span class="op" id="6276670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276675">if</span>&nbsp;<span class="ident" id="6276678"><a href="/compress/lzw/reader.go.html#6276637">err</a></span>&nbsp;<span class="op" id="6276682">==</span>&nbsp;<span class="ident" id="6276685"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6276687">.</span><span class="ident" id="6276688">EOF</span>&nbsp;<span class="op" id="6276692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276698"><a href="/compress/lzw/reader.go.html#6276637">err</a></span>&nbsp;<span class="op" id="6276702">=</span>&nbsp;<span class="ident" id="6276704"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6276706">.</span><span class="ident" id="6276707">ErrUnexpectedEOF</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276732"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276733">.</span><span class="ident" id="6276734">err</span>&nbsp;<span class="op" id="6276738">=</span>&nbsp;<span class="ident" id="6276740"><a href="/compress/lzw/reader.go.html#6276637">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276747">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6276756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276760">switch</span>&nbsp;<span class="op" id="6276767">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276771">case</span>&nbsp;<span class="ident" id="6276776"><a href="/compress/lzw/reader.go.html#6276631">code</a></span>&nbsp;<span class="op" id="6276781">&lt;</span>&nbsp;<span class="ident" id="6276783"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276784">.</span><span class="ident" id="6276785">clear</span><span class="op" id="6276790">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6276795">//&nbsp;We&nbsp;have&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276825"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276826">.</span><span class="ident" id="6276827">output</span><span class="op" id="6276833">[</span><span class="ident" id="6276834"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276835">.</span><span class="ident" id="6276836">o</span><span class="op" id="6276837">]</span>&nbsp;<span class="op" id="6276839">=</span>&nbsp;<span class="builtintype" id="6276841">uint8</span><span class="op" id="6276846">(</span><span class="ident" id="6276847"><a href="/compress/lzw/reader.go.html#6276631">code</a></span><span class="op" id="6276851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276856"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276857">.</span><span class="ident" id="6276858">o</span><span class="op" id="6276859">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6276865">if</span>&nbsp;<span class="ident" id="6276868"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276869">.</span><span class="ident" id="6276870">last</span>&nbsp;<span class="op" id="6276875">!=</span>&nbsp;<span class="ident" id="6276878"><a href="/compress/lzw/reader.go.html#6273735">decoderInvalidCode</a></span>&nbsp;<span class="op" id="6276897">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6276903">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276944"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276945">.</span><span class="ident" id="6276946">suffix</span><span class="op" id="6276952">[</span><span class="ident" id="6276953"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276954">.</span><span class="ident" id="6276955">hi</span><span class="op" id="6276957">]</span>&nbsp;<span class="op" id="6276959">=</span>&nbsp;<span class="builtintype" id="6276961">uint8</span><span class="op" id="6276966">(</span><span class="ident" id="6276967"><a href="/compress/lzw/reader.go.html#6276631">code</a></span><span class="op" id="6276971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6276977"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276978">.</span><span class="ident" id="6276979">prefix</span><span class="op" id="6276985">[</span><span class="ident" id="6276986"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276987">.</span><span class="ident" id="6276988">hi</span><span class="op" id="6276990">]</span>&nbsp;<span class="op" id="6276992">=</span>&nbsp;<span class="ident" id="6276994"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6276995">.</span><span class="ident" id="6276996">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277008">case</span>&nbsp;<span class="ident" id="6277013"><a href="/compress/lzw/reader.go.html#6276631">code</a></span>&nbsp;<span class="op" id="6277018">==</span>&nbsp;<span class="ident" id="6277021"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277022">.</span><span class="ident" id="6277023">clear</span><span class="op" id="6277028">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277033"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277034">.</span><span class="ident" id="6277035">width</span>&nbsp;<span class="op" id="6277041">=</span>&nbsp;<span class="num" id="6277043">1</span>&nbsp;<span class="op" id="6277045">+</span>&nbsp;<span class="builtintype" id="6277047">uint</span><span class="op" id="6277051">(</span><span class="ident" id="6277052"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277053">.</span><span class="ident" id="6277054">litWidth</span><span class="op" id="6277062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277067"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277068">.</span><span class="ident" id="6277069">hi</span>&nbsp;<span class="op" id="6277072">=</span>&nbsp;<span class="ident" id="6277074"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277075">.</span><span class="ident" id="6277076">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277083"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277084">.</span><span class="ident" id="6277085">overflow</span>&nbsp;<span class="op" id="6277094">=</span>&nbsp;<span class="num" id="6277096">1</span>&nbsp;<span class="op" id="6277098">&lt;&lt;</span>&nbsp;<span class="ident" id="6277101"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277102">.</span><span class="ident" id="6277103">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277112"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277113">.</span><span class="ident" id="6277114">last</span>&nbsp;<span class="op" id="6277119">=</span>&nbsp;<span class="ident" id="6277121"><a href="/compress/lzw/reader.go.html#6273735">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277143">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277154">case</span>&nbsp;<span class="ident" id="6277159"><a href="/compress/lzw/reader.go.html#6276631">code</a></span>&nbsp;<span class="op" id="6277164">==</span>&nbsp;<span class="ident" id="6277167"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277168">.</span><span class="ident" id="6277169">eof</span><span class="op" id="6277172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277177"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277178">.</span><span class="ident" id="6277179">flush</span><span class="op" id="6277184">(</span><span class="op" id="6277185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277190"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277191">.</span><span class="ident" id="6277192">err</span>&nbsp;<span class="op" id="6277196">=</span>&nbsp;<span class="ident" id="6277198"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6277200">.</span><span class="ident" id="6277201">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277208">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277217">case</span>&nbsp;<span class="ident" id="6277222"><a href="/compress/lzw/reader.go.html#6276631">code</a></span>&nbsp;<span class="op" id="6277227">&lt;=</span>&nbsp;<span class="ident" id="6277230"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277231">.</span><span class="ident" id="6277232">hi</span><span class="op" id="6277234">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277239">c</span><span class="op" id="6277240">,</span>&nbsp;<span class="ident" id="6277242">i</span>&nbsp;<span class="op" id="6277244">:=</span>&nbsp;<span class="ident" id="6277247"><a href="/compress/lzw/reader.go.html#6276631">code</a></span><span class="op" id="6277251">,</span>&nbsp;<span class="builtinfunc" id="6277253">len</span><span class="op" id="6277256">(</span><span class="ident" id="6277257"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277258">.</span><span class="ident" id="6277259">output</span><span class="op" id="6277265">)</span><span class="op" id="6277266">-</span><span class="num" id="6277267">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277272">if</span>&nbsp;<span class="ident" id="6277275"><a href="/compress/lzw/reader.go.html#6276631">code</a></span>&nbsp;<span class="op" id="6277280">==</span>&nbsp;<span class="ident" id="6277283"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277284">.</span><span class="ident" id="6277285">hi</span>&nbsp;<span class="op" id="6277288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6277294">//&nbsp;code&nbsp;==&nbsp;hi&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;which&nbsp;expands&nbsp;to&nbsp;the&nbsp;last&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6277366">//&nbsp;followed&nbsp;by&nbsp;the&nbsp;head&nbsp;of&nbsp;the&nbsp;last&nbsp;expansion.&nbsp;To&nbsp;find&nbsp;the&nbsp;head,&nbsp;we&nbsp;walk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6277443">//&nbsp;the&nbsp;prefix&nbsp;chain&nbsp;until&nbsp;we&nbsp;find&nbsp;a&nbsp;literal&nbsp;code.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277497"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277499">=</span>&nbsp;<span class="ident" id="6277501"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277502">.</span><span class="ident" id="6277503">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277512">for</span>&nbsp;<span class="ident" id="6277516"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277518">&gt;=</span>&nbsp;<span class="ident" id="6277521"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277522">.</span><span class="ident" id="6277523">clear</span>&nbsp;<span class="op" id="6277529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277536"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277538">=</span>&nbsp;<span class="ident" id="6277540"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277541">.</span><span class="ident" id="6277542">prefix</span><span class="op" id="6277548">[</span><span class="ident" id="6277549"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277550">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277562"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277563">.</span><span class="ident" id="6277564">output</span><span class="op" id="6277570">[</span><span class="ident" id="6277571"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277572">]</span>&nbsp;<span class="op" id="6277574">=</span>&nbsp;<span class="builtintype" id="6277576">uint8</span><span class="op" id="6277581">(</span><span class="ident" id="6277582"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277583">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277589"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277590">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277597"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277599">=</span>&nbsp;<span class="ident" id="6277601"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277602">.</span><span class="ident" id="6277603">last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6277616">//&nbsp;Copy&nbsp;the&nbsp;suffix&nbsp;chain&nbsp;into&nbsp;output&nbsp;and&nbsp;then&nbsp;write&nbsp;that&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277682">for</span>&nbsp;<span class="ident" id="6277686"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277688">&gt;=</span>&nbsp;<span class="ident" id="6277691"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277692">.</span><span class="ident" id="6277693">clear</span>&nbsp;<span class="op" id="6277699">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277705"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277706">.</span><span class="ident" id="6277707">output</span><span class="op" id="6277713">[</span><span class="ident" id="6277714"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277715">]</span>&nbsp;<span class="op" id="6277717">=</span>&nbsp;<span class="ident" id="6277719"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277720">.</span><span class="ident" id="6277721">suffix</span><span class="op" id="6277727">[</span><span class="ident" id="6277728"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277729">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277735"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277736">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277743"><a href="/compress/lzw/reader.go.html#6277239">c</a></span>&nbsp;<span class="op" id="6277745">=</span>&nbsp;<span class="ident" id="6277747"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277748">.</span><span class="ident" id="6277749">prefix</span><span class="op" id="6277755">[</span><span class="ident" id="6277756"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277757">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277767"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277768">.</span><span class="ident" id="6277769">output</span><span class="op" id="6277775">[</span><span class="ident" id="6277776"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277777">]</span>&nbsp;<span class="op" id="6277779">=</span>&nbsp;<span class="builtintype" id="6277781">uint8</span><span class="op" id="6277786">(</span><span class="ident" id="6277787"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277788">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277793"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277794">.</span><span class="ident" id="6277795">o</span>&nbsp;<span class="op" id="6277797">+=</span>&nbsp;<span class="builtinfunc" id="6277800">copy</span><span class="op" id="6277804">(</span><span class="ident" id="6277805"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277806">.</span><span class="ident" id="6277807">output</span><span class="op" id="6277813">[</span><span class="ident" id="6277814"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277815">.</span><span class="ident" id="6277816">o</span><span class="op" id="6277817">:</span><span class="op" id="6277818">]</span><span class="op" id="6277819">,</span>&nbsp;<span class="ident" id="6277821"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277822">.</span><span class="ident" id="6277823">output</span><span class="op" id="6277829">[</span><span class="ident" id="6277830"><a href="/compress/lzw/reader.go.html#6277242">i</a></span><span class="op" id="6277831">:</span><span class="op" id="6277832">]</span><span class="op" id="6277833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277838">if</span>&nbsp;<span class="ident" id="6277841"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277842">.</span><span class="ident" id="6277843">last</span>&nbsp;<span class="op" id="6277848">!=</span>&nbsp;<span class="ident" id="6277851"><a href="/compress/lzw/reader.go.html#6273735">decoderInvalidCode</a></span>&nbsp;<span class="op" id="6277870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6277876">//&nbsp;Save&nbsp;what&nbsp;the&nbsp;hi&nbsp;code&nbsp;expands&nbsp;to.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277917"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277918">.</span><span class="ident" id="6277919">suffix</span><span class="op" id="6277925">[</span><span class="ident" id="6277926"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277927">.</span><span class="ident" id="6277928">hi</span><span class="op" id="6277930">]</span>&nbsp;<span class="op" id="6277932">=</span>&nbsp;<span class="builtintype" id="6277934">uint8</span><span class="op" id="6277939">(</span><span class="ident" id="6277940"><a href="/compress/lzw/reader.go.html#6277239">c</a></span><span class="op" id="6277941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277947"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277948">.</span><span class="ident" id="6277949">prefix</span><span class="op" id="6277955">[</span><span class="ident" id="6277956"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277957">.</span><span class="ident" id="6277958">hi</span><span class="op" id="6277960">]</span>&nbsp;<span class="op" id="6277962">=</span>&nbsp;<span class="ident" id="6277964"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277965">.</span><span class="ident" id="6277966">last</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6277974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6277978">default</span><span class="op" id="6277985">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6277990"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6277991">.</span><span class="ident" id="6277992">err</span>&nbsp;<span class="op" id="6277996">=</span>&nbsp;<span class="ident" id="6277998"><a href="/compress/lzw/reader.go.html#6273402">errors</a></span><span class="op" id="6278004">.</span><span class="ident" id="6278005">New</span><span class="op" id="6278008">(</span><span class="string" id="6278009">&#34;lzw:&nbsp;invalid&nbsp;code&#34;</span><span class="op" id="6278028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278033">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278042">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278046"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278047">.</span><span class="ident" id="6278048">last</span><span class="op" id="6278052">,</span>&nbsp;<span class="ident" id="6278054"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278055">.</span><span class="ident" id="6278056">hi</span>&nbsp;<span class="op" id="6278059">=</span>&nbsp;<span class="ident" id="6278061"><a href="/compress/lzw/reader.go.html#6276631">code</a></span><span class="op" id="6278065">,</span>&nbsp;<span class="ident" id="6278067"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278068">.</span><span class="ident" id="6278069">hi</span><span class="op" id="6278071">+</span><span class="num" id="6278072">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278076">if</span>&nbsp;<span class="ident" id="6278079"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278080">.</span><span class="ident" id="6278081">hi</span>&nbsp;<span class="op" id="6278084">&gt;=</span>&nbsp;<span class="ident" id="6278087"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278088">.</span><span class="ident" id="6278089">overflow</span>&nbsp;<span class="op" id="6278098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278103">if</span>&nbsp;<span class="ident" id="6278106"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278107">.</span><span class="ident" id="6278108">width</span>&nbsp;<span class="op" id="6278114">==</span>&nbsp;<span class="ident" id="6278117"><a href="/compress/lzw/reader.go.html#6273710">maxWidth</a></span>&nbsp;<span class="op" id="6278126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278132"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278133">.</span><span class="ident" id="6278134">last</span>&nbsp;<span class="op" id="6278139">=</span>&nbsp;<span class="ident" id="6278141"><a href="/compress/lzw/reader.go.html#6273735">decoderInvalidCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278163">}</span>&nbsp;<span class="keyword" id="6278165">else</span>&nbsp;<span class="op" id="6278170">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278176"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278177">.</span><span class="ident" id="6278178">width</span><span class="op" id="6278183">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278190"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278191">.</span><span class="ident" id="6278192">overflow</span>&nbsp;<span class="op" id="6278201">&lt;&lt;=</span>&nbsp;<span class="num" id="6278205">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278218">if</span>&nbsp;<span class="ident" id="6278221"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278222">.</span><span class="ident" id="6278223">o</span>&nbsp;<span class="op" id="6278225">&gt;=</span>&nbsp;<span class="ident" id="6278228"><a href="/compress/lzw/reader.go.html#6273764">flushBuffer</a></span>&nbsp;<span class="op" id="6278240">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278245"><a href="/compress/lzw/reader.go.html#6276526">d</a></span><span class="op" id="6278246">.</span><span class="ident" id="6278247">flush</span><span class="op" id="6278252">(</span><span class="op" id="6278253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278258">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6278270">}</span><br>
<span class="lineno"></span><span class="op" id="6278272">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="6278275">func</span>&nbsp;<span class="op" id="6278280">(</span><span class="ident" id="6278281">d</span>&nbsp;<span class="op" id="6278283">*</span><span class="ident" id="6278284"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6278291">)</span>&nbsp;<span class="ident" id="6278293">flush</span><span class="op" id="6278298">(</span><span class="op" id="6278299">)</span>&nbsp;<span class="op" id="6278301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278304"><a href="/compress/lzw/reader.go.html#6278281">d</a></span><span class="op" id="6278305">.</span><span class="ident" id="6278306">toRead</span>&nbsp;<span class="op" id="6278313">=</span>&nbsp;<span class="ident" id="6278315"><a href="/compress/lzw/reader.go.html#6278281">d</a></span><span class="op" id="6278316">.</span><span class="ident" id="6278317">output</span><span class="op" id="6278323">[</span><span class="op" id="6278324">:</span><span class="ident" id="6278325"><a href="/compress/lzw/reader.go.html#6278281">d</a></span><span class="op" id="6278326">.</span><span class="ident" id="6278327">o</span><span class="op" id="6278328">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278331"><a href="/compress/lzw/reader.go.html#6278281">d</a></span><span class="op" id="6278332">.</span><span class="ident" id="6278333">o</span>&nbsp;<span class="op" id="6278335">=</span>&nbsp;<span class="num" id="6278337">0</span><br>
<span class="lineno"></span><span class="op" id="6278339">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6278342">var</span>&nbsp;<span class="ident" id="6278346">errClosed</span>&nbsp;<span class="op" id="6278356">=</span>&nbsp;<span class="ident" id="6278358"><a href="/compress/lzw/reader.go.html#6273402">errors</a></span><span class="op" id="6278364">.</span><span class="ident" id="6278365">New</span><span class="op" id="6278368">(</span><span class="string" id="6278369">&#34;compress/lzw:&nbsp;reader/writer&nbsp;is&nbsp;closed&#34;</span><span class="op" id="6278408">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6278411">func</span>&nbsp;<span class="op" id="6278416">(</span><span class="ident" id="6278417">d</span>&nbsp;<span class="op" id="6278419">*</span><span class="ident" id="6278420"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6278427">)</span>&nbsp;<span class="ident" id="6278429">Close</span><span class="op" id="6278434">(</span><span class="op" id="6278435">)</span>&nbsp;<span class="builtintype" id="6278437">error</span>&nbsp;<span class="op" id="6278443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6278446"><a href="/compress/lzw/reader.go.html#6278417">d</a></span><span class="op" id="6278447">.</span><span class="ident" id="6278448">err</span>&nbsp;<span class="op" id="6278452">=</span>&nbsp;<span class="ident" id="6278454"><a href="/compress/lzw/reader.go.html#6278346">errClosed</a></span>&nbsp;<span class="comment" id="6278464">//&nbsp;in&nbsp;case&nbsp;any&nbsp;Reads&nbsp;come&nbsp;along</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6278497">return</span>&nbsp;<span class="ident" id="6278504">nil</span><br>
<span class="lineno"></span><span class="op" id="6278508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6278511">//&nbsp;NewReader&nbsp;creates&nbsp;a&nbsp;new&nbsp;io.ReadCloser.</span><br>
<span class="lineno"></span><span class="comment" id="6278553">//&nbsp;Reads&nbsp;from&nbsp;the&nbsp;returned&nbsp;io.ReadCloser&nbsp;read&nbsp;and&nbsp;decompress&nbsp;data&nbsp;from&nbsp;r.</span><br>
<span class="lineno">225</span><span class="comment" id="6278627">//&nbsp;If&nbsp;r&nbsp;does&nbsp;not&nbsp;also&nbsp;implement&nbsp;io.ByteReader,</span><br>
<span class="lineno"></span><span class="comment" id="6278674">//&nbsp;the&nbsp;decompressor&nbsp;may&nbsp;read&nbsp;more&nbsp;data&nbsp;than&nbsp;necessary&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6278736">//&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;call&nbsp;Close&nbsp;on&nbsp;the&nbsp;ReadCloser&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="6278810">//&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="comment" id="6278831">//&nbsp;The&nbsp;number&nbsp;of&nbsp;bits&nbsp;to&nbsp;use&nbsp;for&nbsp;literal&nbsp;codes,&nbsp;litWidth,&nbsp;must&nbsp;be&nbsp;in&nbsp;the</span><br>
<span class="lineno">230</span><span class="comment" id="6278904">//&nbsp;range&nbsp;[2,8]&nbsp;and&nbsp;is&nbsp;typically&nbsp;8.</span><br>
<span class="lineno"></span><span class="keyword" id="6278939">func</span>&nbsp;<span class="ident" id="6278944">NewReader</span><span class="op" id="6278953">(</span><span class="ident" id="6278954">r</span>&nbsp;<span class="ident" id="6278956"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6278958">.</span><span class="ident" id="6278959">Reader</span><span class="op" id="6278965">,</span>&nbsp;<span class="ident" id="6278967">order</span>&nbsp;<span class="ident" id="6278973"><a href="/compress/lzw/reader.go.html#6273491">Order</a></span><span class="op" id="6278978">,</span>&nbsp;<span class="ident" id="6278980">litWidth</span>&nbsp;<span class="builtintype" id="6278989">int</span><span class="op" id="6278992">)</span>&nbsp;<span class="ident" id="6278994"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6278996">.</span><span class="ident" id="6278997">ReadCloser</span>&nbsp;<span class="op" id="6279008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279011">d</span>&nbsp;<span class="op" id="6279013">:=</span>&nbsp;<span class="builtinfunc" id="6279016">new</span><span class="op" id="6279019">(</span><span class="ident" id="6279020"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6279027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279030">switch</span>&nbsp;<span class="ident" id="6279037"><a href="/compress/lzw/reader.go.html#6278967">order</a></span>&nbsp;<span class="op" id="6279043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279046">case</span>&nbsp;<span class="ident" id="6279051"><a href="/compress/lzw/reader.go.html#6273587">LSB</a></span><span class="op" id="6279054">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279058"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279059">.</span><span class="ident" id="6279060">read</span>&nbsp;<span class="op" id="6279065">=</span>&nbsp;<span class="op" id="6279067">(</span><span class="op" id="6279068">*</span><span class="ident" id="6279069"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6279076">)</span><span class="op" id="6279077">.</span><span class="ident" id="6279078">readLSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279087">case</span>&nbsp;<span class="ident" id="6279092"><a href="/compress/lzw/reader.go.html#6273694">MSB</a></span><span class="op" id="6279095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279099"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279100">.</span><span class="ident" id="6279101">read</span>&nbsp;<span class="op" id="6279106">=</span>&nbsp;<span class="op" id="6279108">(</span><span class="op" id="6279109">*</span><span class="ident" id="6279110"><a href="/compress/lzw/reader.go.html#6273907">decoder</a></span><span class="op" id="6279117">)</span><span class="op" id="6279118">.</span><span class="ident" id="6279119">readMSB</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279128">default</span><span class="op" id="6279135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279139"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279140">.</span><span class="ident" id="6279141">err</span>&nbsp;<span class="op" id="6279145">=</span>&nbsp;<span class="ident" id="6279147"><a href="/compress/lzw/reader.go.html#6273402">errors</a></span><span class="op" id="6279153">.</span><span class="ident" id="6279154">New</span><span class="op" id="6279157">(</span><span class="string" id="6279158">&#34;lzw:&nbsp;unknown&nbsp;order&#34;</span><span class="op" id="6279178">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279182">return</span>&nbsp;<span class="ident" id="6279189"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6279192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279195">if</span>&nbsp;<span class="ident" id="6279198"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span>&nbsp;<span class="op" id="6279207">&lt;</span>&nbsp;<span class="num" id="6279209">2</span>&nbsp;<span class="op" id="6279211">||</span>&nbsp;<span class="num" id="6279214">8</span>&nbsp;<span class="op" id="6279216">&lt;</span>&nbsp;<span class="ident" id="6279218"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span>&nbsp;<span class="op" id="6279227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279231"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279232">.</span><span class="ident" id="6279233">err</span>&nbsp;<span class="op" id="6279237">=</span>&nbsp;<span class="ident" id="6279239"><a href="/compress/lzw/reader.go.html#6273412">fmt</a></span><span class="op" id="6279242">.</span><span class="ident" id="6279243">Errorf</span><span class="op" id="6279249">(</span><span class="string" id="6279250">&#34;lzw:&nbsp;litWidth&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&#34;</span><span class="op" id="6279281">,</span>&nbsp;<span class="ident" id="6279283"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span><span class="op" id="6279291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279295">return</span>&nbsp;<span class="ident" id="6279302"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6279305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279308">if</span>&nbsp;<span class="ident" id="6279311">br</span><span class="op" id="6279313">,</span>&nbsp;<span class="ident" id="6279315">ok</span>&nbsp;<span class="op" id="6279318">:=</span>&nbsp;<span class="ident" id="6279321"><a href="/compress/lzw/reader.go.html#6278954">r</a></span><span class="op" id="6279322">.</span><span class="op" id="6279323">(</span><span class="ident" id="6279324"><a href="/compress/lzw/reader.go.html#6273419">io</a></span><span class="op" id="6279326">.</span><span class="ident" id="6279327">ByteReader</span><span class="op" id="6279337">)</span><span class="op" id="6279338">;</span>&nbsp;<span class="ident" id="6279340"><a href="/compress/lzw/reader.go.html#6279315">ok</a></span>&nbsp;<span class="op" id="6279343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279347"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279348">.</span><span class="ident" id="6279349">r</span>&nbsp;<span class="op" id="6279351">=</span>&nbsp;<span class="ident" id="6279353"><a href="/compress/lzw/reader.go.html#6279311">br</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6279357">}</span>&nbsp;<span class="keyword" id="6279359">else</span>&nbsp;<span class="op" id="6279364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279368"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279369">.</span><span class="ident" id="6279370">r</span>&nbsp;<span class="op" id="6279372">=</span>&nbsp;<span class="ident" id="6279374"><a href="/compress/lzw/reader.go.html#6273393">bufio</a></span><span class="op" id="6279379">.</span><span class="ident" id="6279380">NewReader</span><span class="op" id="6279389">(</span><span class="ident" id="6279390"><a href="/compress/lzw/reader.go.html#6278954">r</a></span><span class="op" id="6279391">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6279394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279397"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279398">.</span><span class="ident" id="6279399">litWidth</span>&nbsp;<span class="op" id="6279408">=</span>&nbsp;<span class="ident" id="6279410"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279420"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279421">.</span><span class="ident" id="6279422">width</span>&nbsp;<span class="op" id="6279428">=</span>&nbsp;<span class="num" id="6279430">1</span>&nbsp;<span class="op" id="6279432">+</span>&nbsp;<span class="builtintype" id="6279434">uint</span><span class="op" id="6279438">(</span><span class="ident" id="6279439"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span><span class="op" id="6279447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279450"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279451">.</span><span class="ident" id="6279452">clear</span>&nbsp;<span class="op" id="6279458">=</span>&nbsp;<span class="builtintype" id="6279460">uint16</span><span class="op" id="6279466">(</span><span class="num" id="6279467">1</span><span class="op" id="6279468">)</span>&nbsp;<span class="op" id="6279470">&lt;&lt;</span>&nbsp;<span class="builtintype" id="6279473">uint</span><span class="op" id="6279477">(</span><span class="ident" id="6279478"><a href="/compress/lzw/reader.go.html#6278980">litWidth</a></span><span class="op" id="6279486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279489"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279490">.</span><span class="ident" id="6279491">eof</span><span class="op" id="6279494">,</span>&nbsp;<span class="ident" id="6279496"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279497">.</span><span class="ident" id="6279498">hi</span>&nbsp;<span class="op" id="6279501">=</span>&nbsp;<span class="ident" id="6279503"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279504">.</span><span class="ident" id="6279505">clear</span><span class="op" id="6279510">+</span><span class="num" id="6279511">1</span><span class="op" id="6279512">,</span>&nbsp;<span class="ident" id="6279514"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279515">.</span><span class="ident" id="6279516">clear</span><span class="op" id="6279521">+</span><span class="num" id="6279522">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279525"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279526">.</span><span class="ident" id="6279527">overflow</span>&nbsp;<span class="op" id="6279536">=</span>&nbsp;<span class="builtintype" id="6279538">uint16</span><span class="op" id="6279544">(</span><span class="num" id="6279545">1</span><span class="op" id="6279546">)</span>&nbsp;<span class="op" id="6279548">&lt;&lt;</span>&nbsp;<span class="ident" id="6279551"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279552">.</span><span class="ident" id="6279553">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6279560"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><span class="op" id="6279561">.</span><span class="ident" id="6279562">last</span>&nbsp;<span class="op" id="6279567">=</span>&nbsp;<span class="ident" id="6279569"><a href="/compress/lzw/reader.go.html#6273735">decoderInvalidCode</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6279590">return</span>&nbsp;<span class="ident" id="6279597"><a href="/compress/lzw/reader.go.html#6279011">d</a></span><br>
<span class="lineno"></span><span class="op" id="6279599">}</span>
</div>
</body>
</html>
