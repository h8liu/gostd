<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4021984">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4022040">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4022094">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4022145">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="4022216">package</span>&nbsp;<span class="ident" id="4022224">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022231">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4022294">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="4022349">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022425">const</span>&nbsp;<span class="op" id="4022431">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022434">replacementChar</span>&nbsp;<span class="op" id="4022450">=</span>&nbsp;<span class="string" id="4022452">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4022465">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022499">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022515">=</span>&nbsp;<span class="string" id="4022517">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="4022530">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="4022567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022570">const</span>&nbsp;<span class="op" id="4022576">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022579">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022633">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022686">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022731">surr1</span>&nbsp;<span class="op" id="4022737">=</span>&nbsp;<span class="num" id="4022739">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022747">surr2</span>&nbsp;<span class="op" id="4022753">=</span>&nbsp;<span class="num" id="4022755">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022763">surr3</span>&nbsp;<span class="op" id="4022769">=</span>&nbsp;<span class="num" id="4022771">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022780">surrSelf</span>&nbsp;<span class="op" id="4022789">=</span>&nbsp;<span class="num" id="4022791">0x10000</span><br>
<span class="lineno"></span><span class="op" id="4022799">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022802">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="4022866">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="4022901">func</span>&nbsp;<span class="ident" id="4022906">IsSurrogate</span><span class="op" id="4022917">(</span><span class="ident" id="4022918">r</span>&nbsp;<span class="builtintype" id="4022920">rune</span><span class="op" id="4022924">)</span>&nbsp;<span class="builtintype" id="4022926">bool</span>&nbsp;<span class="op" id="4022931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022934">return</span>&nbsp;<span class="ident" id="4022941">surr1</span>&nbsp;<span class="op" id="4022947">&lt;=</span>&nbsp;<span class="ident" id="4022950">r</span>&nbsp;<span class="op" id="4022952">&amp;&amp;</span>&nbsp;<span class="ident" id="4022955">r</span>&nbsp;<span class="op" id="4022957">&lt;</span>&nbsp;<span class="ident" id="4022959">surr3</span><br>
<span class="lineno"></span><span class="op" id="4022965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022968">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="4023031">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4023103">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4023149">func</span>&nbsp;<span class="ident" id="4023154">DecodeRune</span><span class="op" id="4023164">(</span><span class="ident" id="4023165">r1</span><span class="op" id="4023167">,</span>&nbsp;<span class="ident" id="4023169">r2</span>&nbsp;<span class="builtintype" id="4023172">rune</span><span class="op" id="4023176">)</span>&nbsp;<span class="builtintype" id="4023178">rune</span>&nbsp;<span class="op" id="4023183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023186">if</span>&nbsp;<span class="ident" id="4023189">surr1</span>&nbsp;<span class="op" id="4023195">&lt;=</span>&nbsp;<span class="ident" id="4023198">r1</span>&nbsp;<span class="op" id="4023201">&amp;&amp;</span>&nbsp;<span class="ident" id="4023204">r1</span>&nbsp;<span class="op" id="4023207">&lt;</span>&nbsp;<span class="ident" id="4023209">surr2</span>&nbsp;<span class="op" id="4023215">&amp;&amp;</span>&nbsp;<span class="ident" id="4023218">surr2</span>&nbsp;<span class="op" id="4023224">&lt;=</span>&nbsp;<span class="ident" id="4023227">r2</span>&nbsp;<span class="op" id="4023230">&amp;&amp;</span>&nbsp;<span class="ident" id="4023233">r2</span>&nbsp;<span class="op" id="4023236">&lt;</span>&nbsp;<span class="ident" id="4023238">surr3</span>&nbsp;<span class="op" id="4023244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023248">return</span>&nbsp;<span class="op" id="4023255">(</span><span class="ident" id="4023256">r1</span><span class="op" id="4023258">-</span><span class="ident" id="4023259">surr1</span><span class="op" id="4023264">)</span><span class="op" id="4023265">&lt;&lt;</span><span class="num" id="4023267">10</span>&nbsp;<span class="op" id="4023270">|</span>&nbsp;<span class="op" id="4023272">(</span><span class="ident" id="4023273">r2</span>&nbsp;<span class="op" id="4023276">-</span>&nbsp;<span class="ident" id="4023278">surr2</span><span class="op" id="4023283">)</span>&nbsp;<span class="op" id="4023285">+</span>&nbsp;<span class="num" id="4023287">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023299">return</span>&nbsp;<span class="ident" id="4023306">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="4023322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4023325">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4023400">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="4023476">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4023514">func</span>&nbsp;<span class="ident" id="4023519">EncodeRune</span><span class="op" id="4023529">(</span><span class="ident" id="4023530">r</span>&nbsp;<span class="builtintype" id="4023532">rune</span><span class="op" id="4023536">)</span>&nbsp;<span class="op" id="4023538">(</span><span class="ident" id="4023539">r1</span><span class="op" id="4023541">,</span>&nbsp;<span class="ident" id="4023543">r2</span>&nbsp;<span class="builtintype" id="4023546">rune</span><span class="op" id="4023550">)</span>&nbsp;<span class="op" id="4023552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023555">if</span>&nbsp;<span class="ident" id="4023558">r</span>&nbsp;<span class="op" id="4023560">&lt;</span>&nbsp;<span class="ident" id="4023562">surrSelf</span>&nbsp;<span class="op" id="4023571">||</span>&nbsp;<span class="ident" id="4023574">r</span>&nbsp;<span class="op" id="4023576">&gt;</span>&nbsp;<span class="ident" id="4023578">maxRune</span>&nbsp;<span class="op" id="4023586">||</span>&nbsp;<span class="ident" id="4023589">IsSurrogate</span><span class="op" id="4023600">(</span><span class="ident" id="4023601">r</span><span class="op" id="4023602">)</span>&nbsp;<span class="op" id="4023604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023608">return</span>&nbsp;<span class="ident" id="4023615">replacementChar</span><span class="op" id="4023630">,</span>&nbsp;<span class="ident" id="4023632">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023652">r</span>&nbsp;<span class="op" id="4023654">-=</span>&nbsp;<span class="ident" id="4023657">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023667">return</span>&nbsp;<span class="ident" id="4023674">surr1</span>&nbsp;<span class="op" id="4023680">+</span>&nbsp;<span class="op" id="4023682">(</span><span class="ident" id="4023683">r</span><span class="op" id="4023684">&gt;&gt;</span><span class="num" id="4023686">10</span><span class="op" id="4023688">)</span><span class="op" id="4023689">&amp;</span><span class="num" id="4023690">0x3ff</span><span class="op" id="4023695">,</span>&nbsp;<span class="ident" id="4023697">surr2</span>&nbsp;<span class="op" id="4023703">+</span>&nbsp;<span class="ident" id="4023705">r</span><span class="op" id="4023706">&amp;</span><span class="num" id="4023707">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="4023713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4023716">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4023792">func</span>&nbsp;<span class="ident" id="4023797">Encode</span><span class="op" id="4023803">(</span><span class="ident" id="4023804">s</span>&nbsp;<span class="op" id="4023806">[</span><span class="op" id="4023807">]</span><span class="builtintype" id="4023808">rune</span><span class="op" id="4023812">)</span>&nbsp;<span class="op" id="4023814">[</span><span class="op" id="4023815">]</span><span class="builtintype" id="4023816">uint16</span>&nbsp;<span class="op" id="4023823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023826">n</span>&nbsp;<span class="op" id="4023828">:=</span>&nbsp;<span class="builtinfunc" id="4023831">len</span><span class="op" id="4023834">(</span><span class="ident" id="4023835">s</span><span class="op" id="4023836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023839">for</span>&nbsp;<span class="ident" id="4023843">_</span><span class="op" id="4023844">,</span>&nbsp;<span class="ident" id="4023846">v</span>&nbsp;<span class="op" id="4023848">:=</span>&nbsp;<span class="keyword" id="4023851">range</span>&nbsp;<span class="ident" id="4023857">s</span>&nbsp;<span class="op" id="4023859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023863">if</span>&nbsp;<span class="ident" id="4023866">v</span>&nbsp;<span class="op" id="4023868">&gt;=</span>&nbsp;<span class="ident" id="4023871">surrSelf</span>&nbsp;<span class="op" id="4023880">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023885">n</span><span class="op" id="4023886">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023891">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4023894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023898">a</span>&nbsp;<span class="op" id="4023900">:=</span>&nbsp;<span class="builtinfunc" id="4023903">make</span><span class="op" id="4023907">(</span><span class="op" id="4023908">[</span><span class="op" id="4023909">]</span><span class="builtintype" id="4023910">uint16</span><span class="op" id="4023916">,</span>&nbsp;<span class="ident" id="4023918">n</span><span class="op" id="4023919">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023922">n</span>&nbsp;<span class="op" id="4023924">=</span>&nbsp;<span class="num" id="4023926">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023929">for</span>&nbsp;<span class="ident" id="4023933">_</span><span class="op" id="4023934">,</span>&nbsp;<span class="ident" id="4023936">v</span>&nbsp;<span class="op" id="4023938">:=</span>&nbsp;<span class="keyword" id="4023941">range</span>&nbsp;<span class="ident" id="4023947">s</span>&nbsp;<span class="op" id="4023949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023953">switch</span>&nbsp;<span class="op" id="4023960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023964">case</span>&nbsp;<span class="ident" id="4023969">v</span>&nbsp;<span class="op" id="4023971">&lt;</span>&nbsp;<span class="num" id="4023973">0</span><span class="op" id="4023974">,</span>&nbsp;<span class="ident" id="4023976">surr1</span>&nbsp;<span class="op" id="4023982">&lt;=</span>&nbsp;<span class="ident" id="4023985">v</span>&nbsp;<span class="op" id="4023987">&amp;&amp;</span>&nbsp;<span class="ident" id="4023990">v</span>&nbsp;<span class="op" id="4023992">&lt;</span>&nbsp;<span class="ident" id="4023994">surr3</span><span class="op" id="4023999">,</span>&nbsp;<span class="ident" id="4024001">v</span>&nbsp;<span class="op" id="4024003">&gt;</span>&nbsp;<span class="ident" id="4024005">maxRune</span><span class="op" id="4024012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024017">v</span>&nbsp;<span class="op" id="4024019">=</span>&nbsp;<span class="ident" id="4024021">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024040">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024054">case</span>&nbsp;<span class="ident" id="4024059">v</span>&nbsp;<span class="op" id="4024061">&lt;</span>&nbsp;<span class="ident" id="4024063">surrSelf</span><span class="op" id="4024071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024076">a</span><span class="op" id="4024077">[</span><span class="ident" id="4024078">n</span><span class="op" id="4024079">]</span>&nbsp;<span class="op" id="4024081">=</span>&nbsp;<span class="builtintype" id="4024083">uint16</span><span class="op" id="4024089">(</span><span class="ident" id="4024090">v</span><span class="op" id="4024091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024096">n</span><span class="op" id="4024097">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024102">default</span><span class="op" id="4024109">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024114">r1</span><span class="op" id="4024116">,</span>&nbsp;<span class="ident" id="4024118">r2</span>&nbsp;<span class="op" id="4024121">:=</span>&nbsp;<span class="ident" id="4024124">EncodeRune</span><span class="op" id="4024134">(</span><span class="ident" id="4024135">v</span><span class="op" id="4024136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024141">a</span><span class="op" id="4024142">[</span><span class="ident" id="4024143">n</span><span class="op" id="4024144">]</span>&nbsp;<span class="op" id="4024146">=</span>&nbsp;<span class="builtintype" id="4024148">uint16</span><span class="op" id="4024154">(</span><span class="ident" id="4024155">r1</span><span class="op" id="4024157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024162">a</span><span class="op" id="4024163">[</span><span class="ident" id="4024164">n</span><span class="op" id="4024165">+</span><span class="num" id="4024166">1</span><span class="op" id="4024167">]</span>&nbsp;<span class="op" id="4024169">=</span>&nbsp;<span class="builtintype" id="4024171">uint16</span><span class="op" id="4024177">(</span><span class="ident" id="4024178">r2</span><span class="op" id="4024180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024185">n</span>&nbsp;<span class="op" id="4024187">+=</span>&nbsp;<span class="num" id="4024190">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024194">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024200">return</span>&nbsp;<span class="ident" id="4024207">a</span><span class="op" id="4024208">[</span><span class="num" id="4024209">0</span><span class="op" id="4024210">:</span><span class="ident" id="4024211">n</span><span class="op" id="4024212">]</span><br>
<span class="lineno"></span><span class="op" id="4024214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4024217">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="4024279">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4024308">func</span>&nbsp;<span class="ident" id="4024313">Decode</span><span class="op" id="4024319">(</span><span class="ident" id="4024320">s</span>&nbsp;<span class="op" id="4024322">[</span><span class="op" id="4024323">]</span><span class="builtintype" id="4024324">uint16</span><span class="op" id="4024330">)</span>&nbsp;<span class="op" id="4024332">[</span><span class="op" id="4024333">]</span><span class="builtintype" id="4024334">rune</span>&nbsp;<span class="op" id="4024339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024342">a</span>&nbsp;<span class="op" id="4024344">:=</span>&nbsp;<span class="builtinfunc" id="4024347">make</span><span class="op" id="4024351">(</span><span class="op" id="4024352">[</span><span class="op" id="4024353">]</span><span class="builtintype" id="4024354">rune</span><span class="op" id="4024358">,</span>&nbsp;<span class="builtinfunc" id="4024360">len</span><span class="op" id="4024363">(</span><span class="ident" id="4024364">s</span><span class="op" id="4024365">)</span><span class="op" id="4024366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024369">n</span>&nbsp;<span class="op" id="4024371">:=</span>&nbsp;<span class="num" id="4024374">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024377">for</span>&nbsp;<span class="ident" id="4024381">i</span>&nbsp;<span class="op" id="4024383">:=</span>&nbsp;<span class="num" id="4024386">0</span><span class="op" id="4024387">;</span>&nbsp;<span class="ident" id="4024389">i</span>&nbsp;<span class="op" id="4024391">&lt;</span>&nbsp;<span class="builtinfunc" id="4024393">len</span><span class="op" id="4024396">(</span><span class="ident" id="4024397">s</span><span class="op" id="4024398">)</span><span class="op" id="4024399">;</span>&nbsp;<span class="ident" id="4024401">i</span><span class="op" id="4024402">++</span>&nbsp;<span class="op" id="4024405">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024409">switch</span>&nbsp;<span class="ident" id="4024416">r</span>&nbsp;<span class="op" id="4024418">:=</span>&nbsp;<span class="ident" id="4024421">s</span><span class="op" id="4024422">[</span><span class="ident" id="4024423">i</span><span class="op" id="4024424">]</span><span class="op" id="4024425">;</span>&nbsp;<span class="op" id="4024427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024431">case</span>&nbsp;<span class="ident" id="4024436">surr1</span>&nbsp;<span class="op" id="4024442">&lt;=</span>&nbsp;<span class="ident" id="4024445">r</span>&nbsp;<span class="op" id="4024447">&amp;&amp;</span>&nbsp;<span class="ident" id="4024450">r</span>&nbsp;<span class="op" id="4024452">&lt;</span>&nbsp;<span class="ident" id="4024454">surr2</span>&nbsp;<span class="op" id="4024460">&amp;&amp;</span>&nbsp;<span class="ident" id="4024463">i</span><span class="op" id="4024464">+</span><span class="num" id="4024465">1</span>&nbsp;<span class="op" id="4024467">&lt;</span>&nbsp;<span class="builtinfunc" id="4024469">len</span><span class="op" id="4024472">(</span><span class="ident" id="4024473">s</span><span class="op" id="4024474">)</span>&nbsp;<span class="op" id="4024476">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024482">surr2</span>&nbsp;<span class="op" id="4024488">&lt;=</span>&nbsp;<span class="ident" id="4024491">s</span><span class="op" id="4024492">[</span><span class="ident" id="4024493">i</span><span class="op" id="4024494">+</span><span class="num" id="4024495">1</span><span class="op" id="4024496">]</span>&nbsp;<span class="op" id="4024498">&amp;&amp;</span>&nbsp;<span class="ident" id="4024501">s</span><span class="op" id="4024502">[</span><span class="ident" id="4024503">i</span><span class="op" id="4024504">+</span><span class="num" id="4024505">1</span><span class="op" id="4024506">]</span>&nbsp;<span class="op" id="4024508">&lt;</span>&nbsp;<span class="ident" id="4024510">surr3</span><span class="op" id="4024515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024520">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024551">a</span><span class="op" id="4024552">[</span><span class="ident" id="4024553">n</span><span class="op" id="4024554">]</span>&nbsp;<span class="op" id="4024556">=</span>&nbsp;<span class="ident" id="4024558">DecodeRune</span><span class="op" id="4024568">(</span><span class="builtintype" id="4024569">rune</span><span class="op" id="4024573">(</span><span class="ident" id="4024574">r</span><span class="op" id="4024575">)</span><span class="op" id="4024576">,</span>&nbsp;<span class="builtintype" id="4024578">rune</span><span class="op" id="4024582">(</span><span class="ident" id="4024583">s</span><span class="op" id="4024584">[</span><span class="ident" id="4024585">i</span><span class="op" id="4024586">+</span><span class="num" id="4024587">1</span><span class="op" id="4024588">]</span><span class="op" id="4024589">)</span><span class="op" id="4024590">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024595">i</span><span class="op" id="4024596">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024602">n</span><span class="op" id="4024603">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024608">case</span>&nbsp;<span class="ident" id="4024613">surr1</span>&nbsp;<span class="op" id="4024619">&lt;=</span>&nbsp;<span class="ident" id="4024622">r</span>&nbsp;<span class="op" id="4024624">&amp;&amp;</span>&nbsp;<span class="ident" id="4024627">r</span>&nbsp;<span class="op" id="4024629">&lt;</span>&nbsp;<span class="ident" id="4024631">surr3</span><span class="op" id="4024636">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024641">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024674">a</span><span class="op" id="4024675">[</span><span class="ident" id="4024676">n</span><span class="op" id="4024677">]</span>&nbsp;<span class="op" id="4024679">=</span>&nbsp;<span class="ident" id="4024681">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024700">n</span><span class="op" id="4024701">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024706">default</span><span class="op" id="4024713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4024718">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024736">a</span><span class="op" id="4024737">[</span><span class="ident" id="4024738">n</span><span class="op" id="4024739">]</span>&nbsp;<span class="op" id="4024741">=</span>&nbsp;<span class="builtintype" id="4024743">rune</span><span class="op" id="4024747">(</span><span class="ident" id="4024748">r</span><span class="op" id="4024749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024754">n</span><span class="op" id="4024755">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4024763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024766">return</span>&nbsp;<span class="ident" id="4024773">a</span><span class="op" id="4024774">[</span><span class="num" id="4024775">0</span><span class="op" id="4024776">:</span><span class="ident" id="4024777">n</span><span class="op" id="4024778">]</span><br>
<span class="lineno"></span><span class="op" id="4024780">}</span>
</div>
</body>
</html>
