<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/plan9obj</h2>
<ul>
<li><a href="/gostd/debug/plan9obj/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/plan9obj/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/plan9obj/plan9obj.go.html">plan9obj.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6116907">//&nbsp;Copyright&nbsp;2014&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6116963">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6117017">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6117068">//&nbsp;Package&nbsp;plan9obj&nbsp;implements&nbsp;access&nbsp;to&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="6117136">package</span>&nbsp;<span class="ident" id="6117144">plan9obj</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6117154">import</span>&nbsp;<span class="op" id="6117161">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6117164">&#34;encoding/binary&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6117183">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6117193">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6117200">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6117206">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="6117211">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="6117214">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6117269">type</span>&nbsp;<span class="ident" id="6117274">FileHeader</span>&nbsp;<span class="keyword" id="6117285">struct</span>&nbsp;<span class="op" id="6117292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117295">Magic</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6117307">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117315">Bss</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6117327">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117335">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117347">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117355">PtrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6117367">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117372">LoadAddress</span>&nbsp;<span class="ident" id="6117384">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117392">HdrSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6117404">uint64</span><br>
<span class="lineno"></span><span class="op" id="6117411">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="6117414">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6117462">type</span>&nbsp;<span class="ident" id="6117467">File</span>&nbsp;<span class="keyword" id="6117472">struct</span>&nbsp;<span class="op" id="6117479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117482">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117494">Sections</span>&nbsp;<span class="op" id="6117503">[</span><span class="op" id="6117504">]</span><span class="op" id="6117505">*</span><span class="ident" id="6117506">Section</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117515">closer</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6117524">io</span><span class="op" id="6117526">.</span><span class="ident" id="6117527">Closer</span><br>
<span class="lineno"></span><span class="op" id="6117534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6117537">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="comment" id="6117605">//&nbsp;This&nbsp;structure&nbsp;doesn&#39;t&nbsp;exist&nbsp;on-disk,&nbsp;but&nbsp;eases&nbsp;navigation</span><br>
<span class="lineno">35</span><span class="comment" id="6117667">//&nbsp;through&nbsp;the&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6117695">type</span>&nbsp;<span class="ident" id="6117700">SectionHeader</span>&nbsp;<span class="keyword" id="6117714">struct</span>&nbsp;<span class="op" id="6117721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117724">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6117731">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117739">Size</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6117746">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117754">Offset</span>&nbsp;<span class="builtintype" id="6117761">uint32</span><br>
<span class="lineno">40</span><span class="op" id="6117768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6117771">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6117836">type</span>&nbsp;<span class="ident" id="6117841">Section</span>&nbsp;<span class="keyword" id="6117849">struct</span>&nbsp;<span class="op" id="6117856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6117859">SectionHeader</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117875">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117913">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117953">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6117988">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118036">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6118086">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118110">io</span><span class="op" id="6118112">.</span><span class="ident" id="6118113">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118123">sr</span>&nbsp;<span class="op" id="6118126">*</span><span class="ident" id="6118127">io</span><span class="op" id="6118129">.</span><span class="ident" id="6118130">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="6118144">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="6118147">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6118215">func</span>&nbsp;<span class="op" id="6118220">(</span><span class="ident" id="6118221">s</span>&nbsp;<span class="op" id="6118223">*</span><span class="ident" id="6118224">Section</span><span class="op" id="6118231">)</span>&nbsp;<span class="ident" id="6118233">Data</span><span class="op" id="6118237">(</span><span class="op" id="6118238">)</span>&nbsp;<span class="op" id="6118240">(</span><span class="op" id="6118241">[</span><span class="op" id="6118242">]</span><span class="builtintype" id="6118243">byte</span><span class="op" id="6118247">,</span>&nbsp;<span class="builtintype" id="6118249">error</span><span class="op" id="6118254">)</span>&nbsp;<span class="op" id="6118256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118259">dat</span>&nbsp;<span class="op" id="6118263">:=</span>&nbsp;<span class="builtinfunc" id="6118266">make</span><span class="op" id="6118270">(</span><span class="op" id="6118271">[</span><span class="op" id="6118272">]</span><span class="builtintype" id="6118273">byte</span><span class="op" id="6118277">,</span>&nbsp;<span class="ident" id="6118279">s</span><span class="op" id="6118280">.</span><span class="ident" id="6118281">sr</span><span class="op" id="6118283">.</span><span class="ident" id="6118284">Size</span><span class="op" id="6118288">(</span><span class="op" id="6118289">)</span><span class="op" id="6118290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118293">n</span><span class="op" id="6118294">,</span>&nbsp;<span class="ident" id="6118296">err</span>&nbsp;<span class="op" id="6118300">:=</span>&nbsp;<span class="ident" id="6118303">s</span><span class="op" id="6118304">.</span><span class="ident" id="6118305">sr</span><span class="op" id="6118307">.</span><span class="ident" id="6118308">ReadAt</span><span class="op" id="6118314">(</span><span class="ident" id="6118315">dat</span><span class="op" id="6118318">,</span>&nbsp;<span class="num" id="6118320">0</span><span class="op" id="6118321">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118324">if</span>&nbsp;<span class="ident" id="6118327">n</span>&nbsp;<span class="op" id="6118329">==</span>&nbsp;<span class="builtinfunc" id="6118332">len</span><span class="op" id="6118335">(</span><span class="ident" id="6118336">dat</span><span class="op" id="6118339">)</span>&nbsp;<span class="op" id="6118341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118345">err</span>&nbsp;<span class="op" id="6118349">=</span>&nbsp;<span class="ident" id="6118351">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118359">return</span>&nbsp;<span class="ident" id="6118366">dat</span><span class="op" id="6118369">[</span><span class="num" id="6118370">0</span><span class="op" id="6118371">:</span><span class="ident" id="6118372">n</span><span class="op" id="6118373">]</span><span class="op" id="6118374">,</span>&nbsp;<span class="ident" id="6118376">err</span><br>
<span class="lineno"></span><span class="op" id="6118380">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="comment" id="6118383">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="6118450">func</span>&nbsp;<span class="op" id="6118455">(</span><span class="ident" id="6118456">s</span>&nbsp;<span class="op" id="6118458">*</span><span class="ident" id="6118459">Section</span><span class="op" id="6118466">)</span>&nbsp;<span class="ident" id="6118468">Open</span><span class="op" id="6118472">(</span><span class="op" id="6118473">)</span>&nbsp;<span class="ident" id="6118475">io</span><span class="op" id="6118477">.</span><span class="ident" id="6118478">ReadSeeker</span>&nbsp;<span class="op" id="6118489">{</span>&nbsp;<span class="keyword" id="6118491">return</span>&nbsp;<span class="ident" id="6118498">io</span><span class="op" id="6118500">.</span><span class="ident" id="6118501">NewSectionReader</span><span class="op" id="6118517">(</span><span class="ident" id="6118518">s</span><span class="op" id="6118519">.</span><span class="ident" id="6118520">sr</span><span class="op" id="6118522">,</span>&nbsp;<span class="num" id="6118524">0</span><span class="op" id="6118525">,</span>&nbsp;<span class="num" id="6118527">1</span><span class="op" id="6118528">&lt;&lt;</span><span class="num" id="6118530">63</span><span class="op" id="6118532">-</span><span class="num" id="6118533">1</span><span class="op" id="6118534">)</span>&nbsp;<span class="op" id="6118536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6118539">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno">70</span><span class="keyword" id="6118611">type</span>&nbsp;<span class="ident" id="6118616">Sym</span>&nbsp;<span class="keyword" id="6118620">struct</span>&nbsp;<span class="op" id="6118627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118630">Value</span>&nbsp;<span class="ident" id="6118636">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118644">Type</span>&nbsp;&nbsp;<span class="builtintype" id="6118650">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118656">Name</span>&nbsp;&nbsp;<span class="builtintype" id="6118662">string</span><br>
<span class="lineno"></span><span class="op" id="6118669">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6118672">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="6118703">//&nbsp;formatError&nbsp;is&nbsp;returned&nbsp;by&nbsp;some&nbsp;operations&nbsp;if&nbsp;the&nbsp;data&nbsp;does</span><br>
<span class="lineno"></span><span class="comment" id="6118766">//&nbsp;not&nbsp;have&nbsp;the&nbsp;correct&nbsp;format&nbsp;for&nbsp;an&nbsp;object&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="6118817">type</span>&nbsp;<span class="ident" id="6118822">formatError</span>&nbsp;<span class="keyword" id="6118834">struct</span>&nbsp;<span class="op" id="6118841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118844">off</span>&nbsp;<span class="builtintype" id="6118848">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118853">msg</span>&nbsp;<span class="builtintype" id="6118857">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118865">val</span>&nbsp;<span class="keyword" id="6118869">interface</span><span class="op" id="6118878">{</span><span class="op" id="6118879">}</span><br>
<span class="lineno"></span><span class="op" id="6118881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6118884">func</span>&nbsp;<span class="op" id="6118889">(</span><span class="ident" id="6118890">e</span>&nbsp;<span class="op" id="6118892">*</span><span class="ident" id="6118893">formatError</span><span class="op" id="6118904">)</span>&nbsp;<span class="ident" id="6118906">Error</span><span class="op" id="6118911">(</span><span class="op" id="6118912">)</span>&nbsp;<span class="builtintype" id="6118914">string</span>&nbsp;<span class="op" id="6118921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118924">msg</span>&nbsp;<span class="op" id="6118928">:=</span>&nbsp;<span class="ident" id="6118931">e</span><span class="op" id="6118932">.</span><span class="ident" id="6118933">msg</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6118938">if</span>&nbsp;<span class="ident" id="6118941">e</span><span class="op" id="6118942">.</span><span class="ident" id="6118943">val</span>&nbsp;<span class="op" id="6118947">!=</span>&nbsp;<span class="ident" id="6118950">nil</span>&nbsp;<span class="op" id="6118954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118958">msg</span>&nbsp;<span class="op" id="6118962">+=</span>&nbsp;<span class="ident" id="6118965">fmt</span><span class="op" id="6118968">.</span><span class="ident" id="6118969">Sprintf</span><span class="op" id="6118976">(</span><span class="string" id="6118977">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="6118984">,</span>&nbsp;<span class="ident" id="6118986">e</span><span class="op" id="6118987">.</span><span class="ident" id="6118988">val</span><span class="op" id="6118991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6118994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6118997">msg</span>&nbsp;<span class="op" id="6119001">+=</span>&nbsp;<span class="ident" id="6119004">fmt</span><span class="op" id="6119007">.</span><span class="ident" id="6119008">Sprintf</span><span class="op" id="6119015">(</span><span class="string" id="6119016">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="6119040">,</span>&nbsp;<span class="ident" id="6119042">e</span><span class="op" id="6119043">.</span><span class="ident" id="6119044">off</span><span class="op" id="6119047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119050">return</span>&nbsp;<span class="ident" id="6119057">msg</span><br>
<span class="lineno">95</span><span class="op" id="6119061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6119064">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;Plan&nbsp;9&nbsp;a.out&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="6119157">func</span>&nbsp;<span class="ident" id="6119162">Open</span><span class="op" id="6119166">(</span><span class="ident" id="6119167">name</span>&nbsp;<span class="builtintype" id="6119172">string</span><span class="op" id="6119178">)</span>&nbsp;<span class="op" id="6119180">(</span><span class="op" id="6119181">*</span><span class="ident" id="6119182">File</span><span class="op" id="6119186">,</span>&nbsp;<span class="builtintype" id="6119188">error</span><span class="op" id="6119193">)</span>&nbsp;<span class="op" id="6119195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119198">f</span><span class="op" id="6119199">,</span>&nbsp;<span class="ident" id="6119201">err</span>&nbsp;<span class="op" id="6119205">:=</span>&nbsp;<span class="ident" id="6119208">os</span><span class="op" id="6119210">.</span><span class="ident" id="6119211">Open</span><span class="op" id="6119215">(</span><span class="ident" id="6119216">name</span><span class="op" id="6119220">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119223">if</span>&nbsp;<span class="ident" id="6119226">err</span>&nbsp;<span class="op" id="6119230">!=</span>&nbsp;<span class="ident" id="6119233">nil</span>&nbsp;<span class="op" id="6119237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119241">return</span>&nbsp;<span class="ident" id="6119248">nil</span><span class="op" id="6119251">,</span>&nbsp;<span class="ident" id="6119253">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119261">ff</span><span class="op" id="6119263">,</span>&nbsp;<span class="ident" id="6119265">err</span>&nbsp;<span class="op" id="6119269">:=</span>&nbsp;<span class="ident" id="6119272">NewFile</span><span class="op" id="6119279">(</span><span class="ident" id="6119280">f</span><span class="op" id="6119281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119284">if</span>&nbsp;<span class="ident" id="6119287">err</span>&nbsp;<span class="op" id="6119291">!=</span>&nbsp;<span class="ident" id="6119294">nil</span>&nbsp;<span class="op" id="6119298">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119302">f</span><span class="op" id="6119303">.</span><span class="ident" id="6119304">Close</span><span class="op" id="6119309">(</span><span class="op" id="6119310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119314">return</span>&nbsp;<span class="ident" id="6119321">nil</span><span class="op" id="6119324">,</span>&nbsp;<span class="ident" id="6119326">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119334">ff</span><span class="op" id="6119336">.</span><span class="ident" id="6119337">closer</span>&nbsp;<span class="op" id="6119344">=</span>&nbsp;<span class="ident" id="6119346">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119349">return</span>&nbsp;<span class="ident" id="6119356">ff</span><span class="op" id="6119358">,</span>&nbsp;<span class="ident" id="6119360">nil</span><br>
<span class="lineno">110</span><span class="op" id="6119364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6119367">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="6119393">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="6119460">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno">115</span><span class="keyword" id="6119484">func</span>&nbsp;<span class="op" id="6119489">(</span><span class="ident" id="6119490">f</span>&nbsp;<span class="op" id="6119492">*</span><span class="ident" id="6119493">File</span><span class="op" id="6119497">)</span>&nbsp;<span class="ident" id="6119499">Close</span><span class="op" id="6119504">(</span><span class="op" id="6119505">)</span>&nbsp;<span class="builtintype" id="6119507">error</span>&nbsp;<span class="op" id="6119513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119516">var</span>&nbsp;<span class="ident" id="6119520">err</span>&nbsp;<span class="builtintype" id="6119524">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119531">if</span>&nbsp;<span class="ident" id="6119534">f</span><span class="op" id="6119535">.</span><span class="ident" id="6119536">closer</span>&nbsp;<span class="op" id="6119543">!=</span>&nbsp;<span class="ident" id="6119546">nil</span>&nbsp;<span class="op" id="6119550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119554">err</span>&nbsp;<span class="op" id="6119558">=</span>&nbsp;<span class="ident" id="6119560">f</span><span class="op" id="6119561">.</span><span class="ident" id="6119562">closer</span><span class="op" id="6119568">.</span><span class="ident" id="6119569">Close</span><span class="op" id="6119574">(</span><span class="op" id="6119575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119579">f</span><span class="op" id="6119580">.</span><span class="ident" id="6119581">closer</span>&nbsp;<span class="op" id="6119588">=</span>&nbsp;<span class="ident" id="6119590">nil</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119598">return</span>&nbsp;<span class="ident" id="6119605">err</span><br>
<span class="lineno"></span><span class="op" id="6119609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6119612">func</span>&nbsp;<span class="ident" id="6119617">parseMagic</span><span class="op" id="6119627">(</span><span class="ident" id="6119628">magic</span>&nbsp;<span class="op" id="6119634">[</span><span class="op" id="6119635">]</span><span class="builtintype" id="6119636">byte</span><span class="op" id="6119640">)</span>&nbsp;<span class="op" id="6119642">(</span><span class="builtintype" id="6119643">uint32</span><span class="op" id="6119649">,</span>&nbsp;<span class="builtintype" id="6119651">error</span><span class="op" id="6119656">)</span>&nbsp;<span class="op" id="6119658">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6119661">m</span>&nbsp;<span class="op" id="6119663">:=</span>&nbsp;<span class="ident" id="6119666">binary</span><span class="op" id="6119672">.</span><span class="ident" id="6119673">BigEndian</span><span class="op" id="6119682">.</span><span class="ident" id="6119683">Uint32</span><span class="op" id="6119689">(</span><span class="ident" id="6119690">magic</span><span class="op" id="6119695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119698">switch</span>&nbsp;<span class="ident" id="6119705">m</span>&nbsp;<span class="op" id="6119707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119710">case</span>&nbsp;<span class="ident" id="6119715">Magic386</span><span class="op" id="6119723">,</span>&nbsp;<span class="ident" id="6119725">MagicAMD64</span><span class="op" id="6119735">,</span>&nbsp;<span class="ident" id="6119737">MagicARM</span><span class="op" id="6119745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119749">return</span>&nbsp;<span class="ident" id="6119756">m</span><span class="op" id="6119757">,</span>&nbsp;<span class="ident" id="6119759">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6119764">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6119767">return</span>&nbsp;<span class="num" id="6119774">0</span><span class="op" id="6119775">,</span>&nbsp;<span class="op" id="6119777">&amp;</span><span class="ident" id="6119778">formatError</span><span class="op" id="6119789">{</span><span class="num" id="6119790">0</span><span class="op" id="6119791">,</span>&nbsp;<span class="string" id="6119793">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="6119811">,</span>&nbsp;<span class="ident" id="6119813">magic</span><span class="op" id="6119818">}</span><br>
<span class="lineno"></span><span class="op" id="6119820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6119823">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="6119908">//&nbsp;The&nbsp;Plan&nbsp;9&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno">135</span><span class="keyword" id="6119981">func</span>&nbsp;<span class="ident" id="6119986">NewFile</span><span class="op" id="6119993">(</span><span class="ident" id="6119994">r</span>&nbsp;<span class="ident" id="6119996">io</span><span class="op" id="6119998">.</span><span class="ident" id="6119999">ReaderAt</span><span class="op" id="6120007">)</span>&nbsp;<span class="op" id="6120009">(</span><span class="op" id="6120010">*</span><span class="ident" id="6120011">File</span><span class="op" id="6120015">,</span>&nbsp;<span class="builtintype" id="6120017">error</span><span class="op" id="6120022">)</span>&nbsp;<span class="op" id="6120024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120027">sr</span>&nbsp;<span class="op" id="6120030">:=</span>&nbsp;<span class="ident" id="6120033">io</span><span class="op" id="6120035">.</span><span class="ident" id="6120036">NewSectionReader</span><span class="op" id="6120052">(</span><span class="ident" id="6120053">r</span><span class="op" id="6120054">,</span>&nbsp;<span class="num" id="6120056">0</span><span class="op" id="6120057">,</span>&nbsp;<span class="num" id="6120059">1</span><span class="op" id="6120060">&lt;&lt;</span><span class="num" id="6120062">63</span><span class="op" id="6120064">-</span><span class="num" id="6120065">1</span><span class="op" id="6120066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6120069">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;Plan&nbsp;9&nbsp;magic</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120102">var</span>&nbsp;<span class="ident" id="6120106">magic</span>&nbsp;<span class="op" id="6120112">[</span><span class="num" id="6120113">4</span><span class="op" id="6120114">]</span><span class="builtintype" id="6120115">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120121">if</span>&nbsp;<span class="ident" id="6120124">_</span><span class="op" id="6120125">,</span>&nbsp;<span class="ident" id="6120127">err</span>&nbsp;<span class="op" id="6120131">:=</span>&nbsp;<span class="ident" id="6120134">r</span><span class="op" id="6120135">.</span><span class="ident" id="6120136">ReadAt</span><span class="op" id="6120142">(</span><span class="ident" id="6120143">magic</span><span class="op" id="6120148">[</span><span class="op" id="6120149">:</span><span class="op" id="6120150">]</span><span class="op" id="6120151">,</span>&nbsp;<span class="num" id="6120153">0</span><span class="op" id="6120154">)</span><span class="op" id="6120155">;</span>&nbsp;<span class="ident" id="6120157">err</span>&nbsp;<span class="op" id="6120161">!=</span>&nbsp;<span class="ident" id="6120164">nil</span>&nbsp;<span class="op" id="6120168">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120172">return</span>&nbsp;<span class="ident" id="6120179">nil</span><span class="op" id="6120182">,</span>&nbsp;<span class="ident" id="6120184">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120192">_</span><span class="op" id="6120193">,</span>&nbsp;<span class="ident" id="6120195">err</span>&nbsp;<span class="op" id="6120199">:=</span>&nbsp;<span class="ident" id="6120202">parseMagic</span><span class="op" id="6120212">(</span><span class="ident" id="6120213">magic</span><span class="op" id="6120218">[</span><span class="op" id="6120219">:</span><span class="op" id="6120220">]</span><span class="op" id="6120221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120224">if</span>&nbsp;<span class="ident" id="6120227">err</span>&nbsp;<span class="op" id="6120231">!=</span>&nbsp;<span class="ident" id="6120234">nil</span>&nbsp;<span class="op" id="6120238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120242">return</span>&nbsp;<span class="ident" id="6120249">nil</span><span class="op" id="6120252">,</span>&nbsp;<span class="ident" id="6120254">err</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120263">ph</span>&nbsp;<span class="op" id="6120266">:=</span>&nbsp;<span class="builtinfunc" id="6120269">new</span><span class="op" id="6120272">(</span><span class="ident" id="6120273">prog</span><span class="op" id="6120277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120280">if</span>&nbsp;<span class="ident" id="6120283">err</span>&nbsp;<span class="op" id="6120287">:=</span>&nbsp;<span class="ident" id="6120290">binary</span><span class="op" id="6120296">.</span><span class="ident" id="6120297">Read</span><span class="op" id="6120301">(</span><span class="ident" id="6120302">sr</span><span class="op" id="6120304">,</span>&nbsp;<span class="ident" id="6120306">binary</span><span class="op" id="6120312">.</span><span class="ident" id="6120313">BigEndian</span><span class="op" id="6120322">,</span>&nbsp;<span class="ident" id="6120324">ph</span><span class="op" id="6120326">)</span><span class="op" id="6120327">;</span>&nbsp;<span class="ident" id="6120329">err</span>&nbsp;<span class="op" id="6120333">!=</span>&nbsp;<span class="ident" id="6120336">nil</span>&nbsp;<span class="op" id="6120340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120344">return</span>&nbsp;<span class="ident" id="6120351">nil</span><span class="op" id="6120354">,</span>&nbsp;<span class="ident" id="6120356">err</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120365">f</span>&nbsp;<span class="op" id="6120367">:=</span>&nbsp;<span class="op" id="6120370">&amp;</span><span class="ident" id="6120371">File</span><span class="op" id="6120375">{</span><span class="ident" id="6120376">FileHeader</span><span class="op" id="6120386">:</span>&nbsp;<span class="ident" id="6120388">FileHeader</span><span class="op" id="6120398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120402">Magic</span><span class="op" id="6120407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120415">ph</span><span class="op" id="6120417">.</span><span class="ident" id="6120418">Magic</span><span class="op" id="6120423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120427">Bss</span><span class="op" id="6120430">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120440">ph</span><span class="op" id="6120442">.</span><span class="ident" id="6120443">Bss</span><span class="op" id="6120446">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120450">Entry</span><span class="op" id="6120455">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6120463">uint64</span><span class="op" id="6120469">(</span><span class="ident" id="6120470">ph</span><span class="op" id="6120472">.</span><span class="ident" id="6120473">Entry</span><span class="op" id="6120478">)</span><span class="op" id="6120479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120483">PtrSize</span><span class="op" id="6120490">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6120496">4</span><span class="op" id="6120497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120501">LoadAddress</span><span class="op" id="6120512">:</span>&nbsp;<span class="num" id="6120514">0x1000</span><span class="op" id="6120520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120524">HdrSize</span><span class="op" id="6120531">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6120537">4</span>&nbsp;<span class="op" id="6120539">*</span>&nbsp;<span class="num" id="6120541">8</span><span class="op" id="6120542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120545">}</span><span class="op" id="6120546">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120550">if</span>&nbsp;<span class="ident" id="6120553">ph</span><span class="op" id="6120555">.</span><span class="ident" id="6120556">Magic</span><span class="op" id="6120561">&amp;</span><span class="ident" id="6120562">Magic64</span>&nbsp;<span class="op" id="6120570">!=</span>&nbsp;<span class="num" id="6120573">0</span>&nbsp;<span class="op" id="6120575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120579">if</span>&nbsp;<span class="ident" id="6120582">err</span>&nbsp;<span class="op" id="6120586">:=</span>&nbsp;<span class="ident" id="6120589">binary</span><span class="op" id="6120595">.</span><span class="ident" id="6120596">Read</span><span class="op" id="6120600">(</span><span class="ident" id="6120601">sr</span><span class="op" id="6120603">,</span>&nbsp;<span class="ident" id="6120605">binary</span><span class="op" id="6120611">.</span><span class="ident" id="6120612">BigEndian</span><span class="op" id="6120621">,</span>&nbsp;<span class="op" id="6120623">&amp;</span><span class="ident" id="6120624">f</span><span class="op" id="6120625">.</span><span class="ident" id="6120626">Entry</span><span class="op" id="6120631">)</span><span class="op" id="6120632">;</span>&nbsp;<span class="ident" id="6120634">err</span>&nbsp;<span class="op" id="6120638">!=</span>&nbsp;<span class="ident" id="6120641">nil</span>&nbsp;<span class="op" id="6120645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120650">return</span>&nbsp;<span class="ident" id="6120657">nil</span><span class="op" id="6120660">,</span>&nbsp;<span class="ident" id="6120662">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120668">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120672">f</span><span class="op" id="6120673">.</span><span class="ident" id="6120674">PtrSize</span>&nbsp;<span class="op" id="6120682">=</span>&nbsp;<span class="num" id="6120684">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120688">f</span><span class="op" id="6120689">.</span><span class="ident" id="6120690">LoadAddress</span>&nbsp;<span class="op" id="6120702">=</span>&nbsp;<span class="num" id="6120704">0x200000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120715">f</span><span class="op" id="6120716">.</span><span class="ident" id="6120717">HdrSize</span>&nbsp;<span class="op" id="6120725">+=</span>&nbsp;<span class="num" id="6120728">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120735">var</span>&nbsp;<span class="ident" id="6120739">sects</span>&nbsp;<span class="op" id="6120745">=</span>&nbsp;<span class="op" id="6120747">[</span><span class="op" id="6120748">]</span><span class="keyword" id="6120749">struct</span>&nbsp;<span class="op" id="6120756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120760">name</span>&nbsp;<span class="builtintype" id="6120765">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120774">size</span>&nbsp;<span class="builtintype" id="6120779">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120787">}</span><span class="op" id="6120788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120792">{</span><span class="string" id="6120793">&#34;text&#34;</span><span class="op" id="6120799">,</span>&nbsp;<span class="ident" id="6120801">ph</span><span class="op" id="6120803">.</span><span class="ident" id="6120804">Text</span><span class="op" id="6120808">}</span><span class="op" id="6120809">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120813">{</span><span class="string" id="6120814">&#34;data&#34;</span><span class="op" id="6120820">,</span>&nbsp;<span class="ident" id="6120822">ph</span><span class="op" id="6120824">.</span><span class="ident" id="6120825">Data</span><span class="op" id="6120829">}</span><span class="op" id="6120830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120834">{</span><span class="string" id="6120835">&#34;syms&#34;</span><span class="op" id="6120841">,</span>&nbsp;<span class="ident" id="6120843">ph</span><span class="op" id="6120845">.</span><span class="ident" id="6120846">Syms</span><span class="op" id="6120850">}</span><span class="op" id="6120851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120855">{</span><span class="string" id="6120856">&#34;spsz&#34;</span><span class="op" id="6120862">,</span>&nbsp;<span class="ident" id="6120864">ph</span><span class="op" id="6120866">.</span><span class="ident" id="6120867">Spsz</span><span class="op" id="6120871">}</span><span class="op" id="6120872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120876">{</span><span class="string" id="6120877">&#34;pcsz&#34;</span><span class="op" id="6120883">,</span>&nbsp;<span class="ident" id="6120885">ph</span><span class="op" id="6120887">.</span><span class="ident" id="6120888">Pcsz</span><span class="op" id="6120892">}</span><span class="op" id="6120893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6120896">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120900">f</span><span class="op" id="6120901">.</span><span class="ident" id="6120902">Sections</span>&nbsp;<span class="op" id="6120911">=</span>&nbsp;<span class="builtinfunc" id="6120913">make</span><span class="op" id="6120917">(</span><span class="op" id="6120918">[</span><span class="op" id="6120919">]</span><span class="op" id="6120920">*</span><span class="ident" id="6120921">Section</span><span class="op" id="6120928">,</span>&nbsp;<span class="num" id="6120930">5</span><span class="op" id="6120931">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120935">off</span>&nbsp;<span class="op" id="6120939">:=</span>&nbsp;<span class="builtintype" id="6120942">uint32</span><span class="op" id="6120948">(</span><span class="ident" id="6120949">f</span><span class="op" id="6120950">.</span><span class="ident" id="6120951">HdrSize</span><span class="op" id="6120958">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6120962">for</span>&nbsp;<span class="ident" id="6120966">i</span><span class="op" id="6120967">,</span>&nbsp;<span class="ident" id="6120969">sect</span>&nbsp;<span class="op" id="6120974">:=</span>&nbsp;<span class="keyword" id="6120977">range</span>&nbsp;<span class="ident" id="6120983">sects</span>&nbsp;<span class="op" id="6120989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6120993">s</span>&nbsp;<span class="op" id="6120995">:=</span>&nbsp;<span class="builtinfunc" id="6120998">new</span><span class="op" id="6121001">(</span><span class="ident" id="6121002">Section</span><span class="op" id="6121009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121013">s</span><span class="op" id="6121014">.</span><span class="ident" id="6121015">SectionHeader</span>&nbsp;<span class="op" id="6121029">=</span>&nbsp;<span class="ident" id="6121031">SectionHeader</span><span class="op" id="6121044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121049">Name</span><span class="op" id="6121053">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6121057">sect</span><span class="op" id="6121061">.</span><span class="ident" id="6121062">name</span><span class="op" id="6121066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121071">Size</span><span class="op" id="6121075">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6121079">sect</span><span class="op" id="6121083">.</span><span class="ident" id="6121084">size</span><span class="op" id="6121088">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121093">Offset</span><span class="op" id="6121099">:</span>&nbsp;<span class="ident" id="6121101">off</span><span class="op" id="6121104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121112">off</span>&nbsp;<span class="op" id="6121116">+=</span>&nbsp;<span class="ident" id="6121119">sect</span><span class="op" id="6121123">.</span><span class="ident" id="6121124">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121131">s</span><span class="op" id="6121132">.</span><span class="ident" id="6121133">sr</span>&nbsp;<span class="op" id="6121136">=</span>&nbsp;<span class="ident" id="6121138">io</span><span class="op" id="6121140">.</span><span class="ident" id="6121141">NewSectionReader</span><span class="op" id="6121157">(</span><span class="ident" id="6121158">r</span><span class="op" id="6121159">,</span>&nbsp;<span class="ident" id="6121161">int64</span><span class="op" id="6121166">(</span><span class="ident" id="6121167">s</span><span class="op" id="6121168">.</span><span class="ident" id="6121169">Offset</span><span class="op" id="6121175">)</span><span class="op" id="6121176">,</span>&nbsp;<span class="ident" id="6121178">int64</span><span class="op" id="6121183">(</span><span class="ident" id="6121184">s</span><span class="op" id="6121185">.</span><span class="ident" id="6121186">Size</span><span class="op" id="6121190">)</span><span class="op" id="6121191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121195">s</span><span class="op" id="6121196">.</span><span class="ident" id="6121197">ReaderAt</span>&nbsp;<span class="op" id="6121206">=</span>&nbsp;<span class="ident" id="6121208">s</span><span class="op" id="6121209">.</span><span class="ident" id="6121210">sr</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121215">f</span><span class="op" id="6121216">.</span><span class="ident" id="6121217">Sections</span><span class="op" id="6121225">[</span><span class="ident" id="6121226">i</span><span class="op" id="6121227">]</span>&nbsp;<span class="op" id="6121229">=</span>&nbsp;<span class="ident" id="6121231">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121238">return</span>&nbsp;<span class="ident" id="6121245">f</span><span class="op" id="6121246">,</span>&nbsp;<span class="ident" id="6121248">nil</span><br>
<span class="lineno"></span><span class="op" id="6121252">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="6121255">func</span>&nbsp;<span class="ident" id="6121260">walksymtab</span><span class="op" id="6121270">(</span><span class="ident" id="6121271">data</span>&nbsp;<span class="op" id="6121276">[</span><span class="op" id="6121277">]</span><span class="builtintype" id="6121278">byte</span><span class="op" id="6121282">,</span>&nbsp;<span class="ident" id="6121284">ptrsz</span>&nbsp;<span class="builtintype" id="6121290">int</span><span class="op" id="6121293">,</span>&nbsp;<span class="ident" id="6121295">fn</span>&nbsp;<span class="keyword" id="6121298">func</span><span class="op" id="6121302">(</span><span class="ident" id="6121303">sym</span><span class="op" id="6121306">)</span>&nbsp;<span class="builtintype" id="6121308">error</span><span class="op" id="6121313">)</span>&nbsp;<span class="builtintype" id="6121315">error</span>&nbsp;<span class="op" id="6121321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121324">var</span>&nbsp;<span class="ident" id="6121328">order</span>&nbsp;<span class="ident" id="6121334">binary</span><span class="op" id="6121340">.</span><span class="ident" id="6121341">ByteOrder</span>&nbsp;<span class="op" id="6121351">=</span>&nbsp;<span class="ident" id="6121353">binary</span><span class="op" id="6121359">.</span><span class="ident" id="6121360">BigEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121371">var</span>&nbsp;<span class="ident" id="6121375">s</span>&nbsp;<span class="ident" id="6121377">sym</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121382">p</span>&nbsp;<span class="op" id="6121384">:=</span>&nbsp;<span class="ident" id="6121387">data</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121393">for</span>&nbsp;<span class="builtinfunc" id="6121397">len</span><span class="op" id="6121400">(</span><span class="ident" id="6121401">p</span><span class="op" id="6121402">)</span>&nbsp;<span class="op" id="6121404">&gt;=</span>&nbsp;<span class="num" id="6121407">4</span>&nbsp;<span class="op" id="6121409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6121413">//&nbsp;Symbol&nbsp;type,&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121438">if</span>&nbsp;<span class="builtinfunc" id="6121441">len</span><span class="op" id="6121444">(</span><span class="ident" id="6121445">p</span><span class="op" id="6121446">)</span>&nbsp;<span class="op" id="6121448">&lt;</span>&nbsp;<span class="ident" id="6121450">ptrsz</span>&nbsp;<span class="op" id="6121456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121461">return</span>&nbsp;<span class="op" id="6121468">&amp;</span><span class="ident" id="6121469">formatError</span><span class="op" id="6121480">{</span><span class="builtinfunc" id="6121481">len</span><span class="op" id="6121484">(</span><span class="ident" id="6121485">data</span><span class="op" id="6121489">)</span><span class="op" id="6121490">,</span>&nbsp;<span class="string" id="6121492">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6121508">,</span>&nbsp;<span class="ident" id="6121510">nil</span><span class="op" id="6121513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121517">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6121521">//&nbsp;fixed-width&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121544">if</span>&nbsp;<span class="ident" id="6121547">ptrsz</span>&nbsp;<span class="op" id="6121553">==</span>&nbsp;<span class="num" id="6121556">8</span>&nbsp;<span class="op" id="6121558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121563">s</span><span class="op" id="6121564">.</span><span class="ident" id="6121565">value</span>&nbsp;<span class="op" id="6121571">=</span>&nbsp;<span class="ident" id="6121573">order</span><span class="op" id="6121578">.</span><span class="ident" id="6121579">Uint64</span><span class="op" id="6121585">(</span><span class="ident" id="6121586">p</span><span class="op" id="6121587">[</span><span class="num" id="6121588">0</span><span class="op" id="6121589">:</span><span class="num" id="6121590">8</span><span class="op" id="6121591">]</span><span class="op" id="6121592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121597">p</span>&nbsp;<span class="op" id="6121599">=</span>&nbsp;<span class="ident" id="6121601">p</span><span class="op" id="6121602">[</span><span class="num" id="6121603">8</span><span class="op" id="6121604">:</span><span class="op" id="6121605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121609">}</span>&nbsp;<span class="keyword" id="6121611">else</span>&nbsp;<span class="op" id="6121616">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121621">s</span><span class="op" id="6121622">.</span><span class="ident" id="6121623">value</span>&nbsp;<span class="op" id="6121629">=</span>&nbsp;<span class="ident" id="6121631">uint64</span><span class="op" id="6121637">(</span><span class="ident" id="6121638">order</span><span class="op" id="6121643">.</span><span class="ident" id="6121644">Uint32</span><span class="op" id="6121650">(</span><span class="ident" id="6121651">p</span><span class="op" id="6121652">[</span><span class="num" id="6121653">0</span><span class="op" id="6121654">:</span><span class="num" id="6121655">4</span><span class="op" id="6121656">]</span><span class="op" id="6121657">)</span><span class="op" id="6121658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121663">p</span>&nbsp;<span class="op" id="6121665">=</span>&nbsp;<span class="ident" id="6121667">p</span><span class="op" id="6121668">[</span><span class="num" id="6121669">4</span><span class="op" id="6121670">:</span><span class="op" id="6121671">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121675">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121680">var</span>&nbsp;<span class="ident" id="6121684">typ</span>&nbsp;<span class="builtintype" id="6121688">byte</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121695">typ</span>&nbsp;<span class="op" id="6121699">=</span>&nbsp;<span class="ident" id="6121701">p</span><span class="op" id="6121702">[</span><span class="num" id="6121703">0</span><span class="op" id="6121704">]</span>&nbsp;<span class="op" id="6121706">&amp;</span>&nbsp;<span class="num" id="6121708">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121715">s</span><span class="op" id="6121716">.</span><span class="ident" id="6121717">typ</span>&nbsp;<span class="op" id="6121721">=</span>&nbsp;<span class="ident" id="6121723">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121729">p</span>&nbsp;<span class="op" id="6121731">=</span>&nbsp;<span class="ident" id="6121733">p</span><span class="op" id="6121734">[</span><span class="num" id="6121735">1</span><span class="op" id="6121736">:</span><span class="op" id="6121737">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6121742">//&nbsp;Name.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121753">var</span>&nbsp;<span class="ident" id="6121757">i</span>&nbsp;<span class="builtintype" id="6121759">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121765">var</span>&nbsp;<span class="ident" id="6121769">nnul</span>&nbsp;<span class="builtintype" id="6121774">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121780">for</span>&nbsp;<span class="ident" id="6121784">i</span>&nbsp;<span class="op" id="6121786">=</span>&nbsp;<span class="num" id="6121788">0</span><span class="op" id="6121789">;</span>&nbsp;<span class="ident" id="6121791">i</span>&nbsp;<span class="op" id="6121793">&lt;</span>&nbsp;<span class="builtinfunc" id="6121795">len</span><span class="op" id="6121798">(</span><span class="ident" id="6121799">p</span><span class="op" id="6121800">)</span><span class="op" id="6121801">;</span>&nbsp;<span class="ident" id="6121803">i</span><span class="op" id="6121804">++</span>&nbsp;<span class="op" id="6121807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121812">if</span>&nbsp;<span class="ident" id="6121815">p</span><span class="op" id="6121816">[</span><span class="ident" id="6121817">i</span><span class="op" id="6121818">]</span>&nbsp;<span class="op" id="6121820">==</span>&nbsp;<span class="num" id="6121823">0</span>&nbsp;<span class="op" id="6121825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121831">nnul</span>&nbsp;<span class="op" id="6121836">=</span>&nbsp;<span class="num" id="6121838">1</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121844">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6121857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121861">switch</span>&nbsp;<span class="ident" id="6121868">typ</span>&nbsp;<span class="op" id="6121872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121876">case</span>&nbsp;<span class="string" id="6121881">&#39;z&#39;</span><span class="op" id="6121884">,</span>&nbsp;<span class="string" id="6121886">&#39;Z&#39;</span><span class="op" id="6121889">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121894">p</span>&nbsp;<span class="op" id="6121896">=</span>&nbsp;<span class="ident" id="6121898">p</span><span class="op" id="6121899">[</span><span class="ident" id="6121900">i</span><span class="op" id="6121901">+</span><span class="ident" id="6121902">nnul</span><span class="op" id="6121906">:</span><span class="op" id="6121907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121912">for</span>&nbsp;<span class="ident" id="6121916">i</span>&nbsp;<span class="op" id="6121918">=</span>&nbsp;<span class="num" id="6121920">0</span><span class="op" id="6121921">;</span>&nbsp;<span class="ident" id="6121923">i</span><span class="op" id="6121924">+</span><span class="num" id="6121925">2</span>&nbsp;<span class="op" id="6121927">&lt;=</span>&nbsp;<span class="builtinfunc" id="6121930">len</span><span class="op" id="6121933">(</span><span class="ident" id="6121934">p</span><span class="op" id="6121935">)</span><span class="op" id="6121936">;</span>&nbsp;<span class="ident" id="6121938">i</span>&nbsp;<span class="op" id="6121940">+=</span>&nbsp;<span class="num" id="6121943">2</span>&nbsp;<span class="op" id="6121945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6121951">if</span>&nbsp;<span class="ident" id="6121954">p</span><span class="op" id="6121955">[</span><span class="ident" id="6121956">i</span><span class="op" id="6121957">]</span>&nbsp;<span class="op" id="6121959">==</span>&nbsp;<span class="num" id="6121962">0</span>&nbsp;<span class="op" id="6121964">&amp;&amp;</span>&nbsp;<span class="ident" id="6121967">p</span><span class="op" id="6121968">[</span><span class="ident" id="6121969">i</span><span class="op" id="6121970">+</span><span class="num" id="6121971">1</span><span class="op" id="6121972">]</span>&nbsp;<span class="op" id="6121974">==</span>&nbsp;<span class="num" id="6121977">0</span>&nbsp;<span class="op" id="6121979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6121986">nnul</span>&nbsp;<span class="op" id="6121991">=</span>&nbsp;<span class="num" id="6121993">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122000">break</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122023">if</span>&nbsp;<span class="builtinfunc" id="6122026">len</span><span class="op" id="6122029">(</span><span class="ident" id="6122030">p</span><span class="op" id="6122031">)</span>&nbsp;<span class="op" id="6122033">&lt;</span>&nbsp;<span class="ident" id="6122035">i</span><span class="op" id="6122036">+</span><span class="ident" id="6122037">nnul</span>&nbsp;<span class="op" id="6122042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122047">return</span>&nbsp;<span class="op" id="6122054">&amp;</span><span class="ident" id="6122055">formatError</span><span class="op" id="6122066">{</span><span class="builtinfunc" id="6122067">len</span><span class="op" id="6122070">(</span><span class="ident" id="6122071">data</span><span class="op" id="6122075">)</span><span class="op" id="6122076">,</span>&nbsp;<span class="string" id="6122078">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6122094">,</span>&nbsp;<span class="ident" id="6122096">nil</span><span class="op" id="6122099">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122103">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122107">s</span><span class="op" id="6122108">.</span><span class="ident" id="6122109">name</span>&nbsp;<span class="op" id="6122114">=</span>&nbsp;<span class="ident" id="6122116">p</span><span class="op" id="6122117">[</span><span class="num" id="6122118">0</span><span class="op" id="6122119">:</span><span class="ident" id="6122120">i</span><span class="op" id="6122121">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122125">i</span>&nbsp;<span class="op" id="6122127">+=</span>&nbsp;<span class="ident" id="6122130">nnul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122137">p</span>&nbsp;<span class="op" id="6122139">=</span>&nbsp;<span class="ident" id="6122141">p</span><span class="op" id="6122142">[</span><span class="ident" id="6122143">i</span><span class="op" id="6122144">:</span><span class="op" id="6122145">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122150">fn</span><span class="op" id="6122152">(</span><span class="ident" id="6122153">s</span><span class="op" id="6122154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122160">return</span>&nbsp;<span class="ident" id="6122167">nil</span><br>
<span class="lineno"></span><span class="op" id="6122171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="6122174">//&nbsp;NewTable&nbsp;decodes&nbsp;the&nbsp;Go&nbsp;symbol&nbsp;table&nbsp;in&nbsp;data,</span><br>
<span class="lineno"></span><span class="comment" id="6122223">//&nbsp;returning&nbsp;an&nbsp;in-memory&nbsp;representation.</span><br>
<span class="lineno"></span><span class="keyword" id="6122265">func</span>&nbsp;<span class="ident" id="6122270">newTable</span><span class="op" id="6122278">(</span><span class="ident" id="6122279">symtab</span>&nbsp;<span class="op" id="6122286">[</span><span class="op" id="6122287">]</span><span class="builtintype" id="6122288">byte</span><span class="op" id="6122292">,</span>&nbsp;<span class="ident" id="6122294">ptrsz</span>&nbsp;<span class="builtintype" id="6122300">int</span><span class="op" id="6122303">)</span>&nbsp;<span class="op" id="6122305">(</span><span class="op" id="6122306">[</span><span class="op" id="6122307">]</span><span class="ident" id="6122308">Sym</span><span class="op" id="6122311">,</span>&nbsp;<span class="builtintype" id="6122313">error</span><span class="op" id="6122318">)</span>&nbsp;<span class="op" id="6122320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122323">var</span>&nbsp;<span class="ident" id="6122327">n</span>&nbsp;<span class="builtintype" id="6122329">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122334">err</span>&nbsp;<span class="op" id="6122338">:=</span>&nbsp;<span class="ident" id="6122341">walksymtab</span><span class="op" id="6122351">(</span><span class="ident" id="6122352">symtab</span><span class="op" id="6122358">,</span>&nbsp;<span class="ident" id="6122360">ptrsz</span><span class="op" id="6122365">,</span>&nbsp;<span class="keyword" id="6122367">func</span><span class="op" id="6122371">(</span><span class="ident" id="6122372">s</span>&nbsp;<span class="ident" id="6122374">sym</span><span class="op" id="6122377">)</span>&nbsp;<span class="builtintype" id="6122379">error</span>&nbsp;<span class="op" id="6122385">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122389">n</span><span class="op" id="6122390">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122395">return</span>&nbsp;<span class="ident" id="6122402">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122407">}</span><span class="op" id="6122408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122411">if</span>&nbsp;<span class="ident" id="6122414">err</span>&nbsp;<span class="op" id="6122418">!=</span>&nbsp;<span class="ident" id="6122421">nil</span>&nbsp;<span class="op" id="6122425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122429">return</span>&nbsp;<span class="ident" id="6122436">nil</span><span class="op" id="6122439">,</span>&nbsp;<span class="ident" id="6122441">err</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122450">fname</span>&nbsp;<span class="op" id="6122456">:=</span>&nbsp;<span class="builtinfunc" id="6122459">make</span><span class="op" id="6122463">(</span><span class="keyword" id="6122464">map</span><span class="op" id="6122467">[</span><span class="builtintype" id="6122468">uint16</span><span class="op" id="6122474">]</span><span class="builtintype" id="6122475">string</span><span class="op" id="6122481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122484">syms</span>&nbsp;<span class="op" id="6122489">:=</span>&nbsp;<span class="builtinfunc" id="6122492">make</span><span class="op" id="6122496">(</span><span class="op" id="6122497">[</span><span class="op" id="6122498">]</span><span class="ident" id="6122499">Sym</span><span class="op" id="6122502">,</span>&nbsp;<span class="num" id="6122504">0</span><span class="op" id="6122505">,</span>&nbsp;<span class="ident" id="6122507">n</span><span class="op" id="6122508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122511">err</span>&nbsp;<span class="op" id="6122515">=</span>&nbsp;<span class="ident" id="6122517">walksymtab</span><span class="op" id="6122527">(</span><span class="ident" id="6122528">symtab</span><span class="op" id="6122534">,</span>&nbsp;<span class="ident" id="6122536">ptrsz</span><span class="op" id="6122541">,</span>&nbsp;<span class="keyword" id="6122543">func</span><span class="op" id="6122547">(</span><span class="ident" id="6122548">s</span>&nbsp;<span class="ident" id="6122550">sym</span><span class="op" id="6122553">)</span>&nbsp;<span class="builtintype" id="6122555">error</span>&nbsp;<span class="op" id="6122561">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122565">n</span>&nbsp;<span class="op" id="6122567">:=</span>&nbsp;<span class="builtinfunc" id="6122570">len</span><span class="op" id="6122573">(</span><span class="ident" id="6122574">syms</span><span class="op" id="6122578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122582">syms</span>&nbsp;<span class="op" id="6122587">=</span>&nbsp;<span class="ident" id="6122589">syms</span><span class="op" id="6122593">[</span><span class="num" id="6122594">0</span>&nbsp;<span class="op" id="6122596">:</span>&nbsp;<span class="ident" id="6122598">n</span><span class="op" id="6122599">+</span><span class="num" id="6122600">1</span><span class="op" id="6122601">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122605">ts</span>&nbsp;<span class="op" id="6122608">:=</span>&nbsp;<span class="op" id="6122611">&amp;</span><span class="ident" id="6122612">syms</span><span class="op" id="6122616">[</span><span class="ident" id="6122617">n</span><span class="op" id="6122618">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122622">ts</span><span class="op" id="6122624">.</span><span class="ident" id="6122625">Type</span>&nbsp;<span class="op" id="6122630">=</span>&nbsp;<span class="builtintype" id="6122632">rune</span><span class="op" id="6122636">(</span><span class="ident" id="6122637">s</span><span class="op" id="6122638">.</span><span class="ident" id="6122639">typ</span><span class="op" id="6122642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122646">ts</span><span class="op" id="6122648">.</span><span class="ident" id="6122649">Value</span>&nbsp;<span class="op" id="6122655">=</span>&nbsp;<span class="ident" id="6122657">s</span><span class="op" id="6122658">.</span><span class="ident" id="6122659">value</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122667">switch</span>&nbsp;<span class="ident" id="6122674">s</span><span class="op" id="6122675">.</span><span class="ident" id="6122676">typ</span>&nbsp;<span class="op" id="6122680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122684">default</span><span class="op" id="6122691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122696">ts</span><span class="op" id="6122698">.</span><span class="ident" id="6122699">Name</span>&nbsp;<span class="op" id="6122704">=</span>&nbsp;<span class="builtintype" id="6122706">string</span><span class="op" id="6122712">(</span><span class="ident" id="6122713">s</span><span class="op" id="6122714">.</span><span class="ident" id="6122715">name</span><span class="op" id="6122719">[</span><span class="op" id="6122720">:</span><span class="op" id="6122721">]</span><span class="op" id="6122722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122726">case</span>&nbsp;<span class="string" id="6122731">&#39;z&#39;</span><span class="op" id="6122734">,</span>&nbsp;<span class="string" id="6122736">&#39;Z&#39;</span><span class="op" id="6122739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122744">for</span>&nbsp;<span class="ident" id="6122748">i</span>&nbsp;<span class="op" id="6122750">:=</span>&nbsp;<span class="num" id="6122753">0</span><span class="op" id="6122754">;</span>&nbsp;<span class="ident" id="6122756">i</span>&nbsp;<span class="op" id="6122758">&lt;</span>&nbsp;<span class="builtinfunc" id="6122760">len</span><span class="op" id="6122763">(</span><span class="ident" id="6122764">s</span><span class="op" id="6122765">.</span><span class="ident" id="6122766">name</span><span class="op" id="6122770">)</span><span class="op" id="6122771">;</span>&nbsp;<span class="ident" id="6122773">i</span>&nbsp;<span class="op" id="6122775">+=</span>&nbsp;<span class="num" id="6122778">2</span>&nbsp;<span class="op" id="6122780">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122786">eltIdx</span>&nbsp;<span class="op" id="6122793">:=</span>&nbsp;<span class="ident" id="6122796">binary</span><span class="op" id="6122802">.</span><span class="ident" id="6122803">BigEndian</span><span class="op" id="6122812">.</span><span class="ident" id="6122813">Uint16</span><span class="op" id="6122819">(</span><span class="ident" id="6122820">s</span><span class="op" id="6122821">.</span><span class="ident" id="6122822">name</span><span class="op" id="6122826">[</span><span class="ident" id="6122827">i</span>&nbsp;<span class="op" id="6122829">:</span>&nbsp;<span class="ident" id="6122831">i</span><span class="op" id="6122832">+</span><span class="num" id="6122833">2</span><span class="op" id="6122834">]</span><span class="op" id="6122835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6122841">elt</span><span class="op" id="6122844">,</span>&nbsp;<span class="ident" id="6122846">ok</span>&nbsp;<span class="op" id="6122849">:=</span>&nbsp;<span class="ident" id="6122852">fname</span><span class="op" id="6122857">[</span><span class="ident" id="6122858">eltIdx</span><span class="op" id="6122864">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122870">if</span>&nbsp;<span class="op" id="6122873">!</span><span class="ident" id="6122874">ok</span>&nbsp;<span class="op" id="6122877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122884">return</span>&nbsp;<span class="op" id="6122891">&amp;</span><span class="ident" id="6122892">formatError</span><span class="op" id="6122903">{</span><span class="op" id="6122904">-</span><span class="num" id="6122905">1</span><span class="op" id="6122906">,</span>&nbsp;<span class="string" id="6122908">&#34;bad&nbsp;filename&nbsp;code&#34;</span><span class="op" id="6122927">,</span>&nbsp;<span class="ident" id="6122929">eltIdx</span><span class="op" id="6122935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6122941">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6122947">if</span>&nbsp;<span class="ident" id="6122950">n</span>&nbsp;<span class="op" id="6122952">:=</span>&nbsp;<span class="builtinfunc" id="6122955">len</span><span class="op" id="6122958">(</span><span class="ident" id="6122959">ts</span><span class="op" id="6122961">.</span><span class="ident" id="6122962">Name</span><span class="op" id="6122966">)</span><span class="op" id="6122967">;</span>&nbsp;<span class="ident" id="6122969">n</span>&nbsp;<span class="op" id="6122971">&gt;</span>&nbsp;<span class="num" id="6122973">0</span>&nbsp;<span class="op" id="6122975">&amp;&amp;</span>&nbsp;<span class="ident" id="6122978">ts</span><span class="op" id="6122980">.</span><span class="ident" id="6122981">Name</span><span class="op" id="6122985">[</span><span class="ident" id="6122986">n</span><span class="op" id="6122987">-</span><span class="num" id="6122988">1</span><span class="op" id="6122989">]</span>&nbsp;<span class="op" id="6122991">!=</span>&nbsp;<span class="string" id="6122994">&#39;/&#39;</span>&nbsp;<span class="op" id="6122998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123005">ts</span><span class="op" id="6123007">.</span><span class="ident" id="6123008">Name</span>&nbsp;<span class="op" id="6123013">+=</span>&nbsp;<span class="string" id="6123016">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123030">ts</span><span class="op" id="6123032">.</span><span class="ident" id="6123033">Name</span>&nbsp;<span class="op" id="6123038">+=</span>&nbsp;<span class="ident" id="6123041">elt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123048">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123056">switch</span>&nbsp;<span class="ident" id="6123063">s</span><span class="op" id="6123064">.</span><span class="ident" id="6123065">typ</span>&nbsp;<span class="op" id="6123069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123073">case</span>&nbsp;<span class="string" id="6123078">&#39;f&#39;</span><span class="op" id="6123081">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123086">fname</span><span class="op" id="6123091">[</span><span class="builtintype" id="6123092">uint16</span><span class="op" id="6123098">(</span><span class="ident" id="6123099">s</span><span class="op" id="6123100">.</span><span class="ident" id="6123101">value</span><span class="op" id="6123106">)</span><span class="op" id="6123107">]</span>&nbsp;<span class="op" id="6123109">=</span>&nbsp;<span class="ident" id="6123111">ts</span><span class="op" id="6123113">.</span><span class="ident" id="6123114">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123121">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123125">return</span>&nbsp;<span class="ident" id="6123132">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123137">}</span><span class="op" id="6123138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123141">if</span>&nbsp;<span class="ident" id="6123144">err</span>&nbsp;<span class="op" id="6123148">!=</span>&nbsp;<span class="ident" id="6123151">nil</span>&nbsp;<span class="op" id="6123155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123159">return</span>&nbsp;<span class="ident" id="6123166">nil</span><span class="op" id="6123169">,</span>&nbsp;<span class="ident" id="6123171">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123176">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123180">return</span>&nbsp;<span class="ident" id="6123187">syms</span><span class="op" id="6123191">,</span>&nbsp;<span class="ident" id="6123193">nil</span><br>
<span class="lineno"></span><span class="op" id="6123197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123200">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.</span><br>
<span class="lineno">305</span><span class="keyword" id="6123243">func</span>&nbsp;<span class="op" id="6123248">(</span><span class="ident" id="6123249">f</span>&nbsp;<span class="op" id="6123251">*</span><span class="ident" id="6123252">File</span><span class="op" id="6123256">)</span>&nbsp;<span class="ident" id="6123258">Symbols</span><span class="op" id="6123265">(</span><span class="op" id="6123266">)</span>&nbsp;<span class="op" id="6123268">(</span><span class="op" id="6123269">[</span><span class="op" id="6123270">]</span><span class="ident" id="6123271">Sym</span><span class="op" id="6123274">,</span>&nbsp;<span class="builtintype" id="6123276">error</span><span class="op" id="6123281">)</span>&nbsp;<span class="op" id="6123283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123286">symtabSection</span>&nbsp;<span class="op" id="6123300">:=</span>&nbsp;<span class="ident" id="6123303">f</span><span class="op" id="6123304">.</span><span class="ident" id="6123305">Section</span><span class="op" id="6123312">(</span><span class="string" id="6123313">&#34;syms&#34;</span><span class="op" id="6123319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123322">if</span>&nbsp;<span class="ident" id="6123325">symtabSection</span>&nbsp;<span class="op" id="6123339">==</span>&nbsp;<span class="ident" id="6123342">nil</span>&nbsp;<span class="op" id="6123346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123350">return</span>&nbsp;<span class="ident" id="6123357">nil</span><span class="op" id="6123360">,</span>&nbsp;<span class="ident" id="6123362">errors</span><span class="op" id="6123368">.</span><span class="ident" id="6123369">New</span><span class="op" id="6123372">(</span><span class="string" id="6123373">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6123392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123395">}</span><br>
<span class="lineno">310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6123399">symtab</span><span class="op" id="6123405">,</span>&nbsp;<span class="ident" id="6123407">err</span>&nbsp;<span class="op" id="6123411">:=</span>&nbsp;<span class="ident" id="6123414">symtabSection</span><span class="op" id="6123427">.</span><span class="ident" id="6123428">Data</span><span class="op" id="6123432">(</span><span class="op" id="6123433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123436">if</span>&nbsp;<span class="ident" id="6123439">err</span>&nbsp;<span class="op" id="6123443">!=</span>&nbsp;<span class="ident" id="6123446">nil</span>&nbsp;<span class="op" id="6123450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123454">return</span>&nbsp;<span class="ident" id="6123461">nil</span><span class="op" id="6123464">,</span>&nbsp;<span class="ident" id="6123466">errors</span><span class="op" id="6123472">.</span><span class="ident" id="6123473">New</span><span class="op" id="6123476">(</span><span class="string" id="6123477">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="6123505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123508">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123512">return</span>&nbsp;<span class="ident" id="6123519">newTable</span><span class="op" id="6123527">(</span><span class="ident" id="6123528">symtab</span><span class="op" id="6123534">,</span>&nbsp;<span class="ident" id="6123536">f</span><span class="op" id="6123537">.</span><span class="ident" id="6123538">PtrSize</span><span class="op" id="6123545">)</span><br>
<span class="lineno"></span><span class="op" id="6123547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6123550">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno">320</span><span class="comment" id="6123618">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="6123637">func</span>&nbsp;<span class="op" id="6123642">(</span><span class="ident" id="6123643">f</span>&nbsp;<span class="op" id="6123645">*</span><span class="ident" id="6123646">File</span><span class="op" id="6123650">)</span>&nbsp;<span class="ident" id="6123652">Section</span><span class="op" id="6123659">(</span><span class="ident" id="6123660">name</span>&nbsp;<span class="builtintype" id="6123665">string</span><span class="op" id="6123671">)</span>&nbsp;<span class="op" id="6123673">*</span><span class="ident" id="6123674">Section</span>&nbsp;<span class="op" id="6123682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123685">for</span>&nbsp;<span class="ident" id="6123689">_</span><span class="op" id="6123690">,</span>&nbsp;<span class="ident" id="6123692">s</span>&nbsp;<span class="op" id="6123694">:=</span>&nbsp;<span class="keyword" id="6123697">range</span>&nbsp;<span class="ident" id="6123703">f</span><span class="op" id="6123704">.</span><span class="ident" id="6123705">Sections</span>&nbsp;<span class="op" id="6123714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123718">if</span>&nbsp;<span class="ident" id="6123721">s</span><span class="op" id="6123722">.</span><span class="ident" id="6123723">Name</span>&nbsp;<span class="op" id="6123728">==</span>&nbsp;<span class="ident" id="6123731">name</span>&nbsp;<span class="op" id="6123736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123741">return</span>&nbsp;<span class="ident" id="6123748">s</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6123755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6123758">return</span>&nbsp;<span class="ident" id="6123765">nil</span><br>
<span class="lineno"></span><span class="op" id="6123769">}</span>
</div>
</body>
</html>
