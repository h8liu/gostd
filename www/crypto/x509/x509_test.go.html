<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6626215">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6626270">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6626324">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6626375">package</span>&nbsp;<span class="ident" id="6626383">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6626389">import</span>&nbsp;<span class="op" id="6626396">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626399">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626408">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626422">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626438">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626457">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626472">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626486">_</span>&nbsp;<span class="string" id="6626488">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626505">_</span>&nbsp;<span class="string" id="6626507">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626524">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626544">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626561">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626580">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626596">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626612">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626624">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626631">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626642">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626653">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626664">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626675">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6626682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6626685">func</span>&nbsp;<span class="ident" id="6626690">TestParsePKCS1PrivateKey</span><span class="op" id="6626714">(</span><span class="ident" id="6626715">t</span>&nbsp;<span class="op" id="6626717">*</span><span class="ident" id="6626718">testing</span><span class="op" id="6626725">.</span><span class="ident" id="6626726">T</span><span class="op" id="6626727">)</span>&nbsp;<span class="op" id="6626729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626732">block</span><span class="op" id="6626737">,</span>&nbsp;<span class="ident" id="6626739">_</span>&nbsp;<span class="op" id="6626741">:=</span>&nbsp;<span class="ident" id="6626744">pem</span><span class="op" id="6626747">.</span><span class="ident" id="6626748">Decode</span><span class="op" id="6626754">(</span><span class="op" id="6626755">[</span><span class="op" id="6626756">]</span><span class="builtintype" id="6626757">byte</span><span class="op" id="6626761">(</span><span class="ident" id="6626762">pemPrivateKey</span><span class="op" id="6626775">)</span><span class="op" id="6626776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626779">priv</span><span class="op" id="6626783">,</span>&nbsp;<span class="ident" id="6626785">err</span>&nbsp;<span class="op" id="6626789">:=</span>&nbsp;<span class="ident" id="6626792">ParsePKCS1PrivateKey</span><span class="op" id="6626812">(</span><span class="ident" id="6626813">block</span><span class="op" id="6626818">.</span><span class="ident" id="6626819">Bytes</span><span class="op" id="6626824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6626827">if</span>&nbsp;<span class="ident" id="6626830">err</span>&nbsp;<span class="op" id="6626834">!=</span>&nbsp;<span class="ident" id="6626837">nil</span>&nbsp;<span class="op" id="6626841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626845">t</span><span class="op" id="6626846">.</span><span class="ident" id="6626847">Errorf</span><span class="op" id="6626853">(</span><span class="string" id="6626854">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6626887">,</span>&nbsp;<span class="ident" id="6626889">err</span><span class="op" id="6626892">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6626896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6626904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6626907">if</span>&nbsp;<span class="ident" id="6626910">priv</span><span class="op" id="6626914">.</span><span class="ident" id="6626915">PublicKey</span><span class="op" id="6626924">.</span><span class="ident" id="6626925">N</span><span class="op" id="6626926">.</span><span class="ident" id="6626927">Cmp</span><span class="op" id="6626930">(</span><span class="ident" id="6626931">rsaPrivateKey</span><span class="op" id="6626944">.</span><span class="ident" id="6626945">PublicKey</span><span class="op" id="6626954">.</span><span class="ident" id="6626955">N</span><span class="op" id="6626956">)</span>&nbsp;<span class="op" id="6626958">!=</span>&nbsp;<span class="num" id="6626961">0</span>&nbsp;<span class="op" id="6626963">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626968">priv</span><span class="op" id="6626972">.</span><span class="ident" id="6626973">PublicKey</span><span class="op" id="6626982">.</span><span class="ident" id="6626983">E</span>&nbsp;<span class="op" id="6626985">!=</span>&nbsp;<span class="ident" id="6626988">rsaPrivateKey</span><span class="op" id="6627001">.</span><span class="ident" id="6627002">PublicKey</span><span class="op" id="6627011">.</span><span class="ident" id="6627012">E</span>&nbsp;<span class="op" id="6627014">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627019">priv</span><span class="op" id="6627023">.</span><span class="ident" id="6627024">D</span><span class="op" id="6627025">.</span><span class="ident" id="6627026">Cmp</span><span class="op" id="6627029">(</span><span class="ident" id="6627030">rsaPrivateKey</span><span class="op" id="6627043">.</span><span class="ident" id="6627044">D</span><span class="op" id="6627045">)</span>&nbsp;<span class="op" id="6627047">!=</span>&nbsp;<span class="num" id="6627050">0</span>&nbsp;<span class="op" id="6627052">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627057">priv</span><span class="op" id="6627061">.</span><span class="ident" id="6627062">Primes</span><span class="op" id="6627068">[</span><span class="num" id="6627069">0</span><span class="op" id="6627070">]</span><span class="op" id="6627071">.</span><span class="ident" id="6627072">Cmp</span><span class="op" id="6627075">(</span><span class="ident" id="6627076">rsaPrivateKey</span><span class="op" id="6627089">.</span><span class="ident" id="6627090">Primes</span><span class="op" id="6627096">[</span><span class="num" id="6627097">0</span><span class="op" id="6627098">]</span><span class="op" id="6627099">)</span>&nbsp;<span class="op" id="6627101">!=</span>&nbsp;<span class="num" id="6627104">0</span>&nbsp;<span class="op" id="6627106">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627111">priv</span><span class="op" id="6627115">.</span><span class="ident" id="6627116">Primes</span><span class="op" id="6627122">[</span><span class="num" id="6627123">1</span><span class="op" id="6627124">]</span><span class="op" id="6627125">.</span><span class="ident" id="6627126">Cmp</span><span class="op" id="6627129">(</span><span class="ident" id="6627130">rsaPrivateKey</span><span class="op" id="6627143">.</span><span class="ident" id="6627144">Primes</span><span class="op" id="6627150">[</span><span class="num" id="6627151">1</span><span class="op" id="6627152">]</span><span class="op" id="6627153">)</span>&nbsp;<span class="op" id="6627155">!=</span>&nbsp;<span class="num" id="6627158">0</span>&nbsp;<span class="op" id="6627160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627164">t</span><span class="op" id="6627165">.</span><span class="ident" id="6627166">Errorf</span><span class="op" id="6627172">(</span><span class="string" id="6627173">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6627191">,</span>&nbsp;<span class="ident" id="6627193">priv</span><span class="op" id="6627197">,</span>&nbsp;<span class="ident" id="6627199">rsaPrivateKey</span><span class="op" id="6627212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627215">}</span><br>
<span class="lineno"></span><span class="op" id="6627217">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6627220">func</span>&nbsp;<span class="ident" id="6627225">TestParsePKIXPublicKey</span><span class="op" id="6627247">(</span><span class="ident" id="6627248">t</span>&nbsp;<span class="op" id="6627250">*</span><span class="ident" id="6627251">testing</span><span class="op" id="6627258">.</span><span class="ident" id="6627259">T</span><span class="op" id="6627260">)</span>&nbsp;<span class="op" id="6627262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627265">block</span><span class="op" id="6627270">,</span>&nbsp;<span class="ident" id="6627272">_</span>&nbsp;<span class="op" id="6627274">:=</span>&nbsp;<span class="ident" id="6627277">pem</span><span class="op" id="6627280">.</span><span class="ident" id="6627281">Decode</span><span class="op" id="6627287">(</span><span class="op" id="6627288">[</span><span class="op" id="6627289">]</span><span class="builtintype" id="6627290">byte</span><span class="op" id="6627294">(</span><span class="ident" id="6627295">pemPublicKey</span><span class="op" id="6627307">)</span><span class="op" id="6627308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627311">pub</span><span class="op" id="6627314">,</span>&nbsp;<span class="ident" id="6627316">err</span>&nbsp;<span class="op" id="6627320">:=</span>&nbsp;<span class="ident" id="6627323">ParsePKIXPublicKey</span><span class="op" id="6627341">(</span><span class="ident" id="6627342">block</span><span class="op" id="6627347">.</span><span class="ident" id="6627348">Bytes</span><span class="op" id="6627353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627356">if</span>&nbsp;<span class="ident" id="6627359">err</span>&nbsp;<span class="op" id="6627363">!=</span>&nbsp;<span class="ident" id="6627366">nil</span>&nbsp;<span class="op" id="6627370">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627374">t</span><span class="op" id="6627375">.</span><span class="ident" id="6627376">Errorf</span><span class="op" id="6627382">(</span><span class="string" id="6627383">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6627419">,</span>&nbsp;<span class="ident" id="6627421">err</span><span class="op" id="6627424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627439">rsaPub</span><span class="op" id="6627445">,</span>&nbsp;<span class="ident" id="6627447">ok</span>&nbsp;<span class="op" id="6627450">:=</span>&nbsp;<span class="ident" id="6627453">pub</span><span class="op" id="6627456">.</span><span class="op" id="6627457">(</span><span class="op" id="6627458">*</span><span class="ident" id="6627459">rsa</span><span class="op" id="6627462">.</span><span class="ident" id="6627463">PublicKey</span><span class="op" id="6627472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627475">if</span>&nbsp;<span class="op" id="6627478">!</span><span class="ident" id="6627479">ok</span>&nbsp;<span class="op" id="6627482">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627486">t</span><span class="op" id="6627487">.</span><span class="ident" id="6627488">Errorf</span><span class="op" id="6627494">(</span><span class="string" id="6627495">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="6627561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627565">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627577">pubBytes2</span><span class="op" id="6627586">,</span>&nbsp;<span class="ident" id="6627588">err</span>&nbsp;<span class="op" id="6627592">:=</span>&nbsp;<span class="ident" id="6627595">MarshalPKIXPublicKey</span><span class="op" id="6627615">(</span><span class="ident" id="6627616">rsaPub</span><span class="op" id="6627622">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627625">if</span>&nbsp;<span class="ident" id="6627628">err</span>&nbsp;<span class="op" id="6627632">!=</span>&nbsp;<span class="ident" id="6627635">nil</span>&nbsp;<span class="op" id="6627639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627643">t</span><span class="op" id="6627644">.</span><span class="ident" id="6627645">Errorf</span><span class="op" id="6627651">(</span><span class="string" id="6627652">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="6627710">,</span>&nbsp;<span class="ident" id="6627712">err</span><span class="op" id="6627715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627719">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627730">if</span>&nbsp;<span class="op" id="6627733">!</span><span class="ident" id="6627734">bytes</span><span class="op" id="6627739">.</span><span class="ident" id="6627740">Equal</span><span class="op" id="6627745">(</span><span class="ident" id="6627746">pubBytes2</span><span class="op" id="6627755">,</span>&nbsp;<span class="ident" id="6627757">block</span><span class="op" id="6627762">.</span><span class="ident" id="6627763">Bytes</span><span class="op" id="6627768">)</span>&nbsp;<span class="op" id="6627770">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627774">t</span><span class="op" id="6627775">.</span><span class="ident" id="6627776">Errorf</span><span class="op" id="6627782">(</span><span class="string" id="6627783">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6627844">,</span>&nbsp;<span class="ident" id="6627846">pubBytes2</span><span class="op" id="6627855">,</span>&nbsp;<span class="ident" id="6627857">block</span><span class="op" id="6627862">.</span><span class="ident" id="6627863">Bytes</span><span class="op" id="6627868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627871">}</span><br>
<span class="lineno"></span><span class="op" id="6627873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6627876">var</span>&nbsp;<span class="ident" id="6627880">pemPublicKey</span>&nbsp;<span class="op" id="6627893">=</span>&nbsp;<span class="string" id="6627895">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6628350">var</span>&nbsp;<span class="ident" id="6628354">pemPrivateKey</span>&nbsp;<span class="op" id="6628368">=</span>&nbsp;<span class="string" id="6628370">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6628867">func</span>&nbsp;<span class="ident" id="6628872">bigFromString</span><span class="op" id="6628885">(</span><span class="ident" id="6628886">s</span>&nbsp;<span class="builtintype" id="6628888">string</span><span class="op" id="6628894">)</span>&nbsp;<span class="op" id="6628896">*</span><span class="ident" id="6628897">big</span><span class="op" id="6628900">.</span><span class="ident" id="6628901">Int</span>&nbsp;<span class="op" id="6628905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6628908">ret</span>&nbsp;<span class="op" id="6628912">:=</span>&nbsp;<span class="builtinfunc" id="6628915">new</span><span class="op" id="6628918">(</span><span class="ident" id="6628919">big</span><span class="op" id="6628922">.</span><span class="ident" id="6628923">Int</span><span class="op" id="6628926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6628929">ret</span><span class="op" id="6628932">.</span><span class="ident" id="6628933">SetString</span><span class="op" id="6628942">(</span><span class="ident" id="6628943">s</span><span class="op" id="6628944">,</span>&nbsp;<span class="num" id="6628946">10</span><span class="op" id="6628948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6628951">return</span>&nbsp;<span class="ident" id="6628958">ret</span><br>
<span class="lineno">95</span><span class="op" id="6628962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6628965">func</span>&nbsp;<span class="ident" id="6628970">fromBase10</span><span class="op" id="6628980">(</span><span class="ident" id="6628981">base10</span>&nbsp;<span class="builtintype" id="6628988">string</span><span class="op" id="6628994">)</span>&nbsp;<span class="op" id="6628996">*</span><span class="ident" id="6628997">big</span><span class="op" id="6629000">.</span><span class="ident" id="6629001">Int</span>&nbsp;<span class="op" id="6629005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629008">i</span>&nbsp;<span class="op" id="6629010">:=</span>&nbsp;<span class="builtinfunc" id="6629013">new</span><span class="op" id="6629016">(</span><span class="ident" id="6629017">big</span><span class="op" id="6629020">.</span><span class="ident" id="6629021">Int</span><span class="op" id="6629024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629027">i</span><span class="op" id="6629028">.</span><span class="ident" id="6629029">SetString</span><span class="op" id="6629038">(</span><span class="ident" id="6629039">base10</span><span class="op" id="6629045">,</span>&nbsp;<span class="num" id="6629047">10</span><span class="op" id="6629049">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6629052">return</span>&nbsp;<span class="ident" id="6629059">i</span><br>
<span class="lineno"></span><span class="op" id="6629061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6629064">func</span>&nbsp;<span class="ident" id="6629069">bigFromHexString</span><span class="op" id="6629085">(</span><span class="ident" id="6629086">s</span>&nbsp;<span class="builtintype" id="6629088">string</span><span class="op" id="6629094">)</span>&nbsp;<span class="op" id="6629096">*</span><span class="ident" id="6629097">big</span><span class="op" id="6629100">.</span><span class="ident" id="6629101">Int</span>&nbsp;<span class="op" id="6629105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629108">ret</span>&nbsp;<span class="op" id="6629112">:=</span>&nbsp;<span class="builtinfunc" id="6629115">new</span><span class="op" id="6629118">(</span><span class="ident" id="6629119">big</span><span class="op" id="6629122">.</span><span class="ident" id="6629123">Int</span><span class="op" id="6629126">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629129">ret</span><span class="op" id="6629132">.</span><span class="ident" id="6629133">SetString</span><span class="op" id="6629142">(</span><span class="ident" id="6629143">s</span><span class="op" id="6629144">,</span>&nbsp;<span class="num" id="6629146">16</span><span class="op" id="6629148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6629151">return</span>&nbsp;<span class="ident" id="6629158">ret</span><br>
<span class="lineno"></span><span class="op" id="6629162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6629165">var</span>&nbsp;<span class="ident" id="6629169">rsaPrivateKey</span>&nbsp;<span class="op" id="6629183">=</span>&nbsp;<span class="op" id="6629185">&amp;</span><span class="ident" id="6629186">rsa</span><span class="op" id="6629189">.</span><span class="ident" id="6629190">PrivateKey</span><span class="op" id="6629200">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629203">PublicKey</span><span class="op" id="6629212">:</span>&nbsp;<span class="ident" id="6629214">rsa</span><span class="op" id="6629217">.</span><span class="ident" id="6629218">PublicKey</span><span class="op" id="6629227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629231">N</span><span class="op" id="6629232">:</span>&nbsp;<span class="ident" id="6629234">bigFromString</span><span class="op" id="6629247">(</span><span class="string" id="6629248">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6629404">)</span><span class="op" id="6629405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629409">E</span><span class="op" id="6629410">:</span>&nbsp;<span class="num" id="6629412">65537</span><span class="op" id="6629417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6629420">}</span><span class="op" id="6629421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629424">D</span><span class="op" id="6629425">:</span>&nbsp;<span class="ident" id="6629427">bigFromString</span><span class="op" id="6629440">(</span><span class="string" id="6629441">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6629597">)</span><span class="op" id="6629598">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629601">Primes</span><span class="op" id="6629607">:</span>&nbsp;<span class="op" id="6629609">[</span><span class="op" id="6629610">]</span><span class="op" id="6629611">*</span><span class="ident" id="6629612">big</span><span class="op" id="6629615">.</span><span class="ident" id="6629616">Int</span><span class="op" id="6629619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629623">bigFromString</span><span class="op" id="6629636">(</span><span class="string" id="6629637">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6629716">)</span><span class="op" id="6629717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629721">bigFromString</span><span class="op" id="6629734">(</span><span class="string" id="6629735">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6629814">)</span><span class="op" id="6629815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6629818">}</span><span class="op" id="6629819">,</span><br>
<span class="lineno"></span><span class="op" id="6629821">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="6629824">func</span>&nbsp;<span class="ident" id="6629829">TestMarshalRSAPrivateKey</span><span class="op" id="6629853">(</span><span class="ident" id="6629854">t</span>&nbsp;<span class="op" id="6629856">*</span><span class="ident" id="6629857">testing</span><span class="op" id="6629864">.</span><span class="ident" id="6629865">T</span><span class="op" id="6629866">)</span>&nbsp;<span class="op" id="6629868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629871">priv</span>&nbsp;<span class="op" id="6629876">:=</span>&nbsp;<span class="op" id="6629879">&amp;</span><span class="ident" id="6629880">rsa</span><span class="op" id="6629883">.</span><span class="ident" id="6629884">PrivateKey</span><span class="op" id="6629894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629898">PublicKey</span><span class="op" id="6629907">:</span>&nbsp;<span class="ident" id="6629909">rsa</span><span class="op" id="6629912">.</span><span class="ident" id="6629913">PublicKey</span><span class="op" id="6629922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6629927">N</span><span class="op" id="6629928">:</span>&nbsp;<span class="ident" id="6629930">fromBase10</span><span class="op" id="6629940">(</span><span class="string" id="6629941">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="6630560">)</span><span class="op" id="6630561">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6630566">E</span><span class="op" id="6630567">:</span>&nbsp;<span class="num" id="6630569">3</span><span class="op" id="6630570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6630574">}</span><span class="op" id="6630575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6630579">D</span><span class="op" id="6630580">:</span>&nbsp;<span class="ident" id="6630582">fromBase10</span><span class="op" id="6630592">(</span><span class="string" id="6630593">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="6631212">)</span><span class="op" id="6631213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631217">Primes</span><span class="op" id="6631223">:</span>&nbsp;<span class="op" id="6631225">[</span><span class="op" id="6631226">]</span><span class="op" id="6631227">*</span><span class="ident" id="6631228">big</span><span class="op" id="6631231">.</span><span class="ident" id="6631232">Int</span><span class="op" id="6631235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631240">fromBase10</span><span class="op" id="6631250">(</span><span class="string" id="6631251">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="6631461">)</span><span class="op" id="6631462">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631467">fromBase10</span><span class="op" id="6631477">(</span><span class="string" id="6631478">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="6631685">)</span><span class="op" id="6631686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631691">fromBase10</span><span class="op" id="6631701">(</span><span class="string" id="6631702">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="6631909">)</span><span class="op" id="6631910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6631914">}</span><span class="op" id="6631915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6631918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631922">derBytes</span>&nbsp;<span class="op" id="6631931">:=</span>&nbsp;<span class="ident" id="6631934">MarshalPKCS1PrivateKey</span><span class="op" id="6631956">(</span><span class="ident" id="6631957">priv</span><span class="op" id="6631961">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6631965">priv2</span><span class="op" id="6631970">,</span>&nbsp;<span class="ident" id="6631972">err</span>&nbsp;<span class="op" id="6631976">:=</span>&nbsp;<span class="ident" id="6631979">ParsePKCS1PrivateKey</span><span class="op" id="6631999">(</span><span class="ident" id="6632000">derBytes</span><span class="op" id="6632008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6632011">if</span>&nbsp;<span class="ident" id="6632014">err</span>&nbsp;<span class="op" id="6632018">!=</span>&nbsp;<span class="ident" id="6632021">nil</span>&nbsp;<span class="op" id="6632025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632029">t</span><span class="op" id="6632030">.</span><span class="ident" id="6632031">Errorf</span><span class="op" id="6632037">(</span><span class="string" id="6632038">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6632072">,</span>&nbsp;<span class="ident" id="6632074">err</span><span class="op" id="6632077">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6632081">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6632092">if</span>&nbsp;<span class="ident" id="6632095">priv</span><span class="op" id="6632099">.</span><span class="ident" id="6632100">PublicKey</span><span class="op" id="6632109">.</span><span class="ident" id="6632110">N</span><span class="op" id="6632111">.</span><span class="ident" id="6632112">Cmp</span><span class="op" id="6632115">(</span><span class="ident" id="6632116">priv2</span><span class="op" id="6632121">.</span><span class="ident" id="6632122">PublicKey</span><span class="op" id="6632131">.</span><span class="ident" id="6632132">N</span><span class="op" id="6632133">)</span>&nbsp;<span class="op" id="6632135">!=</span>&nbsp;<span class="num" id="6632138">0</span>&nbsp;<span class="op" id="6632140">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632145">priv</span><span class="op" id="6632149">.</span><span class="ident" id="6632150">PublicKey</span><span class="op" id="6632159">.</span><span class="ident" id="6632160">E</span>&nbsp;<span class="op" id="6632162">!=</span>&nbsp;<span class="ident" id="6632165">priv2</span><span class="op" id="6632170">.</span><span class="ident" id="6632171">PublicKey</span><span class="op" id="6632180">.</span><span class="ident" id="6632181">E</span>&nbsp;<span class="op" id="6632183">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632188">priv</span><span class="op" id="6632192">.</span><span class="ident" id="6632193">D</span><span class="op" id="6632194">.</span><span class="ident" id="6632195">Cmp</span><span class="op" id="6632198">(</span><span class="ident" id="6632199">priv2</span><span class="op" id="6632204">.</span><span class="ident" id="6632205">D</span><span class="op" id="6632206">)</span>&nbsp;<span class="op" id="6632208">!=</span>&nbsp;<span class="num" id="6632211">0</span>&nbsp;<span class="op" id="6632213">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6632218">len</span><span class="op" id="6632221">(</span><span class="ident" id="6632222">priv2</span><span class="op" id="6632227">.</span><span class="ident" id="6632228">Primes</span><span class="op" id="6632234">)</span>&nbsp;<span class="op" id="6632236">!=</span>&nbsp;<span class="num" id="6632239">3</span>&nbsp;<span class="op" id="6632241">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632246">priv</span><span class="op" id="6632250">.</span><span class="ident" id="6632251">Primes</span><span class="op" id="6632257">[</span><span class="num" id="6632258">0</span><span class="op" id="6632259">]</span><span class="op" id="6632260">.</span><span class="ident" id="6632261">Cmp</span><span class="op" id="6632264">(</span><span class="ident" id="6632265">priv2</span><span class="op" id="6632270">.</span><span class="ident" id="6632271">Primes</span><span class="op" id="6632277">[</span><span class="num" id="6632278">0</span><span class="op" id="6632279">]</span><span class="op" id="6632280">)</span>&nbsp;<span class="op" id="6632282">!=</span>&nbsp;<span class="num" id="6632285">0</span>&nbsp;<span class="op" id="6632287">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632292">priv</span><span class="op" id="6632296">.</span><span class="ident" id="6632297">Primes</span><span class="op" id="6632303">[</span><span class="num" id="6632304">1</span><span class="op" id="6632305">]</span><span class="op" id="6632306">.</span><span class="ident" id="6632307">Cmp</span><span class="op" id="6632310">(</span><span class="ident" id="6632311">priv2</span><span class="op" id="6632316">.</span><span class="ident" id="6632317">Primes</span><span class="op" id="6632323">[</span><span class="num" id="6632324">1</span><span class="op" id="6632325">]</span><span class="op" id="6632326">)</span>&nbsp;<span class="op" id="6632328">!=</span>&nbsp;<span class="num" id="6632331">0</span>&nbsp;<span class="op" id="6632333">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632338">priv</span><span class="op" id="6632342">.</span><span class="ident" id="6632343">Primes</span><span class="op" id="6632349">[</span><span class="num" id="6632350">2</span><span class="op" id="6632351">]</span><span class="op" id="6632352">.</span><span class="ident" id="6632353">Cmp</span><span class="op" id="6632356">(</span><span class="ident" id="6632357">priv2</span><span class="op" id="6632362">.</span><span class="ident" id="6632363">Primes</span><span class="op" id="6632369">[</span><span class="num" id="6632370">2</span><span class="op" id="6632371">]</span><span class="op" id="6632372">)</span>&nbsp;<span class="op" id="6632374">!=</span>&nbsp;<span class="num" id="6632377">0</span>&nbsp;<span class="op" id="6632379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632383">t</span><span class="op" id="6632384">.</span><span class="ident" id="6632385">Errorf</span><span class="op" id="6632391">(</span><span class="string" id="6632392">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6632410">,</span>&nbsp;<span class="ident" id="6632412">priv</span><span class="op" id="6632416">,</span>&nbsp;<span class="ident" id="6632418">priv2</span><span class="op" id="6632423">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632426">}</span><br>
<span class="lineno"></span><span class="op" id="6632428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6632431">type</span>&nbsp;<span class="ident" id="6632436">matchHostnamesTest</span>&nbsp;<span class="keyword" id="6632455">struct</span>&nbsp;<span class="op" id="6632462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632465">pattern</span><span class="op" id="6632472">,</span>&nbsp;<span class="ident" id="6632474">host</span>&nbsp;<span class="builtintype" id="6632479">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6632487">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6632501">bool</span><br>
<span class="lineno"></span><span class="op" id="6632506">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6632509">var</span>&nbsp;<span class="ident" id="6632513">matchHostnamesTests</span>&nbsp;<span class="op" id="6632533">=</span>&nbsp;<span class="op" id="6632535">[</span><span class="op" id="6632536">]</span><span class="ident" id="6632537">matchHostnamesTest</span><span class="op" id="6632555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632558">{</span><span class="string" id="6632559">&#34;a.b.c&#34;</span><span class="op" id="6632566">,</span>&nbsp;<span class="string" id="6632568">&#34;a.b.c&#34;</span><span class="op" id="6632575">,</span>&nbsp;<span class="ident" id="6632577">true</span><span class="op" id="6632581">}</span><span class="op" id="6632582">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632585">{</span><span class="string" id="6632586">&#34;a.b.c&#34;</span><span class="op" id="6632593">,</span>&nbsp;<span class="string" id="6632595">&#34;b.b.c&#34;</span><span class="op" id="6632602">,</span>&nbsp;<span class="ident" id="6632604">false</span><span class="op" id="6632609">}</span><span class="op" id="6632610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632613">{</span><span class="string" id="6632614">&#34;&#34;</span><span class="op" id="6632616">,</span>&nbsp;<span class="string" id="6632618">&#34;b.b.c&#34;</span><span class="op" id="6632625">,</span>&nbsp;<span class="ident" id="6632627">false</span><span class="op" id="6632632">}</span><span class="op" id="6632633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632636">{</span><span class="string" id="6632637">&#34;a.b.c&#34;</span><span class="op" id="6632644">,</span>&nbsp;<span class="string" id="6632646">&#34;&#34;</span><span class="op" id="6632648">,</span>&nbsp;<span class="ident" id="6632650">false</span><span class="op" id="6632655">}</span><span class="op" id="6632656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632659">{</span><span class="string" id="6632660">&#34;example.com&#34;</span><span class="op" id="6632673">,</span>&nbsp;<span class="string" id="6632675">&#34;example.com&#34;</span><span class="op" id="6632688">,</span>&nbsp;<span class="ident" id="6632690">true</span><span class="op" id="6632694">}</span><span class="op" id="6632695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632698">{</span><span class="string" id="6632699">&#34;example.com&#34;</span><span class="op" id="6632712">,</span>&nbsp;<span class="string" id="6632714">&#34;www.example.com&#34;</span><span class="op" id="6632731">,</span>&nbsp;<span class="ident" id="6632733">false</span><span class="op" id="6632738">}</span><span class="op" id="6632739">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632742">{</span><span class="string" id="6632743">&#34;*.example.com&#34;</span><span class="op" id="6632758">,</span>&nbsp;<span class="string" id="6632760">&#34;www.example.com&#34;</span><span class="op" id="6632777">,</span>&nbsp;<span class="ident" id="6632779">true</span><span class="op" id="6632783">}</span><span class="op" id="6632784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632787">{</span><span class="string" id="6632788">&#34;*.example.com&#34;</span><span class="op" id="6632803">,</span>&nbsp;<span class="string" id="6632805">&#34;xyz.www.example.com&#34;</span><span class="op" id="6632826">,</span>&nbsp;<span class="ident" id="6632828">false</span><span class="op" id="6632833">}</span><span class="op" id="6632834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632837">{</span><span class="string" id="6632838">&#34;*.*.example.com&#34;</span><span class="op" id="6632855">,</span>&nbsp;<span class="string" id="6632857">&#34;xyz.www.example.com&#34;</span><span class="op" id="6632878">,</span>&nbsp;<span class="ident" id="6632880">true</span><span class="op" id="6632884">}</span><span class="op" id="6632885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6632888">{</span><span class="string" id="6632889">&#34;*.www.*.com&#34;</span><span class="op" id="6632902">,</span>&nbsp;<span class="string" id="6632904">&#34;xyz.www.example.com&#34;</span><span class="op" id="6632925">,</span>&nbsp;<span class="ident" id="6632927">true</span><span class="op" id="6632931">}</span><span class="op" id="6632932">,</span><br>
<span class="lineno"></span><span class="op" id="6632934">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6632937">func</span>&nbsp;<span class="ident" id="6632942">TestMatchHostnames</span><span class="op" id="6632960">(</span><span class="ident" id="6632961">t</span>&nbsp;<span class="op" id="6632963">*</span><span class="ident" id="6632964">testing</span><span class="op" id="6632971">.</span><span class="ident" id="6632972">T</span><span class="op" id="6632973">)</span>&nbsp;<span class="op" id="6632975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6632978">for</span>&nbsp;<span class="ident" id="6632982">i</span><span class="op" id="6632983">,</span>&nbsp;<span class="ident" id="6632985">test</span>&nbsp;<span class="op" id="6632990">:=</span>&nbsp;<span class="keyword" id="6632993">range</span>&nbsp;<span class="ident" id="6632999">matchHostnamesTests</span>&nbsp;<span class="op" id="6633019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633023">r</span>&nbsp;<span class="op" id="6633025">:=</span>&nbsp;<span class="ident" id="6633028">matchHostnames</span><span class="op" id="6633042">(</span><span class="ident" id="6633043">test</span><span class="op" id="6633047">.</span><span class="ident" id="6633048">pattern</span><span class="op" id="6633055">,</span>&nbsp;<span class="ident" id="6633057">test</span><span class="op" id="6633061">.</span><span class="ident" id="6633062">host</span><span class="op" id="6633066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633070">if</span>&nbsp;<span class="ident" id="6633073">r</span>&nbsp;<span class="op" id="6633075">!=</span>&nbsp;<span class="ident" id="6633078">test</span><span class="op" id="6633082">.</span><span class="ident" id="6633083">ok</span>&nbsp;<span class="op" id="6633086">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633091">t</span><span class="op" id="6633092">.</span><span class="ident" id="6633093">Errorf</span><span class="op" id="6633099">(</span><span class="string" id="6633100">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="6633131">,</span>&nbsp;<span class="ident" id="6633133">i</span><span class="op" id="6633134">,</span>&nbsp;<span class="ident" id="6633136">r</span><span class="op" id="6633137">,</span>&nbsp;<span class="ident" id="6633139">test</span><span class="op" id="6633143">.</span><span class="ident" id="6633144">ok</span><span class="op" id="6633146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633153">}</span><br>
<span class="lineno"></span><span class="op" id="6633155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="6633158">func</span>&nbsp;<span class="ident" id="6633163">TestMatchIP</span><span class="op" id="6633174">(</span><span class="ident" id="6633175">t</span>&nbsp;<span class="op" id="6633177">*</span><span class="ident" id="6633178">testing</span><span class="op" id="6633185">.</span><span class="ident" id="6633186">T</span><span class="op" id="6633187">)</span>&nbsp;<span class="op" id="6633189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633192">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633236">c</span>&nbsp;<span class="op" id="6633238">:=</span>&nbsp;<span class="op" id="6633241">&amp;</span><span class="ident" id="6633242">Certificate</span><span class="op" id="6633253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633257">DNSNames</span><span class="op" id="6633265">:</span>&nbsp;<span class="op" id="6633267">[</span><span class="op" id="6633268">]</span><span class="builtintype" id="6633269">string</span><span class="op" id="6633275">{</span><span class="string" id="6633276">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6633291">}</span><span class="op" id="6633292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633296">Subject</span><span class="op" id="6633303">:</span>&nbsp;<span class="ident" id="6633305">pkix</span><span class="op" id="6633309">.</span><span class="ident" id="6633310">Name</span><span class="op" id="6633314">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633319">CommonName</span><span class="op" id="6633329">:</span>&nbsp;<span class="string" id="6633331">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6633346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633350">}</span><span class="op" id="6633351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633357">err</span>&nbsp;<span class="op" id="6633361">:=</span>&nbsp;<span class="ident" id="6633364">c</span><span class="op" id="6633365">.</span><span class="ident" id="6633366">VerifyHostname</span><span class="op" id="6633380">(</span><span class="string" id="6633381">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="6633399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633402">if</span>&nbsp;<span class="ident" id="6633405">err</span>&nbsp;<span class="op" id="6633409">!=</span>&nbsp;<span class="ident" id="6633412">nil</span>&nbsp;<span class="op" id="6633416">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633420">t</span><span class="op" id="6633421">.</span><span class="ident" id="6633422">Fatalf</span><span class="op" id="6633428">(</span><span class="string" id="6633429">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="6633467">,</span>&nbsp;<span class="ident" id="6633469">err</span><span class="op" id="6633472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633475">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633479">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6633552">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633572">c</span>&nbsp;<span class="op" id="6633574">=</span>&nbsp;<span class="op" id="6633576">&amp;</span><span class="ident" id="6633577">Certificate</span><span class="op" id="6633588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633592">DNSNames</span><span class="op" id="6633600">:</span>&nbsp;<span class="op" id="6633602">[</span><span class="op" id="6633603">]</span><span class="builtintype" id="6633604">string</span><span class="op" id="6633610">{</span><span class="string" id="6633611">&#34;*.2.3.4&#34;</span><span class="op" id="6633620">}</span><span class="op" id="6633621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633625">Subject</span><span class="op" id="6633632">:</span>&nbsp;<span class="ident" id="6633634">pkix</span><span class="op" id="6633638">.</span><span class="ident" id="6633639">Name</span><span class="op" id="6633643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633648">CommonName</span><span class="op" id="6633658">:</span>&nbsp;<span class="string" id="6633660">&#34;*.2.3.4&#34;</span><span class="op" id="6633669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633673">}</span><span class="op" id="6633674">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633680">err</span>&nbsp;<span class="op" id="6633684">=</span>&nbsp;<span class="ident" id="6633686">c</span><span class="op" id="6633687">.</span><span class="ident" id="6633688">VerifyHostname</span><span class="op" id="6633702">(</span><span class="string" id="6633703">&#34;1.2.3.4&#34;</span><span class="op" id="6633712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633715">if</span>&nbsp;<span class="ident" id="6633718">err</span>&nbsp;<span class="op" id="6633722">==</span>&nbsp;<span class="ident" id="6633725">nil</span>&nbsp;<span class="op" id="6633729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633733">t</span><span class="op" id="6633734">.</span><span class="ident" id="6633735">Fatalf</span><span class="op" id="6633741">(</span><span class="string" id="6633742">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="6633795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633798">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633802">c</span>&nbsp;<span class="op" id="6633804">=</span>&nbsp;<span class="op" id="6633806">&amp;</span><span class="ident" id="6633807">Certificate</span><span class="op" id="6633818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633822">IPAddresses</span><span class="op" id="6633833">:</span>&nbsp;<span class="op" id="6633835">[</span><span class="op" id="6633836">]</span><span class="ident" id="6633837">net</span><span class="op" id="6633840">.</span><span class="ident" id="6633841">IP</span><span class="op" id="6633843">{</span><span class="ident" id="6633844">net</span><span class="op" id="6633847">.</span><span class="ident" id="6633848">ParseIP</span><span class="op" id="6633855">(</span><span class="string" id="6633856">&#34;127.0.0.1&#34;</span><span class="op" id="6633867">)</span><span class="op" id="6633868">,</span>&nbsp;<span class="ident" id="6633870">net</span><span class="op" id="6633873">.</span><span class="ident" id="6633874">ParseIP</span><span class="op" id="6633881">(</span><span class="string" id="6633882">&#34;::1&#34;</span><span class="op" id="6633887">)</span><span class="op" id="6633888">}</span><span class="op" id="6633889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633895">err</span>&nbsp;<span class="op" id="6633899">=</span>&nbsp;<span class="ident" id="6633901">c</span><span class="op" id="6633902">.</span><span class="ident" id="6633903">VerifyHostname</span><span class="op" id="6633917">(</span><span class="string" id="6633918">&#34;127.0.0.1&#34;</span><span class="op" id="6633929">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6633932">if</span>&nbsp;<span class="ident" id="6633935">err</span>&nbsp;<span class="op" id="6633939">!=</span>&nbsp;<span class="ident" id="6633942">nil</span>&nbsp;<span class="op" id="6633946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6633950">t</span><span class="op" id="6633951">.</span><span class="ident" id="6633952">Fatalf</span><span class="op" id="6633958">(</span><span class="string" id="6633959">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="6633990">,</span>&nbsp;<span class="ident" id="6633992">err</span><span class="op" id="6633995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6633998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634001">err</span>&nbsp;<span class="op" id="6634005">=</span>&nbsp;<span class="ident" id="6634007">c</span><span class="op" id="6634008">.</span><span class="ident" id="6634009">VerifyHostname</span><span class="op" id="6634023">(</span><span class="string" id="6634024">&#34;::1&#34;</span><span class="op" id="6634029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634032">if</span>&nbsp;<span class="ident" id="6634035">err</span>&nbsp;<span class="op" id="6634039">!=</span>&nbsp;<span class="ident" id="6634042">nil</span>&nbsp;<span class="op" id="6634046">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634050">t</span><span class="op" id="6634051">.</span><span class="ident" id="6634052">Fatalf</span><span class="op" id="6634058">(</span><span class="string" id="6634059">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="6634084">,</span>&nbsp;<span class="ident" id="6634086">err</span><span class="op" id="6634089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634095">err</span>&nbsp;<span class="op" id="6634099">=</span>&nbsp;<span class="ident" id="6634101">c</span><span class="op" id="6634102">.</span><span class="ident" id="6634103">VerifyHostname</span><span class="op" id="6634117">(</span><span class="string" id="6634118">&#34;[::1]&#34;</span><span class="op" id="6634125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634128">if</span>&nbsp;<span class="ident" id="6634131">err</span>&nbsp;<span class="op" id="6634135">!=</span>&nbsp;<span class="ident" id="6634138">nil</span>&nbsp;<span class="op" id="6634142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634146">t</span><span class="op" id="6634147">.</span><span class="ident" id="6634148">Fatalf</span><span class="op" id="6634154">(</span><span class="string" id="6634155">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="6634182">,</span>&nbsp;<span class="ident" id="6634184">err</span><span class="op" id="6634187">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634190">}</span><br>
<span class="lineno"></span><span class="op" id="6634192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6634195">func</span>&nbsp;<span class="ident" id="6634200">TestCertificateParse</span><span class="op" id="6634220">(</span><span class="ident" id="6634221">t</span>&nbsp;<span class="op" id="6634223">*</span><span class="ident" id="6634224">testing</span><span class="op" id="6634231">.</span><span class="ident" id="6634232">T</span><span class="op" id="6634233">)</span>&nbsp;<span class="op" id="6634235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634238">s</span><span class="op" id="6634239">,</span>&nbsp;<span class="ident" id="6634241">_</span>&nbsp;<span class="op" id="6634243">:=</span>&nbsp;<span class="ident" id="6634246">hex</span><span class="op" id="6634249">.</span><span class="ident" id="6634250">DecodeString</span><span class="op" id="6634262">(</span><span class="ident" id="6634263">certBytes</span><span class="op" id="6634272">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634275">certs</span><span class="op" id="6634280">,</span>&nbsp;<span class="ident" id="6634282">err</span>&nbsp;<span class="op" id="6634286">:=</span>&nbsp;<span class="ident" id="6634289">ParseCertificates</span><span class="op" id="6634306">(</span><span class="ident" id="6634307">s</span><span class="op" id="6634308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634311">if</span>&nbsp;<span class="ident" id="6634314">err</span>&nbsp;<span class="op" id="6634318">!=</span>&nbsp;<span class="ident" id="6634321">nil</span>&nbsp;<span class="op" id="6634325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634329">t</span><span class="op" id="6634330">.</span><span class="ident" id="6634331">Error</span><span class="op" id="6634336">(</span><span class="ident" id="6634337">err</span><span class="op" id="6634340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634346">if</span>&nbsp;<span class="builtinfunc" id="6634349">len</span><span class="op" id="6634352">(</span><span class="ident" id="6634353">certs</span><span class="op" id="6634358">)</span>&nbsp;<span class="op" id="6634360">!=</span>&nbsp;<span class="num" id="6634363">2</span>&nbsp;<span class="op" id="6634365">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634369">t</span><span class="op" id="6634370">.</span><span class="ident" id="6634371">Errorf</span><span class="op" id="6634377">(</span><span class="string" id="6634378">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="6634416">,</span>&nbsp;<span class="builtinfunc" id="6634418">len</span><span class="op" id="6634421">(</span><span class="ident" id="6634422">certs</span><span class="op" id="6634427">)</span><span class="op" id="6634428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634432">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634444">err</span>&nbsp;<span class="op" id="6634448">=</span>&nbsp;<span class="ident" id="6634450">certs</span><span class="op" id="6634455">[</span><span class="num" id="6634456">0</span><span class="op" id="6634457">]</span><span class="op" id="6634458">.</span><span class="ident" id="6634459">CheckSignatureFrom</span><span class="op" id="6634477">(</span><span class="ident" id="6634478">certs</span><span class="op" id="6634483">[</span><span class="num" id="6634484">1</span><span class="op" id="6634485">]</span><span class="op" id="6634486">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634489">if</span>&nbsp;<span class="ident" id="6634492">err</span>&nbsp;<span class="op" id="6634496">!=</span>&nbsp;<span class="ident" id="6634499">nil</span>&nbsp;<span class="op" id="6634503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634507">t</span><span class="op" id="6634508">.</span><span class="ident" id="6634509">Error</span><span class="op" id="6634514">(</span><span class="ident" id="6634515">err</span><span class="op" id="6634518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634525">if</span>&nbsp;<span class="ident" id="6634528">err</span>&nbsp;<span class="op" id="6634532">:=</span>&nbsp;<span class="ident" id="6634535">certs</span><span class="op" id="6634540">[</span><span class="num" id="6634541">0</span><span class="op" id="6634542">]</span><span class="op" id="6634543">.</span><span class="ident" id="6634544">VerifyHostname</span><span class="op" id="6634558">(</span><span class="string" id="6634559">&#34;mail.google.com&#34;</span><span class="op" id="6634576">)</span><span class="op" id="6634577">;</span>&nbsp;<span class="ident" id="6634579">err</span>&nbsp;<span class="op" id="6634583">!=</span>&nbsp;<span class="ident" id="6634586">nil</span>&nbsp;<span class="op" id="6634590">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634594">t</span><span class="op" id="6634595">.</span><span class="ident" id="6634596">Error</span><span class="op" id="6634601">(</span><span class="ident" id="6634602">err</span><span class="op" id="6634605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634612">const</span>&nbsp;<span class="ident" id="6634618">expectedExtensions</span>&nbsp;<span class="op" id="6634637">=</span>&nbsp;<span class="num" id="6634639">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6634642">if</span>&nbsp;<span class="ident" id="6634645">n</span>&nbsp;<span class="op" id="6634647">:=</span>&nbsp;<span class="builtinfunc" id="6634650">len</span><span class="op" id="6634653">(</span><span class="ident" id="6634654">certs</span><span class="op" id="6634659">[</span><span class="num" id="6634660">0</span><span class="op" id="6634661">]</span><span class="op" id="6634662">.</span><span class="ident" id="6634663">Extensions</span><span class="op" id="6634673">)</span><span class="op" id="6634674">;</span>&nbsp;<span class="ident" id="6634676">n</span>&nbsp;<span class="op" id="6634678">!=</span>&nbsp;<span class="ident" id="6634681">expectedExtensions</span>&nbsp;<span class="op" id="6634700">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6634704">t</span><span class="op" id="6634705">.</span><span class="ident" id="6634706">Errorf</span><span class="op" id="6634712">(</span><span class="string" id="6634713">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6634741">,</span>&nbsp;<span class="ident" id="6634743">expectedExtensions</span><span class="op" id="6634761">,</span>&nbsp;<span class="ident" id="6634763">n</span><span class="op" id="6634764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6634767">}</span><br>
<span class="lineno"></span><span class="op" id="6634769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6634772">var</span>&nbsp;<span class="ident" id="6634776">certBytes</span>&nbsp;<span class="op" id="6634786">=</span>&nbsp;<span class="string" id="6634788">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="6634869">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6634872">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="6634953">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6634956">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="6635037">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635040">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="6635121">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635124">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="6635205">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635208">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="6635289">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635292">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="6635373">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635376">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="6635457">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635460">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="6635541">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635544">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="6635625">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635628">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="6635709">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635712">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="6635793">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635796">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="6635877">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635880">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="6635961">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6635964">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="6636045">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636048">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="6636129">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636132">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="6636213">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636216">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="6636297">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636300">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="6636381">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636384">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="6636465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636468">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="6636549">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636552">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="6636633">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636636">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="6636717">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636720">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="6636801">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636804">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="6636885">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636888">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="6636969">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6636972">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="6637053">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637056">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="6637137">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637140">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="6637221">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637224">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="6637305">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637308">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="6637389">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637392">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="6637473">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637476">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="6637557">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637560">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="6637641">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637644">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="6637725">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637728">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="6637809">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637812">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="6637893">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637896">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="6637977">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6637980">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="6638061">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6638064">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="6638145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6638148">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="6638229">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6638232">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6638264">func</span>&nbsp;<span class="ident" id="6638269">TestCreateSelfSignedCertificate</span><span class="op" id="6638300">(</span><span class="ident" id="6638301">t</span>&nbsp;<span class="op" id="6638303">*</span><span class="ident" id="6638304">testing</span><span class="op" id="6638311">.</span><span class="ident" id="6638312">T</span><span class="op" id="6638313">)</span>&nbsp;<span class="op" id="6638315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638318">random</span>&nbsp;<span class="op" id="6638325">:=</span>&nbsp;<span class="ident" id="6638328">rand</span><span class="op" id="6638332">.</span><span class="ident" id="6638333">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638342">block</span><span class="op" id="6638347">,</span>&nbsp;<span class="ident" id="6638349">_</span>&nbsp;<span class="op" id="6638351">:=</span>&nbsp;<span class="ident" id="6638354">pem</span><span class="op" id="6638357">.</span><span class="ident" id="6638358">Decode</span><span class="op" id="6638364">(</span><span class="op" id="6638365">[</span><span class="op" id="6638366">]</span><span class="builtintype" id="6638367">byte</span><span class="op" id="6638371">(</span><span class="ident" id="6638372">pemPrivateKey</span><span class="op" id="6638385">)</span><span class="op" id="6638386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638389">rsaPriv</span><span class="op" id="6638396">,</span>&nbsp;<span class="ident" id="6638398">err</span>&nbsp;<span class="op" id="6638402">:=</span>&nbsp;<span class="ident" id="6638405">ParsePKCS1PrivateKey</span><span class="op" id="6638425">(</span><span class="ident" id="6638426">block</span><span class="op" id="6638431">.</span><span class="ident" id="6638432">Bytes</span><span class="op" id="6638437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6638440">if</span>&nbsp;<span class="ident" id="6638443">err</span>&nbsp;<span class="op" id="6638447">!=</span>&nbsp;<span class="ident" id="6638450">nil</span>&nbsp;<span class="op" id="6638454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638458">t</span><span class="op" id="6638459">.</span><span class="ident" id="6638460">Fatalf</span><span class="op" id="6638466">(</span><span class="string" id="6638467">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6638500">,</span>&nbsp;<span class="ident" id="6638502">err</span><span class="op" id="6638505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638508">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638512">ecdsaPriv</span><span class="op" id="6638521">,</span>&nbsp;<span class="ident" id="6638523">err</span>&nbsp;<span class="op" id="6638527">:=</span>&nbsp;<span class="ident" id="6638530">ecdsa</span><span class="op" id="6638535">.</span><span class="ident" id="6638536">GenerateKey</span><span class="op" id="6638547">(</span><span class="ident" id="6638548">elliptic</span><span class="op" id="6638556">.</span><span class="ident" id="6638557">P256</span><span class="op" id="6638561">(</span><span class="op" id="6638562">)</span><span class="op" id="6638563">,</span>&nbsp;<span class="ident" id="6638565">rand</span><span class="op" id="6638569">.</span><span class="ident" id="6638570">Reader</span><span class="op" id="6638576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6638579">if</span>&nbsp;<span class="ident" id="6638582">err</span>&nbsp;<span class="op" id="6638586">!=</span>&nbsp;<span class="ident" id="6638589">nil</span>&nbsp;<span class="op" id="6638593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638597">t</span><span class="op" id="6638598">.</span><span class="ident" id="6638599">Fatalf</span><span class="op" id="6638605">(</span><span class="string" id="6638606">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6638640">,</span>&nbsp;<span class="ident" id="6638642">err</span><span class="op" id="6638645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638648">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638652">tests</span>&nbsp;<span class="op" id="6638658">:=</span>&nbsp;<span class="op" id="6638661">[</span><span class="op" id="6638662">]</span><span class="keyword" id="6638663">struct</span>&nbsp;<span class="op" id="6638670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638674">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6638684">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638693">pub</span><span class="op" id="6638696">,</span>&nbsp;<span class="ident" id="6638698">priv</span>&nbsp;<span class="keyword" id="6638703">interface</span><span class="op" id="6638712">{</span><span class="op" id="6638713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638717">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="6638727">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6638734">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6638744">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638764">}</span><span class="op" id="6638765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638769">{</span><span class="string" id="6638770">&#34;RSA/RSA&#34;</span><span class="op" id="6638779">,</span>&nbsp;<span class="op" id="6638781">&amp;</span><span class="ident" id="6638782">rsaPriv</span><span class="op" id="6638789">.</span><span class="ident" id="6638790">PublicKey</span><span class="op" id="6638799">,</span>&nbsp;<span class="ident" id="6638801">rsaPriv</span><span class="op" id="6638808">,</span>&nbsp;<span class="ident" id="6638810">true</span><span class="op" id="6638814">,</span>&nbsp;<span class="ident" id="6638816">SHA1WithRSA</span><span class="op" id="6638827">}</span><span class="op" id="6638828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638832">{</span><span class="string" id="6638833">&#34;RSA/ECDSA&#34;</span><span class="op" id="6638844">,</span>&nbsp;<span class="op" id="6638846">&amp;</span><span class="ident" id="6638847">rsaPriv</span><span class="op" id="6638854">.</span><span class="ident" id="6638855">PublicKey</span><span class="op" id="6638864">,</span>&nbsp;<span class="ident" id="6638866">ecdsaPriv</span><span class="op" id="6638875">,</span>&nbsp;<span class="ident" id="6638877">false</span><span class="op" id="6638882">,</span>&nbsp;<span class="ident" id="6638884">ECDSAWithSHA384</span><span class="op" id="6638899">}</span><span class="op" id="6638900">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638904">{</span><span class="string" id="6638905">&#34;ECDSA/RSA&#34;</span><span class="op" id="6638916">,</span>&nbsp;<span class="op" id="6638918">&amp;</span><span class="ident" id="6638919">ecdsaPriv</span><span class="op" id="6638928">.</span><span class="ident" id="6638929">PublicKey</span><span class="op" id="6638938">,</span>&nbsp;<span class="ident" id="6638940">rsaPriv</span><span class="op" id="6638947">,</span>&nbsp;<span class="ident" id="6638949">false</span><span class="op" id="6638954">,</span>&nbsp;<span class="ident" id="6638956">SHA256WithRSA</span><span class="op" id="6638969">}</span><span class="op" id="6638970">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6638974">{</span><span class="string" id="6638975">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="6638988">,</span>&nbsp;<span class="op" id="6638990">&amp;</span><span class="ident" id="6638991">ecdsaPriv</span><span class="op" id="6639000">.</span><span class="ident" id="6639001">PublicKey</span><span class="op" id="6639010">,</span>&nbsp;<span class="ident" id="6639012">ecdsaPriv</span><span class="op" id="6639021">,</span>&nbsp;<span class="ident" id="6639023">true</span><span class="op" id="6639027">,</span>&nbsp;<span class="ident" id="6639029">ECDSAWithSHA1</span><span class="op" id="6639042">}</span><span class="op" id="6639043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6639046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639050">testExtKeyUsage</span>&nbsp;<span class="op" id="6639066">:=</span>&nbsp;<span class="op" id="6639069">[</span><span class="op" id="6639070">]</span><span class="ident" id="6639071">ExtKeyUsage</span><span class="op" id="6639082">{</span><span class="ident" id="6639083">ExtKeyUsageClientAuth</span><span class="op" id="6639104">,</span>&nbsp;<span class="ident" id="6639106">ExtKeyUsageServerAuth</span><span class="op" id="6639127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639130">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="6639153">:=</span>&nbsp;<span class="op" id="6639156">[</span><span class="op" id="6639157">]</span><span class="ident" id="6639158">asn1</span><span class="op" id="6639162">.</span><span class="ident" id="6639163">ObjectIdentifier</span><span class="op" id="6639179">{</span><span class="op" id="6639180">[</span><span class="op" id="6639181">]</span><span class="builtintype" id="6639182">int</span><span class="op" id="6639185">{</span><span class="num" id="6639186">1</span><span class="op" id="6639187">,</span>&nbsp;<span class="num" id="6639189">2</span><span class="op" id="6639190">,</span>&nbsp;<span class="num" id="6639192">3</span><span class="op" id="6639193">}</span><span class="op" id="6639194">,</span>&nbsp;<span class="op" id="6639196">[</span><span class="op" id="6639197">]</span><span class="builtintype" id="6639198">int</span><span class="op" id="6639201">{</span><span class="num" id="6639202">2</span><span class="op" id="6639203">,</span>&nbsp;<span class="num" id="6639205">59</span><span class="op" id="6639207">,</span>&nbsp;<span class="num" id="6639209">1</span><span class="op" id="6639210">}</span><span class="op" id="6639211">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639214">extraExtensionData</span>&nbsp;<span class="op" id="6639233">:=</span>&nbsp;<span class="op" id="6639236">[</span><span class="op" id="6639237">]</span><span class="builtintype" id="6639238">byte</span><span class="op" id="6639242">(</span><span class="string" id="6639243">&#34;extra&nbsp;extension&#34;</span><span class="op" id="6639260">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6639264">for</span>&nbsp;<span class="ident" id="6639268">_</span><span class="op" id="6639269">,</span>&nbsp;<span class="ident" id="6639271">test</span>&nbsp;<span class="op" id="6639276">:=</span>&nbsp;<span class="keyword" id="6639279">range</span>&nbsp;<span class="ident" id="6639285">tests</span>&nbsp;<span class="op" id="6639291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639295">commonName</span>&nbsp;<span class="op" id="6639306">:=</span>&nbsp;<span class="string" id="6639309">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639330">template</span>&nbsp;<span class="op" id="6639339">:=</span>&nbsp;<span class="ident" id="6639342">Certificate</span><span class="op" id="6639353">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639358">SerialNumber</span><span class="op" id="6639370">:</span>&nbsp;<span class="ident" id="6639372">big</span><span class="op" id="6639375">.</span><span class="ident" id="6639376">NewInt</span><span class="op" id="6639382">(</span><span class="num" id="6639383">1</span><span class="op" id="6639384">)</span><span class="op" id="6639385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639390">Subject</span><span class="op" id="6639397">:</span>&nbsp;<span class="ident" id="6639399">pkix</span><span class="op" id="6639403">.</span><span class="ident" id="6639404">Name</span><span class="op" id="6639408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639414">CommonName</span><span class="op" id="6639424">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6639428">commonName</span><span class="op" id="6639438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639444">Organization</span><span class="op" id="6639456">:</span>&nbsp;<span class="op" id="6639458">[</span><span class="op" id="6639459">]</span><span class="builtintype" id="6639460">string</span><span class="op" id="6639466">{</span><span class="string" id="6639467">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6639479">}</span><span class="op" id="6639480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6639485">}</span><span class="op" id="6639486">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639491">NotBefore</span><span class="op" id="6639500">:</span>&nbsp;<span class="ident" id="6639502">time</span><span class="op" id="6639506">.</span><span class="ident" id="6639507">Unix</span><span class="op" id="6639511">(</span><span class="num" id="6639512">1000</span><span class="op" id="6639516">,</span>&nbsp;<span class="num" id="6639518">0</span><span class="op" id="6639519">)</span><span class="op" id="6639520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639525">NotAfter</span><span class="op" id="6639533">:</span>&nbsp;&nbsp;<span class="ident" id="6639536">time</span><span class="op" id="6639540">.</span><span class="ident" id="6639541">Unix</span><span class="op" id="6639545">(</span><span class="num" id="6639546">100000</span><span class="op" id="6639552">,</span>&nbsp;<span class="num" id="6639554">0</span><span class="op" id="6639555">)</span><span class="op" id="6639556">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639562">SignatureAlgorithm</span><span class="op" id="6639580">:</span>&nbsp;<span class="ident" id="6639582">test</span><span class="op" id="6639586">.</span><span class="ident" id="6639587">sigAlgo</span><span class="op" id="6639594">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639600">SubjectKeyId</span><span class="op" id="6639612">:</span>&nbsp;<span class="op" id="6639614">[</span><span class="op" id="6639615">]</span><span class="builtintype" id="6639616">byte</span><span class="op" id="6639620">{</span><span class="num" id="6639621">1</span><span class="op" id="6639622">,</span>&nbsp;<span class="num" id="6639624">2</span><span class="op" id="6639625">,</span>&nbsp;<span class="num" id="6639627">3</span><span class="op" id="6639628">,</span>&nbsp;<span class="num" id="6639630">4</span><span class="op" id="6639631">}</span><span class="op" id="6639632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639637">KeyUsage</span><span class="op" id="6639645">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639651">KeyUsageCertSign</span><span class="op" id="6639667">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639673">ExtKeyUsage</span><span class="op" id="6639684">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6639693">testExtKeyUsage</span><span class="op" id="6639708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639713">UnknownExtKeyUsage</span><span class="op" id="6639731">:</span>&nbsp;<span class="ident" id="6639733">testUnknownExtKeyUsage</span><span class="op" id="6639755">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639761">BasicConstraintsValid</span><span class="op" id="6639782">:</span>&nbsp;<span class="ident" id="6639784">true</span><span class="op" id="6639788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639793">IsCA</span><span class="op" id="6639797">:</span>&nbsp;<span class="ident" id="6639799">true</span><span class="op" id="6639803">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639809">OCSPServer</span><span class="op" id="6639819">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639832">[</span><span class="op" id="6639833">]</span><span class="builtintype" id="6639834">string</span><span class="op" id="6639840">{</span><span class="string" id="6639841">&#34;http://ocsp.example.com&#34;</span><span class="op" id="6639866">}</span><span class="op" id="6639867">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639872">IssuingCertificateURL</span><span class="op" id="6639893">:</span>&nbsp;<span class="op" id="6639895">[</span><span class="op" id="6639896">]</span><span class="builtintype" id="6639897">string</span><span class="op" id="6639903">{</span><span class="string" id="6639904">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="6639936">}</span><span class="op" id="6639937">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639943">DNSNames</span><span class="op" id="6639951">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6639959">[</span><span class="op" id="6639960">]</span><span class="builtintype" id="6639961">string</span><span class="op" id="6639967">{</span><span class="string" id="6639968">&#34;test.example.com&#34;</span><span class="op" id="6639986">}</span><span class="op" id="6639987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6639992">EmailAddresses</span><span class="op" id="6640006">:</span>&nbsp;<span class="op" id="6640008">[</span><span class="op" id="6640009">]</span><span class="builtintype" id="6640010">string</span><span class="op" id="6640016">{</span><span class="string" id="6640017">&#34;gopher@golang.org&#34;</span><span class="op" id="6640036">}</span><span class="op" id="6640037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640042">IPAddresses</span><span class="op" id="6640053">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640058">[</span><span class="op" id="6640059">]</span><span class="ident" id="6640060">net</span><span class="op" id="6640063">.</span><span class="ident" id="6640064">IP</span><span class="op" id="6640066">{</span><span class="ident" id="6640067">net</span><span class="op" id="6640070">.</span><span class="ident" id="6640071">IPv4</span><span class="op" id="6640075">(</span><span class="num" id="6640076">127</span><span class="op" id="6640079">,</span>&nbsp;<span class="num" id="6640081">0</span><span class="op" id="6640082">,</span>&nbsp;<span class="num" id="6640084">0</span><span class="op" id="6640085">,</span>&nbsp;<span class="num" id="6640087">1</span><span class="op" id="6640088">)</span><span class="op" id="6640089">.</span><span class="ident" id="6640090">To4</span><span class="op" id="6640093">(</span><span class="op" id="6640094">)</span><span class="op" id="6640095">,</span>&nbsp;<span class="ident" id="6640097">net</span><span class="op" id="6640100">.</span><span class="ident" id="6640101">ParseIP</span><span class="op" id="6640108">(</span><span class="string" id="6640109">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6640131">)</span><span class="op" id="6640132">}</span><span class="op" id="6640133">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640139">PolicyIdentifiers</span><span class="op" id="6640156">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6640160">[</span><span class="op" id="6640161">]</span><span class="ident" id="6640162">asn1</span><span class="op" id="6640166">.</span><span class="ident" id="6640167">ObjectIdentifier</span><span class="op" id="6640183">{</span><span class="op" id="6640184">[</span><span class="op" id="6640185">]</span><span class="builtintype" id="6640186">int</span><span class="op" id="6640189">{</span><span class="num" id="6640190">1</span><span class="op" id="6640191">,</span>&nbsp;<span class="num" id="6640193">2</span><span class="op" id="6640194">,</span>&nbsp;<span class="num" id="6640196">3</span><span class="op" id="6640197">}</span><span class="op" id="6640198">}</span><span class="op" id="6640199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640204">PermittedDNSDomains</span><span class="op" id="6640223">:</span>&nbsp;<span class="op" id="6640225">[</span><span class="op" id="6640226">]</span><span class="builtintype" id="6640227">string</span><span class="op" id="6640233">{</span><span class="string" id="6640234">&#34;.example.com&#34;</span><span class="op" id="6640248">,</span>&nbsp;<span class="string" id="6640250">&#34;example.com&#34;</span><span class="op" id="6640263">}</span><span class="op" id="6640264">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640270">CRLDistributionPoints</span><span class="op" id="6640291">:</span>&nbsp;<span class="op" id="6640293">[</span><span class="op" id="6640294">]</span><span class="builtintype" id="6640295">string</span><span class="op" id="6640301">{</span><span class="string" id="6640302">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="6640335">,</span>&nbsp;<span class="string" id="6640337">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="6640370">}</span><span class="op" id="6640371">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640377">ExtraExtensions</span><span class="op" id="6640392">:</span>&nbsp;<span class="op" id="6640394">[</span><span class="op" id="6640395">]</span><span class="ident" id="6640396">pkix</span><span class="op" id="6640400">.</span><span class="ident" id="6640401">Extension</span><span class="op" id="6640410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640423">Id</span><span class="op" id="6640425">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640430">[</span><span class="op" id="6640431">]</span><span class="builtintype" id="6640432">int</span><span class="op" id="6640435">{</span><span class="num" id="6640436">1</span><span class="op" id="6640437">,</span>&nbsp;<span class="num" id="6640439">2</span><span class="op" id="6640440">,</span>&nbsp;<span class="num" id="6640442">3</span><span class="op" id="6640443">,</span>&nbsp;<span class="num" id="6640445">4</span><span class="op" id="6640446">}</span><span class="op" id="6640447">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640454">Value</span><span class="op" id="6640459">:</span>&nbsp;<span class="ident" id="6640461">extraExtensionData</span><span class="op" id="6640479">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640485">}</span><span class="op" id="6640486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6640492">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640562">Id</span><span class="op" id="6640564">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6640572">oidExtensionSubjectKeyId</span><span class="op" id="6640596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640603">Critical</span><span class="op" id="6640611">:</span>&nbsp;<span class="ident" id="6640613">false</span><span class="op" id="6640618">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640625">Value</span><span class="op" id="6640630">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6640635">[</span><span class="op" id="6640636">]</span><span class="builtintype" id="6640637">byte</span><span class="op" id="6640641">{</span><span class="num" id="6640642">0x04</span><span class="op" id="6640646">,</span>&nbsp;<span class="num" id="6640648">0x04</span><span class="op" id="6640652">,</span>&nbsp;<span class="num" id="6640654">4</span><span class="op" id="6640655">,</span>&nbsp;<span class="num" id="6640657">3</span><span class="op" id="6640658">,</span>&nbsp;<span class="num" id="6640660">2</span><span class="op" id="6640661">,</span>&nbsp;<span class="num" id="6640663">1</span><span class="op" id="6640664">}</span><span class="op" id="6640665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640671">}</span><span class="op" id="6640672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640677">}</span><span class="op" id="6640678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640687">derBytes</span><span class="op" id="6640695">,</span>&nbsp;<span class="ident" id="6640697">err</span>&nbsp;<span class="op" id="6640701">:=</span>&nbsp;<span class="ident" id="6640704">CreateCertificate</span><span class="op" id="6640721">(</span><span class="ident" id="6640722">random</span><span class="op" id="6640728">,</span>&nbsp;<span class="op" id="6640730">&amp;</span><span class="ident" id="6640731">template</span><span class="op" id="6640739">,</span>&nbsp;<span class="op" id="6640741">&amp;</span><span class="ident" id="6640742">template</span><span class="op" id="6640750">,</span>&nbsp;<span class="ident" id="6640752">test</span><span class="op" id="6640756">.</span><span class="ident" id="6640757">pub</span><span class="op" id="6640760">,</span>&nbsp;<span class="ident" id="6640762">test</span><span class="op" id="6640766">.</span><span class="ident" id="6640767">priv</span><span class="op" id="6640771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6640775">if</span>&nbsp;<span class="ident" id="6640778">err</span>&nbsp;<span class="op" id="6640782">!=</span>&nbsp;<span class="ident" id="6640785">nil</span>&nbsp;<span class="op" id="6640789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640794">t</span><span class="op" id="6640795">.</span><span class="ident" id="6640796">Errorf</span><span class="op" id="6640802">(</span><span class="string" id="6640803">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6640841">,</span>&nbsp;<span class="ident" id="6640843">test</span><span class="op" id="6640847">.</span><span class="ident" id="6640848">name</span><span class="op" id="6640852">,</span>&nbsp;<span class="ident" id="6640854">err</span><span class="op" id="6640857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6640862">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6640873">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640878">cert</span><span class="op" id="6640882">,</span>&nbsp;<span class="ident" id="6640884">err</span>&nbsp;<span class="op" id="6640888">:=</span>&nbsp;<span class="ident" id="6640891">ParseCertificate</span><span class="op" id="6640907">(</span><span class="ident" id="6640908">derBytes</span><span class="op" id="6640916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6640920">if</span>&nbsp;<span class="ident" id="6640923">err</span>&nbsp;<span class="op" id="6640927">!=</span>&nbsp;<span class="ident" id="6640930">nil</span>&nbsp;<span class="op" id="6640934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6640939">t</span><span class="op" id="6640940">.</span><span class="ident" id="6640941">Errorf</span><span class="op" id="6640947">(</span><span class="string" id="6640948">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6640985">,</span>&nbsp;<span class="ident" id="6640987">test</span><span class="op" id="6640991">.</span><span class="ident" id="6640992">name</span><span class="op" id="6640996">,</span>&nbsp;<span class="ident" id="6640998">err</span><span class="op" id="6641001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641006">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641022">if</span>&nbsp;<span class="builtinfunc" id="6641025">len</span><span class="op" id="6641028">(</span><span class="ident" id="6641029">cert</span><span class="op" id="6641033">.</span><span class="ident" id="6641034">PolicyIdentifiers</span><span class="op" id="6641051">)</span>&nbsp;<span class="op" id="6641053">!=</span>&nbsp;<span class="num" id="6641056">1</span>&nbsp;<span class="op" id="6641058">||</span>&nbsp;<span class="op" id="6641061">!</span><span class="ident" id="6641062">cert</span><span class="op" id="6641066">.</span><span class="ident" id="6641067">PolicyIdentifiers</span><span class="op" id="6641084">[</span><span class="num" id="6641085">0</span><span class="op" id="6641086">]</span><span class="op" id="6641087">.</span><span class="ident" id="6641088">Equal</span><span class="op" id="6641093">(</span><span class="ident" id="6641094">template</span><span class="op" id="6641102">.</span><span class="ident" id="6641103">PolicyIdentifiers</span><span class="op" id="6641120">[</span><span class="num" id="6641121">0</span><span class="op" id="6641122">]</span><span class="op" id="6641123">)</span>&nbsp;<span class="op" id="6641125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641130">t</span><span class="op" id="6641131">.</span><span class="ident" id="6641132">Errorf</span><span class="op" id="6641138">(</span><span class="string" id="6641139">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6641197">,</span>&nbsp;<span class="ident" id="6641199">test</span><span class="op" id="6641203">.</span><span class="ident" id="6641204">name</span><span class="op" id="6641208">,</span>&nbsp;<span class="ident" id="6641210">cert</span><span class="op" id="6641214">.</span><span class="ident" id="6641215">PolicyIdentifiers</span><span class="op" id="6641232">,</span>&nbsp;<span class="ident" id="6641234">template</span><span class="op" id="6641242">.</span><span class="ident" id="6641243">PolicyIdentifiers</span><span class="op" id="6641260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641264">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641269">if</span>&nbsp;<span class="builtinfunc" id="6641272">len</span><span class="op" id="6641275">(</span><span class="ident" id="6641276">cert</span><span class="op" id="6641280">.</span><span class="ident" id="6641281">PermittedDNSDomains</span><span class="op" id="6641300">)</span>&nbsp;<span class="op" id="6641302">!=</span>&nbsp;<span class="num" id="6641305">2</span>&nbsp;<span class="op" id="6641307">||</span>&nbsp;<span class="ident" id="6641310">cert</span><span class="op" id="6641314">.</span><span class="ident" id="6641315">PermittedDNSDomains</span><span class="op" id="6641334">[</span><span class="num" id="6641335">0</span><span class="op" id="6641336">]</span>&nbsp;<span class="op" id="6641338">!=</span>&nbsp;<span class="string" id="6641341">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="6641356">||</span>&nbsp;<span class="ident" id="6641359">cert</span><span class="op" id="6641363">.</span><span class="ident" id="6641364">PermittedDNSDomains</span><span class="op" id="6641383">[</span><span class="num" id="6641384">1</span><span class="op" id="6641385">]</span>&nbsp;<span class="op" id="6641387">!=</span>&nbsp;<span class="string" id="6641390">&#34;example.com&#34;</span>&nbsp;<span class="op" id="6641404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641409">t</span><span class="op" id="6641410">.</span><span class="ident" id="6641411">Errorf</span><span class="op" id="6641417">(</span><span class="string" id="6641418">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="6641461">,</span>&nbsp;<span class="ident" id="6641463">test</span><span class="op" id="6641467">.</span><span class="ident" id="6641468">name</span><span class="op" id="6641472">,</span>&nbsp;<span class="ident" id="6641474">cert</span><span class="op" id="6641478">.</span><span class="ident" id="6641479">PermittedDNSDomains</span><span class="op" id="6641498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641507">if</span>&nbsp;<span class="ident" id="6641510">cert</span><span class="op" id="6641514">.</span><span class="ident" id="6641515">Subject</span><span class="op" id="6641522">.</span><span class="ident" id="6641523">CommonName</span>&nbsp;<span class="op" id="6641534">!=</span>&nbsp;<span class="ident" id="6641537">commonName</span>&nbsp;<span class="op" id="6641548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641553">t</span><span class="op" id="6641554">.</span><span class="ident" id="6641555">Errorf</span><span class="op" id="6641561">(</span><span class="string" id="6641562">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6641634">,</span>&nbsp;<span class="ident" id="6641636">test</span><span class="op" id="6641640">.</span><span class="ident" id="6641641">name</span><span class="op" id="6641645">,</span>&nbsp;<span class="ident" id="6641647">cert</span><span class="op" id="6641651">.</span><span class="ident" id="6641652">Subject</span><span class="op" id="6641659">.</span><span class="ident" id="6641660">CommonName</span><span class="op" id="6641670">,</span>&nbsp;<span class="ident" id="6641672">commonName</span><span class="op" id="6641682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641691">if</span>&nbsp;<span class="ident" id="6641694">cert</span><span class="op" id="6641698">.</span><span class="ident" id="6641699">Issuer</span><span class="op" id="6641705">.</span><span class="ident" id="6641706">CommonName</span>&nbsp;<span class="op" id="6641717">!=</span>&nbsp;<span class="ident" id="6641720">commonName</span>&nbsp;<span class="op" id="6641731">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641736">t</span><span class="op" id="6641737">.</span><span class="ident" id="6641738">Errorf</span><span class="op" id="6641744">(</span><span class="string" id="6641745">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6641816">,</span>&nbsp;<span class="ident" id="6641818">test</span><span class="op" id="6641822">.</span><span class="ident" id="6641823">name</span><span class="op" id="6641827">,</span>&nbsp;<span class="ident" id="6641829">cert</span><span class="op" id="6641833">.</span><span class="ident" id="6641834">Issuer</span><span class="op" id="6641840">.</span><span class="ident" id="6641841">CommonName</span><span class="op" id="6641851">,</span>&nbsp;<span class="ident" id="6641853">commonName</span><span class="op" id="6641863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6641867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6641872">if</span>&nbsp;<span class="ident" id="6641875">cert</span><span class="op" id="6641879">.</span><span class="ident" id="6641880">SignatureAlgorithm</span>&nbsp;<span class="op" id="6641899">!=</span>&nbsp;<span class="ident" id="6641902">test</span><span class="op" id="6641906">.</span><span class="ident" id="6641907">sigAlgo</span>&nbsp;<span class="op" id="6641915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6641920">t</span><span class="op" id="6641921">.</span><span class="ident" id="6641922">Errorf</span><span class="op" id="6641928">(</span><span class="string" id="6641929">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6641998">,</span>&nbsp;<span class="ident" id="6642000">test</span><span class="op" id="6642004">.</span><span class="ident" id="6642005">name</span><span class="op" id="6642009">,</span>&nbsp;<span class="ident" id="6642011">cert</span><span class="op" id="6642015">.</span><span class="ident" id="6642016">SignatureAlgorithm</span><span class="op" id="6642034">,</span>&nbsp;<span class="ident" id="6642036">test</span><span class="op" id="6642040">.</span><span class="ident" id="6642041">sigAlgo</span><span class="op" id="6642048">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642057">if</span>&nbsp;<span class="op" id="6642060">!</span><span class="ident" id="6642061">reflect</span><span class="op" id="6642068">.</span><span class="ident" id="6642069">DeepEqual</span><span class="op" id="6642078">(</span><span class="ident" id="6642079">cert</span><span class="op" id="6642083">.</span><span class="ident" id="6642084">ExtKeyUsage</span><span class="op" id="6642095">,</span>&nbsp;<span class="ident" id="6642097">testExtKeyUsage</span><span class="op" id="6642112">)</span>&nbsp;<span class="op" id="6642114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642119">t</span><span class="op" id="6642120">.</span><span class="ident" id="6642121">Errorf</span><span class="op" id="6642127">(</span><span class="string" id="6642128">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6642204">,</span>&nbsp;<span class="ident" id="6642206">test</span><span class="op" id="6642210">.</span><span class="ident" id="6642211">name</span><span class="op" id="6642215">,</span>&nbsp;<span class="ident" id="6642217">cert</span><span class="op" id="6642221">.</span><span class="ident" id="6642222">ExtKeyUsage</span><span class="op" id="6642233">,</span>&nbsp;<span class="ident" id="6642235">testExtKeyUsage</span><span class="op" id="6642250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642254">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642259">if</span>&nbsp;<span class="op" id="6642262">!</span><span class="ident" id="6642263">reflect</span><span class="op" id="6642270">.</span><span class="ident" id="6642271">DeepEqual</span><span class="op" id="6642280">(</span><span class="ident" id="6642281">cert</span><span class="op" id="6642285">.</span><span class="ident" id="6642286">UnknownExtKeyUsage</span><span class="op" id="6642304">,</span>&nbsp;<span class="ident" id="6642306">testUnknownExtKeyUsage</span><span class="op" id="6642328">)</span>&nbsp;<span class="op" id="6642330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642335">t</span><span class="op" id="6642336">.</span><span class="ident" id="6642337">Errorf</span><span class="op" id="6642343">(</span><span class="string" id="6642344">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6642428">,</span>&nbsp;<span class="ident" id="6642430">test</span><span class="op" id="6642434">.</span><span class="ident" id="6642435">name</span><span class="op" id="6642439">,</span>&nbsp;<span class="ident" id="6642441">cert</span><span class="op" id="6642445">.</span><span class="ident" id="6642446">UnknownExtKeyUsage</span><span class="op" id="6642464">,</span>&nbsp;<span class="ident" id="6642466">testUnknownExtKeyUsage</span><span class="op" id="6642488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642492">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642497">if</span>&nbsp;<span class="op" id="6642500">!</span><span class="ident" id="6642501">reflect</span><span class="op" id="6642508">.</span><span class="ident" id="6642509">DeepEqual</span><span class="op" id="6642518">(</span><span class="ident" id="6642519">cert</span><span class="op" id="6642523">.</span><span class="ident" id="6642524">OCSPServer</span><span class="op" id="6642534">,</span>&nbsp;<span class="ident" id="6642536">template</span><span class="op" id="6642544">.</span><span class="ident" id="6642545">OCSPServer</span><span class="op" id="6642555">)</span>&nbsp;<span class="op" id="6642557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642562">t</span><span class="op" id="6642563">.</span><span class="ident" id="6642564">Errorf</span><span class="op" id="6642570">(</span><span class="string" id="6642571">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6642627">,</span>&nbsp;<span class="ident" id="6642629">test</span><span class="op" id="6642633">.</span><span class="ident" id="6642634">name</span><span class="op" id="6642638">,</span>&nbsp;<span class="ident" id="6642640">cert</span><span class="op" id="6642644">.</span><span class="ident" id="6642645">OCSPServer</span><span class="op" id="6642655">,</span>&nbsp;<span class="ident" id="6642657">template</span><span class="op" id="6642665">.</span><span class="ident" id="6642666">OCSPServer</span><span class="op" id="6642676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642685">if</span>&nbsp;<span class="op" id="6642688">!</span><span class="ident" id="6642689">reflect</span><span class="op" id="6642696">.</span><span class="ident" id="6642697">DeepEqual</span><span class="op" id="6642706">(</span><span class="ident" id="6642707">cert</span><span class="op" id="6642711">.</span><span class="ident" id="6642712">IssuingCertificateURL</span><span class="op" id="6642733">,</span>&nbsp;<span class="ident" id="6642735">template</span><span class="op" id="6642743">.</span><span class="ident" id="6642744">IssuingCertificateURL</span><span class="op" id="6642765">)</span>&nbsp;<span class="op" id="6642767">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642772">t</span><span class="op" id="6642773">.</span><span class="ident" id="6642774">Errorf</span><span class="op" id="6642780">(</span><span class="string" id="6642781">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6642849">,</span>&nbsp;<span class="ident" id="6642851">test</span><span class="op" id="6642855">.</span><span class="ident" id="6642856">name</span><span class="op" id="6642860">,</span>&nbsp;<span class="ident" id="6642862">cert</span><span class="op" id="6642866">.</span><span class="ident" id="6642867">IssuingCertificateURL</span><span class="op" id="6642888">,</span>&nbsp;<span class="ident" id="6642890">template</span><span class="op" id="6642898">.</span><span class="ident" id="6642899">IssuingCertificateURL</span><span class="op" id="6642920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6642924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6642929">if</span>&nbsp;<span class="op" id="6642932">!</span><span class="ident" id="6642933">reflect</span><span class="op" id="6642940">.</span><span class="ident" id="6642941">DeepEqual</span><span class="op" id="6642950">(</span><span class="ident" id="6642951">cert</span><span class="op" id="6642955">.</span><span class="ident" id="6642956">DNSNames</span><span class="op" id="6642964">,</span>&nbsp;<span class="ident" id="6642966">template</span><span class="op" id="6642974">.</span><span class="ident" id="6642975">DNSNames</span><span class="op" id="6642983">)</span>&nbsp;<span class="op" id="6642985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6642990">t</span><span class="op" id="6642991">.</span><span class="ident" id="6642992">Errorf</span><span class="op" id="6642998">(</span><span class="string" id="6642999">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6643056">,</span>&nbsp;<span class="ident" id="6643058">test</span><span class="op" id="6643062">.</span><span class="ident" id="6643063">name</span><span class="op" id="6643067">,</span>&nbsp;<span class="ident" id="6643069">cert</span><span class="op" id="6643073">.</span><span class="ident" id="6643074">DNSNames</span><span class="op" id="6643082">,</span>&nbsp;<span class="ident" id="6643084">template</span><span class="op" id="6643092">.</span><span class="ident" id="6643093">DNSNames</span><span class="op" id="6643101">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6643110">if</span>&nbsp;<span class="op" id="6643113">!</span><span class="ident" id="6643114">reflect</span><span class="op" id="6643121">.</span><span class="ident" id="6643122">DeepEqual</span><span class="op" id="6643131">(</span><span class="ident" id="6643132">cert</span><span class="op" id="6643136">.</span><span class="ident" id="6643137">EmailAddresses</span><span class="op" id="6643151">,</span>&nbsp;<span class="ident" id="6643153">template</span><span class="op" id="6643161">.</span><span class="ident" id="6643162">EmailAddresses</span><span class="op" id="6643176">)</span>&nbsp;<span class="op" id="6643178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6643183">t</span><span class="op" id="6643184">.</span><span class="ident" id="6643185">Errorf</span><span class="op" id="6643191">(</span><span class="string" id="6643192">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6643246">,</span>&nbsp;<span class="ident" id="6643248">test</span><span class="op" id="6643252">.</span><span class="ident" id="6643253">name</span><span class="op" id="6643257">,</span>&nbsp;<span class="ident" id="6643259">cert</span><span class="op" id="6643263">.</span><span class="ident" id="6643264">EmailAddresses</span><span class="op" id="6643278">,</span>&nbsp;<span class="ident" id="6643280">template</span><span class="op" id="6643288">.</span><span class="ident" id="6643289">EmailAddresses</span><span class="op" id="6643303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643307">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6643312">if</span>&nbsp;<span class="op" id="6643315">!</span><span class="ident" id="6643316">reflect</span><span class="op" id="6643323">.</span><span class="ident" id="6643324">DeepEqual</span><span class="op" id="6643333">(</span><span class="ident" id="6643334">cert</span><span class="op" id="6643338">.</span><span class="ident" id="6643339">IPAddresses</span><span class="op" id="6643350">,</span>&nbsp;<span class="ident" id="6643352">template</span><span class="op" id="6643360">.</span><span class="ident" id="6643361">IPAddresses</span><span class="op" id="6643372">)</span>&nbsp;<span class="op" id="6643374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6643379">t</span><span class="op" id="6643380">.</span><span class="ident" id="6643381">Errorf</span><span class="op" id="6643387">(</span><span class="string" id="6643388">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6643439">,</span>&nbsp;<span class="ident" id="6643441">test</span><span class="op" id="6643445">.</span><span class="ident" id="6643446">name</span><span class="op" id="6643450">,</span>&nbsp;<span class="ident" id="6643452">cert</span><span class="op" id="6643456">.</span><span class="ident" id="6643457">IPAddresses</span><span class="op" id="6643468">,</span>&nbsp;<span class="ident" id="6643470">template</span><span class="op" id="6643478">.</span><span class="ident" id="6643479">IPAddresses</span><span class="op" id="6643490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6643499">if</span>&nbsp;<span class="op" id="6643502">!</span><span class="ident" id="6643503">reflect</span><span class="op" id="6643510">.</span><span class="ident" id="6643511">DeepEqual</span><span class="op" id="6643520">(</span><span class="ident" id="6643521">cert</span><span class="op" id="6643525">.</span><span class="ident" id="6643526">CRLDistributionPoints</span><span class="op" id="6643547">,</span>&nbsp;<span class="ident" id="6643549">template</span><span class="op" id="6643557">.</span><span class="ident" id="6643558">CRLDistributionPoints</span><span class="op" id="6643579">)</span>&nbsp;<span class="op" id="6643581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6643586">t</span><span class="op" id="6643587">.</span><span class="ident" id="6643588">Errorf</span><span class="op" id="6643594">(</span><span class="string" id="6643595">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6643662">,</span>&nbsp;<span class="ident" id="6643664">test</span><span class="op" id="6643668">.</span><span class="ident" id="6643669">name</span><span class="op" id="6643673">,</span>&nbsp;<span class="ident" id="6643675">cert</span><span class="op" id="6643679">.</span><span class="ident" id="6643680">CRLDistributionPoints</span><span class="op" id="6643701">,</span>&nbsp;<span class="ident" id="6643703">template</span><span class="op" id="6643711">.</span><span class="ident" id="6643712">CRLDistributionPoints</span><span class="op" id="6643733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6643742">if</span>&nbsp;<span class="op" id="6643745">!</span><span class="ident" id="6643746">bytes</span><span class="op" id="6643751">.</span><span class="ident" id="6643752">Equal</span><span class="op" id="6643757">(</span><span class="ident" id="6643758">cert</span><span class="op" id="6643762">.</span><span class="ident" id="6643763">SubjectKeyId</span><span class="op" id="6643775">,</span>&nbsp;<span class="op" id="6643777">[</span><span class="op" id="6643778">]</span><span class="builtintype" id="6643779">byte</span><span class="op" id="6643783">{</span><span class="num" id="6643784">4</span><span class="op" id="6643785">,</span>&nbsp;<span class="num" id="6643787">3</span><span class="op" id="6643788">,</span>&nbsp;<span class="num" id="6643790">2</span><span class="op" id="6643791">,</span>&nbsp;<span class="num" id="6643793">1</span><span class="op" id="6643794">}</span><span class="op" id="6643795">)</span>&nbsp;<span class="op" id="6643797">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6643802">t</span><span class="op" id="6643803">.</span><span class="ident" id="6643804">Errorf</span><span class="op" id="6643810">(</span><span class="string" id="6643811">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="6643861">,</span>&nbsp;<span class="ident" id="6643863">test</span><span class="op" id="6643867">.</span><span class="ident" id="6643868">name</span><span class="op" id="6643872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6643876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6643881">if</span>&nbsp;<span class="ident" id="6643884">bytes</span><span class="op" id="6643889">.</span><span class="ident" id="6643890">Index</span><span class="op" id="6643895">(</span><span class="ident" id="6643896">derBytes</span><span class="op" id="6643904">,</span>&nbsp;<span class="ident" id="6643906">extraExtensionData</span><span class="op" id="6643924">)</span>&nbsp;<span class="op" id="6643926">==</span>&nbsp;<span class="op" id="6643929">-</span><span class="num" id="6643930">1</span>&nbsp;<span class="op" id="6643932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6643937">t</span><span class="op" id="6643938">.</span><span class="ident" id="6643939">Errorf</span><span class="op" id="6643945">(</span><span class="string" id="6643946">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="6643993">,</span>&nbsp;<span class="ident" id="6643995">test</span><span class="op" id="6643999">.</span><span class="ident" id="6644000">name</span><span class="op" id="6644004">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644013">if</span>&nbsp;<span class="ident" id="6644016">test</span><span class="op" id="6644020">.</span><span class="ident" id="6644021">checkSig</span>&nbsp;<span class="op" id="6644030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644035">err</span>&nbsp;<span class="op" id="6644039">=</span>&nbsp;<span class="ident" id="6644041">cert</span><span class="op" id="6644045">.</span><span class="ident" id="6644046">CheckSignatureFrom</span><span class="op" id="6644064">(</span><span class="ident" id="6644065">cert</span><span class="op" id="6644069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6644074">if</span>&nbsp;<span class="ident" id="6644077">err</span>&nbsp;<span class="op" id="6644081">!=</span>&nbsp;<span class="ident" id="6644084">nil</span>&nbsp;<span class="op" id="6644088">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6644094">t</span><span class="op" id="6644095">.</span><span class="ident" id="6644096">Errorf</span><span class="op" id="6644102">(</span><span class="string" id="6644103">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6644142">,</span>&nbsp;<span class="ident" id="6644144">test</span><span class="op" id="6644148">.</span><span class="ident" id="6644149">name</span><span class="op" id="6644153">,</span>&nbsp;<span class="ident" id="6644155">err</span><span class="op" id="6644158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6644170">}</span><br>
<span class="lineno"></span><span class="op" id="6644172">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6644175">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="6644236">var</span>&nbsp;<span class="ident" id="6644240">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="6644257">=</span>&nbsp;<span class="string" id="6644259">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6645038">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="6645101">var</span>&nbsp;<span class="ident" id="6645105">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="6645128">=</span>&nbsp;<span class="string" id="6645130">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6645909">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="6645972">var</span>&nbsp;<span class="ident" id="6645976">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="6645999">=</span>&nbsp;<span class="string" id="6646001">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="6646861">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="6646924">var</span>&nbsp;<span class="ident" id="6646928">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="6646951">=</span>&nbsp;<span class="string" id="6646953">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="6647914">var</span>&nbsp;<span class="ident" id="6647918">ecdsaTests</span>&nbsp;<span class="op" id="6647929">=</span>&nbsp;<span class="op" id="6647931">[</span><span class="op" id="6647932">]</span><span class="keyword" id="6647933">struct</span>&nbsp;<span class="op" id="6647940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647943">sigAlgo</span>&nbsp;<span class="ident" id="6647951">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6647971">pemCert</span>&nbsp;<span class="builtintype" id="6647979">string</span><br>
<span class="lineno"></span><span class="op" id="6647986">}</span><span class="op" id="6647987">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6647990">{</span><span class="ident" id="6647991">ECDSAWithSHA1</span><span class="op" id="6648004">,</span>&nbsp;<span class="ident" id="6648006">ecdsaSHA1CertPem</span><span class="op" id="6648022">}</span><span class="op" id="6648023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648026">{</span><span class="ident" id="6648027">ECDSAWithSHA256</span><span class="op" id="6648042">,</span>&nbsp;<span class="ident" id="6648044">ecdsaSHA256p256CertPem</span><span class="op" id="6648066">}</span><span class="op" id="6648067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648070">{</span><span class="ident" id="6648071">ECDSAWithSHA256</span><span class="op" id="6648086">,</span>&nbsp;<span class="ident" id="6648088">ecdsaSHA256p384CertPem</span><span class="op" id="6648110">}</span><span class="op" id="6648111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648114">{</span><span class="ident" id="6648115">ECDSAWithSHA384</span><span class="op" id="6648130">,</span>&nbsp;<span class="ident" id="6648132">ecdsaSHA384p521CertPem</span><span class="op" id="6648154">}</span><span class="op" id="6648155">,</span><br>
<span class="lineno"></span><span class="op" id="6648157">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="6648160">func</span>&nbsp;<span class="ident" id="6648165">TestECDSA</span><span class="op" id="6648174">(</span><span class="ident" id="6648175">t</span>&nbsp;<span class="op" id="6648177">*</span><span class="ident" id="6648178">testing</span><span class="op" id="6648185">.</span><span class="ident" id="6648186">T</span><span class="op" id="6648187">)</span>&nbsp;<span class="op" id="6648189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648192">for</span>&nbsp;<span class="ident" id="6648196">i</span><span class="op" id="6648197">,</span>&nbsp;<span class="ident" id="6648199">test</span>&nbsp;<span class="op" id="6648204">:=</span>&nbsp;<span class="keyword" id="6648207">range</span>&nbsp;<span class="ident" id="6648213">ecdsaTests</span>&nbsp;<span class="op" id="6648224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648228">pemBlock</span><span class="op" id="6648236">,</span>&nbsp;<span class="ident" id="6648238">_</span>&nbsp;<span class="op" id="6648240">:=</span>&nbsp;<span class="ident" id="6648243">pem</span><span class="op" id="6648246">.</span><span class="ident" id="6648247">Decode</span><span class="op" id="6648253">(</span><span class="op" id="6648254">[</span><span class="op" id="6648255">]</span><span class="builtintype" id="6648256">byte</span><span class="op" id="6648260">(</span><span class="ident" id="6648261">test</span><span class="op" id="6648265">.</span><span class="ident" id="6648266">pemCert</span><span class="op" id="6648273">)</span><span class="op" id="6648274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648278">cert</span><span class="op" id="6648282">,</span>&nbsp;<span class="ident" id="6648284">err</span>&nbsp;<span class="op" id="6648288">:=</span>&nbsp;<span class="ident" id="6648291">ParseCertificate</span><span class="op" id="6648307">(</span><span class="ident" id="6648308">pemBlock</span><span class="op" id="6648316">.</span><span class="ident" id="6648317">Bytes</span><span class="op" id="6648322">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648326">if</span>&nbsp;<span class="ident" id="6648329">err</span>&nbsp;<span class="op" id="6648333">!=</span>&nbsp;<span class="ident" id="6648336">nil</span>&nbsp;<span class="op" id="6648340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648345">t</span><span class="op" id="6648346">.</span><span class="ident" id="6648347">Errorf</span><span class="op" id="6648353">(</span><span class="string" id="6648354">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6648391">,</span>&nbsp;<span class="ident" id="6648393">i</span><span class="op" id="6648394">,</span>&nbsp;<span class="ident" id="6648396">err</span><span class="op" id="6648399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648404">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648419">if</span>&nbsp;<span class="ident" id="6648422">sa</span>&nbsp;<span class="op" id="6648425">:=</span>&nbsp;<span class="ident" id="6648428">cert</span><span class="op" id="6648432">.</span><span class="ident" id="6648433">SignatureAlgorithm</span><span class="op" id="6648451">;</span>&nbsp;<span class="ident" id="6648453">sa</span>&nbsp;<span class="op" id="6648456">!=</span>&nbsp;<span class="ident" id="6648459">test</span><span class="op" id="6648463">.</span><span class="ident" id="6648464">sigAlgo</span>&nbsp;<span class="op" id="6648472">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648477">t</span><span class="op" id="6648478">.</span><span class="ident" id="6648479">Errorf</span><span class="op" id="6648485">(</span><span class="string" id="6648486">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6648526">,</span>&nbsp;<span class="ident" id="6648528">i</span><span class="op" id="6648529">,</span>&nbsp;<span class="ident" id="6648531">sa</span><span class="op" id="6648533">,</span>&nbsp;<span class="ident" id="6648535">test</span><span class="op" id="6648539">.</span><span class="ident" id="6648540">sigAlgo</span><span class="op" id="6648547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648555">if</span>&nbsp;<span class="ident" id="6648558">parsedKey</span><span class="op" id="6648567">,</span>&nbsp;<span class="ident" id="6648569">ok</span>&nbsp;<span class="op" id="6648572">:=</span>&nbsp;<span class="ident" id="6648575">cert</span><span class="op" id="6648579">.</span><span class="ident" id="6648580">PublicKey</span><span class="op" id="6648589">.</span><span class="op" id="6648590">(</span><span class="op" id="6648591">*</span><span class="ident" id="6648592">ecdsa</span><span class="op" id="6648597">.</span><span class="ident" id="6648598">PublicKey</span><span class="op" id="6648607">)</span><span class="op" id="6648608">;</span>&nbsp;<span class="op" id="6648610">!</span><span class="ident" id="6648611">ok</span>&nbsp;<span class="op" id="6648614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648619">t</span><span class="op" id="6648620">.</span><span class="ident" id="6648621">Errorf</span><span class="op" id="6648627">(</span><span class="string" id="6648628">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="6648675">,</span>&nbsp;<span class="ident" id="6648677">i</span><span class="op" id="6648678">,</span>&nbsp;<span class="ident" id="6648680">parsedKey</span><span class="op" id="6648689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648693">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648697">if</span>&nbsp;<span class="ident" id="6648700">pka</span>&nbsp;<span class="op" id="6648704">:=</span>&nbsp;<span class="ident" id="6648707">cert</span><span class="op" id="6648711">.</span><span class="ident" id="6648712">PublicKeyAlgorithm</span><span class="op" id="6648730">;</span>&nbsp;<span class="ident" id="6648732">pka</span>&nbsp;<span class="op" id="6648736">!=</span>&nbsp;<span class="ident" id="6648739">ECDSA</span>&nbsp;<span class="op" id="6648745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648750">t</span><span class="op" id="6648751">.</span><span class="ident" id="6648752">Errorf</span><span class="op" id="6648758">(</span><span class="string" id="6648759">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="6648803">,</span>&nbsp;<span class="ident" id="6648805">i</span><span class="op" id="6648806">,</span>&nbsp;<span class="ident" id="6648808">pka</span><span class="op" id="6648811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6648819">if</span>&nbsp;<span class="ident" id="6648822">err</span>&nbsp;<span class="op" id="6648826">=</span>&nbsp;<span class="ident" id="6648828">cert</span><span class="op" id="6648832">.</span><span class="ident" id="6648833">CheckSignatureFrom</span><span class="op" id="6648851">(</span><span class="ident" id="6648852">cert</span><span class="op" id="6648856">)</span><span class="op" id="6648857">;</span>&nbsp;<span class="ident" id="6648859">err</span>&nbsp;<span class="op" id="6648863">!=</span>&nbsp;<span class="ident" id="6648866">nil</span>&nbsp;<span class="op" id="6648870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6648875">t</span><span class="op" id="6648876">.</span><span class="ident" id="6648877">Errorf</span><span class="op" id="6648883">(</span><span class="string" id="6648884">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6648925">,</span>&nbsp;<span class="ident" id="6648927">i</span><span class="op" id="6648928">,</span>&nbsp;<span class="ident" id="6648930">err</span><span class="op" id="6648933">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6648940">}</span><br>
<span class="lineno"></span><span class="op" id="6648942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6648945">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="6648992">var</span>&nbsp;<span class="ident" id="6648996">dsaCertPem</span>&nbsp;<span class="op" id="6649007">=</span>&nbsp;<span class="string" id="6649009">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="6650477">func</span>&nbsp;<span class="ident" id="6650482">TestParseCertificateWithDsaPublicKey</span><span class="op" id="6650518">(</span><span class="ident" id="6650519">t</span>&nbsp;<span class="op" id="6650521">*</span><span class="ident" id="6650522">testing</span><span class="op" id="6650529">.</span><span class="ident" id="6650530">T</span><span class="op" id="6650531">)</span>&nbsp;<span class="op" id="6650533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650536">expectedKey</span>&nbsp;<span class="op" id="6650548">:=</span>&nbsp;<span class="op" id="6650551">&amp;</span><span class="ident" id="6650552">dsa</span><span class="op" id="6650555">.</span><span class="ident" id="6650556">PublicKey</span><span class="op" id="6650565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650569">Parameters</span><span class="op" id="6650579">:</span>&nbsp;<span class="ident" id="6650581">dsa</span><span class="op" id="6650584">.</span><span class="ident" id="6650585">Parameters</span><span class="op" id="6650595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650600">P</span><span class="op" id="6650601">:</span>&nbsp;<span class="ident" id="6650603">bigFromHexString</span><span class="op" id="6650619">(</span><span class="string" id="6650620">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="6650880">)</span><span class="op" id="6650881">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650886">Q</span><span class="op" id="6650887">:</span>&nbsp;<span class="ident" id="6650889">bigFromHexString</span><span class="op" id="6650905">(</span><span class="string" id="6650906">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="6650950">)</span><span class="op" id="6650951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6650956">G</span><span class="op" id="6650957">:</span>&nbsp;<span class="ident" id="6650959">bigFromHexString</span><span class="op" id="6650975">(</span><span class="string" id="6650976">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="6651236">)</span><span class="op" id="6651237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651241">}</span><span class="op" id="6651242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651246">Y</span><span class="op" id="6651247">:</span>&nbsp;<span class="ident" id="6651249">bigFromHexString</span><span class="op" id="6651265">(</span><span class="string" id="6651266">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="6651524">)</span><span class="op" id="6651525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651528">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651531">pemBlock</span><span class="op" id="6651539">,</span>&nbsp;<span class="ident" id="6651541">_</span>&nbsp;<span class="op" id="6651543">:=</span>&nbsp;<span class="ident" id="6651546">pem</span><span class="op" id="6651549">.</span><span class="ident" id="6651550">Decode</span><span class="op" id="6651556">(</span><span class="op" id="6651557">[</span><span class="op" id="6651558">]</span><span class="builtintype" id="6651559">byte</span><span class="op" id="6651563">(</span><span class="ident" id="6651564">dsaCertPem</span><span class="op" id="6651574">)</span><span class="op" id="6651575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651578">cert</span><span class="op" id="6651582">,</span>&nbsp;<span class="ident" id="6651584">err</span>&nbsp;<span class="op" id="6651588">:=</span>&nbsp;<span class="ident" id="6651591">ParseCertificate</span><span class="op" id="6651607">(</span><span class="ident" id="6651608">pemBlock</span><span class="op" id="6651616">.</span><span class="ident" id="6651617">Bytes</span><span class="op" id="6651622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651625">if</span>&nbsp;<span class="ident" id="6651628">err</span>&nbsp;<span class="op" id="6651632">!=</span>&nbsp;<span class="ident" id="6651635">nil</span>&nbsp;<span class="op" id="6651639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651643">t</span><span class="op" id="6651644">.</span><span class="ident" id="6651645">Fatalf</span><span class="op" id="6651651">(</span><span class="string" id="6651652">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6651685">,</span>&nbsp;<span class="ident" id="6651687">err</span><span class="op" id="6651690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651693">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651696">if</span>&nbsp;<span class="ident" id="6651699">cert</span><span class="op" id="6651703">.</span><span class="ident" id="6651704">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="6651723">!=</span>&nbsp;<span class="ident" id="6651726">DSA</span>&nbsp;<span class="op" id="6651730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651734">t</span><span class="op" id="6651735">.</span><span class="ident" id="6651736">Errorf</span><span class="op" id="6651742">(</span><span class="string" id="6651743">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="6651777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651783">parsedKey</span><span class="op" id="6651792">,</span>&nbsp;<span class="ident" id="6651794">ok</span>&nbsp;<span class="op" id="6651797">:=</span>&nbsp;<span class="ident" id="6651800">cert</span><span class="op" id="6651804">.</span><span class="ident" id="6651805">PublicKey</span><span class="op" id="6651814">.</span><span class="op" id="6651815">(</span><span class="op" id="6651816">*</span><span class="ident" id="6651817">dsa</span><span class="op" id="6651820">.</span><span class="ident" id="6651821">PublicKey</span><span class="op" id="6651830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651833">if</span>&nbsp;<span class="op" id="6651836">!</span><span class="ident" id="6651837">ok</span>&nbsp;<span class="op" id="6651840">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651844">t</span><span class="op" id="6651845">.</span><span class="ident" id="6651846">Fatalf</span><span class="op" id="6651852">(</span><span class="string" id="6651853">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6651887">,</span>&nbsp;<span class="ident" id="6651889">err</span><span class="op" id="6651892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6651895">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6651898">if</span>&nbsp;<span class="ident" id="6651901">expectedKey</span><span class="op" id="6651912">.</span><span class="ident" id="6651913">Y</span><span class="op" id="6651914">.</span><span class="ident" id="6651915">Cmp</span><span class="op" id="6651918">(</span><span class="ident" id="6651919">parsedKey</span><span class="op" id="6651928">.</span><span class="ident" id="6651929">Y</span><span class="op" id="6651930">)</span>&nbsp;<span class="op" id="6651932">!=</span>&nbsp;<span class="num" id="6651935">0</span>&nbsp;<span class="op" id="6651937">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651942">expectedKey</span><span class="op" id="6651953">.</span><span class="ident" id="6651954">P</span><span class="op" id="6651955">.</span><span class="ident" id="6651956">Cmp</span><span class="op" id="6651959">(</span><span class="ident" id="6651960">parsedKey</span><span class="op" id="6651969">.</span><span class="ident" id="6651970">P</span><span class="op" id="6651971">)</span>&nbsp;<span class="op" id="6651973">!=</span>&nbsp;<span class="num" id="6651976">0</span>&nbsp;<span class="op" id="6651978">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6651983">expectedKey</span><span class="op" id="6651994">.</span><span class="ident" id="6651995">Q</span><span class="op" id="6651996">.</span><span class="ident" id="6651997">Cmp</span><span class="op" id="6652000">(</span><span class="ident" id="6652001">parsedKey</span><span class="op" id="6652010">.</span><span class="ident" id="6652011">Q</span><span class="op" id="6652012">)</span>&nbsp;<span class="op" id="6652014">!=</span>&nbsp;<span class="num" id="6652017">0</span>&nbsp;<span class="op" id="6652019">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652024">expectedKey</span><span class="op" id="6652035">.</span><span class="ident" id="6652036">G</span><span class="op" id="6652037">.</span><span class="ident" id="6652038">Cmp</span><span class="op" id="6652041">(</span><span class="ident" id="6652042">parsedKey</span><span class="op" id="6652051">.</span><span class="ident" id="6652052">G</span><span class="op" id="6652053">)</span>&nbsp;<span class="op" id="6652055">!=</span>&nbsp;<span class="num" id="6652058">0</span>&nbsp;<span class="op" id="6652060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652064">t</span><span class="op" id="6652065">.</span><span class="ident" id="6652066">Fatal</span><span class="op" id="6652071">(</span><span class="string" id="6652072">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="6652110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652113">}</span><br>
<span class="lineno"></span><span class="op" id="6652115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="6652118">func</span>&nbsp;<span class="ident" id="6652123">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="6652168">(</span><span class="ident" id="6652169">t</span>&nbsp;<span class="op" id="6652171">*</span><span class="ident" id="6652172">testing</span><span class="op" id="6652179">.</span><span class="ident" id="6652180">T</span><span class="op" id="6652181">)</span>&nbsp;<span class="op" id="6652183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652186">pemBlock</span><span class="op" id="6652194">,</span>&nbsp;<span class="ident" id="6652196">_</span>&nbsp;<span class="op" id="6652198">:=</span>&nbsp;<span class="ident" id="6652201">pem</span><span class="op" id="6652204">.</span><span class="ident" id="6652205">Decode</span><span class="op" id="6652211">(</span><span class="op" id="6652212">[</span><span class="op" id="6652213">]</span><span class="builtintype" id="6652214">byte</span><span class="op" id="6652218">(</span><span class="ident" id="6652219">dsaCertPem</span><span class="op" id="6652229">)</span><span class="op" id="6652230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652233">cert</span><span class="op" id="6652237">,</span>&nbsp;<span class="ident" id="6652239">err</span>&nbsp;<span class="op" id="6652243">:=</span>&nbsp;<span class="ident" id="6652246">ParseCertificate</span><span class="op" id="6652262">(</span><span class="ident" id="6652263">pemBlock</span><span class="op" id="6652271">.</span><span class="ident" id="6652272">Bytes</span><span class="op" id="6652277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652280">if</span>&nbsp;<span class="ident" id="6652283">err</span>&nbsp;<span class="op" id="6652287">!=</span>&nbsp;<span class="ident" id="6652290">nil</span>&nbsp;<span class="op" id="6652294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652298">t</span><span class="op" id="6652299">.</span><span class="ident" id="6652300">Fatalf</span><span class="op" id="6652306">(</span><span class="string" id="6652307">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6652340">,</span>&nbsp;<span class="ident" id="6652342">err</span><span class="op" id="6652345">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652351">if</span>&nbsp;<span class="ident" id="6652354">cert</span><span class="op" id="6652358">.</span><span class="ident" id="6652359">SignatureAlgorithm</span>&nbsp;<span class="op" id="6652378">!=</span>&nbsp;<span class="ident" id="6652381">DSAWithSHA1</span>&nbsp;<span class="op" id="6652393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652397">t</span><span class="op" id="6652398">.</span><span class="ident" id="6652399">Errorf</span><span class="op" id="6652405">(</span><span class="string" id="6652406">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="6652454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652457">}</span><br>
<span class="lineno"></span><span class="op" id="6652459">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="6652462">func</span>&nbsp;<span class="ident" id="6652467">TestVerifyCertificateWithDSASignature</span><span class="op" id="6652504">(</span><span class="ident" id="6652505">t</span>&nbsp;<span class="op" id="6652507">*</span><span class="ident" id="6652508">testing</span><span class="op" id="6652515">.</span><span class="ident" id="6652516">T</span><span class="op" id="6652517">)</span>&nbsp;<span class="op" id="6652519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652522">pemBlock</span><span class="op" id="6652530">,</span>&nbsp;<span class="ident" id="6652532">_</span>&nbsp;<span class="op" id="6652534">:=</span>&nbsp;<span class="ident" id="6652537">pem</span><span class="op" id="6652540">.</span><span class="ident" id="6652541">Decode</span><span class="op" id="6652547">(</span><span class="op" id="6652548">[</span><span class="op" id="6652549">]</span><span class="builtintype" id="6652550">byte</span><span class="op" id="6652554">(</span><span class="ident" id="6652555">dsaCertPem</span><span class="op" id="6652565">)</span><span class="op" id="6652566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652569">cert</span><span class="op" id="6652573">,</span>&nbsp;<span class="ident" id="6652575">err</span>&nbsp;<span class="op" id="6652579">:=</span>&nbsp;<span class="ident" id="6652582">ParseCertificate</span><span class="op" id="6652598">(</span><span class="ident" id="6652599">pemBlock</span><span class="op" id="6652607">.</span><span class="ident" id="6652608">Bytes</span><span class="op" id="6652613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652616">if</span>&nbsp;<span class="ident" id="6652619">err</span>&nbsp;<span class="op" id="6652623">!=</span>&nbsp;<span class="ident" id="6652626">nil</span>&nbsp;<span class="op" id="6652630">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652634">t</span><span class="op" id="6652635">.</span><span class="ident" id="6652636">Fatalf</span><span class="op" id="6652642">(</span><span class="string" id="6652643">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6652676">,</span>&nbsp;<span class="ident" id="6652678">err</span><span class="op" id="6652681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6652687">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6652716">if</span>&nbsp;<span class="ident" id="6652719">err</span>&nbsp;<span class="op" id="6652723">=</span>&nbsp;<span class="ident" id="6652725">cert</span><span class="op" id="6652729">.</span><span class="ident" id="6652730">CheckSignatureFrom</span><span class="op" id="6652748">(</span><span class="ident" id="6652749">cert</span><span class="op" id="6652753">)</span><span class="op" id="6652754">;</span>&nbsp;<span class="ident" id="6652756">err</span>&nbsp;<span class="op" id="6652760">!=</span>&nbsp;<span class="ident" id="6652763">nil</span>&nbsp;<span class="op" id="6652767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6652771">t</span><span class="op" id="6652772">.</span><span class="ident" id="6652773">Fatalf</span><span class="op" id="6652779">(</span><span class="string" id="6652780">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6652821">,</span>&nbsp;<span class="ident" id="6652823">err</span><span class="op" id="6652826">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6652829">}</span><br>
<span class="lineno"></span><span class="op" id="6652831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6652834">const</span>&nbsp;<span class="ident" id="6652840">pemCertificate</span>&nbsp;<span class="op" id="6652855">=</span>&nbsp;<span class="string" id="6652857">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="6653575">func</span>&nbsp;<span class="ident" id="6653580">TestCRLCreation</span><span class="op" id="6653595">(</span><span class="ident" id="6653596">t</span>&nbsp;<span class="op" id="6653598">*</span><span class="ident" id="6653599">testing</span><span class="op" id="6653606">.</span><span class="ident" id="6653607">T</span><span class="op" id="6653608">)</span>&nbsp;<span class="op" id="6653610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653613">block</span><span class="op" id="6653618">,</span>&nbsp;<span class="ident" id="6653620">_</span>&nbsp;<span class="op" id="6653622">:=</span>&nbsp;<span class="ident" id="6653625">pem</span><span class="op" id="6653628">.</span><span class="ident" id="6653629">Decode</span><span class="op" id="6653635">(</span><span class="op" id="6653636">[</span><span class="op" id="6653637">]</span><span class="builtintype" id="6653638">byte</span><span class="op" id="6653642">(</span><span class="ident" id="6653643">pemPrivateKey</span><span class="op" id="6653656">)</span><span class="op" id="6653657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653660">priv</span><span class="op" id="6653664">,</span>&nbsp;<span class="ident" id="6653666">_</span>&nbsp;<span class="op" id="6653668">:=</span>&nbsp;<span class="ident" id="6653671">ParsePKCS1PrivateKey</span><span class="op" id="6653691">(</span><span class="ident" id="6653692">block</span><span class="op" id="6653697">.</span><span class="ident" id="6653698">Bytes</span><span class="op" id="6653703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653706">block</span><span class="op" id="6653711">,</span>&nbsp;<span class="ident" id="6653713">_</span>&nbsp;<span class="op" id="6653715">=</span>&nbsp;<span class="ident" id="6653717">pem</span><span class="op" id="6653720">.</span><span class="ident" id="6653721">Decode</span><span class="op" id="6653727">(</span><span class="op" id="6653728">[</span><span class="op" id="6653729">]</span><span class="builtintype" id="6653730">byte</span><span class="op" id="6653734">(</span><span class="ident" id="6653735">pemCertificate</span><span class="op" id="6653749">)</span><span class="op" id="6653750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653753">cert</span><span class="op" id="6653757">,</span>&nbsp;<span class="ident" id="6653759">_</span>&nbsp;<span class="op" id="6653761">:=</span>&nbsp;<span class="ident" id="6653764">ParseCertificate</span><span class="op" id="6653780">(</span><span class="ident" id="6653781">block</span><span class="op" id="6653786">.</span><span class="ident" id="6653787">Bytes</span><span class="op" id="6653792">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653796">now</span>&nbsp;<span class="op" id="6653800">:=</span>&nbsp;<span class="ident" id="6653803">time</span><span class="op" id="6653807">.</span><span class="ident" id="6653808">Unix</span><span class="op" id="6653812">(</span><span class="num" id="6653813">1000</span><span class="op" id="6653817">,</span>&nbsp;<span class="num" id="6653819">0</span><span class="op" id="6653820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653823">expiry</span>&nbsp;<span class="op" id="6653830">:=</span>&nbsp;<span class="ident" id="6653833">time</span><span class="op" id="6653837">.</span><span class="ident" id="6653838">Unix</span><span class="op" id="6653842">(</span><span class="num" id="6653843">10000</span><span class="op" id="6653848">,</span>&nbsp;<span class="num" id="6653850">0</span><span class="op" id="6653851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653855">revokedCerts</span>&nbsp;<span class="op" id="6653868">:=</span>&nbsp;<span class="op" id="6653871">[</span><span class="op" id="6653872">]</span><span class="ident" id="6653873">pkix</span><span class="op" id="6653877">.</span><span class="ident" id="6653878">RevokedCertificate</span><span class="op" id="6653896">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653905">SerialNumber</span><span class="op" id="6653917">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6653921">big</span><span class="op" id="6653924">.</span><span class="ident" id="6653925">NewInt</span><span class="op" id="6653931">(</span><span class="num" id="6653932">1</span><span class="op" id="6653933">)</span><span class="op" id="6653934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653939">RevocationTime</span><span class="op" id="6653953">:</span>&nbsp;<span class="ident" id="6653955">now</span><span class="op" id="6653958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653962">}</span><span class="op" id="6653963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6653967">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6653972">SerialNumber</span><span class="op" id="6653984">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6653988">big</span><span class="op" id="6653991">.</span><span class="ident" id="6653992">NewInt</span><span class="op" id="6653998">(</span><span class="num" id="6653999">42</span><span class="op" id="6654001">)</span><span class="op" id="6654002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654007">RevocationTime</span><span class="op" id="6654021">:</span>&nbsp;<span class="ident" id="6654023">now</span><span class="op" id="6654026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654030">}</span><span class="op" id="6654031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654038">crlBytes</span><span class="op" id="6654046">,</span>&nbsp;<span class="ident" id="6654048">err</span>&nbsp;<span class="op" id="6654052">:=</span>&nbsp;<span class="ident" id="6654055">cert</span><span class="op" id="6654059">.</span><span class="ident" id="6654060">CreateCRL</span><span class="op" id="6654069">(</span><span class="ident" id="6654070">rand</span><span class="op" id="6654074">.</span><span class="ident" id="6654075">Reader</span><span class="op" id="6654081">,</span>&nbsp;<span class="ident" id="6654083">priv</span><span class="op" id="6654087">,</span>&nbsp;<span class="ident" id="6654089">revokedCerts</span><span class="op" id="6654101">,</span>&nbsp;<span class="ident" id="6654103">now</span><span class="op" id="6654106">,</span>&nbsp;<span class="ident" id="6654108">expiry</span><span class="op" id="6654114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654117">if</span>&nbsp;<span class="ident" id="6654120">err</span>&nbsp;<span class="op" id="6654124">!=</span>&nbsp;<span class="ident" id="6654127">nil</span>&nbsp;<span class="op" id="6654131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654135">t</span><span class="op" id="6654136">.</span><span class="ident" id="6654137">Errorf</span><span class="op" id="6654143">(</span><span class="string" id="6654144">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6654168">,</span>&nbsp;<span class="ident" id="6654170">err</span><span class="op" id="6654173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654180">_</span><span class="op" id="6654181">,</span>&nbsp;<span class="ident" id="6654183">err</span>&nbsp;<span class="op" id="6654187">=</span>&nbsp;<span class="ident" id="6654189">ParseDERCRL</span><span class="op" id="6654200">(</span><span class="ident" id="6654201">crlBytes</span><span class="op" id="6654209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654212">if</span>&nbsp;<span class="ident" id="6654215">err</span>&nbsp;<span class="op" id="6654219">!=</span>&nbsp;<span class="ident" id="6654222">nil</span>&nbsp;<span class="op" id="6654226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654230">t</span><span class="op" id="6654231">.</span><span class="ident" id="6654232">Errorf</span><span class="op" id="6654238">(</span><span class="string" id="6654239">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6654264">,</span>&nbsp;<span class="ident" id="6654266">err</span><span class="op" id="6654269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654272">}</span><br>
<span class="lineno"></span><span class="op" id="6654274">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6654277">func</span>&nbsp;<span class="ident" id="6654282">fromBase64</span><span class="op" id="6654292">(</span><span class="ident" id="6654293">in</span>&nbsp;<span class="builtintype" id="6654296">string</span><span class="op" id="6654302">)</span>&nbsp;<span class="op" id="6654304">[</span><span class="op" id="6654305">]</span><span class="builtintype" id="6654306">byte</span>&nbsp;<span class="op" id="6654311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654314">out</span>&nbsp;<span class="op" id="6654318">:=</span>&nbsp;<span class="builtinfunc" id="6654321">make</span><span class="op" id="6654325">(</span><span class="op" id="6654326">[</span><span class="op" id="6654327">]</span><span class="builtintype" id="6654328">byte</span><span class="op" id="6654332">,</span>&nbsp;<span class="ident" id="6654334">base64</span><span class="op" id="6654340">.</span><span class="ident" id="6654341">StdEncoding</span><span class="op" id="6654352">.</span><span class="ident" id="6654353">DecodedLen</span><span class="op" id="6654363">(</span><span class="builtinfunc" id="6654364">len</span><span class="op" id="6654367">(</span><span class="ident" id="6654368">in</span><span class="op" id="6654370">)</span><span class="op" id="6654371">)</span><span class="op" id="6654372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654375">n</span><span class="op" id="6654376">,</span>&nbsp;<span class="ident" id="6654378">err</span>&nbsp;<span class="op" id="6654382">:=</span>&nbsp;<span class="ident" id="6654385">base64</span><span class="op" id="6654391">.</span><span class="ident" id="6654392">StdEncoding</span><span class="op" id="6654403">.</span><span class="ident" id="6654404">Decode</span><span class="op" id="6654410">(</span><span class="ident" id="6654411">out</span><span class="op" id="6654414">,</span>&nbsp;<span class="op" id="6654416">[</span><span class="op" id="6654417">]</span><span class="builtintype" id="6654418">byte</span><span class="op" id="6654422">(</span><span class="ident" id="6654423">in</span><span class="op" id="6654425">)</span><span class="op" id="6654426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654429">if</span>&nbsp;<span class="ident" id="6654432">err</span>&nbsp;<span class="op" id="6654436">!=</span>&nbsp;<span class="ident" id="6654439">nil</span>&nbsp;<span class="op" id="6654443">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6654447">panic</span><span class="op" id="6654452">(</span><span class="string" id="6654453">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="6654478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654484">return</span>&nbsp;<span class="ident" id="6654491">out</span><span class="op" id="6654494">[</span><span class="op" id="6654495">:</span><span class="ident" id="6654496">n</span><span class="op" id="6654497">]</span><br>
<span class="lineno"></span><span class="op" id="6654499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="6654502">func</span>&nbsp;<span class="ident" id="6654507">TestParseDERCRL</span><span class="op" id="6654522">(</span><span class="ident" id="6654523">t</span>&nbsp;<span class="op" id="6654525">*</span><span class="ident" id="6654526">testing</span><span class="op" id="6654533">.</span><span class="ident" id="6654534">T</span><span class="op" id="6654535">)</span>&nbsp;<span class="op" id="6654537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654540">derBytes</span>&nbsp;<span class="op" id="6654549">:=</span>&nbsp;<span class="ident" id="6654552">fromBase64</span><span class="op" id="6654562">(</span><span class="ident" id="6654563">derCRLBase64</span><span class="op" id="6654575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654578">certList</span><span class="op" id="6654586">,</span>&nbsp;<span class="ident" id="6654588">err</span>&nbsp;<span class="op" id="6654592">:=</span>&nbsp;<span class="ident" id="6654595">ParseDERCRL</span><span class="op" id="6654606">(</span><span class="ident" id="6654607">derBytes</span><span class="op" id="6654615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654618">if</span>&nbsp;<span class="ident" id="6654621">err</span>&nbsp;<span class="op" id="6654625">!=</span>&nbsp;<span class="ident" id="6654628">nil</span>&nbsp;<span class="op" id="6654632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654636">t</span><span class="op" id="6654637">.</span><span class="ident" id="6654638">Errorf</span><span class="op" id="6654644">(</span><span class="string" id="6654645">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6654664">,</span>&nbsp;<span class="ident" id="6654666">err</span><span class="op" id="6654669">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654673">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654684">numCerts</span>&nbsp;<span class="op" id="6654693">:=</span>&nbsp;<span class="builtinfunc" id="6654696">len</span><span class="op" id="6654699">(</span><span class="ident" id="6654700">certList</span><span class="op" id="6654708">.</span><span class="ident" id="6654709">TBSCertList</span><span class="op" id="6654720">.</span><span class="ident" id="6654721">RevokedCertificates</span><span class="op" id="6654740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654743">expected</span>&nbsp;<span class="op" id="6654752">:=</span>&nbsp;<span class="num" id="6654755">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654759">if</span>&nbsp;<span class="ident" id="6654762">numCerts</span>&nbsp;<span class="op" id="6654771">!=</span>&nbsp;<span class="ident" id="6654774">expected</span>&nbsp;<span class="op" id="6654783">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654787">t</span><span class="op" id="6654788">.</span><span class="ident" id="6654789">Errorf</span><span class="op" id="6654795">(</span><span class="string" id="6654796">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6654850">,</span>&nbsp;<span class="ident" id="6654852">numCerts</span><span class="op" id="6654860">,</span>&nbsp;<span class="ident" id="6654862">expected</span><span class="op" id="6654870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6654877">if</span>&nbsp;<span class="ident" id="6654880">certList</span><span class="op" id="6654888">.</span><span class="ident" id="6654889">HasExpired</span><span class="op" id="6654899">(</span><span class="ident" id="6654900">time</span><span class="op" id="6654904">.</span><span class="ident" id="6654905">Unix</span><span class="op" id="6654909">(</span><span class="num" id="6654910">1302517272</span><span class="op" id="6654920">,</span>&nbsp;<span class="num" id="6654922">0</span><span class="op" id="6654923">)</span><span class="op" id="6654924">)</span>&nbsp;<span class="op" id="6654926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6654930">t</span><span class="op" id="6654931">.</span><span class="ident" id="6654932">Errorf</span><span class="op" id="6654938">(</span><span class="string" id="6654939">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6654977">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6654980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6654984">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6655043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="6655046">func</span>&nbsp;<span class="ident" id="6655051">TestCRLWithoutExpiry</span><span class="op" id="6655071">(</span><span class="ident" id="6655072">t</span>&nbsp;<span class="op" id="6655074">*</span><span class="ident" id="6655075">testing</span><span class="op" id="6655082">.</span><span class="ident" id="6655083">T</span><span class="op" id="6655084">)</span>&nbsp;<span class="op" id="6655086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655089">derBytes</span>&nbsp;<span class="op" id="6655098">:=</span>&nbsp;<span class="ident" id="6655101">fromBase64</span><span class="op" id="6655111">(</span><span class="string" id="6655112">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="6655406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655409">certList</span><span class="op" id="6655417">,</span>&nbsp;<span class="ident" id="6655419">err</span>&nbsp;<span class="op" id="6655423">:=</span>&nbsp;<span class="ident" id="6655426">ParseDERCRL</span><span class="op" id="6655437">(</span><span class="ident" id="6655438">derBytes</span><span class="op" id="6655446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655449">if</span>&nbsp;<span class="ident" id="6655452">err</span>&nbsp;<span class="op" id="6655456">!=</span>&nbsp;<span class="ident" id="6655459">nil</span>&nbsp;<span class="op" id="6655463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655467">t</span><span class="op" id="6655468">.</span><span class="ident" id="6655469">Fatal</span><span class="op" id="6655474">(</span><span class="ident" id="6655475">err</span><span class="op" id="6655478">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655484">if</span>&nbsp;<span class="op" id="6655487">!</span><span class="ident" id="6655488">certList</span><span class="op" id="6655496">.</span><span class="ident" id="6655497">TBSCertList</span><span class="op" id="6655508">.</span><span class="ident" id="6655509">NextUpdate</span><span class="op" id="6655519">.</span><span class="ident" id="6655520">IsZero</span><span class="op" id="6655526">(</span><span class="op" id="6655527">)</span>&nbsp;<span class="op" id="6655529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655533">t</span><span class="op" id="6655534">.</span><span class="ident" id="6655535">Errorf</span><span class="op" id="6655541">(</span><span class="string" id="6655542">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="6655576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655579">}</span><br>
<span class="lineno"></span><span class="op" id="6655581">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="6655584">func</span>&nbsp;<span class="ident" id="6655589">TestParsePEMCRL</span><span class="op" id="6655604">(</span><span class="ident" id="6655605">t</span>&nbsp;<span class="op" id="6655607">*</span><span class="ident" id="6655608">testing</span><span class="op" id="6655615">.</span><span class="ident" id="6655616">T</span><span class="op" id="6655617">)</span>&nbsp;<span class="op" id="6655619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655622">pemBytes</span>&nbsp;<span class="op" id="6655631">:=</span>&nbsp;<span class="ident" id="6655634">fromBase64</span><span class="op" id="6655644">(</span><span class="ident" id="6655645">pemCRLBase64</span><span class="op" id="6655657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655660">certList</span><span class="op" id="6655668">,</span>&nbsp;<span class="ident" id="6655670">err</span>&nbsp;<span class="op" id="6655674">:=</span>&nbsp;<span class="ident" id="6655677">ParseCRL</span><span class="op" id="6655685">(</span><span class="ident" id="6655686">pemBytes</span><span class="op" id="6655694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655697">if</span>&nbsp;<span class="ident" id="6655700">err</span>&nbsp;<span class="op" id="6655704">!=</span>&nbsp;<span class="ident" id="6655707">nil</span>&nbsp;<span class="op" id="6655711">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655715">t</span><span class="op" id="6655716">.</span><span class="ident" id="6655717">Errorf</span><span class="op" id="6655723">(</span><span class="string" id="6655724">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6655743">,</span>&nbsp;<span class="ident" id="6655745">err</span><span class="op" id="6655748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655752">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655763">numCerts</span>&nbsp;<span class="op" id="6655772">:=</span>&nbsp;<span class="builtinfunc" id="6655775">len</span><span class="op" id="6655778">(</span><span class="ident" id="6655779">certList</span><span class="op" id="6655787">.</span><span class="ident" id="6655788">TBSCertList</span><span class="op" id="6655799">.</span><span class="ident" id="6655800">RevokedCertificates</span><span class="op" id="6655819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655822">expected</span>&nbsp;<span class="op" id="6655831">:=</span>&nbsp;<span class="num" id="6655834">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655837">if</span>&nbsp;<span class="ident" id="6655840">numCerts</span>&nbsp;<span class="op" id="6655849">!=</span>&nbsp;<span class="ident" id="6655852">expected</span>&nbsp;<span class="op" id="6655861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6655865">t</span><span class="op" id="6655866">.</span><span class="ident" id="6655867">Errorf</span><span class="op" id="6655873">(</span><span class="string" id="6655874">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6655928">,</span>&nbsp;<span class="ident" id="6655930">numCerts</span><span class="op" id="6655938">,</span>&nbsp;<span class="ident" id="6655940">expected</span><span class="op" id="6655948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6655951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6655955">if</span>&nbsp;<span class="ident" id="6655958">certList</span><span class="op" id="6655966">.</span><span class="ident" id="6655967">HasExpired</span><span class="op" id="6655977">(</span><span class="ident" id="6655978">time</span><span class="op" id="6655982">.</span><span class="ident" id="6655983">Unix</span><span class="op" id="6655987">(</span><span class="num" id="6655988">1302517272</span><span class="op" id="6655998">,</span>&nbsp;<span class="num" id="6656000">0</span><span class="op" id="6656001">)</span><span class="op" id="6656002">)</span>&nbsp;<span class="op" id="6656004">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656008">t</span><span class="op" id="6656009">.</span><span class="ident" id="6656010">Errorf</span><span class="op" id="6656016">(</span><span class="string" id="6656017">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6656055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6656062">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6656121">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="6656124">func</span>&nbsp;<span class="ident" id="6656129">TestImports</span><span class="op" id="6656140">(</span><span class="ident" id="6656141">t</span>&nbsp;<span class="op" id="6656143">*</span><span class="ident" id="6656144">testing</span><span class="op" id="6656151">.</span><span class="ident" id="6656152">T</span><span class="op" id="6656153">)</span>&nbsp;<span class="op" id="6656155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656158">switch</span>&nbsp;<span class="ident" id="6656165">runtime</span><span class="op" id="6656172">.</span><span class="ident" id="6656173">GOOS</span>&nbsp;<span class="op" id="6656178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656181">case</span>&nbsp;<span class="string" id="6656186">&#34;android&#34;</span><span class="op" id="6656195">,</span>&nbsp;<span class="string" id="6656197">&#34;nacl&#34;</span><span class="op" id="6656203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656207">t</span><span class="op" id="6656208">.</span><span class="ident" id="6656209">Skipf</span><span class="op" id="6656214">(</span><span class="string" id="6656215">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="6656231">,</span>&nbsp;<span class="ident" id="6656233">runtime</span><span class="op" id="6656240">.</span><span class="ident" id="6656241">GOOS</span><span class="op" id="6656245">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6656252">if</span>&nbsp;<span class="ident" id="6656255">err</span>&nbsp;<span class="op" id="6656259">:=</span>&nbsp;<span class="ident" id="6656262">exec</span><span class="op" id="6656266">.</span><span class="ident" id="6656267">Command</span><span class="op" id="6656274">(</span><span class="string" id="6656275">&#34;go&#34;</span><span class="op" id="6656279">,</span>&nbsp;<span class="string" id="6656281">&#34;run&#34;</span><span class="op" id="6656286">,</span>&nbsp;<span class="string" id="6656288">&#34;x509_test_import.go&#34;</span><span class="op" id="6656309">)</span><span class="op" id="6656310">.</span><span class="ident" id="6656311">Run</span><span class="op" id="6656314">(</span><span class="op" id="6656315">)</span><span class="op" id="6656316">;</span>&nbsp;<span class="ident" id="6656318">err</span>&nbsp;<span class="op" id="6656322">!=</span>&nbsp;<span class="ident" id="6656325">nil</span>&nbsp;<span class="op" id="6656329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6656333">t</span><span class="op" id="6656334">.</span><span class="ident" id="6656335">Errorf</span><span class="op" id="6656341">(</span><span class="string" id="6656342">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="6656381">,</span>&nbsp;<span class="ident" id="6656383">err</span><span class="op" id="6656386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6656389">}</span><br>
<span class="lineno">750</span><span class="op" id="6656391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6656394">const</span>&nbsp;<span class="ident" id="6656400">derCRLBase64</span>&nbsp;<span class="op" id="6656413">=</span>&nbsp;<span class="string" id="6656415">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6661091">const</span>&nbsp;<span class="ident" id="6661097">pemCRLBase64</span>&nbsp;<span class="op" id="6661110">=</span>&nbsp;<span class="string" id="6661112">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="6662116">func</span>&nbsp;<span class="ident" id="6662121">TestCreateCertificateRequest</span><span class="op" id="6662149">(</span><span class="ident" id="6662150">t</span>&nbsp;<span class="op" id="6662152">*</span><span class="ident" id="6662153">testing</span><span class="op" id="6662160">.</span><span class="ident" id="6662161">T</span><span class="op" id="6662162">)</span>&nbsp;<span class="op" id="6662164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662167">random</span>&nbsp;<span class="op" id="6662174">:=</span>&nbsp;<span class="ident" id="6662177">rand</span><span class="op" id="6662181">.</span><span class="ident" id="6662182">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662191">block</span><span class="op" id="6662196">,</span>&nbsp;<span class="ident" id="6662198">_</span>&nbsp;<span class="op" id="6662200">:=</span>&nbsp;<span class="ident" id="6662203">pem</span><span class="op" id="6662206">.</span><span class="ident" id="6662207">Decode</span><span class="op" id="6662213">(</span><span class="op" id="6662214">[</span><span class="op" id="6662215">]</span><span class="builtintype" id="6662216">byte</span><span class="op" id="6662220">(</span><span class="ident" id="6662221">pemPrivateKey</span><span class="op" id="6662234">)</span><span class="op" id="6662235">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662238">rsaPriv</span><span class="op" id="6662245">,</span>&nbsp;<span class="ident" id="6662247">err</span>&nbsp;<span class="op" id="6662251">:=</span>&nbsp;<span class="ident" id="6662254">ParsePKCS1PrivateKey</span><span class="op" id="6662274">(</span><span class="ident" id="6662275">block</span><span class="op" id="6662280">.</span><span class="ident" id="6662281">Bytes</span><span class="op" id="6662286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662289">if</span>&nbsp;<span class="ident" id="6662292">err</span>&nbsp;<span class="op" id="6662296">!=</span>&nbsp;<span class="ident" id="6662299">nil</span>&nbsp;<span class="op" id="6662303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662307">t</span><span class="op" id="6662308">.</span><span class="ident" id="6662309">Fatalf</span><span class="op" id="6662315">(</span><span class="string" id="6662316">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6662349">,</span>&nbsp;<span class="ident" id="6662351">err</span><span class="op" id="6662354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662361">ecdsa256Priv</span><span class="op" id="6662373">,</span>&nbsp;<span class="ident" id="6662375">err</span>&nbsp;<span class="op" id="6662379">:=</span>&nbsp;<span class="ident" id="6662382">ecdsa</span><span class="op" id="6662387">.</span><span class="ident" id="6662388">GenerateKey</span><span class="op" id="6662399">(</span><span class="ident" id="6662400">elliptic</span><span class="op" id="6662408">.</span><span class="ident" id="6662409">P256</span><span class="op" id="6662413">(</span><span class="op" id="6662414">)</span><span class="op" id="6662415">,</span>&nbsp;<span class="ident" id="6662417">rand</span><span class="op" id="6662421">.</span><span class="ident" id="6662422">Reader</span><span class="op" id="6662428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662431">if</span>&nbsp;<span class="ident" id="6662434">err</span>&nbsp;<span class="op" id="6662438">!=</span>&nbsp;<span class="ident" id="6662441">nil</span>&nbsp;<span class="op" id="6662445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662449">t</span><span class="op" id="6662450">.</span><span class="ident" id="6662451">Fatalf</span><span class="op" id="6662457">(</span><span class="string" id="6662458">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6662492">,</span>&nbsp;<span class="ident" id="6662494">err</span><span class="op" id="6662497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662504">ecdsa384Priv</span><span class="op" id="6662516">,</span>&nbsp;<span class="ident" id="6662518">err</span>&nbsp;<span class="op" id="6662522">:=</span>&nbsp;<span class="ident" id="6662525">ecdsa</span><span class="op" id="6662530">.</span><span class="ident" id="6662531">GenerateKey</span><span class="op" id="6662542">(</span><span class="ident" id="6662543">elliptic</span><span class="op" id="6662551">.</span><span class="ident" id="6662552">P384</span><span class="op" id="6662556">(</span><span class="op" id="6662557">)</span><span class="op" id="6662558">,</span>&nbsp;<span class="ident" id="6662560">rand</span><span class="op" id="6662564">.</span><span class="ident" id="6662565">Reader</span><span class="op" id="6662571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662574">if</span>&nbsp;<span class="ident" id="6662577">err</span>&nbsp;<span class="op" id="6662581">!=</span>&nbsp;<span class="ident" id="6662584">nil</span>&nbsp;<span class="op" id="6662588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662592">t</span><span class="op" id="6662593">.</span><span class="ident" id="6662594">Fatalf</span><span class="op" id="6662600">(</span><span class="string" id="6662601">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6662635">,</span>&nbsp;<span class="ident" id="6662637">err</span><span class="op" id="6662640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662647">ecdsa521Priv</span><span class="op" id="6662659">,</span>&nbsp;<span class="ident" id="6662661">err</span>&nbsp;<span class="op" id="6662665">:=</span>&nbsp;<span class="ident" id="6662668">ecdsa</span><span class="op" id="6662673">.</span><span class="ident" id="6662674">GenerateKey</span><span class="op" id="6662685">(</span><span class="ident" id="6662686">elliptic</span><span class="op" id="6662694">.</span><span class="ident" id="6662695">P521</span><span class="op" id="6662699">(</span><span class="op" id="6662700">)</span><span class="op" id="6662701">,</span>&nbsp;<span class="ident" id="6662703">rand</span><span class="op" id="6662707">.</span><span class="ident" id="6662708">Reader</span><span class="op" id="6662714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6662717">if</span>&nbsp;<span class="ident" id="6662720">err</span>&nbsp;<span class="op" id="6662724">!=</span>&nbsp;<span class="ident" id="6662727">nil</span>&nbsp;<span class="op" id="6662731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662735">t</span><span class="op" id="6662736">.</span><span class="ident" id="6662737">Fatalf</span><span class="op" id="6662743">(</span><span class="string" id="6662744">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6662778">,</span>&nbsp;<span class="ident" id="6662780">err</span><span class="op" id="6662783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662790">tests</span>&nbsp;<span class="op" id="6662796">:=</span>&nbsp;<span class="op" id="6662799">[</span><span class="op" id="6662800">]</span><span class="keyword" id="6662801">struct</span>&nbsp;<span class="op" id="6662808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662812">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6662820">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662829">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6662837">interface</span><span class="op" id="6662846">{</span><span class="op" id="6662847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6662851">sigAlgo</span>&nbsp;<span class="ident" id="6662859">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662879">}</span><span class="op" id="6662880">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662884">{</span><span class="string" id="6662885">&#34;RSA&#34;</span><span class="op" id="6662890">,</span>&nbsp;<span class="ident" id="6662892">rsaPriv</span><span class="op" id="6662899">,</span>&nbsp;<span class="ident" id="6662901">SHA1WithRSA</span><span class="op" id="6662912">}</span><span class="op" id="6662913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662917">{</span><span class="string" id="6662918">&#34;ECDSA-256&#34;</span><span class="op" id="6662929">,</span>&nbsp;<span class="ident" id="6662931">ecdsa256Priv</span><span class="op" id="6662943">,</span>&nbsp;<span class="ident" id="6662945">ECDSAWithSHA1</span><span class="op" id="6662958">}</span><span class="op" id="6662959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6662963">{</span><span class="string" id="6662964">&#34;ECDSA-384&#34;</span><span class="op" id="6662975">,</span>&nbsp;<span class="ident" id="6662977">ecdsa384Priv</span><span class="op" id="6662989">,</span>&nbsp;<span class="ident" id="6662991">ECDSAWithSHA1</span><span class="op" id="6663004">}</span><span class="op" id="6663005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663009">{</span><span class="string" id="6663010">&#34;ECDSA-521&#34;</span><span class="op" id="6663021">,</span>&nbsp;<span class="ident" id="6663023">ecdsa521Priv</span><span class="op" id="6663035">,</span>&nbsp;<span class="ident" id="6663037">ECDSAWithSHA1</span><span class="op" id="6663050">}</span><span class="op" id="6663051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663054">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663058">for</span>&nbsp;<span class="ident" id="6663062">_</span><span class="op" id="6663063">,</span>&nbsp;<span class="ident" id="6663065">test</span>&nbsp;<span class="op" id="6663070">:=</span>&nbsp;<span class="keyword" id="6663073">range</span>&nbsp;<span class="ident" id="6663079">tests</span>&nbsp;<span class="op" id="6663085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663089">template</span>&nbsp;<span class="op" id="6663098">:=</span>&nbsp;<span class="ident" id="6663101">CertificateRequest</span><span class="op" id="6663119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663124">Subject</span><span class="op" id="6663131">:</span>&nbsp;<span class="ident" id="6663133">pkix</span><span class="op" id="6663137">.</span><span class="ident" id="6663138">Name</span><span class="op" id="6663142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663148">CommonName</span><span class="op" id="6663158">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6663162">&#34;test.example.com&#34;</span><span class="op" id="6663180">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663186">Organization</span><span class="op" id="6663198">:</span>&nbsp;<span class="op" id="6663200">[</span><span class="op" id="6663201">]</span><span class="builtintype" id="6663202">string</span><span class="op" id="6663208">{</span><span class="string" id="6663209">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6663221">}</span><span class="op" id="6663222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663227">}</span><span class="op" id="6663228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663233">SignatureAlgorithm</span><span class="op" id="6663251">:</span>&nbsp;<span class="ident" id="6663253">test</span><span class="op" id="6663257">.</span><span class="ident" id="6663258">sigAlgo</span><span class="op" id="6663265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663270">DNSNames</span><span class="op" id="6663278">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663290">[</span><span class="op" id="6663291">]</span><span class="builtintype" id="6663292">string</span><span class="op" id="6663298">{</span><span class="string" id="6663299">&#34;test.example.com&#34;</span><span class="op" id="6663317">}</span><span class="op" id="6663318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663323">EmailAddresses</span><span class="op" id="6663337">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663343">[</span><span class="op" id="6663344">]</span><span class="builtintype" id="6663345">string</span><span class="op" id="6663351">{</span><span class="string" id="6663352">&#34;gopher@golang.org&#34;</span><span class="op" id="6663371">}</span><span class="op" id="6663372">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663377">IPAddresses</span><span class="op" id="6663388">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6663397">[</span><span class="op" id="6663398">]</span><span class="ident" id="6663399">net</span><span class="op" id="6663402">.</span><span class="ident" id="6663403">IP</span><span class="op" id="6663405">{</span><span class="ident" id="6663406">net</span><span class="op" id="6663409">.</span><span class="ident" id="6663410">IPv4</span><span class="op" id="6663414">(</span><span class="num" id="6663415">127</span><span class="op" id="6663418">,</span>&nbsp;<span class="num" id="6663420">0</span><span class="op" id="6663421">,</span>&nbsp;<span class="num" id="6663423">0</span><span class="op" id="6663424">,</span>&nbsp;<span class="num" id="6663426">1</span><span class="op" id="6663427">)</span><span class="op" id="6663428">.</span><span class="ident" id="6663429">To4</span><span class="op" id="6663432">(</span><span class="op" id="6663433">)</span><span class="op" id="6663434">,</span>&nbsp;<span class="ident" id="6663436">net</span><span class="op" id="6663439">.</span><span class="ident" id="6663440">ParseIP</span><span class="op" id="6663447">(</span><span class="string" id="6663448">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6663470">)</span><span class="op" id="6663471">}</span><span class="op" id="6663472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663481">derBytes</span><span class="op" id="6663489">,</span>&nbsp;<span class="ident" id="6663491">err</span>&nbsp;<span class="op" id="6663495">:=</span>&nbsp;<span class="ident" id="6663498">CreateCertificateRequest</span><span class="op" id="6663522">(</span><span class="ident" id="6663523">random</span><span class="op" id="6663529">,</span>&nbsp;<span class="op" id="6663531">&amp;</span><span class="ident" id="6663532">template</span><span class="op" id="6663540">,</span>&nbsp;<span class="ident" id="6663542">test</span><span class="op" id="6663546">.</span><span class="ident" id="6663547">priv</span><span class="op" id="6663551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663555">if</span>&nbsp;<span class="ident" id="6663558">err</span>&nbsp;<span class="op" id="6663562">!=</span>&nbsp;<span class="ident" id="6663565">nil</span>&nbsp;<span class="op" id="6663569">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663574">t</span><span class="op" id="6663575">.</span><span class="ident" id="6663576">Errorf</span><span class="op" id="6663582">(</span><span class="string" id="6663583">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6663629">,</span>&nbsp;<span class="ident" id="6663631">test</span><span class="op" id="6663635">.</span><span class="ident" id="6663636">name</span><span class="op" id="6663640">,</span>&nbsp;<span class="ident" id="6663642">err</span><span class="op" id="6663645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663650">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663666">out</span><span class="op" id="6663669">,</span>&nbsp;<span class="ident" id="6663671">err</span>&nbsp;<span class="op" id="6663675">:=</span>&nbsp;<span class="ident" id="6663678">ParseCertificateRequest</span><span class="op" id="6663701">(</span><span class="ident" id="6663702">derBytes</span><span class="op" id="6663710">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663714">if</span>&nbsp;<span class="ident" id="6663717">err</span>&nbsp;<span class="op" id="6663721">!=</span>&nbsp;<span class="ident" id="6663724">nil</span>&nbsp;<span class="op" id="6663728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663733">t</span><span class="op" id="6663734">.</span><span class="ident" id="6663735">Errorf</span><span class="op" id="6663741">(</span><span class="string" id="6663742">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6663788">,</span>&nbsp;<span class="ident" id="6663790">test</span><span class="op" id="6663794">.</span><span class="ident" id="6663795">name</span><span class="op" id="6663799">,</span>&nbsp;<span class="ident" id="6663801">err</span><span class="op" id="6663804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663809">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6663825">if</span>&nbsp;<span class="ident" id="6663828">out</span><span class="op" id="6663831">.</span><span class="ident" id="6663832">Subject</span><span class="op" id="6663839">.</span><span class="ident" id="6663840">CommonName</span>&nbsp;<span class="op" id="6663851">!=</span>&nbsp;<span class="ident" id="6663854">template</span><span class="op" id="6663862">.</span><span class="ident" id="6663863">Subject</span><span class="op" id="6663870">.</span><span class="ident" id="6663871">CommonName</span>&nbsp;<span class="op" id="6663882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6663887">t</span><span class="op" id="6663888">.</span><span class="ident" id="6663889">Errorf</span><span class="op" id="6663895">(</span><span class="string" id="6663896">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6663973">,</span>&nbsp;<span class="ident" id="6663975">test</span><span class="op" id="6663979">.</span><span class="ident" id="6663980">name</span><span class="op" id="6663984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6663988">}</span>&nbsp;<span class="keyword" id="6663990">else</span>&nbsp;<span class="keyword" id="6663995">if</span>&nbsp;<span class="builtinfunc" id="6663998">len</span><span class="op" id="6664001">(</span><span class="ident" id="6664002">out</span><span class="op" id="6664005">.</span><span class="ident" id="6664006">Subject</span><span class="op" id="6664013">.</span><span class="ident" id="6664014">Organization</span><span class="op" id="6664026">)</span>&nbsp;<span class="op" id="6664028">!=</span>&nbsp;<span class="builtinfunc" id="6664031">len</span><span class="op" id="6664034">(</span><span class="ident" id="6664035">template</span><span class="op" id="6664043">.</span><span class="ident" id="6664044">Subject</span><span class="op" id="6664051">.</span><span class="ident" id="6664052">Organization</span><span class="op" id="6664064">)</span>&nbsp;<span class="op" id="6664066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664071">t</span><span class="op" id="6664072">.</span><span class="ident" id="6664073">Errorf</span><span class="op" id="6664079">(</span><span class="string" id="6664080">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6664159">,</span>&nbsp;<span class="ident" id="6664161">test</span><span class="op" id="6664165">.</span><span class="ident" id="6664166">name</span><span class="op" id="6664170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664174">}</span>&nbsp;<span class="keyword" id="6664176">else</span>&nbsp;<span class="keyword" id="6664181">if</span>&nbsp;<span class="builtinfunc" id="6664184">len</span><span class="op" id="6664187">(</span><span class="ident" id="6664188">out</span><span class="op" id="6664191">.</span><span class="ident" id="6664192">DNSNames</span><span class="op" id="6664200">)</span>&nbsp;<span class="op" id="6664202">!=</span>&nbsp;<span class="builtinfunc" id="6664205">len</span><span class="op" id="6664208">(</span><span class="ident" id="6664209">template</span><span class="op" id="6664217">.</span><span class="ident" id="6664218">DNSNames</span><span class="op" id="6664226">)</span>&nbsp;<span class="op" id="6664228">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664233">t</span><span class="op" id="6664234">.</span><span class="ident" id="6664235">Errorf</span><span class="op" id="6664241">(</span><span class="string" id="6664242">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6664299">,</span>&nbsp;<span class="ident" id="6664301">test</span><span class="op" id="6664305">.</span><span class="ident" id="6664306">name</span><span class="op" id="6664310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664314">}</span>&nbsp;<span class="keyword" id="6664316">else</span>&nbsp;<span class="keyword" id="6664321">if</span>&nbsp;<span class="builtinfunc" id="6664324">len</span><span class="op" id="6664327">(</span><span class="ident" id="6664328">out</span><span class="op" id="6664331">.</span><span class="ident" id="6664332">EmailAddresses</span><span class="op" id="6664346">)</span>&nbsp;<span class="op" id="6664348">!=</span>&nbsp;<span class="builtinfunc" id="6664351">len</span><span class="op" id="6664354">(</span><span class="ident" id="6664355">template</span><span class="op" id="6664363">.</span><span class="ident" id="6664364">EmailAddresses</span><span class="op" id="6664378">)</span>&nbsp;<span class="op" id="6664380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664385">t</span><span class="op" id="6664386">.</span><span class="ident" id="6664387">Errorf</span><span class="op" id="6664393">(</span><span class="string" id="6664394">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6664463">,</span>&nbsp;<span class="ident" id="6664465">test</span><span class="op" id="6664469">.</span><span class="ident" id="6664470">name</span><span class="op" id="6664474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664478">}</span>&nbsp;<span class="keyword" id="6664480">else</span>&nbsp;<span class="keyword" id="6664485">if</span>&nbsp;<span class="builtinfunc" id="6664488">len</span><span class="op" id="6664491">(</span><span class="ident" id="6664492">out</span><span class="op" id="6664495">.</span><span class="ident" id="6664496">IPAddresses</span><span class="op" id="6664507">)</span>&nbsp;<span class="op" id="6664509">!=</span>&nbsp;<span class="builtinfunc" id="6664512">len</span><span class="op" id="6664515">(</span><span class="ident" id="6664516">template</span><span class="op" id="6664524">.</span><span class="ident" id="6664525">IPAddresses</span><span class="op" id="6664536">)</span>&nbsp;<span class="op" id="6664538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664543">t</span><span class="op" id="6664544">.</span><span class="ident" id="6664545">Errorf</span><span class="op" id="6664551">(</span><span class="string" id="6664552">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6664621">,</span>&nbsp;<span class="ident" id="6664623">test</span><span class="op" id="6664627">.</span><span class="ident" id="6664628">name</span><span class="op" id="6664632">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664639">}</span><br>
<span class="lineno"></span><span class="op" id="6664641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6664644">func</span>&nbsp;<span class="ident" id="6664649">marshalAndParseCSR</span><span class="op" id="6664667">(</span><span class="ident" id="6664668">t</span>&nbsp;<span class="op" id="6664670">*</span><span class="ident" id="6664671">testing</span><span class="op" id="6664678">.</span><span class="ident" id="6664679">T</span><span class="op" id="6664680">,</span>&nbsp;<span class="ident" id="6664682">template</span>&nbsp;<span class="op" id="6664691">*</span><span class="ident" id="6664692">CertificateRequest</span><span class="op" id="6664710">)</span>&nbsp;<span class="op" id="6664712">*</span><span class="ident" id="6664713">CertificateRequest</span>&nbsp;<span class="op" id="6664732">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664735">block</span><span class="op" id="6664740">,</span>&nbsp;<span class="ident" id="6664742">_</span>&nbsp;<span class="op" id="6664744">:=</span>&nbsp;<span class="ident" id="6664747">pem</span><span class="op" id="6664750">.</span><span class="ident" id="6664751">Decode</span><span class="op" id="6664757">(</span><span class="op" id="6664758">[</span><span class="op" id="6664759">]</span><span class="builtintype" id="6664760">byte</span><span class="op" id="6664764">(</span><span class="ident" id="6664765">pemPrivateKey</span><span class="op" id="6664778">)</span><span class="op" id="6664779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664782">rsaPriv</span><span class="op" id="6664789">,</span>&nbsp;<span class="ident" id="6664791">err</span>&nbsp;<span class="op" id="6664795">:=</span>&nbsp;<span class="ident" id="6664798">ParsePKCS1PrivateKey</span><span class="op" id="6664818">(</span><span class="ident" id="6664819">block</span><span class="op" id="6664824">.</span><span class="ident" id="6664825">Bytes</span><span class="op" id="6664830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664833">if</span>&nbsp;<span class="ident" id="6664836">err</span>&nbsp;<span class="op" id="6664840">!=</span>&nbsp;<span class="ident" id="6664843">nil</span>&nbsp;<span class="op" id="6664847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664851">t</span><span class="op" id="6664852">.</span><span class="ident" id="6664853">Fatal</span><span class="op" id="6664858">(</span><span class="ident" id="6664859">err</span><span class="op" id="6664862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664865">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664869">derBytes</span><span class="op" id="6664877">,</span>&nbsp;<span class="ident" id="6664879">err</span>&nbsp;<span class="op" id="6664883">:=</span>&nbsp;<span class="ident" id="6664886">CreateCertificateRequest</span><span class="op" id="6664910">(</span><span class="ident" id="6664911">rand</span><span class="op" id="6664915">.</span><span class="ident" id="6664916">Reader</span><span class="op" id="6664922">,</span>&nbsp;<span class="ident" id="6664924">template</span><span class="op" id="6664932">,</span>&nbsp;<span class="ident" id="6664934">rsaPriv</span><span class="op" id="6664941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6664944">if</span>&nbsp;<span class="ident" id="6664947">err</span>&nbsp;<span class="op" id="6664951">!=</span>&nbsp;<span class="ident" id="6664954">nil</span>&nbsp;<span class="op" id="6664958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664962">t</span><span class="op" id="6664963">.</span><span class="ident" id="6664964">Fatal</span><span class="op" id="6664969">(</span><span class="ident" id="6664970">err</span><span class="op" id="6664973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6664976">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6664980">csr</span><span class="op" id="6664983">,</span>&nbsp;<span class="ident" id="6664985">err</span>&nbsp;<span class="op" id="6664989">:=</span>&nbsp;<span class="ident" id="6664992">ParseCertificateRequest</span><span class="op" id="6665015">(</span><span class="ident" id="6665016">derBytes</span><span class="op" id="6665024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665027">if</span>&nbsp;<span class="ident" id="6665030">err</span>&nbsp;<span class="op" id="6665034">!=</span>&nbsp;<span class="ident" id="6665037">nil</span>&nbsp;<span class="op" id="6665041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665045">t</span><span class="op" id="6665046">.</span><span class="ident" id="6665047">Fatal</span><span class="op" id="6665052">(</span><span class="ident" id="6665053">err</span><span class="op" id="6665056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665059">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665063">return</span>&nbsp;<span class="ident" id="6665070">csr</span><br>
<span class="lineno"></span><span class="op" id="6665074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6665077">func</span>&nbsp;<span class="ident" id="6665082">TestCertificateRequestOverrides</span><span class="op" id="6665113">(</span><span class="ident" id="6665114">t</span>&nbsp;<span class="op" id="6665116">*</span><span class="ident" id="6665117">testing</span><span class="op" id="6665124">.</span><span class="ident" id="6665125">T</span><span class="op" id="6665126">)</span>&nbsp;<span class="op" id="6665128">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665131">sanContents</span><span class="op" id="6665142">,</span>&nbsp;<span class="ident" id="6665144">err</span>&nbsp;<span class="op" id="6665148">:=</span>&nbsp;<span class="ident" id="6665151">marshalSANs</span><span class="op" id="6665162">(</span><span class="op" id="6665163">[</span><span class="op" id="6665164">]</span><span class="builtintype" id="6665165">string</span><span class="op" id="6665171">{</span><span class="string" id="6665172">&#34;foo.example.com&#34;</span><span class="op" id="6665189">}</span><span class="op" id="6665190">,</span>&nbsp;<span class="ident" id="6665192">nil</span><span class="op" id="6665195">,</span>&nbsp;<span class="ident" id="6665197">nil</span><span class="op" id="6665200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665203">if</span>&nbsp;<span class="ident" id="6665206">err</span>&nbsp;<span class="op" id="6665210">!=</span>&nbsp;<span class="ident" id="6665213">nil</span>&nbsp;<span class="op" id="6665217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665221">t</span><span class="op" id="6665222">.</span><span class="ident" id="6665223">Fatal</span><span class="op" id="6665228">(</span><span class="ident" id="6665229">err</span><span class="op" id="6665232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665239">template</span>&nbsp;<span class="op" id="6665248">:=</span>&nbsp;<span class="ident" id="6665251">CertificateRequest</span><span class="op" id="6665269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665273">Subject</span><span class="op" id="6665280">:</span>&nbsp;<span class="ident" id="6665282">pkix</span><span class="op" id="6665286">.</span><span class="ident" id="6665287">Name</span><span class="op" id="6665291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665296">CommonName</span><span class="op" id="6665306">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6665310">&#34;test.example.com&#34;</span><span class="op" id="6665328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665333">Organization</span><span class="op" id="6665345">:</span>&nbsp;<span class="op" id="6665347">[</span><span class="op" id="6665348">]</span><span class="builtintype" id="6665349">string</span><span class="op" id="6665355">{</span><span class="string" id="6665356">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6665368">}</span><span class="op" id="6665369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665373">}</span><span class="op" id="6665374">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665378">DNSNames</span><span class="op" id="6665386">:</span>&nbsp;<span class="op" id="6665388">[</span><span class="op" id="6665389">]</span><span class="builtintype" id="6665390">string</span><span class="op" id="6665396">{</span><span class="string" id="6665397">&#34;test.example.com&#34;</span><span class="op" id="6665415">}</span><span class="op" id="6665416">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6665421">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6665486">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665501">ExtraExtensions</span><span class="op" id="6665516">:</span>&nbsp;<span class="op" id="6665518">[</span><span class="op" id="6665519">]</span><span class="ident" id="6665520">pkix</span><span class="op" id="6665524">.</span><span class="ident" id="6665525">Extension</span><span class="op" id="6665534">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665545">Id</span><span class="op" id="6665547">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6665552">oidExtensionSubjectAltName</span><span class="op" id="6665578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665584">Value</span><span class="op" id="6665589">:</span>&nbsp;<span class="ident" id="6665591">sanContents</span><span class="op" id="6665602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665607">}</span><span class="op" id="6665608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665612">}</span><span class="op" id="6665613">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665620">csr</span>&nbsp;<span class="op" id="6665624">:=</span>&nbsp;<span class="ident" id="6665627">marshalAndParseCSR</span><span class="op" id="6665645">(</span><span class="ident" id="6665646">t</span><span class="op" id="6665647">,</span>&nbsp;<span class="op" id="6665649">&amp;</span><span class="ident" id="6665650">template</span><span class="op" id="6665658">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6665662">if</span>&nbsp;<span class="builtinfunc" id="6665665">len</span><span class="op" id="6665668">(</span><span class="ident" id="6665669">csr</span><span class="op" id="6665672">.</span><span class="ident" id="6665673">DNSNames</span><span class="op" id="6665681">)</span>&nbsp;<span class="op" id="6665683">!=</span>&nbsp;<span class="num" id="6665686">1</span>&nbsp;<span class="op" id="6665688">||</span>&nbsp;<span class="ident" id="6665691">csr</span><span class="op" id="6665694">.</span><span class="ident" id="6665695">DNSNames</span><span class="op" id="6665703">[</span><span class="num" id="6665704">0</span><span class="op" id="6665705">]</span>&nbsp;<span class="op" id="6665707">!=</span>&nbsp;<span class="string" id="6665710">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="6665728">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665732">t</span><span class="op" id="6665733">.</span><span class="ident" id="6665734">Errorf</span><span class="op" id="6665740">(</span><span class="string" id="6665741">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6665788">,</span>&nbsp;<span class="ident" id="6665790">csr</span><span class="op" id="6665793">.</span><span class="ident" id="6665794">DNSNames</span><span class="op" id="6665802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6665805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6665809">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6665877">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6665947">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6665983">template</span><span class="op" id="6665991">.</span><span class="ident" id="6665992">Attributes</span>&nbsp;<span class="op" id="6666003">=</span>&nbsp;<span class="op" id="6666005">[</span><span class="op" id="6666006">]</span><span class="ident" id="6666007">pkix</span><span class="op" id="6666011">.</span><span class="ident" id="6666012">AttributeTypeAndValueSET</span><span class="op" id="6666036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666045">Type</span><span class="op" id="6666049">:</span>&nbsp;<span class="ident" id="6666051">oidExtensionRequest</span><span class="op" id="6666070">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666075">Value</span><span class="op" id="6666080">:</span>&nbsp;<span class="op" id="6666082">[</span><span class="op" id="6666083">]</span><span class="op" id="6666084">[</span><span class="op" id="6666085">]</span><span class="ident" id="6666086">pkix</span><span class="op" id="6666090">.</span><span class="ident" id="6666091">AttributeTypeAndValue</span><span class="op" id="6666112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666133">Type</span><span class="op" id="6666137">:</span>&nbsp;&nbsp;<span class="ident" id="6666140">oidExtensionAuthorityInfoAccess</span><span class="op" id="6666171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666179">Value</span><span class="op" id="6666184">:</span>&nbsp;<span class="op" id="6666186">[</span><span class="op" id="6666187">]</span><span class="builtintype" id="6666188">byte</span><span class="op" id="6666192">(</span><span class="string" id="6666193">&#34;foo&#34;</span><span class="op" id="6666198">)</span><span class="op" id="6666199">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666206">}</span><span class="op" id="6666207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666213">}</span><span class="op" id="6666214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666219">}</span><span class="op" id="6666220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666224">}</span><span class="op" id="6666225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666228">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666232">csr</span>&nbsp;<span class="op" id="6666236">=</span>&nbsp;<span class="ident" id="6666238">marshalAndParseCSR</span><span class="op" id="6666256">(</span><span class="ident" id="6666257">t</span><span class="op" id="6666258">,</span>&nbsp;<span class="op" id="6666260">&amp;</span><span class="ident" id="6666261">template</span><span class="op" id="6666269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666272">if</span>&nbsp;<span class="ident" id="6666275">l</span>&nbsp;<span class="op" id="6666277">:=</span>&nbsp;<span class="builtinfunc" id="6666280">len</span><span class="op" id="6666283">(</span><span class="ident" id="6666284">csr</span><span class="op" id="6666287">.</span><span class="ident" id="6666288">Attributes</span><span class="op" id="6666298">)</span><span class="op" id="6666299">;</span>&nbsp;<span class="ident" id="6666301">l</span>&nbsp;<span class="op" id="6666303">!=</span>&nbsp;<span class="num" id="6666306">1</span>&nbsp;<span class="op" id="6666308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666312">t</span><span class="op" id="6666313">.</span><span class="ident" id="6666314">Errorf</span><span class="op" id="6666320">(</span><span class="string" id="6666321">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="6666359">,</span>&nbsp;<span class="ident" id="6666361">l</span><span class="op" id="6666362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666365">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666369">if</span>&nbsp;<span class="op" id="6666372">!</span><span class="ident" id="6666373">csr</span><span class="op" id="6666376">.</span><span class="ident" id="6666377">Attributes</span><span class="op" id="6666387">[</span><span class="num" id="6666388">0</span><span class="op" id="6666389">]</span><span class="op" id="6666390">.</span><span class="ident" id="6666391">Type</span><span class="op" id="6666395">.</span><span class="ident" id="6666396">Equal</span><span class="op" id="6666401">(</span><span class="ident" id="6666402">oidExtensionRequest</span><span class="op" id="6666421">)</span>&nbsp;<span class="op" id="6666423">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6666428">len</span><span class="op" id="6666431">(</span><span class="ident" id="6666432">csr</span><span class="op" id="6666435">.</span><span class="ident" id="6666436">Attributes</span><span class="op" id="6666446">[</span><span class="num" id="6666447">0</span><span class="op" id="6666448">]</span><span class="op" id="6666449">.</span><span class="ident" id="6666450">Value</span><span class="op" id="6666455">)</span>&nbsp;<span class="op" id="6666457">!=</span>&nbsp;<span class="num" id="6666460">1</span>&nbsp;<span class="op" id="6666462">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6666467">len</span><span class="op" id="6666470">(</span><span class="ident" id="6666471">csr</span><span class="op" id="6666474">.</span><span class="ident" id="6666475">Attributes</span><span class="op" id="6666485">[</span><span class="num" id="6666486">0</span><span class="op" id="6666487">]</span><span class="op" id="6666488">.</span><span class="ident" id="6666489">Value</span><span class="op" id="6666494">[</span><span class="num" id="6666495">0</span><span class="op" id="6666496">]</span><span class="op" id="6666497">)</span>&nbsp;<span class="op" id="6666499">!=</span>&nbsp;<span class="num" id="6666502">2</span>&nbsp;<span class="op" id="6666504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666508">t</span><span class="op" id="6666509">.</span><span class="ident" id="6666510">Errorf</span><span class="op" id="6666516">(</span><span class="string" id="6666517">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="6666540">,</span>&nbsp;<span class="ident" id="6666542">csr</span><span class="op" id="6666545">.</span><span class="ident" id="6666546">Attributes</span><span class="op" id="6666556">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666563">sanContents2</span><span class="op" id="6666575">,</span>&nbsp;<span class="ident" id="6666577">err</span>&nbsp;<span class="op" id="6666581">:=</span>&nbsp;<span class="ident" id="6666584">marshalSANs</span><span class="op" id="6666595">(</span><span class="op" id="6666596">[</span><span class="op" id="6666597">]</span><span class="builtintype" id="6666598">string</span><span class="op" id="6666604">{</span><span class="string" id="6666605">&#34;foo2.example.com&#34;</span><span class="op" id="6666623">}</span><span class="op" id="6666624">,</span>&nbsp;<span class="ident" id="6666626">nil</span><span class="op" id="6666629">,</span>&nbsp;<span class="ident" id="6666631">nil</span><span class="op" id="6666634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666637">if</span>&nbsp;<span class="ident" id="6666640">err</span>&nbsp;<span class="op" id="6666644">!=</span>&nbsp;<span class="ident" id="6666647">nil</span>&nbsp;<span class="op" id="6666651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666655">t</span><span class="op" id="6666656">.</span><span class="ident" id="6666657">Fatal</span><span class="op" id="6666662">(</span><span class="ident" id="6666663">err</span><span class="op" id="6666666">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6666673">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666744">template</span><span class="op" id="6666752">.</span><span class="ident" id="6666753">Attributes</span><span class="op" id="6666763">[</span><span class="num" id="6666764">0</span><span class="op" id="6666765">]</span><span class="op" id="6666766">.</span><span class="ident" id="6666767">Value</span><span class="op" id="6666772">[</span><span class="num" id="6666773">0</span><span class="op" id="6666774">]</span>&nbsp;<span class="op" id="6666776">=</span>&nbsp;<span class="builtinfunc" id="6666778">append</span><span class="op" id="6666784">(</span><span class="ident" id="6666785">template</span><span class="op" id="6666793">.</span><span class="ident" id="6666794">Attributes</span><span class="op" id="6666804">[</span><span class="num" id="6666805">0</span><span class="op" id="6666806">]</span><span class="op" id="6666807">.</span><span class="ident" id="6666808">Value</span><span class="op" id="6666813">[</span><span class="num" id="6666814">0</span><span class="op" id="6666815">]</span><span class="op" id="6666816">,</span>&nbsp;<span class="ident" id="6666818">pkix</span><span class="op" id="6666822">.</span><span class="ident" id="6666823">AttributeTypeAndValue</span><span class="op" id="6666844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666848">Type</span><span class="op" id="6666852">:</span>&nbsp;&nbsp;<span class="ident" id="6666855">oidExtensionSubjectAltName</span><span class="op" id="6666881">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666885">Value</span><span class="op" id="6666890">:</span>&nbsp;<span class="ident" id="6666892">sanContents2</span><span class="op" id="6666904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6666907">}</span><span class="op" id="6666908">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6666912">csr</span>&nbsp;<span class="op" id="6666916">=</span>&nbsp;<span class="ident" id="6666918">marshalAndParseCSR</span><span class="op" id="6666936">(</span><span class="ident" id="6666937">t</span><span class="op" id="6666938">,</span>&nbsp;<span class="op" id="6666940">&amp;</span><span class="ident" id="6666941">template</span><span class="op" id="6666949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6666953">if</span>&nbsp;<span class="builtinfunc" id="6666956">len</span><span class="op" id="6666959">(</span><span class="ident" id="6666960">csr</span><span class="op" id="6666963">.</span><span class="ident" id="6666964">DNSNames</span><span class="op" id="6666972">)</span>&nbsp;<span class="op" id="6666974">!=</span>&nbsp;<span class="num" id="6666977">1</span>&nbsp;<span class="op" id="6666979">||</span>&nbsp;<span class="ident" id="6666982">csr</span><span class="op" id="6666985">.</span><span class="ident" id="6666986">DNSNames</span><span class="op" id="6666994">[</span><span class="num" id="6666995">0</span><span class="op" id="6666996">]</span>&nbsp;<span class="op" id="6666998">!=</span>&nbsp;<span class="string" id="6667001">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="6667020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667024">t</span><span class="op" id="6667025">.</span><span class="ident" id="6667026">Errorf</span><span class="op" id="6667032">(</span><span class="string" id="6667033">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6667088">,</span>&nbsp;<span class="ident" id="6667090">csr</span><span class="op" id="6667093">.</span><span class="ident" id="6667094">DNSNames</span><span class="op" id="6667102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667105">}</span><br>
<span class="lineno"></span><span class="op" id="6667107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="6667110">func</span>&nbsp;<span class="ident" id="6667115">TestParseCertificateRequest</span><span class="op" id="6667142">(</span><span class="ident" id="6667143">t</span>&nbsp;<span class="op" id="6667145">*</span><span class="ident" id="6667146">testing</span><span class="op" id="6667153">.</span><span class="ident" id="6667154">T</span><span class="op" id="6667155">)</span>&nbsp;<span class="op" id="6667157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667160">csrBytes</span>&nbsp;<span class="op" id="6667169">:=</span>&nbsp;<span class="ident" id="6667172">fromBase64</span><span class="op" id="6667182">(</span><span class="ident" id="6667183">csrBase64</span><span class="op" id="6667192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667195">csr</span><span class="op" id="6667198">,</span>&nbsp;<span class="ident" id="6667200">err</span>&nbsp;<span class="op" id="6667204">:=</span>&nbsp;<span class="ident" id="6667207">ParseCertificateRequest</span><span class="op" id="6667230">(</span><span class="ident" id="6667231">csrBytes</span><span class="op" id="6667239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667242">if</span>&nbsp;<span class="ident" id="6667245">err</span>&nbsp;<span class="op" id="6667249">!=</span>&nbsp;<span class="ident" id="6667252">nil</span>&nbsp;<span class="op" id="6667256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667260">t</span><span class="op" id="6667261">.</span><span class="ident" id="6667262">Fatalf</span><span class="op" id="6667268">(</span><span class="string" id="6667269">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="6667294">,</span>&nbsp;<span class="ident" id="6667296">err</span><span class="op" id="6667299">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667306">if</span>&nbsp;<span class="builtinfunc" id="6667309">len</span><span class="op" id="6667312">(</span><span class="ident" id="6667313">csr</span><span class="op" id="6667316">.</span><span class="ident" id="6667317">EmailAddresses</span><span class="op" id="6667331">)</span>&nbsp;<span class="op" id="6667333">!=</span>&nbsp;<span class="num" id="6667336">1</span>&nbsp;<span class="op" id="6667338">||</span>&nbsp;<span class="ident" id="6667341">csr</span><span class="op" id="6667344">.</span><span class="ident" id="6667345">EmailAddresses</span><span class="op" id="6667359">[</span><span class="num" id="6667360">0</span><span class="op" id="6667361">]</span>&nbsp;<span class="op" id="6667363">!=</span>&nbsp;<span class="string" id="6667366">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="6667386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667390">t</span><span class="op" id="6667391">.</span><span class="ident" id="6667392">Errorf</span><span class="op" id="6667398">(</span><span class="string" id="6667399">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6667436">,</span>&nbsp;<span class="ident" id="6667438">csr</span><span class="op" id="6667441">.</span><span class="ident" id="6667442">EmailAddresses</span><span class="op" id="6667456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667459">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667463">if</span>&nbsp;<span class="builtinfunc" id="6667466">len</span><span class="op" id="6667469">(</span><span class="ident" id="6667470">csr</span><span class="op" id="6667473">.</span><span class="ident" id="6667474">DNSNames</span><span class="op" id="6667482">)</span>&nbsp;<span class="op" id="6667484">!=</span>&nbsp;<span class="num" id="6667487">1</span>&nbsp;<span class="op" id="6667489">||</span>&nbsp;<span class="ident" id="6667492">csr</span><span class="op" id="6667495">.</span><span class="ident" id="6667496">DNSNames</span><span class="op" id="6667504">[</span><span class="num" id="6667505">0</span><span class="op" id="6667506">]</span>&nbsp;<span class="op" id="6667508">!=</span>&nbsp;<span class="string" id="6667511">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="6667530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667534">t</span><span class="op" id="6667535">.</span><span class="ident" id="6667536">Errorf</span><span class="op" id="6667542">(</span><span class="string" id="6667543">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6667574">,</span>&nbsp;<span class="ident" id="6667576">csr</span><span class="op" id="6667579">.</span><span class="ident" id="6667580">DNSNames</span><span class="op" id="6667588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667595">if</span>&nbsp;<span class="builtinfunc" id="6667598">len</span><span class="op" id="6667601">(</span><span class="ident" id="6667602">csr</span><span class="op" id="6667605">.</span><span class="ident" id="6667606">Subject</span><span class="op" id="6667613">.</span><span class="ident" id="6667614">Country</span><span class="op" id="6667621">)</span>&nbsp;<span class="op" id="6667623">!=</span>&nbsp;<span class="num" id="6667626">1</span>&nbsp;<span class="op" id="6667628">||</span>&nbsp;<span class="ident" id="6667631">csr</span><span class="op" id="6667634">.</span><span class="ident" id="6667635">Subject</span><span class="op" id="6667642">.</span><span class="ident" id="6667643">Country</span><span class="op" id="6667650">[</span><span class="num" id="6667651">0</span><span class="op" id="6667652">]</span>&nbsp;<span class="op" id="6667654">!=</span>&nbsp;<span class="string" id="6667657">&#34;AU&#34;</span>&nbsp;<span class="op" id="6667662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667666">t</span><span class="op" id="6667667">.</span><span class="ident" id="6667668">Errorf</span><span class="op" id="6667674">(</span><span class="string" id="6667675">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6667703">,</span>&nbsp;<span class="ident" id="6667705">csr</span><span class="op" id="6667708">.</span><span class="ident" id="6667709">Subject</span><span class="op" id="6667716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667723">found</span>&nbsp;<span class="op" id="6667729">:=</span>&nbsp;<span class="ident" id="6667732">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667739">for</span>&nbsp;<span class="ident" id="6667743">_</span><span class="op" id="6667744">,</span>&nbsp;<span class="ident" id="6667746">e</span>&nbsp;<span class="op" id="6667748">:=</span>&nbsp;<span class="keyword" id="6667751">range</span>&nbsp;<span class="ident" id="6667757">csr</span><span class="op" id="6667760">.</span><span class="ident" id="6667761">Extensions</span>&nbsp;<span class="op" id="6667772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667776">if</span>&nbsp;<span class="ident" id="6667779">e</span><span class="op" id="6667780">.</span><span class="ident" id="6667781">Id</span><span class="op" id="6667783">.</span><span class="ident" id="6667784">Equal</span><span class="op" id="6667789">(</span><span class="ident" id="6667790">oidExtensionBasicConstraints</span><span class="op" id="6667818">)</span>&nbsp;<span class="op" id="6667820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667825">found</span>&nbsp;<span class="op" id="6667831">=</span>&nbsp;<span class="ident" id="6667833">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667841">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667849">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6667855">if</span>&nbsp;<span class="op" id="6667858">!</span><span class="ident" id="6667859">found</span>&nbsp;<span class="op" id="6667865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667869">t</span><span class="op" id="6667870">.</span><span class="ident" id="6667871">Errorf</span><span class="op" id="6667877">(</span><span class="string" id="6667878">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="6667924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6667927">}</span><br>
<span class="lineno"></span><span class="op" id="6667929">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="6667932">func</span>&nbsp;<span class="ident" id="6667937">TestMaxPathLen</span><span class="op" id="6667951">(</span><span class="ident" id="6667952">t</span>&nbsp;<span class="op" id="6667954">*</span><span class="ident" id="6667955">testing</span><span class="op" id="6667962">.</span><span class="ident" id="6667963">T</span><span class="op" id="6667964">)</span>&nbsp;<span class="op" id="6667966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6667969">block</span><span class="op" id="6667974">,</span>&nbsp;<span class="ident" id="6667976">_</span>&nbsp;<span class="op" id="6667978">:=</span>&nbsp;<span class="ident" id="6667981">pem</span><span class="op" id="6667984">.</span><span class="ident" id="6667985">Decode</span><span class="op" id="6667991">(</span><span class="op" id="6667992">[</span><span class="op" id="6667993">]</span><span class="builtintype" id="6667994">byte</span><span class="op" id="6667998">(</span><span class="ident" id="6667999">pemPrivateKey</span><span class="op" id="6668012">)</span><span class="op" id="6668013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668016">rsaPriv</span><span class="op" id="6668023">,</span>&nbsp;<span class="ident" id="6668025">err</span>&nbsp;<span class="op" id="6668029">:=</span>&nbsp;<span class="ident" id="6668032">ParsePKCS1PrivateKey</span><span class="op" id="6668052">(</span><span class="ident" id="6668053">block</span><span class="op" id="6668058">.</span><span class="ident" id="6668059">Bytes</span><span class="op" id="6668064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668067">if</span>&nbsp;<span class="ident" id="6668070">err</span>&nbsp;<span class="op" id="6668074">!=</span>&nbsp;<span class="ident" id="6668077">nil</span>&nbsp;<span class="op" id="6668081">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668085">t</span><span class="op" id="6668086">.</span><span class="ident" id="6668087">Fatalf</span><span class="op" id="6668093">(</span><span class="string" id="6668094">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6668127">,</span>&nbsp;<span class="ident" id="6668129">err</span><span class="op" id="6668132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668139">template</span>&nbsp;<span class="op" id="6668148">:=</span>&nbsp;<span class="op" id="6668151">&amp;</span><span class="ident" id="6668152">Certificate</span><span class="op" id="6668163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668167">SerialNumber</span><span class="op" id="6668179">:</span>&nbsp;<span class="ident" id="6668181">big</span><span class="op" id="6668184">.</span><span class="ident" id="6668185">NewInt</span><span class="op" id="6668191">(</span><span class="num" id="6668192">1</span><span class="op" id="6668193">)</span><span class="op" id="6668194">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668198">Subject</span><span class="op" id="6668205">:</span>&nbsp;<span class="ident" id="6668207">pkix</span><span class="op" id="6668211">.</span><span class="ident" id="6668212">Name</span><span class="op" id="6668216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668221">CommonName</span><span class="op" id="6668231">:</span>&nbsp;<span class="string" id="6668233">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6668245">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668249">}</span><span class="op" id="6668250">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668254">NotBefore</span><span class="op" id="6668263">:</span>&nbsp;<span class="ident" id="6668265">time</span><span class="op" id="6668269">.</span><span class="ident" id="6668270">Unix</span><span class="op" id="6668274">(</span><span class="num" id="6668275">1000</span><span class="op" id="6668279">,</span>&nbsp;<span class="num" id="6668281">0</span><span class="op" id="6668282">)</span><span class="op" id="6668283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668287">NotAfter</span><span class="op" id="6668295">:</span>&nbsp;&nbsp;<span class="ident" id="6668298">time</span><span class="op" id="6668302">.</span><span class="ident" id="6668303">Unix</span><span class="op" id="6668307">(</span><span class="num" id="6668308">100000</span><span class="op" id="6668314">,</span>&nbsp;<span class="num" id="6668316">0</span><span class="op" id="6668317">)</span><span class="op" id="6668318">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668323">BasicConstraintsValid</span><span class="op" id="6668344">:</span>&nbsp;<span class="ident" id="6668346">true</span><span class="op" id="6668350">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668354">IsCA</span><span class="op" id="6668358">:</span>&nbsp;<span class="ident" id="6668360">true</span><span class="op" id="6668364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668371">serialiseAndParse</span>&nbsp;<span class="op" id="6668389">:=</span>&nbsp;<span class="keyword" id="6668392">func</span><span class="op" id="6668396">(</span><span class="ident" id="6668397">template</span>&nbsp;<span class="op" id="6668406">*</span><span class="ident" id="6668407">Certificate</span><span class="op" id="6668418">)</span>&nbsp;<span class="op" id="6668420">*</span><span class="ident" id="6668421">Certificate</span>&nbsp;<span class="op" id="6668433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668437">derBytes</span><span class="op" id="6668445">,</span>&nbsp;<span class="ident" id="6668447">err</span>&nbsp;<span class="op" id="6668451">:=</span>&nbsp;<span class="ident" id="6668454">CreateCertificate</span><span class="op" id="6668471">(</span><span class="ident" id="6668472">rand</span><span class="op" id="6668476">.</span><span class="ident" id="6668477">Reader</span><span class="op" id="6668483">,</span>&nbsp;<span class="ident" id="6668485">template</span><span class="op" id="6668493">,</span>&nbsp;<span class="ident" id="6668495">template</span><span class="op" id="6668503">,</span>&nbsp;<span class="op" id="6668505">&amp;</span><span class="ident" id="6668506">rsaPriv</span><span class="op" id="6668513">.</span><span class="ident" id="6668514">PublicKey</span><span class="op" id="6668523">,</span>&nbsp;<span class="ident" id="6668525">rsaPriv</span><span class="op" id="6668532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668536">if</span>&nbsp;<span class="ident" id="6668539">err</span>&nbsp;<span class="op" id="6668543">!=</span>&nbsp;<span class="ident" id="6668546">nil</span>&nbsp;<span class="op" id="6668550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668555">t</span><span class="op" id="6668556">.</span><span class="ident" id="6668557">Fatalf</span><span class="op" id="6668563">(</span><span class="string" id="6668564">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6668598">,</span>&nbsp;<span class="ident" id="6668600">err</span><span class="op" id="6668603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668608">return</span>&nbsp;<span class="ident" id="6668615">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668626">cert</span><span class="op" id="6668630">,</span>&nbsp;<span class="ident" id="6668632">err</span>&nbsp;<span class="op" id="6668636">:=</span>&nbsp;<span class="ident" id="6668639">ParseCertificate</span><span class="op" id="6668655">(</span><span class="ident" id="6668656">derBytes</span><span class="op" id="6668664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668668">if</span>&nbsp;<span class="ident" id="6668671">err</span>&nbsp;<span class="op" id="6668675">!=</span>&nbsp;<span class="ident" id="6668678">nil</span>&nbsp;<span class="op" id="6668682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668687">t</span><span class="op" id="6668688">.</span><span class="ident" id="6668689">Fatalf</span><span class="op" id="6668695">(</span><span class="string" id="6668696">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6668729">,</span>&nbsp;<span class="ident" id="6668731">err</span><span class="op" id="6668734">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668739">return</span>&nbsp;<span class="ident" id="6668746">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668757">return</span>&nbsp;<span class="ident" id="6668764">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668770">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668774">cert1</span>&nbsp;<span class="op" id="6668780">:=</span>&nbsp;<span class="ident" id="6668783">serialiseAndParse</span><span class="op" id="6668800">(</span><span class="ident" id="6668801">template</span><span class="op" id="6668809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668812">if</span>&nbsp;<span class="ident" id="6668815">m</span>&nbsp;<span class="op" id="6668817">:=</span>&nbsp;<span class="ident" id="6668820">cert1</span><span class="op" id="6668825">.</span><span class="ident" id="6668826">MaxPathLen</span><span class="op" id="6668836">;</span>&nbsp;<span class="ident" id="6668838">m</span>&nbsp;<span class="op" id="6668840">!=</span>&nbsp;<span class="op" id="6668843">-</span><span class="num" id="6668844">1</span>&nbsp;<span class="op" id="6668846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668850">t</span><span class="op" id="6668851">.</span><span class="ident" id="6668852">Errorf</span><span class="op" id="6668858">(</span><span class="string" id="6668859">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6668908">,</span>&nbsp;<span class="ident" id="6668910">m</span><span class="op" id="6668911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6668914">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6668917">if</span>&nbsp;<span class="ident" id="6668920">cert1</span><span class="op" id="6668925">.</span><span class="ident" id="6668926">MaxPathLenZero</span>&nbsp;<span class="op" id="6668941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6668945">t</span><span class="op" id="6668946">.</span><span class="ident" id="6668947">Errorf</span><span class="op" id="6668953">(</span><span class="string" id="6668954">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6669002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669009">template</span><span class="op" id="6669017">.</span><span class="ident" id="6669018">MaxPathLen</span>&nbsp;<span class="op" id="6669029">=</span>&nbsp;<span class="num" id="6669031">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669034">cert2</span>&nbsp;<span class="op" id="6669040">:=</span>&nbsp;<span class="ident" id="6669043">serialiseAndParse</span><span class="op" id="6669060">(</span><span class="ident" id="6669061">template</span><span class="op" id="6669069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669072">if</span>&nbsp;<span class="ident" id="6669075">m</span>&nbsp;<span class="op" id="6669077">:=</span>&nbsp;<span class="ident" id="6669080">cert2</span><span class="op" id="6669085">.</span><span class="ident" id="6669086">MaxPathLen</span><span class="op" id="6669096">;</span>&nbsp;<span class="ident" id="6669098">m</span>&nbsp;<span class="op" id="6669100">!=</span>&nbsp;<span class="num" id="6669103">1</span>&nbsp;<span class="op" id="6669105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669109">t</span><span class="op" id="6669110">.</span><span class="ident" id="6669111">Errorf</span><span class="op" id="6669117">(</span><span class="string" id="6669118">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="6669168">,</span>&nbsp;<span class="ident" id="6669170">m</span><span class="op" id="6669171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669177">if</span>&nbsp;<span class="ident" id="6669180">cert2</span><span class="op" id="6669185">.</span><span class="ident" id="6669186">MaxPathLenZero</span>&nbsp;<span class="op" id="6669201">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669205">t</span><span class="op" id="6669206">.</span><span class="ident" id="6669207">Errorf</span><span class="op" id="6669213">(</span><span class="string" id="6669214">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6669261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669268">template</span><span class="op" id="6669276">.</span><span class="ident" id="6669277">MaxPathLen</span>&nbsp;<span class="op" id="6669288">=</span>&nbsp;<span class="num" id="6669290">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669293">template</span><span class="op" id="6669301">.</span><span class="ident" id="6669302">MaxPathLenZero</span>&nbsp;<span class="op" id="6669317">=</span>&nbsp;<span class="ident" id="6669319">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669325">cert3</span>&nbsp;<span class="op" id="6669331">:=</span>&nbsp;<span class="ident" id="6669334">serialiseAndParse</span><span class="op" id="6669351">(</span><span class="ident" id="6669352">template</span><span class="op" id="6669360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669363">if</span>&nbsp;<span class="ident" id="6669366">m</span>&nbsp;<span class="op" id="6669368">:=</span>&nbsp;<span class="ident" id="6669371">cert3</span><span class="op" id="6669376">.</span><span class="ident" id="6669377">MaxPathLen</span><span class="op" id="6669387">;</span>&nbsp;<span class="ident" id="6669389">m</span>&nbsp;<span class="op" id="6669391">!=</span>&nbsp;<span class="num" id="6669394">0</span>&nbsp;<span class="op" id="6669396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669400">t</span><span class="op" id="6669401">.</span><span class="ident" id="6669402">Errorf</span><span class="op" id="6669408">(</span><span class="string" id="6669409">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6669453">,</span>&nbsp;<span class="ident" id="6669455">m</span><span class="op" id="6669456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6669462">if</span>&nbsp;<span class="op" id="6669465">!</span><span class="ident" id="6669466">cert3</span><span class="op" id="6669471">.</span><span class="ident" id="6669472">MaxPathLenZero</span>&nbsp;<span class="op" id="6669487">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6669491">t</span><span class="op" id="6669492">.</span><span class="ident" id="6669493">Errorf</span><span class="op" id="6669499">(</span><span class="string" id="6669500">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6669560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6669563">}</span><br>
<span class="lineno"></span><span class="op" id="6669565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6669568">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="6669608">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="6669709">//</span><br>
<span class="lineno"></span><span class="comment" id="6669712">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="6669762">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="6669778">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="6669811">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="6669877">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="6669944">const</span>&nbsp;<span class="ident" id="6669950">csrBase64</span>&nbsp;<span class="op" id="6669960">=</span>&nbsp;<span class="string" id="6669962">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
