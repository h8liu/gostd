<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7059960">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7060016">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7060070">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7060121">package</span>&nbsp;<span class="ident" id="7060129">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7060135">import</span>&nbsp;<span class="op" id="7060142">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060145">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060154">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060164">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060171">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060177">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060190">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060201">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060212">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7060222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7060225">type</span>&nbsp;<span class="ident" id="7060230">reqWriteTest</span>&nbsp;<span class="keyword" id="7060243">struct</span>&nbsp;<span class="op" id="7060250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060253">Req</span>&nbsp;&nbsp;<span class="ident" id="7060258"><a href="/net/http/request.go.html#3366486">Request</a></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060267">Body</span>&nbsp;<span class="keyword" id="7060272">interface</span><span class="op" id="7060281">{</span><span class="op" id="7060282">}</span>&nbsp;<span class="comment" id="7060284">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060350">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060405">WantWrite</span>&nbsp;<span class="builtintype" id="7060415">string</span>&nbsp;<span class="comment" id="7060422">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060440">WantProxy</span>&nbsp;<span class="builtintype" id="7060450">string</span>&nbsp;<span class="comment" id="7060457">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060481">WantError</span>&nbsp;<span class="builtintype" id="7060491">error</span>&nbsp;<span class="comment" id="7060497">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="7060532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7060535">var</span>&nbsp;<span class="ident" id="7060539">reqWriteTests</span>&nbsp;<span class="op" id="7060553">=</span>&nbsp;<span class="op" id="7060555">[</span><span class="op" id="7060556">]</span><span class="ident" id="7060557"><a href="/net/http/requestwrite_test.go.html#7060230">reqWriteTest</a></span><span class="op" id="7060569">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7060572">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060628">Req</span><span class="op" id="7060631">:</span>&nbsp;<span class="ident" id="7060633"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7060640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060645">Method</span><span class="op" id="7060651">:</span>&nbsp;<span class="string" id="7060653">&#34;GET&#34;</span><span class="op" id="7060658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060663">URL</span><span class="op" id="7060666">:</span>&nbsp;<span class="op" id="7060668">&amp;</span><span class="ident" id="7060669"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7060672">.</span><span class="ident" id="7060673">URL</span><span class="op" id="7060676">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060682">Scheme</span><span class="op" id="7060688">:</span>&nbsp;<span class="string" id="7060690">&#34;http&#34;</span><span class="op" id="7060696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060702">Host</span><span class="op" id="7060706">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7060710">&#34;www.techcrunch.com&#34;</span><span class="op" id="7060730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060736">Path</span><span class="op" id="7060740">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7060744">&#34;/&#34;</span><span class="op" id="7060747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7060752">}</span><span class="op" id="7060753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060758">Proto</span><span class="op" id="7060763">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7060770">&#34;HTTP/1.1&#34;</span><span class="op" id="7060780">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060785">ProtoMajor</span><span class="op" id="7060795">:</span>&nbsp;<span class="num" id="7060797">1</span><span class="op" id="7060798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060803">ProtoMinor</span><span class="op" id="7060813">:</span>&nbsp;<span class="num" id="7060815">1</span><span class="op" id="7060816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7060821">Header</span><span class="op" id="7060827">:</span>&nbsp;<span class="ident" id="7060829"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7060835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060841">&#34;Accept&#34;</span><span class="op" id="7060849">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7060861">{</span><span class="string" id="7060862">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="7060927">}</span><span class="op" id="7060928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060934">&#34;Accept-Charset&#34;</span><span class="op" id="7060950">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7060954">{</span><span class="string" id="7060955">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="7060987">}</span><span class="op" id="7060988">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7060994">&#34;Accept-Encoding&#34;</span><span class="op" id="7061011">:</span>&nbsp;&nbsp;<span class="op" id="7061014">{</span><span class="string" id="7061015">&#34;gzip,deflate&#34;</span><span class="op" id="7061029">}</span><span class="op" id="7061030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061036">&#34;Accept-Language&#34;</span><span class="op" id="7061053">:</span>&nbsp;&nbsp;<span class="op" id="7061056">{</span><span class="string" id="7061057">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="7061073">}</span><span class="op" id="7061074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061080">&#34;Keep-Alive&#34;</span><span class="op" id="7061092">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7061100">{</span><span class="string" id="7061101">&#34;300&#34;</span><span class="op" id="7061106">}</span><span class="op" id="7061107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061113">&#34;Proxy-Connection&#34;</span><span class="op" id="7061131">:</span>&nbsp;<span class="op" id="7061133">{</span><span class="string" id="7061134">&#34;keep-alive&#34;</span><span class="op" id="7061146">}</span><span class="op" id="7061147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061153">&#34;User-Agent&#34;</span><span class="op" id="7061165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7061173">{</span><span class="string" id="7061174">&#34;Fake&#34;</span><span class="op" id="7061180">}</span><span class="op" id="7061181">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061186">}</span><span class="op" id="7061187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061192">Body</span><span class="op" id="7061196">:</span>&nbsp;&nbsp;<span class="ident" id="7061199">nil</span><span class="op" id="7061202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061207">Close</span><span class="op" id="7061212">:</span>&nbsp;<span class="builtintype" id="7061214">false</span><span class="op" id="7061219">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061224">Host</span><span class="op" id="7061228">:</span>&nbsp;&nbsp;<span class="string" id="7061231">&#34;www.techcrunch.com&#34;</span><span class="op" id="7061251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061256">Form</span><span class="op" id="7061260">:</span>&nbsp;&nbsp;<span class="keyword" id="7061263">map</span><span class="op" id="7061266">[</span><span class="builtintype" id="7061267">string</span><span class="op" id="7061273">]</span><span class="op" id="7061274">[</span><span class="op" id="7061275">]</span><span class="builtintype" id="7061276">string</span><span class="op" id="7061282">{</span><span class="op" id="7061283">}</span><span class="op" id="7061284">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7061288">}</span><span class="op" id="7061289">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061294">WantWrite</span><span class="op" id="7061303">:</span>&nbsp;<span class="string" id="7061305">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7061326">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061331">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7061362">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061367">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7061390">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061395">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7061473">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061478">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7061531">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061536">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7061572">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061577">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7061615">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061620">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7061642">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061647">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7061685">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7061690">WantProxy</span><span class="op" id="7061699">:</span>&nbsp;<span class="string" id="7061701">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7061747">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061752">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="7061783">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061788">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="7061811">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061816">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="7061894">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061899">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="7061952">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061957">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="7061993">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7061998">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="7062036">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062041">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="7062063">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062068">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="7062106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062109">}</span><span class="op" id="7062110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7062113">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062169">Req</span><span class="op" id="7062172">:</span>&nbsp;<span class="ident" id="7062174"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7062181">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062186">Method</span><span class="op" id="7062192">:</span>&nbsp;<span class="string" id="7062194">&#34;GET&#34;</span><span class="op" id="7062199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062204">URL</span><span class="op" id="7062207">:</span>&nbsp;<span class="op" id="7062209">&amp;</span><span class="ident" id="7062210"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7062213">.</span><span class="ident" id="7062214">URL</span><span class="op" id="7062217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062223">Scheme</span><span class="op" id="7062229">:</span>&nbsp;<span class="string" id="7062231">&#34;http&#34;</span><span class="op" id="7062237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062243">Host</span><span class="op" id="7062247">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7062251">&#34;www.google.com&#34;</span><span class="op" id="7062267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062273">Path</span><span class="op" id="7062277">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7062281">&#34;/search&#34;</span><span class="op" id="7062290">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062295">}</span><span class="op" id="7062296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062301">ProtoMajor</span><span class="op" id="7062311">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062319">1</span><span class="op" id="7062320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062325">ProtoMinor</span><span class="op" id="7062335">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7062343">1</span><span class="op" id="7062344">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062349">Header</span><span class="op" id="7062355">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7062367"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7062373">{</span><span class="op" id="7062374">}</span><span class="op" id="7062375">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062380">TransferEncoding</span><span class="op" id="7062396">:</span>&nbsp;<span class="op" id="7062398">[</span><span class="op" id="7062399">]</span><span class="builtintype" id="7062400">string</span><span class="op" id="7062406">{</span><span class="string" id="7062407">&#34;chunked&#34;</span><span class="op" id="7062416">}</span><span class="op" id="7062417">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062421">}</span><span class="op" id="7062422">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062427">Body</span><span class="op" id="7062431">:</span>&nbsp;<span class="op" id="7062433">[</span><span class="op" id="7062434">]</span><span class="builtintype" id="7062435">byte</span><span class="op" id="7062439">(</span><span class="string" id="7062440">&#34;abcdef&#34;</span><span class="op" id="7062448">)</span><span class="op" id="7062449">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062454">WantWrite</span><span class="op" id="7062463">:</span>&nbsp;<span class="string" id="7062465">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7062492">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062497">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7062524">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062529">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7062567">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062572">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7062609">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062614"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7062619">(</span><span class="string" id="7062620">&#34;abcdef&#34;</span><span class="op" id="7062628">)</span>&nbsp;<span class="op" id="7062630">+</span>&nbsp;<span class="ident" id="7062632"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7062637">(</span><span class="string" id="7062638">&#34;&#34;</span><span class="op" id="7062640">)</span><span class="op" id="7062641">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062646">WantProxy</span><span class="op" id="7062655">:</span>&nbsp;<span class="string" id="7062657">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7062705">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062710">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7062737">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062742">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7062780">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7062785">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7062822">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062827"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7062832">(</span><span class="string" id="7062833">&#34;abcdef&#34;</span><span class="op" id="7062841">)</span>&nbsp;<span class="op" id="7062843">+</span>&nbsp;<span class="ident" id="7062845"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7062850">(</span><span class="string" id="7062851">&#34;&#34;</span><span class="op" id="7062853">)</span><span class="op" id="7062854">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062857">}</span><span class="op" id="7062858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7062861">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7062918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062922">Req</span><span class="op" id="7062925">:</span>&nbsp;<span class="ident" id="7062927"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7062934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062939">Method</span><span class="op" id="7062945">:</span>&nbsp;<span class="string" id="7062947">&#34;POST&#34;</span><span class="op" id="7062953">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062958">URL</span><span class="op" id="7062961">:</span>&nbsp;<span class="op" id="7062963">&amp;</span><span class="ident" id="7062964"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7062967">.</span><span class="ident" id="7062968">URL</span><span class="op" id="7062971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062977">Scheme</span><span class="op" id="7062983">:</span>&nbsp;<span class="string" id="7062985">&#34;http&#34;</span><span class="op" id="7062991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7062997">Host</span><span class="op" id="7063001">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7063005">&#34;www.google.com&#34;</span><span class="op" id="7063021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063027">Path</span><span class="op" id="7063031">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7063035">&#34;/search&#34;</span><span class="op" id="7063044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063049">}</span><span class="op" id="7063050">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063055">ProtoMajor</span><span class="op" id="7063065">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063073">1</span><span class="op" id="7063074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063079">ProtoMinor</span><span class="op" id="7063089">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063097">1</span><span class="op" id="7063098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063103">Header</span><span class="op" id="7063109">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7063121"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7063127">{</span><span class="op" id="7063128">}</span><span class="op" id="7063129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063134">Close</span><span class="op" id="7063139">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7063152">true</span><span class="op" id="7063156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063161">TransferEncoding</span><span class="op" id="7063177">:</span>&nbsp;<span class="op" id="7063179">[</span><span class="op" id="7063180">]</span><span class="builtintype" id="7063181">string</span><span class="op" id="7063187">{</span><span class="string" id="7063188">&#34;chunked&#34;</span><span class="op" id="7063197">}</span><span class="op" id="7063198">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063202">}</span><span class="op" id="7063203">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063208">Body</span><span class="op" id="7063212">:</span>&nbsp;<span class="op" id="7063214">[</span><span class="op" id="7063215">]</span><span class="builtintype" id="7063216">byte</span><span class="op" id="7063220">(</span><span class="string" id="7063221">&#34;abcdef&#34;</span><span class="op" id="7063229">)</span><span class="op" id="7063230">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063235">WantWrite</span><span class="op" id="7063244">:</span>&nbsp;<span class="string" id="7063246">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7063274">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063279">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7063306">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063311">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7063349">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063354">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7063378">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063383">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7063420">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063425"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7063430">(</span><span class="string" id="7063431">&#34;abcdef&#34;</span><span class="op" id="7063439">)</span>&nbsp;<span class="op" id="7063441">+</span>&nbsp;<span class="ident" id="7063443"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7063448">(</span><span class="string" id="7063449">&#34;&#34;</span><span class="op" id="7063451">)</span><span class="op" id="7063452">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063457">WantProxy</span><span class="op" id="7063466">:</span>&nbsp;<span class="string" id="7063468">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7063517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063522">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7063549">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063554">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7063592">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063597">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7063621">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7063626">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7063663">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063668"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7063673">(</span><span class="string" id="7063674">&#34;abcdef&#34;</span><span class="op" id="7063682">)</span>&nbsp;<span class="op" id="7063684">+</span>&nbsp;<span class="ident" id="7063686"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7063691">(</span><span class="string" id="7063692">&#34;&#34;</span><span class="op" id="7063694">)</span><span class="op" id="7063695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063698">}</span><span class="op" id="7063699">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7063703">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063758">Req</span><span class="op" id="7063761">:</span>&nbsp;<span class="ident" id="7063763"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7063770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063775">Method</span><span class="op" id="7063781">:</span>&nbsp;<span class="string" id="7063783">&#34;POST&#34;</span><span class="op" id="7063789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063794">URL</span><span class="op" id="7063797">:</span>&nbsp;<span class="op" id="7063799">&amp;</span><span class="ident" id="7063800"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7063803">.</span><span class="ident" id="7063804">URL</span><span class="op" id="7063807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063813">Scheme</span><span class="op" id="7063819">:</span>&nbsp;<span class="string" id="7063821">&#34;http&#34;</span><span class="op" id="7063827">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063833">Host</span><span class="op" id="7063837">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7063841">&#34;www.google.com&#34;</span><span class="op" id="7063857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063863">Path</span><span class="op" id="7063867">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7063871">&#34;/search&#34;</span><span class="op" id="7063880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7063885">}</span><span class="op" id="7063886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063891">ProtoMajor</span><span class="op" id="7063901">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063906">1</span><span class="op" id="7063907">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063912">ProtoMinor</span><span class="op" id="7063922">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7063927">1</span><span class="op" id="7063928">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063933">Header</span><span class="op" id="7063939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7063948"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7063954">{</span><span class="op" id="7063955">}</span><span class="op" id="7063956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063961">Close</span><span class="op" id="7063966">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7063976">true</span><span class="op" id="7063980">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7063985">ContentLength</span><span class="op" id="7063998">:</span>&nbsp;<span class="num" id="7064000">6</span><span class="op" id="7064001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064005">}</span><span class="op" id="7064006">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064011">Body</span><span class="op" id="7064015">:</span>&nbsp;<span class="op" id="7064017">[</span><span class="op" id="7064018">]</span><span class="builtintype" id="7064019">byte</span><span class="op" id="7064023">(</span><span class="string" id="7064024">&#34;abcdef&#34;</span><span class="op" id="7064032">)</span><span class="op" id="7064033">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064038">WantWrite</span><span class="op" id="7064047">:</span>&nbsp;<span class="string" id="7064049">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064077">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064082">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7064109">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064114">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7064152">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064157">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7064181">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064186">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7064210">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064215">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7064222">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064227">&#34;abcdef&#34;</span><span class="op" id="7064235">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064240">WantProxy</span><span class="op" id="7064249">:</span>&nbsp;<span class="string" id="7064251">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064300">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064305">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7064332">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064337">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7064375">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064380">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="7064404">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064409">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7064433">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064438">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7064445">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064450">&#34;abcdef&#34;</span><span class="op" id="7064458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064461">}</span><span class="op" id="7064462">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7064466">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064519">Req</span><span class="op" id="7064522">:</span>&nbsp;<span class="ident" id="7064524"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7064531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064536">Method</span><span class="op" id="7064542">:</span>&nbsp;<span class="string" id="7064544">&#34;POST&#34;</span><span class="op" id="7064550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064555">URL</span><span class="op" id="7064558">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7064563"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7064575">(</span><span class="string" id="7064576">&#34;http://example.com/&#34;</span><span class="op" id="7064597">)</span><span class="op" id="7064598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064603">Host</span><span class="op" id="7064607">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7064611">&#34;example.com&#34;</span><span class="op" id="7064624">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064629">Header</span><span class="op" id="7064635">:</span>&nbsp;<span class="ident" id="7064637"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7064643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064649">&#34;Content-Length&#34;</span><span class="op" id="7064665">:</span>&nbsp;<span class="op" id="7064667">[</span><span class="op" id="7064668">]</span><span class="builtintype" id="7064669">string</span><span class="op" id="7064675">{</span><span class="string" id="7064676">&#34;10&#34;</span><span class="op" id="7064680">}</span><span class="op" id="7064681">,</span>&nbsp;<span class="comment" id="7064683">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064697">}</span><span class="op" id="7064698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064703">ContentLength</span><span class="op" id="7064716">:</span>&nbsp;<span class="num" id="7064718">6</span><span class="op" id="7064719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7064723">}</span><span class="op" id="7064724">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064729">Body</span><span class="op" id="7064733">:</span>&nbsp;<span class="op" id="7064735">[</span><span class="op" id="7064736">]</span><span class="builtintype" id="7064737">byte</span><span class="op" id="7064741">(</span><span class="string" id="7064742">&#34;abcdef&#34;</span><span class="op" id="7064750">)</span><span class="op" id="7064751">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064756">WantWrite</span><span class="op" id="7064765">:</span>&nbsp;<span class="string" id="7064767">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064789">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064794">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7064818">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064823">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7064861">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064866">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7064890">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064895">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7064902">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064907">&#34;abcdef&#34;</span><span class="op" id="7064915">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7064920">WantProxy</span><span class="op" id="7064929">:</span>&nbsp;<span class="string" id="7064931">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7064971">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7064976">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7065000">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065005">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7065043">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065048">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="7065072">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065077">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="7065084">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065089">&#34;abcdef&#34;</span><span class="op" id="7065097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065100">}</span><span class="op" id="7065101">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065105">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065129">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065133">Req</span><span class="op" id="7065136">:</span>&nbsp;<span class="ident" id="7065138"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7065145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065150">Method</span><span class="op" id="7065156">:</span>&nbsp;<span class="string" id="7065158">&#34;GET&#34;</span><span class="op" id="7065163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065168">URL</span><span class="op" id="7065171">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7065176"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7065188">(</span><span class="string" id="7065189">&#34;/search&#34;</span><span class="op" id="7065198">)</span><span class="op" id="7065199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065204">Host</span><span class="op" id="7065208">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7065212">&#34;www.google.com&#34;</span><span class="op" id="7065228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065232">}</span><span class="op" id="7065233">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065238">WantWrite</span><span class="op" id="7065247">:</span>&nbsp;<span class="string" id="7065249">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7065276">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065281">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7065308">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065313">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7065351">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065356">&#34;\r\n&#34;</span><span class="op" id="7065362">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065365">}</span><span class="op" id="7065366">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065370">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065428">Req</span><span class="op" id="7065431">:</span>&nbsp;<span class="ident" id="7065433"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7065440">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065445">Method</span><span class="op" id="7065451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7065460">&#34;POST&#34;</span><span class="op" id="7065466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065471">URL</span><span class="op" id="7065474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7065486"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7065498">(</span><span class="string" id="7065499">&#34;/&#34;</span><span class="op" id="7065502">)</span><span class="op" id="7065503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065508">Host</span><span class="op" id="7065512">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7065523">&#34;example.com&#34;</span><span class="op" id="7065536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065541">ProtoMajor</span><span class="op" id="7065551">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7065556">1</span><span class="op" id="7065557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065562">ProtoMinor</span><span class="op" id="7065572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7065577">1</span><span class="op" id="7065578">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065583">ContentLength</span><span class="op" id="7065596">:</span>&nbsp;<span class="num" id="7065598">0</span><span class="op" id="7065599">,</span>&nbsp;<span class="comment" id="7065601">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7065626">}</span><span class="op" id="7065627">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065632">Body</span><span class="op" id="7065636">:</span>&nbsp;<span class="keyword" id="7065638">func</span><span class="op" id="7065642">(</span><span class="op" id="7065643">)</span>&nbsp;<span class="ident" id="7065645"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7065647">.</span><span class="ident" id="7065648">ReadCloser</span>&nbsp;<span class="op" id="7065659">{</span>&nbsp;<span class="keyword" id="7065661">return</span>&nbsp;<span class="ident" id="7065668"><a href="/net/http/requestwrite_test.go.html#7060177">ioutil</a></span><span class="op" id="7065674">.</span><span class="ident" id="7065675">NopCloser</span><span class="op" id="7065684">(</span><span class="ident" id="7065685"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7065687">.</span><span class="ident" id="7065688">LimitReader</span><span class="op" id="7065699">(</span><span class="ident" id="7065700"><a href="/net/http/requestwrite_test.go.html#7060201">strings</a></span><span class="op" id="7065707">.</span><span class="ident" id="7065708">NewReader</span><span class="op" id="7065717">(</span><span class="string" id="7065718">&#34;xx&#34;</span><span class="op" id="7065722">)</span><span class="op" id="7065723">,</span>&nbsp;<span class="num" id="7065725">0</span><span class="op" id="7065726">)</span><span class="op" id="7065727">)</span>&nbsp;<span class="op" id="7065729">}</span><span class="op" id="7065730">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065735">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065803">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7065857">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7065903">WantWrite</span><span class="op" id="7065912">:</span>&nbsp;<span class="string" id="7065914">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7065936">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065941">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7065965">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7065970">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7066008">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066013">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7066037">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066042">&#34;\r\n&#34;</span><span class="op" id="7066048">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066053">WantProxy</span><span class="op" id="7066062">:</span>&nbsp;<span class="string" id="7066064">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7066086">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066091">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7066115">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066120">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7066158">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066163">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="7066187">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066192">&#34;\r\n&#34;</span><span class="op" id="7066198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066201">}</span><span class="op" id="7066202">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7066206">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066264">Req</span><span class="op" id="7066267">:</span>&nbsp;<span class="ident" id="7066269"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7066276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066281">Method</span><span class="op" id="7066287">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7066296">&#34;POST&#34;</span><span class="op" id="7066302">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066307">URL</span><span class="op" id="7066310">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7066322"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7066334">(</span><span class="string" id="7066335">&#34;/&#34;</span><span class="op" id="7066338">)</span><span class="op" id="7066339">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066344">Host</span><span class="op" id="7066348">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7066359">&#34;example.com&#34;</span><span class="op" id="7066372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066377">ProtoMajor</span><span class="op" id="7066387">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7066392">1</span><span class="op" id="7066393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066398">ProtoMinor</span><span class="op" id="7066408">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7066413">1</span><span class="op" id="7066414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066419">ContentLength</span><span class="op" id="7066432">:</span>&nbsp;<span class="num" id="7066434">0</span><span class="op" id="7066435">,</span>&nbsp;<span class="comment" id="7066437">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066462">}</span><span class="op" id="7066463">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066468">Body</span><span class="op" id="7066472">:</span>&nbsp;<span class="keyword" id="7066474">func</span><span class="op" id="7066478">(</span><span class="op" id="7066479">)</span>&nbsp;<span class="ident" id="7066481"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7066483">.</span><span class="ident" id="7066484">ReadCloser</span>&nbsp;<span class="op" id="7066495">{</span>&nbsp;<span class="keyword" id="7066497">return</span>&nbsp;<span class="ident" id="7066504"><a href="/net/http/requestwrite_test.go.html#7060177">ioutil</a></span><span class="op" id="7066510">.</span><span class="ident" id="7066511">NopCloser</span><span class="op" id="7066520">(</span><span class="ident" id="7066521"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7066523">.</span><span class="ident" id="7066524">LimitReader</span><span class="op" id="7066535">(</span><span class="ident" id="7066536"><a href="/net/http/requestwrite_test.go.html#7060201">strings</a></span><span class="op" id="7066543">.</span><span class="ident" id="7066544">NewReader</span><span class="op" id="7066553">(</span><span class="string" id="7066554">&#34;xx&#34;</span><span class="op" id="7066558">)</span><span class="op" id="7066559">,</span>&nbsp;<span class="num" id="7066561">1</span><span class="op" id="7066562">)</span><span class="op" id="7066563">)</span>&nbsp;<span class="op" id="7066565">}</span><span class="op" id="7066566">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066571">WantWrite</span><span class="op" id="7066580">:</span>&nbsp;<span class="string" id="7066582">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7066604">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066609">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7066633">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066638">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7066676">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066681">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7066718">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066723"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7066728">(</span><span class="string" id="7066729">&#34;x&#34;</span><span class="op" id="7066732">)</span>&nbsp;<span class="op" id="7066734">+</span>&nbsp;<span class="ident" id="7066736"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7066741">(</span><span class="string" id="7066742">&#34;&#34;</span><span class="op" id="7066744">)</span><span class="op" id="7066745">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066750">WantProxy</span><span class="op" id="7066759">:</span>&nbsp;<span class="string" id="7066761">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7066783">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066788">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="7066812">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066817">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7066855">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7066860">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7066897">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066902"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7066907">(</span><span class="string" id="7066908">&#34;x&#34;</span><span class="op" id="7066911">)</span>&nbsp;<span class="op" id="7066913">+</span>&nbsp;<span class="ident" id="7066915"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7066920">(</span><span class="string" id="7066921">&#34;&#34;</span><span class="op" id="7066923">)</span><span class="op" id="7066924">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066927">}</span><span class="op" id="7066928">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7066932">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7066990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7066994">Req</span><span class="op" id="7066997">:</span>&nbsp;<span class="ident" id="7066999"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7067006">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067011">Method</span><span class="op" id="7067017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067026">&#34;POST&#34;</span><span class="op" id="7067032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067037">URL</span><span class="op" id="7067040">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7067052"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7067064">(</span><span class="string" id="7067065">&#34;/&#34;</span><span class="op" id="7067068">)</span><span class="op" id="7067069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067074">Host</span><span class="op" id="7067078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067089">&#34;example.com&#34;</span><span class="op" id="7067102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067107">ProtoMajor</span><span class="op" id="7067117">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067122">1</span><span class="op" id="7067123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067128">ProtoMinor</span><span class="op" id="7067138">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067143">1</span><span class="op" id="7067144">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067149">ContentLength</span><span class="op" id="7067162">:</span>&nbsp;<span class="num" id="7067164">10</span><span class="op" id="7067166">,</span>&nbsp;<span class="comment" id="7067168">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067210">}</span><span class="op" id="7067211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067215">Body</span><span class="op" id="7067219">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7067226">[</span><span class="op" id="7067227">]</span><span class="builtintype" id="7067228">byte</span><span class="op" id="7067232">(</span><span class="string" id="7067233">&#34;12345&#34;</span><span class="op" id="7067240">)</span><span class="op" id="7067241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067245">WantError</span><span class="op" id="7067254">:</span>&nbsp;<span class="ident" id="7067256"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7067262">.</span><span class="ident" id="7067263">New</span><span class="op" id="7067266">(</span><span class="string" id="7067267">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="7067310">)</span><span class="op" id="7067311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067314">}</span><span class="op" id="7067315">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067319">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067381">Req</span><span class="op" id="7067384">:</span>&nbsp;<span class="ident" id="7067386"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7067393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067398">Method</span><span class="op" id="7067404">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067413">&#34;POST&#34;</span><span class="op" id="7067419">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067424">URL</span><span class="op" id="7067427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7067439"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7067451">(</span><span class="string" id="7067452">&#34;/&#34;</span><span class="op" id="7067455">)</span><span class="op" id="7067456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067461">Host</span><span class="op" id="7067465">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067476">&#34;example.com&#34;</span><span class="op" id="7067489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067494">ProtoMajor</span><span class="op" id="7067504">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067509">1</span><span class="op" id="7067510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067515">ProtoMinor</span><span class="op" id="7067525">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067530">1</span><span class="op" id="7067531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067536">ContentLength</span><span class="op" id="7067549">:</span>&nbsp;<span class="num" id="7067551">4</span><span class="op" id="7067552">,</span>&nbsp;<span class="comment" id="7067554">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067598">}</span><span class="op" id="7067599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067603">Body</span><span class="op" id="7067607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7067614">[</span><span class="op" id="7067615">]</span><span class="builtintype" id="7067616">byte</span><span class="op" id="7067620">(</span><span class="string" id="7067621">&#34;12345678&#34;</span><span class="op" id="7067631">)</span><span class="op" id="7067632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067636">WantError</span><span class="op" id="7067645">:</span>&nbsp;<span class="ident" id="7067647"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7067653">.</span><span class="ident" id="7067654">New</span><span class="op" id="7067657">(</span><span class="string" id="7067658">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="7067700">)</span><span class="op" id="7067701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067704">}</span><span class="op" id="7067705">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7067709">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067762">Req</span><span class="op" id="7067765">:</span>&nbsp;<span class="ident" id="7067767"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7067774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067779">Method</span><span class="op" id="7067785">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067794">&#34;POST&#34;</span><span class="op" id="7067800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067805">URL</span><span class="op" id="7067808">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7067820"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7067832">(</span><span class="string" id="7067833">&#34;/&#34;</span><span class="op" id="7067836">)</span><span class="op" id="7067837">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067842">Host</span><span class="op" id="7067846">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7067857">&#34;example.com&#34;</span><span class="op" id="7067870">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067875">ProtoMajor</span><span class="op" id="7067885">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067890">1</span><span class="op" id="7067891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067896">ProtoMinor</span><span class="op" id="7067906">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7067911">1</span><span class="op" id="7067912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067917">ContentLength</span><span class="op" id="7067930">:</span>&nbsp;<span class="num" id="7067932">5</span><span class="op" id="7067933">,</span>&nbsp;<span class="comment" id="7067935">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7067964">}</span><span class="op" id="7067965">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7067969">WantError</span><span class="op" id="7067978">:</span>&nbsp;<span class="ident" id="7067980"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7067986">.</span><span class="ident" id="7067987">New</span><span class="op" id="7067990">(</span><span class="string" id="7067991">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="7068036">)</span><span class="op" id="7068037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068040">}</span><span class="op" id="7068041">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068045">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068125">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068129">Req</span><span class="op" id="7068132">:</span>&nbsp;<span class="ident" id="7068134"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7068141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068146">Method</span><span class="op" id="7068152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7068161">&#34;POST&#34;</span><span class="op" id="7068167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068172">URL</span><span class="op" id="7068175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7068187"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7068199">(</span><span class="string" id="7068200">&#34;/&#34;</span><span class="op" id="7068203">)</span><span class="op" id="7068204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068209">Host</span><span class="op" id="7068213">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7068224">&#34;example.com&#34;</span><span class="op" id="7068237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068242">ProtoMajor</span><span class="op" id="7068252">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068257">1</span><span class="op" id="7068258">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068263">ProtoMinor</span><span class="op" id="7068273">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068278">1</span><span class="op" id="7068279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068284">ContentLength</span><span class="op" id="7068297">:</span>&nbsp;<span class="num" id="7068299">0</span><span class="op" id="7068300">,</span>&nbsp;<span class="comment" id="7068302">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068327">}</span><span class="op" id="7068328">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068333">Body</span><span class="op" id="7068337">:</span>&nbsp;<span class="keyword" id="7068339">func</span><span class="op" id="7068343">(</span><span class="op" id="7068344">)</span>&nbsp;<span class="ident" id="7068346"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7068348">.</span><span class="ident" id="7068349">ReadCloser</span>&nbsp;<span class="op" id="7068360">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068365">err</span>&nbsp;<span class="op" id="7068369">:=</span>&nbsp;<span class="ident" id="7068372"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7068378">.</span><span class="ident" id="7068379">New</span><span class="op" id="7068382">(</span><span class="string" id="7068383">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7068404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068409">errReader</span>&nbsp;<span class="op" id="7068419">:=</span>&nbsp;<span class="op" id="7068422">&amp;</span><span class="ident" id="7068423"><a href="/net/http/transfer.go.html#3471589">errorReader</a></span><span class="op" id="7068434">{</span><span class="ident" id="7068435"><a href="/net/http/requestwrite_test.go.html#7068365">err</a></span><span class="op" id="7068438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068443">return</span>&nbsp;<span class="ident" id="7068450"><a href="/net/http/requestwrite_test.go.html#7060177">ioutil</a></span><span class="op" id="7068456">.</span><span class="ident" id="7068457">NopCloser</span><span class="op" id="7068466">(</span><span class="ident" id="7068467"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7068469">.</span><span class="ident" id="7068470">MultiReader</span><span class="op" id="7068481">(</span><span class="ident" id="7068482"><a href="/net/http/requestwrite_test.go.html#7060201">strings</a></span><span class="op" id="7068489">.</span><span class="ident" id="7068490">NewReader</span><span class="op" id="7068499">(</span><span class="string" id="7068500">&#34;x&#34;</span><span class="op" id="7068503">)</span><span class="op" id="7068504">,</span>&nbsp;<span class="ident" id="7068506"><a href="/net/http/requestwrite_test.go.html#7068409">errReader</a></span><span class="op" id="7068515">)</span><span class="op" id="7068516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068520">}</span><span class="op" id="7068521">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068526">WantError</span><span class="op" id="7068535">:</span>&nbsp;<span class="ident" id="7068537"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7068543">.</span><span class="ident" id="7068544">New</span><span class="op" id="7068547">(</span><span class="string" id="7068548">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7068569">)</span><span class="op" id="7068570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068573">}</span><span class="op" id="7068574">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7068578">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068654">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068658">Req</span><span class="op" id="7068661">:</span>&nbsp;<span class="ident" id="7068663"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7068670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068675">Method</span><span class="op" id="7068681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7068690">&#34;POST&#34;</span><span class="op" id="7068696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068701">URL</span><span class="op" id="7068704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7068716"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7068728">(</span><span class="string" id="7068729">&#34;/&#34;</span><span class="op" id="7068732">)</span><span class="op" id="7068733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068738">Host</span><span class="op" id="7068742">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7068753">&#34;example.com&#34;</span><span class="op" id="7068766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068771">ProtoMajor</span><span class="op" id="7068781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068786">1</span><span class="op" id="7068787">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068792">ProtoMinor</span><span class="op" id="7068802">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7068807">1</span><span class="op" id="7068808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068813">ContentLength</span><span class="op" id="7068826">:</span>&nbsp;<span class="num" id="7068828">0</span><span class="op" id="7068829">,</span>&nbsp;<span class="comment" id="7068831">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7068856">}</span><span class="op" id="7068857">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068862">Body</span><span class="op" id="7068866">:</span>&nbsp;<span class="keyword" id="7068868">func</span><span class="op" id="7068872">(</span><span class="op" id="7068873">)</span>&nbsp;<span class="ident" id="7068875"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7068877">.</span><span class="ident" id="7068878">ReadCloser</span>&nbsp;<span class="op" id="7068889">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068894">err</span>&nbsp;<span class="op" id="7068898">:=</span>&nbsp;<span class="ident" id="7068901"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7068907">.</span><span class="ident" id="7068908">New</span><span class="op" id="7068911">(</span><span class="string" id="7068912">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7068933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7068938">errReader</span>&nbsp;<span class="op" id="7068948">:=</span>&nbsp;<span class="op" id="7068951">&amp;</span><span class="ident" id="7068952"><a href="/net/http/transfer.go.html#3471589">errorReader</a></span><span class="op" id="7068963">{</span><span class="ident" id="7068964"><a href="/net/http/requestwrite_test.go.html#7068894">err</a></span><span class="op" id="7068967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7068972">return</span>&nbsp;<span class="ident" id="7068979"><a href="/net/http/requestwrite_test.go.html#7060177">ioutil</a></span><span class="op" id="7068985">.</span><span class="ident" id="7068986">NopCloser</span><span class="op" id="7068995">(</span><span class="ident" id="7068996"><a href="/net/http/requestwrite_test.go.html#7068938">errReader</a></span><span class="op" id="7069005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069009">}</span><span class="op" id="7069010">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069015">WantError</span><span class="op" id="7069024">:</span>&nbsp;<span class="ident" id="7069026"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7069032">.</span><span class="ident" id="7069033">New</span><span class="op" id="7069036">(</span><span class="string" id="7069037">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="7069058">)</span><span class="op" id="7069059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069062">}</span><span class="op" id="7069063">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069067">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069150">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069188">Req</span><span class="op" id="7069191">:</span>&nbsp;<span class="ident" id="7069193"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7069200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069205">Method</span><span class="op" id="7069211">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7069217">&#34;GET&#34;</span><span class="op" id="7069222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069227">URL</span><span class="op" id="7069230">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7069239"><a href="/net/http/requestwrite_test.go.html#7073776">mustParseURL</a></span><span class="op" id="7069251">(</span><span class="string" id="7069252">&#34;/foo&#34;</span><span class="op" id="7069258">)</span><span class="op" id="7069259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069264">ProtoMajor</span><span class="op" id="7069274">:</span>&nbsp;<span class="num" id="7069276">1</span><span class="op" id="7069277">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069282">ProtoMinor</span><span class="op" id="7069292">:</span>&nbsp;<span class="num" id="7069294">0</span><span class="op" id="7069295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069300">Header</span><span class="op" id="7069306">:</span>&nbsp;<span class="ident" id="7069308"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7069314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069320">&#34;X-Foo&#34;</span><span class="op" id="7069327">:</span>&nbsp;<span class="op" id="7069329">[</span><span class="op" id="7069330">]</span><span class="builtintype" id="7069331">string</span><span class="op" id="7069337">{</span><span class="string" id="7069338">&#34;X-Bar&#34;</span><span class="op" id="7069345">}</span><span class="op" id="7069346">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069351">}</span><span class="op" id="7069352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069356">}</span><span class="op" id="7069357">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069362">WantWrite</span><span class="op" id="7069371">:</span>&nbsp;<span class="string" id="7069373">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7069397">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069402">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7069415">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069420">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7069458">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069463">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="7069485">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069488">}</span><span class="op" id="7069489">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069493">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069549">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069589">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7069643">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069684">Req</span><span class="op" id="7069687">:</span>&nbsp;<span class="ident" id="7069689"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7069696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069701">Method</span><span class="op" id="7069707">:</span>&nbsp;<span class="string" id="7069709">&#34;GET&#34;</span><span class="op" id="7069714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069719">Host</span><span class="op" id="7069723">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7069727">&#34;&#34;</span><span class="op" id="7069729">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069734">URL</span><span class="op" id="7069737">:</span>&nbsp;<span class="op" id="7069739">&amp;</span><span class="ident" id="7069740"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7069743">.</span><span class="ident" id="7069744">URL</span><span class="op" id="7069747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069753">Scheme</span><span class="op" id="7069759">:</span>&nbsp;<span class="string" id="7069761">&#34;http&#34;</span><span class="op" id="7069767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069773">Host</span><span class="op" id="7069777">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7069781">&#34;&#34;</span><span class="op" id="7069783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069789">Path</span><span class="op" id="7069793">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7069797">&#34;/search&#34;</span><span class="op" id="7069806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069811">}</span><span class="op" id="7069812">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069817">ProtoMajor</span><span class="op" id="7069827">:</span>&nbsp;<span class="num" id="7069829">1</span><span class="op" id="7069830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069835">ProtoMinor</span><span class="op" id="7069845">:</span>&nbsp;<span class="num" id="7069847">1</span><span class="op" id="7069848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069853">Header</span><span class="op" id="7069859">:</span>&nbsp;<span class="ident" id="7069861"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7069867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069873">&#34;Host&#34;</span><span class="op" id="7069879">:</span>&nbsp;<span class="op" id="7069881">[</span><span class="op" id="7069882">]</span><span class="builtintype" id="7069883">string</span><span class="op" id="7069889">{</span><span class="string" id="7069890">&#34;bad.example.com&#34;</span><span class="op" id="7069907">}</span><span class="op" id="7069908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069913">}</span><span class="op" id="7069914">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7069918">}</span><span class="op" id="7069919">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7069924">WantWrite</span><span class="op" id="7069933">:</span>&nbsp;<span class="string" id="7069935">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7069962">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069967">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="7069980">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7069985">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7070026">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070029">}</span><span class="op" id="7070030">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7070034">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070084">Req</span><span class="op" id="7070087">:</span>&nbsp;<span class="ident" id="7070089"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7070096">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070101">Method</span><span class="op" id="7070107">:</span>&nbsp;<span class="string" id="7070109">&#34;GET&#34;</span><span class="op" id="7070114">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070119">URL</span><span class="op" id="7070122">:</span>&nbsp;<span class="op" id="7070124">&amp;</span><span class="ident" id="7070125"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7070128">.</span><span class="ident" id="7070129">URL</span><span class="op" id="7070132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070138">Scheme</span><span class="op" id="7070144">:</span>&nbsp;<span class="string" id="7070146">&#34;http&#34;</span><span class="op" id="7070152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070158">Host</span><span class="op" id="7070162">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7070166">&#34;www.google.com&#34;</span><span class="op" id="7070182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070188">Opaque</span><span class="op" id="7070194">:</span>&nbsp;<span class="string" id="7070196">&#34;/%2F/%2F/&#34;</span><span class="op" id="7070207">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070212">}</span><span class="op" id="7070213">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070218">ProtoMajor</span><span class="op" id="7070228">:</span>&nbsp;<span class="num" id="7070230">1</span><span class="op" id="7070231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070236">ProtoMinor</span><span class="op" id="7070246">:</span>&nbsp;<span class="num" id="7070248">1</span><span class="op" id="7070249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070254">Header</span><span class="op" id="7070260">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7070266"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7070272">{</span><span class="op" id="7070273">}</span><span class="op" id="7070274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070278">}</span><span class="op" id="7070279">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070284">WantWrite</span><span class="op" id="7070293">:</span>&nbsp;<span class="string" id="7070295">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7070324">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070329">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7070356">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070361">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7070402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070405">}</span><span class="op" id="7070406">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7070410">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070460">Req</span><span class="op" id="7070463">:</span>&nbsp;<span class="ident" id="7070465"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7070472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070477">Method</span><span class="op" id="7070483">:</span>&nbsp;<span class="string" id="7070485">&#34;GET&#34;</span><span class="op" id="7070490">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070495">URL</span><span class="op" id="7070498">:</span>&nbsp;<span class="op" id="7070500">&amp;</span><span class="ident" id="7070501"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7070504">.</span><span class="ident" id="7070505">URL</span><span class="op" id="7070508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070514">Scheme</span><span class="op" id="7070520">:</span>&nbsp;<span class="string" id="7070522">&#34;http&#34;</span><span class="op" id="7070528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070534">Host</span><span class="op" id="7070538">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7070542">&#34;x.google.com&#34;</span><span class="op" id="7070556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070562">Opaque</span><span class="op" id="7070568">:</span>&nbsp;<span class="string" id="7070570">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="7070595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070600">}</span><span class="op" id="7070601">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070606">ProtoMajor</span><span class="op" id="7070616">:</span>&nbsp;<span class="num" id="7070618">1</span><span class="op" id="7070619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070624">ProtoMinor</span><span class="op" id="7070634">:</span>&nbsp;<span class="num" id="7070636">1</span><span class="op" id="7070637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070642">Header</span><span class="op" id="7070648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7070654"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7070660">{</span><span class="op" id="7070661">}</span><span class="op" id="7070662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070666">}</span><span class="op" id="7070667">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070672">WantWrite</span><span class="op" id="7070681">:</span>&nbsp;<span class="string" id="7070683">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7070731">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070736">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7070761">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7070766">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="7070807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070810">}</span><span class="op" id="7070811">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7070815">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070871">Req</span><span class="op" id="7070874">:</span>&nbsp;<span class="ident" id="7070876"><a href="/net/http/request.go.html#3366486">Request</a></span><span class="op" id="7070883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070888">Method</span><span class="op" id="7070894">:</span>&nbsp;<span class="string" id="7070896">&#34;GET&#34;</span><span class="op" id="7070901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070906">URL</span><span class="op" id="7070909">:</span>&nbsp;<span class="op" id="7070911">&amp;</span><span class="ident" id="7070912"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7070915">.</span><span class="ident" id="7070916">URL</span><span class="op" id="7070919">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070925">Scheme</span><span class="op" id="7070931">:</span>&nbsp;<span class="string" id="7070933">&#34;http&#34;</span><span class="op" id="7070939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070945">Host</span><span class="op" id="7070949">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7070953">&#34;www.google.com&#34;</span><span class="op" id="7070969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070975">Path</span><span class="op" id="7070979">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7070983">&#34;/&#34;</span><span class="op" id="7070986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7070991">}</span><span class="op" id="7070992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7070997">Proto</span><span class="op" id="7071002">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7071009">&#34;HTTP/1.1&#34;</span><span class="op" id="7071019">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071024">ProtoMajor</span><span class="op" id="7071034">:</span>&nbsp;<span class="num" id="7071036">1</span><span class="op" id="7071037">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071042">ProtoMinor</span><span class="op" id="7071052">:</span>&nbsp;<span class="num" id="7071054">1</span><span class="op" id="7071055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071060">Header</span><span class="op" id="7071066">:</span>&nbsp;<span class="ident" id="7071068"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7071074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071080">&#34;ALL-CAPS&#34;</span><span class="op" id="7071090">:</span>&nbsp;<span class="op" id="7071092">{</span><span class="string" id="7071093">&#34;x&#34;</span><span class="op" id="7071096">}</span><span class="op" id="7071097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071102">}</span><span class="op" id="7071103">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071107">}</span><span class="op" id="7071108">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071113">WantWrite</span><span class="op" id="7071122">:</span>&nbsp;<span class="string" id="7071124">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7071145">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071150">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="7071177">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071182">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7071220">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071225">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="7071243">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7071248">&#34;\r\n&#34;</span><span class="op" id="7071254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071257">}</span><span class="op" id="7071258">,</span><br>
<span class="lineno"></span><span class="op" id="7071260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="7071263">func</span>&nbsp;<span class="ident" id="7071268">TestRequestWrite</span><span class="op" id="7071284">(</span><span class="ident" id="7071285">t</span>&nbsp;<span class="op" id="7071287">*</span><span class="ident" id="7071288"><a href="/net/http/requestwrite_test.go.html#7060212">testing</a></span><span class="op" id="7071295">.</span><span class="ident" id="7071296">T</span><span class="op" id="7071297">)</span>&nbsp;<span class="op" id="7071299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071302">for</span>&nbsp;<span class="ident" id="7071306">i</span>&nbsp;<span class="op" id="7071308">:=</span>&nbsp;<span class="keyword" id="7071311">range</span>&nbsp;<span class="ident" id="7071317"><a href="/net/http/requestwrite_test.go.html#7060539">reqWriteTests</a></span>&nbsp;<span class="op" id="7071331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071335">tt</span>&nbsp;<span class="op" id="7071338">:=</span>&nbsp;<span class="op" id="7071341">&amp;</span><span class="ident" id="7071342"><a href="/net/http/requestwrite_test.go.html#7060539">reqWriteTests</a></span><span class="op" id="7071355">[</span><span class="ident" id="7071356"><a href="/net/http/requestwrite_test.go.html#7071306">i</a></span><span class="op" id="7071357">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071362">setBody</span>&nbsp;<span class="op" id="7071370">:=</span>&nbsp;<span class="keyword" id="7071373">func</span><span class="op" id="7071377">(</span><span class="op" id="7071378">)</span>&nbsp;<span class="op" id="7071380">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071385">if</span>&nbsp;<span class="ident" id="7071388"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071390">.</span><span class="ident" id="7071391">Body</span>&nbsp;<span class="op" id="7071396">==</span>&nbsp;<span class="ident" id="7071399">nil</span>&nbsp;<span class="op" id="7071403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071409">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071424">switch</span>&nbsp;<span class="ident" id="7071431">b</span>&nbsp;<span class="op" id="7071433">:=</span>&nbsp;<span class="ident" id="7071436"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071438">.</span><span class="ident" id="7071439">Body</span><span class="op" id="7071443">.</span><span class="op" id="7071444">(</span><span class="keyword" id="7071445">type</span><span class="op" id="7071449">)</span>&nbsp;<span class="op" id="7071451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071456">case</span>&nbsp;<span class="op" id="7071461">[</span><span class="op" id="7071462">]</span><span class="builtintype" id="7071463">byte</span><span class="op" id="7071467">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071473"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071475">.</span><span class="ident" id="7071476">Req</span><span class="op" id="7071479">.</span><span class="ident" id="7071480">Body</span>&nbsp;<span class="op" id="7071485">=</span>&nbsp;<span class="ident" id="7071487"><a href="/net/http/requestwrite_test.go.html#7060177">ioutil</a></span><span class="op" id="7071493">.</span><span class="ident" id="7071494">NopCloser</span><span class="op" id="7071503">(</span><span class="ident" id="7071504"><a href="/net/http/requestwrite_test.go.html#7060145">bytes</a></span><span class="op" id="7071509">.</span><span class="ident" id="7071510">NewReader</span><span class="op" id="7071519">(</span><span class="ident" id="7071520"><a href="/net/http/requestwrite_test.go.html#7071431">b</a></span><span class="op" id="7071521">)</span><span class="op" id="7071522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071527">case</span>&nbsp;<span class="keyword" id="7071532">func</span><span class="op" id="7071536">(</span><span class="op" id="7071537">)</span>&nbsp;<span class="ident" id="7071539"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7071541">.</span><span class="ident" id="7071542">ReadCloser</span><span class="op" id="7071552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071558"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071560">.</span><span class="ident" id="7071561">Req</span><span class="op" id="7071564">.</span><span class="ident" id="7071565">Body</span>&nbsp;<span class="op" id="7071570">=</span>&nbsp;<span class="ident" id="7071572"><a href="/net/http/requestwrite_test.go.html#7071431">b</a></span><span class="op" id="7071573">(</span><span class="op" id="7071574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071583">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071587"><a href="/net/http/requestwrite_test.go.html#7071362">setBody</a></span><span class="op" id="7071594">(</span><span class="op" id="7071595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071599">if</span>&nbsp;<span class="ident" id="7071602"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071604">.</span><span class="ident" id="7071605">Req</span><span class="op" id="7071608">.</span><span class="ident" id="7071609">Header</span>&nbsp;<span class="op" id="7071616">==</span>&nbsp;<span class="ident" id="7071619">nil</span>&nbsp;<span class="op" id="7071623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071628"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071630">.</span><span class="ident" id="7071631">Req</span><span class="op" id="7071634">.</span><span class="ident" id="7071635">Header</span>&nbsp;<span class="op" id="7071642">=</span>&nbsp;<span class="builtinfunc" id="7071644">make</span><span class="op" id="7071648">(</span><span class="ident" id="7071649"><a href="/net/http/header.go.html#3356649">Header</a></span><span class="op" id="7071655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071664">var</span>&nbsp;<span class="ident" id="7071668">braw</span>&nbsp;<span class="ident" id="7071673"><a href="/net/http/requestwrite_test.go.html#7060145">bytes</a></span><span class="op" id="7071678">.</span><span class="ident" id="7071679">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071688">err</span>&nbsp;<span class="op" id="7071692">:=</span>&nbsp;<span class="ident" id="7071695"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071697">.</span><span class="ident" id="7071698">Req</span><span class="op" id="7071701">.</span><span class="ident" id="7071702">Write</span><span class="op" id="7071707">(</span><span class="op" id="7071708">&amp;</span><span class="ident" id="7071709"><a href="/net/http/requestwrite_test.go.html#7071668">braw</a></span><span class="op" id="7071713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071717">if</span>&nbsp;<span class="ident" id="7071720">g</span><span class="op" id="7071721">,</span>&nbsp;<span class="ident" id="7071723">e</span>&nbsp;<span class="op" id="7071725">:=</span>&nbsp;<span class="ident" id="7071728"><a href="/net/http/requestwrite_test.go.html#7060164">fmt</a></span><span class="op" id="7071731">.</span><span class="ident" id="7071732">Sprintf</span><span class="op" id="7071739">(</span><span class="string" id="7071740">&#34;%v&#34;</span><span class="op" id="7071744">,</span>&nbsp;<span class="ident" id="7071746"><a href="/net/http/requestwrite_test.go.html#7071688">err</a></span><span class="op" id="7071749">)</span><span class="op" id="7071750">,</span>&nbsp;<span class="ident" id="7071752"><a href="/net/http/requestwrite_test.go.html#7060164">fmt</a></span><span class="op" id="7071755">.</span><span class="ident" id="7071756">Sprintf</span><span class="op" id="7071763">(</span><span class="string" id="7071764">&#34;%v&#34;</span><span class="op" id="7071768">,</span>&nbsp;<span class="ident" id="7071770"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071772">.</span><span class="ident" id="7071773">WantError</span><span class="op" id="7071782">)</span><span class="op" id="7071783">;</span>&nbsp;<span class="ident" id="7071785"><a href="/net/http/requestwrite_test.go.html#7071720">g</a></span>&nbsp;<span class="op" id="7071787">!=</span>&nbsp;<span class="ident" id="7071790"><a href="/net/http/requestwrite_test.go.html#7071723">e</a></span>&nbsp;<span class="op" id="7071792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071797"><a href="/net/http/requestwrite_test.go.html#7071285">t</a></span><span class="op" id="7071798">.</span><span class="ident" id="7071799">Errorf</span><span class="op" id="7071805">(</span><span class="string" id="7071806">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7071838">,</span>&nbsp;<span class="ident" id="7071840"><a href="/net/http/requestwrite_test.go.html#7071306">i</a></span><span class="op" id="7071841">,</span>&nbsp;<span class="ident" id="7071843"><a href="/net/http/requestwrite_test.go.html#7071720">g</a></span><span class="op" id="7071844">,</span>&nbsp;<span class="ident" id="7071846"><a href="/net/http/requestwrite_test.go.html#7071723">e</a></span><span class="op" id="7071847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071852">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071867">if</span>&nbsp;<span class="ident" id="7071870"><a href="/net/http/requestwrite_test.go.html#7071688">err</a></span>&nbsp;<span class="op" id="7071874">!=</span>&nbsp;<span class="ident" id="7071877">nil</span>&nbsp;<span class="op" id="7071881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071886">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7071897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071902">if</span>&nbsp;<span class="ident" id="7071905"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071907">.</span><span class="ident" id="7071908">WantWrite</span>&nbsp;<span class="op" id="7071918">!=</span>&nbsp;<span class="string" id="7071921">&#34;&#34;</span>&nbsp;<span class="op" id="7071924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071929">sraw</span>&nbsp;<span class="op" id="7071934">:=</span>&nbsp;<span class="ident" id="7071937"><a href="/net/http/requestwrite_test.go.html#7071668">braw</a></span><span class="op" id="7071941">.</span><span class="ident" id="7071942">String</span><span class="op" id="7071948">(</span><span class="op" id="7071949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7071954">if</span>&nbsp;<span class="ident" id="7071957"><a href="/net/http/requestwrite_test.go.html#7071929">sraw</a></span>&nbsp;<span class="op" id="7071962">!=</span>&nbsp;<span class="ident" id="7071965"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7071967">.</span><span class="ident" id="7071968">WantWrite</span>&nbsp;<span class="op" id="7071978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7071984"><a href="/net/http/requestwrite_test.go.html#7071285">t</a></span><span class="op" id="7071985">.</span><span class="ident" id="7071986">Errorf</span><span class="op" id="7071992">(</span><span class="string" id="7071993">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7072030">,</span>&nbsp;<span class="ident" id="7072032"><a href="/net/http/requestwrite_test.go.html#7071306">i</a></span><span class="op" id="7072033">,</span>&nbsp;<span class="ident" id="7072035"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7072037">.</span><span class="ident" id="7072038">WantWrite</span><span class="op" id="7072047">,</span>&nbsp;<span class="ident" id="7072049"><a href="/net/http/requestwrite_test.go.html#7071929">sraw</a></span><span class="op" id="7072053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072059">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072080">if</span>&nbsp;<span class="ident" id="7072083"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7072085">.</span><span class="ident" id="7072086">WantProxy</span>&nbsp;<span class="op" id="7072096">!=</span>&nbsp;<span class="string" id="7072099">&#34;&#34;</span>&nbsp;<span class="op" id="7072102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072107"><a href="/net/http/requestwrite_test.go.html#7071362">setBody</a></span><span class="op" id="7072114">(</span><span class="op" id="7072115">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072120">var</span>&nbsp;<span class="ident" id="7072124">praw</span>&nbsp;<span class="ident" id="7072129"><a href="/net/http/requestwrite_test.go.html#7060145">bytes</a></span><span class="op" id="7072134">.</span><span class="ident" id="7072135">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072145"><a href="/net/http/requestwrite_test.go.html#7071688">err</a></span>&nbsp;<span class="op" id="7072149">=</span>&nbsp;<span class="ident" id="7072151"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7072153">.</span><span class="ident" id="7072154">Req</span><span class="op" id="7072157">.</span><span class="ident" id="7072158">WriteProxy</span><span class="op" id="7072168">(</span><span class="op" id="7072169">&amp;</span><span class="ident" id="7072170"><a href="/net/http/requestwrite_test.go.html#7072124">praw</a></span><span class="op" id="7072174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072179">if</span>&nbsp;<span class="ident" id="7072182"><a href="/net/http/requestwrite_test.go.html#7071688">err</a></span>&nbsp;<span class="op" id="7072186">!=</span>&nbsp;<span class="ident" id="7072189">nil</span>&nbsp;<span class="op" id="7072193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072199"><a href="/net/http/requestwrite_test.go.html#7071285">t</a></span><span class="op" id="7072200">.</span><span class="ident" id="7072201">Errorf</span><span class="op" id="7072207">(</span><span class="string" id="7072208">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="7072228">,</span>&nbsp;<span class="ident" id="7072230"><a href="/net/http/requestwrite_test.go.html#7071306">i</a></span><span class="op" id="7072231">,</span>&nbsp;<span class="ident" id="7072233"><a href="/net/http/requestwrite_test.go.html#7071688">err</a></span><span class="op" id="7072236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072242">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072259">sraw</span>&nbsp;<span class="op" id="7072264">:=</span>&nbsp;<span class="ident" id="7072267"><a href="/net/http/requestwrite_test.go.html#7072124">praw</a></span><span class="op" id="7072271">.</span><span class="ident" id="7072272">String</span><span class="op" id="7072278">(</span><span class="op" id="7072279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072284">if</span>&nbsp;<span class="ident" id="7072287"><a href="/net/http/requestwrite_test.go.html#7072259">sraw</a></span>&nbsp;<span class="op" id="7072292">!=</span>&nbsp;<span class="ident" id="7072295"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7072297">.</span><span class="ident" id="7072298">WantProxy</span>&nbsp;<span class="op" id="7072308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072314"><a href="/net/http/requestwrite_test.go.html#7071285">t</a></span><span class="op" id="7072315">.</span><span class="ident" id="7072316">Errorf</span><span class="op" id="7072322">(</span><span class="string" id="7072323">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7072366">,</span>&nbsp;<span class="ident" id="7072368"><a href="/net/http/requestwrite_test.go.html#7071306">i</a></span><span class="op" id="7072369">,</span>&nbsp;<span class="ident" id="7072371"><a href="/net/http/requestwrite_test.go.html#7071335">tt</a></span><span class="op" id="7072373">.</span><span class="ident" id="7072374">WantProxy</span><span class="op" id="7072383">,</span>&nbsp;<span class="ident" id="7072385"><a href="/net/http/requestwrite_test.go.html#7072259">sraw</a></span><span class="op" id="7072389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072395">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7072414">}</span><br>
<span class="lineno"></span><span class="op" id="7072416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7072419">type</span>&nbsp;<span class="ident" id="7072424">closeChecker</span>&nbsp;<span class="keyword" id="7072437">struct</span>&nbsp;<span class="op" id="7072444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072447"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7072449">.</span><span class="ident" id="7072450">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072458">closed</span>&nbsp;<span class="builtintype" id="7072465">bool</span><br>
<span class="lineno"></span><span class="op" id="7072470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="7072473">func</span>&nbsp;<span class="op" id="7072478">(</span><span class="ident" id="7072479">rc</span>&nbsp;<span class="op" id="7072482">*</span><span class="ident" id="7072483"><a href="/net/http/requestwrite_test.go.html#7072424">closeChecker</a></span><span class="op" id="7072495">)</span>&nbsp;<span class="ident" id="7072497">Close</span><span class="op" id="7072502">(</span><span class="op" id="7072503">)</span>&nbsp;<span class="builtintype" id="7072505">error</span>&nbsp;<span class="op" id="7072511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072514"><a href="/net/http/requestwrite_test.go.html#7072479">rc</a></span><span class="op" id="7072516">.</span><span class="ident" id="7072517">closed</span>&nbsp;<span class="op" id="7072524">=</span>&nbsp;<span class="builtintype" id="7072526">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072532">return</span>&nbsp;<span class="ident" id="7072539">nil</span><br>
<span class="lineno"></span><span class="op" id="7072543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="7072546">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="7072630">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="7072713">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="7072773">func</span>&nbsp;<span class="ident" id="7072778">TestRequestWriteClosesBody</span><span class="op" id="7072804">(</span><span class="ident" id="7072805">t</span>&nbsp;<span class="op" id="7072807">*</span><span class="ident" id="7072808"><a href="/net/http/requestwrite_test.go.html#7060212">testing</a></span><span class="op" id="7072815">.</span><span class="ident" id="7072816">T</span><span class="op" id="7072817">)</span>&nbsp;<span class="op" id="7072819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072822">rc</span>&nbsp;<span class="op" id="7072825">:=</span>&nbsp;<span class="op" id="7072828">&amp;</span><span class="ident" id="7072829"><a href="/net/http/requestwrite_test.go.html#7072424">closeChecker</a></span><span class="op" id="7072841">{</span><span class="ident" id="7072842">Reader</span><span class="op" id="7072848">:</span>&nbsp;<span class="ident" id="7072850"><a href="/net/http/requestwrite_test.go.html#7060201">strings</a></span><span class="op" id="7072857">.</span><span class="ident" id="7072858">NewReader</span><span class="op" id="7072867">(</span><span class="string" id="7072868">&#34;my&nbsp;body&#34;</span><span class="op" id="7072877">)</span><span class="op" id="7072878">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072881">req</span><span class="op" id="7072884">,</span>&nbsp;<span class="ident" id="7072886">_</span>&nbsp;<span class="op" id="7072888">:=</span>&nbsp;<span class="ident" id="7072891"><a href="/net/http/request.go.html#3380061">NewRequest</a></span><span class="op" id="7072901">(</span><span class="string" id="7072902">&#34;POST&#34;</span><span class="op" id="7072908">,</span>&nbsp;<span class="string" id="7072910">&#34;http://foo.com/&#34;</span><span class="op" id="7072927">,</span>&nbsp;<span class="ident" id="7072929"><a href="/net/http/requestwrite_test.go.html#7072822">rc</a></span><span class="op" id="7072931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7072934">if</span>&nbsp;<span class="ident" id="7072937"><a href="/net/http/requestwrite_test.go.html#7072881">req</a></span><span class="op" id="7072940">.</span><span class="ident" id="7072941">ContentLength</span>&nbsp;<span class="op" id="7072955">!=</span>&nbsp;<span class="num" id="7072958">0</span>&nbsp;<span class="op" id="7072960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7072964"><a href="/net/http/requestwrite_test.go.html#7072805">t</a></span><span class="op" id="7072965">.</span><span class="ident" id="7072966">Errorf</span><span class="op" id="7072972">(</span><span class="string" id="7072973">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="7073007">,</span>&nbsp;<span class="ident" id="7073009"><a href="/net/http/requestwrite_test.go.html#7072881">req</a></span><span class="op" id="7073012">.</span><span class="ident" id="7073013">ContentLength</span><span class="op" id="7073026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073032">buf</span>&nbsp;<span class="op" id="7073036">:=</span>&nbsp;<span class="builtinfunc" id="7073039">new</span><span class="op" id="7073042">(</span><span class="ident" id="7073043"><a href="/net/http/requestwrite_test.go.html#7060145">bytes</a></span><span class="op" id="7073048">.</span><span class="ident" id="7073049">Buffer</span><span class="op" id="7073055">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073058"><a href="/net/http/requestwrite_test.go.html#7072881">req</a></span><span class="op" id="7073061">.</span><span class="ident" id="7073062">Write</span><span class="op" id="7073067">(</span><span class="ident" id="7073068"><a href="/net/http/requestwrite_test.go.html#7073032">buf</a></span><span class="op" id="7073071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7073074">if</span>&nbsp;<span class="op" id="7073077">!</span><span class="ident" id="7073078"><a href="/net/http/requestwrite_test.go.html#7072822">rc</a></span><span class="op" id="7073080">.</span><span class="ident" id="7073081">closed</span>&nbsp;<span class="op" id="7073088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073092"><a href="/net/http/requestwrite_test.go.html#7072805">t</a></span><span class="op" id="7073093">.</span><span class="ident" id="7073094">Error</span><span class="op" id="7073099">(</span><span class="string" id="7073100">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="7073129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073135">expected</span>&nbsp;<span class="op" id="7073144">:=</span>&nbsp;<span class="string" id="7073147">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="7073169">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073173">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="7073193">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073197">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="7073235">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7073239">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="7073276">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073280">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073346">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073416">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7073487">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073544"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7073549">(</span><span class="string" id="7073550">&#34;m&#34;</span><span class="op" id="7073553">)</span>&nbsp;<span class="op" id="7073555">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073559"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7073564">(</span><span class="string" id="7073565">&#34;y&nbsp;body&#34;</span><span class="op" id="7073573">)</span>&nbsp;<span class="op" id="7073575">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073579"><a href="/net/http/requestwrite_test.go.html#7073696">chunk</a></span><span class="op" id="7073584">(</span><span class="string" id="7073585">&#34;&#34;</span><span class="op" id="7073587">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7073590">if</span>&nbsp;<span class="ident" id="7073593"><a href="/net/http/requestwrite_test.go.html#7073032">buf</a></span><span class="op" id="7073596">.</span><span class="ident" id="7073597">String</span><span class="op" id="7073603">(</span><span class="op" id="7073604">)</span>&nbsp;<span class="op" id="7073606">!=</span>&nbsp;<span class="ident" id="7073609"><a href="/net/http/requestwrite_test.go.html#7073135">expected</a></span>&nbsp;<span class="op" id="7073618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073622"><a href="/net/http/requestwrite_test.go.html#7072805">t</a></span><span class="op" id="7073623">.</span><span class="ident" id="7073624">Errorf</span><span class="op" id="7073630">(</span><span class="string" id="7073631">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="7073659">,</span>&nbsp;<span class="ident" id="7073661"><a href="/net/http/requestwrite_test.go.html#7073032">buf</a></span><span class="op" id="7073664">.</span><span class="ident" id="7073665">String</span><span class="op" id="7073671">(</span><span class="op" id="7073672">)</span><span class="op" id="7073673">,</span>&nbsp;<span class="ident" id="7073675"><a href="/net/http/requestwrite_test.go.html#7073135">expected</a></span><span class="op" id="7073683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073686">}</span><br>
<span class="lineno"></span><span class="op" id="7073688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="7073691">func</span>&nbsp;<span class="ident" id="7073696">chunk</span><span class="op" id="7073701">(</span><span class="ident" id="7073702">s</span>&nbsp;<span class="builtintype" id="7073704">string</span><span class="op" id="7073710">)</span>&nbsp;<span class="builtintype" id="7073712">string</span>&nbsp;<span class="op" id="7073719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7073722">return</span>&nbsp;<span class="ident" id="7073729"><a href="/net/http/requestwrite_test.go.html#7060164">fmt</a></span><span class="op" id="7073732">.</span><span class="ident" id="7073733">Sprintf</span><span class="op" id="7073740">(</span><span class="string" id="7073741">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="7073755">,</span>&nbsp;<span class="builtinfunc" id="7073757">len</span><span class="op" id="7073760">(</span><span class="ident" id="7073761"><a href="/net/http/requestwrite_test.go.html#7073702">s</a></span><span class="op" id="7073762">)</span><span class="op" id="7073763">,</span>&nbsp;<span class="ident" id="7073765"><a href="/net/http/requestwrite_test.go.html#7073702">s</a></span><span class="op" id="7073766">)</span><br>
<span class="lineno"></span><span class="op" id="7073768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7073771">func</span>&nbsp;<span class="ident" id="7073776">mustParseURL</span><span class="op" id="7073788">(</span><span class="ident" id="7073789">s</span>&nbsp;<span class="builtintype" id="7073791">string</span><span class="op" id="7073797">)</span>&nbsp;<span class="op" id="7073799">*</span><span class="ident" id="7073800"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7073803">.</span><span class="ident" id="7073804">URL</span>&nbsp;<span class="op" id="7073808">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7073811">u</span><span class="op" id="7073812">,</span>&nbsp;<span class="ident" id="7073814">err</span>&nbsp;<span class="op" id="7073818">:=</span>&nbsp;<span class="ident" id="7073821"><a href="/net/http/requestwrite_test.go.html#7060190">url</a></span><span class="op" id="7073824">.</span><span class="ident" id="7073825">Parse</span><span class="op" id="7073830">(</span><span class="ident" id="7073831"><a href="/net/http/requestwrite_test.go.html#7073789">s</a></span><span class="op" id="7073832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7073835">if</span>&nbsp;<span class="ident" id="7073838"><a href="/net/http/requestwrite_test.go.html#7073814">err</a></span>&nbsp;<span class="op" id="7073842">!=</span>&nbsp;<span class="ident" id="7073845">nil</span>&nbsp;<span class="op" id="7073849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7073853">panic</span><span class="op" id="7073858">(</span><span class="ident" id="7073859"><a href="/net/http/requestwrite_test.go.html#7060164">fmt</a></span><span class="op" id="7073862">.</span><span class="ident" id="7073863">Sprintf</span><span class="op" id="7073870">(</span><span class="string" id="7073871">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="7073897">,</span>&nbsp;<span class="ident" id="7073899"><a href="/net/http/requestwrite_test.go.html#7073789">s</a></span><span class="op" id="7073900">,</span>&nbsp;<span class="ident" id="7073902"><a href="/net/http/requestwrite_test.go.html#7073814">err</a></span><span class="op" id="7073905">)</span><span class="op" id="7073906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7073909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7073912">return</span>&nbsp;<span class="ident" id="7073919"><a href="/net/http/requestwrite_test.go.html#7073811">u</a></span><br>
<span class="lineno">565</span><span class="op" id="7073921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7073924">type</span>&nbsp;<span class="ident" id="7073929">writerFunc</span>&nbsp;<span class="keyword" id="7073940">func</span><span class="op" id="7073944">(</span><span class="op" id="7073945">[</span><span class="op" id="7073946">]</span><span class="builtintype" id="7073947">byte</span><span class="op" id="7073951">)</span>&nbsp;<span class="op" id="7073953">(</span><span class="builtintype" id="7073954">int</span><span class="op" id="7073957">,</span>&nbsp;<span class="builtintype" id="7073959">error</span><span class="op" id="7073964">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7073967">func</span>&nbsp;<span class="op" id="7073972">(</span><span class="ident" id="7073973">f</span>&nbsp;<span class="ident" id="7073975"><a href="/net/http/requestwrite_test.go.html#7073929">writerFunc</a></span><span class="op" id="7073985">)</span>&nbsp;<span class="ident" id="7073987">Write</span><span class="op" id="7073992">(</span><span class="ident" id="7073993">p</span>&nbsp;<span class="op" id="7073995">[</span><span class="op" id="7073996">]</span><span class="builtintype" id="7073997">byte</span><span class="op" id="7074001">)</span>&nbsp;<span class="op" id="7074003">(</span><span class="builtintype" id="7074004">int</span><span class="op" id="7074007">,</span>&nbsp;<span class="builtintype" id="7074009">error</span><span class="op" id="7074014">)</span>&nbsp;<span class="op" id="7074016">{</span>&nbsp;<span class="keyword" id="7074018">return</span>&nbsp;<span class="ident" id="7074025"><a href="/net/http/requestwrite_test.go.html#7073973">f</a></span><span class="op" id="7074026">(</span><span class="ident" id="7074027"><a href="/net/http/requestwrite_test.go.html#7073993">p</a></span><span class="op" id="7074028">)</span>&nbsp;<span class="op" id="7074030">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="7074033">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="7074113">func</span>&nbsp;<span class="ident" id="7074118">TestRequestWriteError</span><span class="op" id="7074139">(</span><span class="ident" id="7074140">t</span>&nbsp;<span class="op" id="7074142">*</span><span class="ident" id="7074143"><a href="/net/http/requestwrite_test.go.html#7060212">testing</a></span><span class="op" id="7074150">.</span><span class="ident" id="7074151">T</span><span class="op" id="7074152">)</span>&nbsp;<span class="op" id="7074154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074157">failAfter</span><span class="op" id="7074166">,</span>&nbsp;<span class="ident" id="7074168">writeCount</span>&nbsp;<span class="op" id="7074179">:=</span>&nbsp;<span class="num" id="7074182">0</span><span class="op" id="7074183">,</span>&nbsp;<span class="num" id="7074185">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074188">errFail</span>&nbsp;<span class="op" id="7074196">:=</span>&nbsp;<span class="ident" id="7074199"><a href="/net/http/requestwrite_test.go.html#7060154">errors</a></span><span class="op" id="7074205">.</span><span class="ident" id="7074206">New</span><span class="op" id="7074209">(</span><span class="string" id="7074210">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7074230">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074234">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074295">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074358">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7074411">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074427">w</span>&nbsp;<span class="op" id="7074429">:=</span>&nbsp;<span class="keyword" id="7074432">struct</span>&nbsp;<span class="op" id="7074439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074443"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7074445">.</span><span class="ident" id="7074446">ByteWriter</span>&nbsp;<span class="comment" id="7074457">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074503"><a href="/net/http/requestwrite_test.go.html#7060171">io</a></span><span class="op" id="7074505">.</span><span class="ident" id="7074506">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074514">}</span><span class="op" id="7074515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074519">nil</span><span class="op" id="7074522">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074526"><a href="/net/http/requestwrite_test.go.html#7073929">writerFunc</a></span><span class="op" id="7074536">(</span><span class="keyword" id="7074537">func</span><span class="op" id="7074541">(</span><span class="ident" id="7074542">p</span>&nbsp;<span class="op" id="7074544">[</span><span class="op" id="7074545">]</span><span class="builtintype" id="7074546">byte</span><span class="op" id="7074550">)</span>&nbsp;<span class="op" id="7074552">(</span><span class="ident" id="7074553">n</span>&nbsp;<span class="builtintype" id="7074555">int</span><span class="op" id="7074558">,</span>&nbsp;<span class="ident" id="7074560">err</span>&nbsp;<span class="builtintype" id="7074564">error</span><span class="op" id="7074569">)</span>&nbsp;<span class="op" id="7074571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074576"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span><span class="op" id="7074586">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074592">if</span>&nbsp;<span class="ident" id="7074595"><a href="/net/http/requestwrite_test.go.html#7074157">failAfter</a></span>&nbsp;<span class="op" id="7074605">==</span>&nbsp;<span class="num" id="7074608">0</span>&nbsp;<span class="op" id="7074610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074616"><a href="/net/http/requestwrite_test.go.html#7074560">err</a></span>&nbsp;<span class="op" id="7074620">=</span>&nbsp;<span class="ident" id="7074622"><a href="/net/http/requestwrite_test.go.html#7074188">errFail</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074633">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074638"><a href="/net/http/requestwrite_test.go.html#7074157">failAfter</a></span><span class="op" id="7074647">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074653">return</span>&nbsp;<span class="builtinfunc" id="7074660">len</span><span class="op" id="7074663">(</span><span class="ident" id="7074664"><a href="/net/http/requestwrite_test.go.html#7074542">p</a></span><span class="op" id="7074665">)</span><span class="op" id="7074666">,</span>&nbsp;<span class="ident" id="7074668"><a href="/net/http/requestwrite_test.go.html#7074560">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074674">}</span><span class="op" id="7074675">)</span><span class="op" id="7074676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074683">req</span><span class="op" id="7074686">,</span>&nbsp;<span class="ident" id="7074688">_</span>&nbsp;<span class="op" id="7074690">:=</span>&nbsp;<span class="ident" id="7074693"><a href="/net/http/request.go.html#3380061">NewRequest</a></span><span class="op" id="7074703">(</span><span class="string" id="7074704">&#34;GET&#34;</span><span class="op" id="7074709">,</span>&nbsp;<span class="string" id="7074711">&#34;http://example.com/&#34;</span><span class="op" id="7074732">,</span>&nbsp;<span class="ident" id="7074734">nil</span><span class="op" id="7074737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074740">const</span>&nbsp;<span class="ident" id="7074746">writeCalls</span>&nbsp;<span class="op" id="7074757">=</span>&nbsp;<span class="num" id="7074759">4</span>&nbsp;<span class="comment" id="7074761">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074813">sawGood</span>&nbsp;<span class="op" id="7074821">:=</span>&nbsp;<span class="builtintype" id="7074824">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074831">for</span>&nbsp;<span class="ident" id="7074835">n</span>&nbsp;<span class="op" id="7074837">:=</span>&nbsp;<span class="num" id="7074840">0</span><span class="op" id="7074841">;</span>&nbsp;<span class="ident" id="7074843"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span>&nbsp;<span class="op" id="7074845">&lt;=</span>&nbsp;<span class="ident" id="7074848"><a href="/net/http/requestwrite_test.go.html#7074746">writeCalls</a></span><span class="op" id="7074858">+</span><span class="num" id="7074859">2</span><span class="op" id="7074860">;</span>&nbsp;<span class="ident" id="7074862"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span><span class="op" id="7074863">++</span>&nbsp;<span class="op" id="7074866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074870"><a href="/net/http/requestwrite_test.go.html#7074157">failAfter</a></span>&nbsp;<span class="op" id="7074880">=</span>&nbsp;<span class="ident" id="7074882"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074886"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span>&nbsp;<span class="op" id="7074897">=</span>&nbsp;<span class="num" id="7074899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074903">err</span>&nbsp;<span class="op" id="7074907">:=</span>&nbsp;<span class="ident" id="7074910"><a href="/net/http/requestwrite_test.go.html#7074683">req</a></span><span class="op" id="7074913">.</span><span class="ident" id="7074914">Write</span><span class="op" id="7074919">(</span><span class="ident" id="7074920"><a href="/net/http/requestwrite_test.go.html#7074427">w</a></span><span class="op" id="7074921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074925">var</span>&nbsp;<span class="ident" id="7074929">wantErr</span>&nbsp;<span class="builtintype" id="7074937">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074945">if</span>&nbsp;<span class="ident" id="7074948"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span>&nbsp;<span class="op" id="7074950">&lt;</span>&nbsp;<span class="ident" id="7074952"><a href="/net/http/requestwrite_test.go.html#7074746">writeCalls</a></span>&nbsp;<span class="op" id="7074963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7074968"><a href="/net/http/requestwrite_test.go.html#7074929">wantErr</a></span>&nbsp;<span class="op" id="7074976">=</span>&nbsp;<span class="ident" id="7074978"><a href="/net/http/requestwrite_test.go.html#7074188">errFail</a></span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7074988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7074992">if</span>&nbsp;<span class="ident" id="7074995"><a href="/net/http/requestwrite_test.go.html#7074903">err</a></span>&nbsp;<span class="op" id="7074999">!=</span>&nbsp;<span class="ident" id="7075002"><a href="/net/http/requestwrite_test.go.html#7074929">wantErr</a></span>&nbsp;<span class="op" id="7075010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075015"><a href="/net/http/requestwrite_test.go.html#7074140">t</a></span><span class="op" id="7075016">.</span><span class="ident" id="7075017">Errorf</span><span class="op" id="7075023">(</span><span class="string" id="7075024">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7075069">,</span>&nbsp;<span class="ident" id="7075071"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span><span class="op" id="7075072">,</span>&nbsp;<span class="ident" id="7075074"><a href="/net/http/requestwrite_test.go.html#7074903">err</a></span><span class="op" id="7075077">,</span>&nbsp;<span class="ident" id="7075079"><a href="/net/http/requestwrite_test.go.html#7074929">wantErr</a></span><span class="op" id="7075086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7075091">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075102">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7075106">if</span>&nbsp;<span class="ident" id="7075109"><a href="/net/http/requestwrite_test.go.html#7074903">err</a></span>&nbsp;<span class="op" id="7075113">==</span>&nbsp;<span class="ident" id="7075116">nil</span>&nbsp;<span class="op" id="7075120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075125"><a href="/net/http/requestwrite_test.go.html#7074813">sawGood</a></span>&nbsp;<span class="op" id="7075133">=</span>&nbsp;<span class="builtintype" id="7075135">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7075143">if</span>&nbsp;<span class="ident" id="7075146"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span>&nbsp;<span class="op" id="7075157">!=</span>&nbsp;<span class="ident" id="7075160"><a href="/net/http/requestwrite_test.go.html#7074746">writeCalls</a></span>&nbsp;<span class="op" id="7075171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075177"><a href="/net/http/requestwrite_test.go.html#7074140">t</a></span><span class="op" id="7075178">.</span><span class="ident" id="7075179">Fatalf</span><span class="op" id="7075185">(</span><span class="string" id="7075186">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7075227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075232">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7075240">if</span>&nbsp;<span class="ident" id="7075243"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span>&nbsp;<span class="op" id="7075254">&gt;</span>&nbsp;<span class="ident" id="7075256"><a href="/net/http/requestwrite_test.go.html#7074746">writeCalls</a></span>&nbsp;<span class="op" id="7075267">||</span>&nbsp;<span class="ident" id="7075270"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span>&nbsp;<span class="op" id="7075281">&gt;</span>&nbsp;<span class="ident" id="7075283"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span><span class="op" id="7075284">+</span><span class="num" id="7075285">1</span>&nbsp;<span class="op" id="7075287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075292"><a href="/net/http/requestwrite_test.go.html#7074140">t</a></span><span class="op" id="7075293">.</span><span class="ident" id="7075294">Errorf</span><span class="op" id="7075300">(</span><span class="string" id="7075301">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="7075360">,</span>&nbsp;<span class="ident" id="7075362"><a href="/net/http/requestwrite_test.go.html#7074835">n</a></span><span class="op" id="7075363">,</span>&nbsp;<span class="ident" id="7075365"><a href="/net/http/requestwrite_test.go.html#7074168">writeCount</a></span><span class="op" id="7075375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075382">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7075385">if</span>&nbsp;<span class="op" id="7075388">!</span><span class="ident" id="7075389"><a href="/net/http/requestwrite_test.go.html#7074813">sawGood</a></span>&nbsp;<span class="op" id="7075397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7075401"><a href="/net/http/requestwrite_test.go.html#7074140">t</a></span><span class="op" id="7075402">.</span><span class="ident" id="7075403">Fatalf</span><span class="op" id="7075409">(</span><span class="string" id="7075410">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="7075451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7075454">}</span><br>
<span class="lineno"></span><span class="op" id="7075456">}</span>
</div>
</body>
</html>
