<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2048078">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2048133">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2048187">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2048238">package</span>&nbsp;<span class="ident" id="2048246">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2048252">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2048308">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2048362">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2048419">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2048474">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2048504">//</span><br>
<span class="lineno"></span><span class="comment" id="2048507">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2048563">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2048632">//</span><br>
<span class="lineno"></span><span class="comment" id="2048635">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2048694">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2048750">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2048807">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2048824">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2048880">//</span><br>
<span class="lineno">25</span><span class="comment" id="2048883">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2048918">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2048978">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2049034">//</span><br>
<span class="lineno"></span><span class="comment" id="2049037">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2049048">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2049090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2049150">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2049195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2049244">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2049265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2049318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2049375">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2049444">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2049498">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2049568">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2049633">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2049665">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2049733">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2049784">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2049845">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2049889">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2049916">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2049964">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2049986">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2050039">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2050101">//</span><br>
<span class="lineno"></span><span class="comment" id="2050104">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2050168">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2050238">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2050293">//</span><br>
<span class="lineno"></span><span class="comment" id="2050296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2050363">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2050393">//</span><br>
<span class="lineno"></span><span class="comment" id="2050396">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2050422">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2050494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2050519">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2050582">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2050625">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2050678">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2050689">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2050750">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2050809">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2050823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2050862">//</span><br>
<span class="lineno"></span><span class="comment" id="2050865">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2050917">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2050963">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2050979">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2051028">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2051098">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2051152">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2051196">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2051262">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2051327">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2051370">//</span><br>
<span class="lineno"></span><span class="comment" id="2051373">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2051395">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2051448">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2051486">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2051533">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2051579">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2051620">//</span><br>
<span class="lineno"></span><span class="comment" id="2051623">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2051627">var</span>&nbsp;<span class="ident" id="2051631">_lgamA</span>&nbsp;<span class="op" id="2051638">=</span>&nbsp;<span class="op" id="2051640">[</span><span class="op" id="2051641">...</span><span class="op" id="2051644">]</span><span class="builtintype" id="2051645">float64</span><span class="op" id="2051652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051655">7.72156649015328655494e-02</span><span class="op" id="2051681">,</span>&nbsp;<span class="comment" id="2051683">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051706">3.22467033424113591611e-01</span><span class="op" id="2051732">,</span>&nbsp;<span class="comment" id="2051734">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051757">6.73523010531292681824e-02</span><span class="op" id="2051783">,</span>&nbsp;<span class="comment" id="2051785">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051808">2.05808084325167332806e-02</span><span class="op" id="2051834">,</span>&nbsp;<span class="comment" id="2051836">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051859">7.38555086081402883957e-03</span><span class="op" id="2051885">,</span>&nbsp;<span class="comment" id="2051887">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051910">2.89051383673415629091e-03</span><span class="op" id="2051936">,</span>&nbsp;<span class="comment" id="2051938">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2051961">1.19270763183362067845e-03</span><span class="op" id="2051987">,</span>&nbsp;<span class="comment" id="2051989">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052012">5.10069792153511336608e-04</span><span class="op" id="2052038">,</span>&nbsp;<span class="comment" id="2052040">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052063">2.20862790713908385557e-04</span><span class="op" id="2052089">,</span>&nbsp;<span class="comment" id="2052091">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052114">1.08011567247583939954e-04</span><span class="op" id="2052140">,</span>&nbsp;<span class="comment" id="2052142">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052165">2.52144565451257326939e-05</span><span class="op" id="2052191">,</span>&nbsp;<span class="comment" id="2052193">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052216">4.48640949618915160150e-05</span><span class="op" id="2052242">,</span>&nbsp;<span class="comment" id="2052244">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2052266">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2052268">var</span>&nbsp;<span class="ident" id="2052272">_lgamR</span>&nbsp;<span class="op" id="2052279">=</span>&nbsp;<span class="op" id="2052281">[</span><span class="op" id="2052282">...</span><span class="op" id="2052285">]</span><span class="builtintype" id="2052286">float64</span><span class="op" id="2052293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052296">1.0</span><span class="op" id="2052299">,</span>&nbsp;<span class="comment" id="2052301">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052317">1.39200533467621045958e+00</span><span class="op" id="2052343">,</span>&nbsp;<span class="comment" id="2052345">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052368">7.21935547567138069525e-01</span><span class="op" id="2052394">,</span>&nbsp;<span class="comment" id="2052396">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052419">1.71933865632803078993e-01</span><span class="op" id="2052445">,</span>&nbsp;<span class="comment" id="2052447">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052470">1.86459191715652901344e-02</span><span class="op" id="2052496">,</span>&nbsp;<span class="comment" id="2052498">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052521">7.77942496381893596434e-04</span><span class="op" id="2052547">,</span>&nbsp;<span class="comment" id="2052549">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052572">7.32668430744625636189e-06</span><span class="op" id="2052598">,</span>&nbsp;<span class="comment" id="2052600">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2052622">}</span><br>
<span class="lineno"></span><span class="keyword" id="2052624">var</span>&nbsp;<span class="ident" id="2052628">_lgamS</span>&nbsp;<span class="op" id="2052635">=</span>&nbsp;<span class="op" id="2052637">[</span><span class="op" id="2052638">...</span><span class="op" id="2052641">]</span><span class="builtintype" id="2052642">float64</span><span class="op" id="2052649">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2052652">-</span><span class="num" id="2052653">7.72156649015328655494e-02</span><span class="op" id="2052679">,</span>&nbsp;<span class="comment" id="2052681">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052704">2.14982415960608852501e-01</span><span class="op" id="2052730">,</span>&nbsp;&nbsp;<span class="comment" id="2052733">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052756">3.25778796408930981787e-01</span><span class="op" id="2052782">,</span>&nbsp;&nbsp;<span class="comment" id="2052785">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052808">1.46350472652464452805e-01</span><span class="op" id="2052834">,</span>&nbsp;&nbsp;<span class="comment" id="2052837">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052860">2.66422703033638609560e-02</span><span class="op" id="2052886">,</span>&nbsp;&nbsp;<span class="comment" id="2052889">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052912">1.84028451407337715652e-03</span><span class="op" id="2052938">,</span>&nbsp;&nbsp;<span class="comment" id="2052941">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2052964">3.19475326584100867617e-05</span><span class="op" id="2052990">,</span>&nbsp;&nbsp;<span class="comment" id="2052993">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2053015">}</span><br>
<span class="lineno"></span><span class="keyword" id="2053017">var</span>&nbsp;<span class="ident" id="2053021">_lgamT</span>&nbsp;<span class="op" id="2053028">=</span>&nbsp;<span class="op" id="2053030">[</span><span class="op" id="2053031">...</span><span class="op" id="2053034">]</span><span class="builtintype" id="2053035">float64</span><span class="op" id="2053042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053045">4.83836122723810047042e-01</span><span class="op" id="2053071">,</span>&nbsp;&nbsp;<span class="comment" id="2053074">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053097">-</span><span class="num" id="2053098">1.47587722994593911752e-01</span><span class="op" id="2053124">,</span>&nbsp;<span class="comment" id="2053126">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053149">6.46249402391333854778e-02</span><span class="op" id="2053175">,</span>&nbsp;&nbsp;<span class="comment" id="2053178">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053201">-</span><span class="num" id="2053202">3.27885410759859649565e-02</span><span class="op" id="2053228">,</span>&nbsp;<span class="comment" id="2053230">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053253">1.79706750811820387126e-02</span><span class="op" id="2053279">,</span>&nbsp;&nbsp;<span class="comment" id="2053282">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053305">-</span><span class="num" id="2053306">1.03142241298341437450e-02</span><span class="op" id="2053332">,</span>&nbsp;<span class="comment" id="2053334">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053357">6.10053870246291332635e-03</span><span class="op" id="2053383">,</span>&nbsp;&nbsp;<span class="comment" id="2053386">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053409">-</span><span class="num" id="2053410">3.68452016781138256760e-03</span><span class="op" id="2053436">,</span>&nbsp;<span class="comment" id="2053438">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053461">2.25964780900612472250e-03</span><span class="op" id="2053487">,</span>&nbsp;&nbsp;<span class="comment" id="2053490">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053513">-</span><span class="num" id="2053514">1.40346469989232843813e-03</span><span class="op" id="2053540">,</span>&nbsp;<span class="comment" id="2053542">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053565">8.81081882437654011382e-04</span><span class="op" id="2053591">,</span>&nbsp;&nbsp;<span class="comment" id="2053594">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053617">-</span><span class="num" id="2053618">5.38595305356740546715e-04</span><span class="op" id="2053644">,</span>&nbsp;<span class="comment" id="2053646">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053669">3.15632070903625950361e-04</span><span class="op" id="2053695">,</span>&nbsp;&nbsp;<span class="comment" id="2053698">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053721">-</span><span class="num" id="2053722">3.12754168375120860518e-04</span><span class="op" id="2053748">,</span>&nbsp;<span class="comment" id="2053750">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053773">3.35529192635519073543e-04</span><span class="op" id="2053799">,</span>&nbsp;&nbsp;<span class="comment" id="2053802">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2053824">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2053826">var</span>&nbsp;<span class="ident" id="2053830">_lgamU</span>&nbsp;<span class="op" id="2053837">=</span>&nbsp;<span class="op" id="2053839">[</span><span class="op" id="2053840">...</span><span class="op" id="2053843">]</span><span class="builtintype" id="2053844">float64</span><span class="op" id="2053851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2053854">-</span><span class="num" id="2053855">7.72156649015328655494e-02</span><span class="op" id="2053881">,</span>&nbsp;<span class="comment" id="2053883">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053906">6.32827064025093366517e-01</span><span class="op" id="2053932">,</span>&nbsp;&nbsp;<span class="comment" id="2053935">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2053958">1.45492250137234768737e+00</span><span class="op" id="2053984">,</span>&nbsp;&nbsp;<span class="comment" id="2053987">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054010">9.77717527963372745603e-01</span><span class="op" id="2054036">,</span>&nbsp;&nbsp;<span class="comment" id="2054039">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054062">2.28963728064692451092e-01</span><span class="op" id="2054088">,</span>&nbsp;&nbsp;<span class="comment" id="2054091">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054114">1.33810918536787660377e-02</span><span class="op" id="2054140">,</span>&nbsp;&nbsp;<span class="comment" id="2054143">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2054165">}</span><br>
<span class="lineno"></span><span class="keyword" id="2054167">var</span>&nbsp;<span class="ident" id="2054171">_lgamV</span>&nbsp;<span class="op" id="2054178">=</span>&nbsp;<span class="op" id="2054180">[</span><span class="op" id="2054181">...</span><span class="op" id="2054184">]</span><span class="builtintype" id="2054185">float64</span><span class="op" id="2054192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054195">1.0</span><span class="op" id="2054198">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054201">2.45597793713041134822e+00</span><span class="op" id="2054227">,</span>&nbsp;<span class="comment" id="2054229">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054252">2.12848976379893395361e+00</span><span class="op" id="2054278">,</span>&nbsp;<span class="comment" id="2054280">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054303">7.69285150456672783825e-01</span><span class="op" id="2054329">,</span>&nbsp;<span class="comment" id="2054331">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054354">1.04222645593369134254e-01</span><span class="op" id="2054380">,</span>&nbsp;<span class="comment" id="2054382">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054405">3.21709242282423911810e-03</span><span class="op" id="2054431">,</span>&nbsp;<span class="comment" id="2054433">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2054455">}</span><br>
<span class="lineno"></span><span class="keyword" id="2054457">var</span>&nbsp;<span class="ident" id="2054461">_lgamW</span>&nbsp;<span class="op" id="2054468">=</span>&nbsp;<span class="op" id="2054470">[</span><span class="op" id="2054471">...</span><span class="op" id="2054474">]</span><span class="builtintype" id="2054475">float64</span><span class="op" id="2054482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054485">4.18938533204672725052e-01</span><span class="op" id="2054511">,</span>&nbsp;&nbsp;<span class="comment" id="2054514">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054537">8.33333333333329678849e-02</span><span class="op" id="2054563">,</span>&nbsp;&nbsp;<span class="comment" id="2054566">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2054589">-</span><span class="num" id="2054590">2.77777777728775536470e-03</span><span class="op" id="2054616">,</span>&nbsp;<span class="comment" id="2054618">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054641">7.93650558643019558500e-04</span><span class="op" id="2054667">,</span>&nbsp;&nbsp;<span class="comment" id="2054670">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2054693">-</span><span class="num" id="2054694">5.95187557450339963135e-04</span><span class="op" id="2054720">,</span>&nbsp;<span class="comment" id="2054722">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2054745">8.36339918996282139126e-04</span><span class="op" id="2054771">,</span>&nbsp;&nbsp;<span class="comment" id="2054774">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2054797">-</span><span class="num" id="2054798">1.63092934096575273989e-03</span><span class="op" id="2054824">,</span>&nbsp;<span class="comment" id="2054826">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2054848">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2054851">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2054924">//</span><br>
<span class="lineno"></span><span class="comment" id="2054927">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2054949">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2054972">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2054992">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2055019">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2055042">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2055063">func</span>&nbsp;<span class="ident" id="2055068">Lgamma</span><span class="op" id="2055074">(</span><span class="ident" id="2055075">x</span>&nbsp;<span class="builtintype" id="2055077">float64</span><span class="op" id="2055084">)</span>&nbsp;<span class="op" id="2055086">(</span><span class="ident" id="2055087">lgamma</span>&nbsp;<span class="builtintype" id="2055094">float64</span><span class="op" id="2055101">,</span>&nbsp;<span class="ident" id="2055103">sign</span>&nbsp;<span class="builtintype" id="2055108">int</span><span class="op" id="2055111">)</span>&nbsp;<span class="op" id="2055113">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055116">const</span>&nbsp;<span class="op" id="2055122">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055126">Ymin</span>&nbsp;&nbsp;<span class="op" id="2055132">=</span>&nbsp;<span class="num" id="2055134">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055157">Two52</span>&nbsp;<span class="op" id="2055163">=</span>&nbsp;<span class="num" id="2055165">1</span>&nbsp;<span class="op" id="2055167">&lt;&lt;</span>&nbsp;<span class="num" id="2055170">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2055193">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055229">Two53</span>&nbsp;<span class="op" id="2055235">=</span>&nbsp;<span class="num" id="2055237">1</span>&nbsp;<span class="op" id="2055239">&lt;&lt;</span>&nbsp;<span class="num" id="2055242">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2055265">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055301">Two58</span>&nbsp;<span class="op" id="2055307">=</span>&nbsp;<span class="num" id="2055309">1</span>&nbsp;<span class="op" id="2055311">&lt;&lt;</span>&nbsp;<span class="num" id="2055314">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2055337">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055373">Tiny</span>&nbsp;&nbsp;<span class="op" id="2055379">=</span>&nbsp;<span class="num" id="2055381">1.0</span>&nbsp;<span class="op" id="2055385">/</span>&nbsp;<span class="op" id="2055387">(</span><span class="num" id="2055388">1</span>&nbsp;<span class="op" id="2055390">&lt;&lt;</span>&nbsp;<span class="num" id="2055393">70</span><span class="op" id="2055395">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2055409">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055446">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2055452">=</span>&nbsp;<span class="num" id="2055454">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2055482">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055506">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2055512">=</span>&nbsp;<span class="op" id="2055514">-</span><span class="num" id="2055515">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2055542">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055566">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055590">Tt</span>&nbsp;<span class="op" id="2055593">=</span>&nbsp;<span class="op" id="2055595">-</span><span class="num" id="2055596">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2055623">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2055649">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055667">sign</span>&nbsp;<span class="op" id="2055672">=</span>&nbsp;<span class="num" id="2055674">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055677">switch</span>&nbsp;<span class="op" id="2055684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055687">case</span>&nbsp;<span class="ident" id="2055692">IsNaN</span><span class="op" id="2055697">(</span><span class="ident" id="2055698">x</span><span class="op" id="2055699">)</span><span class="op" id="2055700">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055704">lgamma</span>&nbsp;<span class="op" id="2055711">=</span>&nbsp;<span class="ident" id="2055713">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055717">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055725">case</span>&nbsp;<span class="ident" id="2055730">IsInf</span><span class="op" id="2055735">(</span><span class="ident" id="2055736">x</span><span class="op" id="2055737">,</span>&nbsp;<span class="num" id="2055739">0</span><span class="op" id="2055740">)</span><span class="op" id="2055741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055745">lgamma</span>&nbsp;<span class="op" id="2055752">=</span>&nbsp;<span class="ident" id="2055754">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055758">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055766">case</span>&nbsp;<span class="ident" id="2055771">x</span>&nbsp;<span class="op" id="2055773">==</span>&nbsp;<span class="num" id="2055776">0</span><span class="op" id="2055777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055781">lgamma</span>&nbsp;<span class="op" id="2055788">=</span>&nbsp;<span class="ident" id="2055790">Inf</span><span class="op" id="2055793">(</span><span class="num" id="2055794">1</span><span class="op" id="2055795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055799">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055807">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055811">neg</span>&nbsp;<span class="op" id="2055815">:=</span>&nbsp;<span class="ident" id="2055818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055825">if</span>&nbsp;<span class="ident" id="2055828">x</span>&nbsp;<span class="op" id="2055830">&lt;</span>&nbsp;<span class="num" id="2055832">0</span>&nbsp;<span class="op" id="2055834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055838">x</span>&nbsp;<span class="op" id="2055840">=</span>&nbsp;<span class="op" id="2055842">-</span><span class="ident" id="2055843">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055847">neg</span>&nbsp;<span class="op" id="2055851">=</span>&nbsp;<span class="ident" id="2055853">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055859">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055863">if</span>&nbsp;<span class="ident" id="2055866">x</span>&nbsp;<span class="op" id="2055868">&lt;</span>&nbsp;<span class="ident" id="2055870">Tiny</span>&nbsp;<span class="op" id="2055875">{</span>&nbsp;<span class="comment" id="2055877">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055916">if</span>&nbsp;<span class="ident" id="2055919">neg</span>&nbsp;<span class="op" id="2055923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055928">sign</span>&nbsp;<span class="op" id="2055933">=</span>&nbsp;<span class="op" id="2055935">-</span><span class="num" id="2055936">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055940">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2055944">lgamma</span>&nbsp;<span class="op" id="2055951">=</span>&nbsp;<span class="op" id="2055953">-</span><span class="ident" id="2055954">Log</span><span class="op" id="2055957">(</span><span class="ident" id="2055958">x</span><span class="op" id="2055959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055963">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2055971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055974">var</span>&nbsp;<span class="ident" id="2055978">nadj</span>&nbsp;<span class="builtintype" id="2055983">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2055992">if</span>&nbsp;<span class="ident" id="2055995">neg</span>&nbsp;<span class="op" id="2055999">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056003">if</span>&nbsp;<span class="ident" id="2056006">x</span>&nbsp;<span class="op" id="2056008">&gt;=</span>&nbsp;<span class="ident" id="2056011">Two52</span>&nbsp;<span class="op" id="2056017">{</span>&nbsp;<span class="comment" id="2056019">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056056">lgamma</span>&nbsp;<span class="op" id="2056063">=</span>&nbsp;<span class="ident" id="2056065">Inf</span><span class="op" id="2056068">(</span><span class="num" id="2056069">1</span><span class="op" id="2056070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056088">t</span>&nbsp;<span class="op" id="2056090">:=</span>&nbsp;<span class="ident" id="2056093">sinPi</span><span class="op" id="2056098">(</span><span class="ident" id="2056099">x</span><span class="op" id="2056100">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056104">if</span>&nbsp;<span class="ident" id="2056107">t</span>&nbsp;<span class="op" id="2056109">==</span>&nbsp;<span class="num" id="2056112">0</span>&nbsp;<span class="op" id="2056114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056119">lgamma</span>&nbsp;<span class="op" id="2056126">=</span>&nbsp;<span class="ident" id="2056128">Inf</span><span class="op" id="2056131">(</span><span class="num" id="2056132">1</span><span class="op" id="2056133">)</span>&nbsp;<span class="comment" id="2056135">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056150">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056163">nadj</span>&nbsp;<span class="op" id="2056168">=</span>&nbsp;<span class="ident" id="2056170">Log</span><span class="op" id="2056173">(</span><span class="ident" id="2056174">Pi</span>&nbsp;<span class="op" id="2056177">/</span>&nbsp;<span class="ident" id="2056179">Abs</span><span class="op" id="2056182">(</span><span class="ident" id="2056183">t</span><span class="op" id="2056184">*</span><span class="ident" id="2056185">x</span><span class="op" id="2056186">)</span><span class="op" id="2056187">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056191">if</span>&nbsp;<span class="ident" id="2056194">t</span>&nbsp;<span class="op" id="2056196">&lt;</span>&nbsp;<span class="num" id="2056198">0</span>&nbsp;<span class="op" id="2056200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056205">sign</span>&nbsp;<span class="op" id="2056210">=</span>&nbsp;<span class="op" id="2056212">-</span><span class="num" id="2056213">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056224">switch</span>&nbsp;<span class="op" id="2056231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056234">case</span>&nbsp;<span class="ident" id="2056239">x</span>&nbsp;<span class="op" id="2056241">==</span>&nbsp;<span class="num" id="2056244">1</span>&nbsp;<span class="op" id="2056246">||</span>&nbsp;<span class="ident" id="2056249">x</span>&nbsp;<span class="op" id="2056251">==</span>&nbsp;<span class="num" id="2056254">2</span><span class="op" id="2056255">:</span>&nbsp;<span class="comment" id="2056257">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056280">lgamma</span>&nbsp;<span class="op" id="2056287">=</span>&nbsp;<span class="num" id="2056289">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056293">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056301">case</span>&nbsp;<span class="ident" id="2056306">x</span>&nbsp;<span class="op" id="2056308">&lt;</span>&nbsp;<span class="num" id="2056310">2</span><span class="op" id="2056311">:</span>&nbsp;<span class="comment" id="2056313">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056355">var</span>&nbsp;<span class="ident" id="2056359">y</span>&nbsp;<span class="builtintype" id="2056361">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056371">var</span>&nbsp;<span class="ident" id="2056375">i</span>&nbsp;<span class="builtintype" id="2056377">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056383">if</span>&nbsp;<span class="ident" id="2056386">x</span>&nbsp;<span class="op" id="2056388">&lt;=</span>&nbsp;<span class="num" id="2056391">0.9</span>&nbsp;<span class="op" id="2056395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056400">lgamma</span>&nbsp;<span class="op" id="2056407">=</span>&nbsp;<span class="op" id="2056409">-</span><span class="ident" id="2056410">Log</span><span class="op" id="2056413">(</span><span class="ident" id="2056414">x</span><span class="op" id="2056415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056420">switch</span>&nbsp;<span class="op" id="2056427">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056432">case</span>&nbsp;<span class="ident" id="2056437">x</span>&nbsp;<span class="op" id="2056439">&gt;=</span>&nbsp;<span class="op" id="2056442">(</span><span class="ident" id="2056443">Ymin</span>&nbsp;<span class="op" id="2056448">-</span>&nbsp;<span class="num" id="2056450">1</span>&nbsp;<span class="op" id="2056452">+</span>&nbsp;<span class="num" id="2056454">0.27</span><span class="op" id="2056458">)</span><span class="op" id="2056459">:</span>&nbsp;<span class="comment" id="2056461">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056488">y</span>&nbsp;<span class="op" id="2056490">=</span>&nbsp;<span class="num" id="2056492">1</span>&nbsp;<span class="op" id="2056494">-</span>&nbsp;<span class="ident" id="2056496">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056502">i</span>&nbsp;<span class="op" id="2056504">=</span>&nbsp;<span class="num" id="2056506">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056511">case</span>&nbsp;<span class="ident" id="2056516">x</span>&nbsp;<span class="op" id="2056518">&gt;=</span>&nbsp;<span class="op" id="2056521">(</span><span class="ident" id="2056522">Ymin</span>&nbsp;<span class="op" id="2056527">-</span>&nbsp;<span class="num" id="2056529">1</span>&nbsp;<span class="op" id="2056531">-</span>&nbsp;<span class="num" id="2056533">0.27</span><span class="op" id="2056537">)</span><span class="op" id="2056538">:</span>&nbsp;<span class="comment" id="2056540">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056568">y</span>&nbsp;<span class="op" id="2056570">=</span>&nbsp;<span class="ident" id="2056572">x</span>&nbsp;<span class="op" id="2056574">-</span>&nbsp;<span class="op" id="2056576">(</span><span class="ident" id="2056577">Tc</span>&nbsp;<span class="op" id="2056580">-</span>&nbsp;<span class="num" id="2056582">1</span><span class="op" id="2056583">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056589">i</span>&nbsp;<span class="op" id="2056591">=</span>&nbsp;<span class="num" id="2056593">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056598">default</span><span class="op" id="2056605">:</span>&nbsp;<span class="comment" id="2056607">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056629">y</span>&nbsp;<span class="op" id="2056631">=</span>&nbsp;<span class="ident" id="2056633">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056639">i</span>&nbsp;<span class="op" id="2056641">=</span>&nbsp;<span class="num" id="2056643">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056648">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056652">}</span>&nbsp;<span class="keyword" id="2056654">else</span>&nbsp;<span class="op" id="2056659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056664">lgamma</span>&nbsp;<span class="op" id="2056671">=</span>&nbsp;<span class="num" id="2056673">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056678">switch</span>&nbsp;<span class="op" id="2056685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056690">case</span>&nbsp;<span class="ident" id="2056695">x</span>&nbsp;<span class="op" id="2056697">&gt;=</span>&nbsp;<span class="op" id="2056700">(</span><span class="ident" id="2056701">Ymin</span>&nbsp;<span class="op" id="2056706">+</span>&nbsp;<span class="num" id="2056708">0.27</span><span class="op" id="2056712">)</span><span class="op" id="2056713">:</span>&nbsp;<span class="comment" id="2056715">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056738">y</span>&nbsp;<span class="op" id="2056740">=</span>&nbsp;<span class="num" id="2056742">2</span>&nbsp;<span class="op" id="2056744">-</span>&nbsp;<span class="ident" id="2056746">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056752">i</span>&nbsp;<span class="op" id="2056754">=</span>&nbsp;<span class="num" id="2056756">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056761">case</span>&nbsp;<span class="ident" id="2056766">x</span>&nbsp;<span class="op" id="2056768">&gt;=</span>&nbsp;<span class="op" id="2056771">(</span><span class="ident" id="2056772">Ymin</span>&nbsp;<span class="op" id="2056777">-</span>&nbsp;<span class="num" id="2056779">0.27</span><span class="op" id="2056783">)</span><span class="op" id="2056784">:</span>&nbsp;<span class="comment" id="2056786">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056814">y</span>&nbsp;<span class="op" id="2056816">=</span>&nbsp;<span class="ident" id="2056818">x</span>&nbsp;<span class="op" id="2056820">-</span>&nbsp;<span class="ident" id="2056822">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056829">i</span>&nbsp;<span class="op" id="2056831">=</span>&nbsp;<span class="num" id="2056833">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056838">default</span><span class="op" id="2056845">:</span>&nbsp;<span class="comment" id="2056847">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056871">y</span>&nbsp;<span class="op" id="2056873">=</span>&nbsp;<span class="ident" id="2056875">x</span>&nbsp;<span class="op" id="2056877">-</span>&nbsp;<span class="num" id="2056879">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056885">i</span>&nbsp;<span class="op" id="2056887">=</span>&nbsp;<span class="num" id="2056889">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2056898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056902">switch</span>&nbsp;<span class="ident" id="2056909">i</span>&nbsp;<span class="op" id="2056911">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2056915">case</span>&nbsp;<span class="num" id="2056920">0</span><span class="op" id="2056921">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056926">z</span>&nbsp;<span class="op" id="2056928">:=</span>&nbsp;<span class="ident" id="2056931">y</span>&nbsp;<span class="op" id="2056933">*</span>&nbsp;<span class="ident" id="2056935">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2056940">p1</span>&nbsp;<span class="op" id="2056943">:=</span>&nbsp;<span class="ident" id="2056946">_lgamA</span><span class="op" id="2056952">[</span><span class="num" id="2056953">0</span><span class="op" id="2056954">]</span>&nbsp;<span class="op" id="2056956">+</span>&nbsp;<span class="ident" id="2056958">z</span><span class="op" id="2056959">*</span><span class="op" id="2056960">(</span><span class="ident" id="2056961">_lgamA</span><span class="op" id="2056967">[</span><span class="num" id="2056968">2</span><span class="op" id="2056969">]</span><span class="op" id="2056970">+</span><span class="ident" id="2056971">z</span><span class="op" id="2056972">*</span><span class="op" id="2056973">(</span><span class="ident" id="2056974">_lgamA</span><span class="op" id="2056980">[</span><span class="num" id="2056981">4</span><span class="op" id="2056982">]</span><span class="op" id="2056983">+</span><span class="ident" id="2056984">z</span><span class="op" id="2056985">*</span><span class="op" id="2056986">(</span><span class="ident" id="2056987">_lgamA</span><span class="op" id="2056993">[</span><span class="num" id="2056994">6</span><span class="op" id="2056995">]</span><span class="op" id="2056996">+</span><span class="ident" id="2056997">z</span><span class="op" id="2056998">*</span><span class="op" id="2056999">(</span><span class="ident" id="2057000">_lgamA</span><span class="op" id="2057006">[</span><span class="num" id="2057007">8</span><span class="op" id="2057008">]</span><span class="op" id="2057009">+</span><span class="ident" id="2057010">z</span><span class="op" id="2057011">*</span><span class="ident" id="2057012">_lgamA</span><span class="op" id="2057018">[</span><span class="num" id="2057019">10</span><span class="op" id="2057021">]</span><span class="op" id="2057022">)</span><span class="op" id="2057023">)</span><span class="op" id="2057024">)</span><span class="op" id="2057025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057030">p2</span>&nbsp;<span class="op" id="2057033">:=</span>&nbsp;<span class="ident" id="2057036">z</span>&nbsp;<span class="op" id="2057038">*</span>&nbsp;<span class="op" id="2057040">(</span><span class="ident" id="2057041">_lgamA</span><span class="op" id="2057047">[</span><span class="num" id="2057048">1</span><span class="op" id="2057049">]</span>&nbsp;<span class="op" id="2057051">+</span>&nbsp;<span class="ident" id="2057053">z</span><span class="op" id="2057054">*</span><span class="op" id="2057055">(</span><span class="op" id="2057056">+</span><span class="ident" id="2057057">_lgamA</span><span class="op" id="2057063">[</span><span class="num" id="2057064">3</span><span class="op" id="2057065">]</span><span class="op" id="2057066">+</span><span class="ident" id="2057067">z</span><span class="op" id="2057068">*</span><span class="op" id="2057069">(</span><span class="ident" id="2057070">_lgamA</span><span class="op" id="2057076">[</span><span class="num" id="2057077">5</span><span class="op" id="2057078">]</span><span class="op" id="2057079">+</span><span class="ident" id="2057080">z</span><span class="op" id="2057081">*</span><span class="op" id="2057082">(</span><span class="ident" id="2057083">_lgamA</span><span class="op" id="2057089">[</span><span class="num" id="2057090">7</span><span class="op" id="2057091">]</span><span class="op" id="2057092">+</span><span class="ident" id="2057093">z</span><span class="op" id="2057094">*</span><span class="op" id="2057095">(</span><span class="ident" id="2057096">_lgamA</span><span class="op" id="2057102">[</span><span class="num" id="2057103">9</span><span class="op" id="2057104">]</span><span class="op" id="2057105">+</span><span class="ident" id="2057106">z</span><span class="op" id="2057107">*</span><span class="ident" id="2057108">_lgamA</span><span class="op" id="2057114">[</span><span class="num" id="2057115">11</span><span class="op" id="2057117">]</span><span class="op" id="2057118">)</span><span class="op" id="2057119">)</span><span class="op" id="2057120">)</span><span class="op" id="2057121">)</span><span class="op" id="2057122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057127">p</span>&nbsp;<span class="op" id="2057129">:=</span>&nbsp;<span class="ident" id="2057132">y</span><span class="op" id="2057133">*</span><span class="ident" id="2057134">p1</span>&nbsp;<span class="op" id="2057137">+</span>&nbsp;<span class="ident" id="2057139">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057145">lgamma</span>&nbsp;<span class="op" id="2057152">+=</span>&nbsp;<span class="op" id="2057155">(</span><span class="ident" id="2057156">p</span>&nbsp;<span class="op" id="2057158">-</span>&nbsp;<span class="num" id="2057160">0.5</span><span class="op" id="2057163">*</span><span class="ident" id="2057164">y</span><span class="op" id="2057165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057169">case</span>&nbsp;<span class="num" id="2057174">1</span><span class="op" id="2057175">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057180">z</span>&nbsp;<span class="op" id="2057182">:=</span>&nbsp;<span class="ident" id="2057185">y</span>&nbsp;<span class="op" id="2057187">*</span>&nbsp;<span class="ident" id="2057189">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057194">w</span>&nbsp;<span class="op" id="2057196">:=</span>&nbsp;<span class="ident" id="2057199">z</span>&nbsp;<span class="op" id="2057201">*</span>&nbsp;<span class="ident" id="2057203">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057208">p1</span>&nbsp;<span class="op" id="2057211">:=</span>&nbsp;<span class="ident" id="2057214">_lgamT</span><span class="op" id="2057220">[</span><span class="num" id="2057221">0</span><span class="op" id="2057222">]</span>&nbsp;<span class="op" id="2057224">+</span>&nbsp;<span class="ident" id="2057226">w</span><span class="op" id="2057227">*</span><span class="op" id="2057228">(</span><span class="ident" id="2057229">_lgamT</span><span class="op" id="2057235">[</span><span class="num" id="2057236">3</span><span class="op" id="2057237">]</span><span class="op" id="2057238">+</span><span class="ident" id="2057239">w</span><span class="op" id="2057240">*</span><span class="op" id="2057241">(</span><span class="ident" id="2057242">_lgamT</span><span class="op" id="2057248">[</span><span class="num" id="2057249">6</span><span class="op" id="2057250">]</span><span class="op" id="2057251">+</span><span class="ident" id="2057252">w</span><span class="op" id="2057253">*</span><span class="op" id="2057254">(</span><span class="ident" id="2057255">_lgamT</span><span class="op" id="2057261">[</span><span class="num" id="2057262">9</span><span class="op" id="2057263">]</span><span class="op" id="2057264">+</span><span class="ident" id="2057265">w</span><span class="op" id="2057266">*</span><span class="ident" id="2057267">_lgamT</span><span class="op" id="2057273">[</span><span class="num" id="2057274">12</span><span class="op" id="2057276">]</span><span class="op" id="2057277">)</span><span class="op" id="2057278">)</span><span class="op" id="2057279">)</span>&nbsp;<span class="comment" id="2057281">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057301">p2</span>&nbsp;<span class="op" id="2057304">:=</span>&nbsp;<span class="ident" id="2057307">_lgamT</span><span class="op" id="2057313">[</span><span class="num" id="2057314">1</span><span class="op" id="2057315">]</span>&nbsp;<span class="op" id="2057317">+</span>&nbsp;<span class="ident" id="2057319">w</span><span class="op" id="2057320">*</span><span class="op" id="2057321">(</span><span class="ident" id="2057322">_lgamT</span><span class="op" id="2057328">[</span><span class="num" id="2057329">4</span><span class="op" id="2057330">]</span><span class="op" id="2057331">+</span><span class="ident" id="2057332">w</span><span class="op" id="2057333">*</span><span class="op" id="2057334">(</span><span class="ident" id="2057335">_lgamT</span><span class="op" id="2057341">[</span><span class="num" id="2057342">7</span><span class="op" id="2057343">]</span><span class="op" id="2057344">+</span><span class="ident" id="2057345">w</span><span class="op" id="2057346">*</span><span class="op" id="2057347">(</span><span class="ident" id="2057348">_lgamT</span><span class="op" id="2057354">[</span><span class="num" id="2057355">10</span><span class="op" id="2057357">]</span><span class="op" id="2057358">+</span><span class="ident" id="2057359">w</span><span class="op" id="2057360">*</span><span class="ident" id="2057361">_lgamT</span><span class="op" id="2057367">[</span><span class="num" id="2057368">13</span><span class="op" id="2057370">]</span><span class="op" id="2057371">)</span><span class="op" id="2057372">)</span><span class="op" id="2057373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057378">p3</span>&nbsp;<span class="op" id="2057381">:=</span>&nbsp;<span class="ident" id="2057384">_lgamT</span><span class="op" id="2057390">[</span><span class="num" id="2057391">2</span><span class="op" id="2057392">]</span>&nbsp;<span class="op" id="2057394">+</span>&nbsp;<span class="ident" id="2057396">w</span><span class="op" id="2057397">*</span><span class="op" id="2057398">(</span><span class="ident" id="2057399">_lgamT</span><span class="op" id="2057405">[</span><span class="num" id="2057406">5</span><span class="op" id="2057407">]</span><span class="op" id="2057408">+</span><span class="ident" id="2057409">w</span><span class="op" id="2057410">*</span><span class="op" id="2057411">(</span><span class="ident" id="2057412">_lgamT</span><span class="op" id="2057418">[</span><span class="num" id="2057419">8</span><span class="op" id="2057420">]</span><span class="op" id="2057421">+</span><span class="ident" id="2057422">w</span><span class="op" id="2057423">*</span><span class="op" id="2057424">(</span><span class="ident" id="2057425">_lgamT</span><span class="op" id="2057431">[</span><span class="num" id="2057432">11</span><span class="op" id="2057434">]</span><span class="op" id="2057435">+</span><span class="ident" id="2057436">w</span><span class="op" id="2057437">*</span><span class="ident" id="2057438">_lgamT</span><span class="op" id="2057444">[</span><span class="num" id="2057445">14</span><span class="op" id="2057447">]</span><span class="op" id="2057448">)</span><span class="op" id="2057449">)</span><span class="op" id="2057450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057455">p</span>&nbsp;<span class="op" id="2057457">:=</span>&nbsp;<span class="ident" id="2057460">z</span><span class="op" id="2057461">*</span><span class="ident" id="2057462">p1</span>&nbsp;<span class="op" id="2057465">-</span>&nbsp;<span class="op" id="2057467">(</span><span class="ident" id="2057468">Tt</span>&nbsp;<span class="op" id="2057471">-</span>&nbsp;<span class="ident" id="2057473">w</span><span class="op" id="2057474">*</span><span class="op" id="2057475">(</span><span class="ident" id="2057476">p2</span><span class="op" id="2057478">+</span><span class="ident" id="2057479">y</span><span class="op" id="2057480">*</span><span class="ident" id="2057481">p3</span><span class="op" id="2057483">)</span><span class="op" id="2057484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057489">lgamma</span>&nbsp;<span class="op" id="2057496">+=</span>&nbsp;<span class="op" id="2057499">(</span><span class="ident" id="2057500">Tf</span>&nbsp;<span class="op" id="2057503">+</span>&nbsp;<span class="ident" id="2057505">p</span><span class="op" id="2057506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057510">case</span>&nbsp;<span class="num" id="2057515">2</span><span class="op" id="2057516">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057521">p1</span>&nbsp;<span class="op" id="2057524">:=</span>&nbsp;<span class="ident" id="2057527">y</span>&nbsp;<span class="op" id="2057529">*</span>&nbsp;<span class="op" id="2057531">(</span><span class="ident" id="2057532">_lgamU</span><span class="op" id="2057538">[</span><span class="num" id="2057539">0</span><span class="op" id="2057540">]</span>&nbsp;<span class="op" id="2057542">+</span>&nbsp;<span class="ident" id="2057544">y</span><span class="op" id="2057545">*</span><span class="op" id="2057546">(</span><span class="ident" id="2057547">_lgamU</span><span class="op" id="2057553">[</span><span class="num" id="2057554">1</span><span class="op" id="2057555">]</span><span class="op" id="2057556">+</span><span class="ident" id="2057557">y</span><span class="op" id="2057558">*</span><span class="op" id="2057559">(</span><span class="ident" id="2057560">_lgamU</span><span class="op" id="2057566">[</span><span class="num" id="2057567">2</span><span class="op" id="2057568">]</span><span class="op" id="2057569">+</span><span class="ident" id="2057570">y</span><span class="op" id="2057571">*</span><span class="op" id="2057572">(</span><span class="ident" id="2057573">_lgamU</span><span class="op" id="2057579">[</span><span class="num" id="2057580">3</span><span class="op" id="2057581">]</span><span class="op" id="2057582">+</span><span class="ident" id="2057583">y</span><span class="op" id="2057584">*</span><span class="op" id="2057585">(</span><span class="ident" id="2057586">_lgamU</span><span class="op" id="2057592">[</span><span class="num" id="2057593">4</span><span class="op" id="2057594">]</span><span class="op" id="2057595">+</span><span class="ident" id="2057596">y</span><span class="op" id="2057597">*</span><span class="ident" id="2057598">_lgamU</span><span class="op" id="2057604">[</span><span class="num" id="2057605">5</span><span class="op" id="2057606">]</span><span class="op" id="2057607">)</span><span class="op" id="2057608">)</span><span class="op" id="2057609">)</span><span class="op" id="2057610">)</span><span class="op" id="2057611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057616">p2</span>&nbsp;<span class="op" id="2057619">:=</span>&nbsp;<span class="num" id="2057622">1</span>&nbsp;<span class="op" id="2057624">+</span>&nbsp;<span class="ident" id="2057626">y</span><span class="op" id="2057627">*</span><span class="op" id="2057628">(</span><span class="ident" id="2057629">_lgamV</span><span class="op" id="2057635">[</span><span class="num" id="2057636">1</span><span class="op" id="2057637">]</span><span class="op" id="2057638">+</span><span class="ident" id="2057639">y</span><span class="op" id="2057640">*</span><span class="op" id="2057641">(</span><span class="ident" id="2057642">_lgamV</span><span class="op" id="2057648">[</span><span class="num" id="2057649">2</span><span class="op" id="2057650">]</span><span class="op" id="2057651">+</span><span class="ident" id="2057652">y</span><span class="op" id="2057653">*</span><span class="op" id="2057654">(</span><span class="ident" id="2057655">_lgamV</span><span class="op" id="2057661">[</span><span class="num" id="2057662">3</span><span class="op" id="2057663">]</span><span class="op" id="2057664">+</span><span class="ident" id="2057665">y</span><span class="op" id="2057666">*</span><span class="op" id="2057667">(</span><span class="ident" id="2057668">_lgamV</span><span class="op" id="2057674">[</span><span class="num" id="2057675">4</span><span class="op" id="2057676">]</span><span class="op" id="2057677">+</span><span class="ident" id="2057678">y</span><span class="op" id="2057679">*</span><span class="ident" id="2057680">_lgamV</span><span class="op" id="2057686">[</span><span class="num" id="2057687">5</span><span class="op" id="2057688">]</span><span class="op" id="2057689">)</span><span class="op" id="2057690">)</span><span class="op" id="2057691">)</span><span class="op" id="2057692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057697">lgamma</span>&nbsp;<span class="op" id="2057704">+=</span>&nbsp;<span class="op" id="2057707">(</span><span class="op" id="2057708">-</span><span class="num" id="2057709">0.5</span><span class="op" id="2057712">*</span><span class="ident" id="2057713">y</span>&nbsp;<span class="op" id="2057715">+</span>&nbsp;<span class="ident" id="2057717">p1</span><span class="op" id="2057719">/</span><span class="ident" id="2057720">p2</span><span class="op" id="2057722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2057726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2057729">case</span>&nbsp;<span class="ident" id="2057734">x</span>&nbsp;<span class="op" id="2057736">&lt;</span>&nbsp;<span class="num" id="2057738">8</span><span class="op" id="2057739">:</span>&nbsp;<span class="comment" id="2057741">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057757">i</span>&nbsp;<span class="op" id="2057759">:=</span>&nbsp;<span class="builtintype" id="2057762">int</span><span class="op" id="2057765">(</span><span class="ident" id="2057766">x</span><span class="op" id="2057767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057771">y</span>&nbsp;<span class="op" id="2057773">:=</span>&nbsp;<span class="ident" id="2057776">x</span>&nbsp;<span class="op" id="2057778">-</span>&nbsp;<span class="builtintype" id="2057780">float64</span><span class="op" id="2057787">(</span><span class="ident" id="2057788">i</span><span class="op" id="2057789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057793">p</span>&nbsp;<span class="op" id="2057795">:=</span>&nbsp;<span class="ident" id="2057798">y</span>&nbsp;<span class="op" id="2057800">*</span>&nbsp;<span class="op" id="2057802">(</span><span class="ident" id="2057803">_lgamS</span><span class="op" id="2057809">[</span><span class="num" id="2057810">0</span><span class="op" id="2057811">]</span>&nbsp;<span class="op" id="2057813">+</span>&nbsp;<span class="ident" id="2057815">y</span><span class="op" id="2057816">*</span><span class="op" id="2057817">(</span><span class="ident" id="2057818">_lgamS</span><span class="op" id="2057824">[</span><span class="num" id="2057825">1</span><span class="op" id="2057826">]</span><span class="op" id="2057827">+</span><span class="ident" id="2057828">y</span><span class="op" id="2057829">*</span><span class="op" id="2057830">(</span><span class="ident" id="2057831">_lgamS</span><span class="op" id="2057837">[</span><span class="num" id="2057838">2</span><span class="op" id="2057839">]</span><span class="op" id="2057840">+</span><span class="ident" id="2057841">y</span><span class="op" id="2057842">*</span><span class="op" id="2057843">(</span><span class="ident" id="2057844">_lgamS</span><span class="op" id="2057850">[</span><span class="num" id="2057851">3</span><span class="op" id="2057852">]</span><span class="op" id="2057853">+</span><span class="ident" id="2057854">y</span><span class="op" id="2057855">*</span><span class="op" id="2057856">(</span><span class="ident" id="2057857">_lgamS</span><span class="op" id="2057863">[</span><span class="num" id="2057864">4</span><span class="op" id="2057865">]</span><span class="op" id="2057866">+</span><span class="ident" id="2057867">y</span><span class="op" id="2057868">*</span><span class="op" id="2057869">(</span><span class="ident" id="2057870">_lgamS</span><span class="op" id="2057876">[</span><span class="num" id="2057877">5</span><span class="op" id="2057878">]</span><span class="op" id="2057879">+</span><span class="ident" id="2057880">y</span><span class="op" id="2057881">*</span><span class="ident" id="2057882">_lgamS</span><span class="op" id="2057888">[</span><span class="num" id="2057889">6</span><span class="op" id="2057890">]</span><span class="op" id="2057891">)</span><span class="op" id="2057892">)</span><span class="op" id="2057893">)</span><span class="op" id="2057894">)</span><span class="op" id="2057895">)</span><span class="op" id="2057896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057900">q</span>&nbsp;<span class="op" id="2057902">:=</span>&nbsp;<span class="num" id="2057905">1</span>&nbsp;<span class="op" id="2057907">+</span>&nbsp;<span class="ident" id="2057909">y</span><span class="op" id="2057910">*</span><span class="op" id="2057911">(</span><span class="ident" id="2057912">_lgamR</span><span class="op" id="2057918">[</span><span class="num" id="2057919">1</span><span class="op" id="2057920">]</span><span class="op" id="2057921">+</span><span class="ident" id="2057922">y</span><span class="op" id="2057923">*</span><span class="op" id="2057924">(</span><span class="ident" id="2057925">_lgamR</span><span class="op" id="2057931">[</span><span class="num" id="2057932">2</span><span class="op" id="2057933">]</span><span class="op" id="2057934">+</span><span class="ident" id="2057935">y</span><span class="op" id="2057936">*</span><span class="op" id="2057937">(</span><span class="ident" id="2057938">_lgamR</span><span class="op" id="2057944">[</span><span class="num" id="2057945">3</span><span class="op" id="2057946">]</span><span class="op" id="2057947">+</span><span class="ident" id="2057948">y</span><span class="op" id="2057949">*</span><span class="op" id="2057950">(</span><span class="ident" id="2057951">_lgamR</span><span class="op" id="2057957">[</span><span class="num" id="2057958">4</span><span class="op" id="2057959">]</span><span class="op" id="2057960">+</span><span class="ident" id="2057961">y</span><span class="op" id="2057962">*</span><span class="op" id="2057963">(</span><span class="ident" id="2057964">_lgamR</span><span class="op" id="2057970">[</span><span class="num" id="2057971">5</span><span class="op" id="2057972">]</span><span class="op" id="2057973">+</span><span class="ident" id="2057974">y</span><span class="op" id="2057975">*</span><span class="ident" id="2057976">_lgamR</span><span class="op" id="2057982">[</span><span class="num" id="2057983">6</span><span class="op" id="2057984">]</span><span class="op" id="2057985">)</span><span class="op" id="2057986">)</span><span class="op" id="2057987">)</span><span class="op" id="2057988">)</span><span class="op" id="2057989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2057993">lgamma</span>&nbsp;<span class="op" id="2058000">=</span>&nbsp;<span class="num" id="2058002">0.5</span><span class="op" id="2058005">*</span><span class="ident" id="2058006">y</span>&nbsp;<span class="op" id="2058008">+</span>&nbsp;<span class="ident" id="2058010">p</span><span class="op" id="2058011">/</span><span class="ident" id="2058012">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058016">z</span>&nbsp;<span class="op" id="2058018">:=</span>&nbsp;<span class="num" id="2058021">1.0</span>&nbsp;<span class="comment" id="2058025">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058063">switch</span>&nbsp;<span class="ident" id="2058070">i</span>&nbsp;<span class="op" id="2058072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058076">case</span>&nbsp;<span class="num" id="2058081">7</span><span class="op" id="2058082">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058087">z</span>&nbsp;<span class="op" id="2058089">*=</span>&nbsp;<span class="op" id="2058092">(</span><span class="ident" id="2058093">y</span>&nbsp;<span class="op" id="2058095">+</span>&nbsp;<span class="num" id="2058097">6</span><span class="op" id="2058098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058103">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058117">case</span>&nbsp;<span class="num" id="2058122">6</span><span class="op" id="2058123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058128">z</span>&nbsp;<span class="op" id="2058130">*=</span>&nbsp;<span class="op" id="2058133">(</span><span class="ident" id="2058134">y</span>&nbsp;<span class="op" id="2058136">+</span>&nbsp;<span class="num" id="2058138">5</span><span class="op" id="2058139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058144">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058158">case</span>&nbsp;<span class="num" id="2058163">5</span><span class="op" id="2058164">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058169">z</span>&nbsp;<span class="op" id="2058171">*=</span>&nbsp;<span class="op" id="2058174">(</span><span class="ident" id="2058175">y</span>&nbsp;<span class="op" id="2058177">+</span>&nbsp;<span class="num" id="2058179">4</span><span class="op" id="2058180">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058185">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058199">case</span>&nbsp;<span class="num" id="2058204">4</span><span class="op" id="2058205">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058210">z</span>&nbsp;<span class="op" id="2058212">*=</span>&nbsp;<span class="op" id="2058215">(</span><span class="ident" id="2058216">y</span>&nbsp;<span class="op" id="2058218">+</span>&nbsp;<span class="num" id="2058220">3</span><span class="op" id="2058221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058226">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058240">case</span>&nbsp;<span class="num" id="2058245">3</span><span class="op" id="2058246">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058251">z</span>&nbsp;<span class="op" id="2058253">*=</span>&nbsp;<span class="op" id="2058256">(</span><span class="ident" id="2058257">y</span>&nbsp;<span class="op" id="2058259">+</span>&nbsp;<span class="num" id="2058261">2</span><span class="op" id="2058262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058267">lgamma</span>&nbsp;<span class="op" id="2058274">+=</span>&nbsp;<span class="ident" id="2058277">Log</span><span class="op" id="2058280">(</span><span class="ident" id="2058281">z</span><span class="op" id="2058282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058289">case</span>&nbsp;<span class="ident" id="2058294">x</span>&nbsp;<span class="op" id="2058296">&lt;</span>&nbsp;<span class="ident" id="2058298">Two58</span><span class="op" id="2058303">:</span>&nbsp;<span class="comment" id="2058305">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058325">t</span>&nbsp;<span class="op" id="2058327">:=</span>&nbsp;<span class="ident" id="2058330">Log</span><span class="op" id="2058333">(</span><span class="ident" id="2058334">x</span><span class="op" id="2058335">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058339">z</span>&nbsp;<span class="op" id="2058341">:=</span>&nbsp;<span class="num" id="2058344">1</span>&nbsp;<span class="op" id="2058346">/</span>&nbsp;<span class="ident" id="2058348">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058352">y</span>&nbsp;<span class="op" id="2058354">:=</span>&nbsp;<span class="ident" id="2058357">z</span>&nbsp;<span class="op" id="2058359">*</span>&nbsp;<span class="ident" id="2058361">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058365">w</span>&nbsp;<span class="op" id="2058367">:=</span>&nbsp;<span class="ident" id="2058370">_lgamW</span><span class="op" id="2058376">[</span><span class="num" id="2058377">0</span><span class="op" id="2058378">]</span>&nbsp;<span class="op" id="2058380">+</span>&nbsp;<span class="ident" id="2058382">z</span><span class="op" id="2058383">*</span><span class="op" id="2058384">(</span><span class="ident" id="2058385">_lgamW</span><span class="op" id="2058391">[</span><span class="num" id="2058392">1</span><span class="op" id="2058393">]</span><span class="op" id="2058394">+</span><span class="ident" id="2058395">y</span><span class="op" id="2058396">*</span><span class="op" id="2058397">(</span><span class="ident" id="2058398">_lgamW</span><span class="op" id="2058404">[</span><span class="num" id="2058405">2</span><span class="op" id="2058406">]</span><span class="op" id="2058407">+</span><span class="ident" id="2058408">y</span><span class="op" id="2058409">*</span><span class="op" id="2058410">(</span><span class="ident" id="2058411">_lgamW</span><span class="op" id="2058417">[</span><span class="num" id="2058418">3</span><span class="op" id="2058419">]</span><span class="op" id="2058420">+</span><span class="ident" id="2058421">y</span><span class="op" id="2058422">*</span><span class="op" id="2058423">(</span><span class="ident" id="2058424">_lgamW</span><span class="op" id="2058430">[</span><span class="num" id="2058431">4</span><span class="op" id="2058432">]</span><span class="op" id="2058433">+</span><span class="ident" id="2058434">y</span><span class="op" id="2058435">*</span><span class="op" id="2058436">(</span><span class="ident" id="2058437">_lgamW</span><span class="op" id="2058443">[</span><span class="num" id="2058444">5</span><span class="op" id="2058445">]</span><span class="op" id="2058446">+</span><span class="ident" id="2058447">y</span><span class="op" id="2058448">*</span><span class="ident" id="2058449">_lgamW</span><span class="op" id="2058455">[</span><span class="num" id="2058456">6</span><span class="op" id="2058457">]</span><span class="op" id="2058458">)</span><span class="op" id="2058459">)</span><span class="op" id="2058460">)</span><span class="op" id="2058461">)</span><span class="op" id="2058462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058466">lgamma</span>&nbsp;<span class="op" id="2058473">=</span>&nbsp;<span class="op" id="2058475">(</span><span class="ident" id="2058476">x</span><span class="op" id="2058477">-</span><span class="num" id="2058478">0.5</span><span class="op" id="2058481">)</span><span class="op" id="2058482">*</span><span class="op" id="2058483">(</span><span class="ident" id="2058484">t</span><span class="op" id="2058485">-</span><span class="num" id="2058486">1</span><span class="op" id="2058487">)</span>&nbsp;<span class="op" id="2058489">+</span>&nbsp;<span class="ident" id="2058491">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058494">default</span><span class="op" id="2058501">:</span>&nbsp;<span class="comment" id="2058503">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058526">lgamma</span>&nbsp;<span class="op" id="2058533">=</span>&nbsp;<span class="ident" id="2058535">x</span>&nbsp;<span class="op" id="2058537">*</span>&nbsp;<span class="op" id="2058539">(</span><span class="ident" id="2058540">Log</span><span class="op" id="2058543">(</span><span class="ident" id="2058544">x</span><span class="op" id="2058545">)</span>&nbsp;<span class="op" id="2058547">-</span>&nbsp;<span class="num" id="2058549">1</span><span class="op" id="2058550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058556">if</span>&nbsp;<span class="ident" id="2058559">neg</span>&nbsp;<span class="op" id="2058563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058567">lgamma</span>&nbsp;<span class="op" id="2058574">=</span>&nbsp;<span class="ident" id="2058576">nadj</span>&nbsp;<span class="op" id="2058581">-</span>&nbsp;<span class="ident" id="2058583">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058591">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058594">return</span><br>
<span class="lineno"></span><span class="op" id="2058601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2058604">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2058652">func</span>&nbsp;<span class="ident" id="2058657">sinPi</span><span class="op" id="2058662">(</span><span class="ident" id="2058663">x</span>&nbsp;<span class="builtintype" id="2058665">float64</span><span class="op" id="2058672">)</span>&nbsp;<span class="builtintype" id="2058674">float64</span>&nbsp;<span class="op" id="2058682">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058685">const</span>&nbsp;<span class="op" id="2058691">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058695">Two52</span>&nbsp;<span class="op" id="2058701">=</span>&nbsp;<span class="num" id="2058703">1</span>&nbsp;<span class="op" id="2058705">&lt;&lt;</span>&nbsp;<span class="num" id="2058708">52</span>&nbsp;<span class="comment" id="2058711">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058747">Two53</span>&nbsp;<span class="op" id="2058753">=</span>&nbsp;<span class="num" id="2058755">1</span>&nbsp;<span class="op" id="2058757">&lt;&lt;</span>&nbsp;<span class="num" id="2058760">53</span>&nbsp;<span class="comment" id="2058763">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058801">if</span>&nbsp;<span class="ident" id="2058804">x</span>&nbsp;<span class="op" id="2058806">&lt;</span>&nbsp;<span class="num" id="2058808">0.25</span>&nbsp;<span class="op" id="2058813">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058817">return</span>&nbsp;<span class="op" id="2058824">-</span><span class="ident" id="2058825">Sin</span><span class="op" id="2058828">(</span><span class="ident" id="2058829">Pi</span>&nbsp;<span class="op" id="2058832">*</span>&nbsp;<span class="ident" id="2058834">x</span><span class="op" id="2058835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058838">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2058842">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058865">z</span>&nbsp;<span class="op" id="2058867">:=</span>&nbsp;<span class="ident" id="2058870">Floor</span><span class="op" id="2058875">(</span><span class="ident" id="2058876">x</span><span class="op" id="2058877">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058880">var</span>&nbsp;<span class="ident" id="2058884">n</span>&nbsp;<span class="builtintype" id="2058886">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058891">if</span>&nbsp;<span class="ident" id="2058894">z</span>&nbsp;<span class="op" id="2058896">!=</span>&nbsp;<span class="ident" id="2058899">x</span>&nbsp;<span class="op" id="2058901">{</span>&nbsp;<span class="comment" id="2058903">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058916">x</span>&nbsp;<span class="op" id="2058918">=</span>&nbsp;<span class="ident" id="2058920">Mod</span><span class="op" id="2058923">(</span><span class="ident" id="2058924">x</span><span class="op" id="2058925">,</span>&nbsp;<span class="num" id="2058927">2</span><span class="op" id="2058928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058932">n</span>&nbsp;<span class="op" id="2058934">=</span>&nbsp;<span class="builtintype" id="2058936">int</span><span class="op" id="2058939">(</span><span class="ident" id="2058940">x</span>&nbsp;<span class="op" id="2058942">*</span>&nbsp;<span class="num" id="2058944">4</span><span class="op" id="2058945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2058948">}</span>&nbsp;<span class="keyword" id="2058950">else</span>&nbsp;<span class="op" id="2058955">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2058959">if</span>&nbsp;<span class="ident" id="2058962">x</span>&nbsp;<span class="op" id="2058964">&gt;=</span>&nbsp;<span class="ident" id="2058967">Two53</span>&nbsp;<span class="op" id="2058973">{</span>&nbsp;<span class="comment" id="2058975">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2058996">x</span>&nbsp;<span class="op" id="2058998">=</span>&nbsp;<span class="num" id="2059000">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059005">n</span>&nbsp;<span class="op" id="2059007">=</span>&nbsp;<span class="num" id="2059009">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059013">}</span>&nbsp;<span class="keyword" id="2059015">else</span>&nbsp;<span class="op" id="2059020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059025">if</span>&nbsp;<span class="ident" id="2059028">x</span>&nbsp;<span class="op" id="2059030">&lt;</span>&nbsp;<span class="ident" id="2059032">Two52</span>&nbsp;<span class="op" id="2059038">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059044">z</span>&nbsp;<span class="op" id="2059046">=</span>&nbsp;<span class="ident" id="2059048">x</span>&nbsp;<span class="op" id="2059050">+</span>&nbsp;<span class="ident" id="2059052">Two52</span>&nbsp;<span class="comment" id="2059058">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059075">n</span>&nbsp;<span class="op" id="2059077">=</span>&nbsp;<span class="builtintype" id="2059079">int</span><span class="op" id="2059082">(</span><span class="num" id="2059083">1</span>&nbsp;<span class="op" id="2059085">&amp;</span>&nbsp;<span class="ident" id="2059087">Float64bits</span><span class="op" id="2059098">(</span><span class="ident" id="2059099">z</span><span class="op" id="2059100">)</span><span class="op" id="2059101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059106">x</span>&nbsp;<span class="op" id="2059108">=</span>&nbsp;<span class="builtintype" id="2059110">float64</span><span class="op" id="2059117">(</span><span class="ident" id="2059118">n</span><span class="op" id="2059119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059124">n</span>&nbsp;<span class="op" id="2059126">&lt;&lt;=</span>&nbsp;<span class="num" id="2059130">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059140">switch</span>&nbsp;<span class="ident" id="2059147">n</span>&nbsp;<span class="op" id="2059149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059152">case</span>&nbsp;<span class="num" id="2059157">0</span><span class="op" id="2059158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059162">x</span>&nbsp;<span class="op" id="2059164">=</span>&nbsp;<span class="ident" id="2059166">Sin</span><span class="op" id="2059169">(</span><span class="ident" id="2059170">Pi</span>&nbsp;<span class="op" id="2059173">*</span>&nbsp;<span class="ident" id="2059175">x</span><span class="op" id="2059176">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059179">case</span>&nbsp;<span class="num" id="2059184">1</span><span class="op" id="2059185">,</span>&nbsp;<span class="num" id="2059187">2</span><span class="op" id="2059188">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059192">x</span>&nbsp;<span class="op" id="2059194">=</span>&nbsp;<span class="ident" id="2059196">Cos</span><span class="op" id="2059199">(</span><span class="ident" id="2059200">Pi</span>&nbsp;<span class="op" id="2059203">*</span>&nbsp;<span class="op" id="2059205">(</span><span class="num" id="2059206">0.5</span>&nbsp;<span class="op" id="2059210">-</span>&nbsp;<span class="ident" id="2059212">x</span><span class="op" id="2059213">)</span><span class="op" id="2059214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059217">case</span>&nbsp;<span class="num" id="2059222">3</span><span class="op" id="2059223">,</span>&nbsp;<span class="num" id="2059225">4</span><span class="op" id="2059226">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059230">x</span>&nbsp;<span class="op" id="2059232">=</span>&nbsp;<span class="ident" id="2059234">Sin</span><span class="op" id="2059237">(</span><span class="ident" id="2059238">Pi</span>&nbsp;<span class="op" id="2059241">*</span>&nbsp;<span class="op" id="2059243">(</span><span class="num" id="2059244">1</span>&nbsp;<span class="op" id="2059246">-</span>&nbsp;<span class="ident" id="2059248">x</span><span class="op" id="2059249">)</span><span class="op" id="2059250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059253">case</span>&nbsp;<span class="num" id="2059258">5</span><span class="op" id="2059259">,</span>&nbsp;<span class="num" id="2059261">6</span><span class="op" id="2059262">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059266">x</span>&nbsp;<span class="op" id="2059268">=</span>&nbsp;<span class="op" id="2059270">-</span><span class="ident" id="2059271">Cos</span><span class="op" id="2059274">(</span><span class="ident" id="2059275">Pi</span>&nbsp;<span class="op" id="2059278">*</span>&nbsp;<span class="op" id="2059280">(</span><span class="ident" id="2059281">x</span>&nbsp;<span class="op" id="2059283">-</span>&nbsp;<span class="num" id="2059285">1.5</span><span class="op" id="2059288">)</span><span class="op" id="2059289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059292">default</span><span class="op" id="2059299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2059303">x</span>&nbsp;<span class="op" id="2059305">=</span>&nbsp;<span class="ident" id="2059307">Sin</span><span class="op" id="2059310">(</span><span class="ident" id="2059311">Pi</span>&nbsp;<span class="op" id="2059314">*</span>&nbsp;<span class="op" id="2059316">(</span><span class="ident" id="2059317">x</span>&nbsp;<span class="op" id="2059319">-</span>&nbsp;<span class="num" id="2059321">2</span><span class="op" id="2059322">)</span><span class="op" id="2059323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2059326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2059329">return</span>&nbsp;<span class="op" id="2059336">-</span><span class="ident" id="2059337">x</span><br>
<span class="lineno">365</span><span class="op" id="2059339">}</span>
</div>
</body>
</html>
