<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html" class="current">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3487737">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3487792">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3487846">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3487897">package</span>&nbsp;<span class="ident" id="3487905">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3487911">import</span>&nbsp;<span class="op" id="3487918">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3487921">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3487928">&#34;io&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3487933">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3487936">//&nbsp;fileTransport&nbsp;implements&nbsp;RoundTripper&nbsp;for&nbsp;the&nbsp;&#39;file&#39;&nbsp;protocol.</span><br>
<span class="lineno"></span><span class="keyword" id="3488002">type</span>&nbsp;<span class="ident" id="3488007">fileTransport</span>&nbsp;<span class="keyword" id="3488021">struct</span>&nbsp;<span class="op" id="3488028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3488031">fh</span>&nbsp;<span class="ident" id="3488034">fileHandler</span><br>
<span class="lineno">15</span><span class="op" id="3488046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3488049">//&nbsp;NewFileTransport&nbsp;returns&nbsp;a&nbsp;new&nbsp;RoundTripper,&nbsp;serving&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span><span class="comment" id="3488118">//&nbsp;FileSystem.&nbsp;The&nbsp;returned&nbsp;RoundTripper&nbsp;ignores&nbsp;the&nbsp;URL&nbsp;host&nbsp;in&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="3488187">//&nbsp;incoming&nbsp;requests,&nbsp;as&nbsp;well&nbsp;as&nbsp;most&nbsp;other&nbsp;properties&nbsp;of&nbsp;the</span><br>
<span class="lineno">20</span><span class="comment" id="3488249">//&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="3488261">//</span><br>
<span class="lineno"></span><span class="comment" id="3488264">//&nbsp;The&nbsp;typical&nbsp;use&nbsp;case&nbsp;for&nbsp;NewFileTransport&nbsp;is&nbsp;to&nbsp;register&nbsp;the&nbsp;&#34;file&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3488335">//&nbsp;protocol&nbsp;with&nbsp;a&nbsp;Transport,&nbsp;as&nbsp;in:</span><br>
<span class="lineno"></span><span class="comment" id="3488372">//</span><br>
<span class="lineno">25</span><span class="comment" id="3488375">//&nbsp;&nbsp;&nbsp;t&nbsp;:=&nbsp;&amp;http.Transport{}</span><br>
<span class="lineno"></span><span class="comment" id="3488403">//&nbsp;&nbsp;&nbsp;t.RegisterProtocol(&#34;file&#34;,&nbsp;http.NewFileTransport(http.Dir(&#34;/&#34;)))</span><br>
<span class="lineno"></span><span class="comment" id="3488473">//&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;&amp;http.Client{Transport:&nbsp;t}</span><br>
<span class="lineno"></span><span class="comment" id="3488510">//&nbsp;&nbsp;&nbsp;res,&nbsp;err&nbsp;:=&nbsp;c.Get(&#34;file:///etc/passwd&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="3488555">//&nbsp;&nbsp;&nbsp;...</span><br>
<span class="lineno">30</span><span class="keyword" id="3488564">func</span>&nbsp;<span class="ident" id="3488569">NewFileTransport</span><span class="op" id="3488585">(</span><span class="ident" id="3488586">fs</span>&nbsp;<span class="ident" id="3488589">FileSystem</span><span class="op" id="3488599">)</span>&nbsp;<span class="ident" id="3488601">RoundTripper</span>&nbsp;<span class="op" id="3488614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3488617">return</span>&nbsp;<span class="ident" id="3488624">fileTransport</span><span class="op" id="3488637">{</span><span class="ident" id="3488638">fileHandler</span><span class="op" id="3488649">{</span><span class="ident" id="3488650">fs</span><span class="op" id="3488652">}</span><span class="op" id="3488653">}</span><br>
<span class="lineno"></span><span class="op" id="3488655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488658">func</span>&nbsp;<span class="op" id="3488663">(</span><span class="ident" id="3488664">t</span>&nbsp;<span class="ident" id="3488666">fileTransport</span><span class="op" id="3488679">)</span>&nbsp;<span class="ident" id="3488681">RoundTrip</span><span class="op" id="3488690">(</span><span class="ident" id="3488691">req</span>&nbsp;<span class="op" id="3488695">*</span><span class="ident" id="3488696">Request</span><span class="op" id="3488703">)</span>&nbsp;<span class="op" id="3488705">(</span><span class="ident" id="3488706">resp</span>&nbsp;<span class="op" id="3488711">*</span><span class="ident" id="3488712">Response</span><span class="op" id="3488720">,</span>&nbsp;<span class="ident" id="3488722">err</span>&nbsp;<span class="builtintype" id="3488726">error</span><span class="op" id="3488731">)</span>&nbsp;<span class="op" id="3488733">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3488736">//&nbsp;We&nbsp;start&nbsp;ServeHTTP&nbsp;in&nbsp;a&nbsp;goroutine,&nbsp;which&nbsp;may&nbsp;take&nbsp;a&nbsp;long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3488797">//&nbsp;time&nbsp;if&nbsp;the&nbsp;file&nbsp;is&nbsp;large.&nbsp;&nbsp;The&nbsp;newPopulateResponseWriter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3488859">//&nbsp;call&nbsp;returns&nbsp;a&nbsp;channel&nbsp;which&nbsp;either&nbsp;ServeHTTP&nbsp;or&nbsp;finish()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3488921">//&nbsp;sends&nbsp;our&nbsp;*Response&nbsp;on,&nbsp;once&nbsp;the&nbsp;*Response&nbsp;itself&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3488984">//&nbsp;populated&nbsp;(even&nbsp;if&nbsp;the&nbsp;body&nbsp;itself&nbsp;is&nbsp;still&nbsp;being</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3489038">//&nbsp;written&nbsp;to&nbsp;the&nbsp;res.Body,&nbsp;a&nbsp;pipe)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489075">rw</span><span class="op" id="3489077">,</span>&nbsp;<span class="ident" id="3489079">resc</span>&nbsp;<span class="op" id="3489084">:=</span>&nbsp;<span class="ident" id="3489087">newPopulateResponseWriter</span><span class="op" id="3489112">(</span><span class="op" id="3489113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489116">go</span>&nbsp;<span class="keyword" id="3489119">func</span><span class="op" id="3489123">(</span><span class="op" id="3489124">)</span>&nbsp;<span class="op" id="3489126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489130">t</span><span class="op" id="3489131">.</span><span class="ident" id="3489132">fh</span><span class="op" id="3489134">.</span><span class="ident" id="3489135">ServeHTTP</span><span class="op" id="3489144">(</span><span class="ident" id="3489145">rw</span><span class="op" id="3489147">,</span>&nbsp;<span class="ident" id="3489149">req</span><span class="op" id="3489152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489156">rw</span><span class="op" id="3489158">.</span><span class="ident" id="3489159">finish</span><span class="op" id="3489165">(</span><span class="op" id="3489166">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489169">}</span><span class="op" id="3489170">(</span><span class="op" id="3489171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489174">return</span>&nbsp;<span class="op" id="3489181">&lt;-</span><span class="ident" id="3489183">resc</span><span class="op" id="3489187">,</span>&nbsp;<span class="builtintype" id="3489189">nil</span><br>
<span class="lineno"></span><span class="op" id="3489193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489196">func</span>&nbsp;<span class="ident" id="3489201">newPopulateResponseWriter</span><span class="op" id="3489226">(</span><span class="op" id="3489227">)</span>&nbsp;<span class="op" id="3489229">(</span><span class="op" id="3489230">*</span><span class="ident" id="3489231">populateResponse</span><span class="op" id="3489247">,</span>&nbsp;<span class="op" id="3489249">&lt;-</span><span class="keyword" id="3489251">chan</span>&nbsp;<span class="op" id="3489256">*</span><span class="ident" id="3489257">Response</span><span class="op" id="3489265">)</span>&nbsp;<span class="op" id="3489267">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489270">pr</span><span class="op" id="3489272">,</span>&nbsp;<span class="ident" id="3489274">pw</span>&nbsp;<span class="op" id="3489277">:=</span>&nbsp;<span class="ident" id="3489280">io</span><span class="op" id="3489282">.</span><span class="ident" id="3489283">Pipe</span><span class="op" id="3489287">(</span><span class="op" id="3489288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489291">rw</span>&nbsp;<span class="op" id="3489294">:=</span>&nbsp;<span class="op" id="3489297">&amp;</span><span class="ident" id="3489298">populateResponse</span><span class="op" id="3489314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489318">ch</span><span class="op" id="3489320">:</span>&nbsp;<span class="builtinfunc" id="3489322">make</span><span class="op" id="3489326">(</span><span class="keyword" id="3489327">chan</span>&nbsp;<span class="op" id="3489332">*</span><span class="ident" id="3489333">Response</span><span class="op" id="3489341">)</span><span class="op" id="3489342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489346">pw</span><span class="op" id="3489348">:</span>&nbsp;<span class="ident" id="3489350">pw</span><span class="op" id="3489352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489356">res</span><span class="op" id="3489359">:</span>&nbsp;<span class="op" id="3489361">&amp;</span><span class="ident" id="3489362">Response</span><span class="op" id="3489370">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489375">Proto</span><span class="op" id="3489380">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3489387">&#34;HTTP/1.0&#34;</span><span class="op" id="3489397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489402">ProtoMajor</span><span class="op" id="3489412">:</span>&nbsp;<span class="num" id="3489414">1</span><span class="op" id="3489415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489420">Header</span><span class="op" id="3489426">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3489432">make</span><span class="op" id="3489436">(</span><span class="ident" id="3489437">Header</span><span class="op" id="3489443">)</span><span class="op" id="3489444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489449">Close</span><span class="op" id="3489454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3489461">true</span><span class="op" id="3489465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489470">Body</span><span class="op" id="3489474">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489482">pr</span><span class="op" id="3489484">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489488">}</span><span class="op" id="3489489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489495">return</span>&nbsp;<span class="ident" id="3489502">rw</span><span class="op" id="3489504">,</span>&nbsp;<span class="ident" id="3489506">rw</span><span class="op" id="3489508">.</span><span class="ident" id="3489509">ch</span><br>
<span class="lineno"></span><span class="op" id="3489512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="3489515">//&nbsp;populateResponse&nbsp;is&nbsp;a&nbsp;ResponseWriter&nbsp;that&nbsp;populates&nbsp;the&nbsp;*Response</span><br>
<span class="lineno"></span><span class="comment" id="3489584">//&nbsp;in&nbsp;res,&nbsp;and&nbsp;writes&nbsp;its&nbsp;body&nbsp;to&nbsp;a&nbsp;pipe&nbsp;connected&nbsp;to&nbsp;the&nbsp;response</span><br>
<span class="lineno"></span><span class="comment" id="3489651">//&nbsp;body.&nbsp;Once&nbsp;writes&nbsp;begin&nbsp;or&nbsp;finish()&nbsp;is&nbsp;called,&nbsp;the&nbsp;response&nbsp;is&nbsp;sent</span><br>
<span class="lineno"></span><span class="comment" id="3489722">//&nbsp;on&nbsp;ch.</span><br>
<span class="lineno"></span><span class="keyword" id="3489732">type</span>&nbsp;<span class="ident" id="3489737">populateResponse</span>&nbsp;<span class="keyword" id="3489754">struct</span>&nbsp;<span class="op" id="3489761">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489764">res</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489777">*</span><span class="ident" id="3489778">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489788">ch</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489801">chan</span>&nbsp;<span class="op" id="3489806">*</span><span class="ident" id="3489807">Response</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489817">wroteHeader</span>&nbsp;&nbsp;<span class="builtintype" id="3489830">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489836">hasContent</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3489849">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489855">sentResponse</span>&nbsp;<span class="builtintype" id="3489868">bool</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489874">pw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489887">*</span><span class="ident" id="3489888">io</span><span class="op" id="3489890">.</span><span class="ident" id="3489891">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3489902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489905">func</span>&nbsp;<span class="op" id="3489910">(</span><span class="ident" id="3489911">pr</span>&nbsp;<span class="op" id="3489914">*</span><span class="ident" id="3489915">populateResponse</span><span class="op" id="3489931">)</span>&nbsp;<span class="ident" id="3489933">finish</span><span class="op" id="3489939">(</span><span class="op" id="3489940">)</span>&nbsp;<span class="op" id="3489942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489945">if</span>&nbsp;<span class="op" id="3489948">!</span><span class="ident" id="3489949">pr</span><span class="op" id="3489951">.</span><span class="ident" id="3489952">wroteHeader</span>&nbsp;<span class="op" id="3489964">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3489968">pr</span><span class="op" id="3489970">.</span><span class="ident" id="3489971">WriteHeader</span><span class="op" id="3489982">(</span><span class="num" id="3489983">500</span><span class="op" id="3489986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3489989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3489992">if</span>&nbsp;<span class="op" id="3489995">!</span><span class="ident" id="3489996">pr</span><span class="op" id="3489998">.</span><span class="ident" id="3489999">sentResponse</span>&nbsp;<span class="op" id="3490012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490016">pr</span><span class="op" id="3490018">.</span><span class="ident" id="3490019">sendResponse</span><span class="op" id="3490031">(</span><span class="op" id="3490032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490035">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490038">pr</span><span class="op" id="3490040">.</span><span class="ident" id="3490041">pw</span><span class="op" id="3490043">.</span><span class="ident" id="3490044">Close</span><span class="op" id="3490049">(</span><span class="op" id="3490050">)</span><br>
<span class="lineno"></span><span class="op" id="3490052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490055">func</span>&nbsp;<span class="op" id="3490060">(</span><span class="ident" id="3490061">pr</span>&nbsp;<span class="op" id="3490064">*</span><span class="ident" id="3490065">populateResponse</span><span class="op" id="3490081">)</span>&nbsp;<span class="ident" id="3490083">sendResponse</span><span class="op" id="3490095">(</span><span class="op" id="3490096">)</span>&nbsp;<span class="op" id="3490098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490101">if</span>&nbsp;<span class="ident" id="3490104">pr</span><span class="op" id="3490106">.</span><span class="ident" id="3490107">sentResponse</span>&nbsp;<span class="op" id="3490120">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490124">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490135">pr</span><span class="op" id="3490137">.</span><span class="ident" id="3490138">sentResponse</span>&nbsp;<span class="op" id="3490151">=</span>&nbsp;<span class="builtintype" id="3490153">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490160">if</span>&nbsp;<span class="ident" id="3490163">pr</span><span class="op" id="3490165">.</span><span class="ident" id="3490166">hasContent</span>&nbsp;<span class="op" id="3490177">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490181">pr</span><span class="op" id="3490183">.</span><span class="ident" id="3490184">res</span><span class="op" id="3490187">.</span><span class="ident" id="3490188">ContentLength</span>&nbsp;<span class="op" id="3490202">=</span>&nbsp;<span class="op" id="3490204">-</span><span class="num" id="3490205">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490211">pr</span><span class="op" id="3490213">.</span><span class="ident" id="3490214">ch</span>&nbsp;<span class="op" id="3490217">&lt;-</span>&nbsp;<span class="ident" id="3490220">pr</span><span class="op" id="3490222">.</span><span class="ident" id="3490223">res</span><br>
<span class="lineno"></span><span class="op" id="3490227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3490230">func</span>&nbsp;<span class="op" id="3490235">(</span><span class="ident" id="3490236">pr</span>&nbsp;<span class="op" id="3490239">*</span><span class="ident" id="3490240">populateResponse</span><span class="op" id="3490256">)</span>&nbsp;<span class="ident" id="3490258">Header</span><span class="op" id="3490264">(</span><span class="op" id="3490265">)</span>&nbsp;<span class="ident" id="3490267">Header</span>&nbsp;<span class="op" id="3490274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490277">return</span>&nbsp;<span class="ident" id="3490284">pr</span><span class="op" id="3490286">.</span><span class="ident" id="3490287">res</span><span class="op" id="3490290">.</span><span class="ident" id="3490291">Header</span><br>
<span class="lineno"></span><span class="op" id="3490298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490301">func</span>&nbsp;<span class="op" id="3490306">(</span><span class="ident" id="3490307">pr</span>&nbsp;<span class="op" id="3490310">*</span><span class="ident" id="3490311">populateResponse</span><span class="op" id="3490327">)</span>&nbsp;<span class="ident" id="3490329">WriteHeader</span><span class="op" id="3490340">(</span><span class="ident" id="3490341">code</span>&nbsp;<span class="builtintype" id="3490346">int</span><span class="op" id="3490349">)</span>&nbsp;<span class="op" id="3490351">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490354">if</span>&nbsp;<span class="ident" id="3490357">pr</span><span class="op" id="3490359">.</span><span class="ident" id="3490360">wroteHeader</span>&nbsp;<span class="op" id="3490372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490376">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490387">pr</span><span class="op" id="3490389">.</span><span class="ident" id="3490390">wroteHeader</span>&nbsp;<span class="op" id="3490402">=</span>&nbsp;<span class="builtintype" id="3490404">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490411">pr</span><span class="op" id="3490413">.</span><span class="ident" id="3490414">res</span><span class="op" id="3490417">.</span><span class="ident" id="3490418">StatusCode</span>&nbsp;<span class="op" id="3490429">=</span>&nbsp;<span class="ident" id="3490431">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490437">pr</span><span class="op" id="3490439">.</span><span class="ident" id="3490440">res</span><span class="op" id="3490443">.</span><span class="ident" id="3490444">Status</span>&nbsp;<span class="op" id="3490451">=</span>&nbsp;<span class="ident" id="3490453">fmt</span><span class="op" id="3490456">.</span><span class="ident" id="3490457">Sprintf</span><span class="op" id="3490464">(</span><span class="string" id="3490465">&#34;%d&nbsp;%s&#34;</span><span class="op" id="3490472">,</span>&nbsp;<span class="ident" id="3490474">code</span><span class="op" id="3490478">,</span>&nbsp;<span class="ident" id="3490480">StatusText</span><span class="op" id="3490490">(</span><span class="ident" id="3490491">code</span><span class="op" id="3490495">)</span><span class="op" id="3490496">)</span><br>
<span class="lineno"></span><span class="op" id="3490498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490501">func</span>&nbsp;<span class="op" id="3490506">(</span><span class="ident" id="3490507">pr</span>&nbsp;<span class="op" id="3490510">*</span><span class="ident" id="3490511">populateResponse</span><span class="op" id="3490527">)</span>&nbsp;<span class="ident" id="3490529">Write</span><span class="op" id="3490534">(</span><span class="ident" id="3490535">p</span>&nbsp;<span class="op" id="3490537">[</span><span class="op" id="3490538">]</span><span class="builtintype" id="3490539">byte</span><span class="op" id="3490543">)</span>&nbsp;<span class="op" id="3490545">(</span><span class="ident" id="3490546">n</span>&nbsp;<span class="builtintype" id="3490548">int</span><span class="op" id="3490551">,</span>&nbsp;<span class="ident" id="3490553">err</span>&nbsp;<span class="builtintype" id="3490557">error</span><span class="op" id="3490562">)</span>&nbsp;<span class="op" id="3490564">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490567">if</span>&nbsp;<span class="op" id="3490570">!</span><span class="ident" id="3490571">pr</span><span class="op" id="3490573">.</span><span class="ident" id="3490574">wroteHeader</span>&nbsp;<span class="op" id="3490586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490590">pr</span><span class="op" id="3490592">.</span><span class="ident" id="3490593">WriteHeader</span><span class="op" id="3490604">(</span><span class="ident" id="3490605">StatusOK</span><span class="op" id="3490613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490619">pr</span><span class="op" id="3490621">.</span><span class="ident" id="3490622">hasContent</span>&nbsp;<span class="op" id="3490633">=</span>&nbsp;<span class="builtintype" id="3490635">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490641">if</span>&nbsp;<span class="op" id="3490644">!</span><span class="ident" id="3490645">pr</span><span class="op" id="3490647">.</span><span class="ident" id="3490648">sentResponse</span>&nbsp;<span class="op" id="3490661">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3490665">pr</span><span class="op" id="3490667">.</span><span class="ident" id="3490668">sendResponse</span><span class="op" id="3490680">(</span><span class="op" id="3490681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3490687">return</span>&nbsp;<span class="ident" id="3490694">pr</span><span class="op" id="3490696">.</span><span class="ident" id="3490697">pw</span><span class="op" id="3490699">.</span><span class="ident" id="3490700">Write</span><span class="op" id="3490705">(</span><span class="ident" id="3490706">p</span><span class="op" id="3490707">)</span><br>
<span class="lineno"></span><span class="op" id="3490709">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
