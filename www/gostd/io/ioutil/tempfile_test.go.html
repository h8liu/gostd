<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6626641">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6626696">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6626750">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6626801">package</span>&nbsp;<span class="ident" id="6626809">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6626817">import</span>&nbsp;<span class="op" id="6626824">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626827">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626833">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626850">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6626860">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6626870">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6626873">func</span>&nbsp;<span class="ident" id="6626878">TestTempFile</span><span class="op" id="6626890">(</span><span class="ident" id="6626891">t</span>&nbsp;<span class="op" id="6626893">*</span><span class="ident" id="6626894">testing</span><span class="op" id="6626901">.</span><span class="ident" id="6626902">T</span><span class="op" id="6626903">)</span>&nbsp;<span class="op" id="6626905">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626908">f</span><span class="op" id="6626909">,</span>&nbsp;<span class="ident" id="6626911">err</span>&nbsp;<span class="op" id="6626915">:=</span>&nbsp;<span class="ident" id="6626918">TempFile</span><span class="op" id="6626926">(</span><span class="string" id="6626927">&#34;/_not_exists_&#34;</span><span class="op" id="6626942">,</span>&nbsp;<span class="string" id="6626944">&#34;foo&#34;</span><span class="op" id="6626949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6626952">if</span>&nbsp;<span class="ident" id="6626955">f</span>&nbsp;<span class="op" id="6626957">!=</span>&nbsp;<span class="ident" id="6626960">nil</span>&nbsp;<span class="op" id="6626964">||</span>&nbsp;<span class="ident" id="6626967">err</span>&nbsp;<span class="op" id="6626971">==</span>&nbsp;<span class="ident" id="6626974">nil</span>&nbsp;<span class="op" id="6626978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6626982">t</span><span class="op" id="6626983">.</span><span class="ident" id="6626984">Errorf</span><span class="op" id="6626990">(</span><span class="string" id="6626991">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6627034">,</span>&nbsp;<span class="ident" id="6627036">f</span><span class="op" id="6627037">,</span>&nbsp;<span class="ident" id="6627039">err</span><span class="op" id="6627042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627049">dir</span>&nbsp;<span class="op" id="6627053">:=</span>&nbsp;<span class="ident" id="6627056">os</span><span class="op" id="6627058">.</span><span class="ident" id="6627059">TempDir</span><span class="op" id="6627066">(</span><span class="op" id="6627067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627070">f</span><span class="op" id="6627071">,</span>&nbsp;<span class="ident" id="6627073">err</span>&nbsp;<span class="op" id="6627077">=</span>&nbsp;<span class="ident" id="6627079">TempFile</span><span class="op" id="6627087">(</span><span class="ident" id="6627088">dir</span><span class="op" id="6627091">,</span>&nbsp;<span class="string" id="6627093">&#34;ioutil_test&#34;</span><span class="op" id="6627106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627109">if</span>&nbsp;<span class="ident" id="6627112">f</span>&nbsp;<span class="op" id="6627114">==</span>&nbsp;<span class="ident" id="6627117">nil</span>&nbsp;<span class="op" id="6627121">||</span>&nbsp;<span class="ident" id="6627124">err</span>&nbsp;<span class="op" id="6627128">!=</span>&nbsp;<span class="ident" id="6627131">nil</span>&nbsp;<span class="op" id="6627135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627139">t</span><span class="op" id="6627140">.</span><span class="ident" id="6627141">Errorf</span><span class="op" id="6627147">(</span><span class="string" id="6627148">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6627187">,</span>&nbsp;<span class="ident" id="6627189">f</span><span class="op" id="6627190">,</span>&nbsp;<span class="ident" id="6627192">err</span><span class="op" id="6627195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627198">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627201">if</span>&nbsp;<span class="ident" id="6627204">f</span>&nbsp;<span class="op" id="6627206">!=</span>&nbsp;<span class="ident" id="6627209">nil</span>&nbsp;<span class="op" id="6627213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627217">f</span><span class="op" id="6627218">.</span><span class="ident" id="6627219">Close</span><span class="op" id="6627224">(</span><span class="op" id="6627225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627229">os</span><span class="op" id="6627231">.</span><span class="ident" id="6627232">Remove</span><span class="op" id="6627238">(</span><span class="ident" id="6627239">f</span><span class="op" id="6627240">.</span><span class="ident" id="6627241">Name</span><span class="op" id="6627245">(</span><span class="op" id="6627246">)</span><span class="op" id="6627247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627251">re</span>&nbsp;<span class="op" id="6627254">:=</span>&nbsp;<span class="ident" id="6627257">regexp</span><span class="op" id="6627263">.</span><span class="ident" id="6627264">MustCompile</span><span class="op" id="6627275">(</span><span class="string" id="6627276">&#34;^&#34;</span>&nbsp;<span class="op" id="6627280">+</span>&nbsp;<span class="ident" id="6627282">regexp</span><span class="op" id="6627288">.</span><span class="ident" id="6627289">QuoteMeta</span><span class="op" id="6627298">(</span><span class="ident" id="6627299">filepath</span><span class="op" id="6627307">.</span><span class="ident" id="6627308">Join</span><span class="op" id="6627312">(</span><span class="ident" id="6627313">dir</span><span class="op" id="6627316">,</span>&nbsp;<span class="string" id="6627318">&#34;ioutil_test&#34;</span><span class="op" id="6627331">)</span><span class="op" id="6627332">)</span>&nbsp;<span class="op" id="6627334">+</span>&nbsp;<span class="string" id="6627336">&#34;[0-9]+$&#34;</span><span class="op" id="6627345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627349">if</span>&nbsp;<span class="op" id="6627352">!</span><span class="ident" id="6627353">re</span><span class="op" id="6627355">.</span><span class="ident" id="6627356">MatchString</span><span class="op" id="6627367">(</span><span class="ident" id="6627368">f</span><span class="op" id="6627369">.</span><span class="ident" id="6627370">Name</span><span class="op" id="6627374">(</span><span class="op" id="6627375">)</span><span class="op" id="6627376">)</span>&nbsp;<span class="op" id="6627378">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627383">t</span><span class="op" id="6627384">.</span><span class="ident" id="6627385">Errorf</span><span class="op" id="6627391">(</span><span class="string" id="6627392">&#34;TempFile(`&#34;</span><span class="op" id="6627404">+</span><span class="ident" id="6627405">dir</span><span class="op" id="6627408">+</span><span class="string" id="6627409">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6627448">,</span>&nbsp;<span class="ident" id="6627450">f</span><span class="op" id="6627451">.</span><span class="ident" id="6627452">Name</span><span class="op" id="6627456">(</span><span class="op" id="6627457">)</span><span class="op" id="6627458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627465">}</span><br>
<span class="lineno"></span><span class="op" id="6627467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6627470">func</span>&nbsp;<span class="ident" id="6627475">TestTempDir</span><span class="op" id="6627486">(</span><span class="ident" id="6627487">t</span>&nbsp;<span class="op" id="6627489">*</span><span class="ident" id="6627490">testing</span><span class="op" id="6627497">.</span><span class="ident" id="6627498">T</span><span class="op" id="6627499">)</span>&nbsp;<span class="op" id="6627501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627504">name</span><span class="op" id="6627508">,</span>&nbsp;<span class="ident" id="6627510">err</span>&nbsp;<span class="op" id="6627514">:=</span>&nbsp;<span class="ident" id="6627517">TempDir</span><span class="op" id="6627524">(</span><span class="string" id="6627525">&#34;/_not_exists_&#34;</span><span class="op" id="6627540">,</span>&nbsp;<span class="string" id="6627542">&#34;foo&#34;</span><span class="op" id="6627547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627550">if</span>&nbsp;<span class="ident" id="6627553">name</span>&nbsp;<span class="op" id="6627558">!=</span>&nbsp;<span class="string" id="6627561">&#34;&#34;</span>&nbsp;<span class="op" id="6627564">||</span>&nbsp;<span class="ident" id="6627567">err</span>&nbsp;<span class="op" id="6627571">==</span>&nbsp;<span class="ident" id="6627574">nil</span>&nbsp;<span class="op" id="6627578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627582">t</span><span class="op" id="6627583">.</span><span class="ident" id="6627584">Errorf</span><span class="op" id="6627590">(</span><span class="string" id="6627591">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6627633">,</span>&nbsp;<span class="ident" id="6627635">name</span><span class="op" id="6627639">,</span>&nbsp;<span class="ident" id="6627641">err</span><span class="op" id="6627644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627647">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627651">dir</span>&nbsp;<span class="op" id="6627655">:=</span>&nbsp;<span class="ident" id="6627658">os</span><span class="op" id="6627660">.</span><span class="ident" id="6627661">TempDir</span><span class="op" id="6627668">(</span><span class="op" id="6627669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627672">name</span><span class="op" id="6627676">,</span>&nbsp;<span class="ident" id="6627678">err</span>&nbsp;<span class="op" id="6627682">=</span>&nbsp;<span class="ident" id="6627684">TempDir</span><span class="op" id="6627691">(</span><span class="ident" id="6627692">dir</span><span class="op" id="6627695">,</span>&nbsp;<span class="string" id="6627697">&#34;ioutil_test&#34;</span><span class="op" id="6627710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627713">if</span>&nbsp;<span class="ident" id="6627716">name</span>&nbsp;<span class="op" id="6627721">==</span>&nbsp;<span class="string" id="6627724">&#34;&#34;</span>&nbsp;<span class="op" id="6627727">||</span>&nbsp;<span class="ident" id="6627730">err</span>&nbsp;<span class="op" id="6627734">!=</span>&nbsp;<span class="ident" id="6627737">nil</span>&nbsp;<span class="op" id="6627741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627745">t</span><span class="op" id="6627746">.</span><span class="ident" id="6627747">Errorf</span><span class="op" id="6627753">(</span><span class="string" id="6627754">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="6627792">,</span>&nbsp;<span class="ident" id="6627794">name</span><span class="op" id="6627798">,</span>&nbsp;<span class="ident" id="6627800">err</span><span class="op" id="6627803">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6627806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627809">if</span>&nbsp;<span class="ident" id="6627812">name</span>&nbsp;<span class="op" id="6627817">!=</span>&nbsp;<span class="string" id="6627820">&#34;&#34;</span>&nbsp;<span class="op" id="6627823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627827">os</span><span class="op" id="6627829">.</span><span class="ident" id="6627830">Remove</span><span class="op" id="6627836">(</span><span class="ident" id="6627837">name</span><span class="op" id="6627841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627845">re</span>&nbsp;<span class="op" id="6627848">:=</span>&nbsp;<span class="ident" id="6627851">regexp</span><span class="op" id="6627857">.</span><span class="ident" id="6627858">MustCompile</span><span class="op" id="6627869">(</span><span class="string" id="6627870">&#34;^&#34;</span>&nbsp;<span class="op" id="6627874">+</span>&nbsp;<span class="ident" id="6627876">regexp</span><span class="op" id="6627882">.</span><span class="ident" id="6627883">QuoteMeta</span><span class="op" id="6627892">(</span><span class="ident" id="6627893">filepath</span><span class="op" id="6627901">.</span><span class="ident" id="6627902">Join</span><span class="op" id="6627906">(</span><span class="ident" id="6627907">dir</span><span class="op" id="6627910">,</span>&nbsp;<span class="string" id="6627912">&#34;ioutil_test&#34;</span><span class="op" id="6627925">)</span><span class="op" id="6627926">)</span>&nbsp;<span class="op" id="6627928">+</span>&nbsp;<span class="string" id="6627930">&#34;[0-9]+$&#34;</span><span class="op" id="6627939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6627943">if</span>&nbsp;<span class="op" id="6627946">!</span><span class="ident" id="6627947">re</span><span class="op" id="6627949">.</span><span class="ident" id="6627950">MatchString</span><span class="op" id="6627961">(</span><span class="ident" id="6627962">name</span><span class="op" id="6627966">)</span>&nbsp;<span class="op" id="6627968">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6627973">t</span><span class="op" id="6627974">.</span><span class="ident" id="6627975">Errorf</span><span class="op" id="6627981">(</span><span class="string" id="6627982">&#34;TempDir(`&#34;</span><span class="op" id="6627993">+</span><span class="ident" id="6627994">dir</span><span class="op" id="6627997">+</span><span class="string" id="6627998">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="6628037">,</span>&nbsp;<span class="ident" id="6628039">name</span><span class="op" id="6628043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6628047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6628050">}</span><br>
<span class="lineno"></span><span class="op" id="6628052">}</span>
</div>
</body>
</html>
