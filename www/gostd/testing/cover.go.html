<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing</h2>
<ul>
<li><a href="/gostd/testing/allocs.go.html">allocs.go</a></li>
<li><a href="/gostd/testing/allocs_test.go.html">allocs_test.go</a></li>
<li><a href="/gostd/testing/benchmark.go.html">benchmark.go</a></li>
<li><a href="/gostd/testing/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/testing/cover.go.html" class="current">cover.go</a></li>
<li><a href="/gostd/testing/example.go.html">example.go</a></li>
<li><a href="/gostd/testing/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/testing/testing.go.html">testing.go</a></li>
<li><a href="/gostd/testing/testing_test.go.html">testing_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6345797">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6345852">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6345906">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6345957">//&nbsp;Support&nbsp;for&nbsp;test&nbsp;coverage.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6345988">package</span>&nbsp;<span class="ident" id="6345996">testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6346005">import</span>&nbsp;<span class="op" id="6346012">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6346015">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6346022">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6346028">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span><span class="op" id="6346042">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6346045">//&nbsp;CoverBlock&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;for&nbsp;a&nbsp;single&nbsp;basic&nbsp;block.</span><br>
<span class="lineno"></span><span class="comment" id="6346111">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6346190">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6346255">type</span>&nbsp;<span class="ident" id="6346260">CoverBlock</span>&nbsp;<span class="keyword" id="6346271">struct</span>&nbsp;<span class="op" id="6346278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346281">Line0</span>&nbsp;<span class="builtintype" id="6346287">uint32</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346295">Col0</span>&nbsp;&nbsp;<span class="builtintype" id="6346301">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346309">Line1</span>&nbsp;<span class="builtintype" id="6346315">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346323">Col1</span>&nbsp;&nbsp;<span class="builtintype" id="6346329">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346337">Stmts</span>&nbsp;<span class="builtintype" id="6346343">uint16</span><br>
<span class="lineno"></span><span class="op" id="6346350">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="6346353">var</span>&nbsp;<span class="ident" id="6346357">cover</span>&nbsp;<span class="ident" id="6346363">Cover</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346370">//&nbsp;Cover&nbsp;records&nbsp;information&nbsp;about&nbsp;test&nbsp;coverage&nbsp;checking.</span><br>
<span class="lineno"></span><span class="comment" id="6346429">//&nbsp;NOTE:&nbsp;This&nbsp;struct&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno">30</span><span class="comment" id="6346508">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6346573">type</span>&nbsp;<span class="ident" id="6346578">Cover</span>&nbsp;<span class="keyword" id="6346584">struct</span>&nbsp;<span class="op" id="6346591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346594">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6346610">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346618">Counters</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6346634">map</span><span class="op" id="6346637">[</span><span class="builtintype" id="6346638">string</span><span class="op" id="6346644">]</span><span class="op" id="6346645">[</span><span class="op" id="6346646">]</span><span class="builtintype" id="6346647">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346655">Blocks</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6346671">map</span><span class="op" id="6346674">[</span><span class="builtintype" id="6346675">string</span><span class="op" id="6346681">]</span><span class="op" id="6346682">[</span><span class="op" id="6346683">]</span><span class="ident" id="6346684">CoverBlock</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6346696">CoveredPackages</span>&nbsp;<span class="builtintype" id="6346712">string</span><br>
<span class="lineno"></span><span class="op" id="6346719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6346722">//&nbsp;Coverage&nbsp;reports&nbsp;the&nbsp;current&nbsp;code&nbsp;coverage&nbsp;as&nbsp;a&nbsp;fraction&nbsp;in&nbsp;the&nbsp;range&nbsp;[0,&nbsp;1].</span><br>
<span class="lineno"></span><span class="comment" id="6346803">//&nbsp;If&nbsp;coverage&nbsp;is&nbsp;not&nbsp;enabled,&nbsp;Coverage&nbsp;returns&nbsp;0.</span><br>
<span class="lineno">40</span><span class="comment" id="6346854">//</span><br>
<span class="lineno"></span><span class="comment" id="6346857">//&nbsp;When&nbsp;running&nbsp;a&nbsp;large&nbsp;set&nbsp;of&nbsp;sequential&nbsp;test&nbsp;cases,&nbsp;checking&nbsp;Coverage&nbsp;after&nbsp;each&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="6346944">//&nbsp;can&nbsp;be&nbsp;useful&nbsp;for&nbsp;identifying&nbsp;which&nbsp;test&nbsp;cases&nbsp;exercise&nbsp;new&nbsp;code&nbsp;paths.</span><br>
<span class="lineno"></span><span class="comment" id="6347019">//&nbsp;It&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;reports&nbsp;generated&nbsp;by&nbsp;&#39;go&nbsp;test&nbsp;-cover&#39;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6347096">//&nbsp;&#39;go&nbsp;tool&nbsp;cover&#39;.</span><br>
<span class="lineno">45</span><span class="keyword" id="6347116">func</span>&nbsp;<span class="ident" id="6347121">Coverage</span><span class="op" id="6347129">(</span><span class="op" id="6347130">)</span>&nbsp;<span class="builtintype" id="6347132">float64</span>&nbsp;<span class="op" id="6347140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347143">var</span>&nbsp;<span class="ident" id="6347147">n</span><span class="op" id="6347148">,</span>&nbsp;<span class="ident" id="6347150">d</span>&nbsp;<span class="ident" id="6347152">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347159">for</span>&nbsp;<span class="ident" id="6347163">_</span><span class="op" id="6347164">,</span>&nbsp;<span class="ident" id="6347166">counters</span>&nbsp;<span class="op" id="6347175">:=</span>&nbsp;<span class="keyword" id="6347178">range</span>&nbsp;<span class="ident" id="6347184">cover</span><span class="op" id="6347189">.</span><span class="ident" id="6347190">Counters</span>&nbsp;<span class="op" id="6347199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347203">for</span>&nbsp;<span class="ident" id="6347207">i</span>&nbsp;<span class="op" id="6347209">:=</span>&nbsp;<span class="keyword" id="6347212">range</span>&nbsp;<span class="ident" id="6347218">counters</span>&nbsp;<span class="op" id="6347227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347232">if</span>&nbsp;<span class="ident" id="6347235">atomic</span><span class="op" id="6347241">.</span><span class="ident" id="6347242">LoadUint32</span><span class="op" id="6347252">(</span><span class="op" id="6347253">&amp;</span><span class="ident" id="6347254">counters</span><span class="op" id="6347262">[</span><span class="ident" id="6347263">i</span><span class="op" id="6347264">]</span><span class="op" id="6347265">)</span>&nbsp;<span class="op" id="6347267">&gt;</span>&nbsp;<span class="num" id="6347269">0</span>&nbsp;<span class="op" id="6347271">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347277">n</span><span class="op" id="6347278">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347289">d</span><span class="op" id="6347290">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347298">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347301">if</span>&nbsp;<span class="ident" id="6347304">d</span>&nbsp;<span class="op" id="6347306">==</span>&nbsp;<span class="num" id="6347309">0</span>&nbsp;<span class="op" id="6347311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347315">return</span>&nbsp;<span class="num" id="6347322">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347328">return</span>&nbsp;<span class="builtintype" id="6347335">float64</span><span class="op" id="6347342">(</span><span class="ident" id="6347343">n</span><span class="op" id="6347344">)</span>&nbsp;<span class="op" id="6347346">/</span>&nbsp;<span class="builtintype" id="6347348">float64</span><span class="op" id="6347355">(</span><span class="ident" id="6347356">d</span><span class="op" id="6347357">)</span><br>
<span class="lineno"></span><span class="op" id="6347359">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="6347362">//&nbsp;RegisterCover&nbsp;records&nbsp;the&nbsp;coverage&nbsp;data&nbsp;accumulators&nbsp;for&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="comment" id="6347433">//&nbsp;NOTE:&nbsp;This&nbsp;function&nbsp;is&nbsp;internal&nbsp;to&nbsp;the&nbsp;testing&nbsp;infrastructure&nbsp;and&nbsp;may&nbsp;change.</span><br>
<span class="lineno"></span><span class="comment" id="6347514">//&nbsp;It&nbsp;is&nbsp;not&nbsp;covered&nbsp;(yet)&nbsp;by&nbsp;the&nbsp;Go&nbsp;1&nbsp;compatibility&nbsp;guidelines.</span><br>
<span class="lineno"></span><span class="keyword" id="6347579">func</span>&nbsp;<span class="ident" id="6347584">RegisterCover</span><span class="op" id="6347597">(</span><span class="ident" id="6347598">c</span>&nbsp;<span class="ident" id="6347600">Cover</span><span class="op" id="6347605">)</span>&nbsp;<span class="op" id="6347607">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347610">cover</span>&nbsp;<span class="op" id="6347616">=</span>&nbsp;<span class="ident" id="6347618">c</span><br>
<span class="lineno"></span><span class="op" id="6347620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6347623">//&nbsp;mustBeNil&nbsp;checks&nbsp;the&nbsp;error&nbsp;and,&nbsp;if&nbsp;present,&nbsp;reports&nbsp;it&nbsp;and&nbsp;exits.</span><br>
<span class="lineno"></span><span class="keyword" id="6347692">func</span>&nbsp;<span class="ident" id="6347697">mustBeNil</span><span class="op" id="6347706">(</span><span class="ident" id="6347707">err</span>&nbsp;<span class="builtintype" id="6347711">error</span><span class="op" id="6347716">)</span>&nbsp;<span class="op" id="6347718">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347721">if</span>&nbsp;<span class="ident" id="6347724">err</span>&nbsp;<span class="op" id="6347728">!=</span>&nbsp;<span class="ident" id="6347731">nil</span>&nbsp;<span class="op" id="6347735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347739">fmt</span><span class="op" id="6347742">.</span><span class="ident" id="6347743">Fprintf</span><span class="op" id="6347750">(</span><span class="ident" id="6347751">os</span><span class="op" id="6347753">.</span><span class="ident" id="6347754">Stderr</span><span class="op" id="6347760">,</span>&nbsp;<span class="string" id="6347762">&#34;testing:&nbsp;%s\n&#34;</span><span class="op" id="6347777">,</span>&nbsp;<span class="ident" id="6347779">err</span><span class="op" id="6347782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347786">os</span><span class="op" id="6347788">.</span><span class="ident" id="6347789">Exit</span><span class="op" id="6347793">(</span><span class="num" id="6347794">2</span><span class="op" id="6347795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6347798">}</span><br>
<span class="lineno"></span><span class="op" id="6347800">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="6347803">//&nbsp;coverReport&nbsp;reports&nbsp;the&nbsp;coverage&nbsp;percentage&nbsp;and&nbsp;writes&nbsp;a&nbsp;coverage&nbsp;profile&nbsp;if&nbsp;requested.</span><br>
<span class="lineno"></span><span class="keyword" id="6347894">func</span>&nbsp;<span class="ident" id="6347899">coverReport</span><span class="op" id="6347910">(</span><span class="op" id="6347911">)</span>&nbsp;<span class="op" id="6347913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347916">var</span>&nbsp;<span class="ident" id="6347920">f</span>&nbsp;<span class="op" id="6347922">*</span><span class="ident" id="6347923">os</span><span class="op" id="6347925">.</span><span class="ident" id="6347926">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347932">var</span>&nbsp;<span class="ident" id="6347936">err</span>&nbsp;<span class="builtintype" id="6347940">error</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6347947">if</span>&nbsp;<span class="op" id="6347950">*</span><span class="ident" id="6347951">coverProfile</span>&nbsp;<span class="op" id="6347964">!=</span>&nbsp;<span class="string" id="6347967">&#34;&#34;</span>&nbsp;<span class="op" id="6347970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6347974">f</span><span class="op" id="6347975">,</span>&nbsp;<span class="ident" id="6347977">err</span>&nbsp;<span class="op" id="6347981">=</span>&nbsp;<span class="ident" id="6347983">os</span><span class="op" id="6347985">.</span><span class="ident" id="6347986">Create</span><span class="op" id="6347992">(</span><span class="ident" id="6347993">toOutputDir</span><span class="op" id="6348004">(</span><span class="op" id="6348005">*</span><span class="ident" id="6348006">coverProfile</span><span class="op" id="6348018">)</span><span class="op" id="6348019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348023">mustBeNil</span><span class="op" id="6348032">(</span><span class="ident" id="6348033">err</span><span class="op" id="6348036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348040">fmt</span><span class="op" id="6348043">.</span><span class="ident" id="6348044">Fprintf</span><span class="op" id="6348051">(</span><span class="ident" id="6348052">f</span><span class="op" id="6348053">,</span>&nbsp;<span class="string" id="6348055">&#34;mode:&nbsp;%s\n&#34;</span><span class="op" id="6348067">,</span>&nbsp;<span class="ident" id="6348069">cover</span><span class="op" id="6348074">.</span><span class="ident" id="6348075">Mode</span><span class="op" id="6348079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348083">defer</span>&nbsp;<span class="keyword" id="6348089">func</span><span class="op" id="6348093">(</span><span class="op" id="6348094">)</span>&nbsp;<span class="op" id="6348096">{</span>&nbsp;<span class="ident" id="6348098">mustBeNil</span><span class="op" id="6348107">(</span><span class="ident" id="6348108">f</span><span class="op" id="6348109">.</span><span class="ident" id="6348110">Close</span><span class="op" id="6348115">(</span><span class="op" id="6348116">)</span><span class="op" id="6348117">)</span>&nbsp;<span class="op" id="6348119">}</span><span class="op" id="6348120">(</span><span class="op" id="6348121">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348128">var</span>&nbsp;<span class="ident" id="6348132">active</span><span class="op" id="6348138">,</span>&nbsp;<span class="ident" id="6348140">total</span>&nbsp;<span class="ident" id="6348146">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348153">var</span>&nbsp;<span class="ident" id="6348157">count</span>&nbsp;<span class="builtintype" id="6348163">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348171">for</span>&nbsp;<span class="ident" id="6348175">name</span><span class="op" id="6348179">,</span>&nbsp;<span class="ident" id="6348181">counts</span>&nbsp;<span class="op" id="6348188">:=</span>&nbsp;<span class="keyword" id="6348191">range</span>&nbsp;<span class="ident" id="6348197">cover</span><span class="op" id="6348202">.</span><span class="ident" id="6348203">Counters</span>&nbsp;<span class="op" id="6348212">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348216">blocks</span>&nbsp;<span class="op" id="6348223">:=</span>&nbsp;<span class="ident" id="6348226">cover</span><span class="op" id="6348231">.</span><span class="ident" id="6348232">Blocks</span><span class="op" id="6348238">[</span><span class="ident" id="6348239">name</span><span class="op" id="6348243">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348247">for</span>&nbsp;<span class="ident" id="6348251">i</span>&nbsp;<span class="op" id="6348253">:=</span>&nbsp;<span class="keyword" id="6348256">range</span>&nbsp;<span class="ident" id="6348262">counts</span>&nbsp;<span class="op" id="6348269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348274">stmts</span>&nbsp;<span class="op" id="6348280">:=</span>&nbsp;<span class="ident" id="6348283">int64</span><span class="op" id="6348288">(</span><span class="ident" id="6348289">blocks</span><span class="op" id="6348295">[</span><span class="ident" id="6348296">i</span><span class="op" id="6348297">]</span><span class="op" id="6348298">.</span><span class="ident" id="6348299">Stmts</span><span class="op" id="6348304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348309">total</span>&nbsp;<span class="op" id="6348315">+=</span>&nbsp;<span class="ident" id="6348318">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348327">count</span>&nbsp;<span class="op" id="6348333">=</span>&nbsp;<span class="ident" id="6348335">atomic</span><span class="op" id="6348341">.</span><span class="ident" id="6348342">LoadUint32</span><span class="op" id="6348352">(</span><span class="op" id="6348353">&amp;</span><span class="ident" id="6348354">counts</span><span class="op" id="6348360">[</span><span class="ident" id="6348361">i</span><span class="op" id="6348362">]</span><span class="op" id="6348363">)</span>&nbsp;<span class="comment" id="6348365">//&nbsp;For&nbsp;-mode=atomic.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348389">if</span>&nbsp;<span class="ident" id="6348392">count</span>&nbsp;<span class="op" id="6348398">&gt;</span>&nbsp;<span class="num" id="6348400">0</span>&nbsp;<span class="op" id="6348402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348408">active</span>&nbsp;<span class="op" id="6348415">+=</span>&nbsp;<span class="ident" id="6348418">stmts</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348432">if</span>&nbsp;<span class="ident" id="6348435">f</span>&nbsp;<span class="op" id="6348437">!=</span>&nbsp;<span class="ident" id="6348440">nil</span>&nbsp;<span class="op" id="6348444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348450">_</span><span class="op" id="6348451">,</span>&nbsp;<span class="ident" id="6348453">err</span>&nbsp;<span class="op" id="6348457">:=</span>&nbsp;<span class="ident" id="6348460">fmt</span><span class="op" id="6348463">.</span><span class="ident" id="6348464">Fprintf</span><span class="op" id="6348471">(</span><span class="ident" id="6348472">f</span><span class="op" id="6348473">,</span>&nbsp;<span class="string" id="6348475">&#34;%s:%d.%d,%d.%d&nbsp;%d&nbsp;%d\n&#34;</span><span class="op" id="6348499">,</span>&nbsp;<span class="ident" id="6348501">name</span><span class="op" id="6348505">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348512">blocks</span><span class="op" id="6348518">[</span><span class="ident" id="6348519">i</span><span class="op" id="6348520">]</span><span class="op" id="6348521">.</span><span class="ident" id="6348522">Line0</span><span class="op" id="6348527">,</span>&nbsp;<span class="ident" id="6348529">blocks</span><span class="op" id="6348535">[</span><span class="ident" id="6348536">i</span><span class="op" id="6348537">]</span><span class="op" id="6348538">.</span><span class="ident" id="6348539">Col0</span><span class="op" id="6348543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348550">blocks</span><span class="op" id="6348556">[</span><span class="ident" id="6348557">i</span><span class="op" id="6348558">]</span><span class="op" id="6348559">.</span><span class="ident" id="6348560">Line1</span><span class="op" id="6348565">,</span>&nbsp;<span class="ident" id="6348567">blocks</span><span class="op" id="6348573">[</span><span class="ident" id="6348574">i</span><span class="op" id="6348575">]</span><span class="op" id="6348576">.</span><span class="ident" id="6348577">Col1</span><span class="op" id="6348581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348588">stmts</span><span class="op" id="6348593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348600">count</span><span class="op" id="6348605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348611">mustBeNil</span><span class="op" id="6348620">(</span><span class="ident" id="6348621">err</span><span class="op" id="6348624">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6348639">if</span>&nbsp;<span class="ident" id="6348642">total</span>&nbsp;<span class="op" id="6348648">==</span>&nbsp;<span class="num" id="6348651">0</span>&nbsp;<span class="op" id="6348653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348657">total</span>&nbsp;<span class="op" id="6348663">=</span>&nbsp;<span class="num" id="6348665">1</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6348668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6348671">fmt</span><span class="op" id="6348674">.</span><span class="ident" id="6348675">Printf</span><span class="op" id="6348681">(</span><span class="string" id="6348682">&#34;coverage:&nbsp;%.1f%%&nbsp;of&nbsp;statements%s\n&#34;</span><span class="op" id="6348718">,</span>&nbsp;<span class="num" id="6348720">100</span><span class="op" id="6348723">*</span><span class="builtintype" id="6348724">float64</span><span class="op" id="6348731">(</span><span class="ident" id="6348732">active</span><span class="op" id="6348738">)</span><span class="op" id="6348739">/</span><span class="builtintype" id="6348740">float64</span><span class="op" id="6348747">(</span><span class="ident" id="6348748">total</span><span class="op" id="6348753">)</span><span class="op" id="6348754">,</span>&nbsp;<span class="ident" id="6348756">cover</span><span class="op" id="6348761">.</span><span class="ident" id="6348762">CoveredPackages</span><span class="op" id="6348777">)</span><br>
<span class="lineno"></span><span class="op" id="6348779">}</span>
</div>
</body>
</html>
