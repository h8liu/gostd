<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3582379">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3582434">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3582488">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3582539">package</span>&nbsp;<span class="ident" id="3582547">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3582553">import</span>&nbsp;<span class="op" id="3582560">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3582563">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3582577">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3582594">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3582604">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3582615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3582618">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="3582707">type</span>&nbsp;<span class="ident" id="3582712">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="3582728">struct</span>&nbsp;<span class="op" id="3582735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582738">Version</span>&nbsp;<span class="builtintype" id="3582746">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582751">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3582759">*</span><span class="ident" id="3582760">big</span><span class="op" id="3582763">.</span><span class="ident" id="3582764">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582769">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3582777">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582782">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3582790">*</span><span class="ident" id="3582791">big</span><span class="op" id="3582794">.</span><span class="ident" id="3582795">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582800">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3582808">*</span><span class="ident" id="3582809">big</span><span class="op" id="3582812">.</span><span class="ident" id="3582813">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582818">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3582826">*</span><span class="ident" id="3582827">big</span><span class="op" id="3582830">.</span><span class="ident" id="3582831">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3582836">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582909">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3582914">*</span><span class="ident" id="3582915">big</span><span class="op" id="3582918">.</span><span class="ident" id="3582919">Int</span>&nbsp;<span class="string" id="3582923">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582942">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3582947">*</span><span class="ident" id="3582948">big</span><span class="op" id="3582951">.</span><span class="ident" id="3582952">Int</span>&nbsp;<span class="string" id="3582956">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3582975">Qinv</span>&nbsp;<span class="op" id="3582980">*</span><span class="ident" id="3582981">big</span><span class="op" id="3582984">.</span><span class="ident" id="3582985">Int</span>&nbsp;<span class="string" id="3582989">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583009">AdditionalPrimes</span>&nbsp;<span class="op" id="3583026">[</span><span class="op" id="3583027">]</span><span class="ident" id="3583028">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="3583052">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3583080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3583083">type</span>&nbsp;<span class="ident" id="3583088">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="3583112">struct</span>&nbsp;<span class="op" id="3583119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583122">Prime</span>&nbsp;<span class="op" id="3583128">*</span><span class="ident" id="3583129">big</span><span class="op" id="3583132">.</span><span class="ident" id="3583133">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3583139">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583199">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3583205">*</span><span class="ident" id="3583206">big</span><span class="op" id="3583209">.</span><span class="ident" id="3583210">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583215">Coeff</span>&nbsp;<span class="op" id="3583221">*</span><span class="ident" id="3583222">big</span><span class="op" id="3583225">.</span><span class="ident" id="3583226">Int</span><br>
<span class="lineno"></span><span class="op" id="3583230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3583233">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3583324">func</span>&nbsp;<span class="ident" id="3583329">ParsePKCS1PrivateKey</span><span class="op" id="3583349">(</span><span class="ident" id="3583350">der</span>&nbsp;<span class="op" id="3583354">[</span><span class="op" id="3583355">]</span><span class="builtintype" id="3583356">byte</span><span class="op" id="3583360">)</span>&nbsp;<span class="op" id="3583362">(</span><span class="ident" id="3583363">key</span>&nbsp;<span class="op" id="3583367">*</span><span class="ident" id="3583368">rsa</span><span class="op" id="3583371">.</span><span class="ident" id="3583372">PrivateKey</span><span class="op" id="3583382">,</span>&nbsp;<span class="ident" id="3583384">err</span>&nbsp;<span class="builtintype" id="3583388">error</span><span class="op" id="3583393">)</span>&nbsp;<span class="op" id="3583395">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583398">var</span>&nbsp;<span class="ident" id="3583402">priv</span>&nbsp;<span class="ident" id="3583407">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583424">rest</span><span class="op" id="3583428">,</span>&nbsp;<span class="ident" id="3583430">err</span>&nbsp;<span class="op" id="3583434">:=</span>&nbsp;<span class="ident" id="3583437">asn1</span><span class="op" id="3583441">.</span><span class="ident" id="3583442">Unmarshal</span><span class="op" id="3583451">(</span><span class="ident" id="3583452">der</span><span class="op" id="3583455">,</span>&nbsp;<span class="op" id="3583457">&amp;</span><span class="ident" id="3583458">priv</span><span class="op" id="3583462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583465">if</span>&nbsp;<span class="builtinfunc" id="3583468">len</span><span class="op" id="3583471">(</span><span class="ident" id="3583472">rest</span><span class="op" id="3583476">)</span>&nbsp;<span class="op" id="3583478">&gt;</span>&nbsp;<span class="num" id="3583480">0</span>&nbsp;<span class="op" id="3583482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583486">err</span>&nbsp;<span class="op" id="3583490">=</span>&nbsp;<span class="ident" id="3583492">asn1</span><span class="op" id="3583496">.</span><span class="ident" id="3583497">SyntaxError</span><span class="op" id="3583508">{</span><span class="ident" id="3583509">Msg</span><span class="op" id="3583512">:</span>&nbsp;<span class="string" id="3583514">&#34;trailing&nbsp;data&#34;</span><span class="op" id="3583529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583533">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583544">if</span>&nbsp;<span class="ident" id="3583547">err</span>&nbsp;<span class="op" id="3583551">!=</span>&nbsp;<span class="ident" id="3583554">nil</span>&nbsp;<span class="op" id="3583558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583562">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583574">if</span>&nbsp;<span class="ident" id="3583577">priv</span><span class="op" id="3583581">.</span><span class="ident" id="3583582">Version</span>&nbsp;<span class="op" id="3583590">&gt;</span>&nbsp;<span class="num" id="3583592">1</span>&nbsp;<span class="op" id="3583594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583598">return</span>&nbsp;<span class="ident" id="3583605">nil</span><span class="op" id="3583608">,</span>&nbsp;<span class="ident" id="3583610">errors</span><span class="op" id="3583616">.</span><span class="ident" id="3583617">New</span><span class="op" id="3583620">(</span><span class="string" id="3583621">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="3583660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583667">if</span>&nbsp;<span class="ident" id="3583670">priv</span><span class="op" id="3583674">.</span><span class="ident" id="3583675">N</span><span class="op" id="3583676">.</span><span class="ident" id="3583677">Sign</span><span class="op" id="3583681">(</span><span class="op" id="3583682">)</span>&nbsp;<span class="op" id="3583684">&lt;=</span>&nbsp;<span class="num" id="3583687">0</span>&nbsp;<span class="op" id="3583689">||</span>&nbsp;<span class="ident" id="3583692">priv</span><span class="op" id="3583696">.</span><span class="ident" id="3583697">D</span><span class="op" id="3583698">.</span><span class="ident" id="3583699">Sign</span><span class="op" id="3583703">(</span><span class="op" id="3583704">)</span>&nbsp;<span class="op" id="3583706">&lt;=</span>&nbsp;<span class="num" id="3583709">0</span>&nbsp;<span class="op" id="3583711">||</span>&nbsp;<span class="ident" id="3583714">priv</span><span class="op" id="3583718">.</span><span class="ident" id="3583719">P</span><span class="op" id="3583720">.</span><span class="ident" id="3583721">Sign</span><span class="op" id="3583725">(</span><span class="op" id="3583726">)</span>&nbsp;<span class="op" id="3583728">&lt;=</span>&nbsp;<span class="num" id="3583731">0</span>&nbsp;<span class="op" id="3583733">||</span>&nbsp;<span class="ident" id="3583736">priv</span><span class="op" id="3583740">.</span><span class="ident" id="3583741">Q</span><span class="op" id="3583742">.</span><span class="ident" id="3583743">Sign</span><span class="op" id="3583747">(</span><span class="op" id="3583748">)</span>&nbsp;<span class="op" id="3583750">&lt;=</span>&nbsp;<span class="num" id="3583753">0</span>&nbsp;<span class="op" id="3583755">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3583759">return</span>&nbsp;<span class="ident" id="3583766">nil</span><span class="op" id="3583769">,</span>&nbsp;<span class="ident" id="3583771">errors</span><span class="op" id="3583777">.</span><span class="ident" id="3583778">New</span><span class="op" id="3583781">(</span><span class="string" id="3583782">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="3583833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583840">key</span>&nbsp;<span class="op" id="3583844">=</span>&nbsp;<span class="builtinfunc" id="3583846">new</span><span class="op" id="3583849">(</span><span class="ident" id="3583850">rsa</span><span class="op" id="3583853">.</span><span class="ident" id="3583854">PrivateKey</span><span class="op" id="3583864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583867">key</span><span class="op" id="3583870">.</span><span class="ident" id="3583871">PublicKey</span>&nbsp;<span class="op" id="3583881">=</span>&nbsp;<span class="ident" id="3583883">rsa</span><span class="op" id="3583886">.</span><span class="ident" id="3583887">PublicKey</span><span class="op" id="3583896">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583900">E</span><span class="op" id="3583901">:</span>&nbsp;<span class="ident" id="3583903">priv</span><span class="op" id="3583907">.</span><span class="ident" id="3583908">E</span><span class="op" id="3583909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583913">N</span><span class="op" id="3583914">:</span>&nbsp;<span class="ident" id="3583916">priv</span><span class="op" id="3583920">.</span><span class="ident" id="3583921">N</span><span class="op" id="3583922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3583925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583929">key</span><span class="op" id="3583932">.</span><span class="ident" id="3583933">D</span>&nbsp;<span class="op" id="3583935">=</span>&nbsp;<span class="ident" id="3583937">priv</span><span class="op" id="3583941">.</span><span class="ident" id="3583942">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3583945">key</span><span class="op" id="3583948">.</span><span class="ident" id="3583949">Primes</span>&nbsp;<span class="op" id="3583956">=</span>&nbsp;<span class="builtinfunc" id="3583958">make</span><span class="op" id="3583962">(</span><span class="op" id="3583963">[</span><span class="op" id="3583964">]</span><span class="op" id="3583965">*</span><span class="ident" id="3583966">big</span><span class="op" id="3583969">.</span><span class="ident" id="3583970">Int</span><span class="op" id="3583973">,</span>&nbsp;<span class="num" id="3583975">2</span><span class="op" id="3583976">+</span><span class="builtinfunc" id="3583977">len</span><span class="op" id="3583980">(</span><span class="ident" id="3583981">priv</span><span class="op" id="3583985">.</span><span class="ident" id="3583986">AdditionalPrimes</span><span class="op" id="3584002">)</span><span class="op" id="3584003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584006">key</span><span class="op" id="3584009">.</span><span class="ident" id="3584010">Primes</span><span class="op" id="3584016">[</span><span class="num" id="3584017">0</span><span class="op" id="3584018">]</span>&nbsp;<span class="op" id="3584020">=</span>&nbsp;<span class="ident" id="3584022">priv</span><span class="op" id="3584026">.</span><span class="ident" id="3584027">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584030">key</span><span class="op" id="3584033">.</span><span class="ident" id="3584034">Primes</span><span class="op" id="3584040">[</span><span class="num" id="3584041">1</span><span class="op" id="3584042">]</span>&nbsp;<span class="op" id="3584044">=</span>&nbsp;<span class="ident" id="3584046">priv</span><span class="op" id="3584050">.</span><span class="ident" id="3584051">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584054">for</span>&nbsp;<span class="ident" id="3584058">i</span><span class="op" id="3584059">,</span>&nbsp;<span class="ident" id="3584061">a</span>&nbsp;<span class="op" id="3584063">:=</span>&nbsp;<span class="keyword" id="3584066">range</span>&nbsp;<span class="ident" id="3584072">priv</span><span class="op" id="3584076">.</span><span class="ident" id="3584077">AdditionalPrimes</span>&nbsp;<span class="op" id="3584094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584098">if</span>&nbsp;<span class="ident" id="3584101">a</span><span class="op" id="3584102">.</span><span class="ident" id="3584103">Prime</span><span class="op" id="3584108">.</span><span class="ident" id="3584109">Sign</span><span class="op" id="3584113">(</span><span class="op" id="3584114">)</span>&nbsp;<span class="op" id="3584116">&lt;=</span>&nbsp;<span class="num" id="3584119">0</span>&nbsp;<span class="op" id="3584121">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584126">return</span>&nbsp;<span class="ident" id="3584133">nil</span><span class="op" id="3584136">,</span>&nbsp;<span class="ident" id="3584138">errors</span><span class="op" id="3584144">.</span><span class="ident" id="3584145">New</span><span class="op" id="3584148">(</span><span class="string" id="3584149">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="3584200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3584204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584208">key</span><span class="op" id="3584211">.</span><span class="ident" id="3584212">Primes</span><span class="op" id="3584218">[</span><span class="ident" id="3584219">i</span><span class="op" id="3584220">+</span><span class="num" id="3584221">2</span><span class="op" id="3584222">]</span>&nbsp;<span class="op" id="3584224">=</span>&nbsp;<span class="ident" id="3584226">a</span><span class="op" id="3584227">.</span><span class="ident" id="3584228">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3584236">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3584299">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3584319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584323">err</span>&nbsp;<span class="op" id="3584327">=</span>&nbsp;<span class="ident" id="3584329">key</span><span class="op" id="3584332">.</span><span class="ident" id="3584333">Validate</span><span class="op" id="3584341">(</span><span class="op" id="3584342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584345">if</span>&nbsp;<span class="ident" id="3584348">err</span>&nbsp;<span class="op" id="3584352">!=</span>&nbsp;<span class="ident" id="3584355">nil</span>&nbsp;<span class="op" id="3584359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584363">return</span>&nbsp;<span class="ident" id="3584370">nil</span><span class="op" id="3584373">,</span>&nbsp;<span class="ident" id="3584375">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3584380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584383">key</span><span class="op" id="3584386">.</span><span class="ident" id="3584387">Precompute</span><span class="op" id="3584397">(</span><span class="op" id="3584398">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584402">return</span><br>
<span class="lineno"></span><span class="op" id="3584409">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3584412">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="3584488">func</span>&nbsp;<span class="ident" id="3584493">MarshalPKCS1PrivateKey</span><span class="op" id="3584515">(</span><span class="ident" id="3584516">key</span>&nbsp;<span class="op" id="3584520">*</span><span class="ident" id="3584521">rsa</span><span class="op" id="3584524">.</span><span class="ident" id="3584525">PrivateKey</span><span class="op" id="3584535">)</span>&nbsp;<span class="op" id="3584537">[</span><span class="op" id="3584538">]</span><span class="builtintype" id="3584539">byte</span>&nbsp;<span class="op" id="3584544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584547">key</span><span class="op" id="3584550">.</span><span class="ident" id="3584551">Precompute</span><span class="op" id="3584561">(</span><span class="op" id="3584562">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584566">version</span>&nbsp;<span class="op" id="3584574">:=</span>&nbsp;<span class="num" id="3584577">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584580">if</span>&nbsp;<span class="builtinfunc" id="3584583">len</span><span class="op" id="3584586">(</span><span class="ident" id="3584587">key</span><span class="op" id="3584590">.</span><span class="ident" id="3584591">Primes</span><span class="op" id="3584597">)</span>&nbsp;<span class="op" id="3584599">&gt;</span>&nbsp;<span class="num" id="3584601">2</span>&nbsp;<span class="op" id="3584603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584607">version</span>&nbsp;<span class="op" id="3584615">=</span>&nbsp;<span class="num" id="3584617">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3584620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584624">priv</span>&nbsp;<span class="op" id="3584629">:=</span>&nbsp;<span class="ident" id="3584632">pkcs1PrivateKey</span><span class="op" id="3584647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584651">Version</span><span class="op" id="3584658">:</span>&nbsp;<span class="ident" id="3584660">version</span><span class="op" id="3584667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584671">N</span><span class="op" id="3584672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584680">key</span><span class="op" id="3584683">.</span><span class="ident" id="3584684">N</span><span class="op" id="3584685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584689">E</span><span class="op" id="3584690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584698">key</span><span class="op" id="3584701">.</span><span class="ident" id="3584702">PublicKey</span><span class="op" id="3584711">.</span><span class="ident" id="3584712">E</span><span class="op" id="3584713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584717">D</span><span class="op" id="3584718">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584726">key</span><span class="op" id="3584729">.</span><span class="ident" id="3584730">D</span><span class="op" id="3584731">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584735">P</span><span class="op" id="3584736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584744">key</span><span class="op" id="3584747">.</span><span class="ident" id="3584748">Primes</span><span class="op" id="3584754">[</span><span class="num" id="3584755">0</span><span class="op" id="3584756">]</span><span class="op" id="3584757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584761">Q</span><span class="op" id="3584762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584770">key</span><span class="op" id="3584773">.</span><span class="ident" id="3584774">Primes</span><span class="op" id="3584780">[</span><span class="num" id="3584781">1</span><span class="op" id="3584782">]</span><span class="op" id="3584783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584787">Dp</span><span class="op" id="3584789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584796">key</span><span class="op" id="3584799">.</span><span class="ident" id="3584800">Precomputed</span><span class="op" id="3584811">.</span><span class="ident" id="3584812">Dp</span><span class="op" id="3584814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584818">Dq</span><span class="op" id="3584820">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584827">key</span><span class="op" id="3584830">.</span><span class="ident" id="3584831">Precomputed</span><span class="op" id="3584842">.</span><span class="ident" id="3584843">Dq</span><span class="op" id="3584845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584849">Qinv</span><span class="op" id="3584853">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3584858">key</span><span class="op" id="3584861">.</span><span class="ident" id="3584862">Precomputed</span><span class="op" id="3584873">.</span><span class="ident" id="3584874">Qinv</span><span class="op" id="3584878">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3584881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3584885">priv</span><span class="op" id="3584889">.</span><span class="ident" id="3584890">AdditionalPrimes</span>&nbsp;<span class="op" id="3584907">=</span>&nbsp;<span class="builtinfunc" id="3584909">make</span><span class="op" id="3584913">(</span><span class="op" id="3584914">[</span><span class="op" id="3584915">]</span><span class="ident" id="3584916">pkcs1AdditionalRSAPrime</span><span class="op" id="3584939">,</span>&nbsp;<span class="builtinfunc" id="3584941">len</span><span class="op" id="3584944">(</span><span class="ident" id="3584945">key</span><span class="op" id="3584948">.</span><span class="ident" id="3584949">Precomputed</span><span class="op" id="3584960">.</span><span class="ident" id="3584961">CRTValues</span><span class="op" id="3584970">)</span><span class="op" id="3584971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3584974">for</span>&nbsp;<span class="ident" id="3584978">i</span><span class="op" id="3584979">,</span>&nbsp;<span class="ident" id="3584981">values</span>&nbsp;<span class="op" id="3584988">:=</span>&nbsp;<span class="keyword" id="3584991">range</span>&nbsp;<span class="ident" id="3584997">key</span><span class="op" id="3585000">.</span><span class="ident" id="3585001">Precomputed</span><span class="op" id="3585012">.</span><span class="ident" id="3585013">CRTValues</span>&nbsp;<span class="op" id="3585023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585027">priv</span><span class="op" id="3585031">.</span><span class="ident" id="3585032">AdditionalPrimes</span><span class="op" id="3585048">[</span><span class="ident" id="3585049">i</span><span class="op" id="3585050">]</span><span class="op" id="3585051">.</span><span class="ident" id="3585052">Prime</span>&nbsp;<span class="op" id="3585058">=</span>&nbsp;<span class="ident" id="3585060">key</span><span class="op" id="3585063">.</span><span class="ident" id="3585064">Primes</span><span class="op" id="3585070">[</span><span class="num" id="3585071">2</span><span class="op" id="3585072">+</span><span class="ident" id="3585073">i</span><span class="op" id="3585074">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585078">priv</span><span class="op" id="3585082">.</span><span class="ident" id="3585083">AdditionalPrimes</span><span class="op" id="3585099">[</span><span class="ident" id="3585100">i</span><span class="op" id="3585101">]</span><span class="op" id="3585102">.</span><span class="ident" id="3585103">Exp</span>&nbsp;<span class="op" id="3585107">=</span>&nbsp;<span class="ident" id="3585109">values</span><span class="op" id="3585115">.</span><span class="ident" id="3585116">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585122">priv</span><span class="op" id="3585126">.</span><span class="ident" id="3585127">AdditionalPrimes</span><span class="op" id="3585143">[</span><span class="ident" id="3585144">i</span><span class="op" id="3585145">]</span><span class="op" id="3585146">.</span><span class="ident" id="3585147">Coeff</span>&nbsp;<span class="op" id="3585153">=</span>&nbsp;<span class="ident" id="3585155">values</span><span class="op" id="3585161">.</span><span class="ident" id="3585162">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3585169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585173">b</span><span class="op" id="3585174">,</span>&nbsp;<span class="ident" id="3585176">_</span>&nbsp;<span class="op" id="3585178">:=</span>&nbsp;<span class="ident" id="3585181">asn1</span><span class="op" id="3585185">.</span><span class="ident" id="3585186">Marshal</span><span class="op" id="3585193">(</span><span class="ident" id="3585194">priv</span><span class="op" id="3585198">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3585201">return</span>&nbsp;<span class="ident" id="3585208">b</span><br>
<span class="lineno"></span><span class="op" id="3585210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3585213">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="3585282">type</span>&nbsp;<span class="ident" id="3585287">rsaPublicKey</span>&nbsp;<span class="keyword" id="3585300">struct</span>&nbsp;<span class="op" id="3585307">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585310">N</span>&nbsp;<span class="op" id="3585312">*</span><span class="ident" id="3585313">big</span><span class="op" id="3585316">.</span><span class="ident" id="3585317">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3585322">E</span>&nbsp;<span class="builtintype" id="3585324">int</span><br>
<span class="lineno"></span><span class="op" id="3585328">}</span>
</div>
</body>
</html>
