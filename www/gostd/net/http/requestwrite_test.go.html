<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/http</h2>
<ul>
<li><a href="/gostd/net/http/client.go.html">client.go</a></li>
<li><a href="/gostd/net/http/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/http/cookie.go.html">cookie.go</a></li>
<li><a href="/gostd/net/http/cookie_test.go.html">cookie_test.go</a></li>
<li><a href="/gostd/net/http/doc.go.html">doc.go</a></li>
<li><a href="/gostd/net/http/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/http/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/net/http/filetransport.go.html">filetransport.go</a></li>
<li><a href="/gostd/net/http/filetransport_test.go.html">filetransport_test.go</a></li>
<li><a href="/gostd/net/http/fs.go.html">fs.go</a></li>
<li><a href="/gostd/net/http/fs_test.go.html">fs_test.go</a></li>
<li><a href="/gostd/net/http/header.go.html">header.go</a></li>
<li><a href="/gostd/net/http/header_test.go.html">header_test.go</a></li>
<li><a href="/gostd/net/http/jar.go.html">jar.go</a></li>
<li><a href="/gostd/net/http/lex.go.html">lex.go</a></li>
<li><a href="/gostd/net/http/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/net/http/main_test.go.html">main_test.go</a></li>
<li><a href="/gostd/net/http/npn_test.go.html">npn_test.go</a></li>
<li><a href="/gostd/net/http/proxy_test.go.html">proxy_test.go</a></li>
<li><a href="/gostd/net/http/range_test.go.html">range_test.go</a></li>
<li><a href="/gostd/net/http/readrequest_test.go.html">readrequest_test.go</a></li>
<li><a href="/gostd/net/http/request.go.html">request.go</a></li>
<li><a href="/gostd/net/http/request_test.go.html">request_test.go</a></li>
<li><a href="/gostd/net/http/requestwrite_test.go.html" class="current">requestwrite_test.go</a></li>
<li><a href="/gostd/net/http/response.go.html">response.go</a></li>
<li><a href="/gostd/net/http/response_test.go.html">response_test.go</a></li>
<li><a href="/gostd/net/http/responsewrite_test.go.html">responsewrite_test.go</a></li>
<li><a href="/gostd/net/http/serve_test.go.html">serve_test.go</a></li>
<li><a href="/gostd/net/http/server.go.html">server.go</a></li>
<li><a href="/gostd/net/http/sniff.go.html">sniff.go</a></li>
<li><a href="/gostd/net/http/sniff_test.go.html">sniff_test.go</a></li>
<li><a href="/gostd/net/http/status.go.html">status.go</a></li>
<li><a href="/gostd/net/http/transfer.go.html">transfer.go</a></li>
<li><a href="/gostd/net/http/transfer_test.go.html">transfer_test.go</a></li>
<li><a href="/gostd/net/http/transport.go.html">transport.go</a></li>
<li><a href="/gostd/net/http/transport_test.go.html">transport_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8252570">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8252626">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8252680">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8252731">package</span>&nbsp;<span class="ident" id="8252739">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8252745">import</span>&nbsp;<span class="op" id="8252752">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252755">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252764">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252774">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252781">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252787">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252800">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252811">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8252822">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8252832">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8252835">type</span>&nbsp;<span class="ident" id="8252840">reqWriteTest</span>&nbsp;<span class="keyword" id="8252853">struct</span>&nbsp;<span class="op" id="8252860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8252863">Req</span>&nbsp;&nbsp;<span class="ident" id="8252868">Request</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8252877">Body</span>&nbsp;<span class="keyword" id="8252882">interface</span><span class="op" id="8252891">{</span><span class="op" id="8252892">}</span>&nbsp;<span class="comment" id="8252894">//&nbsp;optional&nbsp;[]byte&nbsp;or&nbsp;func()&nbsp;io.ReadCloser&nbsp;to&nbsp;populate&nbsp;Req.Body</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8252960">//&nbsp;Any&nbsp;of&nbsp;these&nbsp;three&nbsp;may&nbsp;be&nbsp;empty&nbsp;to&nbsp;skip&nbsp;that&nbsp;test.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253015">WantWrite</span>&nbsp;<span class="builtintype" id="8253025">string</span>&nbsp;<span class="comment" id="8253032">//&nbsp;Request.Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253050">WantProxy</span>&nbsp;<span class="builtintype" id="8253060">string</span>&nbsp;<span class="comment" id="8253067">//&nbsp;Request.WriteProxy</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253091">WantError</span>&nbsp;<span class="builtintype" id="8253101">error</span>&nbsp;<span class="comment" id="8253107">//&nbsp;wanted&nbsp;error&nbsp;from&nbsp;Request.Write</span><br>
<span class="lineno"></span><span class="op" id="8253142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8253145">var</span>&nbsp;<span class="ident" id="8253149">reqWriteTests</span>&nbsp;<span class="op" id="8253163">=</span>&nbsp;<span class="op" id="8253165">[</span><span class="op" id="8253166">]</span><span class="ident" id="8253167">reqWriteTest</span><span class="op" id="8253179">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8253182">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;no&nbsp;body;&nbsp;no&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253238">Req</span><span class="op" id="8253241">:</span>&nbsp;<span class="ident" id="8253243">Request</span><span class="op" id="8253250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253255">Method</span><span class="op" id="8253261">:</span>&nbsp;<span class="string" id="8253263">&#34;GET&#34;</span><span class="op" id="8253268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253273">URL</span><span class="op" id="8253276">:</span>&nbsp;<span class="op" id="8253278">&amp;</span><span class="ident" id="8253279">url</span><span class="op" id="8253282">.</span><span class="ident" id="8253283">URL</span><span class="op" id="8253286">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253292">Scheme</span><span class="op" id="8253298">:</span>&nbsp;<span class="string" id="8253300">&#34;http&#34;</span><span class="op" id="8253306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253312">Host</span><span class="op" id="8253316">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8253320">&#34;www.techcrunch.com&#34;</span><span class="op" id="8253340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253346">Path</span><span class="op" id="8253350">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8253354">&#34;/&#34;</span><span class="op" id="8253357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253362">}</span><span class="op" id="8253363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253368">Proto</span><span class="op" id="8253373">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253380">&#34;HTTP/1.1&#34;</span><span class="op" id="8253390">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253395">ProtoMajor</span><span class="op" id="8253405">:</span>&nbsp;<span class="num" id="8253407">1</span><span class="op" id="8253408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253413">ProtoMinor</span><span class="op" id="8253423">:</span>&nbsp;<span class="num" id="8253425">1</span><span class="op" id="8253426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253431">Header</span><span class="op" id="8253437">:</span>&nbsp;<span class="ident" id="8253439">Header</span><span class="op" id="8253445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253451">&#34;Accept&#34;</span><span class="op" id="8253459">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253471">{</span><span class="string" id="8253472">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#34;</span><span class="op" id="8253537">}</span><span class="op" id="8253538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253544">&#34;Accept-Charset&#34;</span><span class="op" id="8253560">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="8253564">{</span><span class="string" id="8253565">&#34;ISO-8859-1,utf-8;q=0.7,*;q=0.7&#34;</span><span class="op" id="8253597">}</span><span class="op" id="8253598">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253604">&#34;Accept-Encoding&#34;</span><span class="op" id="8253621">:</span>&nbsp;&nbsp;<span class="op" id="8253624">{</span><span class="string" id="8253625">&#34;gzip,deflate&#34;</span><span class="op" id="8253639">}</span><span class="op" id="8253640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253646">&#34;Accept-Language&#34;</span><span class="op" id="8253663">:</span>&nbsp;&nbsp;<span class="op" id="8253666">{</span><span class="string" id="8253667">&#34;en-us,en;q=0.5&#34;</span><span class="op" id="8253683">}</span><span class="op" id="8253684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253690">&#34;Keep-Alive&#34;</span><span class="op" id="8253702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253710">{</span><span class="string" id="8253711">&#34;300&#34;</span><span class="op" id="8253716">}</span><span class="op" id="8253717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253723">&#34;Proxy-Connection&#34;</span><span class="op" id="8253741">:</span>&nbsp;<span class="op" id="8253743">{</span><span class="string" id="8253744">&#34;keep-alive&#34;</span><span class="op" id="8253756">}</span><span class="op" id="8253757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253763">&#34;User-Agent&#34;</span><span class="op" id="8253775">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253783">{</span><span class="string" id="8253784">&#34;Fake&#34;</span><span class="op" id="8253790">}</span><span class="op" id="8253791">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253796">}</span><span class="op" id="8253797">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253802">Body</span><span class="op" id="8253806">:</span>&nbsp;&nbsp;<span class="ident" id="8253809">nil</span><span class="op" id="8253812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253817">Close</span><span class="op" id="8253822">:</span>&nbsp;<span class="builtintype" id="8253824">false</span><span class="op" id="8253829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253834">Host</span><span class="op" id="8253838">:</span>&nbsp;&nbsp;<span class="string" id="8253841">&#34;www.techcrunch.com&#34;</span><span class="op" id="8253861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253866">Form</span><span class="op" id="8253870">:</span>&nbsp;&nbsp;<span class="keyword" id="8253873">map</span><span class="op" id="8253876">[</span><span class="builtintype" id="8253877">string</span><span class="op" id="8253883">]</span><span class="op" id="8253884">[</span><span class="op" id="8253885">]</span><span class="builtintype" id="8253886">string</span><span class="op" id="8253892">{</span><span class="op" id="8253893">}</span><span class="op" id="8253894">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8253898">}</span><span class="op" id="8253899">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8253904">WantWrite</span><span class="op" id="8253913">:</span>&nbsp;<span class="string" id="8253915">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8253936">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253941">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8253972">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8253977">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8254000">+</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254005">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8254083">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254088">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8254141">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254146">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8254182">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254187">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8254225">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254230">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8254252">+</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254257">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8254295">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254300">WantProxy</span><span class="op" id="8254309">:</span>&nbsp;<span class="string" id="8254311">&#34;GET&nbsp;http://www.techcrunch.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8254357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254362">&#34;Host:&nbsp;www.techcrunch.com\r\n&#34;</span>&nbsp;<span class="op" id="8254393">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254398">&#34;User-Agent:&nbsp;Fake\r\n&#34;</span>&nbsp;<span class="op" id="8254421">+</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254426">&#34;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n&#34;</span>&nbsp;<span class="op" id="8254504">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254509">&#34;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n&#34;</span>&nbsp;<span class="op" id="8254562">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254567">&#34;Accept-Encoding:&nbsp;gzip,deflate\r\n&#34;</span>&nbsp;<span class="op" id="8254603">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254608">&#34;Accept-Language:&nbsp;en-us,en;q=0.5\r\n&#34;</span>&nbsp;<span class="op" id="8254646">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254651">&#34;Keep-Alive:&nbsp;300\r\n&#34;</span>&nbsp;<span class="op" id="8254673">+</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8254678">&#34;Proxy-Connection:&nbsp;keep-alive\r\n\r\n&#34;</span><span class="op" id="8254716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8254719">}</span><span class="op" id="8254720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8254723">//&nbsp;HTTP/1.1&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8254775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254779">Req</span><span class="op" id="8254782">:</span>&nbsp;<span class="ident" id="8254784">Request</span><span class="op" id="8254791">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254796">Method</span><span class="op" id="8254802">:</span>&nbsp;<span class="string" id="8254804">&#34;GET&#34;</span><span class="op" id="8254809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254814">URL</span><span class="op" id="8254817">:</span>&nbsp;<span class="op" id="8254819">&amp;</span><span class="ident" id="8254820">url</span><span class="op" id="8254823">.</span><span class="ident" id="8254824">URL</span><span class="op" id="8254827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254833">Scheme</span><span class="op" id="8254839">:</span>&nbsp;<span class="string" id="8254841">&#34;http&#34;</span><span class="op" id="8254847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254853">Host</span><span class="op" id="8254857">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8254861">&#34;www.google.com&#34;</span><span class="op" id="8254877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254883">Path</span><span class="op" id="8254887">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8254891">&#34;/search&#34;</span><span class="op" id="8254900">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8254905">}</span><span class="op" id="8254906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254911">ProtoMajor</span><span class="op" id="8254921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8254929">1</span><span class="op" id="8254930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254935">ProtoMinor</span><span class="op" id="8254945">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8254953">1</span><span class="op" id="8254954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254959">Header</span><span class="op" id="8254965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254977">Header</span><span class="op" id="8254983">{</span><span class="op" id="8254984">}</span><span class="op" id="8254985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8254990">TransferEncoding</span><span class="op" id="8255006">:</span>&nbsp;<span class="op" id="8255008">[</span><span class="op" id="8255009">]</span><span class="builtintype" id="8255010">string</span><span class="op" id="8255016">{</span><span class="string" id="8255017">&#34;chunked&#34;</span><span class="op" id="8255026">}</span><span class="op" id="8255027">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8255031">}</span><span class="op" id="8255032">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255037">Body</span><span class="op" id="8255041">:</span>&nbsp;<span class="op" id="8255043">[</span><span class="op" id="8255044">]</span><span class="builtintype" id="8255045">byte</span><span class="op" id="8255049">(</span><span class="string" id="8255050">&#34;abcdef&#34;</span><span class="op" id="8255058">)</span><span class="op" id="8255059">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255064">WantWrite</span><span class="op" id="8255073">:</span>&nbsp;<span class="string" id="8255075">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8255102">+</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255107">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8255134">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255139">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8255177">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255182">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8255219">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255224">chunk</span><span class="op" id="8255229">(</span><span class="string" id="8255230">&#34;abcdef&#34;</span><span class="op" id="8255238">)</span>&nbsp;<span class="op" id="8255240">+</span>&nbsp;<span class="ident" id="8255242">chunk</span><span class="op" id="8255247">(</span><span class="string" id="8255248">&#34;&#34;</span><span class="op" id="8255250">)</span><span class="op" id="8255251">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255256">WantProxy</span><span class="op" id="8255265">:</span>&nbsp;<span class="string" id="8255267">&#34;GET&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8255315">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255320">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8255347">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255352">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8255390">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255395">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8255432">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255437">chunk</span><span class="op" id="8255442">(</span><span class="string" id="8255443">&#34;abcdef&#34;</span><span class="op" id="8255451">)</span>&nbsp;<span class="op" id="8255453">+</span>&nbsp;<span class="ident" id="8255455">chunk</span><span class="op" id="8255460">(</span><span class="string" id="8255461">&#34;&#34;</span><span class="op" id="8255463">)</span><span class="op" id="8255464">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8255467">}</span><span class="op" id="8255468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8255471">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;=&gt;&nbsp;chunked&nbsp;coding;&nbsp;body;&nbsp;empty&nbsp;trailer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8255528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255532">Req</span><span class="op" id="8255535">:</span>&nbsp;<span class="ident" id="8255537">Request</span><span class="op" id="8255544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255549">Method</span><span class="op" id="8255555">:</span>&nbsp;<span class="string" id="8255557">&#34;POST&#34;</span><span class="op" id="8255563">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255568">URL</span><span class="op" id="8255571">:</span>&nbsp;<span class="op" id="8255573">&amp;</span><span class="ident" id="8255574">url</span><span class="op" id="8255577">.</span><span class="ident" id="8255578">URL</span><span class="op" id="8255581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255587">Scheme</span><span class="op" id="8255593">:</span>&nbsp;<span class="string" id="8255595">&#34;http&#34;</span><span class="op" id="8255601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255607">Host</span><span class="op" id="8255611">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8255615">&#34;www.google.com&#34;</span><span class="op" id="8255631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255637">Path</span><span class="op" id="8255641">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8255645">&#34;/search&#34;</span><span class="op" id="8255654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8255659">}</span><span class="op" id="8255660">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255665">ProtoMajor</span><span class="op" id="8255675">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8255683">1</span><span class="op" id="8255684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255689">ProtoMinor</span><span class="op" id="8255699">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8255707">1</span><span class="op" id="8255708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255713">Header</span><span class="op" id="8255719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255731">Header</span><span class="op" id="8255737">{</span><span class="op" id="8255738">}</span><span class="op" id="8255739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255744">Close</span><span class="op" id="8255749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8255762">true</span><span class="op" id="8255766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255771">TransferEncoding</span><span class="op" id="8255787">:</span>&nbsp;<span class="op" id="8255789">[</span><span class="op" id="8255790">]</span><span class="builtintype" id="8255791">string</span><span class="op" id="8255797">{</span><span class="string" id="8255798">&#34;chunked&#34;</span><span class="op" id="8255807">}</span><span class="op" id="8255808">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8255812">}</span><span class="op" id="8255813">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255818">Body</span><span class="op" id="8255822">:</span>&nbsp;<span class="op" id="8255824">[</span><span class="op" id="8255825">]</span><span class="builtintype" id="8255826">byte</span><span class="op" id="8255830">(</span><span class="string" id="8255831">&#34;abcdef&#34;</span><span class="op" id="8255839">)</span><span class="op" id="8255840">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8255845">WantWrite</span><span class="op" id="8255854">:</span>&nbsp;<span class="string" id="8255856">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8255884">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255889">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8255916">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255921">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8255959">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255964">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8255988">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8255993">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8256030">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256035">chunk</span><span class="op" id="8256040">(</span><span class="string" id="8256041">&#34;abcdef&#34;</span><span class="op" id="8256049">)</span>&nbsp;<span class="op" id="8256051">+</span>&nbsp;<span class="ident" id="8256053">chunk</span><span class="op" id="8256058">(</span><span class="string" id="8256059">&#34;&#34;</span><span class="op" id="8256061">)</span><span class="op" id="8256062">,</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256067">WantProxy</span><span class="op" id="8256076">:</span>&nbsp;<span class="string" id="8256078">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8256127">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256132">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8256159">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256164">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8256202">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256207">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8256231">+</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256236">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8256273">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256278">chunk</span><span class="op" id="8256283">(</span><span class="string" id="8256284">&#34;abcdef&#34;</span><span class="op" id="8256292">)</span>&nbsp;<span class="op" id="8256294">+</span>&nbsp;<span class="ident" id="8256296">chunk</span><span class="op" id="8256301">(</span><span class="string" id="8256302">&#34;&#34;</span><span class="op" id="8256304">)</span><span class="op" id="8256305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8256308">}</span><span class="op" id="8256309">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8256313">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length,&nbsp;no&nbsp;chunking</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8256364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256368">Req</span><span class="op" id="8256371">:</span>&nbsp;<span class="ident" id="8256373">Request</span><span class="op" id="8256380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256385">Method</span><span class="op" id="8256391">:</span>&nbsp;<span class="string" id="8256393">&#34;POST&#34;</span><span class="op" id="8256399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256404">URL</span><span class="op" id="8256407">:</span>&nbsp;<span class="op" id="8256409">&amp;</span><span class="ident" id="8256410">url</span><span class="op" id="8256413">.</span><span class="ident" id="8256414">URL</span><span class="op" id="8256417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256423">Scheme</span><span class="op" id="8256429">:</span>&nbsp;<span class="string" id="8256431">&#34;http&#34;</span><span class="op" id="8256437">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256443">Host</span><span class="op" id="8256447">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8256451">&#34;www.google.com&#34;</span><span class="op" id="8256467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256473">Path</span><span class="op" id="8256477">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8256481">&#34;/search&#34;</span><span class="op" id="8256490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8256495">}</span><span class="op" id="8256496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256501">ProtoMajor</span><span class="op" id="8256511">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8256516">1</span><span class="op" id="8256517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256522">ProtoMinor</span><span class="op" id="8256532">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8256537">1</span><span class="op" id="8256538">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256543">Header</span><span class="op" id="8256549">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256558">Header</span><span class="op" id="8256564">{</span><span class="op" id="8256565">}</span><span class="op" id="8256566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256571">Close</span><span class="op" id="8256576">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8256586">true</span><span class="op" id="8256590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256595">ContentLength</span><span class="op" id="8256608">:</span>&nbsp;<span class="num" id="8256610">6</span><span class="op" id="8256611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8256615">}</span><span class="op" id="8256616">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256621">Body</span><span class="op" id="8256625">:</span>&nbsp;<span class="op" id="8256627">[</span><span class="op" id="8256628">]</span><span class="builtintype" id="8256629">byte</span><span class="op" id="8256633">(</span><span class="string" id="8256634">&#34;abcdef&#34;</span><span class="op" id="8256642">)</span><span class="op" id="8256643">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256648">WantWrite</span><span class="op" id="8256657">:</span>&nbsp;<span class="string" id="8256659">&#34;POST&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8256687">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256692">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8256719">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256724">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8256762">+</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256767">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8256791">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256796">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8256820">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256825">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8256832">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256837">&#34;abcdef&#34;</span><span class="op" id="8256845">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8256850">WantProxy</span><span class="op" id="8256859">:</span>&nbsp;<span class="string" id="8256861">&#34;POST&nbsp;http://www.google.com/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8256910">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256915">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8256942">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256947">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8256985">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8256990">&#34;Connection:&nbsp;close\r\n&#34;</span>&nbsp;<span class="op" id="8257014">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257019">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8257043">+</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257048">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8257055">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257060">&#34;abcdef&#34;</span><span class="op" id="8257068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257071">}</span><span class="op" id="8257072">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8257076">//&nbsp;HTTP/1.1&nbsp;POST&nbsp;with&nbsp;Content-Length&nbsp;in&nbsp;headers</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257129">Req</span><span class="op" id="8257132">:</span>&nbsp;<span class="ident" id="8257134">Request</span><span class="op" id="8257141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257146">Method</span><span class="op" id="8257152">:</span>&nbsp;<span class="string" id="8257154">&#34;POST&#34;</span><span class="op" id="8257160">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257165">URL</span><span class="op" id="8257168">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257173">mustParseURL</span><span class="op" id="8257185">(</span><span class="string" id="8257186">&#34;http://example.com/&#34;</span><span class="op" id="8257207">)</span><span class="op" id="8257208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257213">Host</span><span class="op" id="8257217">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8257221">&#34;example.com&#34;</span><span class="op" id="8257234">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257239">Header</span><span class="op" id="8257245">:</span>&nbsp;<span class="ident" id="8257247">Header</span><span class="op" id="8257253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257259">&#34;Content-Length&#34;</span><span class="op" id="8257275">:</span>&nbsp;<span class="op" id="8257277">[</span><span class="op" id="8257278">]</span><span class="builtintype" id="8257279">string</span><span class="op" id="8257285">{</span><span class="string" id="8257286">&#34;10&#34;</span><span class="op" id="8257290">}</span><span class="op" id="8257291">,</span>&nbsp;<span class="comment" id="8257293">//&nbsp;ignored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257307">}</span><span class="op" id="8257308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257313">ContentLength</span><span class="op" id="8257326">:</span>&nbsp;<span class="num" id="8257328">6</span><span class="op" id="8257329">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257333">}</span><span class="op" id="8257334">,</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257339">Body</span><span class="op" id="8257343">:</span>&nbsp;<span class="op" id="8257345">[</span><span class="op" id="8257346">]</span><span class="builtintype" id="8257347">byte</span><span class="op" id="8257351">(</span><span class="string" id="8257352">&#34;abcdef&#34;</span><span class="op" id="8257360">)</span><span class="op" id="8257361">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257366">WantWrite</span><span class="op" id="8257375">:</span>&nbsp;<span class="string" id="8257377">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8257399">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257404">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8257428">+</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257433">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8257471">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257476">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8257500">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257505">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8257512">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257517">&#34;abcdef&#34;</span><span class="op" id="8257525">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257530">WantProxy</span><span class="op" id="8257539">:</span>&nbsp;<span class="string" id="8257541">&#34;POST&nbsp;http://example.com/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8257581">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257586">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8257610">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257615">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8257653">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257658">&#34;Content-Length:&nbsp;6\r\n&#34;</span>&nbsp;<span class="op" id="8257682">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257687">&#34;\r\n&#34;</span>&nbsp;<span class="op" id="8257694">+</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257699">&#34;abcdef&#34;</span><span class="op" id="8257707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257710">}</span><span class="op" id="8257711">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8257715">//&nbsp;default&nbsp;to&nbsp;HTTP/1.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257739">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257743">Req</span><span class="op" id="8257746">:</span>&nbsp;<span class="ident" id="8257748">Request</span><span class="op" id="8257755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257760">Method</span><span class="op" id="8257766">:</span>&nbsp;<span class="string" id="8257768">&#34;GET&#34;</span><span class="op" id="8257773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257778">URL</span><span class="op" id="8257781">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257786">mustParseURL</span><span class="op" id="8257798">(</span><span class="string" id="8257799">&#34;/search&#34;</span><span class="op" id="8257808">)</span><span class="op" id="8257809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257814">Host</span><span class="op" id="8257818">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8257822">&#34;www.google.com&#34;</span><span class="op" id="8257838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257842">}</span><span class="op" id="8257843">,</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8257848">WantWrite</span><span class="op" id="8257857">:</span>&nbsp;<span class="string" id="8257859">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8257886">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257891">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8257918">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257923">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8257961">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8257966">&#34;\r\n&#34;</span><span class="op" id="8257972">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8257975">}</span><span class="op" id="8257976">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8257980">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;0&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8258034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258038">Req</span><span class="op" id="8258041">:</span>&nbsp;<span class="ident" id="8258043">Request</span><span class="op" id="8258050">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258055">Method</span><span class="op" id="8258061">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258070">&#34;POST&#34;</span><span class="op" id="8258076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258081">URL</span><span class="op" id="8258084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258096">mustParseURL</span><span class="op" id="8258108">(</span><span class="string" id="8258109">&#34;/&#34;</span><span class="op" id="8258112">)</span><span class="op" id="8258113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258118">Host</span><span class="op" id="8258122">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258133">&#34;example.com&#34;</span><span class="op" id="8258146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258151">ProtoMajor</span><span class="op" id="8258161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8258166">1</span><span class="op" id="8258167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258172">ProtoMinor</span><span class="op" id="8258182">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8258187">1</span><span class="op" id="8258188">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258193">ContentLength</span><span class="op" id="8258206">:</span>&nbsp;<span class="num" id="8258208">0</span><span class="op" id="8258209">,</span>&nbsp;<span class="comment" id="8258211">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8258236">}</span><span class="op" id="8258237">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258242">Body</span><span class="op" id="8258246">:</span>&nbsp;<span class="keyword" id="8258248">func</span><span class="op" id="8258252">(</span><span class="op" id="8258253">)</span>&nbsp;<span class="ident" id="8258255">io</span><span class="op" id="8258257">.</span><span class="ident" id="8258258">ReadCloser</span>&nbsp;<span class="op" id="8258269">{</span>&nbsp;<span class="keyword" id="8258271">return</span>&nbsp;<span class="ident" id="8258278">ioutil</span><span class="op" id="8258284">.</span><span class="ident" id="8258285">NopCloser</span><span class="op" id="8258294">(</span><span class="ident" id="8258295">io</span><span class="op" id="8258297">.</span><span class="ident" id="8258298">LimitReader</span><span class="op" id="8258309">(</span><span class="ident" id="8258310">strings</span><span class="op" id="8258317">.</span><span class="ident" id="8258318">NewReader</span><span class="op" id="8258327">(</span><span class="string" id="8258328">&#34;xx&#34;</span><span class="op" id="8258332">)</span><span class="op" id="8258333">,</span>&nbsp;<span class="num" id="8258335">0</span><span class="op" id="8258336">)</span><span class="op" id="8258337">)</span>&nbsp;<span class="op" id="8258339">}</span><span class="op" id="8258340">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8258345">//&nbsp;RFC&nbsp;2616&nbsp;Section&nbsp;14.13&nbsp;says&nbsp;Content-Length&nbsp;should&nbsp;be&nbsp;specified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8258413">//&nbsp;unless&nbsp;body&nbsp;is&nbsp;prohibited&nbsp;by&nbsp;the&nbsp;request&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8258467">//&nbsp;Also,&nbsp;nginx&nbsp;expects&nbsp;it&nbsp;for&nbsp;POST&nbsp;and&nbsp;PUT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258513">WantWrite</span><span class="op" id="8258522">:</span>&nbsp;<span class="string" id="8258524">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8258546">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258551">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8258575">+</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258580">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8258618">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258623">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8258647">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258652">&#34;\r\n&#34;</span><span class="op" id="8258658">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258663">WantProxy</span><span class="op" id="8258672">:</span>&nbsp;<span class="string" id="8258674">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8258696">+</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258701">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8258725">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258730">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8258768">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258773">&#34;Content-Length:&nbsp;0\r\n&#34;</span>&nbsp;<span class="op" id="8258797">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258802">&#34;\r\n&#34;</span><span class="op" id="8258808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8258811">}</span><span class="op" id="8258812">,</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8258816">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;1&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8258870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258874">Req</span><span class="op" id="8258877">:</span>&nbsp;<span class="ident" id="8258879">Request</span><span class="op" id="8258886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258891">Method</span><span class="op" id="8258897">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258906">&#34;POST&#34;</span><span class="op" id="8258912">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258917">URL</span><span class="op" id="8258920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258932">mustParseURL</span><span class="op" id="8258944">(</span><span class="string" id="8258945">&#34;/&#34;</span><span class="op" id="8258948">)</span><span class="op" id="8258949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258954">Host</span><span class="op" id="8258958">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8258969">&#34;example.com&#34;</span><span class="op" id="8258982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8258987">ProtoMajor</span><span class="op" id="8258997">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8259002">1</span><span class="op" id="8259003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259008">ProtoMinor</span><span class="op" id="8259018">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8259023">1</span><span class="op" id="8259024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259029">ContentLength</span><span class="op" id="8259042">:</span>&nbsp;<span class="num" id="8259044">0</span><span class="op" id="8259045">,</span>&nbsp;<span class="comment" id="8259047">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259072">}</span><span class="op" id="8259073">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259078">Body</span><span class="op" id="8259082">:</span>&nbsp;<span class="keyword" id="8259084">func</span><span class="op" id="8259088">(</span><span class="op" id="8259089">)</span>&nbsp;<span class="ident" id="8259091">io</span><span class="op" id="8259093">.</span><span class="ident" id="8259094">ReadCloser</span>&nbsp;<span class="op" id="8259105">{</span>&nbsp;<span class="keyword" id="8259107">return</span>&nbsp;<span class="ident" id="8259114">ioutil</span><span class="op" id="8259120">.</span><span class="ident" id="8259121">NopCloser</span><span class="op" id="8259130">(</span><span class="ident" id="8259131">io</span><span class="op" id="8259133">.</span><span class="ident" id="8259134">LimitReader</span><span class="op" id="8259145">(</span><span class="ident" id="8259146">strings</span><span class="op" id="8259153">.</span><span class="ident" id="8259154">NewReader</span><span class="op" id="8259163">(</span><span class="string" id="8259164">&#34;xx&#34;</span><span class="op" id="8259168">)</span><span class="op" id="8259169">,</span>&nbsp;<span class="num" id="8259171">1</span><span class="op" id="8259172">)</span><span class="op" id="8259173">)</span>&nbsp;<span class="op" id="8259175">}</span><span class="op" id="8259176">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259181">WantWrite</span><span class="op" id="8259190">:</span>&nbsp;<span class="string" id="8259192">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8259214">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259219">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8259243">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259248">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8259286">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259291">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8259328">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259333">chunk</span><span class="op" id="8259338">(</span><span class="string" id="8259339">&#34;x&#34;</span><span class="op" id="8259342">)</span>&nbsp;<span class="op" id="8259344">+</span>&nbsp;<span class="ident" id="8259346">chunk</span><span class="op" id="8259351">(</span><span class="string" id="8259352">&#34;&#34;</span><span class="op" id="8259354">)</span><span class="op" id="8259355">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259360">WantProxy</span><span class="op" id="8259369">:</span>&nbsp;<span class="string" id="8259371">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8259393">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259398">&#34;Host:&nbsp;example.com\r\n&#34;</span>&nbsp;<span class="op" id="8259422">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259427">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8259465">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259470">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8259507">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259512">chunk</span><span class="op" id="8259517">(</span><span class="string" id="8259518">&#34;x&#34;</span><span class="op" id="8259521">)</span>&nbsp;<span class="op" id="8259523">+</span>&nbsp;<span class="ident" id="8259525">chunk</span><span class="op" id="8259530">(</span><span class="string" id="8259531">&#34;&#34;</span><span class="op" id="8259533">)</span><span class="op" id="8259534">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259537">}</span><span class="op" id="8259538">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8259542">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;10&nbsp;but&nbsp;a&nbsp;5&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259604">Req</span><span class="op" id="8259607">:</span>&nbsp;<span class="ident" id="8259609">Request</span><span class="op" id="8259616">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259621">Method</span><span class="op" id="8259627">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259636">&#34;POST&#34;</span><span class="op" id="8259642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259647">URL</span><span class="op" id="8259650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259662">mustParseURL</span><span class="op" id="8259674">(</span><span class="string" id="8259675">&#34;/&#34;</span><span class="op" id="8259678">)</span><span class="op" id="8259679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259684">Host</span><span class="op" id="8259688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8259699">&#34;example.com&#34;</span><span class="op" id="8259712">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259717">ProtoMajor</span><span class="op" id="8259727">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8259732">1</span><span class="op" id="8259733">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259738">ProtoMinor</span><span class="op" id="8259748">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8259753">1</span><span class="op" id="8259754">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259759">ContentLength</span><span class="op" id="8259772">:</span>&nbsp;<span class="num" id="8259774">10</span><span class="op" id="8259776">,</span>&nbsp;<span class="comment" id="8259778">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;send&nbsp;only&nbsp;5&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259820">}</span><span class="op" id="8259821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259825">Body</span><span class="op" id="8259829">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259836">[</span><span class="op" id="8259837">]</span><span class="builtintype" id="8259838">byte</span><span class="op" id="8259842">(</span><span class="string" id="8259843">&#34;12345&#34;</span><span class="op" id="8259850">)</span><span class="op" id="8259851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259855">WantError</span><span class="op" id="8259864">:</span>&nbsp;<span class="ident" id="8259866">errors</span><span class="op" id="8259872">.</span><span class="ident" id="8259873">New</span><span class="op" id="8259876">(</span><span class="string" id="8259877">&#34;http:&nbsp;ContentLength=10&nbsp;with&nbsp;Body&nbsp;length&nbsp;5&#34;</span><span class="op" id="8259920">)</span><span class="op" id="8259921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259924">}</span><span class="op" id="8259925">,</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8259929">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;ContentLength&nbsp;of&nbsp;4&nbsp;but&nbsp;an&nbsp;8&nbsp;byte&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8259987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8259991">Req</span><span class="op" id="8259994">:</span>&nbsp;<span class="ident" id="8259996">Request</span><span class="op" id="8260003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260008">Method</span><span class="op" id="8260014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260023">&#34;POST&#34;</span><span class="op" id="8260029">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260034">URL</span><span class="op" id="8260037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260049">mustParseURL</span><span class="op" id="8260061">(</span><span class="string" id="8260062">&#34;/&#34;</span><span class="op" id="8260065">)</span><span class="op" id="8260066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260071">Host</span><span class="op" id="8260075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260086">&#34;example.com&#34;</span><span class="op" id="8260099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260104">ProtoMajor</span><span class="op" id="8260114">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260119">1</span><span class="op" id="8260120">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260125">ProtoMinor</span><span class="op" id="8260135">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260140">1</span><span class="op" id="8260141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260146">ContentLength</span><span class="op" id="8260159">:</span>&nbsp;<span class="num" id="8260161">4</span><span class="op" id="8260162">,</span>&nbsp;<span class="comment" id="8260164">//&nbsp;but&nbsp;we&#39;re&nbsp;going&nbsp;to&nbsp;try&nbsp;to&nbsp;send&nbsp;8&nbsp;bytes</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260208">}</span><span class="op" id="8260209">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260213">Body</span><span class="op" id="8260217">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260224">[</span><span class="op" id="8260225">]</span><span class="builtintype" id="8260226">byte</span><span class="op" id="8260230">(</span><span class="string" id="8260231">&#34;12345678&#34;</span><span class="op" id="8260241">)</span><span class="op" id="8260242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260246">WantError</span><span class="op" id="8260255">:</span>&nbsp;<span class="ident" id="8260257">errors</span><span class="op" id="8260263">.</span><span class="ident" id="8260264">New</span><span class="op" id="8260267">(</span><span class="string" id="8260268">&#34;http:&nbsp;ContentLength=4&nbsp;with&nbsp;Body&nbsp;length&nbsp;8&#34;</span><span class="op" id="8260310">)</span><span class="op" id="8260311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260314">}</span><span class="op" id="8260315">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8260319">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;5&nbsp;ContentLength&nbsp;and&nbsp;nil&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260372">Req</span><span class="op" id="8260375">:</span>&nbsp;<span class="ident" id="8260377">Request</span><span class="op" id="8260384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260389">Method</span><span class="op" id="8260395">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260404">&#34;POST&#34;</span><span class="op" id="8260410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260415">URL</span><span class="op" id="8260418">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260430">mustParseURL</span><span class="op" id="8260442">(</span><span class="string" id="8260443">&#34;/&#34;</span><span class="op" id="8260446">)</span><span class="op" id="8260447">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260452">Host</span><span class="op" id="8260456">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260467">&#34;example.com&#34;</span><span class="op" id="8260480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260485">ProtoMajor</span><span class="op" id="8260495">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260500">1</span><span class="op" id="8260501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260506">ProtoMinor</span><span class="op" id="8260516">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260521">1</span><span class="op" id="8260522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260527">ContentLength</span><span class="op" id="8260540">:</span>&nbsp;<span class="num" id="8260542">5</span><span class="op" id="8260543">,</span>&nbsp;<span class="comment" id="8260545">//&nbsp;but&nbsp;we&#39;ll&nbsp;omit&nbsp;the&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260574">}</span><span class="op" id="8260575">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260579">WantError</span><span class="op" id="8260588">:</span>&nbsp;<span class="ident" id="8260590">errors</span><span class="op" id="8260596">.</span><span class="ident" id="8260597">New</span><span class="op" id="8260600">(</span><span class="string" id="8260601">&#34;http:&nbsp;Request.ContentLength=5&nbsp;with&nbsp;nil&nbsp;Body&#34;</span><span class="op" id="8260646">)</span><span class="op" id="8260647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260650">}</span><span class="op" id="8260651">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8260655">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;with&nbsp;1&nbsp;byte&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260735">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260739">Req</span><span class="op" id="8260742">:</span>&nbsp;<span class="ident" id="8260744">Request</span><span class="op" id="8260751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260756">Method</span><span class="op" id="8260762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260771">&#34;POST&#34;</span><span class="op" id="8260777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260782">URL</span><span class="op" id="8260785">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260797">mustParseURL</span><span class="op" id="8260809">(</span><span class="string" id="8260810">&#34;/&#34;</span><span class="op" id="8260813">)</span><span class="op" id="8260814">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260819">Host</span><span class="op" id="8260823">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8260834">&#34;example.com&#34;</span><span class="op" id="8260847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260852">ProtoMajor</span><span class="op" id="8260862">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260867">1</span><span class="op" id="8260868">,</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260873">ProtoMinor</span><span class="op" id="8260883">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8260888">1</span><span class="op" id="8260889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260894">ContentLength</span><span class="op" id="8260907">:</span>&nbsp;<span class="num" id="8260909">0</span><span class="op" id="8260910">,</span>&nbsp;<span class="comment" id="8260912">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8260937">}</span><span class="op" id="8260938">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260943">Body</span><span class="op" id="8260947">:</span>&nbsp;<span class="keyword" id="8260949">func</span><span class="op" id="8260953">(</span><span class="op" id="8260954">)</span>&nbsp;<span class="ident" id="8260956">io</span><span class="op" id="8260958">.</span><span class="ident" id="8260959">ReadCloser</span>&nbsp;<span class="op" id="8260970">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8260975">err</span>&nbsp;<span class="op" id="8260979">:=</span>&nbsp;<span class="ident" id="8260982">errors</span><span class="op" id="8260988">.</span><span class="ident" id="8260989">New</span><span class="op" id="8260992">(</span><span class="string" id="8260993">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8261014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261019">errReader</span>&nbsp;<span class="op" id="8261029">:=</span>&nbsp;<span class="op" id="8261032">&amp;</span><span class="ident" id="8261033">errorReader</span><span class="op" id="8261044">{</span><span class="ident" id="8261045">err</span><span class="op" id="8261048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8261053">return</span>&nbsp;<span class="ident" id="8261060">ioutil</span><span class="op" id="8261066">.</span><span class="ident" id="8261067">NopCloser</span><span class="op" id="8261076">(</span><span class="ident" id="8261077">io</span><span class="op" id="8261079">.</span><span class="ident" id="8261080">MultiReader</span><span class="op" id="8261091">(</span><span class="ident" id="8261092">strings</span><span class="op" id="8261099">.</span><span class="ident" id="8261100">NewReader</span><span class="op" id="8261109">(</span><span class="string" id="8261110">&#34;x&#34;</span><span class="op" id="8261113">)</span><span class="op" id="8261114">,</span>&nbsp;<span class="ident" id="8261116">errReader</span><span class="op" id="8261125">)</span><span class="op" id="8261126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261130">}</span><span class="op" id="8261131">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261136">WantError</span><span class="op" id="8261145">:</span>&nbsp;<span class="ident" id="8261147">errors</span><span class="op" id="8261153">.</span><span class="ident" id="8261154">New</span><span class="op" id="8261157">(</span><span class="string" id="8261158">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8261179">)</span><span class="op" id="8261180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261183">}</span><span class="op" id="8261184">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8261188">//&nbsp;Request&nbsp;with&nbsp;a&nbsp;0&nbsp;ContentLength&nbsp;and&nbsp;a&nbsp;body&nbsp;without&nbsp;content&nbsp;and&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261264">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261268">Req</span><span class="op" id="8261271">:</span>&nbsp;<span class="ident" id="8261273">Request</span><span class="op" id="8261280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261285">Method</span><span class="op" id="8261291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261300">&#34;POST&#34;</span><span class="op" id="8261306">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261311">URL</span><span class="op" id="8261314">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261326">mustParseURL</span><span class="op" id="8261338">(</span><span class="string" id="8261339">&#34;/&#34;</span><span class="op" id="8261342">)</span><span class="op" id="8261343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261348">Host</span><span class="op" id="8261352">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261363">&#34;example.com&#34;</span><span class="op" id="8261376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261381">ProtoMajor</span><span class="op" id="8261391">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8261396">1</span><span class="op" id="8261397">,</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261402">ProtoMinor</span><span class="op" id="8261412">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="8261417">1</span><span class="op" id="8261418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261423">ContentLength</span><span class="op" id="8261436">:</span>&nbsp;<span class="num" id="8261438">0</span><span class="op" id="8261439">,</span>&nbsp;<span class="comment" id="8261441">//&nbsp;as&nbsp;if&nbsp;unset&nbsp;by&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261466">}</span><span class="op" id="8261467">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261472">Body</span><span class="op" id="8261476">:</span>&nbsp;<span class="keyword" id="8261478">func</span><span class="op" id="8261482">(</span><span class="op" id="8261483">)</span>&nbsp;<span class="ident" id="8261485">io</span><span class="op" id="8261487">.</span><span class="ident" id="8261488">ReadCloser</span>&nbsp;<span class="op" id="8261499">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261504">err</span>&nbsp;<span class="op" id="8261508">:=</span>&nbsp;<span class="ident" id="8261511">errors</span><span class="op" id="8261517">.</span><span class="ident" id="8261518">New</span><span class="op" id="8261521">(</span><span class="string" id="8261522">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8261543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261548">errReader</span>&nbsp;<span class="op" id="8261558">:=</span>&nbsp;<span class="op" id="8261561">&amp;</span><span class="ident" id="8261562">errorReader</span><span class="op" id="8261573">{</span><span class="ident" id="8261574">err</span><span class="op" id="8261577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8261582">return</span>&nbsp;<span class="ident" id="8261589">ioutil</span><span class="op" id="8261595">.</span><span class="ident" id="8261596">NopCloser</span><span class="op" id="8261605">(</span><span class="ident" id="8261606">errReader</span><span class="op" id="8261615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261619">}</span><span class="op" id="8261620">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261625">WantError</span><span class="op" id="8261634">:</span>&nbsp;<span class="ident" id="8261636">errors</span><span class="op" id="8261642">.</span><span class="ident" id="8261643">New</span><span class="op" id="8261646">(</span><span class="string" id="8261647">&#34;Custom&nbsp;reader&nbsp;error&#34;</span><span class="op" id="8261668">)</span><span class="op" id="8261669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261672">}</span><span class="op" id="8261673">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8261677">//&nbsp;Verify&nbsp;that&nbsp;DumpRequest&nbsp;preserves&nbsp;the&nbsp;HTTP&nbsp;version&nbsp;number,&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;Host,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8261760">//&nbsp;and&nbsp;doesn&#39;t&nbsp;add&nbsp;a&nbsp;User-Agent.</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261798">Req</span><span class="op" id="8261801">:</span>&nbsp;<span class="ident" id="8261803">Request</span><span class="op" id="8261810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261815">Method</span><span class="op" id="8261821">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261827">&#34;GET&#34;</span><span class="op" id="8261832">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261837">URL</span><span class="op" id="8261840">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261849">mustParseURL</span><span class="op" id="8261861">(</span><span class="string" id="8261862">&#34;/foo&#34;</span><span class="op" id="8261868">)</span><span class="op" id="8261869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261874">ProtoMajor</span><span class="op" id="8261884">:</span>&nbsp;<span class="num" id="8261886">1</span><span class="op" id="8261887">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261892">ProtoMinor</span><span class="op" id="8261902">:</span>&nbsp;<span class="num" id="8261904">0</span><span class="op" id="8261905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261910">Header</span><span class="op" id="8261916">:</span>&nbsp;<span class="ident" id="8261918">Header</span><span class="op" id="8261924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8261930">&#34;X-Foo&#34;</span><span class="op" id="8261937">:</span>&nbsp;<span class="op" id="8261939">[</span><span class="op" id="8261940">]</span><span class="builtintype" id="8261941">string</span><span class="op" id="8261947">{</span><span class="string" id="8261948">&#34;X-Bar&#34;</span><span class="op" id="8261955">}</span><span class="op" id="8261956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261961">}</span><span class="op" id="8261962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8261966">}</span><span class="op" id="8261967">,</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8261972">WantWrite</span><span class="op" id="8261981">:</span>&nbsp;<span class="string" id="8261983">&#34;GET&nbsp;/foo&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8262007">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262012">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8262025">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262030">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8262068">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262073">&#34;X-Foo:&nbsp;X-Bar\r\n\r\n&#34;</span><span class="op" id="8262095">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262098">}</span><span class="op" id="8262099">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8262103">//&nbsp;If&nbsp;no&nbsp;Request.Host&nbsp;and&nbsp;no&nbsp;Request.URL.Host,&nbsp;we&nbsp;send</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8262159">//&nbsp;an&nbsp;empty&nbsp;Host&nbsp;header,&nbsp;and&nbsp;don&#39;t&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8262199">//&nbsp;Request.Header[&#34;Host&#34;].&nbsp;This&nbsp;is&nbsp;just&nbsp;testing&nbsp;that</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8262253">//&nbsp;we&nbsp;don&#39;t&nbsp;change&nbsp;Go&nbsp;1.0&nbsp;behavior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262294">Req</span><span class="op" id="8262297">:</span>&nbsp;<span class="ident" id="8262299">Request</span><span class="op" id="8262306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262311">Method</span><span class="op" id="8262317">:</span>&nbsp;<span class="string" id="8262319">&#34;GET&#34;</span><span class="op" id="8262324">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262329">Host</span><span class="op" id="8262333">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8262337">&#34;&#34;</span><span class="op" id="8262339">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262344">URL</span><span class="op" id="8262347">:</span>&nbsp;<span class="op" id="8262349">&amp;</span><span class="ident" id="8262350">url</span><span class="op" id="8262353">.</span><span class="ident" id="8262354">URL</span><span class="op" id="8262357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262363">Scheme</span><span class="op" id="8262369">:</span>&nbsp;<span class="string" id="8262371">&#34;http&#34;</span><span class="op" id="8262377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262383">Host</span><span class="op" id="8262387">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8262391">&#34;&#34;</span><span class="op" id="8262393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262399">Path</span><span class="op" id="8262403">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8262407">&#34;/search&#34;</span><span class="op" id="8262416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262421">}</span><span class="op" id="8262422">,</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262427">ProtoMajor</span><span class="op" id="8262437">:</span>&nbsp;<span class="num" id="8262439">1</span><span class="op" id="8262440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262445">ProtoMinor</span><span class="op" id="8262455">:</span>&nbsp;<span class="num" id="8262457">1</span><span class="op" id="8262458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262463">Header</span><span class="op" id="8262469">:</span>&nbsp;<span class="ident" id="8262471">Header</span><span class="op" id="8262477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262483">&#34;Host&#34;</span><span class="op" id="8262489">:</span>&nbsp;<span class="op" id="8262491">[</span><span class="op" id="8262492">]</span><span class="builtintype" id="8262493">string</span><span class="op" id="8262499">{</span><span class="string" id="8262500">&#34;bad.example.com&#34;</span><span class="op" id="8262517">}</span><span class="op" id="8262518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262523">}</span><span class="op" id="8262524">,</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262528">}</span><span class="op" id="8262529">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262534">WantWrite</span><span class="op" id="8262543">:</span>&nbsp;<span class="string" id="8262545">&#34;GET&nbsp;/search&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8262572">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262577">&#34;Host:&nbsp;\r\n&#34;</span>&nbsp;<span class="op" id="8262590">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262595">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8262636">,</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262639">}</span><span class="op" id="8262640">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8262644">//&nbsp;Opaque&nbsp;test&nbsp;#1&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262694">Req</span><span class="op" id="8262697">:</span>&nbsp;<span class="ident" id="8262699">Request</span><span class="op" id="8262706">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262711">Method</span><span class="op" id="8262717">:</span>&nbsp;<span class="string" id="8262719">&#34;GET&#34;</span><span class="op" id="8262724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262729">URL</span><span class="op" id="8262732">:</span>&nbsp;<span class="op" id="8262734">&amp;</span><span class="ident" id="8262735">url</span><span class="op" id="8262738">.</span><span class="ident" id="8262739">URL</span><span class="op" id="8262742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262748">Scheme</span><span class="op" id="8262754">:</span>&nbsp;<span class="string" id="8262756">&#34;http&#34;</span><span class="op" id="8262762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262768">Host</span><span class="op" id="8262772">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8262776">&#34;www.google.com&#34;</span><span class="op" id="8262792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262798">Opaque</span><span class="op" id="8262804">:</span>&nbsp;<span class="string" id="8262806">&#34;/%2F/%2F/&#34;</span><span class="op" id="8262817">,</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262822">}</span><span class="op" id="8262823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262828">ProtoMajor</span><span class="op" id="8262838">:</span>&nbsp;<span class="num" id="8262840">1</span><span class="op" id="8262841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262846">ProtoMinor</span><span class="op" id="8262856">:</span>&nbsp;<span class="num" id="8262858">1</span><span class="op" id="8262859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262864">Header</span><span class="op" id="8262870">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262876">Header</span><span class="op" id="8262882">{</span><span class="op" id="8262883">}</span><span class="op" id="8262884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8262888">}</span><span class="op" id="8262889">,</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8262894">WantWrite</span><span class="op" id="8262903">:</span>&nbsp;<span class="string" id="8262905">&#34;GET&nbsp;/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8262934">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262939">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8262966">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8262971">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8263012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263015">}</span><span class="op" id="8263016">,</span><br>
<span class="lineno">415</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8263020">//&nbsp;Opaque&nbsp;test&nbsp;#2&nbsp;from&nbsp;golang.org/issue/4860</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263070">Req</span><span class="op" id="8263073">:</span>&nbsp;<span class="ident" id="8263075">Request</span><span class="op" id="8263082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263087">Method</span><span class="op" id="8263093">:</span>&nbsp;<span class="string" id="8263095">&#34;GET&#34;</span><span class="op" id="8263100">,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263105">URL</span><span class="op" id="8263108">:</span>&nbsp;<span class="op" id="8263110">&amp;</span><span class="ident" id="8263111">url</span><span class="op" id="8263114">.</span><span class="ident" id="8263115">URL</span><span class="op" id="8263118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263124">Scheme</span><span class="op" id="8263130">:</span>&nbsp;<span class="string" id="8263132">&#34;http&#34;</span><span class="op" id="8263138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263144">Host</span><span class="op" id="8263148">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8263152">&#34;x.google.com&#34;</span><span class="op" id="8263166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263172">Opaque</span><span class="op" id="8263178">:</span>&nbsp;<span class="string" id="8263180">&#34;//y.google.com/%2F/%2F/&#34;</span><span class="op" id="8263205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263210">}</span><span class="op" id="8263211">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263216">ProtoMajor</span><span class="op" id="8263226">:</span>&nbsp;<span class="num" id="8263228">1</span><span class="op" id="8263229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263234">ProtoMinor</span><span class="op" id="8263244">:</span>&nbsp;<span class="num" id="8263246">1</span><span class="op" id="8263247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263252">Header</span><span class="op" id="8263258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263264">Header</span><span class="op" id="8263270">{</span><span class="op" id="8263271">}</span><span class="op" id="8263272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263276">}</span><span class="op" id="8263277">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263282">WantWrite</span><span class="op" id="8263291">:</span>&nbsp;<span class="string" id="8263293">&#34;GET&nbsp;http://y.google.com/%2F/%2F/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8263341">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263346">&#34;Host:&nbsp;x.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8263371">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263376">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n\r\n&#34;</span><span class="op" id="8263417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263420">}</span><span class="op" id="8263421">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8263425">//&nbsp;Testing&nbsp;custom&nbsp;case&nbsp;in&nbsp;header&nbsp;keys.&nbsp;Issue&nbsp;5022.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263481">Req</span><span class="op" id="8263484">:</span>&nbsp;<span class="ident" id="8263486">Request</span><span class="op" id="8263493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263498">Method</span><span class="op" id="8263504">:</span>&nbsp;<span class="string" id="8263506">&#34;GET&#34;</span><span class="op" id="8263511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263516">URL</span><span class="op" id="8263519">:</span>&nbsp;<span class="op" id="8263521">&amp;</span><span class="ident" id="8263522">url</span><span class="op" id="8263525">.</span><span class="ident" id="8263526">URL</span><span class="op" id="8263529">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263535">Scheme</span><span class="op" id="8263541">:</span>&nbsp;<span class="string" id="8263543">&#34;http&#34;</span><span class="op" id="8263549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263555">Host</span><span class="op" id="8263559">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8263563">&#34;www.google.com&#34;</span><span class="op" id="8263579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263585">Path</span><span class="op" id="8263589">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8263593">&#34;/&#34;</span><span class="op" id="8263596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263601">}</span><span class="op" id="8263602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263607">Proto</span><span class="op" id="8263612">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263619">&#34;HTTP/1.1&#34;</span><span class="op" id="8263629">,</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263634">ProtoMajor</span><span class="op" id="8263644">:</span>&nbsp;<span class="num" id="8263646">1</span><span class="op" id="8263647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263652">ProtoMinor</span><span class="op" id="8263662">:</span>&nbsp;<span class="num" id="8263664">1</span><span class="op" id="8263665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263670">Header</span><span class="op" id="8263676">:</span>&nbsp;<span class="ident" id="8263678">Header</span><span class="op" id="8263684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263690">&#34;ALL-CAPS&#34;</span><span class="op" id="8263700">:</span>&nbsp;<span class="op" id="8263702">{</span><span class="string" id="8263703">&#34;x&#34;</span><span class="op" id="8263706">}</span><span class="op" id="8263707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263712">}</span><span class="op" id="8263713">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263717">}</span><span class="op" id="8263718">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263723">WantWrite</span><span class="op" id="8263732">:</span>&nbsp;<span class="string" id="8263734">&#34;GET&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8263755">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263760">&#34;Host:&nbsp;www.google.com\r\n&#34;</span>&nbsp;<span class="op" id="8263787">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263792">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8263830">+</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263835">&#34;ALL-CAPS:&nbsp;x\r\n&#34;</span>&nbsp;<span class="op" id="8263853">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8263858">&#34;\r\n&#34;</span><span class="op" id="8263864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8263867">}</span><span class="op" id="8263868">,</span><br>
<span class="lineno"></span><span class="op" id="8263870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span><span class="keyword" id="8263873">func</span>&nbsp;<span class="ident" id="8263878">TestRequestWrite</span><span class="op" id="8263894">(</span><span class="ident" id="8263895">t</span>&nbsp;<span class="op" id="8263897">*</span><span class="ident" id="8263898">testing</span><span class="op" id="8263905">.</span><span class="ident" id="8263906">T</span><span class="op" id="8263907">)</span>&nbsp;<span class="op" id="8263909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8263912">for</span>&nbsp;<span class="ident" id="8263916">i</span>&nbsp;<span class="op" id="8263918">:=</span>&nbsp;<span class="keyword" id="8263921">range</span>&nbsp;<span class="ident" id="8263927">reqWriteTests</span>&nbsp;<span class="op" id="8263941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263945">tt</span>&nbsp;<span class="op" id="8263948">:=</span>&nbsp;<span class="op" id="8263951">&amp;</span><span class="ident" id="8263952">reqWriteTests</span><span class="op" id="8263965">[</span><span class="ident" id="8263966">i</span><span class="op" id="8263967">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8263972">setBody</span>&nbsp;<span class="op" id="8263980">:=</span>&nbsp;<span class="keyword" id="8263983">func</span><span class="op" id="8263987">(</span><span class="op" id="8263988">)</span>&nbsp;<span class="op" id="8263990">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8263995">if</span>&nbsp;<span class="ident" id="8263998">tt</span><span class="op" id="8264000">.</span><span class="ident" id="8264001">Body</span>&nbsp;<span class="op" id="8264006">==</span>&nbsp;<span class="ident" id="8264009">nil</span>&nbsp;<span class="op" id="8264013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264019">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264034">switch</span>&nbsp;<span class="ident" id="8264041">b</span>&nbsp;<span class="op" id="8264043">:=</span>&nbsp;<span class="ident" id="8264046">tt</span><span class="op" id="8264048">.</span><span class="ident" id="8264049">Body</span><span class="op" id="8264053">.</span><span class="op" id="8264054">(</span><span class="keyword" id="8264055">type</span><span class="op" id="8264059">)</span>&nbsp;<span class="op" id="8264061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264066">case</span>&nbsp;<span class="op" id="8264071">[</span><span class="op" id="8264072">]</span><span class="builtintype" id="8264073">byte</span><span class="op" id="8264077">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264083">tt</span><span class="op" id="8264085">.</span><span class="ident" id="8264086">Req</span><span class="op" id="8264089">.</span><span class="ident" id="8264090">Body</span>&nbsp;<span class="op" id="8264095">=</span>&nbsp;<span class="ident" id="8264097">ioutil</span><span class="op" id="8264103">.</span><span class="ident" id="8264104">NopCloser</span><span class="op" id="8264113">(</span><span class="ident" id="8264114">bytes</span><span class="op" id="8264119">.</span><span class="ident" id="8264120">NewReader</span><span class="op" id="8264129">(</span><span class="ident" id="8264130">b</span><span class="op" id="8264131">)</span><span class="op" id="8264132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264137">case</span>&nbsp;<span class="keyword" id="8264142">func</span><span class="op" id="8264146">(</span><span class="op" id="8264147">)</span>&nbsp;<span class="ident" id="8264149">io</span><span class="op" id="8264151">.</span><span class="ident" id="8264152">ReadCloser</span><span class="op" id="8264162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264168">tt</span><span class="op" id="8264170">.</span><span class="ident" id="8264171">Req</span><span class="op" id="8264174">.</span><span class="ident" id="8264175">Body</span>&nbsp;<span class="op" id="8264180">=</span>&nbsp;<span class="ident" id="8264182">b</span><span class="op" id="8264183">(</span><span class="op" id="8264184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264193">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264197">setBody</span><span class="op" id="8264204">(</span><span class="op" id="8264205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264209">if</span>&nbsp;<span class="ident" id="8264212">tt</span><span class="op" id="8264214">.</span><span class="ident" id="8264215">Req</span><span class="op" id="8264218">.</span><span class="ident" id="8264219">Header</span>&nbsp;<span class="op" id="8264226">==</span>&nbsp;<span class="ident" id="8264229">nil</span>&nbsp;<span class="op" id="8264233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264238">tt</span><span class="op" id="8264240">.</span><span class="ident" id="8264241">Req</span><span class="op" id="8264244">.</span><span class="ident" id="8264245">Header</span>&nbsp;<span class="op" id="8264252">=</span>&nbsp;<span class="builtinfunc" id="8264254">make</span><span class="op" id="8264258">(</span><span class="ident" id="8264259">Header</span><span class="op" id="8264265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264274">var</span>&nbsp;<span class="ident" id="8264278">braw</span>&nbsp;<span class="ident" id="8264283">bytes</span><span class="op" id="8264288">.</span><span class="ident" id="8264289">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264298">err</span>&nbsp;<span class="op" id="8264302">:=</span>&nbsp;<span class="ident" id="8264305">tt</span><span class="op" id="8264307">.</span><span class="ident" id="8264308">Req</span><span class="op" id="8264311">.</span><span class="ident" id="8264312">Write</span><span class="op" id="8264317">(</span><span class="op" id="8264318">&amp;</span><span class="ident" id="8264319">braw</span><span class="op" id="8264323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264327">if</span>&nbsp;<span class="ident" id="8264330">g</span><span class="op" id="8264331">,</span>&nbsp;<span class="ident" id="8264333">e</span>&nbsp;<span class="op" id="8264335">:=</span>&nbsp;<span class="ident" id="8264338">fmt</span><span class="op" id="8264341">.</span><span class="ident" id="8264342">Sprintf</span><span class="op" id="8264349">(</span><span class="string" id="8264350">&#34;%v&#34;</span><span class="op" id="8264354">,</span>&nbsp;<span class="ident" id="8264356">err</span><span class="op" id="8264359">)</span><span class="op" id="8264360">,</span>&nbsp;<span class="ident" id="8264362">fmt</span><span class="op" id="8264365">.</span><span class="ident" id="8264366">Sprintf</span><span class="op" id="8264373">(</span><span class="string" id="8264374">&#34;%v&#34;</span><span class="op" id="8264378">,</span>&nbsp;<span class="ident" id="8264380">tt</span><span class="op" id="8264382">.</span><span class="ident" id="8264383">WantError</span><span class="op" id="8264392">)</span><span class="op" id="8264393">;</span>&nbsp;<span class="ident" id="8264395">g</span>&nbsp;<span class="op" id="8264397">!=</span>&nbsp;<span class="ident" id="8264400">e</span>&nbsp;<span class="op" id="8264402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264407">t</span><span class="op" id="8264408">.</span><span class="ident" id="8264409">Errorf</span><span class="op" id="8264415">(</span><span class="string" id="8264416">&#34;writing&nbsp;#%d,&nbsp;err&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8264448">,</span>&nbsp;<span class="ident" id="8264450">i</span><span class="op" id="8264451">,</span>&nbsp;<span class="ident" id="8264453">g</span><span class="op" id="8264454">,</span>&nbsp;<span class="ident" id="8264456">e</span><span class="op" id="8264457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264462">continue</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264477">if</span>&nbsp;<span class="ident" id="8264480">err</span>&nbsp;<span class="op" id="8264484">!=</span>&nbsp;<span class="ident" id="8264487">nil</span>&nbsp;<span class="op" id="8264491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264496">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264512">if</span>&nbsp;<span class="ident" id="8264515">tt</span><span class="op" id="8264517">.</span><span class="ident" id="8264518">WantWrite</span>&nbsp;<span class="op" id="8264528">!=</span>&nbsp;<span class="string" id="8264531">&#34;&#34;</span>&nbsp;<span class="op" id="8264534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264539">sraw</span>&nbsp;<span class="op" id="8264544">:=</span>&nbsp;<span class="ident" id="8264547">braw</span><span class="op" id="8264551">.</span><span class="ident" id="8264552">String</span><span class="op" id="8264558">(</span><span class="op" id="8264559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264564">if</span>&nbsp;<span class="ident" id="8264567">sraw</span>&nbsp;<span class="op" id="8264572">!=</span>&nbsp;<span class="ident" id="8264575">tt</span><span class="op" id="8264577">.</span><span class="ident" id="8264578">WantWrite</span>&nbsp;<span class="op" id="8264588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264594">t</span><span class="op" id="8264595">.</span><span class="ident" id="8264596">Errorf</span><span class="op" id="8264602">(</span><span class="string" id="8264603">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8264640">,</span>&nbsp;<span class="ident" id="8264642">i</span><span class="op" id="8264643">,</span>&nbsp;<span class="ident" id="8264645">tt</span><span class="op" id="8264647">.</span><span class="ident" id="8264648">WantWrite</span><span class="op" id="8264657">,</span>&nbsp;<span class="ident" id="8264659">sraw</span><span class="op" id="8264663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264669">continue</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264690">if</span>&nbsp;<span class="ident" id="8264693">tt</span><span class="op" id="8264695">.</span><span class="ident" id="8264696">WantProxy</span>&nbsp;<span class="op" id="8264706">!=</span>&nbsp;<span class="string" id="8264709">&#34;&#34;</span>&nbsp;<span class="op" id="8264712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264717">setBody</span><span class="op" id="8264724">(</span><span class="op" id="8264725">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264730">var</span>&nbsp;<span class="ident" id="8264734">praw</span>&nbsp;<span class="ident" id="8264739">bytes</span><span class="op" id="8264744">.</span><span class="ident" id="8264745">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264755">err</span>&nbsp;<span class="op" id="8264759">=</span>&nbsp;<span class="ident" id="8264761">tt</span><span class="op" id="8264763">.</span><span class="ident" id="8264764">Req</span><span class="op" id="8264767">.</span><span class="ident" id="8264768">WriteProxy</span><span class="op" id="8264778">(</span><span class="op" id="8264779">&amp;</span><span class="ident" id="8264780">praw</span><span class="op" id="8264784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264789">if</span>&nbsp;<span class="ident" id="8264792">err</span>&nbsp;<span class="op" id="8264796">!=</span>&nbsp;<span class="ident" id="8264799">nil</span>&nbsp;<span class="op" id="8264803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264809">t</span><span class="op" id="8264810">.</span><span class="ident" id="8264811">Errorf</span><span class="op" id="8264817">(</span><span class="string" id="8264818">&#34;WriteProxy&nbsp;#%d:&nbsp;%s&#34;</span><span class="op" id="8264838">,</span>&nbsp;<span class="ident" id="8264840">i</span><span class="op" id="8264841">,</span>&nbsp;<span class="ident" id="8264843">err</span><span class="op" id="8264846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264852">continue</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8264864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264869">sraw</span>&nbsp;<span class="op" id="8264874">:=</span>&nbsp;<span class="ident" id="8264877">praw</span><span class="op" id="8264881">.</span><span class="ident" id="8264882">String</span><span class="op" id="8264888">(</span><span class="op" id="8264889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8264894">if</span>&nbsp;<span class="ident" id="8264897">sraw</span>&nbsp;<span class="op" id="8264902">!=</span>&nbsp;<span class="ident" id="8264905">tt</span><span class="op" id="8264907">.</span><span class="ident" id="8264908">WantProxy</span>&nbsp;<span class="op" id="8264918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8264924">t</span><span class="op" id="8264925">.</span><span class="ident" id="8264926">Errorf</span><span class="op" id="8264932">(</span><span class="string" id="8264933">&#34;Test&nbsp;Proxy&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="8264976">,</span>&nbsp;<span class="ident" id="8264978">i</span><span class="op" id="8264979">,</span>&nbsp;<span class="ident" id="8264981">tt</span><span class="op" id="8264983">.</span><span class="ident" id="8264984">WantProxy</span><span class="op" id="8264993">,</span>&nbsp;<span class="ident" id="8264995">sraw</span><span class="op" id="8264999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8265005">continue</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8265017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8265021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8265024">}</span><br>
<span class="lineno"></span><span class="op" id="8265026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="8265029">type</span>&nbsp;<span class="ident" id="8265034">closeChecker</span>&nbsp;<span class="keyword" id="8265047">struct</span>&nbsp;<span class="op" id="8265054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265057">io</span><span class="op" id="8265059">.</span><span class="ident" id="8265060">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265068">closed</span>&nbsp;<span class="builtintype" id="8265075">bool</span><br>
<span class="lineno"></span><span class="op" id="8265080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="8265083">func</span>&nbsp;<span class="op" id="8265088">(</span><span class="ident" id="8265089">rc</span>&nbsp;<span class="op" id="8265092">*</span><span class="ident" id="8265093">closeChecker</span><span class="op" id="8265105">)</span>&nbsp;<span class="ident" id="8265107">Close</span><span class="op" id="8265112">(</span><span class="op" id="8265113">)</span>&nbsp;<span class="builtintype" id="8265115">error</span>&nbsp;<span class="op" id="8265121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265124">rc</span><span class="op" id="8265126">.</span><span class="ident" id="8265127">closed</span>&nbsp;<span class="op" id="8265134">=</span>&nbsp;<span class="builtintype" id="8265136">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8265142">return</span>&nbsp;<span class="ident" id="8265149">nil</span><br>
<span class="lineno"></span><span class="op" id="8265153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="comment" id="8265156">//&nbsp;TestRequestWriteClosesBody&nbsp;tests&nbsp;that&nbsp;Request.Write&nbsp;does&nbsp;close&nbsp;its&nbsp;request.Body.</span><br>
<span class="lineno"></span><span class="comment" id="8265240">//&nbsp;It&nbsp;also&nbsp;indirectly&nbsp;tests&nbsp;NewRequest&nbsp;and&nbsp;that&nbsp;it&nbsp;doesn&#39;t&nbsp;wrap&nbsp;an&nbsp;existing&nbsp;Closer</span><br>
<span class="lineno"></span><span class="comment" id="8265323">//&nbsp;inside&nbsp;a&nbsp;NopCloser,&nbsp;and&nbsp;that&nbsp;it&nbsp;serializes&nbsp;it&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="keyword" id="8265383">func</span>&nbsp;<span class="ident" id="8265388">TestRequestWriteClosesBody</span><span class="op" id="8265414">(</span><span class="ident" id="8265415">t</span>&nbsp;<span class="op" id="8265417">*</span><span class="ident" id="8265418">testing</span><span class="op" id="8265425">.</span><span class="ident" id="8265426">T</span><span class="op" id="8265427">)</span>&nbsp;<span class="op" id="8265429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265432">rc</span>&nbsp;<span class="op" id="8265435">:=</span>&nbsp;<span class="op" id="8265438">&amp;</span><span class="ident" id="8265439">closeChecker</span><span class="op" id="8265451">{</span><span class="ident" id="8265452">Reader</span><span class="op" id="8265458">:</span>&nbsp;<span class="ident" id="8265460">strings</span><span class="op" id="8265467">.</span><span class="ident" id="8265468">NewReader</span><span class="op" id="8265477">(</span><span class="string" id="8265478">&#34;my&nbsp;body&#34;</span><span class="op" id="8265487">)</span><span class="op" id="8265488">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265491">req</span><span class="op" id="8265494">,</span>&nbsp;<span class="ident" id="8265496">_</span>&nbsp;<span class="op" id="8265498">:=</span>&nbsp;<span class="ident" id="8265501">NewRequest</span><span class="op" id="8265511">(</span><span class="string" id="8265512">&#34;POST&#34;</span><span class="op" id="8265518">,</span>&nbsp;<span class="string" id="8265520">&#34;http://foo.com/&#34;</span><span class="op" id="8265537">,</span>&nbsp;<span class="ident" id="8265539">rc</span><span class="op" id="8265541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8265544">if</span>&nbsp;<span class="ident" id="8265547">req</span><span class="op" id="8265550">.</span><span class="ident" id="8265551">ContentLength</span>&nbsp;<span class="op" id="8265565">!=</span>&nbsp;<span class="num" id="8265568">0</span>&nbsp;<span class="op" id="8265570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265574">t</span><span class="op" id="8265575">.</span><span class="ident" id="8265576">Errorf</span><span class="op" id="8265582">(</span><span class="string" id="8265583">&#34;got&nbsp;req.ContentLength&nbsp;%d,&nbsp;want&nbsp;0&#34;</span><span class="op" id="8265617">,</span>&nbsp;<span class="ident" id="8265619">req</span><span class="op" id="8265622">.</span><span class="ident" id="8265623">ContentLength</span><span class="op" id="8265636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8265639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265642">buf</span>&nbsp;<span class="op" id="8265646">:=</span>&nbsp;<span class="builtinfunc" id="8265649">new</span><span class="op" id="8265652">(</span><span class="ident" id="8265653">bytes</span><span class="op" id="8265658">.</span><span class="ident" id="8265659">Buffer</span><span class="op" id="8265665">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265668">req</span><span class="op" id="8265671">.</span><span class="ident" id="8265672">Write</span><span class="op" id="8265677">(</span><span class="ident" id="8265678">buf</span><span class="op" id="8265681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8265684">if</span>&nbsp;<span class="op" id="8265687">!</span><span class="ident" id="8265688">rc</span><span class="op" id="8265690">.</span><span class="ident" id="8265691">closed</span>&nbsp;<span class="op" id="8265698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265702">t</span><span class="op" id="8265703">.</span><span class="ident" id="8265704">Error</span><span class="op" id="8265709">(</span><span class="string" id="8265710">&#34;body&nbsp;not&nbsp;closed&nbsp;after&nbsp;write&#34;</span><span class="op" id="8265739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8265742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8265745">expected</span>&nbsp;<span class="op" id="8265754">:=</span>&nbsp;<span class="string" id="8265757">&#34;POST&nbsp;/&nbsp;HTTP/1.1\r\n&#34;</span>&nbsp;<span class="op" id="8265779">+</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265783">&#34;Host:&nbsp;foo.com\r\n&#34;</span>&nbsp;<span class="op" id="8265803">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265807">&#34;User-Agent:&nbsp;Go&nbsp;1.1&nbsp;package&nbsp;http\r\n&#34;</span>&nbsp;<span class="op" id="8265845">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8265849">&#34;Transfer-Encoding:&nbsp;chunked\r\n\r\n&#34;</span>&nbsp;<span class="op" id="8265886">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8265890">//&nbsp;TODO:&nbsp;currently&nbsp;we&nbsp;don&#39;t&nbsp;buffer&nbsp;before&nbsp;chunking,&nbsp;so&nbsp;we&nbsp;get&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8265956">//&nbsp;single&nbsp;&#34;m&#34;&nbsp;chunk&nbsp;before&nbsp;the&nbsp;other&nbsp;chunks,&nbsp;as&nbsp;this&nbsp;was&nbsp;the&nbsp;1-byte</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8266026">//&nbsp;read&nbsp;from&nbsp;our&nbsp;MultiReader&nbsp;where&nbsp;we&nbsp;stiched&nbsp;the&nbsp;Body&nbsp;back&nbsp;together</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8266097">//&nbsp;after&nbsp;sniffing&nbsp;whether&nbsp;the&nbsp;Body&nbsp;was&nbsp;0&nbsp;bytes&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266154">chunk</span><span class="op" id="8266159">(</span><span class="string" id="8266160">&#34;m&#34;</span><span class="op" id="8266163">)</span>&nbsp;<span class="op" id="8266165">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266169">chunk</span><span class="op" id="8266174">(</span><span class="string" id="8266175">&#34;y&nbsp;body&#34;</span><span class="op" id="8266183">)</span>&nbsp;<span class="op" id="8266185">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266189">chunk</span><span class="op" id="8266194">(</span><span class="string" id="8266195">&#34;&#34;</span><span class="op" id="8266197">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266200">if</span>&nbsp;<span class="ident" id="8266203">buf</span><span class="op" id="8266206">.</span><span class="ident" id="8266207">String</span><span class="op" id="8266213">(</span><span class="op" id="8266214">)</span>&nbsp;<span class="op" id="8266216">!=</span>&nbsp;<span class="ident" id="8266219">expected</span>&nbsp;<span class="op" id="8266228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266232">t</span><span class="op" id="8266233">.</span><span class="ident" id="8266234">Errorf</span><span class="op" id="8266240">(</span><span class="string" id="8266241">&#34;write:\n&nbsp;got:&nbsp;%s\nwant:&nbsp;%s&#34;</span><span class="op" id="8266269">,</span>&nbsp;<span class="ident" id="8266271">buf</span><span class="op" id="8266274">.</span><span class="ident" id="8266275">String</span><span class="op" id="8266281">(</span><span class="op" id="8266282">)</span><span class="op" id="8266283">,</span>&nbsp;<span class="ident" id="8266285">expected</span><span class="op" id="8266293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266296">}</span><br>
<span class="lineno"></span><span class="op" id="8266298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="8266301">func</span>&nbsp;<span class="ident" id="8266306">chunk</span><span class="op" id="8266311">(</span><span class="ident" id="8266312">s</span>&nbsp;<span class="builtintype" id="8266314">string</span><span class="op" id="8266320">)</span>&nbsp;<span class="builtintype" id="8266322">string</span>&nbsp;<span class="op" id="8266329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266332">return</span>&nbsp;<span class="ident" id="8266339">fmt</span><span class="op" id="8266342">.</span><span class="ident" id="8266343">Sprintf</span><span class="op" id="8266350">(</span><span class="string" id="8266351">&#34;%x\r\n%s\r\n&#34;</span><span class="op" id="8266365">,</span>&nbsp;<span class="builtinfunc" id="8266367">len</span><span class="op" id="8266370">(</span><span class="ident" id="8266371">s</span><span class="op" id="8266372">)</span><span class="op" id="8266373">,</span>&nbsp;<span class="ident" id="8266375">s</span><span class="op" id="8266376">)</span><br>
<span class="lineno"></span><span class="op" id="8266378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8266381">func</span>&nbsp;<span class="ident" id="8266386">mustParseURL</span><span class="op" id="8266398">(</span><span class="ident" id="8266399">s</span>&nbsp;<span class="builtintype" id="8266401">string</span><span class="op" id="8266407">)</span>&nbsp;<span class="op" id="8266409">*</span><span class="ident" id="8266410">url</span><span class="op" id="8266413">.</span><span class="ident" id="8266414">URL</span>&nbsp;<span class="op" id="8266418">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266421">u</span><span class="op" id="8266422">,</span>&nbsp;<span class="ident" id="8266424">err</span>&nbsp;<span class="op" id="8266428">:=</span>&nbsp;<span class="ident" id="8266431">url</span><span class="op" id="8266434">.</span><span class="ident" id="8266435">Parse</span><span class="op" id="8266440">(</span><span class="ident" id="8266441">s</span><span class="op" id="8266442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266445">if</span>&nbsp;<span class="ident" id="8266448">err</span>&nbsp;<span class="op" id="8266452">!=</span>&nbsp;<span class="ident" id="8266455">nil</span>&nbsp;<span class="op" id="8266459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="8266463">panic</span><span class="op" id="8266468">(</span><span class="ident" id="8266469">fmt</span><span class="op" id="8266472">.</span><span class="ident" id="8266473">Sprintf</span><span class="op" id="8266480">(</span><span class="string" id="8266481">&#34;Error&nbsp;parsing&nbsp;URL&nbsp;%q:&nbsp;%v&#34;</span><span class="op" id="8266507">,</span>&nbsp;<span class="ident" id="8266509">s</span><span class="op" id="8266510">,</span>&nbsp;<span class="ident" id="8266512">err</span><span class="op" id="8266515">)</span><span class="op" id="8266516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8266519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8266522">return</span>&nbsp;<span class="ident" id="8266529">u</span><br>
<span class="lineno">565</span><span class="op" id="8266531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8266534">type</span>&nbsp;<span class="ident" id="8266539">writerFunc</span>&nbsp;<span class="keyword" id="8266550">func</span><span class="op" id="8266554">(</span><span class="op" id="8266555">[</span><span class="op" id="8266556">]</span><span class="builtintype" id="8266557">byte</span><span class="op" id="8266561">)</span>&nbsp;<span class="op" id="8266563">(</span><span class="builtintype" id="8266564">int</span><span class="op" id="8266567">,</span>&nbsp;<span class="builtintype" id="8266569">error</span><span class="op" id="8266574">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8266577">func</span>&nbsp;<span class="op" id="8266582">(</span><span class="ident" id="8266583">f</span>&nbsp;<span class="ident" id="8266585">writerFunc</span><span class="op" id="8266595">)</span>&nbsp;<span class="ident" id="8266597">Write</span><span class="op" id="8266602">(</span><span class="ident" id="8266603">p</span>&nbsp;<span class="op" id="8266605">[</span><span class="op" id="8266606">]</span><span class="builtintype" id="8266607">byte</span><span class="op" id="8266611">)</span>&nbsp;<span class="op" id="8266613">(</span><span class="builtintype" id="8266614">int</span><span class="op" id="8266617">,</span>&nbsp;<span class="builtintype" id="8266619">error</span><span class="op" id="8266624">)</span>&nbsp;<span class="op" id="8266626">{</span>&nbsp;<span class="keyword" id="8266628">return</span>&nbsp;<span class="ident" id="8266635">f</span><span class="op" id="8266636">(</span><span class="ident" id="8266637">p</span><span class="op" id="8266638">)</span>&nbsp;<span class="op" id="8266640">}</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span><span class="comment" id="8266643">//&nbsp;TestRequestWriteError&nbsp;tests&nbsp;the&nbsp;Write&nbsp;err&nbsp;!=&nbsp;nil&nbsp;checks&nbsp;in&nbsp;(*Request).write.</span><br>
<span class="lineno"></span><span class="keyword" id="8266723">func</span>&nbsp;<span class="ident" id="8266728">TestRequestWriteError</span><span class="op" id="8266749">(</span><span class="ident" id="8266750">t</span>&nbsp;<span class="op" id="8266752">*</span><span class="ident" id="8266753">testing</span><span class="op" id="8266760">.</span><span class="ident" id="8266761">T</span><span class="op" id="8266762">)</span>&nbsp;<span class="op" id="8266764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266767">failAfter</span><span class="op" id="8266776">,</span>&nbsp;<span class="ident" id="8266778">writeCount</span>&nbsp;<span class="op" id="8266789">:=</span>&nbsp;<span class="num" id="8266792">0</span><span class="op" id="8266793">,</span>&nbsp;<span class="num" id="8266795">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8266798">errFail</span>&nbsp;<span class="op" id="8266806">:=</span>&nbsp;<span class="ident" id="8266809">errors</span><span class="op" id="8266815">.</span><span class="ident" id="8266816">New</span><span class="op" id="8266819">(</span><span class="string" id="8266820">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="8266840">)</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8266844">//&nbsp;w&nbsp;is&nbsp;the&nbsp;buffered&nbsp;io.Writer&nbsp;to&nbsp;write&nbsp;the&nbsp;request&nbsp;to.&nbsp;&nbsp;It</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8266905">//&nbsp;fails&nbsp;exactly&nbsp;once&nbsp;on&nbsp;its&nbsp;Nth&nbsp;Write&nbsp;call,&nbsp;as&nbsp;controlled&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8266968">//&nbsp;failAfter.&nbsp;It&nbsp;also&nbsp;tracks&nbsp;the&nbsp;number&nbsp;of&nbsp;calls&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8267021">//&nbsp;writeCount.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267037">w</span>&nbsp;<span class="op" id="8267039">:=</span>&nbsp;<span class="keyword" id="8267042">struct</span>&nbsp;<span class="op" id="8267049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267053">io</span><span class="op" id="8267055">.</span><span class="ident" id="8267056">ByteWriter</span>&nbsp;<span class="comment" id="8267067">//&nbsp;to&nbsp;avoid&nbsp;being&nbsp;wrapped&nbsp;by&nbsp;a&nbsp;bufio.Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267113">io</span><span class="op" id="8267115">.</span><span class="ident" id="8267116">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267124">}</span><span class="op" id="8267125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267129">nil</span><span class="op" id="8267132">,</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267136">writerFunc</span><span class="op" id="8267146">(</span><span class="keyword" id="8267147">func</span><span class="op" id="8267151">(</span><span class="ident" id="8267152">p</span>&nbsp;<span class="op" id="8267154">[</span><span class="op" id="8267155">]</span><span class="builtintype" id="8267156">byte</span><span class="op" id="8267160">)</span>&nbsp;<span class="op" id="8267162">(</span><span class="ident" id="8267163">n</span>&nbsp;<span class="builtintype" id="8267165">int</span><span class="op" id="8267168">,</span>&nbsp;<span class="ident" id="8267170">err</span>&nbsp;<span class="builtintype" id="8267174">error</span><span class="op" id="8267179">)</span>&nbsp;<span class="op" id="8267181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267186">writeCount</span><span class="op" id="8267196">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267202">if</span>&nbsp;<span class="ident" id="8267205">failAfter</span>&nbsp;<span class="op" id="8267215">==</span>&nbsp;<span class="num" id="8267218">0</span>&nbsp;<span class="op" id="8267220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267226">err</span>&nbsp;<span class="op" id="8267230">=</span>&nbsp;<span class="ident" id="8267232">errFail</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267243">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267248">failAfter</span><span class="op" id="8267257">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267263">return</span>&nbsp;<span class="builtinfunc" id="8267270">len</span><span class="op" id="8267273">(</span><span class="ident" id="8267274">p</span><span class="op" id="8267275">)</span><span class="op" id="8267276">,</span>&nbsp;<span class="ident" id="8267278">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267284">}</span><span class="op" id="8267285">)</span><span class="op" id="8267286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267293">req</span><span class="op" id="8267296">,</span>&nbsp;<span class="ident" id="8267298">_</span>&nbsp;<span class="op" id="8267300">:=</span>&nbsp;<span class="ident" id="8267303">NewRequest</span><span class="op" id="8267313">(</span><span class="string" id="8267314">&#34;GET&#34;</span><span class="op" id="8267319">,</span>&nbsp;<span class="string" id="8267321">&#34;http://example.com/&#34;</span><span class="op" id="8267342">,</span>&nbsp;<span class="ident" id="8267344">nil</span><span class="op" id="8267347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267350">const</span>&nbsp;<span class="ident" id="8267356">writeCalls</span>&nbsp;<span class="op" id="8267367">=</span>&nbsp;<span class="num" id="8267369">4</span>&nbsp;<span class="comment" id="8267371">//&nbsp;number&nbsp;of&nbsp;Write&nbsp;calls&nbsp;in&nbsp;current&nbsp;implementation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267423">sawGood</span>&nbsp;<span class="op" id="8267431">:=</span>&nbsp;<span class="builtintype" id="8267434">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267441">for</span>&nbsp;<span class="ident" id="8267445">n</span>&nbsp;<span class="op" id="8267447">:=</span>&nbsp;<span class="num" id="8267450">0</span><span class="op" id="8267451">;</span>&nbsp;<span class="ident" id="8267453">n</span>&nbsp;<span class="op" id="8267455">&lt;=</span>&nbsp;<span class="ident" id="8267458">writeCalls</span><span class="op" id="8267468">+</span><span class="num" id="8267469">2</span><span class="op" id="8267470">;</span>&nbsp;<span class="ident" id="8267472">n</span><span class="op" id="8267473">++</span>&nbsp;<span class="op" id="8267476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267480">failAfter</span>&nbsp;<span class="op" id="8267490">=</span>&nbsp;<span class="ident" id="8267492">n</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267496">writeCount</span>&nbsp;<span class="op" id="8267507">=</span>&nbsp;<span class="num" id="8267509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267513">err</span>&nbsp;<span class="op" id="8267517">:=</span>&nbsp;<span class="ident" id="8267520">req</span><span class="op" id="8267523">.</span><span class="ident" id="8267524">Write</span><span class="op" id="8267529">(</span><span class="ident" id="8267530">w</span><span class="op" id="8267531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267535">var</span>&nbsp;<span class="ident" id="8267539">wantErr</span>&nbsp;<span class="builtintype" id="8267547">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267555">if</span>&nbsp;<span class="ident" id="8267558">n</span>&nbsp;<span class="op" id="8267560">&lt;</span>&nbsp;<span class="ident" id="8267562">writeCalls</span>&nbsp;<span class="op" id="8267573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267578">wantErr</span>&nbsp;<span class="op" id="8267586">=</span>&nbsp;<span class="ident" id="8267588">errFail</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267602">if</span>&nbsp;<span class="ident" id="8267605">err</span>&nbsp;<span class="op" id="8267609">!=</span>&nbsp;<span class="ident" id="8267612">wantErr</span>&nbsp;<span class="op" id="8267620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267625">t</span><span class="op" id="8267626">.</span><span class="ident" id="8267627">Errorf</span><span class="op" id="8267633">(</span><span class="string" id="8267634">&#34;for&nbsp;fail-after&nbsp;%d&nbsp;Writes,&nbsp;err&nbsp;=&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="8267679">,</span>&nbsp;<span class="ident" id="8267681">n</span><span class="op" id="8267682">,</span>&nbsp;<span class="ident" id="8267684">err</span><span class="op" id="8267687">,</span>&nbsp;<span class="ident" id="8267689">wantErr</span><span class="op" id="8267696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267701">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267712">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267716">if</span>&nbsp;<span class="ident" id="8267719">err</span>&nbsp;<span class="op" id="8267723">==</span>&nbsp;<span class="ident" id="8267726">nil</span>&nbsp;<span class="op" id="8267730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267735">sawGood</span>&nbsp;<span class="op" id="8267743">=</span>&nbsp;<span class="builtintype" id="8267745">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267753">if</span>&nbsp;<span class="ident" id="8267756">writeCount</span>&nbsp;<span class="op" id="8267767">!=</span>&nbsp;<span class="ident" id="8267770">writeCalls</span>&nbsp;<span class="op" id="8267781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267787">t</span><span class="op" id="8267788">.</span><span class="ident" id="8267789">Fatalf</span><span class="op" id="8267795">(</span><span class="string" id="8267796">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8267837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267842">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267850">if</span>&nbsp;<span class="ident" id="8267853">writeCount</span>&nbsp;<span class="op" id="8267864">&gt;</span>&nbsp;<span class="ident" id="8267866">writeCalls</span>&nbsp;<span class="op" id="8267877">||</span>&nbsp;<span class="ident" id="8267880">writeCount</span>&nbsp;<span class="op" id="8267891">&gt;</span>&nbsp;<span class="ident" id="8267893">n</span><span class="op" id="8267894">+</span><span class="num" id="8267895">1</span>&nbsp;<span class="op" id="8267897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8267902">t</span><span class="op" id="8267903">.</span><span class="ident" id="8267904">Errorf</span><span class="op" id="8267910">(</span><span class="string" id="8267911">&#34;for&nbsp;fail-after&nbsp;%d,&nbsp;saw&nbsp;unexpectedly&nbsp;high&nbsp;(%d)&nbsp;write&nbsp;calls&#34;</span><span class="op" id="8267970">,</span>&nbsp;<span class="ident" id="8267972">n</span><span class="op" id="8267973">,</span>&nbsp;<span class="ident" id="8267975">writeCount</span><span class="op" id="8267985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8267992">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8267995">if</span>&nbsp;<span class="op" id="8267998">!</span><span class="ident" id="8267999">sawGood</span>&nbsp;<span class="op" id="8268007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8268011">t</span><span class="op" id="8268012">.</span><span class="ident" id="8268013">Fatalf</span><span class="op" id="8268019">(</span><span class="string" id="8268020">&#34;writeCalls&nbsp;constant&nbsp;is&nbsp;outdated&nbsp;in&nbsp;test&#34;</span><span class="op" id="8268061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8268064">}</span><br>
<span class="lineno"></span><span class="op" id="8268066">}</span>
</div>
</body>
</html>
