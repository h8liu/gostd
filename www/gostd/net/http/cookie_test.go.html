<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7289377">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7289433">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7289487">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7289538">package</span>&nbsp;<span class="ident" id="7289546">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7289552">import</span>&nbsp;<span class="op" id="7289559">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289562">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289571">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289588">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289595">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289602">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289608">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289619">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289630">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289641">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7289648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7289651">var</span>&nbsp;<span class="ident" id="7289655">writeSetCookiesTests</span>&nbsp;<span class="op" id="7289676">=</span>&nbsp;<span class="op" id="7289678">[</span><span class="op" id="7289679">]</span><span class="keyword" id="7289680">struct</span>&nbsp;<span class="op" id="7289687">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289690">Cookie</span>&nbsp;<span class="op" id="7289697">*</span><span class="ident" id="7289698">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7289706">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7289713">string</span><br>
<span class="lineno"></span><span class="op" id="7289720">}</span><span class="op" id="7289721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289728">&amp;</span><span class="ident" id="7289729">Cookie</span><span class="op" id="7289735">{</span><span class="ident" id="7289736">Name</span><span class="op" id="7289740">:</span>&nbsp;<span class="string" id="7289742">&#34;cookie-1&#34;</span><span class="op" id="7289752">,</span>&nbsp;<span class="ident" id="7289754">Value</span><span class="op" id="7289759">:</span>&nbsp;<span class="string" id="7289761">&#34;v$1&#34;</span><span class="op" id="7289766">}</span><span class="op" id="7289767">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289771">&#34;cookie-1=v$1&#34;</span><span class="op" id="7289785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289788">}</span><span class="op" id="7289789">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289796">&amp;</span><span class="ident" id="7289797">Cookie</span><span class="op" id="7289803">{</span><span class="ident" id="7289804">Name</span><span class="op" id="7289808">:</span>&nbsp;<span class="string" id="7289810">&#34;cookie-2&#34;</span><span class="op" id="7289820">,</span>&nbsp;<span class="ident" id="7289822">Value</span><span class="op" id="7289827">:</span>&nbsp;<span class="string" id="7289829">&#34;two&#34;</span><span class="op" id="7289834">,</span>&nbsp;<span class="ident" id="7289836">MaxAge</span><span class="op" id="7289842">:</span>&nbsp;<span class="num" id="7289844">3600</span><span class="op" id="7289848">}</span><span class="op" id="7289849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289853">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7289881">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289884">}</span><span class="op" id="7289885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7289892">&amp;</span><span class="ident" id="7289893">Cookie</span><span class="op" id="7289899">{</span><span class="ident" id="7289900">Name</span><span class="op" id="7289904">:</span>&nbsp;<span class="string" id="7289906">&#34;cookie-3&#34;</span><span class="op" id="7289916">,</span>&nbsp;<span class="ident" id="7289918">Value</span><span class="op" id="7289923">:</span>&nbsp;<span class="string" id="7289925">&#34;three&#34;</span><span class="op" id="7289932">,</span>&nbsp;<span class="ident" id="7289934">Domain</span><span class="op" id="7289940">:</span>&nbsp;<span class="string" id="7289942">&#34;.example.com&#34;</span><span class="op" id="7289956">}</span><span class="op" id="7289957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7289961">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7289997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290000">}</span><span class="op" id="7290001">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290008">&amp;</span><span class="ident" id="7290009">Cookie</span><span class="op" id="7290015">{</span><span class="ident" id="7290016">Name</span><span class="op" id="7290020">:</span>&nbsp;<span class="string" id="7290022">&#34;cookie-4&#34;</span><span class="op" id="7290032">,</span>&nbsp;<span class="ident" id="7290034">Value</span><span class="op" id="7290039">:</span>&nbsp;<span class="string" id="7290041">&#34;four&#34;</span><span class="op" id="7290047">,</span>&nbsp;<span class="ident" id="7290049">Path</span><span class="op" id="7290053">:</span>&nbsp;<span class="string" id="7290055">&#34;/restricted/&#34;</span><span class="op" id="7290069">}</span><span class="op" id="7290070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290074">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7290108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290111">}</span><span class="op" id="7290112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290115">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290119">&amp;</span><span class="ident" id="7290120">Cookie</span><span class="op" id="7290126">{</span><span class="ident" id="7290127">Name</span><span class="op" id="7290131">:</span>&nbsp;<span class="string" id="7290133">&#34;cookie-5&#34;</span><span class="op" id="7290143">,</span>&nbsp;<span class="ident" id="7290145">Value</span><span class="op" id="7290150">:</span>&nbsp;<span class="string" id="7290152">&#34;five&#34;</span><span class="op" id="7290158">,</span>&nbsp;<span class="ident" id="7290160">Domain</span><span class="op" id="7290166">:</span>&nbsp;<span class="string" id="7290168">&#34;wrong;bad.abc&#34;</span><span class="op" id="7290183">}</span><span class="op" id="7290184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290188">&#34;cookie-5=five&#34;</span><span class="op" id="7290203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290206">}</span><span class="op" id="7290207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290214">&amp;</span><span class="ident" id="7290215">Cookie</span><span class="op" id="7290221">{</span><span class="ident" id="7290222">Name</span><span class="op" id="7290226">:</span>&nbsp;<span class="string" id="7290228">&#34;cookie-6&#34;</span><span class="op" id="7290238">,</span>&nbsp;<span class="ident" id="7290240">Value</span><span class="op" id="7290245">:</span>&nbsp;<span class="string" id="7290247">&#34;six&#34;</span><span class="op" id="7290252">,</span>&nbsp;<span class="ident" id="7290254">Domain</span><span class="op" id="7290260">:</span>&nbsp;<span class="string" id="7290262">&#34;bad-.abc&#34;</span><span class="op" id="7290272">}</span><span class="op" id="7290273">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290277">&#34;cookie-6=six&#34;</span><span class="op" id="7290291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290294">}</span><span class="op" id="7290295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290302">&amp;</span><span class="ident" id="7290303">Cookie</span><span class="op" id="7290309">{</span><span class="ident" id="7290310">Name</span><span class="op" id="7290314">:</span>&nbsp;<span class="string" id="7290316">&#34;cookie-7&#34;</span><span class="op" id="7290326">,</span>&nbsp;<span class="ident" id="7290328">Value</span><span class="op" id="7290333">:</span>&nbsp;<span class="string" id="7290335">&#34;seven&#34;</span><span class="op" id="7290342">,</span>&nbsp;<span class="ident" id="7290344">Domain</span><span class="op" id="7290350">:</span>&nbsp;<span class="string" id="7290352">&#34;127.0.0.1&#34;</span><span class="op" id="7290363">}</span><span class="op" id="7290364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290368">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7290402">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290405">}</span><span class="op" id="7290406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290413">&amp;</span><span class="ident" id="7290414">Cookie</span><span class="op" id="7290420">{</span><span class="ident" id="7290421">Name</span><span class="op" id="7290425">:</span>&nbsp;<span class="string" id="7290427">&#34;cookie-8&#34;</span><span class="op" id="7290437">,</span>&nbsp;<span class="ident" id="7290439">Value</span><span class="op" id="7290444">:</span>&nbsp;<span class="string" id="7290446">&#34;eight&#34;</span><span class="op" id="7290453">,</span>&nbsp;<span class="ident" id="7290455">Domain</span><span class="op" id="7290461">:</span>&nbsp;<span class="string" id="7290463">&#34;::1&#34;</span><span class="op" id="7290468">}</span><span class="op" id="7290469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290473">&#34;cookie-8=eight&#34;</span><span class="op" id="7290489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290492">}</span><span class="op" id="7290493">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7290496">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7290568">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290631">&amp;</span><span class="ident" id="7290632">Cookie</span><span class="op" id="7290638">{</span><span class="ident" id="7290639">Name</span><span class="op" id="7290643">:</span>&nbsp;<span class="string" id="7290645">&#34;special-1&#34;</span><span class="op" id="7290656">,</span>&nbsp;<span class="ident" id="7290658">Value</span><span class="op" id="7290663">:</span>&nbsp;<span class="string" id="7290665">&#34;a&nbsp;z&#34;</span><span class="op" id="7290670">}</span><span class="op" id="7290671">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290675">`special-1=a&nbsp;z`</span><span class="op" id="7290690">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290693">}</span><span class="op" id="7290694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290701">&amp;</span><span class="ident" id="7290702">Cookie</span><span class="op" id="7290708">{</span><span class="ident" id="7290709">Name</span><span class="op" id="7290713">:</span>&nbsp;<span class="string" id="7290715">&#34;special-2&#34;</span><span class="op" id="7290726">,</span>&nbsp;<span class="ident" id="7290728">Value</span><span class="op" id="7290733">:</span>&nbsp;<span class="string" id="7290735">&#34;&nbsp;z&#34;</span><span class="op" id="7290739">}</span><span class="op" id="7290740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290744">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7290760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290763">}</span><span class="op" id="7290764">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290771">&amp;</span><span class="ident" id="7290772">Cookie</span><span class="op" id="7290778">{</span><span class="ident" id="7290779">Name</span><span class="op" id="7290783">:</span>&nbsp;<span class="string" id="7290785">&#34;special-3&#34;</span><span class="op" id="7290796">,</span>&nbsp;<span class="ident" id="7290798">Value</span><span class="op" id="7290803">:</span>&nbsp;<span class="string" id="7290805">&#34;a&nbsp;&#34;</span><span class="op" id="7290809">}</span><span class="op" id="7290810">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290814">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7290830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290833">}</span><span class="op" id="7290834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290837">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290841">&amp;</span><span class="ident" id="7290842">Cookie</span><span class="op" id="7290848">{</span><span class="ident" id="7290849">Name</span><span class="op" id="7290853">:</span>&nbsp;<span class="string" id="7290855">&#34;special-4&#34;</span><span class="op" id="7290866">,</span>&nbsp;<span class="ident" id="7290868">Value</span><span class="op" id="7290873">:</span>&nbsp;<span class="string" id="7290875">&#34;&nbsp;&#34;</span><span class="op" id="7290878">}</span><span class="op" id="7290879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290883">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7290898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290901">}</span><span class="op" id="7290902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290909">&amp;</span><span class="ident" id="7290910">Cookie</span><span class="op" id="7290916">{</span><span class="ident" id="7290917">Name</span><span class="op" id="7290921">:</span>&nbsp;<span class="string" id="7290923">&#34;special-5&#34;</span><span class="op" id="7290934">,</span>&nbsp;<span class="ident" id="7290936">Value</span><span class="op" id="7290941">:</span>&nbsp;<span class="string" id="7290943">&#34;a,z&#34;</span><span class="op" id="7290948">}</span><span class="op" id="7290949">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7290953">`special-5=a,z`</span><span class="op" id="7290968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290971">}</span><span class="op" id="7290972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7290979">&amp;</span><span class="ident" id="7290980">Cookie</span><span class="op" id="7290986">{</span><span class="ident" id="7290987">Name</span><span class="op" id="7290991">:</span>&nbsp;<span class="string" id="7290993">&#34;special-6&#34;</span><span class="op" id="7291004">,</span>&nbsp;<span class="ident" id="7291006">Value</span><span class="op" id="7291011">:</span>&nbsp;<span class="string" id="7291013">&#34;,z&#34;</span><span class="op" id="7291017">}</span><span class="op" id="7291018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291022">`special-6=&#34;,z&#34;`</span><span class="op" id="7291038">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291041">}</span><span class="op" id="7291042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291049">&amp;</span><span class="ident" id="7291050">Cookie</span><span class="op" id="7291056">{</span><span class="ident" id="7291057">Name</span><span class="op" id="7291061">:</span>&nbsp;<span class="string" id="7291063">&#34;special-7&#34;</span><span class="op" id="7291074">,</span>&nbsp;<span class="ident" id="7291076">Value</span><span class="op" id="7291081">:</span>&nbsp;<span class="string" id="7291083">&#34;a,&#34;</span><span class="op" id="7291087">}</span><span class="op" id="7291088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291092">`special-7=&#34;a,&#34;`</span><span class="op" id="7291108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291111">}</span><span class="op" id="7291112">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291119">&amp;</span><span class="ident" id="7291120">Cookie</span><span class="op" id="7291126">{</span><span class="ident" id="7291127">Name</span><span class="op" id="7291131">:</span>&nbsp;<span class="string" id="7291133">&#34;special-8&#34;</span><span class="op" id="7291144">,</span>&nbsp;<span class="ident" id="7291146">Value</span><span class="op" id="7291151">:</span>&nbsp;<span class="string" id="7291153">&#34;,&#34;</span><span class="op" id="7291156">}</span><span class="op" id="7291157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291161">`special-8=&#34;,&#34;`</span><span class="op" id="7291176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291179">}</span><span class="op" id="7291180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291183">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291187">&amp;</span><span class="ident" id="7291188">Cookie</span><span class="op" id="7291194">{</span><span class="ident" id="7291195">Name</span><span class="op" id="7291199">:</span>&nbsp;<span class="string" id="7291201">&#34;empty-value&#34;</span><span class="op" id="7291214">,</span>&nbsp;<span class="ident" id="7291216">Value</span><span class="op" id="7291221">:</span>&nbsp;<span class="string" id="7291223">&#34;&#34;</span><span class="op" id="7291225">}</span><span class="op" id="7291226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7291230">`empty-value=`</span><span class="op" id="7291244">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291247">}</span><span class="op" id="7291248">,</span><br>
<span class="lineno"></span><span class="op" id="7291250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7291253">func</span>&nbsp;<span class="ident" id="7291258">TestWriteSetCookies</span><span class="op" id="7291277">(</span><span class="ident" id="7291278">t</span>&nbsp;<span class="op" id="7291280">*</span><span class="ident" id="7291281">testing</span><span class="op" id="7291288">.</span><span class="ident" id="7291289">T</span><span class="op" id="7291290">)</span>&nbsp;<span class="op" id="7291292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291295">defer</span>&nbsp;<span class="ident" id="7291301">log</span><span class="op" id="7291304">.</span><span class="ident" id="7291305">SetOutput</span><span class="op" id="7291314">(</span><span class="ident" id="7291315">os</span><span class="op" id="7291317">.</span><span class="ident" id="7291318">Stderr</span><span class="op" id="7291324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291327">var</span>&nbsp;<span class="ident" id="7291331">logbuf</span>&nbsp;<span class="ident" id="7291338">bytes</span><span class="op" id="7291343">.</span><span class="ident" id="7291344">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291352">log</span><span class="op" id="7291355">.</span><span class="ident" id="7291356">SetOutput</span><span class="op" id="7291365">(</span><span class="op" id="7291366">&amp;</span><span class="ident" id="7291367">logbuf</span><span class="op" id="7291373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291377">for</span>&nbsp;<span class="ident" id="7291381">i</span><span class="op" id="7291382">,</span>&nbsp;<span class="ident" id="7291384">tt</span>&nbsp;<span class="op" id="7291387">:=</span>&nbsp;<span class="keyword" id="7291390">range</span>&nbsp;<span class="ident" id="7291396">writeSetCookiesTests</span>&nbsp;<span class="op" id="7291417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291421">if</span>&nbsp;<span class="ident" id="7291424">g</span><span class="op" id="7291425">,</span>&nbsp;<span class="ident" id="7291427">e</span>&nbsp;<span class="op" id="7291429">:=</span>&nbsp;<span class="ident" id="7291432">tt</span><span class="op" id="7291434">.</span><span class="ident" id="7291435">Cookie</span><span class="op" id="7291441">.</span><span class="ident" id="7291442">String</span><span class="op" id="7291448">(</span><span class="op" id="7291449">)</span><span class="op" id="7291450">,</span>&nbsp;<span class="ident" id="7291452">tt</span><span class="op" id="7291454">.</span><span class="ident" id="7291455">Raw</span><span class="op" id="7291458">;</span>&nbsp;<span class="ident" id="7291460">g</span>&nbsp;<span class="op" id="7291462">!=</span>&nbsp;<span class="ident" id="7291465">e</span>&nbsp;<span class="op" id="7291467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291472">t</span><span class="op" id="7291473">.</span><span class="ident" id="7291474">Errorf</span><span class="op" id="7291480">(</span><span class="string" id="7291481">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7291518">,</span>&nbsp;<span class="ident" id="7291520">i</span><span class="op" id="7291521">,</span>&nbsp;<span class="ident" id="7291523">e</span><span class="op" id="7291524">,</span>&nbsp;<span class="ident" id="7291526">g</span><span class="op" id="7291527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291532">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291543">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291550">if</span>&nbsp;<span class="ident" id="7291553">got</span><span class="op" id="7291556">,</span>&nbsp;<span class="ident" id="7291558">sub</span>&nbsp;<span class="op" id="7291562">:=</span>&nbsp;<span class="ident" id="7291565">logbuf</span><span class="op" id="7291571">.</span><span class="ident" id="7291572">String</span><span class="op" id="7291578">(</span><span class="op" id="7291579">)</span><span class="op" id="7291580">,</span>&nbsp;<span class="string" id="7291582">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7291609">;</span>&nbsp;<span class="op" id="7291611">!</span><span class="ident" id="7291612">strings</span><span class="op" id="7291619">.</span><span class="ident" id="7291620">Contains</span><span class="op" id="7291628">(</span><span class="ident" id="7291629">got</span><span class="op" id="7291632">,</span>&nbsp;<span class="ident" id="7291634">sub</span><span class="op" id="7291637">)</span>&nbsp;<span class="op" id="7291639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7291643">t</span><span class="op" id="7291644">.</span><span class="ident" id="7291645">Errorf</span><span class="op" id="7291651">(</span><span class="string" id="7291652">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7291699">,</span>&nbsp;<span class="ident" id="7291701">sub</span><span class="op" id="7291704">,</span>&nbsp;<span class="ident" id="7291706">got</span><span class="op" id="7291709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7291712">}</span><br>
<span class="lineno">110</span><span class="op" id="7291714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7291717">type</span>&nbsp;<span class="ident" id="7291722">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7291747">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7291755">func</span>&nbsp;<span class="op" id="7291760">(</span><span class="ident" id="7291761">ho</span>&nbsp;<span class="ident" id="7291764">headerOnlyResponseWriter</span><span class="op" id="7291788">)</span>&nbsp;<span class="ident" id="7291790">Header</span><span class="op" id="7291796">(</span><span class="op" id="7291797">)</span>&nbsp;<span class="ident" id="7291799">Header</span>&nbsp;<span class="op" id="7291806">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7291809">return</span>&nbsp;<span class="ident" id="7291816">Header</span><span class="op" id="7291822">(</span><span class="ident" id="7291823">ho</span><span class="op" id="7291825">)</span><br>
<span class="lineno"></span><span class="op" id="7291827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7291830">func</span>&nbsp;<span class="op" id="7291835">(</span><span class="ident" id="7291836">ho</span>&nbsp;<span class="ident" id="7291839">headerOnlyResponseWriter</span><span class="op" id="7291863">)</span>&nbsp;<span class="ident" id="7291865">Write</span><span class="op" id="7291870">(</span><span class="op" id="7291871">[</span><span class="op" id="7291872">]</span><span class="builtintype" id="7291873">byte</span><span class="op" id="7291877">)</span>&nbsp;<span class="op" id="7291879">(</span><span class="builtintype" id="7291880">int</span><span class="op" id="7291883">,</span>&nbsp;<span class="builtintype" id="7291885">error</span><span class="op" id="7291890">)</span>&nbsp;<span class="op" id="7291892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7291895">panic</span><span class="op" id="7291900">(</span><span class="string" id="7291901">&#34;NOIMPL&#34;</span><span class="op" id="7291909">)</span><br>
<span class="lineno">120</span><span class="op" id="7291911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7291914">func</span>&nbsp;<span class="op" id="7291919">(</span><span class="ident" id="7291920">ho</span>&nbsp;<span class="ident" id="7291923">headerOnlyResponseWriter</span><span class="op" id="7291947">)</span>&nbsp;<span class="ident" id="7291949">WriteHeader</span><span class="op" id="7291960">(</span><span class="builtintype" id="7291961">int</span><span class="op" id="7291964">)</span>&nbsp;<span class="op" id="7291966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7291969">panic</span><span class="op" id="7291974">(</span><span class="string" id="7291975">&#34;NOIMPL&#34;</span><span class="op" id="7291983">)</span><br>
<span class="lineno"></span><span class="op" id="7291985">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7291988">func</span>&nbsp;<span class="ident" id="7291993">TestSetCookie</span><span class="op" id="7292006">(</span><span class="ident" id="7292007">t</span>&nbsp;<span class="op" id="7292009">*</span><span class="ident" id="7292010">testing</span><span class="op" id="7292017">.</span><span class="ident" id="7292018">T</span><span class="op" id="7292019">)</span>&nbsp;<span class="op" id="7292021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292024">m</span>&nbsp;<span class="op" id="7292026">:=</span>&nbsp;<span class="builtinfunc" id="7292029">make</span><span class="op" id="7292033">(</span><span class="ident" id="7292034">Header</span><span class="op" id="7292040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292043">SetCookie</span><span class="op" id="7292052">(</span><span class="ident" id="7292053">headerOnlyResponseWriter</span><span class="op" id="7292077">(</span><span class="ident" id="7292078">m</span><span class="op" id="7292079">)</span><span class="op" id="7292080">,</span>&nbsp;<span class="op" id="7292082">&amp;</span><span class="ident" id="7292083">Cookie</span><span class="op" id="7292089">{</span><span class="ident" id="7292090">Name</span><span class="op" id="7292094">:</span>&nbsp;<span class="string" id="7292096">&#34;cookie-1&#34;</span><span class="op" id="7292106">,</span>&nbsp;<span class="ident" id="7292108">Value</span><span class="op" id="7292113">:</span>&nbsp;<span class="string" id="7292115">&#34;one&#34;</span><span class="op" id="7292120">,</span>&nbsp;<span class="ident" id="7292122">Path</span><span class="op" id="7292126">:</span>&nbsp;<span class="string" id="7292128">&#34;/restricted/&#34;</span><span class="op" id="7292142">}</span><span class="op" id="7292143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292146">SetCookie</span><span class="op" id="7292155">(</span><span class="ident" id="7292156">headerOnlyResponseWriter</span><span class="op" id="7292180">(</span><span class="ident" id="7292181">m</span><span class="op" id="7292182">)</span><span class="op" id="7292183">,</span>&nbsp;<span class="op" id="7292185">&amp;</span><span class="ident" id="7292186">Cookie</span><span class="op" id="7292192">{</span><span class="ident" id="7292193">Name</span><span class="op" id="7292197">:</span>&nbsp;<span class="string" id="7292199">&#34;cookie-2&#34;</span><span class="op" id="7292209">,</span>&nbsp;<span class="ident" id="7292211">Value</span><span class="op" id="7292216">:</span>&nbsp;<span class="string" id="7292218">&#34;two&#34;</span><span class="op" id="7292223">,</span>&nbsp;<span class="ident" id="7292225">MaxAge</span><span class="op" id="7292231">:</span>&nbsp;<span class="num" id="7292233">3600</span><span class="op" id="7292237">}</span><span class="op" id="7292238">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292241">if</span>&nbsp;<span class="ident" id="7292244">l</span>&nbsp;<span class="op" id="7292246">:=</span>&nbsp;<span class="builtinfunc" id="7292249">len</span><span class="op" id="7292252">(</span><span class="ident" id="7292253">m</span><span class="op" id="7292254">[</span><span class="string" id="7292255">&#34;Set-Cookie&#34;</span><span class="op" id="7292267">]</span><span class="op" id="7292268">)</span><span class="op" id="7292269">;</span>&nbsp;<span class="ident" id="7292271">l</span>&nbsp;<span class="op" id="7292273">!=</span>&nbsp;<span class="num" id="7292276">2</span>&nbsp;<span class="op" id="7292278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292282">t</span><span class="op" id="7292283">.</span><span class="ident" id="7292284">Fatalf</span><span class="op" id="7292290">(</span><span class="string" id="7292291">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7292320">,</span>&nbsp;<span class="num" id="7292322">2</span><span class="op" id="7292323">,</span>&nbsp;<span class="ident" id="7292325">l</span><span class="op" id="7292326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292332">if</span>&nbsp;<span class="ident" id="7292335">g</span><span class="op" id="7292336">,</span>&nbsp;<span class="ident" id="7292338">e</span>&nbsp;<span class="op" id="7292340">:=</span>&nbsp;<span class="ident" id="7292343">m</span><span class="op" id="7292344">[</span><span class="string" id="7292345">&#34;Set-Cookie&#34;</span><span class="op" id="7292357">]</span><span class="op" id="7292358">[</span><span class="num" id="7292359">0</span><span class="op" id="7292360">]</span><span class="op" id="7292361">,</span>&nbsp;<span class="string" id="7292363">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7292396">;</span>&nbsp;<span class="ident" id="7292398">g</span>&nbsp;<span class="op" id="7292400">!=</span>&nbsp;<span class="ident" id="7292403">e</span>&nbsp;<span class="op" id="7292405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292409">t</span><span class="op" id="7292410">.</span><span class="ident" id="7292411">Errorf</span><span class="op" id="7292417">(</span><span class="string" id="7292418">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7292446">,</span>&nbsp;<span class="ident" id="7292448">e</span><span class="op" id="7292449">,</span>&nbsp;<span class="ident" id="7292451">g</span><span class="op" id="7292452">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292458">if</span>&nbsp;<span class="ident" id="7292461">g</span><span class="op" id="7292462">,</span>&nbsp;<span class="ident" id="7292464">e</span>&nbsp;<span class="op" id="7292466">:=</span>&nbsp;<span class="ident" id="7292469">m</span><span class="op" id="7292470">[</span><span class="string" id="7292471">&#34;Set-Cookie&#34;</span><span class="op" id="7292483">]</span><span class="op" id="7292484">[</span><span class="num" id="7292485">1</span><span class="op" id="7292486">]</span><span class="op" id="7292487">,</span>&nbsp;<span class="string" id="7292489">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7292517">;</span>&nbsp;<span class="ident" id="7292519">g</span>&nbsp;<span class="op" id="7292521">!=</span>&nbsp;<span class="ident" id="7292524">e</span>&nbsp;<span class="op" id="7292526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292530">t</span><span class="op" id="7292531">.</span><span class="ident" id="7292532">Errorf</span><span class="op" id="7292538">(</span><span class="string" id="7292539">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7292567">,</span>&nbsp;<span class="ident" id="7292569">e</span><span class="op" id="7292570">,</span>&nbsp;<span class="ident" id="7292572">g</span><span class="op" id="7292573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292576">}</span><br>
<span class="lineno"></span><span class="op" id="7292578">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7292581">var</span>&nbsp;<span class="ident" id="7292585">addCookieTests</span>&nbsp;<span class="op" id="7292600">=</span>&nbsp;<span class="op" id="7292602">[</span><span class="op" id="7292603">]</span><span class="keyword" id="7292604">struct</span>&nbsp;<span class="op" id="7292611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292614">Cookies</span>&nbsp;<span class="op" id="7292622">[</span><span class="op" id="7292623">]</span><span class="op" id="7292624">*</span><span class="ident" id="7292625">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7292633">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7292641">string</span><br>
<span class="lineno"></span><span class="op" id="7292648">}</span><span class="op" id="7292649">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292656">[</span><span class="op" id="7292657">]</span><span class="op" id="7292658">*</span><span class="ident" id="7292659">Cookie</span><span class="op" id="7292665">{</span><span class="op" id="7292666">}</span><span class="op" id="7292667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292671">&#34;&#34;</span><span class="op" id="7292673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292676">}</span><span class="op" id="7292677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292680">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292684">[</span><span class="op" id="7292685">]</span><span class="op" id="7292686">*</span><span class="ident" id="7292687">Cookie</span><span class="op" id="7292693">{</span><span class="op" id="7292694">{</span><span class="ident" id="7292695">Name</span><span class="op" id="7292699">:</span>&nbsp;<span class="string" id="7292701">&#34;cookie-1&#34;</span><span class="op" id="7292711">,</span>&nbsp;<span class="ident" id="7292713">Value</span><span class="op" id="7292718">:</span>&nbsp;<span class="string" id="7292720">&#34;v$1&#34;</span><span class="op" id="7292725">}</span><span class="op" id="7292726">}</span><span class="op" id="7292727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292731">&#34;cookie-1=v$1&#34;</span><span class="op" id="7292745">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292748">}</span><span class="op" id="7292749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292756">[</span><span class="op" id="7292757">]</span><span class="op" id="7292758">*</span><span class="ident" id="7292759">Cookie</span><span class="op" id="7292765">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292770">{</span><span class="ident" id="7292771">Name</span><span class="op" id="7292775">:</span>&nbsp;<span class="string" id="7292777">&#34;cookie-1&#34;</span><span class="op" id="7292787">,</span>&nbsp;<span class="ident" id="7292789">Value</span><span class="op" id="7292794">:</span>&nbsp;<span class="string" id="7292796">&#34;v$1&#34;</span><span class="op" id="7292801">}</span><span class="op" id="7292802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292807">{</span><span class="ident" id="7292808">Name</span><span class="op" id="7292812">:</span>&nbsp;<span class="string" id="7292814">&#34;cookie-2&#34;</span><span class="op" id="7292824">,</span>&nbsp;<span class="ident" id="7292826">Value</span><span class="op" id="7292831">:</span>&nbsp;<span class="string" id="7292833">&#34;v$2&#34;</span><span class="op" id="7292838">}</span><span class="op" id="7292839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292844">{</span><span class="ident" id="7292845">Name</span><span class="op" id="7292849">:</span>&nbsp;<span class="string" id="7292851">&#34;cookie-3&#34;</span><span class="op" id="7292861">,</span>&nbsp;<span class="ident" id="7292863">Value</span><span class="op" id="7292868">:</span>&nbsp;<span class="string" id="7292870">&#34;v$3&#34;</span><span class="op" id="7292875">}</span><span class="op" id="7292876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292880">}</span><span class="op" id="7292881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7292885">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7292927">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7292930">}</span><span class="op" id="7292931">,</span><br>
<span class="lineno"></span><span class="op" id="7292933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7292936">func</span>&nbsp;<span class="ident" id="7292941">TestAddCookie</span><span class="op" id="7292954">(</span><span class="ident" id="7292955">t</span>&nbsp;<span class="op" id="7292957">*</span><span class="ident" id="7292958">testing</span><span class="op" id="7292965">.</span><span class="ident" id="7292966">T</span><span class="op" id="7292967">)</span>&nbsp;<span class="op" id="7292969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7292972">for</span>&nbsp;<span class="ident" id="7292976">i</span><span class="op" id="7292977">,</span>&nbsp;<span class="ident" id="7292979">tt</span>&nbsp;<span class="op" id="7292982">:=</span>&nbsp;<span class="keyword" id="7292985">range</span>&nbsp;<span class="ident" id="7292991">addCookieTests</span>&nbsp;<span class="op" id="7293006">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293010">req</span><span class="op" id="7293013">,</span>&nbsp;<span class="ident" id="7293015">_</span>&nbsp;<span class="op" id="7293017">:=</span>&nbsp;<span class="ident" id="7293020">NewRequest</span><span class="op" id="7293030">(</span><span class="string" id="7293031">&#34;GET&#34;</span><span class="op" id="7293036">,</span>&nbsp;<span class="string" id="7293038">&#34;http://example.com/&#34;</span><span class="op" id="7293059">,</span>&nbsp;<span class="ident" id="7293061">nil</span><span class="op" id="7293064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293068">for</span>&nbsp;<span class="ident" id="7293072">_</span><span class="op" id="7293073">,</span>&nbsp;<span class="ident" id="7293075">c</span>&nbsp;<span class="op" id="7293077">:=</span>&nbsp;<span class="keyword" id="7293080">range</span>&nbsp;<span class="ident" id="7293086">tt</span><span class="op" id="7293088">.</span><span class="ident" id="7293089">Cookies</span>&nbsp;<span class="op" id="7293097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293102">req</span><span class="op" id="7293105">.</span><span class="ident" id="7293106">AddCookie</span><span class="op" id="7293115">(</span><span class="ident" id="7293116">c</span><span class="op" id="7293117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293125">if</span>&nbsp;<span class="ident" id="7293128">g</span>&nbsp;<span class="op" id="7293130">:=</span>&nbsp;<span class="ident" id="7293133">req</span><span class="op" id="7293136">.</span><span class="ident" id="7293137">Header</span><span class="op" id="7293143">.</span><span class="ident" id="7293144">Get</span><span class="op" id="7293147">(</span><span class="string" id="7293148">&#34;Cookie&#34;</span><span class="op" id="7293156">)</span><span class="op" id="7293157">;</span>&nbsp;<span class="ident" id="7293159">g</span>&nbsp;<span class="op" id="7293161">!=</span>&nbsp;<span class="ident" id="7293164">tt</span><span class="op" id="7293166">.</span><span class="ident" id="7293167">Raw</span>&nbsp;<span class="op" id="7293171">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293176">t</span><span class="op" id="7293177">.</span><span class="ident" id="7293178">Errorf</span><span class="op" id="7293184">(</span><span class="string" id="7293185">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7293217">,</span>&nbsp;<span class="ident" id="7293219">i</span><span class="op" id="7293220">,</span>&nbsp;<span class="ident" id="7293222">tt</span><span class="op" id="7293224">.</span><span class="ident" id="7293225">Raw</span><span class="op" id="7293228">,</span>&nbsp;<span class="ident" id="7293230">g</span><span class="op" id="7293231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7293236">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293250">}</span><br>
<span class="lineno"></span><span class="op" id="7293252">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7293255">var</span>&nbsp;<span class="ident" id="7293259">readSetCookiesTests</span>&nbsp;<span class="op" id="7293279">=</span>&nbsp;<span class="op" id="7293281">[</span><span class="op" id="7293282">]</span><span class="keyword" id="7293283">struct</span>&nbsp;<span class="op" id="7293290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293293">Header</span>&nbsp;&nbsp;<span class="ident" id="7293301">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293309">Cookies</span>&nbsp;<span class="op" id="7293317">[</span><span class="op" id="7293318">]</span><span class="op" id="7293319">*</span><span class="ident" id="7293320">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7293327">}</span><span class="op" id="7293328">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293335">Header</span><span class="op" id="7293341">{</span><span class="string" id="7293342">&#34;Set-Cookie&#34;</span><span class="op" id="7293354">:</span>&nbsp;<span class="op" id="7293356">{</span><span class="string" id="7293357">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7293371">}</span><span class="op" id="7293372">}</span><span class="op" id="7293373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293377">[</span><span class="op" id="7293378">]</span><span class="op" id="7293379">*</span><span class="ident" id="7293380">Cookie</span><span class="op" id="7293386">{</span><span class="op" id="7293387">{</span><span class="ident" id="7293388">Name</span><span class="op" id="7293392">:</span>&nbsp;<span class="string" id="7293394">&#34;Cookie-1&#34;</span><span class="op" id="7293404">,</span>&nbsp;<span class="ident" id="7293406">Value</span><span class="op" id="7293411">:</span>&nbsp;<span class="string" id="7293413">&#34;v$1&#34;</span><span class="op" id="7293418">,</span>&nbsp;<span class="ident" id="7293420">Raw</span><span class="op" id="7293423">:</span>&nbsp;<span class="string" id="7293425">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7293439">}</span><span class="op" id="7293440">}</span><span class="op" id="7293441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293444">}</span><span class="op" id="7293445">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293448">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293452">Header</span><span class="op" id="7293458">{</span><span class="string" id="7293459">&#34;Set-Cookie&#34;</span><span class="op" id="7293471">:</span>&nbsp;<span class="op" id="7293473">{</span><span class="string" id="7293474">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7293573">}</span><span class="op" id="7293574">}</span><span class="op" id="7293575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293579">[</span><span class="op" id="7293580">]</span><span class="op" id="7293581">*</span><span class="ident" id="7293582">Cookie</span><span class="op" id="7293588">{</span><span class="op" id="7293589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293594">Name</span><span class="op" id="7293598">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7293606">&#34;NID&#34;</span><span class="op" id="7293611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293616">Value</span><span class="op" id="7293621">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7293628">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7293647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293652">Path</span><span class="op" id="7293656">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7293664">&#34;/&#34;</span><span class="op" id="7293667">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293672">Domain</span><span class="op" id="7293678">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7293684">&#34;.google.ch&#34;</span><span class="op" id="7293696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293701">HttpOnly</span><span class="op" id="7293709">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7293713">true</span><span class="op" id="7293717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293722">Expires</span><span class="op" id="7293729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7293734">time</span><span class="op" id="7293738">.</span><span class="ident" id="7293739">Date</span><span class="op" id="7293743">(</span><span class="num" id="7293744">2011</span><span class="op" id="7293748">,</span>&nbsp;<span class="num" id="7293750">11</span><span class="op" id="7293752">,</span>&nbsp;<span class="num" id="7293754">23</span><span class="op" id="7293756">,</span>&nbsp;<span class="num" id="7293758">1</span><span class="op" id="7293759">,</span>&nbsp;<span class="num" id="7293761">5</span><span class="op" id="7293762">,</span>&nbsp;<span class="num" id="7293764">3</span><span class="op" id="7293765">,</span>&nbsp;<span class="num" id="7293767">0</span><span class="op" id="7293768">,</span>&nbsp;<span class="ident" id="7293770">time</span><span class="op" id="7293774">.</span><span class="ident" id="7293775">UTC</span><span class="op" id="7293778">)</span><span class="op" id="7293779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293784">RawExpires</span><span class="op" id="7293794">:</span>&nbsp;<span class="string" id="7293796">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7293827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293832">Raw</span><span class="op" id="7293835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7293844">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7293943">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293947">}</span><span class="op" id="7293948">}</span><span class="op" id="7293949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293952">}</span><span class="op" id="7293953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7293956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7293960">Header</span><span class="op" id="7293966">{</span><span class="string" id="7293967">&#34;Set-Cookie&#34;</span><span class="op" id="7293979">:</span>&nbsp;<span class="op" id="7293981">{</span><span class="string" id="7293982">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7294056">}</span><span class="op" id="7294057">}</span><span class="op" id="7294058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294062">[</span><span class="op" id="7294063">]</span><span class="op" id="7294064">*</span><span class="ident" id="7294065">Cookie</span><span class="op" id="7294071">{</span><span class="op" id="7294072">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294077">Name</span><span class="op" id="7294081">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294089">&#34;.ASPXAUTH&#34;</span><span class="op" id="7294100">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294105">Value</span><span class="op" id="7294110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294117">&#34;7E3AA&#34;</span><span class="op" id="7294124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294129">Path</span><span class="op" id="7294133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294141">&#34;/&#34;</span><span class="op" id="7294144">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294149">Expires</span><span class="op" id="7294156">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7294161">time</span><span class="op" id="7294165">.</span><span class="ident" id="7294166">Date</span><span class="op" id="7294170">(</span><span class="num" id="7294171">2012</span><span class="op" id="7294175">,</span>&nbsp;<span class="num" id="7294177">3</span><span class="op" id="7294178">,</span>&nbsp;<span class="num" id="7294180">7</span><span class="op" id="7294181">,</span>&nbsp;<span class="num" id="7294183">14</span><span class="op" id="7294185">,</span>&nbsp;<span class="num" id="7294187">25</span><span class="op" id="7294189">,</span>&nbsp;<span class="num" id="7294191">6</span><span class="op" id="7294192">,</span>&nbsp;<span class="num" id="7294194">0</span><span class="op" id="7294195">,</span>&nbsp;<span class="ident" id="7294197">time</span><span class="op" id="7294201">.</span><span class="ident" id="7294202">UTC</span><span class="op" id="7294205">)</span><span class="op" id="7294206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294211">RawExpires</span><span class="op" id="7294221">:</span>&nbsp;<span class="string" id="7294223">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7294254">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294259">HttpOnly</span><span class="op" id="7294267">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7294271">true</span><span class="op" id="7294275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294280">Raw</span><span class="op" id="7294283">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294292">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7294366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294370">}</span><span class="op" id="7294371">}</span><span class="op" id="7294372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294375">}</span><span class="op" id="7294376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294379">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294383">Header</span><span class="op" id="7294389">{</span><span class="string" id="7294390">&#34;Set-Cookie&#34;</span><span class="op" id="7294402">:</span>&nbsp;<span class="op" id="7294404">{</span><span class="string" id="7294405">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7294446">}</span><span class="op" id="7294447">}</span><span class="op" id="7294448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294452">[</span><span class="op" id="7294453">]</span><span class="op" id="7294454">*</span><span class="ident" id="7294455">Cookie</span><span class="op" id="7294461">{</span><span class="op" id="7294462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294467">Name</span><span class="op" id="7294471">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294477">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7294496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294501">Value</span><span class="op" id="7294506">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294511">&#34;foo&#34;</span><span class="op" id="7294516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294521">Path</span><span class="op" id="7294525">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294531">&#34;/&#34;</span><span class="op" id="7294534">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294539">HttpOnly</span><span class="op" id="7294547">:</span>&nbsp;<span class="builtintype" id="7294549">true</span><span class="op" id="7294553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294558">Raw</span><span class="op" id="7294561">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7294568">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7294609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294613">}</span><span class="op" id="7294614">}</span><span class="op" id="7294615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294618">}</span><span class="op" id="7294619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294622">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7294695">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294743">Header</span><span class="op" id="7294749">{</span><span class="string" id="7294750">&#34;Set-Cookie&#34;</span><span class="op" id="7294762">:</span>&nbsp;<span class="op" id="7294764">{</span><span class="string" id="7294765">`special-1=a&nbsp;z`</span><span class="op" id="7294780">}</span><span class="op" id="7294781">}</span><span class="op" id="7294782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294786">[</span><span class="op" id="7294787">]</span><span class="op" id="7294788">*</span><span class="ident" id="7294789">Cookie</span><span class="op" id="7294795">{</span><span class="op" id="7294796">{</span><span class="ident" id="7294797">Name</span><span class="op" id="7294801">:</span>&nbsp;<span class="string" id="7294803">&#34;special-1&#34;</span><span class="op" id="7294814">,</span>&nbsp;<span class="ident" id="7294816">Value</span><span class="op" id="7294821">:</span>&nbsp;<span class="string" id="7294823">&#34;a&nbsp;z&#34;</span><span class="op" id="7294828">,</span>&nbsp;<span class="ident" id="7294830">Raw</span><span class="op" id="7294833">:</span>&nbsp;<span class="string" id="7294835">`special-1=a&nbsp;z`</span><span class="op" id="7294850">}</span><span class="op" id="7294851">}</span><span class="op" id="7294852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294855">}</span><span class="op" id="7294856">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294863">Header</span><span class="op" id="7294869">{</span><span class="string" id="7294870">&#34;Set-Cookie&#34;</span><span class="op" id="7294882">:</span>&nbsp;<span class="op" id="7294884">{</span><span class="string" id="7294885">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7294901">}</span><span class="op" id="7294902">}</span><span class="op" id="7294903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294907">[</span><span class="op" id="7294908">]</span><span class="op" id="7294909">*</span><span class="ident" id="7294910">Cookie</span><span class="op" id="7294916">{</span><span class="op" id="7294917">{</span><span class="ident" id="7294918">Name</span><span class="op" id="7294922">:</span>&nbsp;<span class="string" id="7294924">&#34;special-2&#34;</span><span class="op" id="7294935">,</span>&nbsp;<span class="ident" id="7294937">Value</span><span class="op" id="7294942">:</span>&nbsp;<span class="string" id="7294944">&#34;&nbsp;z&#34;</span><span class="op" id="7294948">,</span>&nbsp;<span class="ident" id="7294950">Raw</span><span class="op" id="7294953">:</span>&nbsp;<span class="string" id="7294955">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7294971">}</span><span class="op" id="7294972">}</span><span class="op" id="7294973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294976">}</span><span class="op" id="7294977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7294980">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7294984">Header</span><span class="op" id="7294990">{</span><span class="string" id="7294991">&#34;Set-Cookie&#34;</span><span class="op" id="7295003">:</span>&nbsp;<span class="op" id="7295005">{</span><span class="string" id="7295006">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7295022">}</span><span class="op" id="7295023">}</span><span class="op" id="7295024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295028">[</span><span class="op" id="7295029">]</span><span class="op" id="7295030">*</span><span class="ident" id="7295031">Cookie</span><span class="op" id="7295037">{</span><span class="op" id="7295038">{</span><span class="ident" id="7295039">Name</span><span class="op" id="7295043">:</span>&nbsp;<span class="string" id="7295045">&#34;special-3&#34;</span><span class="op" id="7295056">,</span>&nbsp;<span class="ident" id="7295058">Value</span><span class="op" id="7295063">:</span>&nbsp;<span class="string" id="7295065">&#34;a&nbsp;&#34;</span><span class="op" id="7295069">,</span>&nbsp;<span class="ident" id="7295071">Raw</span><span class="op" id="7295074">:</span>&nbsp;<span class="string" id="7295076">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7295092">}</span><span class="op" id="7295093">}</span><span class="op" id="7295094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295097">}</span><span class="op" id="7295098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295105">Header</span><span class="op" id="7295111">{</span><span class="string" id="7295112">&#34;Set-Cookie&#34;</span><span class="op" id="7295124">:</span>&nbsp;<span class="op" id="7295126">{</span><span class="string" id="7295127">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7295142">}</span><span class="op" id="7295143">}</span><span class="op" id="7295144">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295148">[</span><span class="op" id="7295149">]</span><span class="op" id="7295150">*</span><span class="ident" id="7295151">Cookie</span><span class="op" id="7295157">{</span><span class="op" id="7295158">{</span><span class="ident" id="7295159">Name</span><span class="op" id="7295163">:</span>&nbsp;<span class="string" id="7295165">&#34;special-4&#34;</span><span class="op" id="7295176">,</span>&nbsp;<span class="ident" id="7295178">Value</span><span class="op" id="7295183">:</span>&nbsp;<span class="string" id="7295185">&#34;&nbsp;&#34;</span><span class="op" id="7295188">,</span>&nbsp;<span class="ident" id="7295190">Raw</span><span class="op" id="7295193">:</span>&nbsp;<span class="string" id="7295195">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7295210">}</span><span class="op" id="7295211">}</span><span class="op" id="7295212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295215">}</span><span class="op" id="7295216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295223">Header</span><span class="op" id="7295229">{</span><span class="string" id="7295230">&#34;Set-Cookie&#34;</span><span class="op" id="7295242">:</span>&nbsp;<span class="op" id="7295244">{</span><span class="string" id="7295245">`special-5=a,z`</span><span class="op" id="7295260">}</span><span class="op" id="7295261">}</span><span class="op" id="7295262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295266">[</span><span class="op" id="7295267">]</span><span class="op" id="7295268">*</span><span class="ident" id="7295269">Cookie</span><span class="op" id="7295275">{</span><span class="op" id="7295276">{</span><span class="ident" id="7295277">Name</span><span class="op" id="7295281">:</span>&nbsp;<span class="string" id="7295283">&#34;special-5&#34;</span><span class="op" id="7295294">,</span>&nbsp;<span class="ident" id="7295296">Value</span><span class="op" id="7295301">:</span>&nbsp;<span class="string" id="7295303">&#34;a,z&#34;</span><span class="op" id="7295308">,</span>&nbsp;<span class="ident" id="7295310">Raw</span><span class="op" id="7295313">:</span>&nbsp;<span class="string" id="7295315">`special-5=a,z`</span><span class="op" id="7295330">}</span><span class="op" id="7295331">}</span><span class="op" id="7295332">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295335">}</span><span class="op" id="7295336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295343">Header</span><span class="op" id="7295349">{</span><span class="string" id="7295350">&#34;Set-Cookie&#34;</span><span class="op" id="7295362">:</span>&nbsp;<span class="op" id="7295364">{</span><span class="string" id="7295365">`special-6=&#34;,z&#34;`</span><span class="op" id="7295381">}</span><span class="op" id="7295382">}</span><span class="op" id="7295383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295387">[</span><span class="op" id="7295388">]</span><span class="op" id="7295389">*</span><span class="ident" id="7295390">Cookie</span><span class="op" id="7295396">{</span><span class="op" id="7295397">{</span><span class="ident" id="7295398">Name</span><span class="op" id="7295402">:</span>&nbsp;<span class="string" id="7295404">&#34;special-6&#34;</span><span class="op" id="7295415">,</span>&nbsp;<span class="ident" id="7295417">Value</span><span class="op" id="7295422">:</span>&nbsp;<span class="string" id="7295424">&#34;,z&#34;</span><span class="op" id="7295428">,</span>&nbsp;<span class="ident" id="7295430">Raw</span><span class="op" id="7295433">:</span>&nbsp;<span class="string" id="7295435">`special-6=&#34;,z&#34;`</span><span class="op" id="7295451">}</span><span class="op" id="7295452">}</span><span class="op" id="7295453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295456">}</span><span class="op" id="7295457">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295464">Header</span><span class="op" id="7295470">{</span><span class="string" id="7295471">&#34;Set-Cookie&#34;</span><span class="op" id="7295483">:</span>&nbsp;<span class="op" id="7295485">{</span><span class="string" id="7295486">`special-7=a,`</span><span class="op" id="7295500">}</span><span class="op" id="7295501">}</span><span class="op" id="7295502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295506">[</span><span class="op" id="7295507">]</span><span class="op" id="7295508">*</span><span class="ident" id="7295509">Cookie</span><span class="op" id="7295515">{</span><span class="op" id="7295516">{</span><span class="ident" id="7295517">Name</span><span class="op" id="7295521">:</span>&nbsp;<span class="string" id="7295523">&#34;special-7&#34;</span><span class="op" id="7295534">,</span>&nbsp;<span class="ident" id="7295536">Value</span><span class="op" id="7295541">:</span>&nbsp;<span class="string" id="7295543">&#34;a,&#34;</span><span class="op" id="7295547">,</span>&nbsp;<span class="ident" id="7295549">Raw</span><span class="op" id="7295552">:</span>&nbsp;<span class="string" id="7295554">`special-7=a,`</span><span class="op" id="7295568">}</span><span class="op" id="7295569">}</span><span class="op" id="7295570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295573">}</span><span class="op" id="7295574">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295577">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7295581">Header</span><span class="op" id="7295587">{</span><span class="string" id="7295588">&#34;Set-Cookie&#34;</span><span class="op" id="7295600">:</span>&nbsp;<span class="op" id="7295602">{</span><span class="string" id="7295603">`special-8=&#34;,&#34;`</span><span class="op" id="7295618">}</span><span class="op" id="7295619">}</span><span class="op" id="7295620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295624">[</span><span class="op" id="7295625">]</span><span class="op" id="7295626">*</span><span class="ident" id="7295627">Cookie</span><span class="op" id="7295633">{</span><span class="op" id="7295634">{</span><span class="ident" id="7295635">Name</span><span class="op" id="7295639">:</span>&nbsp;<span class="string" id="7295641">&#34;special-8&#34;</span><span class="op" id="7295652">,</span>&nbsp;<span class="ident" id="7295654">Value</span><span class="op" id="7295659">:</span>&nbsp;<span class="string" id="7295661">&#34;,&#34;</span><span class="op" id="7295664">,</span>&nbsp;<span class="ident" id="7295666">Raw</span><span class="op" id="7295669">:</span>&nbsp;<span class="string" id="7295671">`special-8=&#34;,&#34;`</span><span class="op" id="7295686">}</span><span class="op" id="7295687">}</span><span class="op" id="7295688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7295691">}</span><span class="op" id="7295692">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295696">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295755">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295818">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295882">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7295893">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7296037">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7296040">func</span>&nbsp;<span class="ident" id="7296045">toJSON</span><span class="op" id="7296051">(</span><span class="ident" id="7296052">v</span>&nbsp;<span class="keyword" id="7296054">interface</span><span class="op" id="7296063">{</span><span class="op" id="7296064">}</span><span class="op" id="7296065">)</span>&nbsp;<span class="builtintype" id="7296067">string</span>&nbsp;<span class="op" id="7296074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296077">b</span><span class="op" id="7296078">,</span>&nbsp;<span class="ident" id="7296080">err</span>&nbsp;<span class="op" id="7296084">:=</span>&nbsp;<span class="ident" id="7296087">json</span><span class="op" id="7296091">.</span><span class="ident" id="7296092">Marshal</span><span class="op" id="7296099">(</span><span class="ident" id="7296100">v</span><span class="op" id="7296101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296104">if</span>&nbsp;<span class="ident" id="7296107">err</span>&nbsp;<span class="op" id="7296111">!=</span>&nbsp;<span class="ident" id="7296114">nil</span>&nbsp;<span class="op" id="7296118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296122">return</span>&nbsp;<span class="ident" id="7296129">fmt</span><span class="op" id="7296132">.</span><span class="ident" id="7296133">Sprintf</span><span class="op" id="7296140">(</span><span class="string" id="7296141">&#34;%#v&#34;</span><span class="op" id="7296146">,</span>&nbsp;<span class="ident" id="7296148">v</span><span class="op" id="7296149">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296155">return</span>&nbsp;<span class="builtintype" id="7296162">string</span><span class="op" id="7296168">(</span><span class="ident" id="7296169">b</span><span class="op" id="7296170">)</span><br>
<span class="lineno"></span><span class="op" id="7296172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7296175">func</span>&nbsp;<span class="ident" id="7296180">TestReadSetCookies</span><span class="op" id="7296198">(</span><span class="ident" id="7296199">t</span>&nbsp;<span class="op" id="7296201">*</span><span class="ident" id="7296202">testing</span><span class="op" id="7296209">.</span><span class="ident" id="7296210">T</span><span class="op" id="7296211">)</span>&nbsp;<span class="op" id="7296213">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296216">for</span>&nbsp;<span class="ident" id="7296220">i</span><span class="op" id="7296221">,</span>&nbsp;<span class="ident" id="7296223">tt</span>&nbsp;<span class="op" id="7296226">:=</span>&nbsp;<span class="keyword" id="7296229">range</span>&nbsp;<span class="ident" id="7296235">readSetCookiesTests</span>&nbsp;<span class="op" id="7296255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296259">for</span>&nbsp;<span class="ident" id="7296263">n</span>&nbsp;<span class="op" id="7296265">:=</span>&nbsp;<span class="num" id="7296268">0</span><span class="op" id="7296269">;</span>&nbsp;<span class="ident" id="7296271">n</span>&nbsp;<span class="op" id="7296273">&lt;</span>&nbsp;<span class="num" id="7296275">2</span><span class="op" id="7296276">;</span>&nbsp;<span class="ident" id="7296278">n</span><span class="op" id="7296279">++</span>&nbsp;<span class="op" id="7296282">{</span>&nbsp;<span class="comment" id="7296284">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296340">c</span>&nbsp;<span class="op" id="7296342">:=</span>&nbsp;<span class="ident" id="7296345">readSetCookies</span><span class="op" id="7296359">(</span><span class="ident" id="7296360">tt</span><span class="op" id="7296362">.</span><span class="ident" id="7296363">Header</span><span class="op" id="7296369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296374">if</span>&nbsp;<span class="op" id="7296377">!</span><span class="ident" id="7296378">reflect</span><span class="op" id="7296385">.</span><span class="ident" id="7296386">DeepEqual</span><span class="op" id="7296395">(</span><span class="ident" id="7296396">c</span><span class="op" id="7296397">,</span>&nbsp;<span class="ident" id="7296399">tt</span><span class="op" id="7296401">.</span><span class="ident" id="7296402">Cookies</span><span class="op" id="7296409">)</span>&nbsp;<span class="op" id="7296411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296417">t</span><span class="op" id="7296418">.</span><span class="ident" id="7296419">Errorf</span><span class="op" id="7296425">(</span><span class="string" id="7296426">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7296468">,</span>&nbsp;<span class="ident" id="7296470">i</span><span class="op" id="7296471">,</span>&nbsp;<span class="ident" id="7296473">toJSON</span><span class="op" id="7296479">(</span><span class="ident" id="7296480">c</span><span class="op" id="7296481">)</span><span class="op" id="7296482">,</span>&nbsp;<span class="ident" id="7296484">toJSON</span><span class="op" id="7296490">(</span><span class="ident" id="7296491">tt</span><span class="op" id="7296493">.</span><span class="ident" id="7296494">Cookies</span><span class="op" id="7296501">)</span><span class="op" id="7296502">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7296508">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296527">}</span><br>
<span class="lineno"></span><span class="op" id="7296529">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7296532">var</span>&nbsp;<span class="ident" id="7296536">readCookiesTests</span>&nbsp;<span class="op" id="7296553">=</span>&nbsp;<span class="op" id="7296555">[</span><span class="op" id="7296556">]</span><span class="keyword" id="7296557">struct</span>&nbsp;<span class="op" id="7296564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296567">Header</span>&nbsp;&nbsp;<span class="ident" id="7296575">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296583">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7296591">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296599">Cookies</span>&nbsp;<span class="op" id="7296607">[</span><span class="op" id="7296608">]</span><span class="op" id="7296609">*</span><span class="ident" id="7296610">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7296617">}</span><span class="op" id="7296618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296625">Header</span><span class="op" id="7296631">{</span><span class="string" id="7296632">&#34;Cookie&#34;</span><span class="op" id="7296640">:</span>&nbsp;<span class="op" id="7296642">{</span><span class="string" id="7296643">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7296657">,</span>&nbsp;<span class="string" id="7296659">&#34;c2=v2&#34;</span><span class="op" id="7296666">}</span><span class="op" id="7296667">}</span><span class="op" id="7296668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7296672">&#34;&#34;</span><span class="op" id="7296674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296678">[</span><span class="op" id="7296679">]</span><span class="op" id="7296680">*</span><span class="ident" id="7296681">Cookie</span><span class="op" id="7296687">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296692">{</span><span class="ident" id="7296693">Name</span><span class="op" id="7296697">:</span>&nbsp;<span class="string" id="7296699">&#34;Cookie-1&#34;</span><span class="op" id="7296709">,</span>&nbsp;<span class="ident" id="7296711">Value</span><span class="op" id="7296716">:</span>&nbsp;<span class="string" id="7296718">&#34;v$1&#34;</span><span class="op" id="7296723">}</span><span class="op" id="7296724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296729">{</span><span class="ident" id="7296730">Name</span><span class="op" id="7296734">:</span>&nbsp;<span class="string" id="7296736">&#34;c2&#34;</span><span class="op" id="7296740">,</span>&nbsp;<span class="ident" id="7296742">Value</span><span class="op" id="7296747">:</span>&nbsp;<span class="string" id="7296749">&#34;v2&#34;</span><span class="op" id="7296753">}</span><span class="op" id="7296754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296758">}</span><span class="op" id="7296759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296762">}</span><span class="op" id="7296763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296766">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296770">Header</span><span class="op" id="7296776">{</span><span class="string" id="7296777">&#34;Cookie&#34;</span><span class="op" id="7296785">:</span>&nbsp;<span class="op" id="7296787">{</span><span class="string" id="7296788">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7296802">,</span>&nbsp;<span class="string" id="7296804">&#34;c2=v2&#34;</span><span class="op" id="7296811">}</span><span class="op" id="7296812">}</span><span class="op" id="7296813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7296817">&#34;c2&#34;</span><span class="op" id="7296821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296825">[</span><span class="op" id="7296826">]</span><span class="op" id="7296827">*</span><span class="ident" id="7296828">Cookie</span><span class="op" id="7296834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296839">{</span><span class="ident" id="7296840">Name</span><span class="op" id="7296844">:</span>&nbsp;<span class="string" id="7296846">&#34;c2&#34;</span><span class="op" id="7296850">,</span>&nbsp;<span class="ident" id="7296852">Value</span><span class="op" id="7296857">:</span>&nbsp;<span class="string" id="7296859">&#34;v2&#34;</span><span class="op" id="7296863">}</span><span class="op" id="7296864">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296868">}</span><span class="op" id="7296869">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296872">}</span><span class="op" id="7296873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7296880">Header</span><span class="op" id="7296886">{</span><span class="string" id="7296887">&#34;Cookie&#34;</span><span class="op" id="7296895">:</span>&nbsp;<span class="op" id="7296897">{</span><span class="string" id="7296898">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7296919">}</span><span class="op" id="7296920">}</span><span class="op" id="7296921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7296925">&#34;&#34;</span><span class="op" id="7296927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296931">[</span><span class="op" id="7296932">]</span><span class="op" id="7296933">*</span><span class="ident" id="7296934">Cookie</span><span class="op" id="7296940">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296945">{</span><span class="ident" id="7296946">Name</span><span class="op" id="7296950">:</span>&nbsp;<span class="string" id="7296952">&#34;Cookie-1&#34;</span><span class="op" id="7296962">,</span>&nbsp;<span class="ident" id="7296964">Value</span><span class="op" id="7296969">:</span>&nbsp;<span class="string" id="7296971">&#34;v$1&#34;</span><span class="op" id="7296976">}</span><span class="op" id="7296977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7296982">{</span><span class="ident" id="7296983">Name</span><span class="op" id="7296987">:</span>&nbsp;<span class="string" id="7296989">&#34;c2&#34;</span><span class="op" id="7296993">,</span>&nbsp;<span class="ident" id="7296995">Value</span><span class="op" id="7297000">:</span>&nbsp;<span class="string" id="7297002">&#34;v2&#34;</span><span class="op" id="7297006">}</span><span class="op" id="7297007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297011">}</span><span class="op" id="7297012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297015">}</span><span class="op" id="7297016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297019">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297023">Header</span><span class="op" id="7297029">{</span><span class="string" id="7297030">&#34;Cookie&#34;</span><span class="op" id="7297038">:</span>&nbsp;<span class="op" id="7297040">{</span><span class="string" id="7297041">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7297062">}</span><span class="op" id="7297063">}</span><span class="op" id="7297064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297068">&#34;c2&#34;</span><span class="op" id="7297072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297076">[</span><span class="op" id="7297077">]</span><span class="op" id="7297078">*</span><span class="ident" id="7297079">Cookie</span><span class="op" id="7297085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297090">{</span><span class="ident" id="7297091">Name</span><span class="op" id="7297095">:</span>&nbsp;<span class="string" id="7297097">&#34;c2&#34;</span><span class="op" id="7297101">,</span>&nbsp;<span class="ident" id="7297103">Value</span><span class="op" id="7297108">:</span>&nbsp;<span class="string" id="7297110">&#34;v2&#34;</span><span class="op" id="7297114">}</span><span class="op" id="7297115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297119">}</span><span class="op" id="7297120">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297123">}</span><span class="op" id="7297124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297131">Header</span><span class="op" id="7297137">{</span><span class="string" id="7297138">&#34;Cookie&#34;</span><span class="op" id="7297146">:</span>&nbsp;<span class="op" id="7297148">{</span><span class="string" id="7297149">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7297174">}</span><span class="op" id="7297175">}</span><span class="op" id="7297176">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7297180">&#34;&#34;</span><span class="op" id="7297182">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297186">[</span><span class="op" id="7297187">]</span><span class="op" id="7297188">*</span><span class="ident" id="7297189">Cookie</span><span class="op" id="7297195">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297200">{</span><span class="ident" id="7297201">Name</span><span class="op" id="7297205">:</span>&nbsp;<span class="string" id="7297207">&#34;Cookie-1&#34;</span><span class="op" id="7297217">,</span>&nbsp;<span class="ident" id="7297219">Value</span><span class="op" id="7297224">:</span>&nbsp;<span class="string" id="7297226">&#34;v$1&#34;</span><span class="op" id="7297231">}</span><span class="op" id="7297232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297237">{</span><span class="ident" id="7297238">Name</span><span class="op" id="7297242">:</span>&nbsp;<span class="string" id="7297244">&#34;c2&#34;</span><span class="op" id="7297248">,</span>&nbsp;<span class="ident" id="7297250">Value</span><span class="op" id="7297255">:</span>&nbsp;<span class="string" id="7297257">&#34;v2&#34;</span><span class="op" id="7297261">}</span><span class="op" id="7297262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297266">}</span><span class="op" id="7297267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297270">}</span><span class="op" id="7297271">,</span><br>
<span class="lineno"></span><span class="op" id="7297273">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7297276">func</span>&nbsp;<span class="ident" id="7297281">TestReadCookies</span><span class="op" id="7297296">(</span><span class="ident" id="7297297">t</span>&nbsp;<span class="op" id="7297299">*</span><span class="ident" id="7297300">testing</span><span class="op" id="7297307">.</span><span class="ident" id="7297308">T</span><span class="op" id="7297309">)</span>&nbsp;<span class="op" id="7297311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297314">for</span>&nbsp;<span class="ident" id="7297318">i</span><span class="op" id="7297319">,</span>&nbsp;<span class="ident" id="7297321">tt</span>&nbsp;<span class="op" id="7297324">:=</span>&nbsp;<span class="keyword" id="7297327">range</span>&nbsp;<span class="ident" id="7297333">readCookiesTests</span>&nbsp;<span class="op" id="7297350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297354">for</span>&nbsp;<span class="ident" id="7297358">n</span>&nbsp;<span class="op" id="7297360">:=</span>&nbsp;<span class="num" id="7297363">0</span><span class="op" id="7297364">;</span>&nbsp;<span class="ident" id="7297366">n</span>&nbsp;<span class="op" id="7297368">&lt;</span>&nbsp;<span class="num" id="7297370">2</span><span class="op" id="7297371">;</span>&nbsp;<span class="ident" id="7297373">n</span><span class="op" id="7297374">++</span>&nbsp;<span class="op" id="7297377">{</span>&nbsp;<span class="comment" id="7297379">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297432">c</span>&nbsp;<span class="op" id="7297434">:=</span>&nbsp;<span class="ident" id="7297437">readCookies</span><span class="op" id="7297448">(</span><span class="ident" id="7297449">tt</span><span class="op" id="7297451">.</span><span class="ident" id="7297452">Header</span><span class="op" id="7297458">,</span>&nbsp;<span class="ident" id="7297460">tt</span><span class="op" id="7297462">.</span><span class="ident" id="7297463">Filter</span><span class="op" id="7297469">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297474">if</span>&nbsp;<span class="op" id="7297477">!</span><span class="ident" id="7297478">reflect</span><span class="op" id="7297485">.</span><span class="ident" id="7297486">DeepEqual</span><span class="op" id="7297495">(</span><span class="ident" id="7297496">c</span><span class="op" id="7297497">,</span>&nbsp;<span class="ident" id="7297499">tt</span><span class="op" id="7297501">.</span><span class="ident" id="7297502">Cookies</span><span class="op" id="7297509">)</span>&nbsp;<span class="op" id="7297511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297517">t</span><span class="op" id="7297518">.</span><span class="ident" id="7297519">Errorf</span><span class="op" id="7297525">(</span><span class="string" id="7297526">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7297566">,</span>&nbsp;<span class="ident" id="7297568">i</span><span class="op" id="7297569">,</span>&nbsp;<span class="ident" id="7297571">toJSON</span><span class="op" id="7297577">(</span><span class="ident" id="7297578">c</span><span class="op" id="7297579">)</span><span class="op" id="7297580">,</span>&nbsp;<span class="ident" id="7297582">toJSON</span><span class="op" id="7297588">(</span><span class="ident" id="7297589">tt</span><span class="op" id="7297591">.</span><span class="ident" id="7297592">Cookies</span><span class="op" id="7297599">)</span><span class="op" id="7297600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7297606">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297622">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7297625">}</span><br>
<span class="lineno"></span><span class="op" id="7297627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7297630">func</span>&nbsp;<span class="ident" id="7297635">TestSetCookieDoubleQuotes</span><span class="op" id="7297660">(</span><span class="ident" id="7297661">t</span>&nbsp;<span class="op" id="7297663">*</span><span class="ident" id="7297664">testing</span><span class="op" id="7297671">.</span><span class="ident" id="7297672">T</span><span class="op" id="7297673">)</span>&nbsp;<span class="op" id="7297675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297678">res</span>&nbsp;<span class="op" id="7297682">:=</span>&nbsp;<span class="op" id="7297685">&amp;</span><span class="ident" id="7297686">Response</span><span class="op" id="7297694">{</span><span class="ident" id="7297695">Header</span><span class="op" id="7297701">:</span>&nbsp;<span class="ident" id="7297703">Header</span><span class="op" id="7297709">{</span><span class="op" id="7297710">}</span><span class="op" id="7297711">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297714">res</span><span class="op" id="7297717">.</span><span class="ident" id="7297718">Header</span><span class="op" id="7297724">.</span><span class="ident" id="7297725">Add</span><span class="op" id="7297728">(</span><span class="string" id="7297729">&#34;Set-Cookie&#34;</span><span class="op" id="7297741">,</span>&nbsp;<span class="string" id="7297743">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7297769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297772">res</span><span class="op" id="7297775">.</span><span class="ident" id="7297776">Header</span><span class="op" id="7297782">.</span><span class="ident" id="7297783">Add</span><span class="op" id="7297786">(</span><span class="string" id="7297787">&#34;Set-Cookie&#34;</span><span class="op" id="7297799">,</span>&nbsp;<span class="string" id="7297801">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7297836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297839">res</span><span class="op" id="7297842">.</span><span class="ident" id="7297843">Header</span><span class="op" id="7297849">.</span><span class="ident" id="7297850">Add</span><span class="op" id="7297853">(</span><span class="string" id="7297854">&#34;Set-Cookie&#34;</span><span class="op" id="7297866">,</span>&nbsp;<span class="string" id="7297868">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7297900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297903">res</span><span class="op" id="7297906">.</span><span class="ident" id="7297907">Header</span><span class="op" id="7297913">.</span><span class="ident" id="7297914">Add</span><span class="op" id="7297917">(</span><span class="string" id="7297918">&#34;Set-Cookie&#34;</span><span class="op" id="7297930">,</span>&nbsp;<span class="string" id="7297932">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7297962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297965">got</span>&nbsp;<span class="op" id="7297969">:=</span>&nbsp;<span class="ident" id="7297972">res</span><span class="op" id="7297975">.</span><span class="ident" id="7297976">Cookies</span><span class="op" id="7297983">(</span><span class="op" id="7297984">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7297987">want</span>&nbsp;<span class="op" id="7297992">:=</span>&nbsp;<span class="op" id="7297995">[</span><span class="op" id="7297996">]</span><span class="op" id="7297997">*</span><span class="ident" id="7297998">Cookie</span><span class="op" id="7298004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298008">{</span><span class="ident" id="7298009">Name</span><span class="op" id="7298013">:</span>&nbsp;<span class="string" id="7298015">&#34;quoted0&#34;</span><span class="op" id="7298024">,</span>&nbsp;<span class="ident" id="7298026">Value</span><span class="op" id="7298031">:</span>&nbsp;<span class="string" id="7298033">&#34;none&#34;</span><span class="op" id="7298039">,</span>&nbsp;<span class="ident" id="7298041">MaxAge</span><span class="op" id="7298047">:</span>&nbsp;<span class="num" id="7298049">30</span><span class="op" id="7298051">}</span><span class="op" id="7298052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298056">{</span><span class="ident" id="7298057">Name</span><span class="op" id="7298061">:</span>&nbsp;<span class="string" id="7298063">&#34;quoted1&#34;</span><span class="op" id="7298072">,</span>&nbsp;<span class="ident" id="7298074">Value</span><span class="op" id="7298079">:</span>&nbsp;<span class="string" id="7298081">&#34;cookieValue&#34;</span><span class="op" id="7298094">,</span>&nbsp;<span class="ident" id="7298096">MaxAge</span><span class="op" id="7298102">:</span>&nbsp;<span class="num" id="7298104">31</span><span class="op" id="7298106">}</span><span class="op" id="7298107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298111">{</span><span class="ident" id="7298112">Name</span><span class="op" id="7298116">:</span>&nbsp;<span class="string" id="7298118">&#34;quoted2&#34;</span><span class="op" id="7298127">,</span>&nbsp;<span class="ident" id="7298129">Value</span><span class="op" id="7298134">:</span>&nbsp;<span class="string" id="7298136">&#34;cookieAV&#34;</span><span class="op" id="7298146">}</span><span class="op" id="7298147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298151">{</span><span class="ident" id="7298152">Name</span><span class="op" id="7298156">:</span>&nbsp;<span class="string" id="7298158">&#34;quoted3&#34;</span><span class="op" id="7298167">,</span>&nbsp;<span class="ident" id="7298169">Value</span><span class="op" id="7298174">:</span>&nbsp;<span class="string" id="7298176">&#34;both&#34;</span><span class="op" id="7298182">}</span><span class="op" id="7298183">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298189">if</span>&nbsp;<span class="builtinfunc" id="7298192">len</span><span class="op" id="7298195">(</span><span class="ident" id="7298196">got</span><span class="op" id="7298199">)</span>&nbsp;<span class="op" id="7298201">!=</span>&nbsp;<span class="builtinfunc" id="7298204">len</span><span class="op" id="7298207">(</span><span class="ident" id="7298208">want</span><span class="op" id="7298212">)</span>&nbsp;<span class="op" id="7298214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298218">t</span><span class="op" id="7298219">.</span><span class="ident" id="7298220">Fatal</span><span class="op" id="7298225">(</span><span class="string" id="7298226">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7298251">,</span>&nbsp;<span class="builtinfunc" id="7298253">len</span><span class="op" id="7298256">(</span><span class="ident" id="7298257">got</span><span class="op" id="7298260">)</span><span class="op" id="7298261">,</span>&nbsp;<span class="builtinfunc" id="7298263">len</span><span class="op" id="7298266">(</span><span class="ident" id="7298267">want</span><span class="op" id="7298271">)</span><span class="op" id="7298272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298278">for</span>&nbsp;<span class="ident" id="7298282">i</span><span class="op" id="7298283">,</span>&nbsp;<span class="ident" id="7298285">w</span>&nbsp;<span class="op" id="7298287">:=</span>&nbsp;<span class="keyword" id="7298290">range</span>&nbsp;<span class="ident" id="7298296">want</span>&nbsp;<span class="op" id="7298301">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298305">g</span>&nbsp;<span class="op" id="7298307">:=</span>&nbsp;<span class="ident" id="7298310">got</span><span class="op" id="7298313">[</span><span class="ident" id="7298314">i</span><span class="op" id="7298315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298319">if</span>&nbsp;<span class="ident" id="7298322">g</span><span class="op" id="7298323">.</span><span class="ident" id="7298324">Name</span>&nbsp;<span class="op" id="7298329">!=</span>&nbsp;<span class="ident" id="7298332">w</span><span class="op" id="7298333">.</span><span class="ident" id="7298334">Name</span>&nbsp;<span class="op" id="7298339">||</span>&nbsp;<span class="ident" id="7298342">g</span><span class="op" id="7298343">.</span><span class="ident" id="7298344">Value</span>&nbsp;<span class="op" id="7298350">!=</span>&nbsp;<span class="ident" id="7298353">w</span><span class="op" id="7298354">.</span><span class="ident" id="7298355">Value</span>&nbsp;<span class="op" id="7298361">||</span>&nbsp;<span class="ident" id="7298364">g</span><span class="op" id="7298365">.</span><span class="ident" id="7298366">MaxAge</span>&nbsp;<span class="op" id="7298373">!=</span>&nbsp;<span class="ident" id="7298376">w</span><span class="op" id="7298377">.</span><span class="ident" id="7298378">MaxAge</span>&nbsp;<span class="op" id="7298385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298390">t</span><span class="op" id="7298391">.</span><span class="ident" id="7298392">Errorf</span><span class="op" id="7298398">(</span><span class="string" id="7298399">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7298430">,</span>&nbsp;<span class="ident" id="7298432">i</span><span class="op" id="7298433">,</span>&nbsp;<span class="ident" id="7298435">g</span><span class="op" id="7298436">,</span>&nbsp;<span class="ident" id="7298438">w</span><span class="op" id="7298439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298446">}</span><br>
<span class="lineno">360</span><span class="op" id="7298448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7298451">func</span>&nbsp;<span class="ident" id="7298456">TestCookieSanitizeValue</span><span class="op" id="7298479">(</span><span class="ident" id="7298480">t</span>&nbsp;<span class="op" id="7298482">*</span><span class="ident" id="7298483">testing</span><span class="op" id="7298490">.</span><span class="ident" id="7298491">T</span><span class="op" id="7298492">)</span>&nbsp;<span class="op" id="7298494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298497">defer</span>&nbsp;<span class="ident" id="7298503">log</span><span class="op" id="7298506">.</span><span class="ident" id="7298507">SetOutput</span><span class="op" id="7298516">(</span><span class="ident" id="7298517">os</span><span class="op" id="7298519">.</span><span class="ident" id="7298520">Stderr</span><span class="op" id="7298526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298529">var</span>&nbsp;<span class="ident" id="7298533">logbuf</span>&nbsp;<span class="ident" id="7298540">bytes</span><span class="op" id="7298545">.</span><span class="ident" id="7298546">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298554">log</span><span class="op" id="7298557">.</span><span class="ident" id="7298558">SetOutput</span><span class="op" id="7298567">(</span><span class="op" id="7298568">&amp;</span><span class="ident" id="7298569">logbuf</span><span class="op" id="7298575">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298579">tests</span>&nbsp;<span class="op" id="7298585">:=</span>&nbsp;<span class="op" id="7298588">[</span><span class="op" id="7298589">]</span><span class="keyword" id="7298590">struct</span>&nbsp;<span class="op" id="7298597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298601">in</span><span class="op" id="7298603">,</span>&nbsp;<span class="ident" id="7298605">want</span>&nbsp;<span class="builtintype" id="7298610">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298618">}</span><span class="op" id="7298619">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298623">{</span><span class="string" id="7298624">&#34;foo&#34;</span><span class="op" id="7298629">,</span>&nbsp;<span class="string" id="7298631">&#34;foo&#34;</span><span class="op" id="7298636">}</span><span class="op" id="7298637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298641">{</span><span class="string" id="7298642">&#34;foo;bar&#34;</span><span class="op" id="7298651">,</span>&nbsp;<span class="string" id="7298653">&#34;foobar&#34;</span><span class="op" id="7298661">}</span><span class="op" id="7298662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298666">{</span><span class="string" id="7298667">&#34;foo\\bar&#34;</span><span class="op" id="7298677">,</span>&nbsp;<span class="string" id="7298679">&#34;foobar&#34;</span><span class="op" id="7298687">}</span><span class="op" id="7298688">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298692">{</span><span class="string" id="7298693">&#34;foo\&#34;bar&#34;</span><span class="op" id="7298703">,</span>&nbsp;<span class="string" id="7298705">&#34;foobar&#34;</span><span class="op" id="7298713">}</span><span class="op" id="7298714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298718">{</span><span class="string" id="7298719">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7298737">,</span>&nbsp;<span class="string" id="7298739">&#34;\x7e&#34;</span><span class="op" id="7298745">}</span><span class="op" id="7298746">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298750">{</span><span class="string" id="7298751">`&#34;withquotes&#34;`</span><span class="op" id="7298765">,</span>&nbsp;<span class="string" id="7298767">&#34;withquotes&#34;</span><span class="op" id="7298779">}</span><span class="op" id="7298780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298784">{</span><span class="string" id="7298785">&#34;a&nbsp;z&#34;</span><span class="op" id="7298790">,</span>&nbsp;<span class="string" id="7298792">&#34;a&nbsp;z&#34;</span><span class="op" id="7298797">}</span><span class="op" id="7298798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298802">{</span><span class="string" id="7298803">&#34;&nbsp;z&#34;</span><span class="op" id="7298807">,</span>&nbsp;<span class="string" id="7298809">`&#34;&nbsp;z&#34;`</span><span class="op" id="7298815">}</span><span class="op" id="7298816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298820">{</span><span class="string" id="7298821">&#34;a&nbsp;&#34;</span><span class="op" id="7298825">,</span>&nbsp;<span class="string" id="7298827">`&#34;a&nbsp;&#34;`</span><span class="op" id="7298833">}</span><span class="op" id="7298834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7298837">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298840">for</span>&nbsp;<span class="ident" id="7298844">_</span><span class="op" id="7298845">,</span>&nbsp;<span class="ident" id="7298847">tt</span>&nbsp;<span class="op" id="7298850">:=</span>&nbsp;<span class="keyword" id="7298853">range</span>&nbsp;<span class="ident" id="7298859">tests</span>&nbsp;<span class="op" id="7298865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7298869">if</span>&nbsp;<span class="ident" id="7298872">got</span>&nbsp;<span class="op" id="7298876">:=</span>&nbsp;<span class="ident" id="7298879">sanitizeCookieValue</span><span class="op" id="7298898">(</span><span class="ident" id="7298899">tt</span><span class="op" id="7298901">.</span><span class="ident" id="7298902">in</span><span class="op" id="7298904">)</span><span class="op" id="7298905">;</span>&nbsp;<span class="ident" id="7298907">got</span>&nbsp;<span class="op" id="7298911">!=</span>&nbsp;<span class="ident" id="7298914">tt</span><span class="op" id="7298916">.</span><span class="ident" id="7298917">want</span>&nbsp;<span class="op" id="7298922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7298927">t</span><span class="op" id="7298928">.</span><span class="ident" id="7298929">Errorf</span><span class="op" id="7298935">(</span><span class="string" id="7298936">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7298975">,</span>&nbsp;<span class="ident" id="7298977">tt</span><span class="op" id="7298979">.</span><span class="ident" id="7298980">in</span><span class="op" id="7298982">,</span>&nbsp;<span class="ident" id="7298984">got</span><span class="op" id="7298987">,</span>&nbsp;<span class="ident" id="7298989">tt</span><span class="op" id="7298991">.</span><span class="ident" id="7298992">want</span><span class="op" id="7298996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299003">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299007">if</span>&nbsp;<span class="ident" id="7299010">got</span><span class="op" id="7299013">,</span>&nbsp;<span class="ident" id="7299015">sub</span>&nbsp;<span class="op" id="7299019">:=</span>&nbsp;<span class="ident" id="7299022">logbuf</span><span class="op" id="7299028">.</span><span class="ident" id="7299029">String</span><span class="op" id="7299035">(</span><span class="op" id="7299036">)</span><span class="op" id="7299037">,</span>&nbsp;<span class="string" id="7299039">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7299063">;</span>&nbsp;<span class="op" id="7299065">!</span><span class="ident" id="7299066">strings</span><span class="op" id="7299073">.</span><span class="ident" id="7299074">Contains</span><span class="op" id="7299082">(</span><span class="ident" id="7299083">got</span><span class="op" id="7299086">,</span>&nbsp;<span class="ident" id="7299088">sub</span><span class="op" id="7299091">)</span>&nbsp;<span class="op" id="7299093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299097">t</span><span class="op" id="7299098">.</span><span class="ident" id="7299099">Errorf</span><span class="op" id="7299105">(</span><span class="string" id="7299106">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7299153">,</span>&nbsp;<span class="ident" id="7299155">sub</span><span class="op" id="7299158">,</span>&nbsp;<span class="ident" id="7299160">got</span><span class="op" id="7299163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299166">}</span><br>
<span class="lineno"></span><span class="op" id="7299168">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7299171">func</span>&nbsp;<span class="ident" id="7299176">TestCookieSanitizePath</span><span class="op" id="7299198">(</span><span class="ident" id="7299199">t</span>&nbsp;<span class="op" id="7299201">*</span><span class="ident" id="7299202">testing</span><span class="op" id="7299209">.</span><span class="ident" id="7299210">T</span><span class="op" id="7299211">)</span>&nbsp;<span class="op" id="7299213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299216">defer</span>&nbsp;<span class="ident" id="7299222">log</span><span class="op" id="7299225">.</span><span class="ident" id="7299226">SetOutput</span><span class="op" id="7299235">(</span><span class="ident" id="7299236">os</span><span class="op" id="7299238">.</span><span class="ident" id="7299239">Stderr</span><span class="op" id="7299245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299248">var</span>&nbsp;<span class="ident" id="7299252">logbuf</span>&nbsp;<span class="ident" id="7299259">bytes</span><span class="op" id="7299264">.</span><span class="ident" id="7299265">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299273">log</span><span class="op" id="7299276">.</span><span class="ident" id="7299277">SetOutput</span><span class="op" id="7299286">(</span><span class="op" id="7299287">&amp;</span><span class="ident" id="7299288">logbuf</span><span class="op" id="7299294">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299298">tests</span>&nbsp;<span class="op" id="7299304">:=</span>&nbsp;<span class="op" id="7299307">[</span><span class="op" id="7299308">]</span><span class="keyword" id="7299309">struct</span>&nbsp;<span class="op" id="7299316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299320">in</span><span class="op" id="7299322">,</span>&nbsp;<span class="ident" id="7299324">want</span>&nbsp;<span class="builtintype" id="7299329">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299337">}</span><span class="op" id="7299338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299342">{</span><span class="string" id="7299343">&#34;/path&#34;</span><span class="op" id="7299350">,</span>&nbsp;<span class="string" id="7299352">&#34;/path&#34;</span><span class="op" id="7299359">}</span><span class="op" id="7299360">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299364">{</span><span class="string" id="7299365">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7299384">,</span>&nbsp;<span class="string" id="7299386">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7299405">}</span><span class="op" id="7299406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299410">{</span><span class="string" id="7299411">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7299443">,</span>&nbsp;<span class="string" id="7299445">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7299471">}</span><span class="op" id="7299472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299478">for</span>&nbsp;<span class="ident" id="7299482">_</span><span class="op" id="7299483">,</span>&nbsp;<span class="ident" id="7299485">tt</span>&nbsp;<span class="op" id="7299488">:=</span>&nbsp;<span class="keyword" id="7299491">range</span>&nbsp;<span class="ident" id="7299497">tests</span>&nbsp;<span class="op" id="7299503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299507">if</span>&nbsp;<span class="ident" id="7299510">got</span>&nbsp;<span class="op" id="7299514">:=</span>&nbsp;<span class="ident" id="7299517">sanitizeCookiePath</span><span class="op" id="7299535">(</span><span class="ident" id="7299536">tt</span><span class="op" id="7299538">.</span><span class="ident" id="7299539">in</span><span class="op" id="7299541">)</span><span class="op" id="7299542">;</span>&nbsp;<span class="ident" id="7299544">got</span>&nbsp;<span class="op" id="7299548">!=</span>&nbsp;<span class="ident" id="7299551">tt</span><span class="op" id="7299553">.</span><span class="ident" id="7299554">want</span>&nbsp;<span class="op" id="7299559">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299564">t</span><span class="op" id="7299565">.</span><span class="ident" id="7299566">Errorf</span><span class="op" id="7299572">(</span><span class="string" id="7299573">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7299611">,</span>&nbsp;<span class="ident" id="7299613">tt</span><span class="op" id="7299615">.</span><span class="ident" id="7299616">in</span><span class="op" id="7299618">,</span>&nbsp;<span class="ident" id="7299620">got</span><span class="op" id="7299623">,</span>&nbsp;<span class="ident" id="7299625">tt</span><span class="op" id="7299627">.</span><span class="ident" id="7299628">want</span><span class="op" id="7299632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7299643">if</span>&nbsp;<span class="ident" id="7299646">got</span><span class="op" id="7299649">,</span>&nbsp;<span class="ident" id="7299651">sub</span>&nbsp;<span class="op" id="7299655">:=</span>&nbsp;<span class="ident" id="7299658">logbuf</span><span class="op" id="7299664">.</span><span class="ident" id="7299665">String</span><span class="op" id="7299671">(</span><span class="op" id="7299672">)</span><span class="op" id="7299673">,</span>&nbsp;<span class="string" id="7299675">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7299699">;</span>&nbsp;<span class="op" id="7299701">!</span><span class="ident" id="7299702">strings</span><span class="op" id="7299709">.</span><span class="ident" id="7299710">Contains</span><span class="op" id="7299718">(</span><span class="ident" id="7299719">got</span><span class="op" id="7299722">,</span>&nbsp;<span class="ident" id="7299724">sub</span><span class="op" id="7299727">)</span>&nbsp;<span class="op" id="7299729">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7299733">t</span><span class="op" id="7299734">.</span><span class="ident" id="7299735">Errorf</span><span class="op" id="7299741">(</span><span class="string" id="7299742">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7299789">,</span>&nbsp;<span class="ident" id="7299791">sub</span><span class="op" id="7299794">,</span>&nbsp;<span class="ident" id="7299796">got</span><span class="op" id="7299799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7299802">}</span><br>
<span class="lineno"></span><span class="op" id="7299804">}</span>
</div>
</body>
</html>
