<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/tar</h2>
<ul>
<li><a href="/gostd/archive/tar/common.go.html">common.go</a></li>
<li><a href="/gostd/archive/tar/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/tar/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/tar/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/tar/stat_atim.go.html">stat_atim.go</a></li>
<li><a href="/gostd/archive/tar/stat_unix.go.html">stat_unix.go</a></li>
<li><a href="/gostd/archive/tar/tar_test.go.html">tar_test.go</a></li>
<li><a href="/gostd/archive/tar/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/tar/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4164004">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4164059">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4164113">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4164164">//&nbsp;Package&nbsp;tar&nbsp;implements&nbsp;access&nbsp;to&nbsp;tar&nbsp;archives.</span><br>
<span class="lineno"></span><span class="comment" id="4164214">//&nbsp;It&nbsp;aims&nbsp;to&nbsp;cover&nbsp;most&nbsp;of&nbsp;the&nbsp;variations,&nbsp;including&nbsp;those&nbsp;produced</span><br>
<span class="lineno"></span><span class="comment" id="4164283">//&nbsp;by&nbsp;GNU&nbsp;and&nbsp;BSD&nbsp;tars.</span><br>
<span class="lineno"></span><span class="comment" id="4164307">//</span><br>
<span class="lineno"></span><span class="comment" id="4164310">//&nbsp;References:</span><br>
<span class="lineno">10</span><span class="comment" id="4164325">//&nbsp;&nbsp;&nbsp;http://www.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=5</span><br>
<span class="lineno"></span><span class="comment" id="4164385">//&nbsp;&nbsp;&nbsp;http://www.gnu.org/software/tar/manual/html_node/Standard.html</span><br>
<span class="lineno"></span><span class="comment" id="4164453">//&nbsp;&nbsp;&nbsp;http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html</span><br>
<span class="lineno"></span><span class="keyword" id="4164525">package</span>&nbsp;<span class="ident" id="4164533">tar</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4164538">import</span>&nbsp;<span class="op" id="4164545">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164548">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164557">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164567">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164574">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164580">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4164588">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4164595">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4164598">const</span>&nbsp;<span class="op" id="4164604">(</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164607">blockSize</span>&nbsp;<span class="op" id="4164617">=</span>&nbsp;<span class="num" id="4164619">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164625">//&nbsp;Types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164635">TypeReg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164653">=</span>&nbsp;<span class="string" id="4164655">&#39;0&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164662">//&nbsp;regular&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164679">TypeRegA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164697">=</span>&nbsp;<span class="string" id="4164699">&#39;\x00&#39;</span>&nbsp;<span class="comment" id="4164706">//&nbsp;regular&nbsp;file</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164723">TypeLink</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164741">=</span>&nbsp;<span class="string" id="4164743">&#39;1&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164750">//&nbsp;hard&nbsp;link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164764">TypeSymlink</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164782">=</span>&nbsp;<span class="string" id="4164784">&#39;2&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164791">//&nbsp;symbolic&nbsp;link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164809">TypeChar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164827">=</span>&nbsp;<span class="string" id="4164829">&#39;3&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164836">//&nbsp;character&nbsp;device&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164862">TypeBlock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164880">=</span>&nbsp;<span class="string" id="4164882">&#39;4&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164889">//&nbsp;block&nbsp;device&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164911">TypeDir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164929">=</span>&nbsp;<span class="string" id="4164931">&#39;5&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164938">//&nbsp;directory</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164952">TypeFifo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4164970">=</span>&nbsp;<span class="string" id="4164972">&#39;6&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4164979">//&nbsp;fifo&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164993">TypeCont</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165011">=</span>&nbsp;<span class="string" id="4165013">&#39;7&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165020">//&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165033">TypeXHeader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165051">=</span>&nbsp;<span class="string" id="4165053">&#39;x&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165060">//&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165080">TypeXGlobalHeader</span>&nbsp;<span class="op" id="4165098">=</span>&nbsp;<span class="string" id="4165100">&#39;g&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165107">//&nbsp;global&nbsp;extended&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165134">TypeGNULongName</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4165152">=</span>&nbsp;<span class="string" id="4165154">&#39;L&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165161">//&nbsp;Next&nbsp;file&nbsp;has&nbsp;a&nbsp;long&nbsp;name</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165191">TypeGNULongLink</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4165209">=</span>&nbsp;<span class="string" id="4165211">&#39;K&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165218">//&nbsp;Next&nbsp;file&nbsp;symlinks&nbsp;to&nbsp;a&nbsp;file&nbsp;w/&nbsp;a&nbsp;long&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165266">TypeGNUSparse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4165284">=</span>&nbsp;<span class="string" id="4165286">&#39;S&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165293">//&nbsp;sparse&nbsp;file</span><br>
<span class="lineno"></span><span class="op" id="4165308">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4165311">//&nbsp;A&nbsp;Header&nbsp;represents&nbsp;a&nbsp;single&nbsp;header&nbsp;in&nbsp;a&nbsp;tar&nbsp;archive.</span><br>
<span class="lineno">45</span><span class="comment" id="4165368">//&nbsp;Some&nbsp;fields&nbsp;may&nbsp;not&nbsp;be&nbsp;populated.</span><br>
<span class="lineno"></span><span class="keyword" id="4165405">type</span>&nbsp;<span class="ident" id="4165410">Header</span>&nbsp;<span class="keyword" id="4165417">struct</span>&nbsp;<span class="op" id="4165424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165427">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165438">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165448">//&nbsp;name&nbsp;of&nbsp;header&nbsp;file&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165478">Mode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165489">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165499">//&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165528">Uid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165539">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165549">//&nbsp;user&nbsp;id&nbsp;of&nbsp;owner</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165570">Gid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165581">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165591">//&nbsp;group&nbsp;id&nbsp;of&nbsp;owner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165613">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165624">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165634">//&nbsp;length&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165654">ModTime</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4165665">time</span><span class="op" id="4165669">.</span><span class="ident" id="4165670">Time</span>&nbsp;<span class="comment" id="4165675">//&nbsp;modified&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165693">Typeflag</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165704">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165714">//&nbsp;type&nbsp;of&nbsp;header&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165739">Linkname</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165750">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165760">//&nbsp;target&nbsp;name&nbsp;of&nbsp;link</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165784">Uname</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165795">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165805">//&nbsp;user&nbsp;name&nbsp;of&nbsp;owner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165828">Gname</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4165839">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165849">//&nbsp;group&nbsp;name&nbsp;of&nbsp;owner</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165873">Devmajor</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4165884">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165894">//&nbsp;major&nbsp;number&nbsp;of&nbsp;character&nbsp;or&nbsp;block&nbsp;device</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165940">Devminor</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4165951">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4165961">//&nbsp;minor&nbsp;number&nbsp;of&nbsp;character&nbsp;or&nbsp;block&nbsp;device</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166007">AccessTime</span>&nbsp;<span class="ident" id="4166018">time</span><span class="op" id="4166022">.</span><span class="ident" id="4166023">Time</span>&nbsp;<span class="comment" id="4166028">//&nbsp;access&nbsp;time</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166044">ChangeTime</span>&nbsp;<span class="ident" id="4166055">time</span><span class="op" id="4166059">.</span><span class="ident" id="4166060">Time</span>&nbsp;<span class="comment" id="4166065">//&nbsp;status&nbsp;change&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166088">Xattrs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4166099">map</span><span class="op" id="4166102">[</span><span class="builtintype" id="4166103">string</span><span class="op" id="4166109">]</span><span class="builtintype" id="4166110">string</span><br>
<span class="lineno"></span><span class="op" id="4166117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4166120">//&nbsp;File&nbsp;name&nbsp;constants&nbsp;from&nbsp;the&nbsp;tar&nbsp;spec.</span><br>
<span class="lineno">65</span><span class="keyword" id="4166162">const</span>&nbsp;<span class="op" id="4166168">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166171">fileNameSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166190">=</span>&nbsp;<span class="num" id="4166192">100</span>&nbsp;<span class="comment" id="4166196">//&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;a&nbsp;standard&nbsp;tar&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166248">fileNamePrefixSize</span>&nbsp;<span class="op" id="4166267">=</span>&nbsp;<span class="num" id="4166269">155</span>&nbsp;<span class="comment" id="4166273">//&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;ustar&nbsp;extension&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="op" id="4166317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4166320">//&nbsp;FileInfo&nbsp;returns&nbsp;an&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;Header.</span><br>
<span class="lineno"></span><span class="keyword" id="4166371">func</span>&nbsp;<span class="op" id="4166376">(</span><span class="ident" id="4166377">h</span>&nbsp;<span class="op" id="4166379">*</span><span class="ident" id="4166380">Header</span><span class="op" id="4166386">)</span>&nbsp;<span class="ident" id="4166388">FileInfo</span><span class="op" id="4166396">(</span><span class="op" id="4166397">)</span>&nbsp;<span class="ident" id="4166399">os</span><span class="op" id="4166401">.</span><span class="ident" id="4166402">FileInfo</span>&nbsp;<span class="op" id="4166411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166414">return</span>&nbsp;<span class="ident" id="4166421">headerFileInfo</span><span class="op" id="4166435">{</span><span class="ident" id="4166436">h</span><span class="op" id="4166437">}</span><br>
<span class="lineno"></span><span class="op" id="4166439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="4166442">//&nbsp;headerFileInfo&nbsp;implements&nbsp;os.FileInfo.</span><br>
<span class="lineno"></span><span class="keyword" id="4166484">type</span>&nbsp;<span class="ident" id="4166489">headerFileInfo</span>&nbsp;<span class="keyword" id="4166504">struct</span>&nbsp;<span class="op" id="4166511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4166514">h</span>&nbsp;<span class="op" id="4166516">*</span><span class="ident" id="4166517">Header</span><br>
<span class="lineno"></span><span class="op" id="4166524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4166527">func</span>&nbsp;<span class="op" id="4166532">(</span><span class="ident" id="4166533">fi</span>&nbsp;<span class="ident" id="4166536">headerFileInfo</span><span class="op" id="4166550">)</span>&nbsp;<span class="ident" id="4166552">Size</span><span class="op" id="4166556">(</span><span class="op" id="4166557">)</span>&nbsp;<span class="ident" id="4166559">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166572">{</span>&nbsp;<span class="keyword" id="4166574">return</span>&nbsp;<span class="ident" id="4166581">fi</span><span class="op" id="4166583">.</span><span class="ident" id="4166584">h</span><span class="op" id="4166585">.</span><span class="ident" id="4166586">Size</span>&nbsp;<span class="op" id="4166591">}</span><br>
<span class="lineno"></span><span class="keyword" id="4166593">func</span>&nbsp;<span class="op" id="4166598">(</span><span class="ident" id="4166599">fi</span>&nbsp;<span class="ident" id="4166602">headerFileInfo</span><span class="op" id="4166616">)</span>&nbsp;<span class="ident" id="4166618">IsDir</span><span class="op" id="4166623">(</span><span class="op" id="4166624">)</span>&nbsp;<span class="builtintype" id="4166626">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4166638">{</span>&nbsp;<span class="keyword" id="4166640">return</span>&nbsp;<span class="ident" id="4166647">fi</span><span class="op" id="4166649">.</span><span class="ident" id="4166650">Mode</span><span class="op" id="4166654">(</span><span class="op" id="4166655">)</span><span class="op" id="4166656">.</span><span class="ident" id="4166657">IsDir</span><span class="op" id="4166662">(</span><span class="op" id="4166663">)</span>&nbsp;<span class="op" id="4166665">}</span><br>
<span class="lineno"></span><span class="keyword" id="4166667">func</span>&nbsp;<span class="op" id="4166672">(</span><span class="ident" id="4166673">fi</span>&nbsp;<span class="ident" id="4166676">headerFileInfo</span><span class="op" id="4166690">)</span>&nbsp;<span class="ident" id="4166692">ModTime</span><span class="op" id="4166699">(</span><span class="op" id="4166700">)</span>&nbsp;<span class="ident" id="4166702">time</span><span class="op" id="4166706">.</span><span class="ident" id="4166707">Time</span>&nbsp;<span class="op" id="4166712">{</span>&nbsp;<span class="keyword" id="4166714">return</span>&nbsp;<span class="ident" id="4166721">fi</span><span class="op" id="4166723">.</span><span class="ident" id="4166724">h</span><span class="op" id="4166725">.</span><span class="ident" id="4166726">ModTime</span>&nbsp;<span class="op" id="4166734">}</span><br>
<span class="lineno"></span><span class="keyword" id="4166736">func</span>&nbsp;<span class="op" id="4166741">(</span><span class="ident" id="4166742">fi</span>&nbsp;<span class="ident" id="4166745">headerFileInfo</span><span class="op" id="4166759">)</span>&nbsp;<span class="ident" id="4166761">Sys</span><span class="op" id="4166764">(</span><span class="op" id="4166765">)</span>&nbsp;<span class="keyword" id="4166767">interface</span><span class="op" id="4166776">{</span><span class="op" id="4166777">}</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4166781">{</span>&nbsp;<span class="keyword" id="4166783">return</span>&nbsp;<span class="ident" id="4166790">fi</span><span class="op" id="4166792">.</span><span class="ident" id="4166793">h</span>&nbsp;<span class="op" id="4166795">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4166798">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;base&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4166841">func</span>&nbsp;<span class="op" id="4166846">(</span><span class="ident" id="4166847">fi</span>&nbsp;<span class="ident" id="4166850">headerFileInfo</span><span class="op" id="4166864">)</span>&nbsp;<span class="ident" id="4166866">Name</span><span class="op" id="4166870">(</span><span class="op" id="4166871">)</span>&nbsp;<span class="builtintype" id="4166873">string</span>&nbsp;<span class="op" id="4166880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166883">if</span>&nbsp;<span class="ident" id="4166886">fi</span><span class="op" id="4166888">.</span><span class="ident" id="4166889">IsDir</span><span class="op" id="4166894">(</span><span class="op" id="4166895">)</span>&nbsp;<span class="op" id="4166897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166901">return</span>&nbsp;<span class="ident" id="4166908">path</span><span class="op" id="4166912">.</span><span class="ident" id="4166913">Base</span><span class="op" id="4166917">(</span><span class="ident" id="4166918">path</span><span class="op" id="4166922">.</span><span class="ident" id="4166923">Clean</span><span class="op" id="4166928">(</span><span class="ident" id="4166929">fi</span><span class="op" id="4166931">.</span><span class="ident" id="4166932">h</span><span class="op" id="4166933">.</span><span class="ident" id="4166934">Name</span><span class="op" id="4166938">)</span><span class="op" id="4166939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4166942">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4166945">return</span>&nbsp;<span class="ident" id="4166952">path</span><span class="op" id="4166956">.</span><span class="ident" id="4166957">Base</span><span class="op" id="4166961">(</span><span class="ident" id="4166962">fi</span><span class="op" id="4166964">.</span><span class="ident" id="4166965">h</span><span class="op" id="4166966">.</span><span class="ident" id="4166967">Name</span><span class="op" id="4166971">)</span><br>
<span class="lineno"></span><span class="op" id="4166973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4166976">//&nbsp;Mode&nbsp;returns&nbsp;the&nbsp;permission&nbsp;and&nbsp;mode&nbsp;bits&nbsp;for&nbsp;the&nbsp;headerFileInfo.</span><br>
<span class="lineno"></span><span class="keyword" id="4167045">func</span>&nbsp;<span class="op" id="4167050">(</span><span class="ident" id="4167051">fi</span>&nbsp;<span class="ident" id="4167054">headerFileInfo</span><span class="op" id="4167068">)</span>&nbsp;<span class="ident" id="4167070">Mode</span><span class="op" id="4167074">(</span><span class="op" id="4167075">)</span>&nbsp;<span class="op" id="4167077">(</span><span class="ident" id="4167078">mode</span>&nbsp;<span class="ident" id="4167083">os</span><span class="op" id="4167085">.</span><span class="ident" id="4167086">FileMode</span><span class="op" id="4167094">)</span>&nbsp;<span class="op" id="4167096">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167099">//&nbsp;Set&nbsp;file&nbsp;permission&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167129">mode</span>&nbsp;<span class="op" id="4167134">=</span>&nbsp;<span class="ident" id="4167136">os</span><span class="op" id="4167138">.</span><span class="ident" id="4167139">FileMode</span><span class="op" id="4167147">(</span><span class="ident" id="4167148">fi</span><span class="op" id="4167150">.</span><span class="ident" id="4167151">h</span><span class="op" id="4167152">.</span><span class="ident" id="4167153">Mode</span><span class="op" id="4167157">)</span><span class="op" id="4167158">.</span><span class="ident" id="4167159">Perm</span><span class="op" id="4167163">(</span><span class="op" id="4167164">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167168">//&nbsp;Set&nbsp;setuid,&nbsp;setgid&nbsp;and&nbsp;sticky&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167208">if</span>&nbsp;<span class="ident" id="4167211">fi</span><span class="op" id="4167213">.</span><span class="ident" id="4167214">h</span><span class="op" id="4167215">.</span><span class="ident" id="4167216">Mode</span><span class="op" id="4167220">&amp;</span><span class="ident" id="4167221">c_ISUID</span>&nbsp;<span class="op" id="4167229">!=</span>&nbsp;<span class="num" id="4167232">0</span>&nbsp;<span class="op" id="4167234">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167238">//&nbsp;setuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167250">mode</span>&nbsp;<span class="op" id="4167255">|=</span>&nbsp;<span class="ident" id="4167258">os</span><span class="op" id="4167260">.</span><span class="ident" id="4167261">ModeSetuid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167276">if</span>&nbsp;<span class="ident" id="4167279">fi</span><span class="op" id="4167281">.</span><span class="ident" id="4167282">h</span><span class="op" id="4167283">.</span><span class="ident" id="4167284">Mode</span><span class="op" id="4167288">&amp;</span><span class="ident" id="4167289">c_ISGID</span>&nbsp;<span class="op" id="4167297">!=</span>&nbsp;<span class="num" id="4167300">0</span>&nbsp;<span class="op" id="4167302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167306">//&nbsp;setgid</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167318">mode</span>&nbsp;<span class="op" id="4167323">|=</span>&nbsp;<span class="ident" id="4167326">os</span><span class="op" id="4167328">.</span><span class="ident" id="4167329">ModeSetgid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167344">if</span>&nbsp;<span class="ident" id="4167347">fi</span><span class="op" id="4167349">.</span><span class="ident" id="4167350">h</span><span class="op" id="4167351">.</span><span class="ident" id="4167352">Mode</span><span class="op" id="4167356">&amp;</span><span class="ident" id="4167357">c_ISVTX</span>&nbsp;<span class="op" id="4167365">!=</span>&nbsp;<span class="num" id="4167368">0</span>&nbsp;<span class="op" id="4167370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167374">//&nbsp;sticky</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167386">mode</span>&nbsp;<span class="op" id="4167391">|=</span>&nbsp;<span class="ident" id="4167394">os</span><span class="op" id="4167396">.</span><span class="ident" id="4167397">ModeSticky</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167413">//&nbsp;Set&nbsp;file&nbsp;mode&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167437">//&nbsp;clear&nbsp;perm,&nbsp;setuid,&nbsp;setgid&nbsp;and&nbsp;sticky&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167485">m</span>&nbsp;<span class="op" id="4167487">:=</span>&nbsp;<span class="ident" id="4167490">os</span><span class="op" id="4167492">.</span><span class="ident" id="4167493">FileMode</span><span class="op" id="4167501">(</span><span class="ident" id="4167502">fi</span><span class="op" id="4167504">.</span><span class="ident" id="4167505">h</span><span class="op" id="4167506">.</span><span class="ident" id="4167507">Mode</span><span class="op" id="4167511">)</span>&nbsp;<span class="op" id="4167513">&amp;^</span>&nbsp;<span class="num" id="4167516">07777</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167523">if</span>&nbsp;<span class="ident" id="4167526">m</span>&nbsp;<span class="op" id="4167528">==</span>&nbsp;<span class="ident" id="4167531">c_ISDIR</span>&nbsp;<span class="op" id="4167539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167543">//&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167558">mode</span>&nbsp;<span class="op" id="4167563">|=</span>&nbsp;<span class="ident" id="4167566">os</span><span class="op" id="4167568">.</span><span class="ident" id="4167569">ModeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167581">if</span>&nbsp;<span class="ident" id="4167584">m</span>&nbsp;<span class="op" id="4167586">==</span>&nbsp;<span class="ident" id="4167589">c_ISFIFO</span>&nbsp;<span class="op" id="4167598">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167602">//&nbsp;named&nbsp;pipe&nbsp;(FIFO)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167625">mode</span>&nbsp;<span class="op" id="4167630">|=</span>&nbsp;<span class="ident" id="4167633">os</span><span class="op" id="4167635">.</span><span class="ident" id="4167636">ModeNamedPipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167654">if</span>&nbsp;<span class="ident" id="4167657">m</span>&nbsp;<span class="op" id="4167659">==</span>&nbsp;<span class="ident" id="4167662">c_ISLNK</span>&nbsp;<span class="op" id="4167670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167674">//&nbsp;symbolic&nbsp;link</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167693">mode</span>&nbsp;<span class="op" id="4167698">|=</span>&nbsp;<span class="ident" id="4167701">os</span><span class="op" id="4167703">.</span><span class="ident" id="4167704">ModeSymlink</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167720">if</span>&nbsp;<span class="ident" id="4167723">m</span>&nbsp;<span class="op" id="4167725">==</span>&nbsp;<span class="ident" id="4167728">c_ISBLK</span>&nbsp;<span class="op" id="4167736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167740">//&nbsp;device&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167757">mode</span>&nbsp;<span class="op" id="4167762">|=</span>&nbsp;<span class="ident" id="4167765">os</span><span class="op" id="4167767">.</span><span class="ident" id="4167768">ModeDevice</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167783">if</span>&nbsp;<span class="ident" id="4167786">m</span>&nbsp;<span class="op" id="4167788">==</span>&nbsp;<span class="ident" id="4167791">c_ISCHR</span>&nbsp;<span class="op" id="4167799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167803">//&nbsp;Unix&nbsp;character&nbsp;device</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167830">mode</span>&nbsp;<span class="op" id="4167835">|=</span>&nbsp;<span class="ident" id="4167838">os</span><span class="op" id="4167840">.</span><span class="ident" id="4167841">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167854">mode</span>&nbsp;<span class="op" id="4167859">|=</span>&nbsp;<span class="ident" id="4167862">os</span><span class="op" id="4167864">.</span><span class="ident" id="4167865">ModeCharDevice</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167884">if</span>&nbsp;<span class="ident" id="4167887">m</span>&nbsp;<span class="op" id="4167889">==</span>&nbsp;<span class="ident" id="4167892">c_ISSOCK</span>&nbsp;<span class="op" id="4167901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4167905">//&nbsp;Unix&nbsp;domain&nbsp;socket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4167929">mode</span>&nbsp;<span class="op" id="4167934">|=</span>&nbsp;<span class="ident" id="4167937">os</span><span class="op" id="4167939">.</span><span class="ident" id="4167940">ModeSocket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4167952">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167956">switch</span>&nbsp;<span class="ident" id="4167963">fi</span><span class="op" id="4167965">.</span><span class="ident" id="4167966">h</span><span class="op" id="4167967">.</span><span class="ident" id="4167968">Typeflag</span>&nbsp;<span class="op" id="4167977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4167980">case</span>&nbsp;<span class="ident" id="4167985">TypeLink</span><span class="op" id="4167993">,</span>&nbsp;<span class="ident" id="4167995">TypeSymlink</span><span class="op" id="4168006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4168010">//&nbsp;hard&nbsp;link,&nbsp;symbolic&nbsp;link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168040">mode</span>&nbsp;<span class="op" id="4168045">|=</span>&nbsp;<span class="ident" id="4168048">os</span><span class="op" id="4168050">.</span><span class="ident" id="4168051">ModeSymlink</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168064">case</span>&nbsp;<span class="ident" id="4168069">TypeChar</span><span class="op" id="4168077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4168081">//&nbsp;character&nbsp;device&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168108">mode</span>&nbsp;<span class="op" id="4168113">|=</span>&nbsp;<span class="ident" id="4168116">os</span><span class="op" id="4168118">.</span><span class="ident" id="4168119">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168132">mode</span>&nbsp;<span class="op" id="4168137">|=</span>&nbsp;<span class="ident" id="4168140">os</span><span class="op" id="4168142">.</span><span class="ident" id="4168143">ModeCharDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168159">case</span>&nbsp;<span class="ident" id="4168164">TypeBlock</span><span class="op" id="4168173">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4168177">//&nbsp;block&nbsp;device&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168200">mode</span>&nbsp;<span class="op" id="4168205">|=</span>&nbsp;<span class="ident" id="4168208">os</span><span class="op" id="4168210">.</span><span class="ident" id="4168211">ModeDevice</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168223">case</span>&nbsp;<span class="ident" id="4168228">TypeDir</span><span class="op" id="4168235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4168239">//&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168254">mode</span>&nbsp;<span class="op" id="4168259">|=</span>&nbsp;<span class="ident" id="4168262">os</span><span class="op" id="4168264">.</span><span class="ident" id="4168265">ModeDir</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168274">case</span>&nbsp;<span class="ident" id="4168279">TypeFifo</span><span class="op" id="4168287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4168291">//&nbsp;fifo&nbsp;node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168306">mode</span>&nbsp;<span class="op" id="4168311">|=</span>&nbsp;<span class="ident" id="4168314">os</span><span class="op" id="4168316">.</span><span class="ident" id="4168317">ModeNamedPipe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4168332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168336">return</span>&nbsp;<span class="ident" id="4168343">mode</span><br>
<span class="lineno"></span><span class="op" id="4168348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4168351">//&nbsp;sysStat,&nbsp;if&nbsp;non-nil,&nbsp;populates&nbsp;h&nbsp;from&nbsp;system-dependent&nbsp;fields&nbsp;of&nbsp;fi.</span><br>
<span class="lineno"></span><span class="keyword" id="4168423">var</span>&nbsp;<span class="ident" id="4168427">sysStat</span>&nbsp;<span class="keyword" id="4168435">func</span><span class="op" id="4168439">(</span><span class="ident" id="4168440">fi</span>&nbsp;<span class="ident" id="4168443">os</span><span class="op" id="4168445">.</span><span class="ident" id="4168446">FileInfo</span><span class="op" id="4168454">,</span>&nbsp;<span class="ident" id="4168456">h</span>&nbsp;<span class="op" id="4168458">*</span><span class="ident" id="4168459">Header</span><span class="op" id="4168465">)</span>&nbsp;<span class="builtintype" id="4168467">error</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="4168474">//&nbsp;Mode&nbsp;constants&nbsp;from&nbsp;the&nbsp;tar&nbsp;spec.</span><br>
<span class="lineno"></span><span class="keyword" id="4168511">const</span>&nbsp;<span class="op" id="4168517">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168520">c_ISUID</span>&nbsp;&nbsp;<span class="op" id="4168529">=</span>&nbsp;<span class="num" id="4168531">04000</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4168539">//&nbsp;Set&nbsp;uid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168551">c_ISGID</span>&nbsp;&nbsp;<span class="op" id="4168560">=</span>&nbsp;<span class="num" id="4168562">02000</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4168570">//&nbsp;Set&nbsp;gid</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168582">c_ISVTX</span>&nbsp;&nbsp;<span class="op" id="4168591">=</span>&nbsp;<span class="num" id="4168593">01000</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4168601">//&nbsp;Save&nbsp;text&nbsp;(sticky&nbsp;bit)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168628">c_ISDIR</span>&nbsp;&nbsp;<span class="op" id="4168637">=</span>&nbsp;<span class="num" id="4168639">040000</span>&nbsp;&nbsp;<span class="comment" id="4168647">//&nbsp;Directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168661">c_ISFIFO</span>&nbsp;<span class="op" id="4168670">=</span>&nbsp;<span class="num" id="4168672">010000</span>&nbsp;&nbsp;<span class="comment" id="4168680">//&nbsp;FIFO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168689">c_ISREG</span>&nbsp;&nbsp;<span class="op" id="4168698">=</span>&nbsp;<span class="num" id="4168700">0100000</span>&nbsp;<span class="comment" id="4168708">//&nbsp;Regular&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168725">c_ISLNK</span>&nbsp;&nbsp;<span class="op" id="4168734">=</span>&nbsp;<span class="num" id="4168736">0120000</span>&nbsp;<span class="comment" id="4168744">//&nbsp;Symbolic&nbsp;link</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168762">c_ISBLK</span>&nbsp;&nbsp;<span class="op" id="4168771">=</span>&nbsp;<span class="num" id="4168773">060000</span>&nbsp;&nbsp;<span class="comment" id="4168781">//&nbsp;Block&nbsp;special&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168804">c_ISCHR</span>&nbsp;&nbsp;<span class="op" id="4168813">=</span>&nbsp;<span class="num" id="4168815">020000</span>&nbsp;&nbsp;<span class="comment" id="4168823">//&nbsp;Character&nbsp;special&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168850">c_ISSOCK</span>&nbsp;<span class="op" id="4168859">=</span>&nbsp;<span class="num" id="4168861">0140000</span>&nbsp;<span class="comment" id="4168869">//&nbsp;Socket</span><br>
<span class="lineno"></span><span class="op" id="4168879">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4168882">//&nbsp;Keywords&nbsp;for&nbsp;the&nbsp;PAX&nbsp;Extended&nbsp;Header</span><br>
<span class="lineno"></span><span class="keyword" id="4168922">const</span>&nbsp;<span class="op" id="4168928">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168931">paxAtime</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4168943">=</span>&nbsp;<span class="string" id="4168945">&#34;atime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168954">paxCharset</span>&nbsp;&nbsp;<span class="op" id="4168966">=</span>&nbsp;<span class="string" id="4168968">&#34;charset&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168979">paxComment</span>&nbsp;&nbsp;<span class="op" id="4168991">=</span>&nbsp;<span class="string" id="4168993">&#34;comment&#34;</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169004">paxCtime</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169016">=</span>&nbsp;<span class="string" id="4169018">&#34;ctime&#34;</span>&nbsp;<span class="comment" id="4169026">//&nbsp;please&nbsp;note&nbsp;that&nbsp;ctime&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;pax&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169080">paxGid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169092">=</span>&nbsp;<span class="string" id="4169094">&#34;gid&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169101">paxGname</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169113">=</span>&nbsp;<span class="string" id="4169115">&#34;gname&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169124">paxLinkpath</span>&nbsp;<span class="op" id="4169136">=</span>&nbsp;<span class="string" id="4169138">&#34;linkpath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169150">paxMtime</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169162">=</span>&nbsp;<span class="string" id="4169164">&#34;mtime&#34;</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169173">paxPath</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169185">=</span>&nbsp;<span class="string" id="4169187">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169195">paxSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169207">=</span>&nbsp;<span class="string" id="4169209">&#34;size&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169217">paxUid</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169229">=</span>&nbsp;<span class="string" id="4169231">&#34;uid&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169238">paxUname</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169250">=</span>&nbsp;<span class="string" id="4169252">&#34;uname&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169261">paxXattr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169273">=</span>&nbsp;<span class="string" id="4169275">&#34;SCHILY.xattr.&#34;</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169292">paxNone</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4169304">=</span>&nbsp;<span class="string" id="4169306">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="4169309">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4169312">//&nbsp;FileInfoHeader&nbsp;creates&nbsp;a&nbsp;partially-populated&nbsp;Header&nbsp;from&nbsp;fi.</span><br>
<span class="lineno"></span><span class="comment" id="4169376">//&nbsp;If&nbsp;fi&nbsp;describes&nbsp;a&nbsp;symlink,&nbsp;FileInfoHeader&nbsp;records&nbsp;link&nbsp;as&nbsp;the&nbsp;link&nbsp;target.</span><br>
<span class="lineno">200</span><span class="comment" id="4169454">//&nbsp;If&nbsp;fi&nbsp;describes&nbsp;a&nbsp;directory,&nbsp;a&nbsp;slash&nbsp;is&nbsp;appended&nbsp;to&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4169519">//&nbsp;Because&nbsp;os.FileInfo&#39;s&nbsp;Name&nbsp;method&nbsp;returns&nbsp;only&nbsp;the&nbsp;base&nbsp;name&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4169586">//&nbsp;the&nbsp;file&nbsp;it&nbsp;describes,&nbsp;it&nbsp;may&nbsp;be&nbsp;necessary&nbsp;to&nbsp;modify&nbsp;the&nbsp;Name&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="4169657">//&nbsp;of&nbsp;the&nbsp;returned&nbsp;header&nbsp;to&nbsp;provide&nbsp;the&nbsp;full&nbsp;path&nbsp;name&nbsp;of&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4169726">func</span>&nbsp;<span class="ident" id="4169731">FileInfoHeader</span><span class="op" id="4169745">(</span><span class="ident" id="4169746">fi</span>&nbsp;<span class="ident" id="4169749">os</span><span class="op" id="4169751">.</span><span class="ident" id="4169752">FileInfo</span><span class="op" id="4169760">,</span>&nbsp;<span class="ident" id="4169762">link</span>&nbsp;<span class="builtintype" id="4169767">string</span><span class="op" id="4169773">)</span>&nbsp;<span class="op" id="4169775">(</span><span class="op" id="4169776">*</span><span class="ident" id="4169777">Header</span><span class="op" id="4169783">,</span>&nbsp;<span class="builtintype" id="4169785">error</span><span class="op" id="4169790">)</span>&nbsp;<span class="op" id="4169792">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169795">if</span>&nbsp;<span class="ident" id="4169798">fi</span>&nbsp;<span class="op" id="4169801">==</span>&nbsp;<span class="ident" id="4169804">nil</span>&nbsp;<span class="op" id="4169808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4169812">return</span>&nbsp;<span class="ident" id="4169819">nil</span><span class="op" id="4169822">,</span>&nbsp;<span class="ident" id="4169824">errors</span><span class="op" id="4169830">.</span><span class="ident" id="4169831">New</span><span class="op" id="4169834">(</span><span class="string" id="4169835">&#34;tar:&nbsp;FileInfo&nbsp;is&nbsp;nil&#34;</span><span class="op" id="4169857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4169860">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169863">fm</span>&nbsp;<span class="op" id="4169866">:=</span>&nbsp;<span class="ident" id="4169869">fi</span><span class="op" id="4169871">.</span><span class="ident" id="4169872">Mode</span><span class="op" id="4169876">(</span><span class="op" id="4169877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169880">h</span>&nbsp;<span class="op" id="4169882">:=</span>&nbsp;<span class="op" id="4169885">&amp;</span><span class="ident" id="4169886">Header</span><span class="op" id="4169892">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169896">Name</span><span class="op" id="4169900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169905">fi</span><span class="op" id="4169907">.</span><span class="ident" id="4169908">Name</span><span class="op" id="4169912">(</span><span class="op" id="4169913">)</span><span class="op" id="4169914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169918">ModTime</span><span class="op" id="4169925">:</span>&nbsp;<span class="ident" id="4169927">fi</span><span class="op" id="4169929">.</span><span class="ident" id="4169930">ModTime</span><span class="op" id="4169937">(</span><span class="op" id="4169938">)</span><span class="op" id="4169939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4169943">Mode</span><span class="op" id="4169947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4169952">int64</span><span class="op" id="4169957">(</span><span class="ident" id="4169958">fm</span><span class="op" id="4169960">.</span><span class="ident" id="4169961">Perm</span><span class="op" id="4169965">(</span><span class="op" id="4169966">)</span><span class="op" id="4169967">)</span><span class="op" id="4169968">,</span>&nbsp;<span class="comment" id="4169970">//&nbsp;or&#39;d&nbsp;with&nbsp;c_IS*&nbsp;constants&nbsp;later</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170009">switch</span>&nbsp;<span class="op" id="4170016">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170019">case</span>&nbsp;<span class="ident" id="4170024">fm</span><span class="op" id="4170026">.</span><span class="ident" id="4170027">IsRegular</span><span class="op" id="4170036">(</span><span class="op" id="4170037">)</span><span class="op" id="4170038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170042">h</span><span class="op" id="4170043">.</span><span class="ident" id="4170044">Mode</span>&nbsp;<span class="op" id="4170049">|=</span>&nbsp;<span class="ident" id="4170052">c_ISREG</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170062">h</span><span class="op" id="4170063">.</span><span class="ident" id="4170064">Typeflag</span>&nbsp;<span class="op" id="4170073">=</span>&nbsp;<span class="ident" id="4170075">TypeReg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170085">h</span><span class="op" id="4170086">.</span><span class="ident" id="4170087">Size</span>&nbsp;<span class="op" id="4170092">=</span>&nbsp;<span class="ident" id="4170094">fi</span><span class="op" id="4170096">.</span><span class="ident" id="4170097">Size</span><span class="op" id="4170101">(</span><span class="op" id="4170102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170105">case</span>&nbsp;<span class="ident" id="4170110">fi</span><span class="op" id="4170112">.</span><span class="ident" id="4170113">IsDir</span><span class="op" id="4170118">(</span><span class="op" id="4170119">)</span><span class="op" id="4170120">:</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170124">h</span><span class="op" id="4170125">.</span><span class="ident" id="4170126">Typeflag</span>&nbsp;<span class="op" id="4170135">=</span>&nbsp;<span class="ident" id="4170137">TypeDir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170147">h</span><span class="op" id="4170148">.</span><span class="ident" id="4170149">Mode</span>&nbsp;<span class="op" id="4170154">|=</span>&nbsp;<span class="ident" id="4170157">c_ISDIR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170167">h</span><span class="op" id="4170168">.</span><span class="ident" id="4170169">Name</span>&nbsp;<span class="op" id="4170174">+=</span>&nbsp;<span class="string" id="4170177">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170182">case</span>&nbsp;<span class="ident" id="4170187">fm</span><span class="op" id="4170189">&amp;</span><span class="ident" id="4170190">os</span><span class="op" id="4170192">.</span><span class="ident" id="4170193">ModeSymlink</span>&nbsp;<span class="op" id="4170205">!=</span>&nbsp;<span class="num" id="4170208">0</span><span class="op" id="4170209">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170213">h</span><span class="op" id="4170214">.</span><span class="ident" id="4170215">Typeflag</span>&nbsp;<span class="op" id="4170224">=</span>&nbsp;<span class="ident" id="4170226">TypeSymlink</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170240">h</span><span class="op" id="4170241">.</span><span class="ident" id="4170242">Mode</span>&nbsp;<span class="op" id="4170247">|=</span>&nbsp;<span class="ident" id="4170250">c_ISLNK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170260">h</span><span class="op" id="4170261">.</span><span class="ident" id="4170262">Linkname</span>&nbsp;<span class="op" id="4170271">=</span>&nbsp;<span class="ident" id="4170273">link</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170279">case</span>&nbsp;<span class="ident" id="4170284">fm</span><span class="op" id="4170286">&amp;</span><span class="ident" id="4170287">os</span><span class="op" id="4170289">.</span><span class="ident" id="4170290">ModeDevice</span>&nbsp;<span class="op" id="4170301">!=</span>&nbsp;<span class="num" id="4170304">0</span><span class="op" id="4170305">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170309">if</span>&nbsp;<span class="ident" id="4170312">fm</span><span class="op" id="4170314">&amp;</span><span class="ident" id="4170315">os</span><span class="op" id="4170317">.</span><span class="ident" id="4170318">ModeCharDevice</span>&nbsp;<span class="op" id="4170333">!=</span>&nbsp;<span class="num" id="4170336">0</span>&nbsp;<span class="op" id="4170338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170343">h</span><span class="op" id="4170344">.</span><span class="ident" id="4170345">Mode</span>&nbsp;<span class="op" id="4170350">|=</span>&nbsp;<span class="ident" id="4170353">c_ISCHR</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170364">h</span><span class="op" id="4170365">.</span><span class="ident" id="4170366">Typeflag</span>&nbsp;<span class="op" id="4170375">=</span>&nbsp;<span class="ident" id="4170377">TypeChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170388">}</span>&nbsp;<span class="keyword" id="4170390">else</span>&nbsp;<span class="op" id="4170395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170400">h</span><span class="op" id="4170401">.</span><span class="ident" id="4170402">Mode</span>&nbsp;<span class="op" id="4170407">|=</span>&nbsp;<span class="ident" id="4170410">c_ISBLK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170421">h</span><span class="op" id="4170422">.</span><span class="ident" id="4170423">Typeflag</span>&nbsp;<span class="op" id="4170432">=</span>&nbsp;<span class="ident" id="4170434">TypeBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170446">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170449">case</span>&nbsp;<span class="ident" id="4170454">fm</span><span class="op" id="4170456">&amp;</span><span class="ident" id="4170457">os</span><span class="op" id="4170459">.</span><span class="ident" id="4170460">ModeNamedPipe</span>&nbsp;<span class="op" id="4170474">!=</span>&nbsp;<span class="num" id="4170477">0</span><span class="op" id="4170478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170482">h</span><span class="op" id="4170483">.</span><span class="ident" id="4170484">Typeflag</span>&nbsp;<span class="op" id="4170493">=</span>&nbsp;<span class="ident" id="4170495">TypeFifo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170506">h</span><span class="op" id="4170507">.</span><span class="ident" id="4170508">Mode</span>&nbsp;<span class="op" id="4170513">|=</span>&nbsp;<span class="ident" id="4170516">c_ISFIFO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170526">case</span>&nbsp;<span class="ident" id="4170531">fm</span><span class="op" id="4170533">&amp;</span><span class="ident" id="4170534">os</span><span class="op" id="4170536">.</span><span class="ident" id="4170537">ModeSocket</span>&nbsp;<span class="op" id="4170548">!=</span>&nbsp;<span class="num" id="4170551">0</span><span class="op" id="4170552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170556">h</span><span class="op" id="4170557">.</span><span class="ident" id="4170558">Mode</span>&nbsp;<span class="op" id="4170563">|=</span>&nbsp;<span class="ident" id="4170566">c_ISSOCK</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170576">default</span><span class="op" id="4170583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170587">return</span>&nbsp;<span class="ident" id="4170594">nil</span><span class="op" id="4170597">,</span>&nbsp;<span class="ident" id="4170599">fmt</span><span class="op" id="4170602">.</span><span class="ident" id="4170603">Errorf</span><span class="op" id="4170609">(</span><span class="string" id="4170610">&#34;archive/tar:&nbsp;unknown&nbsp;file&nbsp;mode&nbsp;%v&#34;</span><span class="op" id="4170645">,</span>&nbsp;<span class="ident" id="4170647">fm</span><span class="op" id="4170649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170655">if</span>&nbsp;<span class="ident" id="4170658">fm</span><span class="op" id="4170660">&amp;</span><span class="ident" id="4170661">os</span><span class="op" id="4170663">.</span><span class="ident" id="4170664">ModeSetuid</span>&nbsp;<span class="op" id="4170675">!=</span>&nbsp;<span class="num" id="4170678">0</span>&nbsp;<span class="op" id="4170680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170684">h</span><span class="op" id="4170685">.</span><span class="ident" id="4170686">Mode</span>&nbsp;<span class="op" id="4170691">|=</span>&nbsp;<span class="ident" id="4170694">c_ISUID</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170703">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170706">if</span>&nbsp;<span class="ident" id="4170709">fm</span><span class="op" id="4170711">&amp;</span><span class="ident" id="4170712">os</span><span class="op" id="4170714">.</span><span class="ident" id="4170715">ModeSetgid</span>&nbsp;<span class="op" id="4170726">!=</span>&nbsp;<span class="num" id="4170729">0</span>&nbsp;<span class="op" id="4170731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170735">h</span><span class="op" id="4170736">.</span><span class="ident" id="4170737">Mode</span>&nbsp;<span class="op" id="4170742">|=</span>&nbsp;<span class="ident" id="4170745">c_ISGID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170757">if</span>&nbsp;<span class="ident" id="4170760">fm</span><span class="op" id="4170762">&amp;</span><span class="ident" id="4170763">os</span><span class="op" id="4170765">.</span><span class="ident" id="4170766">ModeSticky</span>&nbsp;<span class="op" id="4170777">!=</span>&nbsp;<span class="num" id="4170780">0</span>&nbsp;<span class="op" id="4170782">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4170786">h</span><span class="op" id="4170787">.</span><span class="ident" id="4170788">Mode</span>&nbsp;<span class="op" id="4170793">|=</span>&nbsp;<span class="ident" id="4170796">c_ISVTX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170808">if</span>&nbsp;<span class="ident" id="4170811">sysStat</span>&nbsp;<span class="op" id="4170819">!=</span>&nbsp;<span class="ident" id="4170822">nil</span>&nbsp;<span class="op" id="4170826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170830">return</span>&nbsp;<span class="ident" id="4170837">h</span><span class="op" id="4170838">,</span>&nbsp;<span class="ident" id="4170840">sysStat</span><span class="op" id="4170847">(</span><span class="ident" id="4170848">fi</span><span class="op" id="4170850">,</span>&nbsp;<span class="ident" id="4170852">h</span><span class="op" id="4170853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4170856">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4170859">return</span>&nbsp;<span class="ident" id="4170866">h</span><span class="op" id="4170867">,</span>&nbsp;<span class="ident" id="4170869">nil</span><br>
<span class="lineno"></span><span class="op" id="4170873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4170876">var</span>&nbsp;<span class="ident" id="4170880">zeroBlock</span>&nbsp;<span class="op" id="4170890">=</span>&nbsp;<span class="builtinfunc" id="4170892">make</span><span class="op" id="4170896">(</span><span class="op" id="4170897">[</span><span class="op" id="4170898">]</span><span class="builtintype" id="4170899">byte</span><span class="op" id="4170903">,</span>&nbsp;<span class="ident" id="4170905">blockSize</span><span class="op" id="4170914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4170917">//&nbsp;POSIX&nbsp;specifies&nbsp;a&nbsp;sum&nbsp;of&nbsp;the&nbsp;unsigned&nbsp;byte&nbsp;values,&nbsp;but&nbsp;the&nbsp;Sun&nbsp;tar&nbsp;uses&nbsp;signed&nbsp;byte&nbsp;values.</span><br>
<span class="lineno"></span><span class="comment" id="4171012">//&nbsp;We&nbsp;compute&nbsp;and&nbsp;return&nbsp;both.</span><br>
<span class="lineno"></span><span class="keyword" id="4171043">func</span>&nbsp;<span class="ident" id="4171048">checksum</span><span class="op" id="4171056">(</span><span class="ident" id="4171057">header</span>&nbsp;<span class="op" id="4171064">[</span><span class="op" id="4171065">]</span><span class="builtintype" id="4171066">byte</span><span class="op" id="4171070">)</span>&nbsp;<span class="op" id="4171072">(</span><span class="ident" id="4171073">unsigned</span>&nbsp;<span class="ident" id="4171082">int64</span><span class="op" id="4171087">,</span>&nbsp;<span class="ident" id="4171089">signed</span>&nbsp;<span class="ident" id="4171096">int64</span><span class="op" id="4171101">)</span>&nbsp;<span class="op" id="4171103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171106">for</span>&nbsp;<span class="ident" id="4171110">i</span>&nbsp;<span class="op" id="4171112">:=</span>&nbsp;<span class="num" id="4171115">0</span><span class="op" id="4171116">;</span>&nbsp;<span class="ident" id="4171118">i</span>&nbsp;<span class="op" id="4171120">&lt;</span>&nbsp;<span class="builtinfunc" id="4171122">len</span><span class="op" id="4171125">(</span><span class="ident" id="4171126">header</span><span class="op" id="4171132">)</span><span class="op" id="4171133">;</span>&nbsp;<span class="ident" id="4171135">i</span><span class="op" id="4171136">++</span>&nbsp;<span class="op" id="4171139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171143">if</span>&nbsp;<span class="ident" id="4171146">i</span>&nbsp;<span class="op" id="4171148">==</span>&nbsp;<span class="num" id="4171151">148</span>&nbsp;<span class="op" id="4171155">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4171160">//&nbsp;The&nbsp;chksum&nbsp;field&nbsp;(header[148:156])&nbsp;is&nbsp;special:&nbsp;it&nbsp;should&nbsp;be&nbsp;treated&nbsp;as&nbsp;space&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171250">unsigned</span>&nbsp;<span class="op" id="4171259">+=</span>&nbsp;<span class="string" id="4171262">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4171266">*</span>&nbsp;<span class="num" id="4171268">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171273">signed</span>&nbsp;<span class="op" id="4171280">+=</span>&nbsp;<span class="string" id="4171283">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4171287">*</span>&nbsp;<span class="num" id="4171289">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171294">i</span>&nbsp;<span class="op" id="4171296">+=</span>&nbsp;<span class="num" id="4171299">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171304">continue</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171319">unsigned</span>&nbsp;<span class="op" id="4171328">+=</span>&nbsp;<span class="ident" id="4171331">int64</span><span class="op" id="4171336">(</span><span class="ident" id="4171337">header</span><span class="op" id="4171343">[</span><span class="ident" id="4171344">i</span><span class="op" id="4171345">]</span><span class="op" id="4171346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171350">signed</span>&nbsp;<span class="op" id="4171357">+=</span>&nbsp;<span class="ident" id="4171360">int64</span><span class="op" id="4171365">(</span><span class="builtintype" id="4171366">int8</span><span class="op" id="4171370">(</span><span class="ident" id="4171371">header</span><span class="op" id="4171377">[</span><span class="ident" id="4171378">i</span><span class="op" id="4171379">]</span><span class="op" id="4171380">)</span><span class="op" id="4171381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171387">return</span><br>
<span class="lineno">275</span><span class="op" id="4171394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171397">type</span>&nbsp;<span class="ident" id="4171402">slicer</span>&nbsp;<span class="op" id="4171409">[</span><span class="op" id="4171410">]</span><span class="builtintype" id="4171411">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171417">func</span>&nbsp;<span class="op" id="4171422">(</span><span class="ident" id="4171423">sp</span>&nbsp;<span class="op" id="4171426">*</span><span class="ident" id="4171427">slicer</span><span class="op" id="4171433">)</span>&nbsp;<span class="ident" id="4171435">next</span><span class="op" id="4171439">(</span><span class="ident" id="4171440">n</span>&nbsp;<span class="builtintype" id="4171442">int</span><span class="op" id="4171445">)</span>&nbsp;<span class="op" id="4171447">(</span><span class="ident" id="4171448">b</span>&nbsp;<span class="op" id="4171450">[</span><span class="op" id="4171451">]</span><span class="builtintype" id="4171452">byte</span><span class="op" id="4171456">)</span>&nbsp;<span class="op" id="4171458">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171461">s</span>&nbsp;<span class="op" id="4171463">:=</span>&nbsp;<span class="op" id="4171466">*</span><span class="ident" id="4171467">sp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171471">b</span><span class="op" id="4171472">,</span>&nbsp;<span class="op" id="4171474">*</span><span class="ident" id="4171475">sp</span>&nbsp;<span class="op" id="4171478">=</span>&nbsp;<span class="ident" id="4171480">s</span><span class="op" id="4171481">[</span><span class="num" id="4171482">0</span><span class="op" id="4171483">:</span><span class="ident" id="4171484">n</span><span class="op" id="4171485">]</span><span class="op" id="4171486">,</span>&nbsp;<span class="ident" id="4171488">s</span><span class="op" id="4171489">[</span><span class="ident" id="4171490">n</span><span class="op" id="4171491">:</span><span class="op" id="4171492">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171495">return</span><br>
<span class="lineno"></span><span class="op" id="4171502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4171505">func</span>&nbsp;<span class="ident" id="4171510">isASCII</span><span class="op" id="4171517">(</span><span class="ident" id="4171518">s</span>&nbsp;<span class="builtintype" id="4171520">string</span><span class="op" id="4171526">)</span>&nbsp;<span class="builtintype" id="4171528">bool</span>&nbsp;<span class="op" id="4171533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171536">for</span>&nbsp;<span class="ident" id="4171540">_</span><span class="op" id="4171541">,</span>&nbsp;<span class="ident" id="4171543">c</span>&nbsp;<span class="op" id="4171545">:=</span>&nbsp;<span class="keyword" id="4171548">range</span>&nbsp;<span class="ident" id="4171554">s</span>&nbsp;<span class="op" id="4171556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171560">if</span>&nbsp;<span class="ident" id="4171563">c</span>&nbsp;<span class="op" id="4171565">&gt;=</span>&nbsp;<span class="num" id="4171568">0x80</span>&nbsp;<span class="op" id="4171573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171578">return</span>&nbsp;<span class="builtintype" id="4171585">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171593">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171599">return</span>&nbsp;<span class="builtintype" id="4171606">true</span><br>
<span class="lineno"></span><span class="op" id="4171611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4171614">func</span>&nbsp;<span class="ident" id="4171619">toASCII</span><span class="op" id="4171626">(</span><span class="ident" id="4171627">s</span>&nbsp;<span class="builtintype" id="4171629">string</span><span class="op" id="4171635">)</span>&nbsp;<span class="builtintype" id="4171637">string</span>&nbsp;<span class="op" id="4171644">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171647">if</span>&nbsp;<span class="ident" id="4171650">isASCII</span><span class="op" id="4171657">(</span><span class="ident" id="4171658">s</span><span class="op" id="4171659">)</span>&nbsp;<span class="op" id="4171661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171665">return</span>&nbsp;<span class="ident" id="4171672">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171678">var</span>&nbsp;<span class="ident" id="4171682">buf</span>&nbsp;<span class="ident" id="4171686">bytes</span><span class="op" id="4171691">.</span><span class="ident" id="4171692">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171700">for</span>&nbsp;<span class="ident" id="4171704">_</span><span class="op" id="4171705">,</span>&nbsp;<span class="ident" id="4171707">c</span>&nbsp;<span class="op" id="4171709">:=</span>&nbsp;<span class="keyword" id="4171712">range</span>&nbsp;<span class="ident" id="4171718">s</span>&nbsp;<span class="op" id="4171720">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171724">if</span>&nbsp;<span class="ident" id="4171727">c</span>&nbsp;<span class="op" id="4171729">&lt;</span>&nbsp;<span class="num" id="4171731">0x80</span>&nbsp;<span class="op" id="4171736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4171741">buf</span><span class="op" id="4171744">.</span><span class="ident" id="4171745">WriteByte</span><span class="op" id="4171754">(</span><span class="builtintype" id="4171755">byte</span><span class="op" id="4171759">(</span><span class="ident" id="4171760">c</span><span class="op" id="4171761">)</span><span class="op" id="4171762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4171769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4171772">return</span>&nbsp;<span class="ident" id="4171779">buf</span><span class="op" id="4171782">.</span><span class="ident" id="4171783">String</span><span class="op" id="4171789">(</span><span class="op" id="4171790">)</span><br>
<span class="lineno">305</span><span class="op" id="4171792">}</span>
</div>
</body>
</html>
