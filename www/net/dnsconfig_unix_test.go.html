<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7419884">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7419939">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7419993">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="7420044">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420109">package</span>&nbsp;<span class="ident" id="7420117">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420122">import</span>&nbsp;<span class="op" id="7420129">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7420132">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7420143">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7420153">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420156">var</span>&nbsp;<span class="ident" id="7420160">dnsReadConfigTests</span>&nbsp;<span class="op" id="7420179">=</span>&nbsp;<span class="op" id="7420181">[</span><span class="op" id="7420182">]</span><span class="keyword" id="7420183">struct</span>&nbsp;<span class="op" id="7420190">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420193">name</span>&nbsp;<span class="builtintype" id="7420198">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420206">conf</span>&nbsp;<span class="ident" id="7420211">dnsConfig</span><br>
<span class="lineno"></span><span class="op" id="7420221">}</span><span class="op" id="7420222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420229">name</span><span class="op" id="7420233">:</span>&nbsp;<span class="string" id="7420235">&#34;testdata/resolv.conf&#34;</span><span class="op" id="7420257">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420261">conf</span><span class="op" id="7420265">:</span>&nbsp;<span class="ident" id="7420267">dnsConfig</span><span class="op" id="7420276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420281">servers</span><span class="op" id="7420288">:</span>&nbsp;&nbsp;<span class="op" id="7420291">[</span><span class="op" id="7420292">]</span><span class="builtintype" id="7420293">string</span><span class="op" id="7420299">{</span><span class="string" id="7420300">&#34;8.8.8.8&#34;</span><span class="op" id="7420309">,</span>&nbsp;<span class="string" id="7420311">&#34;2001:4860:4860::8888&#34;</span><span class="op" id="7420333">,</span>&nbsp;<span class="string" id="7420335">&#34;fe80::1%lo0&#34;</span><span class="op" id="7420348">}</span><span class="op" id="7420349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420354">search</span><span class="op" id="7420360">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7420364">[</span><span class="op" id="7420365">]</span><span class="builtintype" id="7420366">string</span><span class="op" id="7420372">{</span><span class="string" id="7420373">&#34;localdomain&#34;</span><span class="op" id="7420386">}</span><span class="op" id="7420387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420392">ndots</span><span class="op" id="7420397">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7420402">5</span><span class="op" id="7420403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420408">timeout</span><span class="op" id="7420415">:</span>&nbsp;&nbsp;<span class="num" id="7420418">10</span><span class="op" id="7420420">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420425">attempts</span><span class="op" id="7420433">:</span>&nbsp;<span class="num" id="7420435">3</span><span class="op" id="7420436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420441">rotate</span><span class="op" id="7420447">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7420451">true</span><span class="op" id="7420455">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420459">}</span><span class="op" id="7420460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420463">}</span><span class="op" id="7420464">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420467">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420471">name</span><span class="op" id="7420475">:</span>&nbsp;<span class="string" id="7420477">&#34;testdata/domain-resolv.conf&#34;</span><span class="op" id="7420506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420510">conf</span><span class="op" id="7420514">:</span>&nbsp;<span class="ident" id="7420516">dnsConfig</span><span class="op" id="7420525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420530">servers</span><span class="op" id="7420537">:</span>&nbsp;&nbsp;<span class="op" id="7420540">[</span><span class="op" id="7420541">]</span><span class="builtintype" id="7420542">string</span><span class="op" id="7420548">{</span><span class="string" id="7420549">&#34;8.8.8.8&#34;</span><span class="op" id="7420558">}</span><span class="op" id="7420559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420564">search</span><span class="op" id="7420570">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7420574">[</span><span class="op" id="7420575">]</span><span class="builtintype" id="7420576">string</span><span class="op" id="7420582">{</span><span class="string" id="7420583">&#34;localdomain&#34;</span><span class="op" id="7420596">}</span><span class="op" id="7420597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420602">ndots</span><span class="op" id="7420607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7420612">1</span><span class="op" id="7420613">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420618">timeout</span><span class="op" id="7420625">:</span>&nbsp;&nbsp;<span class="num" id="7420628">5</span><span class="op" id="7420629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420634">attempts</span><span class="op" id="7420642">:</span>&nbsp;<span class="num" id="7420644">2</span><span class="op" id="7420645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420649">}</span><span class="op" id="7420650">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420653">}</span><span class="op" id="7420654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420657">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420661">name</span><span class="op" id="7420665">:</span>&nbsp;<span class="string" id="7420667">&#34;testdata/search-resolv.conf&#34;</span><span class="op" id="7420696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420700">conf</span><span class="op" id="7420704">:</span>&nbsp;<span class="ident" id="7420706">dnsConfig</span><span class="op" id="7420715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420720">servers</span><span class="op" id="7420727">:</span>&nbsp;&nbsp;<span class="op" id="7420730">[</span><span class="op" id="7420731">]</span><span class="builtintype" id="7420732">string</span><span class="op" id="7420738">{</span><span class="string" id="7420739">&#34;8.8.8.8&#34;</span><span class="op" id="7420748">}</span><span class="op" id="7420749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420754">search</span><span class="op" id="7420760">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7420764">[</span><span class="op" id="7420765">]</span><span class="builtintype" id="7420766">string</span><span class="op" id="7420772">{</span><span class="string" id="7420773">&#34;test&#34;</span><span class="op" id="7420779">,</span>&nbsp;<span class="string" id="7420781">&#34;invalid&#34;</span><span class="op" id="7420790">}</span><span class="op" id="7420791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420796">ndots</span><span class="op" id="7420801">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7420806">1</span><span class="op" id="7420807">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420812">timeout</span><span class="op" id="7420819">:</span>&nbsp;&nbsp;<span class="num" id="7420822">5</span><span class="op" id="7420823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420828">attempts</span><span class="op" id="7420836">:</span>&nbsp;<span class="num" id="7420838">2</span><span class="op" id="7420839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420843">}</span><span class="op" id="7420844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420847">}</span><span class="op" id="7420848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420851">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420855">name</span><span class="op" id="7420859">:</span>&nbsp;<span class="string" id="7420861">&#34;testdata/empty-resolv.conf&#34;</span><span class="op" id="7420889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420893">conf</span><span class="op" id="7420897">:</span>&nbsp;<span class="ident" id="7420899">dnsConfig</span><span class="op" id="7420908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420913">ndots</span><span class="op" id="7420918">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7420923">1</span><span class="op" id="7420924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420929">timeout</span><span class="op" id="7420936">:</span>&nbsp;&nbsp;<span class="num" id="7420939">5</span><span class="op" id="7420940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7420945">attempts</span><span class="op" id="7420953">:</span>&nbsp;<span class="num" id="7420955">2</span><span class="op" id="7420956">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420960">}</span><span class="op" id="7420961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7420964">}</span><span class="op" id="7420965">,</span><br>
<span class="lineno"></span><span class="op" id="7420967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7420970">func</span>&nbsp;<span class="ident" id="7420975">TestDNSReadConfig</span><span class="op" id="7420992">(</span><span class="ident" id="7420993">t</span>&nbsp;<span class="op" id="7420995">*</span><span class="ident" id="7420996">testing</span><span class="op" id="7421003">.</span><span class="ident" id="7421004">T</span><span class="op" id="7421005">)</span>&nbsp;<span class="op" id="7421007">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7421010">for</span>&nbsp;<span class="ident" id="7421014">_</span><span class="op" id="7421015">,</span>&nbsp;<span class="ident" id="7421017">tt</span>&nbsp;<span class="op" id="7421020">:=</span>&nbsp;<span class="keyword" id="7421023">range</span>&nbsp;<span class="ident" id="7421029">dnsReadConfigTests</span>&nbsp;<span class="op" id="7421048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7421052">conf</span><span class="op" id="7421056">,</span>&nbsp;<span class="ident" id="7421058">err</span>&nbsp;<span class="op" id="7421062">:=</span>&nbsp;<span class="ident" id="7421065">dnsReadConfig</span><span class="op" id="7421078">(</span><span class="ident" id="7421079">tt</span><span class="op" id="7421081">.</span><span class="ident" id="7421082">name</span><span class="op" id="7421086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7421090">if</span>&nbsp;<span class="ident" id="7421093">err</span>&nbsp;<span class="op" id="7421097">!=</span>&nbsp;<span class="ident" id="7421100">nil</span>&nbsp;<span class="op" id="7421104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7421109">t</span><span class="op" id="7421110">.</span><span class="ident" id="7421111">Fatal</span><span class="op" id="7421116">(</span><span class="ident" id="7421117">err</span><span class="op" id="7421120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7421124">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7421128">if</span>&nbsp;<span class="op" id="7421131">!</span><span class="ident" id="7421132">reflect</span><span class="op" id="7421139">.</span><span class="ident" id="7421140">DeepEqual</span><span class="op" id="7421149">(</span><span class="ident" id="7421150">conf</span><span class="op" id="7421154">,</span>&nbsp;<span class="op" id="7421156">&amp;</span><span class="ident" id="7421157">tt</span><span class="op" id="7421159">.</span><span class="ident" id="7421160">conf</span><span class="op" id="7421164">)</span>&nbsp;<span class="op" id="7421166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7421171">t</span><span class="op" id="7421172">.</span><span class="ident" id="7421173">Errorf</span><span class="op" id="7421179">(</span><span class="string" id="7421180">&#34;got&nbsp;%v;&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7421197">,</span>&nbsp;<span class="ident" id="7421199">conf</span><span class="op" id="7421203">,</span>&nbsp;<span class="op" id="7421205">&amp;</span><span class="ident" id="7421206">tt</span><span class="op" id="7421208">.</span><span class="ident" id="7421209">conf</span><span class="op" id="7421213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7421217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7421220">}</span><br>
<span class="lineno"></span><span class="op" id="7421222">}</span>
</div>
</body>
</html>
