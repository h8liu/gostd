<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6701609">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6701664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6701718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6701769">package</span>&nbsp;<span class="ident" id="6701777">json</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6701783">import</span>&nbsp;<span class="op" id="6701790">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6701793">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6701802">&#34;math&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6701810">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6701821">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6701832">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="6701842">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6701845">type</span>&nbsp;<span class="ident" id="6701850">Optionals</span>&nbsp;<span class="keyword" id="6701860">struct</span>&nbsp;<span class="op" id="6701867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701870">Sr</span>&nbsp;<span class="builtintype" id="6701873">string</span>&nbsp;<span class="string" id="6701880">`json:&#34;sr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701893">So</span>&nbsp;<span class="builtintype" id="6701896">string</span>&nbsp;<span class="string" id="6701903">`json:&#34;so,omitempty&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701926">Sw</span>&nbsp;<span class="builtintype" id="6701929">string</span>&nbsp;<span class="string" id="6701936">`json:&#34;-&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6701949">Ir</span>&nbsp;<span class="builtintype" id="6701952">int</span>&nbsp;<span class="string" id="6701956">`json:&#34;omitempty&#34;`</span>&nbsp;<span class="comment" id="6701975">//&nbsp;actually&nbsp;named&nbsp;omitempty,&nbsp;not&nbsp;an&nbsp;option</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702019">Io</span>&nbsp;<span class="builtintype" id="6702022">int</span>&nbsp;<span class="string" id="6702026">`json:&#34;io,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702050">Slr</span>&nbsp;<span class="op" id="6702054">[</span><span class="op" id="6702055">]</span><span class="builtintype" id="6702056">string</span>&nbsp;<span class="string" id="6702063">`json:&#34;slr,random&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702084">Slo</span>&nbsp;<span class="op" id="6702088">[</span><span class="op" id="6702089">]</span><span class="builtintype" id="6702090">string</span>&nbsp;<span class="string" id="6702097">`json:&#34;slo,omitempty&#34;`</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702122">Mr</span>&nbsp;<span class="keyword" id="6702125">map</span><span class="op" id="6702128">[</span><span class="builtintype" id="6702129">string</span><span class="op" id="6702135">]</span><span class="keyword" id="6702136">interface</span><span class="op" id="6702145">{</span><span class="op" id="6702146">}</span>&nbsp;<span class="string" id="6702148">`json:&#34;mr&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702161">Mo</span>&nbsp;<span class="keyword" id="6702164">map</span><span class="op" id="6702167">[</span><span class="builtintype" id="6702168">string</span><span class="op" id="6702174">]</span><span class="keyword" id="6702175">interface</span><span class="op" id="6702184">{</span><span class="op" id="6702185">}</span>&nbsp;<span class="string" id="6702187">`json:&#34;,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702209">Fr</span>&nbsp;<span class="builtintype" id="6702212">float64</span>&nbsp;<span class="string" id="6702220">`json:&#34;fr&#34;`</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702233">Fo</span>&nbsp;<span class="builtintype" id="6702236">float64</span>&nbsp;<span class="string" id="6702244">`json:&#34;fo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702268">Br</span>&nbsp;<span class="builtintype" id="6702271">bool</span>&nbsp;<span class="string" id="6702276">`json:&#34;br&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702289">Bo</span>&nbsp;<span class="builtintype" id="6702292">bool</span>&nbsp;<span class="string" id="6702297">`json:&#34;bo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702321">Ur</span>&nbsp;<span class="builtintype" id="6702324">uint</span>&nbsp;<span class="string" id="6702329">`json:&#34;ur&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702342">Uo</span>&nbsp;<span class="builtintype" id="6702345">uint</span>&nbsp;<span class="string" id="6702350">`json:&#34;uo,omitempty&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702374">Str</span>&nbsp;<span class="keyword" id="6702378">struct</span><span class="op" id="6702384">{</span><span class="op" id="6702385">}</span>&nbsp;<span class="string" id="6702387">`json:&#34;str&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702401">Sto</span>&nbsp;<span class="keyword" id="6702405">struct</span><span class="op" id="6702411">{</span><span class="op" id="6702412">}</span>&nbsp;<span class="string" id="6702414">`json:&#34;sto,omitempty&#34;`</span><br>
<span class="lineno">40</span><span class="op" id="6702437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6702440">var</span>&nbsp;<span class="ident" id="6702444">optionalsExpected</span>&nbsp;<span class="op" id="6702462">=</span>&nbsp;<span class="string" id="6702464">`{<br>
<span class="lineno"></span>&nbsp;&#34;sr&#34;:&nbsp;&#34;&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;omitempty&#34;:&nbsp;0,<br>
<span class="lineno">45</span>&nbsp;&#34;slr&#34;:&nbsp;null,<br>
<span class="lineno"></span>&nbsp;&#34;mr&#34;:&nbsp;{},<br>
<span class="lineno"></span>&nbsp;&#34;fr&#34;:&nbsp;0,<br>
<span class="lineno"></span>&nbsp;&#34;br&#34;:&nbsp;false,<br>
<span class="lineno"></span>&nbsp;&#34;ur&#34;:&nbsp;0,<br>
<span class="lineno">50</span>&nbsp;&#34;str&#34;:&nbsp;{},<br>
<span class="lineno"></span>&nbsp;&#34;sto&#34;:&nbsp;{}<br>
<span class="lineno"></span>}`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6702581">func</span>&nbsp;<span class="ident" id="6702586">TestOmitEmpty</span><span class="op" id="6702599">(</span><span class="ident" id="6702600">t</span>&nbsp;<span class="op" id="6702602">*</span><span class="ident" id="6702603"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6702610">.</span><span class="ident" id="6702611">T</span><span class="op" id="6702612">)</span>&nbsp;<span class="op" id="6702614">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702617">var</span>&nbsp;<span class="ident" id="6702621">o</span>&nbsp;<span class="ident" id="6702623"><a href="/encoding/json/encode_test.go.html#6701850">Optionals</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702634"><a href="/encoding/json/encode_test.go.html#6702621">o</a></span><span class="op" id="6702635">.</span><span class="ident" id="6702636">Sw</span>&nbsp;<span class="op" id="6702639">=</span>&nbsp;<span class="string" id="6702641">&#34;something&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702654"><a href="/encoding/json/encode_test.go.html#6702621">o</a></span><span class="op" id="6702655">.</span><span class="ident" id="6702656">Mr</span>&nbsp;<span class="op" id="6702659">=</span>&nbsp;<span class="keyword" id="6702661">map</span><span class="op" id="6702664">[</span><span class="builtintype" id="6702665">string</span><span class="op" id="6702671">]</span><span class="keyword" id="6702672">interface</span><span class="op" id="6702681">{</span><span class="op" id="6702682">}</span><span class="op" id="6702683">{</span><span class="op" id="6702684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702687"><a href="/encoding/json/encode_test.go.html#6702621">o</a></span><span class="op" id="6702688">.</span><span class="ident" id="6702689">Mo</span>&nbsp;<span class="op" id="6702692">=</span>&nbsp;<span class="keyword" id="6702694">map</span><span class="op" id="6702697">[</span><span class="builtintype" id="6702698">string</span><span class="op" id="6702704">]</span><span class="keyword" id="6702705">interface</span><span class="op" id="6702714">{</span><span class="op" id="6702715">}</span><span class="op" id="6702716">{</span><span class="op" id="6702717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702721">got</span><span class="op" id="6702724">,</span>&nbsp;<span class="ident" id="6702726">err</span>&nbsp;<span class="op" id="6702730">:=</span>&nbsp;<span class="ident" id="6702733"><a href="/encoding/json/encode.go.html#4753703">MarshalIndent</a></span><span class="op" id="6702746">(</span><span class="op" id="6702747">&amp;</span><span class="ident" id="6702748"><a href="/encoding/json/encode_test.go.html#6702621">o</a></span><span class="op" id="6702749">,</span>&nbsp;<span class="string" id="6702751">&#34;&#34;</span><span class="op" id="6702753">,</span>&nbsp;<span class="string" id="6702755">&#34;&nbsp;&#34;</span><span class="op" id="6702758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702761">if</span>&nbsp;<span class="ident" id="6702764"><a href="/encoding/json/encode_test.go.html#6702726">err</a></span>&nbsp;<span class="op" id="6702768">!=</span>&nbsp;<span class="ident" id="6702771">nil</span>&nbsp;<span class="op" id="6702775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702779"><a href="/encoding/json/encode_test.go.html#6702600">t</a></span><span class="op" id="6702780">.</span><span class="ident" id="6702781">Fatal</span><span class="op" id="6702786">(</span><span class="ident" id="6702787"><a href="/encoding/json/encode_test.go.html#6702726">err</a></span><span class="op" id="6702790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6702796">if</span>&nbsp;<span class="ident" id="6702799">got</span>&nbsp;<span class="op" id="6702803">:=</span>&nbsp;<span class="builtintype" id="6702806">string</span><span class="op" id="6702812">(</span><span class="ident" id="6702813"><a href="/encoding/json/encode_test.go.html#6702721">got</a></span><span class="op" id="6702816">)</span><span class="op" id="6702817">;</span>&nbsp;<span class="ident" id="6702819"><a href="/encoding/json/encode_test.go.html#6702799">got</a></span>&nbsp;<span class="op" id="6702823">!=</span>&nbsp;<span class="ident" id="6702826"><a href="/encoding/json/encode_test.go.html#6702444">optionalsExpected</a></span>&nbsp;<span class="op" id="6702844">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702848"><a href="/encoding/json/encode_test.go.html#6702600">t</a></span><span class="op" id="6702849">.</span><span class="ident" id="6702850">Errorf</span><span class="op" id="6702856">(</span><span class="string" id="6702857">&#34;&nbsp;got:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="6702879">,</span>&nbsp;<span class="ident" id="6702881"><a href="/encoding/json/encode_test.go.html#6702799">got</a></span><span class="op" id="6702884">,</span>&nbsp;<span class="ident" id="6702886"><a href="/encoding/json/encode_test.go.html#6702444">optionalsExpected</a></span><span class="op" id="6702903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6702906">}</span><br>
<span class="lineno"></span><span class="op" id="6702908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6702911">type</span>&nbsp;<span class="ident" id="6702916">StringTag</span>&nbsp;<span class="keyword" id="6702926">struct</span>&nbsp;<span class="op" id="6702933">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702936">BoolStr</span>&nbsp;<span class="builtintype" id="6702944">bool</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6702951">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6702969">IntStr</span>&nbsp;&nbsp;<span class="ident" id="6702977">int64</span>&nbsp;&nbsp;<span class="string" id="6702984">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703002">StrStr</span>&nbsp;&nbsp;<span class="builtintype" id="6703010">string</span>&nbsp;<span class="string" id="6703017">`json:&#34;,string&#34;`</span><br>
<span class="lineno"></span><span class="op" id="6703034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6703037">var</span>&nbsp;<span class="ident" id="6703041">stringTagExpected</span>&nbsp;<span class="op" id="6703059">=</span>&nbsp;<span class="string" id="6703061">`{<br>
<span class="lineno"></span>&nbsp;&#34;BoolStr&#34;:&nbsp;&#34;true&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;IntStr&#34;:&nbsp;&#34;42&#34;,<br>
<span class="lineno"></span>&nbsp;&#34;StrStr&#34;:&nbsp;&#34;\&#34;xzbit\&#34;&#34;<br>
<span class="lineno"></span>}`</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="keyword" id="6703128">func</span>&nbsp;<span class="ident" id="6703133">TestStringTag</span><span class="op" id="6703146">(</span><span class="ident" id="6703147">t</span>&nbsp;<span class="op" id="6703149">*</span><span class="ident" id="6703150"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6703157">.</span><span class="ident" id="6703158">T</span><span class="op" id="6703159">)</span>&nbsp;<span class="op" id="6703161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703164">var</span>&nbsp;<span class="ident" id="6703168">s</span>&nbsp;<span class="ident" id="6703170"><a href="/encoding/json/encode_test.go.html#6702916">StringTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703181"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703182">.</span><span class="ident" id="6703183">BoolStr</span>&nbsp;<span class="op" id="6703191">=</span>&nbsp;<span class="builtintype" id="6703193">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703199"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703200">.</span><span class="ident" id="6703201">IntStr</span>&nbsp;<span class="op" id="6703208">=</span>&nbsp;<span class="num" id="6703210">42</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703214"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703215">.</span><span class="ident" id="6703216">StrStr</span>&nbsp;<span class="op" id="6703223">=</span>&nbsp;<span class="string" id="6703225">&#34;xzbit&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703234">got</span><span class="op" id="6703237">,</span>&nbsp;<span class="ident" id="6703239">err</span>&nbsp;<span class="op" id="6703243">:=</span>&nbsp;<span class="ident" id="6703246"><a href="/encoding/json/encode.go.html#4753703">MarshalIndent</a></span><span class="op" id="6703259">(</span><span class="op" id="6703260">&amp;</span><span class="ident" id="6703261"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703262">,</span>&nbsp;<span class="string" id="6703264">&#34;&#34;</span><span class="op" id="6703266">,</span>&nbsp;<span class="string" id="6703268">&#34;&nbsp;&#34;</span><span class="op" id="6703271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703274">if</span>&nbsp;<span class="ident" id="6703277"><a href="/encoding/json/encode_test.go.html#6703239">err</a></span>&nbsp;<span class="op" id="6703281">!=</span>&nbsp;<span class="ident" id="6703284">nil</span>&nbsp;<span class="op" id="6703288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703292"><a href="/encoding/json/encode_test.go.html#6703147">t</a></span><span class="op" id="6703293">.</span><span class="ident" id="6703294">Fatal</span><span class="op" id="6703299">(</span><span class="ident" id="6703300"><a href="/encoding/json/encode_test.go.html#6703239">err</a></span><span class="op" id="6703303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703306">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703309">if</span>&nbsp;<span class="ident" id="6703312">got</span>&nbsp;<span class="op" id="6703316">:=</span>&nbsp;<span class="builtintype" id="6703319">string</span><span class="op" id="6703325">(</span><span class="ident" id="6703326"><a href="/encoding/json/encode_test.go.html#6703234">got</a></span><span class="op" id="6703329">)</span><span class="op" id="6703330">;</span>&nbsp;<span class="ident" id="6703332"><a href="/encoding/json/encode_test.go.html#6703312">got</a></span>&nbsp;<span class="op" id="6703336">!=</span>&nbsp;<span class="ident" id="6703339"><a href="/encoding/json/encode_test.go.html#6703041">stringTagExpected</a></span>&nbsp;<span class="op" id="6703357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703361"><a href="/encoding/json/encode_test.go.html#6703147">t</a></span><span class="op" id="6703362">.</span><span class="ident" id="6703363">Fatalf</span><span class="op" id="6703369">(</span><span class="string" id="6703370">&#34;&nbsp;got:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="6703392">,</span>&nbsp;<span class="ident" id="6703394"><a href="/encoding/json/encode_test.go.html#6703312">got</a></span><span class="op" id="6703397">,</span>&nbsp;<span class="ident" id="6703399"><a href="/encoding/json/encode_test.go.html#6703041">stringTagExpected</a></span><span class="op" id="6703416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6703423">//&nbsp;Verify&nbsp;that&nbsp;it&nbsp;round-trips.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703455">var</span>&nbsp;<span class="ident" id="6703459">s2</span>&nbsp;<span class="ident" id="6703462"><a href="/encoding/json/encode_test.go.html#6702916">StringTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703473"><a href="/encoding/json/encode_test.go.html#6703239">err</a></span>&nbsp;<span class="op" id="6703477">=</span>&nbsp;<span class="ident" id="6703479"><a href="/encoding/json/stream.go.html#4802892">NewDecoder</a></span><span class="op" id="6703489">(</span><span class="ident" id="6703490"><a href="/encoding/json/encode_test.go.html#6701793">bytes</a></span><span class="op" id="6703495">.</span><span class="ident" id="6703496">NewReader</span><span class="op" id="6703505">(</span><span class="ident" id="6703506"><a href="/encoding/json/encode_test.go.html#6703234">got</a></span><span class="op" id="6703509">)</span><span class="op" id="6703510">)</span><span class="op" id="6703511">.</span><span class="ident" id="6703512">Decode</span><span class="op" id="6703518">(</span><span class="op" id="6703519">&amp;</span><span class="ident" id="6703520"><a href="/encoding/json/encode_test.go.html#6703459">s2</a></span><span class="op" id="6703522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703525">if</span>&nbsp;<span class="ident" id="6703528"><a href="/encoding/json/encode_test.go.html#6703239">err</a></span>&nbsp;<span class="op" id="6703532">!=</span>&nbsp;<span class="ident" id="6703535">nil</span>&nbsp;<span class="op" id="6703539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703543"><a href="/encoding/json/encode_test.go.html#6703147">t</a></span><span class="op" id="6703544">.</span><span class="ident" id="6703545">Fatalf</span><span class="op" id="6703551">(</span><span class="string" id="6703552">&#34;Decode:&nbsp;%v&#34;</span><span class="op" id="6703564">,</span>&nbsp;<span class="ident" id="6703566"><a href="/encoding/json/encode_test.go.html#6703239">err</a></span><span class="op" id="6703569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703572">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703575">if</span>&nbsp;<span class="op" id="6703578">!</span><span class="ident" id="6703579"><a href="/encoding/json/encode_test.go.html#6701810">reflect</a></span><span class="op" id="6703586">.</span><span class="ident" id="6703587">DeepEqual</span><span class="op" id="6703596">(</span><span class="ident" id="6703597"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703598">,</span>&nbsp;<span class="ident" id="6703600"><a href="/encoding/json/encode_test.go.html#6703459">s2</a></span><span class="op" id="6703602">)</span>&nbsp;<span class="op" id="6703604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703608"><a href="/encoding/json/encode_test.go.html#6703147">t</a></span><span class="op" id="6703609">.</span><span class="ident" id="6703610">Fatalf</span><span class="op" id="6703616">(</span><span class="string" id="6703617">&#34;decode&nbsp;didn&#39;t&nbsp;match.\nsource:&nbsp;%#v\nEncoded&nbsp;as:\n%s\ndecode:&nbsp;%#v&#34;</span><span class="op" id="6703682">,</span>&nbsp;<span class="ident" id="6703684"><a href="/encoding/json/encode_test.go.html#6703168">s</a></span><span class="op" id="6703685">,</span>&nbsp;<span class="builtintype" id="6703687">string</span><span class="op" id="6703693">(</span><span class="ident" id="6703694"><a href="/encoding/json/encode_test.go.html#6703234">got</a></span><span class="op" id="6703697">)</span><span class="op" id="6703698">,</span>&nbsp;<span class="ident" id="6703700"><a href="/encoding/json/encode_test.go.html#6703459">s2</a></span><span class="op" id="6703702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6703705">}</span><br>
<span class="lineno"></span><span class="op" id="6703707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6703710">//&nbsp;byte&nbsp;slices&nbsp;are&nbsp;special&nbsp;even&nbsp;if&nbsp;they&#39;re&nbsp;renamed&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="6703768">type</span>&nbsp;<span class="ident" id="6703773">renamedByte</span>&nbsp;<span class="builtintype" id="6703785">byte</span><br>
<span class="lineno"></span><span class="keyword" id="6703790">type</span>&nbsp;<span class="ident" id="6703795">renamedByteSlice</span>&nbsp;<span class="op" id="6703812">[</span><span class="op" id="6703813">]</span><span class="builtintype" id="6703814">byte</span><br>
<span class="lineno"></span><span class="keyword" id="6703819">type</span>&nbsp;<span class="ident" id="6703824">renamedRenamedByteSlice</span>&nbsp;<span class="op" id="6703848">[</span><span class="op" id="6703849">]</span><span class="ident" id="6703850"><a href="/encoding/json/encode_test.go.html#6703773">renamedByte</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6703863">func</span>&nbsp;<span class="ident" id="6703868">TestEncodeRenamedByteSlice</span><span class="op" id="6703894">(</span><span class="ident" id="6703895">t</span>&nbsp;<span class="op" id="6703897">*</span><span class="ident" id="6703898"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6703905">.</span><span class="ident" id="6703906">T</span><span class="op" id="6703907">)</span>&nbsp;<span class="op" id="6703909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703912">s</span>&nbsp;<span class="op" id="6703914">:=</span>&nbsp;<span class="ident" id="6703917"><a href="/encoding/json/encode_test.go.html#6703795">renamedByteSlice</a></span><span class="op" id="6703933">(</span><span class="string" id="6703934">&#34;abc&#34;</span><span class="op" id="6703939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703942">result</span><span class="op" id="6703948">,</span>&nbsp;<span class="ident" id="6703950">err</span>&nbsp;<span class="op" id="6703954">:=</span>&nbsp;<span class="ident" id="6703957"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6703964">(</span><span class="ident" id="6703965"><a href="/encoding/json/encode_test.go.html#6703912">s</a></span><span class="op" id="6703966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6703969">if</span>&nbsp;<span class="ident" id="6703972"><a href="/encoding/json/encode_test.go.html#6703950">err</a></span>&nbsp;<span class="op" id="6703976">!=</span>&nbsp;<span class="ident" id="6703979">nil</span>&nbsp;<span class="op" id="6703983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6703987"><a href="/encoding/json/encode_test.go.html#6703895">t</a></span><span class="op" id="6703988">.</span><span class="ident" id="6703989">Fatal</span><span class="op" id="6703994">(</span><span class="ident" id="6703995"><a href="/encoding/json/encode_test.go.html#6703950">err</a></span><span class="op" id="6703998">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704004">expect</span>&nbsp;<span class="op" id="6704011">:=</span>&nbsp;<span class="string" id="6704014">`&#34;YWJj&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704024">if</span>&nbsp;<span class="builtintype" id="6704027">string</span><span class="op" id="6704033">(</span><span class="ident" id="6704034"><a href="/encoding/json/encode_test.go.html#6703942">result</a></span><span class="op" id="6704040">)</span>&nbsp;<span class="op" id="6704042">!=</span>&nbsp;<span class="ident" id="6704045"><a href="/encoding/json/encode_test.go.html#6704004">expect</a></span>&nbsp;<span class="op" id="6704052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704056"><a href="/encoding/json/encode_test.go.html#6703895">t</a></span><span class="op" id="6704057">.</span><span class="ident" id="6704058">Errorf</span><span class="op" id="6704064">(</span><span class="string" id="6704065">&#34;&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6704082">,</span>&nbsp;<span class="ident" id="6704084"><a href="/encoding/json/encode_test.go.html#6703942">result</a></span><span class="op" id="6704090">,</span>&nbsp;<span class="ident" id="6704092"><a href="/encoding/json/encode_test.go.html#6704004">expect</a></span><span class="op" id="6704098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704101">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704104">r</span>&nbsp;<span class="op" id="6704106">:=</span>&nbsp;<span class="ident" id="6704109"><a href="/encoding/json/encode_test.go.html#6703824">renamedRenamedByteSlice</a></span><span class="op" id="6704132">(</span><span class="string" id="6704133">&#34;abc&#34;</span><span class="op" id="6704138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704141"><a href="/encoding/json/encode_test.go.html#6703942">result</a></span><span class="op" id="6704147">,</span>&nbsp;<span class="ident" id="6704149"><a href="/encoding/json/encode_test.go.html#6703950">err</a></span>&nbsp;<span class="op" id="6704153">=</span>&nbsp;<span class="ident" id="6704155"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6704162">(</span><span class="ident" id="6704163"><a href="/encoding/json/encode_test.go.html#6704104">r</a></span><span class="op" id="6704164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704167">if</span>&nbsp;<span class="ident" id="6704170"><a href="/encoding/json/encode_test.go.html#6703950">err</a></span>&nbsp;<span class="op" id="6704174">!=</span>&nbsp;<span class="ident" id="6704177">nil</span>&nbsp;<span class="op" id="6704181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704185"><a href="/encoding/json/encode_test.go.html#6703895">t</a></span><span class="op" id="6704186">.</span><span class="ident" id="6704187">Fatal</span><span class="op" id="6704192">(</span><span class="ident" id="6704193"><a href="/encoding/json/encode_test.go.html#6703950">err</a></span><span class="op" id="6704196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704199">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704202">if</span>&nbsp;<span class="builtintype" id="6704205">string</span><span class="op" id="6704211">(</span><span class="ident" id="6704212"><a href="/encoding/json/encode_test.go.html#6703942">result</a></span><span class="op" id="6704218">)</span>&nbsp;<span class="op" id="6704220">!=</span>&nbsp;<span class="ident" id="6704223"><a href="/encoding/json/encode_test.go.html#6704004">expect</a></span>&nbsp;<span class="op" id="6704230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704234"><a href="/encoding/json/encode_test.go.html#6703895">t</a></span><span class="op" id="6704235">.</span><span class="ident" id="6704236">Errorf</span><span class="op" id="6704242">(</span><span class="string" id="6704243">&#34;&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6704260">,</span>&nbsp;<span class="ident" id="6704262"><a href="/encoding/json/encode_test.go.html#6703942">result</a></span><span class="op" id="6704268">,</span>&nbsp;<span class="ident" id="6704270"><a href="/encoding/json/encode_test.go.html#6704004">expect</a></span><span class="op" id="6704276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704279">}</span><br>
<span class="lineno"></span><span class="op" id="6704281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="6704284">var</span>&nbsp;<span class="ident" id="6704288">unsupportedValues</span>&nbsp;<span class="op" id="6704306">=</span>&nbsp;<span class="op" id="6704308">[</span><span class="op" id="6704309">]</span><span class="keyword" id="6704310">interface</span><span class="op" id="6704319">{</span><span class="op" id="6704320">}</span><span class="op" id="6704321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704324"><a href="/encoding/json/encode_test.go.html#6701802">math</a></span><span class="op" id="6704328">.</span><span class="ident" id="6704329">NaN</span><span class="op" id="6704332">(</span><span class="op" id="6704333">)</span><span class="op" id="6704334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704337"><a href="/encoding/json/encode_test.go.html#6701802">math</a></span><span class="op" id="6704341">.</span><span class="ident" id="6704342">Inf</span><span class="op" id="6704345">(</span><span class="op" id="6704346">-</span><span class="num" id="6704347">1</span><span class="op" id="6704348">)</span><span class="op" id="6704349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704352"><a href="/encoding/json/encode_test.go.html#6701802">math</a></span><span class="op" id="6704356">.</span><span class="ident" id="6704357">Inf</span><span class="op" id="6704360">(</span><span class="num" id="6704361">1</span><span class="op" id="6704362">)</span><span class="op" id="6704363">,</span><br>
<span class="lineno"></span><span class="op" id="6704365">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="keyword" id="6704368">func</span>&nbsp;<span class="ident" id="6704373">TestUnsupportedValues</span><span class="op" id="6704394">(</span><span class="ident" id="6704395">t</span>&nbsp;<span class="op" id="6704397">*</span><span class="ident" id="6704398"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6704405">.</span><span class="ident" id="6704406">T</span><span class="op" id="6704407">)</span>&nbsp;<span class="op" id="6704409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704412">for</span>&nbsp;<span class="ident" id="6704416">_</span><span class="op" id="6704417">,</span>&nbsp;<span class="ident" id="6704419">v</span>&nbsp;<span class="op" id="6704421">:=</span>&nbsp;<span class="keyword" id="6704424">range</span>&nbsp;<span class="ident" id="6704430"><a href="/encoding/json/encode_test.go.html#6704288">unsupportedValues</a></span>&nbsp;<span class="op" id="6704448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704452">if</span>&nbsp;<span class="ident" id="6704455">_</span><span class="op" id="6704456">,</span>&nbsp;<span class="ident" id="6704458">err</span>&nbsp;<span class="op" id="6704462">:=</span>&nbsp;<span class="ident" id="6704465"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6704472">(</span><span class="ident" id="6704473"><a href="/encoding/json/encode_test.go.html#6704419">v</a></span><span class="op" id="6704474">)</span><span class="op" id="6704475">;</span>&nbsp;<span class="ident" id="6704477"><a href="/encoding/json/encode_test.go.html#6704458">err</a></span>&nbsp;<span class="op" id="6704481">!=</span>&nbsp;<span class="ident" id="6704484">nil</span>&nbsp;<span class="op" id="6704488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704493">if</span>&nbsp;<span class="ident" id="6704496">_</span><span class="op" id="6704497">,</span>&nbsp;<span class="ident" id="6704499">ok</span>&nbsp;<span class="op" id="6704502">:=</span>&nbsp;<span class="ident" id="6704505"><a href="/encoding/json/encode_test.go.html#6704458">err</a></span><span class="op" id="6704508">.</span><span class="op" id="6704509">(</span><span class="op" id="6704510">*</span><span class="ident" id="6704511"><a href="/encoding/json/encode.go.html#4755493">UnsupportedValueError</a></span><span class="op" id="6704532">)</span><span class="op" id="6704533">;</span>&nbsp;<span class="op" id="6704535">!</span><span class="ident" id="6704536"><a href="/encoding/json/encode_test.go.html#6704499">ok</a></span>&nbsp;<span class="op" id="6704539">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704545"><a href="/encoding/json/encode_test.go.html#6704395">t</a></span><span class="op" id="6704546">.</span><span class="ident" id="6704547">Errorf</span><span class="op" id="6704553">(</span><span class="string" id="6704554">&#34;for&nbsp;%v,&nbsp;got&nbsp;%T&nbsp;want&nbsp;UnsupportedValueError&#34;</span><span class="op" id="6704597">,</span>&nbsp;<span class="ident" id="6704599"><a href="/encoding/json/encode_test.go.html#6704419">v</a></span><span class="op" id="6704600">,</span>&nbsp;<span class="ident" id="6704602"><a href="/encoding/json/encode_test.go.html#6704458">err</a></span><span class="op" id="6704605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704614">}</span>&nbsp;<span class="keyword" id="6704616">else</span>&nbsp;<span class="op" id="6704621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6704626"><a href="/encoding/json/encode_test.go.html#6704395">t</a></span><span class="op" id="6704627">.</span><span class="ident" id="6704628">Errorf</span><span class="op" id="6704634">(</span><span class="string" id="6704635">&#34;for&nbsp;%v,&nbsp;expected&nbsp;error&#34;</span><span class="op" id="6704659">,</span>&nbsp;<span class="ident" id="6704661"><a href="/encoding/json/encode_test.go.html#6704419">v</a></span><span class="op" id="6704662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704666">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704669">}</span><br>
<span class="lineno"></span><span class="op" id="6704671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6704674">//&nbsp;Ref&nbsp;has&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;methods&nbsp;with&nbsp;pointer&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="6704742">type</span>&nbsp;<span class="ident" id="6704747">Ref</span>&nbsp;<span class="builtintype" id="6704751">int</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="6704756">func</span>&nbsp;<span class="op" id="6704761">(</span><span class="op" id="6704762">*</span><span class="ident" id="6704763"><a href="/encoding/json/encode_test.go.html#6704747">Ref</a></span><span class="op" id="6704766">)</span>&nbsp;<span class="ident" id="6704768">MarshalJSON</span><span class="op" id="6704779">(</span><span class="op" id="6704780">)</span>&nbsp;<span class="op" id="6704782">(</span><span class="op" id="6704783">[</span><span class="op" id="6704784">]</span><span class="builtintype" id="6704785">byte</span><span class="op" id="6704789">,</span>&nbsp;<span class="builtintype" id="6704791">error</span><span class="op" id="6704796">)</span>&nbsp;<span class="op" id="6704798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704801">return</span>&nbsp;<span class="op" id="6704808">[</span><span class="op" id="6704809">]</span><span class="builtintype" id="6704810">byte</span><span class="op" id="6704814">(</span><span class="string" id="6704815">`&#34;ref&#34;`</span><span class="op" id="6704822">)</span><span class="op" id="6704823">,</span>&nbsp;<span class="ident" id="6704825">nil</span><br>
<span class="lineno"></span><span class="op" id="6704829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="keyword" id="6704832">func</span>&nbsp;<span class="op" id="6704837">(</span><span class="ident" id="6704838">r</span>&nbsp;<span class="op" id="6704840">*</span><span class="ident" id="6704841"><a href="/encoding/json/encode_test.go.html#6704747">Ref</a></span><span class="op" id="6704844">)</span>&nbsp;<span class="ident" id="6704846">UnmarshalJSON</span><span class="op" id="6704859">(</span><span class="op" id="6704860">[</span><span class="op" id="6704861">]</span><span class="builtintype" id="6704862">byte</span><span class="op" id="6704866">)</span>&nbsp;<span class="builtintype" id="6704868">error</span>&nbsp;<span class="op" id="6704874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6704877">*</span><span class="ident" id="6704878"><a href="/encoding/json/encode_test.go.html#6704838">r</a></span>&nbsp;<span class="op" id="6704880">=</span>&nbsp;<span class="num" id="6704882">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6704886">return</span>&nbsp;<span class="ident" id="6704893">nil</span><br>
<span class="lineno"></span><span class="op" id="6704897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span><span class="comment" id="6704900">//&nbsp;Val&nbsp;has&nbsp;Marshaler&nbsp;methods&nbsp;with&nbsp;value&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="6704950">type</span>&nbsp;<span class="ident" id="6704955">Val</span>&nbsp;<span class="builtintype" id="6704959">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6704964">func</span>&nbsp;<span class="op" id="6704969">(</span><span class="ident" id="6704970"><a href="/encoding/json/encode_test.go.html#6704955">Val</a></span><span class="op" id="6704973">)</span>&nbsp;<span class="ident" id="6704975">MarshalJSON</span><span class="op" id="6704986">(</span><span class="op" id="6704987">)</span>&nbsp;<span class="op" id="6704989">(</span><span class="op" id="6704990">[</span><span class="op" id="6704991">]</span><span class="builtintype" id="6704992">byte</span><span class="op" id="6704996">,</span>&nbsp;<span class="builtintype" id="6704998">error</span><span class="op" id="6705003">)</span>&nbsp;<span class="op" id="6705005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705008">return</span>&nbsp;<span class="op" id="6705015">[</span><span class="op" id="6705016">]</span><span class="builtintype" id="6705017">byte</span><span class="op" id="6705021">(</span><span class="string" id="6705022">`&#34;val&#34;`</span><span class="op" id="6705029">)</span><span class="op" id="6705030">,</span>&nbsp;<span class="ident" id="6705032">nil</span><br>
<span class="lineno">165</span><span class="op" id="6705036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6705039">//&nbsp;RefText&nbsp;has&nbsp;Marshaler&nbsp;and&nbsp;Unmarshaler&nbsp;methods&nbsp;with&nbsp;pointer&nbsp;receiver.</span><br>
<span class="lineno"></span><span class="keyword" id="6705111">type</span>&nbsp;<span class="ident" id="6705116">RefText</span>&nbsp;<span class="builtintype" id="6705124">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="6705129">func</span>&nbsp;<span class="op" id="6705134">(</span><span class="op" id="6705135">*</span><span class="ident" id="6705136"><a href="/encoding/json/encode_test.go.html#6705116">RefText</a></span><span class="op" id="6705143">)</span>&nbsp;<span class="ident" id="6705145">MarshalText</span><span class="op" id="6705156">(</span><span class="op" id="6705157">)</span>&nbsp;<span class="op" id="6705159">(</span><span class="op" id="6705160">[</span><span class="op" id="6705161">]</span><span class="builtintype" id="6705162">byte</span><span class="op" id="6705166">,</span>&nbsp;<span class="builtintype" id="6705168">error</span><span class="op" id="6705173">)</span>&nbsp;<span class="op" id="6705175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705178">return</span>&nbsp;<span class="op" id="6705185">[</span><span class="op" id="6705186">]</span><span class="builtintype" id="6705187">byte</span><span class="op" id="6705191">(</span><span class="string" id="6705192">`&#34;ref&#34;`</span><span class="op" id="6705199">)</span><span class="op" id="6705200">,</span>&nbsp;<span class="ident" id="6705202">nil</span><br>
<span class="lineno"></span><span class="op" id="6705206">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6705209">func</span>&nbsp;<span class="op" id="6705214">(</span><span class="ident" id="6705215">r</span>&nbsp;<span class="op" id="6705217">*</span><span class="ident" id="6705218"><a href="/encoding/json/encode_test.go.html#6705116">RefText</a></span><span class="op" id="6705225">)</span>&nbsp;<span class="ident" id="6705227">UnmarshalText</span><span class="op" id="6705240">(</span><span class="op" id="6705241">[</span><span class="op" id="6705242">]</span><span class="builtintype" id="6705243">byte</span><span class="op" id="6705247">)</span>&nbsp;<span class="builtintype" id="6705249">error</span>&nbsp;<span class="op" id="6705255">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6705258">*</span><span class="ident" id="6705259"><a href="/encoding/json/encode_test.go.html#6705215">r</a></span>&nbsp;<span class="op" id="6705261">=</span>&nbsp;<span class="num" id="6705263">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705267">return</span>&nbsp;<span class="ident" id="6705274">nil</span><br>
<span class="lineno"></span><span class="op" id="6705278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6705281">//&nbsp;ValText&nbsp;has&nbsp;Marshaler&nbsp;methods&nbsp;with&nbsp;value&nbsp;receiver.</span><br>
<span class="lineno">180</span><span class="keyword" id="6705335">type</span>&nbsp;<span class="ident" id="6705340">ValText</span>&nbsp;<span class="builtintype" id="6705348">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6705353">func</span>&nbsp;<span class="op" id="6705358">(</span><span class="ident" id="6705359"><a href="/encoding/json/encode_test.go.html#6705340">ValText</a></span><span class="op" id="6705366">)</span>&nbsp;<span class="ident" id="6705368">MarshalText</span><span class="op" id="6705379">(</span><span class="op" id="6705380">)</span>&nbsp;<span class="op" id="6705382">(</span><span class="op" id="6705383">[</span><span class="op" id="6705384">]</span><span class="builtintype" id="6705385">byte</span><span class="op" id="6705389">,</span>&nbsp;<span class="builtintype" id="6705391">error</span><span class="op" id="6705396">)</span>&nbsp;<span class="op" id="6705398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705401">return</span>&nbsp;<span class="op" id="6705408">[</span><span class="op" id="6705409">]</span><span class="builtintype" id="6705410">byte</span><span class="op" id="6705414">(</span><span class="string" id="6705415">`&#34;val&#34;`</span><span class="op" id="6705422">)</span><span class="op" id="6705423">,</span>&nbsp;<span class="ident" id="6705425">nil</span><br>
<span class="lineno"></span><span class="op" id="6705429">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="6705432">func</span>&nbsp;<span class="ident" id="6705437">TestRefValMarshal</span><span class="op" id="6705454">(</span><span class="ident" id="6705455">t</span>&nbsp;<span class="op" id="6705457">*</span><span class="ident" id="6705458"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6705465">.</span><span class="ident" id="6705466">T</span><span class="op" id="6705467">)</span>&nbsp;<span class="op" id="6705469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705472">var</span>&nbsp;<span class="ident" id="6705476">s</span>&nbsp;<span class="op" id="6705478">=</span>&nbsp;<span class="keyword" id="6705480">struct</span>&nbsp;<span class="op" id="6705487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705491">R0</span>&nbsp;<span class="ident" id="6705494"><a href="/encoding/json/encode_test.go.html#6704747">Ref</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705500">R1</span>&nbsp;<span class="op" id="6705503">*</span><span class="ident" id="6705504"><a href="/encoding/json/encode_test.go.html#6704747">Ref</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705510">R2</span>&nbsp;<span class="ident" id="6705513"><a href="/encoding/json/encode_test.go.html#6705116">RefText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705523">R3</span>&nbsp;<span class="op" id="6705526">*</span><span class="ident" id="6705527"><a href="/encoding/json/encode_test.go.html#6705116">RefText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705537">V0</span>&nbsp;<span class="ident" id="6705540"><a href="/encoding/json/encode_test.go.html#6704955">Val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705546">V1</span>&nbsp;<span class="op" id="6705549">*</span><span class="ident" id="6705550"><a href="/encoding/json/encode_test.go.html#6704955">Val</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705556">V2</span>&nbsp;<span class="ident" id="6705559"><a href="/encoding/json/encode_test.go.html#6705340">ValText</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705569">V3</span>&nbsp;<span class="op" id="6705572">*</span><span class="ident" id="6705573"><a href="/encoding/json/encode_test.go.html#6705340">ValText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6705582">}</span><span class="op" id="6705583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705587">R0</span><span class="op" id="6705589">:</span>&nbsp;<span class="num" id="6705591">12</span><span class="op" id="6705593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705597">R1</span><span class="op" id="6705599">:</span>&nbsp;<span class="builtinfunc" id="6705601">new</span><span class="op" id="6705604">(</span><span class="ident" id="6705605"><a href="/encoding/json/encode_test.go.html#6704747">Ref</a></span><span class="op" id="6705608">)</span><span class="op" id="6705609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705613">R2</span><span class="op" id="6705615">:</span>&nbsp;<span class="num" id="6705617">14</span><span class="op" id="6705619">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705623">R3</span><span class="op" id="6705625">:</span>&nbsp;<span class="builtinfunc" id="6705627">new</span><span class="op" id="6705630">(</span><span class="ident" id="6705631"><a href="/encoding/json/encode_test.go.html#6705116">RefText</a></span><span class="op" id="6705638">)</span><span class="op" id="6705639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705643">V0</span><span class="op" id="6705645">:</span>&nbsp;<span class="num" id="6705647">13</span><span class="op" id="6705649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705653">V1</span><span class="op" id="6705655">:</span>&nbsp;<span class="builtinfunc" id="6705657">new</span><span class="op" id="6705660">(</span><span class="ident" id="6705661"><a href="/encoding/json/encode_test.go.html#6704955">Val</a></span><span class="op" id="6705664">)</span><span class="op" id="6705665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705669">V2</span><span class="op" id="6705671">:</span>&nbsp;<span class="num" id="6705673">15</span><span class="op" id="6705675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705679">V3</span><span class="op" id="6705681">:</span>&nbsp;<span class="builtinfunc" id="6705683">new</span><span class="op" id="6705686">(</span><span class="ident" id="6705687"><a href="/encoding/json/encode_test.go.html#6705340">ValText</a></span><span class="op" id="6705694">)</span><span class="op" id="6705695">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6705698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705701">const</span>&nbsp;<span class="ident" id="6705707">want</span>&nbsp;<span class="op" id="6705712">=</span>&nbsp;<span class="string" id="6705714">`{&#34;R0&#34;:&#34;ref&#34;,&#34;R1&#34;:&#34;ref&#34;,&#34;R2&#34;:&#34;\&#34;ref\&#34;&#34;,&#34;R3&#34;:&#34;\&#34;ref\&#34;&#34;,&#34;V0&#34;:&#34;val&#34;,&#34;V1&#34;:&#34;val&#34;,&#34;V2&#34;:&#34;\&#34;val\&#34;&#34;,&#34;V3&#34;:&#34;\&#34;val\&#34;&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705823">b</span><span class="op" id="6705824">,</span>&nbsp;<span class="ident" id="6705826">err</span>&nbsp;<span class="op" id="6705830">:=</span>&nbsp;<span class="ident" id="6705833"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6705840">(</span><span class="op" id="6705841">&amp;</span><span class="ident" id="6705842"><a href="/encoding/json/encode_test.go.html#6705476">s</a></span><span class="op" id="6705843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705846">if</span>&nbsp;<span class="ident" id="6705849"><a href="/encoding/json/encode_test.go.html#6705826">err</a></span>&nbsp;<span class="op" id="6705853">!=</span>&nbsp;<span class="ident" id="6705856">nil</span>&nbsp;<span class="op" id="6705860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705864"><a href="/encoding/json/encode_test.go.html#6705455">t</a></span><span class="op" id="6705865">.</span><span class="ident" id="6705866">Fatalf</span><span class="op" id="6705872">(</span><span class="string" id="6705873">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="6705886">,</span>&nbsp;<span class="ident" id="6705888"><a href="/encoding/json/encode_test.go.html#6705826">err</a></span><span class="op" id="6705891">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6705894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6705897">if</span>&nbsp;<span class="ident" id="6705900">got</span>&nbsp;<span class="op" id="6705904">:=</span>&nbsp;<span class="builtintype" id="6705907">string</span><span class="op" id="6705913">(</span><span class="ident" id="6705914"><a href="/encoding/json/encode_test.go.html#6705823">b</a></span><span class="op" id="6705915">)</span><span class="op" id="6705916">;</span>&nbsp;<span class="ident" id="6705918"><a href="/encoding/json/encode_test.go.html#6705900">got</a></span>&nbsp;<span class="op" id="6705922">!=</span>&nbsp;<span class="ident" id="6705925"><a href="/encoding/json/encode_test.go.html#6705707">want</a></span>&nbsp;<span class="op" id="6705930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6705934"><a href="/encoding/json/encode_test.go.html#6705455">t</a></span><span class="op" id="6705935">.</span><span class="ident" id="6705936">Errorf</span><span class="op" id="6705942">(</span><span class="string" id="6705943">&#34;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6705960">,</span>&nbsp;<span class="ident" id="6705962"><a href="/encoding/json/encode_test.go.html#6705900">got</a></span><span class="op" id="6705965">,</span>&nbsp;<span class="ident" id="6705967"><a href="/encoding/json/encode_test.go.html#6705707">want</a></span><span class="op" id="6705971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6705974">}</span><br>
<span class="lineno"></span><span class="op" id="6705976">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="comment" id="6705979">//&nbsp;C&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;returns&nbsp;unescaped&nbsp;JSON.</span><br>
<span class="lineno"></span><span class="keyword" id="6706033">type</span>&nbsp;<span class="ident" id="6706038">C</span>&nbsp;<span class="builtintype" id="6706040">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6706045">func</span>&nbsp;<span class="op" id="6706050">(</span><span class="ident" id="6706051"><a href="/encoding/json/encode_test.go.html#6706038">C</a></span><span class="op" id="6706052">)</span>&nbsp;<span class="ident" id="6706054">MarshalJSON</span><span class="op" id="6706065">(</span><span class="op" id="6706066">)</span>&nbsp;<span class="op" id="6706068">(</span><span class="op" id="6706069">[</span><span class="op" id="6706070">]</span><span class="builtintype" id="6706071">byte</span><span class="op" id="6706075">,</span>&nbsp;<span class="builtintype" id="6706077">error</span><span class="op" id="6706082">)</span>&nbsp;<span class="op" id="6706084">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706087">return</span>&nbsp;<span class="op" id="6706094">[</span><span class="op" id="6706095">]</span><span class="builtintype" id="6706096">byte</span><span class="op" id="6706100">(</span><span class="string" id="6706101">`&#34;&lt;&amp;&gt;&#34;`</span><span class="op" id="6706108">)</span><span class="op" id="6706109">,</span>&nbsp;<span class="ident" id="6706111">nil</span><br>
<span class="lineno"></span><span class="op" id="6706115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6706118">//&nbsp;CText&nbsp;implements&nbsp;Marshaler&nbsp;and&nbsp;returns&nbsp;unescaped&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="6706176">type</span>&nbsp;<span class="ident" id="6706181">CText</span>&nbsp;<span class="builtintype" id="6706187">int</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="keyword" id="6706192">func</span>&nbsp;<span class="op" id="6706197">(</span><span class="ident" id="6706198"><a href="/encoding/json/encode_test.go.html#6706181">CText</a></span><span class="op" id="6706203">)</span>&nbsp;<span class="ident" id="6706205">MarshalText</span><span class="op" id="6706216">(</span><span class="op" id="6706217">)</span>&nbsp;<span class="op" id="6706219">(</span><span class="op" id="6706220">[</span><span class="op" id="6706221">]</span><span class="builtintype" id="6706222">byte</span><span class="op" id="6706226">,</span>&nbsp;<span class="builtintype" id="6706228">error</span><span class="op" id="6706233">)</span>&nbsp;<span class="op" id="6706235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706238">return</span>&nbsp;<span class="op" id="6706245">[</span><span class="op" id="6706246">]</span><span class="builtintype" id="6706247">byte</span><span class="op" id="6706251">(</span><span class="string" id="6706252">`&#34;&lt;&amp;&gt;&#34;`</span><span class="op" id="6706259">)</span><span class="op" id="6706260">,</span>&nbsp;<span class="ident" id="6706262">nil</span><br>
<span class="lineno"></span><span class="op" id="6706266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="6706269">func</span>&nbsp;<span class="ident" id="6706274">TestMarshalerEscaping</span><span class="op" id="6706295">(</span><span class="ident" id="6706296">t</span>&nbsp;<span class="op" id="6706298">*</span><span class="ident" id="6706299"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6706306">.</span><span class="ident" id="6706307">T</span><span class="op" id="6706308">)</span>&nbsp;<span class="op" id="6706310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706313">var</span>&nbsp;<span class="ident" id="6706317">c</span>&nbsp;<span class="ident" id="6706319"><a href="/encoding/json/encode_test.go.html#6706038">C</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706322">want</span>&nbsp;<span class="op" id="6706327">:=</span>&nbsp;<span class="string" id="6706330">`&#34;\u003c\u0026\u003e&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706354">b</span><span class="op" id="6706355">,</span>&nbsp;<span class="ident" id="6706357">err</span>&nbsp;<span class="op" id="6706361">:=</span>&nbsp;<span class="ident" id="6706364"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6706371">(</span><span class="ident" id="6706372"><a href="/encoding/json/encode_test.go.html#6706317">c</a></span><span class="op" id="6706373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706376">if</span>&nbsp;<span class="ident" id="6706379"><a href="/encoding/json/encode_test.go.html#6706357">err</a></span>&nbsp;<span class="op" id="6706383">!=</span>&nbsp;<span class="ident" id="6706386">nil</span>&nbsp;<span class="op" id="6706390">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706394"><a href="/encoding/json/encode_test.go.html#6706296">t</a></span><span class="op" id="6706395">.</span><span class="ident" id="6706396">Fatalf</span><span class="op" id="6706402">(</span><span class="string" id="6706403">&#34;Marshal(c):&nbsp;%v&#34;</span><span class="op" id="6706419">,</span>&nbsp;<span class="ident" id="6706421"><a href="/encoding/json/encode_test.go.html#6706357">err</a></span><span class="op" id="6706424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6706427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706430">if</span>&nbsp;<span class="ident" id="6706433">got</span>&nbsp;<span class="op" id="6706437">:=</span>&nbsp;<span class="builtintype" id="6706440">string</span><span class="op" id="6706446">(</span><span class="ident" id="6706447"><a href="/encoding/json/encode_test.go.html#6706354">b</a></span><span class="op" id="6706448">)</span><span class="op" id="6706449">;</span>&nbsp;<span class="ident" id="6706451"><a href="/encoding/json/encode_test.go.html#6706433">got</a></span>&nbsp;<span class="op" id="6706455">!=</span>&nbsp;<span class="ident" id="6706458"><a href="/encoding/json/encode_test.go.html#6706322">want</a></span>&nbsp;<span class="op" id="6706463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706467"><a href="/encoding/json/encode_test.go.html#6706296">t</a></span><span class="op" id="6706468">.</span><span class="ident" id="6706469">Errorf</span><span class="op" id="6706475">(</span><span class="string" id="6706476">&#34;Marshal(c)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6706504">,</span>&nbsp;<span class="ident" id="6706506"><a href="/encoding/json/encode_test.go.html#6706433">got</a></span><span class="op" id="6706509">,</span>&nbsp;<span class="ident" id="6706511"><a href="/encoding/json/encode_test.go.html#6706322">want</a></span><span class="op" id="6706515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6706518">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706522">var</span>&nbsp;<span class="ident" id="6706526">ct</span>&nbsp;<span class="ident" id="6706529"><a href="/encoding/json/encode_test.go.html#6706181">CText</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706536"><a href="/encoding/json/encode_test.go.html#6706322">want</a></span>&nbsp;<span class="op" id="6706541">=</span>&nbsp;<span class="string" id="6706543">`&#34;\&#34;\u003c\u0026\u003e\&#34;&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706571"><a href="/encoding/json/encode_test.go.html#6706354">b</a></span><span class="op" id="6706572">,</span>&nbsp;<span class="ident" id="6706574"><a href="/encoding/json/encode_test.go.html#6706357">err</a></span>&nbsp;<span class="op" id="6706578">=</span>&nbsp;<span class="ident" id="6706580"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6706587">(</span><span class="ident" id="6706588"><a href="/encoding/json/encode_test.go.html#6706526">ct</a></span><span class="op" id="6706590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706593">if</span>&nbsp;<span class="ident" id="6706596"><a href="/encoding/json/encode_test.go.html#6706357">err</a></span>&nbsp;<span class="op" id="6706600">!=</span>&nbsp;<span class="ident" id="6706603">nil</span>&nbsp;<span class="op" id="6706607">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706611"><a href="/encoding/json/encode_test.go.html#6706296">t</a></span><span class="op" id="6706612">.</span><span class="ident" id="6706613">Fatalf</span><span class="op" id="6706619">(</span><span class="string" id="6706620">&#34;Marshal(ct):&nbsp;%v&#34;</span><span class="op" id="6706637">,</span>&nbsp;<span class="ident" id="6706639"><a href="/encoding/json/encode_test.go.html#6706357">err</a></span><span class="op" id="6706642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6706645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706648">if</span>&nbsp;<span class="ident" id="6706651">got</span>&nbsp;<span class="op" id="6706655">:=</span>&nbsp;<span class="builtintype" id="6706658">string</span><span class="op" id="6706664">(</span><span class="ident" id="6706665"><a href="/encoding/json/encode_test.go.html#6706354">b</a></span><span class="op" id="6706666">)</span><span class="op" id="6706667">;</span>&nbsp;<span class="ident" id="6706669"><a href="/encoding/json/encode_test.go.html#6706651">got</a></span>&nbsp;<span class="op" id="6706673">!=</span>&nbsp;<span class="ident" id="6706676"><a href="/encoding/json/encode_test.go.html#6706322">want</a></span>&nbsp;<span class="op" id="6706681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706685"><a href="/encoding/json/encode_test.go.html#6706296">t</a></span><span class="op" id="6706686">.</span><span class="ident" id="6706687">Errorf</span><span class="op" id="6706693">(</span><span class="string" id="6706694">&#34;Marshal(ct)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6706723">,</span>&nbsp;<span class="ident" id="6706725"><a href="/encoding/json/encode_test.go.html#6706651">got</a></span><span class="op" id="6706728">,</span>&nbsp;<span class="ident" id="6706730"><a href="/encoding/json/encode_test.go.html#6706322">want</a></span><span class="op" id="6706734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6706737">}</span><br>
<span class="lineno">250</span><span class="op" id="6706739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6706742">type</span>&nbsp;<span class="ident" id="6706747">IntType</span>&nbsp;<span class="builtintype" id="6706755">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6706760">type</span>&nbsp;<span class="ident" id="6706765">MyStruct</span>&nbsp;<span class="keyword" id="6706774">struct</span>&nbsp;<span class="op" id="6706781">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706784"><a href="/encoding/json/encode_test.go.html#6706747">IntType</a></span><br>
<span class="lineno"></span><span class="op" id="6706792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6706795">func</span>&nbsp;<span class="ident" id="6706800">TestAnonymousNonstruct</span><span class="op" id="6706822">(</span><span class="ident" id="6706823">t</span>&nbsp;<span class="op" id="6706825">*</span><span class="ident" id="6706826"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6706833">.</span><span class="ident" id="6706834">T</span><span class="op" id="6706835">)</span>&nbsp;<span class="op" id="6706837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706840">var</span>&nbsp;<span class="ident" id="6706844">i</span>&nbsp;<span class="ident" id="6706846"><a href="/encoding/json/encode_test.go.html#6706747">IntType</a></span>&nbsp;<span class="op" id="6706854">=</span>&nbsp;<span class="num" id="6706856">11</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706860">a</span>&nbsp;<span class="op" id="6706862">:=</span>&nbsp;<span class="ident" id="6706865"><a href="/encoding/json/encode_test.go.html#6706765">MyStruct</a></span><span class="op" id="6706873">{</span><span class="ident" id="6706874"><a href="/encoding/json/encode_test.go.html#6706844">i</a></span><span class="op" id="6706875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706878">const</span>&nbsp;<span class="ident" id="6706884">want</span>&nbsp;<span class="op" id="6706889">=</span>&nbsp;<span class="string" id="6706891">`{&#34;IntType&#34;:11}`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706910">b</span><span class="op" id="6706911">,</span>&nbsp;<span class="ident" id="6706913">err</span>&nbsp;<span class="op" id="6706917">:=</span>&nbsp;<span class="ident" id="6706920"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6706927">(</span><span class="ident" id="6706928"><a href="/encoding/json/encode_test.go.html#6706860">a</a></span><span class="op" id="6706929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706932">if</span>&nbsp;<span class="ident" id="6706935"><a href="/encoding/json/encode_test.go.html#6706913">err</a></span>&nbsp;<span class="op" id="6706939">!=</span>&nbsp;<span class="ident" id="6706942">nil</span>&nbsp;<span class="op" id="6706946">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6706950"><a href="/encoding/json/encode_test.go.html#6706823">t</a></span><span class="op" id="6706951">.</span><span class="ident" id="6706952">Fatalf</span><span class="op" id="6706958">(</span><span class="string" id="6706959">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="6706972">,</span>&nbsp;<span class="ident" id="6706974"><a href="/encoding/json/encode_test.go.html#6706913">err</a></span><span class="op" id="6706977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6706980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6706983">if</span>&nbsp;<span class="ident" id="6706986">got</span>&nbsp;<span class="op" id="6706990">:=</span>&nbsp;<span class="builtintype" id="6706993">string</span><span class="op" id="6706999">(</span><span class="ident" id="6707000"><a href="/encoding/json/encode_test.go.html#6706910">b</a></span><span class="op" id="6707001">)</span><span class="op" id="6707002">;</span>&nbsp;<span class="ident" id="6707004"><a href="/encoding/json/encode_test.go.html#6706986">got</a></span>&nbsp;<span class="op" id="6707008">!=</span>&nbsp;<span class="ident" id="6707011"><a href="/encoding/json/encode_test.go.html#6706884">want</a></span>&nbsp;<span class="op" id="6707016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707020"><a href="/encoding/json/encode_test.go.html#6706823">t</a></span><span class="op" id="6707021">.</span><span class="ident" id="6707022">Errorf</span><span class="op" id="6707028">(</span><span class="string" id="6707029">&#34;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6707046">,</span>&nbsp;<span class="ident" id="6707048"><a href="/encoding/json/encode_test.go.html#6706986">got</a></span><span class="op" id="6707051">,</span>&nbsp;<span class="ident" id="6707053"><a href="/encoding/json/encode_test.go.html#6706884">want</a></span><span class="op" id="6707057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707060">}</span><br>
<span class="lineno">270</span><span class="op" id="6707062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6707065">type</span>&nbsp;<span class="ident" id="6707070">BugA</span>&nbsp;<span class="keyword" id="6707075">struct</span>&nbsp;<span class="op" id="6707082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707085">S</span>&nbsp;<span class="builtintype" id="6707087">string</span><br>
<span class="lineno"></span><span class="op" id="6707094">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="keyword" id="6707097">type</span>&nbsp;<span class="ident" id="6707102">BugB</span>&nbsp;<span class="keyword" id="6707107">struct</span>&nbsp;<span class="op" id="6707114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707117"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707123">S</span>&nbsp;<span class="builtintype" id="6707125">string</span><br>
<span class="lineno"></span><span class="op" id="6707132">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="6707135">type</span>&nbsp;<span class="ident" id="6707140">BugC</span>&nbsp;<span class="keyword" id="6707145">struct</span>&nbsp;<span class="op" id="6707152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707155">S</span>&nbsp;<span class="builtintype" id="6707157">string</span><br>
<span class="lineno"></span><span class="op" id="6707164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="comment" id="6707167">//&nbsp;Legal&nbsp;Go:&nbsp;We&nbsp;never&nbsp;use&nbsp;the&nbsp;repeated&nbsp;embedded&nbsp;field&nbsp;(S).</span><br>
<span class="lineno"></span><span class="keyword" id="6707226">type</span>&nbsp;<span class="ident" id="6707231">BugX</span>&nbsp;<span class="keyword" id="6707236">struct</span>&nbsp;<span class="op" id="6707243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707246">A</span>&nbsp;<span class="builtintype" id="6707248">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707253"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707259"><a href="/encoding/json/encode_test.go.html#6707102">BugB</a></span><br>
<span class="lineno">290</span><span class="op" id="6707264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6707267">//&nbsp;Issue&nbsp;5245.</span><br>
<span class="lineno"></span><span class="keyword" id="6707282">func</span>&nbsp;<span class="ident" id="6707287">TestEmbeddedBug</span><span class="op" id="6707302">(</span><span class="ident" id="6707303">t</span>&nbsp;<span class="op" id="6707305">*</span><span class="ident" id="6707306"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6707313">.</span><span class="ident" id="6707314">T</span><span class="op" id="6707315">)</span>&nbsp;<span class="op" id="6707317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707320">v</span>&nbsp;<span class="op" id="6707322">:=</span>&nbsp;<span class="ident" id="6707325"><a href="/encoding/json/encode_test.go.html#6707102">BugB</a></span><span class="op" id="6707329">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707333"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><span class="op" id="6707337">{</span><span class="string" id="6707338">&#34;A&#34;</span><span class="op" id="6707341">}</span><span class="op" id="6707342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6707346">&#34;B&#34;</span><span class="op" id="6707349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707355">b</span><span class="op" id="6707356">,</span>&nbsp;<span class="ident" id="6707358">err</span>&nbsp;<span class="op" id="6707362">:=</span>&nbsp;<span class="ident" id="6707365"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6707372">(</span><span class="ident" id="6707373"><a href="/encoding/json/encode_test.go.html#6707320">v</a></span><span class="op" id="6707374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6707377">if</span>&nbsp;<span class="ident" id="6707380"><a href="/encoding/json/encode_test.go.html#6707358">err</a></span>&nbsp;<span class="op" id="6707384">!=</span>&nbsp;<span class="ident" id="6707387">nil</span>&nbsp;<span class="op" id="6707391">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707395"><a href="/encoding/json/encode_test.go.html#6707303">t</a></span><span class="op" id="6707396">.</span><span class="ident" id="6707397">Fatal</span><span class="op" id="6707402">(</span><span class="string" id="6707403">&#34;Marshal:&#34;</span><span class="op" id="6707413">,</span>&nbsp;<span class="ident" id="6707415"><a href="/encoding/json/encode_test.go.html#6707358">err</a></span><span class="op" id="6707418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707424">want</span>&nbsp;<span class="op" id="6707429">:=</span>&nbsp;<span class="string" id="6707432">`{&#34;S&#34;:&#34;B&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707445">got</span>&nbsp;<span class="op" id="6707449">:=</span>&nbsp;<span class="builtintype" id="6707452">string</span><span class="op" id="6707458">(</span><span class="ident" id="6707459"><a href="/encoding/json/encode_test.go.html#6707355">b</a></span><span class="op" id="6707460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6707463">if</span>&nbsp;<span class="ident" id="6707466"><a href="/encoding/json/encode_test.go.html#6707445">got</a></span>&nbsp;<span class="op" id="6707470">!=</span>&nbsp;<span class="ident" id="6707473"><a href="/encoding/json/encode_test.go.html#6707424">want</a></span>&nbsp;<span class="op" id="6707478">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707482"><a href="/encoding/json/encode_test.go.html#6707303">t</a></span><span class="op" id="6707483">.</span><span class="ident" id="6707484">Fatalf</span><span class="op" id="6707490">(</span><span class="string" id="6707491">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6707516">,</span>&nbsp;<span class="ident" id="6707518"><a href="/encoding/json/encode_test.go.html#6707445">got</a></span><span class="op" id="6707521">,</span>&nbsp;<span class="ident" id="6707523"><a href="/encoding/json/encode_test.go.html#6707424">want</a></span><span class="op" id="6707527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6707533">//&nbsp;Now&nbsp;check&nbsp;that&nbsp;the&nbsp;duplicate&nbsp;field,&nbsp;S,&nbsp;does&nbsp;not&nbsp;appear.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707593">x</span>&nbsp;<span class="op" id="6707595">:=</span>&nbsp;<span class="ident" id="6707598"><a href="/encoding/json/encode_test.go.html#6707231">BugX</a></span><span class="op" id="6707602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707606">A</span><span class="op" id="6707607">:</span>&nbsp;<span class="num" id="6707609">23</span><span class="op" id="6707611">,</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707617"><a href="/encoding/json/encode_test.go.html#6707355">b</a></span><span class="op" id="6707618">,</span>&nbsp;<span class="ident" id="6707620"><a href="/encoding/json/encode_test.go.html#6707358">err</a></span>&nbsp;<span class="op" id="6707624">=</span>&nbsp;<span class="ident" id="6707626"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6707633">(</span><span class="ident" id="6707634"><a href="/encoding/json/encode_test.go.html#6707593">x</a></span><span class="op" id="6707635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6707638">if</span>&nbsp;<span class="ident" id="6707641"><a href="/encoding/json/encode_test.go.html#6707358">err</a></span>&nbsp;<span class="op" id="6707645">!=</span>&nbsp;<span class="ident" id="6707648">nil</span>&nbsp;<span class="op" id="6707652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707656"><a href="/encoding/json/encode_test.go.html#6707303">t</a></span><span class="op" id="6707657">.</span><span class="ident" id="6707658">Fatal</span><span class="op" id="6707663">(</span><span class="string" id="6707664">&#34;Marshal:&#34;</span><span class="op" id="6707674">,</span>&nbsp;<span class="ident" id="6707676"><a href="/encoding/json/encode_test.go.html#6707358">err</a></span><span class="op" id="6707679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707682">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707685"><a href="/encoding/json/encode_test.go.html#6707424">want</a></span>&nbsp;<span class="op" id="6707690">=</span>&nbsp;<span class="string" id="6707692">`{&#34;A&#34;:23}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707704"><a href="/encoding/json/encode_test.go.html#6707445">got</a></span>&nbsp;<span class="op" id="6707708">=</span>&nbsp;<span class="builtintype" id="6707710">string</span><span class="op" id="6707716">(</span><span class="ident" id="6707717"><a href="/encoding/json/encode_test.go.html#6707355">b</a></span><span class="op" id="6707718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6707721">if</span>&nbsp;<span class="ident" id="6707724"><a href="/encoding/json/encode_test.go.html#6707445">got</a></span>&nbsp;<span class="op" id="6707728">!=</span>&nbsp;<span class="ident" id="6707731"><a href="/encoding/json/encode_test.go.html#6707424">want</a></span>&nbsp;<span class="op" id="6707736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707740"><a href="/encoding/json/encode_test.go.html#6707303">t</a></span><span class="op" id="6707741">.</span><span class="ident" id="6707742">Fatalf</span><span class="op" id="6707748">(</span><span class="string" id="6707749">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6707774">,</span>&nbsp;<span class="ident" id="6707776"><a href="/encoding/json/encode_test.go.html#6707445">got</a></span><span class="op" id="6707779">,</span>&nbsp;<span class="ident" id="6707781"><a href="/encoding/json/encode_test.go.html#6707424">want</a></span><span class="op" id="6707785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6707788">}</span><br>
<span class="lineno">320</span><span class="op" id="6707790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6707793">type</span>&nbsp;<span class="ident" id="6707798">BugD</span>&nbsp;<span class="keyword" id="6707803">struct</span>&nbsp;<span class="op" id="6707810">{</span>&nbsp;<span class="comment" id="6707812">//&nbsp;Same&nbsp;as&nbsp;BugA&nbsp;after&nbsp;tagging.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707844">XXX</span>&nbsp;<span class="builtintype" id="6707848">string</span>&nbsp;<span class="string" id="6707855">`json:&#34;S&#34;`</span><br>
<span class="lineno"></span><span class="op" id="6707866">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="6707869">//&nbsp;BugD&#39;s&nbsp;tagged&nbsp;S&nbsp;field&nbsp;should&nbsp;dominate&nbsp;BugA&#39;s.</span><br>
<span class="lineno"></span><span class="keyword" id="6707918">type</span>&nbsp;<span class="ident" id="6707923">BugY</span>&nbsp;<span class="keyword" id="6707928">struct</span>&nbsp;<span class="op" id="6707935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707938"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6707944"><a href="/encoding/json/encode_test.go.html#6707798">BugD</a></span><br>
<span class="lineno">330</span><span class="op" id="6707949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6707952">//&nbsp;Test&nbsp;that&nbsp;a&nbsp;field&nbsp;with&nbsp;a&nbsp;tag&nbsp;dominates&nbsp;untagged&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="6708011">func</span>&nbsp;<span class="ident" id="6708016">TestTaggedFieldDominates</span><span class="op" id="6708040">(</span><span class="ident" id="6708041">t</span>&nbsp;<span class="op" id="6708043">*</span><span class="ident" id="6708044"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6708051">.</span><span class="ident" id="6708052">T</span><span class="op" id="6708053">)</span>&nbsp;<span class="op" id="6708055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708058">v</span>&nbsp;<span class="op" id="6708060">:=</span>&nbsp;<span class="ident" id="6708063"><a href="/encoding/json/encode_test.go.html#6707923">BugY</a></span><span class="op" id="6708067">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708071"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><span class="op" id="6708075">{</span><span class="string" id="6708076">&#34;BugA&#34;</span><span class="op" id="6708082">}</span><span class="op" id="6708083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708087"><a href="/encoding/json/encode_test.go.html#6707798">BugD</a></span><span class="op" id="6708091">{</span><span class="string" id="6708092">&#34;BugD&#34;</span><span class="op" id="6708098">}</span><span class="op" id="6708099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708105">b</span><span class="op" id="6708106">,</span>&nbsp;<span class="ident" id="6708108">err</span>&nbsp;<span class="op" id="6708112">:=</span>&nbsp;<span class="ident" id="6708115"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6708122">(</span><span class="ident" id="6708123"><a href="/encoding/json/encode_test.go.html#6708058">v</a></span><span class="op" id="6708124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708127">if</span>&nbsp;<span class="ident" id="6708130"><a href="/encoding/json/encode_test.go.html#6708108">err</a></span>&nbsp;<span class="op" id="6708134">!=</span>&nbsp;<span class="ident" id="6708137">nil</span>&nbsp;<span class="op" id="6708141">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708145"><a href="/encoding/json/encode_test.go.html#6708041">t</a></span><span class="op" id="6708146">.</span><span class="ident" id="6708147">Fatal</span><span class="op" id="6708152">(</span><span class="string" id="6708153">&#34;Marshal:&#34;</span><span class="op" id="6708163">,</span>&nbsp;<span class="ident" id="6708165"><a href="/encoding/json/encode_test.go.html#6708108">err</a></span><span class="op" id="6708168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708174">want</span>&nbsp;<span class="op" id="6708179">:=</span>&nbsp;<span class="string" id="6708182">`{&#34;S&#34;:&#34;BugD&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708198">got</span>&nbsp;<span class="op" id="6708202">:=</span>&nbsp;<span class="builtintype" id="6708205">string</span><span class="op" id="6708211">(</span><span class="ident" id="6708212"><a href="/encoding/json/encode_test.go.html#6708105">b</a></span><span class="op" id="6708213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708216">if</span>&nbsp;<span class="ident" id="6708219"><a href="/encoding/json/encode_test.go.html#6708198">got</a></span>&nbsp;<span class="op" id="6708223">!=</span>&nbsp;<span class="ident" id="6708226"><a href="/encoding/json/encode_test.go.html#6708174">want</a></span>&nbsp;<span class="op" id="6708231">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708235"><a href="/encoding/json/encode_test.go.html#6708041">t</a></span><span class="op" id="6708236">.</span><span class="ident" id="6708237">Fatalf</span><span class="op" id="6708243">(</span><span class="string" id="6708244">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6708269">,</span>&nbsp;<span class="ident" id="6708271"><a href="/encoding/json/encode_test.go.html#6708198">got</a></span><span class="op" id="6708274">,</span>&nbsp;<span class="ident" id="6708276"><a href="/encoding/json/encode_test.go.html#6708174">want</a></span><span class="op" id="6708280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708283">}</span><br>
<span class="lineno"></span><span class="op" id="6708285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6708288">//&nbsp;There&nbsp;are&nbsp;no&nbsp;tags&nbsp;here,&nbsp;so&nbsp;S&nbsp;should&nbsp;not&nbsp;appear.</span><br>
<span class="lineno">350</span><span class="keyword" id="6708339">type</span>&nbsp;<span class="ident" id="6708344">BugZ</span>&nbsp;<span class="keyword" id="6708349">struct</span>&nbsp;<span class="op" id="6708356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708359"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708365"><a href="/encoding/json/encode_test.go.html#6707140">BugC</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708371"><a href="/encoding/json/encode_test.go.html#6707923">BugY</a></span>&nbsp;<span class="comment" id="6708376">//&nbsp;Contains&nbsp;a&nbsp;tagged&nbsp;S&nbsp;field&nbsp;through&nbsp;BugD;&nbsp;should&nbsp;not&nbsp;dominate.</span><br>
<span class="lineno"></span><span class="op" id="6708440">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="keyword" id="6708443">func</span>&nbsp;<span class="ident" id="6708448">TestDuplicatedFieldDisappears</span><span class="op" id="6708477">(</span><span class="ident" id="6708478">t</span>&nbsp;<span class="op" id="6708480">*</span><span class="ident" id="6708481"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6708488">.</span><span class="ident" id="6708489">T</span><span class="op" id="6708490">)</span>&nbsp;<span class="op" id="6708492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708495">v</span>&nbsp;<span class="op" id="6708497">:=</span>&nbsp;<span class="ident" id="6708500"><a href="/encoding/json/encode_test.go.html#6708344">BugZ</a></span><span class="op" id="6708504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708508"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><span class="op" id="6708512">{</span><span class="string" id="6708513">&#34;BugA&#34;</span><span class="op" id="6708519">}</span><span class="op" id="6708520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708524"><a href="/encoding/json/encode_test.go.html#6707140">BugC</a></span><span class="op" id="6708528">{</span><span class="string" id="6708529">&#34;BugC&#34;</span><span class="op" id="6708535">}</span><span class="op" id="6708536">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708540"><a href="/encoding/json/encode_test.go.html#6707923">BugY</a></span><span class="op" id="6708544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708549"><a href="/encoding/json/encode_test.go.html#6707070">BugA</a></span><span class="op" id="6708553">{</span><span class="string" id="6708554">&#34;nested&nbsp;BugA&#34;</span><span class="op" id="6708567">}</span><span class="op" id="6708568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708573"><a href="/encoding/json/encode_test.go.html#6707798">BugD</a></span><span class="op" id="6708577">{</span><span class="string" id="6708578">&#34;nested&nbsp;BugD&#34;</span><span class="op" id="6708591">}</span><span class="op" id="6708592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708596">}</span><span class="op" id="6708597">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708600">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708603">b</span><span class="op" id="6708604">,</span>&nbsp;<span class="ident" id="6708606">err</span>&nbsp;<span class="op" id="6708610">:=</span>&nbsp;<span class="ident" id="6708613"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6708620">(</span><span class="ident" id="6708621"><a href="/encoding/json/encode_test.go.html#6708495">v</a></span><span class="op" id="6708622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708625">if</span>&nbsp;<span class="ident" id="6708628"><a href="/encoding/json/encode_test.go.html#6708606">err</a></span>&nbsp;<span class="op" id="6708632">!=</span>&nbsp;<span class="ident" id="6708635">nil</span>&nbsp;<span class="op" id="6708639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708643"><a href="/encoding/json/encode_test.go.html#6708478">t</a></span><span class="op" id="6708644">.</span><span class="ident" id="6708645">Fatal</span><span class="op" id="6708650">(</span><span class="string" id="6708651">&#34;Marshal:&#34;</span><span class="op" id="6708661">,</span>&nbsp;<span class="ident" id="6708663"><a href="/encoding/json/encode_test.go.html#6708606">err</a></span><span class="op" id="6708666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708672">want</span>&nbsp;<span class="op" id="6708677">:=</span>&nbsp;<span class="string" id="6708680">`{}`</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708686">got</span>&nbsp;<span class="op" id="6708690">:=</span>&nbsp;<span class="builtintype" id="6708693">string</span><span class="op" id="6708699">(</span><span class="ident" id="6708700"><a href="/encoding/json/encode_test.go.html#6708603">b</a></span><span class="op" id="6708701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708704">if</span>&nbsp;<span class="ident" id="6708707"><a href="/encoding/json/encode_test.go.html#6708686">got</a></span>&nbsp;<span class="op" id="6708711">!=</span>&nbsp;<span class="ident" id="6708714"><a href="/encoding/json/encode_test.go.html#6708672">want</a></span>&nbsp;<span class="op" id="6708719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708723"><a href="/encoding/json/encode_test.go.html#6708478">t</a></span><span class="op" id="6708724">.</span><span class="ident" id="6708725">Fatalf</span><span class="op" id="6708731">(</span><span class="string" id="6708732">&#34;Marshal:&nbsp;got&nbsp;%s&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6708757">,</span>&nbsp;<span class="ident" id="6708759"><a href="/encoding/json/encode_test.go.html#6708686">got</a></span><span class="op" id="6708762">,</span>&nbsp;<span class="ident" id="6708764"><a href="/encoding/json/encode_test.go.html#6708672">want</a></span><span class="op" id="6708768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6708771">}</span><br>
<span class="lineno"></span><span class="op" id="6708773">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6708776">func</span>&nbsp;<span class="ident" id="6708781">TestStringBytes</span><span class="op" id="6708796">(</span><span class="ident" id="6708797">t</span>&nbsp;<span class="op" id="6708799">*</span><span class="ident" id="6708800"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6708807">.</span><span class="ident" id="6708808">T</span><span class="op" id="6708809">)</span>&nbsp;<span class="op" id="6708811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6708814">//&nbsp;Test&nbsp;that&nbsp;encodeState.stringBytes&nbsp;and&nbsp;encodeState.string&nbsp;use&nbsp;the&nbsp;same&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708898">es</span>&nbsp;<span class="op" id="6708901">:=</span>&nbsp;<span class="op" id="6708904">&amp;</span><span class="ident" id="6708905"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="6708916">{</span><span class="op" id="6708917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708920">var</span>&nbsp;<span class="ident" id="6708924">r</span>&nbsp;<span class="op" id="6708926">[</span><span class="op" id="6708927">]</span><span class="builtintype" id="6708928">rune</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6708934">for</span>&nbsp;<span class="ident" id="6708938">i</span>&nbsp;<span class="op" id="6708940">:=</span>&nbsp;<span class="string" id="6708943">&#39;\u0000&#39;</span><span class="op" id="6708951">;</span>&nbsp;<span class="ident" id="6708953"><a href="/encoding/json/encode_test.go.html#6708938">i</a></span>&nbsp;<span class="op" id="6708955">&lt;=</span>&nbsp;<span class="ident" id="6708958"><a href="/encoding/json/encode_test.go.html#6701832">unicode</a></span><span class="op" id="6708965">.</span><span class="ident" id="6708966">MaxRune</span><span class="op" id="6708973">;</span>&nbsp;<span class="ident" id="6708975"><a href="/encoding/json/encode_test.go.html#6708938">i</a></span><span class="op" id="6708976">++</span>&nbsp;<span class="op" id="6708979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6708983"><a href="/encoding/json/encode_test.go.html#6708924">r</a></span>&nbsp;<span class="op" id="6708985">=</span>&nbsp;<span class="builtinfunc" id="6708987">append</span><span class="op" id="6708993">(</span><span class="ident" id="6708994"><a href="/encoding/json/encode_test.go.html#6708924">r</a></span><span class="op" id="6708995">,</span>&nbsp;<span class="ident" id="6708997"><a href="/encoding/json/encode_test.go.html#6708938">i</a></span><span class="op" id="6708998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709004">s</span>&nbsp;<span class="op" id="6709006">:=</span>&nbsp;<span class="builtintype" id="6709009">string</span><span class="op" id="6709015">(</span><span class="ident" id="6709016"><a href="/encoding/json/encode_test.go.html#6708924">r</a></span><span class="op" id="6709017">)</span>&nbsp;<span class="op" id="6709019">+</span>&nbsp;<span class="string" id="6709021">&#34;\xff\xff\xffhello&#34;</span>&nbsp;<span class="comment" id="6709041">//&nbsp;some&nbsp;invalid&nbsp;UTF-8&nbsp;too</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709068">_</span><span class="op" id="6709069">,</span>&nbsp;<span class="ident" id="6709071">err</span>&nbsp;<span class="op" id="6709075">:=</span>&nbsp;<span class="ident" id="6709078"><a href="/encoding/json/encode_test.go.html#6708898">es</a></span><span class="op" id="6709080">.</span><span class="builtintype" id="6709081">string</span><span class="op" id="6709087">(</span><span class="ident" id="6709088"><a href="/encoding/json/encode_test.go.html#6709004">s</a></span><span class="op" id="6709089">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709092">if</span>&nbsp;<span class="ident" id="6709095"><a href="/encoding/json/encode_test.go.html#6709071">err</a></span>&nbsp;<span class="op" id="6709099">!=</span>&nbsp;<span class="ident" id="6709102">nil</span>&nbsp;<span class="op" id="6709106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709110"><a href="/encoding/json/encode_test.go.html#6708797">t</a></span><span class="op" id="6709111">.</span><span class="ident" id="6709112">Fatal</span><span class="op" id="6709117">(</span><span class="ident" id="6709118"><a href="/encoding/json/encode_test.go.html#6709071">err</a></span><span class="op" id="6709121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709128">esBytes</span>&nbsp;<span class="op" id="6709136">:=</span>&nbsp;<span class="op" id="6709139">&amp;</span><span class="ident" id="6709140"><a href="/encoding/json/encode.go.html#4756540">encodeState</a></span><span class="op" id="6709151">{</span><span class="op" id="6709152">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709155">_</span><span class="op" id="6709156">,</span>&nbsp;<span class="ident" id="6709158"><a href="/encoding/json/encode_test.go.html#6709071">err</a></span>&nbsp;<span class="op" id="6709162">=</span>&nbsp;<span class="ident" id="6709164"><a href="/encoding/json/encode_test.go.html#6709128">esBytes</a></span><span class="op" id="6709171">.</span><span class="ident" id="6709172">stringBytes</span><span class="op" id="6709183">(</span><span class="op" id="6709184">[</span><span class="op" id="6709185">]</span><span class="builtintype" id="6709186">byte</span><span class="op" id="6709190">(</span><span class="ident" id="6709191"><a href="/encoding/json/encode_test.go.html#6709004">s</a></span><span class="op" id="6709192">)</span><span class="op" id="6709193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709196">if</span>&nbsp;<span class="ident" id="6709199"><a href="/encoding/json/encode_test.go.html#6709071">err</a></span>&nbsp;<span class="op" id="6709203">!=</span>&nbsp;<span class="ident" id="6709206">nil</span>&nbsp;<span class="op" id="6709210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709214"><a href="/encoding/json/encode_test.go.html#6708797">t</a></span><span class="op" id="6709215">.</span><span class="ident" id="6709216">Fatal</span><span class="op" id="6709221">(</span><span class="ident" id="6709222"><a href="/encoding/json/encode_test.go.html#6709071">err</a></span><span class="op" id="6709225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709232">enc</span>&nbsp;<span class="op" id="6709236">:=</span>&nbsp;<span class="ident" id="6709239"><a href="/encoding/json/encode_test.go.html#6708898">es</a></span><span class="op" id="6709241">.</span><span class="ident" id="6709242">Buffer</span><span class="op" id="6709248">.</span><span class="ident" id="6709249">String</span><span class="op" id="6709255">(</span><span class="op" id="6709256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709259">encBytes</span>&nbsp;<span class="op" id="6709268">:=</span>&nbsp;<span class="ident" id="6709271"><a href="/encoding/json/encode_test.go.html#6709128">esBytes</a></span><span class="op" id="6709278">.</span><span class="ident" id="6709279">Buffer</span><span class="op" id="6709285">.</span><span class="ident" id="6709286">String</span><span class="op" id="6709292">(</span><span class="op" id="6709293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709296">if</span>&nbsp;<span class="ident" id="6709299"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span>&nbsp;<span class="op" id="6709303">!=</span>&nbsp;<span class="ident" id="6709306"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span>&nbsp;<span class="op" id="6709315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709319">i</span>&nbsp;<span class="op" id="6709321">:=</span>&nbsp;<span class="num" id="6709324">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709328">for</span>&nbsp;<span class="ident" id="6709332"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span>&nbsp;<span class="op" id="6709334">&lt;</span>&nbsp;<span class="builtinfunc" id="6709336">len</span><span class="op" id="6709339">(</span><span class="ident" id="6709340"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709343">)</span>&nbsp;<span class="op" id="6709345">&amp;&amp;</span>&nbsp;<span class="ident" id="6709348"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span>&nbsp;<span class="op" id="6709350">&lt;</span>&nbsp;<span class="builtinfunc" id="6709352">len</span><span class="op" id="6709355">(</span><span class="ident" id="6709356"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709364">)</span>&nbsp;<span class="op" id="6709366">&amp;&amp;</span>&nbsp;<span class="ident" id="6709369"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709372">[</span><span class="ident" id="6709373"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709374">]</span>&nbsp;<span class="op" id="6709376">==</span>&nbsp;<span class="ident" id="6709379"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709387">[</span><span class="ident" id="6709388"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709389">]</span>&nbsp;<span class="op" id="6709391">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709396"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709397">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709406"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span>&nbsp;<span class="op" id="6709410">=</span>&nbsp;<span class="ident" id="6709412"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709415">[</span><span class="ident" id="6709416"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709417">:</span><span class="op" id="6709418">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709422"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span>&nbsp;<span class="op" id="6709431">=</span>&nbsp;<span class="ident" id="6709433"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709441">[</span><span class="ident" id="6709442"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709443">:</span><span class="op" id="6709444">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709448"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span>&nbsp;<span class="op" id="6709450">=</span>&nbsp;<span class="num" id="6709452">0</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709456">for</span>&nbsp;<span class="ident" id="6709460"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span>&nbsp;<span class="op" id="6709462">&lt;</span>&nbsp;<span class="builtinfunc" id="6709464">len</span><span class="op" id="6709467">(</span><span class="ident" id="6709468"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709471">)</span>&nbsp;<span class="op" id="6709473">&amp;&amp;</span>&nbsp;<span class="ident" id="6709476"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span>&nbsp;<span class="op" id="6709478">&lt;</span>&nbsp;<span class="builtinfunc" id="6709480">len</span><span class="op" id="6709483">(</span><span class="ident" id="6709484"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709492">)</span>&nbsp;<span class="op" id="6709494">&amp;&amp;</span>&nbsp;<span class="ident" id="6709497"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709500">[</span><span class="builtinfunc" id="6709501">len</span><span class="op" id="6709504">(</span><span class="ident" id="6709505"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709508">)</span><span class="op" id="6709509">-</span><span class="ident" id="6709510"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709511">-</span><span class="num" id="6709512">1</span><span class="op" id="6709513">]</span>&nbsp;<span class="op" id="6709515">==</span>&nbsp;<span class="ident" id="6709518"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709526">[</span><span class="builtinfunc" id="6709527">len</span><span class="op" id="6709530">(</span><span class="ident" id="6709531"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709539">)</span><span class="op" id="6709540">-</span><span class="ident" id="6709541"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709542">-</span><span class="num" id="6709543">1</span><span class="op" id="6709544">]</span>&nbsp;<span class="op" id="6709546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709551"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709552">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709561"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span>&nbsp;<span class="op" id="6709565">=</span>&nbsp;<span class="ident" id="6709567"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709570">[</span><span class="op" id="6709571">:</span><span class="builtinfunc" id="6709572">len</span><span class="op" id="6709575">(</span><span class="ident" id="6709576"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709579">)</span><span class="op" id="6709580">-</span><span class="ident" id="6709581"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709582">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709586"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span>&nbsp;<span class="op" id="6709595">=</span>&nbsp;<span class="ident" id="6709597"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709605">[</span><span class="op" id="6709606">:</span><span class="builtinfunc" id="6709607">len</span><span class="op" id="6709610">(</span><span class="ident" id="6709611"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709619">)</span><span class="op" id="6709620">-</span><span class="ident" id="6709621"><a href="/encoding/json/encode_test.go.html#6709319">i</a></span><span class="op" id="6709622">]</span><br>
<span class="lineno">410</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709627">if</span>&nbsp;<span class="builtinfunc" id="6709630">len</span><span class="op" id="6709633">(</span><span class="ident" id="6709634"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709637">)</span>&nbsp;<span class="op" id="6709639">&gt;</span>&nbsp;<span class="num" id="6709641">20</span>&nbsp;<span class="op" id="6709644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709649"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span>&nbsp;<span class="op" id="6709653">=</span>&nbsp;<span class="ident" id="6709655"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709658">[</span><span class="op" id="6709659">:</span><span class="num" id="6709660">20</span><span class="op" id="6709662">]</span>&nbsp;<span class="op" id="6709664">+</span>&nbsp;<span class="string" id="6709666">&#34;...&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709678">if</span>&nbsp;<span class="builtinfunc" id="6709681">len</span><span class="op" id="6709684">(</span><span class="ident" id="6709685"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709693">)</span>&nbsp;<span class="op" id="6709695">&gt;</span>&nbsp;<span class="num" id="6709697">20</span>&nbsp;<span class="op" id="6709700">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709705"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span>&nbsp;<span class="op" id="6709714">=</span>&nbsp;<span class="ident" id="6709716"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709724">[</span><span class="op" id="6709725">:</span><span class="num" id="6709726">20</span><span class="op" id="6709728">]</span>&nbsp;<span class="op" id="6709730">+</span>&nbsp;<span class="string" id="6709732">&#34;...&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709745"><a href="/encoding/json/encode_test.go.html#6708797">t</a></span><span class="op" id="6709746">.</span><span class="ident" id="6709747">Errorf</span><span class="op" id="6709753">(</span><span class="string" id="6709754">&#34;encodings&nbsp;differ&nbsp;at&nbsp;%#q&nbsp;vs&nbsp;%#q&#34;</span><span class="op" id="6709786">,</span>&nbsp;<span class="ident" id="6709788"><a href="/encoding/json/encode_test.go.html#6709232">enc</a></span><span class="op" id="6709791">,</span>&nbsp;<span class="ident" id="6709793"><a href="/encoding/json/encode_test.go.html#6709259">encBytes</a></span><span class="op" id="6709801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709804">}</span><br>
<span class="lineno">420</span><span class="op" id="6709806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6709809">func</span>&nbsp;<span class="ident" id="6709814">TestIssue6458</span><span class="op" id="6709827">(</span><span class="ident" id="6709828">t</span>&nbsp;<span class="op" id="6709830">*</span><span class="ident" id="6709831"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6709838">.</span><span class="ident" id="6709839">T</span><span class="op" id="6709840">)</span>&nbsp;<span class="op" id="6709842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709845">type</span>&nbsp;<span class="ident" id="6709850">Foo</span>&nbsp;<span class="keyword" id="6709854">struct</span>&nbsp;<span class="op" id="6709861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709865">M</span>&nbsp;<span class="ident" id="6709867"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709882">x</span>&nbsp;<span class="op" id="6709884">:=</span>&nbsp;<span class="ident" id="6709887"><a href="/encoding/json/encode_test.go.html#6709850">Foo</a></span><span class="op" id="6709890">{</span><span class="ident" id="6709891"><a href="/encoding/json/stream.go.html#4806744">RawMessage</a></span><span class="op" id="6709901">(</span><span class="string" id="6709902">`&#34;foo&#34;`</span><span class="op" id="6709909">)</span><span class="op" id="6709910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709914">b</span><span class="op" id="6709915">,</span>&nbsp;<span class="ident" id="6709917">err</span>&nbsp;<span class="op" id="6709921">:=</span>&nbsp;<span class="ident" id="6709924"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6709931">(</span><span class="op" id="6709932">&amp;</span><span class="ident" id="6709933"><a href="/encoding/json/encode_test.go.html#6709882">x</a></span><span class="op" id="6709934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709937">if</span>&nbsp;<span class="ident" id="6709940"><a href="/encoding/json/encode_test.go.html#6709917">err</a></span>&nbsp;<span class="op" id="6709944">!=</span>&nbsp;<span class="ident" id="6709947">nil</span>&nbsp;<span class="op" id="6709951">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6709955"><a href="/encoding/json/encode_test.go.html#6709828">t</a></span><span class="op" id="6709956">.</span><span class="ident" id="6709957">Fatal</span><span class="op" id="6709962">(</span><span class="ident" id="6709963"><a href="/encoding/json/encode_test.go.html#6709917">err</a></span><span class="op" id="6709966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6709969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6709972">if</span>&nbsp;<span class="ident" id="6709975">want</span>&nbsp;<span class="op" id="6709980">:=</span>&nbsp;<span class="string" id="6709983">`{&#34;M&#34;:&#34;foo&#34;}`</span><span class="op" id="6709996">;</span>&nbsp;<span class="builtintype" id="6709998">string</span><span class="op" id="6710004">(</span><span class="ident" id="6710005"><a href="/encoding/json/encode_test.go.html#6709914">b</a></span><span class="op" id="6710006">)</span>&nbsp;<span class="op" id="6710008">!=</span>&nbsp;<span class="ident" id="6710011"><a href="/encoding/json/encode_test.go.html#6709975">want</a></span>&nbsp;<span class="op" id="6710016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710020"><a href="/encoding/json/encode_test.go.html#6709828">t</a></span><span class="op" id="6710021">.</span><span class="ident" id="6710022">Errorf</span><span class="op" id="6710028">(</span><span class="string" id="6710029">&#34;Marshal(&amp;x)&nbsp;=&nbsp;%#q;&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6710058">,</span>&nbsp;<span class="ident" id="6710060"><a href="/encoding/json/encode_test.go.html#6709914">b</a></span><span class="op" id="6710061">,</span>&nbsp;<span class="ident" id="6710063"><a href="/encoding/json/encode_test.go.html#6709975">want</a></span><span class="op" id="6710067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710070">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710074"><a href="/encoding/json/encode_test.go.html#6709914">b</a></span><span class="op" id="6710075">,</span>&nbsp;<span class="ident" id="6710077"><a href="/encoding/json/encode_test.go.html#6709917">err</a></span>&nbsp;<span class="op" id="6710081">=</span>&nbsp;<span class="ident" id="6710083"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6710090">(</span><span class="ident" id="6710091"><a href="/encoding/json/encode_test.go.html#6709882">x</a></span><span class="op" id="6710092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710095">if</span>&nbsp;<span class="ident" id="6710098"><a href="/encoding/json/encode_test.go.html#6709917">err</a></span>&nbsp;<span class="op" id="6710102">!=</span>&nbsp;<span class="ident" id="6710105">nil</span>&nbsp;<span class="op" id="6710109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710113"><a href="/encoding/json/encode_test.go.html#6709828">t</a></span><span class="op" id="6710114">.</span><span class="ident" id="6710115">Fatal</span><span class="op" id="6710120">(</span><span class="ident" id="6710121"><a href="/encoding/json/encode_test.go.html#6709917">err</a></span><span class="op" id="6710124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710127">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710131">if</span>&nbsp;<span class="ident" id="6710134">want</span>&nbsp;<span class="op" id="6710139">:=</span>&nbsp;<span class="string" id="6710142">`{&#34;M&#34;:&#34;ImZvbyI=&#34;}`</span><span class="op" id="6710160">;</span>&nbsp;<span class="builtintype" id="6710162">string</span><span class="op" id="6710168">(</span><span class="ident" id="6710169"><a href="/encoding/json/encode_test.go.html#6709914">b</a></span><span class="op" id="6710170">)</span>&nbsp;<span class="op" id="6710172">!=</span>&nbsp;<span class="ident" id="6710175"><a href="/encoding/json/encode_test.go.html#6710134">want</a></span>&nbsp;<span class="op" id="6710180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710184"><a href="/encoding/json/encode_test.go.html#6709828">t</a></span><span class="op" id="6710185">.</span><span class="ident" id="6710186">Errorf</span><span class="op" id="6710192">(</span><span class="string" id="6710193">&#34;Marshal(x)&nbsp;=&nbsp;%#q;&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6710221">,</span>&nbsp;<span class="ident" id="6710223"><a href="/encoding/json/encode_test.go.html#6709914">b</a></span><span class="op" id="6710224">,</span>&nbsp;<span class="ident" id="6710226"><a href="/encoding/json/encode_test.go.html#6710134">want</a></span><span class="op" id="6710230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710233">}</span><br>
<span class="lineno"></span><span class="op" id="6710235">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="6710238">func</span>&nbsp;<span class="ident" id="6710243">TestHTMLEscape</span><span class="op" id="6710257">(</span><span class="ident" id="6710258">t</span>&nbsp;<span class="op" id="6710260">*</span><span class="ident" id="6710261"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6710268">.</span><span class="ident" id="6710269">T</span><span class="op" id="6710270">)</span>&nbsp;<span class="op" id="6710272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710275">var</span>&nbsp;<span class="ident" id="6710279">b</span><span class="op" id="6710280">,</span>&nbsp;<span class="ident" id="6710282">want</span>&nbsp;<span class="ident" id="6710287"><a href="/encoding/json/encode_test.go.html#6701793">bytes</a></span><span class="op" id="6710292">.</span><span class="ident" id="6710293">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710301">m</span>&nbsp;<span class="op" id="6710303">:=</span>&nbsp;<span class="string" id="6710306">`{&#34;M&#34;:&#34;&lt;html&gt;foo&nbsp;&amp;`</span>&nbsp;<span class="op" id="6710326">+</span>&nbsp;<span class="string" id="6710328">&#34;\xe2\x80\xa8&nbsp;\xe2\x80\xa9&#34;</span>&nbsp;<span class="op" id="6710356">+</span>&nbsp;<span class="string" id="6710358">`&lt;/html&gt;&#34;}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710371"><a href="/encoding/json/encode_test.go.html#6710282">want</a></span><span class="op" id="6710375">.</span><span class="ident" id="6710376">Write</span><span class="op" id="6710381">(</span><span class="op" id="6710382">[</span><span class="op" id="6710383">]</span><span class="builtintype" id="6710384">byte</span><span class="op" id="6710388">(</span><span class="string" id="6710389">`{&#34;M&#34;:&#34;\u003chtml\u003efoo&nbsp;\u0026\u2028&nbsp;\u2029\u003c/html\u003e&#34;}`</span><span class="op" id="6710455">)</span><span class="op" id="6710456">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710459"><a href="/encoding/json/encode.go.html#4754352">HTMLEscape</a></span><span class="op" id="6710469">(</span><span class="op" id="6710470">&amp;</span><span class="ident" id="6710471"><a href="/encoding/json/encode_test.go.html#6710279">b</a></span><span class="op" id="6710472">,</span>&nbsp;<span class="op" id="6710474">[</span><span class="op" id="6710475">]</span><span class="builtintype" id="6710476">byte</span><span class="op" id="6710480">(</span><span class="ident" id="6710481"><a href="/encoding/json/encode_test.go.html#6710301">m</a></span><span class="op" id="6710482">)</span><span class="op" id="6710483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710486">if</span>&nbsp;<span class="op" id="6710489">!</span><span class="ident" id="6710490"><a href="/encoding/json/encode_test.go.html#6701793">bytes</a></span><span class="op" id="6710495">.</span><span class="ident" id="6710496">Equal</span><span class="op" id="6710501">(</span><span class="ident" id="6710502"><a href="/encoding/json/encode_test.go.html#6710279">b</a></span><span class="op" id="6710503">.</span><span class="ident" id="6710504">Bytes</span><span class="op" id="6710509">(</span><span class="op" id="6710510">)</span><span class="op" id="6710511">,</span>&nbsp;<span class="ident" id="6710513"><a href="/encoding/json/encode_test.go.html#6710282">want</a></span><span class="op" id="6710517">.</span><span class="ident" id="6710518">Bytes</span><span class="op" id="6710523">(</span><span class="op" id="6710524">)</span><span class="op" id="6710525">)</span>&nbsp;<span class="op" id="6710527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710531"><a href="/encoding/json/encode_test.go.html#6710258">t</a></span><span class="op" id="6710532">.</span><span class="ident" id="6710533">Errorf</span><span class="op" id="6710539">(</span><span class="string" id="6710540">&#34;HTMLEscape(&amp;b,&nbsp;[]byte(m))&nbsp;=&nbsp;%s;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6710581">,</span>&nbsp;<span class="ident" id="6710583"><a href="/encoding/json/encode_test.go.html#6710279">b</a></span><span class="op" id="6710584">.</span><span class="ident" id="6710585">Bytes</span><span class="op" id="6710590">(</span><span class="op" id="6710591">)</span><span class="op" id="6710592">,</span>&nbsp;<span class="ident" id="6710594"><a href="/encoding/json/encode_test.go.html#6710282">want</a></span><span class="op" id="6710598">.</span><span class="ident" id="6710599">Bytes</span><span class="op" id="6710604">(</span><span class="op" id="6710605">)</span><span class="op" id="6710606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710609">}</span><br>
<span class="lineno"></span><span class="op" id="6710611">}</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span><span class="comment" id="6710614">//&nbsp;golang.org/issue/8582</span><br>
<span class="lineno"></span><span class="keyword" id="6710639">func</span>&nbsp;<span class="ident" id="6710644">TestEncodePointerString</span><span class="op" id="6710667">(</span><span class="ident" id="6710668">t</span>&nbsp;<span class="op" id="6710670">*</span><span class="ident" id="6710671"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6710678">.</span><span class="ident" id="6710679">T</span><span class="op" id="6710680">)</span>&nbsp;<span class="op" id="6710682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710685">type</span>&nbsp;<span class="ident" id="6710690">stringPointer</span>&nbsp;<span class="keyword" id="6710704">struct</span>&nbsp;<span class="op" id="6710711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710715">N</span>&nbsp;<span class="op" id="6710717">*</span><span class="ident" id="6710718">int64</span>&nbsp;<span class="string" id="6710724">`json:&#34;n,string&#34;`</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710746">var</span>&nbsp;<span class="ident" id="6710750">n</span>&nbsp;<span class="ident" id="6710752">int64</span>&nbsp;<span class="op" id="6710758">=</span>&nbsp;<span class="num" id="6710760">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710764">b</span><span class="op" id="6710765">,</span>&nbsp;<span class="ident" id="6710767">err</span>&nbsp;<span class="op" id="6710771">:=</span>&nbsp;<span class="ident" id="6710774"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6710781">(</span><span class="ident" id="6710782"><a href="/encoding/json/encode_test.go.html#6710690">stringPointer</a></span><span class="op" id="6710795">{</span><span class="ident" id="6710796">N</span><span class="op" id="6710797">:</span>&nbsp;<span class="op" id="6710799">&amp;</span><span class="ident" id="6710800"><a href="/encoding/json/encode_test.go.html#6710750">n</a></span><span class="op" id="6710801">}</span><span class="op" id="6710802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710805">if</span>&nbsp;<span class="ident" id="6710808"><a href="/encoding/json/encode_test.go.html#6710767">err</a></span>&nbsp;<span class="op" id="6710812">!=</span>&nbsp;<span class="ident" id="6710815">nil</span>&nbsp;<span class="op" id="6710819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710823"><a href="/encoding/json/encode_test.go.html#6710668">t</a></span><span class="op" id="6710824">.</span><span class="ident" id="6710825">Fatalf</span><span class="op" id="6710831">(</span><span class="string" id="6710832">&#34;Marshal:&nbsp;%v&#34;</span><span class="op" id="6710845">,</span>&nbsp;<span class="ident" id="6710847"><a href="/encoding/json/encode_test.go.html#6710767">err</a></span><span class="op" id="6710850">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710856">if</span>&nbsp;<span class="ident" id="6710859">got</span><span class="op" id="6710862">,</span>&nbsp;<span class="ident" id="6710864">want</span>&nbsp;<span class="op" id="6710869">:=</span>&nbsp;<span class="builtintype" id="6710872">string</span><span class="op" id="6710878">(</span><span class="ident" id="6710879"><a href="/encoding/json/encode_test.go.html#6710764">b</a></span><span class="op" id="6710880">)</span><span class="op" id="6710881">,</span>&nbsp;<span class="string" id="6710883">`{&#34;n&#34;:&#34;42&#34;}`</span><span class="op" id="6710895">;</span>&nbsp;<span class="ident" id="6710897"><a href="/encoding/json/encode_test.go.html#6710859">got</a></span>&nbsp;<span class="op" id="6710901">!=</span>&nbsp;<span class="ident" id="6710904"><a href="/encoding/json/encode_test.go.html#6710864">want</a></span>&nbsp;<span class="op" id="6710909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710913"><a href="/encoding/json/encode_test.go.html#6710668">t</a></span><span class="op" id="6710914">.</span><span class="ident" id="6710915">Errorf</span><span class="op" id="6710921">(</span><span class="string" id="6710922">&#34;Marshal&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6710945">,</span>&nbsp;<span class="ident" id="6710947"><a href="/encoding/json/encode_test.go.html#6710859">got</a></span><span class="op" id="6710950">,</span>&nbsp;<span class="ident" id="6710952"><a href="/encoding/json/encode_test.go.html#6710864">want</a></span><span class="op" id="6710956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6710959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6710962">var</span>&nbsp;<span class="ident" id="6710966">back</span>&nbsp;<span class="ident" id="6710971"><a href="/encoding/json/encode_test.go.html#6710690">stringPointer</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6710986"><a href="/encoding/json/encode_test.go.html#6710767">err</a></span>&nbsp;<span class="op" id="6710990">=</span>&nbsp;<span class="ident" id="6710992"><a href="/encoding/json/decode.go.html#4723926">Unmarshal</a></span><span class="op" id="6711001">(</span><span class="ident" id="6711002"><a href="/encoding/json/encode_test.go.html#6710764">b</a></span><span class="op" id="6711003">,</span>&nbsp;<span class="op" id="6711005">&amp;</span><span class="ident" id="6711006"><a href="/encoding/json/encode_test.go.html#6710966">back</a></span><span class="op" id="6711010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6711013">if</span>&nbsp;<span class="ident" id="6711016"><a href="/encoding/json/encode_test.go.html#6710767">err</a></span>&nbsp;<span class="op" id="6711020">!=</span>&nbsp;<span class="ident" id="6711023">nil</span>&nbsp;<span class="op" id="6711027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6711031"><a href="/encoding/json/encode_test.go.html#6710668">t</a></span><span class="op" id="6711032">.</span><span class="ident" id="6711033">Fatalf</span><span class="op" id="6711039">(</span><span class="string" id="6711040">&#34;Unmarshal:&nbsp;%v&#34;</span><span class="op" id="6711055">,</span>&nbsp;<span class="ident" id="6711057"><a href="/encoding/json/encode_test.go.html#6710767">err</a></span><span class="op" id="6711060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6711066">if</span>&nbsp;<span class="ident" id="6711069"><a href="/encoding/json/encode_test.go.html#6710966">back</a></span><span class="op" id="6711073">.</span><span class="ident" id="6711074">N</span>&nbsp;<span class="op" id="6711076">==</span>&nbsp;<span class="ident" id="6711079">nil</span>&nbsp;<span class="op" id="6711083">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6711087"><a href="/encoding/json/encode_test.go.html#6710668">t</a></span><span class="op" id="6711088">.</span><span class="ident" id="6711089">Fatalf</span><span class="op" id="6711095">(</span><span class="string" id="6711096">&#34;Unmarshalled&nbsp;nil&nbsp;N&nbsp;field&#34;</span><span class="op" id="6711122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6711128">if</span>&nbsp;<span class="op" id="6711131">*</span><span class="ident" id="6711132"><a href="/encoding/json/encode_test.go.html#6710966">back</a></span><span class="op" id="6711136">.</span><span class="ident" id="6711137">N</span>&nbsp;<span class="op" id="6711139">!=</span>&nbsp;<span class="num" id="6711142">42</span>&nbsp;<span class="op" id="6711145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6711149"><a href="/encoding/json/encode_test.go.html#6710668">t</a></span><span class="op" id="6711150">.</span><span class="ident" id="6711151">Fatalf</span><span class="op" id="6711157">(</span><span class="string" id="6711158">&#34;*N&nbsp;=&nbsp;%d;&nbsp;want&nbsp;42&#34;</span><span class="op" id="6711176">,</span>&nbsp;<span class="op" id="6711178">*</span><span class="ident" id="6711179"><a href="/encoding/json/encode_test.go.html#6710966">back</a></span><span class="op" id="6711183">.</span><span class="ident" id="6711184">N</span><span class="op" id="6711185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711188">}</span><br>
<span class="lineno">480</span><span class="op" id="6711190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6711193">var</span>&nbsp;<span class="ident" id="6711197">encodeStringTests</span>&nbsp;<span class="op" id="6711215">=</span>&nbsp;<span class="op" id="6711217">[</span><span class="op" id="6711218">]</span><span class="keyword" id="6711219">struct</span>&nbsp;<span class="op" id="6711226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6711229">in</span>&nbsp;&nbsp;<span class="builtintype" id="6711233">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6711241">out</span>&nbsp;<span class="builtintype" id="6711245">string</span><br>
<span class="lineno">485</span><span class="op" id="6711252">}</span><span class="op" id="6711253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711256">{</span><span class="string" id="6711257">&#34;\x00&#34;</span><span class="op" id="6711263">,</span>&nbsp;<span class="string" id="6711265">`&#34;\u0000&#34;`</span><span class="op" id="6711275">}</span><span class="op" id="6711276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711279">{</span><span class="string" id="6711280">&#34;\x01&#34;</span><span class="op" id="6711286">,</span>&nbsp;<span class="string" id="6711288">`&#34;\u0001&#34;`</span><span class="op" id="6711298">}</span><span class="op" id="6711299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711302">{</span><span class="string" id="6711303">&#34;\x02&#34;</span><span class="op" id="6711309">,</span>&nbsp;<span class="string" id="6711311">`&#34;\u0002&#34;`</span><span class="op" id="6711321">}</span><span class="op" id="6711322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711325">{</span><span class="string" id="6711326">&#34;\x03&#34;</span><span class="op" id="6711332">,</span>&nbsp;<span class="string" id="6711334">`&#34;\u0003&#34;`</span><span class="op" id="6711344">}</span><span class="op" id="6711345">,</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711348">{</span><span class="string" id="6711349">&#34;\x04&#34;</span><span class="op" id="6711355">,</span>&nbsp;<span class="string" id="6711357">`&#34;\u0004&#34;`</span><span class="op" id="6711367">}</span><span class="op" id="6711368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711371">{</span><span class="string" id="6711372">&#34;\x05&#34;</span><span class="op" id="6711378">,</span>&nbsp;<span class="string" id="6711380">`&#34;\u0005&#34;`</span><span class="op" id="6711390">}</span><span class="op" id="6711391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711394">{</span><span class="string" id="6711395">&#34;\x06&#34;</span><span class="op" id="6711401">,</span>&nbsp;<span class="string" id="6711403">`&#34;\u0006&#34;`</span><span class="op" id="6711413">}</span><span class="op" id="6711414">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711417">{</span><span class="string" id="6711418">&#34;\x07&#34;</span><span class="op" id="6711424">,</span>&nbsp;<span class="string" id="6711426">`&#34;\u0007&#34;`</span><span class="op" id="6711436">}</span><span class="op" id="6711437">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711440">{</span><span class="string" id="6711441">&#34;\x08&#34;</span><span class="op" id="6711447">,</span>&nbsp;<span class="string" id="6711449">`&#34;\u0008&#34;`</span><span class="op" id="6711459">}</span><span class="op" id="6711460">,</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711463">{</span><span class="string" id="6711464">&#34;\x09&#34;</span><span class="op" id="6711470">,</span>&nbsp;<span class="string" id="6711472">`&#34;\t&#34;`</span><span class="op" id="6711478">}</span><span class="op" id="6711479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711482">{</span><span class="string" id="6711483">&#34;\x0a&#34;</span><span class="op" id="6711489">,</span>&nbsp;<span class="string" id="6711491">`&#34;\n&#34;`</span><span class="op" id="6711497">}</span><span class="op" id="6711498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711501">{</span><span class="string" id="6711502">&#34;\x0b&#34;</span><span class="op" id="6711508">,</span>&nbsp;<span class="string" id="6711510">`&#34;\u000b&#34;`</span><span class="op" id="6711520">}</span><span class="op" id="6711521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711524">{</span><span class="string" id="6711525">&#34;\x0c&#34;</span><span class="op" id="6711531">,</span>&nbsp;<span class="string" id="6711533">`&#34;\u000c&#34;`</span><span class="op" id="6711543">}</span><span class="op" id="6711544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711547">{</span><span class="string" id="6711548">&#34;\x0d&#34;</span><span class="op" id="6711554">,</span>&nbsp;<span class="string" id="6711556">`&#34;\r&#34;`</span><span class="op" id="6711562">}</span><span class="op" id="6711563">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711566">{</span><span class="string" id="6711567">&#34;\x0e&#34;</span><span class="op" id="6711573">,</span>&nbsp;<span class="string" id="6711575">`&#34;\u000e&#34;`</span><span class="op" id="6711585">}</span><span class="op" id="6711586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711589">{</span><span class="string" id="6711590">&#34;\x0f&#34;</span><span class="op" id="6711596">,</span>&nbsp;<span class="string" id="6711598">`&#34;\u000f&#34;`</span><span class="op" id="6711608">}</span><span class="op" id="6711609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711612">{</span><span class="string" id="6711613">&#34;\x10&#34;</span><span class="op" id="6711619">,</span>&nbsp;<span class="string" id="6711621">`&#34;\u0010&#34;`</span><span class="op" id="6711631">}</span><span class="op" id="6711632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711635">{</span><span class="string" id="6711636">&#34;\x11&#34;</span><span class="op" id="6711642">,</span>&nbsp;<span class="string" id="6711644">`&#34;\u0011&#34;`</span><span class="op" id="6711654">}</span><span class="op" id="6711655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711658">{</span><span class="string" id="6711659">&#34;\x12&#34;</span><span class="op" id="6711665">,</span>&nbsp;<span class="string" id="6711667">`&#34;\u0012&#34;`</span><span class="op" id="6711677">}</span><span class="op" id="6711678">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711681">{</span><span class="string" id="6711682">&#34;\x13&#34;</span><span class="op" id="6711688">,</span>&nbsp;<span class="string" id="6711690">`&#34;\u0013&#34;`</span><span class="op" id="6711700">}</span><span class="op" id="6711701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711704">{</span><span class="string" id="6711705">&#34;\x14&#34;</span><span class="op" id="6711711">,</span>&nbsp;<span class="string" id="6711713">`&#34;\u0014&#34;`</span><span class="op" id="6711723">}</span><span class="op" id="6711724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711727">{</span><span class="string" id="6711728">&#34;\x15&#34;</span><span class="op" id="6711734">,</span>&nbsp;<span class="string" id="6711736">`&#34;\u0015&#34;`</span><span class="op" id="6711746">}</span><span class="op" id="6711747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711750">{</span><span class="string" id="6711751">&#34;\x16&#34;</span><span class="op" id="6711757">,</span>&nbsp;<span class="string" id="6711759">`&#34;\u0016&#34;`</span><span class="op" id="6711769">}</span><span class="op" id="6711770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711773">{</span><span class="string" id="6711774">&#34;\x17&#34;</span><span class="op" id="6711780">,</span>&nbsp;<span class="string" id="6711782">`&#34;\u0017&#34;`</span><span class="op" id="6711792">}</span><span class="op" id="6711793">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711796">{</span><span class="string" id="6711797">&#34;\x18&#34;</span><span class="op" id="6711803">,</span>&nbsp;<span class="string" id="6711805">`&#34;\u0018&#34;`</span><span class="op" id="6711815">}</span><span class="op" id="6711816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711819">{</span><span class="string" id="6711820">&#34;\x19&#34;</span><span class="op" id="6711826">,</span>&nbsp;<span class="string" id="6711828">`&#34;\u0019&#34;`</span><span class="op" id="6711838">}</span><span class="op" id="6711839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711842">{</span><span class="string" id="6711843">&#34;\x1a&#34;</span><span class="op" id="6711849">,</span>&nbsp;<span class="string" id="6711851">`&#34;\u001a&#34;`</span><span class="op" id="6711861">}</span><span class="op" id="6711862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711865">{</span><span class="string" id="6711866">&#34;\x1b&#34;</span><span class="op" id="6711872">,</span>&nbsp;<span class="string" id="6711874">`&#34;\u001b&#34;`</span><span class="op" id="6711884">}</span><span class="op" id="6711885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711888">{</span><span class="string" id="6711889">&#34;\x1c&#34;</span><span class="op" id="6711895">,</span>&nbsp;<span class="string" id="6711897">`&#34;\u001c&#34;`</span><span class="op" id="6711907">}</span><span class="op" id="6711908">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711911">{</span><span class="string" id="6711912">&#34;\x1d&#34;</span><span class="op" id="6711918">,</span>&nbsp;<span class="string" id="6711920">`&#34;\u001d&#34;`</span><span class="op" id="6711930">}</span><span class="op" id="6711931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711934">{</span><span class="string" id="6711935">&#34;\x1e&#34;</span><span class="op" id="6711941">,</span>&nbsp;<span class="string" id="6711943">`&#34;\u001e&#34;`</span><span class="op" id="6711953">}</span><span class="op" id="6711954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6711957">{</span><span class="string" id="6711958">&#34;\x1f&#34;</span><span class="op" id="6711964">,</span>&nbsp;<span class="string" id="6711966">`&#34;\u001f&#34;`</span><span class="op" id="6711976">}</span><span class="op" id="6711977">,</span><br>
<span class="lineno"></span><span class="op" id="6711979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="keyword" id="6711982">func</span>&nbsp;<span class="ident" id="6711987">TestEncodeString</span><span class="op" id="6712003">(</span><span class="ident" id="6712004">t</span>&nbsp;<span class="op" id="6712006">*</span><span class="ident" id="6712007"><a href="/encoding/json/encode_test.go.html#6701821">testing</a></span><span class="op" id="6712014">.</span><span class="ident" id="6712015">T</span><span class="op" id="6712016">)</span>&nbsp;<span class="op" id="6712018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6712021">for</span>&nbsp;<span class="ident" id="6712025">_</span><span class="op" id="6712026">,</span>&nbsp;<span class="ident" id="6712028">tt</span>&nbsp;<span class="op" id="6712031">:=</span>&nbsp;<span class="keyword" id="6712034">range</span>&nbsp;<span class="ident" id="6712040"><a href="/encoding/json/encode_test.go.html#6711197">encodeStringTests</a></span>&nbsp;<span class="op" id="6712058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6712062">b</span><span class="op" id="6712063">,</span>&nbsp;<span class="ident" id="6712065">err</span>&nbsp;<span class="op" id="6712069">:=</span>&nbsp;<span class="ident" id="6712072"><a href="/encoding/json/encode.go.html#4753477">Marshal</a></span><span class="op" id="6712079">(</span><span class="ident" id="6712080"><a href="/encoding/json/encode_test.go.html#6712028">tt</a></span><span class="op" id="6712082">.</span><span class="ident" id="6712083">in</span><span class="op" id="6712085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6712089">if</span>&nbsp;<span class="ident" id="6712092"><a href="/encoding/json/encode_test.go.html#6712065">err</a></span>&nbsp;<span class="op" id="6712096">!=</span>&nbsp;<span class="ident" id="6712099">nil</span>&nbsp;<span class="op" id="6712103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6712108"><a href="/encoding/json/encode_test.go.html#6712004">t</a></span><span class="op" id="6712109">.</span><span class="ident" id="6712110">Errorf</span><span class="op" id="6712116">(</span><span class="string" id="6712117">&#34;Marshal(%q):&nbsp;%v&#34;</span><span class="op" id="6712134">,</span>&nbsp;<span class="ident" id="6712136"><a href="/encoding/json/encode_test.go.html#6712028">tt</a></span><span class="op" id="6712138">.</span><span class="ident" id="6712139">in</span><span class="op" id="6712141">,</span>&nbsp;<span class="ident" id="6712143"><a href="/encoding/json/encode_test.go.html#6712065">err</a></span><span class="op" id="6712146">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6712151">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6712162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6712166">out</span>&nbsp;<span class="op" id="6712170">:=</span>&nbsp;<span class="builtintype" id="6712173">string</span><span class="op" id="6712179">(</span><span class="ident" id="6712180"><a href="/encoding/json/encode_test.go.html#6712062">b</a></span><span class="op" id="6712181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6712185">if</span>&nbsp;<span class="ident" id="6712188"><a href="/encoding/json/encode_test.go.html#6712166">out</a></span>&nbsp;<span class="op" id="6712192">!=</span>&nbsp;<span class="ident" id="6712195"><a href="/encoding/json/encode_test.go.html#6712028">tt</a></span><span class="op" id="6712197">.</span><span class="ident" id="6712198">out</span>&nbsp;<span class="op" id="6712202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6712207"><a href="/encoding/json/encode_test.go.html#6712004">t</a></span><span class="op" id="6712208">.</span><span class="ident" id="6712209">Errorf</span><span class="op" id="6712215">(</span><span class="string" id="6712216">&#34;Marshal(%q)&nbsp;=&nbsp;%#q,&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="6712245">,</span>&nbsp;<span class="ident" id="6712247"><a href="/encoding/json/encode_test.go.html#6712028">tt</a></span><span class="op" id="6712249">.</span><span class="ident" id="6712250">in</span><span class="op" id="6712252">,</span>&nbsp;<span class="ident" id="6712254"><a href="/encoding/json/encode_test.go.html#6712166">out</a></span><span class="op" id="6712257">,</span>&nbsp;<span class="ident" id="6712259"><a href="/encoding/json/encode_test.go.html#6712028">tt</a></span><span class="op" id="6712261">.</span><span class="ident" id="6712262">out</span><span class="op" id="6712265">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6712269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6712272">}</span><br>
<span class="lineno"></span><span class="op" id="6712274">}</span>
</div>
</body>
</html>
