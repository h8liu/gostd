<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3144262">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3144317">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3144371">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3144422">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3144461">//</span><br>
<span class="lineno"></span><span class="comment" id="3144464">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3144524">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3144563">//</span><br>
<span class="lineno">10</span><span class="comment" id="3144566">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3144626">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3144691">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3144758">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3144782">//</span><br>
<span class="lineno">15</span><span class="comment" id="3144785">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3144849">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3144919">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3144982">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3145015">//</span><br>
<span class="lineno">20</span><span class="comment" id="3145018">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3145094">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3145161">package</span>&nbsp;<span class="ident" id="3145169">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3145174">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3145193">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3145212">const</span>&nbsp;<span class="op" id="3145218">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3145221">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145273">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145286">=</span>&nbsp;<span class="num" id="3145288">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145291">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145304">=</span>&nbsp;<span class="num" id="3145306">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145309">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145322">=</span>&nbsp;<span class="num" id="3145324">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145327">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145340">=</span>&nbsp;<span class="num" id="3145342">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145345">dnsTypeCNAME</span>&nbsp;<span class="op" id="3145358">=</span>&nbsp;<span class="num" id="3145360">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145363">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145376">=</span>&nbsp;<span class="num" id="3145378">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145381">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145394">=</span>&nbsp;<span class="num" id="3145396">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145399">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145412">=</span>&nbsp;<span class="num" id="3145414">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145417">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145430">=</span>&nbsp;<span class="num" id="3145432">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145435">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3145448">=</span>&nbsp;<span class="num" id="3145450">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145454">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145467">=</span>&nbsp;<span class="num" id="3145469">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145473">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145486">=</span>&nbsp;<span class="num" id="3145488">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145492">dnsTypeHINFO</span>&nbsp;<span class="op" id="3145505">=</span>&nbsp;<span class="num" id="3145507">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145511">dnsTypeMINFO</span>&nbsp;<span class="op" id="3145524">=</span>&nbsp;<span class="num" id="3145526">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145530">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145543">=</span>&nbsp;<span class="num" id="3145545">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145549">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145562">=</span>&nbsp;<span class="num" id="3145564">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145568">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3145581">=</span>&nbsp;<span class="num" id="3145583">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145587">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145600">=</span>&nbsp;<span class="num" id="3145602">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3145607">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145640">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3145653">=</span>&nbsp;<span class="num" id="3145655">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145660">dnsTypeMAILB</span>&nbsp;<span class="op" id="3145673">=</span>&nbsp;<span class="num" id="3145675">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145680">dnsTypeMAILA</span>&nbsp;<span class="op" id="3145693">=</span>&nbsp;<span class="num" id="3145695">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145700">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145713">=</span>&nbsp;<span class="num" id="3145715">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3145721">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145750">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3145765">=</span>&nbsp;<span class="num" id="3145767">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145770">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3145785">=</span>&nbsp;<span class="num" id="3145787">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145790">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3145805">=</span>&nbsp;<span class="num" id="3145807">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145810">dnsClassHESIOD</span>&nbsp;<span class="op" id="3145825">=</span>&nbsp;<span class="num" id="3145827">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145830">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145845">=</span>&nbsp;<span class="num" id="3145847">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3145853">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145870">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145893">=</span>&nbsp;<span class="num" id="3145895">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145898">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145921">=</span>&nbsp;<span class="num" id="3145923">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145926">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3145949">=</span>&nbsp;<span class="num" id="3145951">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145954">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3145977">=</span>&nbsp;<span class="num" id="3145979">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3145982">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3146005">=</span>&nbsp;<span class="num" id="3146007">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146010">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3146033">=</span>&nbsp;<span class="num" id="3146035">5</span><br>
<span class="lineno"></span><span class="op" id="3146037">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3146040">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3146107">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3146134">type</span>&nbsp;<span class="ident" id="3146139">dnsStruct</span>&nbsp;<span class="keyword" id="3146149">interface</span>&nbsp;<span class="op" id="3146159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146162">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146219">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146277">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146333">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146383">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146439">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146481">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3146537">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146575">Walk</span><span class="op" id="3146579">(</span><span class="ident" id="3146580">f</span>&nbsp;<span class="keyword" id="3146582">func</span><span class="op" id="3146586">(</span><span class="ident" id="3146587">v</span>&nbsp;<span class="keyword" id="3146589">interface</span><span class="op" id="3146598">{</span><span class="op" id="3146599">}</span><span class="op" id="3146600">,</span>&nbsp;<span class="ident" id="3146602">name</span><span class="op" id="3146606">,</span>&nbsp;<span class="ident" id="3146608">tag</span>&nbsp;<span class="builtintype" id="3146612">string</span><span class="op" id="3146618">)</span>&nbsp;<span class="op" id="3146620">(</span><span class="ident" id="3146621">ok</span>&nbsp;<span class="builtintype" id="3146624">bool</span><span class="op" id="3146628">)</span><span class="op" id="3146629">)</span>&nbsp;<span class="op" id="3146631">(</span><span class="ident" id="3146632">ok</span>&nbsp;<span class="builtintype" id="3146635">bool</span><span class="op" id="3146639">)</span><br>
<span class="lineno"></span><span class="op" id="3146641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3146644">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3146690">type</span>&nbsp;<span class="ident" id="3146695">dnsHeader</span>&nbsp;<span class="keyword" id="3146705">struct</span>&nbsp;<span class="op" id="3146712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146715">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3146750">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146758">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3146793">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146801">Qdcount</span><span class="op" id="3146808">,</span>&nbsp;<span class="ident" id="3146810">Ancount</span><span class="op" id="3146817">,</span>&nbsp;<span class="ident" id="3146819">Nscount</span><span class="op" id="3146826">,</span>&nbsp;<span class="ident" id="3146828">Arcount</span>&nbsp;<span class="builtintype" id="3146836">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3146843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3146846">func</span>&nbsp;<span class="op" id="3146851">(</span><span class="ident" id="3146852">h</span>&nbsp;<span class="op" id="3146854">*</span><span class="ident" id="3146855">dnsHeader</span><span class="op" id="3146864">)</span>&nbsp;<span class="ident" id="3146866">Walk</span><span class="op" id="3146870">(</span><span class="ident" id="3146871">f</span>&nbsp;<span class="keyword" id="3146873">func</span><span class="op" id="3146877">(</span><span class="ident" id="3146878">v</span>&nbsp;<span class="keyword" id="3146880">interface</span><span class="op" id="3146889">{</span><span class="op" id="3146890">}</span><span class="op" id="3146891">,</span>&nbsp;<span class="ident" id="3146893">name</span><span class="op" id="3146897">,</span>&nbsp;<span class="ident" id="3146899">tag</span>&nbsp;<span class="builtintype" id="3146903">string</span><span class="op" id="3146909">)</span>&nbsp;<span class="builtintype" id="3146911">bool</span><span class="op" id="3146915">)</span>&nbsp;<span class="builtintype" id="3146917">bool</span>&nbsp;<span class="op" id="3146922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3146925">return</span>&nbsp;<span class="ident" id="3146932">f</span><span class="op" id="3146933">(</span><span class="op" id="3146934">&amp;</span><span class="ident" id="3146935">h</span><span class="op" id="3146936">.</span><span class="ident" id="3146937">Id</span><span class="op" id="3146939">,</span>&nbsp;<span class="string" id="3146941">&#34;Id&#34;</span><span class="op" id="3146945">,</span>&nbsp;<span class="string" id="3146947">&#34;&#34;</span><span class="op" id="3146949">)</span>&nbsp;<span class="op" id="3146951">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146956">f</span><span class="op" id="3146957">(</span><span class="op" id="3146958">&amp;</span><span class="ident" id="3146959">h</span><span class="op" id="3146960">.</span><span class="ident" id="3146961">Bits</span><span class="op" id="3146965">,</span>&nbsp;<span class="string" id="3146967">&#34;Bits&#34;</span><span class="op" id="3146973">,</span>&nbsp;<span class="string" id="3146975">&#34;&#34;</span><span class="op" id="3146977">)</span>&nbsp;<span class="op" id="3146979">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3146984">f</span><span class="op" id="3146985">(</span><span class="op" id="3146986">&amp;</span><span class="ident" id="3146987">h</span><span class="op" id="3146988">.</span><span class="ident" id="3146989">Qdcount</span><span class="op" id="3146996">,</span>&nbsp;<span class="string" id="3146998">&#34;Qdcount&#34;</span><span class="op" id="3147007">,</span>&nbsp;<span class="string" id="3147009">&#34;&#34;</span><span class="op" id="3147011">)</span>&nbsp;<span class="op" id="3147013">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147018">f</span><span class="op" id="3147019">(</span><span class="op" id="3147020">&amp;</span><span class="ident" id="3147021">h</span><span class="op" id="3147022">.</span><span class="ident" id="3147023">Ancount</span><span class="op" id="3147030">,</span>&nbsp;<span class="string" id="3147032">&#34;Ancount&#34;</span><span class="op" id="3147041">,</span>&nbsp;<span class="string" id="3147043">&#34;&#34;</span><span class="op" id="3147045">)</span>&nbsp;<span class="op" id="3147047">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147052">f</span><span class="op" id="3147053">(</span><span class="op" id="3147054">&amp;</span><span class="ident" id="3147055">h</span><span class="op" id="3147056">.</span><span class="ident" id="3147057">Nscount</span><span class="op" id="3147064">,</span>&nbsp;<span class="string" id="3147066">&#34;Nscount&#34;</span><span class="op" id="3147075">,</span>&nbsp;<span class="string" id="3147077">&#34;&#34;</span><span class="op" id="3147079">)</span>&nbsp;<span class="op" id="3147081">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147086">f</span><span class="op" id="3147087">(</span><span class="op" id="3147088">&amp;</span><span class="ident" id="3147089">h</span><span class="op" id="3147090">.</span><span class="ident" id="3147091">Arcount</span><span class="op" id="3147098">,</span>&nbsp;<span class="string" id="3147100">&#34;Arcount&#34;</span><span class="op" id="3147109">,</span>&nbsp;<span class="string" id="3147111">&#34;&#34;</span><span class="op" id="3147113">)</span><br>
<span class="lineno"></span><span class="op" id="3147115">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3147118">const</span>&nbsp;<span class="op" id="3147124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3147127">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147146">_QR</span>&nbsp;<span class="op" id="3147150">=</span>&nbsp;<span class="num" id="3147152">1</span>&nbsp;<span class="op" id="3147154">&lt;&lt;</span>&nbsp;<span class="num" id="3147157">15</span>&nbsp;<span class="comment" id="3147160">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147192">_AA</span>&nbsp;<span class="op" id="3147196">=</span>&nbsp;<span class="num" id="3147198">1</span>&nbsp;<span class="op" id="3147200">&lt;&lt;</span>&nbsp;<span class="num" id="3147203">10</span>&nbsp;<span class="comment" id="3147206">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147224">_TC</span>&nbsp;<span class="op" id="3147228">=</span>&nbsp;<span class="num" id="3147230">1</span>&nbsp;<span class="op" id="3147232">&lt;&lt;</span>&nbsp;<span class="num" id="3147235">9</span>&nbsp;&nbsp;<span class="comment" id="3147238">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147252">_RD</span>&nbsp;<span class="op" id="3147256">=</span>&nbsp;<span class="num" id="3147258">1</span>&nbsp;<span class="op" id="3147260">&lt;&lt;</span>&nbsp;<span class="num" id="3147263">8</span>&nbsp;&nbsp;<span class="comment" id="3147266">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147288">_RA</span>&nbsp;<span class="op" id="3147292">=</span>&nbsp;<span class="num" id="3147294">1</span>&nbsp;<span class="op" id="3147296">&lt;&lt;</span>&nbsp;<span class="num" id="3147299">7</span>&nbsp;&nbsp;<span class="comment" id="3147302">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3147325">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3147328">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3147344">type</span>&nbsp;<span class="ident" id="3147349">dnsQuestion</span>&nbsp;<span class="keyword" id="3147361">struct</span>&nbsp;<span class="op" id="3147368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147371">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147378">string</span>&nbsp;<span class="string" id="3147385">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3147405">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147467">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3147474">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147482">Qclass</span>&nbsp;<span class="builtintype" id="3147489">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3147496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3147499">func</span>&nbsp;<span class="op" id="3147504">(</span><span class="ident" id="3147505">q</span>&nbsp;<span class="op" id="3147507">*</span><span class="ident" id="3147508">dnsQuestion</span><span class="op" id="3147519">)</span>&nbsp;<span class="ident" id="3147521">Walk</span><span class="op" id="3147525">(</span><span class="ident" id="3147526">f</span>&nbsp;<span class="keyword" id="3147528">func</span><span class="op" id="3147532">(</span><span class="ident" id="3147533">v</span>&nbsp;<span class="keyword" id="3147535">interface</span><span class="op" id="3147544">{</span><span class="op" id="3147545">}</span><span class="op" id="3147546">,</span>&nbsp;<span class="ident" id="3147548">name</span><span class="op" id="3147552">,</span>&nbsp;<span class="ident" id="3147554">tag</span>&nbsp;<span class="builtintype" id="3147558">string</span><span class="op" id="3147564">)</span>&nbsp;<span class="builtintype" id="3147566">bool</span><span class="op" id="3147570">)</span>&nbsp;<span class="builtintype" id="3147572">bool</span>&nbsp;<span class="op" id="3147577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3147580">return</span>&nbsp;<span class="ident" id="3147587">f</span><span class="op" id="3147588">(</span><span class="op" id="3147589">&amp;</span><span class="ident" id="3147590">q</span><span class="op" id="3147591">.</span><span class="ident" id="3147592">Name</span><span class="op" id="3147596">,</span>&nbsp;<span class="string" id="3147598">&#34;Name&#34;</span><span class="op" id="3147604">,</span>&nbsp;<span class="string" id="3147606">&#34;domain&#34;</span><span class="op" id="3147614">)</span>&nbsp;<span class="op" id="3147616">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147621">f</span><span class="op" id="3147622">(</span><span class="op" id="3147623">&amp;</span><span class="ident" id="3147624">q</span><span class="op" id="3147625">.</span><span class="ident" id="3147626">Qtype</span><span class="op" id="3147631">,</span>&nbsp;<span class="string" id="3147633">&#34;Qtype&#34;</span><span class="op" id="3147640">,</span>&nbsp;<span class="string" id="3147642">&#34;&#34;</span><span class="op" id="3147644">)</span>&nbsp;<span class="op" id="3147646">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147651">f</span><span class="op" id="3147652">(</span><span class="op" id="3147653">&amp;</span><span class="ident" id="3147654">q</span><span class="op" id="3147655">.</span><span class="ident" id="3147656">Qclass</span><span class="op" id="3147662">,</span>&nbsp;<span class="string" id="3147664">&#34;Qclass&#34;</span><span class="op" id="3147672">,</span>&nbsp;<span class="string" id="3147674">&#34;&#34;</span><span class="op" id="3147676">)</span><br>
<span class="lineno"></span><span class="op" id="3147678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3147681">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3147718">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3147755">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3147794">type</span>&nbsp;<span class="ident" id="3147799">dnsRR_Header</span>&nbsp;<span class="keyword" id="3147812">struct</span>&nbsp;<span class="op" id="3147819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147822">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147831">string</span>&nbsp;<span class="string" id="3147838">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147859">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147868">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147876">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147885">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147893">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3147902">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3147910">Rdlength</span>&nbsp;<span class="builtintype" id="3147919">uint16</span>&nbsp;<span class="comment" id="3147926">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3147957">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3147960">func</span>&nbsp;<span class="op" id="3147965">(</span><span class="ident" id="3147966">h</span>&nbsp;<span class="op" id="3147968">*</span><span class="ident" id="3147969">dnsRR_Header</span><span class="op" id="3147981">)</span>&nbsp;<span class="ident" id="3147983">Header</span><span class="op" id="3147989">(</span><span class="op" id="3147990">)</span>&nbsp;<span class="op" id="3147992">*</span><span class="ident" id="3147993">dnsRR_Header</span>&nbsp;<span class="op" id="3148006">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148009">return</span>&nbsp;<span class="ident" id="3148016">h</span><br>
<span class="lineno"></span><span class="op" id="3148018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148021">func</span>&nbsp;<span class="op" id="3148026">(</span><span class="ident" id="3148027">h</span>&nbsp;<span class="op" id="3148029">*</span><span class="ident" id="3148030">dnsRR_Header</span><span class="op" id="3148042">)</span>&nbsp;<span class="ident" id="3148044">Walk</span><span class="op" id="3148048">(</span><span class="ident" id="3148049">f</span>&nbsp;<span class="keyword" id="3148051">func</span><span class="op" id="3148055">(</span><span class="ident" id="3148056">v</span>&nbsp;<span class="keyword" id="3148058">interface</span><span class="op" id="3148067">{</span><span class="op" id="3148068">}</span><span class="op" id="3148069">,</span>&nbsp;<span class="ident" id="3148071">name</span><span class="op" id="3148075">,</span>&nbsp;<span class="ident" id="3148077">tag</span>&nbsp;<span class="builtintype" id="3148081">string</span><span class="op" id="3148087">)</span>&nbsp;<span class="builtintype" id="3148089">bool</span><span class="op" id="3148093">)</span>&nbsp;<span class="builtintype" id="3148095">bool</span>&nbsp;<span class="op" id="3148100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148103">return</span>&nbsp;<span class="ident" id="3148110">f</span><span class="op" id="3148111">(</span><span class="op" id="3148112">&amp;</span><span class="ident" id="3148113">h</span><span class="op" id="3148114">.</span><span class="ident" id="3148115">Name</span><span class="op" id="3148119">,</span>&nbsp;<span class="string" id="3148121">&#34;Name&#34;</span><span class="op" id="3148127">,</span>&nbsp;<span class="string" id="3148129">&#34;domain&#34;</span><span class="op" id="3148137">)</span>&nbsp;<span class="op" id="3148139">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148144">f</span><span class="op" id="3148145">(</span><span class="op" id="3148146">&amp;</span><span class="ident" id="3148147">h</span><span class="op" id="3148148">.</span><span class="ident" id="3148149">Rrtype</span><span class="op" id="3148155">,</span>&nbsp;<span class="string" id="3148157">&#34;Rrtype&#34;</span><span class="op" id="3148165">,</span>&nbsp;<span class="string" id="3148167">&#34;&#34;</span><span class="op" id="3148169">)</span>&nbsp;<span class="op" id="3148171">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148176">f</span><span class="op" id="3148177">(</span><span class="op" id="3148178">&amp;</span><span class="ident" id="3148179">h</span><span class="op" id="3148180">.</span><span class="ident" id="3148181">Class</span><span class="op" id="3148186">,</span>&nbsp;<span class="string" id="3148188">&#34;Class&#34;</span><span class="op" id="3148195">,</span>&nbsp;<span class="string" id="3148197">&#34;&#34;</span><span class="op" id="3148199">)</span>&nbsp;<span class="op" id="3148201">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148206">f</span><span class="op" id="3148207">(</span><span class="op" id="3148208">&amp;</span><span class="ident" id="3148209">h</span><span class="op" id="3148210">.</span><span class="ident" id="3148211">Ttl</span><span class="op" id="3148214">,</span>&nbsp;<span class="string" id="3148216">&#34;Ttl&#34;</span><span class="op" id="3148221">,</span>&nbsp;<span class="string" id="3148223">&#34;&#34;</span><span class="op" id="3148225">)</span>&nbsp;<span class="op" id="3148227">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148232">f</span><span class="op" id="3148233">(</span><span class="op" id="3148234">&amp;</span><span class="ident" id="3148235">h</span><span class="op" id="3148236">.</span><span class="ident" id="3148237">Rdlength</span><span class="op" id="3148245">,</span>&nbsp;<span class="string" id="3148247">&#34;Rdlength&#34;</span><span class="op" id="3148257">,</span>&nbsp;<span class="string" id="3148259">&#34;&#34;</span><span class="op" id="3148261">)</span><br>
<span class="lineno"></span><span class="op" id="3148263">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3148266">type</span>&nbsp;<span class="ident" id="3148271">dnsRR</span>&nbsp;<span class="keyword" id="3148277">interface</span>&nbsp;<span class="op" id="3148287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148290">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148301">Header</span><span class="op" id="3148307">(</span><span class="op" id="3148308">)</span>&nbsp;<span class="op" id="3148310">*</span><span class="ident" id="3148311">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3148324">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3148327">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148376">type</span>&nbsp;<span class="ident" id="3148381">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3148393">struct</span>&nbsp;<span class="op" id="3148400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148403">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3148409">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148423">Cname</span>&nbsp;<span class="builtintype" id="3148429">string</span>&nbsp;<span class="string" id="3148436">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3148456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148459">func</span>&nbsp;<span class="op" id="3148464">(</span><span class="ident" id="3148465">rr</span>&nbsp;<span class="op" id="3148468">*</span><span class="ident" id="3148469">dnsRR_CNAME</span><span class="op" id="3148480">)</span>&nbsp;<span class="ident" id="3148482">Header</span><span class="op" id="3148488">(</span><span class="op" id="3148489">)</span>&nbsp;<span class="op" id="3148491">*</span><span class="ident" id="3148492">dnsRR_Header</span>&nbsp;<span class="op" id="3148505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148508">return</span>&nbsp;<span class="op" id="3148515">&amp;</span><span class="ident" id="3148516">rr</span><span class="op" id="3148518">.</span><span class="ident" id="3148519">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3148523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148526">func</span>&nbsp;<span class="op" id="3148531">(</span><span class="ident" id="3148532">rr</span>&nbsp;<span class="op" id="3148535">*</span><span class="ident" id="3148536">dnsRR_CNAME</span><span class="op" id="3148547">)</span>&nbsp;<span class="ident" id="3148549">Walk</span><span class="op" id="3148553">(</span><span class="ident" id="3148554">f</span>&nbsp;<span class="keyword" id="3148556">func</span><span class="op" id="3148560">(</span><span class="ident" id="3148561">v</span>&nbsp;<span class="keyword" id="3148563">interface</span><span class="op" id="3148572">{</span><span class="op" id="3148573">}</span><span class="op" id="3148574">,</span>&nbsp;<span class="ident" id="3148576">name</span><span class="op" id="3148580">,</span>&nbsp;<span class="ident" id="3148582">tag</span>&nbsp;<span class="builtintype" id="3148586">string</span><span class="op" id="3148592">)</span>&nbsp;<span class="builtintype" id="3148594">bool</span><span class="op" id="3148598">)</span>&nbsp;<span class="builtintype" id="3148600">bool</span>&nbsp;<span class="op" id="3148605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148608">return</span>&nbsp;<span class="ident" id="3148615">rr</span><span class="op" id="3148617">.</span><span class="ident" id="3148618">Hdr</span><span class="op" id="3148621">.</span><span class="ident" id="3148622">Walk</span><span class="op" id="3148626">(</span><span class="ident" id="3148627">f</span><span class="op" id="3148628">)</span>&nbsp;<span class="op" id="3148630">&amp;&amp;</span>&nbsp;<span class="ident" id="3148633">f</span><span class="op" id="3148634">(</span><span class="op" id="3148635">&amp;</span><span class="ident" id="3148636">rr</span><span class="op" id="3148638">.</span><span class="ident" id="3148639">Cname</span><span class="op" id="3148644">,</span>&nbsp;<span class="string" id="3148646">&#34;Cname&#34;</span><span class="op" id="3148653">,</span>&nbsp;<span class="string" id="3148655">&#34;domain&#34;</span><span class="op" id="3148663">)</span><br>
<span class="lineno"></span><span class="op" id="3148665">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3148668">type</span>&nbsp;<span class="ident" id="3148673">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3148685">struct</span>&nbsp;<span class="op" id="3148692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148695">Hdr</span>&nbsp;<span class="ident" id="3148699">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148713">Cpu</span>&nbsp;<span class="builtintype" id="3148717">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148725">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3148729">string</span><br>
<span class="lineno">170</span><span class="op" id="3148736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3148739">func</span>&nbsp;<span class="op" id="3148744">(</span><span class="ident" id="3148745">rr</span>&nbsp;<span class="op" id="3148748">*</span><span class="ident" id="3148749">dnsRR_HINFO</span><span class="op" id="3148760">)</span>&nbsp;<span class="ident" id="3148762">Header</span><span class="op" id="3148768">(</span><span class="op" id="3148769">)</span>&nbsp;<span class="op" id="3148771">*</span><span class="ident" id="3148772">dnsRR_Header</span>&nbsp;<span class="op" id="3148785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148788">return</span>&nbsp;<span class="op" id="3148795">&amp;</span><span class="ident" id="3148796">rr</span><span class="op" id="3148798">.</span><span class="ident" id="3148799">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3148803">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3148806">func</span>&nbsp;<span class="op" id="3148811">(</span><span class="ident" id="3148812">rr</span>&nbsp;<span class="op" id="3148815">*</span><span class="ident" id="3148816">dnsRR_HINFO</span><span class="op" id="3148827">)</span>&nbsp;<span class="ident" id="3148829">Walk</span><span class="op" id="3148833">(</span><span class="ident" id="3148834">f</span>&nbsp;<span class="keyword" id="3148836">func</span><span class="op" id="3148840">(</span><span class="ident" id="3148841">v</span>&nbsp;<span class="keyword" id="3148843">interface</span><span class="op" id="3148852">{</span><span class="op" id="3148853">}</span><span class="op" id="3148854">,</span>&nbsp;<span class="ident" id="3148856">name</span><span class="op" id="3148860">,</span>&nbsp;<span class="ident" id="3148862">tag</span>&nbsp;<span class="builtintype" id="3148866">string</span><span class="op" id="3148872">)</span>&nbsp;<span class="builtintype" id="3148874">bool</span><span class="op" id="3148878">)</span>&nbsp;<span class="builtintype" id="3148880">bool</span>&nbsp;<span class="op" id="3148885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3148888">return</span>&nbsp;<span class="ident" id="3148895">rr</span><span class="op" id="3148897">.</span><span class="ident" id="3148898">Hdr</span><span class="op" id="3148901">.</span><span class="ident" id="3148902">Walk</span><span class="op" id="3148906">(</span><span class="ident" id="3148907">f</span><span class="op" id="3148908">)</span>&nbsp;<span class="op" id="3148910">&amp;&amp;</span>&nbsp;<span class="ident" id="3148913">f</span><span class="op" id="3148914">(</span><span class="op" id="3148915">&amp;</span><span class="ident" id="3148916">rr</span><span class="op" id="3148918">.</span><span class="ident" id="3148919">Cpu</span><span class="op" id="3148922">,</span>&nbsp;<span class="string" id="3148924">&#34;Cpu&#34;</span><span class="op" id="3148929">,</span>&nbsp;<span class="string" id="3148931">&#34;&#34;</span><span class="op" id="3148933">)</span>&nbsp;<span class="op" id="3148935">&amp;&amp;</span>&nbsp;<span class="ident" id="3148938">f</span><span class="op" id="3148939">(</span><span class="op" id="3148940">&amp;</span><span class="ident" id="3148941">rr</span><span class="op" id="3148943">.</span><span class="ident" id="3148944">Os</span><span class="op" id="3148946">,</span>&nbsp;<span class="string" id="3148948">&#34;Os&#34;</span><span class="op" id="3148952">,</span>&nbsp;<span class="string" id="3148954">&#34;&#34;</span><span class="op" id="3148956">)</span><br>
<span class="lineno"></span><span class="op" id="3148958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3148961">type</span>&nbsp;<span class="ident" id="3148966">dnsRR_MB</span>&nbsp;<span class="keyword" id="3148975">struct</span>&nbsp;<span class="op" id="3148982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3148985">Hdr</span>&nbsp;<span class="ident" id="3148989">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149003">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3149007">string</span>&nbsp;<span class="string" id="3149014">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3149034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3149037">func</span>&nbsp;<span class="op" id="3149042">(</span><span class="ident" id="3149043">rr</span>&nbsp;<span class="op" id="3149046">*</span><span class="ident" id="3149047">dnsRR_MB</span><span class="op" id="3149055">)</span>&nbsp;<span class="ident" id="3149057">Header</span><span class="op" id="3149063">(</span><span class="op" id="3149064">)</span>&nbsp;<span class="op" id="3149066">*</span><span class="ident" id="3149067">dnsRR_Header</span>&nbsp;<span class="op" id="3149080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149083">return</span>&nbsp;<span class="op" id="3149090">&amp;</span><span class="ident" id="3149091">rr</span><span class="op" id="3149093">.</span><span class="ident" id="3149094">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3149098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149101">func</span>&nbsp;<span class="op" id="3149106">(</span><span class="ident" id="3149107">rr</span>&nbsp;<span class="op" id="3149110">*</span><span class="ident" id="3149111">dnsRR_MB</span><span class="op" id="3149119">)</span>&nbsp;<span class="ident" id="3149121">Walk</span><span class="op" id="3149125">(</span><span class="ident" id="3149126">f</span>&nbsp;<span class="keyword" id="3149128">func</span><span class="op" id="3149132">(</span><span class="ident" id="3149133">v</span>&nbsp;<span class="keyword" id="3149135">interface</span><span class="op" id="3149144">{</span><span class="op" id="3149145">}</span><span class="op" id="3149146">,</span>&nbsp;<span class="ident" id="3149148">name</span><span class="op" id="3149152">,</span>&nbsp;<span class="ident" id="3149154">tag</span>&nbsp;<span class="builtintype" id="3149158">string</span><span class="op" id="3149164">)</span>&nbsp;<span class="builtintype" id="3149166">bool</span><span class="op" id="3149170">)</span>&nbsp;<span class="builtintype" id="3149172">bool</span>&nbsp;<span class="op" id="3149177">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149180">return</span>&nbsp;<span class="ident" id="3149187">rr</span><span class="op" id="3149189">.</span><span class="ident" id="3149190">Hdr</span><span class="op" id="3149193">.</span><span class="ident" id="3149194">Walk</span><span class="op" id="3149198">(</span><span class="ident" id="3149199">f</span><span class="op" id="3149200">)</span>&nbsp;<span class="op" id="3149202">&amp;&amp;</span>&nbsp;<span class="ident" id="3149205">f</span><span class="op" id="3149206">(</span><span class="op" id="3149207">&amp;</span><span class="ident" id="3149208">rr</span><span class="op" id="3149210">.</span><span class="ident" id="3149211">Mb</span><span class="op" id="3149213">,</span>&nbsp;<span class="string" id="3149215">&#34;Mb&#34;</span><span class="op" id="3149219">,</span>&nbsp;<span class="string" id="3149221">&#34;domain&#34;</span><span class="op" id="3149229">)</span><br>
<span class="lineno"></span><span class="op" id="3149231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149234">type</span>&nbsp;<span class="ident" id="3149239">dnsRR_MG</span>&nbsp;<span class="keyword" id="3149248">struct</span>&nbsp;<span class="op" id="3149255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149258">Hdr</span>&nbsp;<span class="ident" id="3149262">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149276">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3149280">string</span>&nbsp;<span class="string" id="3149287">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3149307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149310">func</span>&nbsp;<span class="op" id="3149315">(</span><span class="ident" id="3149316">rr</span>&nbsp;<span class="op" id="3149319">*</span><span class="ident" id="3149320">dnsRR_MG</span><span class="op" id="3149328">)</span>&nbsp;<span class="ident" id="3149330">Header</span><span class="op" id="3149336">(</span><span class="op" id="3149337">)</span>&nbsp;<span class="op" id="3149339">*</span><span class="ident" id="3149340">dnsRR_Header</span>&nbsp;<span class="op" id="3149353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149356">return</span>&nbsp;<span class="op" id="3149363">&amp;</span><span class="ident" id="3149364">rr</span><span class="op" id="3149366">.</span><span class="ident" id="3149367">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3149371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149374">func</span>&nbsp;<span class="op" id="3149379">(</span><span class="ident" id="3149380">rr</span>&nbsp;<span class="op" id="3149383">*</span><span class="ident" id="3149384">dnsRR_MG</span><span class="op" id="3149392">)</span>&nbsp;<span class="ident" id="3149394">Walk</span><span class="op" id="3149398">(</span><span class="ident" id="3149399">f</span>&nbsp;<span class="keyword" id="3149401">func</span><span class="op" id="3149405">(</span><span class="ident" id="3149406">v</span>&nbsp;<span class="keyword" id="3149408">interface</span><span class="op" id="3149417">{</span><span class="op" id="3149418">}</span><span class="op" id="3149419">,</span>&nbsp;<span class="ident" id="3149421">name</span><span class="op" id="3149425">,</span>&nbsp;<span class="ident" id="3149427">tag</span>&nbsp;<span class="builtintype" id="3149431">string</span><span class="op" id="3149437">)</span>&nbsp;<span class="builtintype" id="3149439">bool</span><span class="op" id="3149443">)</span>&nbsp;<span class="builtintype" id="3149445">bool</span>&nbsp;<span class="op" id="3149450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149453">return</span>&nbsp;<span class="ident" id="3149460">rr</span><span class="op" id="3149462">.</span><span class="ident" id="3149463">Hdr</span><span class="op" id="3149466">.</span><span class="ident" id="3149467">Walk</span><span class="op" id="3149471">(</span><span class="ident" id="3149472">f</span><span class="op" id="3149473">)</span>&nbsp;<span class="op" id="3149475">&amp;&amp;</span>&nbsp;<span class="ident" id="3149478">f</span><span class="op" id="3149479">(</span><span class="op" id="3149480">&amp;</span><span class="ident" id="3149481">rr</span><span class="op" id="3149483">.</span><span class="ident" id="3149484">Mg</span><span class="op" id="3149486">,</span>&nbsp;<span class="string" id="3149488">&#34;Mg&#34;</span><span class="op" id="3149492">,</span>&nbsp;<span class="string" id="3149494">&#34;domain&#34;</span><span class="op" id="3149502">)</span><br>
<span class="lineno"></span><span class="op" id="3149504">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3149507">type</span>&nbsp;<span class="ident" id="3149512">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3149524">struct</span>&nbsp;<span class="op" id="3149531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149534">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3149540">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149554">Rmail</span>&nbsp;<span class="builtintype" id="3149560">string</span>&nbsp;<span class="string" id="3149567">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149588">Email</span>&nbsp;<span class="builtintype" id="3149594">string</span>&nbsp;<span class="string" id="3149601">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3149621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3149624">func</span>&nbsp;<span class="op" id="3149629">(</span><span class="ident" id="3149630">rr</span>&nbsp;<span class="op" id="3149633">*</span><span class="ident" id="3149634">dnsRR_MINFO</span><span class="op" id="3149645">)</span>&nbsp;<span class="ident" id="3149647">Header</span><span class="op" id="3149653">(</span><span class="op" id="3149654">)</span>&nbsp;<span class="op" id="3149656">*</span><span class="ident" id="3149657">dnsRR_Header</span>&nbsp;<span class="op" id="3149670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149673">return</span>&nbsp;<span class="op" id="3149680">&amp;</span><span class="ident" id="3149681">rr</span><span class="op" id="3149683">.</span><span class="ident" id="3149684">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3149688">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3149691">func</span>&nbsp;<span class="op" id="3149696">(</span><span class="ident" id="3149697">rr</span>&nbsp;<span class="op" id="3149700">*</span><span class="ident" id="3149701">dnsRR_MINFO</span><span class="op" id="3149712">)</span>&nbsp;<span class="ident" id="3149714">Walk</span><span class="op" id="3149718">(</span><span class="ident" id="3149719">f</span>&nbsp;<span class="keyword" id="3149721">func</span><span class="op" id="3149725">(</span><span class="ident" id="3149726">v</span>&nbsp;<span class="keyword" id="3149728">interface</span><span class="op" id="3149737">{</span><span class="op" id="3149738">}</span><span class="op" id="3149739">,</span>&nbsp;<span class="ident" id="3149741">name</span><span class="op" id="3149745">,</span>&nbsp;<span class="ident" id="3149747">tag</span>&nbsp;<span class="builtintype" id="3149751">string</span><span class="op" id="3149757">)</span>&nbsp;<span class="builtintype" id="3149759">bool</span><span class="op" id="3149763">)</span>&nbsp;<span class="builtintype" id="3149765">bool</span>&nbsp;<span class="op" id="3149770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149773">return</span>&nbsp;<span class="ident" id="3149780">rr</span><span class="op" id="3149782">.</span><span class="ident" id="3149783">Hdr</span><span class="op" id="3149786">.</span><span class="ident" id="3149787">Walk</span><span class="op" id="3149791">(</span><span class="ident" id="3149792">f</span><span class="op" id="3149793">)</span>&nbsp;<span class="op" id="3149795">&amp;&amp;</span>&nbsp;<span class="ident" id="3149798">f</span><span class="op" id="3149799">(</span><span class="op" id="3149800">&amp;</span><span class="ident" id="3149801">rr</span><span class="op" id="3149803">.</span><span class="ident" id="3149804">Rmail</span><span class="op" id="3149809">,</span>&nbsp;<span class="string" id="3149811">&#34;Rmail&#34;</span><span class="op" id="3149818">,</span>&nbsp;<span class="string" id="3149820">&#34;domain&#34;</span><span class="op" id="3149828">)</span>&nbsp;<span class="op" id="3149830">&amp;&amp;</span>&nbsp;<span class="ident" id="3149833">f</span><span class="op" id="3149834">(</span><span class="op" id="3149835">&amp;</span><span class="ident" id="3149836">rr</span><span class="op" id="3149838">.</span><span class="ident" id="3149839">Email</span><span class="op" id="3149844">,</span>&nbsp;<span class="string" id="3149846">&#34;Email&#34;</span><span class="op" id="3149853">,</span>&nbsp;<span class="string" id="3149855">&#34;domain&#34;</span><span class="op" id="3149863">)</span><br>
<span class="lineno"></span><span class="op" id="3149865">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3149868">type</span>&nbsp;<span class="ident" id="3149873">dnsRR_MR</span>&nbsp;<span class="keyword" id="3149882">struct</span>&nbsp;<span class="op" id="3149889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149892">Hdr</span>&nbsp;<span class="ident" id="3149896">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3149910">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3149914">string</span>&nbsp;<span class="string" id="3149921">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3149941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3149944">func</span>&nbsp;<span class="op" id="3149949">(</span><span class="ident" id="3149950">rr</span>&nbsp;<span class="op" id="3149953">*</span><span class="ident" id="3149954">dnsRR_MR</span><span class="op" id="3149962">)</span>&nbsp;<span class="ident" id="3149964">Header</span><span class="op" id="3149970">(</span><span class="op" id="3149971">)</span>&nbsp;<span class="op" id="3149973">*</span><span class="ident" id="3149974">dnsRR_Header</span>&nbsp;<span class="op" id="3149987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3149990">return</span>&nbsp;<span class="op" id="3149997">&amp;</span><span class="ident" id="3149998">rr</span><span class="op" id="3150000">.</span><span class="ident" id="3150001">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3150005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150008">func</span>&nbsp;<span class="op" id="3150013">(</span><span class="ident" id="3150014">rr</span>&nbsp;<span class="op" id="3150017">*</span><span class="ident" id="3150018">dnsRR_MR</span><span class="op" id="3150026">)</span>&nbsp;<span class="ident" id="3150028">Walk</span><span class="op" id="3150032">(</span><span class="ident" id="3150033">f</span>&nbsp;<span class="keyword" id="3150035">func</span><span class="op" id="3150039">(</span><span class="ident" id="3150040">v</span>&nbsp;<span class="keyword" id="3150042">interface</span><span class="op" id="3150051">{</span><span class="op" id="3150052">}</span><span class="op" id="3150053">,</span>&nbsp;<span class="ident" id="3150055">name</span><span class="op" id="3150059">,</span>&nbsp;<span class="ident" id="3150061">tag</span>&nbsp;<span class="builtintype" id="3150065">string</span><span class="op" id="3150071">)</span>&nbsp;<span class="builtintype" id="3150073">bool</span><span class="op" id="3150077">)</span>&nbsp;<span class="builtintype" id="3150079">bool</span>&nbsp;<span class="op" id="3150084">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150087">return</span>&nbsp;<span class="ident" id="3150094">rr</span><span class="op" id="3150096">.</span><span class="ident" id="3150097">Hdr</span><span class="op" id="3150100">.</span><span class="ident" id="3150101">Walk</span><span class="op" id="3150105">(</span><span class="ident" id="3150106">f</span><span class="op" id="3150107">)</span>&nbsp;<span class="op" id="3150109">&amp;&amp;</span>&nbsp;<span class="ident" id="3150112">f</span><span class="op" id="3150113">(</span><span class="op" id="3150114">&amp;</span><span class="ident" id="3150115">rr</span><span class="op" id="3150117">.</span><span class="ident" id="3150118">Mr</span><span class="op" id="3150120">,</span>&nbsp;<span class="string" id="3150122">&#34;Mr&#34;</span><span class="op" id="3150126">,</span>&nbsp;<span class="string" id="3150128">&#34;domain&#34;</span><span class="op" id="3150136">)</span><br>
<span class="lineno"></span><span class="op" id="3150138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150141">type</span>&nbsp;<span class="ident" id="3150146">dnsRR_MX</span>&nbsp;<span class="keyword" id="3150155">struct</span>&nbsp;<span class="op" id="3150162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150165">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3150170">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150184">Pref</span>&nbsp;<span class="builtintype" id="3150189">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150197">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3150202">string</span>&nbsp;<span class="string" id="3150209">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3150229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150232">func</span>&nbsp;<span class="op" id="3150237">(</span><span class="ident" id="3150238">rr</span>&nbsp;<span class="op" id="3150241">*</span><span class="ident" id="3150242">dnsRR_MX</span><span class="op" id="3150250">)</span>&nbsp;<span class="ident" id="3150252">Header</span><span class="op" id="3150258">(</span><span class="op" id="3150259">)</span>&nbsp;<span class="op" id="3150261">*</span><span class="ident" id="3150262">dnsRR_Header</span>&nbsp;<span class="op" id="3150275">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150278">return</span>&nbsp;<span class="op" id="3150285">&amp;</span><span class="ident" id="3150286">rr</span><span class="op" id="3150288">.</span><span class="ident" id="3150289">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3150293">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150296">func</span>&nbsp;<span class="op" id="3150301">(</span><span class="ident" id="3150302">rr</span>&nbsp;<span class="op" id="3150305">*</span><span class="ident" id="3150306">dnsRR_MX</span><span class="op" id="3150314">)</span>&nbsp;<span class="ident" id="3150316">Walk</span><span class="op" id="3150320">(</span><span class="ident" id="3150321">f</span>&nbsp;<span class="keyword" id="3150323">func</span><span class="op" id="3150327">(</span><span class="ident" id="3150328">v</span>&nbsp;<span class="keyword" id="3150330">interface</span><span class="op" id="3150339">{</span><span class="op" id="3150340">}</span><span class="op" id="3150341">,</span>&nbsp;<span class="ident" id="3150343">name</span><span class="op" id="3150347">,</span>&nbsp;<span class="ident" id="3150349">tag</span>&nbsp;<span class="builtintype" id="3150353">string</span><span class="op" id="3150359">)</span>&nbsp;<span class="builtintype" id="3150361">bool</span><span class="op" id="3150365">)</span>&nbsp;<span class="builtintype" id="3150367">bool</span>&nbsp;<span class="op" id="3150372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150375">return</span>&nbsp;<span class="ident" id="3150382">rr</span><span class="op" id="3150384">.</span><span class="ident" id="3150385">Hdr</span><span class="op" id="3150388">.</span><span class="ident" id="3150389">Walk</span><span class="op" id="3150393">(</span><span class="ident" id="3150394">f</span><span class="op" id="3150395">)</span>&nbsp;<span class="op" id="3150397">&amp;&amp;</span>&nbsp;<span class="ident" id="3150400">f</span><span class="op" id="3150401">(</span><span class="op" id="3150402">&amp;</span><span class="ident" id="3150403">rr</span><span class="op" id="3150405">.</span><span class="ident" id="3150406">Pref</span><span class="op" id="3150410">,</span>&nbsp;<span class="string" id="3150412">&#34;Pref&#34;</span><span class="op" id="3150418">,</span>&nbsp;<span class="string" id="3150420">&#34;&#34;</span><span class="op" id="3150422">)</span>&nbsp;<span class="op" id="3150424">&amp;&amp;</span>&nbsp;<span class="ident" id="3150427">f</span><span class="op" id="3150428">(</span><span class="op" id="3150429">&amp;</span><span class="ident" id="3150430">rr</span><span class="op" id="3150432">.</span><span class="ident" id="3150433">Mx</span><span class="op" id="3150435">,</span>&nbsp;<span class="string" id="3150437">&#34;Mx&#34;</span><span class="op" id="3150441">,</span>&nbsp;<span class="string" id="3150443">&#34;domain&#34;</span><span class="op" id="3150451">)</span><br>
<span class="lineno">245</span><span class="op" id="3150453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150456">type</span>&nbsp;<span class="ident" id="3150461">dnsRR_NS</span>&nbsp;<span class="keyword" id="3150470">struct</span>&nbsp;<span class="op" id="3150477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150480">Hdr</span>&nbsp;<span class="ident" id="3150484">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150498">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3150502">string</span>&nbsp;<span class="string" id="3150509">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3150529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150532">func</span>&nbsp;<span class="op" id="3150537">(</span><span class="ident" id="3150538">rr</span>&nbsp;<span class="op" id="3150541">*</span><span class="ident" id="3150542">dnsRR_NS</span><span class="op" id="3150550">)</span>&nbsp;<span class="ident" id="3150552">Header</span><span class="op" id="3150558">(</span><span class="op" id="3150559">)</span>&nbsp;<span class="op" id="3150561">*</span><span class="ident" id="3150562">dnsRR_Header</span>&nbsp;<span class="op" id="3150575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150578">return</span>&nbsp;<span class="op" id="3150585">&amp;</span><span class="ident" id="3150586">rr</span><span class="op" id="3150588">.</span><span class="ident" id="3150589">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3150593">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3150596">func</span>&nbsp;<span class="op" id="3150601">(</span><span class="ident" id="3150602">rr</span>&nbsp;<span class="op" id="3150605">*</span><span class="ident" id="3150606">dnsRR_NS</span><span class="op" id="3150614">)</span>&nbsp;<span class="ident" id="3150616">Walk</span><span class="op" id="3150620">(</span><span class="ident" id="3150621">f</span>&nbsp;<span class="keyword" id="3150623">func</span><span class="op" id="3150627">(</span><span class="ident" id="3150628">v</span>&nbsp;<span class="keyword" id="3150630">interface</span><span class="op" id="3150639">{</span><span class="op" id="3150640">}</span><span class="op" id="3150641">,</span>&nbsp;<span class="ident" id="3150643">name</span><span class="op" id="3150647">,</span>&nbsp;<span class="ident" id="3150649">tag</span>&nbsp;<span class="builtintype" id="3150653">string</span><span class="op" id="3150659">)</span>&nbsp;<span class="builtintype" id="3150661">bool</span><span class="op" id="3150665">)</span>&nbsp;<span class="builtintype" id="3150667">bool</span>&nbsp;<span class="op" id="3150672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150675">return</span>&nbsp;<span class="ident" id="3150682">rr</span><span class="op" id="3150684">.</span><span class="ident" id="3150685">Hdr</span><span class="op" id="3150688">.</span><span class="ident" id="3150689">Walk</span><span class="op" id="3150693">(</span><span class="ident" id="3150694">f</span><span class="op" id="3150695">)</span>&nbsp;<span class="op" id="3150697">&amp;&amp;</span>&nbsp;<span class="ident" id="3150700">f</span><span class="op" id="3150701">(</span><span class="op" id="3150702">&amp;</span><span class="ident" id="3150703">rr</span><span class="op" id="3150705">.</span><span class="ident" id="3150706">Ns</span><span class="op" id="3150708">,</span>&nbsp;<span class="string" id="3150710">&#34;Ns&#34;</span><span class="op" id="3150714">,</span>&nbsp;<span class="string" id="3150716">&#34;domain&#34;</span><span class="op" id="3150724">)</span><br>
<span class="lineno"></span><span class="op" id="3150726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3150729">type</span>&nbsp;<span class="ident" id="3150734">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3150744">struct</span>&nbsp;<span class="op" id="3150751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150754">Hdr</span>&nbsp;<span class="ident" id="3150758">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3150772">Ptr</span>&nbsp;<span class="builtintype" id="3150776">string</span>&nbsp;<span class="string" id="3150783">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3150803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3150806">func</span>&nbsp;<span class="op" id="3150811">(</span><span class="ident" id="3150812">rr</span>&nbsp;<span class="op" id="3150815">*</span><span class="ident" id="3150816">dnsRR_PTR</span><span class="op" id="3150825">)</span>&nbsp;<span class="ident" id="3150827">Header</span><span class="op" id="3150833">(</span><span class="op" id="3150834">)</span>&nbsp;<span class="op" id="3150836">*</span><span class="ident" id="3150837">dnsRR_Header</span>&nbsp;<span class="op" id="3150850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150853">return</span>&nbsp;<span class="op" id="3150860">&amp;</span><span class="ident" id="3150861">rr</span><span class="op" id="3150863">.</span><span class="ident" id="3150864">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3150868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3150871">func</span>&nbsp;<span class="op" id="3150876">(</span><span class="ident" id="3150877">rr</span>&nbsp;<span class="op" id="3150880">*</span><span class="ident" id="3150881">dnsRR_PTR</span><span class="op" id="3150890">)</span>&nbsp;<span class="ident" id="3150892">Walk</span><span class="op" id="3150896">(</span><span class="ident" id="3150897">f</span>&nbsp;<span class="keyword" id="3150899">func</span><span class="op" id="3150903">(</span><span class="ident" id="3150904">v</span>&nbsp;<span class="keyword" id="3150906">interface</span><span class="op" id="3150915">{</span><span class="op" id="3150916">}</span><span class="op" id="3150917">,</span>&nbsp;<span class="ident" id="3150919">name</span><span class="op" id="3150923">,</span>&nbsp;<span class="ident" id="3150925">tag</span>&nbsp;<span class="builtintype" id="3150929">string</span><span class="op" id="3150935">)</span>&nbsp;<span class="builtintype" id="3150937">bool</span><span class="op" id="3150941">)</span>&nbsp;<span class="builtintype" id="3150943">bool</span>&nbsp;<span class="op" id="3150948">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3150951">return</span>&nbsp;<span class="ident" id="3150958">rr</span><span class="op" id="3150960">.</span><span class="ident" id="3150961">Hdr</span><span class="op" id="3150964">.</span><span class="ident" id="3150965">Walk</span><span class="op" id="3150969">(</span><span class="ident" id="3150970">f</span><span class="op" id="3150971">)</span>&nbsp;<span class="op" id="3150973">&amp;&amp;</span>&nbsp;<span class="ident" id="3150976">f</span><span class="op" id="3150977">(</span><span class="op" id="3150978">&amp;</span><span class="ident" id="3150979">rr</span><span class="op" id="3150981">.</span><span class="ident" id="3150982">Ptr</span><span class="op" id="3150985">,</span>&nbsp;<span class="string" id="3150987">&#34;Ptr&#34;</span><span class="op" id="3150992">,</span>&nbsp;<span class="string" id="3150994">&#34;domain&#34;</span><span class="op" id="3151002">)</span><br>
<span class="lineno"></span><span class="op" id="3151004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151007">type</span>&nbsp;<span class="ident" id="3151012">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3151022">struct</span>&nbsp;<span class="op" id="3151029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151032">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151040">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151054">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151062">string</span>&nbsp;<span class="string" id="3151069">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151090">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151098">string</span>&nbsp;<span class="string" id="3151105">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151126">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3151134">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151142">Refresh</span>&nbsp;<span class="builtintype" id="3151150">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151158">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151166">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151174">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3151182">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151190">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3151198">uint32</span><br>
<span class="lineno"></span><span class="op" id="3151205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151208">func</span>&nbsp;<span class="op" id="3151213">(</span><span class="ident" id="3151214">rr</span>&nbsp;<span class="op" id="3151217">*</span><span class="ident" id="3151218">dnsRR_SOA</span><span class="op" id="3151227">)</span>&nbsp;<span class="ident" id="3151229">Header</span><span class="op" id="3151235">(</span><span class="op" id="3151236">)</span>&nbsp;<span class="op" id="3151238">*</span><span class="ident" id="3151239">dnsRR_Header</span>&nbsp;<span class="op" id="3151252">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151255">return</span>&nbsp;<span class="op" id="3151262">&amp;</span><span class="ident" id="3151263">rr</span><span class="op" id="3151265">.</span><span class="ident" id="3151266">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3151270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151273">func</span>&nbsp;<span class="op" id="3151278">(</span><span class="ident" id="3151279">rr</span>&nbsp;<span class="op" id="3151282">*</span><span class="ident" id="3151283">dnsRR_SOA</span><span class="op" id="3151292">)</span>&nbsp;<span class="ident" id="3151294">Walk</span><span class="op" id="3151298">(</span><span class="ident" id="3151299">f</span>&nbsp;<span class="keyword" id="3151301">func</span><span class="op" id="3151305">(</span><span class="ident" id="3151306">v</span>&nbsp;<span class="keyword" id="3151308">interface</span><span class="op" id="3151317">{</span><span class="op" id="3151318">}</span><span class="op" id="3151319">,</span>&nbsp;<span class="ident" id="3151321">name</span><span class="op" id="3151325">,</span>&nbsp;<span class="ident" id="3151327">tag</span>&nbsp;<span class="builtintype" id="3151331">string</span><span class="op" id="3151337">)</span>&nbsp;<span class="builtintype" id="3151339">bool</span><span class="op" id="3151343">)</span>&nbsp;<span class="builtintype" id="3151345">bool</span>&nbsp;<span class="op" id="3151350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151353">return</span>&nbsp;<span class="ident" id="3151360">rr</span><span class="op" id="3151362">.</span><span class="ident" id="3151363">Hdr</span><span class="op" id="3151366">.</span><span class="ident" id="3151367">Walk</span><span class="op" id="3151371">(</span><span class="ident" id="3151372">f</span><span class="op" id="3151373">)</span>&nbsp;<span class="op" id="3151375">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151380">f</span><span class="op" id="3151381">(</span><span class="op" id="3151382">&amp;</span><span class="ident" id="3151383">rr</span><span class="op" id="3151385">.</span><span class="ident" id="3151386">Ns</span><span class="op" id="3151388">,</span>&nbsp;<span class="string" id="3151390">&#34;Ns&#34;</span><span class="op" id="3151394">,</span>&nbsp;<span class="string" id="3151396">&#34;domain&#34;</span><span class="op" id="3151404">)</span>&nbsp;<span class="op" id="3151406">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151411">f</span><span class="op" id="3151412">(</span><span class="op" id="3151413">&amp;</span><span class="ident" id="3151414">rr</span><span class="op" id="3151416">.</span><span class="ident" id="3151417">Mbox</span><span class="op" id="3151421">,</span>&nbsp;<span class="string" id="3151423">&#34;Mbox&#34;</span><span class="op" id="3151429">,</span>&nbsp;<span class="string" id="3151431">&#34;domain&#34;</span><span class="op" id="3151439">)</span>&nbsp;<span class="op" id="3151441">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151446">f</span><span class="op" id="3151447">(</span><span class="op" id="3151448">&amp;</span><span class="ident" id="3151449">rr</span><span class="op" id="3151451">.</span><span class="ident" id="3151452">Serial</span><span class="op" id="3151458">,</span>&nbsp;<span class="string" id="3151460">&#34;Serial&#34;</span><span class="op" id="3151468">,</span>&nbsp;<span class="string" id="3151470">&#34;&#34;</span><span class="op" id="3151472">)</span>&nbsp;<span class="op" id="3151474">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151479">f</span><span class="op" id="3151480">(</span><span class="op" id="3151481">&amp;</span><span class="ident" id="3151482">rr</span><span class="op" id="3151484">.</span><span class="ident" id="3151485">Refresh</span><span class="op" id="3151492">,</span>&nbsp;<span class="string" id="3151494">&#34;Refresh&#34;</span><span class="op" id="3151503">,</span>&nbsp;<span class="string" id="3151505">&#34;&#34;</span><span class="op" id="3151507">)</span>&nbsp;<span class="op" id="3151509">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151514">f</span><span class="op" id="3151515">(</span><span class="op" id="3151516">&amp;</span><span class="ident" id="3151517">rr</span><span class="op" id="3151519">.</span><span class="ident" id="3151520">Retry</span><span class="op" id="3151525">,</span>&nbsp;<span class="string" id="3151527">&#34;Retry&#34;</span><span class="op" id="3151534">,</span>&nbsp;<span class="string" id="3151536">&#34;&#34;</span><span class="op" id="3151538">)</span>&nbsp;<span class="op" id="3151540">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151545">f</span><span class="op" id="3151546">(</span><span class="op" id="3151547">&amp;</span><span class="ident" id="3151548">rr</span><span class="op" id="3151550">.</span><span class="ident" id="3151551">Expire</span><span class="op" id="3151557">,</span>&nbsp;<span class="string" id="3151559">&#34;Expire&#34;</span><span class="op" id="3151567">,</span>&nbsp;<span class="string" id="3151569">&#34;&#34;</span><span class="op" id="3151571">)</span>&nbsp;<span class="op" id="3151573">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151578">f</span><span class="op" id="3151579">(</span><span class="op" id="3151580">&amp;</span><span class="ident" id="3151581">rr</span><span class="op" id="3151583">.</span><span class="ident" id="3151584">Minttl</span><span class="op" id="3151590">,</span>&nbsp;<span class="string" id="3151592">&#34;Minttl&#34;</span><span class="op" id="3151600">,</span>&nbsp;<span class="string" id="3151602">&#34;&#34;</span><span class="op" id="3151604">)</span><br>
<span class="lineno"></span><span class="op" id="3151606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151609">type</span>&nbsp;<span class="ident" id="3151614">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3151624">struct</span>&nbsp;<span class="op" id="3151631">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151634">Hdr</span>&nbsp;<span class="ident" id="3151638">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151652">Txt</span>&nbsp;<span class="builtintype" id="3151656">string</span>&nbsp;<span class="comment" id="3151663">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3151682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151685">func</span>&nbsp;<span class="op" id="3151690">(</span><span class="ident" id="3151691">rr</span>&nbsp;<span class="op" id="3151694">*</span><span class="ident" id="3151695">dnsRR_TXT</span><span class="op" id="3151704">)</span>&nbsp;<span class="ident" id="3151706">Header</span><span class="op" id="3151712">(</span><span class="op" id="3151713">)</span>&nbsp;<span class="op" id="3151715">*</span><span class="ident" id="3151716">dnsRR_Header</span>&nbsp;<span class="op" id="3151729">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151732">return</span>&nbsp;<span class="op" id="3151739">&amp;</span><span class="ident" id="3151740">rr</span><span class="op" id="3151742">.</span><span class="ident" id="3151743">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3151747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151750">func</span>&nbsp;<span class="op" id="3151755">(</span><span class="ident" id="3151756">rr</span>&nbsp;<span class="op" id="3151759">*</span><span class="ident" id="3151760">dnsRR_TXT</span><span class="op" id="3151769">)</span>&nbsp;<span class="ident" id="3151771">Walk</span><span class="op" id="3151775">(</span><span class="ident" id="3151776">f</span>&nbsp;<span class="keyword" id="3151778">func</span><span class="op" id="3151782">(</span><span class="ident" id="3151783">v</span>&nbsp;<span class="keyword" id="3151785">interface</span><span class="op" id="3151794">{</span><span class="op" id="3151795">}</span><span class="op" id="3151796">,</span>&nbsp;<span class="ident" id="3151798">name</span><span class="op" id="3151802">,</span>&nbsp;<span class="ident" id="3151804">tag</span>&nbsp;<span class="builtintype" id="3151808">string</span><span class="op" id="3151814">)</span>&nbsp;<span class="builtintype" id="3151816">bool</span><span class="op" id="3151820">)</span>&nbsp;<span class="builtintype" id="3151822">bool</span>&nbsp;<span class="op" id="3151827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3151830">return</span>&nbsp;<span class="ident" id="3151837">rr</span><span class="op" id="3151839">.</span><span class="ident" id="3151840">Hdr</span><span class="op" id="3151843">.</span><span class="ident" id="3151844">Walk</span><span class="op" id="3151848">(</span><span class="ident" id="3151849">f</span><span class="op" id="3151850">)</span>&nbsp;<span class="op" id="3151852">&amp;&amp;</span>&nbsp;<span class="ident" id="3151855">f</span><span class="op" id="3151856">(</span><span class="op" id="3151857">&amp;</span><span class="ident" id="3151858">rr</span><span class="op" id="3151860">.</span><span class="ident" id="3151861">Txt</span><span class="op" id="3151864">,</span>&nbsp;<span class="string" id="3151866">&#34;Txt&#34;</span><span class="op" id="3151871">,</span>&nbsp;<span class="string" id="3151873">&#34;&#34;</span><span class="op" id="3151875">)</span><br>
<span class="lineno">310</span><span class="op" id="3151877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3151880">type</span>&nbsp;<span class="ident" id="3151885">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3151895">struct</span>&nbsp;<span class="op" id="3151902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151905">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3151914">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151928">Priority</span>&nbsp;<span class="builtintype" id="3151937">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151945">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151954">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151962">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151971">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3151979">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3151988">string</span>&nbsp;<span class="string" id="3151995">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3152015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3152018">func</span>&nbsp;<span class="op" id="3152023">(</span><span class="ident" id="3152024">rr</span>&nbsp;<span class="op" id="3152027">*</span><span class="ident" id="3152028">dnsRR_SRV</span><span class="op" id="3152037">)</span>&nbsp;<span class="ident" id="3152039">Header</span><span class="op" id="3152045">(</span><span class="op" id="3152046">)</span>&nbsp;<span class="op" id="3152048">*</span><span class="ident" id="3152049">dnsRR_Header</span>&nbsp;<span class="op" id="3152062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152065">return</span>&nbsp;<span class="op" id="3152072">&amp;</span><span class="ident" id="3152073">rr</span><span class="op" id="3152075">.</span><span class="ident" id="3152076">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3152080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152083">func</span>&nbsp;<span class="op" id="3152088">(</span><span class="ident" id="3152089">rr</span>&nbsp;<span class="op" id="3152092">*</span><span class="ident" id="3152093">dnsRR_SRV</span><span class="op" id="3152102">)</span>&nbsp;<span class="ident" id="3152104">Walk</span><span class="op" id="3152108">(</span><span class="ident" id="3152109">f</span>&nbsp;<span class="keyword" id="3152111">func</span><span class="op" id="3152115">(</span><span class="ident" id="3152116">v</span>&nbsp;<span class="keyword" id="3152118">interface</span><span class="op" id="3152127">{</span><span class="op" id="3152128">}</span><span class="op" id="3152129">,</span>&nbsp;<span class="ident" id="3152131">name</span><span class="op" id="3152135">,</span>&nbsp;<span class="ident" id="3152137">tag</span>&nbsp;<span class="builtintype" id="3152141">string</span><span class="op" id="3152147">)</span>&nbsp;<span class="builtintype" id="3152149">bool</span><span class="op" id="3152153">)</span>&nbsp;<span class="builtintype" id="3152155">bool</span>&nbsp;<span class="op" id="3152160">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152163">return</span>&nbsp;<span class="ident" id="3152170">rr</span><span class="op" id="3152172">.</span><span class="ident" id="3152173">Hdr</span><span class="op" id="3152176">.</span><span class="ident" id="3152177">Walk</span><span class="op" id="3152181">(</span><span class="ident" id="3152182">f</span><span class="op" id="3152183">)</span>&nbsp;<span class="op" id="3152185">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152190">f</span><span class="op" id="3152191">(</span><span class="op" id="3152192">&amp;</span><span class="ident" id="3152193">rr</span><span class="op" id="3152195">.</span><span class="ident" id="3152196">Priority</span><span class="op" id="3152204">,</span>&nbsp;<span class="string" id="3152206">&#34;Priority&#34;</span><span class="op" id="3152216">,</span>&nbsp;<span class="string" id="3152218">&#34;&#34;</span><span class="op" id="3152220">)</span>&nbsp;<span class="op" id="3152222">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152227">f</span><span class="op" id="3152228">(</span><span class="op" id="3152229">&amp;</span><span class="ident" id="3152230">rr</span><span class="op" id="3152232">.</span><span class="ident" id="3152233">Weight</span><span class="op" id="3152239">,</span>&nbsp;<span class="string" id="3152241">&#34;Weight&#34;</span><span class="op" id="3152249">,</span>&nbsp;<span class="string" id="3152251">&#34;&#34;</span><span class="op" id="3152253">)</span>&nbsp;<span class="op" id="3152255">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152260">f</span><span class="op" id="3152261">(</span><span class="op" id="3152262">&amp;</span><span class="ident" id="3152263">rr</span><span class="op" id="3152265">.</span><span class="ident" id="3152266">Port</span><span class="op" id="3152270">,</span>&nbsp;<span class="string" id="3152272">&#34;Port&#34;</span><span class="op" id="3152278">,</span>&nbsp;<span class="string" id="3152280">&#34;&#34;</span><span class="op" id="3152282">)</span>&nbsp;<span class="op" id="3152284">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152289">f</span><span class="op" id="3152290">(</span><span class="op" id="3152291">&amp;</span><span class="ident" id="3152292">rr</span><span class="op" id="3152294">.</span><span class="ident" id="3152295">Target</span><span class="op" id="3152301">,</span>&nbsp;<span class="string" id="3152303">&#34;Target&#34;</span><span class="op" id="3152311">,</span>&nbsp;<span class="string" id="3152313">&#34;domain&#34;</span><span class="op" id="3152321">)</span><br>
<span class="lineno">330</span><span class="op" id="3152323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152326">type</span>&nbsp;<span class="ident" id="3152331">dnsRR_A</span>&nbsp;<span class="keyword" id="3152339">struct</span>&nbsp;<span class="op" id="3152346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152349">Hdr</span>&nbsp;<span class="ident" id="3152353">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152367">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3152371">uint32</span>&nbsp;<span class="string" id="3152378">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3152391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152394">func</span>&nbsp;<span class="op" id="3152399">(</span><span class="ident" id="3152400">rr</span>&nbsp;<span class="op" id="3152403">*</span><span class="ident" id="3152404">dnsRR_A</span><span class="op" id="3152411">)</span>&nbsp;<span class="ident" id="3152413">Header</span><span class="op" id="3152419">(</span><span class="op" id="3152420">)</span>&nbsp;<span class="op" id="3152422">*</span><span class="ident" id="3152423">dnsRR_Header</span>&nbsp;<span class="op" id="3152436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152439">return</span>&nbsp;<span class="op" id="3152446">&amp;</span><span class="ident" id="3152447">rr</span><span class="op" id="3152449">.</span><span class="ident" id="3152450">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3152454">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3152457">func</span>&nbsp;<span class="op" id="3152462">(</span><span class="ident" id="3152463">rr</span>&nbsp;<span class="op" id="3152466">*</span><span class="ident" id="3152467">dnsRR_A</span><span class="op" id="3152474">)</span>&nbsp;<span class="ident" id="3152476">Walk</span><span class="op" id="3152480">(</span><span class="ident" id="3152481">f</span>&nbsp;<span class="keyword" id="3152483">func</span><span class="op" id="3152487">(</span><span class="ident" id="3152488">v</span>&nbsp;<span class="keyword" id="3152490">interface</span><span class="op" id="3152499">{</span><span class="op" id="3152500">}</span><span class="op" id="3152501">,</span>&nbsp;<span class="ident" id="3152503">name</span><span class="op" id="3152507">,</span>&nbsp;<span class="ident" id="3152509">tag</span>&nbsp;<span class="builtintype" id="3152513">string</span><span class="op" id="3152519">)</span>&nbsp;<span class="builtintype" id="3152521">bool</span><span class="op" id="3152525">)</span>&nbsp;<span class="builtintype" id="3152527">bool</span>&nbsp;<span class="op" id="3152532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152535">return</span>&nbsp;<span class="ident" id="3152542">rr</span><span class="op" id="3152544">.</span><span class="ident" id="3152545">Hdr</span><span class="op" id="3152548">.</span><span class="ident" id="3152549">Walk</span><span class="op" id="3152553">(</span><span class="ident" id="3152554">f</span><span class="op" id="3152555">)</span>&nbsp;<span class="op" id="3152557">&amp;&amp;</span>&nbsp;<span class="ident" id="3152560">f</span><span class="op" id="3152561">(</span><span class="op" id="3152562">&amp;</span><span class="ident" id="3152563">rr</span><span class="op" id="3152565">.</span><span class="ident" id="3152566">A</span><span class="op" id="3152567">,</span>&nbsp;<span class="string" id="3152569">&#34;A&#34;</span><span class="op" id="3152572">,</span>&nbsp;<span class="string" id="3152574">&#34;ipv4&#34;</span><span class="op" id="3152580">)</span><br>
<span class="lineno"></span><span class="op" id="3152582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3152585">type</span>&nbsp;<span class="ident" id="3152590">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3152601">struct</span>&nbsp;<span class="op" id="3152608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152611">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3152616">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3152630">AAAA</span>&nbsp;<span class="op" id="3152635">[</span><span class="num" id="3152636">16</span><span class="op" id="3152638">]</span><span class="builtintype" id="3152639">byte</span>&nbsp;<span class="string" id="3152644">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3152657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3152660">func</span>&nbsp;<span class="op" id="3152665">(</span><span class="ident" id="3152666">rr</span>&nbsp;<span class="op" id="3152669">*</span><span class="ident" id="3152670">dnsRR_AAAA</span><span class="op" id="3152680">)</span>&nbsp;<span class="ident" id="3152682">Header</span><span class="op" id="3152688">(</span><span class="op" id="3152689">)</span>&nbsp;<span class="op" id="3152691">*</span><span class="ident" id="3152692">dnsRR_Header</span>&nbsp;<span class="op" id="3152705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152708">return</span>&nbsp;<span class="op" id="3152715">&amp;</span><span class="ident" id="3152716">rr</span><span class="op" id="3152718">.</span><span class="ident" id="3152719">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3152723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3152726">func</span>&nbsp;<span class="op" id="3152731">(</span><span class="ident" id="3152732">rr</span>&nbsp;<span class="op" id="3152735">*</span><span class="ident" id="3152736">dnsRR_AAAA</span><span class="op" id="3152746">)</span>&nbsp;<span class="ident" id="3152748">Walk</span><span class="op" id="3152752">(</span><span class="ident" id="3152753">f</span>&nbsp;<span class="keyword" id="3152755">func</span><span class="op" id="3152759">(</span><span class="ident" id="3152760">v</span>&nbsp;<span class="keyword" id="3152762">interface</span><span class="op" id="3152771">{</span><span class="op" id="3152772">}</span><span class="op" id="3152773">,</span>&nbsp;<span class="ident" id="3152775">name</span><span class="op" id="3152779">,</span>&nbsp;<span class="ident" id="3152781">tag</span>&nbsp;<span class="builtintype" id="3152785">string</span><span class="op" id="3152791">)</span>&nbsp;<span class="builtintype" id="3152793">bool</span><span class="op" id="3152797">)</span>&nbsp;<span class="builtintype" id="3152799">bool</span>&nbsp;<span class="op" id="3152804">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3152807">return</span>&nbsp;<span class="ident" id="3152814">rr</span><span class="op" id="3152816">.</span><span class="ident" id="3152817">Hdr</span><span class="op" id="3152820">.</span><span class="ident" id="3152821">Walk</span><span class="op" id="3152825">(</span><span class="ident" id="3152826">f</span><span class="op" id="3152827">)</span>&nbsp;<span class="op" id="3152829">&amp;&amp;</span>&nbsp;<span class="ident" id="3152832">f</span><span class="op" id="3152833">(</span><span class="ident" id="3152834">rr</span><span class="op" id="3152836">.</span><span class="ident" id="3152837">AAAA</span><span class="op" id="3152841">[</span><span class="op" id="3152842">:</span><span class="op" id="3152843">]</span><span class="op" id="3152844">,</span>&nbsp;<span class="string" id="3152846">&#34;AAAA&#34;</span><span class="op" id="3152852">,</span>&nbsp;<span class="string" id="3152854">&#34;ipv6&#34;</span><span class="op" id="3152860">)</span><br>
<span class="lineno"></span><span class="op" id="3152862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3152865">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3152891">//</span><br>
<span class="lineno">360</span><span class="comment" id="3152894">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3152956">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3153023">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3153085">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3153151">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3153173">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3153219">var</span>&nbsp;<span class="ident" id="3153223">rr_mk</span>&nbsp;<span class="op" id="3153229">=</span>&nbsp;<span class="keyword" id="3153231">map</span><span class="op" id="3153234">[</span><span class="builtintype" id="3153235">int</span><span class="op" id="3153238">]</span><span class="keyword" id="3153239">func</span><span class="op" id="3153243">(</span><span class="op" id="3153244">)</span>&nbsp;<span class="ident" id="3153246">dnsRR</span><span class="op" id="3153251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153254">dnsTypeCNAME</span><span class="op" id="3153266">:</span>&nbsp;<span class="keyword" id="3153268">func</span><span class="op" id="3153272">(</span><span class="op" id="3153273">)</span>&nbsp;<span class="ident" id="3153275">dnsRR</span>&nbsp;<span class="op" id="3153281">{</span>&nbsp;<span class="keyword" id="3153283">return</span>&nbsp;<span class="builtinfunc" id="3153290">new</span><span class="op" id="3153293">(</span><span class="ident" id="3153294">dnsRR_CNAME</span><span class="op" id="3153305">)</span>&nbsp;<span class="op" id="3153307">}</span><span class="op" id="3153308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153311">dnsTypeHINFO</span><span class="op" id="3153323">:</span>&nbsp;<span class="keyword" id="3153325">func</span><span class="op" id="3153329">(</span><span class="op" id="3153330">)</span>&nbsp;<span class="ident" id="3153332">dnsRR</span>&nbsp;<span class="op" id="3153338">{</span>&nbsp;<span class="keyword" id="3153340">return</span>&nbsp;<span class="builtinfunc" id="3153347">new</span><span class="op" id="3153350">(</span><span class="ident" id="3153351">dnsRR_HINFO</span><span class="op" id="3153362">)</span>&nbsp;<span class="op" id="3153364">}</span><span class="op" id="3153365">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153368">dnsTypeMB</span><span class="op" id="3153377">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153382">func</span><span class="op" id="3153386">(</span><span class="op" id="3153387">)</span>&nbsp;<span class="ident" id="3153389">dnsRR</span>&nbsp;<span class="op" id="3153395">{</span>&nbsp;<span class="keyword" id="3153397">return</span>&nbsp;<span class="builtinfunc" id="3153404">new</span><span class="op" id="3153407">(</span><span class="ident" id="3153408">dnsRR_MB</span><span class="op" id="3153416">)</span>&nbsp;<span class="op" id="3153418">}</span><span class="op" id="3153419">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153422">dnsTypeMG</span><span class="op" id="3153431">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153436">func</span><span class="op" id="3153440">(</span><span class="op" id="3153441">)</span>&nbsp;<span class="ident" id="3153443">dnsRR</span>&nbsp;<span class="op" id="3153449">{</span>&nbsp;<span class="keyword" id="3153451">return</span>&nbsp;<span class="builtinfunc" id="3153458">new</span><span class="op" id="3153461">(</span><span class="ident" id="3153462">dnsRR_MG</span><span class="op" id="3153470">)</span>&nbsp;<span class="op" id="3153472">}</span><span class="op" id="3153473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153476">dnsTypeMINFO</span><span class="op" id="3153488">:</span>&nbsp;<span class="keyword" id="3153490">func</span><span class="op" id="3153494">(</span><span class="op" id="3153495">)</span>&nbsp;<span class="ident" id="3153497">dnsRR</span>&nbsp;<span class="op" id="3153503">{</span>&nbsp;<span class="keyword" id="3153505">return</span>&nbsp;<span class="builtinfunc" id="3153512">new</span><span class="op" id="3153515">(</span><span class="ident" id="3153516">dnsRR_MINFO</span><span class="op" id="3153527">)</span>&nbsp;<span class="op" id="3153529">}</span><span class="op" id="3153530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153533">dnsTypeMR</span><span class="op" id="3153542">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153547">func</span><span class="op" id="3153551">(</span><span class="op" id="3153552">)</span>&nbsp;<span class="ident" id="3153554">dnsRR</span>&nbsp;<span class="op" id="3153560">{</span>&nbsp;<span class="keyword" id="3153562">return</span>&nbsp;<span class="builtinfunc" id="3153569">new</span><span class="op" id="3153572">(</span><span class="ident" id="3153573">dnsRR_MR</span><span class="op" id="3153581">)</span>&nbsp;<span class="op" id="3153583">}</span><span class="op" id="3153584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153587">dnsTypeMX</span><span class="op" id="3153596">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153601">func</span><span class="op" id="3153605">(</span><span class="op" id="3153606">)</span>&nbsp;<span class="ident" id="3153608">dnsRR</span>&nbsp;<span class="op" id="3153614">{</span>&nbsp;<span class="keyword" id="3153616">return</span>&nbsp;<span class="builtinfunc" id="3153623">new</span><span class="op" id="3153626">(</span><span class="ident" id="3153627">dnsRR_MX</span><span class="op" id="3153635">)</span>&nbsp;<span class="op" id="3153637">}</span><span class="op" id="3153638">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153641">dnsTypeNS</span><span class="op" id="3153650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153655">func</span><span class="op" id="3153659">(</span><span class="op" id="3153660">)</span>&nbsp;<span class="ident" id="3153662">dnsRR</span>&nbsp;<span class="op" id="3153668">{</span>&nbsp;<span class="keyword" id="3153670">return</span>&nbsp;<span class="builtinfunc" id="3153677">new</span><span class="op" id="3153680">(</span><span class="ident" id="3153681">dnsRR_NS</span><span class="op" id="3153689">)</span>&nbsp;<span class="op" id="3153691">}</span><span class="op" id="3153692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153695">dnsTypePTR</span><span class="op" id="3153705">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153709">func</span><span class="op" id="3153713">(</span><span class="op" id="3153714">)</span>&nbsp;<span class="ident" id="3153716">dnsRR</span>&nbsp;<span class="op" id="3153722">{</span>&nbsp;<span class="keyword" id="3153724">return</span>&nbsp;<span class="builtinfunc" id="3153731">new</span><span class="op" id="3153734">(</span><span class="ident" id="3153735">dnsRR_PTR</span><span class="op" id="3153744">)</span>&nbsp;<span class="op" id="3153746">}</span><span class="op" id="3153747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153750">dnsTypeSOA</span><span class="op" id="3153760">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153764">func</span><span class="op" id="3153768">(</span><span class="op" id="3153769">)</span>&nbsp;<span class="ident" id="3153771">dnsRR</span>&nbsp;<span class="op" id="3153777">{</span>&nbsp;<span class="keyword" id="3153779">return</span>&nbsp;<span class="builtinfunc" id="3153786">new</span><span class="op" id="3153789">(</span><span class="ident" id="3153790">dnsRR_SOA</span><span class="op" id="3153799">)</span>&nbsp;<span class="op" id="3153801">}</span><span class="op" id="3153802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153805">dnsTypeTXT</span><span class="op" id="3153815">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153819">func</span><span class="op" id="3153823">(</span><span class="op" id="3153824">)</span>&nbsp;<span class="ident" id="3153826">dnsRR</span>&nbsp;<span class="op" id="3153832">{</span>&nbsp;<span class="keyword" id="3153834">return</span>&nbsp;<span class="builtinfunc" id="3153841">new</span><span class="op" id="3153844">(</span><span class="ident" id="3153845">dnsRR_TXT</span><span class="op" id="3153854">)</span>&nbsp;<span class="op" id="3153856">}</span><span class="op" id="3153857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153860">dnsTypeSRV</span><span class="op" id="3153870">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153874">func</span><span class="op" id="3153878">(</span><span class="op" id="3153879">)</span>&nbsp;<span class="ident" id="3153881">dnsRR</span>&nbsp;<span class="op" id="3153887">{</span>&nbsp;<span class="keyword" id="3153889">return</span>&nbsp;<span class="builtinfunc" id="3153896">new</span><span class="op" id="3153899">(</span><span class="ident" id="3153900">dnsRR_SRV</span><span class="op" id="3153909">)</span>&nbsp;<span class="op" id="3153911">}</span><span class="op" id="3153912">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153915">dnsTypeA</span><span class="op" id="3153923">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3153929">func</span><span class="op" id="3153933">(</span><span class="op" id="3153934">)</span>&nbsp;<span class="ident" id="3153936">dnsRR</span>&nbsp;<span class="op" id="3153942">{</span>&nbsp;<span class="keyword" id="3153944">return</span>&nbsp;<span class="builtinfunc" id="3153951">new</span><span class="op" id="3153954">(</span><span class="ident" id="3153955">dnsRR_A</span><span class="op" id="3153962">)</span>&nbsp;<span class="op" id="3153964">}</span><span class="op" id="3153965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3153968">dnsTypeAAAA</span><span class="op" id="3153979">:</span>&nbsp;&nbsp;<span class="keyword" id="3153982">func</span><span class="op" id="3153986">(</span><span class="op" id="3153987">)</span>&nbsp;<span class="ident" id="3153989">dnsRR</span>&nbsp;<span class="op" id="3153995">{</span>&nbsp;<span class="keyword" id="3153997">return</span>&nbsp;<span class="builtinfunc" id="3154004">new</span><span class="op" id="3154007">(</span><span class="ident" id="3154008">dnsRR_AAAA</span><span class="op" id="3154018">)</span>&nbsp;<span class="op" id="3154020">}</span><span class="op" id="3154021">,</span><br>
<span class="lineno"></span><span class="op" id="3154023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154026">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3154066">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3154116">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3154175">func</span>&nbsp;<span class="ident" id="3154180">packDomainName</span><span class="op" id="3154194">(</span><span class="ident" id="3154195">s</span>&nbsp;<span class="builtintype" id="3154197">string</span><span class="op" id="3154203">,</span>&nbsp;<span class="ident" id="3154205">msg</span>&nbsp;<span class="op" id="3154209">[</span><span class="op" id="3154210">]</span><span class="builtintype" id="3154211">byte</span><span class="op" id="3154215">,</span>&nbsp;<span class="ident" id="3154217">off</span>&nbsp;<span class="builtintype" id="3154221">int</span><span class="op" id="3154224">)</span>&nbsp;<span class="op" id="3154226">(</span><span class="ident" id="3154227">off1</span>&nbsp;<span class="builtintype" id="3154232">int</span><span class="op" id="3154235">,</span>&nbsp;<span class="ident" id="3154237">ok</span>&nbsp;<span class="builtintype" id="3154240">bool</span><span class="op" id="3154244">)</span>&nbsp;<span class="op" id="3154246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154249">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154292">if</span>&nbsp;<span class="ident" id="3154295">n</span>&nbsp;<span class="op" id="3154297">:=</span>&nbsp;<span class="builtinfunc" id="3154300">len</span><span class="op" id="3154303">(</span><span class="ident" id="3154304">s</span><span class="op" id="3154305">)</span><span class="op" id="3154306">;</span>&nbsp;<span class="ident" id="3154308">n</span>&nbsp;<span class="op" id="3154310">==</span>&nbsp;<span class="num" id="3154313">0</span>&nbsp;<span class="op" id="3154315">||</span>&nbsp;<span class="ident" id="3154318">s</span><span class="op" id="3154319">[</span><span class="ident" id="3154320">n</span><span class="op" id="3154321">-</span><span class="num" id="3154322">1</span><span class="op" id="3154323">]</span>&nbsp;<span class="op" id="3154325">!=</span>&nbsp;<span class="string" id="3154328">&#39;.&#39;</span>&nbsp;<span class="op" id="3154332">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154336">s</span>&nbsp;<span class="op" id="3154338">+=</span>&nbsp;<span class="string" id="3154341">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154350">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154391">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154437">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154472">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154518">tot</span>&nbsp;<span class="op" id="3154522">:=</span>&nbsp;<span class="builtinfunc" id="3154525">len</span><span class="op" id="3154528">(</span><span class="ident" id="3154529">s</span><span class="op" id="3154530">)</span>&nbsp;<span class="op" id="3154532">+</span>&nbsp;<span class="num" id="3154534">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154537">if</span>&nbsp;<span class="ident" id="3154540">off</span><span class="op" id="3154543">+</span><span class="ident" id="3154544">tot</span>&nbsp;<span class="op" id="3154548">&gt;</span>&nbsp;<span class="builtinfunc" id="3154550">len</span><span class="op" id="3154553">(</span><span class="ident" id="3154554">msg</span><span class="op" id="3154557">)</span>&nbsp;<span class="op" id="3154559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154563">return</span>&nbsp;<span class="builtinfunc" id="3154570">len</span><span class="op" id="3154573">(</span><span class="ident" id="3154574">msg</span><span class="op" id="3154577">)</span><span class="op" id="3154578">,</span>&nbsp;<span class="builtintype" id="3154580">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3154591">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154647">begin</span>&nbsp;<span class="op" id="3154653">:=</span>&nbsp;<span class="num" id="3154656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154659">for</span>&nbsp;<span class="ident" id="3154663">i</span>&nbsp;<span class="op" id="3154665">:=</span>&nbsp;<span class="num" id="3154668">0</span><span class="op" id="3154669">;</span>&nbsp;<span class="ident" id="3154671">i</span>&nbsp;<span class="op" id="3154673">&lt;</span>&nbsp;<span class="builtinfunc" id="3154675">len</span><span class="op" id="3154678">(</span><span class="ident" id="3154679">s</span><span class="op" id="3154680">)</span><span class="op" id="3154681">;</span>&nbsp;<span class="ident" id="3154683">i</span><span class="op" id="3154684">++</span>&nbsp;<span class="op" id="3154687">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154691">if</span>&nbsp;<span class="ident" id="3154694">s</span><span class="op" id="3154695">[</span><span class="ident" id="3154696">i</span><span class="op" id="3154697">]</span>&nbsp;<span class="op" id="3154699">==</span>&nbsp;<span class="string" id="3154702">&#39;.&#39;</span>&nbsp;<span class="op" id="3154706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154711">if</span>&nbsp;<span class="ident" id="3154714">i</span><span class="op" id="3154715">-</span><span class="ident" id="3154716">begin</span>&nbsp;<span class="op" id="3154722">&gt;=</span>&nbsp;<span class="num" id="3154725">1</span><span class="op" id="3154726">&lt;&lt;</span><span class="num" id="3154728">6</span>&nbsp;<span class="op" id="3154730">{</span>&nbsp;<span class="comment" id="3154732">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154776">return</span>&nbsp;<span class="builtinfunc" id="3154783">len</span><span class="op" id="3154786">(</span><span class="ident" id="3154787">msg</span><span class="op" id="3154790">)</span><span class="op" id="3154791">,</span>&nbsp;<span class="builtintype" id="3154793">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154807">msg</span><span class="op" id="3154810">[</span><span class="ident" id="3154811">off</span><span class="op" id="3154814">]</span>&nbsp;<span class="op" id="3154816">=</span>&nbsp;<span class="builtintype" id="3154818">byte</span><span class="op" id="3154822">(</span><span class="ident" id="3154823">i</span>&nbsp;<span class="op" id="3154825">-</span>&nbsp;<span class="ident" id="3154827">begin</span><span class="op" id="3154832">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154837">off</span><span class="op" id="3154840">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154846">for</span>&nbsp;<span class="ident" id="3154850">j</span>&nbsp;<span class="op" id="3154852">:=</span>&nbsp;<span class="ident" id="3154855">begin</span><span class="op" id="3154860">;</span>&nbsp;<span class="ident" id="3154862">j</span>&nbsp;<span class="op" id="3154864">&lt;</span>&nbsp;<span class="ident" id="3154866">i</span><span class="op" id="3154867">;</span>&nbsp;<span class="ident" id="3154869">j</span><span class="op" id="3154870">++</span>&nbsp;<span class="op" id="3154873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154879">msg</span><span class="op" id="3154882">[</span><span class="ident" id="3154883">off</span><span class="op" id="3154886">]</span>&nbsp;<span class="op" id="3154888">=</span>&nbsp;<span class="ident" id="3154890">s</span><span class="op" id="3154891">[</span><span class="ident" id="3154892">j</span><span class="op" id="3154893">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154899">off</span><span class="op" id="3154902">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154908">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154913">begin</span>&nbsp;<span class="op" id="3154919">=</span>&nbsp;<span class="ident" id="3154921">i</span>&nbsp;<span class="op" id="3154923">+</span>&nbsp;<span class="num" id="3154925">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3154932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154935">msg</span><span class="op" id="3154938">[</span><span class="ident" id="3154939">off</span><span class="op" id="3154942">]</span>&nbsp;<span class="op" id="3154944">=</span>&nbsp;<span class="num" id="3154946">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3154949">off</span><span class="op" id="3154952">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3154956">return</span>&nbsp;<span class="ident" id="3154963">off</span><span class="op" id="3154966">,</span>&nbsp;<span class="builtintype" id="3154968">true</span><br>
<span class="lineno"></span><span class="op" id="3154973">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3154976">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3155001">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3155066">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3155131">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3155192">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3155253">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3155316">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3155385">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3155423">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3155472">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3155538">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3155584">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3155646">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3155707">func</span>&nbsp;<span class="ident" id="3155712">unpackDomainName</span><span class="op" id="3155728">(</span><span class="ident" id="3155729">msg</span>&nbsp;<span class="op" id="3155733">[</span><span class="op" id="3155734">]</span><span class="builtintype" id="3155735">byte</span><span class="op" id="3155739">,</span>&nbsp;<span class="ident" id="3155741">off</span>&nbsp;<span class="builtintype" id="3155745">int</span><span class="op" id="3155748">)</span>&nbsp;<span class="op" id="3155750">(</span><span class="ident" id="3155751">s</span>&nbsp;<span class="builtintype" id="3155753">string</span><span class="op" id="3155759">,</span>&nbsp;<span class="ident" id="3155761">off1</span>&nbsp;<span class="builtintype" id="3155766">int</span><span class="op" id="3155769">,</span>&nbsp;<span class="ident" id="3155771">ok</span>&nbsp;<span class="builtintype" id="3155774">bool</span><span class="op" id="3155778">)</span>&nbsp;<span class="op" id="3155780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155783">s</span>&nbsp;<span class="op" id="3155785">=</span>&nbsp;<span class="string" id="3155787">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155791">ptr</span>&nbsp;<span class="op" id="3155795">:=</span>&nbsp;<span class="num" id="3155798">0</span>&nbsp;<span class="comment" id="3155800">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3155831">Loop</span><span class="op" id="3155835">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155838">for</span>&nbsp;<span class="op" id="3155842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155846">if</span>&nbsp;<span class="ident" id="3155849">off</span>&nbsp;<span class="op" id="3155853">&gt;=</span>&nbsp;<span class="builtinfunc" id="3155856">len</span><span class="op" id="3155859">(</span><span class="ident" id="3155860">msg</span><span class="op" id="3155863">)</span>&nbsp;<span class="op" id="3155865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155870">return</span>&nbsp;<span class="string" id="3155877">&#34;&#34;</span><span class="op" id="3155879">,</span>&nbsp;<span class="builtinfunc" id="3155881">len</span><span class="op" id="3155884">(</span><span class="ident" id="3155885">msg</span><span class="op" id="3155888">)</span><span class="op" id="3155889">,</span>&nbsp;<span class="builtintype" id="3155891">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3155899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155903">c</span>&nbsp;<span class="op" id="3155905">:=</span>&nbsp;<span class="builtintype" id="3155908">int</span><span class="op" id="3155911">(</span><span class="ident" id="3155912">msg</span><span class="op" id="3155915">[</span><span class="ident" id="3155916">off</span><span class="op" id="3155919">]</span><span class="op" id="3155920">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3155924">off</span><span class="op" id="3155927">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155932">switch</span>&nbsp;<span class="ident" id="3155939">c</span>&nbsp;<span class="op" id="3155941">&amp;</span>&nbsp;<span class="num" id="3155943">0xC0</span>&nbsp;<span class="op" id="3155948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155952">case</span>&nbsp;<span class="num" id="3155957">0x00</span><span class="op" id="3155961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3155966">if</span>&nbsp;<span class="ident" id="3155969">c</span>&nbsp;<span class="op" id="3155971">==</span>&nbsp;<span class="num" id="3155974">0x00</span>&nbsp;<span class="op" id="3155979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3155985">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156004">break</span>&nbsp;<span class="ident" id="3156010">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156023">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156044">if</span>&nbsp;<span class="ident" id="3156047">off</span><span class="op" id="3156050">+</span><span class="ident" id="3156051">c</span>&nbsp;<span class="op" id="3156053">&gt;</span>&nbsp;<span class="builtinfunc" id="3156055">len</span><span class="op" id="3156058">(</span><span class="ident" id="3156059">msg</span><span class="op" id="3156062">)</span>&nbsp;<span class="op" id="3156064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156070">return</span>&nbsp;<span class="string" id="3156077">&#34;&#34;</span><span class="op" id="3156079">,</span>&nbsp;<span class="builtinfunc" id="3156081">len</span><span class="op" id="3156084">(</span><span class="ident" id="3156085">msg</span><span class="op" id="3156088">)</span><span class="op" id="3156089">,</span>&nbsp;<span class="builtintype" id="3156091">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156105">s</span>&nbsp;<span class="op" id="3156107">+=</span>&nbsp;<span class="builtintype" id="3156110">string</span><span class="op" id="3156116">(</span><span class="ident" id="3156117">msg</span><span class="op" id="3156120">[</span><span class="ident" id="3156121">off</span><span class="op" id="3156124">:</span><span class="ident" id="3156125">off</span><span class="op" id="3156128">+</span><span class="ident" id="3156129">c</span><span class="op" id="3156130">]</span><span class="op" id="3156131">)</span>&nbsp;<span class="op" id="3156133">+</span>&nbsp;<span class="string" id="3156135">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156142">off</span>&nbsp;<span class="op" id="3156146">+=</span>&nbsp;<span class="ident" id="3156149">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156153">case</span>&nbsp;<span class="num" id="3156158">0xC0</span><span class="op" id="3156162">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156167">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156207">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156248">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156295">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156341">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156369">if</span>&nbsp;<span class="ident" id="3156372">off</span>&nbsp;<span class="op" id="3156376">&gt;=</span>&nbsp;<span class="builtinfunc" id="3156379">len</span><span class="op" id="3156382">(</span><span class="ident" id="3156383">msg</span><span class="op" id="3156386">)</span>&nbsp;<span class="op" id="3156388">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156394">return</span>&nbsp;<span class="string" id="3156401">&#34;&#34;</span><span class="op" id="3156403">,</span>&nbsp;<span class="builtinfunc" id="3156405">len</span><span class="op" id="3156408">(</span><span class="ident" id="3156409">msg</span><span class="op" id="3156412">)</span><span class="op" id="3156413">,</span>&nbsp;<span class="builtintype" id="3156415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156429">c1</span>&nbsp;<span class="op" id="3156432">:=</span>&nbsp;<span class="ident" id="3156435">msg</span><span class="op" id="3156438">[</span><span class="ident" id="3156439">off</span><span class="op" id="3156442">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156447">off</span><span class="op" id="3156450">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156456">if</span>&nbsp;<span class="ident" id="3156459">ptr</span>&nbsp;<span class="op" id="3156463">==</span>&nbsp;<span class="num" id="3156466">0</span>&nbsp;<span class="op" id="3156468">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156474">off1</span>&nbsp;<span class="op" id="3156479">=</span>&nbsp;<span class="ident" id="3156481">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156493">if</span>&nbsp;<span class="ident" id="3156496">ptr</span><span class="op" id="3156499">++</span><span class="op" id="3156501">;</span>&nbsp;<span class="ident" id="3156503">ptr</span>&nbsp;<span class="op" id="3156507">&gt;</span>&nbsp;<span class="num" id="3156509">10</span>&nbsp;<span class="op" id="3156512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156518">return</span>&nbsp;<span class="string" id="3156525">&#34;&#34;</span><span class="op" id="3156527">,</span>&nbsp;<span class="builtinfunc" id="3156529">len</span><span class="op" id="3156532">(</span><span class="ident" id="3156533">msg</span><span class="op" id="3156536">)</span><span class="op" id="3156537">,</span>&nbsp;<span class="builtintype" id="3156539">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156548">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156553">off</span>&nbsp;<span class="op" id="3156557">=</span>&nbsp;<span class="op" id="3156559">(</span><span class="ident" id="3156560">c</span><span class="op" id="3156561">^</span><span class="num" id="3156562">0xC0</span><span class="op" id="3156566">)</span><span class="op" id="3156567">&lt;&lt;</span><span class="num" id="3156569">8</span>&nbsp;<span class="op" id="3156571">|</span>&nbsp;<span class="builtintype" id="3156573">int</span><span class="op" id="3156576">(</span><span class="ident" id="3156577">c1</span><span class="op" id="3156579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156583">default</span><span class="op" id="3156590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3156595">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156628">return</span>&nbsp;<span class="string" id="3156635">&#34;&#34;</span><span class="op" id="3156637">,</span>&nbsp;<span class="builtinfunc" id="3156639">len</span><span class="op" id="3156642">(</span><span class="ident" id="3156643">msg</span><span class="op" id="3156646">)</span><span class="op" id="3156647">,</span>&nbsp;<span class="builtintype" id="3156649">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156657">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156663">if</span>&nbsp;<span class="ident" id="3156666">ptr</span>&nbsp;<span class="op" id="3156670">==</span>&nbsp;<span class="num" id="3156673">0</span>&nbsp;<span class="op" id="3156675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156679">off1</span>&nbsp;<span class="op" id="3156684">=</span>&nbsp;<span class="ident" id="3156686">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3156691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156694">return</span>&nbsp;<span class="ident" id="3156701">s</span><span class="op" id="3156702">,</span>&nbsp;<span class="ident" id="3156704">off1</span><span class="op" id="3156708">,</span>&nbsp;<span class="builtintype" id="3156710">true</span><br>
<span class="lineno">485</span><span class="op" id="3156715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3156718">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3156788">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3156849">func</span>&nbsp;<span class="ident" id="3156854">packStruct</span><span class="op" id="3156864">(</span><span class="ident" id="3156865">any</span>&nbsp;<span class="ident" id="3156869">dnsStruct</span><span class="op" id="3156878">,</span>&nbsp;<span class="ident" id="3156880">msg</span>&nbsp;<span class="op" id="3156884">[</span><span class="op" id="3156885">]</span><span class="builtintype" id="3156886">byte</span><span class="op" id="3156890">,</span>&nbsp;<span class="ident" id="3156892">off</span>&nbsp;<span class="builtintype" id="3156896">int</span><span class="op" id="3156899">)</span>&nbsp;<span class="op" id="3156901">(</span><span class="ident" id="3156902">off1</span>&nbsp;<span class="builtintype" id="3156907">int</span><span class="op" id="3156910">,</span>&nbsp;<span class="ident" id="3156912">ok</span>&nbsp;<span class="builtintype" id="3156915">bool</span><span class="op" id="3156919">)</span>&nbsp;<span class="op" id="3156921">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3156924">ok</span>&nbsp;<span class="op" id="3156927">=</span>&nbsp;<span class="ident" id="3156929">any</span><span class="op" id="3156932">.</span><span class="ident" id="3156933">Walk</span><span class="op" id="3156937">(</span><span class="keyword" id="3156938">func</span><span class="op" id="3156942">(</span><span class="ident" id="3156943">field</span>&nbsp;<span class="keyword" id="3156949">interface</span><span class="op" id="3156958">{</span><span class="op" id="3156959">}</span><span class="op" id="3156960">,</span>&nbsp;<span class="ident" id="3156962">name</span><span class="op" id="3156966">,</span>&nbsp;<span class="ident" id="3156968">tag</span>&nbsp;<span class="builtintype" id="3156972">string</span><span class="op" id="3156978">)</span>&nbsp;<span class="builtintype" id="3156980">bool</span>&nbsp;<span class="op" id="3156985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3156989">switch</span>&nbsp;<span class="ident" id="3156996">fv</span>&nbsp;<span class="op" id="3156999">:=</span>&nbsp;<span class="ident" id="3157002">field</span><span class="op" id="3157007">.</span><span class="op" id="3157008">(</span><span class="keyword" id="3157009">type</span><span class="op" id="3157013">)</span>&nbsp;<span class="op" id="3157015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157019">default</span><span class="op" id="3157026">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3157031">println</span><span class="op" id="3157038">(</span><span class="string" id="3157039">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3157071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157076">return</span>&nbsp;<span class="builtintype" id="3157083">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157091">case</span>&nbsp;<span class="op" id="3157096">*</span><span class="builtintype" id="3157097">uint16</span><span class="op" id="3157103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157108">i</span>&nbsp;<span class="op" id="3157110">:=</span>&nbsp;<span class="op" id="3157113">*</span><span class="ident" id="3157114">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157120">if</span>&nbsp;<span class="ident" id="3157123">off</span><span class="op" id="3157126">+</span><span class="num" id="3157127">2</span>&nbsp;<span class="op" id="3157129">&gt;</span>&nbsp;<span class="builtinfunc" id="3157131">len</span><span class="op" id="3157134">(</span><span class="ident" id="3157135">msg</span><span class="op" id="3157138">)</span>&nbsp;<span class="op" id="3157140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157146">return</span>&nbsp;<span class="builtintype" id="3157153">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157162">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157167">msg</span><span class="op" id="3157170">[</span><span class="ident" id="3157171">off</span><span class="op" id="3157174">]</span>&nbsp;<span class="op" id="3157176">=</span>&nbsp;<span class="builtintype" id="3157178">byte</span><span class="op" id="3157182">(</span><span class="ident" id="3157183">i</span>&nbsp;<span class="op" id="3157185">&gt;&gt;</span>&nbsp;<span class="num" id="3157188">8</span><span class="op" id="3157189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157194">msg</span><span class="op" id="3157197">[</span><span class="ident" id="3157198">off</span><span class="op" id="3157201">+</span><span class="num" id="3157202">1</span><span class="op" id="3157203">]</span>&nbsp;<span class="op" id="3157205">=</span>&nbsp;<span class="builtintype" id="3157207">byte</span><span class="op" id="3157211">(</span><span class="ident" id="3157212">i</span><span class="op" id="3157213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157218">off</span>&nbsp;<span class="op" id="3157222">+=</span>&nbsp;<span class="num" id="3157225">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157229">case</span>&nbsp;<span class="op" id="3157234">*</span><span class="builtintype" id="3157235">uint32</span><span class="op" id="3157241">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157246">i</span>&nbsp;<span class="op" id="3157248">:=</span>&nbsp;<span class="op" id="3157251">*</span><span class="ident" id="3157252">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157258">msg</span><span class="op" id="3157261">[</span><span class="ident" id="3157262">off</span><span class="op" id="3157265">]</span>&nbsp;<span class="op" id="3157267">=</span>&nbsp;<span class="builtintype" id="3157269">byte</span><span class="op" id="3157273">(</span><span class="ident" id="3157274">i</span>&nbsp;<span class="op" id="3157276">&gt;&gt;</span>&nbsp;<span class="num" id="3157279">24</span><span class="op" id="3157281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157286">msg</span><span class="op" id="3157289">[</span><span class="ident" id="3157290">off</span><span class="op" id="3157293">+</span><span class="num" id="3157294">1</span><span class="op" id="3157295">]</span>&nbsp;<span class="op" id="3157297">=</span>&nbsp;<span class="builtintype" id="3157299">byte</span><span class="op" id="3157303">(</span><span class="ident" id="3157304">i</span>&nbsp;<span class="op" id="3157306">&gt;&gt;</span>&nbsp;<span class="num" id="3157309">16</span><span class="op" id="3157311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157316">msg</span><span class="op" id="3157319">[</span><span class="ident" id="3157320">off</span><span class="op" id="3157323">+</span><span class="num" id="3157324">2</span><span class="op" id="3157325">]</span>&nbsp;<span class="op" id="3157327">=</span>&nbsp;<span class="builtintype" id="3157329">byte</span><span class="op" id="3157333">(</span><span class="ident" id="3157334">i</span>&nbsp;<span class="op" id="3157336">&gt;&gt;</span>&nbsp;<span class="num" id="3157339">8</span><span class="op" id="3157340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157345">msg</span><span class="op" id="3157348">[</span><span class="ident" id="3157349">off</span><span class="op" id="3157352">+</span><span class="num" id="3157353">3</span><span class="op" id="3157354">]</span>&nbsp;<span class="op" id="3157356">=</span>&nbsp;<span class="builtintype" id="3157358">byte</span><span class="op" id="3157362">(</span><span class="ident" id="3157363">i</span><span class="op" id="3157364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157369">off</span>&nbsp;<span class="op" id="3157373">+=</span>&nbsp;<span class="num" id="3157376">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157380">case</span>&nbsp;<span class="op" id="3157385">[</span><span class="op" id="3157386">]</span><span class="builtintype" id="3157387">byte</span><span class="op" id="3157391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157396">n</span>&nbsp;<span class="op" id="3157398">:=</span>&nbsp;<span class="builtinfunc" id="3157401">len</span><span class="op" id="3157404">(</span><span class="ident" id="3157405">fv</span><span class="op" id="3157407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157412">if</span>&nbsp;<span class="ident" id="3157415">off</span><span class="op" id="3157418">+</span><span class="ident" id="3157419">n</span>&nbsp;<span class="op" id="3157421">&gt;</span>&nbsp;<span class="builtinfunc" id="3157423">len</span><span class="op" id="3157426">(</span><span class="ident" id="3157427">msg</span><span class="op" id="3157430">)</span>&nbsp;<span class="op" id="3157432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157438">return</span>&nbsp;<span class="builtintype" id="3157445">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157454">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3157459">copy</span><span class="op" id="3157463">(</span><span class="ident" id="3157464">msg</span><span class="op" id="3157467">[</span><span class="ident" id="3157468">off</span><span class="op" id="3157471">:</span><span class="ident" id="3157472">off</span><span class="op" id="3157475">+</span><span class="ident" id="3157476">n</span><span class="op" id="3157477">]</span><span class="op" id="3157478">,</span>&nbsp;<span class="ident" id="3157480">fv</span><span class="op" id="3157482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157487">off</span>&nbsp;<span class="op" id="3157491">+=</span>&nbsp;<span class="ident" id="3157494">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157498">case</span>&nbsp;<span class="op" id="3157503">*</span><span class="builtintype" id="3157504">string</span><span class="op" id="3157510">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157515">s</span>&nbsp;<span class="op" id="3157517">:=</span>&nbsp;<span class="op" id="3157520">*</span><span class="ident" id="3157521">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157527">switch</span>&nbsp;<span class="ident" id="3157534">tag</span>&nbsp;<span class="op" id="3157538">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157543">default</span><span class="op" id="3157550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3157556">println</span><span class="op" id="3157563">(</span><span class="string" id="3157564">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3157594">,</span>&nbsp;<span class="ident" id="3157596">tag</span><span class="op" id="3157599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157605">return</span>&nbsp;<span class="builtintype" id="3157612">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157621">case</span>&nbsp;<span class="string" id="3157626">&#34;domain&#34;</span><span class="op" id="3157634">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157640">off</span><span class="op" id="3157643">,</span>&nbsp;<span class="ident" id="3157645">ok</span>&nbsp;<span class="op" id="3157648">=</span>&nbsp;<span class="ident" id="3157650">packDomainName</span><span class="op" id="3157664">(</span><span class="ident" id="3157665">s</span><span class="op" id="3157666">,</span>&nbsp;<span class="ident" id="3157668">msg</span><span class="op" id="3157671">,</span>&nbsp;<span class="ident" id="3157673">off</span><span class="op" id="3157676">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157682">if</span>&nbsp;<span class="op" id="3157685">!</span><span class="ident" id="3157686">ok</span>&nbsp;<span class="op" id="3157689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157696">return</span>&nbsp;<span class="builtintype" id="3157703">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157718">case</span>&nbsp;<span class="string" id="3157723">&#34;&#34;</span><span class="op" id="3157725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3157731">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157769">if</span>&nbsp;<span class="builtinfunc" id="3157772">len</span><span class="op" id="3157775">(</span><span class="ident" id="3157776">s</span><span class="op" id="3157777">)</span>&nbsp;<span class="op" id="3157779">&gt;</span>&nbsp;<span class="num" id="3157781">255</span>&nbsp;<span class="op" id="3157785">||</span>&nbsp;<span class="ident" id="3157788">off</span><span class="op" id="3157791">+</span><span class="num" id="3157792">1</span><span class="op" id="3157793">+</span><span class="builtinfunc" id="3157794">len</span><span class="op" id="3157797">(</span><span class="ident" id="3157798">s</span><span class="op" id="3157799">)</span>&nbsp;<span class="op" id="3157801">&gt;</span>&nbsp;<span class="builtinfunc" id="3157803">len</span><span class="op" id="3157806">(</span><span class="ident" id="3157807">msg</span><span class="op" id="3157810">)</span>&nbsp;<span class="op" id="3157812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157819">return</span>&nbsp;<span class="builtintype" id="3157826">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157842">msg</span><span class="op" id="3157845">[</span><span class="ident" id="3157846">off</span><span class="op" id="3157849">]</span>&nbsp;<span class="op" id="3157851">=</span>&nbsp;<span class="builtintype" id="3157853">byte</span><span class="op" id="3157857">(</span><span class="builtinfunc" id="3157858">len</span><span class="op" id="3157861">(</span><span class="ident" id="3157862">s</span><span class="op" id="3157863">)</span><span class="op" id="3157864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157870">off</span><span class="op" id="3157873">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3157880">off</span>&nbsp;<span class="op" id="3157884">+=</span>&nbsp;<span class="builtinfunc" id="3157887">copy</span><span class="op" id="3157891">(</span><span class="ident" id="3157892">msg</span><span class="op" id="3157895">[</span><span class="ident" id="3157896">off</span><span class="op" id="3157899">:</span><span class="op" id="3157900">]</span><span class="op" id="3157901">,</span>&nbsp;<span class="ident" id="3157903">s</span><span class="op" id="3157904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157917">return</span>&nbsp;<span class="builtintype" id="3157924">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157930">}</span><span class="op" id="3157931">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157934">if</span>&nbsp;<span class="op" id="3157937">!</span><span class="ident" id="3157938">ok</span>&nbsp;<span class="op" id="3157941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157945">return</span>&nbsp;<span class="builtinfunc" id="3157952">len</span><span class="op" id="3157955">(</span><span class="ident" id="3157956">msg</span><span class="op" id="3157959">)</span><span class="op" id="3157960">,</span>&nbsp;<span class="builtintype" id="3157962">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3157969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3157972">return</span>&nbsp;<span class="ident" id="3157979">off</span><span class="op" id="3157982">,</span>&nbsp;<span class="builtintype" id="3157984">true</span><br>
<span class="lineno"></span><span class="op" id="3157989">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3157992">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3158057">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3158118">func</span>&nbsp;<span class="ident" id="3158123">unpackStruct</span><span class="op" id="3158135">(</span><span class="ident" id="3158136">any</span>&nbsp;<span class="ident" id="3158140">dnsStruct</span><span class="op" id="3158149">,</span>&nbsp;<span class="ident" id="3158151">msg</span>&nbsp;<span class="op" id="3158155">[</span><span class="op" id="3158156">]</span><span class="builtintype" id="3158157">byte</span><span class="op" id="3158161">,</span>&nbsp;<span class="ident" id="3158163">off</span>&nbsp;<span class="builtintype" id="3158167">int</span><span class="op" id="3158170">)</span>&nbsp;<span class="op" id="3158172">(</span><span class="ident" id="3158173">off1</span>&nbsp;<span class="builtintype" id="3158178">int</span><span class="op" id="3158181">,</span>&nbsp;<span class="ident" id="3158183">ok</span>&nbsp;<span class="builtintype" id="3158186">bool</span><span class="op" id="3158190">)</span>&nbsp;<span class="op" id="3158192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158195">ok</span>&nbsp;<span class="op" id="3158198">=</span>&nbsp;<span class="ident" id="3158200">any</span><span class="op" id="3158203">.</span><span class="ident" id="3158204">Walk</span><span class="op" id="3158208">(</span><span class="keyword" id="3158209">func</span><span class="op" id="3158213">(</span><span class="ident" id="3158214">field</span>&nbsp;<span class="keyword" id="3158220">interface</span><span class="op" id="3158229">{</span><span class="op" id="3158230">}</span><span class="op" id="3158231">,</span>&nbsp;<span class="ident" id="3158233">name</span><span class="op" id="3158237">,</span>&nbsp;<span class="ident" id="3158239">tag</span>&nbsp;<span class="builtintype" id="3158243">string</span><span class="op" id="3158249">)</span>&nbsp;<span class="builtintype" id="3158251">bool</span>&nbsp;<span class="op" id="3158256">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158260">switch</span>&nbsp;<span class="ident" id="3158267">fv</span>&nbsp;<span class="op" id="3158270">:=</span>&nbsp;<span class="ident" id="3158273">field</span><span class="op" id="3158278">.</span><span class="op" id="3158279">(</span><span class="keyword" id="3158280">type</span><span class="op" id="3158284">)</span>&nbsp;<span class="op" id="3158286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158290">default</span><span class="op" id="3158297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3158302">println</span><span class="op" id="3158309">(</span><span class="string" id="3158310">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3158342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158347">return</span>&nbsp;<span class="builtintype" id="3158354">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158362">case</span>&nbsp;<span class="op" id="3158367">*</span><span class="builtintype" id="3158368">uint16</span><span class="op" id="3158374">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158379">if</span>&nbsp;<span class="ident" id="3158382">off</span><span class="op" id="3158385">+</span><span class="num" id="3158386">2</span>&nbsp;<span class="op" id="3158388">&gt;</span>&nbsp;<span class="builtinfunc" id="3158390">len</span><span class="op" id="3158393">(</span><span class="ident" id="3158394">msg</span><span class="op" id="3158397">)</span>&nbsp;<span class="op" id="3158399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158405">return</span>&nbsp;<span class="builtintype" id="3158412">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158426">*</span><span class="ident" id="3158427">fv</span>&nbsp;<span class="op" id="3158430">=</span>&nbsp;<span class="builtintype" id="3158432">uint16</span><span class="op" id="3158438">(</span><span class="ident" id="3158439">msg</span><span class="op" id="3158442">[</span><span class="ident" id="3158443">off</span><span class="op" id="3158446">]</span><span class="op" id="3158447">)</span><span class="op" id="3158448">&lt;&lt;</span><span class="num" id="3158450">8</span>&nbsp;<span class="op" id="3158452">|</span>&nbsp;<span class="builtintype" id="3158454">uint16</span><span class="op" id="3158460">(</span><span class="ident" id="3158461">msg</span><span class="op" id="3158464">[</span><span class="ident" id="3158465">off</span><span class="op" id="3158468">+</span><span class="num" id="3158469">1</span><span class="op" id="3158470">]</span><span class="op" id="3158471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158476">off</span>&nbsp;<span class="op" id="3158480">+=</span>&nbsp;<span class="num" id="3158483">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158487">case</span>&nbsp;<span class="op" id="3158492">*</span><span class="builtintype" id="3158493">uint32</span><span class="op" id="3158499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158504">if</span>&nbsp;<span class="ident" id="3158507">off</span><span class="op" id="3158510">+</span><span class="num" id="3158511">4</span>&nbsp;<span class="op" id="3158513">&gt;</span>&nbsp;<span class="builtinfunc" id="3158515">len</span><span class="op" id="3158518">(</span><span class="ident" id="3158519">msg</span><span class="op" id="3158522">)</span>&nbsp;<span class="op" id="3158524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158530">return</span>&nbsp;<span class="builtintype" id="3158537">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158551">*</span><span class="ident" id="3158552">fv</span>&nbsp;<span class="op" id="3158555">=</span>&nbsp;<span class="builtintype" id="3158557">uint32</span><span class="op" id="3158563">(</span><span class="ident" id="3158564">msg</span><span class="op" id="3158567">[</span><span class="ident" id="3158568">off</span><span class="op" id="3158571">]</span><span class="op" id="3158572">)</span><span class="op" id="3158573">&lt;&lt;</span><span class="num" id="3158575">24</span>&nbsp;<span class="op" id="3158578">|</span>&nbsp;<span class="builtintype" id="3158580">uint32</span><span class="op" id="3158586">(</span><span class="ident" id="3158587">msg</span><span class="op" id="3158590">[</span><span class="ident" id="3158591">off</span><span class="op" id="3158594">+</span><span class="num" id="3158595">1</span><span class="op" id="3158596">]</span><span class="op" id="3158597">)</span><span class="op" id="3158598">&lt;&lt;</span><span class="num" id="3158600">16</span>&nbsp;<span class="op" id="3158603">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3158609">uint32</span><span class="op" id="3158615">(</span><span class="ident" id="3158616">msg</span><span class="op" id="3158619">[</span><span class="ident" id="3158620">off</span><span class="op" id="3158623">+</span><span class="num" id="3158624">2</span><span class="op" id="3158625">]</span><span class="op" id="3158626">)</span><span class="op" id="3158627">&lt;&lt;</span><span class="num" id="3158629">8</span>&nbsp;<span class="op" id="3158631">|</span>&nbsp;<span class="builtintype" id="3158633">uint32</span><span class="op" id="3158639">(</span><span class="ident" id="3158640">msg</span><span class="op" id="3158643">[</span><span class="ident" id="3158644">off</span><span class="op" id="3158647">+</span><span class="num" id="3158648">3</span><span class="op" id="3158649">]</span><span class="op" id="3158650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158655">off</span>&nbsp;<span class="op" id="3158659">+=</span>&nbsp;<span class="num" id="3158662">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158666">case</span>&nbsp;<span class="op" id="3158671">[</span><span class="op" id="3158672">]</span><span class="builtintype" id="3158673">byte</span><span class="op" id="3158677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158682">n</span>&nbsp;<span class="op" id="3158684">:=</span>&nbsp;<span class="builtinfunc" id="3158687">len</span><span class="op" id="3158690">(</span><span class="ident" id="3158691">fv</span><span class="op" id="3158693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158698">if</span>&nbsp;<span class="ident" id="3158701">off</span><span class="op" id="3158704">+</span><span class="ident" id="3158705">n</span>&nbsp;<span class="op" id="3158707">&gt;</span>&nbsp;<span class="builtinfunc" id="3158709">len</span><span class="op" id="3158712">(</span><span class="ident" id="3158713">msg</span><span class="op" id="3158716">)</span>&nbsp;<span class="op" id="3158718">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158724">return</span>&nbsp;<span class="builtintype" id="3158731">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3158740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3158745">copy</span><span class="op" id="3158749">(</span><span class="ident" id="3158750">fv</span><span class="op" id="3158752">,</span>&nbsp;<span class="ident" id="3158754">msg</span><span class="op" id="3158757">[</span><span class="ident" id="3158758">off</span><span class="op" id="3158761">:</span><span class="ident" id="3158762">off</span><span class="op" id="3158765">+</span><span class="ident" id="3158766">n</span><span class="op" id="3158767">]</span><span class="op" id="3158768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158773">off</span>&nbsp;<span class="op" id="3158777">+=</span>&nbsp;<span class="ident" id="3158780">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158784">case</span>&nbsp;<span class="op" id="3158789">*</span><span class="builtintype" id="3158790">string</span><span class="op" id="3158796">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158801">var</span>&nbsp;<span class="ident" id="3158805">s</span>&nbsp;<span class="builtintype" id="3158807">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158817">switch</span>&nbsp;<span class="ident" id="3158824">tag</span>&nbsp;<span class="op" id="3158828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158833">default</span><span class="op" id="3158840">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3158846">println</span><span class="op" id="3158853">(</span><span class="string" id="3158854">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3158884">,</span>&nbsp;<span class="ident" id="3158886">tag</span><span class="op" id="3158889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158895">return</span>&nbsp;<span class="builtintype" id="3158902">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158911">case</span>&nbsp;<span class="string" id="3158916">&#34;domain&#34;</span><span class="op" id="3158924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3158930">s</span><span class="op" id="3158931">,</span>&nbsp;<span class="ident" id="3158933">off</span><span class="op" id="3158936">,</span>&nbsp;<span class="ident" id="3158938">ok</span>&nbsp;<span class="op" id="3158941">=</span>&nbsp;<span class="ident" id="3158943">unpackDomainName</span><span class="op" id="3158959">(</span><span class="ident" id="3158960">msg</span><span class="op" id="3158963">,</span>&nbsp;<span class="ident" id="3158965">off</span><span class="op" id="3158968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158974">if</span>&nbsp;<span class="op" id="3158977">!</span><span class="ident" id="3158978">ok</span>&nbsp;<span class="op" id="3158981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3158988">return</span>&nbsp;<span class="builtintype" id="3158995">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159005">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159010">case</span>&nbsp;<span class="string" id="3159015">&#34;&#34;</span><span class="op" id="3159017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159023">if</span>&nbsp;<span class="ident" id="3159026">off</span>&nbsp;<span class="op" id="3159030">&gt;=</span>&nbsp;<span class="builtinfunc" id="3159033">len</span><span class="op" id="3159036">(</span><span class="ident" id="3159037">msg</span><span class="op" id="3159040">)</span>&nbsp;<span class="op" id="3159042">||</span>&nbsp;<span class="ident" id="3159045">off</span><span class="op" id="3159048">+</span><span class="num" id="3159049">1</span><span class="op" id="3159050">+</span><span class="builtintype" id="3159051">int</span><span class="op" id="3159054">(</span><span class="ident" id="3159055">msg</span><span class="op" id="3159058">[</span><span class="ident" id="3159059">off</span><span class="op" id="3159062">]</span><span class="op" id="3159063">)</span>&nbsp;<span class="op" id="3159065">&gt;</span>&nbsp;<span class="builtinfunc" id="3159067">len</span><span class="op" id="3159070">(</span><span class="ident" id="3159071">msg</span><span class="op" id="3159074">)</span>&nbsp;<span class="op" id="3159076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159083">return</span>&nbsp;<span class="builtintype" id="3159090">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159106">n</span>&nbsp;<span class="op" id="3159108">:=</span>&nbsp;<span class="builtintype" id="3159111">int</span><span class="op" id="3159114">(</span><span class="ident" id="3159115">msg</span><span class="op" id="3159118">[</span><span class="ident" id="3159119">off</span><span class="op" id="3159122">]</span><span class="op" id="3159123">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159129">off</span><span class="op" id="3159132">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159139">b</span>&nbsp;<span class="op" id="3159141">:=</span>&nbsp;<span class="builtinfunc" id="3159144">make</span><span class="op" id="3159148">(</span><span class="op" id="3159149">[</span><span class="op" id="3159150">]</span><span class="builtintype" id="3159151">byte</span><span class="op" id="3159155">,</span>&nbsp;<span class="ident" id="3159157">n</span><span class="op" id="3159158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159164">for</span>&nbsp;<span class="ident" id="3159168">i</span>&nbsp;<span class="op" id="3159170">:=</span>&nbsp;<span class="num" id="3159173">0</span><span class="op" id="3159174">;</span>&nbsp;<span class="ident" id="3159176">i</span>&nbsp;<span class="op" id="3159178">&lt;</span>&nbsp;<span class="ident" id="3159180">n</span><span class="op" id="3159181">;</span>&nbsp;<span class="ident" id="3159183">i</span><span class="op" id="3159184">++</span>&nbsp;<span class="op" id="3159187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159194">b</span><span class="op" id="3159195">[</span><span class="ident" id="3159196">i</span><span class="op" id="3159197">]</span>&nbsp;<span class="op" id="3159199">=</span>&nbsp;<span class="ident" id="3159201">msg</span><span class="op" id="3159204">[</span><span class="ident" id="3159205">off</span><span class="op" id="3159208">+</span><span class="ident" id="3159209">i</span><span class="op" id="3159210">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159216">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159222">off</span>&nbsp;<span class="op" id="3159226">+=</span>&nbsp;<span class="ident" id="3159229">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159235">s</span>&nbsp;<span class="op" id="3159237">=</span>&nbsp;<span class="builtintype" id="3159239">string</span><span class="op" id="3159245">(</span><span class="ident" id="3159246">b</span><span class="op" id="3159247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159257">*</span><span class="ident" id="3159258">fv</span>&nbsp;<span class="op" id="3159261">=</span>&nbsp;<span class="ident" id="3159263">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159267">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159271">return</span>&nbsp;<span class="builtintype" id="3159278">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159284">}</span><span class="op" id="3159285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159288">if</span>&nbsp;<span class="op" id="3159291">!</span><span class="ident" id="3159292">ok</span>&nbsp;<span class="op" id="3159295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159299">return</span>&nbsp;<span class="builtinfunc" id="3159306">len</span><span class="op" id="3159309">(</span><span class="ident" id="3159310">msg</span><span class="op" id="3159313">)</span><span class="op" id="3159314">,</span>&nbsp;<span class="builtintype" id="3159316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159323">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159326">return</span>&nbsp;<span class="ident" id="3159333">off</span><span class="op" id="3159336">,</span>&nbsp;<span class="builtintype" id="3159338">true</span><br>
<span class="lineno"></span><span class="op" id="3159343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3159346">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3159413">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3159433">func</span>&nbsp;<span class="ident" id="3159438">printStruct</span><span class="op" id="3159449">(</span><span class="ident" id="3159450">any</span>&nbsp;<span class="ident" id="3159454">dnsStruct</span><span class="op" id="3159463">)</span>&nbsp;<span class="builtintype" id="3159465">string</span>&nbsp;<span class="op" id="3159472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159475">s</span>&nbsp;<span class="op" id="3159477">:=</span>&nbsp;<span class="string" id="3159480">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159485">i</span>&nbsp;<span class="op" id="3159487">:=</span>&nbsp;<span class="num" id="3159490">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159493">any</span><span class="op" id="3159496">.</span><span class="ident" id="3159497">Walk</span><span class="op" id="3159501">(</span><span class="keyword" id="3159502">func</span><span class="op" id="3159506">(</span><span class="ident" id="3159507">val</span>&nbsp;<span class="keyword" id="3159511">interface</span><span class="op" id="3159520">{</span><span class="op" id="3159521">}</span><span class="op" id="3159522">,</span>&nbsp;<span class="ident" id="3159524">name</span><span class="op" id="3159528">,</span>&nbsp;<span class="ident" id="3159530">tag</span>&nbsp;<span class="builtintype" id="3159534">string</span><span class="op" id="3159540">)</span>&nbsp;<span class="builtintype" id="3159542">bool</span>&nbsp;<span class="op" id="3159547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159551">i</span><span class="op" id="3159552">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159557">if</span>&nbsp;<span class="ident" id="3159560">i</span>&nbsp;<span class="op" id="3159562">&gt;</span>&nbsp;<span class="num" id="3159564">1</span>&nbsp;<span class="op" id="3159566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159571">s</span>&nbsp;<span class="op" id="3159573">+=</span>&nbsp;<span class="string" id="3159576">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3159583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159587">s</span>&nbsp;<span class="op" id="3159589">+=</span>&nbsp;<span class="ident" id="3159592">name</span>&nbsp;<span class="op" id="3159597">+</span>&nbsp;<span class="string" id="3159599">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159605">switch</span>&nbsp;<span class="ident" id="3159612">tag</span>&nbsp;<span class="op" id="3159616">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159620">case</span>&nbsp;<span class="string" id="3159625">&#34;ipv4&#34;</span><span class="op" id="3159631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159636">i</span>&nbsp;<span class="op" id="3159638">:=</span>&nbsp;<span class="op" id="3159641">*</span><span class="ident" id="3159642">val</span><span class="op" id="3159645">.</span><span class="op" id="3159646">(</span><span class="op" id="3159647">*</span><span class="builtintype" id="3159648">uint32</span><span class="op" id="3159654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159659">s</span>&nbsp;<span class="op" id="3159661">+=</span>&nbsp;<span class="ident" id="3159664">IPv4</span><span class="op" id="3159668">(</span><span class="builtintype" id="3159669">byte</span><span class="op" id="3159673">(</span><span class="ident" id="3159674">i</span><span class="op" id="3159675">&gt;&gt;</span><span class="num" id="3159677">24</span><span class="op" id="3159679">)</span><span class="op" id="3159680">,</span>&nbsp;<span class="builtintype" id="3159682">byte</span><span class="op" id="3159686">(</span><span class="ident" id="3159687">i</span><span class="op" id="3159688">&gt;&gt;</span><span class="num" id="3159690">16</span><span class="op" id="3159692">)</span><span class="op" id="3159693">,</span>&nbsp;<span class="builtintype" id="3159695">byte</span><span class="op" id="3159699">(</span><span class="ident" id="3159700">i</span><span class="op" id="3159701">&gt;&gt;</span><span class="num" id="3159703">8</span><span class="op" id="3159704">)</span><span class="op" id="3159705">,</span>&nbsp;<span class="builtintype" id="3159707">byte</span><span class="op" id="3159711">(</span><span class="ident" id="3159712">i</span><span class="op" id="3159713">)</span><span class="op" id="3159714">)</span><span class="op" id="3159715">.</span><span class="ident" id="3159716">String</span><span class="op" id="3159722">(</span><span class="op" id="3159723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159727">case</span>&nbsp;<span class="string" id="3159732">&#34;ipv6&#34;</span><span class="op" id="3159738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159743">i</span>&nbsp;<span class="op" id="3159745">:=</span>&nbsp;<span class="ident" id="3159748">val</span><span class="op" id="3159751">.</span><span class="op" id="3159752">(</span><span class="op" id="3159753">[</span><span class="op" id="3159754">]</span><span class="builtintype" id="3159755">byte</span><span class="op" id="3159759">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159764">s</span>&nbsp;<span class="op" id="3159766">+=</span>&nbsp;<span class="ident" id="3159769">IP</span><span class="op" id="3159771">(</span><span class="ident" id="3159772">i</span><span class="op" id="3159773">)</span><span class="op" id="3159774">.</span><span class="ident" id="3159775">String</span><span class="op" id="3159781">(</span><span class="op" id="3159782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159786">default</span><span class="op" id="3159793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159798">var</span>&nbsp;<span class="ident" id="3159802">i</span>&nbsp;<span class="ident" id="3159804">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159813">switch</span>&nbsp;<span class="ident" id="3159820">v</span>&nbsp;<span class="op" id="3159822">:=</span>&nbsp;<span class="ident" id="3159825">val</span><span class="op" id="3159828">.</span><span class="op" id="3159829">(</span><span class="keyword" id="3159830">type</span><span class="op" id="3159834">)</span>&nbsp;<span class="op" id="3159836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159841">default</span><span class="op" id="3159848">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3159854">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159882">s</span>&nbsp;<span class="op" id="3159884">+=</span>&nbsp;<span class="string" id="3159887">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159908">return</span>&nbsp;<span class="builtintype" id="3159915">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159923">case</span>&nbsp;<span class="op" id="3159928">*</span><span class="builtintype" id="3159929">string</span><span class="op" id="3159935">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159941">s</span>&nbsp;<span class="op" id="3159943">+=</span>&nbsp;<span class="op" id="3159946">*</span><span class="ident" id="3159947">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159953">return</span>&nbsp;<span class="builtintype" id="3159960">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3159968">case</span>&nbsp;<span class="op" id="3159973">[</span><span class="op" id="3159974">]</span><span class="builtintype" id="3159975">byte</span><span class="op" id="3159979">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3159985">s</span>&nbsp;<span class="op" id="3159987">+=</span>&nbsp;<span class="builtintype" id="3159990">string</span><span class="op" id="3159996">(</span><span class="ident" id="3159997">v</span><span class="op" id="3159998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160004">return</span>&nbsp;<span class="builtintype" id="3160011">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160019">case</span>&nbsp;<span class="op" id="3160024">*</span><span class="builtintype" id="3160025">bool</span><span class="op" id="3160029">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160035">if</span>&nbsp;<span class="op" id="3160038">*</span><span class="ident" id="3160039">v</span>&nbsp;<span class="op" id="3160041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160048">s</span>&nbsp;<span class="op" id="3160050">+=</span>&nbsp;<span class="string" id="3160053">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160064">}</span>&nbsp;<span class="keyword" id="3160066">else</span>&nbsp;<span class="op" id="3160071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160078">s</span>&nbsp;<span class="op" id="3160080">+=</span>&nbsp;<span class="string" id="3160083">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160095">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160101">return</span>&nbsp;<span class="builtintype" id="3160108">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160116">case</span>&nbsp;<span class="op" id="3160121">*</span><span class="builtintype" id="3160122">int</span><span class="op" id="3160125">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160131">i</span>&nbsp;<span class="op" id="3160133">=</span>&nbsp;<span class="ident" id="3160135">int64</span><span class="op" id="3160140">(</span><span class="op" id="3160141">*</span><span class="ident" id="3160142">v</span><span class="op" id="3160143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160148">case</span>&nbsp;<span class="op" id="3160153">*</span><span class="builtintype" id="3160154">uint</span><span class="op" id="3160158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160164">i</span>&nbsp;<span class="op" id="3160166">=</span>&nbsp;<span class="ident" id="3160168">int64</span><span class="op" id="3160173">(</span><span class="op" id="3160174">*</span><span class="ident" id="3160175">v</span><span class="op" id="3160176">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160181">case</span>&nbsp;<span class="op" id="3160186">*</span><span class="builtintype" id="3160187">uint8</span><span class="op" id="3160192">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160198">i</span>&nbsp;<span class="op" id="3160200">=</span>&nbsp;<span class="ident" id="3160202">int64</span><span class="op" id="3160207">(</span><span class="op" id="3160208">*</span><span class="ident" id="3160209">v</span><span class="op" id="3160210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160215">case</span>&nbsp;<span class="op" id="3160220">*</span><span class="builtintype" id="3160221">uint16</span><span class="op" id="3160227">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160233">i</span>&nbsp;<span class="op" id="3160235">=</span>&nbsp;<span class="ident" id="3160237">int64</span><span class="op" id="3160242">(</span><span class="op" id="3160243">*</span><span class="ident" id="3160244">v</span><span class="op" id="3160245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160250">case</span>&nbsp;<span class="op" id="3160255">*</span><span class="builtintype" id="3160256">uint32</span><span class="op" id="3160262">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160268">i</span>&nbsp;<span class="op" id="3160270">=</span>&nbsp;<span class="ident" id="3160272">int64</span><span class="op" id="3160277">(</span><span class="op" id="3160278">*</span><span class="ident" id="3160279">v</span><span class="op" id="3160280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160285">case</span>&nbsp;<span class="op" id="3160290">*</span><span class="ident" id="3160291">uint64</span><span class="op" id="3160297">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160303">i</span>&nbsp;<span class="op" id="3160305">=</span>&nbsp;<span class="ident" id="3160307">int64</span><span class="op" id="3160312">(</span><span class="op" id="3160313">*</span><span class="ident" id="3160314">v</span><span class="op" id="3160315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160320">case</span>&nbsp;<span class="op" id="3160325">*</span><span class="builtintype" id="3160326">uintptr</span><span class="op" id="3160333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160339">i</span>&nbsp;<span class="op" id="3160341">=</span>&nbsp;<span class="ident" id="3160343">int64</span><span class="op" id="3160348">(</span><span class="op" id="3160349">*</span><span class="ident" id="3160350">v</span><span class="op" id="3160351">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160361">s</span>&nbsp;<span class="op" id="3160363">+=</span>&nbsp;<span class="ident" id="3160366">itoa</span><span class="op" id="3160370">(</span><span class="builtintype" id="3160371">int</span><span class="op" id="3160374">(</span><span class="ident" id="3160375">i</span><span class="op" id="3160376">)</span><span class="op" id="3160377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160385">return</span>&nbsp;<span class="builtintype" id="3160392">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160398">}</span><span class="op" id="3160399">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160402">s</span>&nbsp;<span class="op" id="3160404">+=</span>&nbsp;<span class="string" id="3160407">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160412">return</span>&nbsp;<span class="ident" id="3160419">s</span><br>
<span class="lineno"></span><span class="op" id="3160421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3160424">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3160451">func</span>&nbsp;<span class="ident" id="3160456">packRR</span><span class="op" id="3160462">(</span><span class="ident" id="3160463">rr</span>&nbsp;<span class="ident" id="3160466">dnsRR</span><span class="op" id="3160471">,</span>&nbsp;<span class="ident" id="3160473">msg</span>&nbsp;<span class="op" id="3160477">[</span><span class="op" id="3160478">]</span><span class="builtintype" id="3160479">byte</span><span class="op" id="3160483">,</span>&nbsp;<span class="ident" id="3160485">off</span>&nbsp;<span class="builtintype" id="3160489">int</span><span class="op" id="3160492">)</span>&nbsp;<span class="op" id="3160494">(</span><span class="ident" id="3160495">off2</span>&nbsp;<span class="builtintype" id="3160500">int</span><span class="op" id="3160503">,</span>&nbsp;<span class="ident" id="3160505">ok</span>&nbsp;<span class="builtintype" id="3160508">bool</span><span class="op" id="3160512">)</span>&nbsp;<span class="op" id="3160514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160517">var</span>&nbsp;<span class="ident" id="3160521">off1</span>&nbsp;<span class="builtintype" id="3160526">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160531">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160574">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160611">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160667">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160693">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160715">off1</span><span class="op" id="3160719">,</span>&nbsp;<span class="ident" id="3160721">ok</span>&nbsp;<span class="op" id="3160724">=</span>&nbsp;<span class="ident" id="3160726">packStruct</span><span class="op" id="3160736">(</span><span class="ident" id="3160737">rr</span><span class="op" id="3160739">.</span><span class="ident" id="3160740">Header</span><span class="op" id="3160746">(</span><span class="op" id="3160747">)</span><span class="op" id="3160748">,</span>&nbsp;<span class="ident" id="3160750">msg</span><span class="op" id="3160753">,</span>&nbsp;<span class="ident" id="3160755">off</span><span class="op" id="3160758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160761">off2</span><span class="op" id="3160765">,</span>&nbsp;<span class="ident" id="3160767">ok</span>&nbsp;<span class="op" id="3160770">=</span>&nbsp;<span class="ident" id="3160772">packStruct</span><span class="op" id="3160782">(</span><span class="ident" id="3160783">rr</span><span class="op" id="3160785">,</span>&nbsp;<span class="ident" id="3160787">msg</span><span class="op" id="3160790">,</span>&nbsp;<span class="ident" id="3160792">off</span><span class="op" id="3160795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160798">if</span>&nbsp;<span class="op" id="3160801">!</span><span class="ident" id="3160802">ok</span>&nbsp;<span class="op" id="3160805">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160809">return</span>&nbsp;<span class="builtinfunc" id="3160816">len</span><span class="op" id="3160819">(</span><span class="ident" id="3160820">msg</span><span class="op" id="3160823">)</span><span class="op" id="3160824">,</span>&nbsp;<span class="builtintype" id="3160826">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3160833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3160836">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160896">rr</span><span class="op" id="3160898">.</span><span class="ident" id="3160899">Header</span><span class="op" id="3160905">(</span><span class="op" id="3160906">)</span><span class="op" id="3160907">.</span><span class="ident" id="3160908">Rdlength</span>&nbsp;<span class="op" id="3160917">=</span>&nbsp;<span class="builtintype" id="3160919">uint16</span><span class="op" id="3160925">(</span><span class="ident" id="3160926">off2</span>&nbsp;<span class="op" id="3160931">-</span>&nbsp;<span class="ident" id="3160933">off1</span><span class="op" id="3160937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3160940">packStruct</span><span class="op" id="3160950">(</span><span class="ident" id="3160951">rr</span><span class="op" id="3160953">.</span><span class="ident" id="3160954">Header</span><span class="op" id="3160960">(</span><span class="op" id="3160961">)</span><span class="op" id="3160962">,</span>&nbsp;<span class="ident" id="3160964">msg</span><span class="op" id="3160967">,</span>&nbsp;<span class="ident" id="3160969">off</span><span class="op" id="3160972">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3160975">return</span>&nbsp;<span class="ident" id="3160982">off2</span><span class="op" id="3160986">,</span>&nbsp;<span class="builtintype" id="3160988">true</span><br>
<span class="lineno"></span><span class="op" id="3160993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3160996">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3161025">func</span>&nbsp;<span class="ident" id="3161030">unpackRR</span><span class="op" id="3161038">(</span><span class="ident" id="3161039">msg</span>&nbsp;<span class="op" id="3161043">[</span><span class="op" id="3161044">]</span><span class="builtintype" id="3161045">byte</span><span class="op" id="3161049">,</span>&nbsp;<span class="ident" id="3161051">off</span>&nbsp;<span class="builtintype" id="3161055">int</span><span class="op" id="3161058">)</span>&nbsp;<span class="op" id="3161060">(</span><span class="ident" id="3161061">rr</span>&nbsp;<span class="ident" id="3161064">dnsRR</span><span class="op" id="3161069">,</span>&nbsp;<span class="ident" id="3161071">off1</span>&nbsp;<span class="builtintype" id="3161076">int</span><span class="op" id="3161079">,</span>&nbsp;<span class="ident" id="3161081">ok</span>&nbsp;<span class="builtintype" id="3161084">bool</span><span class="op" id="3161088">)</span>&nbsp;<span class="op" id="3161090">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3161093">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161152">var</span>&nbsp;<span class="ident" id="3161156">h</span>&nbsp;<span class="ident" id="3161158">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161172">off0</span>&nbsp;<span class="op" id="3161177">:=</span>&nbsp;<span class="ident" id="3161180">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161185">if</span>&nbsp;<span class="ident" id="3161188">off</span><span class="op" id="3161191">,</span>&nbsp;<span class="ident" id="3161193">ok</span>&nbsp;<span class="op" id="3161196">=</span>&nbsp;<span class="ident" id="3161198">unpackStruct</span><span class="op" id="3161210">(</span><span class="op" id="3161211">&amp;</span><span class="ident" id="3161212">h</span><span class="op" id="3161213">,</span>&nbsp;<span class="ident" id="3161215">msg</span><span class="op" id="3161218">,</span>&nbsp;<span class="ident" id="3161220">off</span><span class="op" id="3161223">)</span><span class="op" id="3161224">;</span>&nbsp;<span class="op" id="3161226">!</span><span class="ident" id="3161227">ok</span>&nbsp;<span class="op" id="3161230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161234">return</span>&nbsp;<span class="ident" id="3161241">nil</span><span class="op" id="3161244">,</span>&nbsp;<span class="builtinfunc" id="3161246">len</span><span class="op" id="3161249">(</span><span class="ident" id="3161250">msg</span><span class="op" id="3161253">)</span><span class="op" id="3161254">,</span>&nbsp;<span class="builtintype" id="3161256">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3161263">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161266">end</span>&nbsp;<span class="op" id="3161270">:=</span>&nbsp;<span class="ident" id="3161273">off</span>&nbsp;<span class="op" id="3161277">+</span>&nbsp;<span class="builtintype" id="3161279">int</span><span class="op" id="3161282">(</span><span class="ident" id="3161283">h</span><span class="op" id="3161284">.</span><span class="ident" id="3161285">Rdlength</span><span class="op" id="3161293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3161297">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3161340">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161391">mk</span><span class="op" id="3161393">,</span>&nbsp;<span class="ident" id="3161395">known</span>&nbsp;<span class="op" id="3161401">:=</span>&nbsp;<span class="ident" id="3161404">rr_mk</span><span class="op" id="3161409">[</span><span class="builtintype" id="3161410">int</span><span class="op" id="3161413">(</span><span class="ident" id="3161414">h</span><span class="op" id="3161415">.</span><span class="ident" id="3161416">Rrtype</span><span class="op" id="3161422">)</span><span class="op" id="3161423">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161426">if</span>&nbsp;<span class="op" id="3161429">!</span><span class="ident" id="3161430">known</span>&nbsp;<span class="op" id="3161436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161440">return</span>&nbsp;<span class="op" id="3161447">&amp;</span><span class="ident" id="3161448">h</span><span class="op" id="3161449">,</span>&nbsp;<span class="ident" id="3161451">end</span><span class="op" id="3161454">,</span>&nbsp;<span class="builtintype" id="3161456">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3161462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161465">rr</span>&nbsp;<span class="op" id="3161468">=</span>&nbsp;<span class="ident" id="3161470">mk</span><span class="op" id="3161472">(</span><span class="op" id="3161473">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161476">off</span><span class="op" id="3161479">,</span>&nbsp;<span class="ident" id="3161481">ok</span>&nbsp;<span class="op" id="3161484">=</span>&nbsp;<span class="ident" id="3161486">unpackStruct</span><span class="op" id="3161498">(</span><span class="ident" id="3161499">rr</span><span class="op" id="3161501">,</span>&nbsp;<span class="ident" id="3161503">msg</span><span class="op" id="3161506">,</span>&nbsp;<span class="ident" id="3161508">off0</span><span class="op" id="3161512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161515">if</span>&nbsp;<span class="ident" id="3161518">off</span>&nbsp;<span class="op" id="3161522">!=</span>&nbsp;<span class="ident" id="3161525">end</span>&nbsp;<span class="op" id="3161529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161533">return</span>&nbsp;<span class="op" id="3161540">&amp;</span><span class="ident" id="3161541">h</span><span class="op" id="3161542">,</span>&nbsp;<span class="ident" id="3161544">end</span><span class="op" id="3161547">,</span>&nbsp;<span class="builtintype" id="3161549">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3161555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3161558">return</span>&nbsp;<span class="ident" id="3161565">rr</span><span class="op" id="3161567">,</span>&nbsp;<span class="ident" id="3161569">off</span><span class="op" id="3161572">,</span>&nbsp;<span class="ident" id="3161574">ok</span><br>
<span class="lineno">710</span><span class="op" id="3161577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3161580">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3161623">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3161669">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3161717">type</span>&nbsp;<span class="ident" id="3161722">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3161732">struct</span>&nbsp;<span class="op" id="3161739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161742">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161762">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161770">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161790">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161796">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161816">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161821">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161841">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161847">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161867">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161873">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161893">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161899">recursion_available</span>&nbsp;<span class="builtintype" id="3161919">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3161925">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3161945">int</span><br>
<span class="lineno">725</span><span class="op" id="3161949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3161952">func</span>&nbsp;<span class="op" id="3161957">(</span><span class="ident" id="3161958">h</span>&nbsp;<span class="op" id="3161960">*</span><span class="ident" id="3161961">dnsMsgHdr</span><span class="op" id="3161970">)</span>&nbsp;<span class="ident" id="3161972">Walk</span><span class="op" id="3161976">(</span><span class="ident" id="3161977">f</span>&nbsp;<span class="keyword" id="3161979">func</span><span class="op" id="3161983">(</span><span class="ident" id="3161984">v</span>&nbsp;<span class="keyword" id="3161986">interface</span><span class="op" id="3161995">{</span><span class="op" id="3161996">}</span><span class="op" id="3161997">,</span>&nbsp;<span class="ident" id="3161999">name</span><span class="op" id="3162003">,</span>&nbsp;<span class="ident" id="3162005">tag</span>&nbsp;<span class="builtintype" id="3162009">string</span><span class="op" id="3162015">)</span>&nbsp;<span class="builtintype" id="3162017">bool</span><span class="op" id="3162021">)</span>&nbsp;<span class="builtintype" id="3162023">bool</span>&nbsp;<span class="op" id="3162028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162031">return</span>&nbsp;<span class="ident" id="3162038">f</span><span class="op" id="3162039">(</span><span class="op" id="3162040">&amp;</span><span class="ident" id="3162041">h</span><span class="op" id="3162042">.</span><span class="ident" id="3162043">id</span><span class="op" id="3162045">,</span>&nbsp;<span class="string" id="3162047">&#34;id&#34;</span><span class="op" id="3162051">,</span>&nbsp;<span class="string" id="3162053">&#34;&#34;</span><span class="op" id="3162055">)</span>&nbsp;<span class="op" id="3162057">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162062">f</span><span class="op" id="3162063">(</span><span class="op" id="3162064">&amp;</span><span class="ident" id="3162065">h</span><span class="op" id="3162066">.</span><span class="ident" id="3162067">response</span><span class="op" id="3162075">,</span>&nbsp;<span class="string" id="3162077">&#34;response&#34;</span><span class="op" id="3162087">,</span>&nbsp;<span class="string" id="3162089">&#34;&#34;</span><span class="op" id="3162091">)</span>&nbsp;<span class="op" id="3162093">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162098">f</span><span class="op" id="3162099">(</span><span class="op" id="3162100">&amp;</span><span class="ident" id="3162101">h</span><span class="op" id="3162102">.</span><span class="ident" id="3162103">opcode</span><span class="op" id="3162109">,</span>&nbsp;<span class="string" id="3162111">&#34;opcode&#34;</span><span class="op" id="3162119">,</span>&nbsp;<span class="string" id="3162121">&#34;&#34;</span><span class="op" id="3162123">)</span>&nbsp;<span class="op" id="3162125">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162130">f</span><span class="op" id="3162131">(</span><span class="op" id="3162132">&amp;</span><span class="ident" id="3162133">h</span><span class="op" id="3162134">.</span><span class="ident" id="3162135">authoritative</span><span class="op" id="3162148">,</span>&nbsp;<span class="string" id="3162150">&#34;authoritative&#34;</span><span class="op" id="3162165">,</span>&nbsp;<span class="string" id="3162167">&#34;&#34;</span><span class="op" id="3162169">)</span>&nbsp;<span class="op" id="3162171">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162176">f</span><span class="op" id="3162177">(</span><span class="op" id="3162178">&amp;</span><span class="ident" id="3162179">h</span><span class="op" id="3162180">.</span><span class="ident" id="3162181">truncated</span><span class="op" id="3162190">,</span>&nbsp;<span class="string" id="3162192">&#34;truncated&#34;</span><span class="op" id="3162203">,</span>&nbsp;<span class="string" id="3162205">&#34;&#34;</span><span class="op" id="3162207">)</span>&nbsp;<span class="op" id="3162209">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162214">f</span><span class="op" id="3162215">(</span><span class="op" id="3162216">&amp;</span><span class="ident" id="3162217">h</span><span class="op" id="3162218">.</span><span class="ident" id="3162219">recursion_desired</span><span class="op" id="3162236">,</span>&nbsp;<span class="string" id="3162238">&#34;recursion_desired&#34;</span><span class="op" id="3162257">,</span>&nbsp;<span class="string" id="3162259">&#34;&#34;</span><span class="op" id="3162261">)</span>&nbsp;<span class="op" id="3162263">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162268">f</span><span class="op" id="3162269">(</span><span class="op" id="3162270">&amp;</span><span class="ident" id="3162271">h</span><span class="op" id="3162272">.</span><span class="ident" id="3162273">recursion_available</span><span class="op" id="3162292">,</span>&nbsp;<span class="string" id="3162294">&#34;recursion_available&#34;</span><span class="op" id="3162315">,</span>&nbsp;<span class="string" id="3162317">&#34;&#34;</span><span class="op" id="3162319">)</span>&nbsp;<span class="op" id="3162321">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162326">f</span><span class="op" id="3162327">(</span><span class="op" id="3162328">&amp;</span><span class="ident" id="3162329">h</span><span class="op" id="3162330">.</span><span class="ident" id="3162331">rcode</span><span class="op" id="3162336">,</span>&nbsp;<span class="string" id="3162338">&#34;rcode&#34;</span><span class="op" id="3162345">,</span>&nbsp;<span class="string" id="3162347">&#34;&#34;</span><span class="op" id="3162349">)</span><br>
<span class="lineno"></span><span class="op" id="3162351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3162354">type</span>&nbsp;<span class="ident" id="3162359">dnsMsg</span>&nbsp;<span class="keyword" id="3162366">struct</span>&nbsp;<span class="op" id="3162373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162376">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162387">question</span>&nbsp;<span class="op" id="3162396">[</span><span class="op" id="3162397">]</span><span class="ident" id="3162398">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162411">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3162420">[</span><span class="op" id="3162421">]</span><span class="ident" id="3162422">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162429">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162438">[</span><span class="op" id="3162439">]</span><span class="ident" id="3162440">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162447">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3162456">[</span><span class="op" id="3162457">]</span><span class="ident" id="3162458">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3162464">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3162467">func</span>&nbsp;<span class="op" id="3162472">(</span><span class="ident" id="3162473">dns</span>&nbsp;<span class="op" id="3162477">*</span><span class="ident" id="3162478">dnsMsg</span><span class="op" id="3162484">)</span>&nbsp;<span class="ident" id="3162486">Pack</span><span class="op" id="3162490">(</span><span class="op" id="3162491">)</span>&nbsp;<span class="op" id="3162493">(</span><span class="ident" id="3162494">msg</span>&nbsp;<span class="op" id="3162498">[</span><span class="op" id="3162499">]</span><span class="builtintype" id="3162500">byte</span><span class="op" id="3162504">,</span>&nbsp;<span class="ident" id="3162506">ok</span>&nbsp;<span class="builtintype" id="3162509">bool</span><span class="op" id="3162513">)</span>&nbsp;<span class="op" id="3162515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162518">var</span>&nbsp;<span class="ident" id="3162522">dh</span>&nbsp;<span class="ident" id="3162525">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3162537">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162593">dh</span><span class="op" id="3162595">.</span><span class="ident" id="3162596">Id</span>&nbsp;<span class="op" id="3162599">=</span>&nbsp;<span class="ident" id="3162601">dns</span><span class="op" id="3162604">.</span><span class="ident" id="3162605">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162609">dh</span><span class="op" id="3162611">.</span><span class="ident" id="3162612">Bits</span>&nbsp;<span class="op" id="3162617">=</span>&nbsp;<span class="builtintype" id="3162619">uint16</span><span class="op" id="3162625">(</span><span class="ident" id="3162626">dns</span><span class="op" id="3162629">.</span><span class="ident" id="3162630">opcode</span><span class="op" id="3162636">)</span><span class="op" id="3162637">&lt;&lt;</span><span class="num" id="3162639">11</span>&nbsp;<span class="op" id="3162642">|</span>&nbsp;<span class="builtintype" id="3162644">uint16</span><span class="op" id="3162650">(</span><span class="ident" id="3162651">dns</span><span class="op" id="3162654">.</span><span class="ident" id="3162655">rcode</span><span class="op" id="3162660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162663">if</span>&nbsp;<span class="ident" id="3162666">dns</span><span class="op" id="3162669">.</span><span class="ident" id="3162670">recursion_available</span>&nbsp;<span class="op" id="3162690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162694">dh</span><span class="op" id="3162696">.</span><span class="ident" id="3162697">Bits</span>&nbsp;<span class="op" id="3162702">|=</span>&nbsp;<span class="ident" id="3162705">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162710">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162713">if</span>&nbsp;<span class="ident" id="3162716">dns</span><span class="op" id="3162719">.</span><span class="ident" id="3162720">recursion_desired</span>&nbsp;<span class="op" id="3162738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162742">dh</span><span class="op" id="3162744">.</span><span class="ident" id="3162745">Bits</span>&nbsp;<span class="op" id="3162750">|=</span>&nbsp;<span class="ident" id="3162753">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162761">if</span>&nbsp;<span class="ident" id="3162764">dns</span><span class="op" id="3162767">.</span><span class="ident" id="3162768">truncated</span>&nbsp;<span class="op" id="3162778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162782">dh</span><span class="op" id="3162784">.</span><span class="ident" id="3162785">Bits</span>&nbsp;<span class="op" id="3162790">|=</span>&nbsp;<span class="ident" id="3162793">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162801">if</span>&nbsp;<span class="ident" id="3162804">dns</span><span class="op" id="3162807">.</span><span class="ident" id="3162808">authoritative</span>&nbsp;<span class="op" id="3162822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162826">dh</span><span class="op" id="3162828">.</span><span class="ident" id="3162829">Bits</span>&nbsp;<span class="op" id="3162834">|=</span>&nbsp;<span class="ident" id="3162837">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3162845">if</span>&nbsp;<span class="ident" id="3162848">dns</span><span class="op" id="3162851">.</span><span class="ident" id="3162852">response</span>&nbsp;<span class="op" id="3162861">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162865">dh</span><span class="op" id="3162867">.</span><span class="ident" id="3162868">Bits</span>&nbsp;<span class="op" id="3162873">|=</span>&nbsp;<span class="ident" id="3162876">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3162881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3162885">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162920">question</span>&nbsp;<span class="op" id="3162929">:=</span>&nbsp;<span class="ident" id="3162932">dns</span><span class="op" id="3162935">.</span><span class="ident" id="3162936">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162946">answer</span>&nbsp;<span class="op" id="3162953">:=</span>&nbsp;<span class="ident" id="3162956">dns</span><span class="op" id="3162959">.</span><span class="ident" id="3162960">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162968">ns</span>&nbsp;<span class="op" id="3162971">:=</span>&nbsp;<span class="ident" id="3162974">dns</span><span class="op" id="3162977">.</span><span class="ident" id="3162978">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3162982">extra</span>&nbsp;<span class="op" id="3162988">:=</span>&nbsp;<span class="ident" id="3162991">dns</span><span class="op" id="3162994">.</span><span class="ident" id="3162995">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163003">dh</span><span class="op" id="3163005">.</span><span class="ident" id="3163006">Qdcount</span>&nbsp;<span class="op" id="3163014">=</span>&nbsp;<span class="builtintype" id="3163016">uint16</span><span class="op" id="3163022">(</span><span class="builtinfunc" id="3163023">len</span><span class="op" id="3163026">(</span><span class="ident" id="3163027">question</span><span class="op" id="3163035">)</span><span class="op" id="3163036">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163039">dh</span><span class="op" id="3163041">.</span><span class="ident" id="3163042">Ancount</span>&nbsp;<span class="op" id="3163050">=</span>&nbsp;<span class="builtintype" id="3163052">uint16</span><span class="op" id="3163058">(</span><span class="builtinfunc" id="3163059">len</span><span class="op" id="3163062">(</span><span class="ident" id="3163063">answer</span><span class="op" id="3163069">)</span><span class="op" id="3163070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163073">dh</span><span class="op" id="3163075">.</span><span class="ident" id="3163076">Nscount</span>&nbsp;<span class="op" id="3163084">=</span>&nbsp;<span class="builtintype" id="3163086">uint16</span><span class="op" id="3163092">(</span><span class="builtinfunc" id="3163093">len</span><span class="op" id="3163096">(</span><span class="ident" id="3163097">ns</span><span class="op" id="3163099">)</span><span class="op" id="3163100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163103">dh</span><span class="op" id="3163105">.</span><span class="ident" id="3163106">Arcount</span>&nbsp;<span class="op" id="3163114">=</span>&nbsp;<span class="builtintype" id="3163116">uint16</span><span class="op" id="3163122">(</span><span class="builtinfunc" id="3163123">len</span><span class="op" id="3163126">(</span><span class="ident" id="3163127">extra</span><span class="op" id="3163132">)</span><span class="op" id="3163133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163137">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163186">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163232">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163270">msg</span>&nbsp;<span class="op" id="3163274">=</span>&nbsp;<span class="builtinfunc" id="3163276">make</span><span class="op" id="3163280">(</span><span class="op" id="3163281">[</span><span class="op" id="3163282">]</span><span class="builtintype" id="3163283">byte</span><span class="op" id="3163287">,</span>&nbsp;<span class="num" id="3163289">2000</span><span class="op" id="3163293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163297">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163341">off</span>&nbsp;<span class="op" id="3163345">:=</span>&nbsp;<span class="num" id="3163348">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163351">off</span><span class="op" id="3163354">,</span>&nbsp;<span class="ident" id="3163356">ok</span>&nbsp;<span class="op" id="3163359">=</span>&nbsp;<span class="ident" id="3163361">packStruct</span><span class="op" id="3163371">(</span><span class="op" id="3163372">&amp;</span><span class="ident" id="3163373">dh</span><span class="op" id="3163375">,</span>&nbsp;<span class="ident" id="3163377">msg</span><span class="op" id="3163380">,</span>&nbsp;<span class="ident" id="3163382">off</span><span class="op" id="3163385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163388">for</span>&nbsp;<span class="ident" id="3163392">i</span>&nbsp;<span class="op" id="3163394">:=</span>&nbsp;<span class="num" id="3163397">0</span><span class="op" id="3163398">;</span>&nbsp;<span class="ident" id="3163400">i</span>&nbsp;<span class="op" id="3163402">&lt;</span>&nbsp;<span class="builtinfunc" id="3163404">len</span><span class="op" id="3163407">(</span><span class="ident" id="3163408">question</span><span class="op" id="3163416">)</span><span class="op" id="3163417">;</span>&nbsp;<span class="ident" id="3163419">i</span><span class="op" id="3163420">++</span>&nbsp;<span class="op" id="3163423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163427">off</span><span class="op" id="3163430">,</span>&nbsp;<span class="ident" id="3163432">ok</span>&nbsp;<span class="op" id="3163435">=</span>&nbsp;<span class="ident" id="3163437">packStruct</span><span class="op" id="3163447">(</span><span class="op" id="3163448">&amp;</span><span class="ident" id="3163449">question</span><span class="op" id="3163457">[</span><span class="ident" id="3163458">i</span><span class="op" id="3163459">]</span><span class="op" id="3163460">,</span>&nbsp;<span class="ident" id="3163462">msg</span><span class="op" id="3163465">,</span>&nbsp;<span class="ident" id="3163467">off</span><span class="op" id="3163470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163473">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163476">for</span>&nbsp;<span class="ident" id="3163480">i</span>&nbsp;<span class="op" id="3163482">:=</span>&nbsp;<span class="num" id="3163485">0</span><span class="op" id="3163486">;</span>&nbsp;<span class="ident" id="3163488">i</span>&nbsp;<span class="op" id="3163490">&lt;</span>&nbsp;<span class="builtinfunc" id="3163492">len</span><span class="op" id="3163495">(</span><span class="ident" id="3163496">answer</span><span class="op" id="3163502">)</span><span class="op" id="3163503">;</span>&nbsp;<span class="ident" id="3163505">i</span><span class="op" id="3163506">++</span>&nbsp;<span class="op" id="3163509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163513">off</span><span class="op" id="3163516">,</span>&nbsp;<span class="ident" id="3163518">ok</span>&nbsp;<span class="op" id="3163521">=</span>&nbsp;<span class="ident" id="3163523">packRR</span><span class="op" id="3163529">(</span><span class="ident" id="3163530">answer</span><span class="op" id="3163536">[</span><span class="ident" id="3163537">i</span><span class="op" id="3163538">]</span><span class="op" id="3163539">,</span>&nbsp;<span class="ident" id="3163541">msg</span><span class="op" id="3163544">,</span>&nbsp;<span class="ident" id="3163546">off</span><span class="op" id="3163549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163555">for</span>&nbsp;<span class="ident" id="3163559">i</span>&nbsp;<span class="op" id="3163561">:=</span>&nbsp;<span class="num" id="3163564">0</span><span class="op" id="3163565">;</span>&nbsp;<span class="ident" id="3163567">i</span>&nbsp;<span class="op" id="3163569">&lt;</span>&nbsp;<span class="builtinfunc" id="3163571">len</span><span class="op" id="3163574">(</span><span class="ident" id="3163575">ns</span><span class="op" id="3163577">)</span><span class="op" id="3163578">;</span>&nbsp;<span class="ident" id="3163580">i</span><span class="op" id="3163581">++</span>&nbsp;<span class="op" id="3163584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163588">off</span><span class="op" id="3163591">,</span>&nbsp;<span class="ident" id="3163593">ok</span>&nbsp;<span class="op" id="3163596">=</span>&nbsp;<span class="ident" id="3163598">packRR</span><span class="op" id="3163604">(</span><span class="ident" id="3163605">ns</span><span class="op" id="3163607">[</span><span class="ident" id="3163608">i</span><span class="op" id="3163609">]</span><span class="op" id="3163610">,</span>&nbsp;<span class="ident" id="3163612">msg</span><span class="op" id="3163615">,</span>&nbsp;<span class="ident" id="3163617">off</span><span class="op" id="3163620">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163626">for</span>&nbsp;<span class="ident" id="3163630">i</span>&nbsp;<span class="op" id="3163632">:=</span>&nbsp;<span class="num" id="3163635">0</span><span class="op" id="3163636">;</span>&nbsp;<span class="ident" id="3163638">i</span>&nbsp;<span class="op" id="3163640">&lt;</span>&nbsp;<span class="builtinfunc" id="3163642">len</span><span class="op" id="3163645">(</span><span class="ident" id="3163646">extra</span><span class="op" id="3163651">)</span><span class="op" id="3163652">;</span>&nbsp;<span class="ident" id="3163654">i</span><span class="op" id="3163655">++</span>&nbsp;<span class="op" id="3163658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163662">off</span><span class="op" id="3163665">,</span>&nbsp;<span class="ident" id="3163667">ok</span>&nbsp;<span class="op" id="3163670">=</span>&nbsp;<span class="ident" id="3163672">packRR</span><span class="op" id="3163678">(</span><span class="ident" id="3163679">extra</span><span class="op" id="3163684">[</span><span class="ident" id="3163685">i</span><span class="op" id="3163686">]</span><span class="op" id="3163687">,</span>&nbsp;<span class="ident" id="3163689">msg</span><span class="op" id="3163692">,</span>&nbsp;<span class="ident" id="3163694">off</span><span class="op" id="3163697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163703">if</span>&nbsp;<span class="op" id="3163706">!</span><span class="ident" id="3163707">ok</span>&nbsp;<span class="op" id="3163710">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163714">return</span>&nbsp;<span class="ident" id="3163721">nil</span><span class="op" id="3163724">,</span>&nbsp;<span class="builtintype" id="3163726">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163736">return</span>&nbsp;<span class="ident" id="3163743">msg</span><span class="op" id="3163746">[</span><span class="num" id="3163747">0</span><span class="op" id="3163748">:</span><span class="ident" id="3163749">off</span><span class="op" id="3163752">]</span><span class="op" id="3163753">,</span>&nbsp;<span class="builtintype" id="3163755">true</span><br>
<span class="lineno"></span><span class="op" id="3163760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3163763">func</span>&nbsp;<span class="op" id="3163768">(</span><span class="ident" id="3163769">dns</span>&nbsp;<span class="op" id="3163773">*</span><span class="ident" id="3163774">dnsMsg</span><span class="op" id="3163780">)</span>&nbsp;<span class="ident" id="3163782">Unpack</span><span class="op" id="3163788">(</span><span class="ident" id="3163789">msg</span>&nbsp;<span class="op" id="3163793">[</span><span class="op" id="3163794">]</span><span class="builtintype" id="3163795">byte</span><span class="op" id="3163799">)</span>&nbsp;<span class="builtintype" id="3163801">bool</span>&nbsp;<span class="op" id="3163806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3163809">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163821">var</span>&nbsp;<span class="ident" id="3163825">dh</span>&nbsp;<span class="ident" id="3163828">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163839">off</span>&nbsp;<span class="op" id="3163843">:=</span>&nbsp;<span class="num" id="3163846">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163849">var</span>&nbsp;<span class="ident" id="3163853">ok</span>&nbsp;<span class="builtintype" id="3163856">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163862">if</span>&nbsp;<span class="ident" id="3163865">off</span><span class="op" id="3163868">,</span>&nbsp;<span class="ident" id="3163870">ok</span>&nbsp;<span class="op" id="3163873">=</span>&nbsp;<span class="ident" id="3163875">unpackStruct</span><span class="op" id="3163887">(</span><span class="op" id="3163888">&amp;</span><span class="ident" id="3163889">dh</span><span class="op" id="3163891">,</span>&nbsp;<span class="ident" id="3163893">msg</span><span class="op" id="3163896">,</span>&nbsp;<span class="ident" id="3163898">off</span><span class="op" id="3163901">)</span><span class="op" id="3163902">;</span>&nbsp;<span class="op" id="3163904">!</span><span class="ident" id="3163905">ok</span>&nbsp;<span class="op" id="3163908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3163912">return</span>&nbsp;<span class="builtintype" id="3163919">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3163926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163929">dns</span><span class="op" id="3163932">.</span><span class="ident" id="3163933">id</span>&nbsp;<span class="op" id="3163936">=</span>&nbsp;<span class="ident" id="3163938">dh</span><span class="op" id="3163940">.</span><span class="ident" id="3163941">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163945">dns</span><span class="op" id="3163948">.</span><span class="ident" id="3163949">response</span>&nbsp;<span class="op" id="3163958">=</span>&nbsp;<span class="op" id="3163960">(</span><span class="ident" id="3163961">dh</span><span class="op" id="3163963">.</span><span class="ident" id="3163964">Bits</span>&nbsp;<span class="op" id="3163969">&amp;</span>&nbsp;<span class="ident" id="3163971">_QR</span><span class="op" id="3163974">)</span>&nbsp;<span class="op" id="3163976">!=</span>&nbsp;<span class="num" id="3163979">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3163982">dns</span><span class="op" id="3163985">.</span><span class="ident" id="3163986">opcode</span>&nbsp;<span class="op" id="3163993">=</span>&nbsp;<span class="builtintype" id="3163995">int</span><span class="op" id="3163998">(</span><span class="ident" id="3163999">dh</span><span class="op" id="3164001">.</span><span class="ident" id="3164002">Bits</span><span class="op" id="3164006">&gt;&gt;</span><span class="num" id="3164008">11</span><span class="op" id="3164010">)</span>&nbsp;<span class="op" id="3164012">&amp;</span>&nbsp;<span class="num" id="3164014">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164019">dns</span><span class="op" id="3164022">.</span><span class="ident" id="3164023">authoritative</span>&nbsp;<span class="op" id="3164037">=</span>&nbsp;<span class="op" id="3164039">(</span><span class="ident" id="3164040">dh</span><span class="op" id="3164042">.</span><span class="ident" id="3164043">Bits</span>&nbsp;<span class="op" id="3164048">&amp;</span>&nbsp;<span class="ident" id="3164050">_AA</span><span class="op" id="3164053">)</span>&nbsp;<span class="op" id="3164055">!=</span>&nbsp;<span class="num" id="3164058">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164061">dns</span><span class="op" id="3164064">.</span><span class="ident" id="3164065">truncated</span>&nbsp;<span class="op" id="3164075">=</span>&nbsp;<span class="op" id="3164077">(</span><span class="ident" id="3164078">dh</span><span class="op" id="3164080">.</span><span class="ident" id="3164081">Bits</span>&nbsp;<span class="op" id="3164086">&amp;</span>&nbsp;<span class="ident" id="3164088">_TC</span><span class="op" id="3164091">)</span>&nbsp;<span class="op" id="3164093">!=</span>&nbsp;<span class="num" id="3164096">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164099">dns</span><span class="op" id="3164102">.</span><span class="ident" id="3164103">recursion_desired</span>&nbsp;<span class="op" id="3164121">=</span>&nbsp;<span class="op" id="3164123">(</span><span class="ident" id="3164124">dh</span><span class="op" id="3164126">.</span><span class="ident" id="3164127">Bits</span>&nbsp;<span class="op" id="3164132">&amp;</span>&nbsp;<span class="ident" id="3164134">_RD</span><span class="op" id="3164137">)</span>&nbsp;<span class="op" id="3164139">!=</span>&nbsp;<span class="num" id="3164142">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164145">dns</span><span class="op" id="3164148">.</span><span class="ident" id="3164149">recursion_available</span>&nbsp;<span class="op" id="3164169">=</span>&nbsp;<span class="op" id="3164171">(</span><span class="ident" id="3164172">dh</span><span class="op" id="3164174">.</span><span class="ident" id="3164175">Bits</span>&nbsp;<span class="op" id="3164180">&amp;</span>&nbsp;<span class="ident" id="3164182">_RA</span><span class="op" id="3164185">)</span>&nbsp;<span class="op" id="3164187">!=</span>&nbsp;<span class="num" id="3164190">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164193">dns</span><span class="op" id="3164196">.</span><span class="ident" id="3164197">rcode</span>&nbsp;<span class="op" id="3164203">=</span>&nbsp;<span class="builtintype" id="3164205">int</span><span class="op" id="3164208">(</span><span class="ident" id="3164209">dh</span><span class="op" id="3164211">.</span><span class="ident" id="3164212">Bits</span>&nbsp;<span class="op" id="3164217">&amp;</span>&nbsp;<span class="num" id="3164219">0xF</span><span class="op" id="3164222">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3164226">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164238">dns</span><span class="op" id="3164241">.</span><span class="ident" id="3164242">question</span>&nbsp;<span class="op" id="3164251">=</span>&nbsp;<span class="builtinfunc" id="3164253">make</span><span class="op" id="3164257">(</span><span class="op" id="3164258">[</span><span class="op" id="3164259">]</span><span class="ident" id="3164260">dnsQuestion</span><span class="op" id="3164271">,</span>&nbsp;<span class="ident" id="3164273">dh</span><span class="op" id="3164275">.</span><span class="ident" id="3164276">Qdcount</span><span class="op" id="3164283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164286">dns</span><span class="op" id="3164289">.</span><span class="ident" id="3164290">answer</span>&nbsp;<span class="op" id="3164297">=</span>&nbsp;<span class="builtinfunc" id="3164299">make</span><span class="op" id="3164303">(</span><span class="op" id="3164304">[</span><span class="op" id="3164305">]</span><span class="ident" id="3164306">dnsRR</span><span class="op" id="3164311">,</span>&nbsp;<span class="num" id="3164313">0</span><span class="op" id="3164314">,</span>&nbsp;<span class="ident" id="3164316">dh</span><span class="op" id="3164318">.</span><span class="ident" id="3164319">Ancount</span><span class="op" id="3164326">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164329">dns</span><span class="op" id="3164332">.</span><span class="ident" id="3164333">ns</span>&nbsp;<span class="op" id="3164336">=</span>&nbsp;<span class="builtinfunc" id="3164338">make</span><span class="op" id="3164342">(</span><span class="op" id="3164343">[</span><span class="op" id="3164344">]</span><span class="ident" id="3164345">dnsRR</span><span class="op" id="3164350">,</span>&nbsp;<span class="num" id="3164352">0</span><span class="op" id="3164353">,</span>&nbsp;<span class="ident" id="3164355">dh</span><span class="op" id="3164357">.</span><span class="ident" id="3164358">Nscount</span><span class="op" id="3164365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164368">dns</span><span class="op" id="3164371">.</span><span class="ident" id="3164372">extra</span>&nbsp;<span class="op" id="3164378">=</span>&nbsp;<span class="builtinfunc" id="3164380">make</span><span class="op" id="3164384">(</span><span class="op" id="3164385">[</span><span class="op" id="3164386">]</span><span class="ident" id="3164387">dnsRR</span><span class="op" id="3164392">,</span>&nbsp;<span class="num" id="3164394">0</span><span class="op" id="3164395">,</span>&nbsp;<span class="ident" id="3164397">dh</span><span class="op" id="3164399">.</span><span class="ident" id="3164400">Arcount</span><span class="op" id="3164407">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164411">var</span>&nbsp;<span class="ident" id="3164415">rec</span>&nbsp;<span class="ident" id="3164419">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164427">for</span>&nbsp;<span class="ident" id="3164431">i</span>&nbsp;<span class="op" id="3164433">:=</span>&nbsp;<span class="num" id="3164436">0</span><span class="op" id="3164437">;</span>&nbsp;<span class="ident" id="3164439">i</span>&nbsp;<span class="op" id="3164441">&lt;</span>&nbsp;<span class="builtinfunc" id="3164443">len</span><span class="op" id="3164446">(</span><span class="ident" id="3164447">dns</span><span class="op" id="3164450">.</span><span class="ident" id="3164451">question</span><span class="op" id="3164459">)</span><span class="op" id="3164460">;</span>&nbsp;<span class="ident" id="3164462">i</span><span class="op" id="3164463">++</span>&nbsp;<span class="op" id="3164466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164470">off</span><span class="op" id="3164473">,</span>&nbsp;<span class="ident" id="3164475">ok</span>&nbsp;<span class="op" id="3164478">=</span>&nbsp;<span class="ident" id="3164480">unpackStruct</span><span class="op" id="3164492">(</span><span class="op" id="3164493">&amp;</span><span class="ident" id="3164494">dns</span><span class="op" id="3164497">.</span><span class="ident" id="3164498">question</span><span class="op" id="3164506">[</span><span class="ident" id="3164507">i</span><span class="op" id="3164508">]</span><span class="op" id="3164509">,</span>&nbsp;<span class="ident" id="3164511">msg</span><span class="op" id="3164514">,</span>&nbsp;<span class="ident" id="3164516">off</span><span class="op" id="3164519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164525">for</span>&nbsp;<span class="ident" id="3164529">i</span>&nbsp;<span class="op" id="3164531">:=</span>&nbsp;<span class="num" id="3164534">0</span><span class="op" id="3164535">;</span>&nbsp;<span class="ident" id="3164537">i</span>&nbsp;<span class="op" id="3164539">&lt;</span>&nbsp;<span class="builtintype" id="3164541">int</span><span class="op" id="3164544">(</span><span class="ident" id="3164545">dh</span><span class="op" id="3164547">.</span><span class="ident" id="3164548">Ancount</span><span class="op" id="3164555">)</span><span class="op" id="3164556">;</span>&nbsp;<span class="ident" id="3164558">i</span><span class="op" id="3164559">++</span>&nbsp;<span class="op" id="3164562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164566">rec</span><span class="op" id="3164569">,</span>&nbsp;<span class="ident" id="3164571">off</span><span class="op" id="3164574">,</span>&nbsp;<span class="ident" id="3164576">ok</span>&nbsp;<span class="op" id="3164579">=</span>&nbsp;<span class="ident" id="3164581">unpackRR</span><span class="op" id="3164589">(</span><span class="ident" id="3164590">msg</span><span class="op" id="3164593">,</span>&nbsp;<span class="ident" id="3164595">off</span><span class="op" id="3164598">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164602">if</span>&nbsp;<span class="op" id="3164605">!</span><span class="ident" id="3164606">ok</span>&nbsp;<span class="op" id="3164609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164614">return</span>&nbsp;<span class="builtintype" id="3164621">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164633">dns</span><span class="op" id="3164636">.</span><span class="ident" id="3164637">answer</span>&nbsp;<span class="op" id="3164644">=</span>&nbsp;<span class="builtinfunc" id="3164646">append</span><span class="op" id="3164652">(</span><span class="ident" id="3164653">dns</span><span class="op" id="3164656">.</span><span class="ident" id="3164657">answer</span><span class="op" id="3164663">,</span>&nbsp;<span class="ident" id="3164665">rec</span><span class="op" id="3164668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164671">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164674">for</span>&nbsp;<span class="ident" id="3164678">i</span>&nbsp;<span class="op" id="3164680">:=</span>&nbsp;<span class="num" id="3164683">0</span><span class="op" id="3164684">;</span>&nbsp;<span class="ident" id="3164686">i</span>&nbsp;<span class="op" id="3164688">&lt;</span>&nbsp;<span class="builtintype" id="3164690">int</span><span class="op" id="3164693">(</span><span class="ident" id="3164694">dh</span><span class="op" id="3164696">.</span><span class="ident" id="3164697">Nscount</span><span class="op" id="3164704">)</span><span class="op" id="3164705">;</span>&nbsp;<span class="ident" id="3164707">i</span><span class="op" id="3164708">++</span>&nbsp;<span class="op" id="3164711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164715">rec</span><span class="op" id="3164718">,</span>&nbsp;<span class="ident" id="3164720">off</span><span class="op" id="3164723">,</span>&nbsp;<span class="ident" id="3164725">ok</span>&nbsp;<span class="op" id="3164728">=</span>&nbsp;<span class="ident" id="3164730">unpackRR</span><span class="op" id="3164738">(</span><span class="ident" id="3164739">msg</span><span class="op" id="3164742">,</span>&nbsp;<span class="ident" id="3164744">off</span><span class="op" id="3164747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164751">if</span>&nbsp;<span class="op" id="3164754">!</span><span class="ident" id="3164755">ok</span>&nbsp;<span class="op" id="3164758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164763">return</span>&nbsp;<span class="builtintype" id="3164770">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164778">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164782">dns</span><span class="op" id="3164785">.</span><span class="ident" id="3164786">ns</span>&nbsp;<span class="op" id="3164789">=</span>&nbsp;<span class="builtinfunc" id="3164791">append</span><span class="op" id="3164797">(</span><span class="ident" id="3164798">dns</span><span class="op" id="3164801">.</span><span class="ident" id="3164802">ns</span><span class="op" id="3164804">,</span>&nbsp;<span class="ident" id="3164806">rec</span><span class="op" id="3164809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164815">for</span>&nbsp;<span class="ident" id="3164819">i</span>&nbsp;<span class="op" id="3164821">:=</span>&nbsp;<span class="num" id="3164824">0</span><span class="op" id="3164825">;</span>&nbsp;<span class="ident" id="3164827">i</span>&nbsp;<span class="op" id="3164829">&lt;</span>&nbsp;<span class="builtintype" id="3164831">int</span><span class="op" id="3164834">(</span><span class="ident" id="3164835">dh</span><span class="op" id="3164837">.</span><span class="ident" id="3164838">Arcount</span><span class="op" id="3164845">)</span><span class="op" id="3164846">;</span>&nbsp;<span class="ident" id="3164848">i</span><span class="op" id="3164849">++</span>&nbsp;<span class="op" id="3164852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164856">rec</span><span class="op" id="3164859">,</span>&nbsp;<span class="ident" id="3164861">off</span><span class="op" id="3164864">,</span>&nbsp;<span class="ident" id="3164866">ok</span>&nbsp;<span class="op" id="3164869">=</span>&nbsp;<span class="ident" id="3164871">unpackRR</span><span class="op" id="3164879">(</span><span class="ident" id="3164880">msg</span><span class="op" id="3164883">,</span>&nbsp;<span class="ident" id="3164885">off</span><span class="op" id="3164888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164892">if</span>&nbsp;<span class="op" id="3164895">!</span><span class="ident" id="3164896">ok</span>&nbsp;<span class="op" id="3164899">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3164904">return</span>&nbsp;<span class="builtintype" id="3164911">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3164923">dns</span><span class="op" id="3164926">.</span><span class="ident" id="3164927">extra</span>&nbsp;<span class="op" id="3164933">=</span>&nbsp;<span class="builtinfunc" id="3164935">append</span><span class="op" id="3164941">(</span><span class="ident" id="3164942">dns</span><span class="op" id="3164945">.</span><span class="ident" id="3164946">extra</span><span class="op" id="3164951">,</span>&nbsp;<span class="ident" id="3164953">rec</span><span class="op" id="3164956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3164959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3164962">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3164987">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3165050">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165056">return</span>&nbsp;<span class="builtintype" id="3165063">true</span><br>
<span class="lineno"></span><span class="op" id="3165068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3165071">func</span>&nbsp;<span class="op" id="3165076">(</span><span class="ident" id="3165077">dns</span>&nbsp;<span class="op" id="3165081">*</span><span class="ident" id="3165082">dnsMsg</span><span class="op" id="3165088">)</span>&nbsp;<span class="ident" id="3165090">String</span><span class="op" id="3165096">(</span><span class="op" id="3165097">)</span>&nbsp;<span class="builtintype" id="3165099">string</span>&nbsp;<span class="op" id="3165106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165109">s</span>&nbsp;<span class="op" id="3165111">:=</span>&nbsp;<span class="string" id="3165114">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3165122">+</span>&nbsp;<span class="ident" id="3165124">printStruct</span><span class="op" id="3165135">(</span><span class="op" id="3165136">&amp;</span><span class="ident" id="3165137">dns</span><span class="op" id="3165140">.</span><span class="ident" id="3165141">dnsMsgHdr</span><span class="op" id="3165150">)</span>&nbsp;<span class="op" id="3165152">+</span>&nbsp;<span class="string" id="3165154">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165160">if</span>&nbsp;<span class="builtinfunc" id="3165163">len</span><span class="op" id="3165166">(</span><span class="ident" id="3165167">dns</span><span class="op" id="3165170">.</span><span class="ident" id="3165171">question</span><span class="op" id="3165179">)</span>&nbsp;<span class="op" id="3165181">&gt;</span>&nbsp;<span class="num" id="3165183">0</span>&nbsp;<span class="op" id="3165185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165189">s</span>&nbsp;<span class="op" id="3165191">+=</span>&nbsp;<span class="string" id="3165194">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165213">for</span>&nbsp;<span class="ident" id="3165217">i</span>&nbsp;<span class="op" id="3165219">:=</span>&nbsp;<span class="num" id="3165222">0</span><span class="op" id="3165223">;</span>&nbsp;<span class="ident" id="3165225">i</span>&nbsp;<span class="op" id="3165227">&lt;</span>&nbsp;<span class="builtinfunc" id="3165229">len</span><span class="op" id="3165232">(</span><span class="ident" id="3165233">dns</span><span class="op" id="3165236">.</span><span class="ident" id="3165237">question</span><span class="op" id="3165245">)</span><span class="op" id="3165246">;</span>&nbsp;<span class="ident" id="3165248">i</span><span class="op" id="3165249">++</span>&nbsp;<span class="op" id="3165252">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165257">s</span>&nbsp;<span class="op" id="3165259">+=</span>&nbsp;<span class="ident" id="3165262">printStruct</span><span class="op" id="3165273">(</span><span class="op" id="3165274">&amp;</span><span class="ident" id="3165275">dns</span><span class="op" id="3165278">.</span><span class="ident" id="3165279">question</span><span class="op" id="3165287">[</span><span class="ident" id="3165288">i</span><span class="op" id="3165289">]</span><span class="op" id="3165290">)</span>&nbsp;<span class="op" id="3165292">+</span>&nbsp;<span class="string" id="3165294">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165301">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165304">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165307">if</span>&nbsp;<span class="builtinfunc" id="3165310">len</span><span class="op" id="3165313">(</span><span class="ident" id="3165314">dns</span><span class="op" id="3165317">.</span><span class="ident" id="3165318">answer</span><span class="op" id="3165324">)</span>&nbsp;<span class="op" id="3165326">&gt;</span>&nbsp;<span class="num" id="3165328">0</span>&nbsp;<span class="op" id="3165330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165334">s</span>&nbsp;<span class="op" id="3165336">+=</span>&nbsp;<span class="string" id="3165339">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165356">for</span>&nbsp;<span class="ident" id="3165360">i</span>&nbsp;<span class="op" id="3165362">:=</span>&nbsp;<span class="num" id="3165365">0</span><span class="op" id="3165366">;</span>&nbsp;<span class="ident" id="3165368">i</span>&nbsp;<span class="op" id="3165370">&lt;</span>&nbsp;<span class="builtinfunc" id="3165372">len</span><span class="op" id="3165375">(</span><span class="ident" id="3165376">dns</span><span class="op" id="3165379">.</span><span class="ident" id="3165380">answer</span><span class="op" id="3165386">)</span><span class="op" id="3165387">;</span>&nbsp;<span class="ident" id="3165389">i</span><span class="op" id="3165390">++</span>&nbsp;<span class="op" id="3165393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165398">s</span>&nbsp;<span class="op" id="3165400">+=</span>&nbsp;<span class="ident" id="3165403">printStruct</span><span class="op" id="3165414">(</span><span class="ident" id="3165415">dns</span><span class="op" id="3165418">.</span><span class="ident" id="3165419">answer</span><span class="op" id="3165425">[</span><span class="ident" id="3165426">i</span><span class="op" id="3165427">]</span><span class="op" id="3165428">)</span>&nbsp;<span class="op" id="3165430">+</span>&nbsp;<span class="string" id="3165432">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165445">if</span>&nbsp;<span class="builtinfunc" id="3165448">len</span><span class="op" id="3165451">(</span><span class="ident" id="3165452">dns</span><span class="op" id="3165455">.</span><span class="ident" id="3165456">ns</span><span class="op" id="3165458">)</span>&nbsp;<span class="op" id="3165460">&gt;</span>&nbsp;<span class="num" id="3165462">0</span>&nbsp;<span class="op" id="3165464">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165468">s</span>&nbsp;<span class="op" id="3165470">+=</span>&nbsp;<span class="string" id="3165473">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165495">for</span>&nbsp;<span class="ident" id="3165499">i</span>&nbsp;<span class="op" id="3165501">:=</span>&nbsp;<span class="num" id="3165504">0</span><span class="op" id="3165505">;</span>&nbsp;<span class="ident" id="3165507">i</span>&nbsp;<span class="op" id="3165509">&lt;</span>&nbsp;<span class="builtinfunc" id="3165511">len</span><span class="op" id="3165514">(</span><span class="ident" id="3165515">dns</span><span class="op" id="3165518">.</span><span class="ident" id="3165519">ns</span><span class="op" id="3165521">)</span><span class="op" id="3165522">;</span>&nbsp;<span class="ident" id="3165524">i</span><span class="op" id="3165525">++</span>&nbsp;<span class="op" id="3165528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165533">s</span>&nbsp;<span class="op" id="3165535">+=</span>&nbsp;<span class="ident" id="3165538">printStruct</span><span class="op" id="3165549">(</span><span class="ident" id="3165550">dns</span><span class="op" id="3165553">.</span><span class="ident" id="3165554">ns</span><span class="op" id="3165556">[</span><span class="ident" id="3165557">i</span><span class="op" id="3165558">]</span><span class="op" id="3165559">)</span>&nbsp;<span class="op" id="3165561">+</span>&nbsp;<span class="string" id="3165563">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165573">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165576">if</span>&nbsp;<span class="builtinfunc" id="3165579">len</span><span class="op" id="3165582">(</span><span class="ident" id="3165583">dns</span><span class="op" id="3165586">.</span><span class="ident" id="3165587">extra</span><span class="op" id="3165592">)</span>&nbsp;<span class="op" id="3165594">&gt;</span>&nbsp;<span class="num" id="3165596">0</span>&nbsp;<span class="op" id="3165598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165602">s</span>&nbsp;<span class="op" id="3165604">+=</span>&nbsp;<span class="string" id="3165607">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165622">for</span>&nbsp;<span class="ident" id="3165626">i</span>&nbsp;<span class="op" id="3165628">:=</span>&nbsp;<span class="num" id="3165631">0</span><span class="op" id="3165632">;</span>&nbsp;<span class="ident" id="3165634">i</span>&nbsp;<span class="op" id="3165636">&lt;</span>&nbsp;<span class="builtinfunc" id="3165638">len</span><span class="op" id="3165641">(</span><span class="ident" id="3165642">dns</span><span class="op" id="3165645">.</span><span class="ident" id="3165646">extra</span><span class="op" id="3165651">)</span><span class="op" id="3165652">;</span>&nbsp;<span class="ident" id="3165654">i</span><span class="op" id="3165655">++</span>&nbsp;<span class="op" id="3165658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3165663">s</span>&nbsp;<span class="op" id="3165665">+=</span>&nbsp;<span class="ident" id="3165668">printStruct</span><span class="op" id="3165679">(</span><span class="ident" id="3165680">dns</span><span class="op" id="3165683">.</span><span class="ident" id="3165684">extra</span><span class="op" id="3165689">[</span><span class="ident" id="3165690">i</span><span class="op" id="3165691">]</span><span class="op" id="3165692">)</span>&nbsp;<span class="op" id="3165694">+</span>&nbsp;<span class="string" id="3165696">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165703">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3165706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3165709">return</span>&nbsp;<span class="ident" id="3165716">s</span><br>
<span class="lineno"></span><span class="op" id="3165718">}</span>
</div>
</body>
</html>
