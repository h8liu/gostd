<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3498312">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3498367">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3498421">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3498472">package</span>&nbsp;<span class="ident" id="3498480">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3498486">import</span>&nbsp;<span class="op" id="3498493">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498496">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498505">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498512">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498519">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498526">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498537">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3498548">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3498555">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3498558">//&nbsp;This&nbsp;implementation&nbsp;is&nbsp;done&nbsp;according&nbsp;to&nbsp;RFC&nbsp;6265:</span><br>
<span class="lineno"></span><span class="comment" id="3498612">//</span><br>
<span class="lineno"></span><span class="comment" id="3498615">//&nbsp;&nbsp;&nbsp;&nbsp;http://tools.ietf.org/html/rfc6265</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="3498657">//&nbsp;A&nbsp;Cookie&nbsp;represents&nbsp;an&nbsp;HTTP&nbsp;cookie&nbsp;as&nbsp;sent&nbsp;in&nbsp;the&nbsp;Set-Cookie&nbsp;header&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3498734">//&nbsp;HTTP&nbsp;response&nbsp;or&nbsp;the&nbsp;Cookie&nbsp;header&nbsp;of&nbsp;an&nbsp;HTTP&nbsp;request.</span><br>
<span class="lineno"></span><span class="keyword" id="3498792">type</span>&nbsp;<span class="ident" id="3498797">Cookie</span>&nbsp;<span class="keyword" id="3498804">struct</span>&nbsp;<span class="op" id="3498811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498814">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3498825">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498833">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3498844">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498852">Path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3498863">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498871">Domain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3498882">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498890">Expires</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3498901">time</span><span class="op" id="3498905">.</span><span class="ident" id="3498906">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3498912">RawExpires</span>&nbsp;<span class="builtintype" id="3498923">string</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3498932">//&nbsp;MaxAge=0&nbsp;means&nbsp;no&nbsp;&#39;Max-Age&#39;&nbsp;attribute&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3498985">//&nbsp;MaxAge&lt;0&nbsp;means&nbsp;delete&nbsp;cookie&nbsp;now,&nbsp;equivalently&nbsp;&#39;Max-Age:&nbsp;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3499049">//&nbsp;MaxAge&gt;0&nbsp;means&nbsp;Max-Age&nbsp;attribute&nbsp;present&nbsp;and&nbsp;given&nbsp;in&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499115">MaxAge</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3499124">int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499129">Secure</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3499138">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499144">HttpOnly</span>&nbsp;<span class="builtintype" id="3499153">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499159">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3499168">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499176">Unparsed</span>&nbsp;<span class="op" id="3499185">[</span><span class="op" id="3499186">]</span><span class="builtintype" id="3499187">string</span>&nbsp;<span class="comment" id="3499194">//&nbsp;Raw&nbsp;text&nbsp;of&nbsp;unparsed&nbsp;attribute-value&nbsp;pairs</span><br>
<span class="lineno"></span><span class="op" id="3499240">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3499243">//&nbsp;readSetCookies&nbsp;parses&nbsp;all&nbsp;&#34;Set-Cookie&#34;&nbsp;values&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="3499297">//&nbsp;the&nbsp;header&nbsp;h&nbsp;and&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="keyword" id="3499358">func</span>&nbsp;<span class="ident" id="3499363">readSetCookies</span><span class="op" id="3499377">(</span><span class="ident" id="3499378">h</span>&nbsp;<span class="ident" id="3499380">Header</span><span class="op" id="3499386">)</span>&nbsp;<span class="op" id="3499388">[</span><span class="op" id="3499389">]</span><span class="op" id="3499390">*</span><span class="ident" id="3499391">Cookie</span>&nbsp;<span class="op" id="3499398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499401">cookies</span>&nbsp;<span class="op" id="3499409">:=</span>&nbsp;<span class="op" id="3499412">[</span><span class="op" id="3499413">]</span><span class="op" id="3499414">*</span><span class="ident" id="3499415">Cookie</span><span class="op" id="3499421">{</span><span class="op" id="3499422">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499425">for</span>&nbsp;<span class="ident" id="3499429">_</span><span class="op" id="3499430">,</span>&nbsp;<span class="ident" id="3499432">line</span>&nbsp;<span class="op" id="3499437">:=</span>&nbsp;<span class="keyword" id="3499440">range</span>&nbsp;<span class="ident" id="3499446">h</span><span class="op" id="3499447">[</span><span class="string" id="3499448">&#34;Set-Cookie&#34;</span><span class="op" id="3499460">]</span>&nbsp;<span class="op" id="3499462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499466">parts</span>&nbsp;<span class="op" id="3499472">:=</span>&nbsp;<span class="ident" id="3499475">strings</span><span class="op" id="3499482">.</span><span class="ident" id="3499483">Split</span><span class="op" id="3499488">(</span><span class="ident" id="3499489">strings</span><span class="op" id="3499496">.</span><span class="ident" id="3499497">TrimSpace</span><span class="op" id="3499506">(</span><span class="ident" id="3499507">line</span><span class="op" id="3499511">)</span><span class="op" id="3499512">,</span>&nbsp;<span class="string" id="3499514">&#34;;&#34;</span><span class="op" id="3499517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499521">if</span>&nbsp;<span class="builtinfunc" id="3499524">len</span><span class="op" id="3499527">(</span><span class="ident" id="3499528">parts</span><span class="op" id="3499533">)</span>&nbsp;<span class="op" id="3499535">==</span>&nbsp;<span class="num" id="3499538">1</span>&nbsp;<span class="op" id="3499540">&amp;&amp;</span>&nbsp;<span class="ident" id="3499543">parts</span><span class="op" id="3499548">[</span><span class="num" id="3499549">0</span><span class="op" id="3499550">]</span>&nbsp;<span class="op" id="3499552">==</span>&nbsp;<span class="string" id="3499555">&#34;&#34;</span>&nbsp;<span class="op" id="3499558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499563">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3499574">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499578">parts</span><span class="op" id="3499583">[</span><span class="num" id="3499584">0</span><span class="op" id="3499585">]</span>&nbsp;<span class="op" id="3499587">=</span>&nbsp;<span class="ident" id="3499589">strings</span><span class="op" id="3499596">.</span><span class="ident" id="3499597">TrimSpace</span><span class="op" id="3499606">(</span><span class="ident" id="3499607">parts</span><span class="op" id="3499612">[</span><span class="num" id="3499613">0</span><span class="op" id="3499614">]</span><span class="op" id="3499615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499619">j</span>&nbsp;<span class="op" id="3499621">:=</span>&nbsp;<span class="ident" id="3499624">strings</span><span class="op" id="3499631">.</span><span class="ident" id="3499632">Index</span><span class="op" id="3499637">(</span><span class="ident" id="3499638">parts</span><span class="op" id="3499643">[</span><span class="num" id="3499644">0</span><span class="op" id="3499645">]</span><span class="op" id="3499646">,</span>&nbsp;<span class="string" id="3499648">&#34;=&#34;</span><span class="op" id="3499651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499655">if</span>&nbsp;<span class="ident" id="3499658">j</span>&nbsp;<span class="op" id="3499660">&lt;</span>&nbsp;<span class="num" id="3499662">0</span>&nbsp;<span class="op" id="3499664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499669">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3499680">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499684">name</span><span class="op" id="3499688">,</span>&nbsp;<span class="ident" id="3499690">value</span>&nbsp;<span class="op" id="3499696">:=</span>&nbsp;<span class="ident" id="3499699">parts</span><span class="op" id="3499704">[</span><span class="num" id="3499705">0</span><span class="op" id="3499706">]</span><span class="op" id="3499707">[</span><span class="op" id="3499708">:</span><span class="ident" id="3499709">j</span><span class="op" id="3499710">]</span><span class="op" id="3499711">,</span>&nbsp;<span class="ident" id="3499713">parts</span><span class="op" id="3499718">[</span><span class="num" id="3499719">0</span><span class="op" id="3499720">]</span><span class="op" id="3499721">[</span><span class="ident" id="3499722">j</span><span class="op" id="3499723">+</span><span class="num" id="3499724">1</span><span class="op" id="3499725">:</span><span class="op" id="3499726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499730">if</span>&nbsp;<span class="op" id="3499733">!</span><span class="ident" id="3499734">isCookieNameValid</span><span class="op" id="3499751">(</span><span class="ident" id="3499752">name</span><span class="op" id="3499756">)</span>&nbsp;<span class="op" id="3499758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499763">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3499774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499778">value</span><span class="op" id="3499783">,</span>&nbsp;<span class="ident" id="3499785">success</span>&nbsp;<span class="op" id="3499793">:=</span>&nbsp;<span class="ident" id="3499796">parseCookieValue</span><span class="op" id="3499812">(</span><span class="ident" id="3499813">value</span><span class="op" id="3499818">,</span>&nbsp;<span class="ident" id="3499820">true</span><span class="op" id="3499824">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499828">if</span>&nbsp;<span class="op" id="3499831">!</span><span class="ident" id="3499832">success</span>&nbsp;<span class="op" id="3499840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499845">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3499856">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499860">c</span>&nbsp;<span class="op" id="3499862">:=</span>&nbsp;<span class="op" id="3499865">&amp;</span><span class="ident" id="3499866">Cookie</span><span class="op" id="3499872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499877">Name</span><span class="op" id="3499881">:</span>&nbsp;&nbsp;<span class="ident" id="3499884">name</span><span class="op" id="3499888">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499893">Value</span><span class="op" id="3499898">:</span>&nbsp;<span class="ident" id="3499900">value</span><span class="op" id="3499905">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499910">Raw</span><span class="op" id="3499913">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3499917">line</span><span class="op" id="3499921">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3499925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3499929">for</span>&nbsp;<span class="ident" id="3499933">i</span>&nbsp;<span class="op" id="3499935">:=</span>&nbsp;<span class="num" id="3499938">1</span><span class="op" id="3499939">;</span>&nbsp;<span class="ident" id="3499941">i</span>&nbsp;<span class="op" id="3499943">&lt;</span>&nbsp;<span class="builtinfunc" id="3499945">len</span><span class="op" id="3499948">(</span><span class="ident" id="3499949">parts</span><span class="op" id="3499954">)</span><span class="op" id="3499955">;</span>&nbsp;<span class="ident" id="3499957">i</span><span class="op" id="3499958">++</span>&nbsp;<span class="op" id="3499961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3499966">parts</span><span class="op" id="3499971">[</span><span class="ident" id="3499972">i</span><span class="op" id="3499973">]</span>&nbsp;<span class="op" id="3499975">=</span>&nbsp;<span class="ident" id="3499977">strings</span><span class="op" id="3499984">.</span><span class="ident" id="3499985">TrimSpace</span><span class="op" id="3499994">(</span><span class="ident" id="3499995">parts</span><span class="op" id="3500000">[</span><span class="ident" id="3500001">i</span><span class="op" id="3500002">]</span><span class="op" id="3500003">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500008">if</span>&nbsp;<span class="builtinfunc" id="3500011">len</span><span class="op" id="3500014">(</span><span class="ident" id="3500015">parts</span><span class="op" id="3500020">[</span><span class="ident" id="3500021">i</span><span class="op" id="3500022">]</span><span class="op" id="3500023">)</span>&nbsp;<span class="op" id="3500025">==</span>&nbsp;<span class="num" id="3500028">0</span>&nbsp;<span class="op" id="3500030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500036">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500054">attr</span><span class="op" id="3500058">,</span>&nbsp;<span class="ident" id="3500060">val</span>&nbsp;<span class="op" id="3500064">:=</span>&nbsp;<span class="ident" id="3500067">parts</span><span class="op" id="3500072">[</span><span class="ident" id="3500073">i</span><span class="op" id="3500074">]</span><span class="op" id="3500075">,</span>&nbsp;<span class="string" id="3500077">&#34;&#34;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500083">if</span>&nbsp;<span class="ident" id="3500086">j</span>&nbsp;<span class="op" id="3500088">:=</span>&nbsp;<span class="ident" id="3500091">strings</span><span class="op" id="3500098">.</span><span class="ident" id="3500099">Index</span><span class="op" id="3500104">(</span><span class="ident" id="3500105">attr</span><span class="op" id="3500109">,</span>&nbsp;<span class="string" id="3500111">&#34;=&#34;</span><span class="op" id="3500114">)</span><span class="op" id="3500115">;</span>&nbsp;<span class="ident" id="3500117">j</span>&nbsp;<span class="op" id="3500119">&gt;=</span>&nbsp;<span class="num" id="3500122">0</span>&nbsp;<span class="op" id="3500124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500130">attr</span><span class="op" id="3500134">,</span>&nbsp;<span class="ident" id="3500136">val</span>&nbsp;<span class="op" id="3500140">=</span>&nbsp;<span class="ident" id="3500142">attr</span><span class="op" id="3500146">[</span><span class="op" id="3500147">:</span><span class="ident" id="3500148">j</span><span class="op" id="3500149">]</span><span class="op" id="3500150">,</span>&nbsp;<span class="ident" id="3500152">attr</span><span class="op" id="3500156">[</span><span class="ident" id="3500157">j</span><span class="op" id="3500158">+</span><span class="num" id="3500159">1</span><span class="op" id="3500160">:</span><span class="op" id="3500161">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500171">lowerAttr</span>&nbsp;<span class="op" id="3500181">:=</span>&nbsp;<span class="ident" id="3500184">strings</span><span class="op" id="3500191">.</span><span class="ident" id="3500192">ToLower</span><span class="op" id="3500199">(</span><span class="ident" id="3500200">attr</span><span class="op" id="3500204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500209">val</span><span class="op" id="3500212">,</span>&nbsp;<span class="ident" id="3500214">success</span>&nbsp;<span class="op" id="3500222">=</span>&nbsp;<span class="ident" id="3500224">parseCookieValue</span><span class="op" id="3500240">(</span><span class="ident" id="3500241">val</span><span class="op" id="3500244">,</span>&nbsp;<span class="ident" id="3500246">false</span><span class="op" id="3500251">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500256">if</span>&nbsp;<span class="op" id="3500259">!</span><span class="ident" id="3500260">success</span>&nbsp;<span class="op" id="3500268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500274">c</span><span class="op" id="3500275">.</span><span class="ident" id="3500276">Unparsed</span>&nbsp;<span class="op" id="3500285">=</span>&nbsp;<span class="builtinfunc" id="3500287">append</span><span class="op" id="3500293">(</span><span class="ident" id="3500294">c</span><span class="op" id="3500295">.</span><span class="ident" id="3500296">Unparsed</span><span class="op" id="3500304">,</span>&nbsp;<span class="ident" id="3500306">parts</span><span class="op" id="3500311">[</span><span class="ident" id="3500312">i</span><span class="op" id="3500313">]</span><span class="op" id="3500314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500320">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500337">switch</span>&nbsp;<span class="ident" id="3500344">lowerAttr</span>&nbsp;<span class="op" id="3500354">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500359">case</span>&nbsp;<span class="string" id="3500364">&#34;secure&#34;</span><span class="op" id="3500372">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500378">c</span><span class="op" id="3500379">.</span><span class="ident" id="3500380">Secure</span>&nbsp;<span class="op" id="3500387">=</span>&nbsp;<span class="ident" id="3500389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500398">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500410">case</span>&nbsp;<span class="string" id="3500415">&#34;httponly&#34;</span><span class="op" id="3500425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500431">c</span><span class="op" id="3500432">.</span><span class="ident" id="3500433">HttpOnly</span>&nbsp;<span class="op" id="3500442">=</span>&nbsp;<span class="ident" id="3500444">true</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500453">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500465">case</span>&nbsp;<span class="string" id="3500470">&#34;domain&#34;</span><span class="op" id="3500478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500484">c</span><span class="op" id="3500485">.</span><span class="ident" id="3500486">Domain</span>&nbsp;<span class="op" id="3500493">=</span>&nbsp;<span class="ident" id="3500495">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500503">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500515">case</span>&nbsp;<span class="string" id="3500520">&#34;max-age&#34;</span><span class="op" id="3500529">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500535">secs</span><span class="op" id="3500539">,</span>&nbsp;<span class="ident" id="3500541">err</span>&nbsp;<span class="op" id="3500545">:=</span>&nbsp;<span class="ident" id="3500548">strconv</span><span class="op" id="3500555">.</span><span class="ident" id="3500556">Atoi</span><span class="op" id="3500560">(</span><span class="ident" id="3500561">val</span><span class="op" id="3500564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500570">if</span>&nbsp;<span class="ident" id="3500573">err</span>&nbsp;<span class="op" id="3500577">!=</span>&nbsp;<span class="ident" id="3500580">nil</span>&nbsp;<span class="op" id="3500584">||</span>&nbsp;<span class="ident" id="3500587">secs</span>&nbsp;<span class="op" id="3500592">!=</span>&nbsp;<span class="num" id="3500595">0</span>&nbsp;<span class="op" id="3500597">&amp;&amp;</span>&nbsp;<span class="ident" id="3500600">val</span><span class="op" id="3500603">[</span><span class="num" id="3500604">0</span><span class="op" id="3500605">]</span>&nbsp;<span class="op" id="3500607">==</span>&nbsp;<span class="string" id="3500610">&#39;0&#39;</span>&nbsp;<span class="op" id="3500614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500621">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500637">if</span>&nbsp;<span class="ident" id="3500640">secs</span>&nbsp;<span class="op" id="3500645">&lt;=</span>&nbsp;<span class="num" id="3500648">0</span>&nbsp;<span class="op" id="3500650">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500657">c</span><span class="op" id="3500658">.</span><span class="ident" id="3500659">MaxAge</span>&nbsp;<span class="op" id="3500666">=</span>&nbsp;<span class="op" id="3500668">-</span><span class="num" id="3500669">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500675">}</span>&nbsp;<span class="keyword" id="3500677">else</span>&nbsp;<span class="op" id="3500682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500689">c</span><span class="op" id="3500690">.</span><span class="ident" id="3500691">MaxAge</span>&nbsp;<span class="op" id="3500698">=</span>&nbsp;<span class="ident" id="3500700">secs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500715">continue</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500727">case</span>&nbsp;<span class="string" id="3500732">&#34;expires&#34;</span><span class="op" id="3500741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500747">c</span><span class="op" id="3500748">.</span><span class="ident" id="3500749">RawExpires</span>&nbsp;<span class="op" id="3500760">=</span>&nbsp;<span class="ident" id="3500762">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500770">exptime</span><span class="op" id="3500777">,</span>&nbsp;<span class="ident" id="3500779">err</span>&nbsp;<span class="op" id="3500783">:=</span>&nbsp;<span class="ident" id="3500786">time</span><span class="op" id="3500790">.</span><span class="ident" id="3500791">Parse</span><span class="op" id="3500796">(</span><span class="ident" id="3500797">time</span><span class="op" id="3500801">.</span><span class="ident" id="3500802">RFC1123</span><span class="op" id="3500809">,</span>&nbsp;<span class="ident" id="3500811">val</span><span class="op" id="3500814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500820">if</span>&nbsp;<span class="ident" id="3500823">err</span>&nbsp;<span class="op" id="3500827">!=</span>&nbsp;<span class="ident" id="3500830">nil</span>&nbsp;<span class="op" id="3500834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500841">exptime</span><span class="op" id="3500848">,</span>&nbsp;<span class="ident" id="3500850">err</span>&nbsp;<span class="op" id="3500854">=</span>&nbsp;<span class="ident" id="3500856">time</span><span class="op" id="3500860">.</span><span class="ident" id="3500861">Parse</span><span class="op" id="3500866">(</span><span class="string" id="3500867">&#34;Mon,&nbsp;02-Jan-2006&nbsp;15:04:05&nbsp;MST&#34;</span><span class="op" id="3500898">,</span>&nbsp;<span class="ident" id="3500900">val</span><span class="op" id="3500903">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500910">if</span>&nbsp;<span class="ident" id="3500913">err</span>&nbsp;<span class="op" id="3500917">!=</span>&nbsp;<span class="ident" id="3500920">nil</span>&nbsp;<span class="op" id="3500924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500932">c</span><span class="op" id="3500933">.</span><span class="ident" id="3500934">Expires</span>&nbsp;<span class="op" id="3500942">=</span>&nbsp;<span class="ident" id="3500944">time</span><span class="op" id="3500948">.</span><span class="ident" id="3500949">Time</span><span class="op" id="3500953">{</span><span class="op" id="3500954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3500962">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3500979">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3500985">c</span><span class="op" id="3500986">.</span><span class="ident" id="3500987">Expires</span>&nbsp;<span class="op" id="3500995">=</span>&nbsp;<span class="ident" id="3500997">exptime</span><span class="op" id="3501004">.</span><span class="ident" id="3501005">UTC</span><span class="op" id="3501008">(</span><span class="op" id="3501009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501015">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501027">case</span>&nbsp;<span class="string" id="3501032">&#34;path&#34;</span><span class="op" id="3501038">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501044">c</span><span class="op" id="3501045">.</span><span class="ident" id="3501046">Path</span>&nbsp;<span class="op" id="3501051">=</span>&nbsp;<span class="ident" id="3501053">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501061">continue</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3501073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501078">c</span><span class="op" id="3501079">.</span><span class="ident" id="3501080">Unparsed</span>&nbsp;<span class="op" id="3501089">=</span>&nbsp;<span class="builtinfunc" id="3501091">append</span><span class="op" id="3501097">(</span><span class="ident" id="3501098">c</span><span class="op" id="3501099">.</span><span class="ident" id="3501100">Unparsed</span><span class="op" id="3501108">,</span>&nbsp;<span class="ident" id="3501110">parts</span><span class="op" id="3501115">[</span><span class="ident" id="3501116">i</span><span class="op" id="3501117">]</span><span class="op" id="3501118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3501122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501126">cookies</span>&nbsp;<span class="op" id="3501134">=</span>&nbsp;<span class="builtinfunc" id="3501136">append</span><span class="op" id="3501142">(</span><span class="ident" id="3501143">cookies</span><span class="op" id="3501150">,</span>&nbsp;<span class="ident" id="3501152">c</span><span class="op" id="3501153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3501156">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501159">return</span>&nbsp;<span class="ident" id="3501166">cookies</span><br>
<span class="lineno"></span><span class="op" id="3501174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3501177">//&nbsp;SetCookie&nbsp;adds&nbsp;a&nbsp;Set-Cookie&nbsp;header&nbsp;to&nbsp;the&nbsp;provided&nbsp;ResponseWriter&#39;s&nbsp;headers.</span><br>
<span class="lineno"></span><span class="keyword" id="3501257">func</span>&nbsp;<span class="ident" id="3501262">SetCookie</span><span class="op" id="3501271">(</span><span class="ident" id="3501272">w</span>&nbsp;<span class="ident" id="3501274">ResponseWriter</span><span class="op" id="3501288">,</span>&nbsp;<span class="ident" id="3501290">cookie</span>&nbsp;<span class="op" id="3501297">*</span><span class="ident" id="3501298">Cookie</span><span class="op" id="3501304">)</span>&nbsp;<span class="op" id="3501306">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501309">w</span><span class="op" id="3501310">.</span><span class="ident" id="3501311">Header</span><span class="op" id="3501317">(</span><span class="op" id="3501318">)</span><span class="op" id="3501319">.</span><span class="ident" id="3501320">Add</span><span class="op" id="3501323">(</span><span class="string" id="3501324">&#34;Set-Cookie&#34;</span><span class="op" id="3501336">,</span>&nbsp;<span class="ident" id="3501338">cookie</span><span class="op" id="3501344">.</span><span class="ident" id="3501345">String</span><span class="op" id="3501351">(</span><span class="op" id="3501352">)</span><span class="op" id="3501353">)</span><br>
<span class="lineno"></span><span class="op" id="3501355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3501358">//&nbsp;String&nbsp;returns&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;cookie&nbsp;for&nbsp;use&nbsp;in&nbsp;a&nbsp;Cookie</span><br>
<span class="lineno"></span><span class="comment" id="3501428">//&nbsp;header&nbsp;(if&nbsp;only&nbsp;Name&nbsp;and&nbsp;Value&nbsp;are&nbsp;set)&nbsp;or&nbsp;a&nbsp;Set-Cookie&nbsp;response</span><br>
<span class="lineno">135</span><span class="comment" id="3501496">//&nbsp;header&nbsp;(if&nbsp;other&nbsp;fields&nbsp;are&nbsp;set).</span><br>
<span class="lineno"></span><span class="keyword" id="3501533">func</span>&nbsp;<span class="op" id="3501538">(</span><span class="ident" id="3501539">c</span>&nbsp;<span class="op" id="3501541">*</span><span class="ident" id="3501542">Cookie</span><span class="op" id="3501548">)</span>&nbsp;<span class="ident" id="3501550">String</span><span class="op" id="3501556">(</span><span class="op" id="3501557">)</span>&nbsp;<span class="builtintype" id="3501559">string</span>&nbsp;<span class="op" id="3501566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501569">var</span>&nbsp;<span class="ident" id="3501573">b</span>&nbsp;<span class="ident" id="3501575">bytes</span><span class="op" id="3501580">.</span><span class="ident" id="3501581">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501589">fmt</span><span class="op" id="3501592">.</span><span class="ident" id="3501593">Fprintf</span><span class="op" id="3501600">(</span><span class="op" id="3501601">&amp;</span><span class="ident" id="3501602">b</span><span class="op" id="3501603">,</span>&nbsp;<span class="string" id="3501605">&#34;%s=%s&#34;</span><span class="op" id="3501612">,</span>&nbsp;<span class="ident" id="3501614">sanitizeCookieName</span><span class="op" id="3501632">(</span><span class="ident" id="3501633">c</span><span class="op" id="3501634">.</span><span class="ident" id="3501635">Name</span><span class="op" id="3501639">)</span><span class="op" id="3501640">,</span>&nbsp;<span class="ident" id="3501642">sanitizeCookieValue</span><span class="op" id="3501661">(</span><span class="ident" id="3501662">c</span><span class="op" id="3501663">.</span><span class="ident" id="3501664">Value</span><span class="op" id="3501669">)</span><span class="op" id="3501670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501673">if</span>&nbsp;<span class="builtinfunc" id="3501676">len</span><span class="op" id="3501679">(</span><span class="ident" id="3501680">c</span><span class="op" id="3501681">.</span><span class="ident" id="3501682">Path</span><span class="op" id="3501686">)</span>&nbsp;<span class="op" id="3501688">&gt;</span>&nbsp;<span class="num" id="3501690">0</span>&nbsp;<span class="op" id="3501692">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3501696">fmt</span><span class="op" id="3501699">.</span><span class="ident" id="3501700">Fprintf</span><span class="op" id="3501707">(</span><span class="op" id="3501708">&amp;</span><span class="ident" id="3501709">b</span><span class="op" id="3501710">,</span>&nbsp;<span class="string" id="3501712">&#34;;&nbsp;Path=%s&#34;</span><span class="op" id="3501723">,</span>&nbsp;<span class="ident" id="3501725">sanitizeCookiePath</span><span class="op" id="3501743">(</span><span class="ident" id="3501744">c</span><span class="op" id="3501745">.</span><span class="ident" id="3501746">Path</span><span class="op" id="3501750">)</span><span class="op" id="3501751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3501754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501757">if</span>&nbsp;<span class="builtinfunc" id="3501760">len</span><span class="op" id="3501763">(</span><span class="ident" id="3501764">c</span><span class="op" id="3501765">.</span><span class="ident" id="3501766">Domain</span><span class="op" id="3501772">)</span>&nbsp;<span class="op" id="3501774">&gt;</span>&nbsp;<span class="num" id="3501776">0</span>&nbsp;<span class="op" id="3501778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3501782">if</span>&nbsp;<span class="ident" id="3501785">validCookieDomain</span><span class="op" id="3501802">(</span><span class="ident" id="3501803">c</span><span class="op" id="3501804">.</span><span class="ident" id="3501805">Domain</span><span class="op" id="3501811">)</span>&nbsp;<span class="op" id="3501813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3501818">//&nbsp;A&nbsp;c.Domain&nbsp;containing&nbsp;illegal&nbsp;characters&nbsp;is&nbsp;not</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3501872">//&nbsp;sanitized&nbsp;but&nbsp;simply&nbsp;dropped&nbsp;which&nbsp;turns&nbsp;the&nbsp;cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3501930">//&nbsp;into&nbsp;a&nbsp;host-only&nbsp;cookie.&nbsp;A&nbsp;leading&nbsp;dot&nbsp;is&nbsp;okay</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3501983">//&nbsp;but&nbsp;won&#39;t&nbsp;be&nbsp;sent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502008">d</span>&nbsp;<span class="op" id="3502010">:=</span>&nbsp;<span class="ident" id="3502013">c</span><span class="op" id="3502014">.</span><span class="ident" id="3502015">Domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502025">if</span>&nbsp;<span class="ident" id="3502028">d</span><span class="op" id="3502029">[</span><span class="num" id="3502030">0</span><span class="op" id="3502031">]</span>&nbsp;<span class="op" id="3502033">==</span>&nbsp;<span class="string" id="3502036">&#39;.&#39;</span>&nbsp;<span class="op" id="3502040">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502046">d</span>&nbsp;<span class="op" id="3502048">=</span>&nbsp;<span class="ident" id="3502050">d</span><span class="op" id="3502051">[</span><span class="num" id="3502052">1</span><span class="op" id="3502053">:</span><span class="op" id="3502054">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502064">fmt</span><span class="op" id="3502067">.</span><span class="ident" id="3502068">Fprintf</span><span class="op" id="3502075">(</span><span class="op" id="3502076">&amp;</span><span class="ident" id="3502077">b</span><span class="op" id="3502078">,</span>&nbsp;<span class="string" id="3502080">&#34;;&nbsp;Domain=%s&#34;</span><span class="op" id="3502093">,</span>&nbsp;<span class="ident" id="3502095">d</span><span class="op" id="3502096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502100">}</span>&nbsp;<span class="keyword" id="3502102">else</span>&nbsp;<span class="op" id="3502107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502112">log</span><span class="op" id="3502115">.</span><span class="ident" id="3502116">Printf</span><span class="op" id="3502122">(</span><span class="string" id="3502123">&#34;net/http:&nbsp;invalid&nbsp;Cookie.Domain&nbsp;%q;&nbsp;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="3502186">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502192">c</span><span class="op" id="3502193">.</span><span class="ident" id="3502194">Domain</span><span class="op" id="3502200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502210">if</span>&nbsp;<span class="ident" id="3502213">c</span><span class="op" id="3502214">.</span><span class="ident" id="3502215">Expires</span><span class="op" id="3502222">.</span><span class="ident" id="3502223">Unix</span><span class="op" id="3502227">(</span><span class="op" id="3502228">)</span>&nbsp;<span class="op" id="3502230">&gt;</span>&nbsp;<span class="num" id="3502232">0</span>&nbsp;<span class="op" id="3502234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502238">fmt</span><span class="op" id="3502241">.</span><span class="ident" id="3502242">Fprintf</span><span class="op" id="3502249">(</span><span class="op" id="3502250">&amp;</span><span class="ident" id="3502251">b</span><span class="op" id="3502252">,</span>&nbsp;<span class="string" id="3502254">&#34;;&nbsp;Expires=%s&#34;</span><span class="op" id="3502268">,</span>&nbsp;<span class="ident" id="3502270">c</span><span class="op" id="3502271">.</span><span class="ident" id="3502272">Expires</span><span class="op" id="3502279">.</span><span class="ident" id="3502280">UTC</span><span class="op" id="3502283">(</span><span class="op" id="3502284">)</span><span class="op" id="3502285">.</span><span class="ident" id="3502286">Format</span><span class="op" id="3502292">(</span><span class="ident" id="3502293">time</span><span class="op" id="3502297">.</span><span class="ident" id="3502298">RFC1123</span><span class="op" id="3502305">)</span><span class="op" id="3502306">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502312">if</span>&nbsp;<span class="ident" id="3502315">c</span><span class="op" id="3502316">.</span><span class="ident" id="3502317">MaxAge</span>&nbsp;<span class="op" id="3502324">&gt;</span>&nbsp;<span class="num" id="3502326">0</span>&nbsp;<span class="op" id="3502328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502332">fmt</span><span class="op" id="3502335">.</span><span class="ident" id="3502336">Fprintf</span><span class="op" id="3502343">(</span><span class="op" id="3502344">&amp;</span><span class="ident" id="3502345">b</span><span class="op" id="3502346">,</span>&nbsp;<span class="string" id="3502348">&#34;;&nbsp;Max-Age=%d&#34;</span><span class="op" id="3502362">,</span>&nbsp;<span class="ident" id="3502364">c</span><span class="op" id="3502365">.</span><span class="ident" id="3502366">MaxAge</span><span class="op" id="3502372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502375">}</span>&nbsp;<span class="keyword" id="3502377">else</span>&nbsp;<span class="keyword" id="3502382">if</span>&nbsp;<span class="ident" id="3502385">c</span><span class="op" id="3502386">.</span><span class="ident" id="3502387">MaxAge</span>&nbsp;<span class="op" id="3502394">&lt;</span>&nbsp;<span class="num" id="3502396">0</span>&nbsp;<span class="op" id="3502398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502402">fmt</span><span class="op" id="3502405">.</span><span class="ident" id="3502406">Fprintf</span><span class="op" id="3502413">(</span><span class="op" id="3502414">&amp;</span><span class="ident" id="3502415">b</span><span class="op" id="3502416">,</span>&nbsp;<span class="string" id="3502418">&#34;;&nbsp;Max-Age=0&#34;</span><span class="op" id="3502431">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502437">if</span>&nbsp;<span class="ident" id="3502440">c</span><span class="op" id="3502441">.</span><span class="ident" id="3502442">HttpOnly</span>&nbsp;<span class="op" id="3502451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502455">fmt</span><span class="op" id="3502458">.</span><span class="ident" id="3502459">Fprintf</span><span class="op" id="3502466">(</span><span class="op" id="3502467">&amp;</span><span class="ident" id="3502468">b</span><span class="op" id="3502469">,</span>&nbsp;<span class="string" id="3502471">&#34;;&nbsp;HttpOnly&#34;</span><span class="op" id="3502483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502489">if</span>&nbsp;<span class="ident" id="3502492">c</span><span class="op" id="3502493">.</span><span class="ident" id="3502494">Secure</span>&nbsp;<span class="op" id="3502501">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502505">fmt</span><span class="op" id="3502508">.</span><span class="ident" id="3502509">Fprintf</span><span class="op" id="3502516">(</span><span class="op" id="3502517">&amp;</span><span class="ident" id="3502518">b</span><span class="op" id="3502519">,</span>&nbsp;<span class="string" id="3502521">&#34;;&nbsp;Secure&#34;</span><span class="op" id="3502531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502537">return</span>&nbsp;<span class="ident" id="3502544">b</span><span class="op" id="3502545">.</span><span class="ident" id="3502546">String</span><span class="op" id="3502552">(</span><span class="op" id="3502553">)</span><br>
<span class="lineno"></span><span class="op" id="3502555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="3502558">//&nbsp;readCookies&nbsp;parses&nbsp;all&nbsp;&#34;Cookie&#34;&nbsp;values&nbsp;from&nbsp;the&nbsp;header&nbsp;h&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3502622">//&nbsp;returns&nbsp;the&nbsp;successfully&nbsp;parsed&nbsp;Cookies.</span><br>
<span class="lineno"></span><span class="comment" id="3502666">//</span><br>
<span class="lineno"></span><span class="comment" id="3502669">//&nbsp;if&nbsp;filter&nbsp;isn&#39;t&nbsp;empty,&nbsp;only&nbsp;cookies&nbsp;of&nbsp;that&nbsp;name&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="keyword" id="3502734">func</span>&nbsp;<span class="ident" id="3502739">readCookies</span><span class="op" id="3502750">(</span><span class="ident" id="3502751">h</span>&nbsp;<span class="ident" id="3502753">Header</span><span class="op" id="3502759">,</span>&nbsp;<span class="ident" id="3502761">filter</span>&nbsp;<span class="builtintype" id="3502768">string</span><span class="op" id="3502774">)</span>&nbsp;<span class="op" id="3502776">[</span><span class="op" id="3502777">]</span><span class="op" id="3502778">*</span><span class="ident" id="3502779">Cookie</span>&nbsp;<span class="op" id="3502786">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502789">cookies</span>&nbsp;<span class="op" id="3502797">:=</span>&nbsp;<span class="op" id="3502800">[</span><span class="op" id="3502801">]</span><span class="op" id="3502802">*</span><span class="ident" id="3502803">Cookie</span><span class="op" id="3502809">{</span><span class="op" id="3502810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502813">lines</span><span class="op" id="3502818">,</span>&nbsp;<span class="ident" id="3502820">ok</span>&nbsp;<span class="op" id="3502823">:=</span>&nbsp;<span class="ident" id="3502826">h</span><span class="op" id="3502827">[</span><span class="string" id="3502828">&#34;Cookie&#34;</span><span class="op" id="3502836">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502839">if</span>&nbsp;<span class="op" id="3502842">!</span><span class="ident" id="3502843">ok</span>&nbsp;<span class="op" id="3502846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502850">return</span>&nbsp;<span class="ident" id="3502857">cookies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3502866">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502870">for</span>&nbsp;<span class="ident" id="3502874">_</span><span class="op" id="3502875">,</span>&nbsp;<span class="ident" id="3502877">line</span>&nbsp;<span class="op" id="3502882">:=</span>&nbsp;<span class="keyword" id="3502885">range</span>&nbsp;<span class="ident" id="3502891">lines</span>&nbsp;<span class="op" id="3502897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3502901">parts</span>&nbsp;<span class="op" id="3502907">:=</span>&nbsp;<span class="ident" id="3502910">strings</span><span class="op" id="3502917">.</span><span class="ident" id="3502918">Split</span><span class="op" id="3502923">(</span><span class="ident" id="3502924">strings</span><span class="op" id="3502931">.</span><span class="ident" id="3502932">TrimSpace</span><span class="op" id="3502941">(</span><span class="ident" id="3502942">line</span><span class="op" id="3502946">)</span><span class="op" id="3502947">,</span>&nbsp;<span class="string" id="3502949">&#34;;&#34;</span><span class="op" id="3502952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502956">if</span>&nbsp;<span class="builtinfunc" id="3502959">len</span><span class="op" id="3502962">(</span><span class="ident" id="3502963">parts</span><span class="op" id="3502968">)</span>&nbsp;<span class="op" id="3502970">==</span>&nbsp;<span class="num" id="3502973">1</span>&nbsp;<span class="op" id="3502975">&amp;&amp;</span>&nbsp;<span class="ident" id="3502978">parts</span><span class="op" id="3502983">[</span><span class="num" id="3502984">0</span><span class="op" id="3502985">]</span>&nbsp;<span class="op" id="3502987">==</span>&nbsp;<span class="string" id="3502990">&#34;&#34;</span>&nbsp;<span class="op" id="3502993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3502998">continue</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3503013">//&nbsp;Per-line&nbsp;attributes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503038">parsedPairs</span>&nbsp;<span class="op" id="3503050">:=</span>&nbsp;<span class="num" id="3503053">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503057">for</span>&nbsp;<span class="ident" id="3503061">i</span>&nbsp;<span class="op" id="3503063">:=</span>&nbsp;<span class="num" id="3503066">0</span><span class="op" id="3503067">;</span>&nbsp;<span class="ident" id="3503069">i</span>&nbsp;<span class="op" id="3503071">&lt;</span>&nbsp;<span class="builtinfunc" id="3503073">len</span><span class="op" id="3503076">(</span><span class="ident" id="3503077">parts</span><span class="op" id="3503082">)</span><span class="op" id="3503083">;</span>&nbsp;<span class="ident" id="3503085">i</span><span class="op" id="3503086">++</span>&nbsp;<span class="op" id="3503089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503094">parts</span><span class="op" id="3503099">[</span><span class="ident" id="3503100">i</span><span class="op" id="3503101">]</span>&nbsp;<span class="op" id="3503103">=</span>&nbsp;<span class="ident" id="3503105">strings</span><span class="op" id="3503112">.</span><span class="ident" id="3503113">TrimSpace</span><span class="op" id="3503122">(</span><span class="ident" id="3503123">parts</span><span class="op" id="3503128">[</span><span class="ident" id="3503129">i</span><span class="op" id="3503130">]</span><span class="op" id="3503131">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503136">if</span>&nbsp;<span class="builtinfunc" id="3503139">len</span><span class="op" id="3503142">(</span><span class="ident" id="3503143">parts</span><span class="op" id="3503148">[</span><span class="ident" id="3503149">i</span><span class="op" id="3503150">]</span><span class="op" id="3503151">)</span>&nbsp;<span class="op" id="3503153">==</span>&nbsp;<span class="num" id="3503156">0</span>&nbsp;<span class="op" id="3503158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503164">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503181">name</span><span class="op" id="3503185">,</span>&nbsp;<span class="ident" id="3503187">val</span>&nbsp;<span class="op" id="3503191">:=</span>&nbsp;<span class="ident" id="3503194">parts</span><span class="op" id="3503199">[</span><span class="ident" id="3503200">i</span><span class="op" id="3503201">]</span><span class="op" id="3503202">,</span>&nbsp;<span class="string" id="3503204">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503210">if</span>&nbsp;<span class="ident" id="3503213">j</span>&nbsp;<span class="op" id="3503215">:=</span>&nbsp;<span class="ident" id="3503218">strings</span><span class="op" id="3503225">.</span><span class="ident" id="3503226">Index</span><span class="op" id="3503231">(</span><span class="ident" id="3503232">name</span><span class="op" id="3503236">,</span>&nbsp;<span class="string" id="3503238">&#34;=&#34;</span><span class="op" id="3503241">)</span><span class="op" id="3503242">;</span>&nbsp;<span class="ident" id="3503244">j</span>&nbsp;<span class="op" id="3503246">&gt;=</span>&nbsp;<span class="num" id="3503249">0</span>&nbsp;<span class="op" id="3503251">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503257">name</span><span class="op" id="3503261">,</span>&nbsp;<span class="ident" id="3503263">val</span>&nbsp;<span class="op" id="3503267">=</span>&nbsp;<span class="ident" id="3503269">name</span><span class="op" id="3503273">[</span><span class="op" id="3503274">:</span><span class="ident" id="3503275">j</span><span class="op" id="3503276">]</span><span class="op" id="3503277">,</span>&nbsp;<span class="ident" id="3503279">name</span><span class="op" id="3503283">[</span><span class="ident" id="3503284">j</span><span class="op" id="3503285">+</span><span class="num" id="3503286">1</span><span class="op" id="3503287">:</span><span class="op" id="3503288">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503298">if</span>&nbsp;<span class="op" id="3503301">!</span><span class="ident" id="3503302">isCookieNameValid</span><span class="op" id="3503319">(</span><span class="ident" id="3503320">name</span><span class="op" id="3503324">)</span>&nbsp;<span class="op" id="3503326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503344">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503349">if</span>&nbsp;<span class="ident" id="3503352">filter</span>&nbsp;<span class="op" id="3503359">!=</span>&nbsp;<span class="string" id="3503362">&#34;&#34;</span>&nbsp;<span class="op" id="3503365">&amp;&amp;</span>&nbsp;<span class="ident" id="3503368">filter</span>&nbsp;<span class="op" id="3503375">!=</span>&nbsp;<span class="ident" id="3503378">name</span>&nbsp;<span class="op" id="3503383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503389">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503406">val</span><span class="op" id="3503409">,</span>&nbsp;<span class="ident" id="3503411">success</span>&nbsp;<span class="op" id="3503419">:=</span>&nbsp;<span class="ident" id="3503422">parseCookieValue</span><span class="op" id="3503438">(</span><span class="ident" id="3503439">val</span><span class="op" id="3503442">,</span>&nbsp;<span class="ident" id="3503444">true</span><span class="op" id="3503448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503453">if</span>&nbsp;<span class="op" id="3503456">!</span><span class="ident" id="3503457">success</span>&nbsp;<span class="op" id="3503465">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503471">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503488">cookies</span>&nbsp;<span class="op" id="3503496">=</span>&nbsp;<span class="builtinfunc" id="3503498">append</span><span class="op" id="3503504">(</span><span class="ident" id="3503505">cookies</span><span class="op" id="3503512">,</span>&nbsp;<span class="op" id="3503514">&amp;</span><span class="ident" id="3503515">Cookie</span><span class="op" id="3503521">{</span><span class="ident" id="3503522">Name</span><span class="op" id="3503526">:</span>&nbsp;<span class="ident" id="3503528">name</span><span class="op" id="3503532">,</span>&nbsp;<span class="ident" id="3503534">Value</span><span class="op" id="3503539">:</span>&nbsp;<span class="ident" id="3503541">val</span><span class="op" id="3503544">}</span><span class="op" id="3503545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3503550">parsedPairs</span><span class="op" id="3503561">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503566">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503572">return</span>&nbsp;<span class="ident" id="3503579">cookies</span><br>
<span class="lineno"></span><span class="op" id="3503587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3503590">//&nbsp;validCookieDomain&nbsp;returns&nbsp;wheter&nbsp;v&nbsp;is&nbsp;a&nbsp;valid&nbsp;cookie&nbsp;domain-value.</span><br>
<span class="lineno">220</span><span class="keyword" id="3503660">func</span>&nbsp;<span class="ident" id="3503665">validCookieDomain</span><span class="op" id="3503682">(</span><span class="ident" id="3503683">v</span>&nbsp;<span class="builtintype" id="3503685">string</span><span class="op" id="3503691">)</span>&nbsp;<span class="builtintype" id="3503693">bool</span>&nbsp;<span class="op" id="3503698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503701">if</span>&nbsp;<span class="ident" id="3503704">isCookieDomainName</span><span class="op" id="3503722">(</span><span class="ident" id="3503723">v</span><span class="op" id="3503724">)</span>&nbsp;<span class="op" id="3503726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503730">return</span>&nbsp;<span class="ident" id="3503737">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503746">if</span>&nbsp;<span class="ident" id="3503749">net</span><span class="op" id="3503752">.</span><span class="ident" id="3503753">ParseIP</span><span class="op" id="3503760">(</span><span class="ident" id="3503761">v</span><span class="op" id="3503762">)</span>&nbsp;<span class="op" id="3503764">!=</span>&nbsp;<span class="ident" id="3503767">nil</span>&nbsp;<span class="op" id="3503771">&amp;&amp;</span>&nbsp;<span class="op" id="3503774">!</span><span class="ident" id="3503775">strings</span><span class="op" id="3503782">.</span><span class="ident" id="3503783">Contains</span><span class="op" id="3503791">(</span><span class="ident" id="3503792">v</span><span class="op" id="3503793">,</span>&nbsp;<span class="string" id="3503795">&#34;:&#34;</span><span class="op" id="3503798">)</span>&nbsp;<span class="op" id="3503800">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503804">return</span>&nbsp;<span class="ident" id="3503811">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3503817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3503820">return</span>&nbsp;<span class="ident" id="3503827">false</span><br>
<span class="lineno"></span><span class="op" id="3503833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="3503836">//&nbsp;isCookieDomainName&nbsp;returns&nbsp;whether&nbsp;s&nbsp;is&nbsp;a&nbsp;valid&nbsp;domain&nbsp;name&nbsp;or&nbsp;a&nbsp;valid</span><br>
<span class="lineno"></span><span class="comment" id="3503910">//&nbsp;domain&nbsp;name&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot&nbsp;&#39;.&#39;.&nbsp;&nbsp;It&nbsp;is&nbsp;almost&nbsp;a&nbsp;direct&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3503980">//&nbsp;package&nbsp;net&#39;s&nbsp;isDomainName.</span><br>
<span class="lineno"></span><span class="keyword" id="3504011">func</span>&nbsp;<span class="ident" id="3504016">isCookieDomainName</span><span class="op" id="3504034">(</span><span class="ident" id="3504035">s</span>&nbsp;<span class="builtintype" id="3504037">string</span><span class="op" id="3504043">)</span>&nbsp;<span class="builtintype" id="3504045">bool</span>&nbsp;<span class="op" id="3504050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504053">if</span>&nbsp;<span class="builtinfunc" id="3504056">len</span><span class="op" id="3504059">(</span><span class="ident" id="3504060">s</span><span class="op" id="3504061">)</span>&nbsp;<span class="op" id="3504063">==</span>&nbsp;<span class="num" id="3504066">0</span>&nbsp;<span class="op" id="3504068">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504072">return</span>&nbsp;<span class="ident" id="3504079">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504089">if</span>&nbsp;<span class="builtinfunc" id="3504092">len</span><span class="op" id="3504095">(</span><span class="ident" id="3504096">s</span><span class="op" id="3504097">)</span>&nbsp;<span class="op" id="3504099">&gt;</span>&nbsp;<span class="num" id="3504101">255</span>&nbsp;<span class="op" id="3504105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504109">return</span>&nbsp;<span class="ident" id="3504116">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504123">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504127">if</span>&nbsp;<span class="ident" id="3504130">s</span><span class="op" id="3504131">[</span><span class="num" id="3504132">0</span><span class="op" id="3504133">]</span>&nbsp;<span class="op" id="3504135">==</span>&nbsp;<span class="string" id="3504138">&#39;.&#39;</span>&nbsp;<span class="op" id="3504142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3504146">//&nbsp;A&nbsp;cookie&nbsp;a&nbsp;domain&nbsp;attribute&nbsp;may&nbsp;start&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504209">s</span>&nbsp;<span class="op" id="3504211">=</span>&nbsp;<span class="ident" id="3504213">s</span><span class="op" id="3504214">[</span><span class="num" id="3504215">1</span><span class="op" id="3504216">:</span><span class="op" id="3504217">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504220">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504223">last</span>&nbsp;<span class="op" id="3504228">:=</span>&nbsp;<span class="builtintype" id="3504231">byte</span><span class="op" id="3504235">(</span><span class="string" id="3504236">&#39;.&#39;</span><span class="op" id="3504239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504242">ok</span>&nbsp;<span class="op" id="3504245">:=</span>&nbsp;<span class="ident" id="3504248">false</span>&nbsp;<span class="comment" id="3504254">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504287">partlen</span>&nbsp;<span class="op" id="3504295">:=</span>&nbsp;<span class="num" id="3504298">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504301">for</span>&nbsp;<span class="ident" id="3504305">i</span>&nbsp;<span class="op" id="3504307">:=</span>&nbsp;<span class="num" id="3504310">0</span><span class="op" id="3504311">;</span>&nbsp;<span class="ident" id="3504313">i</span>&nbsp;<span class="op" id="3504315">&lt;</span>&nbsp;<span class="builtinfunc" id="3504317">len</span><span class="op" id="3504320">(</span><span class="ident" id="3504321">s</span><span class="op" id="3504322">)</span><span class="op" id="3504323">;</span>&nbsp;<span class="ident" id="3504325">i</span><span class="op" id="3504326">++</span>&nbsp;<span class="op" id="3504329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504333">c</span>&nbsp;<span class="op" id="3504335">:=</span>&nbsp;<span class="ident" id="3504338">s</span><span class="op" id="3504339">[</span><span class="ident" id="3504340">i</span><span class="op" id="3504341">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504345">switch</span>&nbsp;<span class="op" id="3504352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504356">default</span><span class="op" id="3504363">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504368">return</span>&nbsp;<span class="ident" id="3504375">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504383">case</span>&nbsp;<span class="string" id="3504388">&#39;a&#39;</span>&nbsp;<span class="op" id="3504392">&lt;=</span>&nbsp;<span class="ident" id="3504395">c</span>&nbsp;<span class="op" id="3504397">&amp;&amp;</span>&nbsp;<span class="ident" id="3504400">c</span>&nbsp;<span class="op" id="3504402">&lt;=</span>&nbsp;<span class="string" id="3504405">&#39;z&#39;</span>&nbsp;<span class="op" id="3504409">||</span>&nbsp;<span class="string" id="3504412">&#39;A&#39;</span>&nbsp;<span class="op" id="3504416">&lt;=</span>&nbsp;<span class="ident" id="3504419">c</span>&nbsp;<span class="op" id="3504421">&amp;&amp;</span>&nbsp;<span class="ident" id="3504424">c</span>&nbsp;<span class="op" id="3504426">&lt;=</span>&nbsp;<span class="string" id="3504429">&#39;Z&#39;</span><span class="op" id="3504432">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3504437">//&nbsp;No&nbsp;&#39;_&#39;&nbsp;allowed&nbsp;here&nbsp;(in&nbsp;contrast&nbsp;to&nbsp;package&nbsp;net).</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504493">ok</span>&nbsp;<span class="op" id="3504496">=</span>&nbsp;<span class="ident" id="3504498">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504506">partlen</span><span class="op" id="3504513">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504518">case</span>&nbsp;<span class="string" id="3504523">&#39;0&#39;</span>&nbsp;<span class="op" id="3504527">&lt;=</span>&nbsp;<span class="ident" id="3504530">c</span>&nbsp;<span class="op" id="3504532">&amp;&amp;</span>&nbsp;<span class="ident" id="3504535">c</span>&nbsp;<span class="op" id="3504537">&lt;=</span>&nbsp;<span class="string" id="3504540">&#39;9&#39;</span><span class="op" id="3504543">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3504548">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504559">partlen</span><span class="op" id="3504566">++</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504571">case</span>&nbsp;<span class="ident" id="3504576">c</span>&nbsp;<span class="op" id="3504578">==</span>&nbsp;<span class="string" id="3504581">&#39;-&#39;</span><span class="op" id="3504584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3504589">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504627">if</span>&nbsp;<span class="ident" id="3504630">last</span>&nbsp;<span class="op" id="3504635">==</span>&nbsp;<span class="string" id="3504638">&#39;.&#39;</span>&nbsp;<span class="op" id="3504642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504648">return</span>&nbsp;<span class="ident" id="3504655">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504664">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504669">partlen</span><span class="op" id="3504676">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504681">case</span>&nbsp;<span class="ident" id="3504686">c</span>&nbsp;<span class="op" id="3504688">==</span>&nbsp;<span class="string" id="3504691">&#39;.&#39;</span><span class="op" id="3504694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3504699">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504742">if</span>&nbsp;<span class="ident" id="3504745">last</span>&nbsp;<span class="op" id="3504750">==</span>&nbsp;<span class="string" id="3504753">&#39;.&#39;</span>&nbsp;<span class="op" id="3504757">||</span>&nbsp;<span class="ident" id="3504760">last</span>&nbsp;<span class="op" id="3504765">==</span>&nbsp;<span class="string" id="3504768">&#39;-&#39;</span>&nbsp;<span class="op" id="3504772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504778">return</span>&nbsp;<span class="ident" id="3504785">false</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504799">if</span>&nbsp;<span class="ident" id="3504802">partlen</span>&nbsp;<span class="op" id="3504810">&gt;</span>&nbsp;<span class="num" id="3504812">63</span>&nbsp;<span class="op" id="3504815">||</span>&nbsp;<span class="ident" id="3504818">partlen</span>&nbsp;<span class="op" id="3504826">==</span>&nbsp;<span class="num" id="3504829">0</span>&nbsp;<span class="op" id="3504831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504837">return</span>&nbsp;<span class="ident" id="3504844">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504858">partlen</span>&nbsp;<span class="op" id="3504866">=</span>&nbsp;<span class="num" id="3504868">0</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3504876">last</span>&nbsp;<span class="op" id="3504881">=</span>&nbsp;<span class="ident" id="3504883">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504889">if</span>&nbsp;<span class="ident" id="3504892">last</span>&nbsp;<span class="op" id="3504897">==</span>&nbsp;<span class="string" id="3504900">&#39;-&#39;</span>&nbsp;<span class="op" id="3504904">||</span>&nbsp;<span class="ident" id="3504907">partlen</span>&nbsp;<span class="op" id="3504915">&gt;</span>&nbsp;<span class="num" id="3504917">63</span>&nbsp;<span class="op" id="3504920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504924">return</span>&nbsp;<span class="ident" id="3504931">false</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3504938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3504942">return</span>&nbsp;<span class="ident" id="3504949">ok</span><br>
<span class="lineno"></span><span class="op" id="3504952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="3504955">var</span>&nbsp;<span class="ident" id="3504959">cookieNameSanitizer</span>&nbsp;<span class="op" id="3504979">=</span>&nbsp;<span class="ident" id="3504981">strings</span><span class="op" id="3504988">.</span><span class="ident" id="3504989">NewReplacer</span><span class="op" id="3505000">(</span><span class="string" id="3505001">&#34;\n&#34;</span><span class="op" id="3505005">,</span>&nbsp;<span class="string" id="3505007">&#34;-&#34;</span><span class="op" id="3505010">,</span>&nbsp;<span class="string" id="3505012">&#34;\r&#34;</span><span class="op" id="3505016">,</span>&nbsp;<span class="string" id="3505018">&#34;-&#34;</span><span class="op" id="3505021">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3505024">func</span>&nbsp;<span class="ident" id="3505029">sanitizeCookieName</span><span class="op" id="3505047">(</span><span class="ident" id="3505048">n</span>&nbsp;<span class="builtintype" id="3505050">string</span><span class="op" id="3505056">)</span>&nbsp;<span class="builtintype" id="3505058">string</span>&nbsp;<span class="op" id="3505065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505068">return</span>&nbsp;<span class="ident" id="3505075">cookieNameSanitizer</span><span class="op" id="3505094">.</span><span class="ident" id="3505095">Replace</span><span class="op" id="3505102">(</span><span class="ident" id="3505103">n</span><span class="op" id="3505104">)</span><br>
<span class="lineno"></span><span class="op" id="3505106">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="3505109">//&nbsp;http://tools.ietf.org/html/rfc6265#section-4.1.1</span><br>
<span class="lineno"></span><span class="comment" id="3505161">//&nbsp;cookie-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;*cookie-octet&nbsp;/&nbsp;(&nbsp;DQUOTE&nbsp;*cookie-octet&nbsp;DQUOTE&nbsp;)</span><br>
<span class="lineno"></span><span class="comment" id="3505232">//&nbsp;cookie-octet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;%x21&nbsp;/&nbsp;%x23-2B&nbsp;/&nbsp;%x2D-3A&nbsp;/&nbsp;%x3C-5B&nbsp;/&nbsp;%x5D-7E</span><br>
<span class="lineno"></span><span class="comment" id="3505300">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;US-ASCII&nbsp;characters&nbsp;excluding&nbsp;CTLs,</span><br>
<span class="lineno">295</span><span class="comment" id="3505351">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;whitespace&nbsp;DQUOTE,&nbsp;comma,&nbsp;semicolon,</span><br>
<span class="lineno"></span><span class="comment" id="3505403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;and&nbsp;backslash</span><br>
<span class="lineno"></span><span class="comment" id="3505432">//&nbsp;We&nbsp;loosen&nbsp;this&nbsp;as&nbsp;spaces&nbsp;and&nbsp;commas&nbsp;are&nbsp;common&nbsp;in&nbsp;cookie&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="3505499">//&nbsp;but&nbsp;we&nbsp;produce&nbsp;a&nbsp;quoted&nbsp;cookie-value&nbsp;in&nbsp;when&nbsp;value&nbsp;starts&nbsp;or&nbsp;ends</span><br>
<span class="lineno"></span><span class="comment" id="3505568">//&nbsp;with&nbsp;a&nbsp;comma&nbsp;or&nbsp;space.</span><br>
<span class="lineno">300</span><span class="comment" id="3505594">//&nbsp;See&nbsp;http://golang.org/issue/7243&nbsp;for&nbsp;the&nbsp;discussion.</span><br>
<span class="lineno"></span><span class="keyword" id="3505650">func</span>&nbsp;<span class="ident" id="3505655">sanitizeCookieValue</span><span class="op" id="3505674">(</span><span class="ident" id="3505675">v</span>&nbsp;<span class="builtintype" id="3505677">string</span><span class="op" id="3505683">)</span>&nbsp;<span class="builtintype" id="3505685">string</span>&nbsp;<span class="op" id="3505692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3505695">v</span>&nbsp;<span class="op" id="3505697">=</span>&nbsp;<span class="ident" id="3505699">sanitizeOrWarn</span><span class="op" id="3505713">(</span><span class="string" id="3505714">&#34;Cookie.Value&#34;</span><span class="op" id="3505728">,</span>&nbsp;<span class="ident" id="3505730">validCookieValueByte</span><span class="op" id="3505750">,</span>&nbsp;<span class="ident" id="3505752">v</span><span class="op" id="3505753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505756">if</span>&nbsp;<span class="builtinfunc" id="3505759">len</span><span class="op" id="3505762">(</span><span class="ident" id="3505763">v</span><span class="op" id="3505764">)</span>&nbsp;<span class="op" id="3505766">==</span>&nbsp;<span class="num" id="3505769">0</span>&nbsp;<span class="op" id="3505771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505775">return</span>&nbsp;<span class="ident" id="3505782">v</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3505785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505788">if</span>&nbsp;<span class="ident" id="3505791">v</span><span class="op" id="3505792">[</span><span class="num" id="3505793">0</span><span class="op" id="3505794">]</span>&nbsp;<span class="op" id="3505796">==</span>&nbsp;<span class="string" id="3505799">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3505803">||</span>&nbsp;<span class="ident" id="3505806">v</span><span class="op" id="3505807">[</span><span class="num" id="3505808">0</span><span class="op" id="3505809">]</span>&nbsp;<span class="op" id="3505811">==</span>&nbsp;<span class="string" id="3505814">&#39;,&#39;</span>&nbsp;<span class="op" id="3505818">||</span>&nbsp;<span class="ident" id="3505821">v</span><span class="op" id="3505822">[</span><span class="builtinfunc" id="3505823">len</span><span class="op" id="3505826">(</span><span class="ident" id="3505827">v</span><span class="op" id="3505828">)</span><span class="op" id="3505829">-</span><span class="num" id="3505830">1</span><span class="op" id="3505831">]</span>&nbsp;<span class="op" id="3505833">==</span>&nbsp;<span class="string" id="3505836">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3505840">||</span>&nbsp;<span class="ident" id="3505843">v</span><span class="op" id="3505844">[</span><span class="builtinfunc" id="3505845">len</span><span class="op" id="3505848">(</span><span class="ident" id="3505849">v</span><span class="op" id="3505850">)</span><span class="op" id="3505851">-</span><span class="num" id="3505852">1</span><span class="op" id="3505853">]</span>&nbsp;<span class="op" id="3505855">==</span>&nbsp;<span class="string" id="3505858">&#39;,&#39;</span>&nbsp;<span class="op" id="3505862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505866">return</span>&nbsp;<span class="string" id="3505873">`&#34;`</span>&nbsp;<span class="op" id="3505877">+</span>&nbsp;<span class="ident" id="3505879">v</span>&nbsp;<span class="op" id="3505881">+</span>&nbsp;<span class="string" id="3505883">`&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3505888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505891">return</span>&nbsp;<span class="ident" id="3505898">v</span><br>
<span class="lineno">310</span><span class="op" id="3505900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3505903">func</span>&nbsp;<span class="ident" id="3505908">validCookieValueByte</span><span class="op" id="3505928">(</span><span class="ident" id="3505929">b</span>&nbsp;<span class="builtintype" id="3505931">byte</span><span class="op" id="3505935">)</span>&nbsp;<span class="builtintype" id="3505937">bool</span>&nbsp;<span class="op" id="3505942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3505945">return</span>&nbsp;<span class="num" id="3505952">0x20</span>&nbsp;<span class="op" id="3505957">&lt;=</span>&nbsp;<span class="ident" id="3505960">b</span>&nbsp;<span class="op" id="3505962">&amp;&amp;</span>&nbsp;<span class="ident" id="3505965">b</span>&nbsp;<span class="op" id="3505967">&lt;</span>&nbsp;<span class="num" id="3505969">0x7f</span>&nbsp;<span class="op" id="3505974">&amp;&amp;</span>&nbsp;<span class="ident" id="3505977">b</span>&nbsp;<span class="op" id="3505979">!=</span>&nbsp;<span class="string" id="3505982">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3505986">&amp;&amp;</span>&nbsp;<span class="ident" id="3505989">b</span>&nbsp;<span class="op" id="3505991">!=</span>&nbsp;<span class="string" id="3505994">&#39;;&#39;</span>&nbsp;<span class="op" id="3505998">&amp;&amp;</span>&nbsp;<span class="ident" id="3506001">b</span>&nbsp;<span class="op" id="3506003">!=</span>&nbsp;<span class="string" id="3506006">&#39;\\&#39;</span><br>
<span class="lineno"></span><span class="op" id="3506011">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3506014">//&nbsp;path-av&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&#34;Path=&#34;&nbsp;path-value</span><br>
<span class="lineno"></span><span class="comment" id="3506056">//&nbsp;path-value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;any&nbsp;CHAR&nbsp;except&nbsp;CTLs&nbsp;or&nbsp;&#34;;&#34;&gt;</span><br>
<span class="lineno"></span><span class="keyword" id="3506109">func</span>&nbsp;<span class="ident" id="3506114">sanitizeCookiePath</span><span class="op" id="3506132">(</span><span class="ident" id="3506133">v</span>&nbsp;<span class="builtintype" id="3506135">string</span><span class="op" id="3506141">)</span>&nbsp;<span class="builtintype" id="3506143">string</span>&nbsp;<span class="op" id="3506150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506153">return</span>&nbsp;<span class="ident" id="3506160">sanitizeOrWarn</span><span class="op" id="3506174">(</span><span class="string" id="3506175">&#34;Cookie.Path&#34;</span><span class="op" id="3506188">,</span>&nbsp;<span class="ident" id="3506190">validCookiePathByte</span><span class="op" id="3506209">,</span>&nbsp;<span class="ident" id="3506211">v</span><span class="op" id="3506212">)</span><br>
<span class="lineno">320</span><span class="op" id="3506214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3506217">func</span>&nbsp;<span class="ident" id="3506222">validCookiePathByte</span><span class="op" id="3506241">(</span><span class="ident" id="3506242">b</span>&nbsp;<span class="builtintype" id="3506244">byte</span><span class="op" id="3506248">)</span>&nbsp;<span class="builtintype" id="3506250">bool</span>&nbsp;<span class="op" id="3506255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506258">return</span>&nbsp;<span class="num" id="3506265">0x20</span>&nbsp;<span class="op" id="3506270">&lt;=</span>&nbsp;<span class="ident" id="3506273">b</span>&nbsp;<span class="op" id="3506275">&amp;&amp;</span>&nbsp;<span class="ident" id="3506278">b</span>&nbsp;<span class="op" id="3506280">&lt;</span>&nbsp;<span class="num" id="3506282">0x7f</span>&nbsp;<span class="op" id="3506287">&amp;&amp;</span>&nbsp;<span class="ident" id="3506290">b</span>&nbsp;<span class="op" id="3506292">!=</span>&nbsp;<span class="string" id="3506295">&#39;;&#39;</span><br>
<span class="lineno"></span><span class="op" id="3506299">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="3506302">func</span>&nbsp;<span class="ident" id="3506307">sanitizeOrWarn</span><span class="op" id="3506321">(</span><span class="ident" id="3506322">fieldName</span>&nbsp;<span class="builtintype" id="3506332">string</span><span class="op" id="3506338">,</span>&nbsp;<span class="ident" id="3506340">valid</span>&nbsp;<span class="keyword" id="3506346">func</span><span class="op" id="3506350">(</span><span class="builtintype" id="3506351">byte</span><span class="op" id="3506355">)</span>&nbsp;<span class="builtintype" id="3506357">bool</span><span class="op" id="3506361">,</span>&nbsp;<span class="ident" id="3506363">v</span>&nbsp;<span class="builtintype" id="3506365">string</span><span class="op" id="3506371">)</span>&nbsp;<span class="builtintype" id="3506373">string</span>&nbsp;<span class="op" id="3506380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506383">ok</span>&nbsp;<span class="op" id="3506386">:=</span>&nbsp;<span class="ident" id="3506389">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506395">for</span>&nbsp;<span class="ident" id="3506399">i</span>&nbsp;<span class="op" id="3506401">:=</span>&nbsp;<span class="num" id="3506404">0</span><span class="op" id="3506405">;</span>&nbsp;<span class="ident" id="3506407">i</span>&nbsp;<span class="op" id="3506409">&lt;</span>&nbsp;<span class="builtinfunc" id="3506411">len</span><span class="op" id="3506414">(</span><span class="ident" id="3506415">v</span><span class="op" id="3506416">)</span><span class="op" id="3506417">;</span>&nbsp;<span class="ident" id="3506419">i</span><span class="op" id="3506420">++</span>&nbsp;<span class="op" id="3506423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506427">if</span>&nbsp;<span class="ident" id="3506430">valid</span><span class="op" id="3506435">(</span><span class="ident" id="3506436">v</span><span class="op" id="3506437">[</span><span class="ident" id="3506438">i</span><span class="op" id="3506439">]</span><span class="op" id="3506440">)</span>&nbsp;<span class="op" id="3506442">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506447">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506462">log</span><span class="op" id="3506465">.</span><span class="ident" id="3506466">Printf</span><span class="op" id="3506472">(</span><span class="string" id="3506473">&#34;net/http:&nbsp;invalid&nbsp;byte&nbsp;%q&nbsp;in&nbsp;%s;&nbsp;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="3506530">,</span>&nbsp;<span class="ident" id="3506532">v</span><span class="op" id="3506533">[</span><span class="ident" id="3506534">i</span><span class="op" id="3506535">]</span><span class="op" id="3506536">,</span>&nbsp;<span class="ident" id="3506538">fieldName</span><span class="op" id="3506547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506551">ok</span>&nbsp;<span class="op" id="3506554">=</span>&nbsp;<span class="ident" id="3506556">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506564">break</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506574">if</span>&nbsp;<span class="ident" id="3506577">ok</span>&nbsp;<span class="op" id="3506580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506584">return</span>&nbsp;<span class="ident" id="3506591">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506597">buf</span>&nbsp;<span class="op" id="3506601">:=</span>&nbsp;<span class="builtinfunc" id="3506604">make</span><span class="op" id="3506608">(</span><span class="op" id="3506609">[</span><span class="op" id="3506610">]</span><span class="builtintype" id="3506611">byte</span><span class="op" id="3506615">,</span>&nbsp;<span class="num" id="3506617">0</span><span class="op" id="3506618">,</span>&nbsp;<span class="builtinfunc" id="3506620">len</span><span class="op" id="3506623">(</span><span class="ident" id="3506624">v</span><span class="op" id="3506625">)</span><span class="op" id="3506626">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506629">for</span>&nbsp;<span class="ident" id="3506633">i</span>&nbsp;<span class="op" id="3506635">:=</span>&nbsp;<span class="num" id="3506638">0</span><span class="op" id="3506639">;</span>&nbsp;<span class="ident" id="3506641">i</span>&nbsp;<span class="op" id="3506643">&lt;</span>&nbsp;<span class="builtinfunc" id="3506645">len</span><span class="op" id="3506648">(</span><span class="ident" id="3506649">v</span><span class="op" id="3506650">)</span><span class="op" id="3506651">;</span>&nbsp;<span class="ident" id="3506653">i</span><span class="op" id="3506654">++</span>&nbsp;<span class="op" id="3506657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506661">if</span>&nbsp;<span class="ident" id="3506664">b</span>&nbsp;<span class="op" id="3506666">:=</span>&nbsp;<span class="ident" id="3506669">v</span><span class="op" id="3506670">[</span><span class="ident" id="3506671">i</span><span class="op" id="3506672">]</span><span class="op" id="3506673">;</span>&nbsp;<span class="ident" id="3506675">valid</span><span class="op" id="3506680">(</span><span class="ident" id="3506681">b</span><span class="op" id="3506682">)</span>&nbsp;<span class="op" id="3506684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506689">buf</span>&nbsp;<span class="op" id="3506693">=</span>&nbsp;<span class="builtinfunc" id="3506695">append</span><span class="op" id="3506701">(</span><span class="ident" id="3506702">buf</span><span class="op" id="3506705">,</span>&nbsp;<span class="ident" id="3506707">b</span><span class="op" id="3506708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506715">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506718">return</span>&nbsp;<span class="builtintype" id="3506725">string</span><span class="op" id="3506731">(</span><span class="ident" id="3506732">buf</span><span class="op" id="3506735">)</span><br>
<span class="lineno"></span><span class="op" id="3506737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3506740">func</span>&nbsp;<span class="ident" id="3506745">parseCookieValue</span><span class="op" id="3506761">(</span><span class="ident" id="3506762">raw</span>&nbsp;<span class="builtintype" id="3506766">string</span><span class="op" id="3506772">,</span>&nbsp;<span class="ident" id="3506774">allowDoubleQuote</span>&nbsp;<span class="builtintype" id="3506791">bool</span><span class="op" id="3506795">)</span>&nbsp;<span class="op" id="3506797">(</span><span class="builtintype" id="3506798">string</span><span class="op" id="3506804">,</span>&nbsp;<span class="builtintype" id="3506806">bool</span><span class="op" id="3506810">)</span>&nbsp;<span class="op" id="3506812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3506815">//&nbsp;Strip&nbsp;the&nbsp;quotes,&nbsp;if&nbsp;present.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506849">if</span>&nbsp;<span class="ident" id="3506852">allowDoubleQuote</span>&nbsp;<span class="op" id="3506869">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3506872">len</span><span class="op" id="3506875">(</span><span class="ident" id="3506876">raw</span><span class="op" id="3506879">)</span>&nbsp;<span class="op" id="3506881">&gt;</span>&nbsp;<span class="num" id="3506883">1</span>&nbsp;<span class="op" id="3506885">&amp;&amp;</span>&nbsp;<span class="ident" id="3506888">raw</span><span class="op" id="3506891">[</span><span class="num" id="3506892">0</span><span class="op" id="3506893">]</span>&nbsp;<span class="op" id="3506895">==</span>&nbsp;<span class="string" id="3506898">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3506902">&amp;&amp;</span>&nbsp;<span class="ident" id="3506905">raw</span><span class="op" id="3506908">[</span><span class="builtinfunc" id="3506909">len</span><span class="op" id="3506912">(</span><span class="ident" id="3506913">raw</span><span class="op" id="3506916">)</span><span class="op" id="3506917">-</span><span class="num" id="3506918">1</span><span class="op" id="3506919">]</span>&nbsp;<span class="op" id="3506921">==</span>&nbsp;<span class="string" id="3506924">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="3506928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3506932">raw</span>&nbsp;<span class="op" id="3506936">=</span>&nbsp;<span class="ident" id="3506938">raw</span><span class="op" id="3506941">[</span><span class="num" id="3506942">1</span>&nbsp;<span class="op" id="3506944">:</span>&nbsp;<span class="builtinfunc" id="3506946">len</span><span class="op" id="3506949">(</span><span class="ident" id="3506950">raw</span><span class="op" id="3506953">)</span><span class="op" id="3506954">-</span><span class="num" id="3506955">1</span><span class="op" id="3506956">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3506959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506962">for</span>&nbsp;<span class="ident" id="3506966">i</span>&nbsp;<span class="op" id="3506968">:=</span>&nbsp;<span class="num" id="3506971">0</span><span class="op" id="3506972">;</span>&nbsp;<span class="ident" id="3506974">i</span>&nbsp;<span class="op" id="3506976">&lt;</span>&nbsp;<span class="builtinfunc" id="3506978">len</span><span class="op" id="3506981">(</span><span class="ident" id="3506982">raw</span><span class="op" id="3506985">)</span><span class="op" id="3506986">;</span>&nbsp;<span class="ident" id="3506988">i</span><span class="op" id="3506989">++</span>&nbsp;<span class="op" id="3506992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3506996">if</span>&nbsp;<span class="op" id="3506999">!</span><span class="ident" id="3507000">validCookieValueByte</span><span class="op" id="3507020">(</span><span class="ident" id="3507021">raw</span><span class="op" id="3507024">[</span><span class="ident" id="3507025">i</span><span class="op" id="3507026">]</span><span class="op" id="3507027">)</span>&nbsp;<span class="op" id="3507029">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507034">return</span>&nbsp;<span class="string" id="3507041">&#34;&#34;</span><span class="op" id="3507043">,</span>&nbsp;<span class="ident" id="3507045">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3507053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3507056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507059">return</span>&nbsp;<span class="ident" id="3507066">raw</span><span class="op" id="3507069">,</span>&nbsp;<span class="ident" id="3507071">true</span><br>
<span class="lineno"></span><span class="op" id="3507076">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="3507079">func</span>&nbsp;<span class="ident" id="3507084">isCookieNameValid</span><span class="op" id="3507101">(</span><span class="ident" id="3507102">raw</span>&nbsp;<span class="builtintype" id="3507106">string</span><span class="op" id="3507112">)</span>&nbsp;<span class="builtintype" id="3507114">bool</span>&nbsp;<span class="op" id="3507119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3507122">return</span>&nbsp;<span class="ident" id="3507129">strings</span><span class="op" id="3507136">.</span><span class="ident" id="3507137">IndexFunc</span><span class="op" id="3507146">(</span><span class="ident" id="3507147">raw</span><span class="op" id="3507150">,</span>&nbsp;<span class="ident" id="3507152">isNotToken</span><span class="op" id="3507162">)</span>&nbsp;<span class="op" id="3507164">&lt;</span>&nbsp;<span class="num" id="3507166">0</span><br>
<span class="lineno"></span><span class="op" id="3507168">}</span>
</div>
</body>
</html>
