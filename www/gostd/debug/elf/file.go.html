<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/elf</h2>
<ul>
<li><a href="/gostd/debug/elf/elf.go.html">elf.go</a></li>
<li><a href="/gostd/debug/elf/elf_test.go.html">elf_test.go</a></li>
<li><a href="/gostd/debug/elf/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/elf/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/elf/symbols_test.go.html">symbols_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5729334">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5729390">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5729444">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5729495">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5729549">package</span>&nbsp;<span class="ident" id="5729557">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5729562">import</span>&nbsp;<span class="op" id="5729569">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729572">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729581">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729596">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729615">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729625">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729632">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5729638">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="5729643">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5729646">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="5729679">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5729718">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="5729765">type</span>&nbsp;<span class="ident" id="5729770">FileHeader</span>&nbsp;<span class="keyword" id="5729781">struct</span>&nbsp;<span class="op" id="5729788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729791">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729802">Class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729809">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729820">Data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729826">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729837">Version</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729846">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729857">OSABI</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729864">ABIVersion</span>&nbsp;<span class="builtintype" id="5729875">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729882">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="5729893">binary</span><span class="op" id="5729899">.</span><span class="ident" id="5729900">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729911">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729922">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729928">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729939">Machine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729948">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5729959">uint64</span><br>
<span class="lineno">35</span><span class="op" id="5729966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5729969">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5730008">type</span>&nbsp;<span class="ident" id="5730013">File</span>&nbsp;<span class="keyword" id="5730018">struct</span>&nbsp;<span class="op" id="5730025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730028">FileHeader</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730040">Sections</span>&nbsp;&nbsp;<span class="op" id="5730050">[</span><span class="op" id="5730051">]</span><span class="op" id="5730052">*</span><span class="ident" id="5730053">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730062">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730072">[</span><span class="op" id="5730073">]</span><span class="op" id="5730074">*</span><span class="ident" id="5730075">Prog</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730081">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730091">io</span><span class="op" id="5730093">.</span><span class="ident" id="5730094">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730102">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5730112">[</span><span class="op" id="5730113">]</span><span class="ident" id="5730114">verneed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730123">gnuVersym</span>&nbsp;<span class="op" id="5730133">[</span><span class="op" id="5730134">]</span><span class="builtintype" id="5730135">byte</span><br>
<span class="lineno">45</span><span class="op" id="5730140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5730143">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5730202">type</span>&nbsp;<span class="ident" id="5730207">SectionHeader</span>&nbsp;<span class="keyword" id="5730221">struct</span>&nbsp;<span class="op" id="5730228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730231">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5730241">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730249">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730259">SectionType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730272">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730282">SectionFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730295">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730305">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730313">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730323">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730331">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730341">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730349">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5730359">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730367">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5730377">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730385">Addralign</span>&nbsp;<span class="ident" id="5730395">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730403">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5730413">uint64</span><br>
<span class="lineno"></span><span class="op" id="5730420">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="5730423">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5730480">type</span>&nbsp;<span class="ident" id="5730485">Section</span>&nbsp;<span class="keyword" id="5730493">struct</span>&nbsp;<span class="op" id="5730500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730503">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730519">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730557">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730597">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730632">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730680">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5730730">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730754">io</span><span class="op" id="5730756">.</span><span class="ident" id="5730757">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730767">sr</span>&nbsp;<span class="op" id="5730770">*</span><span class="ident" id="5730771">io</span><span class="op" id="5730773">.</span><span class="ident" id="5730774">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5730788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="5730791">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5730850">func</span>&nbsp;<span class="op" id="5730855">(</span><span class="ident" id="5730856">s</span>&nbsp;<span class="op" id="5730858">*</span><span class="ident" id="5730859">Section</span><span class="op" id="5730866">)</span>&nbsp;<span class="ident" id="5730868">Data</span><span class="op" id="5730872">(</span><span class="op" id="5730873">)</span>&nbsp;<span class="op" id="5730875">(</span><span class="op" id="5730876">[</span><span class="op" id="5730877">]</span><span class="builtintype" id="5730878">byte</span><span class="op" id="5730882">,</span>&nbsp;<span class="builtintype" id="5730884">error</span><span class="op" id="5730889">)</span>&nbsp;<span class="op" id="5730891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730894">dat</span>&nbsp;<span class="op" id="5730898">:=</span>&nbsp;<span class="builtinfunc" id="5730901">make</span><span class="op" id="5730905">(</span><span class="op" id="5730906">[</span><span class="op" id="5730907">]</span><span class="builtintype" id="5730908">byte</span><span class="op" id="5730912">,</span>&nbsp;<span class="ident" id="5730914">s</span><span class="op" id="5730915">.</span><span class="ident" id="5730916">sr</span><span class="op" id="5730918">.</span><span class="ident" id="5730919">Size</span><span class="op" id="5730923">(</span><span class="op" id="5730924">)</span><span class="op" id="5730925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730928">n</span><span class="op" id="5730929">,</span>&nbsp;<span class="ident" id="5730931">err</span>&nbsp;<span class="op" id="5730935">:=</span>&nbsp;<span class="ident" id="5730938">s</span><span class="op" id="5730939">.</span><span class="ident" id="5730940">sr</span><span class="op" id="5730942">.</span><span class="ident" id="5730943">ReadAt</span><span class="op" id="5730949">(</span><span class="ident" id="5730950">dat</span><span class="op" id="5730953">,</span>&nbsp;<span class="num" id="5730955">0</span><span class="op" id="5730956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730959">if</span>&nbsp;<span class="ident" id="5730962">n</span>&nbsp;<span class="op" id="5730964">==</span>&nbsp;<span class="builtinfunc" id="5730967">len</span><span class="op" id="5730970">(</span><span class="ident" id="5730971">dat</span><span class="op" id="5730974">)</span>&nbsp;<span class="op" id="5730976">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5730980">err</span>&nbsp;<span class="op" id="5730984">=</span>&nbsp;<span class="builtintype" id="5730986">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5730991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5730994">return</span>&nbsp;<span class="ident" id="5731001">dat</span><span class="op" id="5731004">[</span><span class="num" id="5731005">0</span><span class="op" id="5731006">:</span><span class="ident" id="5731007">n</span><span class="op" id="5731008">]</span><span class="op" id="5731009">,</span>&nbsp;<span class="ident" id="5731011">err</span><br>
<span class="lineno"></span><span class="op" id="5731015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="5731018">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5731081">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="5731106">func</span>&nbsp;<span class="op" id="5731111">(</span><span class="ident" id="5731112">f</span>&nbsp;<span class="op" id="5731114">*</span><span class="ident" id="5731115">File</span><span class="op" id="5731119">)</span>&nbsp;<span class="ident" id="5731121">stringTable</span><span class="op" id="5731132">(</span><span class="ident" id="5731133">link</span>&nbsp;<span class="builtintype" id="5731138">uint32</span><span class="op" id="5731144">)</span>&nbsp;<span class="op" id="5731146">(</span><span class="op" id="5731147">[</span><span class="op" id="5731148">]</span><span class="builtintype" id="5731149">byte</span><span class="op" id="5731153">,</span>&nbsp;<span class="builtintype" id="5731155">error</span><span class="op" id="5731160">)</span>&nbsp;<span class="op" id="5731162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731165">if</span>&nbsp;<span class="ident" id="5731168">link</span>&nbsp;<span class="op" id="5731173">&lt;=</span>&nbsp;<span class="num" id="5731176">0</span>&nbsp;<span class="op" id="5731178">||</span>&nbsp;<span class="ident" id="5731181">link</span>&nbsp;<span class="op" id="5731186">&gt;=</span>&nbsp;<span class="builtintype" id="5731189">uint32</span><span class="op" id="5731195">(</span><span class="builtinfunc" id="5731196">len</span><span class="op" id="5731199">(</span><span class="ident" id="5731200">f</span><span class="op" id="5731201">.</span><span class="ident" id="5731202">Sections</span><span class="op" id="5731210">)</span><span class="op" id="5731211">)</span>&nbsp;<span class="op" id="5731213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731217">return</span>&nbsp;<span class="builtintype" id="5731224">nil</span><span class="op" id="5731227">,</span>&nbsp;<span class="ident" id="5731229">errors</span><span class="op" id="5731235">.</span><span class="ident" id="5731236">New</span><span class="op" id="5731239">(</span><span class="string" id="5731240">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="5731279">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5731282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5731285">return</span>&nbsp;<span class="ident" id="5731292">f</span><span class="op" id="5731293">.</span><span class="ident" id="5731294">Sections</span><span class="op" id="5731302">[</span><span class="ident" id="5731303">link</span><span class="op" id="5731307">]</span><span class="op" id="5731308">.</span><span class="ident" id="5731309">Data</span><span class="op" id="5731313">(</span><span class="op" id="5731314">)</span><br>
<span class="lineno"></span><span class="op" id="5731316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5731319">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="5731377">func</span>&nbsp;<span class="op" id="5731382">(</span><span class="ident" id="5731383">s</span>&nbsp;<span class="op" id="5731385">*</span><span class="ident" id="5731386">Section</span><span class="op" id="5731393">)</span>&nbsp;<span class="ident" id="5731395">Open</span><span class="op" id="5731399">(</span><span class="op" id="5731400">)</span>&nbsp;<span class="ident" id="5731402">io</span><span class="op" id="5731404">.</span><span class="ident" id="5731405">ReadSeeker</span>&nbsp;<span class="op" id="5731416">{</span>&nbsp;<span class="keyword" id="5731418">return</span>&nbsp;<span class="ident" id="5731425">io</span><span class="op" id="5731427">.</span><span class="ident" id="5731428">NewSectionReader</span><span class="op" id="5731444">(</span><span class="ident" id="5731445">s</span><span class="op" id="5731446">.</span><span class="ident" id="5731447">sr</span><span class="op" id="5731449">,</span>&nbsp;<span class="num" id="5731451">0</span><span class="op" id="5731452">,</span>&nbsp;<span class="num" id="5731454">1</span><span class="op" id="5731455">&lt;&lt;</span><span class="num" id="5731457">63</span><span class="op" id="5731459">-</span><span class="num" id="5731460">1</span><span class="op" id="5731461">)</span>&nbsp;<span class="op" id="5731463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5731466">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="5731522">type</span>&nbsp;<span class="ident" id="5731527">ProgHeader</span>&nbsp;<span class="keyword" id="5731538">struct</span>&nbsp;<span class="op" id="5731545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731548">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5731555">ProgType</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731565">Flags</span>&nbsp;&nbsp;<span class="ident" id="5731572">ProgFlag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731582">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731589">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731597">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="5731604">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731612">Paddr</span>&nbsp;&nbsp;<span class="ident" id="5731619">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731627">Filesz</span>&nbsp;<span class="ident" id="5731634">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731642">Memsz</span>&nbsp;&nbsp;<span class="ident" id="5731649">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731657">Align</span>&nbsp;&nbsp;<span class="ident" id="5731664">uint64</span><br>
<span class="lineno"></span><span class="op" id="5731671">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5731674">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="5731741">type</span>&nbsp;<span class="ident" id="5731746">Prog</span>&nbsp;<span class="keyword" id="5731751">struct</span>&nbsp;<span class="op" id="5731758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5731761">ProgHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731774">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731812">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731852">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731887">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731935">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5731985">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732009">io</span><span class="op" id="5732011">.</span><span class="ident" id="5732012">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732022">sr</span>&nbsp;<span class="op" id="5732025">*</span><span class="ident" id="5732026">io</span><span class="op" id="5732028">.</span><span class="ident" id="5732029">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5732043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5732046">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="5732109">func</span>&nbsp;<span class="op" id="5732114">(</span><span class="ident" id="5732115">p</span>&nbsp;<span class="op" id="5732117">*</span><span class="ident" id="5732118">Prog</span><span class="op" id="5732122">)</span>&nbsp;<span class="ident" id="5732124">Open</span><span class="op" id="5732128">(</span><span class="op" id="5732129">)</span>&nbsp;<span class="ident" id="5732131">io</span><span class="op" id="5732133">.</span><span class="ident" id="5732134">ReadSeeker</span>&nbsp;<span class="op" id="5732145">{</span>&nbsp;<span class="keyword" id="5732147">return</span>&nbsp;<span class="ident" id="5732154">io</span><span class="op" id="5732156">.</span><span class="ident" id="5732157">NewSectionReader</span><span class="op" id="5732173">(</span><span class="ident" id="5732174">p</span><span class="op" id="5732175">.</span><span class="ident" id="5732176">sr</span><span class="op" id="5732178">,</span>&nbsp;<span class="num" id="5732180">0</span><span class="op" id="5732181">,</span>&nbsp;<span class="num" id="5732183">1</span><span class="op" id="5732184">&lt;&lt;</span><span class="num" id="5732186">63</span><span class="op" id="5732188">-</span><span class="num" id="5732189">1</span><span class="op" id="5732190">)</span>&nbsp;<span class="op" id="5732192">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="5732195">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5732259">type</span>&nbsp;<span class="ident" id="5732264">Symbol</span>&nbsp;<span class="keyword" id="5732271">struct</span>&nbsp;<span class="op" id="5732278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732281">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5732293">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732301">Info</span><span class="op" id="5732305">,</span>&nbsp;<span class="ident" id="5732307">Other</span>&nbsp;<span class="builtintype" id="5732313">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732319">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732331">SectionIndex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732345">Value</span><span class="op" id="5732350">,</span>&nbsp;<span class="ident" id="5732352">Size</span>&nbsp;<span class="ident" id="5732357">uint64</span><br>
<span class="lineno"></span><span class="op" id="5732364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5732367">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5732389">type</span>&nbsp;<span class="ident" id="5732394">FormatError</span>&nbsp;<span class="keyword" id="5732406">struct</span>&nbsp;<span class="op" id="5732413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732416">off</span>&nbsp;<span class="ident" id="5732420">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732427">msg</span>&nbsp;<span class="builtintype" id="5732431">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732439">val</span>&nbsp;<span class="keyword" id="5732443">interface</span><span class="op" id="5732452">{</span><span class="op" id="5732453">}</span><br>
<span class="lineno"></span><span class="op" id="5732455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5732458">func</span>&nbsp;<span class="op" id="5732463">(</span><span class="ident" id="5732464">e</span>&nbsp;<span class="op" id="5732466">*</span><span class="ident" id="5732467">FormatError</span><span class="op" id="5732478">)</span>&nbsp;<span class="ident" id="5732480">Error</span><span class="op" id="5732485">(</span><span class="op" id="5732486">)</span>&nbsp;<span class="builtintype" id="5732488">string</span>&nbsp;<span class="op" id="5732495">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732498">msg</span>&nbsp;<span class="op" id="5732502">:=</span>&nbsp;<span class="ident" id="5732505">e</span><span class="op" id="5732506">.</span><span class="ident" id="5732507">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732512">if</span>&nbsp;<span class="ident" id="5732515">e</span><span class="op" id="5732516">.</span><span class="ident" id="5732517">val</span>&nbsp;<span class="op" id="5732521">!=</span>&nbsp;<span class="builtintype" id="5732524">nil</span>&nbsp;<span class="op" id="5732528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732532">msg</span>&nbsp;<span class="op" id="5732536">+=</span>&nbsp;<span class="ident" id="5732539">fmt</span><span class="op" id="5732542">.</span><span class="ident" id="5732543">Sprintf</span><span class="op" id="5732550">(</span><span class="string" id="5732551">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="5732559">,</span>&nbsp;<span class="ident" id="5732561">e</span><span class="op" id="5732562">.</span><span class="ident" id="5732563">val</span><span class="op" id="5732566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732572">msg</span>&nbsp;<span class="op" id="5732576">+=</span>&nbsp;<span class="ident" id="5732579">fmt</span><span class="op" id="5732582">.</span><span class="ident" id="5732583">Sprintf</span><span class="op" id="5732590">(</span><span class="string" id="5732591">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5732614">,</span>&nbsp;<span class="ident" id="5732616">e</span><span class="op" id="5732617">.</span><span class="ident" id="5732618">off</span><span class="op" id="5732621">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732624">return</span>&nbsp;<span class="ident" id="5732631">msg</span><br>
<span class="lineno"></span><span class="op" id="5732635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5732638">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5732723">func</span>&nbsp;<span class="ident" id="5732728">Open</span><span class="op" id="5732732">(</span><span class="ident" id="5732733">name</span>&nbsp;<span class="builtintype" id="5732738">string</span><span class="op" id="5732744">)</span>&nbsp;<span class="op" id="5732746">(</span><span class="op" id="5732747">*</span><span class="ident" id="5732748">File</span><span class="op" id="5732752">,</span>&nbsp;<span class="builtintype" id="5732754">error</span><span class="op" id="5732759">)</span>&nbsp;<span class="op" id="5732761">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732764">f</span><span class="op" id="5732765">,</span>&nbsp;<span class="ident" id="5732767">err</span>&nbsp;<span class="op" id="5732771">:=</span>&nbsp;<span class="ident" id="5732774">os</span><span class="op" id="5732776">.</span><span class="ident" id="5732777">Open</span><span class="op" id="5732781">(</span><span class="ident" id="5732782">name</span><span class="op" id="5732786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732789">if</span>&nbsp;<span class="ident" id="5732792">err</span>&nbsp;<span class="op" id="5732796">!=</span>&nbsp;<span class="builtintype" id="5732799">nil</span>&nbsp;<span class="op" id="5732803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732807">return</span>&nbsp;<span class="builtintype" id="5732814">nil</span><span class="op" id="5732817">,</span>&nbsp;<span class="ident" id="5732819">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732827">ff</span><span class="op" id="5732829">,</span>&nbsp;<span class="ident" id="5732831">err</span>&nbsp;<span class="op" id="5732835">:=</span>&nbsp;<span class="ident" id="5732838">NewFile</span><span class="op" id="5732845">(</span><span class="ident" id="5732846">f</span><span class="op" id="5732847">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732850">if</span>&nbsp;<span class="ident" id="5732853">err</span>&nbsp;<span class="op" id="5732857">!=</span>&nbsp;<span class="builtintype" id="5732860">nil</span>&nbsp;<span class="op" id="5732864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732868">f</span><span class="op" id="5732869">.</span><span class="ident" id="5732870">Close</span><span class="op" id="5732875">(</span><span class="op" id="5732876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732880">return</span>&nbsp;<span class="builtintype" id="5732887">nil</span><span class="op" id="5732890">,</span>&nbsp;<span class="ident" id="5732892">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5732897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5732900">ff</span><span class="op" id="5732902">.</span><span class="ident" id="5732903">closer</span>&nbsp;<span class="op" id="5732910">=</span>&nbsp;<span class="ident" id="5732912">f</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5732915">return</span>&nbsp;<span class="ident" id="5732922">ff</span><span class="op" id="5732924">,</span>&nbsp;<span class="builtintype" id="5732926">nil</span><br>
<span class="lineno"></span><span class="op" id="5732930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5732933">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5732959">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="5733026">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5733050">func</span>&nbsp;<span class="op" id="5733055">(</span><span class="ident" id="5733056">f</span>&nbsp;<span class="op" id="5733058">*</span><span class="ident" id="5733059">File</span><span class="op" id="5733063">)</span>&nbsp;<span class="ident" id="5733065">Close</span><span class="op" id="5733070">(</span><span class="op" id="5733071">)</span>&nbsp;<span class="builtintype" id="5733073">error</span>&nbsp;<span class="op" id="5733079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733082">var</span>&nbsp;<span class="ident" id="5733086">err</span>&nbsp;<span class="builtintype" id="5733090">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733097">if</span>&nbsp;<span class="ident" id="5733100">f</span><span class="op" id="5733101">.</span><span class="ident" id="5733102">closer</span>&nbsp;<span class="op" id="5733109">!=</span>&nbsp;<span class="builtintype" id="5733112">nil</span>&nbsp;<span class="op" id="5733116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733120">err</span>&nbsp;<span class="op" id="5733124">=</span>&nbsp;<span class="ident" id="5733126">f</span><span class="op" id="5733127">.</span><span class="ident" id="5733128">closer</span><span class="op" id="5733134">.</span><span class="ident" id="5733135">Close</span><span class="op" id="5733140">(</span><span class="op" id="5733141">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733145">f</span><span class="op" id="5733146">.</span><span class="ident" id="5733147">closer</span>&nbsp;<span class="op" id="5733154">=</span>&nbsp;<span class="builtintype" id="5733156">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733164">return</span>&nbsp;<span class="ident" id="5733171">err</span><br>
<span class="lineno"></span><span class="op" id="5733175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="5733178">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5733235">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5733286">func</span>&nbsp;<span class="op" id="5733291">(</span><span class="ident" id="5733292">f</span>&nbsp;<span class="op" id="5733294">*</span><span class="ident" id="5733295">File</span><span class="op" id="5733299">)</span>&nbsp;<span class="ident" id="5733301">SectionByType</span><span class="op" id="5733314">(</span><span class="ident" id="5733315">typ</span>&nbsp;<span class="ident" id="5733319">SectionType</span><span class="op" id="5733330">)</span>&nbsp;<span class="op" id="5733332">*</span><span class="ident" id="5733333">Section</span>&nbsp;<span class="op" id="5733341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733344">for</span>&nbsp;<span class="ident" id="5733348">_</span><span class="op" id="5733349">,</span>&nbsp;<span class="ident" id="5733351">s</span>&nbsp;<span class="op" id="5733353">:=</span>&nbsp;<span class="keyword" id="5733356">range</span>&nbsp;<span class="ident" id="5733362">f</span><span class="op" id="5733363">.</span><span class="ident" id="5733364">Sections</span>&nbsp;<span class="op" id="5733373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733377">if</span>&nbsp;<span class="ident" id="5733380">s</span><span class="op" id="5733381">.</span><span class="ident" id="5733382">Type</span>&nbsp;<span class="op" id="5733387">==</span>&nbsp;<span class="ident" id="5733390">typ</span>&nbsp;<span class="op" id="5733394">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733399">return</span>&nbsp;<span class="ident" id="5733406">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733416">return</span>&nbsp;<span class="builtintype" id="5733423">nil</span><br>
<span class="lineno"></span><span class="op" id="5733427">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="5733430">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="5733513">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="5733583">func</span>&nbsp;<span class="ident" id="5733588">NewFile</span><span class="op" id="5733595">(</span><span class="ident" id="5733596">r</span>&nbsp;<span class="ident" id="5733598">io</span><span class="op" id="5733600">.</span><span class="ident" id="5733601">ReaderAt</span><span class="op" id="5733609">)</span>&nbsp;<span class="op" id="5733611">(</span><span class="op" id="5733612">*</span><span class="ident" id="5733613">File</span><span class="op" id="5733617">,</span>&nbsp;<span class="builtintype" id="5733619">error</span><span class="op" id="5733624">)</span>&nbsp;<span class="op" id="5733626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733629">sr</span>&nbsp;<span class="op" id="5733632">:=</span>&nbsp;<span class="ident" id="5733635">io</span><span class="op" id="5733637">.</span><span class="ident" id="5733638">NewSectionReader</span><span class="op" id="5733654">(</span><span class="ident" id="5733655">r</span><span class="op" id="5733656">,</span>&nbsp;<span class="num" id="5733658">0</span><span class="op" id="5733659">,</span>&nbsp;<span class="num" id="5733661">1</span><span class="op" id="5733662">&lt;&lt;</span><span class="num" id="5733664">63</span><span class="op" id="5733666">-</span><span class="num" id="5733667">1</span><span class="op" id="5733668">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5733671">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733706">var</span>&nbsp;<span class="ident" id="5733710">ident</span>&nbsp;<span class="op" id="5733716">[</span><span class="num" id="5733717">16</span><span class="op" id="5733719">]</span><span class="builtintype" id="5733720">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733727">if</span>&nbsp;<span class="ident" id="5733730">_</span><span class="op" id="5733731">,</span>&nbsp;<span class="ident" id="5733733">err</span>&nbsp;<span class="op" id="5733737">:=</span>&nbsp;<span class="ident" id="5733740">r</span><span class="op" id="5733741">.</span><span class="ident" id="5733742">ReadAt</span><span class="op" id="5733748">(</span><span class="ident" id="5733749">ident</span><span class="op" id="5733754">[</span><span class="num" id="5733755">0</span><span class="op" id="5733756">:</span><span class="op" id="5733757">]</span><span class="op" id="5733758">,</span>&nbsp;<span class="num" id="5733760">0</span><span class="op" id="5733761">)</span><span class="op" id="5733762">;</span>&nbsp;<span class="ident" id="5733764">err</span>&nbsp;<span class="op" id="5733768">!=</span>&nbsp;<span class="builtintype" id="5733771">nil</span>&nbsp;<span class="op" id="5733775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733779">return</span>&nbsp;<span class="builtintype" id="5733786">nil</span><span class="op" id="5733789">,</span>&nbsp;<span class="ident" id="5733791">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733796">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733799">if</span>&nbsp;<span class="ident" id="5733802">ident</span><span class="op" id="5733807">[</span><span class="num" id="5733808">0</span><span class="op" id="5733809">]</span>&nbsp;<span class="op" id="5733811">!=</span>&nbsp;<span class="string" id="5733814">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="5733821">||</span>&nbsp;<span class="ident" id="5733824">ident</span><span class="op" id="5733829">[</span><span class="num" id="5733830">1</span><span class="op" id="5733831">]</span>&nbsp;<span class="op" id="5733833">!=</span>&nbsp;<span class="string" id="5733836">&#39;E&#39;</span>&nbsp;<span class="op" id="5733840">||</span>&nbsp;<span class="ident" id="5733843">ident</span><span class="op" id="5733848">[</span><span class="num" id="5733849">2</span><span class="op" id="5733850">]</span>&nbsp;<span class="op" id="5733852">!=</span>&nbsp;<span class="string" id="5733855">&#39;L&#39;</span>&nbsp;<span class="op" id="5733859">||</span>&nbsp;<span class="ident" id="5733862">ident</span><span class="op" id="5733867">[</span><span class="num" id="5733868">3</span><span class="op" id="5733869">]</span>&nbsp;<span class="op" id="5733871">!=</span>&nbsp;<span class="string" id="5733874">&#39;F&#39;</span>&nbsp;<span class="op" id="5733878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733882">return</span>&nbsp;<span class="builtintype" id="5733889">nil</span><span class="op" id="5733892">,</span>&nbsp;<span class="op" id="5733894">&amp;</span><span class="ident" id="5733895">FormatError</span><span class="op" id="5733906">{</span><span class="num" id="5733907">0</span><span class="op" id="5733908">,</span>&nbsp;<span class="string" id="5733910">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="5733928">,</span>&nbsp;<span class="ident" id="5733930">ident</span><span class="op" id="5733935">[</span><span class="num" id="5733936">0</span><span class="op" id="5733937">:</span><span class="num" id="5733938">4</span><span class="op" id="5733939">]</span><span class="op" id="5733940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5733943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733947">f</span>&nbsp;<span class="op" id="5733949">:=</span>&nbsp;<span class="builtinfunc" id="5733952">new</span><span class="op" id="5733955">(</span><span class="ident" id="5733956">File</span><span class="op" id="5733960">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5733963">f</span><span class="op" id="5733964">.</span><span class="ident" id="5733965">Class</span>&nbsp;<span class="op" id="5733971">=</span>&nbsp;<span class="ident" id="5733973">Class</span><span class="op" id="5733978">(</span><span class="ident" id="5733979">ident</span><span class="op" id="5733984">[</span><span class="ident" id="5733985">EI_CLASS</span><span class="op" id="5733993">]</span><span class="op" id="5733994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5733997">switch</span>&nbsp;<span class="ident" id="5734004">f</span><span class="op" id="5734005">.</span><span class="ident" id="5734006">Class</span>&nbsp;<span class="op" id="5734012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734015">case</span>&nbsp;<span class="ident" id="5734020">ELFCLASS32</span><span class="op" id="5734030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734033">case</span>&nbsp;<span class="ident" id="5734038">ELFCLASS64</span><span class="op" id="5734048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734052">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734059">default</span><span class="op" id="5734066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734070">return</span>&nbsp;<span class="builtintype" id="5734077">nil</span><span class="op" id="5734080">,</span>&nbsp;<span class="op" id="5734082">&amp;</span><span class="ident" id="5734083">FormatError</span><span class="op" id="5734094">{</span><span class="num" id="5734095">0</span><span class="op" id="5734096">,</span>&nbsp;<span class="string" id="5734098">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="5734117">,</span>&nbsp;<span class="ident" id="5734119">f</span><span class="op" id="5734120">.</span><span class="ident" id="5734121">Class</span><span class="op" id="5734126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734133">f</span><span class="op" id="5734134">.</span><span class="ident" id="5734135">Data</span>&nbsp;<span class="op" id="5734140">=</span>&nbsp;<span class="ident" id="5734142">Data</span><span class="op" id="5734146">(</span><span class="ident" id="5734147">ident</span><span class="op" id="5734152">[</span><span class="ident" id="5734153">EI_DATA</span><span class="op" id="5734160">]</span><span class="op" id="5734161">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734164">switch</span>&nbsp;<span class="ident" id="5734171">f</span><span class="op" id="5734172">.</span><span class="ident" id="5734173">Data</span>&nbsp;<span class="op" id="5734178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734181">case</span>&nbsp;<span class="ident" id="5734186">ELFDATA2LSB</span><span class="op" id="5734197">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734201">f</span><span class="op" id="5734202">.</span><span class="ident" id="5734203">ByteOrder</span>&nbsp;<span class="op" id="5734213">=</span>&nbsp;<span class="ident" id="5734215">binary</span><span class="op" id="5734221">.</span><span class="ident" id="5734222">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734236">case</span>&nbsp;<span class="ident" id="5734241">ELFDATA2MSB</span><span class="op" id="5734252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734256">f</span><span class="op" id="5734257">.</span><span class="ident" id="5734258">ByteOrder</span>&nbsp;<span class="op" id="5734268">=</span>&nbsp;<span class="ident" id="5734270">binary</span><span class="op" id="5734276">.</span><span class="ident" id="5734277">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734288">default</span><span class="op" id="5734295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734299">return</span>&nbsp;<span class="builtintype" id="5734306">nil</span><span class="op" id="5734309">,</span>&nbsp;<span class="op" id="5734311">&amp;</span><span class="ident" id="5734312">FormatError</span><span class="op" id="5734323">{</span><span class="num" id="5734324">0</span><span class="op" id="5734325">,</span>&nbsp;<span class="string" id="5734327">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="5734354">,</span>&nbsp;<span class="ident" id="5734356">f</span><span class="op" id="5734357">.</span><span class="ident" id="5734358">Data</span><span class="op" id="5734362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734369">f</span><span class="op" id="5734370">.</span><span class="ident" id="5734371">Version</span>&nbsp;<span class="op" id="5734379">=</span>&nbsp;<span class="ident" id="5734381">Version</span><span class="op" id="5734388">(</span><span class="ident" id="5734389">ident</span><span class="op" id="5734394">[</span><span class="ident" id="5734395">EI_VERSION</span><span class="op" id="5734405">]</span><span class="op" id="5734406">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734409">if</span>&nbsp;<span class="ident" id="5734412">f</span><span class="op" id="5734413">.</span><span class="ident" id="5734414">Version</span>&nbsp;<span class="op" id="5734422">!=</span>&nbsp;<span class="ident" id="5734425">EV_CURRENT</span>&nbsp;<span class="op" id="5734436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734440">return</span>&nbsp;<span class="builtintype" id="5734447">nil</span><span class="op" id="5734450">,</span>&nbsp;<span class="op" id="5734452">&amp;</span><span class="ident" id="5734453">FormatError</span><span class="op" id="5734464">{</span><span class="num" id="5734465">0</span><span class="op" id="5734466">,</span>&nbsp;<span class="string" id="5734468">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5734489">,</span>&nbsp;<span class="ident" id="5734491">f</span><span class="op" id="5734492">.</span><span class="ident" id="5734493">Version</span><span class="op" id="5734500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734503">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734507">f</span><span class="op" id="5734508">.</span><span class="ident" id="5734509">OSABI</span>&nbsp;<span class="op" id="5734515">=</span>&nbsp;<span class="ident" id="5734517">OSABI</span><span class="op" id="5734522">(</span><span class="ident" id="5734523">ident</span><span class="op" id="5734528">[</span><span class="ident" id="5734529">EI_OSABI</span><span class="op" id="5734537">]</span><span class="op" id="5734538">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734541">f</span><span class="op" id="5734542">.</span><span class="ident" id="5734543">ABIVersion</span>&nbsp;<span class="op" id="5734554">=</span>&nbsp;<span class="ident" id="5734556">ident</span><span class="op" id="5734561">[</span><span class="ident" id="5734562">EI_ABIVERSION</span><span class="op" id="5734575">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5734579">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734604">var</span>&nbsp;<span class="ident" id="5734608">phoff</span>&nbsp;<span class="ident" id="5734614">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734621">var</span>&nbsp;<span class="ident" id="5734625">phentsize</span><span class="op" id="5734634">,</span>&nbsp;<span class="ident" id="5734636">phnum</span>&nbsp;<span class="builtintype" id="5734642">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734647">var</span>&nbsp;<span class="ident" id="5734651">shoff</span>&nbsp;<span class="ident" id="5734657">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734664">var</span>&nbsp;<span class="ident" id="5734668">shentsize</span><span class="op" id="5734677">,</span>&nbsp;<span class="ident" id="5734679">shnum</span><span class="op" id="5734684">,</span>&nbsp;<span class="ident" id="5734686">shstrndx</span>&nbsp;<span class="builtintype" id="5734695">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734700">shstrndx</span>&nbsp;<span class="op" id="5734709">=</span>&nbsp;<span class="op" id="5734711">-</span><span class="num" id="5734712">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734715">switch</span>&nbsp;<span class="ident" id="5734722">f</span><span class="op" id="5734723">.</span><span class="ident" id="5734724">Class</span>&nbsp;<span class="op" id="5734730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734733">case</span>&nbsp;<span class="ident" id="5734738">ELFCLASS32</span><span class="op" id="5734748">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734752">hdr</span>&nbsp;<span class="op" id="5734756">:=</span>&nbsp;<span class="builtinfunc" id="5734759">new</span><span class="op" id="5734762">(</span><span class="ident" id="5734763">Header32</span><span class="op" id="5734771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734775">sr</span><span class="op" id="5734777">.</span><span class="ident" id="5734778">Seek</span><span class="op" id="5734782">(</span><span class="num" id="5734783">0</span><span class="op" id="5734784">,</span>&nbsp;<span class="ident" id="5734786">os</span><span class="op" id="5734788">.</span><span class="ident" id="5734789">SEEK_SET</span><span class="op" id="5734797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734801">if</span>&nbsp;<span class="ident" id="5734804">err</span>&nbsp;<span class="op" id="5734808">:=</span>&nbsp;<span class="ident" id="5734811">binary</span><span class="op" id="5734817">.</span><span class="ident" id="5734818">Read</span><span class="op" id="5734822">(</span><span class="ident" id="5734823">sr</span><span class="op" id="5734825">,</span>&nbsp;<span class="ident" id="5734827">f</span><span class="op" id="5734828">.</span><span class="ident" id="5734829">ByteOrder</span><span class="op" id="5734838">,</span>&nbsp;<span class="ident" id="5734840">hdr</span><span class="op" id="5734843">)</span><span class="op" id="5734844">;</span>&nbsp;<span class="ident" id="5734846">err</span>&nbsp;<span class="op" id="5734850">!=</span>&nbsp;<span class="builtintype" id="5734853">nil</span>&nbsp;<span class="op" id="5734857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734862">return</span>&nbsp;<span class="builtintype" id="5734869">nil</span><span class="op" id="5734872">,</span>&nbsp;<span class="ident" id="5734874">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5734880">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734884">f</span><span class="op" id="5734885">.</span><span class="ident" id="5734886">Type</span>&nbsp;<span class="op" id="5734891">=</span>&nbsp;<span class="ident" id="5734893">Type</span><span class="op" id="5734897">(</span><span class="ident" id="5734898">hdr</span><span class="op" id="5734901">.</span><span class="ident" id="5734902">Type</span><span class="op" id="5734906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734910">f</span><span class="op" id="5734911">.</span><span class="ident" id="5734912">Machine</span>&nbsp;<span class="op" id="5734920">=</span>&nbsp;<span class="ident" id="5734922">Machine</span><span class="op" id="5734929">(</span><span class="ident" id="5734930">hdr</span><span class="op" id="5734933">.</span><span class="ident" id="5734934">Machine</span><span class="op" id="5734941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5734945">f</span><span class="op" id="5734946">.</span><span class="ident" id="5734947">Entry</span>&nbsp;<span class="op" id="5734953">=</span>&nbsp;<span class="ident" id="5734955">uint64</span><span class="op" id="5734961">(</span><span class="ident" id="5734962">hdr</span><span class="op" id="5734965">.</span><span class="ident" id="5734966">Entry</span><span class="op" id="5734971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5734975">if</span>&nbsp;<span class="ident" id="5734978">v</span>&nbsp;<span class="op" id="5734980">:=</span>&nbsp;<span class="ident" id="5734983">Version</span><span class="op" id="5734990">(</span><span class="ident" id="5734991">hdr</span><span class="op" id="5734994">.</span><span class="ident" id="5734995">Version</span><span class="op" id="5735002">)</span><span class="op" id="5735003">;</span>&nbsp;<span class="ident" id="5735005">v</span>&nbsp;<span class="op" id="5735007">!=</span>&nbsp;<span class="ident" id="5735010">f</span><span class="op" id="5735011">.</span><span class="ident" id="5735012">Version</span>&nbsp;<span class="op" id="5735020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735025">return</span>&nbsp;<span class="builtintype" id="5735032">nil</span><span class="op" id="5735035">,</span>&nbsp;<span class="op" id="5735037">&amp;</span><span class="ident" id="5735038">FormatError</span><span class="op" id="5735049">{</span><span class="num" id="5735050">0</span><span class="op" id="5735051">,</span>&nbsp;<span class="string" id="5735053">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5735077">,</span>&nbsp;<span class="ident" id="5735079">v</span><span class="op" id="5735080">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735088">phoff</span>&nbsp;<span class="op" id="5735094">=</span>&nbsp;<span class="ident" id="5735096">int64</span><span class="op" id="5735101">(</span><span class="ident" id="5735102">hdr</span><span class="op" id="5735105">.</span><span class="ident" id="5735106">Phoff</span><span class="op" id="5735111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735115">phentsize</span>&nbsp;<span class="op" id="5735125">=</span>&nbsp;<span class="builtintype" id="5735127">int</span><span class="op" id="5735130">(</span><span class="ident" id="5735131">hdr</span><span class="op" id="5735134">.</span><span class="ident" id="5735135">Phentsize</span><span class="op" id="5735144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735148">phnum</span>&nbsp;<span class="op" id="5735154">=</span>&nbsp;<span class="builtintype" id="5735156">int</span><span class="op" id="5735159">(</span><span class="ident" id="5735160">hdr</span><span class="op" id="5735163">.</span><span class="ident" id="5735164">Phnum</span><span class="op" id="5735169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735173">shoff</span>&nbsp;<span class="op" id="5735179">=</span>&nbsp;<span class="ident" id="5735181">int64</span><span class="op" id="5735186">(</span><span class="ident" id="5735187">hdr</span><span class="op" id="5735190">.</span><span class="ident" id="5735191">Shoff</span><span class="op" id="5735196">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735200">shentsize</span>&nbsp;<span class="op" id="5735210">=</span>&nbsp;<span class="builtintype" id="5735212">int</span><span class="op" id="5735215">(</span><span class="ident" id="5735216">hdr</span><span class="op" id="5735219">.</span><span class="ident" id="5735220">Shentsize</span><span class="op" id="5735229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735233">shnum</span>&nbsp;<span class="op" id="5735239">=</span>&nbsp;<span class="builtintype" id="5735241">int</span><span class="op" id="5735244">(</span><span class="ident" id="5735245">hdr</span><span class="op" id="5735248">.</span><span class="ident" id="5735249">Shnum</span><span class="op" id="5735254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735258">shstrndx</span>&nbsp;<span class="op" id="5735267">=</span>&nbsp;<span class="builtintype" id="5735269">int</span><span class="op" id="5735272">(</span><span class="ident" id="5735273">hdr</span><span class="op" id="5735276">.</span><span class="ident" id="5735277">Shstrndx</span><span class="op" id="5735285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735288">case</span>&nbsp;<span class="ident" id="5735293">ELFCLASS64</span><span class="op" id="5735303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735307">hdr</span>&nbsp;<span class="op" id="5735311">:=</span>&nbsp;<span class="builtinfunc" id="5735314">new</span><span class="op" id="5735317">(</span><span class="ident" id="5735318">Header64</span><span class="op" id="5735326">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735330">sr</span><span class="op" id="5735332">.</span><span class="ident" id="5735333">Seek</span><span class="op" id="5735337">(</span><span class="num" id="5735338">0</span><span class="op" id="5735339">,</span>&nbsp;<span class="ident" id="5735341">os</span><span class="op" id="5735343">.</span><span class="ident" id="5735344">SEEK_SET</span><span class="op" id="5735352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735356">if</span>&nbsp;<span class="ident" id="5735359">err</span>&nbsp;<span class="op" id="5735363">:=</span>&nbsp;<span class="ident" id="5735366">binary</span><span class="op" id="5735372">.</span><span class="ident" id="5735373">Read</span><span class="op" id="5735377">(</span><span class="ident" id="5735378">sr</span><span class="op" id="5735380">,</span>&nbsp;<span class="ident" id="5735382">f</span><span class="op" id="5735383">.</span><span class="ident" id="5735384">ByteOrder</span><span class="op" id="5735393">,</span>&nbsp;<span class="ident" id="5735395">hdr</span><span class="op" id="5735398">)</span><span class="op" id="5735399">;</span>&nbsp;<span class="ident" id="5735401">err</span>&nbsp;<span class="op" id="5735405">!=</span>&nbsp;<span class="builtintype" id="5735408">nil</span>&nbsp;<span class="op" id="5735412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735417">return</span>&nbsp;<span class="builtintype" id="5735424">nil</span><span class="op" id="5735427">,</span>&nbsp;<span class="ident" id="5735429">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735439">f</span><span class="op" id="5735440">.</span><span class="ident" id="5735441">Type</span>&nbsp;<span class="op" id="5735446">=</span>&nbsp;<span class="ident" id="5735448">Type</span><span class="op" id="5735452">(</span><span class="ident" id="5735453">hdr</span><span class="op" id="5735456">.</span><span class="ident" id="5735457">Type</span><span class="op" id="5735461">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735465">f</span><span class="op" id="5735466">.</span><span class="ident" id="5735467">Machine</span>&nbsp;<span class="op" id="5735475">=</span>&nbsp;<span class="ident" id="5735477">Machine</span><span class="op" id="5735484">(</span><span class="ident" id="5735485">hdr</span><span class="op" id="5735488">.</span><span class="ident" id="5735489">Machine</span><span class="op" id="5735496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735500">f</span><span class="op" id="5735501">.</span><span class="ident" id="5735502">Entry</span>&nbsp;<span class="op" id="5735508">=</span>&nbsp;<span class="ident" id="5735510">uint64</span><span class="op" id="5735516">(</span><span class="ident" id="5735517">hdr</span><span class="op" id="5735520">.</span><span class="ident" id="5735521">Entry</span><span class="op" id="5735526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735530">if</span>&nbsp;<span class="ident" id="5735533">v</span>&nbsp;<span class="op" id="5735535">:=</span>&nbsp;<span class="ident" id="5735538">Version</span><span class="op" id="5735545">(</span><span class="ident" id="5735546">hdr</span><span class="op" id="5735549">.</span><span class="ident" id="5735550">Version</span><span class="op" id="5735557">)</span><span class="op" id="5735558">;</span>&nbsp;<span class="ident" id="5735560">v</span>&nbsp;<span class="op" id="5735562">!=</span>&nbsp;<span class="ident" id="5735565">f</span><span class="op" id="5735566">.</span><span class="ident" id="5735567">Version</span>&nbsp;<span class="op" id="5735575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735580">return</span>&nbsp;<span class="builtintype" id="5735587">nil</span><span class="op" id="5735590">,</span>&nbsp;<span class="op" id="5735592">&amp;</span><span class="ident" id="5735593">FormatError</span><span class="op" id="5735604">{</span><span class="num" id="5735605">0</span><span class="op" id="5735606">,</span>&nbsp;<span class="string" id="5735608">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="5735632">,</span>&nbsp;<span class="ident" id="5735634">v</span><span class="op" id="5735635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735639">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735643">phoff</span>&nbsp;<span class="op" id="5735649">=</span>&nbsp;<span class="ident" id="5735651">int64</span><span class="op" id="5735656">(</span><span class="ident" id="5735657">hdr</span><span class="op" id="5735660">.</span><span class="ident" id="5735661">Phoff</span><span class="op" id="5735666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735670">phentsize</span>&nbsp;<span class="op" id="5735680">=</span>&nbsp;<span class="builtintype" id="5735682">int</span><span class="op" id="5735685">(</span><span class="ident" id="5735686">hdr</span><span class="op" id="5735689">.</span><span class="ident" id="5735690">Phentsize</span><span class="op" id="5735699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735703">phnum</span>&nbsp;<span class="op" id="5735709">=</span>&nbsp;<span class="builtintype" id="5735711">int</span><span class="op" id="5735714">(</span><span class="ident" id="5735715">hdr</span><span class="op" id="5735718">.</span><span class="ident" id="5735719">Phnum</span><span class="op" id="5735724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735728">shoff</span>&nbsp;<span class="op" id="5735734">=</span>&nbsp;<span class="ident" id="5735736">int64</span><span class="op" id="5735741">(</span><span class="ident" id="5735742">hdr</span><span class="op" id="5735745">.</span><span class="ident" id="5735746">Shoff</span><span class="op" id="5735751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735755">shentsize</span>&nbsp;<span class="op" id="5735765">=</span>&nbsp;<span class="builtintype" id="5735767">int</span><span class="op" id="5735770">(</span><span class="ident" id="5735771">hdr</span><span class="op" id="5735774">.</span><span class="ident" id="5735775">Shentsize</span><span class="op" id="5735784">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735788">shnum</span>&nbsp;<span class="op" id="5735794">=</span>&nbsp;<span class="builtintype" id="5735796">int</span><span class="op" id="5735799">(</span><span class="ident" id="5735800">hdr</span><span class="op" id="5735803">.</span><span class="ident" id="5735804">Shnum</span><span class="op" id="5735809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5735813">shstrndx</span>&nbsp;<span class="op" id="5735822">=</span>&nbsp;<span class="builtintype" id="5735824">int</span><span class="op" id="5735827">(</span><span class="ident" id="5735828">hdr</span><span class="op" id="5735831">.</span><span class="ident" id="5735832">Shstrndx</span><span class="op" id="5735840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735847">if</span>&nbsp;<span class="ident" id="5735850">shnum</span>&nbsp;<span class="op" id="5735856">&gt;</span>&nbsp;<span class="num" id="5735858">0</span>&nbsp;<span class="op" id="5735860">&amp;&amp;</span>&nbsp;<span class="ident" id="5735863">shoff</span>&nbsp;<span class="op" id="5735869">&gt;</span>&nbsp;<span class="num" id="5735871">0</span>&nbsp;<span class="op" id="5735873">&amp;&amp;</span>&nbsp;<span class="op" id="5735876">(</span><span class="ident" id="5735877">shstrndx</span>&nbsp;<span class="op" id="5735886">&lt;</span>&nbsp;<span class="num" id="5735888">0</span>&nbsp;<span class="op" id="5735890">||</span>&nbsp;<span class="ident" id="5735893">shstrndx</span>&nbsp;<span class="op" id="5735902">&gt;=</span>&nbsp;<span class="ident" id="5735905">shnum</span><span class="op" id="5735910">)</span>&nbsp;<span class="op" id="5735912">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5735916">return</span>&nbsp;<span class="builtintype" id="5735923">nil</span><span class="op" id="5735926">,</span>&nbsp;<span class="op" id="5735928">&amp;</span><span class="ident" id="5735929">FormatError</span><span class="op" id="5735940">{</span><span class="num" id="5735941">0</span><span class="op" id="5735942">,</span>&nbsp;<span class="string" id="5735944">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="5735966">,</span>&nbsp;<span class="ident" id="5735968">shstrndx</span><span class="op" id="5735976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5735979">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5735983">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736008">f</span><span class="op" id="5736009">.</span><span class="ident" id="5736010">Progs</span>&nbsp;<span class="op" id="5736016">=</span>&nbsp;<span class="builtinfunc" id="5736018">make</span><span class="op" id="5736022">(</span><span class="op" id="5736023">[</span><span class="op" id="5736024">]</span><span class="op" id="5736025">*</span><span class="ident" id="5736026">Prog</span><span class="op" id="5736030">,</span>&nbsp;<span class="ident" id="5736032">phnum</span><span class="op" id="5736037">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736040">for</span>&nbsp;<span class="ident" id="5736044">i</span>&nbsp;<span class="op" id="5736046">:=</span>&nbsp;<span class="num" id="5736049">0</span><span class="op" id="5736050">;</span>&nbsp;<span class="ident" id="5736052">i</span>&nbsp;<span class="op" id="5736054">&lt;</span>&nbsp;<span class="ident" id="5736056">phnum</span><span class="op" id="5736061">;</span>&nbsp;<span class="ident" id="5736063">i</span><span class="op" id="5736064">++</span>&nbsp;<span class="op" id="5736067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736071">off</span>&nbsp;<span class="op" id="5736075">:=</span>&nbsp;<span class="ident" id="5736078">phoff</span>&nbsp;<span class="op" id="5736084">+</span>&nbsp;<span class="ident" id="5736086">int64</span><span class="op" id="5736091">(</span><span class="ident" id="5736092">i</span><span class="op" id="5736093">)</span><span class="op" id="5736094">*</span><span class="ident" id="5736095">int64</span><span class="op" id="5736100">(</span><span class="ident" id="5736101">phentsize</span><span class="op" id="5736110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736114">sr</span><span class="op" id="5736116">.</span><span class="ident" id="5736117">Seek</span><span class="op" id="5736121">(</span><span class="ident" id="5736122">off</span><span class="op" id="5736125">,</span>&nbsp;<span class="ident" id="5736127">os</span><span class="op" id="5736129">.</span><span class="ident" id="5736130">SEEK_SET</span><span class="op" id="5736138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736142">p</span>&nbsp;<span class="op" id="5736144">:=</span>&nbsp;<span class="builtinfunc" id="5736147">new</span><span class="op" id="5736150">(</span><span class="ident" id="5736151">Prog</span><span class="op" id="5736155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736159">switch</span>&nbsp;<span class="ident" id="5736166">f</span><span class="op" id="5736167">.</span><span class="ident" id="5736168">Class</span>&nbsp;<span class="op" id="5736174">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736178">case</span>&nbsp;<span class="ident" id="5736183">ELFCLASS32</span><span class="op" id="5736193">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736198">ph</span>&nbsp;<span class="op" id="5736201">:=</span>&nbsp;<span class="builtinfunc" id="5736204">new</span><span class="op" id="5736207">(</span><span class="ident" id="5736208">Prog32</span><span class="op" id="5736214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736219">if</span>&nbsp;<span class="ident" id="5736222">err</span>&nbsp;<span class="op" id="5736226">:=</span>&nbsp;<span class="ident" id="5736229">binary</span><span class="op" id="5736235">.</span><span class="ident" id="5736236">Read</span><span class="op" id="5736240">(</span><span class="ident" id="5736241">sr</span><span class="op" id="5736243">,</span>&nbsp;<span class="ident" id="5736245">f</span><span class="op" id="5736246">.</span><span class="ident" id="5736247">ByteOrder</span><span class="op" id="5736256">,</span>&nbsp;<span class="ident" id="5736258">ph</span><span class="op" id="5736260">)</span><span class="op" id="5736261">;</span>&nbsp;<span class="ident" id="5736263">err</span>&nbsp;<span class="op" id="5736267">!=</span>&nbsp;<span class="builtintype" id="5736270">nil</span>&nbsp;<span class="op" id="5736274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736280">return</span>&nbsp;<span class="builtintype" id="5736287">nil</span><span class="op" id="5736290">,</span>&nbsp;<span class="ident" id="5736292">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736299">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736304">p</span><span class="op" id="5736305">.</span><span class="ident" id="5736306">ProgHeader</span>&nbsp;<span class="op" id="5736317">=</span>&nbsp;<span class="ident" id="5736319">ProgHeader</span><span class="op" id="5736329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736335">Type</span><span class="op" id="5736339">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5736343">ProgType</span><span class="op" id="5736351">(</span><span class="ident" id="5736352">ph</span><span class="op" id="5736354">.</span><span class="ident" id="5736355">Type</span><span class="op" id="5736359">)</span><span class="op" id="5736360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736366">Flags</span><span class="op" id="5736371">:</span>&nbsp;&nbsp;<span class="ident" id="5736374">ProgFlag</span><span class="op" id="5736382">(</span><span class="ident" id="5736383">ph</span><span class="op" id="5736385">.</span><span class="ident" id="5736386">Flags</span><span class="op" id="5736391">)</span><span class="op" id="5736392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736398">Off</span><span class="op" id="5736401">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736406">uint64</span><span class="op" id="5736412">(</span><span class="ident" id="5736413">ph</span><span class="op" id="5736415">.</span><span class="ident" id="5736416">Off</span><span class="op" id="5736419">)</span><span class="op" id="5736420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736426">Vaddr</span><span class="op" id="5736431">:</span>&nbsp;&nbsp;<span class="ident" id="5736434">uint64</span><span class="op" id="5736440">(</span><span class="ident" id="5736441">ph</span><span class="op" id="5736443">.</span><span class="ident" id="5736444">Vaddr</span><span class="op" id="5736449">)</span><span class="op" id="5736450">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736456">Paddr</span><span class="op" id="5736461">:</span>&nbsp;&nbsp;<span class="ident" id="5736464">uint64</span><span class="op" id="5736470">(</span><span class="ident" id="5736471">ph</span><span class="op" id="5736473">.</span><span class="ident" id="5736474">Paddr</span><span class="op" id="5736479">)</span><span class="op" id="5736480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736486">Filesz</span><span class="op" id="5736492">:</span>&nbsp;<span class="ident" id="5736494">uint64</span><span class="op" id="5736500">(</span><span class="ident" id="5736501">ph</span><span class="op" id="5736503">.</span><span class="ident" id="5736504">Filesz</span><span class="op" id="5736510">)</span><span class="op" id="5736511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736517">Memsz</span><span class="op" id="5736522">:</span>&nbsp;&nbsp;<span class="ident" id="5736525">uint64</span><span class="op" id="5736531">(</span><span class="ident" id="5736532">ph</span><span class="op" id="5736534">.</span><span class="ident" id="5736535">Memsz</span><span class="op" id="5736540">)</span><span class="op" id="5736541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736547">Align</span><span class="op" id="5736552">:</span>&nbsp;&nbsp;<span class="ident" id="5736555">uint64</span><span class="op" id="5736561">(</span><span class="ident" id="5736562">ph</span><span class="op" id="5736564">.</span><span class="ident" id="5736565">Align</span><span class="op" id="5736570">)</span><span class="op" id="5736571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736576">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736580">case</span>&nbsp;<span class="ident" id="5736585">ELFCLASS64</span><span class="op" id="5736595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736600">ph</span>&nbsp;<span class="op" id="5736603">:=</span>&nbsp;<span class="builtinfunc" id="5736606">new</span><span class="op" id="5736609">(</span><span class="ident" id="5736610">Prog64</span><span class="op" id="5736616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736621">if</span>&nbsp;<span class="ident" id="5736624">err</span>&nbsp;<span class="op" id="5736628">:=</span>&nbsp;<span class="ident" id="5736631">binary</span><span class="op" id="5736637">.</span><span class="ident" id="5736638">Read</span><span class="op" id="5736642">(</span><span class="ident" id="5736643">sr</span><span class="op" id="5736645">,</span>&nbsp;<span class="ident" id="5736647">f</span><span class="op" id="5736648">.</span><span class="ident" id="5736649">ByteOrder</span><span class="op" id="5736658">,</span>&nbsp;<span class="ident" id="5736660">ph</span><span class="op" id="5736662">)</span><span class="op" id="5736663">;</span>&nbsp;<span class="ident" id="5736665">err</span>&nbsp;<span class="op" id="5736669">!=</span>&nbsp;<span class="builtintype" id="5736672">nil</span>&nbsp;<span class="op" id="5736676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5736682">return</span>&nbsp;<span class="builtintype" id="5736689">nil</span><span class="op" id="5736692">,</span>&nbsp;<span class="ident" id="5736694">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736701">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736706">p</span><span class="op" id="5736707">.</span><span class="ident" id="5736708">ProgHeader</span>&nbsp;<span class="op" id="5736719">=</span>&nbsp;<span class="ident" id="5736721">ProgHeader</span><span class="op" id="5736731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736737">Type</span><span class="op" id="5736741">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5736745">ProgType</span><span class="op" id="5736753">(</span><span class="ident" id="5736754">ph</span><span class="op" id="5736756">.</span><span class="ident" id="5736757">Type</span><span class="op" id="5736761">)</span><span class="op" id="5736762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736768">Flags</span><span class="op" id="5736773">:</span>&nbsp;&nbsp;<span class="ident" id="5736776">ProgFlag</span><span class="op" id="5736784">(</span><span class="ident" id="5736785">ph</span><span class="op" id="5736787">.</span><span class="ident" id="5736788">Flags</span><span class="op" id="5736793">)</span><span class="op" id="5736794">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736800">Off</span><span class="op" id="5736803">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736808">uint64</span><span class="op" id="5736814">(</span><span class="ident" id="5736815">ph</span><span class="op" id="5736817">.</span><span class="ident" id="5736818">Off</span><span class="op" id="5736821">)</span><span class="op" id="5736822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736828">Vaddr</span><span class="op" id="5736833">:</span>&nbsp;&nbsp;<span class="ident" id="5736836">uint64</span><span class="op" id="5736842">(</span><span class="ident" id="5736843">ph</span><span class="op" id="5736845">.</span><span class="ident" id="5736846">Vaddr</span><span class="op" id="5736851">)</span><span class="op" id="5736852">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736858">Paddr</span><span class="op" id="5736863">:</span>&nbsp;&nbsp;<span class="ident" id="5736866">uint64</span><span class="op" id="5736872">(</span><span class="ident" id="5736873">ph</span><span class="op" id="5736875">.</span><span class="ident" id="5736876">Paddr</span><span class="op" id="5736881">)</span><span class="op" id="5736882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736888">Filesz</span><span class="op" id="5736894">:</span>&nbsp;<span class="ident" id="5736896">uint64</span><span class="op" id="5736902">(</span><span class="ident" id="5736903">ph</span><span class="op" id="5736905">.</span><span class="ident" id="5736906">Filesz</span><span class="op" id="5736912">)</span><span class="op" id="5736913">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736919">Memsz</span><span class="op" id="5736924">:</span>&nbsp;&nbsp;<span class="ident" id="5736927">uint64</span><span class="op" id="5736933">(</span><span class="ident" id="5736934">ph</span><span class="op" id="5736936">.</span><span class="ident" id="5736937">Memsz</span><span class="op" id="5736942">)</span><span class="op" id="5736943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736949">Align</span><span class="op" id="5736954">:</span>&nbsp;&nbsp;<span class="ident" id="5736957">uint64</span><span class="op" id="5736963">(</span><span class="ident" id="5736964">ph</span><span class="op" id="5736966">.</span><span class="ident" id="5736967">Align</span><span class="op" id="5736972">)</span><span class="op" id="5736973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736978">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5736982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5736986">p</span><span class="op" id="5736987">.</span><span class="ident" id="5736988">sr</span>&nbsp;<span class="op" id="5736991">=</span>&nbsp;<span class="ident" id="5736993">io</span><span class="op" id="5736995">.</span><span class="ident" id="5736996">NewSectionReader</span><span class="op" id="5737012">(</span><span class="ident" id="5737013">r</span><span class="op" id="5737014">,</span>&nbsp;<span class="ident" id="5737016">int64</span><span class="op" id="5737021">(</span><span class="ident" id="5737022">p</span><span class="op" id="5737023">.</span><span class="ident" id="5737024">Off</span><span class="op" id="5737027">)</span><span class="op" id="5737028">,</span>&nbsp;<span class="ident" id="5737030">int64</span><span class="op" id="5737035">(</span><span class="ident" id="5737036">p</span><span class="op" id="5737037">.</span><span class="ident" id="5737038">Filesz</span><span class="op" id="5737044">)</span><span class="op" id="5737045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737049">p</span><span class="op" id="5737050">.</span><span class="ident" id="5737051">ReaderAt</span>&nbsp;<span class="op" id="5737060">=</span>&nbsp;<span class="ident" id="5737062">p</span><span class="op" id="5737063">.</span><span class="ident" id="5737064">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737069">f</span><span class="op" id="5737070">.</span><span class="ident" id="5737071">Progs</span><span class="op" id="5737076">[</span><span class="ident" id="5737077">i</span><span class="op" id="5737078">]</span>&nbsp;<span class="op" id="5737080">=</span>&nbsp;<span class="ident" id="5737082">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737085">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5737089">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737114">f</span><span class="op" id="5737115">.</span><span class="ident" id="5737116">Sections</span>&nbsp;<span class="op" id="5737125">=</span>&nbsp;<span class="builtinfunc" id="5737127">make</span><span class="op" id="5737131">(</span><span class="op" id="5737132">[</span><span class="op" id="5737133">]</span><span class="op" id="5737134">*</span><span class="ident" id="5737135">Section</span><span class="op" id="5737142">,</span>&nbsp;<span class="ident" id="5737144">shnum</span><span class="op" id="5737149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737152">names</span>&nbsp;<span class="op" id="5737158">:=</span>&nbsp;<span class="builtinfunc" id="5737161">make</span><span class="op" id="5737165">(</span><span class="op" id="5737166">[</span><span class="op" id="5737167">]</span><span class="builtintype" id="5737168">uint32</span><span class="op" id="5737174">,</span>&nbsp;<span class="ident" id="5737176">shnum</span><span class="op" id="5737181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737184">for</span>&nbsp;<span class="ident" id="5737188">i</span>&nbsp;<span class="op" id="5737190">:=</span>&nbsp;<span class="num" id="5737193">0</span><span class="op" id="5737194">;</span>&nbsp;<span class="ident" id="5737196">i</span>&nbsp;<span class="op" id="5737198">&lt;</span>&nbsp;<span class="ident" id="5737200">shnum</span><span class="op" id="5737205">;</span>&nbsp;<span class="ident" id="5737207">i</span><span class="op" id="5737208">++</span>&nbsp;<span class="op" id="5737211">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737215">off</span>&nbsp;<span class="op" id="5737219">:=</span>&nbsp;<span class="ident" id="5737222">shoff</span>&nbsp;<span class="op" id="5737228">+</span>&nbsp;<span class="ident" id="5737230">int64</span><span class="op" id="5737235">(</span><span class="ident" id="5737236">i</span><span class="op" id="5737237">)</span><span class="op" id="5737238">*</span><span class="ident" id="5737239">int64</span><span class="op" id="5737244">(</span><span class="ident" id="5737245">shentsize</span><span class="op" id="5737254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737258">sr</span><span class="op" id="5737260">.</span><span class="ident" id="5737261">Seek</span><span class="op" id="5737265">(</span><span class="ident" id="5737266">off</span><span class="op" id="5737269">,</span>&nbsp;<span class="ident" id="5737271">os</span><span class="op" id="5737273">.</span><span class="ident" id="5737274">SEEK_SET</span><span class="op" id="5737282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737286">s</span>&nbsp;<span class="op" id="5737288">:=</span>&nbsp;<span class="builtinfunc" id="5737291">new</span><span class="op" id="5737294">(</span><span class="ident" id="5737295">Section</span><span class="op" id="5737302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737306">switch</span>&nbsp;<span class="ident" id="5737313">f</span><span class="op" id="5737314">.</span><span class="ident" id="5737315">Class</span>&nbsp;<span class="op" id="5737321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737325">case</span>&nbsp;<span class="ident" id="5737330">ELFCLASS32</span><span class="op" id="5737340">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737345">sh</span>&nbsp;<span class="op" id="5737348">:=</span>&nbsp;<span class="builtinfunc" id="5737351">new</span><span class="op" id="5737354">(</span><span class="ident" id="5737355">Section32</span><span class="op" id="5737364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737369">if</span>&nbsp;<span class="ident" id="5737372">err</span>&nbsp;<span class="op" id="5737376">:=</span>&nbsp;<span class="ident" id="5737379">binary</span><span class="op" id="5737385">.</span><span class="ident" id="5737386">Read</span><span class="op" id="5737390">(</span><span class="ident" id="5737391">sr</span><span class="op" id="5737393">,</span>&nbsp;<span class="ident" id="5737395">f</span><span class="op" id="5737396">.</span><span class="ident" id="5737397">ByteOrder</span><span class="op" id="5737406">,</span>&nbsp;<span class="ident" id="5737408">sh</span><span class="op" id="5737410">)</span><span class="op" id="5737411">;</span>&nbsp;<span class="ident" id="5737413">err</span>&nbsp;<span class="op" id="5737417">!=</span>&nbsp;<span class="builtintype" id="5737420">nil</span>&nbsp;<span class="op" id="5737424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737430">return</span>&nbsp;<span class="builtintype" id="5737437">nil</span><span class="op" id="5737440">,</span>&nbsp;<span class="ident" id="5737442">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737454">names</span><span class="op" id="5737459">[</span><span class="ident" id="5737460">i</span><span class="op" id="5737461">]</span>&nbsp;<span class="op" id="5737463">=</span>&nbsp;<span class="ident" id="5737465">sh</span><span class="op" id="5737467">.</span><span class="ident" id="5737468">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737476">s</span><span class="op" id="5737477">.</span><span class="ident" id="5737478">SectionHeader</span>&nbsp;<span class="op" id="5737492">=</span>&nbsp;<span class="ident" id="5737494">SectionHeader</span><span class="op" id="5737507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737513">Type</span><span class="op" id="5737517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737524">SectionType</span><span class="op" id="5737535">(</span><span class="ident" id="5737536">sh</span><span class="op" id="5737538">.</span><span class="ident" id="5737539">Type</span><span class="op" id="5737543">)</span><span class="op" id="5737544">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737550">Flags</span><span class="op" id="5737555">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737561">SectionFlag</span><span class="op" id="5737572">(</span><span class="ident" id="5737573">sh</span><span class="op" id="5737575">.</span><span class="ident" id="5737576">Flags</span><span class="op" id="5737581">)</span><span class="op" id="5737582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737588">Addr</span><span class="op" id="5737592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737599">uint64</span><span class="op" id="5737605">(</span><span class="ident" id="5737606">sh</span><span class="op" id="5737608">.</span><span class="ident" id="5737609">Addr</span><span class="op" id="5737613">)</span><span class="op" id="5737614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737620">Offset</span><span class="op" id="5737626">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737631">uint64</span><span class="op" id="5737637">(</span><span class="ident" id="5737638">sh</span><span class="op" id="5737640">.</span><span class="ident" id="5737641">Off</span><span class="op" id="5737644">)</span><span class="op" id="5737645">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737651">Size</span><span class="op" id="5737655">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737662">uint64</span><span class="op" id="5737668">(</span><span class="ident" id="5737669">sh</span><span class="op" id="5737671">.</span><span class="ident" id="5737672">Size</span><span class="op" id="5737676">)</span><span class="op" id="5737677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737683">Link</span><span class="op" id="5737687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5737694">uint32</span><span class="op" id="5737700">(</span><span class="ident" id="5737701">sh</span><span class="op" id="5737703">.</span><span class="ident" id="5737704">Link</span><span class="op" id="5737708">)</span><span class="op" id="5737709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737715">Info</span><span class="op" id="5737719">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5737726">uint32</span><span class="op" id="5737732">(</span><span class="ident" id="5737733">sh</span><span class="op" id="5737735">.</span><span class="ident" id="5737736">Info</span><span class="op" id="5737740">)</span><span class="op" id="5737741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737747">Addralign</span><span class="op" id="5737756">:</span>&nbsp;<span class="ident" id="5737758">uint64</span><span class="op" id="5737764">(</span><span class="ident" id="5737765">sh</span><span class="op" id="5737767">.</span><span class="ident" id="5737768">Addralign</span><span class="op" id="5737777">)</span><span class="op" id="5737778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737784">Entsize</span><span class="op" id="5737791">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5737795">uint64</span><span class="op" id="5737801">(</span><span class="ident" id="5737802">sh</span><span class="op" id="5737804">.</span><span class="ident" id="5737805">Entsize</span><span class="op" id="5737812">)</span><span class="op" id="5737813">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737822">case</span>&nbsp;<span class="ident" id="5737827">ELFCLASS64</span><span class="op" id="5737837">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737842">sh</span>&nbsp;<span class="op" id="5737845">:=</span>&nbsp;<span class="builtinfunc" id="5737848">new</span><span class="op" id="5737851">(</span><span class="ident" id="5737852">Section64</span><span class="op" id="5737861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737866">if</span>&nbsp;<span class="ident" id="5737869">err</span>&nbsp;<span class="op" id="5737873">:=</span>&nbsp;<span class="ident" id="5737876">binary</span><span class="op" id="5737882">.</span><span class="ident" id="5737883">Read</span><span class="op" id="5737887">(</span><span class="ident" id="5737888">sr</span><span class="op" id="5737890">,</span>&nbsp;<span class="ident" id="5737892">f</span><span class="op" id="5737893">.</span><span class="ident" id="5737894">ByteOrder</span><span class="op" id="5737903">,</span>&nbsp;<span class="ident" id="5737905">sh</span><span class="op" id="5737907">)</span><span class="op" id="5737908">;</span>&nbsp;<span class="ident" id="5737910">err</span>&nbsp;<span class="op" id="5737914">!=</span>&nbsp;<span class="builtintype" id="5737917">nil</span>&nbsp;<span class="op" id="5737921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5737927">return</span>&nbsp;<span class="builtintype" id="5737934">nil</span><span class="op" id="5737937">,</span>&nbsp;<span class="ident" id="5737939">err</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5737946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737951">names</span><span class="op" id="5737956">[</span><span class="ident" id="5737957">i</span><span class="op" id="5737958">]</span>&nbsp;<span class="op" id="5737960">=</span>&nbsp;<span class="ident" id="5737962">sh</span><span class="op" id="5737964">.</span><span class="ident" id="5737965">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5737973">s</span><span class="op" id="5737974">.</span><span class="ident" id="5737975">SectionHeader</span>&nbsp;<span class="op" id="5737989">=</span>&nbsp;<span class="ident" id="5737991">SectionHeader</span><span class="op" id="5738004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738010">Type</span><span class="op" id="5738014">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738021">SectionType</span><span class="op" id="5738032">(</span><span class="ident" id="5738033">sh</span><span class="op" id="5738035">.</span><span class="ident" id="5738036">Type</span><span class="op" id="5738040">)</span><span class="op" id="5738041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738047">Flags</span><span class="op" id="5738052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738058">SectionFlag</span><span class="op" id="5738069">(</span><span class="ident" id="5738070">sh</span><span class="op" id="5738072">.</span><span class="ident" id="5738073">Flags</span><span class="op" id="5738078">)</span><span class="op" id="5738079">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738085">Offset</span><span class="op" id="5738091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738096">uint64</span><span class="op" id="5738102">(</span><span class="ident" id="5738103">sh</span><span class="op" id="5738105">.</span><span class="ident" id="5738106">Off</span><span class="op" id="5738109">)</span><span class="op" id="5738110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738116">Size</span><span class="op" id="5738120">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738127">uint64</span><span class="op" id="5738133">(</span><span class="ident" id="5738134">sh</span><span class="op" id="5738136">.</span><span class="ident" id="5738137">Size</span><span class="op" id="5738141">)</span><span class="op" id="5738142">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738148">Addr</span><span class="op" id="5738152">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738159">uint64</span><span class="op" id="5738165">(</span><span class="ident" id="5738166">sh</span><span class="op" id="5738168">.</span><span class="ident" id="5738169">Addr</span><span class="op" id="5738173">)</span><span class="op" id="5738174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738180">Link</span><span class="op" id="5738184">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5738191">uint32</span><span class="op" id="5738197">(</span><span class="ident" id="5738198">sh</span><span class="op" id="5738200">.</span><span class="ident" id="5738201">Link</span><span class="op" id="5738205">)</span><span class="op" id="5738206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738212">Info</span><span class="op" id="5738216">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5738223">uint32</span><span class="op" id="5738229">(</span><span class="ident" id="5738230">sh</span><span class="op" id="5738232">.</span><span class="ident" id="5738233">Info</span><span class="op" id="5738237">)</span><span class="op" id="5738238">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738244">Addralign</span><span class="op" id="5738253">:</span>&nbsp;<span class="ident" id="5738255">uint64</span><span class="op" id="5738261">(</span><span class="ident" id="5738262">sh</span><span class="op" id="5738264">.</span><span class="ident" id="5738265">Addralign</span><span class="op" id="5738274">)</span><span class="op" id="5738275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738281">Entsize</span><span class="op" id="5738288">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5738292">uint64</span><span class="op" id="5738298">(</span><span class="ident" id="5738299">sh</span><span class="op" id="5738301">.</span><span class="ident" id="5738302">Entsize</span><span class="op" id="5738309">)</span><span class="op" id="5738310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738323">s</span><span class="op" id="5738324">.</span><span class="ident" id="5738325">sr</span>&nbsp;<span class="op" id="5738328">=</span>&nbsp;<span class="ident" id="5738330">io</span><span class="op" id="5738332">.</span><span class="ident" id="5738333">NewSectionReader</span><span class="op" id="5738349">(</span><span class="ident" id="5738350">r</span><span class="op" id="5738351">,</span>&nbsp;<span class="ident" id="5738353">int64</span><span class="op" id="5738358">(</span><span class="ident" id="5738359">s</span><span class="op" id="5738360">.</span><span class="ident" id="5738361">Offset</span><span class="op" id="5738367">)</span><span class="op" id="5738368">,</span>&nbsp;<span class="ident" id="5738370">int64</span><span class="op" id="5738375">(</span><span class="ident" id="5738376">s</span><span class="op" id="5738377">.</span><span class="ident" id="5738378">Size</span><span class="op" id="5738382">)</span><span class="op" id="5738383">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738387">s</span><span class="op" id="5738388">.</span><span class="ident" id="5738389">ReaderAt</span>&nbsp;<span class="op" id="5738398">=</span>&nbsp;<span class="ident" id="5738400">s</span><span class="op" id="5738401">.</span><span class="ident" id="5738402">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738407">f</span><span class="op" id="5738408">.</span><span class="ident" id="5738409">Sections</span><span class="op" id="5738417">[</span><span class="ident" id="5738418">i</span><span class="op" id="5738419">]</span>&nbsp;<span class="op" id="5738421">=</span>&nbsp;<span class="ident" id="5738423">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738430">if</span>&nbsp;<span class="builtinfunc" id="5738433">len</span><span class="op" id="5738436">(</span><span class="ident" id="5738437">f</span><span class="op" id="5738438">.</span><span class="ident" id="5738439">Sections</span><span class="op" id="5738447">)</span>&nbsp;<span class="op" id="5738449">==</span>&nbsp;<span class="num" id="5738452">0</span>&nbsp;<span class="op" id="5738454">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738458">return</span>&nbsp;<span class="ident" id="5738465">f</span><span class="op" id="5738466">,</span>&nbsp;<span class="builtintype" id="5738468">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5738477">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738515">shstrtab</span><span class="op" id="5738523">,</span>&nbsp;<span class="ident" id="5738525">err</span>&nbsp;<span class="op" id="5738529">:=</span>&nbsp;<span class="ident" id="5738532">f</span><span class="op" id="5738533">.</span><span class="ident" id="5738534">Sections</span><span class="op" id="5738542">[</span><span class="ident" id="5738543">shstrndx</span><span class="op" id="5738551">]</span><span class="op" id="5738552">.</span><span class="ident" id="5738553">Data</span><span class="op" id="5738557">(</span><span class="op" id="5738558">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738561">if</span>&nbsp;<span class="ident" id="5738564">err</span>&nbsp;<span class="op" id="5738568">!=</span>&nbsp;<span class="builtintype" id="5738571">nil</span>&nbsp;<span class="op" id="5738575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738579">return</span>&nbsp;<span class="builtintype" id="5738586">nil</span><span class="op" id="5738589">,</span>&nbsp;<span class="ident" id="5738591">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738599">for</span>&nbsp;<span class="ident" id="5738603">i</span><span class="op" id="5738604">,</span>&nbsp;<span class="ident" id="5738606">s</span>&nbsp;<span class="op" id="5738608">:=</span>&nbsp;<span class="keyword" id="5738611">range</span>&nbsp;<span class="ident" id="5738617">f</span><span class="op" id="5738618">.</span><span class="ident" id="5738619">Sections</span>&nbsp;<span class="op" id="5738628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738632">var</span>&nbsp;<span class="ident" id="5738636">ok</span>&nbsp;<span class="builtintype" id="5738639">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5738646">s</span><span class="op" id="5738647">.</span><span class="ident" id="5738648">Name</span><span class="op" id="5738652">,</span>&nbsp;<span class="ident" id="5738654">ok</span>&nbsp;<span class="op" id="5738657">=</span>&nbsp;<span class="ident" id="5738659">getString</span><span class="op" id="5738668">(</span><span class="ident" id="5738669">shstrtab</span><span class="op" id="5738677">,</span>&nbsp;<span class="builtintype" id="5738679">int</span><span class="op" id="5738682">(</span><span class="ident" id="5738683">names</span><span class="op" id="5738688">[</span><span class="ident" id="5738689">i</span><span class="op" id="5738690">]</span><span class="op" id="5738691">)</span><span class="op" id="5738692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738696">if</span>&nbsp;<span class="op" id="5738699">!</span><span class="ident" id="5738700">ok</span>&nbsp;<span class="op" id="5738703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738708">return</span>&nbsp;<span class="builtintype" id="5738715">nil</span><span class="op" id="5738718">,</span>&nbsp;<span class="op" id="5738720">&amp;</span><span class="ident" id="5738721">FormatError</span><span class="op" id="5738732">{</span><span class="ident" id="5738733">shoff</span>&nbsp;<span class="op" id="5738739">+</span>&nbsp;<span class="ident" id="5738741">int64</span><span class="op" id="5738746">(</span><span class="ident" id="5738747">i</span><span class="op" id="5738748">*</span><span class="ident" id="5738749">shentsize</span><span class="op" id="5738758">)</span><span class="op" id="5738759">,</span>&nbsp;<span class="string" id="5738761">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="5738785">,</span>&nbsp;<span class="ident" id="5738787">names</span><span class="op" id="5738792">[</span><span class="ident" id="5738793">i</span><span class="op" id="5738794">]</span><span class="op" id="5738795">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5738802">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5738806">return</span>&nbsp;<span class="ident" id="5738813">f</span><span class="op" id="5738814">,</span>&nbsp;<span class="builtintype" id="5738816">nil</span><br>
<span class="lineno"></span><span class="op" id="5738820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5738823">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="5738894">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5738958">func</span>&nbsp;<span class="op" id="5738963">(</span><span class="ident" id="5738964">f</span>&nbsp;<span class="op" id="5738966">*</span><span class="ident" id="5738967">File</span><span class="op" id="5738971">)</span>&nbsp;<span class="ident" id="5738973">getSymbols</span><span class="op" id="5738983">(</span><span class="ident" id="5738984">typ</span>&nbsp;<span class="ident" id="5738988">SectionType</span><span class="op" id="5738999">)</span>&nbsp;<span class="op" id="5739001">(</span><span class="op" id="5739002">[</span><span class="op" id="5739003">]</span><span class="ident" id="5739004">Symbol</span><span class="op" id="5739010">,</span>&nbsp;<span class="op" id="5739012">[</span><span class="op" id="5739013">]</span><span class="builtintype" id="5739014">byte</span><span class="op" id="5739018">,</span>&nbsp;<span class="builtintype" id="5739020">error</span><span class="op" id="5739025">)</span>&nbsp;<span class="op" id="5739027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739030">switch</span>&nbsp;<span class="ident" id="5739037">f</span><span class="op" id="5739038">.</span><span class="ident" id="5739039">Class</span>&nbsp;<span class="op" id="5739045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739048">case</span>&nbsp;<span class="ident" id="5739053">ELFCLASS64</span><span class="op" id="5739063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739067">return</span>&nbsp;<span class="ident" id="5739074">f</span><span class="op" id="5739075">.</span><span class="ident" id="5739076">getSymbols64</span><span class="op" id="5739088">(</span><span class="ident" id="5739089">typ</span><span class="op" id="5739092">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739096">case</span>&nbsp;<span class="ident" id="5739101">ELFCLASS32</span><span class="op" id="5739111">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739115">return</span>&nbsp;<span class="ident" id="5739122">f</span><span class="op" id="5739123">.</span><span class="ident" id="5739124">getSymbols32</span><span class="op" id="5739136">(</span><span class="ident" id="5739137">typ</span><span class="op" id="5739140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739147">return</span>&nbsp;<span class="builtintype" id="5739154">nil</span><span class="op" id="5739157">,</span>&nbsp;<span class="builtintype" id="5739159">nil</span><span class="op" id="5739162">,</span>&nbsp;<span class="ident" id="5739164">errors</span><span class="op" id="5739170">.</span><span class="ident" id="5739171">New</span><span class="op" id="5739174">(</span><span class="string" id="5739175">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5739192">)</span><br>
<span class="lineno"></span><span class="op" id="5739194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5739197">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="5739265">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="5739309">var</span>&nbsp;<span class="ident" id="5739313">ErrNoSymbols</span>&nbsp;<span class="op" id="5739326">=</span>&nbsp;<span class="ident" id="5739328">errors</span><span class="op" id="5739334">.</span><span class="ident" id="5739335">New</span><span class="op" id="5739338">(</span><span class="string" id="5739339">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5739358">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5739361">func</span>&nbsp;<span class="op" id="5739366">(</span><span class="ident" id="5739367">f</span>&nbsp;<span class="op" id="5739369">*</span><span class="ident" id="5739370">File</span><span class="op" id="5739374">)</span>&nbsp;<span class="ident" id="5739376">getSymbols32</span><span class="op" id="5739388">(</span><span class="ident" id="5739389">typ</span>&nbsp;<span class="ident" id="5739393">SectionType</span><span class="op" id="5739404">)</span>&nbsp;<span class="op" id="5739406">(</span><span class="op" id="5739407">[</span><span class="op" id="5739408">]</span><span class="ident" id="5739409">Symbol</span><span class="op" id="5739415">,</span>&nbsp;<span class="op" id="5739417">[</span><span class="op" id="5739418">]</span><span class="builtintype" id="5739419">byte</span><span class="op" id="5739423">,</span>&nbsp;<span class="builtintype" id="5739425">error</span><span class="op" id="5739430">)</span>&nbsp;<span class="op" id="5739432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739435">symtabSection</span>&nbsp;<span class="op" id="5739449">:=</span>&nbsp;<span class="ident" id="5739452">f</span><span class="op" id="5739453">.</span><span class="ident" id="5739454">SectionByType</span><span class="op" id="5739467">(</span><span class="ident" id="5739468">typ</span><span class="op" id="5739471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739474">if</span>&nbsp;<span class="ident" id="5739477">symtabSection</span>&nbsp;<span class="op" id="5739491">==</span>&nbsp;<span class="builtintype" id="5739494">nil</span>&nbsp;<span class="op" id="5739498">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739502">return</span>&nbsp;<span class="builtintype" id="5739509">nil</span><span class="op" id="5739512">,</span>&nbsp;<span class="builtintype" id="5739514">nil</span><span class="op" id="5739517">,</span>&nbsp;<span class="ident" id="5739519">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739533">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739537">data</span><span class="op" id="5739541">,</span>&nbsp;<span class="ident" id="5739543">err</span>&nbsp;<span class="op" id="5739547">:=</span>&nbsp;<span class="ident" id="5739550">symtabSection</span><span class="op" id="5739563">.</span><span class="ident" id="5739564">Data</span><span class="op" id="5739568">(</span><span class="op" id="5739569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739572">if</span>&nbsp;<span class="ident" id="5739575">err</span>&nbsp;<span class="op" id="5739579">!=</span>&nbsp;<span class="builtintype" id="5739582">nil</span>&nbsp;<span class="op" id="5739586">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739590">return</span>&nbsp;<span class="builtintype" id="5739597">nil</span><span class="op" id="5739600">,</span>&nbsp;<span class="builtintype" id="5739602">nil</span><span class="op" id="5739605">,</span>&nbsp;<span class="ident" id="5739607">errors</span><span class="op" id="5739613">.</span><span class="ident" id="5739614">New</span><span class="op" id="5739617">(</span><span class="string" id="5739618">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5739646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739652">symtab</span>&nbsp;<span class="op" id="5739659">:=</span>&nbsp;<span class="ident" id="5739662">bytes</span><span class="op" id="5739667">.</span><span class="ident" id="5739668">NewReader</span><span class="op" id="5739677">(</span><span class="ident" id="5739678">data</span><span class="op" id="5739682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739685">if</span>&nbsp;<span class="ident" id="5739688">symtab</span><span class="op" id="5739694">.</span><span class="ident" id="5739695">Len</span><span class="op" id="5739698">(</span><span class="op" id="5739699">)</span><span class="op" id="5739700">%</span><span class="ident" id="5739701">Sym32Size</span>&nbsp;<span class="op" id="5739711">!=</span>&nbsp;<span class="num" id="5739714">0</span>&nbsp;<span class="op" id="5739716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739720">return</span>&nbsp;<span class="builtintype" id="5739727">nil</span><span class="op" id="5739730">,</span>&nbsp;<span class="builtintype" id="5739732">nil</span><span class="op" id="5739735">,</span>&nbsp;<span class="ident" id="5739737">errors</span><span class="op" id="5739743">.</span><span class="ident" id="5739744">New</span><span class="op" id="5739747">(</span><span class="string" id="5739748">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="5739803">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5739810">strdata</span><span class="op" id="5739817">,</span>&nbsp;<span class="ident" id="5739819">err</span>&nbsp;<span class="op" id="5739823">:=</span>&nbsp;<span class="ident" id="5739826">f</span><span class="op" id="5739827">.</span><span class="ident" id="5739828">stringTable</span><span class="op" id="5739839">(</span><span class="ident" id="5739840">symtabSection</span><span class="op" id="5739853">.</span><span class="ident" id="5739854">Link</span><span class="op" id="5739858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739861">if</span>&nbsp;<span class="ident" id="5739864">err</span>&nbsp;<span class="op" id="5739868">!=</span>&nbsp;<span class="builtintype" id="5739871">nil</span>&nbsp;<span class="op" id="5739875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739879">return</span>&nbsp;<span class="builtintype" id="5739886">nil</span><span class="op" id="5739889">,</span>&nbsp;<span class="builtintype" id="5739891">nil</span><span class="op" id="5739894">,</span>&nbsp;<span class="ident" id="5739896">errors</span><span class="op" id="5739902">.</span><span class="ident" id="5739903">New</span><span class="op" id="5739906">(</span><span class="string" id="5739907">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5739941">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5739944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5739948">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5739982">var</span>&nbsp;<span class="ident" id="5739986">skip</span>&nbsp;<span class="op" id="5739991">[</span><span class="ident" id="5739992">Sym32Size</span><span class="op" id="5740001">]</span><span class="builtintype" id="5740002">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740008">symtab</span><span class="op" id="5740014">.</span><span class="ident" id="5740015">Read</span><span class="op" id="5740019">(</span><span class="ident" id="5740020">skip</span><span class="op" id="5740024">[</span><span class="op" id="5740025">:</span><span class="op" id="5740026">]</span><span class="op" id="5740027">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740031">symbols</span>&nbsp;<span class="op" id="5740039">:=</span>&nbsp;<span class="builtinfunc" id="5740042">make</span><span class="op" id="5740046">(</span><span class="op" id="5740047">[</span><span class="op" id="5740048">]</span><span class="ident" id="5740049">Symbol</span><span class="op" id="5740055">,</span>&nbsp;<span class="ident" id="5740057">symtab</span><span class="op" id="5740063">.</span><span class="ident" id="5740064">Len</span><span class="op" id="5740067">(</span><span class="op" id="5740068">)</span><span class="op" id="5740069">/</span><span class="ident" id="5740070">Sym32Size</span><span class="op" id="5740079">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740083">i</span>&nbsp;<span class="op" id="5740085">:=</span>&nbsp;<span class="num" id="5740088">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740091">var</span>&nbsp;<span class="ident" id="5740095">sym</span>&nbsp;<span class="ident" id="5740099">Sym32</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740106">for</span>&nbsp;<span class="ident" id="5740110">symtab</span><span class="op" id="5740116">.</span><span class="ident" id="5740117">Len</span><span class="op" id="5740120">(</span><span class="op" id="5740121">)</span>&nbsp;<span class="op" id="5740123">&gt;</span>&nbsp;<span class="num" id="5740125">0</span>&nbsp;<span class="op" id="5740127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740131">binary</span><span class="op" id="5740137">.</span><span class="ident" id="5740138">Read</span><span class="op" id="5740142">(</span><span class="ident" id="5740143">symtab</span><span class="op" id="5740149">,</span>&nbsp;<span class="ident" id="5740151">f</span><span class="op" id="5740152">.</span><span class="ident" id="5740153">ByteOrder</span><span class="op" id="5740162">,</span>&nbsp;<span class="op" id="5740164">&amp;</span><span class="ident" id="5740165">sym</span><span class="op" id="5740168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740172">str</span><span class="op" id="5740175">,</span>&nbsp;<span class="ident" id="5740177">_</span>&nbsp;<span class="op" id="5740179">:=</span>&nbsp;<span class="ident" id="5740182">getString</span><span class="op" id="5740191">(</span><span class="ident" id="5740192">strdata</span><span class="op" id="5740199">,</span>&nbsp;<span class="builtintype" id="5740201">int</span><span class="op" id="5740204">(</span><span class="ident" id="5740205">sym</span><span class="op" id="5740208">.</span><span class="ident" id="5740209">Name</span><span class="op" id="5740213">)</span><span class="op" id="5740214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740218">symbols</span><span class="op" id="5740225">[</span><span class="ident" id="5740226">i</span><span class="op" id="5740227">]</span><span class="op" id="5740228">.</span><span class="ident" id="5740229">Name</span>&nbsp;<span class="op" id="5740234">=</span>&nbsp;<span class="ident" id="5740236">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740242">symbols</span><span class="op" id="5740249">[</span><span class="ident" id="5740250">i</span><span class="op" id="5740251">]</span><span class="op" id="5740252">.</span><span class="ident" id="5740253">Info</span>&nbsp;<span class="op" id="5740258">=</span>&nbsp;<span class="ident" id="5740260">sym</span><span class="op" id="5740263">.</span><span class="ident" id="5740264">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740271">symbols</span><span class="op" id="5740278">[</span><span class="ident" id="5740279">i</span><span class="op" id="5740280">]</span><span class="op" id="5740281">.</span><span class="ident" id="5740282">Other</span>&nbsp;<span class="op" id="5740288">=</span>&nbsp;<span class="ident" id="5740290">sym</span><span class="op" id="5740293">.</span><span class="ident" id="5740294">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740302">symbols</span><span class="op" id="5740309">[</span><span class="ident" id="5740310">i</span><span class="op" id="5740311">]</span><span class="op" id="5740312">.</span><span class="ident" id="5740313">Section</span>&nbsp;<span class="op" id="5740321">=</span>&nbsp;<span class="ident" id="5740323">SectionIndex</span><span class="op" id="5740335">(</span><span class="ident" id="5740336">sym</span><span class="op" id="5740339">.</span><span class="ident" id="5740340">Shndx</span><span class="op" id="5740345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740349">symbols</span><span class="op" id="5740356">[</span><span class="ident" id="5740357">i</span><span class="op" id="5740358">]</span><span class="op" id="5740359">.</span><span class="ident" id="5740360">Value</span>&nbsp;<span class="op" id="5740366">=</span>&nbsp;<span class="ident" id="5740368">uint64</span><span class="op" id="5740374">(</span><span class="ident" id="5740375">sym</span><span class="op" id="5740378">.</span><span class="ident" id="5740379">Value</span><span class="op" id="5740384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740388">symbols</span><span class="op" id="5740395">[</span><span class="ident" id="5740396">i</span><span class="op" id="5740397">]</span><span class="op" id="5740398">.</span><span class="ident" id="5740399">Size</span>&nbsp;<span class="op" id="5740404">=</span>&nbsp;<span class="ident" id="5740406">uint64</span><span class="op" id="5740412">(</span><span class="ident" id="5740413">sym</span><span class="op" id="5740416">.</span><span class="ident" id="5740417">Size</span><span class="op" id="5740421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740425">i</span><span class="op" id="5740426">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740434">return</span>&nbsp;<span class="ident" id="5740441">symbols</span><span class="op" id="5740448">,</span>&nbsp;<span class="ident" id="5740450">strdata</span><span class="op" id="5740457">,</span>&nbsp;<span class="builtintype" id="5740459">nil</span><br>
<span class="lineno"></span><span class="op" id="5740463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="5740466">func</span>&nbsp;<span class="op" id="5740471">(</span><span class="ident" id="5740472">f</span>&nbsp;<span class="op" id="5740474">*</span><span class="ident" id="5740475">File</span><span class="op" id="5740479">)</span>&nbsp;<span class="ident" id="5740481">getSymbols64</span><span class="op" id="5740493">(</span><span class="ident" id="5740494">typ</span>&nbsp;<span class="ident" id="5740498">SectionType</span><span class="op" id="5740509">)</span>&nbsp;<span class="op" id="5740511">(</span><span class="op" id="5740512">[</span><span class="op" id="5740513">]</span><span class="ident" id="5740514">Symbol</span><span class="op" id="5740520">,</span>&nbsp;<span class="op" id="5740522">[</span><span class="op" id="5740523">]</span><span class="builtintype" id="5740524">byte</span><span class="op" id="5740528">,</span>&nbsp;<span class="builtintype" id="5740530">error</span><span class="op" id="5740535">)</span>&nbsp;<span class="op" id="5740537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740540">symtabSection</span>&nbsp;<span class="op" id="5740554">:=</span>&nbsp;<span class="ident" id="5740557">f</span><span class="op" id="5740558">.</span><span class="ident" id="5740559">SectionByType</span><span class="op" id="5740572">(</span><span class="ident" id="5740573">typ</span><span class="op" id="5740576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740579">if</span>&nbsp;<span class="ident" id="5740582">symtabSection</span>&nbsp;<span class="op" id="5740596">==</span>&nbsp;<span class="builtintype" id="5740599">nil</span>&nbsp;<span class="op" id="5740603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740607">return</span>&nbsp;<span class="builtintype" id="5740614">nil</span><span class="op" id="5740617">,</span>&nbsp;<span class="builtintype" id="5740619">nil</span><span class="op" id="5740622">,</span>&nbsp;<span class="ident" id="5740624">ErrNoSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740638">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740642">data</span><span class="op" id="5740646">,</span>&nbsp;<span class="ident" id="5740648">err</span>&nbsp;<span class="op" id="5740652">:=</span>&nbsp;<span class="ident" id="5740655">symtabSection</span><span class="op" id="5740668">.</span><span class="ident" id="5740669">Data</span><span class="op" id="5740673">(</span><span class="op" id="5740674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740677">if</span>&nbsp;<span class="ident" id="5740680">err</span>&nbsp;<span class="op" id="5740684">!=</span>&nbsp;<span class="builtintype" id="5740687">nil</span>&nbsp;<span class="op" id="5740691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740695">return</span>&nbsp;<span class="builtintype" id="5740702">nil</span><span class="op" id="5740705">,</span>&nbsp;<span class="builtintype" id="5740707">nil</span><span class="op" id="5740710">,</span>&nbsp;<span class="ident" id="5740712">errors</span><span class="op" id="5740718">.</span><span class="ident" id="5740719">New</span><span class="op" id="5740722">(</span><span class="string" id="5740723">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="5740751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740754">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740757">symtab</span>&nbsp;<span class="op" id="5740764">:=</span>&nbsp;<span class="ident" id="5740767">bytes</span><span class="op" id="5740772">.</span><span class="ident" id="5740773">NewReader</span><span class="op" id="5740782">(</span><span class="ident" id="5740783">data</span><span class="op" id="5740787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740790">if</span>&nbsp;<span class="ident" id="5740793">symtab</span><span class="op" id="5740799">.</span><span class="ident" id="5740800">Len</span><span class="op" id="5740803">(</span><span class="op" id="5740804">)</span><span class="op" id="5740805">%</span><span class="ident" id="5740806">Sym64Size</span>&nbsp;<span class="op" id="5740816">!=</span>&nbsp;<span class="num" id="5740819">0</span>&nbsp;<span class="op" id="5740821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740825">return</span>&nbsp;<span class="builtintype" id="5740832">nil</span><span class="op" id="5740835">,</span>&nbsp;<span class="builtintype" id="5740837">nil</span><span class="op" id="5740840">,</span>&nbsp;<span class="ident" id="5740842">errors</span><span class="op" id="5740848">.</span><span class="ident" id="5740849">New</span><span class="op" id="5740852">(</span><span class="string" id="5740853">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="5740910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5740913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5740917">strdata</span><span class="op" id="5740924">,</span>&nbsp;<span class="ident" id="5740926">err</span>&nbsp;<span class="op" id="5740930">:=</span>&nbsp;<span class="ident" id="5740933">f</span><span class="op" id="5740934">.</span><span class="ident" id="5740935">stringTable</span><span class="op" id="5740946">(</span><span class="ident" id="5740947">symtabSection</span><span class="op" id="5740960">.</span><span class="ident" id="5740961">Link</span><span class="op" id="5740965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740968">if</span>&nbsp;<span class="ident" id="5740971">err</span>&nbsp;<span class="op" id="5740975">!=</span>&nbsp;<span class="builtintype" id="5740978">nil</span>&nbsp;<span class="op" id="5740982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5740986">return</span>&nbsp;<span class="builtintype" id="5740993">nil</span><span class="op" id="5740996">,</span>&nbsp;<span class="builtintype" id="5740998">nil</span><span class="op" id="5741001">,</span>&nbsp;<span class="ident" id="5741003">errors</span><span class="op" id="5741009">.</span><span class="ident" id="5741010">New</span><span class="op" id="5741013">(</span><span class="string" id="5741014">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="5741048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5741051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5741055">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741089">var</span>&nbsp;<span class="ident" id="5741093">skip</span>&nbsp;<span class="op" id="5741098">[</span><span class="ident" id="5741099">Sym64Size</span><span class="op" id="5741108">]</span><span class="builtintype" id="5741109">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741115">symtab</span><span class="op" id="5741121">.</span><span class="ident" id="5741122">Read</span><span class="op" id="5741126">(</span><span class="ident" id="5741127">skip</span><span class="op" id="5741131">[</span><span class="op" id="5741132">:</span><span class="op" id="5741133">]</span><span class="op" id="5741134">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741138">symbols</span>&nbsp;<span class="op" id="5741146">:=</span>&nbsp;<span class="builtinfunc" id="5741149">make</span><span class="op" id="5741153">(</span><span class="op" id="5741154">[</span><span class="op" id="5741155">]</span><span class="ident" id="5741156">Symbol</span><span class="op" id="5741162">,</span>&nbsp;<span class="ident" id="5741164">symtab</span><span class="op" id="5741170">.</span><span class="ident" id="5741171">Len</span><span class="op" id="5741174">(</span><span class="op" id="5741175">)</span><span class="op" id="5741176">/</span><span class="ident" id="5741177">Sym64Size</span><span class="op" id="5741186">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741190">i</span>&nbsp;<span class="op" id="5741192">:=</span>&nbsp;<span class="num" id="5741195">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741198">var</span>&nbsp;<span class="ident" id="5741202">sym</span>&nbsp;<span class="ident" id="5741206">Sym64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741213">for</span>&nbsp;<span class="ident" id="5741217">symtab</span><span class="op" id="5741223">.</span><span class="ident" id="5741224">Len</span><span class="op" id="5741227">(</span><span class="op" id="5741228">)</span>&nbsp;<span class="op" id="5741230">&gt;</span>&nbsp;<span class="num" id="5741232">0</span>&nbsp;<span class="op" id="5741234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741238">binary</span><span class="op" id="5741244">.</span><span class="ident" id="5741245">Read</span><span class="op" id="5741249">(</span><span class="ident" id="5741250">symtab</span><span class="op" id="5741256">,</span>&nbsp;<span class="ident" id="5741258">f</span><span class="op" id="5741259">.</span><span class="ident" id="5741260">ByteOrder</span><span class="op" id="5741269">,</span>&nbsp;<span class="op" id="5741271">&amp;</span><span class="ident" id="5741272">sym</span><span class="op" id="5741275">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741279">str</span><span class="op" id="5741282">,</span>&nbsp;<span class="ident" id="5741284">_</span>&nbsp;<span class="op" id="5741286">:=</span>&nbsp;<span class="ident" id="5741289">getString</span><span class="op" id="5741298">(</span><span class="ident" id="5741299">strdata</span><span class="op" id="5741306">,</span>&nbsp;<span class="builtintype" id="5741308">int</span><span class="op" id="5741311">(</span><span class="ident" id="5741312">sym</span><span class="op" id="5741315">.</span><span class="ident" id="5741316">Name</span><span class="op" id="5741320">)</span><span class="op" id="5741321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741325">symbols</span><span class="op" id="5741332">[</span><span class="ident" id="5741333">i</span><span class="op" id="5741334">]</span><span class="op" id="5741335">.</span><span class="ident" id="5741336">Name</span>&nbsp;<span class="op" id="5741341">=</span>&nbsp;<span class="ident" id="5741343">str</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741349">symbols</span><span class="op" id="5741356">[</span><span class="ident" id="5741357">i</span><span class="op" id="5741358">]</span><span class="op" id="5741359">.</span><span class="ident" id="5741360">Info</span>&nbsp;<span class="op" id="5741365">=</span>&nbsp;<span class="ident" id="5741367">sym</span><span class="op" id="5741370">.</span><span class="ident" id="5741371">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741378">symbols</span><span class="op" id="5741385">[</span><span class="ident" id="5741386">i</span><span class="op" id="5741387">]</span><span class="op" id="5741388">.</span><span class="ident" id="5741389">Other</span>&nbsp;<span class="op" id="5741395">=</span>&nbsp;<span class="ident" id="5741397">sym</span><span class="op" id="5741400">.</span><span class="ident" id="5741401">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741409">symbols</span><span class="op" id="5741416">[</span><span class="ident" id="5741417">i</span><span class="op" id="5741418">]</span><span class="op" id="5741419">.</span><span class="ident" id="5741420">Section</span>&nbsp;<span class="op" id="5741428">=</span>&nbsp;<span class="ident" id="5741430">SectionIndex</span><span class="op" id="5741442">(</span><span class="ident" id="5741443">sym</span><span class="op" id="5741446">.</span><span class="ident" id="5741447">Shndx</span><span class="op" id="5741452">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741456">symbols</span><span class="op" id="5741463">[</span><span class="ident" id="5741464">i</span><span class="op" id="5741465">]</span><span class="op" id="5741466">.</span><span class="ident" id="5741467">Value</span>&nbsp;<span class="op" id="5741473">=</span>&nbsp;<span class="ident" id="5741475">sym</span><span class="op" id="5741478">.</span><span class="ident" id="5741479">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741487">symbols</span><span class="op" id="5741494">[</span><span class="ident" id="5741495">i</span><span class="op" id="5741496">]</span><span class="op" id="5741497">.</span><span class="ident" id="5741498">Size</span>&nbsp;<span class="op" id="5741503">=</span>&nbsp;<span class="ident" id="5741505">sym</span><span class="op" id="5741508">.</span><span class="ident" id="5741509">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5741516">i</span><span class="op" id="5741517">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5741521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741525">return</span>&nbsp;<span class="ident" id="5741532">symbols</span><span class="op" id="5741539">,</span>&nbsp;<span class="ident" id="5741541">strdata</span><span class="op" id="5741548">,</span>&nbsp;<span class="builtintype" id="5741550">nil</span><br>
<span class="lineno"></span><span class="op" id="5741554">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5741557">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5741614">func</span>&nbsp;<span class="ident" id="5741619">getString</span><span class="op" id="5741628">(</span><span class="ident" id="5741629">section</span>&nbsp;<span class="op" id="5741637">[</span><span class="op" id="5741638">]</span><span class="builtintype" id="5741639">byte</span><span class="op" id="5741643">,</span>&nbsp;<span class="ident" id="5741645">start</span>&nbsp;<span class="builtintype" id="5741651">int</span><span class="op" id="5741654">)</span>&nbsp;<span class="op" id="5741656">(</span><span class="builtintype" id="5741657">string</span><span class="op" id="5741663">,</span>&nbsp;<span class="builtintype" id="5741665">bool</span><span class="op" id="5741669">)</span>&nbsp;<span class="op" id="5741671">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741674">if</span>&nbsp;<span class="ident" id="5741677">start</span>&nbsp;<span class="op" id="5741683">&lt;</span>&nbsp;<span class="num" id="5741685">0</span>&nbsp;<span class="op" id="5741687">||</span>&nbsp;<span class="ident" id="5741690">start</span>&nbsp;<span class="op" id="5741696">&gt;=</span>&nbsp;<span class="builtinfunc" id="5741699">len</span><span class="op" id="5741702">(</span><span class="ident" id="5741703">section</span><span class="op" id="5741710">)</span>&nbsp;<span class="op" id="5741712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741716">return</span>&nbsp;<span class="string" id="5741723">&#34;&#34;</span><span class="op" id="5741725">,</span>&nbsp;<span class="builtintype" id="5741727">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5741734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741738">for</span>&nbsp;<span class="ident" id="5741742">end</span>&nbsp;<span class="op" id="5741746">:=</span>&nbsp;<span class="ident" id="5741749">start</span><span class="op" id="5741754">;</span>&nbsp;<span class="ident" id="5741756">end</span>&nbsp;<span class="op" id="5741760">&lt;</span>&nbsp;<span class="builtinfunc" id="5741762">len</span><span class="op" id="5741765">(</span><span class="ident" id="5741766">section</span><span class="op" id="5741773">)</span><span class="op" id="5741774">;</span>&nbsp;<span class="ident" id="5741776">end</span><span class="op" id="5741779">++</span>&nbsp;<span class="op" id="5741782">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741786">if</span>&nbsp;<span class="ident" id="5741789">section</span><span class="op" id="5741796">[</span><span class="ident" id="5741797">end</span><span class="op" id="5741800">]</span>&nbsp;<span class="op" id="5741802">==</span>&nbsp;<span class="num" id="5741805">0</span>&nbsp;<span class="op" id="5741807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741812">return</span>&nbsp;<span class="builtintype" id="5741819">string</span><span class="op" id="5741825">(</span><span class="ident" id="5741826">section</span><span class="op" id="5741833">[</span><span class="ident" id="5741834">start</span><span class="op" id="5741839">:</span><span class="ident" id="5741840">end</span><span class="op" id="5741843">]</span><span class="op" id="5741844">)</span><span class="op" id="5741845">,</span>&nbsp;<span class="builtintype" id="5741847">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5741854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5741857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5741860">return</span>&nbsp;<span class="string" id="5741867">&#34;&#34;</span><span class="op" id="5741869">,</span>&nbsp;<span class="builtintype" id="5741871">false</span><br>
<span class="lineno">510</span><span class="op" id="5741877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5741880">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5741948">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5741967">func</span>&nbsp;<span class="op" id="5741972">(</span><span class="ident" id="5741973">f</span>&nbsp;<span class="op" id="5741975">*</span><span class="ident" id="5741976">File</span><span class="op" id="5741980">)</span>&nbsp;<span class="ident" id="5741982">Section</span><span class="op" id="5741989">(</span><span class="ident" id="5741990">name</span>&nbsp;<span class="builtintype" id="5741995">string</span><span class="op" id="5742001">)</span>&nbsp;<span class="op" id="5742003">*</span><span class="ident" id="5742004">Section</span>&nbsp;<span class="op" id="5742012">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742015">for</span>&nbsp;<span class="ident" id="5742019">_</span><span class="op" id="5742020">,</span>&nbsp;<span class="ident" id="5742022">s</span>&nbsp;<span class="op" id="5742024">:=</span>&nbsp;<span class="keyword" id="5742027">range</span>&nbsp;<span class="ident" id="5742033">f</span><span class="op" id="5742034">.</span><span class="ident" id="5742035">Sections</span>&nbsp;<span class="op" id="5742044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742048">if</span>&nbsp;<span class="ident" id="5742051">s</span><span class="op" id="5742052">.</span><span class="ident" id="5742053">Name</span>&nbsp;<span class="op" id="5742058">==</span>&nbsp;<span class="ident" id="5742061">name</span>&nbsp;<span class="op" id="5742066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742071">return</span>&nbsp;<span class="ident" id="5742078">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742085">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742088">return</span>&nbsp;<span class="builtintype" id="5742095">nil</span><br>
<span class="lineno"></span><span class="op" id="5742099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5742102">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="5742180">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="5742199">func</span>&nbsp;<span class="op" id="5742204">(</span><span class="ident" id="5742205">f</span>&nbsp;<span class="op" id="5742207">*</span><span class="ident" id="5742208">File</span><span class="op" id="5742212">)</span>&nbsp;<span class="ident" id="5742214">applyRelocations</span><span class="op" id="5742230">(</span><span class="ident" id="5742231">dst</span>&nbsp;<span class="op" id="5742235">[</span><span class="op" id="5742236">]</span><span class="builtintype" id="5742237">byte</span><span class="op" id="5742241">,</span>&nbsp;<span class="ident" id="5742243">rels</span>&nbsp;<span class="op" id="5742248">[</span><span class="op" id="5742249">]</span><span class="builtintype" id="5742250">byte</span><span class="op" id="5742254">)</span>&nbsp;<span class="builtintype" id="5742256">error</span>&nbsp;<span class="op" id="5742262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742265">if</span>&nbsp;<span class="ident" id="5742268">f</span><span class="op" id="5742269">.</span><span class="ident" id="5742270">Class</span>&nbsp;<span class="op" id="5742276">==</span>&nbsp;<span class="ident" id="5742279">ELFCLASS64</span>&nbsp;<span class="op" id="5742290">&amp;&amp;</span>&nbsp;<span class="ident" id="5742293">f</span><span class="op" id="5742294">.</span><span class="ident" id="5742295">Machine</span>&nbsp;<span class="op" id="5742303">==</span>&nbsp;<span class="ident" id="5742306">EM_X86_64</span>&nbsp;<span class="op" id="5742316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742320">return</span>&nbsp;<span class="ident" id="5742327">f</span><span class="op" id="5742328">.</span><span class="ident" id="5742329">applyRelocationsAMD64</span><span class="op" id="5742350">(</span><span class="ident" id="5742351">dst</span><span class="op" id="5742354">,</span>&nbsp;<span class="ident" id="5742356">rels</span><span class="op" id="5742360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742366">if</span>&nbsp;<span class="ident" id="5742369">f</span><span class="op" id="5742370">.</span><span class="ident" id="5742371">Class</span>&nbsp;<span class="op" id="5742377">==</span>&nbsp;<span class="ident" id="5742380">ELFCLASS32</span>&nbsp;<span class="op" id="5742391">&amp;&amp;</span>&nbsp;<span class="ident" id="5742394">f</span><span class="op" id="5742395">.</span><span class="ident" id="5742396">Machine</span>&nbsp;<span class="op" id="5742404">==</span>&nbsp;<span class="ident" id="5742407">EM_386</span>&nbsp;<span class="op" id="5742414">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742418">return</span>&nbsp;<span class="ident" id="5742425">f</span><span class="op" id="5742426">.</span><span class="ident" id="5742427">applyRelocations386</span><span class="op" id="5742446">(</span><span class="ident" id="5742447">dst</span><span class="op" id="5742450">,</span>&nbsp;<span class="ident" id="5742452">rels</span><span class="op" id="5742456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742462">if</span>&nbsp;<span class="ident" id="5742465">f</span><span class="op" id="5742466">.</span><span class="ident" id="5742467">Class</span>&nbsp;<span class="op" id="5742473">==</span>&nbsp;<span class="ident" id="5742476">ELFCLASS64</span>&nbsp;<span class="op" id="5742487">&amp;&amp;</span>&nbsp;<span class="ident" id="5742490">f</span><span class="op" id="5742491">.</span><span class="ident" id="5742492">Machine</span>&nbsp;<span class="op" id="5742500">==</span>&nbsp;<span class="ident" id="5742503">EM_AARCH64</span>&nbsp;<span class="op" id="5742514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742518">return</span>&nbsp;<span class="ident" id="5742525">f</span><span class="op" id="5742526">.</span><span class="ident" id="5742527">applyRelocationsARM64</span><span class="op" id="5742548">(</span><span class="ident" id="5742549">dst</span><span class="op" id="5742552">,</span>&nbsp;<span class="ident" id="5742554">rels</span><span class="op" id="5742558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742561">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742565">return</span>&nbsp;<span class="ident" id="5742572">errors</span><span class="op" id="5742578">.</span><span class="ident" id="5742579">New</span><span class="op" id="5742582">(</span><span class="string" id="5742583">&#34;not&nbsp;implemented&#34;</span><span class="op" id="5742600">)</span><br>
<span class="lineno"></span><span class="op" id="5742602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5742605">func</span>&nbsp;<span class="op" id="5742610">(</span><span class="ident" id="5742611">f</span>&nbsp;<span class="op" id="5742613">*</span><span class="ident" id="5742614">File</span><span class="op" id="5742618">)</span>&nbsp;<span class="ident" id="5742620">applyRelocationsAMD64</span><span class="op" id="5742641">(</span><span class="ident" id="5742642">dst</span>&nbsp;<span class="op" id="5742646">[</span><span class="op" id="5742647">]</span><span class="builtintype" id="5742648">byte</span><span class="op" id="5742652">,</span>&nbsp;<span class="ident" id="5742654">rels</span>&nbsp;<span class="op" id="5742659">[</span><span class="op" id="5742660">]</span><span class="builtintype" id="5742661">byte</span><span class="op" id="5742665">)</span>&nbsp;<span class="builtintype" id="5742667">error</span>&nbsp;<span class="op" id="5742673">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5742676">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742706">if</span>&nbsp;<span class="builtinfunc" id="5742709">len</span><span class="op" id="5742712">(</span><span class="ident" id="5742713">rels</span><span class="op" id="5742717">)</span><span class="op" id="5742718">%</span><span class="num" id="5742719">24</span>&nbsp;<span class="op" id="5742722">!=</span>&nbsp;<span class="num" id="5742725">0</span>&nbsp;<span class="op" id="5742727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742731">return</span>&nbsp;<span class="ident" id="5742738">errors</span><span class="op" id="5742744">.</span><span class="ident" id="5742745">New</span><span class="op" id="5742748">(</span><span class="string" id="5742749">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5742803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5742810">symbols</span><span class="op" id="5742817">,</span>&nbsp;<span class="ident" id="5742819">_</span><span class="op" id="5742820">,</span>&nbsp;<span class="ident" id="5742822">err</span>&nbsp;<span class="op" id="5742826">:=</span>&nbsp;<span class="ident" id="5742829">f</span><span class="op" id="5742830">.</span><span class="ident" id="5742831">getSymbols</span><span class="op" id="5742841">(</span><span class="ident" id="5742842">SHT_SYMTAB</span><span class="op" id="5742852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742855">if</span>&nbsp;<span class="ident" id="5742858">err</span>&nbsp;<span class="op" id="5742862">!=</span>&nbsp;<span class="builtintype" id="5742865">nil</span>&nbsp;<span class="op" id="5742869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742873">return</span>&nbsp;<span class="ident" id="5742880">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5742885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5742889">b</span>&nbsp;<span class="op" id="5742891">:=</span>&nbsp;<span class="ident" id="5742894">bytes</span><span class="op" id="5742899">.</span><span class="ident" id="5742900">NewReader</span><span class="op" id="5742909">(</span><span class="ident" id="5742910">rels</span><span class="op" id="5742914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742917">var</span>&nbsp;<span class="ident" id="5742921">rela</span>&nbsp;<span class="ident" id="5742926">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5742935">for</span>&nbsp;<span class="ident" id="5742939">b</span><span class="op" id="5742940">.</span><span class="ident" id="5742941">Len</span><span class="op" id="5742944">(</span><span class="op" id="5742945">)</span>&nbsp;<span class="op" id="5742947">&gt;</span>&nbsp;<span class="num" id="5742949">0</span>&nbsp;<span class="op" id="5742951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5742955">binary</span><span class="op" id="5742961">.</span><span class="ident" id="5742962">Read</span><span class="op" id="5742966">(</span><span class="ident" id="5742967">b</span><span class="op" id="5742968">,</span>&nbsp;<span class="ident" id="5742970">f</span><span class="op" id="5742971">.</span><span class="ident" id="5742972">ByteOrder</span><span class="op" id="5742981">,</span>&nbsp;<span class="op" id="5742983">&amp;</span><span class="ident" id="5742984">rela</span><span class="op" id="5742988">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5742992">symNo</span>&nbsp;<span class="op" id="5742998">:=</span>&nbsp;<span class="ident" id="5743001">rela</span><span class="op" id="5743005">.</span><span class="ident" id="5743006">Info</span>&nbsp;<span class="op" id="5743011">&gt;&gt;</span>&nbsp;<span class="num" id="5743014">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5743019">t</span>&nbsp;<span class="op" id="5743021">:=</span>&nbsp;<span class="ident" id="5743024">R_X86_64</span><span class="op" id="5743032">(</span><span class="ident" id="5743033">rela</span><span class="op" id="5743037">.</span><span class="ident" id="5743038">Info</span>&nbsp;<span class="op" id="5743043">&amp;</span>&nbsp;<span class="num" id="5743045">0xffff</span><span class="op" id="5743051">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743056">if</span>&nbsp;<span class="ident" id="5743059">symNo</span>&nbsp;<span class="op" id="5743065">==</span>&nbsp;<span class="num" id="5743068">0</span>&nbsp;<span class="op" id="5743070">||</span>&nbsp;<span class="ident" id="5743073">symNo</span>&nbsp;<span class="op" id="5743079">&gt;</span>&nbsp;<span class="ident" id="5743081">uint64</span><span class="op" id="5743087">(</span><span class="builtinfunc" id="5743088">len</span><span class="op" id="5743091">(</span><span class="ident" id="5743092">symbols</span><span class="op" id="5743099">)</span><span class="op" id="5743100">)</span>&nbsp;<span class="op" id="5743102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743107">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5743122">sym</span>&nbsp;<span class="op" id="5743126">:=</span>&nbsp;<span class="op" id="5743129">&amp;</span><span class="ident" id="5743130">symbols</span><span class="op" id="5743137">[</span><span class="ident" id="5743138">symNo</span><span class="op" id="5743143">-</span><span class="num" id="5743144">1</span><span class="op" id="5743145">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743149">if</span>&nbsp;<span class="ident" id="5743152">SymType</span><span class="op" id="5743159">(</span><span class="ident" id="5743160">sym</span><span class="op" id="5743163">.</span><span class="ident" id="5743164">Info</span><span class="op" id="5743168">&amp;</span><span class="num" id="5743169">0xf</span><span class="op" id="5743172">)</span>&nbsp;<span class="op" id="5743174">!=</span>&nbsp;<span class="ident" id="5743177">STT_SECTION</span>&nbsp;<span class="op" id="5743189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5743194">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743249">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5743265">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5743318">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5743373">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743420">switch</span>&nbsp;<span class="ident" id="5743427">t</span>&nbsp;<span class="op" id="5743429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743433">case</span>&nbsp;<span class="ident" id="5743438">R_X86_64_64</span><span class="op" id="5743449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743454">if</span>&nbsp;<span class="ident" id="5743457">rela</span><span class="op" id="5743461">.</span><span class="ident" id="5743462">Off</span><span class="op" id="5743465">+</span><span class="num" id="5743466">8</span>&nbsp;<span class="op" id="5743468">&gt;=</span>&nbsp;<span class="ident" id="5743471">uint64</span><span class="op" id="5743477">(</span><span class="builtinfunc" id="5743478">len</span><span class="op" id="5743481">(</span><span class="ident" id="5743482">dst</span><span class="op" id="5743485">)</span><span class="op" id="5743486">)</span>&nbsp;<span class="op" id="5743488">||</span>&nbsp;<span class="ident" id="5743491">rela</span><span class="op" id="5743495">.</span><span class="ident" id="5743496">Addend</span>&nbsp;<span class="op" id="5743503">&lt;</span>&nbsp;<span class="num" id="5743505">0</span>&nbsp;<span class="op" id="5743507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743513">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5743530">f</span><span class="op" id="5743531">.</span><span class="ident" id="5743532">ByteOrder</span><span class="op" id="5743541">.</span><span class="ident" id="5743542">PutUint64</span><span class="op" id="5743551">(</span><span class="ident" id="5743552">dst</span><span class="op" id="5743555">[</span><span class="ident" id="5743556">rela</span><span class="op" id="5743560">.</span><span class="ident" id="5743561">Off</span><span class="op" id="5743564">:</span><span class="ident" id="5743565">rela</span><span class="op" id="5743569">.</span><span class="ident" id="5743570">Off</span><span class="op" id="5743573">+</span><span class="num" id="5743574">8</span><span class="op" id="5743575">]</span><span class="op" id="5743576">,</span>&nbsp;<span class="ident" id="5743578">uint64</span><span class="op" id="5743584">(</span><span class="ident" id="5743585">rela</span><span class="op" id="5743589">.</span><span class="ident" id="5743590">Addend</span><span class="op" id="5743596">)</span><span class="op" id="5743597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743601">case</span>&nbsp;<span class="ident" id="5743606">R_X86_64_32</span><span class="op" id="5743617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743622">if</span>&nbsp;<span class="ident" id="5743625">rela</span><span class="op" id="5743629">.</span><span class="ident" id="5743630">Off</span><span class="op" id="5743633">+</span><span class="num" id="5743634">4</span>&nbsp;<span class="op" id="5743636">&gt;=</span>&nbsp;<span class="ident" id="5743639">uint64</span><span class="op" id="5743645">(</span><span class="builtinfunc" id="5743646">len</span><span class="op" id="5743649">(</span><span class="ident" id="5743650">dst</span><span class="op" id="5743653">)</span><span class="op" id="5743654">)</span>&nbsp;<span class="op" id="5743656">||</span>&nbsp;<span class="ident" id="5743659">rela</span><span class="op" id="5743663">.</span><span class="ident" id="5743664">Addend</span>&nbsp;<span class="op" id="5743671">&lt;</span>&nbsp;<span class="num" id="5743673">0</span>&nbsp;<span class="op" id="5743675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743681">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5743698">f</span><span class="op" id="5743699">.</span><span class="ident" id="5743700">ByteOrder</span><span class="op" id="5743709">.</span><span class="ident" id="5743710">PutUint32</span><span class="op" id="5743719">(</span><span class="ident" id="5743720">dst</span><span class="op" id="5743723">[</span><span class="ident" id="5743724">rela</span><span class="op" id="5743728">.</span><span class="ident" id="5743729">Off</span><span class="op" id="5743732">:</span><span class="ident" id="5743733">rela</span><span class="op" id="5743737">.</span><span class="ident" id="5743738">Off</span><span class="op" id="5743741">+</span><span class="num" id="5743742">4</span><span class="op" id="5743743">]</span><span class="op" id="5743744">,</span>&nbsp;<span class="builtintype" id="5743746">uint32</span><span class="op" id="5743752">(</span><span class="ident" id="5743753">rela</span><span class="op" id="5743757">.</span><span class="ident" id="5743758">Addend</span><span class="op" id="5743764">)</span><span class="op" id="5743765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743776">return</span>&nbsp;<span class="builtintype" id="5743783">nil</span><br>
<span class="lineno"></span><span class="op" id="5743787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5743790">func</span>&nbsp;<span class="op" id="5743795">(</span><span class="ident" id="5743796">f</span>&nbsp;<span class="op" id="5743798">*</span><span class="ident" id="5743799">File</span><span class="op" id="5743803">)</span>&nbsp;<span class="ident" id="5743805">applyRelocations386</span><span class="op" id="5743824">(</span><span class="ident" id="5743825">dst</span>&nbsp;<span class="op" id="5743829">[</span><span class="op" id="5743830">]</span><span class="builtintype" id="5743831">byte</span><span class="op" id="5743835">,</span>&nbsp;<span class="ident" id="5743837">rels</span>&nbsp;<span class="op" id="5743842">[</span><span class="op" id="5743843">]</span><span class="builtintype" id="5743844">byte</span><span class="op" id="5743848">)</span>&nbsp;<span class="builtintype" id="5743850">error</span>&nbsp;<span class="op" id="5743856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5743859">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743887">if</span>&nbsp;<span class="builtinfunc" id="5743890">len</span><span class="op" id="5743893">(</span><span class="ident" id="5743894">rels</span><span class="op" id="5743898">)</span><span class="op" id="5743899">%</span><span class="num" id="5743900">8</span>&nbsp;<span class="op" id="5743902">!=</span>&nbsp;<span class="num" id="5743905">0</span>&nbsp;<span class="op" id="5743907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5743911">return</span>&nbsp;<span class="ident" id="5743918">errors</span><span class="op" id="5743924">.</span><span class="ident" id="5743925">New</span><span class="op" id="5743928">(</span><span class="string" id="5743929">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="5743982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5743985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5743989">symbols</span><span class="op" id="5743996">,</span>&nbsp;<span class="ident" id="5743998">_</span><span class="op" id="5743999">,</span>&nbsp;<span class="ident" id="5744001">err</span>&nbsp;<span class="op" id="5744005">:=</span>&nbsp;<span class="ident" id="5744008">f</span><span class="op" id="5744009">.</span><span class="ident" id="5744010">getSymbols</span><span class="op" id="5744020">(</span><span class="ident" id="5744021">SHT_SYMTAB</span><span class="op" id="5744031">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744034">if</span>&nbsp;<span class="ident" id="5744037">err</span>&nbsp;<span class="op" id="5744041">!=</span>&nbsp;<span class="builtintype" id="5744044">nil</span>&nbsp;<span class="op" id="5744048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744052">return</span>&nbsp;<span class="ident" id="5744059">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744068">b</span>&nbsp;<span class="op" id="5744070">:=</span>&nbsp;<span class="ident" id="5744073">bytes</span><span class="op" id="5744078">.</span><span class="ident" id="5744079">NewReader</span><span class="op" id="5744088">(</span><span class="ident" id="5744089">rels</span><span class="op" id="5744093">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744096">var</span>&nbsp;<span class="ident" id="5744100">rel</span>&nbsp;<span class="ident" id="5744104">Rel32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744112">for</span>&nbsp;<span class="ident" id="5744116">b</span><span class="op" id="5744117">.</span><span class="ident" id="5744118">Len</span><span class="op" id="5744121">(</span><span class="op" id="5744122">)</span>&nbsp;<span class="op" id="5744124">&gt;</span>&nbsp;<span class="num" id="5744126">0</span>&nbsp;<span class="op" id="5744128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744132">binary</span><span class="op" id="5744138">.</span><span class="ident" id="5744139">Read</span><span class="op" id="5744143">(</span><span class="ident" id="5744144">b</span><span class="op" id="5744145">,</span>&nbsp;<span class="ident" id="5744147">f</span><span class="op" id="5744148">.</span><span class="ident" id="5744149">ByteOrder</span><span class="op" id="5744158">,</span>&nbsp;<span class="op" id="5744160">&amp;</span><span class="ident" id="5744161">rel</span><span class="op" id="5744164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744168">symNo</span>&nbsp;<span class="op" id="5744174">:=</span>&nbsp;<span class="ident" id="5744177">rel</span><span class="op" id="5744180">.</span><span class="ident" id="5744181">Info</span>&nbsp;<span class="op" id="5744186">&gt;&gt;</span>&nbsp;<span class="num" id="5744189">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744193">t</span>&nbsp;<span class="op" id="5744195">:=</span>&nbsp;<span class="ident" id="5744198">R_386</span><span class="op" id="5744203">(</span><span class="ident" id="5744204">rel</span><span class="op" id="5744207">.</span><span class="ident" id="5744208">Info</span>&nbsp;<span class="op" id="5744213">&amp;</span>&nbsp;<span class="num" id="5744215">0xff</span><span class="op" id="5744219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744224">if</span>&nbsp;<span class="ident" id="5744227">symNo</span>&nbsp;<span class="op" id="5744233">==</span>&nbsp;<span class="num" id="5744236">0</span>&nbsp;<span class="op" id="5744238">||</span>&nbsp;<span class="ident" id="5744241">symNo</span>&nbsp;<span class="op" id="5744247">&gt;</span>&nbsp;<span class="builtintype" id="5744249">uint32</span><span class="op" id="5744255">(</span><span class="builtinfunc" id="5744256">len</span><span class="op" id="5744259">(</span><span class="ident" id="5744260">symbols</span><span class="op" id="5744267">)</span><span class="op" id="5744268">)</span>&nbsp;<span class="op" id="5744270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744275">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744286">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744290">sym</span>&nbsp;<span class="op" id="5744294">:=</span>&nbsp;<span class="op" id="5744297">&amp;</span><span class="ident" id="5744298">symbols</span><span class="op" id="5744305">[</span><span class="ident" id="5744306">symNo</span><span class="op" id="5744311">-</span><span class="num" id="5744312">1</span><span class="op" id="5744313">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744318">if</span>&nbsp;<span class="ident" id="5744321">t</span>&nbsp;<span class="op" id="5744323">==</span>&nbsp;<span class="ident" id="5744326">R_386_32</span>&nbsp;<span class="op" id="5744335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744340">if</span>&nbsp;<span class="ident" id="5744343">rel</span><span class="op" id="5744346">.</span><span class="ident" id="5744347">Off</span><span class="op" id="5744350">+</span><span class="num" id="5744351">4</span>&nbsp;<span class="op" id="5744353">&gt;=</span>&nbsp;<span class="builtintype" id="5744356">uint32</span><span class="op" id="5744362">(</span><span class="builtinfunc" id="5744363">len</span><span class="op" id="5744366">(</span><span class="ident" id="5744367">dst</span><span class="op" id="5744370">)</span><span class="op" id="5744371">)</span>&nbsp;<span class="op" id="5744373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744379">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744391">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744396">val</span>&nbsp;<span class="op" id="5744400">:=</span>&nbsp;<span class="ident" id="5744403">f</span><span class="op" id="5744404">.</span><span class="ident" id="5744405">ByteOrder</span><span class="op" id="5744414">.</span><span class="ident" id="5744415">Uint32</span><span class="op" id="5744421">(</span><span class="ident" id="5744422">dst</span><span class="op" id="5744425">[</span><span class="ident" id="5744426">rel</span><span class="op" id="5744429">.</span><span class="ident" id="5744430">Off</span>&nbsp;<span class="op" id="5744434">:</span>&nbsp;<span class="ident" id="5744436">rel</span><span class="op" id="5744439">.</span><span class="ident" id="5744440">Off</span><span class="op" id="5744443">+</span><span class="num" id="5744444">4</span><span class="op" id="5744445">]</span><span class="op" id="5744446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744451">val</span>&nbsp;<span class="op" id="5744455">+=</span>&nbsp;<span class="builtintype" id="5744458">uint32</span><span class="op" id="5744464">(</span><span class="ident" id="5744465">sym</span><span class="op" id="5744468">.</span><span class="ident" id="5744469">Value</span><span class="op" id="5744474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744479">f</span><span class="op" id="5744480">.</span><span class="ident" id="5744481">ByteOrder</span><span class="op" id="5744490">.</span><span class="ident" id="5744491">PutUint32</span><span class="op" id="5744500">(</span><span class="ident" id="5744501">dst</span><span class="op" id="5744504">[</span><span class="ident" id="5744505">rel</span><span class="op" id="5744508">.</span><span class="ident" id="5744509">Off</span><span class="op" id="5744512">:</span><span class="ident" id="5744513">rel</span><span class="op" id="5744516">.</span><span class="ident" id="5744517">Off</span><span class="op" id="5744520">+</span><span class="num" id="5744521">4</span><span class="op" id="5744522">]</span><span class="op" id="5744523">,</span>&nbsp;<span class="ident" id="5744525">val</span><span class="op" id="5744528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744532">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744539">return</span>&nbsp;<span class="builtintype" id="5744546">nil</span><br>
<span class="lineno"></span><span class="op" id="5744550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="5744553">func</span>&nbsp;<span class="op" id="5744558">(</span><span class="ident" id="5744559">f</span>&nbsp;<span class="op" id="5744561">*</span><span class="ident" id="5744562">File</span><span class="op" id="5744566">)</span>&nbsp;<span class="ident" id="5744568">applyRelocationsARM64</span><span class="op" id="5744589">(</span><span class="ident" id="5744590">dst</span>&nbsp;<span class="op" id="5744594">[</span><span class="op" id="5744595">]</span><span class="builtintype" id="5744596">byte</span><span class="op" id="5744600">,</span>&nbsp;<span class="ident" id="5744602">rels</span>&nbsp;<span class="op" id="5744607">[</span><span class="op" id="5744608">]</span><span class="builtintype" id="5744609">byte</span><span class="op" id="5744613">)</span>&nbsp;<span class="builtintype" id="5744615">error</span>&nbsp;<span class="op" id="5744621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5744624">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744654">if</span>&nbsp;<span class="builtinfunc" id="5744657">len</span><span class="op" id="5744660">(</span><span class="ident" id="5744661">rels</span><span class="op" id="5744665">)</span><span class="op" id="5744666">%</span><span class="num" id="5744667">24</span>&nbsp;<span class="op" id="5744670">!=</span>&nbsp;<span class="num" id="5744673">0</span>&nbsp;<span class="op" id="5744675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744679">return</span>&nbsp;<span class="ident" id="5744686">errors</span><span class="op" id="5744692">.</span><span class="ident" id="5744693">New</span><span class="op" id="5744696">(</span><span class="string" id="5744697">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="5744751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744754">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744758">symbols</span><span class="op" id="5744765">,</span>&nbsp;<span class="ident" id="5744767">_</span><span class="op" id="5744768">,</span>&nbsp;<span class="ident" id="5744770">err</span>&nbsp;<span class="op" id="5744774">:=</span>&nbsp;<span class="ident" id="5744777">f</span><span class="op" id="5744778">.</span><span class="ident" id="5744779">getSymbols</span><span class="op" id="5744789">(</span><span class="ident" id="5744790">SHT_SYMTAB</span><span class="op" id="5744800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744803">if</span>&nbsp;<span class="ident" id="5744806">err</span>&nbsp;<span class="op" id="5744810">!=</span>&nbsp;<span class="builtintype" id="5744813">nil</span>&nbsp;<span class="op" id="5744817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744821">return</span>&nbsp;<span class="ident" id="5744828">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5744833">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744837">b</span>&nbsp;<span class="op" id="5744839">:=</span>&nbsp;<span class="ident" id="5744842">bytes</span><span class="op" id="5744847">.</span><span class="ident" id="5744848">NewReader</span><span class="op" id="5744857">(</span><span class="ident" id="5744858">rels</span><span class="op" id="5744862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744865">var</span>&nbsp;<span class="ident" id="5744869">rela</span>&nbsp;<span class="ident" id="5744874">Rela64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5744883">for</span>&nbsp;<span class="ident" id="5744887">b</span><span class="op" id="5744888">.</span><span class="ident" id="5744889">Len</span><span class="op" id="5744892">(</span><span class="op" id="5744893">)</span>&nbsp;<span class="op" id="5744895">&gt;</span>&nbsp;<span class="num" id="5744897">0</span>&nbsp;<span class="op" id="5744899">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744903">binary</span><span class="op" id="5744909">.</span><span class="ident" id="5744910">Read</span><span class="op" id="5744914">(</span><span class="ident" id="5744915">b</span><span class="op" id="5744916">,</span>&nbsp;<span class="ident" id="5744918">f</span><span class="op" id="5744919">.</span><span class="ident" id="5744920">ByteOrder</span><span class="op" id="5744929">,</span>&nbsp;<span class="op" id="5744931">&amp;</span><span class="ident" id="5744932">rela</span><span class="op" id="5744936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744940">symNo</span>&nbsp;<span class="op" id="5744946">:=</span>&nbsp;<span class="ident" id="5744949">rela</span><span class="op" id="5744953">.</span><span class="ident" id="5744954">Info</span>&nbsp;<span class="op" id="5744959">&gt;&gt;</span>&nbsp;<span class="num" id="5744962">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5744967">t</span>&nbsp;<span class="op" id="5744969">:=</span>&nbsp;<span class="ident" id="5744972">R_AARCH64</span><span class="op" id="5744981">(</span><span class="ident" id="5744982">rela</span><span class="op" id="5744986">.</span><span class="ident" id="5744987">Info</span>&nbsp;<span class="op" id="5744992">&amp;</span>&nbsp;<span class="num" id="5744994">0xffff</span><span class="op" id="5745000">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745005">if</span>&nbsp;<span class="ident" id="5745008">symNo</span>&nbsp;<span class="op" id="5745014">==</span>&nbsp;<span class="num" id="5745017">0</span>&nbsp;<span class="op" id="5745019">||</span>&nbsp;<span class="ident" id="5745022">symNo</span>&nbsp;<span class="op" id="5745028">&gt;</span>&nbsp;<span class="ident" id="5745030">uint64</span><span class="op" id="5745036">(</span><span class="builtinfunc" id="5745037">len</span><span class="op" id="5745040">(</span><span class="ident" id="5745041">symbols</span><span class="op" id="5745048">)</span><span class="op" id="5745049">)</span>&nbsp;<span class="op" id="5745051">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745056">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745067">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5745071">sym</span>&nbsp;<span class="op" id="5745075">:=</span>&nbsp;<span class="op" id="5745078">&amp;</span><span class="ident" id="5745079">symbols</span><span class="op" id="5745086">[</span><span class="ident" id="5745087">symNo</span><span class="op" id="5745092">-</span><span class="num" id="5745093">1</span><span class="op" id="5745094">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745098">if</span>&nbsp;<span class="ident" id="5745101">SymType</span><span class="op" id="5745108">(</span><span class="ident" id="5745109">sym</span><span class="op" id="5745112">.</span><span class="ident" id="5745113">Info</span><span class="op" id="5745117">&amp;</span><span class="num" id="5745118">0xf</span><span class="op" id="5745121">)</span>&nbsp;<span class="op" id="5745123">!=</span>&nbsp;<span class="ident" id="5745126">STT_SECTION</span>&nbsp;<span class="op" id="5745138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745143">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745198">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745209">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745214">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745267">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745322">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745369">switch</span>&nbsp;<span class="ident" id="5745376">t</span>&nbsp;<span class="op" id="5745378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745382">case</span>&nbsp;<span class="ident" id="5745387">R_AARCH64_ABS64</span><span class="op" id="5745402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745407">if</span>&nbsp;<span class="ident" id="5745410">rela</span><span class="op" id="5745414">.</span><span class="ident" id="5745415">Off</span><span class="op" id="5745418">+</span><span class="num" id="5745419">8</span>&nbsp;<span class="op" id="5745421">&gt;=</span>&nbsp;<span class="ident" id="5745424">uint64</span><span class="op" id="5745430">(</span><span class="builtinfunc" id="5745431">len</span><span class="op" id="5745434">(</span><span class="ident" id="5745435">dst</span><span class="op" id="5745438">)</span><span class="op" id="5745439">)</span>&nbsp;<span class="op" id="5745441">||</span>&nbsp;<span class="ident" id="5745444">rela</span><span class="op" id="5745448">.</span><span class="ident" id="5745449">Addend</span>&nbsp;<span class="op" id="5745456">&lt;</span>&nbsp;<span class="num" id="5745458">0</span>&nbsp;<span class="op" id="5745460">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745466">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5745483">f</span><span class="op" id="5745484">.</span><span class="ident" id="5745485">ByteOrder</span><span class="op" id="5745494">.</span><span class="ident" id="5745495">PutUint64</span><span class="op" id="5745504">(</span><span class="ident" id="5745505">dst</span><span class="op" id="5745508">[</span><span class="ident" id="5745509">rela</span><span class="op" id="5745513">.</span><span class="ident" id="5745514">Off</span><span class="op" id="5745517">:</span><span class="ident" id="5745518">rela</span><span class="op" id="5745522">.</span><span class="ident" id="5745523">Off</span><span class="op" id="5745526">+</span><span class="num" id="5745527">8</span><span class="op" id="5745528">]</span><span class="op" id="5745529">,</span>&nbsp;<span class="ident" id="5745531">uint64</span><span class="op" id="5745537">(</span><span class="ident" id="5745538">rela</span><span class="op" id="5745542">.</span><span class="ident" id="5745543">Addend</span><span class="op" id="5745549">)</span><span class="op" id="5745550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745554">case</span>&nbsp;<span class="ident" id="5745559">R_AARCH64_ABS32</span><span class="op" id="5745574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745579">if</span>&nbsp;<span class="ident" id="5745582">rela</span><span class="op" id="5745586">.</span><span class="ident" id="5745587">Off</span><span class="op" id="5745590">+</span><span class="num" id="5745591">4</span>&nbsp;<span class="op" id="5745593">&gt;=</span>&nbsp;<span class="ident" id="5745596">uint64</span><span class="op" id="5745602">(</span><span class="builtinfunc" id="5745603">len</span><span class="op" id="5745606">(</span><span class="ident" id="5745607">dst</span><span class="op" id="5745610">)</span><span class="op" id="5745611">)</span>&nbsp;<span class="op" id="5745613">||</span>&nbsp;<span class="ident" id="5745616">rela</span><span class="op" id="5745620">.</span><span class="ident" id="5745621">Addend</span>&nbsp;<span class="op" id="5745628">&lt;</span>&nbsp;<span class="num" id="5745630">0</span>&nbsp;<span class="op" id="5745632">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745638">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5745655">f</span><span class="op" id="5745656">.</span><span class="ident" id="5745657">ByteOrder</span><span class="op" id="5745666">.</span><span class="ident" id="5745667">PutUint32</span><span class="op" id="5745676">(</span><span class="ident" id="5745677">dst</span><span class="op" id="5745680">[</span><span class="ident" id="5745681">rela</span><span class="op" id="5745685">.</span><span class="ident" id="5745686">Off</span><span class="op" id="5745689">:</span><span class="ident" id="5745690">rela</span><span class="op" id="5745694">.</span><span class="ident" id="5745695">Off</span><span class="op" id="5745698">+</span><span class="num" id="5745699">4</span><span class="op" id="5745700">]</span><span class="op" id="5745701">,</span>&nbsp;<span class="builtintype" id="5745703">uint32</span><span class="op" id="5745709">(</span><span class="ident" id="5745710">rela</span><span class="op" id="5745714">.</span><span class="ident" id="5745715">Addend</span><span class="op" id="5745721">)</span><span class="op" id="5745722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5745729">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745733">return</span>&nbsp;<span class="builtintype" id="5745740">nil</span><br>
<span class="lineno"></span><span class="op" id="5745744">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5745747">func</span>&nbsp;<span class="op" id="5745752">(</span><span class="ident" id="5745753">f</span>&nbsp;<span class="op" id="5745755">*</span><span class="ident" id="5745756">File</span><span class="op" id="5745760">)</span>&nbsp;<span class="ident" id="5745762">DWARF</span><span class="op" id="5745767">(</span><span class="op" id="5745768">)</span>&nbsp;<span class="op" id="5745770">(</span><span class="op" id="5745771">*</span><span class="ident" id="5745772">dwarf</span><span class="op" id="5745777">.</span><span class="ident" id="5745778">Data</span><span class="op" id="5745782">,</span>&nbsp;<span class="builtintype" id="5745784">error</span><span class="op" id="5745789">)</span>&nbsp;<span class="op" id="5745791">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745794">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745845">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5745900">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5745959">var</span>&nbsp;<span class="ident" id="5745963">names</span>&nbsp;<span class="op" id="5745969">=</span>&nbsp;<span class="op" id="5745971">[</span><span class="op" id="5745972">...</span><span class="op" id="5745975">]</span><span class="builtintype" id="5745976">string</span><span class="op" id="5745982">{</span><span class="string" id="5745983">&#34;abbrev&#34;</span><span class="op" id="5745991">,</span>&nbsp;<span class="string" id="5745993">&#34;info&#34;</span><span class="op" id="5745999">,</span>&nbsp;<span class="string" id="5746001">&#34;str&#34;</span><span class="op" id="5746006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746009">var</span>&nbsp;<span class="ident" id="5746013">dat</span>&nbsp;<span class="op" id="5746017">[</span><span class="builtinfunc" id="5746018">len</span><span class="op" id="5746021">(</span><span class="ident" id="5746022">names</span><span class="op" id="5746027">)</span><span class="op" id="5746028">]</span><span class="op" id="5746029">[</span><span class="op" id="5746030">]</span><span class="builtintype" id="5746031">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746037">for</span>&nbsp;<span class="ident" id="5746041">i</span><span class="op" id="5746042">,</span>&nbsp;<span class="ident" id="5746044">name</span>&nbsp;<span class="op" id="5746049">:=</span>&nbsp;<span class="keyword" id="5746052">range</span>&nbsp;<span class="ident" id="5746058">names</span>&nbsp;<span class="op" id="5746064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746068">name</span>&nbsp;<span class="op" id="5746073">=</span>&nbsp;<span class="string" id="5746075">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5746085">+</span>&nbsp;<span class="ident" id="5746087">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746094">s</span>&nbsp;<span class="op" id="5746096">:=</span>&nbsp;<span class="ident" id="5746099">f</span><span class="op" id="5746100">.</span><span class="ident" id="5746101">Section</span><span class="op" id="5746108">(</span><span class="ident" id="5746109">name</span><span class="op" id="5746113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746117">if</span>&nbsp;<span class="ident" id="5746120">s</span>&nbsp;<span class="op" id="5746122">==</span>&nbsp;<span class="builtintype" id="5746125">nil</span>&nbsp;<span class="op" id="5746129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746134">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746149">b</span><span class="op" id="5746150">,</span>&nbsp;<span class="ident" id="5746152">err</span>&nbsp;<span class="op" id="5746156">:=</span>&nbsp;<span class="ident" id="5746159">s</span><span class="op" id="5746160">.</span><span class="ident" id="5746161">Data</span><span class="op" id="5746165">(</span><span class="op" id="5746166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746170">if</span>&nbsp;<span class="ident" id="5746173">err</span>&nbsp;<span class="op" id="5746177">!=</span>&nbsp;<span class="builtintype" id="5746180">nil</span>&nbsp;<span class="op" id="5746184">&amp;&amp;</span>&nbsp;<span class="ident" id="5746187">uint64</span><span class="op" id="5746193">(</span><span class="builtinfunc" id="5746194">len</span><span class="op" id="5746197">(</span><span class="ident" id="5746198">b</span><span class="op" id="5746199">)</span><span class="op" id="5746200">)</span>&nbsp;<span class="op" id="5746202">&lt;</span>&nbsp;<span class="ident" id="5746204">s</span><span class="op" id="5746205">.</span><span class="ident" id="5746206">Size</span>&nbsp;<span class="op" id="5746211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746216">return</span>&nbsp;<span class="builtintype" id="5746223">nil</span><span class="op" id="5746226">,</span>&nbsp;<span class="ident" id="5746228">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746234">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746238">dat</span><span class="op" id="5746241">[</span><span class="ident" id="5746242">i</span><span class="op" id="5746243">]</span>&nbsp;<span class="op" id="5746245">=</span>&nbsp;<span class="ident" id="5746247">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5746254">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5746327">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746400">rela</span>&nbsp;<span class="op" id="5746405">:=</span>&nbsp;<span class="ident" id="5746408">f</span><span class="op" id="5746409">.</span><span class="ident" id="5746410">Section</span><span class="op" id="5746417">(</span><span class="string" id="5746418">&#34;.rela.debug_info&#34;</span><span class="op" id="5746436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746439">if</span>&nbsp;<span class="ident" id="5746442">rela</span>&nbsp;<span class="op" id="5746447">!=</span>&nbsp;<span class="builtintype" id="5746450">nil</span>&nbsp;<span class="op" id="5746454">&amp;&amp;</span>&nbsp;<span class="ident" id="5746457">rela</span><span class="op" id="5746461">.</span><span class="ident" id="5746462">Type</span>&nbsp;<span class="op" id="5746467">==</span>&nbsp;<span class="ident" id="5746470">SHT_RELA</span>&nbsp;<span class="op" id="5746479">&amp;&amp;</span>&nbsp;<span class="op" id="5746482">(</span><span class="ident" id="5746483">f</span><span class="op" id="5746484">.</span><span class="ident" id="5746485">Machine</span>&nbsp;<span class="op" id="5746493">==</span>&nbsp;<span class="ident" id="5746496">EM_X86_64</span>&nbsp;<span class="op" id="5746506">||</span>&nbsp;<span class="ident" id="5746509">f</span><span class="op" id="5746510">.</span><span class="ident" id="5746511">Machine</span>&nbsp;<span class="op" id="5746519">==</span>&nbsp;<span class="ident" id="5746522">EM_AARCH64</span><span class="op" id="5746532">)</span>&nbsp;<span class="op" id="5746534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746538">data</span><span class="op" id="5746542">,</span>&nbsp;<span class="ident" id="5746544">err</span>&nbsp;<span class="op" id="5746548">:=</span>&nbsp;<span class="ident" id="5746551">rela</span><span class="op" id="5746555">.</span><span class="ident" id="5746556">Data</span><span class="op" id="5746560">(</span><span class="op" id="5746561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746565">if</span>&nbsp;<span class="ident" id="5746568">err</span>&nbsp;<span class="op" id="5746572">!=</span>&nbsp;<span class="builtintype" id="5746575">nil</span>&nbsp;<span class="op" id="5746579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746584">return</span>&nbsp;<span class="builtintype" id="5746591">nil</span><span class="op" id="5746594">,</span>&nbsp;<span class="ident" id="5746596">err</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746606">err</span>&nbsp;<span class="op" id="5746610">=</span>&nbsp;<span class="ident" id="5746612">f</span><span class="op" id="5746613">.</span><span class="ident" id="5746614">applyRelocations</span><span class="op" id="5746630">(</span><span class="ident" id="5746631">dat</span><span class="op" id="5746634">[</span><span class="num" id="5746635">1</span><span class="op" id="5746636">]</span><span class="op" id="5746637">,</span>&nbsp;<span class="ident" id="5746639">data</span><span class="op" id="5746643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746647">if</span>&nbsp;<span class="ident" id="5746650">err</span>&nbsp;<span class="op" id="5746654">!=</span>&nbsp;<span class="builtintype" id="5746657">nil</span>&nbsp;<span class="op" id="5746661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746666">return</span>&nbsp;<span class="builtintype" id="5746673">nil</span><span class="op" id="5746676">,</span>&nbsp;<span class="ident" id="5746678">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746684">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5746691">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746757">rel</span>&nbsp;<span class="op" id="5746761">:=</span>&nbsp;<span class="ident" id="5746764">f</span><span class="op" id="5746765">.</span><span class="ident" id="5746766">Section</span><span class="op" id="5746773">(</span><span class="string" id="5746774">&#34;.rel.debug_info&#34;</span><span class="op" id="5746791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746794">if</span>&nbsp;<span class="ident" id="5746797">rel</span>&nbsp;<span class="op" id="5746801">!=</span>&nbsp;<span class="builtintype" id="5746804">nil</span>&nbsp;<span class="op" id="5746808">&amp;&amp;</span>&nbsp;<span class="ident" id="5746811">rel</span><span class="op" id="5746814">.</span><span class="ident" id="5746815">Type</span>&nbsp;<span class="op" id="5746820">==</span>&nbsp;<span class="ident" id="5746823">SHT_REL</span>&nbsp;<span class="op" id="5746831">&amp;&amp;</span>&nbsp;<span class="ident" id="5746834">f</span><span class="op" id="5746835">.</span><span class="ident" id="5746836">Machine</span>&nbsp;<span class="op" id="5746844">==</span>&nbsp;<span class="ident" id="5746847">EM_386</span>&nbsp;<span class="op" id="5746854">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746858">data</span><span class="op" id="5746862">,</span>&nbsp;<span class="ident" id="5746864">err</span>&nbsp;<span class="op" id="5746868">:=</span>&nbsp;<span class="ident" id="5746871">rel</span><span class="op" id="5746874">.</span><span class="ident" id="5746875">Data</span><span class="op" id="5746879">(</span><span class="op" id="5746880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746884">if</span>&nbsp;<span class="ident" id="5746887">err</span>&nbsp;<span class="op" id="5746891">!=</span>&nbsp;<span class="builtintype" id="5746894">nil</span>&nbsp;<span class="op" id="5746898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746903">return</span>&nbsp;<span class="builtintype" id="5746910">nil</span><span class="op" id="5746913">,</span>&nbsp;<span class="ident" id="5746915">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5746921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5746925">err</span>&nbsp;<span class="op" id="5746929">=</span>&nbsp;<span class="ident" id="5746931">f</span><span class="op" id="5746932">.</span><span class="ident" id="5746933">applyRelocations</span><span class="op" id="5746949">(</span><span class="ident" id="5746950">dat</span><span class="op" id="5746953">[</span><span class="num" id="5746954">1</span><span class="op" id="5746955">]</span><span class="op" id="5746956">,</span>&nbsp;<span class="ident" id="5746958">data</span><span class="op" id="5746962">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746966">if</span>&nbsp;<span class="ident" id="5746969">err</span>&nbsp;<span class="op" id="5746973">!=</span>&nbsp;<span class="builtintype" id="5746976">nil</span>&nbsp;<span class="op" id="5746980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5746985">return</span>&nbsp;<span class="builtintype" id="5746992">nil</span><span class="op" id="5746995">,</span>&nbsp;<span class="ident" id="5746997">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747010">abbrev</span><span class="op" id="5747016">,</span>&nbsp;<span class="ident" id="5747018">info</span><span class="op" id="5747022">,</span>&nbsp;<span class="ident" id="5747024">str</span>&nbsp;<span class="op" id="5747028">:=</span>&nbsp;<span class="ident" id="5747031">dat</span><span class="op" id="5747034">[</span><span class="num" id="5747035">0</span><span class="op" id="5747036">]</span><span class="op" id="5747037">,</span>&nbsp;<span class="ident" id="5747039">dat</span><span class="op" id="5747042">[</span><span class="num" id="5747043">1</span><span class="op" id="5747044">]</span><span class="op" id="5747045">,</span>&nbsp;<span class="ident" id="5747047">dat</span><span class="op" id="5747050">[</span><span class="num" id="5747051">2</span><span class="op" id="5747052">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747055">d</span><span class="op" id="5747056">,</span>&nbsp;<span class="ident" id="5747058">err</span>&nbsp;<span class="op" id="5747062">:=</span>&nbsp;<span class="ident" id="5747065">dwarf</span><span class="op" id="5747070">.</span><span class="ident" id="5747071">New</span><span class="op" id="5747074">(</span><span class="ident" id="5747075">abbrev</span><span class="op" id="5747081">,</span>&nbsp;<span class="builtintype" id="5747083">nil</span><span class="op" id="5747086">,</span>&nbsp;<span class="builtintype" id="5747088">nil</span><span class="op" id="5747091">,</span>&nbsp;<span class="ident" id="5747093">info</span><span class="op" id="5747097">,</span>&nbsp;<span class="builtintype" id="5747099">nil</span><span class="op" id="5747102">,</span>&nbsp;<span class="builtintype" id="5747104">nil</span><span class="op" id="5747107">,</span>&nbsp;<span class="builtintype" id="5747109">nil</span><span class="op" id="5747112">,</span>&nbsp;<span class="ident" id="5747114">str</span><span class="op" id="5747117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747120">if</span>&nbsp;<span class="ident" id="5747123">err</span>&nbsp;<span class="op" id="5747127">!=</span>&nbsp;<span class="builtintype" id="5747130">nil</span>&nbsp;<span class="op" id="5747134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747138">return</span>&nbsp;<span class="builtintype" id="5747145">nil</span><span class="op" id="5747148">,</span>&nbsp;<span class="ident" id="5747150">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747155">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5747159">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747202">for</span>&nbsp;<span class="ident" id="5747206">i</span><span class="op" id="5747207">,</span>&nbsp;<span class="ident" id="5747209">s</span>&nbsp;<span class="op" id="5747211">:=</span>&nbsp;<span class="keyword" id="5747214">range</span>&nbsp;<span class="ident" id="5747220">f</span><span class="op" id="5747221">.</span><span class="ident" id="5747222">Sections</span>&nbsp;<span class="op" id="5747231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747235">if</span>&nbsp;<span class="ident" id="5747238">s</span><span class="op" id="5747239">.</span><span class="ident" id="5747240">Name</span>&nbsp;<span class="op" id="5747245">==</span>&nbsp;<span class="string" id="5747248">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="5747263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747268">b</span><span class="op" id="5747269">,</span>&nbsp;<span class="ident" id="5747271">err</span>&nbsp;<span class="op" id="5747275">:=</span>&nbsp;<span class="ident" id="5747278">s</span><span class="op" id="5747279">.</span><span class="ident" id="5747280">Data</span><span class="op" id="5747284">(</span><span class="op" id="5747285">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747290">if</span>&nbsp;<span class="ident" id="5747293">err</span>&nbsp;<span class="op" id="5747297">!=</span>&nbsp;<span class="builtintype" id="5747300">nil</span>&nbsp;<span class="op" id="5747304">&amp;&amp;</span>&nbsp;<span class="ident" id="5747307">uint64</span><span class="op" id="5747313">(</span><span class="builtinfunc" id="5747314">len</span><span class="op" id="5747317">(</span><span class="ident" id="5747318">b</span><span class="op" id="5747319">)</span><span class="op" id="5747320">)</span>&nbsp;<span class="op" id="5747322">&lt;</span>&nbsp;<span class="ident" id="5747324">s</span><span class="op" id="5747325">.</span><span class="ident" id="5747326">Size</span>&nbsp;<span class="op" id="5747331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747337">return</span>&nbsp;<span class="builtintype" id="5747344">nil</span><span class="op" id="5747347">,</span>&nbsp;<span class="ident" id="5747349">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747362">for</span>&nbsp;<span class="ident" id="5747366">_</span><span class="op" id="5747367">,</span>&nbsp;<span class="ident" id="5747369">r</span>&nbsp;<span class="op" id="5747371">:=</span>&nbsp;<span class="keyword" id="5747374">range</span>&nbsp;<span class="ident" id="5747380">f</span><span class="op" id="5747381">.</span><span class="ident" id="5747382">Sections</span>&nbsp;<span class="op" id="5747391">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747397">if</span>&nbsp;<span class="ident" id="5747400">r</span><span class="op" id="5747401">.</span><span class="ident" id="5747402">Type</span>&nbsp;<span class="op" id="5747407">!=</span>&nbsp;<span class="ident" id="5747410">SHT_RELA</span>&nbsp;<span class="op" id="5747419">&amp;&amp;</span>&nbsp;<span class="ident" id="5747422">r</span><span class="op" id="5747423">.</span><span class="ident" id="5747424">Type</span>&nbsp;<span class="op" id="5747429">!=</span>&nbsp;<span class="ident" id="5747432">SHT_REL</span>&nbsp;<span class="op" id="5747440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747447">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747466">if</span>&nbsp;<span class="builtintype" id="5747469">int</span><span class="op" id="5747472">(</span><span class="ident" id="5747473">r</span><span class="op" id="5747474">.</span><span class="ident" id="5747475">Info</span><span class="op" id="5747479">)</span>&nbsp;<span class="op" id="5747481">!=</span>&nbsp;<span class="ident" id="5747484">i</span>&nbsp;<span class="op" id="5747486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747493">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747512">rd</span><span class="op" id="5747514">,</span>&nbsp;<span class="ident" id="5747516">err</span>&nbsp;<span class="op" id="5747520">:=</span>&nbsp;<span class="ident" id="5747523">r</span><span class="op" id="5747524">.</span><span class="ident" id="5747525">Data</span><span class="op" id="5747529">(</span><span class="op" id="5747530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747536">if</span>&nbsp;<span class="ident" id="5747539">err</span>&nbsp;<span class="op" id="5747543">!=</span>&nbsp;<span class="builtintype" id="5747546">nil</span>&nbsp;<span class="op" id="5747550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747557">return</span>&nbsp;<span class="builtintype" id="5747564">nil</span><span class="op" id="5747567">,</span>&nbsp;<span class="ident" id="5747569">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747577">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747583">err</span>&nbsp;<span class="op" id="5747587">=</span>&nbsp;<span class="ident" id="5747589">f</span><span class="op" id="5747590">.</span><span class="ident" id="5747591">applyRelocations</span><span class="op" id="5747607">(</span><span class="ident" id="5747608">b</span><span class="op" id="5747609">,</span>&nbsp;<span class="ident" id="5747611">rd</span><span class="op" id="5747613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747619">if</span>&nbsp;<span class="ident" id="5747622">err</span>&nbsp;<span class="op" id="5747626">!=</span>&nbsp;<span class="builtintype" id="5747629">nil</span>&nbsp;<span class="op" id="5747633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747640">return</span>&nbsp;<span class="builtintype" id="5747647">nil</span><span class="op" id="5747650">,</span>&nbsp;<span class="ident" id="5747652">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747665">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5747671">err</span>&nbsp;<span class="op" id="5747675">=</span>&nbsp;<span class="ident" id="5747677">d</span><span class="op" id="5747678">.</span><span class="ident" id="5747679">AddTypes</span><span class="op" id="5747687">(</span><span class="ident" id="5747688">fmt</span><span class="op" id="5747691">.</span><span class="ident" id="5747692">Sprintf</span><span class="op" id="5747699">(</span><span class="string" id="5747700">&#34;types-%d&#34;</span><span class="op" id="5747710">,</span>&nbsp;<span class="ident" id="5747712">i</span><span class="op" id="5747713">)</span><span class="op" id="5747714">,</span>&nbsp;<span class="ident" id="5747716">b</span><span class="op" id="5747717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747722">if</span>&nbsp;<span class="ident" id="5747725">err</span>&nbsp;<span class="op" id="5747729">!=</span>&nbsp;<span class="builtintype" id="5747732">nil</span>&nbsp;<span class="op" id="5747736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747742">return</span>&nbsp;<span class="builtintype" id="5747749">nil</span><span class="op" id="5747752">,</span>&nbsp;<span class="ident" id="5747754">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747761">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5747768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5747772">return</span>&nbsp;<span class="ident" id="5747779">d</span><span class="op" id="5747780">,</span>&nbsp;<span class="builtintype" id="5747782">nil</span><br>
<span class="lineno"></span><span class="op" id="5747786">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="5747789">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="5747872">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5747893">//</span><br>
<span class="lineno"></span><span class="comment" id="5747896">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="5747972">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5748046">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5748092">func</span>&nbsp;<span class="op" id="5748097">(</span><span class="ident" id="5748098">f</span>&nbsp;<span class="op" id="5748100">*</span><span class="ident" id="5748101">File</span><span class="op" id="5748105">)</span>&nbsp;<span class="ident" id="5748107">Symbols</span><span class="op" id="5748114">(</span><span class="op" id="5748115">)</span>&nbsp;<span class="op" id="5748117">(</span><span class="op" id="5748118">[</span><span class="op" id="5748119">]</span><span class="ident" id="5748120">Symbol</span><span class="op" id="5748126">,</span>&nbsp;<span class="builtintype" id="5748128">error</span><span class="op" id="5748133">)</span>&nbsp;<span class="op" id="5748135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748138">sym</span><span class="op" id="5748141">,</span>&nbsp;<span class="ident" id="5748143">_</span><span class="op" id="5748144">,</span>&nbsp;<span class="ident" id="5748146">err</span>&nbsp;<span class="op" id="5748150">:=</span>&nbsp;<span class="ident" id="5748153">f</span><span class="op" id="5748154">.</span><span class="ident" id="5748155">getSymbols</span><span class="op" id="5748165">(</span><span class="ident" id="5748166">SHT_SYMTAB</span><span class="op" id="5748176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5748179">return</span>&nbsp;<span class="ident" id="5748186">sym</span><span class="op" id="5748189">,</span>&nbsp;<span class="ident" id="5748191">err</span><br>
<span class="lineno">770</span><span class="op" id="5748195">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5748198">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5748268">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="5748317">//</span><br>
<span class="lineno">775</span><span class="comment" id="5748320">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="5748404">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="5748478">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="5748524">func</span>&nbsp;<span class="op" id="5748529">(</span><span class="ident" id="5748530">f</span>&nbsp;<span class="op" id="5748532">*</span><span class="ident" id="5748533">File</span><span class="op" id="5748537">)</span>&nbsp;<span class="ident" id="5748539">DynamicSymbols</span><span class="op" id="5748553">(</span><span class="op" id="5748554">)</span>&nbsp;<span class="op" id="5748556">(</span><span class="op" id="5748557">[</span><span class="op" id="5748558">]</span><span class="ident" id="5748559">Symbol</span><span class="op" id="5748565">,</span>&nbsp;<span class="builtintype" id="5748567">error</span><span class="op" id="5748572">)</span>&nbsp;<span class="op" id="5748574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748577">sym</span><span class="op" id="5748580">,</span>&nbsp;<span class="ident" id="5748582">_</span><span class="op" id="5748583">,</span>&nbsp;<span class="ident" id="5748585">err</span>&nbsp;<span class="op" id="5748589">:=</span>&nbsp;<span class="ident" id="5748592">f</span><span class="op" id="5748593">.</span><span class="ident" id="5748594">getSymbols</span><span class="op" id="5748604">(</span><span class="ident" id="5748605">SHT_DYNSYM</span><span class="op" id="5748615">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5748618">return</span>&nbsp;<span class="ident" id="5748625">sym</span><span class="op" id="5748628">,</span>&nbsp;<span class="ident" id="5748630">err</span><br>
<span class="lineno"></span><span class="op" id="5748634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5748637">type</span>&nbsp;<span class="ident" id="5748642">ImportedSymbol</span>&nbsp;<span class="keyword" id="5748657">struct</span>&nbsp;<span class="op" id="5748664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748667">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5748675">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748683">Version</span>&nbsp;<span class="builtintype" id="5748691">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748699">Library</span>&nbsp;<span class="builtintype" id="5748707">string</span><br>
<span class="lineno"></span><span class="op" id="5748714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5748717">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="5748769">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5748824">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5748878">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5748914">func</span>&nbsp;<span class="op" id="5748919">(</span><span class="ident" id="5748920">f</span>&nbsp;<span class="op" id="5748922">*</span><span class="ident" id="5748923">File</span><span class="op" id="5748927">)</span>&nbsp;<span class="ident" id="5748929">ImportedSymbols</span><span class="op" id="5748944">(</span><span class="op" id="5748945">)</span>&nbsp;<span class="op" id="5748947">(</span><span class="op" id="5748948">[</span><span class="op" id="5748949">]</span><span class="ident" id="5748950">ImportedSymbol</span><span class="op" id="5748964">,</span>&nbsp;<span class="builtintype" id="5748966">error</span><span class="op" id="5748971">)</span>&nbsp;<span class="op" id="5748973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5748976">sym</span><span class="op" id="5748979">,</span>&nbsp;<span class="ident" id="5748981">str</span><span class="op" id="5748984">,</span>&nbsp;<span class="ident" id="5748986">err</span>&nbsp;<span class="op" id="5748990">:=</span>&nbsp;<span class="ident" id="5748993">f</span><span class="op" id="5748994">.</span><span class="ident" id="5748995">getSymbols</span><span class="op" id="5749005">(</span><span class="ident" id="5749006">SHT_DYNSYM</span><span class="op" id="5749016">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749019">if</span>&nbsp;<span class="ident" id="5749022">err</span>&nbsp;<span class="op" id="5749026">!=</span>&nbsp;<span class="builtintype" id="5749029">nil</span>&nbsp;<span class="op" id="5749033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749037">return</span>&nbsp;<span class="builtintype" id="5749044">nil</span><span class="op" id="5749047">,</span>&nbsp;<span class="ident" id="5749049">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749057">f</span><span class="op" id="5749058">.</span><span class="ident" id="5749059">gnuVersionInit</span><span class="op" id="5749073">(</span><span class="ident" id="5749074">str</span><span class="op" id="5749077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749080">var</span>&nbsp;<span class="ident" id="5749084">all</span>&nbsp;<span class="op" id="5749088">[</span><span class="op" id="5749089">]</span><span class="ident" id="5749090">ImportedSymbol</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749106">for</span>&nbsp;<span class="ident" id="5749110">i</span><span class="op" id="5749111">,</span>&nbsp;<span class="ident" id="5749113">s</span>&nbsp;<span class="op" id="5749115">:=</span>&nbsp;<span class="keyword" id="5749118">range</span>&nbsp;<span class="ident" id="5749124">sym</span>&nbsp;<span class="op" id="5749128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749132">if</span>&nbsp;<span class="ident" id="5749135">ST_BIND</span><span class="op" id="5749142">(</span><span class="ident" id="5749143">s</span><span class="op" id="5749144">.</span><span class="ident" id="5749145">Info</span><span class="op" id="5749149">)</span>&nbsp;<span class="op" id="5749151">==</span>&nbsp;<span class="ident" id="5749154">STB_GLOBAL</span>&nbsp;<span class="op" id="5749165">&amp;&amp;</span>&nbsp;<span class="ident" id="5749168">s</span><span class="op" id="5749169">.</span><span class="ident" id="5749170">Section</span>&nbsp;<span class="op" id="5749178">==</span>&nbsp;<span class="ident" id="5749181">SHN_UNDEF</span>&nbsp;<span class="op" id="5749191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749196">all</span>&nbsp;<span class="op" id="5749200">=</span>&nbsp;<span class="builtinfunc" id="5749202">append</span><span class="op" id="5749208">(</span><span class="ident" id="5749209">all</span><span class="op" id="5749212">,</span>&nbsp;<span class="ident" id="5749214">ImportedSymbol</span><span class="op" id="5749228">{</span><span class="ident" id="5749229">Name</span><span class="op" id="5749233">:</span>&nbsp;<span class="ident" id="5749235">s</span><span class="op" id="5749236">.</span><span class="ident" id="5749237">Name</span><span class="op" id="5749241">}</span><span class="op" id="5749242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749247">f</span><span class="op" id="5749248">.</span><span class="ident" id="5749249">gnuVersion</span><span class="op" id="5749259">(</span><span class="ident" id="5749260">i</span><span class="op" id="5749261">,</span>&nbsp;<span class="op" id="5749263">&amp;</span><span class="ident" id="5749264">all</span><span class="op" id="5749267">[</span><span class="builtinfunc" id="5749268">len</span><span class="op" id="5749271">(</span><span class="ident" id="5749272">all</span><span class="op" id="5749275">)</span><span class="op" id="5749276">-</span><span class="num" id="5749277">1</span><span class="op" id="5749278">]</span><span class="op" id="5749279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749283">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749289">return</span>&nbsp;<span class="ident" id="5749296">all</span><span class="op" id="5749299">,</span>&nbsp;<span class="builtintype" id="5749301">nil</span><br>
<span class="lineno"></span><span class="op" id="5749305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5749308">type</span>&nbsp;<span class="ident" id="5749313">verneed</span>&nbsp;<span class="keyword" id="5749321">struct</span>&nbsp;<span class="op" id="5749328">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749331">File</span>&nbsp;<span class="builtintype" id="5749336">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749344">Name</span>&nbsp;<span class="builtintype" id="5749349">string</span><br>
<span class="lineno"></span><span class="op" id="5749356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5749359">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="5749407">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="5749442">func</span>&nbsp;<span class="op" id="5749447">(</span><span class="ident" id="5749448">f</span>&nbsp;<span class="op" id="5749450">*</span><span class="ident" id="5749451">File</span><span class="op" id="5749455">)</span>&nbsp;<span class="ident" id="5749457">gnuVersionInit</span><span class="op" id="5749471">(</span><span class="ident" id="5749472">str</span>&nbsp;<span class="op" id="5749476">[</span><span class="op" id="5749477">]</span><span class="builtintype" id="5749478">byte</span><span class="op" id="5749482">)</span>&nbsp;<span class="op" id="5749484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5749487">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749523">vn</span>&nbsp;<span class="op" id="5749526">:=</span>&nbsp;<span class="ident" id="5749529">f</span><span class="op" id="5749530">.</span><span class="ident" id="5749531">SectionByType</span><span class="op" id="5749544">(</span><span class="ident" id="5749545">SHT_GNU_VERNEED</span><span class="op" id="5749560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749563">if</span>&nbsp;<span class="ident" id="5749566">vn</span>&nbsp;<span class="op" id="5749569">==</span>&nbsp;<span class="builtintype" id="5749572">nil</span>&nbsp;<span class="op" id="5749576">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749580">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749591">d</span><span class="op" id="5749592">,</span>&nbsp;<span class="ident" id="5749594">_</span>&nbsp;<span class="op" id="5749596">:=</span>&nbsp;<span class="ident" id="5749599">vn</span><span class="op" id="5749601">.</span><span class="ident" id="5749602">Data</span><span class="op" id="5749606">(</span><span class="op" id="5749607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749611">var</span>&nbsp;<span class="ident" id="5749615">need</span>&nbsp;<span class="op" id="5749620">[</span><span class="op" id="5749621">]</span><span class="ident" id="5749622">verneed</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749631">i</span>&nbsp;<span class="op" id="5749633">:=</span>&nbsp;<span class="num" id="5749636">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749639">for</span>&nbsp;<span class="op" id="5749643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749647">if</span>&nbsp;<span class="ident" id="5749650">i</span><span class="op" id="5749651">+</span><span class="num" id="5749652">16</span>&nbsp;<span class="op" id="5749655">&gt;</span>&nbsp;<span class="builtinfunc" id="5749657">len</span><span class="op" id="5749660">(</span><span class="ident" id="5749661">d</span><span class="op" id="5749662">)</span>&nbsp;<span class="op" id="5749664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749669">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749677">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749681">vers</span>&nbsp;<span class="op" id="5749686">:=</span>&nbsp;<span class="ident" id="5749689">f</span><span class="op" id="5749690">.</span><span class="ident" id="5749691">ByteOrder</span><span class="op" id="5749700">.</span><span class="ident" id="5749701">Uint16</span><span class="op" id="5749707">(</span><span class="ident" id="5749708">d</span><span class="op" id="5749709">[</span><span class="ident" id="5749710">i</span>&nbsp;<span class="op" id="5749712">:</span>&nbsp;<span class="ident" id="5749714">i</span><span class="op" id="5749715">+</span><span class="num" id="5749716">2</span><span class="op" id="5749717">]</span><span class="op" id="5749718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749722">if</span>&nbsp;<span class="ident" id="5749725">vers</span>&nbsp;<span class="op" id="5749730">!=</span>&nbsp;<span class="num" id="5749733">1</span>&nbsp;<span class="op" id="5749735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749740">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5749748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749752">cnt</span>&nbsp;<span class="op" id="5749756">:=</span>&nbsp;<span class="ident" id="5749759">f</span><span class="op" id="5749760">.</span><span class="ident" id="5749761">ByteOrder</span><span class="op" id="5749770">.</span><span class="ident" id="5749771">Uint16</span><span class="op" id="5749777">(</span><span class="ident" id="5749778">d</span><span class="op" id="5749779">[</span><span class="ident" id="5749780">i</span><span class="op" id="5749781">+</span><span class="num" id="5749782">2</span>&nbsp;<span class="op" id="5749784">:</span>&nbsp;<span class="ident" id="5749786">i</span><span class="op" id="5749787">+</span><span class="num" id="5749788">4</span><span class="op" id="5749789">]</span><span class="op" id="5749790">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749794">fileoff</span>&nbsp;<span class="op" id="5749802">:=</span>&nbsp;<span class="ident" id="5749805">f</span><span class="op" id="5749806">.</span><span class="ident" id="5749807">ByteOrder</span><span class="op" id="5749816">.</span><span class="ident" id="5749817">Uint32</span><span class="op" id="5749823">(</span><span class="ident" id="5749824">d</span><span class="op" id="5749825">[</span><span class="ident" id="5749826">i</span><span class="op" id="5749827">+</span><span class="num" id="5749828">4</span>&nbsp;<span class="op" id="5749830">:</span>&nbsp;<span class="ident" id="5749832">i</span><span class="op" id="5749833">+</span><span class="num" id="5749834">8</span><span class="op" id="5749835">]</span><span class="op" id="5749836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749840">aux</span>&nbsp;<span class="op" id="5749844">:=</span>&nbsp;<span class="ident" id="5749847">f</span><span class="op" id="5749848">.</span><span class="ident" id="5749849">ByteOrder</span><span class="op" id="5749858">.</span><span class="ident" id="5749859">Uint32</span><span class="op" id="5749865">(</span><span class="ident" id="5749866">d</span><span class="op" id="5749867">[</span><span class="ident" id="5749868">i</span><span class="op" id="5749869">+</span><span class="num" id="5749870">8</span>&nbsp;<span class="op" id="5749872">:</span>&nbsp;<span class="ident" id="5749874">i</span><span class="op" id="5749875">+</span><span class="num" id="5749876">12</span><span class="op" id="5749878">]</span><span class="op" id="5749879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749883">next</span>&nbsp;<span class="op" id="5749888">:=</span>&nbsp;<span class="ident" id="5749891">f</span><span class="op" id="5749892">.</span><span class="ident" id="5749893">ByteOrder</span><span class="op" id="5749902">.</span><span class="ident" id="5749903">Uint32</span><span class="op" id="5749909">(</span><span class="ident" id="5749910">d</span><span class="op" id="5749911">[</span><span class="ident" id="5749912">i</span><span class="op" id="5749913">+</span><span class="num" id="5749914">12</span>&nbsp;<span class="op" id="5749917">:</span>&nbsp;<span class="ident" id="5749919">i</span><span class="op" id="5749920">+</span><span class="num" id="5749921">16</span><span class="op" id="5749923">]</span><span class="op" id="5749924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749928">file</span><span class="op" id="5749932">,</span>&nbsp;<span class="ident" id="5749934">_</span>&nbsp;<span class="op" id="5749936">:=</span>&nbsp;<span class="ident" id="5749939">getString</span><span class="op" id="5749948">(</span><span class="ident" id="5749949">str</span><span class="op" id="5749952">,</span>&nbsp;<span class="builtintype" id="5749954">int</span><span class="op" id="5749957">(</span><span class="ident" id="5749958">fileoff</span><span class="op" id="5749965">)</span><span class="op" id="5749966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5749971">var</span>&nbsp;<span class="ident" id="5749975">name</span>&nbsp;<span class="builtintype" id="5749980">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5749989">j</span>&nbsp;<span class="op" id="5749991">:=</span>&nbsp;<span class="ident" id="5749994">i</span>&nbsp;<span class="op" id="5749996">+</span>&nbsp;<span class="builtintype" id="5749998">int</span><span class="op" id="5750001">(</span><span class="ident" id="5750002">aux</span><span class="op" id="5750005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750009">for</span>&nbsp;<span class="ident" id="5750013">c</span>&nbsp;<span class="op" id="5750015">:=</span>&nbsp;<span class="num" id="5750018">0</span><span class="op" id="5750019">;</span>&nbsp;<span class="ident" id="5750021">c</span>&nbsp;<span class="op" id="5750023">&lt;</span>&nbsp;<span class="builtintype" id="5750025">int</span><span class="op" id="5750028">(</span><span class="ident" id="5750029">cnt</span><span class="op" id="5750032">)</span><span class="op" id="5750033">;</span>&nbsp;<span class="ident" id="5750035">c</span><span class="op" id="5750036">++</span>&nbsp;<span class="op" id="5750039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750044">if</span>&nbsp;<span class="ident" id="5750047">j</span><span class="op" id="5750048">+</span><span class="num" id="5750049">16</span>&nbsp;<span class="op" id="5750052">&gt;</span>&nbsp;<span class="builtinfunc" id="5750054">len</span><span class="op" id="5750057">(</span><span class="ident" id="5750058">d</span><span class="op" id="5750059">)</span>&nbsp;<span class="op" id="5750061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750067">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5750081">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5750124">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750170">other</span>&nbsp;<span class="op" id="5750176">:=</span>&nbsp;<span class="ident" id="5750179">f</span><span class="op" id="5750180">.</span><span class="ident" id="5750181">ByteOrder</span><span class="op" id="5750190">.</span><span class="ident" id="5750191">Uint16</span><span class="op" id="5750197">(</span><span class="ident" id="5750198">d</span><span class="op" id="5750199">[</span><span class="ident" id="5750200">j</span><span class="op" id="5750201">+</span><span class="num" id="5750202">6</span>&nbsp;<span class="op" id="5750204">:</span>&nbsp;<span class="ident" id="5750206">j</span><span class="op" id="5750207">+</span><span class="num" id="5750208">8</span><span class="op" id="5750209">]</span><span class="op" id="5750210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750215">nameoff</span>&nbsp;<span class="op" id="5750223">:=</span>&nbsp;<span class="ident" id="5750226">f</span><span class="op" id="5750227">.</span><span class="ident" id="5750228">ByteOrder</span><span class="op" id="5750237">.</span><span class="ident" id="5750238">Uint32</span><span class="op" id="5750244">(</span><span class="ident" id="5750245">d</span><span class="op" id="5750246">[</span><span class="ident" id="5750247">j</span><span class="op" id="5750248">+</span><span class="num" id="5750249">8</span>&nbsp;<span class="op" id="5750251">:</span>&nbsp;<span class="ident" id="5750253">j</span><span class="op" id="5750254">+</span><span class="num" id="5750255">12</span><span class="op" id="5750257">]</span><span class="op" id="5750258">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750263">next</span>&nbsp;<span class="op" id="5750268">:=</span>&nbsp;<span class="ident" id="5750271">f</span><span class="op" id="5750272">.</span><span class="ident" id="5750273">ByteOrder</span><span class="op" id="5750282">.</span><span class="ident" id="5750283">Uint32</span><span class="op" id="5750289">(</span><span class="ident" id="5750290">d</span><span class="op" id="5750291">[</span><span class="ident" id="5750292">j</span><span class="op" id="5750293">+</span><span class="num" id="5750294">12</span>&nbsp;<span class="op" id="5750297">:</span>&nbsp;<span class="ident" id="5750299">j</span><span class="op" id="5750300">+</span><span class="num" id="5750301">16</span><span class="op" id="5750303">]</span><span class="op" id="5750304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750309">name</span><span class="op" id="5750313">,</span>&nbsp;<span class="ident" id="5750315">_</span>&nbsp;<span class="op" id="5750317">=</span>&nbsp;<span class="ident" id="5750319">getString</span><span class="op" id="5750328">(</span><span class="ident" id="5750329">str</span><span class="op" id="5750332">,</span>&nbsp;<span class="builtintype" id="5750334">int</span><span class="op" id="5750337">(</span><span class="ident" id="5750338">nameoff</span><span class="op" id="5750345">)</span><span class="op" id="5750346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750351">ndx</span>&nbsp;<span class="op" id="5750355">:=</span>&nbsp;<span class="builtintype" id="5750358">int</span><span class="op" id="5750361">(</span><span class="ident" id="5750362">other</span><span class="op" id="5750367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750372">if</span>&nbsp;<span class="ident" id="5750375">ndx</span>&nbsp;<span class="op" id="5750379">&gt;=</span>&nbsp;<span class="builtinfunc" id="5750382">len</span><span class="op" id="5750385">(</span><span class="ident" id="5750386">need</span><span class="op" id="5750390">)</span>&nbsp;<span class="op" id="5750392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750398">a</span>&nbsp;<span class="op" id="5750400">:=</span>&nbsp;<span class="builtinfunc" id="5750403">make</span><span class="op" id="5750407">(</span><span class="op" id="5750408">[</span><span class="op" id="5750409">]</span><span class="ident" id="5750410">verneed</span><span class="op" id="5750417">,</span>&nbsp;<span class="num" id="5750419">2</span><span class="op" id="5750420">*</span><span class="op" id="5750421">(</span><span class="ident" id="5750422">ndx</span><span class="op" id="5750425">+</span><span class="num" id="5750426">1</span><span class="op" id="5750427">)</span><span class="op" id="5750428">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5750434">copy</span><span class="op" id="5750438">(</span><span class="ident" id="5750439">a</span><span class="op" id="5750440">,</span>&nbsp;<span class="ident" id="5750442">need</span><span class="op" id="5750446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750452">need</span>&nbsp;<span class="op" id="5750457">=</span>&nbsp;<span class="ident" id="5750459">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750470">need</span><span class="op" id="5750474">[</span><span class="ident" id="5750475">ndx</span><span class="op" id="5750478">]</span>&nbsp;<span class="op" id="5750480">=</span>&nbsp;<span class="ident" id="5750482">verneed</span><span class="op" id="5750489">{</span><span class="ident" id="5750490">file</span><span class="op" id="5750494">,</span>&nbsp;<span class="ident" id="5750496">name</span><span class="op" id="5750500">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750505">if</span>&nbsp;<span class="ident" id="5750508">next</span>&nbsp;<span class="op" id="5750513">==</span>&nbsp;<span class="num" id="5750516">0</span>&nbsp;<span class="op" id="5750518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750524">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750538">j</span>&nbsp;<span class="op" id="5750540">+=</span>&nbsp;<span class="builtintype" id="5750543">int</span><span class="op" id="5750546">(</span><span class="ident" id="5750547">next</span><span class="op" id="5750551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750555">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750560">if</span>&nbsp;<span class="ident" id="5750563">next</span>&nbsp;<span class="op" id="5750568">==</span>&nbsp;<span class="num" id="5750571">0</span>&nbsp;<span class="op" id="5750573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750578">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750590">i</span>&nbsp;<span class="op" id="5750592">+=</span>&nbsp;<span class="builtintype" id="5750595">int</span><span class="op" id="5750598">(</span><span class="ident" id="5750599">next</span><span class="op" id="5750603">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750606">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5750610">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750668">vs</span>&nbsp;<span class="op" id="5750671">:=</span>&nbsp;<span class="ident" id="5750674">f</span><span class="op" id="5750675">.</span><span class="ident" id="5750676">SectionByType</span><span class="op" id="5750689">(</span><span class="ident" id="5750690">SHT_GNU_VERSYM</span><span class="op" id="5750704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750707">if</span>&nbsp;<span class="ident" id="5750710">vs</span>&nbsp;<span class="op" id="5750713">==</span>&nbsp;<span class="builtintype" id="5750716">nil</span>&nbsp;<span class="op" id="5750720">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5750724">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5750732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750735">d</span><span class="op" id="5750736">,</span>&nbsp;<span class="ident" id="5750738">_</span>&nbsp;<span class="op" id="5750740">=</span>&nbsp;<span class="ident" id="5750742">vs</span><span class="op" id="5750744">.</span><span class="ident" id="5750745">Data</span><span class="op" id="5750749">(</span><span class="op" id="5750750">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750754">f</span><span class="op" id="5750755">.</span><span class="ident" id="5750756">gnuNeed</span>&nbsp;<span class="op" id="5750764">=</span>&nbsp;<span class="ident" id="5750766">need</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750772">f</span><span class="op" id="5750773">.</span><span class="ident" id="5750774">gnuVersym</span>&nbsp;<span class="op" id="5750784">=</span>&nbsp;<span class="ident" id="5750786">d</span><br>
<span class="lineno"></span><span class="op" id="5750788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5750791">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="5750850">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="5750899">func</span>&nbsp;<span class="op" id="5750904">(</span><span class="ident" id="5750905">f</span>&nbsp;<span class="op" id="5750907">*</span><span class="ident" id="5750908">File</span><span class="op" id="5750912">)</span>&nbsp;<span class="ident" id="5750914">gnuVersion</span><span class="op" id="5750924">(</span><span class="ident" id="5750925">i</span>&nbsp;<span class="builtintype" id="5750927">int</span><span class="op" id="5750930">,</span>&nbsp;<span class="ident" id="5750932">sym</span>&nbsp;<span class="op" id="5750936">*</span><span class="ident" id="5750937">ImportedSymbol</span><span class="op" id="5750951">)</span>&nbsp;<span class="op" id="5750953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5750956">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5750985">i</span>&nbsp;<span class="op" id="5750987">=</span>&nbsp;<span class="op" id="5750989">(</span><span class="ident" id="5750990">i</span>&nbsp;<span class="op" id="5750992">+</span>&nbsp;<span class="num" id="5750994">1</span><span class="op" id="5750995">)</span>&nbsp;<span class="op" id="5750997">*</span>&nbsp;<span class="num" id="5750999">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751002">if</span>&nbsp;<span class="ident" id="5751005">i</span>&nbsp;<span class="op" id="5751007">&gt;=</span>&nbsp;<span class="builtinfunc" id="5751010">len</span><span class="op" id="5751013">(</span><span class="ident" id="5751014">f</span><span class="op" id="5751015">.</span><span class="ident" id="5751016">gnuVersym</span><span class="op" id="5751025">)</span>&nbsp;<span class="op" id="5751027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751031">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5751039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751042">j</span>&nbsp;<span class="op" id="5751044">:=</span>&nbsp;<span class="builtintype" id="5751047">int</span><span class="op" id="5751050">(</span><span class="ident" id="5751051">f</span><span class="op" id="5751052">.</span><span class="ident" id="5751053">ByteOrder</span><span class="op" id="5751062">.</span><span class="ident" id="5751063">Uint16</span><span class="op" id="5751069">(</span><span class="ident" id="5751070">f</span><span class="op" id="5751071">.</span><span class="ident" id="5751072">gnuVersym</span><span class="op" id="5751081">[</span><span class="ident" id="5751082">i</span><span class="op" id="5751083">:</span><span class="op" id="5751084">]</span><span class="op" id="5751085">)</span><span class="op" id="5751086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751089">if</span>&nbsp;<span class="ident" id="5751092">j</span>&nbsp;<span class="op" id="5751094">&lt;</span>&nbsp;<span class="num" id="5751096">2</span>&nbsp;<span class="op" id="5751098">||</span>&nbsp;<span class="ident" id="5751101">j</span>&nbsp;<span class="op" id="5751103">&gt;=</span>&nbsp;<span class="builtinfunc" id="5751106">len</span><span class="op" id="5751109">(</span><span class="ident" id="5751110">f</span><span class="op" id="5751111">.</span><span class="ident" id="5751112">gnuNeed</span><span class="op" id="5751119">)</span>&nbsp;<span class="op" id="5751121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751125">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5751133">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751136">n</span>&nbsp;<span class="op" id="5751138">:=</span>&nbsp;<span class="op" id="5751141">&amp;</span><span class="ident" id="5751142">f</span><span class="op" id="5751143">.</span><span class="ident" id="5751144">gnuNeed</span><span class="op" id="5751151">[</span><span class="ident" id="5751152">j</span><span class="op" id="5751153">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751156">sym</span><span class="op" id="5751159">.</span><span class="ident" id="5751160">Library</span>&nbsp;<span class="op" id="5751168">=</span>&nbsp;<span class="ident" id="5751170">n</span><span class="op" id="5751171">.</span><span class="ident" id="5751172">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751178">sym</span><span class="op" id="5751181">.</span><span class="ident" id="5751182">Version</span>&nbsp;<span class="op" id="5751190">=</span>&nbsp;<span class="ident" id="5751192">n</span><span class="op" id="5751193">.</span><span class="ident" id="5751194">Name</span><br>
<span class="lineno"></span><span class="op" id="5751199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="5751202">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5751258">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5751313">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="5751361">func</span>&nbsp;<span class="op" id="5751366">(</span><span class="ident" id="5751367">f</span>&nbsp;<span class="op" id="5751369">*</span><span class="ident" id="5751370">File</span><span class="op" id="5751374">)</span>&nbsp;<span class="ident" id="5751376">ImportedLibraries</span><span class="op" id="5751393">(</span><span class="op" id="5751394">)</span>&nbsp;<span class="op" id="5751396">(</span><span class="op" id="5751397">[</span><span class="op" id="5751398">]</span><span class="builtintype" id="5751399">string</span><span class="op" id="5751405">,</span>&nbsp;<span class="builtintype" id="5751407">error</span><span class="op" id="5751412">)</span>&nbsp;<span class="op" id="5751414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751417">return</span>&nbsp;<span class="ident" id="5751424">f</span><span class="op" id="5751425">.</span><span class="ident" id="5751426">DynString</span><span class="op" id="5751435">(</span><span class="ident" id="5751436">DT_NEEDED</span><span class="op" id="5751445">)</span><br>
<span class="lineno">905</span><span class="op" id="5751447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5751450">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="5751530">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="5751542">//</span><br>
<span class="lineno">910</span><span class="comment" id="5751545">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5751629">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="5751644">func</span>&nbsp;<span class="op" id="5751649">(</span><span class="ident" id="5751650">f</span>&nbsp;<span class="op" id="5751652">*</span><span class="ident" id="5751653">File</span><span class="op" id="5751657">)</span>&nbsp;<span class="ident" id="5751659">DynString</span><span class="op" id="5751668">(</span><span class="ident" id="5751669">tag</span>&nbsp;<span class="ident" id="5751673">DynTag</span><span class="op" id="5751679">)</span>&nbsp;<span class="op" id="5751681">(</span><span class="op" id="5751682">[</span><span class="op" id="5751683">]</span><span class="builtintype" id="5751684">string</span><span class="op" id="5751690">,</span>&nbsp;<span class="builtintype" id="5751692">error</span><span class="op" id="5751697">)</span>&nbsp;<span class="op" id="5751699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751702">switch</span>&nbsp;<span class="ident" id="5751709">tag</span>&nbsp;<span class="op" id="5751713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751716">case</span>&nbsp;<span class="ident" id="5751721">DT_NEEDED</span><span class="op" id="5751730">,</span>&nbsp;<span class="ident" id="5751732">DT_SONAME</span><span class="op" id="5751741">,</span>&nbsp;<span class="ident" id="5751743">DT_RPATH</span><span class="op" id="5751751">,</span>&nbsp;<span class="ident" id="5751753">DT_RUNPATH</span><span class="op" id="5751763">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751766">default</span><span class="op" id="5751773">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751777">return</span>&nbsp;<span class="builtintype" id="5751784">nil</span><span class="op" id="5751787">,</span>&nbsp;<span class="ident" id="5751789">fmt</span><span class="op" id="5751792">.</span><span class="ident" id="5751793">Errorf</span><span class="op" id="5751799">(</span><span class="string" id="5751800">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="5751826">,</span>&nbsp;<span class="ident" id="5751828">tag</span><span class="op" id="5751831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5751834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751837">ds</span>&nbsp;<span class="op" id="5751840">:=</span>&nbsp;<span class="ident" id="5751843">f</span><span class="op" id="5751844">.</span><span class="ident" id="5751845">SectionByType</span><span class="op" id="5751858">(</span><span class="ident" id="5751859">SHT_DYNAMIC</span><span class="op" id="5751870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751873">if</span>&nbsp;<span class="ident" id="5751876">ds</span>&nbsp;<span class="op" id="5751879">==</span>&nbsp;<span class="builtintype" id="5751882">nil</span>&nbsp;<span class="op" id="5751886">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5751890">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751924">return</span>&nbsp;<span class="builtintype" id="5751931">nil</span><span class="op" id="5751934">,</span>&nbsp;<span class="builtintype" id="5751936">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5751941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5751944">d</span><span class="op" id="5751945">,</span>&nbsp;<span class="ident" id="5751947">err</span>&nbsp;<span class="op" id="5751951">:=</span>&nbsp;<span class="ident" id="5751954">ds</span><span class="op" id="5751956">.</span><span class="ident" id="5751957">Data</span><span class="op" id="5751961">(</span><span class="op" id="5751962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751965">if</span>&nbsp;<span class="ident" id="5751968">err</span>&nbsp;<span class="op" id="5751972">!=</span>&nbsp;<span class="builtintype" id="5751975">nil</span>&nbsp;<span class="op" id="5751979">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5751983">return</span>&nbsp;<span class="builtintype" id="5751990">nil</span><span class="op" id="5751993">,</span>&nbsp;<span class="ident" id="5751995">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752003">str</span><span class="op" id="5752006">,</span>&nbsp;<span class="ident" id="5752008">err</span>&nbsp;<span class="op" id="5752012">:=</span>&nbsp;<span class="ident" id="5752015">f</span><span class="op" id="5752016">.</span><span class="ident" id="5752017">stringTable</span><span class="op" id="5752028">(</span><span class="ident" id="5752029">ds</span><span class="op" id="5752031">.</span><span class="ident" id="5752032">Link</span><span class="op" id="5752036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752039">if</span>&nbsp;<span class="ident" id="5752042">err</span>&nbsp;<span class="op" id="5752046">!=</span>&nbsp;<span class="builtintype" id="5752049">nil</span>&nbsp;<span class="op" id="5752053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752057">return</span>&nbsp;<span class="builtintype" id="5752064">nil</span><span class="op" id="5752067">,</span>&nbsp;<span class="ident" id="5752069">err</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752077">var</span>&nbsp;<span class="ident" id="5752081">all</span>&nbsp;<span class="op" id="5752085">[</span><span class="op" id="5752086">]</span><span class="builtintype" id="5752087">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752095">for</span>&nbsp;<span class="builtinfunc" id="5752099">len</span><span class="op" id="5752102">(</span><span class="ident" id="5752103">d</span><span class="op" id="5752104">)</span>&nbsp;<span class="op" id="5752106">&gt;</span>&nbsp;<span class="num" id="5752108">0</span>&nbsp;<span class="op" id="5752110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752114">var</span>&nbsp;<span class="ident" id="5752118">t</span>&nbsp;<span class="ident" id="5752120">DynTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752129">var</span>&nbsp;<span class="ident" id="5752133">v</span>&nbsp;<span class="ident" id="5752135">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752144">switch</span>&nbsp;<span class="ident" id="5752151">f</span><span class="op" id="5752152">.</span><span class="ident" id="5752153">Class</span>&nbsp;<span class="op" id="5752159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752163">case</span>&nbsp;<span class="ident" id="5752168">ELFCLASS32</span><span class="op" id="5752178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752183">t</span>&nbsp;<span class="op" id="5752185">=</span>&nbsp;<span class="ident" id="5752187">DynTag</span><span class="op" id="5752193">(</span><span class="ident" id="5752194">f</span><span class="op" id="5752195">.</span><span class="ident" id="5752196">ByteOrder</span><span class="op" id="5752205">.</span><span class="ident" id="5752206">Uint32</span><span class="op" id="5752212">(</span><span class="ident" id="5752213">d</span><span class="op" id="5752214">[</span><span class="num" id="5752215">0</span><span class="op" id="5752216">:</span><span class="num" id="5752217">4</span><span class="op" id="5752218">]</span><span class="op" id="5752219">)</span><span class="op" id="5752220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752225">v</span>&nbsp;<span class="op" id="5752227">=</span>&nbsp;<span class="ident" id="5752229">uint64</span><span class="op" id="5752235">(</span><span class="ident" id="5752236">f</span><span class="op" id="5752237">.</span><span class="ident" id="5752238">ByteOrder</span><span class="op" id="5752247">.</span><span class="ident" id="5752248">Uint32</span><span class="op" id="5752254">(</span><span class="ident" id="5752255">d</span><span class="op" id="5752256">[</span><span class="num" id="5752257">4</span><span class="op" id="5752258">:</span><span class="num" id="5752259">8</span><span class="op" id="5752260">]</span><span class="op" id="5752261">)</span><span class="op" id="5752262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752267">d</span>&nbsp;<span class="op" id="5752269">=</span>&nbsp;<span class="ident" id="5752271">d</span><span class="op" id="5752272">[</span><span class="num" id="5752273">8</span><span class="op" id="5752274">:</span><span class="op" id="5752275">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752279">case</span>&nbsp;<span class="ident" id="5752284">ELFCLASS64</span><span class="op" id="5752294">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752299">t</span>&nbsp;<span class="op" id="5752301">=</span>&nbsp;<span class="ident" id="5752303">DynTag</span><span class="op" id="5752309">(</span><span class="ident" id="5752310">f</span><span class="op" id="5752311">.</span><span class="ident" id="5752312">ByteOrder</span><span class="op" id="5752321">.</span><span class="ident" id="5752322">Uint64</span><span class="op" id="5752328">(</span><span class="ident" id="5752329">d</span><span class="op" id="5752330">[</span><span class="num" id="5752331">0</span><span class="op" id="5752332">:</span><span class="num" id="5752333">8</span><span class="op" id="5752334">]</span><span class="op" id="5752335">)</span><span class="op" id="5752336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752341">v</span>&nbsp;<span class="op" id="5752343">=</span>&nbsp;<span class="ident" id="5752345">f</span><span class="op" id="5752346">.</span><span class="ident" id="5752347">ByteOrder</span><span class="op" id="5752356">.</span><span class="ident" id="5752357">Uint64</span><span class="op" id="5752363">(</span><span class="ident" id="5752364">d</span><span class="op" id="5752365">[</span><span class="num" id="5752366">8</span><span class="op" id="5752367">:</span><span class="num" id="5752368">16</span><span class="op" id="5752370">]</span><span class="op" id="5752371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752376">d</span>&nbsp;<span class="op" id="5752378">=</span>&nbsp;<span class="ident" id="5752380">d</span><span class="op" id="5752381">[</span><span class="num" id="5752382">16</span><span class="op" id="5752384">:</span><span class="op" id="5752385">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752389">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752393">if</span>&nbsp;<span class="ident" id="5752396">t</span>&nbsp;<span class="op" id="5752398">==</span>&nbsp;<span class="ident" id="5752401">tag</span>&nbsp;<span class="op" id="5752405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752410">s</span><span class="op" id="5752411">,</span>&nbsp;<span class="ident" id="5752413">ok</span>&nbsp;<span class="op" id="5752416">:=</span>&nbsp;<span class="ident" id="5752419">getString</span><span class="op" id="5752428">(</span><span class="ident" id="5752429">str</span><span class="op" id="5752432">,</span>&nbsp;<span class="builtintype" id="5752434">int</span><span class="op" id="5752437">(</span><span class="ident" id="5752438">v</span><span class="op" id="5752439">)</span><span class="op" id="5752440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752445">if</span>&nbsp;<span class="ident" id="5752448">ok</span>&nbsp;<span class="op" id="5752451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5752457">all</span>&nbsp;<span class="op" id="5752461">=</span>&nbsp;<span class="builtinfunc" id="5752463">append</span><span class="op" id="5752469">(</span><span class="ident" id="5752470">all</span><span class="op" id="5752473">,</span>&nbsp;<span class="ident" id="5752475">s</span><span class="op" id="5752476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752481">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5752488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5752491">return</span>&nbsp;<span class="ident" id="5752498">all</span><span class="op" id="5752501">,</span>&nbsp;<span class="builtintype" id="5752503">nil</span><br>
<span class="lineno"></span><span class="op" id="5752507">}</span>
</div>
</body>
</html>
