<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7146712">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7146767">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7146821">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7146872">package</span>&nbsp;<span class="ident" id="7146880">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7146885">import</span>&nbsp;<span class="op" id="7146892">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146895">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146904">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146911">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146917">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146924">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146935">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7146946">&#34;time&#34;</span><br>
<span class="lineno">15</span><span class="op" id="7146953">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7146956">var</span>&nbsp;<span class="ident" id="7146960">rsaCertPEM</span>&nbsp;<span class="op" id="7146971">=</span>&nbsp;<span class="string" id="7146973">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB0zCCAX2gAwIBAgIJAI/M7BYjwB+uMA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV<br>
<span class="lineno"></span>BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX<br>
<span class="lineno">20</span>aWRnaXRzIFB0eSBMdGQwHhcNMTIwOTEyMjE1MjAyWhcNMTUwOTEyMjE1MjAyWjBF<br>
<span class="lineno"></span>MQswCQYDVQQGEwJBVTETMBEGA1UECAwKU29tZS1TdGF0ZTEhMB8GA1UECgwYSW50<br>
<span class="lineno"></span>ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANLJ<br>
<span class="lineno"></span>hPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wok/4xIA+ui35/MmNa<br>
<span class="lineno"></span>rtNuC+BdZ1tMuVCPFZcCAwEAAaNQME4wHQYDVR0OBBYEFJvKs8RfJaXTH08W+SGv<br>
<span class="lineno">25</span>zQyKn0H8MB8GA1UdIwQYMBaAFJvKs8RfJaXTH08W+SGvzQyKn0H8MAwGA1UdEwQF<br>
<span class="lineno"></span>MAMBAf8wDQYJKoZIhvcNAQEFBQADQQBJlffJHybjDGxRMqaRmDhX0+6v02TUKZsW<br>
<span class="lineno"></span>r5QuVbpQhH6u+0UgcW0jp9QwpxoPTLTWGXEWBBBurxFwiCBhkQ+V<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7147669">var</span>&nbsp;<span class="ident" id="7147673">rsaKeyPEM</span>&nbsp;<span class="op" id="7147683">=</span>&nbsp;<span class="string" id="7147685">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno">35</span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno"></span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">40</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7148186">//&nbsp;keyPEM&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;rsaKeyPEM,&nbsp;but&nbsp;declares&nbsp;itself&nbsp;as&nbsp;just</span><br>
<span class="lineno"></span><span class="comment" id="7148250">//&nbsp;&#34;PRIVATE&nbsp;KEY&#34;,&nbsp;not&nbsp;&#34;RSA&nbsp;PRIVATE&nbsp;KEY&#34;.&nbsp;&nbsp;http://golang.org/issue/4477</span><br>
<span class="lineno"></span><span class="keyword" id="7148321">var</span>&nbsp;<span class="ident" id="7148325">keyPEM</span>&nbsp;<span class="op" id="7148332">=</span>&nbsp;<span class="string" id="7148334">`-----BEGIN&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">45</span>MIIBOwIBAAJBANLJhPHhITqQbPklG3ibCVxwGMRfp/v4XqhfdQHdcVfHap6NQ5Wo<br>
<span class="lineno"></span>k/4xIA+ui35/MmNartNuC+BdZ1tMuVCPFZcCAwEAAQJAEJ2N+zsR0Xn8/Q6twa4G<br>
<span class="lineno"></span>6OB1M1WO+k+ztnX/1SvNeWu8D6GImtupLTYgjZcHufykj09jiHmjHx8u8ZZB/o1N<br>
<span class="lineno"></span>MQIhAPW+eyZo7ay3lMz1V01WVjNKK9QSn1MJlb06h/LuYv9FAiEA25WPedKgVyCW<br>
<span class="lineno"></span>SmUwbPw8fnTcpqDWE3yTO3vKcebqMSsCIBF3UmVue8YU3jybC3NxuXq3wNm34R8T<br>
<span class="lineno">50</span>xVLHwDXh/6NJAiEAl2oHGGLz64BuAfjKrqwz7qMYr9HCLIe/YsoWq/olzScCIQDi<br>
<span class="lineno"></span>D2lWusoe2/nEqfDVVWGWlyJ7yOmqaVm/iNUN9B2N2g==<br>
<span class="lineno"></span>-----END&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7148827">var</span>&nbsp;<span class="ident" id="7148831">ecdsaCertPEM</span>&nbsp;<span class="op" id="7148844">=</span>&nbsp;<span class="string" id="7148846">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB/jCCAWICCQDscdUxw16XFDAJBgcqhkjOPQQBMEUxCzAJBgNVBAYTAkFVMRMw<br>
<span class="lineno"></span>EQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0<br>
<span class="lineno"></span>eSBMdGQwHhcNMTIxMTE0MTI0MDQ4WhcNMTUxMTE0MTI0MDQ4WjBFMQswCQYDVQQG<br>
<span class="lineno"></span>EwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lk<br>
<span class="lineno">60</span>Z2l0cyBQdHkgTHRkMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQBY9+my9OoeSUR<br>
<span class="lineno"></span>lDQdV/x8LsOuLilthhiS1Tz4aGDHIPwC1mlvnf7fg5lecYpMCrLLhauAc1UJXcgl<br>
<span class="lineno"></span>01xoLuzgtAEAgv2P/jgytzRSpUYvgLBt1UA0leLYBy6mQQbrNEuqT3INapKIcUv8<br>
<span class="lineno"></span>XxYP0xMEUksLPq6Ca+CRSqTtrd/23uTnapkwCQYHKoZIzj0EAQOBigAwgYYCQXJo<br>
<span class="lineno"></span>A7Sl2nLVf+4Iu/tAX/IF4MavARKC4PPHK3zfuGfPR3oCCcsAoz3kAzOeijvd0iXb<br>
<span class="lineno">65</span>H5jBImIxPL4WxQNiBTexAkF8D1EtpYuWdlVQ80/h/f4pBcGiXPqX5h2PQSQY7hP1<br>
<span class="lineno"></span>+jwM1FGS4fREIOvlBYr/SzzQRtwrvrzGYxDEDbsC0ZGRnA==<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="7149603">var</span>&nbsp;<span class="ident" id="7149607">ecdsaKeyPEM</span>&nbsp;<span class="op" id="7149619">=</span>&nbsp;<span class="string" id="7149621">`-----BEGIN&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>BgUrgQQAIw==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PARAMETERS-----<br>
<span class="lineno"></span>-----BEGIN&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIHcAgEBBEIBrsoKp0oqcv6/JovJJDoDVSGWdirrkgCWxrprGlzB9o0X8fV675X0<br>
<span class="lineno">75</span>NwuBenXFfeZvVcwluO7/Q9wkYoPd/t3jGImgBwYFK4EEACOhgYkDgYYABAFj36bL<br>
<span class="lineno"></span>06h5JRGUNB1X/Hwuw64uKW2GGJLVPPhoYMcg/ALWaW+d/t+DmV5xikwKssuFq4Bz<br>
<span class="lineno"></span>VQldyCXTXGgu7OC0AQCC/Y/+ODK3NFKlRi+AsG3VQDSV4tgHLqZBBus0S6pPcg1q<br>
<span class="lineno"></span>kohxS/xfFg/TEwRSSws+roJr4JFKpO2t3/be5OdqmQ==<br>
<span class="lineno"></span>-----END&nbsp;EC&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno">80</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7150061">var</span>&nbsp;<span class="ident" id="7150065">keyPairTests</span>&nbsp;<span class="op" id="7150078">=</span>&nbsp;<span class="op" id="7150080">[</span><span class="op" id="7150081">]</span><span class="keyword" id="7150082">struct</span>&nbsp;<span class="op" id="7150089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150092">algo</span>&nbsp;<span class="builtintype" id="7150097">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150105">cert</span>&nbsp;<span class="builtintype" id="7150110">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150118">key</span>&nbsp;&nbsp;<span class="builtintype" id="7150123">string</span><br>
<span class="lineno"></span><span class="op" id="7150130">}</span><span class="op" id="7150131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150134">{</span><span class="string" id="7150135">&#34;ECDSA&#34;</span><span class="op" id="7150142">,</span>&nbsp;<span class="ident" id="7150144"><a href="/crypto/tls/tls_test.go.html#7148831">ecdsaCertPEM</a></span><span class="op" id="7150156">,</span>&nbsp;<span class="ident" id="7150158"><a href="/crypto/tls/tls_test.go.html#7149607">ecdsaKeyPEM</a></span><span class="op" id="7150169">}</span><span class="op" id="7150170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150173">{</span><span class="string" id="7150174">&#34;RSA&#34;</span><span class="op" id="7150179">,</span>&nbsp;<span class="ident" id="7150181"><a href="/crypto/tls/tls_test.go.html#7146960">rsaCertPEM</a></span><span class="op" id="7150191">,</span>&nbsp;<span class="ident" id="7150193"><a href="/crypto/tls/tls_test.go.html#7147673">rsaKeyPEM</a></span><span class="op" id="7150202">}</span><span class="op" id="7150203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150206">{</span><span class="string" id="7150207">&#34;RSA-untyped&#34;</span><span class="op" id="7150220">,</span>&nbsp;<span class="ident" id="7150222"><a href="/crypto/tls/tls_test.go.html#7146960">rsaCertPEM</a></span><span class="op" id="7150232">,</span>&nbsp;<span class="ident" id="7150234"><a href="/crypto/tls/tls_test.go.html#7148325">keyPEM</a></span><span class="op" id="7150240">}</span><span class="op" id="7150241">,</span>&nbsp;<span class="comment" id="7150243">//&nbsp;golang.org/issue/4477</span><br>
<span class="lineno">90</span><span class="op" id="7150268">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7150271">func</span>&nbsp;<span class="ident" id="7150276">TestX509KeyPair</span><span class="op" id="7150291">(</span><span class="ident" id="7150292">t</span>&nbsp;<span class="op" id="7150294">*</span><span class="ident" id="7150295"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7150302">.</span><span class="ident" id="7150303">T</span><span class="op" id="7150304">)</span>&nbsp;<span class="op" id="7150306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150309">var</span>&nbsp;<span class="ident" id="7150313">pem</span>&nbsp;<span class="op" id="7150317">[</span><span class="op" id="7150318">]</span><span class="builtintype" id="7150319">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150325">for</span>&nbsp;<span class="ident" id="7150329">_</span><span class="op" id="7150330">,</span>&nbsp;<span class="ident" id="7150332">test</span>&nbsp;<span class="op" id="7150337">:=</span>&nbsp;<span class="keyword" id="7150340">range</span>&nbsp;<span class="ident" id="7150346"><a href="/crypto/tls/tls_test.go.html#7150065">keyPairTests</a></span>&nbsp;<span class="op" id="7150359">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150363"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span>&nbsp;<span class="op" id="7150367">=</span>&nbsp;<span class="op" id="7150369">[</span><span class="op" id="7150370">]</span><span class="builtintype" id="7150371">byte</span><span class="op" id="7150375">(</span><span class="ident" id="7150376"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150380">.</span><span class="ident" id="7150381">cert</span>&nbsp;<span class="op" id="7150386">+</span>&nbsp;<span class="ident" id="7150388"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150392">.</span><span class="ident" id="7150393">key</span><span class="op" id="7150396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150400">if</span>&nbsp;<span class="ident" id="7150403">_</span><span class="op" id="7150404">,</span>&nbsp;<span class="ident" id="7150406">err</span>&nbsp;<span class="op" id="7150410">:=</span>&nbsp;<span class="ident" id="7150413"><a href="/crypto/tls/tls.go.html#4253993">X509KeyPair</a></span><span class="op" id="7150424">(</span><span class="ident" id="7150425"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span><span class="op" id="7150428">,</span>&nbsp;<span class="ident" id="7150430"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span><span class="op" id="7150433">)</span><span class="op" id="7150434">;</span>&nbsp;<span class="ident" id="7150436"><a href="/crypto/tls/tls_test.go.html#7150406">err</a></span>&nbsp;<span class="op" id="7150440">!=</span>&nbsp;<span class="ident" id="7150443">nil</span>&nbsp;<span class="op" id="7150447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150452"><a href="/crypto/tls/tls_test.go.html#7150292">t</a></span><span class="op" id="7150453">.</span><span class="ident" id="7150454">Errorf</span><span class="op" id="7150460">(</span><span class="string" id="7150461">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;cert&nbsp;followed&nbsp;by&nbsp;%s&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7150508">,</span>&nbsp;<span class="ident" id="7150510"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150514">.</span><span class="ident" id="7150515">algo</span><span class="op" id="7150519">,</span>&nbsp;<span class="ident" id="7150521"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150525">.</span><span class="ident" id="7150526">algo</span><span class="op" id="7150530">,</span>&nbsp;<span class="ident" id="7150532"><a href="/crypto/tls/tls_test.go.html#7150406">err</a></span><span class="op" id="7150535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150543"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span>&nbsp;<span class="op" id="7150547">=</span>&nbsp;<span class="op" id="7150549">[</span><span class="op" id="7150550">]</span><span class="builtintype" id="7150551">byte</span><span class="op" id="7150555">(</span><span class="ident" id="7150556"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150560">.</span><span class="ident" id="7150561">key</span>&nbsp;<span class="op" id="7150565">+</span>&nbsp;<span class="ident" id="7150567"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150571">.</span><span class="ident" id="7150572">cert</span><span class="op" id="7150576">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150580">if</span>&nbsp;<span class="ident" id="7150583">_</span><span class="op" id="7150584">,</span>&nbsp;<span class="ident" id="7150586">err</span>&nbsp;<span class="op" id="7150590">:=</span>&nbsp;<span class="ident" id="7150593"><a href="/crypto/tls/tls.go.html#4253993">X509KeyPair</a></span><span class="op" id="7150604">(</span><span class="ident" id="7150605"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span><span class="op" id="7150608">,</span>&nbsp;<span class="ident" id="7150610"><a href="/crypto/tls/tls_test.go.html#7150313">pem</a></span><span class="op" id="7150613">)</span><span class="op" id="7150614">;</span>&nbsp;<span class="ident" id="7150616"><a href="/crypto/tls/tls_test.go.html#7150586">err</a></span>&nbsp;<span class="op" id="7150620">!=</span>&nbsp;<span class="ident" id="7150623">nil</span>&nbsp;<span class="op" id="7150627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150632"><a href="/crypto/tls/tls_test.go.html#7150292">t</a></span><span class="op" id="7150633">.</span><span class="ident" id="7150634">Errorf</span><span class="op" id="7150640">(</span><span class="string" id="7150641">&#34;Failed&nbsp;to&nbsp;load&nbsp;%s&nbsp;key&nbsp;followed&nbsp;by&nbsp;%s&nbsp;cert:&nbsp;%s&#34;</span><span class="op" id="7150688">,</span>&nbsp;<span class="ident" id="7150690"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150694">.</span><span class="ident" id="7150695">algo</span><span class="op" id="7150699">,</span>&nbsp;<span class="ident" id="7150701"><a href="/crypto/tls/tls_test.go.html#7150332">test</a></span><span class="op" id="7150705">.</span><span class="ident" id="7150706">algo</span><span class="op" id="7150710">,</span>&nbsp;<span class="ident" id="7150712"><a href="/crypto/tls/tls_test.go.html#7150586">err</a></span><span class="op" id="7150715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150722">}</span><br>
<span class="lineno"></span><span class="op" id="7150724">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="7150727">func</span>&nbsp;<span class="ident" id="7150732">TestX509MixedKeyPair</span><span class="op" id="7150752">(</span><span class="ident" id="7150753">t</span>&nbsp;<span class="op" id="7150755">*</span><span class="ident" id="7150756"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7150763">.</span><span class="ident" id="7150764">T</span><span class="op" id="7150765">)</span>&nbsp;<span class="op" id="7150767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150770">if</span>&nbsp;<span class="ident" id="7150773">_</span><span class="op" id="7150774">,</span>&nbsp;<span class="ident" id="7150776">err</span>&nbsp;<span class="op" id="7150780">:=</span>&nbsp;<span class="ident" id="7150783"><a href="/crypto/tls/tls.go.html#4253993">X509KeyPair</a></span><span class="op" id="7150794">(</span><span class="op" id="7150795">[</span><span class="op" id="7150796">]</span><span class="builtintype" id="7150797">byte</span><span class="op" id="7150801">(</span><span class="ident" id="7150802"><a href="/crypto/tls/tls_test.go.html#7146960">rsaCertPEM</a></span><span class="op" id="7150812">)</span><span class="op" id="7150813">,</span>&nbsp;<span class="op" id="7150815">[</span><span class="op" id="7150816">]</span><span class="builtintype" id="7150817">byte</span><span class="op" id="7150821">(</span><span class="ident" id="7150822"><a href="/crypto/tls/tls_test.go.html#7149607">ecdsaKeyPEM</a></span><span class="op" id="7150833">)</span><span class="op" id="7150834">)</span><span class="op" id="7150835">;</span>&nbsp;<span class="ident" id="7150837"><a href="/crypto/tls/tls_test.go.html#7150776">err</a></span>&nbsp;<span class="op" id="7150841">==</span>&nbsp;<span class="ident" id="7150844">nil</span>&nbsp;<span class="op" id="7150848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7150852"><a href="/crypto/tls/tls_test.go.html#7150753">t</a></span><span class="op" id="7150853">.</span><span class="ident" id="7150854">Error</span><span class="op" id="7150859">(</span><span class="string" id="7150860">&#34;Load&nbsp;of&nbsp;RSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;ECDSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="7150918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7150921">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7150924">if</span>&nbsp;<span class="ident" id="7150927">_</span><span class="op" id="7150928">,</span>&nbsp;<span class="ident" id="7150930">err</span>&nbsp;<span class="op" id="7150934">:=</span>&nbsp;<span class="ident" id="7150937"><a href="/crypto/tls/tls.go.html#4253993">X509KeyPair</a></span><span class="op" id="7150948">(</span><span class="op" id="7150949">[</span><span class="op" id="7150950">]</span><span class="builtintype" id="7150951">byte</span><span class="op" id="7150955">(</span><span class="ident" id="7150956"><a href="/crypto/tls/tls_test.go.html#7148831">ecdsaCertPEM</a></span><span class="op" id="7150968">)</span><span class="op" id="7150969">,</span>&nbsp;<span class="op" id="7150971">[</span><span class="op" id="7150972">]</span><span class="builtintype" id="7150973">byte</span><span class="op" id="7150977">(</span><span class="ident" id="7150978"><a href="/crypto/tls/tls_test.go.html#7147673">rsaKeyPEM</a></span><span class="op" id="7150987">)</span><span class="op" id="7150988">)</span><span class="op" id="7150989">;</span>&nbsp;<span class="ident" id="7150991"><a href="/crypto/tls/tls_test.go.html#7150930">err</a></span>&nbsp;<span class="op" id="7150995">==</span>&nbsp;<span class="ident" id="7150998">nil</span>&nbsp;<span class="op" id="7151002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151006"><a href="/crypto/tls/tls_test.go.html#7150753">t</a></span><span class="op" id="7151007">.</span><span class="ident" id="7151008">Error</span><span class="op" id="7151013">(</span><span class="string" id="7151014">&#34;Load&nbsp;of&nbsp;ECDSA&nbsp;certificate&nbsp;succeeded&nbsp;with&nbsp;RSA&nbsp;private&nbsp;key&#34;</span><span class="op" id="7151072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151075">}</span><br>
<span class="lineno"></span><span class="op" id="7151077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="7151080">func</span>&nbsp;<span class="ident" id="7151085">newLocalListener</span><span class="op" id="7151101">(</span><span class="ident" id="7151102">t</span>&nbsp;<span class="op" id="7151104">*</span><span class="ident" id="7151105"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7151112">.</span><span class="ident" id="7151113">T</span><span class="op" id="7151114">)</span>&nbsp;<span class="ident" id="7151116"><a href="/crypto/tls/tls_test.go.html#7146917">net</a></span><span class="op" id="7151119">.</span><span class="ident" id="7151120">Listener</span>&nbsp;<span class="op" id="7151129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151132">ln</span><span class="op" id="7151134">,</span>&nbsp;<span class="ident" id="7151136">err</span>&nbsp;<span class="op" id="7151140">:=</span>&nbsp;<span class="ident" id="7151143"><a href="/crypto/tls/tls_test.go.html#7146917">net</a></span><span class="op" id="7151146">.</span><span class="ident" id="7151147">Listen</span><span class="op" id="7151153">(</span><span class="string" id="7151154">&#34;tcp&#34;</span><span class="op" id="7151159">,</span>&nbsp;<span class="string" id="7151161">&#34;127.0.0.1:0&#34;</span><span class="op" id="7151174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151177">if</span>&nbsp;<span class="ident" id="7151180"><a href="/crypto/tls/tls_test.go.html#7151136">err</a></span>&nbsp;<span class="op" id="7151184">!=</span>&nbsp;<span class="ident" id="7151187">nil</span>&nbsp;<span class="op" id="7151191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151195"><a href="/crypto/tls/tls_test.go.html#7151132">ln</a></span><span class="op" id="7151197">,</span>&nbsp;<span class="ident" id="7151199"><a href="/crypto/tls/tls_test.go.html#7151136">err</a></span>&nbsp;<span class="op" id="7151203">=</span>&nbsp;<span class="ident" id="7151205"><a href="/crypto/tls/tls_test.go.html#7146917">net</a></span><span class="op" id="7151208">.</span><span class="ident" id="7151209">Listen</span><span class="op" id="7151215">(</span><span class="string" id="7151216">&#34;tcp6&#34;</span><span class="op" id="7151222">,</span>&nbsp;<span class="string" id="7151224">&#34;[::1]:0&#34;</span><span class="op" id="7151233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151236">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151239">if</span>&nbsp;<span class="ident" id="7151242"><a href="/crypto/tls/tls_test.go.html#7151136">err</a></span>&nbsp;<span class="op" id="7151246">!=</span>&nbsp;<span class="ident" id="7151249">nil</span>&nbsp;<span class="op" id="7151253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151257"><a href="/crypto/tls/tls_test.go.html#7151102">t</a></span><span class="op" id="7151258">.</span><span class="ident" id="7151259">Fatal</span><span class="op" id="7151264">(</span><span class="ident" id="7151265"><a href="/crypto/tls/tls_test.go.html#7151136">err</a></span><span class="op" id="7151268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151274">return</span>&nbsp;<span class="ident" id="7151281"><a href="/crypto/tls/tls_test.go.html#7151132">ln</a></span><br>
<span class="lineno"></span><span class="op" id="7151284">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7151287">func</span>&nbsp;<span class="ident" id="7151292">TestDialTimeout</span><span class="op" id="7151307">(</span><span class="ident" id="7151308">t</span>&nbsp;<span class="op" id="7151310">*</span><span class="ident" id="7151311"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7151318">.</span><span class="ident" id="7151319">T</span><span class="op" id="7151320">)</span>&nbsp;<span class="op" id="7151322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151325">if</span>&nbsp;<span class="ident" id="7151328"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7151335">.</span><span class="ident" id="7151336">Short</span><span class="op" id="7151341">(</span><span class="op" id="7151342">)</span>&nbsp;<span class="op" id="7151344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151348"><a href="/crypto/tls/tls_test.go.html#7151308">t</a></span><span class="op" id="7151349">.</span><span class="ident" id="7151350">Skip</span><span class="op" id="7151354">(</span><span class="string" id="7151355">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7151379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151382">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151385">listener</span>&nbsp;<span class="op" id="7151394">:=</span>&nbsp;<span class="ident" id="7151397"><a href="/crypto/tls/tls_test.go.html#7151085">newLocalListener</a></span><span class="op" id="7151413">(</span><span class="ident" id="7151414"><a href="/crypto/tls/tls_test.go.html#7151308">t</a></span><span class="op" id="7151415">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151419">addr</span>&nbsp;<span class="op" id="7151424">:=</span>&nbsp;<span class="ident" id="7151427"><a href="/crypto/tls/tls_test.go.html#7151385">listener</a></span><span class="op" id="7151435">.</span><span class="ident" id="7151436">Addr</span><span class="op" id="7151440">(</span><span class="op" id="7151441">)</span><span class="op" id="7151442">.</span><span class="ident" id="7151443">String</span><span class="op" id="7151449">(</span><span class="op" id="7151450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151453">defer</span>&nbsp;<span class="ident" id="7151459"><a href="/crypto/tls/tls_test.go.html#7151385">listener</a></span><span class="op" id="7151467">.</span><span class="ident" id="7151468">Close</span><span class="op" id="7151473">(</span><span class="op" id="7151474">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151478">complete</span>&nbsp;<span class="op" id="7151487">:=</span>&nbsp;<span class="builtinfunc" id="7151490">make</span><span class="op" id="7151494">(</span><span class="keyword" id="7151495">chan</span>&nbsp;<span class="builtintype" id="7151500">bool</span><span class="op" id="7151504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151507">defer</span>&nbsp;<span class="builtinfunc" id="7151513">close</span><span class="op" id="7151518">(</span><span class="ident" id="7151519"><a href="/crypto/tls/tls_test.go.html#7151478">complete</a></span><span class="op" id="7151527">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151531">go</span>&nbsp;<span class="keyword" id="7151534">func</span><span class="op" id="7151538">(</span><span class="op" id="7151539">)</span>&nbsp;<span class="op" id="7151541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151545">conn</span><span class="op" id="7151549">,</span>&nbsp;<span class="ident" id="7151551">err</span>&nbsp;<span class="op" id="7151555">:=</span>&nbsp;<span class="ident" id="7151558"><a href="/crypto/tls/tls_test.go.html#7151385">listener</a></span><span class="op" id="7151566">.</span><span class="ident" id="7151567">Accept</span><span class="op" id="7151573">(</span><span class="op" id="7151574">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151578">if</span>&nbsp;<span class="ident" id="7151581"><a href="/crypto/tls/tls_test.go.html#7151551">err</a></span>&nbsp;<span class="op" id="7151585">!=</span>&nbsp;<span class="ident" id="7151588">nil</span>&nbsp;<span class="op" id="7151592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151597"><a href="/crypto/tls/tls_test.go.html#7151308">t</a></span><span class="op" id="7151598">.</span><span class="ident" id="7151599">Error</span><span class="op" id="7151604">(</span><span class="ident" id="7151605"><a href="/crypto/tls/tls_test.go.html#7151551">err</a></span><span class="op" id="7151608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151613">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151622">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151626">&lt;-</span><span class="ident" id="7151628"><a href="/crypto/tls/tls_test.go.html#7151478">complete</a></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151639"><a href="/crypto/tls/tls_test.go.html#7151545">conn</a></span><span class="op" id="7151643">.</span><span class="ident" id="7151644">Close</span><span class="op" id="7151649">(</span><span class="op" id="7151650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151653">}</span><span class="op" id="7151654">(</span><span class="op" id="7151655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151659">dialer</span>&nbsp;<span class="op" id="7151666">:=</span>&nbsp;<span class="op" id="7151669">&amp;</span><span class="ident" id="7151670"><a href="/crypto/tls/tls_test.go.html#7146917">net</a></span><span class="op" id="7151673">.</span><span class="ident" id="7151674">Dialer</span><span class="op" id="7151680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151684">Timeout</span><span class="op" id="7151691">:</span>&nbsp;<span class="num" id="7151693">10</span>&nbsp;<span class="op" id="7151696">*</span>&nbsp;<span class="ident" id="7151698"><a href="/crypto/tls/tls_test.go.html#7146946">time</a></span><span class="op" id="7151702">.</span><span class="ident" id="7151703">Millisecond</span><span class="op" id="7151714">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151721">var</span>&nbsp;<span class="ident" id="7151725">err</span>&nbsp;<span class="builtintype" id="7151729">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151736">if</span>&nbsp;<span class="ident" id="7151739">_</span><span class="op" id="7151740">,</span>&nbsp;<span class="ident" id="7151742"><a href="/crypto/tls/tls_test.go.html#7151725">err</a></span>&nbsp;<span class="op" id="7151746">=</span>&nbsp;<span class="ident" id="7151748"><a href="/crypto/tls/tls.go.html#4251717">DialWithDialer</a></span><span class="op" id="7151762">(</span><span class="ident" id="7151763"><a href="/crypto/tls/tls_test.go.html#7151659">dialer</a></span><span class="op" id="7151769">,</span>&nbsp;<span class="string" id="7151771">&#34;tcp&#34;</span><span class="op" id="7151776">,</span>&nbsp;<span class="ident" id="7151778"><a href="/crypto/tls/tls_test.go.html#7151419">addr</a></span><span class="op" id="7151782">,</span>&nbsp;<span class="ident" id="7151784">nil</span><span class="op" id="7151787">)</span><span class="op" id="7151788">;</span>&nbsp;<span class="ident" id="7151790"><a href="/crypto/tls/tls_test.go.html#7151725">err</a></span>&nbsp;<span class="op" id="7151794">==</span>&nbsp;<span class="ident" id="7151797">nil</span>&nbsp;<span class="op" id="7151801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151805"><a href="/crypto/tls/tls_test.go.html#7151308">t</a></span><span class="op" id="7151806">.</span><span class="ident" id="7151807">Fatal</span><span class="op" id="7151812">(</span><span class="string" id="7151813">&#34;DialWithTimeout&nbsp;completed&nbsp;successfully&#34;</span><span class="op" id="7151853">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7151860">if</span>&nbsp;<span class="op" id="7151863">!</span><span class="ident" id="7151864"><a href="/crypto/tls/tls_test.go.html#7146924">strings</a></span><span class="op" id="7151871">.</span><span class="ident" id="7151872">Contains</span><span class="op" id="7151880">(</span><span class="ident" id="7151881"><a href="/crypto/tls/tls_test.go.html#7151725">err</a></span><span class="op" id="7151884">.</span><span class="ident" id="7151885">Error</span><span class="op" id="7151890">(</span><span class="op" id="7151891">)</span><span class="op" id="7151892">,</span>&nbsp;<span class="string" id="7151894">&#34;timed&nbsp;out&#34;</span><span class="op" id="7151905">)</span>&nbsp;<span class="op" id="7151907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7151911"><a href="/crypto/tls/tls_test.go.html#7151308">t</a></span><span class="op" id="7151912">.</span><span class="ident" id="7151913">Errorf</span><span class="op" id="7151919">(</span><span class="string" id="7151920">&#34;resulting&nbsp;error&nbsp;not&nbsp;a&nbsp;timeout:&nbsp;%s&#34;</span><span class="op" id="7151955">,</span>&nbsp;<span class="ident" id="7151957"><a href="/crypto/tls/tls_test.go.html#7151725">err</a></span><span class="op" id="7151960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7151963">}</span><br>
<span class="lineno">160</span><span class="op" id="7151965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7151968">//&nbsp;tests&nbsp;that&nbsp;Conn.Read&nbsp;returns&nbsp;(non-zero,&nbsp;io.EOF)&nbsp;instead&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="7152030">//&nbsp;(non-zero,&nbsp;nil)&nbsp;when&nbsp;a&nbsp;Close&nbsp;(alertCloseNotify)&nbsp;is&nbsp;sitting&nbsp;right</span><br>
<span class="lineno"></span><span class="comment" id="7152098">//&nbsp;behind&nbsp;the&nbsp;application&nbsp;data&nbsp;in&nbsp;the&nbsp;buffer.</span><br>
<span class="lineno">165</span><span class="keyword" id="7152144">func</span>&nbsp;<span class="ident" id="7152149">TestConnReadNonzeroAndEOF</span><span class="op" id="7152174">(</span><span class="ident" id="7152175">t</span>&nbsp;<span class="op" id="7152177">*</span><span class="ident" id="7152178"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7152185">.</span><span class="ident" id="7152186">T</span><span class="op" id="7152187">)</span>&nbsp;<span class="op" id="7152189">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152192">//&nbsp;This&nbsp;test&nbsp;is&nbsp;racy:&nbsp;it&nbsp;assumes&nbsp;that&nbsp;after&nbsp;a&nbsp;write&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152250">//&nbsp;localhost&nbsp;TCP&nbsp;connection,&nbsp;the&nbsp;peer&nbsp;TCP&nbsp;connection&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152308">//&nbsp;immediately&nbsp;read&nbsp;it.&nbsp;&nbsp;Because&nbsp;it&#39;s&nbsp;racy,&nbsp;we&nbsp;skip&nbsp;this&nbsp;test</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152371">//&nbsp;in&nbsp;short&nbsp;mode,&nbsp;and&nbsp;then&nbsp;retry&nbsp;it&nbsp;several&nbsp;times&nbsp;with&nbsp;an</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152430">//&nbsp;increasing&nbsp;sleep&nbsp;in&nbsp;between&nbsp;our&nbsp;final&nbsp;write&nbsp;(via&nbsp;srv.Close</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7152493">//&nbsp;below)&nbsp;and&nbsp;the&nbsp;following&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152528">if</span>&nbsp;<span class="ident" id="7152531"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7152538">.</span><span class="ident" id="7152539">Short</span><span class="op" id="7152544">(</span><span class="op" id="7152545">)</span>&nbsp;<span class="op" id="7152547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152551"><a href="/crypto/tls/tls_test.go.html#7152175">t</a></span><span class="op" id="7152552">.</span><span class="ident" id="7152553">Skip</span><span class="op" id="7152557">(</span><span class="string" id="7152558">&#34;skipping&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7152582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7152585">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152588">var</span>&nbsp;<span class="ident" id="7152592">err</span>&nbsp;<span class="builtintype" id="7152596">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152603">for</span>&nbsp;<span class="ident" id="7152607">delay</span>&nbsp;<span class="op" id="7152613">:=</span>&nbsp;<span class="ident" id="7152616"><a href="/crypto/tls/tls_test.go.html#7146946">time</a></span><span class="op" id="7152620">.</span><span class="ident" id="7152621">Millisecond</span><span class="op" id="7152632">;</span>&nbsp;<span class="ident" id="7152634"><a href="/crypto/tls/tls_test.go.html#7152607">delay</a></span>&nbsp;<span class="op" id="7152640">&lt;=</span>&nbsp;<span class="num" id="7152643">64</span><span class="op" id="7152645">*</span><span class="ident" id="7152646"><a href="/crypto/tls/tls_test.go.html#7146946">time</a></span><span class="op" id="7152650">.</span><span class="ident" id="7152651">Millisecond</span><span class="op" id="7152662">;</span>&nbsp;<span class="ident" id="7152664"><a href="/crypto/tls/tls_test.go.html#7152607">delay</a></span>&nbsp;<span class="op" id="7152670">*=</span>&nbsp;<span class="num" id="7152673">2</span>&nbsp;<span class="op" id="7152675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152679">if</span>&nbsp;<span class="ident" id="7152682"><a href="/crypto/tls/tls_test.go.html#7152592">err</a></span>&nbsp;<span class="op" id="7152686">=</span>&nbsp;<span class="ident" id="7152688"><a href="/crypto/tls/tls_test.go.html#7152777">testConnReadNonzeroAndEOF</a></span><span class="op" id="7152713">(</span><span class="ident" id="7152714"><a href="/crypto/tls/tls_test.go.html#7152175">t</a></span><span class="op" id="7152715">,</span>&nbsp;<span class="ident" id="7152717"><a href="/crypto/tls/tls_test.go.html#7152607">delay</a></span><span class="op" id="7152722">)</span><span class="op" id="7152723">;</span>&nbsp;<span class="ident" id="7152725"><a href="/crypto/tls/tls_test.go.html#7152592">err</a></span>&nbsp;<span class="op" id="7152729">==</span>&nbsp;<span class="ident" id="7152732">nil</span>&nbsp;<span class="op" id="7152736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152741">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7152750">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7152753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152756"><a href="/crypto/tls/tls_test.go.html#7152175">t</a></span><span class="op" id="7152757">.</span><span class="ident" id="7152758">Error</span><span class="op" id="7152763">(</span><span class="ident" id="7152764"><a href="/crypto/tls/tls_test.go.html#7152592">err</a></span><span class="op" id="7152767">)</span><br>
<span class="lineno"></span><span class="op" id="7152769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7152772">func</span>&nbsp;<span class="ident" id="7152777">testConnReadNonzeroAndEOF</span><span class="op" id="7152802">(</span><span class="ident" id="7152803">t</span>&nbsp;<span class="op" id="7152805">*</span><span class="ident" id="7152806"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7152813">.</span><span class="ident" id="7152814">T</span><span class="op" id="7152815">,</span>&nbsp;<span class="ident" id="7152817">delay</span>&nbsp;<span class="ident" id="7152823"><a href="/crypto/tls/tls_test.go.html#7146946">time</a></span><span class="op" id="7152827">.</span><span class="ident" id="7152828">Duration</span><span class="op" id="7152836">)</span>&nbsp;<span class="builtintype" id="7152838">error</span>&nbsp;<span class="op" id="7152844">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152847">ln</span>&nbsp;<span class="op" id="7152850">:=</span>&nbsp;<span class="ident" id="7152853"><a href="/crypto/tls/tls_test.go.html#7151085">newLocalListener</a></span><span class="op" id="7152869">(</span><span class="ident" id="7152870"><a href="/crypto/tls/tls_test.go.html#7152803">t</a></span><span class="op" id="7152871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152874">defer</span>&nbsp;<span class="ident" id="7152880"><a href="/crypto/tls/tls_test.go.html#7152847">ln</a></span><span class="op" id="7152882">.</span><span class="ident" id="7152883">Close</span><span class="op" id="7152888">(</span><span class="op" id="7152889">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152893">srvCh</span>&nbsp;<span class="op" id="7152899">:=</span>&nbsp;<span class="builtinfunc" id="7152902">make</span><span class="op" id="7152906">(</span><span class="keyword" id="7152907">chan</span>&nbsp;<span class="op" id="7152912">*</span><span class="ident" id="7152913"><a href="/crypto/tls/conn.go.html#4127599">Conn</a></span><span class="op" id="7152917">,</span>&nbsp;<span class="num" id="7152919">1</span><span class="op" id="7152920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152923">var</span>&nbsp;<span class="ident" id="7152927">serr</span>&nbsp;<span class="builtintype" id="7152932">error</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152939">go</span>&nbsp;<span class="keyword" id="7152942">func</span><span class="op" id="7152946">(</span><span class="op" id="7152947">)</span>&nbsp;<span class="op" id="7152949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7152953">sconn</span><span class="op" id="7152958">,</span>&nbsp;<span class="ident" id="7152960">err</span>&nbsp;<span class="op" id="7152964">:=</span>&nbsp;<span class="ident" id="7152967"><a href="/crypto/tls/tls_test.go.html#7152847">ln</a></span><span class="op" id="7152969">.</span><span class="ident" id="7152970">Accept</span><span class="op" id="7152976">(</span><span class="op" id="7152977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7152981">if</span>&nbsp;<span class="ident" id="7152984"><a href="/crypto/tls/tls_test.go.html#7152960">err</a></span>&nbsp;<span class="op" id="7152988">!=</span>&nbsp;<span class="ident" id="7152991">nil</span>&nbsp;<span class="op" id="7152995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153000"><a href="/crypto/tls/tls_test.go.html#7152927">serr</a></span>&nbsp;<span class="op" id="7153005">=</span>&nbsp;<span class="ident" id="7153007"><a href="/crypto/tls/tls_test.go.html#7152960">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153014"><a href="/crypto/tls/tls_test.go.html#7152893">srvCh</a></span>&nbsp;<span class="op" id="7153020">&lt;-</span>&nbsp;<span class="ident" id="7153023">nil</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153030">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153043">serverConfig</span>&nbsp;<span class="op" id="7153056">:=</span>&nbsp;<span class="op" id="7153059">*</span><span class="ident" id="7153060"><a href="/crypto/tls/handshake_server_test.go.html#7106976">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153073">srv</span>&nbsp;<span class="op" id="7153077">:=</span>&nbsp;<span class="ident" id="7153080"><a href="/crypto/tls/tls.go.html#4249440">Server</a></span><span class="op" id="7153086">(</span><span class="ident" id="7153087"><a href="/crypto/tls/tls_test.go.html#7152953">sconn</a></span><span class="op" id="7153092">,</span>&nbsp;<span class="op" id="7153094">&amp;</span><span class="ident" id="7153095"><a href="/crypto/tls/tls_test.go.html#7153043">serverConfig</a></span><span class="op" id="7153107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153111">if</span>&nbsp;<span class="ident" id="7153114">err</span>&nbsp;<span class="op" id="7153118">:=</span>&nbsp;<span class="ident" id="7153121"><a href="/crypto/tls/tls_test.go.html#7153073">srv</a></span><span class="op" id="7153124">.</span><span class="ident" id="7153125">Handshake</span><span class="op" id="7153134">(</span><span class="op" id="7153135">)</span><span class="op" id="7153136">;</span>&nbsp;<span class="ident" id="7153138"><a href="/crypto/tls/tls_test.go.html#7153114">err</a></span>&nbsp;<span class="op" id="7153142">!=</span>&nbsp;<span class="ident" id="7153145">nil</span>&nbsp;<span class="op" id="7153149">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153154"><a href="/crypto/tls/tls_test.go.html#7152927">serr</a></span>&nbsp;<span class="op" id="7153159">=</span>&nbsp;<span class="ident" id="7153161"><a href="/crypto/tls/tls_test.go.html#7146904">fmt</a></span><span class="op" id="7153164">.</span><span class="ident" id="7153165">Errorf</span><span class="op" id="7153171">(</span><span class="string" id="7153172">&#34;handshake:&nbsp;%v&#34;</span><span class="op" id="7153187">,</span>&nbsp;<span class="ident" id="7153189"><a href="/crypto/tls/tls_test.go.html#7153114">err</a></span><span class="op" id="7153192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153197"><a href="/crypto/tls/tls_test.go.html#7152893">srvCh</a></span>&nbsp;<span class="op" id="7153203">&lt;-</span>&nbsp;<span class="ident" id="7153206">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153213">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153226"><a href="/crypto/tls/tls_test.go.html#7152893">srvCh</a></span>&nbsp;<span class="op" id="7153232">&lt;-</span>&nbsp;<span class="ident" id="7153235"><a href="/crypto/tls/tls_test.go.html#7153073">srv</a></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153240">}</span><span class="op" id="7153241">(</span><span class="op" id="7153242">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153246">clientConfig</span>&nbsp;<span class="op" id="7153259">:=</span>&nbsp;<span class="op" id="7153262">*</span><span class="ident" id="7153263"><a href="/crypto/tls/handshake_server_test.go.html#7106976">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153275">conn</span><span class="op" id="7153279">,</span>&nbsp;<span class="ident" id="7153281">err</span>&nbsp;<span class="op" id="7153285">:=</span>&nbsp;<span class="ident" id="7153288"><a href="/crypto/tls/tls.go.html#4253369">Dial</a></span><span class="op" id="7153292">(</span><span class="string" id="7153293">&#34;tcp&#34;</span><span class="op" id="7153298">,</span>&nbsp;<span class="ident" id="7153300"><a href="/crypto/tls/tls_test.go.html#7152847">ln</a></span><span class="op" id="7153302">.</span><span class="ident" id="7153303">Addr</span><span class="op" id="7153307">(</span><span class="op" id="7153308">)</span><span class="op" id="7153309">.</span><span class="ident" id="7153310">String</span><span class="op" id="7153316">(</span><span class="op" id="7153317">)</span><span class="op" id="7153318">,</span>&nbsp;<span class="op" id="7153320">&amp;</span><span class="ident" id="7153321"><a href="/crypto/tls/tls_test.go.html#7153246">clientConfig</a></span><span class="op" id="7153333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153336">if</span>&nbsp;<span class="ident" id="7153339"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span>&nbsp;<span class="op" id="7153343">!=</span>&nbsp;<span class="ident" id="7153346">nil</span>&nbsp;<span class="op" id="7153350">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153354"><a href="/crypto/tls/tls_test.go.html#7152803">t</a></span><span class="op" id="7153355">.</span><span class="ident" id="7153356">Fatal</span><span class="op" id="7153361">(</span><span class="ident" id="7153362"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span><span class="op" id="7153365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153371">defer</span>&nbsp;<span class="ident" id="7153377"><a href="/crypto/tls/tls_test.go.html#7153275">conn</a></span><span class="op" id="7153381">.</span><span class="ident" id="7153382">Close</span><span class="op" id="7153387">(</span><span class="op" id="7153388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153392">srv</span>&nbsp;<span class="op" id="7153396">:=</span>&nbsp;<span class="op" id="7153399">&lt;-</span><span class="ident" id="7153401"><a href="/crypto/tls/tls_test.go.html#7152893">srvCh</a></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153408">if</span>&nbsp;<span class="ident" id="7153411"><a href="/crypto/tls/tls_test.go.html#7153392">srv</a></span>&nbsp;<span class="op" id="7153415">==</span>&nbsp;<span class="ident" id="7153418">nil</span>&nbsp;<span class="op" id="7153422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153426">return</span>&nbsp;<span class="ident" id="7153433"><a href="/crypto/tls/tls_test.go.html#7152927">serr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153443">buf</span>&nbsp;<span class="op" id="7153447">:=</span>&nbsp;<span class="builtinfunc" id="7153450">make</span><span class="op" id="7153454">(</span><span class="op" id="7153455">[</span><span class="op" id="7153456">]</span><span class="builtintype" id="7153457">byte</span><span class="op" id="7153461">,</span>&nbsp;<span class="num" id="7153463">6</span><span class="op" id="7153464">)</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153468"><a href="/crypto/tls/tls_test.go.html#7153392">srv</a></span><span class="op" id="7153471">.</span><span class="ident" id="7153472">Write</span><span class="op" id="7153477">(</span><span class="op" id="7153478">[</span><span class="op" id="7153479">]</span><span class="builtintype" id="7153480">byte</span><span class="op" id="7153484">(</span><span class="string" id="7153485">&#34;foobar&#34;</span><span class="op" id="7153493">)</span><span class="op" id="7153494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153497">n</span><span class="op" id="7153498">,</span>&nbsp;<span class="ident" id="7153500"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span>&nbsp;<span class="op" id="7153504">:=</span>&nbsp;<span class="ident" id="7153507"><a href="/crypto/tls/tls_test.go.html#7153275">conn</a></span><span class="op" id="7153511">.</span><span class="ident" id="7153512">Read</span><span class="op" id="7153516">(</span><span class="ident" id="7153517"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153523">if</span>&nbsp;<span class="ident" id="7153526"><a href="/crypto/tls/tls_test.go.html#7153497">n</a></span>&nbsp;<span class="op" id="7153528">!=</span>&nbsp;<span class="num" id="7153531">6</span>&nbsp;<span class="op" id="7153533">||</span>&nbsp;<span class="ident" id="7153536"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span>&nbsp;<span class="op" id="7153540">!=</span>&nbsp;<span class="ident" id="7153543">nil</span>&nbsp;<span class="op" id="7153547">||</span>&nbsp;<span class="builtintype" id="7153550">string</span><span class="op" id="7153556">(</span><span class="ident" id="7153557"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153560">)</span>&nbsp;<span class="op" id="7153562">!=</span>&nbsp;<span class="string" id="7153565">&#34;foobar&#34;</span>&nbsp;<span class="op" id="7153574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153578">return</span>&nbsp;<span class="ident" id="7153585"><a href="/crypto/tls/tls_test.go.html#7146904">fmt</a></span><span class="op" id="7153588">.</span><span class="ident" id="7153589">Errorf</span><span class="op" id="7153595">(</span><span class="string" id="7153596">&#34;Read&nbsp;=&nbsp;%d,&nbsp;%v,&nbsp;data&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;nil,&nbsp;foobar&#34;</span><span class="op" id="7153641">,</span>&nbsp;<span class="ident" id="7153643"><a href="/crypto/tls/tls_test.go.html#7153497">n</a></span><span class="op" id="7153644">,</span>&nbsp;<span class="ident" id="7153646"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span><span class="op" id="7153649">,</span>&nbsp;<span class="ident" id="7153651"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153654">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153661"><a href="/crypto/tls/tls_test.go.html#7153392">srv</a></span><span class="op" id="7153664">.</span><span class="ident" id="7153665">Write</span><span class="op" id="7153670">(</span><span class="op" id="7153671">[</span><span class="op" id="7153672">]</span><span class="builtintype" id="7153673">byte</span><span class="op" id="7153677">(</span><span class="string" id="7153678">&#34;abcdef&#34;</span><span class="op" id="7153686">)</span><span class="op" id="7153687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153690"><a href="/crypto/tls/tls_test.go.html#7153392">srv</a></span><span class="op" id="7153693">.</span><span class="ident" id="7153694">Close</span><span class="op" id="7153699">(</span><span class="op" id="7153700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153703"><a href="/crypto/tls/tls_test.go.html#7146946">time</a></span><span class="op" id="7153707">.</span><span class="ident" id="7153708">Sleep</span><span class="op" id="7153713">(</span><span class="ident" id="7153714"><a href="/crypto/tls/tls_test.go.html#7152817">delay</a></span><span class="op" id="7153719">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7153722"><a href="/crypto/tls/tls_test.go.html#7153497">n</a></span><span class="op" id="7153723">,</span>&nbsp;<span class="ident" id="7153725"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span>&nbsp;<span class="op" id="7153729">=</span>&nbsp;<span class="ident" id="7153731"><a href="/crypto/tls/tls_test.go.html#7153275">conn</a></span><span class="op" id="7153735">.</span><span class="ident" id="7153736">Read</span><span class="op" id="7153740">(</span><span class="ident" id="7153741"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153747">if</span>&nbsp;<span class="ident" id="7153750"><a href="/crypto/tls/tls_test.go.html#7153497">n</a></span>&nbsp;<span class="op" id="7153752">!=</span>&nbsp;<span class="num" id="7153755">6</span>&nbsp;<span class="op" id="7153757">||</span>&nbsp;<span class="builtintype" id="7153760">string</span><span class="op" id="7153766">(</span><span class="ident" id="7153767"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153770">)</span>&nbsp;<span class="op" id="7153772">!=</span>&nbsp;<span class="string" id="7153775">&#34;abcdef&#34;</span>&nbsp;<span class="op" id="7153784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153788">return</span>&nbsp;<span class="ident" id="7153795"><a href="/crypto/tls/tls_test.go.html#7146904">fmt</a></span><span class="op" id="7153798">.</span><span class="ident" id="7153799">Errorf</span><span class="op" id="7153805">(</span><span class="string" id="7153806">&#34;Read&nbsp;=&nbsp;%d,&nbsp;buf=&nbsp;%q;&nbsp;want&nbsp;6,&nbsp;abcdef&#34;</span><span class="op" id="7153842">,</span>&nbsp;<span class="ident" id="7153844"><a href="/crypto/tls/tls_test.go.html#7153497">n</a></span><span class="op" id="7153845">,</span>&nbsp;<span class="ident" id="7153847"><a href="/crypto/tls/tls_test.go.html#7153443">buf</a></span><span class="op" id="7153850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153856">if</span>&nbsp;<span class="ident" id="7153859"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span>&nbsp;<span class="op" id="7153863">!=</span>&nbsp;<span class="ident" id="7153866"><a href="/crypto/tls/tls_test.go.html#7146911">io</a></span><span class="op" id="7153868">.</span><span class="ident" id="7153869">EOF</span>&nbsp;<span class="op" id="7153873">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153877">return</span>&nbsp;<span class="ident" id="7153884"><a href="/crypto/tls/tls_test.go.html#7146904">fmt</a></span><span class="op" id="7153887">.</span><span class="ident" id="7153888">Errorf</span><span class="op" id="7153894">(</span><span class="string" id="7153895">&#34;Second&nbsp;Read&nbsp;error&nbsp;=&nbsp;%v;&nbsp;want&nbsp;io.EOF&#34;</span><span class="op" id="7153932">,</span>&nbsp;<span class="ident" id="7153934"><a href="/crypto/tls/tls_test.go.html#7153281">err</a></span><span class="op" id="7153937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7153940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7153943">return</span>&nbsp;<span class="ident" id="7153950">nil</span><br>
<span class="lineno"></span><span class="op" id="7153954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7153957">func</span>&nbsp;<span class="ident" id="7153962">TestTLSUniqueMatches</span><span class="op" id="7153982">(</span><span class="ident" id="7153983">t</span>&nbsp;<span class="op" id="7153985">*</span><span class="ident" id="7153986"><a href="/crypto/tls/tls_test.go.html#7146935">testing</a></span><span class="op" id="7153993">.</span><span class="ident" id="7153994">T</span><span class="op" id="7153995">)</span>&nbsp;<span class="op" id="7153997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154000">ln</span>&nbsp;<span class="op" id="7154003">:=</span>&nbsp;<span class="ident" id="7154006"><a href="/crypto/tls/tls_test.go.html#7151085">newLocalListener</a></span><span class="op" id="7154022">(</span><span class="ident" id="7154023"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154027">defer</span>&nbsp;<span class="ident" id="7154033"><a href="/crypto/tls/tls_test.go.html#7154000">ln</a></span><span class="op" id="7154035">.</span><span class="ident" id="7154036">Close</span><span class="op" id="7154041">(</span><span class="op" id="7154042">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154046">serverTLSUniques</span>&nbsp;<span class="op" id="7154063">:=</span>&nbsp;<span class="builtinfunc" id="7154066">make</span><span class="op" id="7154070">(</span><span class="keyword" id="7154071">chan</span>&nbsp;<span class="op" id="7154076">[</span><span class="op" id="7154077">]</span><span class="builtintype" id="7154078">byte</span><span class="op" id="7154082">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154085">go</span>&nbsp;<span class="keyword" id="7154088">func</span><span class="op" id="7154092">(</span><span class="op" id="7154093">)</span>&nbsp;<span class="op" id="7154095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154099">for</span>&nbsp;<span class="ident" id="7154103">i</span>&nbsp;<span class="op" id="7154105">:=</span>&nbsp;<span class="num" id="7154108">0</span><span class="op" id="7154109">;</span>&nbsp;<span class="ident" id="7154111"><a href="/crypto/tls/tls_test.go.html#7154103">i</a></span>&nbsp;<span class="op" id="7154113">&lt;</span>&nbsp;<span class="num" id="7154115">2</span><span class="op" id="7154116">;</span>&nbsp;<span class="ident" id="7154118"><a href="/crypto/tls/tls_test.go.html#7154103">i</a></span><span class="op" id="7154119">++</span>&nbsp;<span class="op" id="7154122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154127">sconn</span><span class="op" id="7154132">,</span>&nbsp;<span class="ident" id="7154134">err</span>&nbsp;<span class="op" id="7154138">:=</span>&nbsp;<span class="ident" id="7154141"><a href="/crypto/tls/tls_test.go.html#7154000">ln</a></span><span class="op" id="7154143">.</span><span class="ident" id="7154144">Accept</span><span class="op" id="7154150">(</span><span class="op" id="7154151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154156">if</span>&nbsp;<span class="ident" id="7154159"><a href="/crypto/tls/tls_test.go.html#7154134">err</a></span>&nbsp;<span class="op" id="7154163">!=</span>&nbsp;<span class="ident" id="7154166">nil</span>&nbsp;<span class="op" id="7154170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154176"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154177">.</span><span class="ident" id="7154178">Fatal</span><span class="op" id="7154183">(</span><span class="ident" id="7154184"><a href="/crypto/tls/tls_test.go.html#7154134">err</a></span><span class="op" id="7154187">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154197">serverConfig</span>&nbsp;<span class="op" id="7154210">:=</span>&nbsp;<span class="op" id="7154213">*</span><span class="ident" id="7154214"><a href="/crypto/tls/handshake_server_test.go.html#7106976">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154228">srv</span>&nbsp;<span class="op" id="7154232">:=</span>&nbsp;<span class="ident" id="7154235"><a href="/crypto/tls/tls.go.html#4249440">Server</a></span><span class="op" id="7154241">(</span><span class="ident" id="7154242"><a href="/crypto/tls/tls_test.go.html#7154127">sconn</a></span><span class="op" id="7154247">,</span>&nbsp;<span class="op" id="7154249">&amp;</span><span class="ident" id="7154250"><a href="/crypto/tls/tls_test.go.html#7154197">serverConfig</a></span><span class="op" id="7154262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154267">if</span>&nbsp;<span class="ident" id="7154270">err</span>&nbsp;<span class="op" id="7154274">:=</span>&nbsp;<span class="ident" id="7154277"><a href="/crypto/tls/tls_test.go.html#7154228">srv</a></span><span class="op" id="7154280">.</span><span class="ident" id="7154281">Handshake</span><span class="op" id="7154290">(</span><span class="op" id="7154291">)</span><span class="op" id="7154292">;</span>&nbsp;<span class="ident" id="7154294"><a href="/crypto/tls/tls_test.go.html#7154270">err</a></span>&nbsp;<span class="op" id="7154298">!=</span>&nbsp;<span class="ident" id="7154301">nil</span>&nbsp;<span class="op" id="7154305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154311"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154312">.</span><span class="ident" id="7154313">Fatal</span><span class="op" id="7154318">(</span><span class="ident" id="7154319"><a href="/crypto/tls/tls_test.go.html#7154270">err</a></span><span class="op" id="7154322">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154332"><a href="/crypto/tls/tls_test.go.html#7154046">serverTLSUniques</a></span>&nbsp;<span class="op" id="7154349">&lt;-</span>&nbsp;<span class="ident" id="7154352"><a href="/crypto/tls/tls_test.go.html#7154228">srv</a></span><span class="op" id="7154355">.</span><span class="ident" id="7154356">ConnectionState</span><span class="op" id="7154371">(</span><span class="op" id="7154372">)</span><span class="op" id="7154373">.</span><span class="ident" id="7154374">TLSUnique</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154389">}</span><span class="op" id="7154390">(</span><span class="op" id="7154391">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154395">clientConfig</span>&nbsp;<span class="op" id="7154408">:=</span>&nbsp;<span class="op" id="7154411">*</span><span class="ident" id="7154412"><a href="/crypto/tls/handshake_server_test.go.html#7106976">testConfig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154424"><a href="/crypto/tls/tls_test.go.html#7154395">clientConfig</a></span><span class="op" id="7154436">.</span><span class="ident" id="7154437">ClientSessionCache</span>&nbsp;<span class="op" id="7154456">=</span>&nbsp;<span class="ident" id="7154458"><a href="/crypto/tls/common.go.html#4125122">NewLRUClientSessionCache</a></span><span class="op" id="7154482">(</span><span class="num" id="7154483">1</span><span class="op" id="7154484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154487">conn</span><span class="op" id="7154491">,</span>&nbsp;<span class="ident" id="7154493">err</span>&nbsp;<span class="op" id="7154497">:=</span>&nbsp;<span class="ident" id="7154500"><a href="/crypto/tls/tls.go.html#4253369">Dial</a></span><span class="op" id="7154504">(</span><span class="string" id="7154505">&#34;tcp&#34;</span><span class="op" id="7154510">,</span>&nbsp;<span class="ident" id="7154512"><a href="/crypto/tls/tls_test.go.html#7154000">ln</a></span><span class="op" id="7154514">.</span><span class="ident" id="7154515">Addr</span><span class="op" id="7154519">(</span><span class="op" id="7154520">)</span><span class="op" id="7154521">.</span><span class="ident" id="7154522">String</span><span class="op" id="7154528">(</span><span class="op" id="7154529">)</span><span class="op" id="7154530">,</span>&nbsp;<span class="op" id="7154532">&amp;</span><span class="ident" id="7154533"><a href="/crypto/tls/tls_test.go.html#7154395">clientConfig</a></span><span class="op" id="7154545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154548">if</span>&nbsp;<span class="ident" id="7154551"><a href="/crypto/tls/tls_test.go.html#7154493">err</a></span>&nbsp;<span class="op" id="7154555">!=</span>&nbsp;<span class="ident" id="7154558">nil</span>&nbsp;<span class="op" id="7154562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154566"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154567">.</span><span class="ident" id="7154568">Fatal</span><span class="op" id="7154573">(</span><span class="ident" id="7154574"><a href="/crypto/tls/tls_test.go.html#7154493">err</a></span><span class="op" id="7154577">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154583">if</span>&nbsp;<span class="op" id="7154586">!</span><span class="ident" id="7154587"><a href="/crypto/tls/tls_test.go.html#7146895">bytes</a></span><span class="op" id="7154592">.</span><span class="ident" id="7154593">Equal</span><span class="op" id="7154598">(</span><span class="ident" id="7154599"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154603">.</span><span class="ident" id="7154604">ConnectionState</span><span class="op" id="7154619">(</span><span class="op" id="7154620">)</span><span class="op" id="7154621">.</span><span class="ident" id="7154622">TLSUnique</span><span class="op" id="7154631">,</span>&nbsp;<span class="op" id="7154633">&lt;-</span><span class="ident" id="7154635"><a href="/crypto/tls/tls_test.go.html#7154046">serverTLSUniques</a></span><span class="op" id="7154651">)</span>&nbsp;<span class="op" id="7154653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154657"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154658">.</span><span class="ident" id="7154659">Error</span><span class="op" id="7154664">(</span><span class="string" id="7154665">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&#34;</span><span class="op" id="7154708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154714"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154718">.</span><span class="ident" id="7154719">Close</span><span class="op" id="7154724">(</span><span class="op" id="7154725">)</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154729"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154733">,</span>&nbsp;<span class="ident" id="7154735"><a href="/crypto/tls/tls_test.go.html#7154493">err</a></span>&nbsp;<span class="op" id="7154739">=</span>&nbsp;<span class="ident" id="7154741"><a href="/crypto/tls/tls.go.html#4253369">Dial</a></span><span class="op" id="7154745">(</span><span class="string" id="7154746">&#34;tcp&#34;</span><span class="op" id="7154751">,</span>&nbsp;<span class="ident" id="7154753"><a href="/crypto/tls/tls_test.go.html#7154000">ln</a></span><span class="op" id="7154755">.</span><span class="ident" id="7154756">Addr</span><span class="op" id="7154760">(</span><span class="op" id="7154761">)</span><span class="op" id="7154762">.</span><span class="ident" id="7154763">String</span><span class="op" id="7154769">(</span><span class="op" id="7154770">)</span><span class="op" id="7154771">,</span>&nbsp;<span class="op" id="7154773">&amp;</span><span class="ident" id="7154774"><a href="/crypto/tls/tls_test.go.html#7154395">clientConfig</a></span><span class="op" id="7154786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154789">if</span>&nbsp;<span class="ident" id="7154792"><a href="/crypto/tls/tls_test.go.html#7154493">err</a></span>&nbsp;<span class="op" id="7154796">!=</span>&nbsp;<span class="ident" id="7154799">nil</span>&nbsp;<span class="op" id="7154803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154807"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154808">.</span><span class="ident" id="7154809">Fatal</span><span class="op" id="7154814">(</span><span class="ident" id="7154815"><a href="/crypto/tls/tls_test.go.html#7154493">err</a></span><span class="op" id="7154818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154821">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154824">defer</span>&nbsp;<span class="ident" id="7154830"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154834">.</span><span class="ident" id="7154835">Close</span><span class="op" id="7154840">(</span><span class="op" id="7154841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154844">if</span>&nbsp;<span class="op" id="7154847">!</span><span class="ident" id="7154848"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154852">.</span><span class="ident" id="7154853">ConnectionState</span><span class="op" id="7154868">(</span><span class="op" id="7154869">)</span><span class="op" id="7154870">.</span><span class="ident" id="7154871">DidResume</span>&nbsp;<span class="op" id="7154881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7154885"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7154886">.</span><span class="ident" id="7154887">Error</span><span class="op" id="7154892">(</span><span class="string" id="7154893">&#34;second&nbsp;session&nbsp;did&nbsp;not&nbsp;use&nbsp;resumption&#34;</span><span class="op" id="7154932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7154935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7154938">if</span>&nbsp;<span class="op" id="7154941">!</span><span class="ident" id="7154942"><a href="/crypto/tls/tls_test.go.html#7146895">bytes</a></span><span class="op" id="7154947">.</span><span class="ident" id="7154948">Equal</span><span class="op" id="7154953">(</span><span class="ident" id="7154954"><a href="/crypto/tls/tls_test.go.html#7154487">conn</a></span><span class="op" id="7154958">.</span><span class="ident" id="7154959">ConnectionState</span><span class="op" id="7154974">(</span><span class="op" id="7154975">)</span><span class="op" id="7154976">.</span><span class="ident" id="7154977">TLSUnique</span><span class="op" id="7154986">,</span>&nbsp;<span class="op" id="7154988">&lt;-</span><span class="ident" id="7154990"><a href="/crypto/tls/tls_test.go.html#7154046">serverTLSUniques</a></span><span class="op" id="7155006">)</span>&nbsp;<span class="op" id="7155008">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155012"><a href="/crypto/tls/tls_test.go.html#7153983">t</a></span><span class="op" id="7155013">.</span><span class="ident" id="7155014">Error</span><span class="op" id="7155019">(</span><span class="string" id="7155020">&#34;client&nbsp;and&nbsp;server&nbsp;channel&nbsp;bindings&nbsp;differ&nbsp;when&nbsp;session&nbsp;resumption&nbsp;is&nbsp;used&#34;</span><span class="op" id="7155095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155098">}</span><br>
<span class="lineno"></span><span class="op" id="7155100">}</span>
</div>
</body>
</html>
