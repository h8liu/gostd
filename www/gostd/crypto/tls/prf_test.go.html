<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8215028">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8215083">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8215137">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8215188">package</span>&nbsp;<span class="ident" id="8215196">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8215201">import</span>&nbsp;<span class="op" id="8215208">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8215211">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8215227">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="8215237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8215240">type</span>&nbsp;<span class="ident" id="8215245">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="8215274">struct</span>&nbsp;<span class="op" id="8215281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215284">in</span><span class="op" id="8215286">,</span>&nbsp;<span class="ident" id="8215288">out1</span><span class="op" id="8215292">,</span>&nbsp;<span class="ident" id="8215294">out2</span>&nbsp;<span class="builtintype" id="8215299">string</span><br>
<span class="lineno"></span><span class="op" id="8215306">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="8215309">var</span>&nbsp;<span class="ident" id="8215313">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8215343">=</span>&nbsp;<span class="op" id="8215345">[</span><span class="op" id="8215346">]</span><span class="ident" id="8215347">testSplitPreMasterSecretTest</span><span class="op" id="8215375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215378">{</span><span class="string" id="8215379">&#34;&#34;</span><span class="op" id="8215381">,</span>&nbsp;<span class="string" id="8215383">&#34;&#34;</span><span class="op" id="8215385">,</span>&nbsp;<span class="string" id="8215387">&#34;&#34;</span><span class="op" id="8215389">}</span><span class="op" id="8215390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215393">{</span><span class="string" id="8215394">&#34;00&#34;</span><span class="op" id="8215398">,</span>&nbsp;<span class="string" id="8215400">&#34;00&#34;</span><span class="op" id="8215404">,</span>&nbsp;<span class="string" id="8215406">&#34;00&#34;</span><span class="op" id="8215410">}</span><span class="op" id="8215411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215414">{</span><span class="string" id="8215415">&#34;0011&#34;</span><span class="op" id="8215421">,</span>&nbsp;<span class="string" id="8215423">&#34;00&#34;</span><span class="op" id="8215427">,</span>&nbsp;<span class="string" id="8215429">&#34;11&#34;</span><span class="op" id="8215433">}</span><span class="op" id="8215434">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215437">{</span><span class="string" id="8215438">&#34;001122&#34;</span><span class="op" id="8215446">,</span>&nbsp;<span class="string" id="8215448">&#34;0011&#34;</span><span class="op" id="8215454">,</span>&nbsp;<span class="string" id="8215456">&#34;1122&#34;</span><span class="op" id="8215462">}</span><span class="op" id="8215463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215466">{</span><span class="string" id="8215467">&#34;00112233&#34;</span><span class="op" id="8215477">,</span>&nbsp;<span class="string" id="8215479">&#34;0011&#34;</span><span class="op" id="8215485">,</span>&nbsp;<span class="string" id="8215487">&#34;2233&#34;</span><span class="op" id="8215493">}</span><span class="op" id="8215494">,</span><br>
<span class="lineno"></span><span class="op" id="8215496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8215499">func</span>&nbsp;<span class="ident" id="8215504">TestSplitPreMasterSecret</span><span class="op" id="8215528">(</span><span class="ident" id="8215529">t</span>&nbsp;<span class="op" id="8215531">*</span><span class="ident" id="8215532">testing</span><span class="op" id="8215539">.</span><span class="ident" id="8215540">T</span><span class="op" id="8215541">)</span>&nbsp;<span class="op" id="8215543">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8215546">for</span>&nbsp;<span class="ident" id="8215550">i</span><span class="op" id="8215551">,</span>&nbsp;<span class="ident" id="8215553">test</span>&nbsp;<span class="op" id="8215558">:=</span>&nbsp;<span class="keyword" id="8215561">range</span>&nbsp;<span class="ident" id="8215567">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="8215597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215601">in</span><span class="op" id="8215603">,</span>&nbsp;<span class="ident" id="8215605">_</span>&nbsp;<span class="op" id="8215607">:=</span>&nbsp;<span class="ident" id="8215610">hex</span><span class="op" id="8215613">.</span><span class="ident" id="8215614">DecodeString</span><span class="op" id="8215626">(</span><span class="ident" id="8215627">test</span><span class="op" id="8215631">.</span><span class="ident" id="8215632">in</span><span class="op" id="8215634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215638">out1</span><span class="op" id="8215642">,</span>&nbsp;<span class="ident" id="8215644">out2</span>&nbsp;<span class="op" id="8215649">:=</span>&nbsp;<span class="ident" id="8215652">splitPreMasterSecret</span><span class="op" id="8215672">(</span><span class="ident" id="8215673">in</span><span class="op" id="8215675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215679">s1</span>&nbsp;<span class="op" id="8215682">:=</span>&nbsp;<span class="ident" id="8215685">hex</span><span class="op" id="8215688">.</span><span class="ident" id="8215689">EncodeToString</span><span class="op" id="8215703">(</span><span class="ident" id="8215704">out1</span><span class="op" id="8215708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215712">s2</span>&nbsp;<span class="op" id="8215715">:=</span>&nbsp;<span class="ident" id="8215718">hex</span><span class="op" id="8215721">.</span><span class="ident" id="8215722">EncodeToString</span><span class="op" id="8215736">(</span><span class="ident" id="8215737">out2</span><span class="op" id="8215741">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8215745">if</span>&nbsp;<span class="ident" id="8215748">s1</span>&nbsp;<span class="op" id="8215751">!=</span>&nbsp;<span class="ident" id="8215754">test</span><span class="op" id="8215758">.</span><span class="ident" id="8215759">out1</span>&nbsp;<span class="op" id="8215764">||</span>&nbsp;<span class="ident" id="8215767">s2</span>&nbsp;<span class="op" id="8215770">!=</span>&nbsp;<span class="ident" id="8215773">test</span><span class="op" id="8215777">.</span><span class="ident" id="8215778">out2</span>&nbsp;<span class="op" id="8215783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215788">t</span><span class="op" id="8215789">.</span><span class="ident" id="8215790">Errorf</span><span class="op" id="8215796">(</span><span class="string" id="8215797">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="8215832">,</span>&nbsp;<span class="ident" id="8215834">i</span><span class="op" id="8215835">,</span>&nbsp;<span class="ident" id="8215837">s1</span><span class="op" id="8215839">,</span>&nbsp;<span class="ident" id="8215841">s2</span><span class="op" id="8215843">,</span>&nbsp;<span class="ident" id="8215845">test</span><span class="op" id="8215849">.</span><span class="ident" id="8215850">out1</span><span class="op" id="8215854">,</span>&nbsp;<span class="ident" id="8215856">test</span><span class="op" id="8215860">.</span><span class="ident" id="8215861">out2</span><span class="op" id="8215865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8215872">}</span><br>
<span class="lineno"></span><span class="op" id="8215874">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="8215877">type</span>&nbsp;<span class="ident" id="8215882">testKeysFromTest</span>&nbsp;<span class="keyword" id="8215899">struct</span>&nbsp;<span class="op" id="8215906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215909">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8215936">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215944">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8215971">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8215979">clientRandom</span><span class="op" id="8215991">,</span>&nbsp;<span class="ident" id="8215993">serverRandom</span>&nbsp;<span class="builtintype" id="8216006">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216014">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8216041">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216049">clientMAC</span><span class="op" id="8216058">,</span>&nbsp;<span class="ident" id="8216060">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8216076">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216084">clientKey</span><span class="op" id="8216093">,</span>&nbsp;<span class="ident" id="8216095">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8216111">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216119">macLen</span><span class="op" id="8216125">,</span>&nbsp;<span class="ident" id="8216127">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8216146">int</span><br>
<span class="lineno"></span><span class="op" id="8216150">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="8216153">func</span>&nbsp;<span class="ident" id="8216158">TestKeysFromPreMasterSecret</span><span class="op" id="8216185">(</span><span class="ident" id="8216186">t</span>&nbsp;<span class="op" id="8216188">*</span><span class="ident" id="8216189">testing</span><span class="op" id="8216196">.</span><span class="ident" id="8216197">T</span><span class="op" id="8216198">)</span>&nbsp;<span class="op" id="8216200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8216203">for</span>&nbsp;<span class="ident" id="8216207">i</span><span class="op" id="8216208">,</span>&nbsp;<span class="ident" id="8216210">test</span>&nbsp;<span class="op" id="8216215">:=</span>&nbsp;<span class="keyword" id="8216218">range</span>&nbsp;<span class="ident" id="8216224">testKeysFromTests</span>&nbsp;<span class="op" id="8216242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216246">in</span><span class="op" id="8216248">,</span>&nbsp;<span class="ident" id="8216250">_</span>&nbsp;<span class="op" id="8216252">:=</span>&nbsp;<span class="ident" id="8216255">hex</span><span class="op" id="8216258">.</span><span class="ident" id="8216259">DecodeString</span><span class="op" id="8216271">(</span><span class="ident" id="8216272">test</span><span class="op" id="8216276">.</span><span class="ident" id="8216277">preMasterSecret</span><span class="op" id="8216292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216296">clientRandom</span><span class="op" id="8216308">,</span>&nbsp;<span class="ident" id="8216310">_</span>&nbsp;<span class="op" id="8216312">:=</span>&nbsp;<span class="ident" id="8216315">hex</span><span class="op" id="8216318">.</span><span class="ident" id="8216319">DecodeString</span><span class="op" id="8216331">(</span><span class="ident" id="8216332">test</span><span class="op" id="8216336">.</span><span class="ident" id="8216337">clientRandom</span><span class="op" id="8216349">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216353">serverRandom</span><span class="op" id="8216365">,</span>&nbsp;<span class="ident" id="8216367">_</span>&nbsp;<span class="op" id="8216369">:=</span>&nbsp;<span class="ident" id="8216372">hex</span><span class="op" id="8216375">.</span><span class="ident" id="8216376">DecodeString</span><span class="op" id="8216388">(</span><span class="ident" id="8216389">test</span><span class="op" id="8216393">.</span><span class="ident" id="8216394">serverRandom</span><span class="op" id="8216406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216411">masterSecret</span>&nbsp;<span class="op" id="8216424">:=</span>&nbsp;<span class="ident" id="8216427">masterFromPreMasterSecret</span><span class="op" id="8216452">(</span><span class="ident" id="8216453">test</span><span class="op" id="8216457">.</span><span class="ident" id="8216458">version</span><span class="op" id="8216465">,</span>&nbsp;<span class="ident" id="8216467">in</span><span class="op" id="8216469">,</span>&nbsp;<span class="ident" id="8216471">clientRandom</span><span class="op" id="8216483">,</span>&nbsp;<span class="ident" id="8216485">serverRandom</span><span class="op" id="8216497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8216501">if</span>&nbsp;<span class="ident" id="8216504">s</span>&nbsp;<span class="op" id="8216506">:=</span>&nbsp;<span class="ident" id="8216509">hex</span><span class="op" id="8216512">.</span><span class="ident" id="8216513">EncodeToString</span><span class="op" id="8216527">(</span><span class="ident" id="8216528">masterSecret</span><span class="op" id="8216540">)</span><span class="op" id="8216541">;</span>&nbsp;<span class="ident" id="8216543">s</span>&nbsp;<span class="op" id="8216545">!=</span>&nbsp;<span class="ident" id="8216548">test</span><span class="op" id="8216552">.</span><span class="ident" id="8216553">masterSecret</span>&nbsp;<span class="op" id="8216566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216571">t</span><span class="op" id="8216572">.</span><span class="ident" id="8216573">Errorf</span><span class="op" id="8216579">(</span><span class="string" id="8216580">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="8216616">,</span>&nbsp;<span class="ident" id="8216618">i</span><span class="op" id="8216619">,</span>&nbsp;<span class="ident" id="8216621">s</span><span class="op" id="8216622">,</span>&nbsp;<span class="ident" id="8216624">test</span><span class="op" id="8216628">.</span><span class="ident" id="8216629">masterSecret</span><span class="op" id="8216641">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8216646">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8216657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216662">clientMAC</span><span class="op" id="8216671">,</span>&nbsp;<span class="ident" id="8216673">serverMAC</span><span class="op" id="8216682">,</span>&nbsp;<span class="ident" id="8216684">clientKey</span><span class="op" id="8216693">,</span>&nbsp;<span class="ident" id="8216695">serverKey</span><span class="op" id="8216704">,</span>&nbsp;<span class="ident" id="8216706">_</span><span class="op" id="8216707">,</span>&nbsp;<span class="ident" id="8216709">_</span>&nbsp;<span class="op" id="8216711">:=</span>&nbsp;<span class="ident" id="8216714">keysFromMasterSecret</span><span class="op" id="8216734">(</span><span class="ident" id="8216735">test</span><span class="op" id="8216739">.</span><span class="ident" id="8216740">version</span><span class="op" id="8216747">,</span>&nbsp;<span class="ident" id="8216749">masterSecret</span><span class="op" id="8216761">,</span>&nbsp;<span class="ident" id="8216763">clientRandom</span><span class="op" id="8216775">,</span>&nbsp;<span class="ident" id="8216777">serverRandom</span><span class="op" id="8216789">,</span>&nbsp;<span class="ident" id="8216791">test</span><span class="op" id="8216795">.</span><span class="ident" id="8216796">macLen</span><span class="op" id="8216802">,</span>&nbsp;<span class="ident" id="8216804">test</span><span class="op" id="8216808">.</span><span class="ident" id="8216809">keyLen</span><span class="op" id="8216815">,</span>&nbsp;<span class="num" id="8216817">0</span><span class="op" id="8216818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216822">clientMACString</span>&nbsp;<span class="op" id="8216838">:=</span>&nbsp;<span class="ident" id="8216841">hex</span><span class="op" id="8216844">.</span><span class="ident" id="8216845">EncodeToString</span><span class="op" id="8216859">(</span><span class="ident" id="8216860">clientMAC</span><span class="op" id="8216869">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216873">serverMACString</span>&nbsp;<span class="op" id="8216889">:=</span>&nbsp;<span class="ident" id="8216892">hex</span><span class="op" id="8216895">.</span><span class="ident" id="8216896">EncodeToString</span><span class="op" id="8216910">(</span><span class="ident" id="8216911">serverMAC</span><span class="op" id="8216920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216924">clientKeyString</span>&nbsp;<span class="op" id="8216940">:=</span>&nbsp;<span class="ident" id="8216943">hex</span><span class="op" id="8216946">.</span><span class="ident" id="8216947">EncodeToString</span><span class="op" id="8216961">(</span><span class="ident" id="8216962">clientKey</span><span class="op" id="8216971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8216975">serverKeyString</span>&nbsp;<span class="op" id="8216991">:=</span>&nbsp;<span class="ident" id="8216994">hex</span><span class="op" id="8216997">.</span><span class="ident" id="8216998">EncodeToString</span><span class="op" id="8217012">(</span><span class="ident" id="8217013">serverKey</span><span class="op" id="8217022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8217026">if</span>&nbsp;<span class="ident" id="8217029">clientMACString</span>&nbsp;<span class="op" id="8217045">!=</span>&nbsp;<span class="ident" id="8217048">test</span><span class="op" id="8217052">.</span><span class="ident" id="8217053">clientMAC</span>&nbsp;<span class="op" id="8217063">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217069">serverMACString</span>&nbsp;<span class="op" id="8217085">!=</span>&nbsp;<span class="ident" id="8217088">test</span><span class="op" id="8217092">.</span><span class="ident" id="8217093">serverMAC</span>&nbsp;<span class="op" id="8217103">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217109">clientKeyString</span>&nbsp;<span class="op" id="8217125">!=</span>&nbsp;<span class="ident" id="8217128">test</span><span class="op" id="8217132">.</span><span class="ident" id="8217133">clientKey</span>&nbsp;<span class="op" id="8217143">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217149">serverKeyString</span>&nbsp;<span class="op" id="8217165">!=</span>&nbsp;<span class="ident" id="8217168">test</span><span class="op" id="8217172">.</span><span class="ident" id="8217173">serverKey</span>&nbsp;<span class="op" id="8217183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217188">t</span><span class="op" id="8217189">.</span><span class="ident" id="8217190">Errorf</span><span class="op" id="8217196">(</span><span class="string" id="8217197">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="8217248">,</span>&nbsp;<span class="ident" id="8217250">i</span><span class="op" id="8217251">,</span>&nbsp;<span class="ident" id="8217253">clientMACString</span><span class="op" id="8217268">,</span>&nbsp;<span class="ident" id="8217270">serverMACString</span><span class="op" id="8217285">,</span>&nbsp;<span class="ident" id="8217287">clientKeyString</span><span class="op" id="8217302">,</span>&nbsp;<span class="ident" id="8217304">serverKeyString</span><span class="op" id="8217319">,</span>&nbsp;<span class="ident" id="8217321">test</span><span class="op" id="8217325">.</span><span class="ident" id="8217326">clientMAC</span><span class="op" id="8217335">,</span>&nbsp;<span class="ident" id="8217337">test</span><span class="op" id="8217341">.</span><span class="ident" id="8217342">serverMAC</span><span class="op" id="8217351">,</span>&nbsp;<span class="ident" id="8217353">test</span><span class="op" id="8217357">.</span><span class="ident" id="8217358">clientKey</span><span class="op" id="8217367">,</span>&nbsp;<span class="ident" id="8217369">test</span><span class="op" id="8217373">.</span><span class="ident" id="8217374">serverKey</span><span class="op" id="8217383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217390">}</span><br>
<span class="lineno">70</span><span class="op" id="8217392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8217395">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="8217480">var</span>&nbsp;<span class="ident" id="8217484">testKeysFromTests</span>&nbsp;<span class="op" id="8217502">=</span>&nbsp;<span class="op" id="8217504">[</span><span class="op" id="8217505">]</span><span class="ident" id="8217506">testKeysFromTest</span><span class="op" id="8217522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8217525">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8217529">VersionTLS10</span><span class="op" id="8217541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217545">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="8217643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217647">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="8217713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217717">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="8217783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217787">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="8217885">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217889">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="8217931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217935">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="8217977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8217981">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="8218015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218019">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="8218053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8218057">20</span><span class="op" id="8218059">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8218063">16</span><span class="op" id="8218065">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218068">}</span><span class="op" id="8218069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218076">VersionTLS10</span><span class="op" id="8218088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218092">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="8218190">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218194">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="8218260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218264">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="8218330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218334">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="8218432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218436">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="8218478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218482">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="8218524">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218528">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="8218562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218566">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="8218600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8218604">20</span><span class="op" id="8218606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8218610">16</span><span class="op" id="8218612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218615">}</span><span class="op" id="8218616">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8218619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8218623">VersionTLS10</span><span class="op" id="8218635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218639">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8218897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218901">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8218967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8218971">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8219037">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219041">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="8219139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219143">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="8219185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219189">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="8219231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219235">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="8219269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219273">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="8219307">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8219311">20</span><span class="op" id="8219313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8219317">16</span><span class="op" id="8219319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219322">}</span><span class="op" id="8219323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8219326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8219330">VersionSSL30</span><span class="op" id="8219342">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219346">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="8219604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219608">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="8219674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219678">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="8219744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219748">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="8219846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219850">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="8219892">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219896">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="8219938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219942">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="8219976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8219980">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="8220014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8220018">20</span><span class="op" id="8220020">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8220024">16</span><span class="op" id="8220026">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8220029">}</span><span class="op" id="8220030">,</span><br>
<span class="lineno"></span><span class="op" id="8220032">}</span>
</div>
</body>
</html>
