<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html" class="current">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6094820">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6094875">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6094929">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6094980">//&nbsp;Package&nbsp;suffixarray&nbsp;implements&nbsp;substring&nbsp;search&nbsp;in&nbsp;logarithmic&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="6095057">//&nbsp;an&nbsp;in-memory&nbsp;suffix&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="6095087">//</span><br>
<span class="lineno"></span><span class="comment" id="6095090">//&nbsp;Example&nbsp;use:</span><br>
<span class="lineno"></span><span class="comment" id="6095106">//</span><br>
<span class="lineno">10</span><span class="comment" id="6095109">//&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;create&nbsp;index&nbsp;for&nbsp;some&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6095142">//&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;:=&nbsp;suffixarray.New(data)</span><br>
<span class="lineno"></span><span class="comment" id="6095176">//</span><br>
<span class="lineno"></span><span class="comment" id="6095179">//&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;lookup&nbsp;byte&nbsp;slice&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="6095205">//&nbsp;&nbsp;&nbsp;&nbsp;offsets1&nbsp;:=&nbsp;index.Lookup(s,&nbsp;-1)&nbsp;//&nbsp;the&nbsp;list&nbsp;of&nbsp;all&nbsp;indices&nbsp;where&nbsp;s&nbsp;occurs&nbsp;in&nbsp;data</span><br>
<span class="lineno">15</span><span class="comment" id="6095290">//&nbsp;&nbsp;&nbsp;&nbsp;offsets2&nbsp;:=&nbsp;index.Lookup(s,&nbsp;3)&nbsp;&nbsp;//&nbsp;the&nbsp;list&nbsp;of&nbsp;at&nbsp;most&nbsp;3&nbsp;indices&nbsp;where&nbsp;s&nbsp;occurs&nbsp;in&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="6095381">//</span><br>
<span class="lineno"></span><span class="keyword" id="6095384">package</span>&nbsp;<span class="ident" id="6095392">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6095405">import</span>&nbsp;<span class="op" id="6095412">(</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6095415">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6095424">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6095443">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6095449">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6095459">&#34;sort&#34;</span><br>
<span class="lineno">25</span><span class="op" id="6095466">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6095469">//&nbsp;Index&nbsp;implements&nbsp;a&nbsp;suffix&nbsp;array&nbsp;for&nbsp;fast&nbsp;substring&nbsp;search.</span><br>
<span class="lineno"></span><span class="keyword" id="6095531">type</span>&nbsp;<span class="ident" id="6095536">Index</span>&nbsp;<span class="keyword" id="6095542">struct</span>&nbsp;<span class="op" id="6095549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6095552">data</span>&nbsp;<span class="op" id="6095557">[</span><span class="op" id="6095558">]</span><span class="builtintype" id="6095559">byte</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6095565">sa</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6095570">[</span><span class="op" id="6095571">]</span><span class="builtintype" id="6095572">int</span>&nbsp;<span class="comment" id="6095576">//&nbsp;suffix&nbsp;array&nbsp;for&nbsp;data;&nbsp;len(sa)&nbsp;==&nbsp;len(data)</span><br>
<span class="lineno"></span><span class="op" id="6095623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6095626">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;new&nbsp;Index&nbsp;for&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6095663">//&nbsp;Index&nbsp;creation&nbsp;time&nbsp;is&nbsp;O(N*log(N))&nbsp;for&nbsp;N&nbsp;=&nbsp;len(data).</span><br>
<span class="lineno">35</span><span class="keyword" id="6095720">func</span>&nbsp;<span class="ident" id="6095725">New</span><span class="op" id="6095728">(</span><span class="ident" id="6095729">data</span>&nbsp;<span class="op" id="6095734">[</span><span class="op" id="6095735">]</span><span class="builtintype" id="6095736">byte</span><span class="op" id="6095740">)</span>&nbsp;<span class="op" id="6095742">*</span><span class="ident" id="6095743"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span>&nbsp;<span class="op" id="6095749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6095752">return</span>&nbsp;<span class="op" id="6095759">&amp;</span><span class="ident" id="6095760"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6095765">{</span><span class="ident" id="6095766"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095729">data</a></span><span class="op" id="6095770">,</span>&nbsp;<span class="ident" id="6095772"><a href="/gostd/index/suffixarray/qsufsort.go.html#6091268">qsufsort</a></span><span class="op" id="6095780">(</span><span class="ident" id="6095781"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095729">data</a></span><span class="op" id="6095785">)</span><span class="op" id="6095786">}</span><br>
<span class="lineno"></span><span class="op" id="6095788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6095791">//&nbsp;writeInt&nbsp;writes&nbsp;an&nbsp;int&nbsp;x&nbsp;to&nbsp;w&nbsp;using&nbsp;buf&nbsp;to&nbsp;buffer&nbsp;the&nbsp;write.</span><br>
<span class="lineno">40</span><span class="keyword" id="6095855">func</span>&nbsp;<span class="ident" id="6095860">writeInt</span><span class="op" id="6095868">(</span><span class="ident" id="6095869">w</span>&nbsp;<span class="ident" id="6095871"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6095873">.</span><span class="ident" id="6095874"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="6095880">,</span>&nbsp;<span class="ident" id="6095882">buf</span>&nbsp;<span class="op" id="6095886">[</span><span class="op" id="6095887">]</span><span class="builtintype" id="6095888">byte</span><span class="op" id="6095892">,</span>&nbsp;<span class="ident" id="6095894">x</span>&nbsp;<span class="builtintype" id="6095896">int</span><span class="op" id="6095899">)</span>&nbsp;<span class="builtintype" id="6095901">error</span>&nbsp;<span class="op" id="6095907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6095910"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6095916">.</span><span class="ident" id="6095917"><a href="/gostd/encoding/binary/varint.go.html#3003456">PutVarint</a></span><span class="op" id="6095926">(</span><span class="ident" id="6095927"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095882">buf</a></span><span class="op" id="6095930">,</span>&nbsp;<span class="builtintype" id="6095932">int64</span><span class="op" id="6095937">(</span><span class="ident" id="6095938"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095894">x</a></span><span class="op" id="6095939">)</span><span class="op" id="6095940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6095943">_</span><span class="op" id="6095944">,</span>&nbsp;<span class="ident" id="6095946">err</span>&nbsp;<span class="op" id="6095950">:=</span>&nbsp;<span class="ident" id="6095953"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095869">w</a></span><span class="op" id="6095954">.</span><span class="ident" id="6095955"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="6095960">(</span><span class="ident" id="6095961"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095882">buf</a></span><span class="op" id="6095964">[</span><span class="num" id="6095965">0</span><span class="op" id="6095966">:</span><span class="ident" id="6095967"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6095973">.</span><span class="ident" id="6095974"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span><span class="op" id="6095988">]</span><span class="op" id="6095989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6095992">return</span>&nbsp;<span class="ident" id="6095999"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095946">err</a></span><br>
<span class="lineno"></span><span class="op" id="6096003">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6096006">//&nbsp;readInt&nbsp;reads&nbsp;an&nbsp;int&nbsp;x&nbsp;from&nbsp;r&nbsp;using&nbsp;buf&nbsp;to&nbsp;buffer&nbsp;the&nbsp;read&nbsp;and&nbsp;returns&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6096083">func</span>&nbsp;<span class="ident" id="6096088">readInt</span><span class="op" id="6096095">(</span><span class="ident" id="6096096">r</span>&nbsp;<span class="ident" id="6096098"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6096100">.</span><span class="ident" id="6096101"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="6096107">,</span>&nbsp;<span class="ident" id="6096109">buf</span>&nbsp;<span class="op" id="6096113">[</span><span class="op" id="6096114">]</span><span class="builtintype" id="6096115">byte</span><span class="op" id="6096119">)</span>&nbsp;<span class="op" id="6096121">(</span><span class="builtintype" id="6096122">int</span><span class="op" id="6096125">,</span>&nbsp;<span class="builtintype" id="6096127">error</span><span class="op" id="6096132">)</span>&nbsp;<span class="op" id="6096134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096137">_</span><span class="op" id="6096138">,</span>&nbsp;<span class="ident" id="6096140">err</span>&nbsp;<span class="op" id="6096144">:=</span>&nbsp;<span class="ident" id="6096147"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6096149">.</span><span class="ident" id="6096150"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="6096158">(</span><span class="ident" id="6096159"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096096">r</a></span><span class="op" id="6096160">,</span>&nbsp;<span class="ident" id="6096162"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096109">buf</a></span><span class="op" id="6096165">[</span><span class="num" id="6096166">0</span><span class="op" id="6096167">:</span><span class="ident" id="6096168"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096174">.</span><span class="ident" id="6096175"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span><span class="op" id="6096189">]</span><span class="op" id="6096190">)</span>&nbsp;<span class="comment" id="6096192">//&nbsp;ok&nbsp;to&nbsp;continue&nbsp;with&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096222">x</span><span class="op" id="6096223">,</span>&nbsp;<span class="ident" id="6096225">_</span>&nbsp;<span class="op" id="6096227">:=</span>&nbsp;<span class="ident" id="6096230"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096236">.</span><span class="ident" id="6096237"><a href="/gostd/encoding/binary/varint.go.html#3003907">Varint</a></span><span class="op" id="6096243">(</span><span class="ident" id="6096244"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096109">buf</a></span><span class="op" id="6096247">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096250">return</span>&nbsp;<span class="builtintype" id="6096257">int</span><span class="op" id="6096260">(</span><span class="ident" id="6096261"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096222">x</a></span><span class="op" id="6096262">)</span><span class="op" id="6096263">,</span>&nbsp;<span class="ident" id="6096265"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096140">err</a></span><br>
<span class="lineno"></span><span class="op" id="6096269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6096272">//&nbsp;writeSlice&nbsp;writes&nbsp;data[:n]&nbsp;to&nbsp;w&nbsp;and&nbsp;returns&nbsp;n.</span><br>
<span class="lineno"></span><span class="comment" id="6096322">//&nbsp;It&nbsp;uses&nbsp;buf&nbsp;to&nbsp;buffer&nbsp;the&nbsp;write.</span><br>
<span class="lineno">55</span><span class="keyword" id="6096358">func</span>&nbsp;<span class="ident" id="6096363">writeSlice</span><span class="op" id="6096373">(</span><span class="ident" id="6096374">w</span>&nbsp;<span class="ident" id="6096376"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6096378">.</span><span class="ident" id="6096379"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="6096385">,</span>&nbsp;<span class="ident" id="6096387">buf</span>&nbsp;<span class="op" id="6096391">[</span><span class="op" id="6096392">]</span><span class="builtintype" id="6096393">byte</span><span class="op" id="6096397">,</span>&nbsp;<span class="ident" id="6096399">data</span>&nbsp;<span class="op" id="6096404">[</span><span class="op" id="6096405">]</span><span class="builtintype" id="6096406">int</span><span class="op" id="6096409">)</span>&nbsp;<span class="op" id="6096411">(</span><span class="ident" id="6096412">n</span>&nbsp;<span class="builtintype" id="6096414">int</span><span class="op" id="6096417">,</span>&nbsp;<span class="ident" id="6096419">err</span>&nbsp;<span class="builtintype" id="6096423">error</span><span class="op" id="6096428">)</span>&nbsp;<span class="op" id="6096430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6096433">//&nbsp;encode&nbsp;as&nbsp;many&nbsp;elements&nbsp;as&nbsp;fit&nbsp;into&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096477">p</span>&nbsp;<span class="op" id="6096479">:=</span>&nbsp;<span class="ident" id="6096482"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096488">.</span><span class="ident" id="6096489"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096505">for</span>&nbsp;<span class="op" id="6096509">;</span>&nbsp;<span class="ident" id="6096511"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096412">n</a></span>&nbsp;<span class="op" id="6096513">&lt;</span>&nbsp;<span class="builtinfunc" id="6096515">len</span><span class="op" id="6096518">(</span><span class="ident" id="6096519"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096399">data</a></span><span class="op" id="6096523">)</span>&nbsp;<span class="op" id="6096525">&amp;&amp;</span>&nbsp;<span class="ident" id="6096528"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096477">p</a></span><span class="op" id="6096529">+</span><span class="ident" id="6096530"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096536">.</span><span class="ident" id="6096537"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span>&nbsp;<span class="op" id="6096552">&lt;=</span>&nbsp;<span class="builtinfunc" id="6096555">len</span><span class="op" id="6096558">(</span><span class="ident" id="6096559"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096387">buf</a></span><span class="op" id="6096562">)</span><span class="op" id="6096563">;</span>&nbsp;<span class="ident" id="6096565"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096412">n</a></span><span class="op" id="6096566">++</span>&nbsp;<span class="op" id="6096569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096573"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096477">p</a></span>&nbsp;<span class="op" id="6096575">+=</span>&nbsp;<span class="ident" id="6096578"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096584">.</span><span class="ident" id="6096585"><a href="/gostd/encoding/binary/varint.go.html#3002588">PutUvarint</a></span><span class="op" id="6096595">(</span><span class="ident" id="6096596"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096387">buf</a></span><span class="op" id="6096599">[</span><span class="ident" id="6096600"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096477">p</a></span><span class="op" id="6096601">:</span><span class="op" id="6096602">]</span><span class="op" id="6096603">,</span>&nbsp;<span class="builtintype" id="6096605">uint64</span><span class="op" id="6096611">(</span><span class="ident" id="6096612"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096399">data</a></span><span class="op" id="6096616">[</span><span class="ident" id="6096617"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096412">n</a></span><span class="op" id="6096618">]</span><span class="op" id="6096619">)</span><span class="op" id="6096620">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6096623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6096627">//&nbsp;update&nbsp;buffer&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096650"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6096656">.</span><span class="ident" id="6096657"><a href="/gostd/encoding/binary/varint.go.html#3003456">PutVarint</a></span><span class="op" id="6096666">(</span><span class="ident" id="6096667"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096387">buf</a></span><span class="op" id="6096670">,</span>&nbsp;<span class="builtintype" id="6096672">int64</span><span class="op" id="6096677">(</span><span class="ident" id="6096678"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096477">p</a></span><span class="op" id="6096679">)</span><span class="op" id="6096680">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6096684">//&nbsp;write&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096701">_</span><span class="op" id="6096702">,</span>&nbsp;<span class="ident" id="6096704"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096419">err</a></span>&nbsp;<span class="op" id="6096708">=</span>&nbsp;<span class="ident" id="6096710"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096374">w</a></span><span class="op" id="6096711">.</span><span class="ident" id="6096712"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="6096717">(</span><span class="ident" id="6096718"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096387">buf</a></span><span class="op" id="6096721">[</span><span class="num" id="6096722">0</span><span class="op" id="6096723">:</span><span class="ident" id="6096724"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096477">p</a></span><span class="op" id="6096725">]</span><span class="op" id="6096726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096729">return</span><br>
<span class="lineno"></span><span class="op" id="6096736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6096739">//&nbsp;readSlice&nbsp;reads&nbsp;data[:n]&nbsp;from&nbsp;r&nbsp;and&nbsp;returns&nbsp;n.</span><br>
<span class="lineno"></span><span class="comment" id="6096789">//&nbsp;It&nbsp;uses&nbsp;buf&nbsp;to&nbsp;buffer&nbsp;the&nbsp;read.</span><br>
<span class="lineno"></span><span class="keyword" id="6096824">func</span>&nbsp;<span class="ident" id="6096829">readSlice</span><span class="op" id="6096838">(</span><span class="ident" id="6096839">r</span>&nbsp;<span class="ident" id="6096841"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6096843">.</span><span class="ident" id="6096844"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="6096850">,</span>&nbsp;<span class="ident" id="6096852">buf</span>&nbsp;<span class="op" id="6096856">[</span><span class="op" id="6096857">]</span><span class="builtintype" id="6096858">byte</span><span class="op" id="6096862">,</span>&nbsp;<span class="ident" id="6096864">data</span>&nbsp;<span class="op" id="6096869">[</span><span class="op" id="6096870">]</span><span class="builtintype" id="6096871">int</span><span class="op" id="6096874">)</span>&nbsp;<span class="op" id="6096876">(</span><span class="ident" id="6096877">n</span>&nbsp;<span class="builtintype" id="6096879">int</span><span class="op" id="6096882">,</span>&nbsp;<span class="ident" id="6096884">err</span>&nbsp;<span class="builtintype" id="6096888">error</span><span class="op" id="6096893">)</span>&nbsp;<span class="op" id="6096895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6096898">//&nbsp;read&nbsp;buffer&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096919">var</span>&nbsp;<span class="ident" id="6096923">size</span>&nbsp;<span class="builtintype" id="6096928">int</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6096933"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096923">size</a></span><span class="op" id="6096937">,</span>&nbsp;<span class="ident" id="6096939"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096884">err</a></span>&nbsp;<span class="op" id="6096943">=</span>&nbsp;<span class="ident" id="6096945"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096088">readInt</a></span><span class="op" id="6096952">(</span><span class="ident" id="6096953"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096839">r</a></span><span class="op" id="6096954">,</span>&nbsp;<span class="ident" id="6096956"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096852">buf</a></span><span class="op" id="6096959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096962">if</span>&nbsp;<span class="ident" id="6096965"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096884">err</a></span>&nbsp;<span class="op" id="6096969">!=</span>&nbsp;<span class="builtintype" id="6096972">nil</span>&nbsp;<span class="op" id="6096976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6096980">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6096988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6096992">//&nbsp;read&nbsp;buffer&nbsp;w/o&nbsp;the&nbsp;size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097021">if</span>&nbsp;<span class="ident" id="6097024">_</span><span class="op" id="6097025">,</span>&nbsp;<span class="ident" id="6097027"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096884">err</a></span>&nbsp;<span class="op" id="6097031">=</span>&nbsp;<span class="ident" id="6097033"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6097035">.</span><span class="ident" id="6097036"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="6097044">(</span><span class="ident" id="6097045"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096839">r</a></span><span class="op" id="6097046">,</span>&nbsp;<span class="ident" id="6097048"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096852">buf</a></span><span class="op" id="6097051">[</span><span class="ident" id="6097052"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6097058">.</span><span class="ident" id="6097059"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span><span class="op" id="6097073">:</span><span class="ident" id="6097074"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096923">size</a></span><span class="op" id="6097078">]</span><span class="op" id="6097079">)</span><span class="op" id="6097080">;</span>&nbsp;<span class="ident" id="6097082"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096884">err</a></span>&nbsp;<span class="op" id="6097086">!=</span>&nbsp;<span class="builtintype" id="6097089">nil</span>&nbsp;<span class="op" id="6097093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097097">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097109">//&nbsp;decode&nbsp;as&nbsp;many&nbsp;elements&nbsp;as&nbsp;present&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097155">for</span>&nbsp;<span class="ident" id="6097159">p</span>&nbsp;<span class="op" id="6097161">:=</span>&nbsp;<span class="ident" id="6097164"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6097170">.</span><span class="ident" id="6097171"><a href="/gostd/encoding/binary/varint.go.html#3002425">MaxVarintLen64</a></span><span class="op" id="6097185">;</span>&nbsp;<span class="ident" id="6097187"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097159">p</a></span>&nbsp;<span class="op" id="6097189">&lt;</span>&nbsp;<span class="ident" id="6097191"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096923">size</a></span><span class="op" id="6097195">;</span>&nbsp;<span class="ident" id="6097197"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096877">n</a></span><span class="op" id="6097198">++</span>&nbsp;<span class="op" id="6097201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097205">x</span><span class="op" id="6097206">,</span>&nbsp;<span class="ident" id="6097208">w</span>&nbsp;<span class="op" id="6097210">:=</span>&nbsp;<span class="ident" id="6097213"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095424">binary</a></span><span class="op" id="6097219">.</span><span class="ident" id="6097220"><a href="/gostd/encoding/binary/varint.go.html#3003049">Uvarint</a></span><span class="op" id="6097227">(</span><span class="ident" id="6097228"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096852">buf</a></span><span class="op" id="6097231">[</span><span class="ident" id="6097232"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097159">p</a></span><span class="op" id="6097233">:</span><span class="op" id="6097234">]</span><span class="op" id="6097235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097239"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096864">data</a></span><span class="op" id="6097243">[</span><span class="ident" id="6097244"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096877">n</a></span><span class="op" id="6097245">]</span>&nbsp;<span class="op" id="6097247">=</span>&nbsp;<span class="builtintype" id="6097249">int</span><span class="op" id="6097252">(</span><span class="ident" id="6097253"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097205">x</a></span><span class="op" id="6097254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097258"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097159">p</a></span>&nbsp;<span class="op" id="6097260">+=</span>&nbsp;<span class="ident" id="6097263"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097208">w</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097270">return</span><br>
<span class="lineno"></span><span class="op" id="6097277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6097280">const</span>&nbsp;<span class="ident" id="6097286">bufSize</span>&nbsp;<span class="op" id="6097294">=</span>&nbsp;<span class="num" id="6097296">16</span>&nbsp;<span class="op" id="6097299">&lt;&lt;</span>&nbsp;<span class="num" id="6097302">10</span>&nbsp;<span class="comment" id="6097305">//&nbsp;reasonable&nbsp;for&nbsp;BenchmarkSaveRestore</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6097345">//&nbsp;Read&nbsp;reads&nbsp;the&nbsp;index&nbsp;from&nbsp;r&nbsp;into&nbsp;x;&nbsp;x&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="6097403">func</span>&nbsp;<span class="op" id="6097408">(</span><span class="ident" id="6097409">x</span>&nbsp;<span class="op" id="6097411">*</span><span class="ident" id="6097412"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6097417">)</span>&nbsp;<span class="ident" id="6097419">Read</span><span class="op" id="6097423">(</span><span class="ident" id="6097424">r</span>&nbsp;<span class="ident" id="6097426"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6097428">.</span><span class="ident" id="6097429"><a href="/gostd/io/io.go.html#1421823">Reader</a></span><span class="op" id="6097435">)</span>&nbsp;<span class="builtintype" id="6097437">error</span>&nbsp;<span class="op" id="6097443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097446">//&nbsp;buffer&nbsp;for&nbsp;all&nbsp;reads</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097471">buf</span>&nbsp;<span class="op" id="6097475">:=</span>&nbsp;<span class="builtinfunc" id="6097478">make</span><span class="op" id="6097482">(</span><span class="op" id="6097483">[</span><span class="op" id="6097484">]</span><span class="builtintype" id="6097485">byte</span><span class="op" id="6097489">,</span>&nbsp;<span class="ident" id="6097491"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097286">bufSize</a></span><span class="op" id="6097498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097502">//&nbsp;read&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097518">n</span><span class="op" id="6097519">,</span>&nbsp;<span class="ident" id="6097521">err</span>&nbsp;<span class="op" id="6097525">:=</span>&nbsp;<span class="ident" id="6097528"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096088">readInt</a></span><span class="op" id="6097535">(</span><span class="ident" id="6097536"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097424">r</a></span><span class="op" id="6097537">,</span>&nbsp;<span class="ident" id="6097539"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097471">buf</a></span><span class="op" id="6097542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097545">if</span>&nbsp;<span class="ident" id="6097548"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097521">err</a></span>&nbsp;<span class="op" id="6097552">!=</span>&nbsp;<span class="builtintype" id="6097555">nil</span>&nbsp;<span class="op" id="6097559">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097563">return</span>&nbsp;<span class="ident" id="6097570"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097521">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097579">//&nbsp;allocate&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097598">if</span>&nbsp;<span class="num" id="6097601">2</span><span class="op" id="6097602">*</span><span class="ident" id="6097603"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span>&nbsp;<span class="op" id="6097605">&lt;</span>&nbsp;<span class="builtinfunc" id="6097607">cap</span><span class="op" id="6097610">(</span><span class="ident" id="6097611"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097612">.</span><span class="ident" id="6097613"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6097617">)</span>&nbsp;<span class="op" id="6097619">||</span>&nbsp;<span class="builtinfunc" id="6097622">cap</span><span class="op" id="6097625">(</span><span class="ident" id="6097626"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097627">.</span><span class="ident" id="6097628"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6097632">)</span>&nbsp;<span class="op" id="6097634">&lt;</span>&nbsp;<span class="ident" id="6097636"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span>&nbsp;<span class="op" id="6097638">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097642">//&nbsp;new&nbsp;data&nbsp;is&nbsp;significantly&nbsp;smaller&nbsp;or&nbsp;larger&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097696">//&nbsp;existing&nbsp;buffers&nbsp;-&nbsp;allocate&nbsp;new&nbsp;ones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097738"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097739">.</span><span class="ident" id="6097740"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span>&nbsp;<span class="op" id="6097745">=</span>&nbsp;<span class="builtinfunc" id="6097747">make</span><span class="op" id="6097751">(</span><span class="op" id="6097752">[</span><span class="op" id="6097753">]</span><span class="builtintype" id="6097754">byte</span><span class="op" id="6097758">,</span>&nbsp;<span class="ident" id="6097760"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span><span class="op" id="6097761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097765"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097766">.</span><span class="ident" id="6097767"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span>&nbsp;<span class="op" id="6097770">=</span>&nbsp;<span class="builtinfunc" id="6097772">make</span><span class="op" id="6097776">(</span><span class="op" id="6097777">[</span><span class="op" id="6097778">]</span><span class="builtintype" id="6097779">int</span><span class="op" id="6097782">,</span>&nbsp;<span class="ident" id="6097784"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span><span class="op" id="6097785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097788">}</span>&nbsp;<span class="keyword" id="6097790">else</span>&nbsp;<span class="op" id="6097795">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097799">//&nbsp;re-use&nbsp;existing&nbsp;buffers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097828"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097829">.</span><span class="ident" id="6097830"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span>&nbsp;<span class="op" id="6097835">=</span>&nbsp;<span class="ident" id="6097837"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097838">.</span><span class="ident" id="6097839"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6097843">[</span><span class="num" id="6097844">0</span><span class="op" id="6097845">:</span><span class="ident" id="6097846"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span><span class="op" id="6097847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6097851"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097852">.</span><span class="ident" id="6097853"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span>&nbsp;<span class="op" id="6097856">=</span>&nbsp;<span class="ident" id="6097858"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097859">.</span><span class="ident" id="6097860"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6097862">[</span><span class="num" id="6097863">0</span><span class="op" id="6097864">:</span><span class="ident" id="6097865"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097518">n</a></span><span class="op" id="6097866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097873">//&nbsp;read&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097887">if</span>&nbsp;<span class="ident" id="6097890">_</span><span class="op" id="6097891">,</span>&nbsp;<span class="ident" id="6097893">err</span>&nbsp;<span class="op" id="6097897">:=</span>&nbsp;<span class="ident" id="6097900"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6097902">.</span><span class="ident" id="6097903"><a href="/gostd/io/io.go.html#1429706">ReadFull</a></span><span class="op" id="6097911">(</span><span class="ident" id="6097912"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097424">r</a></span><span class="op" id="6097913">,</span>&nbsp;<span class="ident" id="6097915"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097916">.</span><span class="ident" id="6097917"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6097921">)</span><span class="op" id="6097922">;</span>&nbsp;<span class="ident" id="6097924"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097893">err</a></span>&nbsp;<span class="op" id="6097928">!=</span>&nbsp;<span class="builtintype" id="6097931">nil</span>&nbsp;<span class="op" id="6097935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097939">return</span>&nbsp;<span class="ident" id="6097946"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097893">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6097951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6097955">//&nbsp;read&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6097970">for</span>&nbsp;<span class="ident" id="6097974">sa</span>&nbsp;<span class="op" id="6097977">:=</span>&nbsp;<span class="ident" id="6097980"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097409">x</a></span><span class="op" id="6097981">.</span><span class="ident" id="6097982"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6097984">;</span>&nbsp;<span class="builtinfunc" id="6097986">len</span><span class="op" id="6097989">(</span><span class="ident" id="6097990"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097974">sa</a></span><span class="op" id="6097992">)</span>&nbsp;<span class="op" id="6097994">&gt;</span>&nbsp;<span class="num" id="6097996">0</span><span class="op" id="6097997">;</span>&nbsp;<span class="op" id="6097999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6098003">n</span><span class="op" id="6098004">,</span>&nbsp;<span class="ident" id="6098006">err</span>&nbsp;<span class="op" id="6098010">:=</span>&nbsp;<span class="ident" id="6098013"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096829">readSlice</a></span><span class="op" id="6098022">(</span><span class="ident" id="6098023"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097424">r</a></span><span class="op" id="6098024">,</span>&nbsp;<span class="ident" id="6098026"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097471">buf</a></span><span class="op" id="6098029">,</span>&nbsp;<span class="ident" id="6098031"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097974">sa</a></span><span class="op" id="6098033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098037">if</span>&nbsp;<span class="ident" id="6098040"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098006">err</a></span>&nbsp;<span class="op" id="6098044">!=</span>&nbsp;<span class="builtintype" id="6098047">nil</span>&nbsp;<span class="op" id="6098051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098056">return</span>&nbsp;<span class="ident" id="6098063"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098006">err</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6098073"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097974">sa</a></span>&nbsp;<span class="op" id="6098076">=</span>&nbsp;<span class="ident" id="6098078"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097974">sa</a></span><span class="op" id="6098080">[</span><span class="ident" id="6098081"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098003">n</a></span><span class="op" id="6098082">:</span><span class="op" id="6098083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098089">return</span>&nbsp;<span class="builtintype" id="6098096">nil</span><br>
<span class="lineno"></span><span class="op" id="6098100">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="6098103">//&nbsp;Write&nbsp;writes&nbsp;the&nbsp;index&nbsp;x&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="6098137">func</span>&nbsp;<span class="op" id="6098142">(</span><span class="ident" id="6098143">x</span>&nbsp;<span class="op" id="6098145">*</span><span class="ident" id="6098146"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6098151">)</span>&nbsp;<span class="ident" id="6098153">Write</span><span class="op" id="6098158">(</span><span class="ident" id="6098159">w</span>&nbsp;<span class="ident" id="6098161"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095443">io</a></span><span class="op" id="6098163">.</span><span class="ident" id="6098164"><a href="/gostd/io/io.go.html#1422314">Writer</a></span><span class="op" id="6098170">)</span>&nbsp;<span class="builtintype" id="6098172">error</span>&nbsp;<span class="op" id="6098178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098181">//&nbsp;buffer&nbsp;for&nbsp;all&nbsp;writes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6098207">buf</span>&nbsp;<span class="op" id="6098211">:=</span>&nbsp;<span class="builtinfunc" id="6098214">make</span><span class="op" id="6098218">(</span><span class="op" id="6098219">[</span><span class="op" id="6098220">]</span><span class="builtintype" id="6098221">byte</span><span class="op" id="6098225">,</span>&nbsp;<span class="ident" id="6098227"><a href="/gostd/index/suffixarray/suffixarray.go.html#6097286">bufSize</a></span><span class="op" id="6098234">)</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098238">//&nbsp;write&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098255">if</span>&nbsp;<span class="ident" id="6098258">err</span>&nbsp;<span class="op" id="6098262">:=</span>&nbsp;<span class="ident" id="6098265"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095860">writeInt</a></span><span class="op" id="6098273">(</span><span class="ident" id="6098274"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098159">w</a></span><span class="op" id="6098275">,</span>&nbsp;<span class="ident" id="6098277"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098207">buf</a></span><span class="op" id="6098280">,</span>&nbsp;<span class="builtinfunc" id="6098282">len</span><span class="op" id="6098285">(</span><span class="ident" id="6098286"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098143">x</a></span><span class="op" id="6098287">.</span><span class="ident" id="6098288"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6098292">)</span><span class="op" id="6098293">)</span><span class="op" id="6098294">;</span>&nbsp;<span class="ident" id="6098296"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098258">err</a></span>&nbsp;<span class="op" id="6098300">!=</span>&nbsp;<span class="builtintype" id="6098303">nil</span>&nbsp;<span class="op" id="6098307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098311">return</span>&nbsp;<span class="ident" id="6098318"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098258">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098323">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098327">//&nbsp;write&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098342">if</span>&nbsp;<span class="ident" id="6098345">_</span><span class="op" id="6098346">,</span>&nbsp;<span class="ident" id="6098348">err</span>&nbsp;<span class="op" id="6098352">:=</span>&nbsp;<span class="ident" id="6098355"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098159">w</a></span><span class="op" id="6098356">.</span><span class="ident" id="6098357"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="6098362">(</span><span class="ident" id="6098363"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098143">x</a></span><span class="op" id="6098364">.</span><span class="ident" id="6098365"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6098369">)</span><span class="op" id="6098370">;</span>&nbsp;<span class="ident" id="6098372"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098348">err</a></span>&nbsp;<span class="op" id="6098376">!=</span>&nbsp;<span class="builtintype" id="6098379">nil</span>&nbsp;<span class="op" id="6098383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098387">return</span>&nbsp;<span class="ident" id="6098394"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098348">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098399">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098403">//&nbsp;write&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098419">for</span>&nbsp;<span class="ident" id="6098423">sa</span>&nbsp;<span class="op" id="6098426">:=</span>&nbsp;<span class="ident" id="6098429"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098143">x</a></span><span class="op" id="6098430">.</span><span class="ident" id="6098431"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6098433">;</span>&nbsp;<span class="builtinfunc" id="6098435">len</span><span class="op" id="6098438">(</span><span class="ident" id="6098439"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098423">sa</a></span><span class="op" id="6098441">)</span>&nbsp;<span class="op" id="6098443">&gt;</span>&nbsp;<span class="num" id="6098445">0</span><span class="op" id="6098446">;</span>&nbsp;<span class="op" id="6098448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6098452">n</span><span class="op" id="6098453">,</span>&nbsp;<span class="ident" id="6098455">err</span>&nbsp;<span class="op" id="6098459">:=</span>&nbsp;<span class="ident" id="6098462"><a href="/gostd/index/suffixarray/suffixarray.go.html#6096363">writeSlice</a></span><span class="op" id="6098472">(</span><span class="ident" id="6098473"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098159">w</a></span><span class="op" id="6098474">,</span>&nbsp;<span class="ident" id="6098476"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098207">buf</a></span><span class="op" id="6098479">,</span>&nbsp;<span class="ident" id="6098481"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098423">sa</a></span><span class="op" id="6098483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098487">if</span>&nbsp;<span class="ident" id="6098490"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098455">err</a></span>&nbsp;<span class="op" id="6098494">!=</span>&nbsp;<span class="builtintype" id="6098497">nil</span>&nbsp;<span class="op" id="6098501">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098506">return</span>&nbsp;<span class="ident" id="6098513"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098455">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6098523"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098423">sa</a></span>&nbsp;<span class="op" id="6098526">=</span>&nbsp;<span class="ident" id="6098528"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098423">sa</a></span><span class="op" id="6098530">[</span><span class="ident" id="6098531"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098452">n</a></span><span class="op" id="6098532">:</span><span class="op" id="6098533">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6098536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098539">return</span>&nbsp;<span class="builtintype" id="6098546">nil</span><br>
<span class="lineno">160</span><span class="op" id="6098550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6098553">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;data&nbsp;over&nbsp;which&nbsp;the&nbsp;index&nbsp;was&nbsp;created.</span><br>
<span class="lineno"></span><span class="comment" id="6098613">//&nbsp;It&nbsp;must&nbsp;not&nbsp;be&nbsp;modified.</span><br>
<span class="lineno"></span><span class="comment" id="6098641">//</span><br>
<span class="lineno">165</span><span class="keyword" id="6098644">func</span>&nbsp;<span class="op" id="6098649">(</span><span class="ident" id="6098650">x</span>&nbsp;<span class="op" id="6098652">*</span><span class="ident" id="6098653"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6098658">)</span>&nbsp;<span class="ident" id="6098660">Bytes</span><span class="op" id="6098665">(</span><span class="op" id="6098666">)</span>&nbsp;<span class="op" id="6098668">[</span><span class="op" id="6098669">]</span><span class="builtintype" id="6098670">byte</span>&nbsp;<span class="op" id="6098675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098678">return</span>&nbsp;<span class="ident" id="6098685"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098650">x</a></span><span class="op" id="6098686">.</span><span class="ident" id="6098687"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><br>
<span class="lineno"></span><span class="op" id="6098692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6098695">func</span>&nbsp;<span class="op" id="6098700">(</span><span class="ident" id="6098701">x</span>&nbsp;<span class="op" id="6098703">*</span><span class="ident" id="6098704"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6098709">)</span>&nbsp;<span class="ident" id="6098711">at</span><span class="op" id="6098713">(</span><span class="ident" id="6098714">i</span>&nbsp;<span class="builtintype" id="6098716">int</span><span class="op" id="6098719">)</span>&nbsp;<span class="op" id="6098721">[</span><span class="op" id="6098722">]</span><span class="builtintype" id="6098723">byte</span>&nbsp;<span class="op" id="6098728">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6098731">return</span>&nbsp;<span class="ident" id="6098738"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098701">x</a></span><span class="op" id="6098739">.</span><span class="ident" id="6098740"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6098744">[</span><span class="ident" id="6098745"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098701">x</a></span><span class="op" id="6098746">.</span><span class="ident" id="6098747"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6098749">[</span><span class="ident" id="6098750"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098714">i</a></span><span class="op" id="6098751">]</span><span class="op" id="6098752">:</span><span class="op" id="6098753">]</span><br>
<span class="lineno"></span><span class="op" id="6098755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6098758">//&nbsp;lookupAll&nbsp;returns&nbsp;a&nbsp;slice&nbsp;into&nbsp;the&nbsp;matching&nbsp;region&nbsp;of&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span><span class="comment" id="6098826">//&nbsp;The&nbsp;runtime&nbsp;is&nbsp;O(log(N)*len(s)).</span><br>
<span class="lineno">175</span><span class="keyword" id="6098862">func</span>&nbsp;<span class="op" id="6098867">(</span><span class="ident" id="6098868">x</span>&nbsp;<span class="op" id="6098870">*</span><span class="ident" id="6098871"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6098876">)</span>&nbsp;<span class="ident" id="6098878">lookupAll</span><span class="op" id="6098887">(</span><span class="ident" id="6098888">s</span>&nbsp;<span class="op" id="6098890">[</span><span class="op" id="6098891">]</span><span class="builtintype" id="6098892">byte</span><span class="op" id="6098896">)</span>&nbsp;<span class="op" id="6098898">[</span><span class="op" id="6098899">]</span><span class="builtintype" id="6098900">int</span>&nbsp;<span class="op" id="6098904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098907">//&nbsp;find&nbsp;matching&nbsp;suffix&nbsp;index&nbsp;range&nbsp;[i:j]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6098950">//&nbsp;find&nbsp;the&nbsp;first&nbsp;index&nbsp;where&nbsp;s&nbsp;would&nbsp;be&nbsp;the&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6099003">i</span>&nbsp;<span class="op" id="6099005">:=</span>&nbsp;<span class="ident" id="6099008"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095459">sort</a></span><span class="op" id="6099012">.</span><span class="ident" id="6099013"><a href="/gostd/sort/search.go.html#2008959">Search</a></span><span class="op" id="6099019">(</span><span class="builtinfunc" id="6099020">len</span><span class="op" id="6099023">(</span><span class="ident" id="6099024"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098868">x</a></span><span class="op" id="6099025">.</span><span class="ident" id="6099026"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6099028">)</span><span class="op" id="6099029">,</span>&nbsp;<span class="keyword" id="6099031">func</span><span class="op" id="6099035">(</span><span class="ident" id="6099036">i</span>&nbsp;<span class="builtintype" id="6099038">int</span><span class="op" id="6099041">)</span>&nbsp;<span class="builtintype" id="6099043">bool</span>&nbsp;<span class="op" id="6099048">{</span>&nbsp;<span class="keyword" id="6099050">return</span>&nbsp;<span class="ident" id="6099057"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095415">bytes</a></span><span class="op" id="6099062">.</span><span class="ident" id="6099063"><a href="/gostd/bytes/bytes_decl.go.html#1415068">Compare</a></span><span class="op" id="6099070">(</span><span class="ident" id="6099071"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098868">x</a></span><span class="op" id="6099072">.</span><span class="ident" id="6099073"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098711">at</a></span><span class="op" id="6099075">(</span><span class="ident" id="6099076"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099036">i</a></span><span class="op" id="6099077">)</span><span class="op" id="6099078">,</span>&nbsp;<span class="ident" id="6099080"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098888">s</a></span><span class="op" id="6099081">)</span>&nbsp;<span class="op" id="6099083">&gt;=</span>&nbsp;<span class="num" id="6099086">0</span>&nbsp;<span class="op" id="6099088">}</span><span class="op" id="6099089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6099092">//&nbsp;starting&nbsp;at&nbsp;i,&nbsp;find&nbsp;the&nbsp;first&nbsp;index&nbsp;at&nbsp;which&nbsp;s&nbsp;is&nbsp;not&nbsp;a&nbsp;prefix</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6099159">j</span>&nbsp;<span class="op" id="6099161">:=</span>&nbsp;<span class="ident" id="6099164"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099003">i</a></span>&nbsp;<span class="op" id="6099166">+</span>&nbsp;<span class="ident" id="6099168"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095459">sort</a></span><span class="op" id="6099172">.</span><span class="ident" id="6099173"><a href="/gostd/sort/search.go.html#2008959">Search</a></span><span class="op" id="6099179">(</span><span class="builtinfunc" id="6099180">len</span><span class="op" id="6099183">(</span><span class="ident" id="6099184"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098868">x</a></span><span class="op" id="6099185">.</span><span class="ident" id="6099186"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6099188">)</span><span class="op" id="6099189">-</span><span class="ident" id="6099190"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099003">i</a></span><span class="op" id="6099191">,</span>&nbsp;<span class="keyword" id="6099193">func</span><span class="op" id="6099197">(</span><span class="ident" id="6099198">j</span>&nbsp;<span class="builtintype" id="6099200">int</span><span class="op" id="6099203">)</span>&nbsp;<span class="builtintype" id="6099205">bool</span>&nbsp;<span class="op" id="6099210">{</span>&nbsp;<span class="keyword" id="6099212">return</span>&nbsp;<span class="op" id="6099219">!</span><span class="ident" id="6099220"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095415">bytes</a></span><span class="op" id="6099225">.</span><span class="ident" id="6099226"><a href="/gostd/bytes/bytes.go.html#1403977">HasPrefix</a></span><span class="op" id="6099235">(</span><span class="ident" id="6099236"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098868">x</a></span><span class="op" id="6099237">.</span><span class="ident" id="6099238"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098711">at</a></span><span class="op" id="6099240">(</span><span class="ident" id="6099241"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099198">j</a></span><span class="op" id="6099242">+</span><span class="ident" id="6099243"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099003">i</a></span><span class="op" id="6099244">)</span><span class="op" id="6099245">,</span>&nbsp;<span class="ident" id="6099247"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098888">s</a></span><span class="op" id="6099248">)</span>&nbsp;<span class="op" id="6099250">}</span><span class="op" id="6099251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6099254">return</span>&nbsp;<span class="ident" id="6099261"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098868">x</a></span><span class="op" id="6099262">.</span><span class="ident" id="6099263"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095565">sa</a></span><span class="op" id="6099265">[</span><span class="ident" id="6099266"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099003">i</a></span><span class="op" id="6099267">:</span><span class="ident" id="6099268"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099159">j</a></span><span class="op" id="6099269">]</span><br>
<span class="lineno"></span><span class="op" id="6099271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6099274">//&nbsp;Lookup&nbsp;returns&nbsp;an&nbsp;unsorted&nbsp;list&nbsp;of&nbsp;at&nbsp;most&nbsp;n&nbsp;indices&nbsp;where&nbsp;the&nbsp;byte&nbsp;string&nbsp;s</span><br>
<span class="lineno">185</span><span class="comment" id="6099354">//&nbsp;occurs&nbsp;in&nbsp;the&nbsp;indexed&nbsp;data.&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;all&nbsp;occurrences&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span><span class="comment" id="6099425">//&nbsp;The&nbsp;result&nbsp;is&nbsp;nil&nbsp;if&nbsp;s&nbsp;is&nbsp;empty,&nbsp;s&nbsp;is&nbsp;not&nbsp;found,&nbsp;or&nbsp;n&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6099488">//&nbsp;Lookup&nbsp;time&nbsp;is&nbsp;O(log(N)*len(s)&nbsp;+&nbsp;len(result))&nbsp;where&nbsp;N&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6099552">//&nbsp;size&nbsp;of&nbsp;the&nbsp;indexed&nbsp;data.</span><br>
<span class="lineno"></span><span class="comment" id="6099581">//</span><br>
<span class="lineno">190</span><span class="keyword" id="6099584">func</span>&nbsp;<span class="op" id="6099589">(</span><span class="ident" id="6099590">x</span>&nbsp;<span class="op" id="6099592">*</span><span class="ident" id="6099593"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6099598">)</span>&nbsp;<span class="ident" id="6099600">Lookup</span><span class="op" id="6099606">(</span><span class="ident" id="6099607">s</span>&nbsp;<span class="op" id="6099609">[</span><span class="op" id="6099610">]</span><span class="builtintype" id="6099611">byte</span><span class="op" id="6099615">,</span>&nbsp;<span class="ident" id="6099617">n</span>&nbsp;<span class="builtintype" id="6099619">int</span><span class="op" id="6099622">)</span>&nbsp;<span class="op" id="6099624">(</span><span class="ident" id="6099625">result</span>&nbsp;<span class="op" id="6099632">[</span><span class="op" id="6099633">]</span><span class="builtintype" id="6099634">int</span><span class="op" id="6099637">)</span>&nbsp;<span class="op" id="6099639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6099642">if</span>&nbsp;<span class="builtinfunc" id="6099645">len</span><span class="op" id="6099648">(</span><span class="ident" id="6099649"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099607">s</a></span><span class="op" id="6099650">)</span>&nbsp;<span class="op" id="6099652">&gt;</span>&nbsp;<span class="num" id="6099654">0</span>&nbsp;<span class="op" id="6099656">&amp;&amp;</span>&nbsp;<span class="ident" id="6099659"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span>&nbsp;<span class="op" id="6099661">!=</span>&nbsp;<span class="num" id="6099664">0</span>&nbsp;<span class="op" id="6099666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6099670">matches</span>&nbsp;<span class="op" id="6099678">:=</span>&nbsp;<span class="ident" id="6099681"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099590">x</a></span><span class="op" id="6099682">.</span><span class="ident" id="6099683"><a href="/gostd/index/suffixarray/suffixarray.go.html#6098878">lookupAll</a></span><span class="op" id="6099692">(</span><span class="ident" id="6099693"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099607">s</a></span><span class="op" id="6099694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6099698">if</span>&nbsp;<span class="ident" id="6099701"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span>&nbsp;<span class="op" id="6099703">&lt;</span>&nbsp;<span class="num" id="6099705">0</span>&nbsp;<span class="op" id="6099707">||</span>&nbsp;<span class="builtinfunc" id="6099710">len</span><span class="op" id="6099713">(</span><span class="ident" id="6099714"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099670">matches</a></span><span class="op" id="6099721">)</span>&nbsp;<span class="op" id="6099723">&lt;</span>&nbsp;<span class="ident" id="6099725"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span>&nbsp;<span class="op" id="6099727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6099732"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span>&nbsp;<span class="op" id="6099734">=</span>&nbsp;<span class="builtinfunc" id="6099736">len</span><span class="op" id="6099739">(</span><span class="ident" id="6099740"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099670">matches</a></span><span class="op" id="6099747">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6099751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6099755">//&nbsp;0&nbsp;&lt;=&nbsp;n&nbsp;&lt;=&nbsp;len(matches)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6099783">if</span>&nbsp;<span class="ident" id="6099786"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span>&nbsp;<span class="op" id="6099788">&gt;</span>&nbsp;<span class="num" id="6099790">0</span>&nbsp;<span class="op" id="6099792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6099797"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099625">result</a></span>&nbsp;<span class="op" id="6099804">=</span>&nbsp;<span class="builtinfunc" id="6099806">make</span><span class="op" id="6099810">(</span><span class="op" id="6099811">[</span><span class="op" id="6099812">]</span><span class="builtintype" id="6099813">int</span><span class="op" id="6099816">,</span>&nbsp;<span class="ident" id="6099818"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099617">n</a></span><span class="op" id="6099819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6099824">copy</span><span class="op" id="6099828">(</span><span class="ident" id="6099829"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099625">result</a></span><span class="op" id="6099835">,</span>&nbsp;<span class="ident" id="6099837"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099670">matches</a></span><span class="op" id="6099844">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6099848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6099851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6099854">return</span><br>
<span class="lineno"></span><span class="op" id="6099861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="6099864">//&nbsp;FindAllIndex&nbsp;returns&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;non-overlapping&nbsp;matches&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6099936">//&nbsp;regular&nbsp;expression&nbsp;r,&nbsp;where&nbsp;a&nbsp;match&nbsp;is&nbsp;a&nbsp;pair&nbsp;of&nbsp;indices&nbsp;specifying</span><br>
<span class="lineno"></span><span class="comment" id="6100007">//&nbsp;the&nbsp;matched&nbsp;slice&nbsp;of&nbsp;x.Bytes().&nbsp;If&nbsp;n&nbsp;&lt;&nbsp;0,&nbsp;all&nbsp;matches&nbsp;are&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="6100077">//&nbsp;in&nbsp;successive&nbsp;order.&nbsp;Otherwise,&nbsp;at&nbsp;most&nbsp;n&nbsp;matches&nbsp;are&nbsp;returned&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6100147">//&nbsp;they&nbsp;may&nbsp;not&nbsp;be&nbsp;successive.&nbsp;The&nbsp;result&nbsp;is&nbsp;nil&nbsp;if&nbsp;there&nbsp;are&nbsp;no&nbsp;matches,</span><br>
<span class="lineno">210</span><span class="comment" id="6100221">//&nbsp;or&nbsp;if&nbsp;n&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="6100238">//</span><br>
<span class="lineno"></span><span class="keyword" id="6100241">func</span>&nbsp;<span class="op" id="6100246">(</span><span class="ident" id="6100247">x</span>&nbsp;<span class="op" id="6100249">*</span><span class="ident" id="6100250"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095536">Index</a></span><span class="op" id="6100255">)</span>&nbsp;<span class="ident" id="6100257">FindAllIndex</span><span class="op" id="6100269">(</span><span class="ident" id="6100270">r</span>&nbsp;<span class="op" id="6100272">*</span><span class="ident" id="6100273"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095449">regexp</a></span><span class="op" id="6100279">.</span><span class="ident" id="6100280"><a href="/gostd/regexp/regexp.go.html#3567022">Regexp</a></span><span class="op" id="6100286">,</span>&nbsp;<span class="ident" id="6100288">n</span>&nbsp;<span class="builtintype" id="6100290">int</span><span class="op" id="6100293">)</span>&nbsp;<span class="op" id="6100295">(</span><span class="ident" id="6100296">result</span>&nbsp;<span class="op" id="6100303">[</span><span class="op" id="6100304">]</span><span class="op" id="6100305">[</span><span class="op" id="6100306">]</span><span class="builtintype" id="6100307">int</span><span class="op" id="6100310">)</span>&nbsp;<span class="op" id="6100312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100315">//&nbsp;a&nbsp;non-empty&nbsp;literal&nbsp;prefix&nbsp;is&nbsp;used&nbsp;to&nbsp;determine&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100376">//&nbsp;match&nbsp;start&nbsp;indices&nbsp;with&nbsp;Lookup</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6100412">prefix</span><span class="op" id="6100418">,</span>&nbsp;<span class="ident" id="6100420">complete</span>&nbsp;<span class="op" id="6100429">:=</span>&nbsp;<span class="ident" id="6100432"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100270">r</a></span><span class="op" id="6100433">.</span><span class="ident" id="6100434"><a href="/gostd/regexp/regexp.go.html#3575954">LiteralPrefix</a></span><span class="op" id="6100447">(</span><span class="op" id="6100448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6100451">lit</span>&nbsp;<span class="op" id="6100455">:=</span>&nbsp;<span class="op" id="6100458">[</span><span class="op" id="6100459">]</span><span class="builtintype" id="6100460">byte</span><span class="op" id="6100464">(</span><span class="ident" id="6100465"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100412">prefix</a></span><span class="op" id="6100471">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100475">//&nbsp;worst-case&nbsp;scenario:&nbsp;no&nbsp;literal&nbsp;prefix</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6100518">if</span>&nbsp;<span class="ident" id="6100521"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100412">prefix</a></span>&nbsp;<span class="op" id="6100528">==</span>&nbsp;<span class="string" id="6100531">&#34;&#34;</span>&nbsp;<span class="op" id="6100534">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6100538">return</span>&nbsp;<span class="ident" id="6100545"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100270">r</a></span><span class="op" id="6100546">.</span><span class="ident" id="6100547"><a href="/gostd/regexp/regexp.go.html#3592878">FindAllIndex</a></span><span class="op" id="6100559">(</span><span class="ident" id="6100560"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100247">x</a></span><span class="op" id="6100561">.</span><span class="ident" id="6100562"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6100566">,</span>&nbsp;<span class="ident" id="6100568"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span><span class="op" id="6100569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6100572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100576">//&nbsp;if&nbsp;regexp&nbsp;is&nbsp;a&nbsp;literal&nbsp;just&nbsp;use&nbsp;Lookup&nbsp;and&nbsp;convert&nbsp;its</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100635">//&nbsp;result&nbsp;into&nbsp;match&nbsp;pairs</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6100663">if</span>&nbsp;<span class="ident" id="6100666"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100420">complete</a></span>&nbsp;<span class="op" id="6100675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100679">//&nbsp;Lookup&nbsp;returns&nbsp;indices&nbsp;that&nbsp;may&nbsp;belong&nbsp;to&nbsp;overlapping&nbsp;matches.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100747">//&nbsp;After&nbsp;eliminating&nbsp;them,&nbsp;we&nbsp;may&nbsp;end&nbsp;up&nbsp;with&nbsp;fewer&nbsp;than&nbsp;n&nbsp;matches.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100817">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;enough&nbsp;at&nbsp;the&nbsp;end,&nbsp;redo&nbsp;the&nbsp;search&nbsp;with&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100882">//&nbsp;increased&nbsp;value&nbsp;n1,&nbsp;but&nbsp;only&nbsp;if&nbsp;Lookup&nbsp;returned&nbsp;all&nbsp;the&nbsp;requested</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6100953">//&nbsp;indices&nbsp;in&nbsp;the&nbsp;first&nbsp;place&nbsp;(if&nbsp;it&nbsp;returned&nbsp;fewer&nbsp;than&nbsp;that&nbsp;then</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101022">//&nbsp;there&nbsp;cannot&nbsp;be&nbsp;more).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101050">for</span>&nbsp;<span class="ident" id="6101054">n1</span>&nbsp;<span class="op" id="6101057">:=</span>&nbsp;<span class="ident" id="6101060"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span><span class="op" id="6101061">;</span>&nbsp;<span class="op" id="6101063">;</span>&nbsp;<span class="ident" id="6101065"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101054">n1</a></span>&nbsp;<span class="op" id="6101068">+=</span>&nbsp;<span class="num" id="6101071">2</span>&nbsp;<span class="op" id="6101073">*</span>&nbsp;<span class="op" id="6101075">(</span><span class="ident" id="6101076"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6101078">-</span>&nbsp;<span class="builtinfunc" id="6101080">len</span><span class="op" id="6101083">(</span><span class="ident" id="6101084"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6101090">)</span><span class="op" id="6101091">)</span>&nbsp;<span class="comment" id="6101093">/*&nbsp;overflow&nbsp;ok&nbsp;*/</span>&nbsp;<span class="op" id="6101111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101116">indices</span>&nbsp;<span class="op" id="6101124">:=</span>&nbsp;<span class="ident" id="6101127"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100247">x</a></span><span class="op" id="6101128">.</span><span class="ident" id="6101129"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099600">Lookup</a></span><span class="op" id="6101135">(</span><span class="ident" id="6101136"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100451">lit</a></span><span class="op" id="6101139">,</span>&nbsp;<span class="ident" id="6101141"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101054">n1</a></span><span class="op" id="6101143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101148">if</span>&nbsp;<span class="builtinfunc" id="6101151">len</span><span class="op" id="6101154">(</span><span class="ident" id="6101155"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span><span class="op" id="6101162">)</span>&nbsp;<span class="op" id="6101164">==</span>&nbsp;<span class="num" id="6101167">0</span>&nbsp;<span class="op" id="6101169">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101175">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101190"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095459">sort</a></span><span class="op" id="6101194">.</span><span class="ident" id="6101195"><a href="/gostd/sort/sort.go.html#2017619">Ints</a></span><span class="op" id="6101199">(</span><span class="ident" id="6101200"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span><span class="op" id="6101207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101212">pairs</span>&nbsp;<span class="op" id="6101218">:=</span>&nbsp;<span class="builtinfunc" id="6101221">make</span><span class="op" id="6101225">(</span><span class="op" id="6101226">[</span><span class="op" id="6101227">]</span><span class="builtintype" id="6101228">int</span><span class="op" id="6101231">,</span>&nbsp;<span class="num" id="6101233">2</span><span class="op" id="6101234">*</span><span class="builtinfunc" id="6101235">len</span><span class="op" id="6101238">(</span><span class="ident" id="6101239"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span><span class="op" id="6101246">)</span><span class="op" id="6101247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101252"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6101259">=</span>&nbsp;<span class="builtinfunc" id="6101261">make</span><span class="op" id="6101265">(</span><span class="op" id="6101266">[</span><span class="op" id="6101267">]</span><span class="op" id="6101268">[</span><span class="op" id="6101269">]</span><span class="builtintype" id="6101270">int</span><span class="op" id="6101273">,</span>&nbsp;<span class="builtinfunc" id="6101275">len</span><span class="op" id="6101278">(</span><span class="ident" id="6101279"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span><span class="op" id="6101286">)</span><span class="op" id="6101287">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101292">count</span>&nbsp;<span class="op" id="6101298">:=</span>&nbsp;<span class="num" id="6101301">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101306">prev</span>&nbsp;<span class="op" id="6101311">:=</span>&nbsp;<span class="num" id="6101314">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101319">for</span>&nbsp;<span class="ident" id="6101323">_</span><span class="op" id="6101324">,</span>&nbsp;<span class="ident" id="6101326">i</span>&nbsp;<span class="op" id="6101328">:=</span>&nbsp;<span class="keyword" id="6101331">range</span>&nbsp;<span class="ident" id="6101337"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span>&nbsp;<span class="op" id="6101345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101351">if</span>&nbsp;<span class="ident" id="6101354"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101292">count</a></span>&nbsp;<span class="op" id="6101360">==</span>&nbsp;<span class="ident" id="6101363"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6101365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101372">break</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101388">//&nbsp;ignore&nbsp;indices&nbsp;leading&nbsp;to&nbsp;overlapping&nbsp;matches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101441">if</span>&nbsp;<span class="ident" id="6101444"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101306">prev</a></span>&nbsp;<span class="op" id="6101449">&lt;=</span>&nbsp;<span class="ident" id="6101452"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101326">i</a></span>&nbsp;<span class="op" id="6101454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101461">j</span>&nbsp;<span class="op" id="6101463">:=</span>&nbsp;<span class="num" id="6101466">2</span>&nbsp;<span class="op" id="6101468">*</span>&nbsp;<span class="ident" id="6101470"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101292">count</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101481"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101212">pairs</a></span><span class="op" id="6101486">[</span><span class="ident" id="6101487"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101461">j</a></span><span class="op" id="6101488">+</span><span class="num" id="6101489">0</span><span class="op" id="6101490">]</span>&nbsp;<span class="op" id="6101492">=</span>&nbsp;<span class="ident" id="6101494"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101326">i</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101501"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101212">pairs</a></span><span class="op" id="6101506">[</span><span class="ident" id="6101507"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101461">j</a></span><span class="op" id="6101508">+</span><span class="num" id="6101509">1</span><span class="op" id="6101510">]</span>&nbsp;<span class="op" id="6101512">=</span>&nbsp;<span class="ident" id="6101514"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101326">i</a></span>&nbsp;<span class="op" id="6101516">+</span>&nbsp;<span class="builtinfunc" id="6101518">len</span><span class="op" id="6101521">(</span><span class="ident" id="6101522"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100451">lit</a></span><span class="op" id="6101525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101532"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6101538">[</span><span class="ident" id="6101539"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101292">count</a></span><span class="op" id="6101544">]</span>&nbsp;<span class="op" id="6101546">=</span>&nbsp;<span class="ident" id="6101548"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101212">pairs</a></span><span class="op" id="6101553">[</span><span class="ident" id="6101554"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101461">j</a></span>&nbsp;<span class="op" id="6101556">:</span>&nbsp;<span class="ident" id="6101558"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101461">j</a></span><span class="op" id="6101559">+</span><span class="num" id="6101560">2</span><span class="op" id="6101561">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101568"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101292">count</a></span><span class="op" id="6101573">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101581"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101306">prev</a></span>&nbsp;<span class="op" id="6101586">=</span>&nbsp;<span class="ident" id="6101588"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101326">i</a></span>&nbsp;<span class="op" id="6101590">+</span>&nbsp;<span class="builtinfunc" id="6101592">len</span><span class="op" id="6101595">(</span><span class="ident" id="6101596"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100451">lit</a></span><span class="op" id="6101599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101605">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101615"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6101622">=</span>&nbsp;<span class="ident" id="6101624"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6101630">[</span><span class="num" id="6101631">0</span><span class="op" id="6101632">:</span><span class="ident" id="6101633"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101292">count</a></span><span class="op" id="6101638">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101643">if</span>&nbsp;<span class="builtinfunc" id="6101646">len</span><span class="op" id="6101649">(</span><span class="ident" id="6101650"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6101656">)</span>&nbsp;<span class="op" id="6101658">&gt;=</span>&nbsp;<span class="ident" id="6101661"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6101663">||</span>&nbsp;<span class="builtinfunc" id="6101666">len</span><span class="op" id="6101669">(</span><span class="ident" id="6101670"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101116">indices</a></span><span class="op" id="6101677">)</span>&nbsp;<span class="op" id="6101679">!=</span>&nbsp;<span class="ident" id="6101682"><a href="/gostd/index/suffixarray/suffixarray.go.html#6101054">n1</a></span>&nbsp;<span class="op" id="6101685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101691">//&nbsp;found&nbsp;all&nbsp;matches&nbsp;or&nbsp;there&#39;s&nbsp;no&nbsp;chance&nbsp;to&nbsp;find&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101750">//&nbsp;(n&nbsp;and&nbsp;n1&nbsp;can&nbsp;be&nbsp;negative)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101784">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101801">if</span>&nbsp;<span class="builtinfunc" id="6101804">len</span><span class="op" id="6101807">(</span><span class="ident" id="6101808"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6101814">)</span>&nbsp;<span class="op" id="6101816">==</span>&nbsp;<span class="num" id="6101819">0</span>&nbsp;<span class="op" id="6101821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6101826"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6101833">=</span>&nbsp;<span class="builtintype" id="6101835">nil</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6101845">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6101853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101857">//&nbsp;regexp&nbsp;has&nbsp;a&nbsp;non-empty&nbsp;literal&nbsp;prefix;&nbsp;Lookup(lit)&nbsp;computes</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101921">//&nbsp;the&nbsp;indices&nbsp;of&nbsp;possible&nbsp;complete&nbsp;matches;&nbsp;use&nbsp;these&nbsp;as&nbsp;starting</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6101989">//&nbsp;points&nbsp;for&nbsp;anchored&nbsp;searches</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6102022">//&nbsp;(regexp&nbsp;&#34;^&#34;&nbsp;matches&nbsp;beginning&nbsp;of&nbsp;input,&nbsp;not&nbsp;beginning&nbsp;of&nbsp;line)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102089"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100270">r</a></span>&nbsp;<span class="op" id="6102091">=</span>&nbsp;<span class="ident" id="6102093"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095449">regexp</a></span><span class="op" id="6102099">.</span><span class="ident" id="6102100"><a href="/gostd/regexp/regexp.go.html#3571892">MustCompile</a></span><span class="op" id="6102111">(</span><span class="string" id="6102112">&#34;^&#34;</span>&nbsp;<span class="op" id="6102116">+</span>&nbsp;<span class="ident" id="6102118"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100270">r</a></span><span class="op" id="6102119">.</span><span class="ident" id="6102120"><a href="/gostd/regexp/regexp.go.html#3567859">String</a></span><span class="op" id="6102126">(</span><span class="op" id="6102127">)</span><span class="op" id="6102128">)</span>&nbsp;<span class="comment" id="6102130">//&nbsp;compiles&nbsp;because&nbsp;r&nbsp;compiled</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6102163">//&nbsp;same&nbsp;comment&nbsp;about&nbsp;Lookup&nbsp;applies&nbsp;here&nbsp;as&nbsp;in&nbsp;the&nbsp;loop&nbsp;above</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102227">for</span>&nbsp;<span class="ident" id="6102231">n1</span>&nbsp;<span class="op" id="6102234">:=</span>&nbsp;<span class="ident" id="6102237"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span><span class="op" id="6102238">;</span>&nbsp;<span class="op" id="6102240">;</span>&nbsp;<span class="ident" id="6102242"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102231">n1</a></span>&nbsp;<span class="op" id="6102245">+=</span>&nbsp;<span class="num" id="6102248">2</span>&nbsp;<span class="op" id="6102250">*</span>&nbsp;<span class="op" id="6102252">(</span><span class="ident" id="6102253"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6102255">-</span>&nbsp;<span class="builtinfunc" id="6102257">len</span><span class="op" id="6102260">(</span><span class="ident" id="6102261"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102267">)</span><span class="op" id="6102268">)</span>&nbsp;<span class="comment" id="6102270">/*&nbsp;overflow&nbsp;ok&nbsp;*/</span>&nbsp;<span class="op" id="6102288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102292">indices</span>&nbsp;<span class="op" id="6102300">:=</span>&nbsp;<span class="ident" id="6102303"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100247">x</a></span><span class="op" id="6102304">.</span><span class="ident" id="6102305"><a href="/gostd/index/suffixarray/suffixarray.go.html#6099600">Lookup</a></span><span class="op" id="6102311">(</span><span class="ident" id="6102312"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100451">lit</a></span><span class="op" id="6102315">,</span>&nbsp;<span class="ident" id="6102317"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102231">n1</a></span><span class="op" id="6102319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102323">if</span>&nbsp;<span class="builtinfunc" id="6102326">len</span><span class="op" id="6102329">(</span><span class="ident" id="6102330"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102292">indices</a></span><span class="op" id="6102337">)</span>&nbsp;<span class="op" id="6102339">==</span>&nbsp;<span class="num" id="6102342">0</span>&nbsp;<span class="op" id="6102344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102349">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102358">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102362"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095459">sort</a></span><span class="op" id="6102366">.</span><span class="ident" id="6102367"><a href="/gostd/sort/sort.go.html#2017619">Ints</a></span><span class="op" id="6102371">(</span><span class="ident" id="6102372"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102292">indices</a></span><span class="op" id="6102379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102383"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6102390">=</span>&nbsp;<span class="ident" id="6102392"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102398">[</span><span class="num" id="6102399">0</span><span class="op" id="6102400">:</span><span class="num" id="6102401">0</span><span class="op" id="6102402">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102406">prev</span>&nbsp;<span class="op" id="6102411">:=</span>&nbsp;<span class="num" id="6102414">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102418">for</span>&nbsp;<span class="ident" id="6102422">_</span><span class="op" id="6102423">,</span>&nbsp;<span class="ident" id="6102425">i</span>&nbsp;<span class="op" id="6102427">:=</span>&nbsp;<span class="keyword" id="6102430">range</span>&nbsp;<span class="ident" id="6102436"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102292">indices</a></span>&nbsp;<span class="op" id="6102444">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102449">if</span>&nbsp;<span class="builtinfunc" id="6102452">len</span><span class="op" id="6102455">(</span><span class="ident" id="6102456"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102462">)</span>&nbsp;<span class="op" id="6102464">==</span>&nbsp;<span class="ident" id="6102467"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6102469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102475">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102484">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102489">m</span>&nbsp;<span class="op" id="6102491">:=</span>&nbsp;<span class="ident" id="6102494"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100270">r</a></span><span class="op" id="6102495">.</span><span class="ident" id="6102496"><a href="/gostd/regexp/regexp.go.html#3584583">FindIndex</a></span><span class="op" id="6102505">(</span><span class="ident" id="6102506"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100247">x</a></span><span class="op" id="6102507">.</span><span class="ident" id="6102508"><a href="/gostd/index/suffixarray/suffixarray.go.html#6095552">data</a></span><span class="op" id="6102512">[</span><span class="ident" id="6102513"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102425">i</a></span><span class="op" id="6102514">:</span><span class="op" id="6102515">]</span><span class="op" id="6102516">)</span>&nbsp;<span class="comment" id="6102518">//&nbsp;anchored&nbsp;search&nbsp;-&nbsp;will&nbsp;not&nbsp;run&nbsp;off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6102559">//&nbsp;ignore&nbsp;indices&nbsp;leading&nbsp;to&nbsp;overlapping&nbsp;matches</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102611">if</span>&nbsp;<span class="ident" id="6102614"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102489">m</a></span>&nbsp;<span class="op" id="6102616">!=</span>&nbsp;<span class="builtintype" id="6102619">nil</span>&nbsp;<span class="op" id="6102623">&amp;&amp;</span>&nbsp;<span class="ident" id="6102626"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102406">prev</a></span>&nbsp;<span class="op" id="6102631">&lt;=</span>&nbsp;<span class="ident" id="6102634"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102425">i</a></span>&nbsp;<span class="op" id="6102636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102642"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102489">m</a></span><span class="op" id="6102643">[</span><span class="num" id="6102644">0</span><span class="op" id="6102645">]</span>&nbsp;<span class="op" id="6102647">=</span>&nbsp;<span class="ident" id="6102649"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102425">i</a></span>&nbsp;<span class="comment" id="6102651">//&nbsp;correct&nbsp;m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102668"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102489">m</a></span><span class="op" id="6102669">[</span><span class="num" id="6102670">1</span><span class="op" id="6102671">]</span>&nbsp;<span class="op" id="6102673">+=</span>&nbsp;<span class="ident" id="6102676"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102425">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102682"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6102689">=</span>&nbsp;<span class="builtinfunc" id="6102691">append</span><span class="op" id="6102697">(</span><span class="ident" id="6102698"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102704">,</span>&nbsp;<span class="ident" id="6102706"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102489">m</a></span><span class="op" id="6102707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102713"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102406">prev</a></span>&nbsp;<span class="op" id="6102718">=</span>&nbsp;<span class="ident" id="6102720"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102489">m</a></span><span class="op" id="6102721">[</span><span class="num" id="6102722">1</span><span class="op" id="6102723">]</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102736">if</span>&nbsp;<span class="builtinfunc" id="6102739">len</span><span class="op" id="6102742">(</span><span class="ident" id="6102743"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102749">)</span>&nbsp;<span class="op" id="6102751">&gt;=</span>&nbsp;<span class="ident" id="6102754"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100288">n</a></span>&nbsp;<span class="op" id="6102756">||</span>&nbsp;<span class="builtinfunc" id="6102759">len</span><span class="op" id="6102762">(</span><span class="ident" id="6102763"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102292">indices</a></span><span class="op" id="6102770">)</span>&nbsp;<span class="op" id="6102772">!=</span>&nbsp;<span class="ident" id="6102775"><a href="/gostd/index/suffixarray/suffixarray.go.html#6102231">n1</a></span>&nbsp;<span class="op" id="6102778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6102783">//&nbsp;found&nbsp;all&nbsp;matches&nbsp;or&nbsp;there&#39;s&nbsp;no&nbsp;chance&nbsp;to&nbsp;find&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6102841">//&nbsp;(n&nbsp;and&nbsp;n1&nbsp;can&nbsp;be&nbsp;negative)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102874">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102888">if</span>&nbsp;<span class="builtinfunc" id="6102891">len</span><span class="op" id="6102894">(</span><span class="ident" id="6102895"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span><span class="op" id="6102901">)</span>&nbsp;<span class="op" id="6102903">==</span>&nbsp;<span class="num" id="6102906">0</span>&nbsp;<span class="op" id="6102908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6102912"><a href="/gostd/index/suffixarray/suffixarray.go.html#6100296">result</a></span>&nbsp;<span class="op" id="6102919">=</span>&nbsp;<span class="builtintype" id="6102921">nil</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6102926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6102929">return</span><br>
<span class="lineno"></span><span class="op" id="6102936">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
