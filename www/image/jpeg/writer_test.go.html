<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8073127">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8073182">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8073236">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8073287">package</span>&nbsp;<span class="ident" id="8073295">jpeg</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8073301">import</span>&nbsp;<span class="op" id="8073308">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073311">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073320">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073327">&#34;image&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073336">&#34;image/color&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073351">&#34;image/png&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073364">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073377">&#34;math/rand&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073390">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8073396">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8073406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8073409">//&nbsp;zigzag&nbsp;maps&nbsp;from&nbsp;the&nbsp;natural&nbsp;ordering&nbsp;to&nbsp;the&nbsp;zig-zag&nbsp;ordering.&nbsp;For&nbsp;example,</span><br>
<span class="lineno">20</span><span class="comment" id="8073488">//&nbsp;zigzag[0*8&nbsp;+&nbsp;3]&nbsp;is&nbsp;the&nbsp;zig-zag&nbsp;sequence&nbsp;number&nbsp;of&nbsp;the&nbsp;element&nbsp;in&nbsp;the&nbsp;fourth</span><br>
<span class="lineno"></span><span class="comment" id="8073567">//&nbsp;column&nbsp;and&nbsp;first&nbsp;row.</span><br>
<span class="lineno"></span><span class="keyword" id="8073592">var</span>&nbsp;<span class="ident" id="8073596">zigzag</span>&nbsp;<span class="op" id="8073603">=</span>&nbsp;<span class="op" id="8073605">[</span><span class="ident" id="8073606"><a href="/image/jpeg/idct.go.html#3131898">blockSize</a></span><span class="op" id="8073615">]</span><span class="builtintype" id="8073616">int</span><span class="op" id="8073619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073622">0</span><span class="op" id="8073623">,</span>&nbsp;<span class="num" id="8073625">1</span><span class="op" id="8073626">,</span>&nbsp;<span class="num" id="8073628">5</span><span class="op" id="8073629">,</span>&nbsp;<span class="num" id="8073631">6</span><span class="op" id="8073632">,</span>&nbsp;<span class="num" id="8073634">14</span><span class="op" id="8073636">,</span>&nbsp;<span class="num" id="8073638">15</span><span class="op" id="8073640">,</span>&nbsp;<span class="num" id="8073642">27</span><span class="op" id="8073644">,</span>&nbsp;<span class="num" id="8073646">28</span><span class="op" id="8073648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073651">2</span><span class="op" id="8073652">,</span>&nbsp;<span class="num" id="8073654">4</span><span class="op" id="8073655">,</span>&nbsp;<span class="num" id="8073657">7</span><span class="op" id="8073658">,</span>&nbsp;<span class="num" id="8073660">13</span><span class="op" id="8073662">,</span>&nbsp;<span class="num" id="8073664">16</span><span class="op" id="8073666">,</span>&nbsp;<span class="num" id="8073668">26</span><span class="op" id="8073670">,</span>&nbsp;<span class="num" id="8073672">29</span><span class="op" id="8073674">,</span>&nbsp;<span class="num" id="8073676">42</span><span class="op" id="8073678">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073681">3</span><span class="op" id="8073682">,</span>&nbsp;<span class="num" id="8073684">8</span><span class="op" id="8073685">,</span>&nbsp;<span class="num" id="8073687">12</span><span class="op" id="8073689">,</span>&nbsp;<span class="num" id="8073691">17</span><span class="op" id="8073693">,</span>&nbsp;<span class="num" id="8073695">25</span><span class="op" id="8073697">,</span>&nbsp;<span class="num" id="8073699">30</span><span class="op" id="8073701">,</span>&nbsp;<span class="num" id="8073703">41</span><span class="op" id="8073705">,</span>&nbsp;<span class="num" id="8073707">43</span><span class="op" id="8073709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073712">9</span><span class="op" id="8073713">,</span>&nbsp;<span class="num" id="8073715">11</span><span class="op" id="8073717">,</span>&nbsp;<span class="num" id="8073719">18</span><span class="op" id="8073721">,</span>&nbsp;<span class="num" id="8073723">24</span><span class="op" id="8073725">,</span>&nbsp;<span class="num" id="8073727">31</span><span class="op" id="8073729">,</span>&nbsp;<span class="num" id="8073731">40</span><span class="op" id="8073733">,</span>&nbsp;<span class="num" id="8073735">44</span><span class="op" id="8073737">,</span>&nbsp;<span class="num" id="8073739">53</span><span class="op" id="8073741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073744">10</span><span class="op" id="8073746">,</span>&nbsp;<span class="num" id="8073748">19</span><span class="op" id="8073750">,</span>&nbsp;<span class="num" id="8073752">23</span><span class="op" id="8073754">,</span>&nbsp;<span class="num" id="8073756">32</span><span class="op" id="8073758">,</span>&nbsp;<span class="num" id="8073760">39</span><span class="op" id="8073762">,</span>&nbsp;<span class="num" id="8073764">45</span><span class="op" id="8073766">,</span>&nbsp;<span class="num" id="8073768">52</span><span class="op" id="8073770">,</span>&nbsp;<span class="num" id="8073772">54</span><span class="op" id="8073774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073777">20</span><span class="op" id="8073779">,</span>&nbsp;<span class="num" id="8073781">22</span><span class="op" id="8073783">,</span>&nbsp;<span class="num" id="8073785">33</span><span class="op" id="8073787">,</span>&nbsp;<span class="num" id="8073789">38</span><span class="op" id="8073791">,</span>&nbsp;<span class="num" id="8073793">46</span><span class="op" id="8073795">,</span>&nbsp;<span class="num" id="8073797">51</span><span class="op" id="8073799">,</span>&nbsp;<span class="num" id="8073801">55</span><span class="op" id="8073803">,</span>&nbsp;<span class="num" id="8073805">60</span><span class="op" id="8073807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073810">21</span><span class="op" id="8073812">,</span>&nbsp;<span class="num" id="8073814">34</span><span class="op" id="8073816">,</span>&nbsp;<span class="num" id="8073818">37</span><span class="op" id="8073820">,</span>&nbsp;<span class="num" id="8073822">47</span><span class="op" id="8073824">,</span>&nbsp;<span class="num" id="8073826">50</span><span class="op" id="8073828">,</span>&nbsp;<span class="num" id="8073830">56</span><span class="op" id="8073832">,</span>&nbsp;<span class="num" id="8073834">59</span><span class="op" id="8073836">,</span>&nbsp;<span class="num" id="8073838">61</span><span class="op" id="8073840">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8073843">35</span><span class="op" id="8073845">,</span>&nbsp;<span class="num" id="8073847">36</span><span class="op" id="8073849">,</span>&nbsp;<span class="num" id="8073851">48</span><span class="op" id="8073853">,</span>&nbsp;<span class="num" id="8073855">49</span><span class="op" id="8073857">,</span>&nbsp;<span class="num" id="8073859">57</span><span class="op" id="8073861">,</span>&nbsp;<span class="num" id="8073863">58</span><span class="op" id="8073865">,</span>&nbsp;<span class="num" id="8073867">62</span><span class="op" id="8073869">,</span>&nbsp;<span class="num" id="8073871">63</span><span class="op" id="8073873">,</span><br>
<span class="lineno"></span><span class="op" id="8073875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8073878">func</span>&nbsp;<span class="ident" id="8073883">TestZigUnzig</span><span class="op" id="8073895">(</span><span class="ident" id="8073896">t</span>&nbsp;<span class="op" id="8073898">*</span><span class="ident" id="8073899"><a href="/image/jpeg/writer_test.go.html#8073396">testing</a></span><span class="op" id="8073906">.</span><span class="ident" id="8073907">T</span><span class="op" id="8073908">)</span>&nbsp;<span class="op" id="8073910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8073913">for</span>&nbsp;<span class="ident" id="8073917">i</span>&nbsp;<span class="op" id="8073919">:=</span>&nbsp;<span class="num" id="8073922">0</span><span class="op" id="8073923">;</span>&nbsp;<span class="ident" id="8073925"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span>&nbsp;<span class="op" id="8073927">&lt;</span>&nbsp;<span class="ident" id="8073929"><a href="/image/jpeg/idct.go.html#3131898">blockSize</a></span><span class="op" id="8073938">;</span>&nbsp;<span class="ident" id="8073940"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8073941">++</span>&nbsp;<span class="op" id="8073944">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8073948">if</span>&nbsp;<span class="ident" id="8073951"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8073956">[</span><span class="ident" id="8073957"><a href="/image/jpeg/writer_test.go.html#8073596">zigzag</a></span><span class="op" id="8073963">[</span><span class="ident" id="8073964"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8073965">]</span><span class="op" id="8073966">]</span>&nbsp;<span class="op" id="8073968">!=</span>&nbsp;<span class="ident" id="8073971"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span>&nbsp;<span class="op" id="8073973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8073978"><a href="/image/jpeg/writer_test.go.html#8073896">t</a></span><span class="op" id="8073979">.</span><span class="ident" id="8073980">Errorf</span><span class="op" id="8073986">(</span><span class="string" id="8073987">&#34;unzig[zigzag[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="8074012">,</span>&nbsp;<span class="ident" id="8074014"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8074015">,</span>&nbsp;<span class="ident" id="8074017"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8074022">[</span><span class="ident" id="8074023"><a href="/image/jpeg/writer_test.go.html#8073596">zigzag</a></span><span class="op" id="8074029">[</span><span class="ident" id="8074030"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8074031">]</span><span class="op" id="8074032">]</span><span class="op" id="8074033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8074041">if</span>&nbsp;<span class="ident" id="8074044"><a href="/image/jpeg/writer_test.go.html#8073596">zigzag</a></span><span class="op" id="8074050">[</span><span class="ident" id="8074051"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8074056">[</span><span class="ident" id="8074057"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8074058">]</span><span class="op" id="8074059">]</span>&nbsp;<span class="op" id="8074061">!=</span>&nbsp;<span class="ident" id="8074064"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span>&nbsp;<span class="op" id="8074066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8074071"><a href="/image/jpeg/writer_test.go.html#8073896">t</a></span><span class="op" id="8074072">.</span><span class="ident" id="8074073">Errorf</span><span class="op" id="8074079">(</span><span class="string" id="8074080">&#34;zigzag[unzig[%d]]&nbsp;==&nbsp;%d&#34;</span><span class="op" id="8074105">,</span>&nbsp;<span class="ident" id="8074107"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8074108">,</span>&nbsp;<span class="ident" id="8074110"><a href="/image/jpeg/writer_test.go.html#8073596">zigzag</a></span><span class="op" id="8074116">[</span><span class="ident" id="8074117"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8074122">[</span><span class="ident" id="8074123"><a href="/image/jpeg/writer_test.go.html#8073917">i</a></span><span class="op" id="8074124">]</span><span class="op" id="8074125">]</span><span class="op" id="8074126">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074133">}</span><br>
<span class="lineno"></span><span class="op" id="8074135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8074138">//&nbsp;unscaledQuantInNaturalOrder&nbsp;are&nbsp;the&nbsp;unscaled&nbsp;quantization&nbsp;tables&nbsp;in</span><br>
<span class="lineno">45</span><span class="comment" id="8074209">//&nbsp;natural&nbsp;(not&nbsp;zig-zag)&nbsp;order,&nbsp;as&nbsp;specified&nbsp;in&nbsp;section&nbsp;K.1.</span><br>
<span class="lineno"></span><span class="keyword" id="8074270">var</span>&nbsp;<span class="ident" id="8074274">unscaledQuantInNaturalOrder</span>&nbsp;<span class="op" id="8074302">=</span>&nbsp;<span class="op" id="8074304">[</span><span class="ident" id="8074305"><a href="/image/jpeg/writer.go.html#3165103">nQuantIndex</a></span><span class="op" id="8074316">]</span><span class="op" id="8074317">[</span><span class="ident" id="8074318"><a href="/image/jpeg/idct.go.html#3131898">blockSize</a></span><span class="op" id="8074327">]</span><span class="builtintype" id="8074328">byte</span><span class="op" id="8074332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8074335">//&nbsp;Luminance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074354">16</span><span class="op" id="8074356">,</span>&nbsp;<span class="num" id="8074358">11</span><span class="op" id="8074360">,</span>&nbsp;<span class="num" id="8074362">10</span><span class="op" id="8074364">,</span>&nbsp;<span class="num" id="8074366">16</span><span class="op" id="8074368">,</span>&nbsp;<span class="num" id="8074370">24</span><span class="op" id="8074372">,</span>&nbsp;<span class="num" id="8074374">40</span><span class="op" id="8074376">,</span>&nbsp;<span class="num" id="8074378">51</span><span class="op" id="8074380">,</span>&nbsp;<span class="num" id="8074382">61</span><span class="op" id="8074384">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074388">12</span><span class="op" id="8074390">,</span>&nbsp;<span class="num" id="8074392">12</span><span class="op" id="8074394">,</span>&nbsp;<span class="num" id="8074396">14</span><span class="op" id="8074398">,</span>&nbsp;<span class="num" id="8074400">19</span><span class="op" id="8074402">,</span>&nbsp;<span class="num" id="8074404">26</span><span class="op" id="8074406">,</span>&nbsp;<span class="num" id="8074408">58</span><span class="op" id="8074410">,</span>&nbsp;<span class="num" id="8074412">60</span><span class="op" id="8074414">,</span>&nbsp;<span class="num" id="8074416">55</span><span class="op" id="8074418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074422">14</span><span class="op" id="8074424">,</span>&nbsp;<span class="num" id="8074426">13</span><span class="op" id="8074428">,</span>&nbsp;<span class="num" id="8074430">16</span><span class="op" id="8074432">,</span>&nbsp;<span class="num" id="8074434">24</span><span class="op" id="8074436">,</span>&nbsp;<span class="num" id="8074438">40</span><span class="op" id="8074440">,</span>&nbsp;<span class="num" id="8074442">57</span><span class="op" id="8074444">,</span>&nbsp;<span class="num" id="8074446">69</span><span class="op" id="8074448">,</span>&nbsp;<span class="num" id="8074450">56</span><span class="op" id="8074452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074456">14</span><span class="op" id="8074458">,</span>&nbsp;<span class="num" id="8074460">17</span><span class="op" id="8074462">,</span>&nbsp;<span class="num" id="8074464">22</span><span class="op" id="8074466">,</span>&nbsp;<span class="num" id="8074468">29</span><span class="op" id="8074470">,</span>&nbsp;<span class="num" id="8074472">51</span><span class="op" id="8074474">,</span>&nbsp;<span class="num" id="8074476">87</span><span class="op" id="8074478">,</span>&nbsp;<span class="num" id="8074480">80</span><span class="op" id="8074482">,</span>&nbsp;<span class="num" id="8074484">62</span><span class="op" id="8074486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074490">18</span><span class="op" id="8074492">,</span>&nbsp;<span class="num" id="8074494">22</span><span class="op" id="8074496">,</span>&nbsp;<span class="num" id="8074498">37</span><span class="op" id="8074500">,</span>&nbsp;<span class="num" id="8074502">56</span><span class="op" id="8074504">,</span>&nbsp;<span class="num" id="8074506">68</span><span class="op" id="8074508">,</span>&nbsp;<span class="num" id="8074510">109</span><span class="op" id="8074513">,</span>&nbsp;<span class="num" id="8074515">103</span><span class="op" id="8074518">,</span>&nbsp;<span class="num" id="8074520">77</span><span class="op" id="8074522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074526">24</span><span class="op" id="8074528">,</span>&nbsp;<span class="num" id="8074530">35</span><span class="op" id="8074532">,</span>&nbsp;<span class="num" id="8074534">55</span><span class="op" id="8074536">,</span>&nbsp;<span class="num" id="8074538">64</span><span class="op" id="8074540">,</span>&nbsp;<span class="num" id="8074542">81</span><span class="op" id="8074544">,</span>&nbsp;<span class="num" id="8074546">104</span><span class="op" id="8074549">,</span>&nbsp;<span class="num" id="8074551">113</span><span class="op" id="8074554">,</span>&nbsp;<span class="num" id="8074556">92</span><span class="op" id="8074558">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074562">49</span><span class="op" id="8074564">,</span>&nbsp;<span class="num" id="8074566">64</span><span class="op" id="8074568">,</span>&nbsp;<span class="num" id="8074570">78</span><span class="op" id="8074572">,</span>&nbsp;<span class="num" id="8074574">87</span><span class="op" id="8074576">,</span>&nbsp;<span class="num" id="8074578">103</span><span class="op" id="8074581">,</span>&nbsp;<span class="num" id="8074583">121</span><span class="op" id="8074586">,</span>&nbsp;<span class="num" id="8074588">120</span><span class="op" id="8074591">,</span>&nbsp;<span class="num" id="8074593">101</span><span class="op" id="8074596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074600">72</span><span class="op" id="8074602">,</span>&nbsp;<span class="num" id="8074604">92</span><span class="op" id="8074606">,</span>&nbsp;<span class="num" id="8074608">95</span><span class="op" id="8074610">,</span>&nbsp;<span class="num" id="8074612">98</span><span class="op" id="8074614">,</span>&nbsp;<span class="num" id="8074616">112</span><span class="op" id="8074619">,</span>&nbsp;<span class="num" id="8074621">100</span><span class="op" id="8074624">,</span>&nbsp;<span class="num" id="8074626">103</span><span class="op" id="8074629">,</span>&nbsp;<span class="num" id="8074631">99</span><span class="op" id="8074633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074636">}</span><span class="op" id="8074637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8074640">//&nbsp;Chrominance.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074657">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074661">17</span><span class="op" id="8074663">,</span>&nbsp;<span class="num" id="8074665">18</span><span class="op" id="8074667">,</span>&nbsp;<span class="num" id="8074669">24</span><span class="op" id="8074671">,</span>&nbsp;<span class="num" id="8074673">47</span><span class="op" id="8074675">,</span>&nbsp;<span class="num" id="8074677">99</span><span class="op" id="8074679">,</span>&nbsp;<span class="num" id="8074681">99</span><span class="op" id="8074683">,</span>&nbsp;<span class="num" id="8074685">99</span><span class="op" id="8074687">,</span>&nbsp;<span class="num" id="8074689">99</span><span class="op" id="8074691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074695">18</span><span class="op" id="8074697">,</span>&nbsp;<span class="num" id="8074699">21</span><span class="op" id="8074701">,</span>&nbsp;<span class="num" id="8074703">26</span><span class="op" id="8074705">,</span>&nbsp;<span class="num" id="8074707">66</span><span class="op" id="8074709">,</span>&nbsp;<span class="num" id="8074711">99</span><span class="op" id="8074713">,</span>&nbsp;<span class="num" id="8074715">99</span><span class="op" id="8074717">,</span>&nbsp;<span class="num" id="8074719">99</span><span class="op" id="8074721">,</span>&nbsp;<span class="num" id="8074723">99</span><span class="op" id="8074725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074729">24</span><span class="op" id="8074731">,</span>&nbsp;<span class="num" id="8074733">26</span><span class="op" id="8074735">,</span>&nbsp;<span class="num" id="8074737">56</span><span class="op" id="8074739">,</span>&nbsp;<span class="num" id="8074741">99</span><span class="op" id="8074743">,</span>&nbsp;<span class="num" id="8074745">99</span><span class="op" id="8074747">,</span>&nbsp;<span class="num" id="8074749">99</span><span class="op" id="8074751">,</span>&nbsp;<span class="num" id="8074753">99</span><span class="op" id="8074755">,</span>&nbsp;<span class="num" id="8074757">99</span><span class="op" id="8074759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074763">47</span><span class="op" id="8074765">,</span>&nbsp;<span class="num" id="8074767">66</span><span class="op" id="8074769">,</span>&nbsp;<span class="num" id="8074771">99</span><span class="op" id="8074773">,</span>&nbsp;<span class="num" id="8074775">99</span><span class="op" id="8074777">,</span>&nbsp;<span class="num" id="8074779">99</span><span class="op" id="8074781">,</span>&nbsp;<span class="num" id="8074783">99</span><span class="op" id="8074785">,</span>&nbsp;<span class="num" id="8074787">99</span><span class="op" id="8074789">,</span>&nbsp;<span class="num" id="8074791">99</span><span class="op" id="8074793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074797">99</span><span class="op" id="8074799">,</span>&nbsp;<span class="num" id="8074801">99</span><span class="op" id="8074803">,</span>&nbsp;<span class="num" id="8074805">99</span><span class="op" id="8074807">,</span>&nbsp;<span class="num" id="8074809">99</span><span class="op" id="8074811">,</span>&nbsp;<span class="num" id="8074813">99</span><span class="op" id="8074815">,</span>&nbsp;<span class="num" id="8074817">99</span><span class="op" id="8074819">,</span>&nbsp;<span class="num" id="8074821">99</span><span class="op" id="8074823">,</span>&nbsp;<span class="num" id="8074825">99</span><span class="op" id="8074827">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074831">99</span><span class="op" id="8074833">,</span>&nbsp;<span class="num" id="8074835">99</span><span class="op" id="8074837">,</span>&nbsp;<span class="num" id="8074839">99</span><span class="op" id="8074841">,</span>&nbsp;<span class="num" id="8074843">99</span><span class="op" id="8074845">,</span>&nbsp;<span class="num" id="8074847">99</span><span class="op" id="8074849">,</span>&nbsp;<span class="num" id="8074851">99</span><span class="op" id="8074853">,</span>&nbsp;<span class="num" id="8074855">99</span><span class="op" id="8074857">,</span>&nbsp;<span class="num" id="8074859">99</span><span class="op" id="8074861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074865">99</span><span class="op" id="8074867">,</span>&nbsp;<span class="num" id="8074869">99</span><span class="op" id="8074871">,</span>&nbsp;<span class="num" id="8074873">99</span><span class="op" id="8074875">,</span>&nbsp;<span class="num" id="8074877">99</span><span class="op" id="8074879">,</span>&nbsp;<span class="num" id="8074881">99</span><span class="op" id="8074883">,</span>&nbsp;<span class="num" id="8074885">99</span><span class="op" id="8074887">,</span>&nbsp;<span class="num" id="8074889">99</span><span class="op" id="8074891">,</span>&nbsp;<span class="num" id="8074893">99</span><span class="op" id="8074895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8074899">99</span><span class="op" id="8074901">,</span>&nbsp;<span class="num" id="8074903">99</span><span class="op" id="8074905">,</span>&nbsp;<span class="num" id="8074907">99</span><span class="op" id="8074909">,</span>&nbsp;<span class="num" id="8074911">99</span><span class="op" id="8074913">,</span>&nbsp;<span class="num" id="8074915">99</span><span class="op" id="8074917">,</span>&nbsp;<span class="num" id="8074919">99</span><span class="op" id="8074921">,</span>&nbsp;<span class="num" id="8074923">99</span><span class="op" id="8074925">,</span>&nbsp;<span class="num" id="8074927">99</span><span class="op" id="8074929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8074932">}</span><span class="op" id="8074933">,</span><br>
<span class="lineno"></span><span class="op" id="8074935">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="8074938">func</span>&nbsp;<span class="ident" id="8074943">TestUnscaledQuant</span><span class="op" id="8074960">(</span><span class="ident" id="8074961">t</span>&nbsp;<span class="op" id="8074963">*</span><span class="ident" id="8074964"><a href="/image/jpeg/writer_test.go.html#8073396">testing</a></span><span class="op" id="8074971">.</span><span class="ident" id="8074972">T</span><span class="op" id="8074973">)</span>&nbsp;<span class="op" id="8074975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8074978">bad</span>&nbsp;<span class="op" id="8074982">:=</span>&nbsp;<span class="builtintype" id="8074985">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8074992">for</span>&nbsp;<span class="ident" id="8074996">i</span>&nbsp;<span class="op" id="8074998">:=</span>&nbsp;<span class="ident" id="8075001"><a href="/image/jpeg/writer.go.html#3165016">quantIndex</a></span><span class="op" id="8075011">(</span><span class="num" id="8075012">0</span><span class="op" id="8075013">)</span><span class="op" id="8075014">;</span>&nbsp;<span class="ident" id="8075016"><a href="/image/jpeg/writer_test.go.html#8074996">i</a></span>&nbsp;<span class="op" id="8075018">&lt;</span>&nbsp;<span class="ident" id="8075020"><a href="/image/jpeg/writer.go.html#3165103">nQuantIndex</a></span><span class="op" id="8075031">;</span>&nbsp;<span class="ident" id="8075033"><a href="/image/jpeg/writer_test.go.html#8074996">i</a></span><span class="op" id="8075034">++</span>&nbsp;<span class="op" id="8075037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075041">for</span>&nbsp;<span class="ident" id="8075045">zig</span>&nbsp;<span class="op" id="8075049">:=</span>&nbsp;<span class="num" id="8075052">0</span><span class="op" id="8075053">;</span>&nbsp;<span class="ident" id="8075055"><a href="/image/jpeg/writer_test.go.html#8075045">zig</a></span>&nbsp;<span class="op" id="8075059">&lt;</span>&nbsp;<span class="ident" id="8075061"><a href="/image/jpeg/idct.go.html#3131898">blockSize</a></span><span class="op" id="8075070">;</span>&nbsp;<span class="ident" id="8075072"><a href="/image/jpeg/writer_test.go.html#8075045">zig</a></span><span class="op" id="8075075">++</span>&nbsp;<span class="op" id="8075078">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075083">got</span>&nbsp;<span class="op" id="8075087">:=</span>&nbsp;<span class="ident" id="8075090"><a href="/image/jpeg/writer.go.html#3165369">unscaledQuant</a></span><span class="op" id="8075103">[</span><span class="ident" id="8075104"><a href="/image/jpeg/writer_test.go.html#8074996">i</a></span><span class="op" id="8075105">]</span><span class="op" id="8075106">[</span><span class="ident" id="8075107"><a href="/image/jpeg/writer_test.go.html#8075045">zig</a></span><span class="op" id="8075110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075115">want</span>&nbsp;<span class="op" id="8075120">:=</span>&nbsp;<span class="ident" id="8075123"><a href="/image/jpeg/writer_test.go.html#8074274">unscaledQuantInNaturalOrder</a></span><span class="op" id="8075150">[</span><span class="ident" id="8075151"><a href="/image/jpeg/writer_test.go.html#8074996">i</a></span><span class="op" id="8075152">]</span><span class="op" id="8075153">[</span><span class="ident" id="8075154"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8075159">[</span><span class="ident" id="8075160"><a href="/image/jpeg/writer_test.go.html#8075045">zig</a></span><span class="op" id="8075163">]</span><span class="op" id="8075164">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075169">if</span>&nbsp;<span class="ident" id="8075172"><a href="/image/jpeg/writer_test.go.html#8075083">got</a></span>&nbsp;<span class="op" id="8075176">!=</span>&nbsp;<span class="ident" id="8075179"><a href="/image/jpeg/writer_test.go.html#8075115">want</a></span>&nbsp;<span class="op" id="8075184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075190"><a href="/image/jpeg/writer_test.go.html#8074961">t</a></span><span class="op" id="8075191">.</span><span class="ident" id="8075192">Errorf</span><span class="op" id="8075198">(</span><span class="string" id="8075199">&#34;i=%d,&nbsp;zig=%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8075230">,</span>&nbsp;<span class="ident" id="8075232"><a href="/image/jpeg/writer_test.go.html#8074996">i</a></span><span class="op" id="8075233">,</span>&nbsp;<span class="ident" id="8075235"><a href="/image/jpeg/writer_test.go.html#8075045">zig</a></span><span class="op" id="8075238">,</span>&nbsp;<span class="ident" id="8075240"><a href="/image/jpeg/writer_test.go.html#8075083">got</a></span><span class="op" id="8075243">,</span>&nbsp;<span class="ident" id="8075245"><a href="/image/jpeg/writer_test.go.html#8075115">want</a></span><span class="op" id="8075249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075255"><a href="/image/jpeg/writer_test.go.html#8074978">bad</a></span>&nbsp;<span class="op" id="8075259">=</span>&nbsp;<span class="builtintype" id="8075261">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075279">if</span>&nbsp;<span class="ident" id="8075282"><a href="/image/jpeg/writer_test.go.html#8074978">bad</a></span>&nbsp;<span class="op" id="8075286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075290">names</span>&nbsp;<span class="op" id="8075296">:=</span>&nbsp;<span class="op" id="8075299">[</span><span class="ident" id="8075300"><a href="/image/jpeg/writer.go.html#3165103">nQuantIndex</a></span><span class="op" id="8075311">]</span><span class="builtintype" id="8075312">string</span><span class="op" id="8075318">{</span><span class="string" id="8075319">&#34;Luminance&#34;</span><span class="op" id="8075330">,</span>&nbsp;<span class="string" id="8075332">&#34;Chrominance&#34;</span><span class="op" id="8075345">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075349">buf</span>&nbsp;<span class="op" id="8075353">:=</span>&nbsp;<span class="op" id="8075356">&amp;</span><span class="ident" id="8075357"><a href="/image/jpeg/writer_test.go.html#8073311">bytes</a></span><span class="op" id="8075362">.</span><span class="ident" id="8075363">Buffer</span><span class="op" id="8075369">{</span><span class="op" id="8075370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075374">for</span>&nbsp;<span class="ident" id="8075378">i</span><span class="op" id="8075379">,</span>&nbsp;<span class="ident" id="8075381">name</span>&nbsp;<span class="op" id="8075386">:=</span>&nbsp;<span class="keyword" id="8075389">range</span>&nbsp;<span class="ident" id="8075395"><a href="/image/jpeg/writer_test.go.html#8075290">names</a></span>&nbsp;<span class="op" id="8075401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075406"><a href="/image/jpeg/writer_test.go.html#8073320">fmt</a></span><span class="op" id="8075409">.</span><span class="ident" id="8075410">Fprintf</span><span class="op" id="8075417">(</span><span class="ident" id="8075418"><a href="/image/jpeg/writer_test.go.html#8075349">buf</a></span><span class="op" id="8075421">,</span>&nbsp;<span class="string" id="8075423">&#34;//&nbsp;%s.\n{\n&#34;</span><span class="op" id="8075436">,</span>&nbsp;<span class="ident" id="8075438"><a href="/image/jpeg/writer_test.go.html#8075381">name</a></span><span class="op" id="8075442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075447">for</span>&nbsp;<span class="ident" id="8075451">zig</span>&nbsp;<span class="op" id="8075455">:=</span>&nbsp;<span class="num" id="8075458">0</span><span class="op" id="8075459">;</span>&nbsp;<span class="ident" id="8075461"><a href="/image/jpeg/writer_test.go.html#8075451">zig</a></span>&nbsp;<span class="op" id="8075465">&lt;</span>&nbsp;<span class="ident" id="8075467"><a href="/image/jpeg/idct.go.html#3131898">blockSize</a></span><span class="op" id="8075476">;</span>&nbsp;<span class="ident" id="8075478"><a href="/image/jpeg/writer_test.go.html#8075451">zig</a></span><span class="op" id="8075481">++</span>&nbsp;<span class="op" id="8075484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075490"><a href="/image/jpeg/writer_test.go.html#8073320">fmt</a></span><span class="op" id="8075493">.</span><span class="ident" id="8075494">Fprintf</span><span class="op" id="8075501">(</span><span class="ident" id="8075502"><a href="/image/jpeg/writer_test.go.html#8075349">buf</a></span><span class="op" id="8075505">,</span>&nbsp;<span class="string" id="8075507">&#34;%d,&nbsp;&#34;</span><span class="op" id="8075513">,</span>&nbsp;<span class="ident" id="8075515"><a href="/image/jpeg/writer_test.go.html#8074274">unscaledQuantInNaturalOrder</a></span><span class="op" id="8075542">[</span><span class="ident" id="8075543"><a href="/image/jpeg/writer_test.go.html#8075378">i</a></span><span class="op" id="8075544">]</span><span class="op" id="8075545">[</span><span class="ident" id="8075546"><a href="/image/jpeg/reader.go.html#3137806">unzig</a></span><span class="op" id="8075551">[</span><span class="ident" id="8075552"><a href="/image/jpeg/writer_test.go.html#8075451">zig</a></span><span class="op" id="8075555">]</span><span class="op" id="8075556">]</span><span class="op" id="8075557">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8075563">if</span>&nbsp;<span class="ident" id="8075566"><a href="/image/jpeg/writer_test.go.html#8075451">zig</a></span><span class="op" id="8075569">%</span><span class="num" id="8075570">8</span>&nbsp;<span class="op" id="8075572">==</span>&nbsp;<span class="num" id="8075575">7</span>&nbsp;<span class="op" id="8075577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075584"><a href="/image/jpeg/writer_test.go.html#8075349">buf</a></span><span class="op" id="8075587">.</span><span class="ident" id="8075588">WriteString</span><span class="op" id="8075599">(</span><span class="string" id="8075600">&#34;\n&#34;</span><span class="op" id="8075604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075620"><a href="/image/jpeg/writer_test.go.html#8075349">buf</a></span><span class="op" id="8075623">.</span><span class="ident" id="8075624">WriteString</span><span class="op" id="8075635">(</span><span class="string" id="8075636">&#34;},\n&#34;</span><span class="op" id="8075642">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075650"><a href="/image/jpeg/writer_test.go.html#8074961">t</a></span><span class="op" id="8075651">.</span><span class="ident" id="8075652">Logf</span><span class="op" id="8075656">(</span><span class="string" id="8075657">&#34;expected&nbsp;unscaledQuant&nbsp;values:\n%s&#34;</span><span class="op" id="8075693">,</span>&nbsp;<span class="ident" id="8075695"><a href="/image/jpeg/writer_test.go.html#8075349">buf</a></span><span class="op" id="8075698">.</span><span class="ident" id="8075699">String</span><span class="op" id="8075705">(</span><span class="op" id="8075706">)</span><span class="op" id="8075707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075710">}</span><br>
<span class="lineno"></span><span class="op" id="8075712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="8075715">var</span>&nbsp;<span class="ident" id="8075719">testCase</span>&nbsp;<span class="op" id="8075728">=</span>&nbsp;<span class="op" id="8075730">[</span><span class="op" id="8075731">]</span><span class="keyword" id="8075732">struct</span>&nbsp;<span class="op" id="8075739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075742">filename</span>&nbsp;&nbsp;<span class="builtintype" id="8075752">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075760">quality</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8075770">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8075775">tolerance</span>&nbsp;<span class="ident" id="8075785">int64</span><br>
<span class="lineno"></span><span class="op" id="8075791">}</span><span class="op" id="8075792">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075795">{</span><span class="string" id="8075796">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8075823">,</span>&nbsp;<span class="num" id="8075825">1</span><span class="op" id="8075826">,</span>&nbsp;<span class="num" id="8075828">24</span>&nbsp;<span class="op" id="8075831">&lt;&lt;</span>&nbsp;<span class="num" id="8075834">8</span><span class="op" id="8075835">}</span><span class="op" id="8075836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075839">{</span><span class="string" id="8075840">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8075867">,</span>&nbsp;<span class="num" id="8075869">20</span><span class="op" id="8075871">,</span>&nbsp;<span class="num" id="8075873">12</span>&nbsp;<span class="op" id="8075876">&lt;&lt;</span>&nbsp;<span class="num" id="8075879">8</span><span class="op" id="8075880">}</span><span class="op" id="8075881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075884">{</span><span class="string" id="8075885">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8075912">,</span>&nbsp;<span class="num" id="8075914">60</span><span class="op" id="8075916">,</span>&nbsp;<span class="num" id="8075918">8</span>&nbsp;<span class="op" id="8075920">&lt;&lt;</span>&nbsp;<span class="num" id="8075923">8</span><span class="op" id="8075924">}</span><span class="op" id="8075925">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075928">{</span><span class="string" id="8075929">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8075956">,</span>&nbsp;<span class="num" id="8075958">80</span><span class="op" id="8075960">,</span>&nbsp;<span class="num" id="8075962">6</span>&nbsp;<span class="op" id="8075964">&lt;&lt;</span>&nbsp;<span class="num" id="8075967">8</span><span class="op" id="8075968">}</span><span class="op" id="8075969">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8075972">{</span><span class="string" id="8075973">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8076000">,</span>&nbsp;<span class="num" id="8076002">90</span><span class="op" id="8076004">,</span>&nbsp;<span class="num" id="8076006">4</span>&nbsp;<span class="op" id="8076008">&lt;&lt;</span>&nbsp;<span class="num" id="8076011">8</span><span class="op" id="8076012">}</span><span class="op" id="8076013">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076016">{</span><span class="string" id="8076017">&#34;../testdata/video-001.png&#34;</span><span class="op" id="8076044">,</span>&nbsp;<span class="num" id="8076046">100</span><span class="op" id="8076049">,</span>&nbsp;<span class="num" id="8076051">2</span>&nbsp;<span class="op" id="8076053">&lt;&lt;</span>&nbsp;<span class="num" id="8076056">8</span><span class="op" id="8076057">}</span><span class="op" id="8076058">,</span><br>
<span class="lineno"></span><span class="op" id="8076060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8076063">func</span>&nbsp;<span class="ident" id="8076068">delta</span><span class="op" id="8076073">(</span><span class="ident" id="8076074">u0</span><span class="op" id="8076076">,</span>&nbsp;<span class="ident" id="8076078">u1</span>&nbsp;<span class="builtintype" id="8076081">uint32</span><span class="op" id="8076087">)</span>&nbsp;<span class="ident" id="8076089">int64</span>&nbsp;<span class="op" id="8076095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076098">d</span>&nbsp;<span class="op" id="8076100">:=</span>&nbsp;<span class="ident" id="8076103">int64</span><span class="op" id="8076108">(</span><span class="ident" id="8076109"><a href="/image/jpeg/writer_test.go.html#8076074">u0</a></span><span class="op" id="8076111">)</span>&nbsp;<span class="op" id="8076113">-</span>&nbsp;<span class="ident" id="8076115">int64</span><span class="op" id="8076120">(</span><span class="ident" id="8076121"><a href="/image/jpeg/writer_test.go.html#8076078">u1</a></span><span class="op" id="8076123">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076126">if</span>&nbsp;<span class="ident" id="8076129"><a href="/image/jpeg/writer_test.go.html#8076098">d</a></span>&nbsp;<span class="op" id="8076131">&lt;</span>&nbsp;<span class="num" id="8076133">0</span>&nbsp;<span class="op" id="8076135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076139">return</span>&nbsp;<span class="op" id="8076146">-</span><span class="ident" id="8076147"><a href="/image/jpeg/writer_test.go.html#8076098">d</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076153">return</span>&nbsp;<span class="ident" id="8076160"><a href="/image/jpeg/writer_test.go.html#8076098">d</a></span><br>
<span class="lineno"></span><span class="op" id="8076162">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="8076165">func</span>&nbsp;<span class="ident" id="8076170">readPng</span><span class="op" id="8076177">(</span><span class="ident" id="8076178">filename</span>&nbsp;<span class="builtintype" id="8076187">string</span><span class="op" id="8076193">)</span>&nbsp;<span class="op" id="8076195">(</span><span class="ident" id="8076196"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8076201">.</span><span class="ident" id="8076202">Image</span><span class="op" id="8076207">,</span>&nbsp;<span class="builtintype" id="8076209">error</span><span class="op" id="8076214">)</span>&nbsp;<span class="op" id="8076216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076219">f</span><span class="op" id="8076220">,</span>&nbsp;<span class="ident" id="8076222">err</span>&nbsp;<span class="op" id="8076226">:=</span>&nbsp;<span class="ident" id="8076229"><a href="/image/jpeg/writer_test.go.html#8073390">os</a></span><span class="op" id="8076231">.</span><span class="ident" id="8076232">Open</span><span class="op" id="8076236">(</span><span class="ident" id="8076237"><a href="/image/jpeg/writer_test.go.html#8076178">filename</a></span><span class="op" id="8076245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076248">if</span>&nbsp;<span class="ident" id="8076251"><a href="/image/jpeg/writer_test.go.html#8076222">err</a></span>&nbsp;<span class="op" id="8076255">!=</span>&nbsp;<span class="ident" id="8076258">nil</span>&nbsp;<span class="op" id="8076262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076266">return</span>&nbsp;<span class="ident" id="8076273">nil</span><span class="op" id="8076276">,</span>&nbsp;<span class="ident" id="8076278"><a href="/image/jpeg/writer_test.go.html#8076222">err</a></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076286">defer</span>&nbsp;<span class="ident" id="8076292"><a href="/image/jpeg/writer_test.go.html#8076219">f</a></span><span class="op" id="8076293">.</span><span class="ident" id="8076294">Close</span><span class="op" id="8076299">(</span><span class="op" id="8076300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076303">return</span>&nbsp;<span class="ident" id="8076310"><a href="/image/jpeg/writer_test.go.html#8073351">png</a></span><span class="op" id="8076313">.</span><span class="ident" id="8076314">Decode</span><span class="op" id="8076320">(</span><span class="ident" id="8076321"><a href="/image/jpeg/writer_test.go.html#8076219">f</a></span><span class="op" id="8076322">)</span><br>
<span class="lineno"></span><span class="op" id="8076324">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="8076327">func</span>&nbsp;<span class="ident" id="8076332">TestWriter</span><span class="op" id="8076342">(</span><span class="ident" id="8076343">t</span>&nbsp;<span class="op" id="8076345">*</span><span class="ident" id="8076346"><a href="/image/jpeg/writer_test.go.html#8073396">testing</a></span><span class="op" id="8076353">.</span><span class="ident" id="8076354">T</span><span class="op" id="8076355">)</span>&nbsp;<span class="op" id="8076357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076360">for</span>&nbsp;<span class="ident" id="8076364">_</span><span class="op" id="8076365">,</span>&nbsp;<span class="ident" id="8076367">tc</span>&nbsp;<span class="op" id="8076370">:=</span>&nbsp;<span class="keyword" id="8076373">range</span>&nbsp;<span class="ident" id="8076379"><a href="/image/jpeg/writer_test.go.html#8075719">testCase</a></span>&nbsp;<span class="op" id="8076388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8076392">//&nbsp;Read&nbsp;the&nbsp;image.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076413">m0</span><span class="op" id="8076415">,</span>&nbsp;<span class="ident" id="8076417">err</span>&nbsp;<span class="op" id="8076421">:=</span>&nbsp;<span class="ident" id="8076424"><a href="/image/jpeg/writer_test.go.html#8076170">readPng</a></span><span class="op" id="8076431">(</span><span class="ident" id="8076432"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076434">.</span><span class="ident" id="8076435">filename</span><span class="op" id="8076443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076447">if</span>&nbsp;<span class="ident" id="8076450"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span>&nbsp;<span class="op" id="8076454">!=</span>&nbsp;<span class="ident" id="8076457">nil</span>&nbsp;<span class="op" id="8076461">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076466"><a href="/image/jpeg/writer_test.go.html#8076343">t</a></span><span class="op" id="8076467">.</span><span class="ident" id="8076468">Error</span><span class="op" id="8076473">(</span><span class="ident" id="8076474"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076476">.</span><span class="ident" id="8076477">filename</span><span class="op" id="8076485">,</span>&nbsp;<span class="ident" id="8076487"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span><span class="op" id="8076490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076495">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8076510">//&nbsp;Encode&nbsp;that&nbsp;image&nbsp;as&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076542">var</span>&nbsp;<span class="ident" id="8076546">buf</span>&nbsp;<span class="ident" id="8076550"><a href="/image/jpeg/writer_test.go.html#8073311">bytes</a></span><span class="op" id="8076555">.</span><span class="ident" id="8076556">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076565"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span>&nbsp;<span class="op" id="8076569">=</span>&nbsp;<span class="ident" id="8076571"><a href="/image/jpeg/writer.go.html#3179028">Encode</a></span><span class="op" id="8076577">(</span><span class="op" id="8076578">&amp;</span><span class="ident" id="8076579"><a href="/image/jpeg/writer_test.go.html#8076546">buf</a></span><span class="op" id="8076582">,</span>&nbsp;<span class="ident" id="8076584"><a href="/image/jpeg/writer_test.go.html#8076413">m0</a></span><span class="op" id="8076586">,</span>&nbsp;<span class="op" id="8076588">&amp;</span><span class="ident" id="8076589"><a href="/image/jpeg/writer.go.html#3178842">Options</a></span><span class="op" id="8076596">{</span><span class="ident" id="8076597">Quality</span><span class="op" id="8076604">:</span>&nbsp;<span class="ident" id="8076606"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076608">.</span><span class="ident" id="8076609">quality</span><span class="op" id="8076616">}</span><span class="op" id="8076617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076621">if</span>&nbsp;<span class="ident" id="8076624"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span>&nbsp;<span class="op" id="8076628">!=</span>&nbsp;<span class="ident" id="8076631">nil</span>&nbsp;<span class="op" id="8076635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076640"><a href="/image/jpeg/writer_test.go.html#8076343">t</a></span><span class="op" id="8076641">.</span><span class="ident" id="8076642">Error</span><span class="op" id="8076647">(</span><span class="ident" id="8076648"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076650">.</span><span class="ident" id="8076651">filename</span><span class="op" id="8076659">,</span>&nbsp;<span class="ident" id="8076661"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span><span class="op" id="8076664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076669">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076680">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8076684">//&nbsp;Decode&nbsp;that&nbsp;JPEG.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076707">m1</span><span class="op" id="8076709">,</span>&nbsp;<span class="ident" id="8076711"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span>&nbsp;<span class="op" id="8076715">:=</span>&nbsp;<span class="ident" id="8076718"><a href="/image/jpeg/reader.go.html#3150112">Decode</a></span><span class="op" id="8076724">(</span><span class="op" id="8076725">&amp;</span><span class="ident" id="8076726"><a href="/image/jpeg/writer_test.go.html#8076546">buf</a></span><span class="op" id="8076729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076733">if</span>&nbsp;<span class="ident" id="8076736"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span>&nbsp;<span class="op" id="8076740">!=</span>&nbsp;<span class="ident" id="8076743">nil</span>&nbsp;<span class="op" id="8076747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076752"><a href="/image/jpeg/writer_test.go.html#8076343">t</a></span><span class="op" id="8076753">.</span><span class="ident" id="8076754">Error</span><span class="op" id="8076759">(</span><span class="ident" id="8076760"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076762">.</span><span class="ident" id="8076763">filename</span><span class="op" id="8076771">,</span>&nbsp;<span class="ident" id="8076773"><a href="/image/jpeg/writer_test.go.html#8076417">err</a></span><span class="op" id="8076776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076781">continue</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076796">if</span>&nbsp;<span class="ident" id="8076799"><a href="/image/jpeg/writer_test.go.html#8076413">m0</a></span><span class="op" id="8076801">.</span><span class="ident" id="8076802">Bounds</span><span class="op" id="8076808">(</span><span class="op" id="8076809">)</span>&nbsp;<span class="op" id="8076811">!=</span>&nbsp;<span class="ident" id="8076814"><a href="/image/jpeg/writer_test.go.html#8076707">m1</a></span><span class="op" id="8076816">.</span><span class="ident" id="8076817">Bounds</span><span class="op" id="8076823">(</span><span class="op" id="8076824">)</span>&nbsp;<span class="op" id="8076826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8076831"><a href="/image/jpeg/writer_test.go.html#8076343">t</a></span><span class="op" id="8076832">.</span><span class="ident" id="8076833">Errorf</span><span class="op" id="8076839">(</span><span class="string" id="8076840">&#34;%s,&nbsp;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="8076870">,</span>&nbsp;<span class="ident" id="8076872"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8076874">.</span><span class="ident" id="8076875">filename</span><span class="op" id="8076883">,</span>&nbsp;<span class="ident" id="8076885"><a href="/image/jpeg/writer_test.go.html#8076413">m0</a></span><span class="op" id="8076887">.</span><span class="ident" id="8076888">Bounds</span><span class="op" id="8076894">(</span><span class="op" id="8076895">)</span><span class="op" id="8076896">,</span>&nbsp;<span class="ident" id="8076898"><a href="/image/jpeg/writer_test.go.html#8076707">m1</a></span><span class="op" id="8076900">.</span><span class="ident" id="8076901">Bounds</span><span class="op" id="8076907">(</span><span class="op" id="8076908">)</span><span class="op" id="8076909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076914">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8076925">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8076929">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8076984">if</span>&nbsp;<span class="ident" id="8076987"><a href="/image/jpeg/writer_test.go.html#8078007">averageDelta</a></span><span class="op" id="8076999">(</span><span class="ident" id="8077000"><a href="/image/jpeg/writer_test.go.html#8076413">m0</a></span><span class="op" id="8077002">,</span>&nbsp;<span class="ident" id="8077004"><a href="/image/jpeg/writer_test.go.html#8076707">m1</a></span><span class="op" id="8077006">)</span>&nbsp;<span class="op" id="8077008">&gt;</span>&nbsp;<span class="ident" id="8077010"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8077012">.</span><span class="ident" id="8077013">tolerance</span>&nbsp;<span class="op" id="8077023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077028"><a href="/image/jpeg/writer_test.go.html#8076343">t</a></span><span class="op" id="8077029">.</span><span class="ident" id="8077030">Errorf</span><span class="op" id="8077036">(</span><span class="string" id="8077037">&#34;%s,&nbsp;quality=%d:&nbsp;average&nbsp;delta&nbsp;is&nbsp;too&nbsp;high&#34;</span><span class="op" id="8077080">,</span>&nbsp;<span class="ident" id="8077082"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8077084">.</span><span class="ident" id="8077085">filename</span><span class="op" id="8077093">,</span>&nbsp;<span class="ident" id="8077095"><a href="/image/jpeg/writer_test.go.html#8076367">tc</a></span><span class="op" id="8077097">.</span><span class="ident" id="8077098">quality</span><span class="op" id="8077105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077110">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077121">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077124">}</span><br>
<span class="lineno"></span><span class="op" id="8077126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8077129">//&nbsp;TestWriteGrayscale&nbsp;tests&nbsp;that&nbsp;a&nbsp;grayscale&nbsp;images&nbsp;survives&nbsp;a&nbsp;round-trip</span><br>
<span class="lineno"></span><span class="comment" id="8077203">//&nbsp;through&nbsp;encode/decode&nbsp;cycle.</span><br>
<span class="lineno">165</span><span class="keyword" id="8077235">func</span>&nbsp;<span class="ident" id="8077240">TestWriteGrayscale</span><span class="op" id="8077258">(</span><span class="ident" id="8077259">t</span>&nbsp;<span class="op" id="8077261">*</span><span class="ident" id="8077262"><a href="/image/jpeg/writer_test.go.html#8073396">testing</a></span><span class="op" id="8077269">.</span><span class="ident" id="8077270">T</span><span class="op" id="8077271">)</span>&nbsp;<span class="op" id="8077273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077276">m0</span>&nbsp;<span class="op" id="8077279">:=</span>&nbsp;<span class="ident" id="8077282"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8077287">.</span><span class="ident" id="8077288">NewGray</span><span class="op" id="8077295">(</span><span class="ident" id="8077296"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8077301">.</span><span class="ident" id="8077302">Rect</span><span class="op" id="8077306">(</span><span class="num" id="8077307">0</span><span class="op" id="8077308">,</span>&nbsp;<span class="num" id="8077310">0</span><span class="op" id="8077311">,</span>&nbsp;<span class="num" id="8077313">32</span><span class="op" id="8077315">,</span>&nbsp;<span class="num" id="8077317">32</span><span class="op" id="8077319">)</span><span class="op" id="8077320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077323">for</span>&nbsp;<span class="ident" id="8077327">i</span>&nbsp;<span class="op" id="8077329">:=</span>&nbsp;<span class="keyword" id="8077332">range</span>&nbsp;<span class="ident" id="8077338"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077340">.</span><span class="ident" id="8077341">Pix</span>&nbsp;<span class="op" id="8077345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077349"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077351">.</span><span class="ident" id="8077352">Pix</span><span class="op" id="8077355">[</span><span class="ident" id="8077356"><a href="/image/jpeg/writer_test.go.html#8077327">i</a></span><span class="op" id="8077357">]</span>&nbsp;<span class="op" id="8077359">=</span>&nbsp;<span class="builtintype" id="8077361">uint8</span><span class="op" id="8077366">(</span><span class="ident" id="8077367"><a href="/image/jpeg/writer_test.go.html#8077327">i</a></span><span class="op" id="8077368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077371">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077374">var</span>&nbsp;<span class="ident" id="8077378">buf</span>&nbsp;<span class="ident" id="8077382"><a href="/image/jpeg/writer_test.go.html#8073311">bytes</a></span><span class="op" id="8077387">.</span><span class="ident" id="8077388">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077396">if</span>&nbsp;<span class="ident" id="8077399">err</span>&nbsp;<span class="op" id="8077403">:=</span>&nbsp;<span class="ident" id="8077406"><a href="/image/jpeg/writer.go.html#3179028">Encode</a></span><span class="op" id="8077412">(</span><span class="op" id="8077413">&amp;</span><span class="ident" id="8077414"><a href="/image/jpeg/writer_test.go.html#8077378">buf</a></span><span class="op" id="8077417">,</span>&nbsp;<span class="ident" id="8077419"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077421">,</span>&nbsp;<span class="ident" id="8077423">nil</span><span class="op" id="8077426">)</span><span class="op" id="8077427">;</span>&nbsp;<span class="ident" id="8077429"><a href="/image/jpeg/writer_test.go.html#8077399">err</a></span>&nbsp;<span class="op" id="8077433">!=</span>&nbsp;<span class="ident" id="8077436">nil</span>&nbsp;<span class="op" id="8077440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077444"><a href="/image/jpeg/writer_test.go.html#8077259">t</a></span><span class="op" id="8077445">.</span><span class="ident" id="8077446">Fatal</span><span class="op" id="8077451">(</span><span class="ident" id="8077452"><a href="/image/jpeg/writer_test.go.html#8077399">err</a></span><span class="op" id="8077455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077461">m1</span><span class="op" id="8077463">,</span>&nbsp;<span class="ident" id="8077465">err</span>&nbsp;<span class="op" id="8077469">:=</span>&nbsp;<span class="ident" id="8077472"><a href="/image/jpeg/reader.go.html#3150112">Decode</a></span><span class="op" id="8077478">(</span><span class="op" id="8077479">&amp;</span><span class="ident" id="8077480"><a href="/image/jpeg/writer_test.go.html#8077378">buf</a></span><span class="op" id="8077483">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077486">if</span>&nbsp;<span class="ident" id="8077489"><a href="/image/jpeg/writer_test.go.html#8077465">err</a></span>&nbsp;<span class="op" id="8077493">!=</span>&nbsp;<span class="ident" id="8077496">nil</span>&nbsp;<span class="op" id="8077500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077504"><a href="/image/jpeg/writer_test.go.html#8077259">t</a></span><span class="op" id="8077505">.</span><span class="ident" id="8077506">Fatal</span><span class="op" id="8077511">(</span><span class="ident" id="8077512"><a href="/image/jpeg/writer_test.go.html#8077465">err</a></span><span class="op" id="8077515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077521">if</span>&nbsp;<span class="ident" id="8077524"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077526">.</span><span class="ident" id="8077527">Bounds</span><span class="op" id="8077533">(</span><span class="op" id="8077534">)</span>&nbsp;<span class="op" id="8077536">!=</span>&nbsp;<span class="ident" id="8077539"><a href="/image/jpeg/writer_test.go.html#8077461">m1</a></span><span class="op" id="8077541">.</span><span class="ident" id="8077542">Bounds</span><span class="op" id="8077548">(</span><span class="op" id="8077549">)</span>&nbsp;<span class="op" id="8077551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077555"><a href="/image/jpeg/writer_test.go.html#8077259">t</a></span><span class="op" id="8077556">.</span><span class="ident" id="8077557">Fatalf</span><span class="op" id="8077563">(</span><span class="string" id="8077564">&#34;bounds&nbsp;differ:&nbsp;%v&nbsp;and&nbsp;%v&#34;</span><span class="op" id="8077590">,</span>&nbsp;<span class="ident" id="8077592"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077594">.</span><span class="ident" id="8077595">Bounds</span><span class="op" id="8077601">(</span><span class="op" id="8077602">)</span><span class="op" id="8077603">,</span>&nbsp;<span class="ident" id="8077605"><a href="/image/jpeg/writer_test.go.html#8077461">m1</a></span><span class="op" id="8077607">.</span><span class="ident" id="8077608">Bounds</span><span class="op" id="8077614">(</span><span class="op" id="8077615">)</span><span class="op" id="8077616">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077622">if</span>&nbsp;<span class="ident" id="8077625">_</span><span class="op" id="8077626">,</span>&nbsp;<span class="ident" id="8077628">ok</span>&nbsp;<span class="op" id="8077631">:=</span>&nbsp;<span class="ident" id="8077634"><a href="/image/jpeg/writer_test.go.html#8077461">m1</a></span><span class="op" id="8077636">.</span><span class="op" id="8077637">(</span><span class="op" id="8077638">*</span><span class="ident" id="8077639"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8077644">.</span><span class="ident" id="8077645">Gray</span><span class="op" id="8077649">)</span><span class="op" id="8077650">;</span>&nbsp;<span class="op" id="8077652">!</span><span class="ident" id="8077653"><a href="/image/jpeg/writer_test.go.html#8077628">ok</a></span>&nbsp;<span class="op" id="8077656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077660"><a href="/image/jpeg/writer_test.go.html#8077259">t</a></span><span class="op" id="8077661">.</span><span class="ident" id="8077662">Errorf</span><span class="op" id="8077668">(</span><span class="string" id="8077669">&#34;got&nbsp;%T,&nbsp;want&nbsp;*image.Gray&#34;</span><span class="op" id="8077695">,</span>&nbsp;<span class="ident" id="8077697"><a href="/image/jpeg/writer_test.go.html#8077461">m1</a></span><span class="op" id="8077699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8077705">//&nbsp;Compare&nbsp;the&nbsp;average&nbsp;delta&nbsp;to&nbsp;the&nbsp;tolerance&nbsp;level.</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077759">want</span>&nbsp;<span class="op" id="8077764">:=</span>&nbsp;<span class="ident" id="8077767">int64</span><span class="op" id="8077772">(</span><span class="num" id="8077773">2</span>&nbsp;<span class="op" id="8077775">&lt;&lt;</span>&nbsp;<span class="num" id="8077778">8</span><span class="op" id="8077779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8077782">if</span>&nbsp;<span class="ident" id="8077785">got</span>&nbsp;<span class="op" id="8077789">:=</span>&nbsp;<span class="ident" id="8077792"><a href="/image/jpeg/writer_test.go.html#8078007">averageDelta</a></span><span class="op" id="8077804">(</span><span class="ident" id="8077805"><a href="/image/jpeg/writer_test.go.html#8077276">m0</a></span><span class="op" id="8077807">,</span>&nbsp;<span class="ident" id="8077809"><a href="/image/jpeg/writer_test.go.html#8077461">m1</a></span><span class="op" id="8077811">)</span><span class="op" id="8077812">;</span>&nbsp;<span class="ident" id="8077814"><a href="/image/jpeg/writer_test.go.html#8077785">got</a></span>&nbsp;<span class="op" id="8077818">&gt;</span>&nbsp;<span class="ident" id="8077820"><a href="/image/jpeg/writer_test.go.html#8077759">want</a></span>&nbsp;<span class="op" id="8077825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8077829"><a href="/image/jpeg/writer_test.go.html#8077259">t</a></span><span class="op" id="8077830">.</span><span class="ident" id="8077831">Errorf</span><span class="op" id="8077837">(</span><span class="string" id="8077838">&#34;average&nbsp;delta&nbsp;too&nbsp;high;&nbsp;got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&#34;</span><span class="op" id="8077882">,</span>&nbsp;<span class="ident" id="8077884"><a href="/image/jpeg/writer_test.go.html#8077785">got</a></span><span class="op" id="8077887">,</span>&nbsp;<span class="ident" id="8077889"><a href="/image/jpeg/writer_test.go.html#8077759">want</a></span><span class="op" id="8077893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8077896">}</span><br>
<span class="lineno"></span><span class="op" id="8077898">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="8077901">//&nbsp;averageDelta&nbsp;returns&nbsp;the&nbsp;average&nbsp;delta&nbsp;in&nbsp;RGB&nbsp;space.&nbsp;The&nbsp;two&nbsp;images&nbsp;must</span><br>
<span class="lineno"></span><span class="comment" id="8077977">//&nbsp;have&nbsp;the&nbsp;same&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="keyword" id="8078002">func</span>&nbsp;<span class="ident" id="8078007">averageDelta</span><span class="op" id="8078019">(</span><span class="ident" id="8078020">m0</span><span class="op" id="8078022">,</span>&nbsp;<span class="ident" id="8078024">m1</span>&nbsp;<span class="ident" id="8078027"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8078032">.</span><span class="ident" id="8078033">Image</span><span class="op" id="8078038">)</span>&nbsp;<span class="ident" id="8078040">int64</span>&nbsp;<span class="op" id="8078046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078049">b</span>&nbsp;<span class="op" id="8078051">:=</span>&nbsp;<span class="ident" id="8078054"><a href="/image/jpeg/writer_test.go.html#8078020">m0</a></span><span class="op" id="8078056">.</span><span class="ident" id="8078057">Bounds</span><span class="op" id="8078063">(</span><span class="op" id="8078064">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078067">var</span>&nbsp;<span class="ident" id="8078071">sum</span><span class="op" id="8078074">,</span>&nbsp;<span class="ident" id="8078076">n</span>&nbsp;<span class="ident" id="8078078">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078085">for</span>&nbsp;<span class="ident" id="8078089">y</span>&nbsp;<span class="op" id="8078091">:=</span>&nbsp;<span class="ident" id="8078094"><a href="/image/jpeg/writer_test.go.html#8078049">b</a></span><span class="op" id="8078095">.</span><span class="ident" id="8078096">Min</span><span class="op" id="8078099">.</span><span class="ident" id="8078100">Y</span><span class="op" id="8078101">;</span>&nbsp;<span class="ident" id="8078103"><a href="/image/jpeg/writer_test.go.html#8078089">y</a></span>&nbsp;<span class="op" id="8078105">&lt;</span>&nbsp;<span class="ident" id="8078107"><a href="/image/jpeg/writer_test.go.html#8078049">b</a></span><span class="op" id="8078108">.</span><span class="ident" id="8078109">Max</span><span class="op" id="8078112">.</span><span class="ident" id="8078113">Y</span><span class="op" id="8078114">;</span>&nbsp;<span class="ident" id="8078116"><a href="/image/jpeg/writer_test.go.html#8078089">y</a></span><span class="op" id="8078117">++</span>&nbsp;<span class="op" id="8078120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078124">for</span>&nbsp;<span class="ident" id="8078128">x</span>&nbsp;<span class="op" id="8078130">:=</span>&nbsp;<span class="ident" id="8078133"><a href="/image/jpeg/writer_test.go.html#8078049">b</a></span><span class="op" id="8078134">.</span><span class="ident" id="8078135">Min</span><span class="op" id="8078138">.</span><span class="ident" id="8078139">X</span><span class="op" id="8078140">;</span>&nbsp;<span class="ident" id="8078142"><a href="/image/jpeg/writer_test.go.html#8078128">x</a></span>&nbsp;<span class="op" id="8078144">&lt;</span>&nbsp;<span class="ident" id="8078146"><a href="/image/jpeg/writer_test.go.html#8078049">b</a></span><span class="op" id="8078147">.</span><span class="ident" id="8078148">Max</span><span class="op" id="8078151">.</span><span class="ident" id="8078152">X</span><span class="op" id="8078153">;</span>&nbsp;<span class="ident" id="8078155"><a href="/image/jpeg/writer_test.go.html#8078128">x</a></span><span class="op" id="8078156">++</span>&nbsp;<span class="op" id="8078159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078164">c0</span>&nbsp;<span class="op" id="8078167">:=</span>&nbsp;<span class="ident" id="8078170"><a href="/image/jpeg/writer_test.go.html#8078020">m0</a></span><span class="op" id="8078172">.</span><span class="ident" id="8078173">At</span><span class="op" id="8078175">(</span><span class="ident" id="8078176"><a href="/image/jpeg/writer_test.go.html#8078128">x</a></span><span class="op" id="8078177">,</span>&nbsp;<span class="ident" id="8078179"><a href="/image/jpeg/writer_test.go.html#8078089">y</a></span><span class="op" id="8078180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078185">c1</span>&nbsp;<span class="op" id="8078188">:=</span>&nbsp;<span class="ident" id="8078191"><a href="/image/jpeg/writer_test.go.html#8078024">m1</a></span><span class="op" id="8078193">.</span><span class="ident" id="8078194">At</span><span class="op" id="8078196">(</span><span class="ident" id="8078197"><a href="/image/jpeg/writer_test.go.html#8078128">x</a></span><span class="op" id="8078198">,</span>&nbsp;<span class="ident" id="8078200"><a href="/image/jpeg/writer_test.go.html#8078089">y</a></span><span class="op" id="8078201">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078206">r0</span><span class="op" id="8078208">,</span>&nbsp;<span class="ident" id="8078210">g0</span><span class="op" id="8078212">,</span>&nbsp;<span class="ident" id="8078214">b0</span><span class="op" id="8078216">,</span>&nbsp;<span class="ident" id="8078218">_</span>&nbsp;<span class="op" id="8078220">:=</span>&nbsp;<span class="ident" id="8078223"><a href="/image/jpeg/writer_test.go.html#8078164">c0</a></span><span class="op" id="8078225">.</span><span class="ident" id="8078226">RGBA</span><span class="op" id="8078230">(</span><span class="op" id="8078231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078236">r1</span><span class="op" id="8078238">,</span>&nbsp;<span class="ident" id="8078240">g1</span><span class="op" id="8078242">,</span>&nbsp;<span class="ident" id="8078244">b1</span><span class="op" id="8078246">,</span>&nbsp;<span class="ident" id="8078248">_</span>&nbsp;<span class="op" id="8078250">:=</span>&nbsp;<span class="ident" id="8078253"><a href="/image/jpeg/writer_test.go.html#8078185">c1</a></span><span class="op" id="8078255">.</span><span class="ident" id="8078256">RGBA</span><span class="op" id="8078260">(</span><span class="op" id="8078261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078266"><a href="/image/jpeg/writer_test.go.html#8078071">sum</a></span>&nbsp;<span class="op" id="8078270">+=</span>&nbsp;<span class="ident" id="8078273"><a href="/image/jpeg/writer_test.go.html#8076068">delta</a></span><span class="op" id="8078278">(</span><span class="ident" id="8078279"><a href="/image/jpeg/writer_test.go.html#8078206">r0</a></span><span class="op" id="8078281">,</span>&nbsp;<span class="ident" id="8078283"><a href="/image/jpeg/writer_test.go.html#8078236">r1</a></span><span class="op" id="8078285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078290"><a href="/image/jpeg/writer_test.go.html#8078071">sum</a></span>&nbsp;<span class="op" id="8078294">+=</span>&nbsp;<span class="ident" id="8078297"><a href="/image/jpeg/writer_test.go.html#8076068">delta</a></span><span class="op" id="8078302">(</span><span class="ident" id="8078303"><a href="/image/jpeg/writer_test.go.html#8078210">g0</a></span><span class="op" id="8078305">,</span>&nbsp;<span class="ident" id="8078307"><a href="/image/jpeg/writer_test.go.html#8078240">g1</a></span><span class="op" id="8078309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078314"><a href="/image/jpeg/writer_test.go.html#8078071">sum</a></span>&nbsp;<span class="op" id="8078318">+=</span>&nbsp;<span class="ident" id="8078321"><a href="/image/jpeg/writer_test.go.html#8076068">delta</a></span><span class="op" id="8078326">(</span><span class="ident" id="8078327"><a href="/image/jpeg/writer_test.go.html#8078214">b0</a></span><span class="op" id="8078329">,</span>&nbsp;<span class="ident" id="8078331"><a href="/image/jpeg/writer_test.go.html#8078244">b1</a></span><span class="op" id="8078333">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078338"><a href="/image/jpeg/writer_test.go.html#8078076">n</a></span>&nbsp;<span class="op" id="8078340">+=</span>&nbsp;<span class="num" id="8078343">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078353">return</span>&nbsp;<span class="ident" id="8078360"><a href="/image/jpeg/writer_test.go.html#8078071">sum</a></span>&nbsp;<span class="op" id="8078364">/</span>&nbsp;<span class="ident" id="8078366"><a href="/image/jpeg/writer_test.go.html#8078076">n</a></span><br>
<span class="lineno"></span><span class="op" id="8078368">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="8078371">func</span>&nbsp;<span class="ident" id="8078376">BenchmarkEncode</span><span class="op" id="8078391">(</span><span class="ident" id="8078392">b</span>&nbsp;<span class="op" id="8078394">*</span><span class="ident" id="8078395"><a href="/image/jpeg/writer_test.go.html#8073396">testing</a></span><span class="op" id="8078402">.</span><span class="ident" id="8078403">B</span><span class="op" id="8078404">)</span>&nbsp;<span class="op" id="8078406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078409"><a href="/image/jpeg/writer_test.go.html#8078392">b</a></span><span class="op" id="8078410">.</span><span class="ident" id="8078411">StopTimer</span><span class="op" id="8078420">(</span><span class="op" id="8078421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078424">img</span>&nbsp;<span class="op" id="8078428">:=</span>&nbsp;<span class="ident" id="8078431"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8078436">.</span><span class="ident" id="8078437">NewRGBA</span><span class="op" id="8078444">(</span><span class="ident" id="8078445"><a href="/image/jpeg/writer_test.go.html#8073327">image</a></span><span class="op" id="8078450">.</span><span class="ident" id="8078451">Rect</span><span class="op" id="8078455">(</span><span class="num" id="8078456">0</span><span class="op" id="8078457">,</span>&nbsp;<span class="num" id="8078459">0</span><span class="op" id="8078460">,</span>&nbsp;<span class="num" id="8078462">640</span><span class="op" id="8078465">,</span>&nbsp;<span class="num" id="8078467">480</span><span class="op" id="8078470">)</span><span class="op" id="8078471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078474">bo</span>&nbsp;<span class="op" id="8078477">:=</span>&nbsp;<span class="ident" id="8078480"><a href="/image/jpeg/writer_test.go.html#8078424">img</a></span><span class="op" id="8078483">.</span><span class="ident" id="8078484">Bounds</span><span class="op" id="8078490">(</span><span class="op" id="8078491">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078494">rnd</span>&nbsp;<span class="op" id="8078498">:=</span>&nbsp;<span class="ident" id="8078501"><a href="/image/jpeg/writer_test.go.html#8073377">rand</a></span><span class="op" id="8078505">.</span><span class="ident" id="8078506">New</span><span class="op" id="8078509">(</span><span class="ident" id="8078510"><a href="/image/jpeg/writer_test.go.html#8073377">rand</a></span><span class="op" id="8078514">.</span><span class="ident" id="8078515">NewSource</span><span class="op" id="8078524">(</span><span class="num" id="8078525">123</span><span class="op" id="8078528">)</span><span class="op" id="8078529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078532">for</span>&nbsp;<span class="ident" id="8078536">y</span>&nbsp;<span class="op" id="8078538">:=</span>&nbsp;<span class="ident" id="8078541"><a href="/image/jpeg/writer_test.go.html#8078474">bo</a></span><span class="op" id="8078543">.</span><span class="ident" id="8078544">Min</span><span class="op" id="8078547">.</span><span class="ident" id="8078548">Y</span><span class="op" id="8078549">;</span>&nbsp;<span class="ident" id="8078551"><a href="/image/jpeg/writer_test.go.html#8078536">y</a></span>&nbsp;<span class="op" id="8078553">&lt;</span>&nbsp;<span class="ident" id="8078555"><a href="/image/jpeg/writer_test.go.html#8078474">bo</a></span><span class="op" id="8078557">.</span><span class="ident" id="8078558">Max</span><span class="op" id="8078561">.</span><span class="ident" id="8078562">Y</span><span class="op" id="8078563">;</span>&nbsp;<span class="ident" id="8078565"><a href="/image/jpeg/writer_test.go.html#8078536">y</a></span><span class="op" id="8078566">++</span>&nbsp;<span class="op" id="8078569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078573">for</span>&nbsp;<span class="ident" id="8078577">x</span>&nbsp;<span class="op" id="8078579">:=</span>&nbsp;<span class="ident" id="8078582"><a href="/image/jpeg/writer_test.go.html#8078474">bo</a></span><span class="op" id="8078584">.</span><span class="ident" id="8078585">Min</span><span class="op" id="8078588">.</span><span class="ident" id="8078589">X</span><span class="op" id="8078590">;</span>&nbsp;<span class="ident" id="8078592"><a href="/image/jpeg/writer_test.go.html#8078577">x</a></span>&nbsp;<span class="op" id="8078594">&lt;</span>&nbsp;<span class="ident" id="8078596"><a href="/image/jpeg/writer_test.go.html#8078474">bo</a></span><span class="op" id="8078598">.</span><span class="ident" id="8078599">Max</span><span class="op" id="8078602">.</span><span class="ident" id="8078603">X</span><span class="op" id="8078604">;</span>&nbsp;<span class="ident" id="8078606"><a href="/image/jpeg/writer_test.go.html#8078577">x</a></span><span class="op" id="8078607">++</span>&nbsp;<span class="op" id="8078610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078615"><a href="/image/jpeg/writer_test.go.html#8078424">img</a></span><span class="op" id="8078618">.</span><span class="ident" id="8078619">SetRGBA</span><span class="op" id="8078626">(</span><span class="ident" id="8078627"><a href="/image/jpeg/writer_test.go.html#8078577">x</a></span><span class="op" id="8078628">,</span>&nbsp;<span class="ident" id="8078630"><a href="/image/jpeg/writer_test.go.html#8078536">y</a></span><span class="op" id="8078631">,</span>&nbsp;<span class="ident" id="8078633"><a href="/image/jpeg/writer_test.go.html#8073336">color</a></span><span class="op" id="8078638">.</span><span class="ident" id="8078639">RGBA</span><span class="op" id="8078643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8078649">uint8</span><span class="op" id="8078654">(</span><span class="ident" id="8078655"><a href="/image/jpeg/writer_test.go.html#8078494">rnd</a></span><span class="op" id="8078658">.</span><span class="ident" id="8078659">Intn</span><span class="op" id="8078663">(</span><span class="num" id="8078664">256</span><span class="op" id="8078667">)</span><span class="op" id="8078668">)</span><span class="op" id="8078669">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8078675">uint8</span><span class="op" id="8078680">(</span><span class="ident" id="8078681"><a href="/image/jpeg/writer_test.go.html#8078494">rnd</a></span><span class="op" id="8078684">.</span><span class="ident" id="8078685">Intn</span><span class="op" id="8078689">(</span><span class="num" id="8078690">256</span><span class="op" id="8078693">)</span><span class="op" id="8078694">)</span><span class="op" id="8078695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="8078701">uint8</span><span class="op" id="8078706">(</span><span class="ident" id="8078707"><a href="/image/jpeg/writer_test.go.html#8078494">rnd</a></span><span class="op" id="8078710">.</span><span class="ident" id="8078711">Intn</span><span class="op" id="8078715">(</span><span class="num" id="8078716">256</span><span class="op" id="8078719">)</span><span class="op" id="8078720">)</span><span class="op" id="8078721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="8078727">255</span><span class="op" id="8078730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078735">}</span><span class="op" id="8078736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078740">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078746"><a href="/image/jpeg/writer_test.go.html#8078392">b</a></span><span class="op" id="8078747">.</span><span class="ident" id="8078748">SetBytes</span><span class="op" id="8078756">(</span><span class="num" id="8078757">640</span>&nbsp;<span class="op" id="8078761">*</span>&nbsp;<span class="num" id="8078763">480</span>&nbsp;<span class="op" id="8078767">*</span>&nbsp;<span class="num" id="8078769">4</span><span class="op" id="8078770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078773"><a href="/image/jpeg/writer_test.go.html#8078392">b</a></span><span class="op" id="8078774">.</span><span class="ident" id="8078775">StartTimer</span><span class="op" id="8078785">(</span><span class="op" id="8078786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078789">options</span>&nbsp;<span class="op" id="8078797">:=</span>&nbsp;<span class="op" id="8078800">&amp;</span><span class="ident" id="8078801"><a href="/image/jpeg/writer.go.html#3178842">Options</a></span><span class="op" id="8078808">{</span><span class="ident" id="8078809">Quality</span><span class="op" id="8078816">:</span>&nbsp;<span class="num" id="8078818">90</span><span class="op" id="8078820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8078823">for</span>&nbsp;<span class="ident" id="8078827">i</span>&nbsp;<span class="op" id="8078829">:=</span>&nbsp;<span class="num" id="8078832">0</span><span class="op" id="8078833">;</span>&nbsp;<span class="ident" id="8078835"><a href="/image/jpeg/writer_test.go.html#8078827">i</a></span>&nbsp;<span class="op" id="8078837">&lt;</span>&nbsp;<span class="ident" id="8078839"><a href="/image/jpeg/writer_test.go.html#8078392">b</a></span><span class="op" id="8078840">.</span><span class="ident" id="8078841">N</span><span class="op" id="8078842">;</span>&nbsp;<span class="ident" id="8078844"><a href="/image/jpeg/writer_test.go.html#8078827">i</a></span><span class="op" id="8078845">++</span>&nbsp;<span class="op" id="8078848">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8078852"><a href="/image/jpeg/writer.go.html#3179028">Encode</a></span><span class="op" id="8078858">(</span><span class="ident" id="8078859"><a href="/image/jpeg/writer_test.go.html#8073364">ioutil</a></span><span class="op" id="8078865">.</span><span class="ident" id="8078866">Discard</span><span class="op" id="8078873">,</span>&nbsp;<span class="ident" id="8078875"><a href="/image/jpeg/writer_test.go.html#8078424">img</a></span><span class="op" id="8078878">,</span>&nbsp;<span class="ident" id="8078880"><a href="/image/jpeg/writer_test.go.html#8078789">options</a></span><span class="op" id="8078887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8078890">}</span><br>
<span class="lineno"></span><span class="op" id="8078892">}</span>
</div>
</body>
</html>
