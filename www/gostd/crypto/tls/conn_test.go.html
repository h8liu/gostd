<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8153923">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8153978">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8154032">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8154083">package</span>&nbsp;<span class="ident" id="8154091">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8154096">import</span>&nbsp;<span class="op" id="8154103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8154106">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8154116">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="8154119">func</span>&nbsp;<span class="ident" id="8154124">TestRoundUp</span><span class="op" id="8154135">(</span><span class="ident" id="8154136">t</span>&nbsp;<span class="op" id="8154138">*</span><span class="ident" id="8154139">testing</span><span class="op" id="8154146">.</span><span class="ident" id="8154147">T</span><span class="op" id="8154148">)</span>&nbsp;<span class="op" id="8154150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8154153">if</span>&nbsp;<span class="ident" id="8154156">roundUp</span><span class="op" id="8154163">(</span><span class="num" id="8154164">0</span><span class="op" id="8154165">,</span>&nbsp;<span class="num" id="8154167">16</span><span class="op" id="8154169">)</span>&nbsp;<span class="op" id="8154171">!=</span>&nbsp;<span class="num" id="8154174">0</span>&nbsp;<span class="op" id="8154176">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154181">roundUp</span><span class="op" id="8154188">(</span><span class="num" id="8154189">1</span><span class="op" id="8154190">,</span>&nbsp;<span class="num" id="8154192">16</span><span class="op" id="8154194">)</span>&nbsp;<span class="op" id="8154196">!=</span>&nbsp;<span class="num" id="8154199">16</span>&nbsp;<span class="op" id="8154202">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154207">roundUp</span><span class="op" id="8154214">(</span><span class="num" id="8154215">15</span><span class="op" id="8154217">,</span>&nbsp;<span class="num" id="8154219">16</span><span class="op" id="8154221">)</span>&nbsp;<span class="op" id="8154223">!=</span>&nbsp;<span class="num" id="8154226">16</span>&nbsp;<span class="op" id="8154229">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154234">roundUp</span><span class="op" id="8154241">(</span><span class="num" id="8154242">16</span><span class="op" id="8154244">,</span>&nbsp;<span class="num" id="8154246">16</span><span class="op" id="8154248">)</span>&nbsp;<span class="op" id="8154250">!=</span>&nbsp;<span class="num" id="8154253">16</span>&nbsp;<span class="op" id="8154256">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154261">roundUp</span><span class="op" id="8154268">(</span><span class="num" id="8154269">17</span><span class="op" id="8154271">,</span>&nbsp;<span class="num" id="8154273">16</span><span class="op" id="8154275">)</span>&nbsp;<span class="op" id="8154277">!=</span>&nbsp;<span class="num" id="8154280">32</span>&nbsp;<span class="op" id="8154283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154287">t</span><span class="op" id="8154288">.</span><span class="ident" id="8154289">Error</span><span class="op" id="8154294">(</span><span class="string" id="8154295">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="8154311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154314">}</span><br>
<span class="lineno"></span><span class="op" id="8154316">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="8154319">var</span>&nbsp;<span class="ident" id="8154323">paddingTests</span>&nbsp;<span class="op" id="8154336">=</span>&nbsp;<span class="op" id="8154338">[</span><span class="op" id="8154339">]</span><span class="keyword" id="8154340">struct</span>&nbsp;<span class="op" id="8154347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154350">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8154362">[</span><span class="op" id="8154363">]</span><span class="builtintype" id="8154364">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154370">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8154382">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154388">expectedLen</span>&nbsp;<span class="builtintype" id="8154400">int</span><br>
<span class="lineno">25</span><span class="op" id="8154404">}</span><span class="op" id="8154405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154408">{</span><span class="op" id="8154409">[</span><span class="op" id="8154410">]</span><span class="builtintype" id="8154411">byte</span><span class="op" id="8154415">{</span><span class="num" id="8154416">1</span><span class="op" id="8154417">,</span>&nbsp;<span class="num" id="8154419">2</span><span class="op" id="8154420">,</span>&nbsp;<span class="num" id="8154422">3</span><span class="op" id="8154423">,</span>&nbsp;<span class="num" id="8154425">4</span><span class="op" id="8154426">,</span>&nbsp;<span class="num" id="8154428">0</span><span class="op" id="8154429">}</span><span class="op" id="8154430">,</span>&nbsp;<span class="builtintype" id="8154432">true</span><span class="op" id="8154436">,</span>&nbsp;<span class="num" id="8154438">4</span><span class="op" id="8154439">}</span><span class="op" id="8154440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154443">{</span><span class="op" id="8154444">[</span><span class="op" id="8154445">]</span><span class="builtintype" id="8154446">byte</span><span class="op" id="8154450">{</span><span class="num" id="8154451">1</span><span class="op" id="8154452">,</span>&nbsp;<span class="num" id="8154454">2</span><span class="op" id="8154455">,</span>&nbsp;<span class="num" id="8154457">3</span><span class="op" id="8154458">,</span>&nbsp;<span class="num" id="8154460">4</span><span class="op" id="8154461">,</span>&nbsp;<span class="num" id="8154463">0</span><span class="op" id="8154464">,</span>&nbsp;<span class="num" id="8154466">1</span><span class="op" id="8154467">}</span><span class="op" id="8154468">,</span>&nbsp;<span class="builtintype" id="8154470">false</span><span class="op" id="8154475">,</span>&nbsp;<span class="num" id="8154477">0</span><span class="op" id="8154478">}</span><span class="op" id="8154479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154482">{</span><span class="op" id="8154483">[</span><span class="op" id="8154484">]</span><span class="builtintype" id="8154485">byte</span><span class="op" id="8154489">{</span><span class="num" id="8154490">1</span><span class="op" id="8154491">,</span>&nbsp;<span class="num" id="8154493">2</span><span class="op" id="8154494">,</span>&nbsp;<span class="num" id="8154496">3</span><span class="op" id="8154497">,</span>&nbsp;<span class="num" id="8154499">4</span><span class="op" id="8154500">,</span>&nbsp;<span class="num" id="8154502">99</span><span class="op" id="8154504">,</span>&nbsp;<span class="num" id="8154506">99</span><span class="op" id="8154508">}</span><span class="op" id="8154509">,</span>&nbsp;<span class="builtintype" id="8154511">false</span><span class="op" id="8154516">,</span>&nbsp;<span class="num" id="8154518">0</span><span class="op" id="8154519">}</span><span class="op" id="8154520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154523">{</span><span class="op" id="8154524">[</span><span class="op" id="8154525">]</span><span class="builtintype" id="8154526">byte</span><span class="op" id="8154530">{</span><span class="num" id="8154531">1</span><span class="op" id="8154532">,</span>&nbsp;<span class="num" id="8154534">2</span><span class="op" id="8154535">,</span>&nbsp;<span class="num" id="8154537">3</span><span class="op" id="8154538">,</span>&nbsp;<span class="num" id="8154540">4</span><span class="op" id="8154541">,</span>&nbsp;<span class="num" id="8154543">1</span><span class="op" id="8154544">,</span>&nbsp;<span class="num" id="8154546">1</span><span class="op" id="8154547">}</span><span class="op" id="8154548">,</span>&nbsp;<span class="builtintype" id="8154550">true</span><span class="op" id="8154554">,</span>&nbsp;<span class="num" id="8154556">4</span><span class="op" id="8154557">}</span><span class="op" id="8154558">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154561">{</span><span class="op" id="8154562">[</span><span class="op" id="8154563">]</span><span class="builtintype" id="8154564">byte</span><span class="op" id="8154568">{</span><span class="num" id="8154569">1</span><span class="op" id="8154570">,</span>&nbsp;<span class="num" id="8154572">2</span><span class="op" id="8154573">,</span>&nbsp;<span class="num" id="8154575">3</span><span class="op" id="8154576">,</span>&nbsp;<span class="num" id="8154578">2</span><span class="op" id="8154579">,</span>&nbsp;<span class="num" id="8154581">2</span><span class="op" id="8154582">,</span>&nbsp;<span class="num" id="8154584">2</span><span class="op" id="8154585">}</span><span class="op" id="8154586">,</span>&nbsp;<span class="builtintype" id="8154588">true</span><span class="op" id="8154592">,</span>&nbsp;<span class="num" id="8154594">3</span><span class="op" id="8154595">}</span><span class="op" id="8154596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154599">{</span><span class="op" id="8154600">[</span><span class="op" id="8154601">]</span><span class="builtintype" id="8154602">byte</span><span class="op" id="8154606">{</span><span class="num" id="8154607">1</span><span class="op" id="8154608">,</span>&nbsp;<span class="num" id="8154610">2</span><span class="op" id="8154611">,</span>&nbsp;<span class="num" id="8154613">3</span><span class="op" id="8154614">,</span>&nbsp;<span class="num" id="8154616">3</span><span class="op" id="8154617">,</span>&nbsp;<span class="num" id="8154619">3</span><span class="op" id="8154620">,</span>&nbsp;<span class="num" id="8154622">3</span><span class="op" id="8154623">}</span><span class="op" id="8154624">,</span>&nbsp;<span class="builtintype" id="8154626">true</span><span class="op" id="8154630">,</span>&nbsp;<span class="num" id="8154632">2</span><span class="op" id="8154633">}</span><span class="op" id="8154634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154637">{</span><span class="op" id="8154638">[</span><span class="op" id="8154639">]</span><span class="builtintype" id="8154640">byte</span><span class="op" id="8154644">{</span><span class="num" id="8154645">1</span><span class="op" id="8154646">,</span>&nbsp;<span class="num" id="8154648">2</span><span class="op" id="8154649">,</span>&nbsp;<span class="num" id="8154651">3</span><span class="op" id="8154652">,</span>&nbsp;<span class="num" id="8154654">4</span><span class="op" id="8154655">,</span>&nbsp;<span class="num" id="8154657">3</span><span class="op" id="8154658">,</span>&nbsp;<span class="num" id="8154660">3</span><span class="op" id="8154661">}</span><span class="op" id="8154662">,</span>&nbsp;<span class="builtintype" id="8154664">false</span><span class="op" id="8154669">,</span>&nbsp;<span class="num" id="8154671">0</span><span class="op" id="8154672">}</span><span class="op" id="8154673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154676">{</span><span class="op" id="8154677">[</span><span class="op" id="8154678">]</span><span class="builtintype" id="8154679">byte</span><span class="op" id="8154683">{</span><span class="num" id="8154684">1</span><span class="op" id="8154685">,</span>&nbsp;<span class="num" id="8154687">4</span><span class="op" id="8154688">,</span>&nbsp;<span class="num" id="8154690">4</span><span class="op" id="8154691">,</span>&nbsp;<span class="num" id="8154693">4</span><span class="op" id="8154694">,</span>&nbsp;<span class="num" id="8154696">4</span><span class="op" id="8154697">,</span>&nbsp;<span class="num" id="8154699">4</span><span class="op" id="8154700">}</span><span class="op" id="8154701">,</span>&nbsp;<span class="builtintype" id="8154703">true</span><span class="op" id="8154707">,</span>&nbsp;<span class="num" id="8154709">1</span><span class="op" id="8154710">}</span><span class="op" id="8154711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154714">{</span><span class="op" id="8154715">[</span><span class="op" id="8154716">]</span><span class="builtintype" id="8154717">byte</span><span class="op" id="8154721">{</span><span class="num" id="8154722">5</span><span class="op" id="8154723">,</span>&nbsp;<span class="num" id="8154725">5</span><span class="op" id="8154726">,</span>&nbsp;<span class="num" id="8154728">5</span><span class="op" id="8154729">,</span>&nbsp;<span class="num" id="8154731">5</span><span class="op" id="8154732">,</span>&nbsp;<span class="num" id="8154734">5</span><span class="op" id="8154735">,</span>&nbsp;<span class="num" id="8154737">5</span><span class="op" id="8154738">}</span><span class="op" id="8154739">,</span>&nbsp;<span class="builtintype" id="8154741">true</span><span class="op" id="8154745">,</span>&nbsp;<span class="num" id="8154747">0</span><span class="op" id="8154748">}</span><span class="op" id="8154749">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154752">{</span><span class="op" id="8154753">[</span><span class="op" id="8154754">]</span><span class="builtintype" id="8154755">byte</span><span class="op" id="8154759">{</span><span class="num" id="8154760">6</span><span class="op" id="8154761">,</span>&nbsp;<span class="num" id="8154763">6</span><span class="op" id="8154764">,</span>&nbsp;<span class="num" id="8154766">6</span><span class="op" id="8154767">,</span>&nbsp;<span class="num" id="8154769">6</span><span class="op" id="8154770">,</span>&nbsp;<span class="num" id="8154772">6</span><span class="op" id="8154773">,</span>&nbsp;<span class="num" id="8154775">6</span><span class="op" id="8154776">}</span><span class="op" id="8154777">,</span>&nbsp;<span class="builtintype" id="8154779">false</span><span class="op" id="8154784">,</span>&nbsp;<span class="num" id="8154786">0</span><span class="op" id="8154787">}</span><span class="op" id="8154788">,</span><br>
<span class="lineno"></span><span class="op" id="8154790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8154793">func</span>&nbsp;<span class="ident" id="8154798">TestRemovePadding</span><span class="op" id="8154815">(</span><span class="ident" id="8154816">t</span>&nbsp;<span class="op" id="8154818">*</span><span class="ident" id="8154819">testing</span><span class="op" id="8154826">.</span><span class="ident" id="8154827">T</span><span class="op" id="8154828">)</span>&nbsp;<span class="op" id="8154830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8154833">for</span>&nbsp;<span class="ident" id="8154837">i</span><span class="op" id="8154838">,</span>&nbsp;<span class="ident" id="8154840">test</span>&nbsp;<span class="op" id="8154845">:=</span>&nbsp;<span class="keyword" id="8154848">range</span>&nbsp;<span class="ident" id="8154854">paddingTests</span>&nbsp;<span class="op" id="8154867">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154871">payload</span><span class="op" id="8154878">,</span>&nbsp;<span class="ident" id="8154880">good</span>&nbsp;<span class="op" id="8154885">:=</span>&nbsp;<span class="ident" id="8154888">removePadding</span><span class="op" id="8154901">(</span><span class="ident" id="8154902">test</span><span class="op" id="8154906">.</span><span class="ident" id="8154907">in</span><span class="op" id="8154909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154913">expectedGood</span>&nbsp;<span class="op" id="8154926">:=</span>&nbsp;<span class="builtintype" id="8154929">byte</span><span class="op" id="8154933">(</span><span class="num" id="8154934">255</span><span class="op" id="8154937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8154941">if</span>&nbsp;<span class="op" id="8154944">!</span><span class="ident" id="8154945">test</span><span class="op" id="8154949">.</span><span class="ident" id="8154950">good</span>&nbsp;<span class="op" id="8154955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8154960">expectedGood</span>&nbsp;<span class="op" id="8154973">=</span>&nbsp;<span class="num" id="8154975">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8154979">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8154983">if</span>&nbsp;<span class="ident" id="8154986">good</span>&nbsp;<span class="op" id="8154991">!=</span>&nbsp;<span class="ident" id="8154994">expectedGood</span>&nbsp;<span class="op" id="8155007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8155012">t</span><span class="op" id="8155013">.</span><span class="ident" id="8155014">Errorf</span><span class="op" id="8155020">(</span><span class="string" id="8155021">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="8155058">,</span>&nbsp;<span class="ident" id="8155060">i</span><span class="op" id="8155061">,</span>&nbsp;<span class="ident" id="8155063">expectedGood</span><span class="op" id="8155075">,</span>&nbsp;<span class="ident" id="8155077">good</span><span class="op" id="8155081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8155085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8155089">if</span>&nbsp;<span class="ident" id="8155092">good</span>&nbsp;<span class="op" id="8155097">==</span>&nbsp;<span class="num" id="8155100">255</span>&nbsp;<span class="op" id="8155104">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="8155107">len</span><span class="op" id="8155110">(</span><span class="ident" id="8155111">payload</span><span class="op" id="8155118">)</span>&nbsp;<span class="op" id="8155120">!=</span>&nbsp;<span class="ident" id="8155123">test</span><span class="op" id="8155127">.</span><span class="ident" id="8155128">expectedLen</span>&nbsp;<span class="op" id="8155140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8155145">t</span><span class="op" id="8155146">.</span><span class="ident" id="8155147">Errorf</span><span class="op" id="8155153">(</span><span class="string" id="8155154">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8155176">,</span>&nbsp;<span class="ident" id="8155178">i</span><span class="op" id="8155179">,</span>&nbsp;<span class="builtinfunc" id="8155181">len</span><span class="op" id="8155184">(</span><span class="ident" id="8155185">payload</span><span class="op" id="8155192">)</span><span class="op" id="8155193">,</span>&nbsp;<span class="ident" id="8155195">test</span><span class="op" id="8155199">.</span><span class="ident" id="8155200">expectedLen</span><span class="op" id="8155211">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8155215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8155218">}</span><br>
<span class="lineno"></span><span class="op" id="8155220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8155223">var</span>&nbsp;<span class="ident" id="8155227">certExampleCom</span>&nbsp;<span class="op" id="8155242">=</span>&nbsp;<span class="string" id="8155244">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="8155896">var</span>&nbsp;<span class="ident" id="8155900">certWildcardExampleCom</span>&nbsp;<span class="op" id="8155923">=</span>&nbsp;<span class="string" id="8155925">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8156581">var</span>&nbsp;<span class="ident" id="8156585">certFooExampleCom</span>&nbsp;<span class="op" id="8156603">=</span>&nbsp;<span class="string" id="8156605">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="8157265">var</span>&nbsp;<span class="ident" id="8157269">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="8157298">=</span>&nbsp;<span class="string" id="8157300">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8157960">func</span>&nbsp;<span class="ident" id="8157965">TestCertificateSelection</span><span class="op" id="8157989">(</span><span class="ident" id="8157990">t</span>&nbsp;<span class="op" id="8157992">*</span><span class="ident" id="8157993">testing</span><span class="op" id="8158000">.</span><span class="ident" id="8158001">T</span><span class="op" id="8158002">)</span>&nbsp;<span class="op" id="8158004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158007">config</span>&nbsp;<span class="op" id="8158014">:=</span>&nbsp;<span class="ident" id="8158017">Config</span><span class="op" id="8158023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158027">Certificates</span><span class="op" id="8158039">:</span>&nbsp;<span class="op" id="8158041">[</span><span class="op" id="8158042">]</span><span class="ident" id="8158043">Certificate</span><span class="op" id="8158054">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158065">Certificate</span><span class="op" id="8158076">:</span>&nbsp;<span class="op" id="8158078">[</span><span class="op" id="8158079">]</span><span class="op" id="8158080">[</span><span class="op" id="8158081">]</span><span class="builtintype" id="8158082">byte</span><span class="op" id="8158086">{</span><span class="ident" id="8158087">fromHex</span><span class="op" id="8158094">(</span><span class="ident" id="8158095">certExampleCom</span><span class="op" id="8158109">)</span><span class="op" id="8158110">}</span><span class="op" id="8158111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158116">}</span><span class="op" id="8158117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158128">Certificate</span><span class="op" id="8158139">:</span>&nbsp;<span class="op" id="8158141">[</span><span class="op" id="8158142">]</span><span class="op" id="8158143">[</span><span class="op" id="8158144">]</span><span class="builtintype" id="8158145">byte</span><span class="op" id="8158149">{</span><span class="ident" id="8158150">fromHex</span><span class="op" id="8158157">(</span><span class="ident" id="8158158">certWildcardExampleCom</span><span class="op" id="8158180">)</span><span class="op" id="8158181">}</span><span class="op" id="8158182">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158187">}</span><span class="op" id="8158188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158199">Certificate</span><span class="op" id="8158210">:</span>&nbsp;<span class="op" id="8158212">[</span><span class="op" id="8158213">]</span><span class="op" id="8158214">[</span><span class="op" id="8158215">]</span><span class="builtintype" id="8158216">byte</span><span class="op" id="8158220">{</span><span class="ident" id="8158221">fromHex</span><span class="op" id="8158228">(</span><span class="ident" id="8158229">certFooExampleCom</span><span class="op" id="8158246">)</span><span class="op" id="8158247">}</span><span class="op" id="8158248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158253">}</span><span class="op" id="8158254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158259">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158265">Certificate</span><span class="op" id="8158276">:</span>&nbsp;<span class="op" id="8158278">[</span><span class="op" id="8158279">]</span><span class="op" id="8158280">[</span><span class="op" id="8158281">]</span><span class="builtintype" id="8158282">byte</span><span class="op" id="8158286">{</span><span class="ident" id="8158287">fromHex</span><span class="op" id="8158294">(</span><span class="ident" id="8158295">certDoubleWildcardExampleCom</span><span class="op" id="8158323">)</span><span class="op" id="8158324">}</span><span class="op" id="8158325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158330">}</span><span class="op" id="8158331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158335">}</span><span class="op" id="8158336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158343">config</span><span class="op" id="8158349">.</span><span class="ident" id="8158350">BuildNameToCertificate</span><span class="op" id="8158372">(</span><span class="op" id="8158373">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158377">pointerToIndex</span>&nbsp;<span class="op" id="8158392">:=</span>&nbsp;<span class="keyword" id="8158395">func</span><span class="op" id="8158399">(</span><span class="ident" id="8158400">c</span>&nbsp;<span class="op" id="8158402">*</span><span class="ident" id="8158403">Certificate</span><span class="op" id="8158414">)</span>&nbsp;<span class="builtintype" id="8158416">int</span>&nbsp;<span class="op" id="8158420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158424">for</span>&nbsp;<span class="ident" id="8158428">i</span>&nbsp;<span class="op" id="8158430">:=</span>&nbsp;<span class="keyword" id="8158433">range</span>&nbsp;<span class="ident" id="8158439">config</span><span class="op" id="8158445">.</span><span class="ident" id="8158446">Certificates</span>&nbsp;<span class="op" id="8158459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158464">if</span>&nbsp;<span class="ident" id="8158467">c</span>&nbsp;<span class="op" id="8158469">==</span>&nbsp;<span class="op" id="8158472">&amp;</span><span class="ident" id="8158473">config</span><span class="op" id="8158479">.</span><span class="ident" id="8158480">Certificates</span><span class="op" id="8158492">[</span><span class="ident" id="8158493">i</span><span class="op" id="8158494">]</span>&nbsp;<span class="op" id="8158496">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158502">return</span>&nbsp;<span class="ident" id="8158509">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158522">return</span>&nbsp;<span class="op" id="8158529">-</span><span class="num" id="8158530">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158533">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158537">certificateForName</span>&nbsp;<span class="op" id="8158556">:=</span>&nbsp;<span class="keyword" id="8158559">func</span><span class="op" id="8158563">(</span><span class="ident" id="8158564">name</span>&nbsp;<span class="builtintype" id="8158569">string</span><span class="op" id="8158575">)</span>&nbsp;<span class="op" id="8158577">*</span><span class="ident" id="8158578">Certificate</span>&nbsp;<span class="op" id="8158590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158594">clientHello</span>&nbsp;<span class="op" id="8158606">:=</span>&nbsp;<span class="op" id="8158609">&amp;</span><span class="ident" id="8158610">ClientHelloInfo</span><span class="op" id="8158625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158630">ServerName</span><span class="op" id="8158640">:</span>&nbsp;<span class="ident" id="8158642">name</span><span class="op" id="8158646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158650">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158654">if</span>&nbsp;<span class="ident" id="8158657">cert</span><span class="op" id="8158661">,</span>&nbsp;<span class="ident" id="8158663">err</span>&nbsp;<span class="op" id="8158667">:=</span>&nbsp;<span class="ident" id="8158670">config</span><span class="op" id="8158676">.</span><span class="ident" id="8158677">getCertificate</span><span class="op" id="8158691">(</span><span class="ident" id="8158692">clientHello</span><span class="op" id="8158703">)</span><span class="op" id="8158704">;</span>&nbsp;<span class="ident" id="8158706">err</span>&nbsp;<span class="op" id="8158710">!=</span>&nbsp;<span class="ident" id="8158713">nil</span>&nbsp;<span class="op" id="8158717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158722">t</span><span class="op" id="8158723">.</span><span class="ident" id="8158724">Errorf</span><span class="op" id="8158730">(</span><span class="string" id="8158731">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="8158776">,</span>&nbsp;<span class="ident" id="8158778">name</span><span class="op" id="8158782">,</span>&nbsp;<span class="ident" id="8158784">err</span><span class="op" id="8158787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158792">return</span>&nbsp;<span class="ident" id="8158799">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158805">}</span>&nbsp;<span class="keyword" id="8158807">else</span>&nbsp;<span class="op" id="8158812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158817">return</span>&nbsp;<span class="ident" id="8158824">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158838">if</span>&nbsp;<span class="ident" id="8158841">n</span>&nbsp;<span class="op" id="8158843">:=</span>&nbsp;<span class="ident" id="8158846">pointerToIndex</span><span class="op" id="8158860">(</span><span class="ident" id="8158861">certificateForName</span><span class="op" id="8158879">(</span><span class="string" id="8158880">&#34;example.com&#34;</span><span class="op" id="8158893">)</span><span class="op" id="8158894">)</span><span class="op" id="8158895">;</span>&nbsp;<span class="ident" id="8158897">n</span>&nbsp;<span class="op" id="8158899">!=</span>&nbsp;<span class="num" id="8158902">0</span>&nbsp;<span class="op" id="8158904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8158908">t</span><span class="op" id="8158909">.</span><span class="ident" id="8158910">Errorf</span><span class="op" id="8158916">(</span><span class="string" id="8158917">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8158961">,</span>&nbsp;<span class="ident" id="8158963">n</span><span class="op" id="8158964">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8158967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8158970">if</span>&nbsp;<span class="ident" id="8158973">n</span>&nbsp;<span class="op" id="8158975">:=</span>&nbsp;<span class="ident" id="8158978">pointerToIndex</span><span class="op" id="8158992">(</span><span class="ident" id="8158993">certificateForName</span><span class="op" id="8159011">(</span><span class="string" id="8159012">&#34;bar.example.com&#34;</span><span class="op" id="8159029">)</span><span class="op" id="8159030">)</span><span class="op" id="8159031">;</span>&nbsp;<span class="ident" id="8159033">n</span>&nbsp;<span class="op" id="8159035">!=</span>&nbsp;<span class="num" id="8159038">1</span>&nbsp;<span class="op" id="8159040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8159044">t</span><span class="op" id="8159045">.</span><span class="ident" id="8159046">Errorf</span><span class="op" id="8159052">(</span><span class="string" id="8159053">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="8159101">,</span>&nbsp;<span class="ident" id="8159103">n</span><span class="op" id="8159104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8159107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8159110">if</span>&nbsp;<span class="ident" id="8159113">n</span>&nbsp;<span class="op" id="8159115">:=</span>&nbsp;<span class="ident" id="8159118">pointerToIndex</span><span class="op" id="8159132">(</span><span class="ident" id="8159133">certificateForName</span><span class="op" id="8159151">(</span><span class="string" id="8159152">&#34;foo.example.com&#34;</span><span class="op" id="8159169">)</span><span class="op" id="8159170">)</span><span class="op" id="8159171">;</span>&nbsp;<span class="ident" id="8159173">n</span>&nbsp;<span class="op" id="8159175">!=</span>&nbsp;<span class="num" id="8159178">2</span>&nbsp;<span class="op" id="8159180">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8159184">t</span><span class="op" id="8159185">.</span><span class="ident" id="8159186">Errorf</span><span class="op" id="8159192">(</span><span class="string" id="8159193">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="8159241">,</span>&nbsp;<span class="ident" id="8159243">n</span><span class="op" id="8159244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8159247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8159250">if</span>&nbsp;<span class="ident" id="8159253">n</span>&nbsp;<span class="op" id="8159255">:=</span>&nbsp;<span class="ident" id="8159258">pointerToIndex</span><span class="op" id="8159272">(</span><span class="ident" id="8159273">certificateForName</span><span class="op" id="8159291">(</span><span class="string" id="8159292">&#34;foo.bar.example.com&#34;</span><span class="op" id="8159313">)</span><span class="op" id="8159314">)</span><span class="op" id="8159315">;</span>&nbsp;<span class="ident" id="8159317">n</span>&nbsp;<span class="op" id="8159319">!=</span>&nbsp;<span class="num" id="8159322">3</span>&nbsp;<span class="op" id="8159324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8159328">t</span><span class="op" id="8159329">.</span><span class="ident" id="8159330">Errorf</span><span class="op" id="8159336">(</span><span class="string" id="8159337">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="8159389">,</span>&nbsp;<span class="ident" id="8159391">n</span><span class="op" id="8159392">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8159395">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8159398">if</span>&nbsp;<span class="ident" id="8159401">n</span>&nbsp;<span class="op" id="8159403">:=</span>&nbsp;<span class="ident" id="8159406">pointerToIndex</span><span class="op" id="8159420">(</span><span class="ident" id="8159421">certificateForName</span><span class="op" id="8159439">(</span><span class="string" id="8159440">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="8159465">)</span><span class="op" id="8159466">)</span><span class="op" id="8159467">;</span>&nbsp;<span class="ident" id="8159469">n</span>&nbsp;<span class="op" id="8159471">!=</span>&nbsp;<span class="num" id="8159474">0</span>&nbsp;<span class="op" id="8159476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8159480">t</span><span class="op" id="8159481">.</span><span class="ident" id="8159482">Errorf</span><span class="op" id="8159488">(</span><span class="string" id="8159489">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="8159545">,</span>&nbsp;<span class="ident" id="8159547">n</span><span class="op" id="8159548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8159551">}</span><br>
<span class="lineno"></span><span class="op" id="8159553">}</span>
</div>
</body>
</html>
