<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1527136">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1527192">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1527246">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1527297">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1527375">package</span>&nbsp;<span class="ident" id="1527383">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1527388">import</span>&nbsp;<span class="op" id="1527395">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1527398">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1527408">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1527414">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="1527425">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="1527432">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="1527435">func</span>&nbsp;<span class="ident" id="1527440">unixSocket</span><span class="op" id="1527450">(</span><span class="ident" id="1527451">net</span>&nbsp;<span class="builtintype" id="1527455">string</span><span class="op" id="1527461">,</span>&nbsp;<span class="ident" id="1527463">laddr</span><span class="op" id="1527468">,</span>&nbsp;<span class="ident" id="1527470">raddr</span>&nbsp;<span class="ident" id="1527476"><a href="/net/sock_posix.go.html#1492167">sockaddr</a></span><span class="op" id="1527484">,</span>&nbsp;<span class="ident" id="1527486">mode</span>&nbsp;<span class="builtintype" id="1527491">string</span><span class="op" id="1527497">,</span>&nbsp;<span class="ident" id="1527499">deadline</span>&nbsp;<span class="ident" id="1527508"><a href="/net/unixsock_posix.go.html#1527425">time</a></span><span class="op" id="1527512">.</span><span class="ident" id="1527513">Time</span><span class="op" id="1527517">)</span>&nbsp;<span class="op" id="1527519">(</span><span class="op" id="1527520">*</span><span class="ident" id="1527521"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1527526">,</span>&nbsp;<span class="builtintype" id="1527528">error</span><span class="op" id="1527533">)</span>&nbsp;<span class="op" id="1527535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527538">var</span>&nbsp;<span class="ident" id="1527542">sotype</span>&nbsp;<span class="builtintype" id="1527549">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527554">switch</span>&nbsp;<span class="ident" id="1527561"><a href="/net/unixsock_posix.go.html#1527451">net</a></span>&nbsp;<span class="op" id="1527565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527568">case</span>&nbsp;<span class="string" id="1527573">&#34;unix&#34;</span><span class="op" id="1527579">:</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1527583"><a href="/net/unixsock_posix.go.html#1527542">sotype</a></span>&nbsp;<span class="op" id="1527590">=</span>&nbsp;<span class="ident" id="1527592"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1527599">.</span><span class="ident" id="1527600">SOCK_STREAM</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527613">case</span>&nbsp;<span class="string" id="1527618">&#34;unixgram&#34;</span><span class="op" id="1527628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1527632"><a href="/net/unixsock_posix.go.html#1527542">sotype</a></span>&nbsp;<span class="op" id="1527639">=</span>&nbsp;<span class="ident" id="1527641"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1527648">.</span><span class="ident" id="1527649">SOCK_DGRAM</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527661">case</span>&nbsp;<span class="string" id="1527666">&#34;unixpacket&#34;</span><span class="op" id="1527678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1527682"><a href="/net/unixsock_posix.go.html#1527542">sotype</a></span>&nbsp;<span class="op" id="1527689">=</span>&nbsp;<span class="ident" id="1527691"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1527698">.</span><span class="ident" id="1527699">SOCK_SEQPACKET</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527715">default</span><span class="op" id="1527722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527726">return</span>&nbsp;<span class="ident" id="1527733">nil</span><span class="op" id="1527736">,</span>&nbsp;<span class="ident" id="1527738"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1527757">(</span><span class="ident" id="1527758"><a href="/net/unixsock_posix.go.html#1527451">net</a></span><span class="op" id="1527761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1527764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527768">switch</span>&nbsp;<span class="ident" id="1527775"><a href="/net/unixsock_posix.go.html#1527486">mode</a></span>&nbsp;<span class="op" id="1527780">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527783">case</span>&nbsp;<span class="string" id="1527788">&#34;dial&#34;</span><span class="op" id="1527794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527798">if</span>&nbsp;<span class="ident" id="1527801"><a href="/net/unixsock_posix.go.html#1527463">laddr</a></span>&nbsp;<span class="op" id="1527807">!=</span>&nbsp;<span class="ident" id="1527810">nil</span>&nbsp;<span class="op" id="1527814">&amp;&amp;</span>&nbsp;<span class="ident" id="1527817"><a href="/net/unixsock_posix.go.html#1527463">laddr</a></span><span class="op" id="1527822">.</span><span class="ident" id="1527823">isWildcard</span><span class="op" id="1527833">(</span><span class="op" id="1527834">)</span>&nbsp;<span class="op" id="1527836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1527841"><a href="/net/unixsock_posix.go.html#1527463">laddr</a></span>&nbsp;<span class="op" id="1527847">=</span>&nbsp;<span class="ident" id="1527849">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1527855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527859">if</span>&nbsp;<span class="ident" id="1527862"><a href="/net/unixsock_posix.go.html#1527470">raddr</a></span>&nbsp;<span class="op" id="1527868">!=</span>&nbsp;<span class="ident" id="1527871">nil</span>&nbsp;<span class="op" id="1527875">&amp;&amp;</span>&nbsp;<span class="ident" id="1527878"><a href="/net/unixsock_posix.go.html#1527470">raddr</a></span><span class="op" id="1527883">.</span><span class="ident" id="1527884">isWildcard</span><span class="op" id="1527894">(</span><span class="op" id="1527895">)</span>&nbsp;<span class="op" id="1527897">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1527902"><a href="/net/unixsock_posix.go.html#1527470">raddr</a></span>&nbsp;<span class="op" id="1527908">=</span>&nbsp;<span class="ident" id="1527910">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1527916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527920">if</span>&nbsp;<span class="ident" id="1527923"><a href="/net/unixsock_posix.go.html#1527470">raddr</a></span>&nbsp;<span class="op" id="1527929">==</span>&nbsp;<span class="ident" id="1527932">nil</span>&nbsp;<span class="op" id="1527936">&amp;&amp;</span>&nbsp;<span class="op" id="1527939">(</span><span class="ident" id="1527940"><a href="/net/unixsock_posix.go.html#1527542">sotype</a></span>&nbsp;<span class="op" id="1527947">!=</span>&nbsp;<span class="ident" id="1527950"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1527957">.</span><span class="ident" id="1527958">SOCK_DGRAM</span>&nbsp;<span class="op" id="1527969">||</span>&nbsp;<span class="ident" id="1527972"><a href="/net/unixsock_posix.go.html#1527463">laddr</a></span>&nbsp;<span class="op" id="1527978">==</span>&nbsp;<span class="ident" id="1527981">nil</span><span class="op" id="1527984">)</span>&nbsp;<span class="op" id="1527986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1527991">return</span>&nbsp;<span class="ident" id="1527998">nil</span><span class="op" id="1528001">,</span>&nbsp;<span class="ident" id="1528003"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528023">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528026">case</span>&nbsp;<span class="string" id="1528031">&#34;listen&#34;</span><span class="op" id="1528039">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528042">default</span><span class="op" id="1528049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528053">return</span>&nbsp;<span class="ident" id="1528060">nil</span><span class="op" id="1528063">,</span>&nbsp;<span class="ident" id="1528065"><a href="/net/unixsock_posix.go.html#1527398">errors</a></span><span class="op" id="1528071">.</span><span class="ident" id="1528072">New</span><span class="op" id="1528075">(</span><span class="string" id="1528076">&#34;unknown&nbsp;mode:&nbsp;&#34;</span>&nbsp;<span class="op" id="1528093">+</span>&nbsp;<span class="ident" id="1528095"><a href="/net/unixsock_posix.go.html#1527486">mode</a></span><span class="op" id="1528099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1528106">fd</span><span class="op" id="1528108">,</span>&nbsp;<span class="ident" id="1528110">err</span>&nbsp;<span class="op" id="1528114">:=</span>&nbsp;<span class="ident" id="1528117"><a href="/net/sock_posix.go.html#1492727">socket</a></span><span class="op" id="1528123">(</span><span class="ident" id="1528124"><a href="/net/unixsock_posix.go.html#1527451">net</a></span><span class="op" id="1528127">,</span>&nbsp;<span class="ident" id="1528129"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528136">.</span><span class="ident" id="1528137">AF_UNIX</span><span class="op" id="1528144">,</span>&nbsp;<span class="ident" id="1528146"><a href="/net/unixsock_posix.go.html#1527542">sotype</a></span><span class="op" id="1528152">,</span>&nbsp;<span class="num" id="1528154">0</span><span class="op" id="1528155">,</span>&nbsp;<span class="builtintype" id="1528157">false</span><span class="op" id="1528162">,</span>&nbsp;<span class="ident" id="1528164"><a href="/net/unixsock_posix.go.html#1527463">laddr</a></span><span class="op" id="1528169">,</span>&nbsp;<span class="ident" id="1528171"><a href="/net/unixsock_posix.go.html#1527470">raddr</a></span><span class="op" id="1528176">,</span>&nbsp;<span class="ident" id="1528178"><a href="/net/unixsock_posix.go.html#1527499">deadline</a></span><span class="op" id="1528186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528189">if</span>&nbsp;<span class="ident" id="1528192"><a href="/net/unixsock_posix.go.html#1528110">err</a></span>&nbsp;<span class="op" id="1528196">!=</span>&nbsp;<span class="ident" id="1528199">nil</span>&nbsp;<span class="op" id="1528203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528207">return</span>&nbsp;<span class="ident" id="1528214">nil</span><span class="op" id="1528217">,</span>&nbsp;<span class="ident" id="1528219"><a href="/net/unixsock_posix.go.html#1528110">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528227">return</span>&nbsp;<span class="ident" id="1528234"><a href="/net/unixsock_posix.go.html#1528106">fd</a></span><span class="op" id="1528236">,</span>&nbsp;<span class="ident" id="1528238">nil</span><br>
<span class="lineno">50</span><span class="op" id="1528242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1528245">func</span>&nbsp;<span class="ident" id="1528250">sockaddrToUnix</span><span class="op" id="1528264">(</span><span class="ident" id="1528265">sa</span>&nbsp;<span class="ident" id="1528268"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528275">.</span><span class="ident" id="1528276">Sockaddr</span><span class="op" id="1528284">)</span>&nbsp;<span class="ident" id="1528286"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1528291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528294">if</span>&nbsp;<span class="ident" id="1528297">s</span><span class="op" id="1528298">,</span>&nbsp;<span class="ident" id="1528300">ok</span>&nbsp;<span class="op" id="1528303">:=</span>&nbsp;<span class="ident" id="1528306"><a href="/net/unixsock_posix.go.html#1528265">sa</a></span><span class="op" id="1528308">.</span><span class="op" id="1528309">(</span><span class="op" id="1528310">*</span><span class="ident" id="1528311"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528318">.</span><span class="ident" id="1528319">SockaddrUnix</span><span class="op" id="1528331">)</span><span class="op" id="1528332">;</span>&nbsp;<span class="ident" id="1528334"><a href="/net/unixsock_posix.go.html#1528300">ok</a></span>&nbsp;<span class="op" id="1528337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528341">return</span>&nbsp;<span class="op" id="1528348">&amp;</span><span class="ident" id="1528349"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1528357">{</span><span class="ident" id="1528358">Name</span><span class="op" id="1528362">:</span>&nbsp;<span class="ident" id="1528364"><a href="/net/unixsock_posix.go.html#1528297">s</a></span><span class="op" id="1528365">.</span><span class="ident" id="1528366">Name</span><span class="op" id="1528370">,</span>&nbsp;<span class="ident" id="1528372">Net</span><span class="op" id="1528375">:</span>&nbsp;<span class="string" id="1528377">&#34;unix&#34;</span><span class="op" id="1528383">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528389">return</span>&nbsp;<span class="ident" id="1528396">nil</span><br>
<span class="lineno"></span><span class="op" id="1528400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1528403">func</span>&nbsp;<span class="ident" id="1528408">sockaddrToUnixgram</span><span class="op" id="1528426">(</span><span class="ident" id="1528427">sa</span>&nbsp;<span class="ident" id="1528430"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528437">.</span><span class="ident" id="1528438">Sockaddr</span><span class="op" id="1528446">)</span>&nbsp;<span class="ident" id="1528448"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1528453">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528456">if</span>&nbsp;<span class="ident" id="1528459">s</span><span class="op" id="1528460">,</span>&nbsp;<span class="ident" id="1528462">ok</span>&nbsp;<span class="op" id="1528465">:=</span>&nbsp;<span class="ident" id="1528468"><a href="/net/unixsock_posix.go.html#1528427">sa</a></span><span class="op" id="1528470">.</span><span class="op" id="1528471">(</span><span class="op" id="1528472">*</span><span class="ident" id="1528473"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528480">.</span><span class="ident" id="1528481">SockaddrUnix</span><span class="op" id="1528493">)</span><span class="op" id="1528494">;</span>&nbsp;<span class="ident" id="1528496"><a href="/net/unixsock_posix.go.html#1528462">ok</a></span>&nbsp;<span class="op" id="1528499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528503">return</span>&nbsp;<span class="op" id="1528510">&amp;</span><span class="ident" id="1528511"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1528519">{</span><span class="ident" id="1528520">Name</span><span class="op" id="1528524">:</span>&nbsp;<span class="ident" id="1528526"><a href="/net/unixsock_posix.go.html#1528459">s</a></span><span class="op" id="1528527">.</span><span class="ident" id="1528528">Name</span><span class="op" id="1528532">,</span>&nbsp;<span class="ident" id="1528534">Net</span><span class="op" id="1528537">:</span>&nbsp;<span class="string" id="1528539">&#34;unixgram&#34;</span><span class="op" id="1528549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528555">return</span>&nbsp;<span class="ident" id="1528562">nil</span><br>
<span class="lineno"></span><span class="op" id="1528566">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1528569">func</span>&nbsp;<span class="ident" id="1528574">sockaddrToUnixpacket</span><span class="op" id="1528594">(</span><span class="ident" id="1528595">sa</span>&nbsp;<span class="ident" id="1528598"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528605">.</span><span class="ident" id="1528606">Sockaddr</span><span class="op" id="1528614">)</span>&nbsp;<span class="ident" id="1528616"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1528621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528624">if</span>&nbsp;<span class="ident" id="1528627">s</span><span class="op" id="1528628">,</span>&nbsp;<span class="ident" id="1528630">ok</span>&nbsp;<span class="op" id="1528633">:=</span>&nbsp;<span class="ident" id="1528636"><a href="/net/unixsock_posix.go.html#1528595">sa</a></span><span class="op" id="1528638">.</span><span class="op" id="1528639">(</span><span class="op" id="1528640">*</span><span class="ident" id="1528641"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528648">.</span><span class="ident" id="1528649">SockaddrUnix</span><span class="op" id="1528661">)</span><span class="op" id="1528662">;</span>&nbsp;<span class="ident" id="1528664"><a href="/net/unixsock_posix.go.html#1528630">ok</a></span>&nbsp;<span class="op" id="1528667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528671">return</span>&nbsp;<span class="op" id="1528678">&amp;</span><span class="ident" id="1528679"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1528687">{</span><span class="ident" id="1528688">Name</span><span class="op" id="1528692">:</span>&nbsp;<span class="ident" id="1528694"><a href="/net/unixsock_posix.go.html#1528627">s</a></span><span class="op" id="1528695">.</span><span class="ident" id="1528696">Name</span><span class="op" id="1528700">,</span>&nbsp;<span class="ident" id="1528702">Net</span><span class="op" id="1528705">:</span>&nbsp;<span class="string" id="1528707">&#34;unixpacket&#34;</span><span class="op" id="1528719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528722">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528725">return</span>&nbsp;<span class="ident" id="1528732">nil</span><br>
<span class="lineno"></span><span class="op" id="1528736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1528739">func</span>&nbsp;<span class="ident" id="1528744">sotypeToNet</span><span class="op" id="1528755">(</span><span class="ident" id="1528756">sotype</span>&nbsp;<span class="builtintype" id="1528763">int</span><span class="op" id="1528766">)</span>&nbsp;<span class="builtintype" id="1528768">string</span>&nbsp;<span class="op" id="1528775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528778">switch</span>&nbsp;<span class="ident" id="1528785"><a href="/net/unixsock_posix.go.html#1528756">sotype</a></span>&nbsp;<span class="op" id="1528792">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528795">case</span>&nbsp;<span class="ident" id="1528800"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528807">.</span><span class="ident" id="1528808">SOCK_STREAM</span><span class="op" id="1528819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528823">return</span>&nbsp;<span class="string" id="1528830">&#34;unix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528838">case</span>&nbsp;<span class="ident" id="1528843"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528850">.</span><span class="ident" id="1528851">SOCK_DGRAM</span><span class="op" id="1528861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528865">return</span>&nbsp;<span class="string" id="1528872">&#34;unixgram&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528884">case</span>&nbsp;<span class="ident" id="1528889"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1528896">.</span><span class="ident" id="1528897">SOCK_SEQPACKET</span><span class="op" id="1528911">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528915">return</span>&nbsp;<span class="string" id="1528922">&#34;unixpacket&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1528936">default</span><span class="op" id="1528943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="1528947">panic</span><span class="op" id="1528952">(</span><span class="string" id="1528953">&#34;sotypeToNet&nbsp;unknown&nbsp;socket&nbsp;type&#34;</span><span class="op" id="1528986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1528989">}</span><br>
<span class="lineno"></span><span class="op" id="1528991">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="1528994">func</span>&nbsp;<span class="op" id="1528999">(</span><span class="ident" id="1529000">a</span>&nbsp;<span class="op" id="1529002">*</span><span class="ident" id="1529003"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1529011">)</span>&nbsp;<span class="ident" id="1529013">family</span><span class="op" id="1529019">(</span><span class="op" id="1529020">)</span>&nbsp;<span class="builtintype" id="1529022">int</span>&nbsp;<span class="op" id="1529026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529029">return</span>&nbsp;<span class="ident" id="1529036"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1529043">.</span><span class="ident" id="1529044">AF_UNIX</span><br>
<span class="lineno"></span><span class="op" id="1529052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="1529055">func</span>&nbsp;<span class="op" id="1529060">(</span><span class="ident" id="1529061">a</span>&nbsp;<span class="op" id="1529063">*</span><span class="ident" id="1529064"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1529072">)</span>&nbsp;<span class="ident" id="1529074">isWildcard</span><span class="op" id="1529084">(</span><span class="op" id="1529085">)</span>&nbsp;<span class="builtintype" id="1529087">bool</span>&nbsp;<span class="op" id="1529092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529095">return</span>&nbsp;<span class="ident" id="1529102"><a href="/net/unixsock_posix.go.html#1529061">a</a></span>&nbsp;<span class="op" id="1529104">==</span>&nbsp;<span class="ident" id="1529107">nil</span>&nbsp;<span class="op" id="1529111">||</span>&nbsp;<span class="ident" id="1529114"><a href="/net/unixsock_posix.go.html#1529061">a</a></span><span class="op" id="1529115">.</span><span class="ident" id="1529116">Name</span>&nbsp;<span class="op" id="1529121">==</span>&nbsp;<span class="string" id="1529124">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="1529127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1529130">func</span>&nbsp;<span class="op" id="1529135">(</span><span class="ident" id="1529136">a</span>&nbsp;<span class="op" id="1529138">*</span><span class="ident" id="1529139"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1529147">)</span>&nbsp;<span class="ident" id="1529149">sockaddr</span><span class="op" id="1529157">(</span><span class="ident" id="1529158">family</span>&nbsp;<span class="builtintype" id="1529165">int</span><span class="op" id="1529168">)</span>&nbsp;<span class="op" id="1529170">(</span><span class="ident" id="1529171"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1529178">.</span><span class="ident" id="1529179">Sockaddr</span><span class="op" id="1529187">,</span>&nbsp;<span class="builtintype" id="1529189">error</span><span class="op" id="1529194">)</span>&nbsp;<span class="op" id="1529196">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529199">if</span>&nbsp;<span class="ident" id="1529202"><a href="/net/unixsock_posix.go.html#1529136">a</a></span>&nbsp;<span class="op" id="1529204">==</span>&nbsp;<span class="ident" id="1529207">nil</span>&nbsp;<span class="op" id="1529211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529215">return</span>&nbsp;<span class="ident" id="1529222">nil</span><span class="op" id="1529225">,</span>&nbsp;<span class="ident" id="1529227">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1529232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529235">return</span>&nbsp;<span class="op" id="1529242">&amp;</span><span class="ident" id="1529243"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1529250">.</span><span class="ident" id="1529251">SockaddrUnix</span><span class="op" id="1529263">{</span><span class="ident" id="1529264">Name</span><span class="op" id="1529268">:</span>&nbsp;<span class="ident" id="1529270"><a href="/net/unixsock_posix.go.html#1529136">a</a></span><span class="op" id="1529271">.</span><span class="ident" id="1529272">Name</span><span class="op" id="1529276">}</span><span class="op" id="1529277">,</span>&nbsp;<span class="ident" id="1529279">nil</span><br>
<span class="lineno"></span><span class="op" id="1529283">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="1529286">//&nbsp;UnixConn&nbsp;is&nbsp;an&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;interface&nbsp;for&nbsp;connections</span><br>
<span class="lineno"></span><span class="comment" id="1529357">//&nbsp;to&nbsp;Unix&nbsp;domain&nbsp;sockets.</span><br>
<span class="lineno"></span><span class="keyword" id="1529384">type</span>&nbsp;<span class="ident" id="1529389">UnixConn</span>&nbsp;<span class="keyword" id="1529398">struct</span>&nbsp;<span class="op" id="1529405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1529408"><a href="/net/net.go.html#1467102">conn</a></span><br>
<span class="lineno">105</span><span class="op" id="1529413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1529416">func</span>&nbsp;<span class="ident" id="1529421">newUnixConn</span><span class="op" id="1529432">(</span><span class="ident" id="1529433">fd</span>&nbsp;<span class="op" id="1529436">*</span><span class="ident" id="1529437"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><span class="op" id="1529442">)</span>&nbsp;<span class="op" id="1529444">*</span><span class="ident" id="1529445"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span>&nbsp;<span class="op" id="1529454">{</span>&nbsp;<span class="keyword" id="1529456">return</span>&nbsp;<span class="op" id="1529463">&amp;</span><span class="ident" id="1529464"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1529472">{</span><span class="ident" id="1529473"><a href="/net/net.go.html#1467102">conn</a></span><span class="op" id="1529477">{</span><span class="ident" id="1529478"><a href="/net/unixsock_posix.go.html#1529433">fd</a></span><span class="op" id="1529480">}</span><span class="op" id="1529481">}</span>&nbsp;<span class="op" id="1529483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1529486">//&nbsp;ReadFromUnix&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.&nbsp;&nbsp;It</span><br>
<span class="lineno">110</span><span class="comment" id="1529557">//&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1529628">//&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="1529643">//</span><br>
<span class="lineno"></span><span class="comment" id="1529646">//&nbsp;ReadFromUnix&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="1529711">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="1529778">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno"></span><span class="keyword" id="1529798">func</span>&nbsp;<span class="op" id="1529803">(</span><span class="ident" id="1529804">c</span>&nbsp;<span class="op" id="1529806">*</span><span class="ident" id="1529807"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1529815">)</span>&nbsp;<span class="ident" id="1529817">ReadFromUnix</span><span class="op" id="1529829">(</span><span class="ident" id="1529830">b</span>&nbsp;<span class="op" id="1529832">[</span><span class="op" id="1529833">]</span><span class="builtintype" id="1529834">byte</span><span class="op" id="1529838">)</span>&nbsp;<span class="op" id="1529840">(</span><span class="ident" id="1529841">n</span>&nbsp;<span class="builtintype" id="1529843">int</span><span class="op" id="1529846">,</span>&nbsp;<span class="ident" id="1529848">addr</span>&nbsp;<span class="op" id="1529853">*</span><span class="ident" id="1529854"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1529862">,</span>&nbsp;<span class="ident" id="1529864">err</span>&nbsp;<span class="builtintype" id="1529868">error</span><span class="op" id="1529873">)</span>&nbsp;<span class="op" id="1529875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529878">if</span>&nbsp;<span class="op" id="1529881">!</span><span class="ident" id="1529882"><a href="/net/unixsock_posix.go.html#1529804">c</a></span><span class="op" id="1529883">.</span><span class="ident" id="1529884">ok</span><span class="op" id="1529886">(</span><span class="op" id="1529887">)</span>&nbsp;<span class="op" id="1529889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529893">return</span>&nbsp;<span class="num" id="1529900">0</span><span class="op" id="1529901">,</span>&nbsp;<span class="ident" id="1529903">nil</span><span class="op" id="1529906">,</span>&nbsp;<span class="ident" id="1529908"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1529915">.</span><span class="ident" id="1529916">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1529924">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1529927"><a href="/net/unixsock_posix.go.html#1529841">n</a></span><span class="op" id="1529928">,</span>&nbsp;<span class="ident" id="1529930">sa</span><span class="op" id="1529932">,</span>&nbsp;<span class="ident" id="1529934"><a href="/net/unixsock_posix.go.html#1529864">err</a></span>&nbsp;<span class="op" id="1529938">:=</span>&nbsp;<span class="ident" id="1529941"><a href="/net/unixsock_posix.go.html#1529804">c</a></span><span class="op" id="1529942">.</span><span class="ident" id="1529943">fd</span><span class="op" id="1529945">.</span><span class="ident" id="1529946">readFrom</span><span class="op" id="1529954">(</span><span class="ident" id="1529955"><a href="/net/unixsock_posix.go.html#1529830">b</a></span><span class="op" id="1529956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529959">switch</span>&nbsp;<span class="ident" id="1529966">sa</span>&nbsp;<span class="op" id="1529969">:=</span>&nbsp;<span class="ident" id="1529972"><a href="/net/unixsock_posix.go.html#1529930">sa</a></span><span class="op" id="1529974">.</span><span class="op" id="1529975">(</span><span class="keyword" id="1529976">type</span><span class="op" id="1529980">)</span>&nbsp;<span class="op" id="1529982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1529985">case</span>&nbsp;<span class="op" id="1529990">*</span><span class="ident" id="1529991"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1529998">.</span><span class="ident" id="1529999">SockaddrUnix</span><span class="op" id="1530011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530015">if</span>&nbsp;<span class="ident" id="1530018"><a href="/net/unixsock_posix.go.html#1529966">sa</a></span><span class="op" id="1530020">.</span><span class="ident" id="1530021">Name</span>&nbsp;<span class="op" id="1530026">!=</span>&nbsp;<span class="string" id="1530029">&#34;&#34;</span>&nbsp;<span class="op" id="1530032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1530037"><a href="/net/unixsock_posix.go.html#1529848">addr</a></span>&nbsp;<span class="op" id="1530042">=</span>&nbsp;<span class="op" id="1530044">&amp;</span><span class="ident" id="1530045"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1530053">{</span><span class="ident" id="1530054">Name</span><span class="op" id="1530058">:</span>&nbsp;<span class="ident" id="1530060"><a href="/net/unixsock_posix.go.html#1529966">sa</a></span><span class="op" id="1530062">.</span><span class="ident" id="1530063">Name</span><span class="op" id="1530067">,</span>&nbsp;<span class="ident" id="1530069">Net</span><span class="op" id="1530072">:</span>&nbsp;<span class="ident" id="1530074"><a href="/net/unixsock_posix.go.html#1528744">sotypeToNet</a></span><span class="op" id="1530085">(</span><span class="ident" id="1530086"><a href="/net/unixsock_posix.go.html#1529804">c</a></span><span class="op" id="1530087">.</span><span class="ident" id="1530088">fd</span><span class="op" id="1530090">.</span><span class="ident" id="1530091">sotype</span><span class="op" id="1530097">)</span><span class="op" id="1530098">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530108">return</span><br>
<span class="lineno"></span><span class="op" id="1530115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="1530118">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1530173">func</span>&nbsp;<span class="op" id="1530178">(</span><span class="ident" id="1530179">c</span>&nbsp;<span class="op" id="1530181">*</span><span class="ident" id="1530182"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1530190">)</span>&nbsp;<span class="ident" id="1530192">ReadFrom</span><span class="op" id="1530200">(</span><span class="ident" id="1530201">b</span>&nbsp;<span class="op" id="1530203">[</span><span class="op" id="1530204">]</span><span class="builtintype" id="1530205">byte</span><span class="op" id="1530209">)</span>&nbsp;<span class="op" id="1530211">(</span><span class="builtintype" id="1530212">int</span><span class="op" id="1530215">,</span>&nbsp;<span class="ident" id="1530217"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1530221">,</span>&nbsp;<span class="builtintype" id="1530223">error</span><span class="op" id="1530228">)</span>&nbsp;<span class="op" id="1530230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530233">if</span>&nbsp;<span class="op" id="1530236">!</span><span class="ident" id="1530237"><a href="/net/unixsock_posix.go.html#1530179">c</a></span><span class="op" id="1530238">.</span><span class="ident" id="1530239">ok</span><span class="op" id="1530241">(</span><span class="op" id="1530242">)</span>&nbsp;<span class="op" id="1530244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530248">return</span>&nbsp;<span class="num" id="1530255">0</span><span class="op" id="1530256">,</span>&nbsp;<span class="ident" id="1530258">nil</span><span class="op" id="1530261">,</span>&nbsp;<span class="ident" id="1530263"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1530270">.</span><span class="ident" id="1530271">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530279">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1530282">n</span><span class="op" id="1530283">,</span>&nbsp;<span class="ident" id="1530285">addr</span><span class="op" id="1530289">,</span>&nbsp;<span class="ident" id="1530291">err</span>&nbsp;<span class="op" id="1530295">:=</span>&nbsp;<span class="ident" id="1530298"><a href="/net/unixsock_posix.go.html#1530179">c</a></span><span class="op" id="1530299">.</span><span class="ident" id="1530300">ReadFromUnix</span><span class="op" id="1530312">(</span><span class="ident" id="1530313"><a href="/net/unixsock_posix.go.html#1530201">b</a></span><span class="op" id="1530314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530317">return</span>&nbsp;<span class="ident" id="1530324"><a href="/net/unixsock_posix.go.html#1530282">n</a></span><span class="op" id="1530325">,</span>&nbsp;<span class="ident" id="1530327"><a href="/net/unixsock_posix.go.html#1530285">addr</a></span><span class="op" id="1530331">.</span><span class="ident" id="1530332">toAddr</span><span class="op" id="1530338">(</span><span class="op" id="1530339">)</span><span class="op" id="1530340">,</span>&nbsp;<span class="ident" id="1530342"><a href="/net/unixsock_posix.go.html#1530291">err</a></span><br>
<span class="lineno"></span><span class="op" id="1530346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1530349">//&nbsp;ReadMsgUnix&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="1530418">//&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="1530489">//&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the&nbsp;flags</span><br>
<span class="lineno"></span><span class="comment" id="1530560">//&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet,&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="keyword" id="1530630">func</span>&nbsp;<span class="op" id="1530635">(</span><span class="ident" id="1530636">c</span>&nbsp;<span class="op" id="1530638">*</span><span class="ident" id="1530639"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1530647">)</span>&nbsp;<span class="ident" id="1530649">ReadMsgUnix</span><span class="op" id="1530660">(</span><span class="ident" id="1530661">b</span><span class="op" id="1530662">,</span>&nbsp;<span class="ident" id="1530664">oob</span>&nbsp;<span class="op" id="1530668">[</span><span class="op" id="1530669">]</span><span class="builtintype" id="1530670">byte</span><span class="op" id="1530674">)</span>&nbsp;<span class="op" id="1530676">(</span><span class="ident" id="1530677">n</span><span class="op" id="1530678">,</span>&nbsp;<span class="ident" id="1530680">oobn</span><span class="op" id="1530684">,</span>&nbsp;<span class="ident" id="1530686">flags</span>&nbsp;<span class="builtintype" id="1530692">int</span><span class="op" id="1530695">,</span>&nbsp;<span class="ident" id="1530697">addr</span>&nbsp;<span class="op" id="1530702">*</span><span class="ident" id="1530703"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1530711">,</span>&nbsp;<span class="ident" id="1530713">err</span>&nbsp;<span class="builtintype" id="1530717">error</span><span class="op" id="1530722">)</span>&nbsp;<span class="op" id="1530724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530727">if</span>&nbsp;<span class="op" id="1530730">!</span><span class="ident" id="1530731"><a href="/net/unixsock_posix.go.html#1530636">c</a></span><span class="op" id="1530732">.</span><span class="ident" id="1530733">ok</span><span class="op" id="1530735">(</span><span class="op" id="1530736">)</span>&nbsp;<span class="op" id="1530738">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530742">return</span>&nbsp;<span class="num" id="1530749">0</span><span class="op" id="1530750">,</span>&nbsp;<span class="num" id="1530752">0</span><span class="op" id="1530753">,</span>&nbsp;<span class="num" id="1530755">0</span><span class="op" id="1530756">,</span>&nbsp;<span class="ident" id="1530758">nil</span><span class="op" id="1530761">,</span>&nbsp;<span class="ident" id="1530763"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1530770">.</span><span class="ident" id="1530771">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1530782"><a href="/net/unixsock_posix.go.html#1530677">n</a></span><span class="op" id="1530783">,</span>&nbsp;<span class="ident" id="1530785"><a href="/net/unixsock_posix.go.html#1530680">oobn</a></span><span class="op" id="1530789">,</span>&nbsp;<span class="ident" id="1530791"><a href="/net/unixsock_posix.go.html#1530686">flags</a></span><span class="op" id="1530796">,</span>&nbsp;<span class="ident" id="1530798">sa</span><span class="op" id="1530800">,</span>&nbsp;<span class="ident" id="1530802"><a href="/net/unixsock_posix.go.html#1530713">err</a></span>&nbsp;<span class="op" id="1530806">:=</span>&nbsp;<span class="ident" id="1530809"><a href="/net/unixsock_posix.go.html#1530636">c</a></span><span class="op" id="1530810">.</span><span class="ident" id="1530811">fd</span><span class="op" id="1530813">.</span><span class="ident" id="1530814">readMsg</span><span class="op" id="1530821">(</span><span class="ident" id="1530822"><a href="/net/unixsock_posix.go.html#1530661">b</a></span><span class="op" id="1530823">,</span>&nbsp;<span class="ident" id="1530825"><a href="/net/unixsock_posix.go.html#1530664">oob</a></span><span class="op" id="1530828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530831">switch</span>&nbsp;<span class="ident" id="1530838">sa</span>&nbsp;<span class="op" id="1530841">:=</span>&nbsp;<span class="ident" id="1530844"><a href="/net/unixsock_posix.go.html#1530798">sa</a></span><span class="op" id="1530846">.</span><span class="op" id="1530847">(</span><span class="keyword" id="1530848">type</span><span class="op" id="1530852">)</span>&nbsp;<span class="op" id="1530854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530857">case</span>&nbsp;<span class="op" id="1530862">*</span><span class="ident" id="1530863"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1530870">.</span><span class="ident" id="1530871">SockaddrUnix</span><span class="op" id="1530883">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530887">if</span>&nbsp;<span class="ident" id="1530890"><a href="/net/unixsock_posix.go.html#1530838">sa</a></span><span class="op" id="1530892">.</span><span class="ident" id="1530893">Name</span>&nbsp;<span class="op" id="1530898">!=</span>&nbsp;<span class="string" id="1530901">&#34;&#34;</span>&nbsp;<span class="op" id="1530904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1530909"><a href="/net/unixsock_posix.go.html#1530697">addr</a></span>&nbsp;<span class="op" id="1530914">=</span>&nbsp;<span class="op" id="1530916">&amp;</span><span class="ident" id="1530917"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1530925">{</span><span class="ident" id="1530926">Name</span><span class="op" id="1530930">:</span>&nbsp;<span class="ident" id="1530932"><a href="/net/unixsock_posix.go.html#1530838">sa</a></span><span class="op" id="1530934">.</span><span class="ident" id="1530935">Name</span><span class="op" id="1530939">,</span>&nbsp;<span class="ident" id="1530941">Net</span><span class="op" id="1530944">:</span>&nbsp;<span class="ident" id="1530946"><a href="/net/unixsock_posix.go.html#1528744">sotypeToNet</a></span><span class="op" id="1530957">(</span><span class="ident" id="1530958"><a href="/net/unixsock_posix.go.html#1530636">c</a></span><span class="op" id="1530959">.</span><span class="ident" id="1530960">fd</span><span class="op" id="1530962">.</span><span class="ident" id="1530963">sotype</span><span class="op" id="1530969">)</span><span class="op" id="1530970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1530977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1530980">return</span><br>
<span class="lineno">155</span><span class="op" id="1530987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1530990">//&nbsp;WriteToUnix&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="1531064">//</span><br>
<span class="lineno"></span><span class="comment" id="1531067">//&nbsp;WriteToUnix&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno">160</span><span class="comment" id="1531131">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1531198">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="1531267">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="1531280">func</span>&nbsp;<span class="op" id="1531285">(</span><span class="ident" id="1531286">c</span>&nbsp;<span class="op" id="1531288">*</span><span class="ident" id="1531289"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1531297">)</span>&nbsp;<span class="ident" id="1531299">WriteToUnix</span><span class="op" id="1531310">(</span><span class="ident" id="1531311">b</span>&nbsp;<span class="op" id="1531313">[</span><span class="op" id="1531314">]</span><span class="builtintype" id="1531315">byte</span><span class="op" id="1531319">,</span>&nbsp;<span class="ident" id="1531321">addr</span>&nbsp;<span class="op" id="1531326">*</span><span class="ident" id="1531327"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1531335">)</span>&nbsp;<span class="op" id="1531337">(</span><span class="ident" id="1531338">n</span>&nbsp;<span class="builtintype" id="1531340">int</span><span class="op" id="1531343">,</span>&nbsp;<span class="ident" id="1531345">err</span>&nbsp;<span class="builtintype" id="1531349">error</span><span class="op" id="1531354">)</span>&nbsp;<span class="op" id="1531356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531359">if</span>&nbsp;<span class="op" id="1531362">!</span><span class="ident" id="1531363"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531364">.</span><span class="ident" id="1531365">ok</span><span class="op" id="1531367">(</span><span class="op" id="1531368">)</span>&nbsp;<span class="op" id="1531370">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531374">return</span>&nbsp;<span class="num" id="1531381">0</span><span class="op" id="1531382">,</span>&nbsp;<span class="ident" id="1531384"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1531391">.</span><span class="ident" id="1531392">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1531400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531403">if</span>&nbsp;<span class="ident" id="1531406"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531407">.</span><span class="ident" id="1531408">fd</span><span class="op" id="1531410">.</span><span class="ident" id="1531411">isConnected</span>&nbsp;<span class="op" id="1531423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531427">return</span>&nbsp;<span class="num" id="1531434">0</span><span class="op" id="1531435">,</span>&nbsp;<span class="op" id="1531437">&amp;</span><span class="ident" id="1531438"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1531445">{</span><span class="ident" id="1531446">Op</span><span class="op" id="1531448">:</span>&nbsp;<span class="string" id="1531450">&#34;write&#34;</span><span class="op" id="1531457">,</span>&nbsp;<span class="ident" id="1531459">Net</span><span class="op" id="1531462">:</span>&nbsp;<span class="ident" id="1531464"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531465">.</span><span class="ident" id="1531466">fd</span><span class="op" id="1531468">.</span><span class="ident" id="1531469">net</span><span class="op" id="1531472">,</span>&nbsp;<span class="ident" id="1531474">Addr</span><span class="op" id="1531478">:</span>&nbsp;<span class="ident" id="1531480"><a href="/net/unixsock_posix.go.html#1531321">addr</a></span><span class="op" id="1531484">,</span>&nbsp;<span class="ident" id="1531486">Err</span><span class="op" id="1531489">:</span>&nbsp;<span class="ident" id="1531491"><a href="/net/net.go.html#1472233">ErrWriteToConnected</a></span><span class="op" id="1531510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1531513">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531516">if</span>&nbsp;<span class="ident" id="1531519"><a href="/net/unixsock_posix.go.html#1531321">addr</a></span>&nbsp;<span class="op" id="1531524">==</span>&nbsp;<span class="ident" id="1531527">nil</span>&nbsp;<span class="op" id="1531531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531535">return</span>&nbsp;<span class="num" id="1531542">0</span><span class="op" id="1531543">,</span>&nbsp;<span class="op" id="1531545">&amp;</span><span class="ident" id="1531546"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1531553">{</span><span class="ident" id="1531554">Op</span><span class="op" id="1531556">:</span>&nbsp;<span class="string" id="1531558">&#34;write&#34;</span><span class="op" id="1531565">,</span>&nbsp;<span class="ident" id="1531567">Net</span><span class="op" id="1531570">:</span>&nbsp;<span class="ident" id="1531572"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531573">.</span><span class="ident" id="1531574">fd</span><span class="op" id="1531576">.</span><span class="ident" id="1531577">net</span><span class="op" id="1531580">,</span>&nbsp;<span class="ident" id="1531582">Addr</span><span class="op" id="1531586">:</span>&nbsp;<span class="ident" id="1531588">nil</span><span class="op" id="1531591">,</span>&nbsp;<span class="ident" id="1531593">Err</span><span class="op" id="1531596">:</span>&nbsp;<span class="ident" id="1531598"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1531615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1531618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531621">if</span>&nbsp;<span class="ident" id="1531624"><a href="/net/unixsock_posix.go.html#1531321">addr</a></span><span class="op" id="1531628">.</span><span class="ident" id="1531629">Net</span>&nbsp;<span class="op" id="1531633">!=</span>&nbsp;<span class="ident" id="1531636"><a href="/net/unixsock_posix.go.html#1528744">sotypeToNet</a></span><span class="op" id="1531647">(</span><span class="ident" id="1531648"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531649">.</span><span class="ident" id="1531650">fd</span><span class="op" id="1531652">.</span><span class="ident" id="1531653">sotype</span><span class="op" id="1531659">)</span>&nbsp;<span class="op" id="1531661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531665">return</span>&nbsp;<span class="num" id="1531672">0</span><span class="op" id="1531673">,</span>&nbsp;<span class="ident" id="1531675"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1531682">.</span><span class="ident" id="1531683">EAFNOSUPPORT</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1531697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1531700">sa</span>&nbsp;<span class="op" id="1531703">:=</span>&nbsp;<span class="op" id="1531706">&amp;</span><span class="ident" id="1531707"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1531714">.</span><span class="ident" id="1531715">SockaddrUnix</span><span class="op" id="1531727">{</span><span class="ident" id="1531728">Name</span><span class="op" id="1531732">:</span>&nbsp;<span class="ident" id="1531734"><a href="/net/unixsock_posix.go.html#1531321">addr</a></span><span class="op" id="1531738">.</span><span class="ident" id="1531739">Name</span><span class="op" id="1531743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531746">return</span>&nbsp;<span class="ident" id="1531753"><a href="/net/unixsock_posix.go.html#1531286">c</a></span><span class="op" id="1531754">.</span><span class="ident" id="1531755">fd</span><span class="op" id="1531757">.</span><span class="ident" id="1531758">writeTo</span><span class="op" id="1531765">(</span><span class="ident" id="1531766"><a href="/net/unixsock_posix.go.html#1531311">b</a></span><span class="op" id="1531767">,</span>&nbsp;<span class="ident" id="1531769"><a href="/net/unixsock_posix.go.html#1531700">sa</a></span><span class="op" id="1531771">)</span><br>
<span class="lineno"></span><span class="op" id="1531773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="1531776">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="1531829">func</span>&nbsp;<span class="op" id="1531834">(</span><span class="ident" id="1531835">c</span>&nbsp;<span class="op" id="1531837">*</span><span class="ident" id="1531838"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1531846">)</span>&nbsp;<span class="ident" id="1531848">WriteTo</span><span class="op" id="1531855">(</span><span class="ident" id="1531856">b</span>&nbsp;<span class="op" id="1531858">[</span><span class="op" id="1531859">]</span><span class="builtintype" id="1531860">byte</span><span class="op" id="1531864">,</span>&nbsp;<span class="ident" id="1531866">addr</span>&nbsp;<span class="ident" id="1531871"><a href="/net/net.go.html#1465097">Addr</a></span><span class="op" id="1531875">)</span>&nbsp;<span class="op" id="1531877">(</span><span class="ident" id="1531878">n</span>&nbsp;<span class="builtintype" id="1531880">int</span><span class="op" id="1531883">,</span>&nbsp;<span class="ident" id="1531885">err</span>&nbsp;<span class="builtintype" id="1531889">error</span><span class="op" id="1531894">)</span>&nbsp;<span class="op" id="1531896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531899">if</span>&nbsp;<span class="op" id="1531902">!</span><span class="ident" id="1531903"><a href="/net/unixsock_posix.go.html#1531835">c</a></span><span class="op" id="1531904">.</span><span class="ident" id="1531905">ok</span><span class="op" id="1531907">(</span><span class="op" id="1531908">)</span>&nbsp;<span class="op" id="1531910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531914">return</span>&nbsp;<span class="num" id="1531921">0</span><span class="op" id="1531922">,</span>&nbsp;<span class="ident" id="1531924"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1531931">.</span><span class="ident" id="1531932">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1531940">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1531943">a</span><span class="op" id="1531944">,</span>&nbsp;<span class="ident" id="1531946">ok</span>&nbsp;<span class="op" id="1531949">:=</span>&nbsp;<span class="ident" id="1531952"><a href="/net/unixsock_posix.go.html#1531866">addr</a></span><span class="op" id="1531956">.</span><span class="op" id="1531957">(</span><span class="op" id="1531958">*</span><span class="ident" id="1531959"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1531967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531970">if</span>&nbsp;<span class="op" id="1531973">!</span><span class="ident" id="1531974"><a href="/net/unixsock_posix.go.html#1531946">ok</a></span>&nbsp;<span class="op" id="1531977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1531981">return</span>&nbsp;<span class="num" id="1531988">0</span><span class="op" id="1531989">,</span>&nbsp;<span class="op" id="1531991">&amp;</span><span class="ident" id="1531992"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1531999">{</span><span class="string" id="1532000">&#34;write&#34;</span><span class="op" id="1532007">,</span>&nbsp;<span class="ident" id="1532009"><a href="/net/unixsock_posix.go.html#1531835">c</a></span><span class="op" id="1532010">.</span><span class="ident" id="1532011">fd</span><span class="op" id="1532013">.</span><span class="ident" id="1532014">net</span><span class="op" id="1532017">,</span>&nbsp;<span class="ident" id="1532019"><a href="/net/unixsock_posix.go.html#1531866">addr</a></span><span class="op" id="1532023">,</span>&nbsp;<span class="ident" id="1532025"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532032">.</span><span class="ident" id="1532033">EINVAL</span><span class="op" id="1532039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532045">return</span>&nbsp;<span class="ident" id="1532052"><a href="/net/unixsock_posix.go.html#1531835">c</a></span><span class="op" id="1532053">.</span><span class="ident" id="1532054">WriteToUnix</span><span class="op" id="1532065">(</span><span class="ident" id="1532066"><a href="/net/unixsock_posix.go.html#1531856">b</a></span><span class="op" id="1532067">,</span>&nbsp;<span class="ident" id="1532069"><a href="/net/unixsock_posix.go.html#1531943">a</a></span><span class="op" id="1532070">)</span><br>
<span class="lineno">190</span><span class="op" id="1532072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1532075">//&nbsp;WriteMsgUnix&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="1532142">//&nbsp;from&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="1532210">//&nbsp;the&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">195</span><span class="keyword" id="1532266">func</span>&nbsp;<span class="op" id="1532271">(</span><span class="ident" id="1532272">c</span>&nbsp;<span class="op" id="1532274">*</span><span class="ident" id="1532275"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1532283">)</span>&nbsp;<span class="ident" id="1532285">WriteMsgUnix</span><span class="op" id="1532297">(</span><span class="ident" id="1532298">b</span><span class="op" id="1532299">,</span>&nbsp;<span class="ident" id="1532301">oob</span>&nbsp;<span class="op" id="1532305">[</span><span class="op" id="1532306">]</span><span class="builtintype" id="1532307">byte</span><span class="op" id="1532311">,</span>&nbsp;<span class="ident" id="1532313">addr</span>&nbsp;<span class="op" id="1532318">*</span><span class="ident" id="1532319"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1532327">)</span>&nbsp;<span class="op" id="1532329">(</span><span class="ident" id="1532330">n</span><span class="op" id="1532331">,</span>&nbsp;<span class="ident" id="1532333">oobn</span>&nbsp;<span class="builtintype" id="1532338">int</span><span class="op" id="1532341">,</span>&nbsp;<span class="ident" id="1532343">err</span>&nbsp;<span class="builtintype" id="1532347">error</span><span class="op" id="1532352">)</span>&nbsp;<span class="op" id="1532354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532357">if</span>&nbsp;<span class="op" id="1532360">!</span><span class="ident" id="1532361"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532362">.</span><span class="ident" id="1532363">ok</span><span class="op" id="1532365">(</span><span class="op" id="1532366">)</span>&nbsp;<span class="op" id="1532368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532372">return</span>&nbsp;<span class="num" id="1532379">0</span><span class="op" id="1532380">,</span>&nbsp;<span class="num" id="1532382">0</span><span class="op" id="1532383">,</span>&nbsp;<span class="ident" id="1532385"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532392">.</span><span class="ident" id="1532393">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532404">if</span>&nbsp;<span class="ident" id="1532407"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532408">.</span><span class="ident" id="1532409">fd</span><span class="op" id="1532411">.</span><span class="ident" id="1532412">sotype</span>&nbsp;<span class="op" id="1532419">==</span>&nbsp;<span class="ident" id="1532422"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532429">.</span><span class="ident" id="1532430">SOCK_DGRAM</span>&nbsp;<span class="op" id="1532441">&amp;&amp;</span>&nbsp;<span class="ident" id="1532444"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532445">.</span><span class="ident" id="1532446">fd</span><span class="op" id="1532448">.</span><span class="ident" id="1532449">isConnected</span>&nbsp;<span class="op" id="1532461">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532465">return</span>&nbsp;<span class="num" id="1532472">0</span><span class="op" id="1532473">,</span>&nbsp;<span class="num" id="1532475">0</span><span class="op" id="1532476">,</span>&nbsp;<span class="op" id="1532478">&amp;</span><span class="ident" id="1532479"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1532486">{</span><span class="ident" id="1532487">Op</span><span class="op" id="1532489">:</span>&nbsp;<span class="string" id="1532491">&#34;write&#34;</span><span class="op" id="1532498">,</span>&nbsp;<span class="ident" id="1532500">Net</span><span class="op" id="1532503">:</span>&nbsp;<span class="ident" id="1532505"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532506">.</span><span class="ident" id="1532507">fd</span><span class="op" id="1532509">.</span><span class="ident" id="1532510">net</span><span class="op" id="1532513">,</span>&nbsp;<span class="ident" id="1532515">Addr</span><span class="op" id="1532519">:</span>&nbsp;<span class="ident" id="1532521"><a href="/net/unixsock_posix.go.html#1532313">addr</a></span><span class="op" id="1532525">,</span>&nbsp;<span class="ident" id="1532527">Err</span><span class="op" id="1532530">:</span>&nbsp;<span class="ident" id="1532532"><a href="/net/net.go.html#1472233">ErrWriteToConnected</a></span><span class="op" id="1532551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532557">if</span>&nbsp;<span class="ident" id="1532560"><a href="/net/unixsock_posix.go.html#1532313">addr</a></span>&nbsp;<span class="op" id="1532565">!=</span>&nbsp;<span class="ident" id="1532568">nil</span>&nbsp;<span class="op" id="1532572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532576">if</span>&nbsp;<span class="ident" id="1532579"><a href="/net/unixsock_posix.go.html#1532313">addr</a></span><span class="op" id="1532583">.</span><span class="ident" id="1532584">Net</span>&nbsp;<span class="op" id="1532588">!=</span>&nbsp;<span class="ident" id="1532591"><a href="/net/unixsock_posix.go.html#1528744">sotypeToNet</a></span><span class="op" id="1532602">(</span><span class="ident" id="1532603"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532604">.</span><span class="ident" id="1532605">fd</span><span class="op" id="1532607">.</span><span class="ident" id="1532608">sotype</span><span class="op" id="1532614">)</span>&nbsp;<span class="op" id="1532616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532621">return</span>&nbsp;<span class="num" id="1532628">0</span><span class="op" id="1532629">,</span>&nbsp;<span class="num" id="1532631">0</span><span class="op" id="1532632">,</span>&nbsp;<span class="ident" id="1532634"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532641">.</span><span class="ident" id="1532642">EAFNOSUPPORT</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1532661">sa</span>&nbsp;<span class="op" id="1532664">:=</span>&nbsp;<span class="op" id="1532667">&amp;</span><span class="ident" id="1532668"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532675">.</span><span class="ident" id="1532676">SockaddrUnix</span><span class="op" id="1532688">{</span><span class="ident" id="1532689">Name</span><span class="op" id="1532693">:</span>&nbsp;<span class="ident" id="1532695"><a href="/net/unixsock_posix.go.html#1532313">addr</a></span><span class="op" id="1532699">.</span><span class="ident" id="1532700">Name</span><span class="op" id="1532704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532708">return</span>&nbsp;<span class="ident" id="1532715"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532716">.</span><span class="ident" id="1532717">fd</span><span class="op" id="1532719">.</span><span class="ident" id="1532720">writeMsg</span><span class="op" id="1532728">(</span><span class="ident" id="1532729"><a href="/net/unixsock_posix.go.html#1532298">b</a></span><span class="op" id="1532730">,</span>&nbsp;<span class="ident" id="1532732"><a href="/net/unixsock_posix.go.html#1532301">oob</a></span><span class="op" id="1532735">,</span>&nbsp;<span class="ident" id="1532737"><a href="/net/unixsock_posix.go.html#1532661">sa</a></span><span class="op" id="1532739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532745">return</span>&nbsp;<span class="ident" id="1532752"><a href="/net/unixsock_posix.go.html#1532272">c</a></span><span class="op" id="1532753">.</span><span class="ident" id="1532754">fd</span><span class="op" id="1532756">.</span><span class="ident" id="1532757">writeMsg</span><span class="op" id="1532765">(</span><span class="ident" id="1532766"><a href="/net/unixsock_posix.go.html#1532298">b</a></span><span class="op" id="1532767">,</span>&nbsp;<span class="ident" id="1532769"><a href="/net/unixsock_posix.go.html#1532301">oob</a></span><span class="op" id="1532772">,</span>&nbsp;<span class="ident" id="1532774">nil</span><span class="op" id="1532777">)</span><br>
<span class="lineno">210</span><span class="op" id="1532779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1532782">//&nbsp;CloseRead&nbsp;shuts&nbsp;down&nbsp;the&nbsp;reading&nbsp;side&nbsp;of&nbsp;the&nbsp;Unix&nbsp;domain&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="1532854">//&nbsp;Most&nbsp;callers&nbsp;should&nbsp;just&nbsp;use&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="1532893">func</span>&nbsp;<span class="op" id="1532898">(</span><span class="ident" id="1532899">c</span>&nbsp;<span class="op" id="1532901">*</span><span class="ident" id="1532902"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1532910">)</span>&nbsp;<span class="ident" id="1532912">CloseRead</span><span class="op" id="1532921">(</span><span class="op" id="1532922">)</span>&nbsp;<span class="builtintype" id="1532924">error</span>&nbsp;<span class="op" id="1532930">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532933">if</span>&nbsp;<span class="op" id="1532936">!</span><span class="ident" id="1532937"><a href="/net/unixsock_posix.go.html#1532899">c</a></span><span class="op" id="1532938">.</span><span class="ident" id="1532939">ok</span><span class="op" id="1532941">(</span><span class="op" id="1532942">)</span>&nbsp;<span class="op" id="1532944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532948">return</span>&nbsp;<span class="ident" id="1532955"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1532962">.</span><span class="ident" id="1532963">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1532971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1532974">return</span>&nbsp;<span class="ident" id="1532981"><a href="/net/unixsock_posix.go.html#1532899">c</a></span><span class="op" id="1532982">.</span><span class="ident" id="1532983">fd</span><span class="op" id="1532985">.</span><span class="ident" id="1532986">closeRead</span><span class="op" id="1532995">(</span><span class="op" id="1532996">)</span><br>
<span class="lineno"></span><span class="op" id="1532998">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="1533001">//&nbsp;CloseWrite&nbsp;shuts&nbsp;down&nbsp;the&nbsp;writing&nbsp;side&nbsp;of&nbsp;the&nbsp;Unix&nbsp;domain&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="1533074">//&nbsp;Most&nbsp;callers&nbsp;should&nbsp;just&nbsp;use&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="1533113">func</span>&nbsp;<span class="op" id="1533118">(</span><span class="ident" id="1533119">c</span>&nbsp;<span class="op" id="1533121">*</span><span class="ident" id="1533122"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1533130">)</span>&nbsp;<span class="ident" id="1533132">CloseWrite</span><span class="op" id="1533142">(</span><span class="op" id="1533143">)</span>&nbsp;<span class="builtintype" id="1533145">error</span>&nbsp;<span class="op" id="1533151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533154">if</span>&nbsp;<span class="op" id="1533157">!</span><span class="ident" id="1533158"><a href="/net/unixsock_posix.go.html#1533119">c</a></span><span class="op" id="1533159">.</span><span class="ident" id="1533160">ok</span><span class="op" id="1533162">(</span><span class="op" id="1533163">)</span>&nbsp;<span class="op" id="1533165">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533169">return</span>&nbsp;<span class="ident" id="1533176"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1533183">.</span><span class="ident" id="1533184">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1533192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533195">return</span>&nbsp;<span class="ident" id="1533202"><a href="/net/unixsock_posix.go.html#1533119">c</a></span><span class="op" id="1533203">.</span><span class="ident" id="1533204">fd</span><span class="op" id="1533206">.</span><span class="ident" id="1533207">closeWrite</span><span class="op" id="1533217">(</span><span class="op" id="1533218">)</span><br>
<span class="lineno"></span><span class="op" id="1533220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="comment" id="1533223">//&nbsp;DialUnix&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;net,</span><br>
<span class="lineno"></span><span class="comment" id="1533292">//&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;unix&#34;,&nbsp;&#34;unixgram&#34;&nbsp;or&nbsp;&#34;unixpacket&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;is&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="1533362">//&nbsp;nil,&nbsp;it&nbsp;is&nbsp;used&nbsp;as&nbsp;the&nbsp;local&nbsp;address&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="1533422">func</span>&nbsp;<span class="ident" id="1533427">DialUnix</span><span class="op" id="1533435">(</span><span class="ident" id="1533436">net</span>&nbsp;<span class="builtintype" id="1533440">string</span><span class="op" id="1533446">,</span>&nbsp;<span class="ident" id="1533448">laddr</span><span class="op" id="1533453">,</span>&nbsp;<span class="ident" id="1533455">raddr</span>&nbsp;<span class="op" id="1533461">*</span><span class="ident" id="1533462"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1533470">)</span>&nbsp;<span class="op" id="1533472">(</span><span class="op" id="1533473">*</span><span class="ident" id="1533474"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1533482">,</span>&nbsp;<span class="builtintype" id="1533484">error</span><span class="op" id="1533489">)</span>&nbsp;<span class="op" id="1533491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533494">switch</span>&nbsp;<span class="ident" id="1533501"><a href="/net/unixsock_posix.go.html#1533436">net</a></span>&nbsp;<span class="op" id="1533505">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533508">case</span>&nbsp;<span class="string" id="1533513">&#34;unix&#34;</span><span class="op" id="1533519">,</span>&nbsp;<span class="string" id="1533521">&#34;unixgram&#34;</span><span class="op" id="1533531">,</span>&nbsp;<span class="string" id="1533533">&#34;unixpacket&#34;</span><span class="op" id="1533545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533548">default</span><span class="op" id="1533555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533559">return</span>&nbsp;<span class="ident" id="1533566">nil</span><span class="op" id="1533569">,</span>&nbsp;<span class="op" id="1533571">&amp;</span><span class="ident" id="1533572"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1533579">{</span><span class="ident" id="1533580">Op</span><span class="op" id="1533582">:</span>&nbsp;<span class="string" id="1533584">&#34;dial&#34;</span><span class="op" id="1533590">,</span>&nbsp;<span class="ident" id="1533592">Net</span><span class="op" id="1533595">:</span>&nbsp;<span class="ident" id="1533597"><a href="/net/unixsock_posix.go.html#1533436">net</a></span><span class="op" id="1533600">,</span>&nbsp;<span class="ident" id="1533602">Addr</span><span class="op" id="1533606">:</span>&nbsp;<span class="ident" id="1533608"><a href="/net/unixsock_posix.go.html#1533455">raddr</a></span><span class="op" id="1533613">,</span>&nbsp;<span class="ident" id="1533615">Err</span><span class="op" id="1533618">:</span>&nbsp;<span class="ident" id="1533620"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1533639">(</span><span class="ident" id="1533640"><a href="/net/unixsock_posix.go.html#1533436">net</a></span><span class="op" id="1533643">)</span><span class="op" id="1533644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1533647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533650">return</span>&nbsp;<span class="ident" id="1533657"><a href="/net/unixsock_posix.go.html#1533705">dialUnix</a></span><span class="op" id="1533665">(</span><span class="ident" id="1533666"><a href="/net/unixsock_posix.go.html#1533436">net</a></span><span class="op" id="1533669">,</span>&nbsp;<span class="ident" id="1533671"><a href="/net/unixsock_posix.go.html#1533448">laddr</a></span><span class="op" id="1533676">,</span>&nbsp;<span class="ident" id="1533678"><a href="/net/unixsock_posix.go.html#1533455">raddr</a></span><span class="op" id="1533683">,</span>&nbsp;<span class="ident" id="1533685"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="1533695">)</span><br>
<span class="lineno">240</span><span class="op" id="1533697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1533700">func</span>&nbsp;<span class="ident" id="1533705">dialUnix</span><span class="op" id="1533713">(</span><span class="ident" id="1533714">net</span>&nbsp;<span class="builtintype" id="1533718">string</span><span class="op" id="1533724">,</span>&nbsp;<span class="ident" id="1533726">laddr</span><span class="op" id="1533731">,</span>&nbsp;<span class="ident" id="1533733">raddr</span>&nbsp;<span class="op" id="1533739">*</span><span class="ident" id="1533740"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1533748">,</span>&nbsp;<span class="ident" id="1533750">deadline</span>&nbsp;<span class="ident" id="1533759"><a href="/net/unixsock_posix.go.html#1527425">time</a></span><span class="op" id="1533763">.</span><span class="ident" id="1533764">Time</span><span class="op" id="1533768">)</span>&nbsp;<span class="op" id="1533770">(</span><span class="op" id="1533771">*</span><span class="ident" id="1533772"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1533780">,</span>&nbsp;<span class="builtintype" id="1533782">error</span><span class="op" id="1533787">)</span>&nbsp;<span class="op" id="1533789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1533792">fd</span><span class="op" id="1533794">,</span>&nbsp;<span class="ident" id="1533796">err</span>&nbsp;<span class="op" id="1533800">:=</span>&nbsp;<span class="ident" id="1533803"><a href="/net/unixsock_posix.go.html#1527440">unixSocket</a></span><span class="op" id="1533813">(</span><span class="ident" id="1533814"><a href="/net/unixsock_posix.go.html#1533714">net</a></span><span class="op" id="1533817">,</span>&nbsp;<span class="ident" id="1533819"><a href="/net/unixsock_posix.go.html#1533726">laddr</a></span><span class="op" id="1533824">,</span>&nbsp;<span class="ident" id="1533826"><a href="/net/unixsock_posix.go.html#1533733">raddr</a></span><span class="op" id="1533831">,</span>&nbsp;<span class="string" id="1533833">&#34;dial&#34;</span><span class="op" id="1533839">,</span>&nbsp;<span class="ident" id="1533841"><a href="/net/unixsock_posix.go.html#1533750">deadline</a></span><span class="op" id="1533849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533852">if</span>&nbsp;<span class="ident" id="1533855"><a href="/net/unixsock_posix.go.html#1533796">err</a></span>&nbsp;<span class="op" id="1533859">!=</span>&nbsp;<span class="ident" id="1533862">nil</span>&nbsp;<span class="op" id="1533866">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533870">return</span>&nbsp;<span class="ident" id="1533877">nil</span><span class="op" id="1533880">,</span>&nbsp;<span class="op" id="1533882">&amp;</span><span class="ident" id="1533883"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1533890">{</span><span class="ident" id="1533891">Op</span><span class="op" id="1533893">:</span>&nbsp;<span class="string" id="1533895">&#34;dial&#34;</span><span class="op" id="1533901">,</span>&nbsp;<span class="ident" id="1533903">Net</span><span class="op" id="1533906">:</span>&nbsp;<span class="ident" id="1533908"><a href="/net/unixsock_posix.go.html#1533714">net</a></span><span class="op" id="1533911">,</span>&nbsp;<span class="ident" id="1533913">Addr</span><span class="op" id="1533917">:</span>&nbsp;<span class="ident" id="1533919"><a href="/net/unixsock_posix.go.html#1533733">raddr</a></span><span class="op" id="1533924">,</span>&nbsp;<span class="ident" id="1533926">Err</span><span class="op" id="1533929">:</span>&nbsp;<span class="ident" id="1533931"><a href="/net/unixsock_posix.go.html#1533796">err</a></span><span class="op" id="1533934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1533937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1533940">return</span>&nbsp;<span class="ident" id="1533947"><a href="/net/unixsock_posix.go.html#1529421">newUnixConn</a></span><span class="op" id="1533958">(</span><span class="ident" id="1533959"><a href="/net/unixsock_posix.go.html#1533792">fd</a></span><span class="op" id="1533961">)</span><span class="op" id="1533962">,</span>&nbsp;<span class="ident" id="1533964">nil</span><br>
<span class="lineno"></span><span class="op" id="1533968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="comment" id="1533971">//&nbsp;UnixListener&nbsp;is&nbsp;a&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;listener.&nbsp;&nbsp;Clients&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="1534037">//&nbsp;typically&nbsp;use&nbsp;variables&nbsp;of&nbsp;type&nbsp;Listener&nbsp;instead&nbsp;of&nbsp;assuming&nbsp;Unix</span><br>
<span class="lineno"></span><span class="comment" id="1534106">//&nbsp;domain&nbsp;sockets.</span><br>
<span class="lineno"></span><span class="keyword" id="1534125">type</span>&nbsp;<span class="ident" id="1534130">UnixListener</span>&nbsp;<span class="keyword" id="1534143">struct</span>&nbsp;<span class="op" id="1534150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1534153">fd</span>&nbsp;&nbsp;&nbsp;<span class="op" id="1534158">*</span><span class="ident" id="1534159"><a href="/net/fd_unix.go.html#1388279">netFD</a></span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1534166">path</span>&nbsp;<span class="builtintype" id="1534171">string</span><br>
<span class="lineno"></span><span class="op" id="1534178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1534181">//&nbsp;ListenUnix&nbsp;announces&nbsp;on&nbsp;the&nbsp;Unix&nbsp;domain&nbsp;socket&nbsp;laddr&nbsp;and&nbsp;returns&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="1534251">//&nbsp;Unix&nbsp;listener.&nbsp;&nbsp;The&nbsp;network&nbsp;net&nbsp;must&nbsp;be&nbsp;&#34;unix&#34;&nbsp;or&nbsp;&#34;unixpacket&#34;.</span><br>
<span class="lineno">260</span><span class="keyword" id="1534318">func</span>&nbsp;<span class="ident" id="1534323">ListenUnix</span><span class="op" id="1534333">(</span><span class="ident" id="1534334">net</span>&nbsp;<span class="builtintype" id="1534338">string</span><span class="op" id="1534344">,</span>&nbsp;<span class="ident" id="1534346">laddr</span>&nbsp;<span class="op" id="1534352">*</span><span class="ident" id="1534353"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1534361">)</span>&nbsp;<span class="op" id="1534363">(</span><span class="op" id="1534364">*</span><span class="ident" id="1534365"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1534377">,</span>&nbsp;<span class="builtintype" id="1534379">error</span><span class="op" id="1534384">)</span>&nbsp;<span class="op" id="1534386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534389">switch</span>&nbsp;<span class="ident" id="1534396"><a href="/net/unixsock_posix.go.html#1534334">net</a></span>&nbsp;<span class="op" id="1534400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534403">case</span>&nbsp;<span class="string" id="1534408">&#34;unix&#34;</span><span class="op" id="1534414">,</span>&nbsp;<span class="string" id="1534416">&#34;unixpacket&#34;</span><span class="op" id="1534428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534431">default</span><span class="op" id="1534438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534442">return</span>&nbsp;<span class="ident" id="1534449">nil</span><span class="op" id="1534452">,</span>&nbsp;<span class="op" id="1534454">&amp;</span><span class="ident" id="1534455"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1534462">{</span><span class="ident" id="1534463">Op</span><span class="op" id="1534465">:</span>&nbsp;<span class="string" id="1534467">&#34;listen&#34;</span><span class="op" id="1534475">,</span>&nbsp;<span class="ident" id="1534477">Net</span><span class="op" id="1534480">:</span>&nbsp;<span class="ident" id="1534482"><a href="/net/unixsock_posix.go.html#1534334">net</a></span><span class="op" id="1534485">,</span>&nbsp;<span class="ident" id="1534487">Addr</span><span class="op" id="1534491">:</span>&nbsp;<span class="ident" id="1534493"><a href="/net/unixsock_posix.go.html#1534346">laddr</a></span><span class="op" id="1534498">,</span>&nbsp;<span class="ident" id="1534500">Err</span><span class="op" id="1534503">:</span>&nbsp;<span class="ident" id="1534505"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1534524">(</span><span class="ident" id="1534525"><a href="/net/unixsock_posix.go.html#1534334">net</a></span><span class="op" id="1534528">)</span><span class="op" id="1534529">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1534532">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534535">if</span>&nbsp;<span class="ident" id="1534538"><a href="/net/unixsock_posix.go.html#1534346">laddr</a></span>&nbsp;<span class="op" id="1534544">==</span>&nbsp;<span class="ident" id="1534547">nil</span>&nbsp;<span class="op" id="1534551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534555">return</span>&nbsp;<span class="ident" id="1534562">nil</span><span class="op" id="1534565">,</span>&nbsp;<span class="op" id="1534567">&amp;</span><span class="ident" id="1534568"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1534575">{</span><span class="ident" id="1534576">Op</span><span class="op" id="1534578">:</span>&nbsp;<span class="string" id="1534580">&#34;listen&#34;</span><span class="op" id="1534588">,</span>&nbsp;<span class="ident" id="1534590">Net</span><span class="op" id="1534593">:</span>&nbsp;<span class="ident" id="1534595"><a href="/net/unixsock_posix.go.html#1534334">net</a></span><span class="op" id="1534598">,</span>&nbsp;<span class="ident" id="1534600">Addr</span><span class="op" id="1534604">:</span>&nbsp;<span class="ident" id="1534606">nil</span><span class="op" id="1534609">,</span>&nbsp;<span class="ident" id="1534611">Err</span><span class="op" id="1534614">:</span>&nbsp;<span class="ident" id="1534616"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1534633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1534636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1534639">fd</span><span class="op" id="1534641">,</span>&nbsp;<span class="ident" id="1534643">err</span>&nbsp;<span class="op" id="1534647">:=</span>&nbsp;<span class="ident" id="1534650"><a href="/net/unixsock_posix.go.html#1527440">unixSocket</a></span><span class="op" id="1534660">(</span><span class="ident" id="1534661"><a href="/net/unixsock_posix.go.html#1534334">net</a></span><span class="op" id="1534664">,</span>&nbsp;<span class="ident" id="1534666"><a href="/net/unixsock_posix.go.html#1534346">laddr</a></span><span class="op" id="1534671">,</span>&nbsp;<span class="ident" id="1534673">nil</span><span class="op" id="1534676">,</span>&nbsp;<span class="string" id="1534678">&#34;listen&#34;</span><span class="op" id="1534686">,</span>&nbsp;<span class="ident" id="1534688"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="1534698">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534701">if</span>&nbsp;<span class="ident" id="1534704"><a href="/net/unixsock_posix.go.html#1534643">err</a></span>&nbsp;<span class="op" id="1534708">!=</span>&nbsp;<span class="ident" id="1534711">nil</span>&nbsp;<span class="op" id="1534715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534719">return</span>&nbsp;<span class="ident" id="1534726">nil</span><span class="op" id="1534729">,</span>&nbsp;<span class="op" id="1534731">&amp;</span><span class="ident" id="1534732"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1534739">{</span><span class="ident" id="1534740">Op</span><span class="op" id="1534742">:</span>&nbsp;<span class="string" id="1534744">&#34;listen&#34;</span><span class="op" id="1534752">,</span>&nbsp;<span class="ident" id="1534754">Net</span><span class="op" id="1534757">:</span>&nbsp;<span class="ident" id="1534759"><a href="/net/unixsock_posix.go.html#1534334">net</a></span><span class="op" id="1534762">,</span>&nbsp;<span class="ident" id="1534764">Addr</span><span class="op" id="1534768">:</span>&nbsp;<span class="ident" id="1534770"><a href="/net/unixsock_posix.go.html#1534346">laddr</a></span><span class="op" id="1534775">,</span>&nbsp;<span class="ident" id="1534777">Err</span><span class="op" id="1534780">:</span>&nbsp;<span class="ident" id="1534782"><a href="/net/unixsock_posix.go.html#1534643">err</a></span><span class="op" id="1534785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1534788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534791">return</span>&nbsp;<span class="op" id="1534798">&amp;</span><span class="ident" id="1534799"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1534811">{</span><span class="ident" id="1534812"><a href="/net/unixsock_posix.go.html#1534639">fd</a></span><span class="op" id="1534814">,</span>&nbsp;<span class="ident" id="1534816"><a href="/net/unixsock_posix.go.html#1534639">fd</a></span><span class="op" id="1534818">.</span><span class="ident" id="1534819">laddr</span><span class="op" id="1534824">.</span><span class="ident" id="1534825">String</span><span class="op" id="1534831">(</span><span class="op" id="1534832">)</span><span class="op" id="1534833">}</span><span class="op" id="1534834">,</span>&nbsp;<span class="ident" id="1534836">nil</span><br>
<span class="lineno"></span><span class="op" id="1534840">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="1534843">//&nbsp;AcceptUnix&nbsp;accepts&nbsp;the&nbsp;next&nbsp;incoming&nbsp;call&nbsp;and&nbsp;returns&nbsp;the&nbsp;new</span><br>
<span class="lineno"></span><span class="comment" id="1534908">//&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="1534923">func</span>&nbsp;<span class="op" id="1534928">(</span><span class="ident" id="1534929">l</span>&nbsp;<span class="op" id="1534931">*</span><span class="ident" id="1534932"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1534944">)</span>&nbsp;<span class="ident" id="1534946">AcceptUnix</span><span class="op" id="1534956">(</span><span class="op" id="1534957">)</span>&nbsp;<span class="op" id="1534959">(</span><span class="op" id="1534960">*</span><span class="ident" id="1534961"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1534969">,</span>&nbsp;<span class="builtintype" id="1534971">error</span><span class="op" id="1534976">)</span>&nbsp;<span class="op" id="1534978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1534981">if</span>&nbsp;<span class="ident" id="1534984"><a href="/net/unixsock_posix.go.html#1534929">l</a></span>&nbsp;<span class="op" id="1534986">==</span>&nbsp;<span class="ident" id="1534989">nil</span>&nbsp;<span class="op" id="1534993">||</span>&nbsp;<span class="ident" id="1534996"><a href="/net/unixsock_posix.go.html#1534929">l</a></span><span class="op" id="1534997">.</span><span class="ident" id="1534998">fd</span>&nbsp;<span class="op" id="1535001">==</span>&nbsp;<span class="ident" id="1535004">nil</span>&nbsp;<span class="op" id="1535008">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535012">return</span>&nbsp;<span class="ident" id="1535019">nil</span><span class="op" id="1535022">,</span>&nbsp;<span class="ident" id="1535024"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1535031">.</span><span class="ident" id="1535032">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1535040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1535043">fd</span><span class="op" id="1535045">,</span>&nbsp;<span class="ident" id="1535047">err</span>&nbsp;<span class="op" id="1535051">:=</span>&nbsp;<span class="ident" id="1535054"><a href="/net/unixsock_posix.go.html#1534929">l</a></span><span class="op" id="1535055">.</span><span class="ident" id="1535056">fd</span><span class="op" id="1535058">.</span><span class="ident" id="1535059">accept</span><span class="op" id="1535065">(</span><span class="op" id="1535066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535069">if</span>&nbsp;<span class="ident" id="1535072"><a href="/net/unixsock_posix.go.html#1535047">err</a></span>&nbsp;<span class="op" id="1535076">!=</span>&nbsp;<span class="ident" id="1535079">nil</span>&nbsp;<span class="op" id="1535083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535087">return</span>&nbsp;<span class="ident" id="1535094">nil</span><span class="op" id="1535097">,</span>&nbsp;<span class="ident" id="1535099"><a href="/net/unixsock_posix.go.html#1535047">err</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1535104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1535107">c</span>&nbsp;<span class="op" id="1535109">:=</span>&nbsp;<span class="ident" id="1535112"><a href="/net/unixsock_posix.go.html#1529421">newUnixConn</a></span><span class="op" id="1535123">(</span><span class="ident" id="1535124"><a href="/net/unixsock_posix.go.html#1535043">fd</a></span><span class="op" id="1535126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535129">return</span>&nbsp;<span class="ident" id="1535136"><a href="/net/unixsock_posix.go.html#1535107">c</a></span><span class="op" id="1535137">,</span>&nbsp;<span class="ident" id="1535139">nil</span><br>
<span class="lineno"></span><span class="op" id="1535143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="1535146">//&nbsp;Accept&nbsp;implements&nbsp;the&nbsp;Accept&nbsp;method&nbsp;in&nbsp;the&nbsp;Listener&nbsp;interface;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="1535215">//&nbsp;waits&nbsp;for&nbsp;the&nbsp;next&nbsp;call&nbsp;and&nbsp;returns&nbsp;a&nbsp;generic&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="keyword" id="1535270">func</span>&nbsp;<span class="op" id="1535275">(</span><span class="ident" id="1535276">l</span>&nbsp;<span class="op" id="1535278">*</span><span class="ident" id="1535279"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1535291">)</span>&nbsp;<span class="ident" id="1535293">Accept</span><span class="op" id="1535299">(</span><span class="op" id="1535300">)</span>&nbsp;<span class="op" id="1535302">(</span><span class="ident" id="1535303">c</span>&nbsp;<span class="ident" id="1535305"><a href="/net/net.go.html#1465335">Conn</a></span><span class="op" id="1535309">,</span>&nbsp;<span class="ident" id="1535311">err</span>&nbsp;<span class="builtintype" id="1535315">error</span><span class="op" id="1535320">)</span>&nbsp;<span class="op" id="1535322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1535325">c1</span><span class="op" id="1535327">,</span>&nbsp;<span class="ident" id="1535329"><a href="/net/unixsock_posix.go.html#1535311">err</a></span>&nbsp;<span class="op" id="1535333">:=</span>&nbsp;<span class="ident" id="1535336"><a href="/net/unixsock_posix.go.html#1535276">l</a></span><span class="op" id="1535337">.</span><span class="ident" id="1535338">AcceptUnix</span><span class="op" id="1535348">(</span><span class="op" id="1535349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535352">if</span>&nbsp;<span class="ident" id="1535355"><a href="/net/unixsock_posix.go.html#1535311">err</a></span>&nbsp;<span class="op" id="1535359">!=</span>&nbsp;<span class="ident" id="1535362">nil</span>&nbsp;<span class="op" id="1535366">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535370">return</span>&nbsp;<span class="ident" id="1535377">nil</span><span class="op" id="1535380">,</span>&nbsp;<span class="ident" id="1535382"><a href="/net/unixsock_posix.go.html#1535311">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1535387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535390">return</span>&nbsp;<span class="ident" id="1535397"><a href="/net/unixsock_posix.go.html#1535325">c1</a></span><span class="op" id="1535399">,</span>&nbsp;<span class="ident" id="1535401">nil</span><br>
<span class="lineno"></span><span class="op" id="1535405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="1535408">//&nbsp;Close&nbsp;stops&nbsp;listening&nbsp;on&nbsp;the&nbsp;Unix&nbsp;address.&nbsp;&nbsp;Already&nbsp;accepted</span><br>
<span class="lineno"></span><span class="comment" id="1535472">//&nbsp;connections&nbsp;are&nbsp;not&nbsp;closed.</span><br>
<span class="lineno"></span><span class="keyword" id="1535503">func</span>&nbsp;<span class="op" id="1535508">(</span><span class="ident" id="1535509">l</span>&nbsp;<span class="op" id="1535511">*</span><span class="ident" id="1535512"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1535524">)</span>&nbsp;<span class="ident" id="1535526">Close</span><span class="op" id="1535531">(</span><span class="op" id="1535532">)</span>&nbsp;<span class="builtintype" id="1535534">error</span>&nbsp;<span class="op" id="1535540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535543">if</span>&nbsp;<span class="ident" id="1535546"><a href="/net/unixsock_posix.go.html#1535509">l</a></span>&nbsp;<span class="op" id="1535548">==</span>&nbsp;<span class="ident" id="1535551">nil</span>&nbsp;<span class="op" id="1535555">||</span>&nbsp;<span class="ident" id="1535558"><a href="/net/unixsock_posix.go.html#1535509">l</a></span><span class="op" id="1535559">.</span><span class="ident" id="1535560">fd</span>&nbsp;<span class="op" id="1535563">==</span>&nbsp;<span class="ident" id="1535566">nil</span>&nbsp;<span class="op" id="1535570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1535574">return</span>&nbsp;<span class="ident" id="1535581"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1535588">.</span><span class="ident" id="1535589">EINVAL</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1535597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535601">//&nbsp;The&nbsp;operating&nbsp;system&nbsp;doesn&#39;t&nbsp;clean&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535643">//&nbsp;the&nbsp;file&nbsp;that&nbsp;announcing&nbsp;created,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535684">//&nbsp;we&nbsp;have&nbsp;to&nbsp;clean&nbsp;it&nbsp;up&nbsp;ourselves.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535722">//&nbsp;There&#39;s&nbsp;a&nbsp;race&nbsp;here--we&nbsp;can&#39;t&nbsp;know&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535765">//&nbsp;sure&nbsp;whether&nbsp;someone&nbsp;else&nbsp;has&nbsp;come&nbsp;along</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535810">//&nbsp;and&nbsp;replaced&nbsp;our&nbsp;socket&nbsp;name&nbsp;already--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535853">//&nbsp;but&nbsp;this&nbsp;sequence&nbsp;(remove&nbsp;then&nbsp;close)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535895">//&nbsp;is&nbsp;at&nbsp;least&nbsp;compatible&nbsp;with&nbsp;the&nbsp;auto-remove</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535943">//&nbsp;sequence&nbsp;in&nbsp;ListenUnix.&nbsp;&nbsp;It&#39;s&nbsp;only&nbsp;non-Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1535989">//&nbsp;programs&nbsp;that&nbsp;can&nbsp;mess&nbsp;us&nbsp;up.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1536023">if</span>&nbsp;<span class="ident" id="1536026"><a href="/net/unixsock_posix.go.html#1535509">l</a></span><span class="op" id="1536027">.</span><span class="ident" id="1536028">path</span><span class="op" id="1536032">[</span><span class="num" id="1536033">0</span><span class="op" id="1536034">]</span>&nbsp;<span class="op" id="1536036">!=</span>&nbsp;<span class="string" id="1536039">&#39;@&#39;</span>&nbsp;<span class="op" id="1536043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1536047"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1536054">.</span><span class="ident" id="1536055">Unlink</span><span class="op" id="1536061">(</span><span class="ident" id="1536062"><a href="/net/unixsock_posix.go.html#1535509">l</a></span><span class="op" id="1536063">.</span><span class="ident" id="1536064">path</span><span class="op" id="1536068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1536071">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1536074">return</span>&nbsp;<span class="ident" id="1536081"><a href="/net/unixsock_posix.go.html#1535509">l</a></span><span class="op" id="1536082">.</span><span class="ident" id="1536083">fd</span><span class="op" id="1536085">.</span><span class="ident" id="1536086">Close</span><span class="op" id="1536091">(</span><span class="op" id="1536092">)</span><br>
<span class="lineno"></span><span class="op" id="1536094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1536097">//&nbsp;Addr&nbsp;returns&nbsp;the&nbsp;listener&#39;s&nbsp;network&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="1536145">func</span>&nbsp;<span class="op" id="1536150">(</span><span class="ident" id="1536151">l</span>&nbsp;<span class="op" id="1536153">*</span><span class="ident" id="1536154"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1536166">)</span>&nbsp;<span class="ident" id="1536168">Addr</span><span class="op" id="1536172">(</span><span class="op" id="1536173">)</span>&nbsp;<span class="ident" id="1536175"><a href="/net/net.go.html#1465097">Addr</a></span>&nbsp;<span class="op" id="1536180">{</span>&nbsp;<span class="keyword" id="1536182">return</span>&nbsp;<span class="ident" id="1536189"><a href="/net/unixsock_posix.go.html#1536151">l</a></span><span class="op" id="1536190">.</span><span class="ident" id="1536191">fd</span><span class="op" id="1536193">.</span><span class="ident" id="1536194">laddr</span>&nbsp;<span class="op" id="1536200">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="1536203">//&nbsp;SetDeadline&nbsp;sets&nbsp;the&nbsp;deadline&nbsp;associated&nbsp;with&nbsp;the&nbsp;listener.</span><br>
<span class="lineno"></span><span class="comment" id="1536266">//&nbsp;A&nbsp;zero&nbsp;time&nbsp;value&nbsp;disables&nbsp;the&nbsp;deadline.</span><br>
<span class="lineno"></span><span class="keyword" id="1536310">func</span>&nbsp;<span class="op" id="1536315">(</span><span class="ident" id="1536316">l</span>&nbsp;<span class="op" id="1536318">*</span><span class="ident" id="1536319"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1536331">)</span>&nbsp;<span class="ident" id="1536333">SetDeadline</span><span class="op" id="1536344">(</span><span class="ident" id="1536345">t</span>&nbsp;<span class="ident" id="1536347"><a href="/net/unixsock_posix.go.html#1527425">time</a></span><span class="op" id="1536351">.</span><span class="ident" id="1536352">Time</span><span class="op" id="1536356">)</span>&nbsp;<span class="op" id="1536358">(</span><span class="ident" id="1536359">err</span>&nbsp;<span class="builtintype" id="1536363">error</span><span class="op" id="1536368">)</span>&nbsp;<span class="op" id="1536370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1536373">if</span>&nbsp;<span class="ident" id="1536376"><a href="/net/unixsock_posix.go.html#1536316">l</a></span>&nbsp;<span class="op" id="1536378">==</span>&nbsp;<span class="ident" id="1536381">nil</span>&nbsp;<span class="op" id="1536385">||</span>&nbsp;<span class="ident" id="1536388"><a href="/net/unixsock_posix.go.html#1536316">l</a></span><span class="op" id="1536389">.</span><span class="ident" id="1536390">fd</span>&nbsp;<span class="op" id="1536393">==</span>&nbsp;<span class="ident" id="1536396">nil</span>&nbsp;<span class="op" id="1536400">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1536404">return</span>&nbsp;<span class="ident" id="1536411"><a href="/net/unixsock_posix.go.html#1527414">syscall</a></span><span class="op" id="1536418">.</span><span class="ident" id="1536419">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1536427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1536430">return</span>&nbsp;<span class="ident" id="1536437"><a href="/net/unixsock_posix.go.html#1536316">l</a></span><span class="op" id="1536438">.</span><span class="ident" id="1536439">fd</span><span class="op" id="1536441">.</span><span class="ident" id="1536442">setDeadline</span><span class="op" id="1536453">(</span><span class="ident" id="1536454"><a href="/net/unixsock_posix.go.html#1536345">t</a></span><span class="op" id="1536455">)</span><br>
<span class="lineno"></span><span class="op" id="1536457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="comment" id="1536460">//&nbsp;File&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;underlying&nbsp;os.File,&nbsp;set&nbsp;to&nbsp;blocking</span><br>
<span class="lineno"></span><span class="comment" id="1536526">//&nbsp;mode.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.</span><br>
<span class="lineno"></span><span class="comment" id="1536596">//&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;l.</span><br>
<span class="lineno"></span><span class="comment" id="1536661">//</span><br>
<span class="lineno"></span><span class="comment" id="1536664">//&nbsp;The&nbsp;returned&nbsp;os.File&#39;s&nbsp;file&nbsp;descriptor&nbsp;is&nbsp;different&nbsp;from&nbsp;the</span><br>
<span class="lineno">340</span><span class="comment" id="1536728">//&nbsp;connection&#39;s.&nbsp;&nbsp;Attempting&nbsp;to&nbsp;change&nbsp;properties&nbsp;of&nbsp;the&nbsp;original</span><br>
<span class="lineno"></span><span class="comment" id="1536794">//&nbsp;using&nbsp;this&nbsp;duplicate&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;desired&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="1536858">func</span>&nbsp;<span class="op" id="1536863">(</span><span class="ident" id="1536864">l</span>&nbsp;<span class="op" id="1536866">*</span><span class="ident" id="1536867"><a href="/net/unixsock_posix.go.html#1534130">UnixListener</a></span><span class="op" id="1536879">)</span>&nbsp;<span class="ident" id="1536881">File</span><span class="op" id="1536885">(</span><span class="op" id="1536886">)</span>&nbsp;<span class="op" id="1536888">(</span><span class="ident" id="1536889">f</span>&nbsp;<span class="op" id="1536891">*</span><span class="ident" id="1536892"><a href="/net/unixsock_posix.go.html#1527408">os</a></span><span class="op" id="1536894">.</span><span class="ident" id="1536895">File</span><span class="op" id="1536899">,</span>&nbsp;<span class="ident" id="1536901">err</span>&nbsp;<span class="builtintype" id="1536905">error</span><span class="op" id="1536910">)</span>&nbsp;<span class="op" id="1536912">{</span>&nbsp;<span class="keyword" id="1536914">return</span>&nbsp;<span class="ident" id="1536921"><a href="/net/unixsock_posix.go.html#1536864">l</a></span><span class="op" id="1536922">.</span><span class="ident" id="1536923">fd</span><span class="op" id="1536925">.</span><span class="ident" id="1536926">dup</span><span class="op" id="1536929">(</span><span class="op" id="1536930">)</span>&nbsp;<span class="op" id="1536932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1536935">//&nbsp;ListenUnixgram&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;Unix&nbsp;datagram&nbsp;packets&nbsp;addressed</span><br>
<span class="lineno">345</span><span class="comment" id="1537006">//&nbsp;to&nbsp;the&nbsp;local&nbsp;address&nbsp;laddr.&nbsp;&nbsp;The&nbsp;network&nbsp;net&nbsp;must&nbsp;be&nbsp;&#34;unixgram&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="1537074">//&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo&nbsp;methods&nbsp;can&nbsp;be&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="1537144">//&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;packets&nbsp;with&nbsp;per-packet&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="1537203">func</span>&nbsp;<span class="ident" id="1537208">ListenUnixgram</span><span class="op" id="1537222">(</span><span class="ident" id="1537223">net</span>&nbsp;<span class="builtintype" id="1537227">string</span><span class="op" id="1537233">,</span>&nbsp;<span class="ident" id="1537235">laddr</span>&nbsp;<span class="op" id="1537241">*</span><span class="ident" id="1537242"><a href="/net/unixsock.go.html#1526419">UnixAddr</a></span><span class="op" id="1537250">)</span>&nbsp;<span class="op" id="1537252">(</span><span class="op" id="1537253">*</span><span class="ident" id="1537254"><a href="/net/unixsock_posix.go.html#1529389">UnixConn</a></span><span class="op" id="1537262">,</span>&nbsp;<span class="builtintype" id="1537264">error</span><span class="op" id="1537269">)</span>&nbsp;<span class="op" id="1537271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537274">switch</span>&nbsp;<span class="ident" id="1537281"><a href="/net/unixsock_posix.go.html#1537223">net</a></span>&nbsp;<span class="op" id="1537285">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537288">case</span>&nbsp;<span class="string" id="1537293">&#34;unixgram&#34;</span><span class="op" id="1537303">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537306">default</span><span class="op" id="1537313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537317">return</span>&nbsp;<span class="ident" id="1537324">nil</span><span class="op" id="1537327">,</span>&nbsp;<span class="op" id="1537329">&amp;</span><span class="ident" id="1537330"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1537337">{</span><span class="ident" id="1537338">Op</span><span class="op" id="1537340">:</span>&nbsp;<span class="string" id="1537342">&#34;listen&#34;</span><span class="op" id="1537350">,</span>&nbsp;<span class="ident" id="1537352">Net</span><span class="op" id="1537355">:</span>&nbsp;<span class="ident" id="1537357"><a href="/net/unixsock_posix.go.html#1537223">net</a></span><span class="op" id="1537360">,</span>&nbsp;<span class="ident" id="1537362">Addr</span><span class="op" id="1537366">:</span>&nbsp;<span class="ident" id="1537368"><a href="/net/unixsock_posix.go.html#1537235">laddr</a></span><span class="op" id="1537373">,</span>&nbsp;<span class="ident" id="1537375">Err</span><span class="op" id="1537378">:</span>&nbsp;<span class="ident" id="1537380"><a href="/net/net.go.html#1473867">UnknownNetworkError</a></span><span class="op" id="1537399">(</span><span class="ident" id="1537400"><a href="/net/unixsock_posix.go.html#1537223">net</a></span><span class="op" id="1537403">)</span><span class="op" id="1537404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537410">if</span>&nbsp;<span class="ident" id="1537413"><a href="/net/unixsock_posix.go.html#1537235">laddr</a></span>&nbsp;<span class="op" id="1537419">==</span>&nbsp;<span class="ident" id="1537422">nil</span>&nbsp;<span class="op" id="1537426">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537430">return</span>&nbsp;<span class="ident" id="1537437">nil</span><span class="op" id="1537440">,</span>&nbsp;<span class="op" id="1537442">&amp;</span><span class="ident" id="1537443"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1537450">{</span><span class="ident" id="1537451">Op</span><span class="op" id="1537453">:</span>&nbsp;<span class="string" id="1537455">&#34;listen&#34;</span><span class="op" id="1537463">,</span>&nbsp;<span class="ident" id="1537465">Net</span><span class="op" id="1537468">:</span>&nbsp;<span class="ident" id="1537470"><a href="/net/unixsock_posix.go.html#1537223">net</a></span><span class="op" id="1537473">,</span>&nbsp;<span class="ident" id="1537475">Addr</span><span class="op" id="1537479">:</span>&nbsp;<span class="ident" id="1537481">nil</span><span class="op" id="1537484">,</span>&nbsp;<span class="ident" id="1537486">Err</span><span class="op" id="1537489">:</span>&nbsp;<span class="ident" id="1537491"><a href="/net/net.go.html#1472020">errMissingAddress</a></span><span class="op" id="1537508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1537514">fd</span><span class="op" id="1537516">,</span>&nbsp;<span class="ident" id="1537518">err</span>&nbsp;<span class="op" id="1537522">:=</span>&nbsp;<span class="ident" id="1537525"><a href="/net/unixsock_posix.go.html#1527440">unixSocket</a></span><span class="op" id="1537535">(</span><span class="ident" id="1537536"><a href="/net/unixsock_posix.go.html#1537223">net</a></span><span class="op" id="1537539">,</span>&nbsp;<span class="ident" id="1537541"><a href="/net/unixsock_posix.go.html#1537235">laddr</a></span><span class="op" id="1537546">,</span>&nbsp;<span class="ident" id="1537548">nil</span><span class="op" id="1537551">,</span>&nbsp;<span class="string" id="1537553">&#34;listen&#34;</span><span class="op" id="1537561">,</span>&nbsp;<span class="ident" id="1537563"><a href="/net/net.go.html#1473194">noDeadline</a></span><span class="op" id="1537573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537576">if</span>&nbsp;<span class="ident" id="1537579"><a href="/net/unixsock_posix.go.html#1537518">err</a></span>&nbsp;<span class="op" id="1537583">!=</span>&nbsp;<span class="ident" id="1537586">nil</span>&nbsp;<span class="op" id="1537590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537594">return</span>&nbsp;<span class="ident" id="1537601">nil</span><span class="op" id="1537604">,</span>&nbsp;<span class="op" id="1537606">&amp;</span><span class="ident" id="1537607"><a href="/net/net.go.html#1472480">OpError</a></span><span class="op" id="1537614">{</span><span class="ident" id="1537615">Op</span><span class="op" id="1537617">:</span>&nbsp;<span class="string" id="1537619">&#34;listen&#34;</span><span class="op" id="1537627">,</span>&nbsp;<span class="ident" id="1537629">Net</span><span class="op" id="1537632">:</span>&nbsp;<span class="ident" id="1537634"><a href="/net/unixsock_posix.go.html#1537223">net</a></span><span class="op" id="1537637">,</span>&nbsp;<span class="ident" id="1537639">Addr</span><span class="op" id="1537643">:</span>&nbsp;<span class="ident" id="1537645"><a href="/net/unixsock_posix.go.html#1537235">laddr</a></span><span class="op" id="1537650">,</span>&nbsp;<span class="ident" id="1537652">Err</span><span class="op" id="1537655">:</span>&nbsp;<span class="ident" id="1537657"><a href="/net/unixsock_posix.go.html#1537518">err</a></span><span class="op" id="1537660">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1537663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1537666">return</span>&nbsp;<span class="ident" id="1537673"><a href="/net/unixsock_posix.go.html#1529421">newUnixConn</a></span><span class="op" id="1537684">(</span><span class="ident" id="1537685"><a href="/net/unixsock_posix.go.html#1537514">fd</a></span><span class="op" id="1537687">)</span><span class="op" id="1537688">,</span>&nbsp;<span class="ident" id="1537690">nil</span><br>
<span class="lineno"></span><span class="op" id="1537694">}</span>
</div>
</body>
</html>
