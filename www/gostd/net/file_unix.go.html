<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html" class="current">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3075562">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3075617">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3075671">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3075722">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3075787">package</span>&nbsp;<span class="ident" id="3075795">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3075800">import</span>&nbsp;<span class="op" id="3075807">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3075810">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3075816">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3075826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3075829">func</span>&nbsp;<span class="ident" id="3075834">newFileFD</span><span class="op" id="3075843">(</span><span class="ident" id="3075844">f</span>&nbsp;<span class="op" id="3075846">*</span><span class="ident" id="3075847">os</span><span class="op" id="3075849">.</span><span class="ident" id="3075850">File</span><span class="op" id="3075854">)</span>&nbsp;<span class="op" id="3075856">(</span><span class="op" id="3075857">*</span><span class="ident" id="3075858">netFD</span><span class="op" id="3075863">,</span>&nbsp;<span class="builtintype" id="3075865">error</span><span class="op" id="3075870">)</span>&nbsp;<span class="op" id="3075872">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3075875">fd</span><span class="op" id="3075877">,</span>&nbsp;<span class="ident" id="3075879">err</span>&nbsp;<span class="op" id="3075883">:=</span>&nbsp;<span class="ident" id="3075886">dupCloseOnExec</span><span class="op" id="3075900">(</span><span class="builtintype" id="3075901">int</span><span class="op" id="3075904">(</span><span class="ident" id="3075905">f</span><span class="op" id="3075906">.</span><span class="ident" id="3075907">Fd</span><span class="op" id="3075909">(</span><span class="op" id="3075910">)</span><span class="op" id="3075911">)</span><span class="op" id="3075912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3075915">if</span>&nbsp;<span class="ident" id="3075918">err</span>&nbsp;<span class="op" id="3075922">!=</span>&nbsp;<span class="ident" id="3075925">nil</span>&nbsp;<span class="op" id="3075929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3075933">return</span>&nbsp;<span class="ident" id="3075940">nil</span><span class="op" id="3075943">,</span>&nbsp;<span class="ident" id="3075945">os</span><span class="op" id="3075947">.</span><span class="ident" id="3075948">NewSyscallError</span><span class="op" id="3075963">(</span><span class="string" id="3075964">&#34;dup&#34;</span><span class="op" id="3075969">,</span>&nbsp;<span class="ident" id="3075971">err</span><span class="op" id="3075974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3075977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3075981">if</span>&nbsp;<span class="ident" id="3075984">err</span>&nbsp;<span class="op" id="3075988">=</span>&nbsp;<span class="ident" id="3075990">syscall</span><span class="op" id="3075997">.</span><span class="ident" id="3075998">SetNonblock</span><span class="op" id="3076009">(</span><span class="ident" id="3076010">fd</span><span class="op" id="3076012">,</span>&nbsp;<span class="builtintype" id="3076014">true</span><span class="op" id="3076018">)</span><span class="op" id="3076019">;</span>&nbsp;<span class="ident" id="3076021">err</span>&nbsp;<span class="op" id="3076025">!=</span>&nbsp;<span class="ident" id="3076028">nil</span>&nbsp;<span class="op" id="3076032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076036">closesocket</span><span class="op" id="3076047">(</span><span class="ident" id="3076048">fd</span><span class="op" id="3076050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076054">return</span>&nbsp;<span class="ident" id="3076061">nil</span><span class="op" id="3076064">,</span>&nbsp;<span class="ident" id="3076066">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076075">sotype</span><span class="op" id="3076081">,</span>&nbsp;<span class="ident" id="3076083">err</span>&nbsp;<span class="op" id="3076087">:=</span>&nbsp;<span class="ident" id="3076090">syscall</span><span class="op" id="3076097">.</span><span class="ident" id="3076098">GetsockoptInt</span><span class="op" id="3076111">(</span><span class="ident" id="3076112">fd</span><span class="op" id="3076114">,</span>&nbsp;<span class="ident" id="3076116">syscall</span><span class="op" id="3076123">.</span><span class="ident" id="3076124">SOL_SOCKET</span><span class="op" id="3076134">,</span>&nbsp;<span class="ident" id="3076136">syscall</span><span class="op" id="3076143">.</span><span class="ident" id="3076144">SO_TYPE</span><span class="op" id="3076151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076154">if</span>&nbsp;<span class="ident" id="3076157">err</span>&nbsp;<span class="op" id="3076161">!=</span>&nbsp;<span class="ident" id="3076164">nil</span>&nbsp;<span class="op" id="3076168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076172">closesocket</span><span class="op" id="3076183">(</span><span class="ident" id="3076184">fd</span><span class="op" id="3076186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076190">return</span>&nbsp;<span class="ident" id="3076197">nil</span><span class="op" id="3076200">,</span>&nbsp;<span class="ident" id="3076202">os</span><span class="op" id="3076204">.</span><span class="ident" id="3076205">NewSyscallError</span><span class="op" id="3076220">(</span><span class="string" id="3076221">&#34;getsockopt&#34;</span><span class="op" id="3076233">,</span>&nbsp;<span class="ident" id="3076235">err</span><span class="op" id="3076238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076241">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076245">family</span>&nbsp;<span class="op" id="3076252">:=</span>&nbsp;<span class="ident" id="3076255">syscall</span><span class="op" id="3076262">.</span><span class="ident" id="3076263">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076274">toAddr</span>&nbsp;<span class="op" id="3076281">:=</span>&nbsp;<span class="ident" id="3076284">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076299">lsa</span><span class="op" id="3076302">,</span>&nbsp;<span class="ident" id="3076304">_</span>&nbsp;<span class="op" id="3076306">:=</span>&nbsp;<span class="ident" id="3076309">syscall</span><span class="op" id="3076316">.</span><span class="ident" id="3076317">Getsockname</span><span class="op" id="3076328">(</span><span class="ident" id="3076329">fd</span><span class="op" id="3076331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076334">switch</span>&nbsp;<span class="ident" id="3076341">lsa</span><span class="op" id="3076344">.</span><span class="op" id="3076345">(</span><span class="keyword" id="3076346">type</span><span class="op" id="3076350">)</span>&nbsp;<span class="op" id="3076352">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076355">default</span><span class="op" id="3076362">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076366">closesocket</span><span class="op" id="3076377">(</span><span class="ident" id="3076378">fd</span><span class="op" id="3076380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076384">return</span>&nbsp;<span class="ident" id="3076391">nil</span><span class="op" id="3076394">,</span>&nbsp;<span class="ident" id="3076396">syscall</span><span class="op" id="3076403">.</span><span class="ident" id="3076404">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076412">case</span>&nbsp;<span class="op" id="3076417">*</span><span class="ident" id="3076418">syscall</span><span class="op" id="3076425">.</span><span class="ident" id="3076426">SockaddrInet4</span><span class="op" id="3076439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076443">family</span>&nbsp;<span class="op" id="3076450">=</span>&nbsp;<span class="ident" id="3076452">syscall</span><span class="op" id="3076459">.</span><span class="ident" id="3076460">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076470">if</span>&nbsp;<span class="ident" id="3076473">sotype</span>&nbsp;<span class="op" id="3076480">==</span>&nbsp;<span class="ident" id="3076483">syscall</span><span class="op" id="3076490">.</span><span class="ident" id="3076491">SOCK_DGRAM</span>&nbsp;<span class="op" id="3076502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076507">toAddr</span>&nbsp;<span class="op" id="3076514">=</span>&nbsp;<span class="ident" id="3076516">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076532">}</span>&nbsp;<span class="keyword" id="3076534">else</span>&nbsp;<span class="keyword" id="3076539">if</span>&nbsp;<span class="ident" id="3076542">sotype</span>&nbsp;<span class="op" id="3076549">==</span>&nbsp;<span class="ident" id="3076552">syscall</span><span class="op" id="3076559">.</span><span class="ident" id="3076560">SOCK_RAW</span>&nbsp;<span class="op" id="3076569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076574">toAddr</span>&nbsp;<span class="op" id="3076581">=</span>&nbsp;<span class="ident" id="3076583">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076598">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076601">case</span>&nbsp;<span class="op" id="3076606">*</span><span class="ident" id="3076607">syscall</span><span class="op" id="3076614">.</span><span class="ident" id="3076615">SockaddrInet6</span><span class="op" id="3076628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076632">family</span>&nbsp;<span class="op" id="3076639">=</span>&nbsp;<span class="ident" id="3076641">syscall</span><span class="op" id="3076648">.</span><span class="ident" id="3076649">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076660">if</span>&nbsp;<span class="ident" id="3076663">sotype</span>&nbsp;<span class="op" id="3076670">==</span>&nbsp;<span class="ident" id="3076673">syscall</span><span class="op" id="3076680">.</span><span class="ident" id="3076681">SOCK_DGRAM</span>&nbsp;<span class="op" id="3076692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076697">toAddr</span>&nbsp;<span class="op" id="3076704">=</span>&nbsp;<span class="ident" id="3076706">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076722">}</span>&nbsp;<span class="keyword" id="3076724">else</span>&nbsp;<span class="keyword" id="3076729">if</span>&nbsp;<span class="ident" id="3076732">sotype</span>&nbsp;<span class="op" id="3076739">==</span>&nbsp;<span class="ident" id="3076742">syscall</span><span class="op" id="3076749">.</span><span class="ident" id="3076750">SOCK_RAW</span>&nbsp;<span class="op" id="3076759">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076764">toAddr</span>&nbsp;<span class="op" id="3076771">=</span>&nbsp;<span class="ident" id="3076773">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076791">case</span>&nbsp;<span class="op" id="3076796">*</span><span class="ident" id="3076797">syscall</span><span class="op" id="3076804">.</span><span class="ident" id="3076805">SockaddrUnix</span><span class="op" id="3076817">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076821">family</span>&nbsp;<span class="op" id="3076828">=</span>&nbsp;<span class="ident" id="3076830">syscall</span><span class="op" id="3076837">.</span><span class="ident" id="3076838">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076848">toAddr</span>&nbsp;<span class="op" id="3076855">=</span>&nbsp;<span class="ident" id="3076857">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3076874">if</span>&nbsp;<span class="ident" id="3076877">sotype</span>&nbsp;<span class="op" id="3076884">==</span>&nbsp;<span class="ident" id="3076887">syscall</span><span class="op" id="3076894">.</span><span class="ident" id="3076895">SOCK_DGRAM</span>&nbsp;<span class="op" id="3076906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076911">toAddr</span>&nbsp;<span class="op" id="3076918">=</span>&nbsp;<span class="ident" id="3076920">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3076941">}</span>&nbsp;<span class="keyword" id="3076943">else</span>&nbsp;<span class="keyword" id="3076948">if</span>&nbsp;<span class="ident" id="3076951">sotype</span>&nbsp;<span class="op" id="3076958">==</span>&nbsp;<span class="ident" id="3076961">syscall</span><span class="op" id="3076968">.</span><span class="ident" id="3076969">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3076984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3076989">toAddr</span>&nbsp;<span class="op" id="3076996">=</span>&nbsp;<span class="ident" id="3076998">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077021">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077027">laddr</span>&nbsp;<span class="op" id="3077033">:=</span>&nbsp;<span class="ident" id="3077036">toAddr</span><span class="op" id="3077042">(</span><span class="ident" id="3077043">lsa</span><span class="op" id="3077046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077049">rsa</span><span class="op" id="3077052">,</span>&nbsp;<span class="ident" id="3077054">_</span>&nbsp;<span class="op" id="3077056">:=</span>&nbsp;<span class="ident" id="3077059">syscall</span><span class="op" id="3077066">.</span><span class="ident" id="3077067">Getpeername</span><span class="op" id="3077078">(</span><span class="ident" id="3077079">fd</span><span class="op" id="3077081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077084">raddr</span>&nbsp;<span class="op" id="3077090">:=</span>&nbsp;<span class="ident" id="3077093">toAddr</span><span class="op" id="3077099">(</span><span class="ident" id="3077100">rsa</span><span class="op" id="3077103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077107">netfd</span><span class="op" id="3077112">,</span>&nbsp;<span class="ident" id="3077114">err</span>&nbsp;<span class="op" id="3077118">:=</span>&nbsp;<span class="ident" id="3077121">newFD</span><span class="op" id="3077126">(</span><span class="ident" id="3077127">fd</span><span class="op" id="3077129">,</span>&nbsp;<span class="ident" id="3077131">family</span><span class="op" id="3077137">,</span>&nbsp;<span class="ident" id="3077139">sotype</span><span class="op" id="3077145">,</span>&nbsp;<span class="ident" id="3077147">laddr</span><span class="op" id="3077152">.</span><span class="ident" id="3077153">Network</span><span class="op" id="3077160">(</span><span class="op" id="3077161">)</span><span class="op" id="3077162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077165">if</span>&nbsp;<span class="ident" id="3077168">err</span>&nbsp;<span class="op" id="3077172">!=</span>&nbsp;<span class="ident" id="3077175">nil</span>&nbsp;<span class="op" id="3077179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077183">closesocket</span><span class="op" id="3077194">(</span><span class="ident" id="3077195">fd</span><span class="op" id="3077197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077201">return</span>&nbsp;<span class="ident" id="3077208">nil</span><span class="op" id="3077211">,</span>&nbsp;<span class="ident" id="3077213">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077218">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077221">if</span>&nbsp;<span class="ident" id="3077224">err</span>&nbsp;<span class="op" id="3077228">:=</span>&nbsp;<span class="ident" id="3077231">netfd</span><span class="op" id="3077236">.</span><span class="ident" id="3077237">init</span><span class="op" id="3077241">(</span><span class="op" id="3077242">)</span><span class="op" id="3077243">;</span>&nbsp;<span class="ident" id="3077245">err</span>&nbsp;<span class="op" id="3077249">!=</span>&nbsp;<span class="ident" id="3077252">nil</span>&nbsp;<span class="op" id="3077256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077260">netfd</span><span class="op" id="3077265">.</span><span class="ident" id="3077266">Close</span><span class="op" id="3077271">(</span><span class="op" id="3077272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077276">return</span>&nbsp;<span class="ident" id="3077283">nil</span><span class="op" id="3077286">,</span>&nbsp;<span class="ident" id="3077288">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077296">netfd</span><span class="op" id="3077301">.</span><span class="ident" id="3077302">setAddr</span><span class="op" id="3077309">(</span><span class="ident" id="3077310">laddr</span><span class="op" id="3077315">,</span>&nbsp;<span class="ident" id="3077317">raddr</span><span class="op" id="3077322">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077325">return</span>&nbsp;<span class="ident" id="3077332">netfd</span><span class="op" id="3077337">,</span>&nbsp;<span class="ident" id="3077339">nil</span><br>
<span class="lineno"></span><span class="op" id="3077343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3077346">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3077416">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3077487">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3077553">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3077566">func</span>&nbsp;<span class="ident" id="3077571">FileConn</span><span class="op" id="3077579">(</span><span class="ident" id="3077580">f</span>&nbsp;<span class="op" id="3077582">*</span><span class="ident" id="3077583">os</span><span class="op" id="3077585">.</span><span class="ident" id="3077586">File</span><span class="op" id="3077590">)</span>&nbsp;<span class="op" id="3077592">(</span><span class="ident" id="3077593">c</span>&nbsp;<span class="ident" id="3077595">Conn</span><span class="op" id="3077599">,</span>&nbsp;<span class="ident" id="3077601">err</span>&nbsp;<span class="builtintype" id="3077605">error</span><span class="op" id="3077610">)</span>&nbsp;<span class="op" id="3077612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077615">fd</span><span class="op" id="3077617">,</span>&nbsp;<span class="ident" id="3077619">err</span>&nbsp;<span class="op" id="3077623">:=</span>&nbsp;<span class="ident" id="3077626">newFileFD</span><span class="op" id="3077635">(</span><span class="ident" id="3077636">f</span><span class="op" id="3077637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077640">if</span>&nbsp;<span class="ident" id="3077643">err</span>&nbsp;<span class="op" id="3077647">!=</span>&nbsp;<span class="ident" id="3077650">nil</span>&nbsp;<span class="op" id="3077654">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077658">return</span>&nbsp;<span class="ident" id="3077665">nil</span><span class="op" id="3077668">,</span>&nbsp;<span class="ident" id="3077670">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077678">switch</span>&nbsp;<span class="ident" id="3077685">fd</span><span class="op" id="3077687">.</span><span class="ident" id="3077688">laddr</span><span class="op" id="3077693">.</span><span class="op" id="3077694">(</span><span class="keyword" id="3077695">type</span><span class="op" id="3077699">)</span>&nbsp;<span class="op" id="3077701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077704">case</span>&nbsp;<span class="op" id="3077709">*</span><span class="ident" id="3077710">TCPAddr</span><span class="op" id="3077717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077721">return</span>&nbsp;<span class="ident" id="3077728">newTCPConn</span><span class="op" id="3077738">(</span><span class="ident" id="3077739">fd</span><span class="op" id="3077741">)</span><span class="op" id="3077742">,</span>&nbsp;<span class="ident" id="3077744">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077749">case</span>&nbsp;<span class="op" id="3077754">*</span><span class="ident" id="3077755">UDPAddr</span><span class="op" id="3077762">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077766">return</span>&nbsp;<span class="ident" id="3077773">newUDPConn</span><span class="op" id="3077783">(</span><span class="ident" id="3077784">fd</span><span class="op" id="3077786">)</span><span class="op" id="3077787">,</span>&nbsp;<span class="ident" id="3077789">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077794">case</span>&nbsp;<span class="op" id="3077799">*</span><span class="ident" id="3077800">IPAddr</span><span class="op" id="3077806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077810">return</span>&nbsp;<span class="ident" id="3077817">newIPConn</span><span class="op" id="3077826">(</span><span class="ident" id="3077827">fd</span><span class="op" id="3077829">)</span><span class="op" id="3077830">,</span>&nbsp;<span class="ident" id="3077832">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077837">case</span>&nbsp;<span class="op" id="3077842">*</span><span class="ident" id="3077843">UnixAddr</span><span class="op" id="3077851">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077855">return</span>&nbsp;<span class="ident" id="3077862">newUnixConn</span><span class="op" id="3077873">(</span><span class="ident" id="3077874">fd</span><span class="op" id="3077876">)</span><span class="op" id="3077877">,</span>&nbsp;<span class="ident" id="3077879">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077887">fd</span><span class="op" id="3077889">.</span><span class="ident" id="3077890">Close</span><span class="op" id="3077895">(</span><span class="op" id="3077896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077899">return</span>&nbsp;<span class="ident" id="3077906">nil</span><span class="op" id="3077909">,</span>&nbsp;<span class="ident" id="3077911">syscall</span><span class="op" id="3077918">.</span><span class="ident" id="3077919">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3077926">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3077929">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3077998">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3078067">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3078138">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3078151">func</span>&nbsp;<span class="ident" id="3078156">FileListener</span><span class="op" id="3078168">(</span><span class="ident" id="3078169">f</span>&nbsp;<span class="op" id="3078171">*</span><span class="ident" id="3078172">os</span><span class="op" id="3078174">.</span><span class="ident" id="3078175">File</span><span class="op" id="3078179">)</span>&nbsp;<span class="op" id="3078181">(</span><span class="ident" id="3078182">l</span>&nbsp;<span class="ident" id="3078184">Listener</span><span class="op" id="3078192">,</span>&nbsp;<span class="ident" id="3078194">err</span>&nbsp;<span class="builtintype" id="3078198">error</span><span class="op" id="3078203">)</span>&nbsp;<span class="op" id="3078205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078208">fd</span><span class="op" id="3078210">,</span>&nbsp;<span class="ident" id="3078212">err</span>&nbsp;<span class="op" id="3078216">:=</span>&nbsp;<span class="ident" id="3078219">newFileFD</span><span class="op" id="3078228">(</span><span class="ident" id="3078229">f</span><span class="op" id="3078230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078233">if</span>&nbsp;<span class="ident" id="3078236">err</span>&nbsp;<span class="op" id="3078240">!=</span>&nbsp;<span class="ident" id="3078243">nil</span>&nbsp;<span class="op" id="3078247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078251">return</span>&nbsp;<span class="ident" id="3078258">nil</span><span class="op" id="3078261">,</span>&nbsp;<span class="ident" id="3078263">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3078268">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078271">switch</span>&nbsp;<span class="ident" id="3078278">laddr</span>&nbsp;<span class="op" id="3078284">:=</span>&nbsp;<span class="ident" id="3078287">fd</span><span class="op" id="3078289">.</span><span class="ident" id="3078290">laddr</span><span class="op" id="3078295">.</span><span class="op" id="3078296">(</span><span class="keyword" id="3078297">type</span><span class="op" id="3078301">)</span>&nbsp;<span class="op" id="3078303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078306">case</span>&nbsp;<span class="op" id="3078311">*</span><span class="ident" id="3078312">TCPAddr</span><span class="op" id="3078319">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078323">return</span>&nbsp;<span class="op" id="3078330">&amp;</span><span class="ident" id="3078331">TCPListener</span><span class="op" id="3078342">{</span><span class="ident" id="3078343">fd</span><span class="op" id="3078345">}</span><span class="op" id="3078346">,</span>&nbsp;<span class="ident" id="3078348">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078353">case</span>&nbsp;<span class="op" id="3078358">*</span><span class="ident" id="3078359">UnixAddr</span><span class="op" id="3078367">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078371">return</span>&nbsp;<span class="op" id="3078378">&amp;</span><span class="ident" id="3078379">UnixListener</span><span class="op" id="3078391">{</span><span class="ident" id="3078392">fd</span><span class="op" id="3078394">,</span>&nbsp;<span class="ident" id="3078396">laddr</span><span class="op" id="3078401">.</span><span class="ident" id="3078402">Name</span><span class="op" id="3078406">}</span><span class="op" id="3078407">,</span>&nbsp;<span class="ident" id="3078409">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3078414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078417">fd</span><span class="op" id="3078419">.</span><span class="ident" id="3078420">Close</span><span class="op" id="3078425">(</span><span class="op" id="3078426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078429">return</span>&nbsp;<span class="ident" id="3078436">nil</span><span class="op" id="3078439">,</span>&nbsp;<span class="ident" id="3078441">syscall</span><span class="op" id="3078448">.</span><span class="ident" id="3078449">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3078456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3078459">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3078525">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3078582">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3078653">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3078692">func</span>&nbsp;<span class="ident" id="3078697">FilePacketConn</span><span class="op" id="3078711">(</span><span class="ident" id="3078712">f</span>&nbsp;<span class="op" id="3078714">*</span><span class="ident" id="3078715">os</span><span class="op" id="3078717">.</span><span class="ident" id="3078718">File</span><span class="op" id="3078722">)</span>&nbsp;<span class="op" id="3078724">(</span><span class="ident" id="3078725">c</span>&nbsp;<span class="ident" id="3078727">PacketConn</span><span class="op" id="3078737">,</span>&nbsp;<span class="ident" id="3078739">err</span>&nbsp;<span class="builtintype" id="3078743">error</span><span class="op" id="3078748">)</span>&nbsp;<span class="op" id="3078750">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078753">fd</span><span class="op" id="3078755">,</span>&nbsp;<span class="ident" id="3078757">err</span>&nbsp;<span class="op" id="3078761">:=</span>&nbsp;<span class="ident" id="3078764">newFileFD</span><span class="op" id="3078773">(</span><span class="ident" id="3078774">f</span><span class="op" id="3078775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078778">if</span>&nbsp;<span class="ident" id="3078781">err</span>&nbsp;<span class="op" id="3078785">!=</span>&nbsp;<span class="ident" id="3078788">nil</span>&nbsp;<span class="op" id="3078792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078796">return</span>&nbsp;<span class="ident" id="3078803">nil</span><span class="op" id="3078806">,</span>&nbsp;<span class="ident" id="3078808">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3078813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078816">switch</span>&nbsp;<span class="ident" id="3078823">fd</span><span class="op" id="3078825">.</span><span class="ident" id="3078826">laddr</span><span class="op" id="3078831">.</span><span class="op" id="3078832">(</span><span class="keyword" id="3078833">type</span><span class="op" id="3078837">)</span>&nbsp;<span class="op" id="3078839">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078842">case</span>&nbsp;<span class="op" id="3078847">*</span><span class="ident" id="3078848">UDPAddr</span><span class="op" id="3078855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078859">return</span>&nbsp;<span class="ident" id="3078866">newUDPConn</span><span class="op" id="3078876">(</span><span class="ident" id="3078877">fd</span><span class="op" id="3078879">)</span><span class="op" id="3078880">,</span>&nbsp;<span class="ident" id="3078882">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078887">case</span>&nbsp;<span class="op" id="3078892">*</span><span class="ident" id="3078893">IPAddr</span><span class="op" id="3078899">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078903">return</span>&nbsp;<span class="ident" id="3078910">newIPConn</span><span class="op" id="3078919">(</span><span class="ident" id="3078920">fd</span><span class="op" id="3078922">)</span><span class="op" id="3078923">,</span>&nbsp;<span class="ident" id="3078925">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078930">case</span>&nbsp;<span class="op" id="3078935">*</span><span class="ident" id="3078936">UnixAddr</span><span class="op" id="3078944">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078948">return</span>&nbsp;<span class="ident" id="3078955">newUnixConn</span><span class="op" id="3078966">(</span><span class="ident" id="3078967">fd</span><span class="op" id="3078969">)</span><span class="op" id="3078970">,</span>&nbsp;<span class="ident" id="3078972">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3078977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078980">fd</span><span class="op" id="3078982">.</span><span class="ident" id="3078983">Close</span><span class="op" id="3078988">(</span><span class="op" id="3078989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3078992">return</span>&nbsp;<span class="ident" id="3078999">nil</span><span class="op" id="3079002">,</span>&nbsp;<span class="ident" id="3079004">syscall</span><span class="op" id="3079011">.</span><span class="ident" id="3079012">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3079019">}</span>
</div>
</body>
</html>
