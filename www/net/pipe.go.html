<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3425168">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3425224">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3425278">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3425329">package</span>&nbsp;<span class="ident" id="3425337">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3425342">import</span>&nbsp;<span class="op" id="3425349">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3425352">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3425362">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3425368">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="3425375">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3425378">//&nbsp;Pipe&nbsp;creates&nbsp;a&nbsp;synchronous,&nbsp;in-memory,&nbsp;full&nbsp;duplex</span><br>
<span class="lineno"></span><span class="comment" id="3425432">//&nbsp;network&nbsp;connection;&nbsp;both&nbsp;ends&nbsp;implement&nbsp;the&nbsp;Conn&nbsp;interface.</span><br>
<span class="lineno">15</span><span class="comment" id="3425495">//&nbsp;Reads&nbsp;on&nbsp;one&nbsp;end&nbsp;are&nbsp;matched&nbsp;with&nbsp;writes&nbsp;on&nbsp;the&nbsp;other,</span><br>
<span class="lineno"></span><span class="comment" id="3425553">//&nbsp;copying&nbsp;data&nbsp;directly&nbsp;between&nbsp;the&nbsp;two;&nbsp;there&nbsp;is&nbsp;no&nbsp;internal</span><br>
<span class="lineno"></span><span class="comment" id="3425616">//&nbsp;buffering.</span><br>
<span class="lineno"></span><span class="keyword" id="3425630">func</span>&nbsp;<span class="ident" id="3425635">Pipe</span><span class="op" id="3425639">(</span><span class="op" id="3425640">)</span>&nbsp;<span class="op" id="3425642">(</span><span class="ident" id="3425643">Conn</span><span class="op" id="3425647">,</span>&nbsp;<span class="ident" id="3425649">Conn</span><span class="op" id="3425653">)</span>&nbsp;<span class="op" id="3425655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425658">r1</span><span class="op" id="3425660">,</span>&nbsp;<span class="ident" id="3425662">w1</span>&nbsp;<span class="op" id="3425665">:=</span>&nbsp;<span class="ident" id="3425668">io</span><span class="op" id="3425670">.</span><span class="ident" id="3425671">Pipe</span><span class="op" id="3425675">(</span><span class="op" id="3425676">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425679">r2</span><span class="op" id="3425681">,</span>&nbsp;<span class="ident" id="3425683">w2</span>&nbsp;<span class="op" id="3425686">:=</span>&nbsp;<span class="ident" id="3425689">io</span><span class="op" id="3425691">.</span><span class="ident" id="3425692">Pipe</span><span class="op" id="3425696">(</span><span class="op" id="3425697">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425701">return</span>&nbsp;<span class="op" id="3425708">&amp;</span><span class="ident" id="3425709">pipe</span><span class="op" id="3425713">{</span><span class="ident" id="3425714">r1</span><span class="op" id="3425716">,</span>&nbsp;<span class="ident" id="3425718">w2</span><span class="op" id="3425720">}</span><span class="op" id="3425721">,</span>&nbsp;<span class="op" id="3425723">&amp;</span><span class="ident" id="3425724">pipe</span><span class="op" id="3425728">{</span><span class="ident" id="3425729">r2</span><span class="op" id="3425731">,</span>&nbsp;<span class="ident" id="3425733">w1</span><span class="op" id="3425735">}</span><br>
<span class="lineno"></span><span class="op" id="3425737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="3425740">type</span>&nbsp;<span class="ident" id="3425745">pipe</span>&nbsp;<span class="keyword" id="3425750">struct</span>&nbsp;<span class="op" id="3425757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425760">*</span><span class="ident" id="3425761">io</span><span class="op" id="3425763">.</span><span class="ident" id="3425764">PipeReader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3425776">*</span><span class="ident" id="3425777">io</span><span class="op" id="3425779">.</span><span class="ident" id="3425780">PipeWriter</span><br>
<span class="lineno"></span><span class="op" id="3425791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3425794">type</span>&nbsp;<span class="ident" id="3425799">pipeAddr</span>&nbsp;<span class="builtintype" id="3425808">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3425813">func</span>&nbsp;<span class="op" id="3425818">(</span><span class="ident" id="3425819">pipeAddr</span><span class="op" id="3425827">)</span>&nbsp;<span class="ident" id="3425829">Network</span><span class="op" id="3425836">(</span><span class="op" id="3425837">)</span>&nbsp;<span class="builtintype" id="3425839">string</span>&nbsp;<span class="op" id="3425846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425849">return</span>&nbsp;<span class="string" id="3425856">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3425863">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="3425866">func</span>&nbsp;<span class="op" id="3425871">(</span><span class="ident" id="3425872">pipeAddr</span><span class="op" id="3425880">)</span>&nbsp;<span class="ident" id="3425882">String</span><span class="op" id="3425888">(</span><span class="op" id="3425889">)</span>&nbsp;<span class="builtintype" id="3425891">string</span>&nbsp;<span class="op" id="3425898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3425901">return</span>&nbsp;<span class="string" id="3425908">&#34;pipe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3425915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="3425918">func</span>&nbsp;<span class="op" id="3425923">(</span><span class="ident" id="3425924">p</span>&nbsp;<span class="op" id="3425926">*</span><span class="ident" id="3425927">pipe</span><span class="op" id="3425931">)</span>&nbsp;<span class="ident" id="3425933">Close</span><span class="op" id="3425938">(</span><span class="op" id="3425939">)</span>&nbsp;<span class="builtintype" id="3425941">error</span>&nbsp;<span class="op" id="3425947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425950">err</span>&nbsp;<span class="op" id="3425954">:=</span>&nbsp;<span class="ident" id="3425957">p</span><span class="op" id="3425958">.</span><span class="ident" id="3425959">PipeReader</span><span class="op" id="3425969">.</span><span class="ident" id="3425970">Close</span><span class="op" id="3425975">(</span><span class="op" id="3425976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3425979">err1</span>&nbsp;<span class="op" id="3425984">:=</span>&nbsp;<span class="ident" id="3425987">p</span><span class="op" id="3425988">.</span><span class="ident" id="3425989">PipeWriter</span><span class="op" id="3425999">.</span><span class="ident" id="3426000">Close</span><span class="op" id="3426005">(</span><span class="op" id="3426006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426009">if</span>&nbsp;<span class="ident" id="3426012">err</span>&nbsp;<span class="op" id="3426016">==</span>&nbsp;<span class="ident" id="3426019">nil</span>&nbsp;<span class="op" id="3426023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3426027">err</span>&nbsp;<span class="op" id="3426031">=</span>&nbsp;<span class="ident" id="3426033">err1</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3426039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426042">return</span>&nbsp;<span class="ident" id="3426049">err</span><br>
<span class="lineno"></span><span class="op" id="3426053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3426056">func</span>&nbsp;<span class="op" id="3426061">(</span><span class="ident" id="3426062">p</span>&nbsp;<span class="op" id="3426064">*</span><span class="ident" id="3426065">pipe</span><span class="op" id="3426069">)</span>&nbsp;<span class="ident" id="3426071">LocalAddr</span><span class="op" id="3426080">(</span><span class="op" id="3426081">)</span>&nbsp;<span class="ident" id="3426083">Addr</span>&nbsp;<span class="op" id="3426088">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426091">return</span>&nbsp;<span class="ident" id="3426098">pipeAddr</span><span class="op" id="3426106">(</span><span class="num" id="3426107">0</span><span class="op" id="3426108">)</span><br>
<span class="lineno"></span><span class="op" id="3426110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3426113">func</span>&nbsp;<span class="op" id="3426118">(</span><span class="ident" id="3426119">p</span>&nbsp;<span class="op" id="3426121">*</span><span class="ident" id="3426122">pipe</span><span class="op" id="3426126">)</span>&nbsp;<span class="ident" id="3426128">RemoteAddr</span><span class="op" id="3426138">(</span><span class="op" id="3426139">)</span>&nbsp;<span class="ident" id="3426141">Addr</span>&nbsp;<span class="op" id="3426146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426149">return</span>&nbsp;<span class="ident" id="3426156">pipeAddr</span><span class="op" id="3426164">(</span><span class="num" id="3426165">0</span><span class="op" id="3426166">)</span><br>
<span class="lineno">55</span><span class="op" id="3426168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3426171">func</span>&nbsp;<span class="op" id="3426176">(</span><span class="ident" id="3426177">p</span>&nbsp;<span class="op" id="3426179">*</span><span class="ident" id="3426180">pipe</span><span class="op" id="3426184">)</span>&nbsp;<span class="ident" id="3426186">SetDeadline</span><span class="op" id="3426197">(</span><span class="ident" id="3426198">t</span>&nbsp;<span class="ident" id="3426200">time</span><span class="op" id="3426204">.</span><span class="ident" id="3426205">Time</span><span class="op" id="3426209">)</span>&nbsp;<span class="builtintype" id="3426211">error</span>&nbsp;<span class="op" id="3426217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426220">return</span>&nbsp;<span class="ident" id="3426227">errors</span><span class="op" id="3426233">.</span><span class="ident" id="3426234">New</span><span class="op" id="3426237">(</span><span class="string" id="3426238">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3426275">)</span><br>
<span class="lineno"></span><span class="op" id="3426277">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="3426280">func</span>&nbsp;<span class="op" id="3426285">(</span><span class="ident" id="3426286">p</span>&nbsp;<span class="op" id="3426288">*</span><span class="ident" id="3426289">pipe</span><span class="op" id="3426293">)</span>&nbsp;<span class="ident" id="3426295">SetReadDeadline</span><span class="op" id="3426310">(</span><span class="ident" id="3426311">t</span>&nbsp;<span class="ident" id="3426313">time</span><span class="op" id="3426317">.</span><span class="ident" id="3426318">Time</span><span class="op" id="3426322">)</span>&nbsp;<span class="builtintype" id="3426324">error</span>&nbsp;<span class="op" id="3426330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426333">return</span>&nbsp;<span class="ident" id="3426340">errors</span><span class="op" id="3426346">.</span><span class="ident" id="3426347">New</span><span class="op" id="3426350">(</span><span class="string" id="3426351">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3426388">)</span><br>
<span class="lineno"></span><span class="op" id="3426390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3426393">func</span>&nbsp;<span class="op" id="3426398">(</span><span class="ident" id="3426399">p</span>&nbsp;<span class="op" id="3426401">*</span><span class="ident" id="3426402">pipe</span><span class="op" id="3426406">)</span>&nbsp;<span class="ident" id="3426408">SetWriteDeadline</span><span class="op" id="3426424">(</span><span class="ident" id="3426425">t</span>&nbsp;<span class="ident" id="3426427">time</span><span class="op" id="3426431">.</span><span class="ident" id="3426432">Time</span><span class="op" id="3426436">)</span>&nbsp;<span class="builtintype" id="3426438">error</span>&nbsp;<span class="op" id="3426444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3426447">return</span>&nbsp;<span class="ident" id="3426454">errors</span><span class="op" id="3426460">.</span><span class="ident" id="3426461">New</span><span class="op" id="3426464">(</span><span class="string" id="3426465">&#34;net.Pipe&nbsp;does&nbsp;not&nbsp;support&nbsp;deadlines&#34;</span><span class="op" id="3426502">)</span><br>
<span class="lineno"></span><span class="op" id="3426504">}</span>
</div>
</body>
</html>
