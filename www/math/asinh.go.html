<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1963794">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1963849">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1963903">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1963954">package</span>&nbsp;<span class="ident" id="1963962">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1963968">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1964028">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_asinh.c</span><br>
<span class="lineno"></span><span class="comment" id="1964088">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="1964147">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="1964177">//</span><br>
<span class="lineno"></span><span class="comment" id="1964180">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1964236">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1964305">//</span><br>
<span class="lineno">15</span><span class="comment" id="1964308">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="1964367">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1964423">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1964480">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1964497">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="1964553">//</span><br>
<span class="lineno"></span><span class="comment" id="1964556">//</span><br>
<span class="lineno"></span><span class="comment" id="1964559">//&nbsp;asinh(x)</span><br>
<span class="lineno"></span><span class="comment" id="1964571">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno"></span><span class="comment" id="1964583">//&nbsp;&nbsp;&nbsp;&nbspBased&nbsp;on</span><br>
<span class="lineno">25</span><span class="comment" id="1964595">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asinh(x)&nbsp;=&nbsp;sign(x)&nbsp;*&nbsp;log&nbsp;[&nbsp;|x|&nbsp;+&nbsp;sqrt(x*x+1)&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="1964653">//&nbsp;&nbsp;&nbsp;&nbspwe&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="1964664">//&nbsp;&nbsp;&nbsp;&nbspasinh(x)&nbsp;:=&nbsp;x&nbsp;&nbsp;if&nbsp;&nbsp;1+x*x=1,</span><br>
<span class="lineno"></span><span class="comment" id="1964695">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*(log(x)+ln2))&nbsp;for&nbsp;large&nbsp;|x|,&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1964752">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*log(2|x|+1/(|x|+sqrt(x*x+1)))&nbsp;if|x|&gt;2,&nbsp;else</span><br>
<span class="lineno">30</span><span class="comment" id="1964819">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;sign(x)*log1p(|x|&nbsp;+&nbsp;x**2/(1&nbsp;+&nbsp;sqrt(1+x**2)))</span><br>
<span class="lineno"></span><span class="comment" id="1964879">//</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1964883">//&nbsp;Asinh&nbsp;returns&nbsp;the&nbsp;inverse&nbsp;hyperbolic&nbsp;sine&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1964934">//</span><br>
<span class="lineno">35</span><span class="comment" id="1964937">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1964959">//&nbsp;&nbsp;&nbsp;&nbspAsinh(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1964979">//&nbsp;&nbsp;&nbsp;&nbspAsinh(±Inf)&nbsp;=&nbsp;±Inf</span><br>
<span class="lineno"></span><span class="comment" id="1965003">//&nbsp;&nbsp;&nbsp;&nbspAsinh(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1965023">func</span>&nbsp;<span class="ident" id="1965028">Asinh</span><span class="op" id="1965033">(</span><span class="ident" id="1965034">x</span>&nbsp;<span class="builtintype" id="1965036">float64</span><span class="op" id="1965043">)</span>&nbsp;<span class="builtintype" id="1965045">float64</span>&nbsp;<span class="op" id="1965053">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965056">const</span>&nbsp;<span class="op" id="1965062">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965066">Ln2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1965075">=</span>&nbsp;<span class="num" id="1965077">6.93147180559945286227e-01</span>&nbsp;<span class="comment" id="1965104">//&nbsp;0x3FE62E42FEFA39EF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965128">NearZero</span>&nbsp;<span class="op" id="1965137">=</span>&nbsp;<span class="num" id="1965139">1.0</span>&nbsp;<span class="op" id="1965143">/</span>&nbsp;<span class="op" id="1965145">(</span><span class="num" id="1965146">1</span>&nbsp;<span class="op" id="1965148">&lt;&lt;</span>&nbsp;<span class="num" id="1965151">28</span><span class="op" id="1965153">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1965166">//&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965178">Large</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1965187">=</span>&nbsp;<span class="num" id="1965189">1</span>&nbsp;<span class="op" id="1965191">&lt;&lt;</span>&nbsp;<span class="num" id="1965194">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1965216">//&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965226">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1965229">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965247">if</span>&nbsp;<span class="ident" id="1965250">IsNaN</span><span class="op" id="1965255">(</span><span class="ident" id="1965256">x</span><span class="op" id="1965257">)</span>&nbsp;<span class="op" id="1965259">||</span>&nbsp;<span class="ident" id="1965262">IsInf</span><span class="op" id="1965267">(</span><span class="ident" id="1965268">x</span><span class="op" id="1965269">,</span>&nbsp;<span class="num" id="1965271">0</span><span class="op" id="1965272">)</span>&nbsp;<span class="op" id="1965274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965278">return</span>&nbsp;<span class="ident" id="1965285">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965288">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965291">sign</span>&nbsp;<span class="op" id="1965296">:=</span>&nbsp;<span class="ident" id="1965299">false</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965306">if</span>&nbsp;<span class="ident" id="1965309">x</span>&nbsp;<span class="op" id="1965311">&lt;</span>&nbsp;<span class="num" id="1965313">0</span>&nbsp;<span class="op" id="1965315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965319">x</span>&nbsp;<span class="op" id="1965321">=</span>&nbsp;<span class="op" id="1965323">-</span><span class="ident" id="1965324">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965328">sign</span>&nbsp;<span class="op" id="1965333">=</span>&nbsp;<span class="ident" id="1965335">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965344">var</span>&nbsp;<span class="ident" id="1965348">temp</span>&nbsp;<span class="builtintype" id="1965353">float64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965362">switch</span>&nbsp;<span class="op" id="1965369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965372">case</span>&nbsp;<span class="ident" id="1965377">x</span>&nbsp;<span class="op" id="1965379">&gt;</span>&nbsp;<span class="ident" id="1965381">Large</span><span class="op" id="1965386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965390">temp</span>&nbsp;<span class="op" id="1965395">=</span>&nbsp;<span class="ident" id="1965397">Log</span><span class="op" id="1965400">(</span><span class="ident" id="1965401">x</span><span class="op" id="1965402">)</span>&nbsp;<span class="op" id="1965404">+</span>&nbsp;<span class="ident" id="1965406">Ln2</span>&nbsp;<span class="comment" id="1965410">//&nbsp;|x|&nbsp;&gt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965426">case</span>&nbsp;<span class="ident" id="1965431">x</span>&nbsp;<span class="op" id="1965433">&gt;</span>&nbsp;<span class="num" id="1965435">2</span><span class="op" id="1965436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965440">temp</span>&nbsp;<span class="op" id="1965445">=</span>&nbsp;<span class="ident" id="1965447">Log</span><span class="op" id="1965450">(</span><span class="num" id="1965451">2</span><span class="op" id="1965452">*</span><span class="ident" id="1965453">x</span>&nbsp;<span class="op" id="1965455">+</span>&nbsp;<span class="num" id="1965457">1</span><span class="op" id="1965458">/</span><span class="op" id="1965459">(</span><span class="ident" id="1965460">Sqrt</span><span class="op" id="1965464">(</span><span class="ident" id="1965465">x</span><span class="op" id="1965466">*</span><span class="ident" id="1965467">x</span><span class="op" id="1965468">+</span><span class="num" id="1965469">1</span><span class="op" id="1965470">)</span><span class="op" id="1965471">+</span><span class="ident" id="1965472">x</span><span class="op" id="1965473">)</span><span class="op" id="1965474">)</span>&nbsp;<span class="comment" id="1965476">//&nbsp;2**28&nbsp;&gt;&nbsp;|x|&nbsp;&gt;&nbsp;2.0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965498">case</span>&nbsp;<span class="ident" id="1965503">x</span>&nbsp;<span class="op" id="1965505">&lt;</span>&nbsp;<span class="ident" id="1965507">NearZero</span><span class="op" id="1965515">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965519">temp</span>&nbsp;<span class="op" id="1965524">=</span>&nbsp;<span class="ident" id="1965526">x</span>&nbsp;<span class="comment" id="1965528">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965545">default</span><span class="op" id="1965552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965556">temp</span>&nbsp;<span class="op" id="1965561">=</span>&nbsp;<span class="ident" id="1965563">Log1p</span><span class="op" id="1965568">(</span><span class="ident" id="1965569">x</span>&nbsp;<span class="op" id="1965571">+</span>&nbsp;<span class="ident" id="1965573">x</span><span class="op" id="1965574">*</span><span class="ident" id="1965575">x</span><span class="op" id="1965576">/</span><span class="op" id="1965577">(</span><span class="num" id="1965578">1</span><span class="op" id="1965579">+</span><span class="ident" id="1965580">Sqrt</span><span class="op" id="1965584">(</span><span class="num" id="1965585">1</span><span class="op" id="1965586">+</span><span class="ident" id="1965587">x</span><span class="op" id="1965588">*</span><span class="ident" id="1965589">x</span><span class="op" id="1965590">)</span><span class="op" id="1965591">)</span><span class="op" id="1965592">)</span>&nbsp;<span class="comment" id="1965594">//&nbsp;2.0&nbsp;&gt;&nbsp;|x|&nbsp;&gt;&nbsp;2**-28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965617">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965620">if</span>&nbsp;<span class="ident" id="1965623">sign</span>&nbsp;<span class="op" id="1965628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1965632">temp</span>&nbsp;<span class="op" id="1965637">=</span>&nbsp;<span class="op" id="1965639">-</span><span class="ident" id="1965640">temp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1965646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1965649">return</span>&nbsp;<span class="ident" id="1965656">temp</span><br>
<span class="lineno"></span><span class="op" id="1965661">}</span>
</div>
</body>
</html>
