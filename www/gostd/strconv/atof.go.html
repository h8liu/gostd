<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>strconv</h2>
<ul>
<li><a href="/gostd/strconv/atob.go.html">atob.go</a></li>
<li><a href="/gostd/strconv/atob_test.go.html">atob_test.go</a></li>
<li><a href="/gostd/strconv/atof.go.html">atof.go</a></li>
<li><a href="/gostd/strconv/atof_test.go.html">atof_test.go</a></li>
<li><a href="/gostd/strconv/atoi.go.html">atoi.go</a></li>
<li><a href="/gostd/strconv/atoi_test.go.html">atoi_test.go</a></li>
<li><a href="/gostd/strconv/decimal.go.html">decimal.go</a></li>
<li><a href="/gostd/strconv/decimal_test.go.html">decimal_test.go</a></li>
<li><a href="/gostd/strconv/extfloat.go.html">extfloat.go</a></li>
<li><a href="/gostd/strconv/fp_test.go.html">fp_test.go</a></li>
<li><a href="/gostd/strconv/ftoa.go.html">ftoa.go</a></li>
<li><a href="/gostd/strconv/ftoa_test.go.html">ftoa_test.go</a></li>
<li><a href="/gostd/strconv/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/strconv/isprint.go.html">isprint.go</a></li>
<li><a href="/gostd/strconv/itoa.go.html">itoa.go</a></li>
<li><a href="/gostd/strconv/itoa_test.go.html">itoa_test.go</a></li>
<li><a href="/gostd/strconv/quote.go.html">quote.go</a></li>
<li><a href="/gostd/strconv/quote_example_test.go.html">quote_example_test.go</a></li>
<li><a href="/gostd/strconv/quote_test.go.html">quote_test.go</a></li>
<li><a href="/gostd/strconv/strconv_test.go.html">strconv_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1727377">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1727432">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1727486">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1727537">//&nbsp;Package&nbsp;strconv&nbsp;implements&nbsp;conversions&nbsp;to&nbsp;and&nbsp;from&nbsp;string&nbsp;representations</span><br>
<span class="lineno"></span><span class="comment" id="1727614">//&nbsp;of&nbsp;basic&nbsp;data&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="1727638">package</span>&nbsp;<span class="ident" id="1727646">strconv</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1727655">//&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;floating&nbsp;point&nbsp;conversion.</span><br>
<span class="lineno">10</span><span class="comment" id="1727703">//&nbsp;Algorithm:</span><br>
<span class="lineno"></span><span class="comment" id="1727717">//&nbsp;&nbsp;&nbsp;1)&nbsp;Store&nbsp;input&nbsp;in&nbsp;multiprecision&nbsp;decimal.</span><br>
<span class="lineno"></span><span class="comment" id="1727764">//&nbsp;&nbsp;&nbsp;2)&nbsp;Multiply/divide&nbsp;decimal&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1)</span><br>
<span class="lineno"></span><span class="comment" id="1727837">//&nbsp;&nbsp;&nbsp;3)&nbsp;Multiply&nbsp;by&nbsp;2^precision&nbsp;and&nbsp;round&nbsp;to&nbsp;get&nbsp;mantissa.</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="1727897">import</span>&nbsp;<span class="string" id="1727904">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1727912">var</span>&nbsp;<span class="ident" id="1727916">optimize</span>&nbsp;<span class="op" id="1727925">=</span>&nbsp;<span class="builtintype" id="1727927">true</span>&nbsp;<span class="comment" id="1727932">//&nbsp;can&nbsp;change&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1727959">func</span>&nbsp;<span class="ident" id="1727964">equalIgnoreCase</span><span class="op" id="1727979">(</span><span class="ident" id="1727980">s1</span><span class="op" id="1727982">,</span>&nbsp;<span class="ident" id="1727984">s2</span>&nbsp;<span class="builtintype" id="1727987">string</span><span class="op" id="1727993">)</span>&nbsp;<span class="builtintype" id="1727995">bool</span>&nbsp;<span class="op" id="1728000">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728003">if</span>&nbsp;<span class="builtinfunc" id="1728006">len</span><span class="op" id="1728009">(</span><span class="ident" id="1728010">s1</span><span class="op" id="1728012">)</span>&nbsp;<span class="op" id="1728014">!=</span>&nbsp;<span class="builtinfunc" id="1728017">len</span><span class="op" id="1728020">(</span><span class="ident" id="1728021">s2</span><span class="op" id="1728023">)</span>&nbsp;<span class="op" id="1728025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728029">return</span>&nbsp;<span class="builtintype" id="1728036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728046">for</span>&nbsp;<span class="ident" id="1728050">i</span>&nbsp;<span class="op" id="1728052">:=</span>&nbsp;<span class="num" id="1728055">0</span><span class="op" id="1728056">;</span>&nbsp;<span class="ident" id="1728058">i</span>&nbsp;<span class="op" id="1728060">&lt;</span>&nbsp;<span class="builtinfunc" id="1728062">len</span><span class="op" id="1728065">(</span><span class="ident" id="1728066">s1</span><span class="op" id="1728068">)</span><span class="op" id="1728069">;</span>&nbsp;<span class="ident" id="1728071">i</span><span class="op" id="1728072">++</span>&nbsp;<span class="op" id="1728075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728079">c1</span>&nbsp;<span class="op" id="1728082">:=</span>&nbsp;<span class="ident" id="1728085">s1</span><span class="op" id="1728087">[</span><span class="ident" id="1728088">i</span><span class="op" id="1728089">]</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728093">if</span>&nbsp;<span class="string" id="1728096">&#39;A&#39;</span>&nbsp;<span class="op" id="1728100">&lt;=</span>&nbsp;<span class="ident" id="1728103">c1</span>&nbsp;<span class="op" id="1728106">&amp;&amp;</span>&nbsp;<span class="ident" id="1728109">c1</span>&nbsp;<span class="op" id="1728112">&lt;=</span>&nbsp;<span class="string" id="1728115">&#39;Z&#39;</span>&nbsp;<span class="op" id="1728119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728124">c1</span>&nbsp;<span class="op" id="1728127">+=</span>&nbsp;<span class="string" id="1728130">&#39;a&#39;</span>&nbsp;<span class="op" id="1728134">-</span>&nbsp;<span class="string" id="1728136">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728146">c2</span>&nbsp;<span class="op" id="1728149">:=</span>&nbsp;<span class="ident" id="1728152">s2</span><span class="op" id="1728154">[</span><span class="ident" id="1728155">i</span><span class="op" id="1728156">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728160">if</span>&nbsp;<span class="string" id="1728163">&#39;A&#39;</span>&nbsp;<span class="op" id="1728167">&lt;=</span>&nbsp;<span class="ident" id="1728170">c2</span>&nbsp;<span class="op" id="1728173">&amp;&amp;</span>&nbsp;<span class="ident" id="1728176">c2</span>&nbsp;<span class="op" id="1728179">&lt;=</span>&nbsp;<span class="string" id="1728182">&#39;Z&#39;</span>&nbsp;<span class="op" id="1728186">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728191">c2</span>&nbsp;<span class="op" id="1728194">+=</span>&nbsp;<span class="string" id="1728197">&#39;a&#39;</span>&nbsp;<span class="op" id="1728201">-</span>&nbsp;<span class="string" id="1728203">&#39;A&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728213">if</span>&nbsp;<span class="ident" id="1728216">c1</span>&nbsp;<span class="op" id="1728219">!=</span>&nbsp;<span class="ident" id="1728222">c2</span>&nbsp;<span class="op" id="1728225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728230">return</span>&nbsp;<span class="builtintype" id="1728237">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728245">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728251">return</span>&nbsp;<span class="builtintype" id="1728258">true</span><br>
<span class="lineno"></span><span class="op" id="1728263">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1728266">func</span>&nbsp;<span class="ident" id="1728271">special</span><span class="op" id="1728278">(</span><span class="ident" id="1728279">s</span>&nbsp;<span class="builtintype" id="1728281">string</span><span class="op" id="1728287">)</span>&nbsp;<span class="op" id="1728289">(</span><span class="ident" id="1728290">f</span>&nbsp;<span class="builtintype" id="1728292">float64</span><span class="op" id="1728299">,</span>&nbsp;<span class="ident" id="1728301">ok</span>&nbsp;<span class="builtintype" id="1728304">bool</span><span class="op" id="1728308">)</span>&nbsp;<span class="op" id="1728310">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728313">if</span>&nbsp;<span class="builtinfunc" id="1728316">len</span><span class="op" id="1728319">(</span><span class="ident" id="1728320">s</span><span class="op" id="1728321">)</span>&nbsp;<span class="op" id="1728323">==</span>&nbsp;<span class="num" id="1728326">0</span>&nbsp;<span class="op" id="1728328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728332">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728343">switch</span>&nbsp;<span class="ident" id="1728350">s</span><span class="op" id="1728351">[</span><span class="num" id="1728352">0</span><span class="op" id="1728353">]</span>&nbsp;<span class="op" id="1728355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728358">default</span><span class="op" id="1728365">:</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728369">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728377">case</span>&nbsp;<span class="string" id="1728382">&#39;+&#39;</span><span class="op" id="1728385">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728389">if</span>&nbsp;<span class="ident" id="1728392">equalIgnoreCase</span><span class="op" id="1728407">(</span><span class="ident" id="1728408">s</span><span class="op" id="1728409">,</span>&nbsp;<span class="string" id="1728411">&#34;+inf&#34;</span><span class="op" id="1728417">)</span>&nbsp;<span class="op" id="1728419">||</span>&nbsp;<span class="ident" id="1728422">equalIgnoreCase</span><span class="op" id="1728437">(</span><span class="ident" id="1728438">s</span><span class="op" id="1728439">,</span>&nbsp;<span class="string" id="1728441">&#34;+infinity&#34;</span><span class="op" id="1728452">)</span>&nbsp;<span class="op" id="1728454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728459">return</span>&nbsp;<span class="ident" id="1728466">math</span><span class="op" id="1728470">.</span><span class="ident" id="1728471">Inf</span><span class="op" id="1728474">(</span><span class="num" id="1728475">1</span><span class="op" id="1728476">)</span><span class="op" id="1728477">,</span>&nbsp;<span class="builtintype" id="1728479">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728486">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728489">case</span>&nbsp;<span class="string" id="1728494">&#39;-&#39;</span><span class="op" id="1728497">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728501">if</span>&nbsp;<span class="ident" id="1728504">equalIgnoreCase</span><span class="op" id="1728519">(</span><span class="ident" id="1728520">s</span><span class="op" id="1728521">,</span>&nbsp;<span class="string" id="1728523">&#34;-inf&#34;</span><span class="op" id="1728529">)</span>&nbsp;<span class="op" id="1728531">||</span>&nbsp;<span class="ident" id="1728534">equalIgnoreCase</span><span class="op" id="1728549">(</span><span class="ident" id="1728550">s</span><span class="op" id="1728551">,</span>&nbsp;<span class="string" id="1728553">&#34;-infinity&#34;</span><span class="op" id="1728564">)</span>&nbsp;<span class="op" id="1728566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728571">return</span>&nbsp;<span class="ident" id="1728578">math</span><span class="op" id="1728582">.</span><span class="ident" id="1728583">Inf</span><span class="op" id="1728586">(</span><span class="op" id="1728587">-</span><span class="num" id="1728588">1</span><span class="op" id="1728589">)</span><span class="op" id="1728590">,</span>&nbsp;<span class="builtintype" id="1728592">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728602">case</span>&nbsp;<span class="string" id="1728607">&#39;n&#39;</span><span class="op" id="1728610">,</span>&nbsp;<span class="string" id="1728612">&#39;N&#39;</span><span class="op" id="1728615">:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728619">if</span>&nbsp;<span class="ident" id="1728622">equalIgnoreCase</span><span class="op" id="1728637">(</span><span class="ident" id="1728638">s</span><span class="op" id="1728639">,</span>&nbsp;<span class="string" id="1728641">&#34;nan&#34;</span><span class="op" id="1728646">)</span>&nbsp;<span class="op" id="1728648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728653">return</span>&nbsp;<span class="ident" id="1728660">math</span><span class="op" id="1728664">.</span><span class="ident" id="1728665">NaN</span><span class="op" id="1728668">(</span><span class="op" id="1728669">)</span><span class="op" id="1728670">,</span>&nbsp;<span class="builtintype" id="1728672">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728682">case</span>&nbsp;<span class="string" id="1728687">&#39;i&#39;</span><span class="op" id="1728690">,</span>&nbsp;<span class="string" id="1728692">&#39;I&#39;</span><span class="op" id="1728695">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728699">if</span>&nbsp;<span class="ident" id="1728702">equalIgnoreCase</span><span class="op" id="1728717">(</span><span class="ident" id="1728718">s</span><span class="op" id="1728719">,</span>&nbsp;<span class="string" id="1728721">&#34;inf&#34;</span><span class="op" id="1728726">)</span>&nbsp;<span class="op" id="1728728">||</span>&nbsp;<span class="ident" id="1728731">equalIgnoreCase</span><span class="op" id="1728746">(</span><span class="ident" id="1728747">s</span><span class="op" id="1728748">,</span>&nbsp;<span class="string" id="1728750">&#34;infinity&#34;</span><span class="op" id="1728760">)</span>&nbsp;<span class="op" id="1728762">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728767">return</span>&nbsp;<span class="ident" id="1728774">math</span><span class="op" id="1728778">.</span><span class="ident" id="1728779">Inf</span><span class="op" id="1728782">(</span><span class="num" id="1728783">1</span><span class="op" id="1728784">)</span><span class="op" id="1728785">,</span>&nbsp;<span class="builtintype" id="1728787">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728800">return</span><br>
<span class="lineno"></span><span class="op" id="1728807">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="1728810">func</span>&nbsp;<span class="op" id="1728815">(</span><span class="ident" id="1728816">b</span>&nbsp;<span class="op" id="1728818">*</span><span class="ident" id="1728819">decimal</span><span class="op" id="1728826">)</span>&nbsp;<span class="ident" id="1728828">set</span><span class="op" id="1728831">(</span><span class="ident" id="1728832">s</span>&nbsp;<span class="builtintype" id="1728834">string</span><span class="op" id="1728840">)</span>&nbsp;<span class="op" id="1728842">(</span><span class="ident" id="1728843">ok</span>&nbsp;<span class="builtintype" id="1728846">bool</span><span class="op" id="1728850">)</span>&nbsp;<span class="op" id="1728852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728855">i</span>&nbsp;<span class="op" id="1728857">:=</span>&nbsp;<span class="num" id="1728860">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728863">b</span><span class="op" id="1728864">.</span><span class="ident" id="1728865">neg</span>&nbsp;<span class="op" id="1728869">=</span>&nbsp;<span class="builtintype" id="1728871">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728878">b</span><span class="op" id="1728879">.</span><span class="ident" id="1728880">trunc</span>&nbsp;<span class="op" id="1728886">=</span>&nbsp;<span class="builtintype" id="1728888">false</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1728896">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728914">if</span>&nbsp;<span class="ident" id="1728917">i</span>&nbsp;<span class="op" id="1728919">&gt;=</span>&nbsp;<span class="builtinfunc" id="1728922">len</span><span class="op" id="1728925">(</span><span class="ident" id="1728926">s</span><span class="op" id="1728927">)</span>&nbsp;<span class="op" id="1728929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728933">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1728941">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728944">switch</span>&nbsp;<span class="op" id="1728951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728954">case</span>&nbsp;<span class="ident" id="1728959">s</span><span class="op" id="1728960">[</span><span class="ident" id="1728961">i</span><span class="op" id="1728962">]</span>&nbsp;<span class="op" id="1728964">==</span>&nbsp;<span class="string" id="1728967">&#39;+&#39;</span><span class="op" id="1728970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728974">i</span><span class="op" id="1728975">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1728979">case</span>&nbsp;<span class="ident" id="1728984">s</span><span class="op" id="1728985">[</span><span class="ident" id="1728986">i</span><span class="op" id="1728987">]</span>&nbsp;<span class="op" id="1728989">==</span>&nbsp;<span class="string" id="1728992">&#39;-&#39;</span><span class="op" id="1728995">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1728999">b</span><span class="op" id="1729000">.</span><span class="ident" id="1729001">neg</span>&nbsp;<span class="op" id="1729005">=</span>&nbsp;<span class="builtintype" id="1729007">true</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729014">i</span><span class="op" id="1729015">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729023">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729034">sawdot</span>&nbsp;<span class="op" id="1729041">:=</span>&nbsp;<span class="builtintype" id="1729044">false</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729051">sawdigits</span>&nbsp;<span class="op" id="1729061">:=</span>&nbsp;<span class="builtintype" id="1729064">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729071">for</span>&nbsp;<span class="op" id="1729075">;</span>&nbsp;<span class="ident" id="1729077">i</span>&nbsp;<span class="op" id="1729079">&lt;</span>&nbsp;<span class="builtinfunc" id="1729081">len</span><span class="op" id="1729084">(</span><span class="ident" id="1729085">s</span><span class="op" id="1729086">)</span><span class="op" id="1729087">;</span>&nbsp;<span class="ident" id="1729089">i</span><span class="op" id="1729090">++</span>&nbsp;<span class="op" id="1729093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729097">switch</span>&nbsp;<span class="op" id="1729104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729108">case</span>&nbsp;<span class="ident" id="1729113">s</span><span class="op" id="1729114">[</span><span class="ident" id="1729115">i</span><span class="op" id="1729116">]</span>&nbsp;<span class="op" id="1729118">==</span>&nbsp;<span class="string" id="1729121">&#39;.&#39;</span><span class="op" id="1729124">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729129">if</span>&nbsp;<span class="ident" id="1729132">sawdot</span>&nbsp;<span class="op" id="1729139">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729145">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729160">sawdot</span>&nbsp;<span class="op" id="1729167">=</span>&nbsp;<span class="builtintype" id="1729169">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729177">b</span><span class="op" id="1729178">.</span><span class="ident" id="1729179">dp</span>&nbsp;<span class="op" id="1729182">=</span>&nbsp;<span class="ident" id="1729184">b</span><span class="op" id="1729185">.</span><span class="ident" id="1729186">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729192">continue</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729204">case</span>&nbsp;<span class="string" id="1729209">&#39;0&#39;</span>&nbsp;<span class="op" id="1729213">&lt;=</span>&nbsp;<span class="ident" id="1729216">s</span><span class="op" id="1729217">[</span><span class="ident" id="1729218">i</span><span class="op" id="1729219">]</span>&nbsp;<span class="op" id="1729221">&amp;&amp;</span>&nbsp;<span class="ident" id="1729224">s</span><span class="op" id="1729225">[</span><span class="ident" id="1729226">i</span><span class="op" id="1729227">]</span>&nbsp;<span class="op" id="1729229">&lt;=</span>&nbsp;<span class="string" id="1729232">&#39;9&#39;</span><span class="op" id="1729235">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729240">sawdigits</span>&nbsp;<span class="op" id="1729250">=</span>&nbsp;<span class="builtintype" id="1729252">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729260">if</span>&nbsp;<span class="ident" id="1729263">s</span><span class="op" id="1729264">[</span><span class="ident" id="1729265">i</span><span class="op" id="1729266">]</span>&nbsp;<span class="op" id="1729268">==</span>&nbsp;<span class="string" id="1729271">&#39;0&#39;</span>&nbsp;<span class="op" id="1729275">&amp;&amp;</span>&nbsp;<span class="ident" id="1729278">b</span><span class="op" id="1729279">.</span><span class="ident" id="1729280">nd</span>&nbsp;<span class="op" id="1729283">==</span>&nbsp;<span class="num" id="1729286">0</span>&nbsp;<span class="op" id="1729288">{</span>&nbsp;<span class="comment" id="1729290">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729318">b</span><span class="op" id="1729319">.</span><span class="ident" id="1729320">dp</span><span class="op" id="1729322">--</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729329">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729346">if</span>&nbsp;<span class="ident" id="1729349">b</span><span class="op" id="1729350">.</span><span class="ident" id="1729351">nd</span>&nbsp;<span class="op" id="1729354">&lt;</span>&nbsp;<span class="builtinfunc" id="1729356">len</span><span class="op" id="1729359">(</span><span class="ident" id="1729360">b</span><span class="op" id="1729361">.</span><span class="ident" id="1729362">d</span><span class="op" id="1729363">)</span>&nbsp;<span class="op" id="1729365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729371">b</span><span class="op" id="1729372">.</span><span class="ident" id="1729373">d</span><span class="op" id="1729374">[</span><span class="ident" id="1729375">b</span><span class="op" id="1729376">.</span><span class="ident" id="1729377">nd</span><span class="op" id="1729379">]</span>&nbsp;<span class="op" id="1729381">=</span>&nbsp;<span class="ident" id="1729383">s</span><span class="op" id="1729384">[</span><span class="ident" id="1729385">i</span><span class="op" id="1729386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729392">b</span><span class="op" id="1729393">.</span><span class="ident" id="1729394">nd</span><span class="op" id="1729396">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729402">}</span>&nbsp;<span class="keyword" id="1729404">else</span>&nbsp;<span class="keyword" id="1729409">if</span>&nbsp;<span class="ident" id="1729412">s</span><span class="op" id="1729413">[</span><span class="ident" id="1729414">i</span><span class="op" id="1729415">]</span>&nbsp;<span class="op" id="1729417">!=</span>&nbsp;<span class="string" id="1729420">&#39;0&#39;</span>&nbsp;<span class="op" id="1729424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729430">b</span><span class="op" id="1729431">.</span><span class="ident" id="1729432">trunc</span>&nbsp;<span class="op" id="1729438">=</span>&nbsp;<span class="builtintype" id="1729440">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729453">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729464">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729468">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729478">if</span>&nbsp;<span class="op" id="1729481">!</span><span class="ident" id="1729482">sawdigits</span>&nbsp;<span class="op" id="1729492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729496">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729504">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729507">if</span>&nbsp;<span class="op" id="1729510">!</span><span class="ident" id="1729511">sawdot</span>&nbsp;<span class="op" id="1729518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729522">b</span><span class="op" id="1729523">.</span><span class="ident" id="1729524">dp</span>&nbsp;<span class="op" id="1729527">=</span>&nbsp;<span class="ident" id="1729529">b</span><span class="op" id="1729530">.</span><span class="ident" id="1729531">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729539">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729582">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729629">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729675">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1729727">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729753">if</span>&nbsp;<span class="ident" id="1729756">i</span>&nbsp;<span class="op" id="1729758">&lt;</span>&nbsp;<span class="builtinfunc" id="1729760">len</span><span class="op" id="1729763">(</span><span class="ident" id="1729764">s</span><span class="op" id="1729765">)</span>&nbsp;<span class="op" id="1729767">&amp;&amp;</span>&nbsp;<span class="op" id="1729770">(</span><span class="ident" id="1729771">s</span><span class="op" id="1729772">[</span><span class="ident" id="1729773">i</span><span class="op" id="1729774">]</span>&nbsp;<span class="op" id="1729776">==</span>&nbsp;<span class="string" id="1729779">&#39;e&#39;</span>&nbsp;<span class="op" id="1729783">||</span>&nbsp;<span class="ident" id="1729786">s</span><span class="op" id="1729787">[</span><span class="ident" id="1729788">i</span><span class="op" id="1729789">]</span>&nbsp;<span class="op" id="1729791">==</span>&nbsp;<span class="string" id="1729794">&#39;E&#39;</span><span class="op" id="1729797">)</span>&nbsp;<span class="op" id="1729799">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729803">i</span><span class="op" id="1729804">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729809">if</span>&nbsp;<span class="ident" id="1729812">i</span>&nbsp;<span class="op" id="1729814">&gt;=</span>&nbsp;<span class="builtinfunc" id="1729817">len</span><span class="op" id="1729820">(</span><span class="ident" id="1729821">s</span><span class="op" id="1729822">)</span>&nbsp;<span class="op" id="1729824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729842">esign</span>&nbsp;<span class="op" id="1729848">:=</span>&nbsp;<span class="num" id="1729851">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729855">if</span>&nbsp;<span class="ident" id="1729858">s</span><span class="op" id="1729859">[</span><span class="ident" id="1729860">i</span><span class="op" id="1729861">]</span>&nbsp;<span class="op" id="1729863">==</span>&nbsp;<span class="string" id="1729866">&#39;+&#39;</span>&nbsp;<span class="op" id="1729870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729875">i</span><span class="op" id="1729876">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729881">}</span>&nbsp;<span class="keyword" id="1729883">else</span>&nbsp;<span class="keyword" id="1729888">if</span>&nbsp;<span class="ident" id="1729891">s</span><span class="op" id="1729892">[</span><span class="ident" id="1729893">i</span><span class="op" id="1729894">]</span>&nbsp;<span class="op" id="1729896">==</span>&nbsp;<span class="string" id="1729899">&#39;-&#39;</span>&nbsp;<span class="op" id="1729903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729908">i</span><span class="op" id="1729909">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729915">esign</span>&nbsp;<span class="op" id="1729921">=</span>&nbsp;<span class="op" id="1729923">-</span><span class="num" id="1729924">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729932">if</span>&nbsp;<span class="ident" id="1729935">i</span>&nbsp;<span class="op" id="1729937">&gt;=</span>&nbsp;<span class="builtinfunc" id="1729940">len</span><span class="op" id="1729943">(</span><span class="ident" id="1729944">s</span><span class="op" id="1729945">)</span>&nbsp;<span class="op" id="1729947">||</span>&nbsp;<span class="ident" id="1729950">s</span><span class="op" id="1729951">[</span><span class="ident" id="1729952">i</span><span class="op" id="1729953">]</span>&nbsp;<span class="op" id="1729955">&lt;</span>&nbsp;<span class="string" id="1729957">&#39;0&#39;</span>&nbsp;<span class="op" id="1729961">||</span>&nbsp;<span class="ident" id="1729964">s</span><span class="op" id="1729965">[</span><span class="ident" id="1729966">i</span><span class="op" id="1729967">]</span>&nbsp;<span class="op" id="1729969">&gt;</span>&nbsp;<span class="string" id="1729971">&#39;9&#39;</span>&nbsp;<span class="op" id="1729975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1729980">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1729989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1729993">e</span>&nbsp;<span class="op" id="1729995">:=</span>&nbsp;<span class="num" id="1729998">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730002">for</span>&nbsp;<span class="op" id="1730006">;</span>&nbsp;<span class="ident" id="1730008">i</span>&nbsp;<span class="op" id="1730010">&lt;</span>&nbsp;<span class="builtinfunc" id="1730012">len</span><span class="op" id="1730015">(</span><span class="ident" id="1730016">s</span><span class="op" id="1730017">)</span>&nbsp;<span class="op" id="1730019">&amp;&amp;</span>&nbsp;<span class="string" id="1730022">&#39;0&#39;</span>&nbsp;<span class="op" id="1730026">&lt;=</span>&nbsp;<span class="ident" id="1730029">s</span><span class="op" id="1730030">[</span><span class="ident" id="1730031">i</span><span class="op" id="1730032">]</span>&nbsp;<span class="op" id="1730034">&amp;&amp;</span>&nbsp;<span class="ident" id="1730037">s</span><span class="op" id="1730038">[</span><span class="ident" id="1730039">i</span><span class="op" id="1730040">]</span>&nbsp;<span class="op" id="1730042">&lt;=</span>&nbsp;<span class="string" id="1730045">&#39;9&#39;</span><span class="op" id="1730048">;</span>&nbsp;<span class="ident" id="1730050">i</span><span class="op" id="1730051">++</span>&nbsp;<span class="op" id="1730054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730059">if</span>&nbsp;<span class="ident" id="1730062">e</span>&nbsp;<span class="op" id="1730064">&lt;</span>&nbsp;<span class="num" id="1730066">10000</span>&nbsp;<span class="op" id="1730072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730078">e</span>&nbsp;<span class="op" id="1730080">=</span>&nbsp;<span class="ident" id="1730082">e</span><span class="op" id="1730083">*</span><span class="num" id="1730084">10</span>&nbsp;<span class="op" id="1730087">+</span>&nbsp;<span class="builtintype" id="1730089">int</span><span class="op" id="1730092">(</span><span class="ident" id="1730093">s</span><span class="op" id="1730094">[</span><span class="ident" id="1730095">i</span><span class="op" id="1730096">]</span><span class="op" id="1730097">)</span>&nbsp;<span class="op" id="1730099">-</span>&nbsp;<span class="string" id="1730101">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730112">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730116">b</span><span class="op" id="1730117">.</span><span class="ident" id="1730118">dp</span>&nbsp;<span class="op" id="1730121">+=</span>&nbsp;<span class="ident" id="1730124">e</span>&nbsp;<span class="op" id="1730126">*</span>&nbsp;<span class="ident" id="1730128">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730139">if</span>&nbsp;<span class="ident" id="1730142">i</span>&nbsp;<span class="op" id="1730144">!=</span>&nbsp;<span class="builtinfunc" id="1730147">len</span><span class="op" id="1730150">(</span><span class="ident" id="1730151">s</span><span class="op" id="1730152">)</span>&nbsp;<span class="op" id="1730154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730158">return</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730170">ok</span>&nbsp;<span class="op" id="1730173">=</span>&nbsp;<span class="builtintype" id="1730175">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730181">return</span><br>
<span class="lineno"></span><span class="op" id="1730188">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="1730191">//&nbsp;readFloat&nbsp;reads&nbsp;a&nbsp;decimal&nbsp;mantissa&nbsp;and&nbsp;exponent&nbsp;from&nbsp;a&nbsp;float</span><br>
<span class="lineno"></span><span class="comment" id="1730255">//&nbsp;string&nbsp;representation.&nbsp;It&nbsp;sets&nbsp;ok&nbsp;to&nbsp;false&nbsp;if&nbsp;the&nbsp;number&nbsp;could</span><br>
<span class="lineno"></span><span class="comment" id="1730321">//&nbsp;not&nbsp;fit&nbsp;return&nbsp;types&nbsp;or&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="1730360">func</span>&nbsp;<span class="ident" id="1730365">readFloat</span><span class="op" id="1730374">(</span><span class="ident" id="1730375">s</span>&nbsp;<span class="builtintype" id="1730377">string</span><span class="op" id="1730383">)</span>&nbsp;<span class="op" id="1730385">(</span><span class="ident" id="1730386">mantissa</span>&nbsp;<span class="ident" id="1730395">uint64</span><span class="op" id="1730401">,</span>&nbsp;<span class="ident" id="1730403">exp</span>&nbsp;<span class="builtintype" id="1730407">int</span><span class="op" id="1730410">,</span>&nbsp;<span class="ident" id="1730412">neg</span><span class="op" id="1730415">,</span>&nbsp;<span class="ident" id="1730417">trunc</span><span class="op" id="1730422">,</span>&nbsp;<span class="ident" id="1730424">ok</span>&nbsp;<span class="builtintype" id="1730427">bool</span><span class="op" id="1730431">)</span>&nbsp;<span class="op" id="1730433">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730436">const</span>&nbsp;<span class="ident" id="1730442">uint64digits</span>&nbsp;<span class="op" id="1730455">=</span>&nbsp;<span class="num" id="1730457">19</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730461">i</span>&nbsp;<span class="op" id="1730463">:=</span>&nbsp;<span class="num" id="1730466">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1730470">//&nbsp;optional&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730488">if</span>&nbsp;<span class="ident" id="1730491">i</span>&nbsp;<span class="op" id="1730493">&gt;=</span>&nbsp;<span class="builtinfunc" id="1730496">len</span><span class="op" id="1730499">(</span><span class="ident" id="1730500">s</span><span class="op" id="1730501">)</span>&nbsp;<span class="op" id="1730503">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730507">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730518">switch</span>&nbsp;<span class="op" id="1730525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730528">case</span>&nbsp;<span class="ident" id="1730533">s</span><span class="op" id="1730534">[</span><span class="ident" id="1730535">i</span><span class="op" id="1730536">]</span>&nbsp;<span class="op" id="1730538">==</span>&nbsp;<span class="string" id="1730541">&#39;+&#39;</span><span class="op" id="1730544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730548">i</span><span class="op" id="1730549">++</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730553">case</span>&nbsp;<span class="ident" id="1730558">s</span><span class="op" id="1730559">[</span><span class="ident" id="1730560">i</span><span class="op" id="1730561">]</span>&nbsp;<span class="op" id="1730563">==</span>&nbsp;<span class="string" id="1730566">&#39;-&#39;</span><span class="op" id="1730569">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730573">neg</span>&nbsp;<span class="op" id="1730577">=</span>&nbsp;<span class="builtintype" id="1730579">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730586">i</span><span class="op" id="1730587">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1730595">//&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730606">sawdot</span>&nbsp;<span class="op" id="1730613">:=</span>&nbsp;<span class="builtintype" id="1730616">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730623">sawdigits</span>&nbsp;<span class="op" id="1730633">:=</span>&nbsp;<span class="builtintype" id="1730636">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730643">nd</span>&nbsp;<span class="op" id="1730646">:=</span>&nbsp;<span class="num" id="1730649">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730652">ndMant</span>&nbsp;<span class="op" id="1730659">:=</span>&nbsp;<span class="num" id="1730662">0</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730665">dp</span>&nbsp;<span class="op" id="1730668">:=</span>&nbsp;<span class="num" id="1730671">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730674">for</span>&nbsp;<span class="op" id="1730678">;</span>&nbsp;<span class="ident" id="1730680">i</span>&nbsp;<span class="op" id="1730682">&lt;</span>&nbsp;<span class="builtinfunc" id="1730684">len</span><span class="op" id="1730687">(</span><span class="ident" id="1730688">s</span><span class="op" id="1730689">)</span><span class="op" id="1730690">;</span>&nbsp;<span class="ident" id="1730692">i</span><span class="op" id="1730693">++</span>&nbsp;<span class="op" id="1730696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730700">switch</span>&nbsp;<span class="ident" id="1730707">c</span>&nbsp;<span class="op" id="1730709">:=</span>&nbsp;<span class="ident" id="1730712">s</span><span class="op" id="1730713">[</span><span class="ident" id="1730714">i</span><span class="op" id="1730715">]</span><span class="op" id="1730716">;</span>&nbsp;<span class="builtintype" id="1730718">true</span>&nbsp;<span class="op" id="1730723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730727">case</span>&nbsp;<span class="ident" id="1730732">c</span>&nbsp;<span class="op" id="1730734">==</span>&nbsp;<span class="string" id="1730737">&#39;.&#39;</span><span class="op" id="1730740">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730745">if</span>&nbsp;<span class="ident" id="1730748">sawdot</span>&nbsp;<span class="op" id="1730755">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730761">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730776">sawdot</span>&nbsp;<span class="op" id="1730783">=</span>&nbsp;<span class="builtintype" id="1730785">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730793">dp</span>&nbsp;<span class="op" id="1730796">=</span>&nbsp;<span class="ident" id="1730798">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730804">continue</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730816">case</span>&nbsp;<span class="string" id="1730821">&#39;0&#39;</span>&nbsp;<span class="op" id="1730825">&lt;=</span>&nbsp;<span class="ident" id="1730828">c</span>&nbsp;<span class="op" id="1730830">&amp;&amp;</span>&nbsp;<span class="ident" id="1730833">c</span>&nbsp;<span class="op" id="1730835">&lt;=</span>&nbsp;<span class="string" id="1730838">&#39;9&#39;</span><span class="op" id="1730841">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730846">sawdigits</span>&nbsp;<span class="op" id="1730856">=</span>&nbsp;<span class="builtintype" id="1730858">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730866">if</span>&nbsp;<span class="ident" id="1730869">c</span>&nbsp;<span class="op" id="1730871">==</span>&nbsp;<span class="string" id="1730874">&#39;0&#39;</span>&nbsp;<span class="op" id="1730878">&amp;&amp;</span>&nbsp;<span class="ident" id="1730881">nd</span>&nbsp;<span class="op" id="1730884">==</span>&nbsp;<span class="num" id="1730887">0</span>&nbsp;<span class="op" id="1730889">{</span>&nbsp;<span class="comment" id="1730891">//&nbsp;ignore&nbsp;leading&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730919">dp</span><span class="op" id="1730921">--</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730928">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1730940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730945">nd</span><span class="op" id="1730947">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1730953">if</span>&nbsp;<span class="ident" id="1730956">ndMant</span>&nbsp;<span class="op" id="1730963">&lt;</span>&nbsp;<span class="ident" id="1730965">uint64digits</span>&nbsp;<span class="op" id="1730978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1730984">mantissa</span>&nbsp;<span class="op" id="1730993">*=</span>&nbsp;<span class="num" id="1730996">10</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731003">mantissa</span>&nbsp;<span class="op" id="1731012">+=</span>&nbsp;<span class="ident" id="1731015">uint64</span><span class="op" id="1731021">(</span><span class="ident" id="1731022">c</span>&nbsp;<span class="op" id="1731024">-</span>&nbsp;<span class="string" id="1731026">&#39;0&#39;</span><span class="op" id="1731029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731035">ndMant</span><span class="op" id="1731041">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731047">}</span>&nbsp;<span class="keyword" id="1731049">else</span>&nbsp;<span class="keyword" id="1731054">if</span>&nbsp;<span class="ident" id="1731057">s</span><span class="op" id="1731058">[</span><span class="ident" id="1731059">i</span><span class="op" id="1731060">]</span>&nbsp;<span class="op" id="1731062">!=</span>&nbsp;<span class="string" id="1731065">&#39;0&#39;</span>&nbsp;<span class="op" id="1731069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731075">trunc</span>&nbsp;<span class="op" id="1731081">=</span>&nbsp;<span class="builtintype" id="1731083">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731091">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731096">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731111">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731121">if</span>&nbsp;<span class="op" id="1731124">!</span><span class="ident" id="1731125">sawdigits</span>&nbsp;<span class="op" id="1731135">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731139">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731150">if</span>&nbsp;<span class="op" id="1731153">!</span><span class="ident" id="1731154">sawdot</span>&nbsp;<span class="op" id="1731161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731165">dp</span>&nbsp;<span class="op" id="1731168">=</span>&nbsp;<span class="ident" id="1731170">nd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731174">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731178">//&nbsp;optional&nbsp;exponent&nbsp;moves&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731221">//&nbsp;if&nbsp;we&nbsp;read&nbsp;a&nbsp;very&nbsp;large,&nbsp;very&nbsp;long&nbsp;number,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731268">//&nbsp;just&nbsp;be&nbsp;sure&nbsp;to&nbsp;move&nbsp;the&nbsp;decimal&nbsp;point&nbsp;by</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731314">//&nbsp;a&nbsp;lot&nbsp;(say,&nbsp;100000).&nbsp;&nbsp;it&nbsp;doesn&#39;t&nbsp;matter&nbsp;if&nbsp;it&#39;s</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1731366">//&nbsp;not&nbsp;the&nbsp;exact&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731392">if</span>&nbsp;<span class="ident" id="1731395">i</span>&nbsp;<span class="op" id="1731397">&lt;</span>&nbsp;<span class="builtinfunc" id="1731399">len</span><span class="op" id="1731402">(</span><span class="ident" id="1731403">s</span><span class="op" id="1731404">)</span>&nbsp;<span class="op" id="1731406">&amp;&amp;</span>&nbsp;<span class="op" id="1731409">(</span><span class="ident" id="1731410">s</span><span class="op" id="1731411">[</span><span class="ident" id="1731412">i</span><span class="op" id="1731413">]</span>&nbsp;<span class="op" id="1731415">==</span>&nbsp;<span class="string" id="1731418">&#39;e&#39;</span>&nbsp;<span class="op" id="1731422">||</span>&nbsp;<span class="ident" id="1731425">s</span><span class="op" id="1731426">[</span><span class="ident" id="1731427">i</span><span class="op" id="1731428">]</span>&nbsp;<span class="op" id="1731430">==</span>&nbsp;<span class="string" id="1731433">&#39;E&#39;</span><span class="op" id="1731436">)</span>&nbsp;<span class="op" id="1731438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731442">i</span><span class="op" id="1731443">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731448">if</span>&nbsp;<span class="ident" id="1731451">i</span>&nbsp;<span class="op" id="1731453">&gt;=</span>&nbsp;<span class="builtinfunc" id="1731456">len</span><span class="op" id="1731459">(</span><span class="ident" id="1731460">s</span><span class="op" id="1731461">)</span>&nbsp;<span class="op" id="1731463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731468">return</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731481">esign</span>&nbsp;<span class="op" id="1731487">:=</span>&nbsp;<span class="num" id="1731490">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731494">if</span>&nbsp;<span class="ident" id="1731497">s</span><span class="op" id="1731498">[</span><span class="ident" id="1731499">i</span><span class="op" id="1731500">]</span>&nbsp;<span class="op" id="1731502">==</span>&nbsp;<span class="string" id="1731505">&#39;+&#39;</span>&nbsp;<span class="op" id="1731509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731514">i</span><span class="op" id="1731515">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731520">}</span>&nbsp;<span class="keyword" id="1731522">else</span>&nbsp;<span class="keyword" id="1731527">if</span>&nbsp;<span class="ident" id="1731530">s</span><span class="op" id="1731531">[</span><span class="ident" id="1731532">i</span><span class="op" id="1731533">]</span>&nbsp;<span class="op" id="1731535">==</span>&nbsp;<span class="string" id="1731538">&#39;-&#39;</span>&nbsp;<span class="op" id="1731542">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731547">i</span><span class="op" id="1731548">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731554">esign</span>&nbsp;<span class="op" id="1731560">=</span>&nbsp;<span class="op" id="1731562">-</span><span class="num" id="1731563">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731571">if</span>&nbsp;<span class="ident" id="1731574">i</span>&nbsp;<span class="op" id="1731576">&gt;=</span>&nbsp;<span class="builtinfunc" id="1731579">len</span><span class="op" id="1731582">(</span><span class="ident" id="1731583">s</span><span class="op" id="1731584">)</span>&nbsp;<span class="op" id="1731586">||</span>&nbsp;<span class="ident" id="1731589">s</span><span class="op" id="1731590">[</span><span class="ident" id="1731591">i</span><span class="op" id="1731592">]</span>&nbsp;<span class="op" id="1731594">&lt;</span>&nbsp;<span class="string" id="1731596">&#39;0&#39;</span>&nbsp;<span class="op" id="1731600">||</span>&nbsp;<span class="ident" id="1731603">s</span><span class="op" id="1731604">[</span><span class="ident" id="1731605">i</span><span class="op" id="1731606">]</span>&nbsp;<span class="op" id="1731608">&gt;</span>&nbsp;<span class="string" id="1731610">&#39;9&#39;</span>&nbsp;<span class="op" id="1731614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731619">return</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731632">e</span>&nbsp;<span class="op" id="1731634">:=</span>&nbsp;<span class="num" id="1731637">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731641">for</span>&nbsp;<span class="op" id="1731645">;</span>&nbsp;<span class="ident" id="1731647">i</span>&nbsp;<span class="op" id="1731649">&lt;</span>&nbsp;<span class="builtinfunc" id="1731651">len</span><span class="op" id="1731654">(</span><span class="ident" id="1731655">s</span><span class="op" id="1731656">)</span>&nbsp;<span class="op" id="1731658">&amp;&amp;</span>&nbsp;<span class="string" id="1731661">&#39;0&#39;</span>&nbsp;<span class="op" id="1731665">&lt;=</span>&nbsp;<span class="ident" id="1731668">s</span><span class="op" id="1731669">[</span><span class="ident" id="1731670">i</span><span class="op" id="1731671">]</span>&nbsp;<span class="op" id="1731673">&amp;&amp;</span>&nbsp;<span class="ident" id="1731676">s</span><span class="op" id="1731677">[</span><span class="ident" id="1731678">i</span><span class="op" id="1731679">]</span>&nbsp;<span class="op" id="1731681">&lt;=</span>&nbsp;<span class="string" id="1731684">&#39;9&#39;</span><span class="op" id="1731687">;</span>&nbsp;<span class="ident" id="1731689">i</span><span class="op" id="1731690">++</span>&nbsp;<span class="op" id="1731693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731698">if</span>&nbsp;<span class="ident" id="1731701">e</span>&nbsp;<span class="op" id="1731703">&lt;</span>&nbsp;<span class="num" id="1731705">10000</span>&nbsp;<span class="op" id="1731711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731717">e</span>&nbsp;<span class="op" id="1731719">=</span>&nbsp;<span class="ident" id="1731721">e</span><span class="op" id="1731722">*</span><span class="num" id="1731723">10</span>&nbsp;<span class="op" id="1731726">+</span>&nbsp;<span class="builtintype" id="1731728">int</span><span class="op" id="1731731">(</span><span class="ident" id="1731732">s</span><span class="op" id="1731733">[</span><span class="ident" id="1731734">i</span><span class="op" id="1731735">]</span><span class="op" id="1731736">)</span>&nbsp;<span class="op" id="1731738">-</span>&nbsp;<span class="string" id="1731740">&#39;0&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731755">dp</span>&nbsp;<span class="op" id="1731758">+=</span>&nbsp;<span class="ident" id="1731761">e</span>&nbsp;<span class="op" id="1731763">*</span>&nbsp;<span class="ident" id="1731765">esign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731776">if</span>&nbsp;<span class="ident" id="1731779">i</span>&nbsp;<span class="op" id="1731781">!=</span>&nbsp;<span class="builtinfunc" id="1731784">len</span><span class="op" id="1731787">(</span><span class="ident" id="1731788">s</span><span class="op" id="1731789">)</span>&nbsp;<span class="op" id="1731791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731795">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1731803">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731807">exp</span>&nbsp;<span class="op" id="1731811">=</span>&nbsp;<span class="ident" id="1731813">dp</span>&nbsp;<span class="op" id="1731816">-</span>&nbsp;<span class="ident" id="1731818">ndMant</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1731826">ok</span>&nbsp;<span class="op" id="1731829">=</span>&nbsp;<span class="builtintype" id="1731831">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1731837">return</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="1731845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="1731848">//&nbsp;decimal&nbsp;power&nbsp;of&nbsp;ten&nbsp;to&nbsp;binary&nbsp;power&nbsp;of&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="1731896">var</span>&nbsp;<span class="ident" id="1731900">powtab</span>&nbsp;<span class="op" id="1731907">=</span>&nbsp;<span class="op" id="1731909">[</span><span class="op" id="1731910">]</span><span class="builtintype" id="1731911">int</span><span class="op" id="1731914">{</span><span class="num" id="1731915">1</span><span class="op" id="1731916">,</span>&nbsp;<span class="num" id="1731918">3</span><span class="op" id="1731919">,</span>&nbsp;<span class="num" id="1731921">6</span><span class="op" id="1731922">,</span>&nbsp;<span class="num" id="1731924">9</span><span class="op" id="1731925">,</span>&nbsp;<span class="num" id="1731927">13</span><span class="op" id="1731929">,</span>&nbsp;<span class="num" id="1731931">16</span><span class="op" id="1731933">,</span>&nbsp;<span class="num" id="1731935">19</span><span class="op" id="1731937">,</span>&nbsp;<span class="num" id="1731939">23</span><span class="op" id="1731941">,</span>&nbsp;<span class="num" id="1731943">26</span><span class="op" id="1731945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1731948">func</span>&nbsp;<span class="op" id="1731953">(</span><span class="ident" id="1731954">d</span>&nbsp;<span class="op" id="1731956">*</span><span class="ident" id="1731957">decimal</span><span class="op" id="1731964">)</span>&nbsp;<span class="ident" id="1731966">floatBits</span><span class="op" id="1731975">(</span><span class="ident" id="1731976">flt</span>&nbsp;<span class="op" id="1731980">*</span><span class="ident" id="1731981">floatInfo</span><span class="op" id="1731990">)</span>&nbsp;<span class="op" id="1731992">(</span><span class="ident" id="1731993">b</span>&nbsp;<span class="ident" id="1731995">uint64</span><span class="op" id="1732001">,</span>&nbsp;<span class="ident" id="1732003">overflow</span>&nbsp;<span class="builtintype" id="1732012">bool</span><span class="op" id="1732016">)</span>&nbsp;<span class="op" id="1732018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732021">var</span>&nbsp;<span class="ident" id="1732025">exp</span>&nbsp;<span class="builtintype" id="1732029">int</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732034">var</span>&nbsp;<span class="ident" id="1732038">mant</span>&nbsp;<span class="ident" id="1732043">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732052">//&nbsp;Zero&nbsp;is&nbsp;always&nbsp;a&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732087">if</span>&nbsp;<span class="ident" id="1732090">d</span><span class="op" id="1732091">.</span><span class="ident" id="1732092">nd</span>&nbsp;<span class="op" id="1732095">==</span>&nbsp;<span class="num" id="1732098">0</span>&nbsp;<span class="op" id="1732100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732104">mant</span>&nbsp;<span class="op" id="1732109">=</span>&nbsp;<span class="num" id="1732111">0</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732115">exp</span>&nbsp;<span class="op" id="1732119">=</span>&nbsp;<span class="ident" id="1732121">flt</span><span class="op" id="1732124">.</span><span class="ident" id="1732125">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732132">goto</span>&nbsp;<span class="ident" id="1732137">out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732146">//&nbsp;Obvious&nbsp;overflow/underflow.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732178">//&nbsp;These&nbsp;bounds&nbsp;are&nbsp;for&nbsp;64-bit&nbsp;floats.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732218">//&nbsp;Will&nbsp;have&nbsp;to&nbsp;change&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;support&nbsp;80-bit&nbsp;floats&nbsp;in&nbsp;the&nbsp;future.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732293">if</span>&nbsp;<span class="ident" id="1732296">d</span><span class="op" id="1732297">.</span><span class="ident" id="1732298">dp</span>&nbsp;<span class="op" id="1732301">&gt;</span>&nbsp;<span class="num" id="1732303">310</span>&nbsp;<span class="op" id="1732307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732311">goto</span>&nbsp;<span class="ident" id="1732316">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732326">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732329">if</span>&nbsp;<span class="ident" id="1732332">d</span><span class="op" id="1732333">.</span><span class="ident" id="1732334">dp</span>&nbsp;<span class="op" id="1732337">&lt;</span>&nbsp;<span class="op" id="1732339">-</span><span class="num" id="1732340">330</span>&nbsp;<span class="op" id="1732344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732348">//&nbsp;zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732358">mant</span>&nbsp;<span class="op" id="1732363">=</span>&nbsp;<span class="num" id="1732365">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732369">exp</span>&nbsp;<span class="op" id="1732373">=</span>&nbsp;<span class="ident" id="1732375">flt</span><span class="op" id="1732378">.</span><span class="ident" id="1732379">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732386">goto</span>&nbsp;<span class="ident" id="1732391">out</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732396">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732400">//&nbsp;Scale&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;until&nbsp;in&nbsp;range&nbsp;[0.5,&nbsp;1.0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732453">exp</span>&nbsp;<span class="op" id="1732457">=</span>&nbsp;<span class="num" id="1732459">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732462">for</span>&nbsp;<span class="ident" id="1732466">d</span><span class="op" id="1732467">.</span><span class="ident" id="1732468">dp</span>&nbsp;<span class="op" id="1732471">&gt;</span>&nbsp;<span class="num" id="1732473">0</span>&nbsp;<span class="op" id="1732475">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732479">var</span>&nbsp;<span class="ident" id="1732483">n</span>&nbsp;<span class="builtintype" id="1732485">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732491">if</span>&nbsp;<span class="ident" id="1732494">d</span><span class="op" id="1732495">.</span><span class="ident" id="1732496">dp</span>&nbsp;<span class="op" id="1732499">&gt;=</span>&nbsp;<span class="builtinfunc" id="1732502">len</span><span class="op" id="1732505">(</span><span class="ident" id="1732506">powtab</span><span class="op" id="1732512">)</span>&nbsp;<span class="op" id="1732514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732519">n</span>&nbsp;<span class="op" id="1732521">=</span>&nbsp;<span class="num" id="1732523">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732528">}</span>&nbsp;<span class="keyword" id="1732530">else</span>&nbsp;<span class="op" id="1732535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732540">n</span>&nbsp;<span class="op" id="1732542">=</span>&nbsp;<span class="ident" id="1732544">powtab</span><span class="op" id="1732550">[</span><span class="ident" id="1732551">d</span><span class="op" id="1732552">.</span><span class="ident" id="1732553">dp</span><span class="op" id="1732555">]</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732563">d</span><span class="op" id="1732564">.</span><span class="ident" id="1732565">Shift</span><span class="op" id="1732570">(</span><span class="op" id="1732571">-</span><span class="ident" id="1732572">n</span><span class="op" id="1732573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732577">exp</span>&nbsp;<span class="op" id="1732581">+=</span>&nbsp;<span class="ident" id="1732584">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732590">for</span>&nbsp;<span class="ident" id="1732594">d</span><span class="op" id="1732595">.</span><span class="ident" id="1732596">dp</span>&nbsp;<span class="op" id="1732599">&lt;</span>&nbsp;<span class="num" id="1732601">0</span>&nbsp;<span class="op" id="1732603">||</span>&nbsp;<span class="ident" id="1732606">d</span><span class="op" id="1732607">.</span><span class="ident" id="1732608">dp</span>&nbsp;<span class="op" id="1732611">==</span>&nbsp;<span class="num" id="1732614">0</span>&nbsp;<span class="op" id="1732616">&amp;&amp;</span>&nbsp;<span class="ident" id="1732619">d</span><span class="op" id="1732620">.</span><span class="ident" id="1732621">d</span><span class="op" id="1732622">[</span><span class="num" id="1732623">0</span><span class="op" id="1732624">]</span>&nbsp;<span class="op" id="1732626">&lt;</span>&nbsp;<span class="string" id="1732628">&#39;5&#39;</span>&nbsp;<span class="op" id="1732632">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732636">var</span>&nbsp;<span class="ident" id="1732640">n</span>&nbsp;<span class="builtintype" id="1732642">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732648">if</span>&nbsp;<span class="op" id="1732651">-</span><span class="ident" id="1732652">d</span><span class="op" id="1732653">.</span><span class="ident" id="1732654">dp</span>&nbsp;<span class="op" id="1732657">&gt;=</span>&nbsp;<span class="builtinfunc" id="1732660">len</span><span class="op" id="1732663">(</span><span class="ident" id="1732664">powtab</span><span class="op" id="1732670">)</span>&nbsp;<span class="op" id="1732672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732677">n</span>&nbsp;<span class="op" id="1732679">=</span>&nbsp;<span class="num" id="1732681">27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732686">}</span>&nbsp;<span class="keyword" id="1732688">else</span>&nbsp;<span class="op" id="1732693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732698">n</span>&nbsp;<span class="op" id="1732700">=</span>&nbsp;<span class="ident" id="1732702">powtab</span><span class="op" id="1732708">[</span><span class="op" id="1732709">-</span><span class="ident" id="1732710">d</span><span class="op" id="1732711">.</span><span class="ident" id="1732712">dp</span><span class="op" id="1732714">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732722">d</span><span class="op" id="1732723">.</span><span class="ident" id="1732724">Shift</span><span class="op" id="1732729">(</span><span class="ident" id="1732730">n</span><span class="op" id="1732731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732735">exp</span>&nbsp;<span class="op" id="1732739">-=</span>&nbsp;<span class="ident" id="1732742">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1732745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732749">//&nbsp;Our&nbsp;range&nbsp;is&nbsp;[0.5,1)&nbsp;but&nbsp;floating&nbsp;point&nbsp;range&nbsp;is&nbsp;[1,2).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732809">exp</span><span class="op" id="1732812">--</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732817">//&nbsp;Minimum&nbsp;representable&nbsp;exponent&nbsp;is&nbsp;flt.bias+1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732867">//&nbsp;If&nbsp;the&nbsp;exponent&nbsp;is&nbsp;smaller,&nbsp;move&nbsp;it&nbsp;up&nbsp;and</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1732914">//&nbsp;adjust&nbsp;d&nbsp;accordingly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1732940">if</span>&nbsp;<span class="ident" id="1732943">exp</span>&nbsp;<span class="op" id="1732947">&lt;</span>&nbsp;<span class="ident" id="1732949">flt</span><span class="op" id="1732952">.</span><span class="ident" id="1732953">bias</span><span class="op" id="1732957">+</span><span class="num" id="1732958">1</span>&nbsp;<span class="op" id="1732960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732964">n</span>&nbsp;<span class="op" id="1732966">:=</span>&nbsp;<span class="ident" id="1732969">flt</span><span class="op" id="1732972">.</span><span class="ident" id="1732973">bias</span>&nbsp;<span class="op" id="1732978">+</span>&nbsp;<span class="num" id="1732980">1</span>&nbsp;<span class="op" id="1732982">-</span>&nbsp;<span class="ident" id="1732984">exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1732990">d</span><span class="op" id="1732991">.</span><span class="ident" id="1732992">Shift</span><span class="op" id="1732997">(</span><span class="op" id="1732998">-</span><span class="ident" id="1732999">n</span><span class="op" id="1733000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733004">exp</span>&nbsp;<span class="op" id="1733008">+=</span>&nbsp;<span class="ident" id="1733011">n</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733018">if</span>&nbsp;<span class="ident" id="1733021">exp</span><span class="op" id="1733024">-</span><span class="ident" id="1733025">flt</span><span class="op" id="1733028">.</span><span class="ident" id="1733029">bias</span>&nbsp;<span class="op" id="1733034">&gt;=</span>&nbsp;<span class="num" id="1733037">1</span><span class="op" id="1733038">&lt;&lt;</span><span class="ident" id="1733040">flt</span><span class="op" id="1733043">.</span><span class="ident" id="1733044">expbits</span><span class="op" id="1733051">-</span><span class="num" id="1733052">1</span>&nbsp;<span class="op" id="1733054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733058">goto</span>&nbsp;<span class="ident" id="1733063">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733073">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1733077">//&nbsp;Extract&nbsp;1+flt.mantbits&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733110">d</span><span class="op" id="1733111">.</span><span class="ident" id="1733112">Shift</span><span class="op" id="1733117">(</span><span class="builtintype" id="1733118">int</span><span class="op" id="1733121">(</span><span class="num" id="1733122">1</span>&nbsp;<span class="op" id="1733124">+</span>&nbsp;<span class="ident" id="1733126">flt</span><span class="op" id="1733129">.</span><span class="ident" id="1733130">mantbits</span><span class="op" id="1733138">)</span><span class="op" id="1733139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733142">mant</span>&nbsp;<span class="op" id="1733147">=</span>&nbsp;<span class="ident" id="1733149">d</span><span class="op" id="1733150">.</span><span class="ident" id="1733151">RoundedInteger</span><span class="op" id="1733165">(</span><span class="op" id="1733166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1733170">//&nbsp;Rounding&nbsp;might&nbsp;have&nbsp;added&nbsp;a&nbsp;bit;&nbsp;shift&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733219">if</span>&nbsp;<span class="ident" id="1733222">mant</span>&nbsp;<span class="op" id="1733227">==</span>&nbsp;<span class="num" id="1733230">2</span><span class="op" id="1733231">&lt;&lt;</span><span class="ident" id="1733233">flt</span><span class="op" id="1733236">.</span><span class="ident" id="1733237">mantbits</span>&nbsp;<span class="op" id="1733246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733250">mant</span>&nbsp;<span class="op" id="1733255">&gt;&gt;=</span>&nbsp;<span class="num" id="1733259">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733263">exp</span><span class="op" id="1733266">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733271">if</span>&nbsp;<span class="ident" id="1733274">exp</span><span class="op" id="1733277">-</span><span class="ident" id="1733278">flt</span><span class="op" id="1733281">.</span><span class="ident" id="1733282">bias</span>&nbsp;<span class="op" id="1733287">&gt;=</span>&nbsp;<span class="num" id="1733290">1</span><span class="op" id="1733291">&lt;&lt;</span><span class="ident" id="1733293">flt</span><span class="op" id="1733296">.</span><span class="ident" id="1733297">expbits</span><span class="op" id="1733304">-</span><span class="num" id="1733305">1</span>&nbsp;<span class="op" id="1733307">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733312">goto</span>&nbsp;<span class="ident" id="1733317">overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1733335">//&nbsp;Denormalized?</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733353">if</span>&nbsp;<span class="ident" id="1733356">mant</span><span class="op" id="1733360">&amp;</span><span class="op" id="1733361">(</span><span class="num" id="1733362">1</span><span class="op" id="1733363">&lt;&lt;</span><span class="ident" id="1733365">flt</span><span class="op" id="1733368">.</span><span class="ident" id="1733369">mantbits</span><span class="op" id="1733377">)</span>&nbsp;<span class="op" id="1733379">==</span>&nbsp;<span class="num" id="1733382">0</span>&nbsp;<span class="op" id="1733384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733388">exp</span>&nbsp;<span class="op" id="1733392">=</span>&nbsp;<span class="ident" id="1733394">flt</span><span class="op" id="1733397">.</span><span class="ident" id="1733398">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733407">goto</span>&nbsp;<span class="ident" id="1733412">out</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="ident" id="1733417">overflow</span><span class="op" id="1733425">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1733428">//&nbsp;Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733438">mant</span>&nbsp;<span class="op" id="1733443">=</span>&nbsp;<span class="num" id="1733445">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733448">exp</span>&nbsp;<span class="op" id="1733452">=</span>&nbsp;<span class="num" id="1733454">1</span><span class="op" id="1733455">&lt;&lt;</span><span class="ident" id="1733457">flt</span><span class="op" id="1733460">.</span><span class="ident" id="1733461">expbits</span>&nbsp;<span class="op" id="1733469">-</span>&nbsp;<span class="num" id="1733471">1</span>&nbsp;<span class="op" id="1733473">+</span>&nbsp;<span class="ident" id="1733475">flt</span><span class="op" id="1733478">.</span><span class="ident" id="1733479">bias</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733485">overflow</span>&nbsp;<span class="op" id="1733494">=</span>&nbsp;<span class="builtintype" id="1733496">true</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="ident" id="1733502">out</span><span class="op" id="1733505">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1733508">//&nbsp;Assemble&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733527">bits</span>&nbsp;<span class="op" id="1733532">:=</span>&nbsp;<span class="ident" id="1733535">mant</span>&nbsp;<span class="op" id="1733540">&amp;</span>&nbsp;<span class="op" id="1733542">(</span><span class="ident" id="1733543">uint64</span><span class="op" id="1733549">(</span><span class="num" id="1733550">1</span><span class="op" id="1733551">)</span><span class="op" id="1733552">&lt;&lt;</span><span class="ident" id="1733554">flt</span><span class="op" id="1733557">.</span><span class="ident" id="1733558">mantbits</span>&nbsp;<span class="op" id="1733567">-</span>&nbsp;<span class="num" id="1733569">1</span><span class="op" id="1733570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733573">bits</span>&nbsp;<span class="op" id="1733578">|=</span>&nbsp;<span class="ident" id="1733581">uint64</span><span class="op" id="1733587">(</span><span class="op" id="1733588">(</span><span class="ident" id="1733589">exp</span><span class="op" id="1733592">-</span><span class="ident" id="1733593">flt</span><span class="op" id="1733596">.</span><span class="ident" id="1733597">bias</span><span class="op" id="1733601">)</span><span class="op" id="1733602">&amp;</span><span class="op" id="1733603">(</span><span class="num" id="1733604">1</span><span class="op" id="1733605">&lt;&lt;</span><span class="ident" id="1733607">flt</span><span class="op" id="1733610">.</span><span class="ident" id="1733611">expbits</span><span class="op" id="1733618">-</span><span class="num" id="1733619">1</span><span class="op" id="1733620">)</span><span class="op" id="1733621">)</span>&nbsp;<span class="op" id="1733623">&lt;&lt;</span>&nbsp;<span class="ident" id="1733626">flt</span><span class="op" id="1733629">.</span><span class="ident" id="1733630">mantbits</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733640">if</span>&nbsp;<span class="ident" id="1733643">d</span><span class="op" id="1733644">.</span><span class="ident" id="1733645">neg</span>&nbsp;<span class="op" id="1733649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1733653">bits</span>&nbsp;<span class="op" id="1733658">|=</span>&nbsp;<span class="num" id="1733661">1</span>&nbsp;<span class="op" id="1733663">&lt;&lt;</span>&nbsp;<span class="ident" id="1733666">flt</span><span class="op" id="1733669">.</span><span class="ident" id="1733670">mantbits</span>&nbsp;<span class="op" id="1733679">&lt;&lt;</span>&nbsp;<span class="ident" id="1733682">flt</span><span class="op" id="1733685">.</span><span class="ident" id="1733686">expbits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1733695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1733698">return</span>&nbsp;<span class="ident" id="1733705">bits</span><span class="op" id="1733709">,</span>&nbsp;<span class="ident" id="1733711">overflow</span><br>
<span class="lineno"></span><span class="op" id="1733720">}</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span><span class="comment" id="1733723">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;10.</span><br>
<span class="lineno"></span><span class="keyword" id="1733746">var</span>&nbsp;<span class="ident" id="1733750">float64pow10</span>&nbsp;<span class="op" id="1733763">=</span>&nbsp;<span class="op" id="1733765">[</span><span class="op" id="1733766">]</span><span class="builtintype" id="1733767">float64</span><span class="op" id="1733774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1733777">1e0</span><span class="op" id="1733780">,</span>&nbsp;<span class="num" id="1733782">1e1</span><span class="op" id="1733785">,</span>&nbsp;<span class="num" id="1733787">1e2</span><span class="op" id="1733790">,</span>&nbsp;<span class="num" id="1733792">1e3</span><span class="op" id="1733795">,</span>&nbsp;<span class="num" id="1733797">1e4</span><span class="op" id="1733800">,</span>&nbsp;<span class="num" id="1733802">1e5</span><span class="op" id="1733805">,</span>&nbsp;<span class="num" id="1733807">1e6</span><span class="op" id="1733810">,</span>&nbsp;<span class="num" id="1733812">1e7</span><span class="op" id="1733815">,</span>&nbsp;<span class="num" id="1733817">1e8</span><span class="op" id="1733820">,</span>&nbsp;<span class="num" id="1733822">1e9</span><span class="op" id="1733825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1733828">1e10</span><span class="op" id="1733832">,</span>&nbsp;<span class="num" id="1733834">1e11</span><span class="op" id="1733838">,</span>&nbsp;<span class="num" id="1733840">1e12</span><span class="op" id="1733844">,</span>&nbsp;<span class="num" id="1733846">1e13</span><span class="op" id="1733850">,</span>&nbsp;<span class="num" id="1733852">1e14</span><span class="op" id="1733856">,</span>&nbsp;<span class="num" id="1733858">1e15</span><span class="op" id="1733862">,</span>&nbsp;<span class="num" id="1733864">1e16</span><span class="op" id="1733868">,</span>&nbsp;<span class="num" id="1733870">1e17</span><span class="op" id="1733874">,</span>&nbsp;<span class="num" id="1733876">1e18</span><span class="op" id="1733880">,</span>&nbsp;<span class="num" id="1733882">1e19</span><span class="op" id="1733886">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1733889">1e20</span><span class="op" id="1733893">,</span>&nbsp;<span class="num" id="1733895">1e21</span><span class="op" id="1733899">,</span>&nbsp;<span class="num" id="1733901">1e22</span><span class="op" id="1733905">,</span><br>
<span class="lineno"></span><span class="op" id="1733907">}</span><br>
<span class="lineno"></span><span class="keyword" id="1733909">var</span>&nbsp;<span class="ident" id="1733913">float32pow10</span>&nbsp;<span class="op" id="1733926">=</span>&nbsp;<span class="op" id="1733928">[</span><span class="op" id="1733929">]</span><span class="builtintype" id="1733930">float32</span><span class="op" id="1733937">{</span><span class="num" id="1733938">1e0</span><span class="op" id="1733941">,</span>&nbsp;<span class="num" id="1733943">1e1</span><span class="op" id="1733946">,</span>&nbsp;<span class="num" id="1733948">1e2</span><span class="op" id="1733951">,</span>&nbsp;<span class="num" id="1733953">1e3</span><span class="op" id="1733956">,</span>&nbsp;<span class="num" id="1733958">1e4</span><span class="op" id="1733961">,</span>&nbsp;<span class="num" id="1733963">1e5</span><span class="op" id="1733966">,</span>&nbsp;<span class="num" id="1733968">1e6</span><span class="op" id="1733971">,</span>&nbsp;<span class="num" id="1733973">1e7</span><span class="op" id="1733976">,</span>&nbsp;<span class="num" id="1733978">1e8</span><span class="op" id="1733981">,</span>&nbsp;<span class="num" id="1733983">1e9</span><span class="op" id="1733986">,</span>&nbsp;<span class="num" id="1733988">1e10</span><span class="op" id="1733992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1733995">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;convert&nbsp;decimal&nbsp;representation&nbsp;to&nbsp;64-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno">365</span><span class="comment" id="1734071">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;expense&nbsp;of&nbsp;decimalToFloatBits.</span><br>
<span class="lineno"></span><span class="comment" id="1734158">//&nbsp;Three&nbsp;common&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1734181">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer</span><br>
<span class="lineno"></span><span class="comment" id="1734207">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;*&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno"></span><span class="comment" id="1734254">//&nbsp;&nbsp;&nbsp;&nbspvalue&nbsp;is&nbsp;exact&nbsp;integer&nbsp;/&nbsp;exact&nbsp;power&nbsp;of&nbsp;ten</span><br>
<span class="lineno">370</span><span class="comment" id="1734301">//&nbsp;These&nbsp;all&nbsp;produce&nbsp;potentially&nbsp;inexact&nbsp;but&nbsp;correctly&nbsp;rounded&nbsp;answers.</span><br>
<span class="lineno"></span><span class="keyword" id="1734373">func</span>&nbsp;<span class="ident" id="1734378">atof64exact</span><span class="op" id="1734389">(</span><span class="ident" id="1734390">mantissa</span>&nbsp;<span class="ident" id="1734399">uint64</span><span class="op" id="1734405">,</span>&nbsp;<span class="ident" id="1734407">exp</span>&nbsp;<span class="builtintype" id="1734411">int</span><span class="op" id="1734414">,</span>&nbsp;<span class="ident" id="1734416">neg</span>&nbsp;<span class="builtintype" id="1734420">bool</span><span class="op" id="1734424">)</span>&nbsp;<span class="op" id="1734426">(</span><span class="ident" id="1734427">f</span>&nbsp;<span class="builtintype" id="1734429">float64</span><span class="op" id="1734436">,</span>&nbsp;<span class="ident" id="1734438">ok</span>&nbsp;<span class="builtintype" id="1734441">bool</span><span class="op" id="1734445">)</span>&nbsp;<span class="op" id="1734447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734450">if</span>&nbsp;<span class="ident" id="1734453">mantissa</span><span class="op" id="1734461">&gt;&gt;</span><span class="ident" id="1734463">float64info</span><span class="op" id="1734474">.</span><span class="ident" id="1734475">mantbits</span>&nbsp;<span class="op" id="1734484">!=</span>&nbsp;<span class="num" id="1734487">0</span>&nbsp;<span class="op" id="1734489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1734501">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734504">f</span>&nbsp;<span class="op" id="1734506">=</span>&nbsp;<span class="builtintype" id="1734508">float64</span><span class="op" id="1734515">(</span><span class="ident" id="1734516">mantissa</span><span class="op" id="1734524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734527">if</span>&nbsp;<span class="ident" id="1734530">neg</span>&nbsp;<span class="op" id="1734534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734538">f</span>&nbsp;<span class="op" id="1734540">=</span>&nbsp;<span class="op" id="1734542">-</span><span class="ident" id="1734543">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1734546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734549">switch</span>&nbsp;<span class="op" id="1734556">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734559">case</span>&nbsp;<span class="ident" id="1734564">exp</span>&nbsp;<span class="op" id="1734568">==</span>&nbsp;<span class="num" id="1734571">0</span><span class="op" id="1734572">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734576">//&nbsp;an&nbsp;integer.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734593">return</span>&nbsp;<span class="ident" id="1734600">f</span><span class="op" id="1734601">,</span>&nbsp;<span class="builtintype" id="1734603">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734609">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^15.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734642">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^22.</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734680">case</span>&nbsp;<span class="ident" id="1734685">exp</span>&nbsp;<span class="op" id="1734689">&gt;</span>&nbsp;<span class="num" id="1734691">0</span>&nbsp;<span class="op" id="1734693">&amp;&amp;</span>&nbsp;<span class="ident" id="1734696">exp</span>&nbsp;<span class="op" id="1734700">&lt;=</span>&nbsp;<span class="num" id="1734703">15</span><span class="op" id="1734705">+</span><span class="num" id="1734706">22</span><span class="op" id="1734708">:</span>&nbsp;<span class="comment" id="1734710">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734726">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734779">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734828">if</span>&nbsp;<span class="ident" id="1734831">exp</span>&nbsp;<span class="op" id="1734835">&gt;</span>&nbsp;<span class="num" id="1734837">22</span>&nbsp;<span class="op" id="1734840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734845">f</span>&nbsp;<span class="op" id="1734847">*=</span>&nbsp;<span class="ident" id="1734850">float64pow10</span><span class="op" id="1734862">[</span><span class="ident" id="1734863">exp</span><span class="op" id="1734866">-</span><span class="num" id="1734867">22</span><span class="op" id="1734869">]</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1734874">exp</span>&nbsp;<span class="op" id="1734878">=</span>&nbsp;<span class="num" id="1734880">22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1734885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734889">if</span>&nbsp;<span class="ident" id="1734892">f</span>&nbsp;<span class="op" id="1734894">&gt;</span>&nbsp;<span class="num" id="1734896">1e15</span>&nbsp;<span class="op" id="1734901">||</span>&nbsp;<span class="ident" id="1734904">f</span>&nbsp;<span class="op" id="1734906">&lt;</span>&nbsp;<span class="op" id="1734908">-</span><span class="num" id="1734909">1e15</span>&nbsp;<span class="op" id="1734914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1734919">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734960">return</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1734969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1734973">return</span>&nbsp;<span class="ident" id="1734980">f</span>&nbsp;<span class="op" id="1734982">*</span>&nbsp;<span class="ident" id="1734984">float64pow10</span><span class="op" id="1734996">[</span><span class="ident" id="1734997">exp</span><span class="op" id="1735000">]</span><span class="op" id="1735001">,</span>&nbsp;<span class="builtintype" id="1735003">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735009">case</span>&nbsp;<span class="ident" id="1735014">exp</span>&nbsp;<span class="op" id="1735018">&lt;</span>&nbsp;<span class="num" id="1735020">0</span>&nbsp;<span class="op" id="1735022">&amp;&amp;</span>&nbsp;<span class="ident" id="1735025">exp</span>&nbsp;<span class="op" id="1735029">&gt;=</span>&nbsp;<span class="op" id="1735032">-</span><span class="num" id="1735033">22</span><span class="op" id="1735035">:</span>&nbsp;<span class="comment" id="1735037">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735053">return</span>&nbsp;<span class="ident" id="1735060">f</span>&nbsp;<span class="op" id="1735062">/</span>&nbsp;<span class="ident" id="1735064">float64pow10</span><span class="op" id="1735076">[</span><span class="op" id="1735077">-</span><span class="ident" id="1735078">exp</span><span class="op" id="1735081">]</span><span class="op" id="1735082">,</span>&nbsp;<span class="builtintype" id="1735084">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735090">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735093">return</span><br>
<span class="lineno"></span><span class="op" id="1735100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1735103">//&nbsp;If&nbsp;possible&nbsp;to&nbsp;compute&nbsp;mantissa*10^exp&nbsp;to&nbsp;32-bit&nbsp;float&nbsp;f&nbsp;exactly,</span><br>
<span class="lineno"></span><span class="comment" id="1735172">//&nbsp;entirely&nbsp;in&nbsp;floating-point&nbsp;math,&nbsp;do&nbsp;so,&nbsp;avoiding&nbsp;the&nbsp;machinery&nbsp;above.</span><br>
<span class="lineno">405</span><span class="keyword" id="1735245">func</span>&nbsp;<span class="ident" id="1735250">atof32exact</span><span class="op" id="1735261">(</span><span class="ident" id="1735262">mantissa</span>&nbsp;<span class="ident" id="1735271">uint64</span><span class="op" id="1735277">,</span>&nbsp;<span class="ident" id="1735279">exp</span>&nbsp;<span class="builtintype" id="1735283">int</span><span class="op" id="1735286">,</span>&nbsp;<span class="ident" id="1735288">neg</span>&nbsp;<span class="builtintype" id="1735292">bool</span><span class="op" id="1735296">)</span>&nbsp;<span class="op" id="1735298">(</span><span class="ident" id="1735299">f</span>&nbsp;<span class="builtintype" id="1735301">float32</span><span class="op" id="1735308">,</span>&nbsp;<span class="ident" id="1735310">ok</span>&nbsp;<span class="builtintype" id="1735313">bool</span><span class="op" id="1735317">)</span>&nbsp;<span class="op" id="1735319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735322">if</span>&nbsp;<span class="ident" id="1735325">mantissa</span><span class="op" id="1735333">&gt;&gt;</span><span class="ident" id="1735335">float32info</span><span class="op" id="1735346">.</span><span class="ident" id="1735347">mantbits</span>&nbsp;<span class="op" id="1735356">!=</span>&nbsp;<span class="num" id="1735359">0</span>&nbsp;<span class="op" id="1735361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735365">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735376">f</span>&nbsp;<span class="op" id="1735378">=</span>&nbsp;<span class="builtintype" id="1735380">float32</span><span class="op" id="1735387">(</span><span class="ident" id="1735388">mantissa</span><span class="op" id="1735396">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735399">if</span>&nbsp;<span class="ident" id="1735402">neg</span>&nbsp;<span class="op" id="1735406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735410">f</span>&nbsp;<span class="op" id="1735412">=</span>&nbsp;<span class="op" id="1735414">-</span><span class="ident" id="1735415">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735421">switch</span>&nbsp;<span class="op" id="1735428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735431">case</span>&nbsp;<span class="ident" id="1735436">exp</span>&nbsp;<span class="op" id="1735440">==</span>&nbsp;<span class="num" id="1735443">0</span><span class="op" id="1735444">:</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735448">return</span>&nbsp;<span class="ident" id="1735455">f</span><span class="op" id="1735456">,</span>&nbsp;<span class="builtintype" id="1735458">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735464">//&nbsp;Exact&nbsp;integers&nbsp;are&nbsp;&lt;=&nbsp;10^7.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735496">//&nbsp;Exact&nbsp;powers&nbsp;of&nbsp;ten&nbsp;are&nbsp;&lt;=&nbsp;10^10.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735534">case</span>&nbsp;<span class="ident" id="1735539">exp</span>&nbsp;<span class="op" id="1735543">&gt;</span>&nbsp;<span class="num" id="1735545">0</span>&nbsp;<span class="op" id="1735547">&amp;&amp;</span>&nbsp;<span class="ident" id="1735550">exp</span>&nbsp;<span class="op" id="1735554">&lt;=</span>&nbsp;<span class="num" id="1735557">7</span><span class="op" id="1735558">+</span><span class="num" id="1735559">10</span><span class="op" id="1735561">:</span>&nbsp;<span class="comment" id="1735563">//&nbsp;int&nbsp;*&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735579">//&nbsp;If&nbsp;exponent&nbsp;is&nbsp;big&nbsp;but&nbsp;number&nbsp;of&nbsp;digits&nbsp;is&nbsp;not,</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735632">//&nbsp;can&nbsp;move&nbsp;a&nbsp;few&nbsp;zeros&nbsp;into&nbsp;the&nbsp;integer&nbsp;part.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735681">if</span>&nbsp;<span class="ident" id="1735684">exp</span>&nbsp;<span class="op" id="1735688">&gt;</span>&nbsp;<span class="num" id="1735690">10</span>&nbsp;<span class="op" id="1735693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735698">f</span>&nbsp;<span class="op" id="1735700">*=</span>&nbsp;<span class="ident" id="1735703">float32pow10</span><span class="op" id="1735715">[</span><span class="ident" id="1735716">exp</span><span class="op" id="1735719">-</span><span class="num" id="1735720">10</span><span class="op" id="1735722">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1735727">exp</span>&nbsp;<span class="op" id="1735731">=</span>&nbsp;<span class="num" id="1735733">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735738">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735742">if</span>&nbsp;<span class="ident" id="1735745">f</span>&nbsp;<span class="op" id="1735747">&gt;</span>&nbsp;<span class="num" id="1735749">1e7</span>&nbsp;<span class="op" id="1735753">||</span>&nbsp;<span class="ident" id="1735756">f</span>&nbsp;<span class="op" id="1735758">&lt;</span>&nbsp;<span class="op" id="1735760">-</span><span class="num" id="1735761">1e7</span>&nbsp;<span class="op" id="1735765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1735770">//&nbsp;the&nbsp;exponent&nbsp;was&nbsp;really&nbsp;too&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735811">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735824">return</span>&nbsp;<span class="ident" id="1735831">f</span>&nbsp;<span class="op" id="1735833">*</span>&nbsp;<span class="ident" id="1735835">float32pow10</span><span class="op" id="1735847">[</span><span class="ident" id="1735848">exp</span><span class="op" id="1735851">]</span><span class="op" id="1735852">,</span>&nbsp;<span class="builtintype" id="1735854">true</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735860">case</span>&nbsp;<span class="ident" id="1735865">exp</span>&nbsp;<span class="op" id="1735869">&lt;</span>&nbsp;<span class="num" id="1735871">0</span>&nbsp;<span class="op" id="1735873">&amp;&amp;</span>&nbsp;<span class="ident" id="1735876">exp</span>&nbsp;<span class="op" id="1735880">&gt;=</span>&nbsp;<span class="op" id="1735883">-</span><span class="num" id="1735884">10</span><span class="op" id="1735886">:</span>&nbsp;<span class="comment" id="1735888">//&nbsp;int&nbsp;/&nbsp;10^k</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735904">return</span>&nbsp;<span class="ident" id="1735911">f</span>&nbsp;<span class="op" id="1735913">/</span>&nbsp;<span class="ident" id="1735915">float32pow10</span><span class="op" id="1735927">[</span><span class="op" id="1735928">-</span><span class="ident" id="1735929">exp</span><span class="op" id="1735932">]</span><span class="op" id="1735933">,</span>&nbsp;<span class="builtintype" id="1735935">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1735941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1735944">return</span><br>
<span class="lineno"></span><span class="op" id="1735951">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="1735954">const</span>&nbsp;<span class="ident" id="1735960">fnParseFloat</span>&nbsp;<span class="op" id="1735973">=</span>&nbsp;<span class="string" id="1735975">&#34;ParseFloat&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1735989">func</span>&nbsp;<span class="ident" id="1735994">atof32</span><span class="op" id="1736000">(</span><span class="ident" id="1736001">s</span>&nbsp;<span class="builtintype" id="1736003">string</span><span class="op" id="1736009">)</span>&nbsp;<span class="op" id="1736011">(</span><span class="ident" id="1736012">f</span>&nbsp;<span class="builtintype" id="1736014">float32</span><span class="op" id="1736021">,</span>&nbsp;<span class="ident" id="1736023">err</span>&nbsp;<span class="builtintype" id="1736027">error</span><span class="op" id="1736032">)</span>&nbsp;<span class="op" id="1736034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736037">if</span>&nbsp;<span class="ident" id="1736040">val</span><span class="op" id="1736043">,</span>&nbsp;<span class="ident" id="1736045">ok</span>&nbsp;<span class="op" id="1736048">:=</span>&nbsp;<span class="ident" id="1736051">special</span><span class="op" id="1736058">(</span><span class="ident" id="1736059">s</span><span class="op" id="1736060">)</span><span class="op" id="1736061">;</span>&nbsp;<span class="ident" id="1736063">ok</span>&nbsp;<span class="op" id="1736066">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736070">return</span>&nbsp;<span class="builtintype" id="1736077">float32</span><span class="op" id="1736084">(</span><span class="ident" id="1736085">val</span><span class="op" id="1736088">)</span><span class="op" id="1736089">,</span>&nbsp;<span class="ident" id="1736091">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736100">if</span>&nbsp;<span class="ident" id="1736103">optimize</span>&nbsp;<span class="op" id="1736112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1736116">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736150">mantissa</span><span class="op" id="1736158">,</span>&nbsp;<span class="ident" id="1736160">exp</span><span class="op" id="1736163">,</span>&nbsp;<span class="ident" id="1736165">neg</span><span class="op" id="1736168">,</span>&nbsp;<span class="ident" id="1736170">trunc</span><span class="op" id="1736175">,</span>&nbsp;<span class="ident" id="1736177">ok</span>&nbsp;<span class="op" id="1736180">:=</span>&nbsp;<span class="ident" id="1736183">readFloat</span><span class="op" id="1736192">(</span><span class="ident" id="1736193">s</span><span class="op" id="1736194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736198">if</span>&nbsp;<span class="ident" id="1736201">ok</span>&nbsp;<span class="op" id="1736204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1736209">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736262">if</span>&nbsp;<span class="op" id="1736265">!</span><span class="ident" id="1736266">trunc</span>&nbsp;<span class="op" id="1736272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736278">if</span>&nbsp;<span class="ident" id="1736281">f</span><span class="op" id="1736282">,</span>&nbsp;<span class="ident" id="1736284">ok</span>&nbsp;<span class="op" id="1736287">:=</span>&nbsp;<span class="ident" id="1736290">atof32exact</span><span class="op" id="1736301">(</span><span class="ident" id="1736302">mantissa</span><span class="op" id="1736310">,</span>&nbsp;<span class="ident" id="1736312">exp</span><span class="op" id="1736315">,</span>&nbsp;<span class="ident" id="1736317">neg</span><span class="op" id="1736320">)</span><span class="op" id="1736321">;</span>&nbsp;<span class="ident" id="1736323">ok</span>&nbsp;<span class="op" id="1736326">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736333">return</span>&nbsp;<span class="ident" id="1736340">f</span><span class="op" id="1736341">,</span>&nbsp;<span class="ident" id="1736343">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1736361">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736390">ext</span>&nbsp;<span class="op" id="1736394">:=</span>&nbsp;<span class="builtinfunc" id="1736397">new</span><span class="op" id="1736400">(</span><span class="ident" id="1736401">extFloat</span><span class="op" id="1736409">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736414">if</span>&nbsp;<span class="ident" id="1736417">ok</span>&nbsp;<span class="op" id="1736420">:=</span>&nbsp;<span class="ident" id="1736423">ext</span><span class="op" id="1736426">.</span><span class="ident" id="1736427">AssignDecimal</span><span class="op" id="1736440">(</span><span class="ident" id="1736441">mantissa</span><span class="op" id="1736449">,</span>&nbsp;<span class="ident" id="1736451">exp</span><span class="op" id="1736454">,</span>&nbsp;<span class="ident" id="1736456">neg</span><span class="op" id="1736459">,</span>&nbsp;<span class="ident" id="1736461">trunc</span><span class="op" id="1736466">,</span>&nbsp;<span class="op" id="1736468">&amp;</span><span class="ident" id="1736469">float32info</span><span class="op" id="1736480">)</span><span class="op" id="1736481">;</span>&nbsp;<span class="ident" id="1736483">ok</span>&nbsp;<span class="op" id="1736486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736492">b</span><span class="op" id="1736493">,</span>&nbsp;<span class="ident" id="1736495">ovf</span>&nbsp;<span class="op" id="1736499">:=</span>&nbsp;<span class="ident" id="1736502">ext</span><span class="op" id="1736505">.</span><span class="ident" id="1736506">floatBits</span><span class="op" id="1736515">(</span><span class="op" id="1736516">&amp;</span><span class="ident" id="1736517">float32info</span><span class="op" id="1736528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736534">f</span>&nbsp;<span class="op" id="1736536">=</span>&nbsp;<span class="ident" id="1736538">math</span><span class="op" id="1736542">.</span><span class="ident" id="1736543">Float32frombits</span><span class="op" id="1736558">(</span><span class="builtintype" id="1736559">uint32</span><span class="op" id="1736565">(</span><span class="ident" id="1736566">b</span><span class="op" id="1736567">)</span><span class="op" id="1736568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736574">if</span>&nbsp;<span class="ident" id="1736577">ovf</span>&nbsp;<span class="op" id="1736581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736588">err</span>&nbsp;<span class="op" id="1736592">=</span>&nbsp;<span class="ident" id="1736594">rangeError</span><span class="op" id="1736604">(</span><span class="ident" id="1736605">fnParseFloat</span><span class="op" id="1736617">,</span>&nbsp;<span class="ident" id="1736619">s</span><span class="op" id="1736620">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736632">return</span>&nbsp;<span class="ident" id="1736639">f</span><span class="op" id="1736640">,</span>&nbsp;<span class="ident" id="1736642">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736656">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736659">var</span>&nbsp;<span class="ident" id="1736663">d</span>&nbsp;<span class="ident" id="1736665">decimal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736674">if</span>&nbsp;<span class="op" id="1736677">!</span><span class="ident" id="1736678">d</span><span class="op" id="1736679">.</span><span class="ident" id="1736680">set</span><span class="op" id="1736683">(</span><span class="ident" id="1736684">s</span><span class="op" id="1736685">)</span>&nbsp;<span class="op" id="1736687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736691">return</span>&nbsp;<span class="num" id="1736698">0</span><span class="op" id="1736699">,</span>&nbsp;<span class="ident" id="1736701">syntaxError</span><span class="op" id="1736712">(</span><span class="ident" id="1736713">fnParseFloat</span><span class="op" id="1736725">,</span>&nbsp;<span class="ident" id="1736727">s</span><span class="op" id="1736728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736734">b</span><span class="op" id="1736735">,</span>&nbsp;<span class="ident" id="1736737">ovf</span>&nbsp;<span class="op" id="1736741">:=</span>&nbsp;<span class="ident" id="1736744">d</span><span class="op" id="1736745">.</span><span class="ident" id="1736746">floatBits</span><span class="op" id="1736755">(</span><span class="op" id="1736756">&amp;</span><span class="ident" id="1736757">float32info</span><span class="op" id="1736768">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736771">f</span>&nbsp;<span class="op" id="1736773">=</span>&nbsp;<span class="ident" id="1736775">math</span><span class="op" id="1736779">.</span><span class="ident" id="1736780">Float32frombits</span><span class="op" id="1736795">(</span><span class="builtintype" id="1736796">uint32</span><span class="op" id="1736802">(</span><span class="ident" id="1736803">b</span><span class="op" id="1736804">)</span><span class="op" id="1736805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736808">if</span>&nbsp;<span class="ident" id="1736811">ovf</span>&nbsp;<span class="op" id="1736815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1736819">err</span>&nbsp;<span class="op" id="1736823">=</span>&nbsp;<span class="ident" id="1736825">rangeError</span><span class="op" id="1736835">(</span><span class="ident" id="1736836">fnParseFloat</span><span class="op" id="1736848">,</span>&nbsp;<span class="ident" id="1736850">s</span><span class="op" id="1736851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736857">return</span>&nbsp;<span class="ident" id="1736864">f</span><span class="op" id="1736865">,</span>&nbsp;<span class="ident" id="1736867">err</span><br>
<span class="lineno">475</span><span class="op" id="1736871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1736874">func</span>&nbsp;<span class="ident" id="1736879">atof64</span><span class="op" id="1736885">(</span><span class="ident" id="1736886">s</span>&nbsp;<span class="builtintype" id="1736888">string</span><span class="op" id="1736894">)</span>&nbsp;<span class="op" id="1736896">(</span><span class="ident" id="1736897">f</span>&nbsp;<span class="builtintype" id="1736899">float64</span><span class="op" id="1736906">,</span>&nbsp;<span class="ident" id="1736908">err</span>&nbsp;<span class="builtintype" id="1736912">error</span><span class="op" id="1736917">)</span>&nbsp;<span class="op" id="1736919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736922">if</span>&nbsp;<span class="ident" id="1736925">val</span><span class="op" id="1736928">,</span>&nbsp;<span class="ident" id="1736930">ok</span>&nbsp;<span class="op" id="1736933">:=</span>&nbsp;<span class="ident" id="1736936">special</span><span class="op" id="1736943">(</span><span class="ident" id="1736944">s</span><span class="op" id="1736945">)</span><span class="op" id="1736946">;</span>&nbsp;<span class="ident" id="1736948">ok</span>&nbsp;<span class="op" id="1736951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736955">return</span>&nbsp;<span class="ident" id="1736962">val</span><span class="op" id="1736965">,</span>&nbsp;<span class="ident" id="1736967">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1736972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1736976">if</span>&nbsp;<span class="ident" id="1736979">optimize</span>&nbsp;<span class="op" id="1736988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1736992">//&nbsp;Parse&nbsp;mantissa&nbsp;and&nbsp;exponent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737026">mantissa</span><span class="op" id="1737034">,</span>&nbsp;<span class="ident" id="1737036">exp</span><span class="op" id="1737039">,</span>&nbsp;<span class="ident" id="1737041">neg</span><span class="op" id="1737044">,</span>&nbsp;<span class="ident" id="1737046">trunc</span><span class="op" id="1737051">,</span>&nbsp;<span class="ident" id="1737053">ok</span>&nbsp;<span class="op" id="1737056">:=</span>&nbsp;<span class="ident" id="1737059">readFloat</span><span class="op" id="1737068">(</span><span class="ident" id="1737069">s</span><span class="op" id="1737070">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737074">if</span>&nbsp;<span class="ident" id="1737077">ok</span>&nbsp;<span class="op" id="1737080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1737085">//&nbsp;Try&nbsp;pure&nbsp;floating-point&nbsp;arithmetic&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737138">if</span>&nbsp;<span class="op" id="1737141">!</span><span class="ident" id="1737142">trunc</span>&nbsp;<span class="op" id="1737148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737154">if</span>&nbsp;<span class="ident" id="1737157">f</span><span class="op" id="1737158">,</span>&nbsp;<span class="ident" id="1737160">ok</span>&nbsp;<span class="op" id="1737163">:=</span>&nbsp;<span class="ident" id="1737166">atof64exact</span><span class="op" id="1737177">(</span><span class="ident" id="1737178">mantissa</span><span class="op" id="1737186">,</span>&nbsp;<span class="ident" id="1737188">exp</span><span class="op" id="1737191">,</span>&nbsp;<span class="ident" id="1737193">neg</span><span class="op" id="1737196">)</span><span class="op" id="1737197">;</span>&nbsp;<span class="ident" id="1737199">ok</span>&nbsp;<span class="op" id="1737202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737209">return</span>&nbsp;<span class="ident" id="1737216">f</span><span class="op" id="1737217">,</span>&nbsp;<span class="ident" id="1737219">nil</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737227">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1737237">//&nbsp;Try&nbsp;another&nbsp;fast&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737266">ext</span>&nbsp;<span class="op" id="1737270">:=</span>&nbsp;<span class="builtinfunc" id="1737273">new</span><span class="op" id="1737276">(</span><span class="ident" id="1737277">extFloat</span><span class="op" id="1737285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737290">if</span>&nbsp;<span class="ident" id="1737293">ok</span>&nbsp;<span class="op" id="1737296">:=</span>&nbsp;<span class="ident" id="1737299">ext</span><span class="op" id="1737302">.</span><span class="ident" id="1737303">AssignDecimal</span><span class="op" id="1737316">(</span><span class="ident" id="1737317">mantissa</span><span class="op" id="1737325">,</span>&nbsp;<span class="ident" id="1737327">exp</span><span class="op" id="1737330">,</span>&nbsp;<span class="ident" id="1737332">neg</span><span class="op" id="1737335">,</span>&nbsp;<span class="ident" id="1737337">trunc</span><span class="op" id="1737342">,</span>&nbsp;<span class="op" id="1737344">&amp;</span><span class="ident" id="1737345">float64info</span><span class="op" id="1737356">)</span><span class="op" id="1737357">;</span>&nbsp;<span class="ident" id="1737359">ok</span>&nbsp;<span class="op" id="1737362">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737368">b</span><span class="op" id="1737369">,</span>&nbsp;<span class="ident" id="1737371">ovf</span>&nbsp;<span class="op" id="1737375">:=</span>&nbsp;<span class="ident" id="1737378">ext</span><span class="op" id="1737381">.</span><span class="ident" id="1737382">floatBits</span><span class="op" id="1737391">(</span><span class="op" id="1737392">&amp;</span><span class="ident" id="1737393">float64info</span><span class="op" id="1737404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737410">f</span>&nbsp;<span class="op" id="1737412">=</span>&nbsp;<span class="ident" id="1737414">math</span><span class="op" id="1737418">.</span><span class="ident" id="1737419">Float64frombits</span><span class="op" id="1737434">(</span><span class="ident" id="1737435">b</span><span class="op" id="1737436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737442">if</span>&nbsp;<span class="ident" id="1737445">ovf</span>&nbsp;<span class="op" id="1737449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737456">err</span>&nbsp;<span class="op" id="1737460">=</span>&nbsp;<span class="ident" id="1737462">rangeError</span><span class="op" id="1737472">(</span><span class="ident" id="1737473">fnParseFloat</span><span class="op" id="1737485">,</span>&nbsp;<span class="ident" id="1737487">s</span><span class="op" id="1737488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737494">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737500">return</span>&nbsp;<span class="ident" id="1737507">f</span><span class="op" id="1737508">,</span>&nbsp;<span class="ident" id="1737510">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737527">var</span>&nbsp;<span class="ident" id="1737531">d</span>&nbsp;<span class="ident" id="1737533">decimal</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737542">if</span>&nbsp;<span class="op" id="1737545">!</span><span class="ident" id="1737546">d</span><span class="op" id="1737547">.</span><span class="ident" id="1737548">set</span><span class="op" id="1737551">(</span><span class="ident" id="1737552">s</span><span class="op" id="1737553">)</span>&nbsp;<span class="op" id="1737555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737559">return</span>&nbsp;<span class="num" id="1737566">0</span><span class="op" id="1737567">,</span>&nbsp;<span class="ident" id="1737569">syntaxError</span><span class="op" id="1737580">(</span><span class="ident" id="1737581">fnParseFloat</span><span class="op" id="1737593">,</span>&nbsp;<span class="ident" id="1737595">s</span><span class="op" id="1737596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737602">b</span><span class="op" id="1737603">,</span>&nbsp;<span class="ident" id="1737605">ovf</span>&nbsp;<span class="op" id="1737609">:=</span>&nbsp;<span class="ident" id="1737612">d</span><span class="op" id="1737613">.</span><span class="ident" id="1737614">floatBits</span><span class="op" id="1737623">(</span><span class="op" id="1737624">&amp;</span><span class="ident" id="1737625">float64info</span><span class="op" id="1737636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737639">f</span>&nbsp;<span class="op" id="1737641">=</span>&nbsp;<span class="ident" id="1737643">math</span><span class="op" id="1737647">.</span><span class="ident" id="1737648">Float64frombits</span><span class="op" id="1737663">(</span><span class="ident" id="1737664">b</span><span class="op" id="1737665">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737668">if</span>&nbsp;<span class="ident" id="1737671">ovf</span>&nbsp;<span class="op" id="1737675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1737679">err</span>&nbsp;<span class="op" id="1737683">=</span>&nbsp;<span class="ident" id="1737685">rangeError</span><span class="op" id="1737695">(</span><span class="ident" id="1737696">fnParseFloat</span><span class="op" id="1737708">,</span>&nbsp;<span class="ident" id="1737710">s</span><span class="op" id="1737711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1737714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1737717">return</span>&nbsp;<span class="ident" id="1737724">f</span><span class="op" id="1737725">,</span>&nbsp;<span class="ident" id="1737727">err</span><br>
<span class="lineno"></span><span class="op" id="1737731">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span><span class="comment" id="1737734">//&nbsp;ParseFloat&nbsp;converts&nbsp;the&nbsp;string&nbsp;s&nbsp;to&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="1737797">//&nbsp;with&nbsp;the&nbsp;precision&nbsp;specified&nbsp;by&nbsp;bitSize:&nbsp;32&nbsp;for&nbsp;float32,&nbsp;or&nbsp;64&nbsp;for&nbsp;float64.</span><br>
<span class="lineno"></span><span class="comment" id="1737876">//&nbsp;When&nbsp;bitSize=32,&nbsp;the&nbsp;result&nbsp;still&nbsp;has&nbsp;type&nbsp;float64,&nbsp;but&nbsp;it&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="1737946">//&nbsp;convertible&nbsp;to&nbsp;float32&nbsp;without&nbsp;changing&nbsp;its&nbsp;value.</span><br>
<span class="lineno">520</span><span class="comment" id="1738000">//</span><br>
<span class="lineno"></span><span class="comment" id="1738003">//&nbsp;If&nbsp;s&nbsp;is&nbsp;well-formed&nbsp;and&nbsp;near&nbsp;a&nbsp;valid&nbsp;floating&nbsp;point&nbsp;number,</span><br>
<span class="lineno"></span><span class="comment" id="1738066">//&nbsp;ParseFloat&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;floating&nbsp;point&nbsp;number&nbsp;rounded</span><br>
<span class="lineno"></span><span class="comment" id="1738130">//&nbsp;using&nbsp;IEEE754&nbsp;unbiased&nbsp;rounding.</span><br>
<span class="lineno"></span><span class="comment" id="1738166">//</span><br>
<span class="lineno">525</span><span class="comment" id="1738169">//&nbsp;The&nbsp;errors&nbsp;that&nbsp;ParseFloat&nbsp;returns&nbsp;have&nbsp;concrete&nbsp;type&nbsp;*NumError</span><br>
<span class="lineno"></span><span class="comment" id="1738236">//&nbsp;and&nbsp;include&nbsp;err.Num&nbsp;=&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="1738264">//</span><br>
<span class="lineno"></span><span class="comment" id="1738267">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;syntactically&nbsp;well-formed,&nbsp;ParseFloat&nbsp;returns&nbsp;err.Err&nbsp;=&nbsp;ErrSyntax.</span><br>
<span class="lineno"></span><span class="comment" id="1738349">//</span><br>
<span class="lineno">530</span><span class="comment" id="1738352">//&nbsp;If&nbsp;s&nbsp;is&nbsp;syntactically&nbsp;well-formed&nbsp;but&nbsp;is&nbsp;more&nbsp;than&nbsp;1/2&nbsp;ULP</span><br>
<span class="lineno"></span><span class="comment" id="1738414">//&nbsp;away&nbsp;from&nbsp;the&nbsp;largest&nbsp;floating&nbsp;point&nbsp;number&nbsp;of&nbsp;the&nbsp;given&nbsp;size,</span><br>
<span class="lineno"></span><span class="comment" id="1738480">//&nbsp;ParseFloat&nbsp;returns&nbsp;f&nbsp;=&nbsp;Inf,&nbsp;err.Err&nbsp;=&nbsp;ErrRange.</span><br>
<span class="lineno"></span><span class="keyword" id="1738533">func</span>&nbsp;<span class="ident" id="1738538">ParseFloat</span><span class="op" id="1738548">(</span><span class="ident" id="1738549">s</span>&nbsp;<span class="builtintype" id="1738551">string</span><span class="op" id="1738557">,</span>&nbsp;<span class="ident" id="1738559">bitSize</span>&nbsp;<span class="builtintype" id="1738567">int</span><span class="op" id="1738570">)</span>&nbsp;<span class="op" id="1738572">(</span><span class="ident" id="1738573">f</span>&nbsp;<span class="builtintype" id="1738575">float64</span><span class="op" id="1738582">,</span>&nbsp;<span class="ident" id="1738584">err</span>&nbsp;<span class="builtintype" id="1738588">error</span><span class="op" id="1738593">)</span>&nbsp;<span class="op" id="1738595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738598">if</span>&nbsp;<span class="ident" id="1738601">bitSize</span>&nbsp;<span class="op" id="1738609">==</span>&nbsp;<span class="num" id="1738612">32</span>&nbsp;<span class="op" id="1738615">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738619">f1</span><span class="op" id="1738621">,</span>&nbsp;<span class="ident" id="1738623">err1</span>&nbsp;<span class="op" id="1738628">:=</span>&nbsp;<span class="ident" id="1738631">atof32</span><span class="op" id="1738637">(</span><span class="ident" id="1738638">s</span><span class="op" id="1738639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738643">return</span>&nbsp;<span class="builtintype" id="1738650">float64</span><span class="op" id="1738657">(</span><span class="ident" id="1738658">f1</span><span class="op" id="1738660">)</span><span class="op" id="1738661">,</span>&nbsp;<span class="ident" id="1738663">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1738669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1738672">f1</span><span class="op" id="1738674">,</span>&nbsp;<span class="ident" id="1738676">err1</span>&nbsp;<span class="op" id="1738681">:=</span>&nbsp;<span class="ident" id="1738684">atof64</span><span class="op" id="1738690">(</span><span class="ident" id="1738691">s</span><span class="op" id="1738692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1738695">return</span>&nbsp;<span class="ident" id="1738702">f1</span><span class="op" id="1738704">,</span>&nbsp;<span class="ident" id="1738706">err1</span><br>
<span class="lineno">540</span><span class="op" id="1738711">}</span>
</div>
</body>
</html>
