<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4142679">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4142734">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4142788">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4142839">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4142912">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4142946">//</span><br>
<span class="lineno"></span><span class="comment" id="4142949">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4143018">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4143070">package</span>&nbsp;<span class="ident" id="4143078">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4143084">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4143164">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4143240">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4143316">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4143395">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4143470">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4143542">//</span><br>
<span class="lineno"></span><span class="comment" id="4143545">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4143616">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4143645">import</span>&nbsp;<span class="op" id="4143652">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4143655">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4143662">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4143674">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4143685">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4143696">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4143703">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4143706">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4143782">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4143822">type</span>&nbsp;<span class="ident" id="4143827">StructuralError</span>&nbsp;<span class="keyword" id="4143843">struct</span>&nbsp;<span class="op" id="4143850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143853">Msg</span>&nbsp;<span class="builtintype" id="4143857">string</span><br>
<span class="lineno"></span><span class="op" id="4143864">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4143867">func</span>&nbsp;<span class="op" id="4143872">(</span><span class="ident" id="4143873">e</span>&nbsp;<span class="ident" id="4143875"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4143890">)</span>&nbsp;<span class="ident" id="4143892">Error</span><span class="op" id="4143897">(</span><span class="op" id="4143898">)</span>&nbsp;<span class="builtintype" id="4143900">string</span>&nbsp;<span class="op" id="4143907">{</span>&nbsp;<span class="keyword" id="4143909">return</span>&nbsp;<span class="string" id="4143916">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4143942">+</span>&nbsp;<span class="ident" id="4143944"><a href="/encoding/asn1/asn1.go.html#4143873">e</a></span><span class="op" id="4143945">.</span><span class="ident" id="4143946">Msg</span>&nbsp;<span class="op" id="4143950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4143953">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4144011">type</span>&nbsp;<span class="ident" id="4144016">SyntaxError</span>&nbsp;<span class="keyword" id="4144028">struct</span>&nbsp;<span class="op" id="4144035">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144038">Msg</span>&nbsp;<span class="builtintype" id="4144042">string</span><br>
<span class="lineno"></span><span class="op" id="4144049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4144052">func</span>&nbsp;<span class="op" id="4144057">(</span><span class="ident" id="4144058">e</span>&nbsp;<span class="ident" id="4144060"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4144071">)</span>&nbsp;<span class="ident" id="4144073">Error</span><span class="op" id="4144078">(</span><span class="op" id="4144079">)</span>&nbsp;<span class="builtintype" id="4144081">string</span>&nbsp;<span class="op" id="4144088">{</span>&nbsp;<span class="keyword" id="4144090">return</span>&nbsp;<span class="string" id="4144097">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4144120">+</span>&nbsp;<span class="ident" id="4144122"><a href="/encoding/asn1/asn1.go.html#4144058">e</a></span><span class="op" id="4144123">.</span><span class="ident" id="4144124">Msg</span>&nbsp;<span class="op" id="4144128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4144131">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144197">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4144209">func</span>&nbsp;<span class="ident" id="4144214">parseBool</span><span class="op" id="4144223">(</span><span class="ident" id="4144224">bytes</span>&nbsp;<span class="op" id="4144230">[</span><span class="op" id="4144231">]</span><span class="builtintype" id="4144232">byte</span><span class="op" id="4144236">)</span>&nbsp;<span class="op" id="4144238">(</span><span class="ident" id="4144239">ret</span>&nbsp;<span class="builtintype" id="4144243">bool</span><span class="op" id="4144247">,</span>&nbsp;<span class="ident" id="4144249">err</span>&nbsp;<span class="builtintype" id="4144253">error</span><span class="op" id="4144258">)</span>&nbsp;<span class="op" id="4144260">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144263">if</span>&nbsp;<span class="builtinfunc" id="4144266">len</span><span class="op" id="4144269">(</span><span class="ident" id="4144270"><a href="/encoding/asn1/asn1.go.html#4144224">bytes</a></span><span class="op" id="4144275">)</span>&nbsp;<span class="op" id="4144277">!=</span>&nbsp;<span class="num" id="4144280">1</span>&nbsp;<span class="op" id="4144282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144286"><a href="/encoding/asn1/asn1.go.html#4144249">err</a></span>&nbsp;<span class="op" id="4144290">=</span>&nbsp;<span class="ident" id="4144292"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4144303">{</span><span class="string" id="4144304">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4144321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144333">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144337">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144410">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144479">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144529">switch</span>&nbsp;<span class="ident" id="4144536"><a href="/encoding/asn1/asn1.go.html#4144224">bytes</a></span><span class="op" id="4144541">[</span><span class="num" id="4144542">0</span><span class="op" id="4144543">]</span>&nbsp;<span class="op" id="4144545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144548">case</span>&nbsp;<span class="num" id="4144553">0</span><span class="op" id="4144554">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144558"><a href="/encoding/asn1/asn1.go.html#4144239">ret</a></span>&nbsp;<span class="op" id="4144562">=</span>&nbsp;<span class="builtintype" id="4144564">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144571">case</span>&nbsp;<span class="num" id="4144576">0xff</span><span class="op" id="4144580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144584"><a href="/encoding/asn1/asn1.go.html#4144239">ret</a></span>&nbsp;<span class="op" id="4144588">=</span>&nbsp;<span class="builtintype" id="4144590">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144596">default</span><span class="op" id="4144603">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144607"><a href="/encoding/asn1/asn1.go.html#4144249">err</a></span>&nbsp;<span class="op" id="4144611">=</span>&nbsp;<span class="ident" id="4144613"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4144624">{</span><span class="string" id="4144625">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4144642">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144649">return</span><br>
<span class="lineno"></span><span class="op" id="4144656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4144659">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4144671">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4144744">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4144767">func</span>&nbsp;<span class="ident" id="4144772">parseInt64</span><span class="op" id="4144782">(</span><span class="ident" id="4144783">bytes</span>&nbsp;<span class="op" id="4144789">[</span><span class="op" id="4144790">]</span><span class="builtintype" id="4144791">byte</span><span class="op" id="4144795">)</span>&nbsp;<span class="op" id="4144797">(</span><span class="ident" id="4144798">ret</span>&nbsp;<span class="ident" id="4144802">int64</span><span class="op" id="4144807">,</span>&nbsp;<span class="ident" id="4144809">err</span>&nbsp;<span class="builtintype" id="4144813">error</span><span class="op" id="4144818">)</span>&nbsp;<span class="op" id="4144820">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144823">if</span>&nbsp;<span class="builtinfunc" id="4144826">len</span><span class="op" id="4144829">(</span><span class="ident" id="4144830"><a href="/encoding/asn1/asn1.go.html#4144783">bytes</a></span><span class="op" id="4144835">)</span>&nbsp;<span class="op" id="4144837">&gt;</span>&nbsp;<span class="num" id="4144839">8</span>&nbsp;<span class="op" id="4144841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144845">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144888"><a href="/encoding/asn1/asn1.go.html#4144809">err</a></span>&nbsp;<span class="op" id="4144892">=</span>&nbsp;<span class="ident" id="4144894"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4144909">{</span><span class="string" id="4144910">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4144929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144933">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144941">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144944">for</span>&nbsp;<span class="ident" id="4144948">bytesRead</span>&nbsp;<span class="op" id="4144958">:=</span>&nbsp;<span class="num" id="4144961">0</span><span class="op" id="4144962">;</span>&nbsp;<span class="ident" id="4144964"><a href="/encoding/asn1/asn1.go.html#4144948">bytesRead</a></span>&nbsp;<span class="op" id="4144974">&lt;</span>&nbsp;<span class="builtinfunc" id="4144976">len</span><span class="op" id="4144979">(</span><span class="ident" id="4144980"><a href="/encoding/asn1/asn1.go.html#4144783">bytes</a></span><span class="op" id="4144985">)</span><span class="op" id="4144986">;</span>&nbsp;<span class="ident" id="4144988"><a href="/encoding/asn1/asn1.go.html#4144948">bytesRead</a></span><span class="op" id="4144997">++</span>&nbsp;<span class="op" id="4145000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145004"><a href="/encoding/asn1/asn1.go.html#4144798">ret</a></span>&nbsp;<span class="op" id="4145008">&lt;&lt;=</span>&nbsp;<span class="num" id="4145012">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145016"><a href="/encoding/asn1/asn1.go.html#4144798">ret</a></span>&nbsp;<span class="op" id="4145020">|=</span>&nbsp;<span class="ident" id="4145023">int64</span><span class="op" id="4145028">(</span><span class="ident" id="4145029"><a href="/encoding/asn1/asn1.go.html#4144783">bytes</a></span><span class="op" id="4145034">[</span><span class="ident" id="4145035"><a href="/encoding/asn1/asn1.go.html#4144948">bytesRead</a></span><span class="op" id="4145044">]</span><span class="op" id="4145045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145052">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145110"><a href="/encoding/asn1/asn1.go.html#4144798">ret</a></span>&nbsp;<span class="op" id="4145114">&lt;&lt;=</span>&nbsp;<span class="num" id="4145118">64</span>&nbsp;<span class="op" id="4145121">-</span>&nbsp;<span class="builtintype" id="4145123">uint8</span><span class="op" id="4145128">(</span><span class="builtinfunc" id="4145129">len</span><span class="op" id="4145132">(</span><span class="ident" id="4145133"><a href="/encoding/asn1/asn1.go.html#4144783">bytes</a></span><span class="op" id="4145138">)</span><span class="op" id="4145139">)</span><span class="op" id="4145140">*</span><span class="num" id="4145141">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145144"><a href="/encoding/asn1/asn1.go.html#4144798">ret</a></span>&nbsp;<span class="op" id="4145148">&gt;&gt;=</span>&nbsp;<span class="num" id="4145152">64</span>&nbsp;<span class="op" id="4145155">-</span>&nbsp;<span class="builtintype" id="4145157">uint8</span><span class="op" id="4145162">(</span><span class="builtinfunc" id="4145163">len</span><span class="op" id="4145166">(</span><span class="ident" id="4145167"><a href="/encoding/asn1/asn1.go.html#4144783">bytes</a></span><span class="op" id="4145172">)</span><span class="op" id="4145173">)</span><span class="op" id="4145174">*</span><span class="num" id="4145175">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145178">return</span><br>
<span class="lineno"></span><span class="op" id="4145185">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4145188">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4145267">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4145282">func</span>&nbsp;<span class="ident" id="4145287">parseInt32</span><span class="op" id="4145297">(</span><span class="ident" id="4145298">bytes</span>&nbsp;<span class="op" id="4145304">[</span><span class="op" id="4145305">]</span><span class="builtintype" id="4145306">byte</span><span class="op" id="4145310">)</span>&nbsp;<span class="op" id="4145312">(</span><span class="builtintype" id="4145313">int32</span><span class="op" id="4145318">,</span>&nbsp;<span class="builtintype" id="4145320">error</span><span class="op" id="4145325">)</span>&nbsp;<span class="op" id="4145327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145330">ret64</span><span class="op" id="4145335">,</span>&nbsp;<span class="ident" id="4145337">err</span>&nbsp;<span class="op" id="4145341">:=</span>&nbsp;<span class="ident" id="4145344"><a href="/encoding/asn1/asn1.go.html#4144772">parseInt64</a></span><span class="op" id="4145354">(</span><span class="ident" id="4145355"><a href="/encoding/asn1/asn1.go.html#4145298">bytes</a></span><span class="op" id="4145360">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145363">if</span>&nbsp;<span class="ident" id="4145366"><a href="/encoding/asn1/asn1.go.html#4145337">err</a></span>&nbsp;<span class="op" id="4145370">!=</span>&nbsp;<span class="ident" id="4145373">nil</span>&nbsp;<span class="op" id="4145377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145381">return</span>&nbsp;<span class="num" id="4145388">0</span><span class="op" id="4145389">,</span>&nbsp;<span class="ident" id="4145391"><a href="/encoding/asn1/asn1.go.html#4145337">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145399">if</span>&nbsp;<span class="ident" id="4145402"><a href="/encoding/asn1/asn1.go.html#4145330">ret64</a></span>&nbsp;<span class="op" id="4145408">!=</span>&nbsp;<span class="ident" id="4145411">int64</span><span class="op" id="4145416">(</span><span class="builtintype" id="4145417">int32</span><span class="op" id="4145422">(</span><span class="ident" id="4145423"><a href="/encoding/asn1/asn1.go.html#4145330">ret64</a></span><span class="op" id="4145428">)</span><span class="op" id="4145429">)</span>&nbsp;<span class="op" id="4145431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145435">return</span>&nbsp;<span class="num" id="4145442">0</span><span class="op" id="4145443">,</span>&nbsp;<span class="ident" id="4145445"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4145460">{</span><span class="string" id="4145461">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4145480">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145486">return</span>&nbsp;<span class="builtintype" id="4145493">int32</span><span class="op" id="4145498">(</span><span class="ident" id="4145499"><a href="/encoding/asn1/asn1.go.html#4145330">ret64</a></span><span class="op" id="4145504">)</span><span class="op" id="4145505">,</span>&nbsp;<span class="ident" id="4145507">nil</span><br>
<span class="lineno"></span><span class="op" id="4145511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145514">var</span>&nbsp;<span class="ident" id="4145518">bigOne</span>&nbsp;<span class="op" id="4145525">=</span>&nbsp;<span class="ident" id="4145527"><a href="/encoding/asn1/asn1.go.html#4143662">big</a></span><span class="op" id="4145530">.</span><span class="ident" id="4145531">NewInt</span><span class="op" id="4145537">(</span><span class="num" id="4145538">1</span><span class="op" id="4145539">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4145542">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4145624">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4145639">func</span>&nbsp;<span class="ident" id="4145644">parseBigInt</span><span class="op" id="4145655">(</span><span class="ident" id="4145656">bytes</span>&nbsp;<span class="op" id="4145662">[</span><span class="op" id="4145663">]</span><span class="builtintype" id="4145664">byte</span><span class="op" id="4145668">)</span>&nbsp;<span class="op" id="4145670">*</span><span class="ident" id="4145671"><a href="/encoding/asn1/asn1.go.html#4143662">big</a></span><span class="op" id="4145674">.</span><span class="ident" id="4145675">Int</span>&nbsp;<span class="op" id="4145679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145682">ret</span>&nbsp;<span class="op" id="4145686">:=</span>&nbsp;<span class="builtinfunc" id="4145689">new</span><span class="op" id="4145692">(</span><span class="ident" id="4145693"><a href="/encoding/asn1/asn1.go.html#4143662">big</a></span><span class="op" id="4145696">.</span><span class="ident" id="4145697">Int</span><span class="op" id="4145700">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145703">if</span>&nbsp;<span class="builtinfunc" id="4145706">len</span><span class="op" id="4145709">(</span><span class="ident" id="4145710"><a href="/encoding/asn1/asn1.go.html#4145656">bytes</a></span><span class="op" id="4145715">)</span>&nbsp;<span class="op" id="4145717">&gt;</span>&nbsp;<span class="num" id="4145719">0</span>&nbsp;<span class="op" id="4145721">&amp;&amp;</span>&nbsp;<span class="ident" id="4145724"><a href="/encoding/asn1/asn1.go.html#4145656">bytes</a></span><span class="op" id="4145729">[</span><span class="num" id="4145730">0</span><span class="op" id="4145731">]</span><span class="op" id="4145732">&amp;</span><span class="num" id="4145733">0x80</span>&nbsp;<span class="op" id="4145738">==</span>&nbsp;<span class="num" id="4145741">0x80</span>&nbsp;<span class="op" id="4145746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145750">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145782">notBytes</span>&nbsp;<span class="op" id="4145791">:=</span>&nbsp;<span class="builtinfunc" id="4145794">make</span><span class="op" id="4145798">(</span><span class="op" id="4145799">[</span><span class="op" id="4145800">]</span><span class="builtintype" id="4145801">byte</span><span class="op" id="4145805">,</span>&nbsp;<span class="builtinfunc" id="4145807">len</span><span class="op" id="4145810">(</span><span class="ident" id="4145811"><a href="/encoding/asn1/asn1.go.html#4145656">bytes</a></span><span class="op" id="4145816">)</span><span class="op" id="4145817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145821">for</span>&nbsp;<span class="ident" id="4145825">i</span>&nbsp;<span class="op" id="4145827">:=</span>&nbsp;<span class="keyword" id="4145830">range</span>&nbsp;<span class="ident" id="4145836"><a href="/encoding/asn1/asn1.go.html#4145782">notBytes</a></span>&nbsp;<span class="op" id="4145845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145850"><a href="/encoding/asn1/asn1.go.html#4145782">notBytes</a></span><span class="op" id="4145858">[</span><span class="ident" id="4145859"><a href="/encoding/asn1/asn1.go.html#4145825">i</a></span><span class="op" id="4145860">]</span>&nbsp;<span class="op" id="4145862">=</span>&nbsp;<span class="op" id="4145864">^</span><span class="ident" id="4145865"><a href="/encoding/asn1/asn1.go.html#4145656">bytes</a></span><span class="op" id="4145870">[</span><span class="ident" id="4145871"><a href="/encoding/asn1/asn1.go.html#4145825">i</a></span><span class="op" id="4145872">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145880"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145883">.</span><span class="ident" id="4145884">SetBytes</span><span class="op" id="4145892">(</span><span class="ident" id="4145893"><a href="/encoding/asn1/asn1.go.html#4145782">notBytes</a></span><span class="op" id="4145901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145905"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145908">.</span><span class="ident" id="4145909">Add</span><span class="op" id="4145912">(</span><span class="ident" id="4145913"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145916">,</span>&nbsp;<span class="ident" id="4145918"><a href="/encoding/asn1/asn1.go.html#4145518">bigOne</a></span><span class="op" id="4145924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145928"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145931">.</span><span class="ident" id="4145932">Neg</span><span class="op" id="4145935">(</span><span class="ident" id="4145936"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145943">return</span>&nbsp;<span class="ident" id="4145950"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145958"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><span class="op" id="4145961">.</span><span class="ident" id="4145962">SetBytes</span><span class="op" id="4145970">(</span><span class="ident" id="4145971"><a href="/encoding/asn1/asn1.go.html#4145656">bytes</a></span><span class="op" id="4145976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145979">return</span>&nbsp;<span class="ident" id="4145986"><a href="/encoding/asn1/asn1.go.html#4145682">ret</a></span><br>
<span class="lineno"></span><span class="op" id="4145990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4145993">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4146008">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4146087">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4146162">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4146216">type</span>&nbsp;<span class="ident" id="4146221">BitString</span>&nbsp;<span class="keyword" id="4146231">struct</span>&nbsp;<span class="op" id="4146238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146241">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4146251">[</span><span class="op" id="4146252">]</span><span class="builtintype" id="4146253">byte</span>&nbsp;<span class="comment" id="4146258">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146286">BitLength</span>&nbsp;<span class="builtintype" id="4146296">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4146303">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4146322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4146325">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4146399">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4146417">func</span>&nbsp;<span class="op" id="4146422">(</span><span class="ident" id="4146423">b</span>&nbsp;<span class="ident" id="4146425"><a href="/encoding/asn1/asn1.go.html#4146221">BitString</a></span><span class="op" id="4146434">)</span>&nbsp;<span class="ident" id="4146436">At</span><span class="op" id="4146438">(</span><span class="ident" id="4146439">i</span>&nbsp;<span class="builtintype" id="4146441">int</span><span class="op" id="4146444">)</span>&nbsp;<span class="builtintype" id="4146446">int</span>&nbsp;<span class="op" id="4146450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146453">if</span>&nbsp;<span class="ident" id="4146456"><a href="/encoding/asn1/asn1.go.html#4146439">i</a></span>&nbsp;<span class="op" id="4146458">&lt;</span>&nbsp;<span class="num" id="4146460">0</span>&nbsp;<span class="op" id="4146462">||</span>&nbsp;<span class="ident" id="4146465"><a href="/encoding/asn1/asn1.go.html#4146439">i</a></span>&nbsp;<span class="op" id="4146467">&gt;=</span>&nbsp;<span class="ident" id="4146470"><a href="/encoding/asn1/asn1.go.html#4146423">b</a></span><span class="op" id="4146471">.</span><span class="ident" id="4146472">BitLength</span>&nbsp;<span class="op" id="4146482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146486">return</span>&nbsp;<span class="num" id="4146493">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146499">x</span>&nbsp;<span class="op" id="4146501">:=</span>&nbsp;<span class="ident" id="4146504"><a href="/encoding/asn1/asn1.go.html#4146439">i</a></span>&nbsp;<span class="op" id="4146506">/</span>&nbsp;<span class="num" id="4146508">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146511">y</span>&nbsp;<span class="op" id="4146513">:=</span>&nbsp;<span class="num" id="4146516">7</span>&nbsp;<span class="op" id="4146518">-</span>&nbsp;<span class="builtintype" id="4146520">uint</span><span class="op" id="4146524">(</span><span class="ident" id="4146525"><a href="/encoding/asn1/asn1.go.html#4146439">i</a></span><span class="op" id="4146526">%</span><span class="num" id="4146527">8</span><span class="op" id="4146528">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146531">return</span>&nbsp;<span class="builtintype" id="4146538">int</span><span class="op" id="4146541">(</span><span class="ident" id="4146542"><a href="/encoding/asn1/asn1.go.html#4146423">b</a></span><span class="op" id="4146543">.</span><span class="ident" id="4146544">Bytes</span><span class="op" id="4146549">[</span><span class="ident" id="4146550"><a href="/encoding/asn1/asn1.go.html#4146499">x</a></span><span class="op" id="4146551">]</span><span class="op" id="4146552">&gt;&gt;</span><span class="ident" id="4146554"><a href="/encoding/asn1/asn1.go.html#4146511">y</a></span><span class="op" id="4146555">)</span>&nbsp;<span class="op" id="4146557">&amp;</span>&nbsp;<span class="num" id="4146559">1</span><br>
<span class="lineno"></span><span class="op" id="4146561">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4146564">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4146643">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4146689">func</span>&nbsp;<span class="op" id="4146694">(</span><span class="ident" id="4146695">b</span>&nbsp;<span class="ident" id="4146697"><a href="/encoding/asn1/asn1.go.html#4146221">BitString</a></span><span class="op" id="4146706">)</span>&nbsp;<span class="ident" id="4146708">RightAlign</span><span class="op" id="4146718">(</span><span class="op" id="4146719">)</span>&nbsp;<span class="op" id="4146721">[</span><span class="op" id="4146722">]</span><span class="builtintype" id="4146723">byte</span>&nbsp;<span class="op" id="4146728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146731">shift</span>&nbsp;<span class="op" id="4146737">:=</span>&nbsp;<span class="builtintype" id="4146740">uint</span><span class="op" id="4146744">(</span><span class="num" id="4146745">8</span>&nbsp;<span class="op" id="4146747">-</span>&nbsp;<span class="op" id="4146749">(</span><span class="ident" id="4146750"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146751">.</span><span class="ident" id="4146752">BitLength</span>&nbsp;<span class="op" id="4146762">%</span>&nbsp;<span class="num" id="4146764">8</span><span class="op" id="4146765">)</span><span class="op" id="4146766">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146769">if</span>&nbsp;<span class="ident" id="4146772"><a href="/encoding/asn1/asn1.go.html#4146731">shift</a></span>&nbsp;<span class="op" id="4146778">==</span>&nbsp;<span class="num" id="4146781">8</span>&nbsp;<span class="op" id="4146783">||</span>&nbsp;<span class="builtinfunc" id="4146786">len</span><span class="op" id="4146789">(</span><span class="ident" id="4146790"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146791">.</span><span class="ident" id="4146792">Bytes</span><span class="op" id="4146797">)</span>&nbsp;<span class="op" id="4146799">==</span>&nbsp;<span class="num" id="4146802">0</span>&nbsp;<span class="op" id="4146804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146808">return</span>&nbsp;<span class="ident" id="4146815"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146816">.</span><span class="ident" id="4146817">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146828">a</span>&nbsp;<span class="op" id="4146830">:=</span>&nbsp;<span class="builtinfunc" id="4146833">make</span><span class="op" id="4146837">(</span><span class="op" id="4146838">[</span><span class="op" id="4146839">]</span><span class="builtintype" id="4146840">byte</span><span class="op" id="4146844">,</span>&nbsp;<span class="builtinfunc" id="4146846">len</span><span class="op" id="4146849">(</span><span class="ident" id="4146850"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146851">.</span><span class="ident" id="4146852">Bytes</span><span class="op" id="4146857">)</span><span class="op" id="4146858">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146861"><a href="/encoding/asn1/asn1.go.html#4146828">a</a></span><span class="op" id="4146862">[</span><span class="num" id="4146863">0</span><span class="op" id="4146864">]</span>&nbsp;<span class="op" id="4146866">=</span>&nbsp;<span class="ident" id="4146868"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146869">.</span><span class="ident" id="4146870">Bytes</span><span class="op" id="4146875">[</span><span class="num" id="4146876">0</span><span class="op" id="4146877">]</span>&nbsp;<span class="op" id="4146879">&gt;&gt;</span>&nbsp;<span class="ident" id="4146882"><a href="/encoding/asn1/asn1.go.html#4146731">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146889">for</span>&nbsp;<span class="ident" id="4146893">i</span>&nbsp;<span class="op" id="4146895">:=</span>&nbsp;<span class="num" id="4146898">1</span><span class="op" id="4146899">;</span>&nbsp;<span class="ident" id="4146901"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span>&nbsp;<span class="op" id="4146903">&lt;</span>&nbsp;<span class="builtinfunc" id="4146905">len</span><span class="op" id="4146908">(</span><span class="ident" id="4146909"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146910">.</span><span class="ident" id="4146911">Bytes</span><span class="op" id="4146916">)</span><span class="op" id="4146917">;</span>&nbsp;<span class="ident" id="4146919"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span><span class="op" id="4146920">++</span>&nbsp;<span class="op" id="4146923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146927"><a href="/encoding/asn1/asn1.go.html#4146828">a</a></span><span class="op" id="4146928">[</span><span class="ident" id="4146929"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span><span class="op" id="4146930">]</span>&nbsp;<span class="op" id="4146932">=</span>&nbsp;<span class="ident" id="4146934"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146935">.</span><span class="ident" id="4146936">Bytes</span><span class="op" id="4146941">[</span><span class="ident" id="4146942"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span><span class="op" id="4146943">-</span><span class="num" id="4146944">1</span><span class="op" id="4146945">]</span>&nbsp;<span class="op" id="4146947">&lt;&lt;</span>&nbsp;<span class="op" id="4146950">(</span><span class="num" id="4146951">8</span>&nbsp;<span class="op" id="4146953">-</span>&nbsp;<span class="ident" id="4146955"><a href="/encoding/asn1/asn1.go.html#4146731">shift</a></span><span class="op" id="4146960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146964"><a href="/encoding/asn1/asn1.go.html#4146828">a</a></span><span class="op" id="4146965">[</span><span class="ident" id="4146966"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span><span class="op" id="4146967">]</span>&nbsp;<span class="op" id="4146969">|=</span>&nbsp;<span class="ident" id="4146972"><a href="/encoding/asn1/asn1.go.html#4146695">b</a></span><span class="op" id="4146973">.</span><span class="ident" id="4146974">Bytes</span><span class="op" id="4146979">[</span><span class="ident" id="4146980"><a href="/encoding/asn1/asn1.go.html#4146893">i</a></span><span class="op" id="4146981">]</span>&nbsp;<span class="op" id="4146983">&gt;&gt;</span>&nbsp;<span class="ident" id="4146986"><a href="/encoding/asn1/asn1.go.html#4146731">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146993">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146997">return</span>&nbsp;<span class="ident" id="4147004"><a href="/encoding/asn1/asn1.go.html#4146828">a</a></span><br>
<span class="lineno"></span><span class="op" id="4147006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4147009">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4147096">func</span>&nbsp;<span class="ident" id="4147101">parseBitString</span><span class="op" id="4147115">(</span><span class="ident" id="4147116">bytes</span>&nbsp;<span class="op" id="4147122">[</span><span class="op" id="4147123">]</span><span class="builtintype" id="4147124">byte</span><span class="op" id="4147128">)</span>&nbsp;<span class="op" id="4147130">(</span><span class="ident" id="4147131">ret</span>&nbsp;<span class="ident" id="4147135"><a href="/encoding/asn1/asn1.go.html#4146221">BitString</a></span><span class="op" id="4147144">,</span>&nbsp;<span class="ident" id="4147146">err</span>&nbsp;<span class="builtintype" id="4147150">error</span><span class="op" id="4147155">)</span>&nbsp;<span class="op" id="4147157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147160">if</span>&nbsp;<span class="builtinfunc" id="4147163">len</span><span class="op" id="4147166">(</span><span class="ident" id="4147167"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147172">)</span>&nbsp;<span class="op" id="4147174">==</span>&nbsp;<span class="num" id="4147177">0</span>&nbsp;<span class="op" id="4147179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147183"><a href="/encoding/asn1/asn1.go.html#4147146">err</a></span>&nbsp;<span class="op" id="4147187">=</span>&nbsp;<span class="ident" id="4147189"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4147200">{</span><span class="string" id="4147201">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4147225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147229">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147237">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147240">paddingBits</span>&nbsp;<span class="op" id="4147252">:=</span>&nbsp;<span class="builtintype" id="4147255">int</span><span class="op" id="4147258">(</span><span class="ident" id="4147259"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147264">[</span><span class="num" id="4147265">0</span><span class="op" id="4147266">]</span><span class="op" id="4147267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147270">if</span>&nbsp;<span class="ident" id="4147273"><a href="/encoding/asn1/asn1.go.html#4147240">paddingBits</a></span>&nbsp;<span class="op" id="4147285">&gt;</span>&nbsp;<span class="num" id="4147287">7</span>&nbsp;<span class="op" id="4147289">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4147294">len</span><span class="op" id="4147297">(</span><span class="ident" id="4147298"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147303">)</span>&nbsp;<span class="op" id="4147305">==</span>&nbsp;<span class="num" id="4147308">1</span>&nbsp;<span class="op" id="4147310">&amp;&amp;</span>&nbsp;<span class="ident" id="4147313"><a href="/encoding/asn1/asn1.go.html#4147240">paddingBits</a></span>&nbsp;<span class="op" id="4147325">&gt;</span>&nbsp;<span class="num" id="4147327">0</span>&nbsp;<span class="op" id="4147329">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147334"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147339">[</span><span class="builtinfunc" id="4147340">len</span><span class="op" id="4147343">(</span><span class="ident" id="4147344"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147349">)</span><span class="op" id="4147350">-</span><span class="num" id="4147351">1</span><span class="op" id="4147352">]</span><span class="op" id="4147353">&amp;</span><span class="op" id="4147354">(</span><span class="op" id="4147355">(</span><span class="num" id="4147356">1</span><span class="op" id="4147357">&lt;&lt;</span><span class="ident" id="4147359"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147364">[</span><span class="num" id="4147365">0</span><span class="op" id="4147366">]</span><span class="op" id="4147367">)</span><span class="op" id="4147368">-</span><span class="num" id="4147369">1</span><span class="op" id="4147370">)</span>&nbsp;<span class="op" id="4147372">!=</span>&nbsp;<span class="num" id="4147375">0</span>&nbsp;<span class="op" id="4147377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147381"><a href="/encoding/asn1/asn1.go.html#4147146">err</a></span>&nbsp;<span class="op" id="4147385">=</span>&nbsp;<span class="ident" id="4147387"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4147398">{</span><span class="string" id="4147399">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4147435">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147450"><a href="/encoding/asn1/asn1.go.html#4147131">ret</a></span><span class="op" id="4147453">.</span><span class="ident" id="4147454">BitLength</span>&nbsp;<span class="op" id="4147464">=</span>&nbsp;<span class="op" id="4147466">(</span><span class="builtinfunc" id="4147467">len</span><span class="op" id="4147470">(</span><span class="ident" id="4147471"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147476">)</span><span class="op" id="4147477">-</span><span class="num" id="4147478">1</span><span class="op" id="4147479">)</span><span class="op" id="4147480">*</span><span class="num" id="4147481">8</span>&nbsp;<span class="op" id="4147483">-</span>&nbsp;<span class="ident" id="4147485"><a href="/encoding/asn1/asn1.go.html#4147240">paddingBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147498"><a href="/encoding/asn1/asn1.go.html#4147131">ret</a></span><span class="op" id="4147501">.</span><span class="ident" id="4147502">Bytes</span>&nbsp;<span class="op" id="4147508">=</span>&nbsp;<span class="ident" id="4147510"><a href="/encoding/asn1/asn1.go.html#4147116">bytes</a></span><span class="op" id="4147515">[</span><span class="num" id="4147516">1</span><span class="op" id="4147517">:</span><span class="op" id="4147518">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147521">return</span><br>
<span class="lineno">180</span><span class="op" id="4147528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4147531">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4147553">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4147615">type</span>&nbsp;<span class="ident" id="4147620">ObjectIdentifier</span>&nbsp;<span class="op" id="4147637">[</span><span class="op" id="4147638">]</span><span class="builtintype" id="4147639">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4147644">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4147713">func</span>&nbsp;<span class="op" id="4147718">(</span><span class="ident" id="4147719">oi</span>&nbsp;<span class="ident" id="4147722"><a href="/encoding/asn1/asn1.go.html#4147620">ObjectIdentifier</a></span><span class="op" id="4147738">)</span>&nbsp;<span class="ident" id="4147740">Equal</span><span class="op" id="4147745">(</span><span class="ident" id="4147746">other</span>&nbsp;<span class="ident" id="4147752"><a href="/encoding/asn1/asn1.go.html#4147620">ObjectIdentifier</a></span><span class="op" id="4147768">)</span>&nbsp;<span class="builtintype" id="4147770">bool</span>&nbsp;<span class="op" id="4147775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147778">if</span>&nbsp;<span class="builtinfunc" id="4147781">len</span><span class="op" id="4147784">(</span><span class="ident" id="4147785"><a href="/encoding/asn1/asn1.go.html#4147719">oi</a></span><span class="op" id="4147787">)</span>&nbsp;<span class="op" id="4147789">!=</span>&nbsp;<span class="builtinfunc" id="4147792">len</span><span class="op" id="4147795">(</span><span class="ident" id="4147796"><a href="/encoding/asn1/asn1.go.html#4147746">other</a></span><span class="op" id="4147801">)</span>&nbsp;<span class="op" id="4147803">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147807">return</span>&nbsp;<span class="builtintype" id="4147814">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147824">for</span>&nbsp;<span class="ident" id="4147828">i</span>&nbsp;<span class="op" id="4147830">:=</span>&nbsp;<span class="num" id="4147833">0</span><span class="op" id="4147834">;</span>&nbsp;<span class="ident" id="4147836"><a href="/encoding/asn1/asn1.go.html#4147828">i</a></span>&nbsp;<span class="op" id="4147838">&lt;</span>&nbsp;<span class="builtinfunc" id="4147840">len</span><span class="op" id="4147843">(</span><span class="ident" id="4147844"><a href="/encoding/asn1/asn1.go.html#4147719">oi</a></span><span class="op" id="4147846">)</span><span class="op" id="4147847">;</span>&nbsp;<span class="ident" id="4147849"><a href="/encoding/asn1/asn1.go.html#4147828">i</a></span><span class="op" id="4147850">++</span>&nbsp;<span class="op" id="4147853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147857">if</span>&nbsp;<span class="ident" id="4147860"><a href="/encoding/asn1/asn1.go.html#4147719">oi</a></span><span class="op" id="4147862">[</span><span class="ident" id="4147863"><a href="/encoding/asn1/asn1.go.html#4147828">i</a></span><span class="op" id="4147864">]</span>&nbsp;<span class="op" id="4147866">!=</span>&nbsp;<span class="ident" id="4147869"><a href="/encoding/asn1/asn1.go.html#4147746">other</a></span><span class="op" id="4147874">[</span><span class="ident" id="4147875"><a href="/encoding/asn1/asn1.go.html#4147828">i</a></span><span class="op" id="4147876">]</span>&nbsp;<span class="op" id="4147878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147883">return</span>&nbsp;<span class="builtintype" id="4147890">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147901">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147905">return</span>&nbsp;<span class="builtintype" id="4147912">true</span><br>
<span class="lineno"></span><span class="op" id="4147917">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4147920">func</span>&nbsp;<span class="op" id="4147925">(</span><span class="ident" id="4147926">oi</span>&nbsp;<span class="ident" id="4147929"><a href="/encoding/asn1/asn1.go.html#4147620">ObjectIdentifier</a></span><span class="op" id="4147945">)</span>&nbsp;<span class="ident" id="4147947">String</span><span class="op" id="4147953">(</span><span class="op" id="4147954">)</span>&nbsp;<span class="builtintype" id="4147956">string</span>&nbsp;<span class="op" id="4147963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147966">var</span>&nbsp;<span class="ident" id="4147970">s</span>&nbsp;<span class="builtintype" id="4147972">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147981">for</span>&nbsp;<span class="ident" id="4147985">i</span><span class="op" id="4147986">,</span>&nbsp;<span class="ident" id="4147988">v</span>&nbsp;<span class="op" id="4147990">:=</span>&nbsp;<span class="keyword" id="4147993">range</span>&nbsp;<span class="ident" id="4147999"><a href="/encoding/asn1/asn1.go.html#4147926">oi</a></span>&nbsp;<span class="op" id="4148002">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148006">if</span>&nbsp;<span class="ident" id="4148009"><a href="/encoding/asn1/asn1.go.html#4147985">i</a></span>&nbsp;<span class="op" id="4148011">&gt;</span>&nbsp;<span class="num" id="4148013">0</span>&nbsp;<span class="op" id="4148015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148020"><a href="/encoding/asn1/asn1.go.html#4147970">s</a></span>&nbsp;<span class="op" id="4148022">+=</span>&nbsp;<span class="string" id="4148025">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148035"><a href="/encoding/asn1/asn1.go.html#4147970">s</a></span>&nbsp;<span class="op" id="4148037">+=</span>&nbsp;<span class="ident" id="4148040"><a href="/encoding/asn1/asn1.go.html#4143685">strconv</a></span><span class="op" id="4148047">.</span><span class="ident" id="4148048">Itoa</span><span class="op" id="4148052">(</span><span class="ident" id="4148053"><a href="/encoding/asn1/asn1.go.html#4147988">v</a></span><span class="op" id="4148054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148057">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148061">return</span>&nbsp;<span class="ident" id="4148068"><a href="/encoding/asn1/asn1.go.html#4147970">s</a></span><br>
<span class="lineno"></span><span class="op" id="4148070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4148073">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4148151">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4148229">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4148266">func</span>&nbsp;<span class="ident" id="4148271">parseObjectIdentifier</span><span class="op" id="4148292">(</span><span class="ident" id="4148293">bytes</span>&nbsp;<span class="op" id="4148299">[</span><span class="op" id="4148300">]</span><span class="builtintype" id="4148301">byte</span><span class="op" id="4148305">)</span>&nbsp;<span class="op" id="4148307">(</span><span class="ident" id="4148308">s</span>&nbsp;<span class="op" id="4148310">[</span><span class="op" id="4148311">]</span><span class="builtintype" id="4148312">int</span><span class="op" id="4148315">,</span>&nbsp;<span class="ident" id="4148317">err</span>&nbsp;<span class="builtintype" id="4148321">error</span><span class="op" id="4148326">)</span>&nbsp;<span class="op" id="4148328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148331">if</span>&nbsp;<span class="builtinfunc" id="4148334">len</span><span class="op" id="4148337">(</span><span class="ident" id="4148338"><a href="/encoding/asn1/asn1.go.html#4148293">bytes</a></span><span class="op" id="4148343">)</span>&nbsp;<span class="op" id="4148345">==</span>&nbsp;<span class="num" id="4148348">0</span>&nbsp;<span class="op" id="4148350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148354"><a href="/encoding/asn1/asn1.go.html#4148317">err</a></span>&nbsp;<span class="op" id="4148358">=</span>&nbsp;<span class="ident" id="4148360"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4148371">{</span><span class="string" id="4148372">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4148403">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148415">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148419">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148492">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148562"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span>&nbsp;<span class="op" id="4148564">=</span>&nbsp;<span class="builtinfunc" id="4148566">make</span><span class="op" id="4148570">(</span><span class="op" id="4148571">[</span><span class="op" id="4148572">]</span><span class="builtintype" id="4148573">int</span><span class="op" id="4148576">,</span>&nbsp;<span class="builtinfunc" id="4148578">len</span><span class="op" id="4148581">(</span><span class="ident" id="4148582"><a href="/encoding/asn1/asn1.go.html#4148293">bytes</a></span><span class="op" id="4148587">)</span><span class="op" id="4148588">+</span><span class="num" id="4148589">1</span><span class="op" id="4148590">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148594">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148638">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148713">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148787">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148833">v</span><span class="op" id="4148834">,</span>&nbsp;<span class="ident" id="4148836">offset</span><span class="op" id="4148842">,</span>&nbsp;<span class="ident" id="4148844"><a href="/encoding/asn1/asn1.go.html#4148317">err</a></span>&nbsp;<span class="op" id="4148848">:=</span>&nbsp;<span class="ident" id="4148851"><a href="/encoding/asn1/asn1.go.html#4149465">parseBase128Int</a></span><span class="op" id="4148866">(</span><span class="ident" id="4148867"><a href="/encoding/asn1/asn1.go.html#4148293">bytes</a></span><span class="op" id="4148872">,</span>&nbsp;<span class="num" id="4148874">0</span><span class="op" id="4148875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148878">if</span>&nbsp;<span class="ident" id="4148881"><a href="/encoding/asn1/asn1.go.html#4148317">err</a></span>&nbsp;<span class="op" id="4148885">!=</span>&nbsp;<span class="ident" id="4148888">nil</span>&nbsp;<span class="op" id="4148892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148904">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148907">if</span>&nbsp;<span class="ident" id="4148910"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span>&nbsp;<span class="op" id="4148912">&lt;</span>&nbsp;<span class="num" id="4148914">80</span>&nbsp;<span class="op" id="4148917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148921"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4148922">[</span><span class="num" id="4148923">0</span><span class="op" id="4148924">]</span>&nbsp;<span class="op" id="4148926">=</span>&nbsp;<span class="ident" id="4148928"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span>&nbsp;<span class="op" id="4148930">/</span>&nbsp;<span class="num" id="4148932">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148937"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4148938">[</span><span class="num" id="4148939">1</span><span class="op" id="4148940">]</span>&nbsp;<span class="op" id="4148942">=</span>&nbsp;<span class="ident" id="4148944"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span>&nbsp;<span class="op" id="4148946">%</span>&nbsp;<span class="num" id="4148948">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148952">}</span>&nbsp;<span class="keyword" id="4148954">else</span>&nbsp;<span class="op" id="4148959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148963"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4148964">[</span><span class="num" id="4148965">0</span><span class="op" id="4148966">]</span>&nbsp;<span class="op" id="4148968">=</span>&nbsp;<span class="num" id="4148970">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148974"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4148975">[</span><span class="num" id="4148976">1</span><span class="op" id="4148977">]</span>&nbsp;<span class="op" id="4148979">=</span>&nbsp;<span class="ident" id="4148981"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span>&nbsp;<span class="op" id="4148983">-</span>&nbsp;<span class="num" id="4148985">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148993">i</span>&nbsp;<span class="op" id="4148995">:=</span>&nbsp;<span class="num" id="4148998">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149001">for</span>&nbsp;<span class="op" id="4149005">;</span>&nbsp;<span class="ident" id="4149007"><a href="/encoding/asn1/asn1.go.html#4148836">offset</a></span>&nbsp;<span class="op" id="4149014">&lt;</span>&nbsp;<span class="builtinfunc" id="4149016">len</span><span class="op" id="4149019">(</span><span class="ident" id="4149020"><a href="/encoding/asn1/asn1.go.html#4148293">bytes</a></span><span class="op" id="4149025">)</span><span class="op" id="4149026">;</span>&nbsp;<span class="ident" id="4149028"><a href="/encoding/asn1/asn1.go.html#4148993">i</a></span><span class="op" id="4149029">++</span>&nbsp;<span class="op" id="4149032">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149036"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span><span class="op" id="4149037">,</span>&nbsp;<span class="ident" id="4149039"><a href="/encoding/asn1/asn1.go.html#4148836">offset</a></span><span class="op" id="4149045">,</span>&nbsp;<span class="ident" id="4149047"><a href="/encoding/asn1/asn1.go.html#4148317">err</a></span>&nbsp;<span class="op" id="4149051">=</span>&nbsp;<span class="ident" id="4149053"><a href="/encoding/asn1/asn1.go.html#4149465">parseBase128Int</a></span><span class="op" id="4149068">(</span><span class="ident" id="4149069"><a href="/encoding/asn1/asn1.go.html#4148293">bytes</a></span><span class="op" id="4149074">,</span>&nbsp;<span class="ident" id="4149076"><a href="/encoding/asn1/asn1.go.html#4148836">offset</a></span><span class="op" id="4149082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149086">if</span>&nbsp;<span class="ident" id="4149089"><a href="/encoding/asn1/asn1.go.html#4148317">err</a></span>&nbsp;<span class="op" id="4149093">!=</span>&nbsp;<span class="ident" id="4149096">nil</span>&nbsp;<span class="op" id="4149100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149118"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4149119">[</span><span class="ident" id="4149120"><a href="/encoding/asn1/asn1.go.html#4148993">i</a></span><span class="op" id="4149121">]</span>&nbsp;<span class="op" id="4149123">=</span>&nbsp;<span class="ident" id="4149125"><a href="/encoding/asn1/asn1.go.html#4148833">v</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149131"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span>&nbsp;<span class="op" id="4149133">=</span>&nbsp;<span class="ident" id="4149135"><a href="/encoding/asn1/asn1.go.html#4148308">s</a></span><span class="op" id="4149136">[</span><span class="num" id="4149137">0</span><span class="op" id="4149138">:</span><span class="ident" id="4149139"><a href="/encoding/asn1/asn1.go.html#4148993">i</a></span><span class="op" id="4149140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149143">return</span><br>
<span class="lineno"></span><span class="op" id="4149150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4149153">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4149168">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4149216">type</span>&nbsp;<span class="ident" id="4149221">Enumerated</span>&nbsp;<span class="builtintype" id="4149232">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4149237">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4149246">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4149304">type</span>&nbsp;<span class="ident" id="4149309">Flag</span>&nbsp;<span class="builtintype" id="4149314">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4149320">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4149398">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4149460">func</span>&nbsp;<span class="ident" id="4149465">parseBase128Int</span><span class="op" id="4149480">(</span><span class="ident" id="4149481">bytes</span>&nbsp;<span class="op" id="4149487">[</span><span class="op" id="4149488">]</span><span class="builtintype" id="4149489">byte</span><span class="op" id="4149493">,</span>&nbsp;<span class="ident" id="4149495">initOffset</span>&nbsp;<span class="builtintype" id="4149506">int</span><span class="op" id="4149509">)</span>&nbsp;<span class="op" id="4149511">(</span><span class="ident" id="4149512">ret</span><span class="op" id="4149515">,</span>&nbsp;<span class="ident" id="4149517">offset</span>&nbsp;<span class="builtintype" id="4149524">int</span><span class="op" id="4149527">,</span>&nbsp;<span class="ident" id="4149529">err</span>&nbsp;<span class="builtintype" id="4149533">error</span><span class="op" id="4149538">)</span>&nbsp;<span class="op" id="4149540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149543"><a href="/encoding/asn1/asn1.go.html#4149517">offset</a></span>&nbsp;<span class="op" id="4149550">=</span>&nbsp;<span class="ident" id="4149552"><a href="/encoding/asn1/asn1.go.html#4149495">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149564">for</span>&nbsp;<span class="ident" id="4149568">shifted</span>&nbsp;<span class="op" id="4149576">:=</span>&nbsp;<span class="num" id="4149579">0</span><span class="op" id="4149580">;</span>&nbsp;<span class="ident" id="4149582"><a href="/encoding/asn1/asn1.go.html#4149517">offset</a></span>&nbsp;<span class="op" id="4149589">&lt;</span>&nbsp;<span class="builtinfunc" id="4149591">len</span><span class="op" id="4149594">(</span><span class="ident" id="4149595"><a href="/encoding/asn1/asn1.go.html#4149481">bytes</a></span><span class="op" id="4149600">)</span><span class="op" id="4149601">;</span>&nbsp;<span class="ident" id="4149603"><a href="/encoding/asn1/asn1.go.html#4149568">shifted</a></span><span class="op" id="4149610">++</span>&nbsp;<span class="op" id="4149613">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149617">if</span>&nbsp;<span class="ident" id="4149620"><a href="/encoding/asn1/asn1.go.html#4149568">shifted</a></span>&nbsp;<span class="op" id="4149628">&gt;</span>&nbsp;<span class="num" id="4149630">4</span>&nbsp;<span class="op" id="4149632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149637"><a href="/encoding/asn1/asn1.go.html#4149529">err</a></span>&nbsp;<span class="op" id="4149641">=</span>&nbsp;<span class="ident" id="4149643"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4149658">{</span><span class="string" id="4149659">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4149687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149692">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149705"><a href="/encoding/asn1/asn1.go.html#4149512">ret</a></span>&nbsp;<span class="op" id="4149709">&lt;&lt;=</span>&nbsp;<span class="num" id="4149713">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149717">b</span>&nbsp;<span class="op" id="4149719">:=</span>&nbsp;<span class="ident" id="4149722"><a href="/encoding/asn1/asn1.go.html#4149481">bytes</a></span><span class="op" id="4149727">[</span><span class="ident" id="4149728"><a href="/encoding/asn1/asn1.go.html#4149517">offset</a></span><span class="op" id="4149734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149738"><a href="/encoding/asn1/asn1.go.html#4149512">ret</a></span>&nbsp;<span class="op" id="4149742">|=</span>&nbsp;<span class="builtintype" id="4149745">int</span><span class="op" id="4149748">(</span><span class="ident" id="4149749"><a href="/encoding/asn1/asn1.go.html#4149717">b</a></span>&nbsp;<span class="op" id="4149751">&amp;</span>&nbsp;<span class="num" id="4149753">0x7f</span><span class="op" id="4149757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149761"><a href="/encoding/asn1/asn1.go.html#4149517">offset</a></span><span class="op" id="4149767">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149772">if</span>&nbsp;<span class="ident" id="4149775"><a href="/encoding/asn1/asn1.go.html#4149717">b</a></span><span class="op" id="4149776">&amp;</span><span class="num" id="4149777">0x80</span>&nbsp;<span class="op" id="4149782">==</span>&nbsp;<span class="num" id="4149785">0</span>&nbsp;<span class="op" id="4149787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149792">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149807"><a href="/encoding/asn1/asn1.go.html#4149529">err</a></span>&nbsp;<span class="op" id="4149811">=</span>&nbsp;<span class="ident" id="4149813"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4149824">{</span><span class="string" id="4149825">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4149853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149856">return</span><br>
<span class="lineno"></span><span class="op" id="4149863">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4149866">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4149878">func</span>&nbsp;<span class="ident" id="4149883">parseUTCTime</span><span class="op" id="4149895">(</span><span class="ident" id="4149896">bytes</span>&nbsp;<span class="op" id="4149902">[</span><span class="op" id="4149903">]</span><span class="builtintype" id="4149904">byte</span><span class="op" id="4149908">)</span>&nbsp;<span class="op" id="4149910">(</span><span class="ident" id="4149911">ret</span>&nbsp;<span class="ident" id="4149915"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4149919">.</span><span class="ident" id="4149920">Time</span><span class="op" id="4149924">,</span>&nbsp;<span class="ident" id="4149926">err</span>&nbsp;<span class="builtintype" id="4149930">error</span><span class="op" id="4149935">)</span>&nbsp;<span class="op" id="4149937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149940">s</span>&nbsp;<span class="op" id="4149942">:=</span>&nbsp;<span class="builtintype" id="4149945">string</span><span class="op" id="4149951">(</span><span class="ident" id="4149952"><a href="/encoding/asn1/asn1.go.html#4149896">bytes</a></span><span class="op" id="4149957">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149960"><a href="/encoding/asn1/asn1.go.html#4149911">ret</a></span><span class="op" id="4149963">,</span>&nbsp;<span class="ident" id="4149965"><a href="/encoding/asn1/asn1.go.html#4149926">err</a></span>&nbsp;<span class="op" id="4149969">=</span>&nbsp;<span class="ident" id="4149971"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4149975">.</span><span class="ident" id="4149976">Parse</span><span class="op" id="4149981">(</span><span class="string" id="4149982">&#34;0601021504Z0700&#34;</span><span class="op" id="4149999">,</span>&nbsp;<span class="ident" id="4150001"><a href="/encoding/asn1/asn1.go.html#4149940">s</a></span><span class="op" id="4150002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150005">if</span>&nbsp;<span class="ident" id="4150008"><a href="/encoding/asn1/asn1.go.html#4149926">err</a></span>&nbsp;<span class="op" id="4150012">!=</span>&nbsp;<span class="ident" id="4150015">nil</span>&nbsp;<span class="op" id="4150019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150023"><a href="/encoding/asn1/asn1.go.html#4149911">ret</a></span><span class="op" id="4150026">,</span>&nbsp;<span class="ident" id="4150028"><a href="/encoding/asn1/asn1.go.html#4149926">err</a></span>&nbsp;<span class="op" id="4150032">=</span>&nbsp;<span class="ident" id="4150034"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4150038">.</span><span class="ident" id="4150039">Parse</span><span class="op" id="4150044">(</span><span class="string" id="4150045">&#34;060102150405Z0700&#34;</span><span class="op" id="4150064">,</span>&nbsp;<span class="ident" id="4150066"><a href="/encoding/asn1/asn1.go.html#4149940">s</a></span><span class="op" id="4150067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150073">if</span>&nbsp;<span class="ident" id="4150076"><a href="/encoding/asn1/asn1.go.html#4149926">err</a></span>&nbsp;<span class="op" id="4150080">==</span>&nbsp;<span class="ident" id="4150083">nil</span>&nbsp;<span class="op" id="4150087">&amp;&amp;</span>&nbsp;<span class="ident" id="4150090"><a href="/encoding/asn1/asn1.go.html#4149911">ret</a></span><span class="op" id="4150093">.</span><span class="ident" id="4150094">Year</span><span class="op" id="4150098">(</span><span class="op" id="4150099">)</span>&nbsp;<span class="op" id="4150101">&gt;=</span>&nbsp;<span class="num" id="4150104">2050</span>&nbsp;<span class="op" id="4150109">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4150113">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150218"><a href="/encoding/asn1/asn1.go.html#4149911">ret</a></span>&nbsp;<span class="op" id="4150222">=</span>&nbsp;<span class="ident" id="4150224"><a href="/encoding/asn1/asn1.go.html#4149911">ret</a></span><span class="op" id="4150227">.</span><span class="ident" id="4150228">AddDate</span><span class="op" id="4150235">(</span><span class="op" id="4150236">-</span><span class="num" id="4150237">100</span><span class="op" id="4150240">,</span>&nbsp;<span class="num" id="4150242">0</span><span class="op" id="4150243">,</span>&nbsp;<span class="num" id="4150245">0</span><span class="op" id="4150246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150253">return</span><br>
<span class="lineno">300</span><span class="op" id="4150260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4150263">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4150340">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4150375">func</span>&nbsp;<span class="ident" id="4150380">parseGeneralizedTime</span><span class="op" id="4150400">(</span><span class="ident" id="4150401">bytes</span>&nbsp;<span class="op" id="4150407">[</span><span class="op" id="4150408">]</span><span class="builtintype" id="4150409">byte</span><span class="op" id="4150413">)</span>&nbsp;<span class="op" id="4150415">(</span><span class="ident" id="4150416">ret</span>&nbsp;<span class="ident" id="4150420"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4150424">.</span><span class="ident" id="4150425">Time</span><span class="op" id="4150429">,</span>&nbsp;<span class="ident" id="4150431">err</span>&nbsp;<span class="builtintype" id="4150435">error</span><span class="op" id="4150440">)</span>&nbsp;<span class="op" id="4150442">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150445">return</span>&nbsp;<span class="ident" id="4150452"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4150456">.</span><span class="ident" id="4150457">Parse</span><span class="op" id="4150462">(</span><span class="string" id="4150463">&#34;20060102150405Z0700&#34;</span><span class="op" id="4150484">,</span>&nbsp;<span class="builtintype" id="4150486">string</span><span class="op" id="4150492">(</span><span class="ident" id="4150493"><a href="/encoding/asn1/asn1.go.html#4150401">bytes</a></span><span class="op" id="4150498">)</span><span class="op" id="4150499">)</span><br>
<span class="lineno"></span><span class="op" id="4150501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4150504">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4150524">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4150599">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4150624">func</span>&nbsp;<span class="ident" id="4150629">parsePrintableString</span><span class="op" id="4150649">(</span><span class="ident" id="4150650">bytes</span>&nbsp;<span class="op" id="4150656">[</span><span class="op" id="4150657">]</span><span class="builtintype" id="4150658">byte</span><span class="op" id="4150662">)</span>&nbsp;<span class="op" id="4150664">(</span><span class="ident" id="4150665">ret</span>&nbsp;<span class="builtintype" id="4150669">string</span><span class="op" id="4150675">,</span>&nbsp;<span class="ident" id="4150677">err</span>&nbsp;<span class="builtintype" id="4150681">error</span><span class="op" id="4150686">)</span>&nbsp;<span class="op" id="4150688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150691">for</span>&nbsp;<span class="ident" id="4150695">_</span><span class="op" id="4150696">,</span>&nbsp;<span class="ident" id="4150698">b</span>&nbsp;<span class="op" id="4150700">:=</span>&nbsp;<span class="keyword" id="4150703">range</span>&nbsp;<span class="ident" id="4150709"><a href="/encoding/asn1/asn1.go.html#4150650">bytes</a></span>&nbsp;<span class="op" id="4150715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150719">if</span>&nbsp;<span class="op" id="4150722">!</span><span class="ident" id="4150723"><a href="/encoding/asn1/asn1.go.html#4150942">isPrintable</a></span><span class="op" id="4150734">(</span><span class="ident" id="4150735"><a href="/encoding/asn1/asn1.go.html#4150698">b</a></span><span class="op" id="4150736">)</span>&nbsp;<span class="op" id="4150738">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150743"><a href="/encoding/asn1/asn1.go.html#4150677">err</a></span>&nbsp;<span class="op" id="4150747">=</span>&nbsp;<span class="ident" id="4150749"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4150760">{</span><span class="string" id="4150761">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4150805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150810">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150825"><a href="/encoding/asn1/asn1.go.html#4150665">ret</a></span>&nbsp;<span class="op" id="4150829">=</span>&nbsp;<span class="builtintype" id="4150831">string</span><span class="op" id="4150837">(</span><span class="ident" id="4150838"><a href="/encoding/asn1/asn1.go.html#4150650">bytes</a></span><span class="op" id="4150843">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150846">return</span><br>
<span class="lineno"></span><span class="op" id="4150853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4150856">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4150937">func</span>&nbsp;<span class="ident" id="4150942">isPrintable</span><span class="op" id="4150953">(</span><span class="ident" id="4150954">b</span>&nbsp;<span class="builtintype" id="4150956">byte</span><span class="op" id="4150960">)</span>&nbsp;<span class="builtintype" id="4150962">bool</span>&nbsp;<span class="op" id="4150967">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150970">return</span>&nbsp;<span class="string" id="4150977">&#39;a&#39;</span>&nbsp;<span class="op" id="4150981">&lt;=</span>&nbsp;<span class="ident" id="4150984"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4150986">&amp;&amp;</span>&nbsp;<span class="ident" id="4150989"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4150991">&lt;=</span>&nbsp;<span class="string" id="4150994">&#39;z&#39;</span>&nbsp;<span class="op" id="4150998">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4151003">&#39;A&#39;</span>&nbsp;<span class="op" id="4151007">&lt;=</span>&nbsp;<span class="ident" id="4151010"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151012">&amp;&amp;</span>&nbsp;<span class="ident" id="4151015"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151017">&lt;=</span>&nbsp;<span class="string" id="4151020">&#39;Z&#39;</span>&nbsp;<span class="op" id="4151024">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4151029">&#39;0&#39;</span>&nbsp;<span class="op" id="4151033">&lt;=</span>&nbsp;<span class="ident" id="4151036"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151038">&amp;&amp;</span>&nbsp;<span class="ident" id="4151041"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151043">&lt;=</span>&nbsp;<span class="string" id="4151046">&#39;9&#39;</span>&nbsp;<span class="op" id="4151050">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4151055">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4151060">&lt;=</span>&nbsp;<span class="ident" id="4151063"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151065">&amp;&amp;</span>&nbsp;<span class="ident" id="4151068"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151070">&lt;=</span>&nbsp;<span class="string" id="4151073">&#39;)&#39;</span>&nbsp;<span class="op" id="4151077">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4151082">&#39;+&#39;</span>&nbsp;<span class="op" id="4151086">&lt;=</span>&nbsp;<span class="ident" id="4151089"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151091">&amp;&amp;</span>&nbsp;<span class="ident" id="4151094"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151096">&lt;=</span>&nbsp;<span class="string" id="4151099">&#39;/&#39;</span>&nbsp;<span class="op" id="4151103">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151108"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151110">==</span>&nbsp;<span class="string" id="4151113">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4151117">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151122"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151124">==</span>&nbsp;<span class="string" id="4151127">&#39;:&#39;</span>&nbsp;<span class="op" id="4151131">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151136"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151138">==</span>&nbsp;<span class="string" id="4151141">&#39;=&#39;</span>&nbsp;<span class="op" id="4151145">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151150"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151152">==</span>&nbsp;<span class="string" id="4151155">&#39;?&#39;</span>&nbsp;<span class="op" id="4151159">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4151164">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4151223">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4151283">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151340"><a href="/encoding/asn1/asn1.go.html#4150954">b</a></span>&nbsp;<span class="op" id="4151342">==</span>&nbsp;<span class="string" id="4151345">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4151349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4151352">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4151366">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4151439">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4151469">func</span>&nbsp;<span class="ident" id="4151474">parseIA5String</span><span class="op" id="4151488">(</span><span class="ident" id="4151489">bytes</span>&nbsp;<span class="op" id="4151495">[</span><span class="op" id="4151496">]</span><span class="builtintype" id="4151497">byte</span><span class="op" id="4151501">)</span>&nbsp;<span class="op" id="4151503">(</span><span class="ident" id="4151504">ret</span>&nbsp;<span class="builtintype" id="4151508">string</span><span class="op" id="4151514">,</span>&nbsp;<span class="ident" id="4151516">err</span>&nbsp;<span class="builtintype" id="4151520">error</span><span class="op" id="4151525">)</span>&nbsp;<span class="op" id="4151527">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151530">for</span>&nbsp;<span class="ident" id="4151534">_</span><span class="op" id="4151535">,</span>&nbsp;<span class="ident" id="4151537">b</span>&nbsp;<span class="op" id="4151539">:=</span>&nbsp;<span class="keyword" id="4151542">range</span>&nbsp;<span class="ident" id="4151548"><a href="/encoding/asn1/asn1.go.html#4151489">bytes</a></span>&nbsp;<span class="op" id="4151554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151558">if</span>&nbsp;<span class="ident" id="4151561"><a href="/encoding/asn1/asn1.go.html#4151537">b</a></span>&nbsp;<span class="op" id="4151563">&gt;=</span>&nbsp;<span class="num" id="4151566">0x80</span>&nbsp;<span class="op" id="4151571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151576"><a href="/encoding/asn1/asn1.go.html#4151516">err</a></span>&nbsp;<span class="op" id="4151580">=</span>&nbsp;<span class="ident" id="4151582"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4151593">{</span><span class="string" id="4151594">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4151632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151637">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151646">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151652"><a href="/encoding/asn1/asn1.go.html#4151504">ret</a></span>&nbsp;<span class="op" id="4151656">=</span>&nbsp;<span class="builtintype" id="4151658">string</span><span class="op" id="4151664">(</span><span class="ident" id="4151665"><a href="/encoding/asn1/asn1.go.html#4151489">bytes</a></span><span class="op" id="4151670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151673">return</span><br>
<span class="lineno"></span><span class="op" id="4151680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4151683">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4151697">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4151776">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4151806">func</span>&nbsp;<span class="ident" id="4151811">parseT61String</span><span class="op" id="4151825">(</span><span class="ident" id="4151826">bytes</span>&nbsp;<span class="op" id="4151832">[</span><span class="op" id="4151833">]</span><span class="builtintype" id="4151834">byte</span><span class="op" id="4151838">)</span>&nbsp;<span class="op" id="4151840">(</span><span class="ident" id="4151841">ret</span>&nbsp;<span class="builtintype" id="4151845">string</span><span class="op" id="4151851">,</span>&nbsp;<span class="ident" id="4151853">err</span>&nbsp;<span class="builtintype" id="4151857">error</span><span class="op" id="4151862">)</span>&nbsp;<span class="op" id="4151864">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151867">return</span>&nbsp;<span class="builtintype" id="4151874">string</span><span class="op" id="4151880">(</span><span class="ident" id="4151881"><a href="/encoding/asn1/asn1.go.html#4151826">bytes</a></span><span class="op" id="4151886">)</span><span class="op" id="4151887">,</span>&nbsp;<span class="ident" id="4151889">nil</span><br>
<span class="lineno"></span><span class="op" id="4151893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4151896">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4151911">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4151988">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4152013">func</span>&nbsp;<span class="ident" id="4152018">parseUTF8String</span><span class="op" id="4152033">(</span><span class="ident" id="4152034">bytes</span>&nbsp;<span class="op" id="4152040">[</span><span class="op" id="4152041">]</span><span class="builtintype" id="4152042">byte</span><span class="op" id="4152046">)</span>&nbsp;<span class="op" id="4152048">(</span><span class="ident" id="4152049">ret</span>&nbsp;<span class="builtintype" id="4152053">string</span><span class="op" id="4152059">,</span>&nbsp;<span class="ident" id="4152061">err</span>&nbsp;<span class="builtintype" id="4152065">error</span><span class="op" id="4152070">)</span>&nbsp;<span class="op" id="4152072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152075">return</span>&nbsp;<span class="builtintype" id="4152082">string</span><span class="op" id="4152088">(</span><span class="ident" id="4152089"><a href="/encoding/asn1/asn1.go.html#4152034">bytes</a></span><span class="op" id="4152094">)</span><span class="op" id="4152095">,</span>&nbsp;<span class="ident" id="4152097">nil</span><br>
<span class="lineno"></span><span class="op" id="4152101">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4152104">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4152156">type</span>&nbsp;<span class="ident" id="4152161">RawValue</span>&nbsp;<span class="keyword" id="4152170">struct</span>&nbsp;<span class="op" id="4152177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152180">Class</span><span class="op" id="4152185">,</span>&nbsp;<span class="ident" id="4152187">Tag</span>&nbsp;<span class="builtintype" id="4152191">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152196">IsCompound</span>&nbsp;<span class="builtintype" id="4152207">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152213">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4152224">[</span><span class="op" id="4152225">]</span><span class="builtintype" id="4152226">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152232">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4152243">[</span><span class="op" id="4152244">]</span><span class="builtintype" id="4152245">byte</span>&nbsp;<span class="comment" id="4152250">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4152281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4152284">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4152357">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4152435">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4152510">type</span>&nbsp;<span class="ident" id="4152515">RawContent</span>&nbsp;<span class="op" id="4152526">[</span><span class="op" id="4152527">]</span><span class="builtintype" id="4152528">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4152534">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4152546">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4152625">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4152702">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4152778">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4152851">func</span>&nbsp;<span class="ident" id="4152856">parseTagAndLength</span><span class="op" id="4152873">(</span><span class="ident" id="4152874">bytes</span>&nbsp;<span class="op" id="4152880">[</span><span class="op" id="4152881">]</span><span class="builtintype" id="4152882">byte</span><span class="op" id="4152886">,</span>&nbsp;<span class="ident" id="4152888">initOffset</span>&nbsp;<span class="builtintype" id="4152899">int</span><span class="op" id="4152902">)</span>&nbsp;<span class="op" id="4152904">(</span><span class="ident" id="4152905">ret</span>&nbsp;<span class="ident" id="4152909"><a href="/encoding/asn1/common.go.html#4169532">tagAndLength</a></span><span class="op" id="4152921">,</span>&nbsp;<span class="ident" id="4152923">offset</span>&nbsp;<span class="builtintype" id="4152930">int</span><span class="op" id="4152933">,</span>&nbsp;<span class="ident" id="4152935">err</span>&nbsp;<span class="builtintype" id="4152939">error</span><span class="op" id="4152944">)</span>&nbsp;<span class="op" id="4152946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152949"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span>&nbsp;<span class="op" id="4152956">=</span>&nbsp;<span class="ident" id="4152958"><a href="/encoding/asn1/asn1.go.html#4152888">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152970">b</span>&nbsp;<span class="op" id="4152972">:=</span>&nbsp;<span class="ident" id="4152975"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4152980">[</span><span class="ident" id="4152981"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4152987">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152990"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4152996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153000"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153003">.</span><span class="ident" id="4153004">class</span>&nbsp;<span class="op" id="4153010">=</span>&nbsp;<span class="builtintype" id="4153012">int</span><span class="op" id="4153015">(</span><span class="ident" id="4153016"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153018">&gt;&gt;</span>&nbsp;<span class="num" id="4153021">6</span><span class="op" id="4153022">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153025"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153028">.</span><span class="ident" id="4153029">isCompound</span>&nbsp;<span class="op" id="4153040">=</span>&nbsp;<span class="ident" id="4153042"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span><span class="op" id="4153043">&amp;</span><span class="num" id="4153044">0x20</span>&nbsp;<span class="op" id="4153049">==</span>&nbsp;<span class="num" id="4153052">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153058"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153061">.</span><span class="ident" id="4153062">tag</span>&nbsp;<span class="op" id="4153066">=</span>&nbsp;<span class="builtintype" id="4153068">int</span><span class="op" id="4153071">(</span><span class="ident" id="4153072"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153074">&amp;</span>&nbsp;<span class="num" id="4153076">0x1f</span><span class="op" id="4153080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153084">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153162">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153185">if</span>&nbsp;<span class="ident" id="4153188"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153191">.</span><span class="ident" id="4153192">tag</span>&nbsp;<span class="op" id="4153196">==</span>&nbsp;<span class="num" id="4153199">0x1f</span>&nbsp;<span class="op" id="4153204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153208"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153211">.</span><span class="ident" id="4153212">tag</span><span class="op" id="4153215">,</span>&nbsp;<span class="ident" id="4153217"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153223">,</span>&nbsp;<span class="ident" id="4153225"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153229">=</span>&nbsp;<span class="ident" id="4153231"><a href="/encoding/asn1/asn1.go.html#4149465">parseBase128Int</a></span><span class="op" id="4153246">(</span><span class="ident" id="4153247"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4153252">,</span>&nbsp;<span class="ident" id="4153254"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153264">if</span>&nbsp;<span class="ident" id="4153267"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153271">!=</span>&nbsp;<span class="ident" id="4153274">nil</span>&nbsp;<span class="op" id="4153278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153283">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153292">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153298">if</span>&nbsp;<span class="ident" id="4153301"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span>&nbsp;<span class="op" id="4153308">&gt;=</span>&nbsp;<span class="builtinfunc" id="4153311">len</span><span class="op" id="4153314">(</span><span class="ident" id="4153315"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4153320">)</span>&nbsp;<span class="op" id="4153322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153326"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153330">=</span>&nbsp;<span class="ident" id="4153332"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4153343">{</span><span class="string" id="4153344">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4153369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153381">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153384"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153386">=</span>&nbsp;<span class="ident" id="4153388"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4153393">[</span><span class="ident" id="4153394"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153403"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153409">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153413">if</span>&nbsp;<span class="ident" id="4153416"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span><span class="op" id="4153417">&amp;</span><span class="num" id="4153418">0x80</span>&nbsp;<span class="op" id="4153423">==</span>&nbsp;<span class="num" id="4153426">0</span>&nbsp;<span class="op" id="4153428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153432">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153481"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153484">.</span><span class="ident" id="4153485">length</span>&nbsp;<span class="op" id="4153492">=</span>&nbsp;<span class="builtintype" id="4153494">int</span><span class="op" id="4153497">(</span><span class="ident" id="4153498"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153500">&amp;</span>&nbsp;<span class="num" id="4153502">0x7f</span><span class="op" id="4153506">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153509">}</span>&nbsp;<span class="keyword" id="4153511">else</span>&nbsp;<span class="op" id="4153516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153520">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153582">numBytes</span>&nbsp;<span class="op" id="4153591">:=</span>&nbsp;<span class="builtintype" id="4153594">int</span><span class="op" id="4153597">(</span><span class="ident" id="4153598"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153600">&amp;</span>&nbsp;<span class="num" id="4153602">0x7f</span><span class="op" id="4153606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153610">if</span>&nbsp;<span class="ident" id="4153613"><a href="/encoding/asn1/asn1.go.html#4153582">numBytes</a></span>&nbsp;<span class="op" id="4153622">==</span>&nbsp;<span class="num" id="4153625">0</span>&nbsp;<span class="op" id="4153627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153632"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153636">=</span>&nbsp;<span class="ident" id="4153638"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4153649">{</span><span class="string" id="4153650">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4153685">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153703"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153706">.</span><span class="ident" id="4153707">length</span>&nbsp;<span class="op" id="4153714">=</span>&nbsp;<span class="num" id="4153716">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153720">for</span>&nbsp;<span class="ident" id="4153724">i</span>&nbsp;<span class="op" id="4153726">:=</span>&nbsp;<span class="num" id="4153729">0</span><span class="op" id="4153730">;</span>&nbsp;<span class="ident" id="4153732"><a href="/encoding/asn1/asn1.go.html#4153724">i</a></span>&nbsp;<span class="op" id="4153734">&lt;</span>&nbsp;<span class="ident" id="4153736"><a href="/encoding/asn1/asn1.go.html#4153582">numBytes</a></span><span class="op" id="4153744">;</span>&nbsp;<span class="ident" id="4153746"><a href="/encoding/asn1/asn1.go.html#4153724">i</a></span><span class="op" id="4153747">++</span>&nbsp;<span class="op" id="4153750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153755">if</span>&nbsp;<span class="ident" id="4153758"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span>&nbsp;<span class="op" id="4153765">&gt;=</span>&nbsp;<span class="builtinfunc" id="4153768">len</span><span class="op" id="4153771">(</span><span class="ident" id="4153772"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4153777">)</span>&nbsp;<span class="op" id="4153779">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153785"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153789">=</span>&nbsp;<span class="ident" id="4153791"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4153802">{</span><span class="string" id="4153803">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4153828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153834">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153849"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span>&nbsp;<span class="op" id="4153851">=</span>&nbsp;<span class="ident" id="4153853"><a href="/encoding/asn1/asn1.go.html#4152874">bytes</a></span><span class="op" id="4153858">[</span><span class="ident" id="4153859"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153865">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153870"><a href="/encoding/asn1/asn1.go.html#4152923">offset</a></span><span class="op" id="4153876">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153882">if</span>&nbsp;<span class="ident" id="4153885"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4153888">.</span><span class="ident" id="4153889">length</span>&nbsp;<span class="op" id="4153896">&gt;=</span>&nbsp;<span class="num" id="4153899">1</span><span class="op" id="4153900">&lt;&lt;</span><span class="num" id="4153902">23</span>&nbsp;<span class="op" id="4153905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153911">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4153955">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153975"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4153979">=</span>&nbsp;<span class="ident" id="4153981"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4153996">{</span><span class="string" id="4153997">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4154015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154021">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154036"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4154039">.</span><span class="ident" id="4154040">length</span>&nbsp;<span class="op" id="4154047">&lt;&lt;=</span>&nbsp;<span class="num" id="4154051">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154056"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4154059">.</span><span class="ident" id="4154060">length</span>&nbsp;<span class="op" id="4154067">|=</span>&nbsp;<span class="builtintype" id="4154070">int</span><span class="op" id="4154073">(</span><span class="ident" id="4154074"><a href="/encoding/asn1/asn1.go.html#4152970">b</a></span><span class="op" id="4154075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154080">if</span>&nbsp;<span class="ident" id="4154083"><a href="/encoding/asn1/asn1.go.html#4152905">ret</a></span><span class="op" id="4154086">.</span><span class="ident" id="4154087">length</span>&nbsp;<span class="op" id="4154094">==</span>&nbsp;<span class="num" id="4154097">0</span>&nbsp;<span class="op" id="4154099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154105">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154150"><a href="/encoding/asn1/asn1.go.html#4152935">err</a></span>&nbsp;<span class="op" id="4154154">=</span>&nbsp;<span class="ident" id="4154156"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4154171">{</span><span class="string" id="4154172">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4154209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154215">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154232">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154236">return</span><br>
<span class="lineno"></span><span class="op" id="4154243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4154246">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4154326">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4154402">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4154443">func</span>&nbsp;<span class="ident" id="4154448">parseSequenceOf</span><span class="op" id="4154463">(</span><span class="ident" id="4154464">bytes</span>&nbsp;<span class="op" id="4154470">[</span><span class="op" id="4154471">]</span><span class="builtintype" id="4154472">byte</span><span class="op" id="4154476">,</span>&nbsp;<span class="ident" id="4154478">sliceType</span>&nbsp;<span class="ident" id="4154488"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4154495">.</span><span class="ident" id="4154496">Type</span><span class="op" id="4154500">,</span>&nbsp;<span class="ident" id="4154502">elemType</span>&nbsp;<span class="ident" id="4154511"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4154518">.</span><span class="ident" id="4154519">Type</span><span class="op" id="4154523">)</span>&nbsp;<span class="op" id="4154525">(</span><span class="ident" id="4154526">ret</span>&nbsp;<span class="ident" id="4154530"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4154537">.</span><span class="ident" id="4154538">Value</span><span class="op" id="4154543">,</span>&nbsp;<span class="ident" id="4154545">err</span>&nbsp;<span class="builtintype" id="4154549">error</span><span class="op" id="4154554">)</span>&nbsp;<span class="op" id="4154556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154559">expectedTag</span><span class="op" id="4154570">,</span>&nbsp;<span class="ident" id="4154572">compoundType</span><span class="op" id="4154584">,</span>&nbsp;<span class="ident" id="4154586">ok</span>&nbsp;<span class="op" id="4154589">:=</span>&nbsp;<span class="ident" id="4154592"><a href="/encoding/asn1/common.go.html#4172493">getUniversalType</a></span><span class="op" id="4154608">(</span><span class="ident" id="4154609"><a href="/encoding/asn1/asn1.go.html#4154502">elemType</a></span><span class="op" id="4154617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154620">if</span>&nbsp;<span class="op" id="4154623">!</span><span class="ident" id="4154624"><a href="/encoding/asn1/asn1.go.html#4154586">ok</a></span>&nbsp;<span class="op" id="4154627">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154631"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4154635">=</span>&nbsp;<span class="ident" id="4154637"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4154652">{</span><span class="string" id="4154653">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4154680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154684">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154696">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4154766">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154820">numElements</span>&nbsp;<span class="op" id="4154832">:=</span>&nbsp;<span class="num" id="4154835">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154838">for</span>&nbsp;<span class="ident" id="4154842">offset</span>&nbsp;<span class="op" id="4154849">:=</span>&nbsp;<span class="num" id="4154852">0</span><span class="op" id="4154853">;</span>&nbsp;<span class="ident" id="4154855"><a href="/encoding/asn1/asn1.go.html#4154842">offset</a></span>&nbsp;<span class="op" id="4154862">&lt;</span>&nbsp;<span class="builtinfunc" id="4154864">len</span><span class="op" id="4154867">(</span><span class="ident" id="4154868"><a href="/encoding/asn1/asn1.go.html#4154464">bytes</a></span><span class="op" id="4154873">)</span><span class="op" id="4154874">;</span>&nbsp;<span class="op" id="4154876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154880">var</span>&nbsp;<span class="ident" id="4154884">t</span>&nbsp;<span class="ident" id="4154886"><a href="/encoding/asn1/common.go.html#4169532">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154901"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4154902">,</span>&nbsp;<span class="ident" id="4154904"><a href="/encoding/asn1/asn1.go.html#4154842">offset</a></span><span class="op" id="4154910">,</span>&nbsp;<span class="ident" id="4154912"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4154916">=</span>&nbsp;<span class="ident" id="4154918"><a href="/encoding/asn1/asn1.go.html#4152856">parseTagAndLength</a></span><span class="op" id="4154935">(</span><span class="ident" id="4154936"><a href="/encoding/asn1/asn1.go.html#4154464">bytes</a></span><span class="op" id="4154941">,</span>&nbsp;<span class="ident" id="4154943"><a href="/encoding/asn1/asn1.go.html#4154842">offset</a></span><span class="op" id="4154949">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154953">if</span>&nbsp;<span class="ident" id="4154956"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4154960">!=</span>&nbsp;<span class="ident" id="4154963">nil</span>&nbsp;<span class="op" id="4154967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154972">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154985">switch</span>&nbsp;<span class="ident" id="4154992"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4154993">.</span><span class="ident" id="4154994">tag</span>&nbsp;<span class="op" id="4154998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155002">case</span>&nbsp;<span class="ident" id="4155007"><a href="/encoding/asn1/common.go.html#4169310">tagIA5String</a></span><span class="op" id="4155019">,</span>&nbsp;<span class="ident" id="4155021"><a href="/encoding/asn1/common.go.html#4169385">tagGeneralString</a></span><span class="op" id="4155037">,</span>&nbsp;<span class="ident" id="4155039"><a href="/encoding/asn1/common.go.html#4169285">tagT61String</a></span><span class="op" id="4155051">,</span>&nbsp;<span class="ident" id="4155053"><a href="/encoding/asn1/common.go.html#4169185">tagUTF8String</a></span><span class="op" id="4155066">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4155071">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4155124">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4155182">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155212"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155213">.</span><span class="ident" id="4155214">tag</span>&nbsp;<span class="op" id="4155218">=</span>&nbsp;<span class="ident" id="4155220"><a href="/encoding/asn1/common.go.html#4169260">tagPrintableString</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155241">case</span>&nbsp;<span class="ident" id="4155246"><a href="/encoding/asn1/common.go.html#4169360">tagGeneralizedTime</a></span><span class="op" id="4155264">,</span>&nbsp;<span class="ident" id="4155266"><a href="/encoding/asn1/common.go.html#4169335">tagUTCTime</a></span><span class="op" id="4155276">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4155281">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155335"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155336">.</span><span class="ident" id="4155337">tag</span>&nbsp;<span class="op" id="4155341">=</span>&nbsp;<span class="ident" id="4155343"><a href="/encoding/asn1/common.go.html#4169335">tagUTCTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155361">if</span>&nbsp;<span class="ident" id="4155364"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155365">.</span><span class="ident" id="4155366">class</span>&nbsp;<span class="op" id="4155372">!=</span>&nbsp;<span class="ident" id="4155375"><a href="/encoding/asn1/common.go.html#4169421">classUniversal</a></span>&nbsp;<span class="op" id="4155390">||</span>&nbsp;<span class="ident" id="4155393"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155394">.</span><span class="ident" id="4155395">isCompound</span>&nbsp;<span class="op" id="4155406">!=</span>&nbsp;<span class="ident" id="4155409"><a href="/encoding/asn1/asn1.go.html#4154572">compoundType</a></span>&nbsp;<span class="op" id="4155422">||</span>&nbsp;<span class="ident" id="4155425"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155426">.</span><span class="ident" id="4155427">tag</span>&nbsp;<span class="op" id="4155431">!=</span>&nbsp;<span class="ident" id="4155434"><a href="/encoding/asn1/asn1.go.html#4154559">expectedTag</a></span>&nbsp;<span class="op" id="4155446">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155451"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4155455">=</span>&nbsp;<span class="ident" id="4155457"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4155472">{</span><span class="string" id="4155473">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4155496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155501">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155514">if</span>&nbsp;<span class="ident" id="4155517"><a href="/encoding/asn1/asn1.go.html#4156456">invalidLength</a></span><span class="op" id="4155530">(</span><span class="ident" id="4155531"><a href="/encoding/asn1/asn1.go.html#4154842">offset</a></span><span class="op" id="4155537">,</span>&nbsp;<span class="ident" id="4155539"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155540">.</span><span class="ident" id="4155541">length</span><span class="op" id="4155547">,</span>&nbsp;<span class="builtinfunc" id="4155549">len</span><span class="op" id="4155552">(</span><span class="ident" id="4155553"><a href="/encoding/asn1/asn1.go.html#4154464">bytes</a></span><span class="op" id="4155558">)</span><span class="op" id="4155559">)</span>&nbsp;<span class="op" id="4155561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155566"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4155570">=</span>&nbsp;<span class="ident" id="4155572"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4155583">{</span><span class="string" id="4155584">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4155604">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155609">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155622"><a href="/encoding/asn1/asn1.go.html#4154842">offset</a></span>&nbsp;<span class="op" id="4155629">+=</span>&nbsp;<span class="ident" id="4155632"><a href="/encoding/asn1/asn1.go.html#4154884">t</a></span><span class="op" id="4155633">.</span><span class="ident" id="4155634">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155643"><a href="/encoding/asn1/asn1.go.html#4154820">numElements</a></span><span class="op" id="4155654">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155658">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155661"><a href="/encoding/asn1/asn1.go.html#4154526">ret</a></span>&nbsp;<span class="op" id="4155665">=</span>&nbsp;<span class="ident" id="4155667"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4155674">.</span><span class="ident" id="4155675">MakeSlice</span><span class="op" id="4155684">(</span><span class="ident" id="4155685"><a href="/encoding/asn1/asn1.go.html#4154478">sliceType</a></span><span class="op" id="4155694">,</span>&nbsp;<span class="ident" id="4155696"><a href="/encoding/asn1/asn1.go.html#4154820">numElements</a></span><span class="op" id="4155707">,</span>&nbsp;<span class="ident" id="4155709"><a href="/encoding/asn1/asn1.go.html#4154820">numElements</a></span><span class="op" id="4155720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155723">params</span>&nbsp;<span class="op" id="4155730">:=</span>&nbsp;<span class="ident" id="4155733"><a href="/encoding/asn1/common.go.html#4170591">fieldParameters</a></span><span class="op" id="4155748">{</span><span class="op" id="4155749">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155752">offset</span>&nbsp;<span class="op" id="4155759">:=</span>&nbsp;<span class="num" id="4155762">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155765">for</span>&nbsp;<span class="ident" id="4155769">i</span>&nbsp;<span class="op" id="4155771">:=</span>&nbsp;<span class="num" id="4155774">0</span><span class="op" id="4155775">;</span>&nbsp;<span class="ident" id="4155777"><a href="/encoding/asn1/asn1.go.html#4155769">i</a></span>&nbsp;<span class="op" id="4155779">&lt;</span>&nbsp;<span class="ident" id="4155781"><a href="/encoding/asn1/asn1.go.html#4154820">numElements</a></span><span class="op" id="4155792">;</span>&nbsp;<span class="ident" id="4155794"><a href="/encoding/asn1/asn1.go.html#4155769">i</a></span><span class="op" id="4155795">++</span>&nbsp;<span class="op" id="4155798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155802"><a href="/encoding/asn1/asn1.go.html#4155752">offset</a></span><span class="op" id="4155808">,</span>&nbsp;<span class="ident" id="4155810"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4155814">=</span>&nbsp;<span class="ident" id="4155816"><a href="/encoding/asn1/asn1.go.html#4156760">parseField</a></span><span class="op" id="4155826">(</span><span class="ident" id="4155827"><a href="/encoding/asn1/asn1.go.html#4154526">ret</a></span><span class="op" id="4155830">.</span><span class="ident" id="4155831">Index</span><span class="op" id="4155836">(</span><span class="ident" id="4155837"><a href="/encoding/asn1/asn1.go.html#4155769">i</a></span><span class="op" id="4155838">)</span><span class="op" id="4155839">,</span>&nbsp;<span class="ident" id="4155841"><a href="/encoding/asn1/asn1.go.html#4154464">bytes</a></span><span class="op" id="4155846">,</span>&nbsp;<span class="ident" id="4155848"><a href="/encoding/asn1/asn1.go.html#4155752">offset</a></span><span class="op" id="4155854">,</span>&nbsp;<span class="ident" id="4155856"><a href="/encoding/asn1/asn1.go.html#4155723">params</a></span><span class="op" id="4155862">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155866">if</span>&nbsp;<span class="ident" id="4155869"><a href="/encoding/asn1/asn1.go.html#4154545">err</a></span>&nbsp;<span class="op" id="4155873">!=</span>&nbsp;<span class="ident" id="4155876">nil</span>&nbsp;<span class="op" id="4155880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155885">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155900">return</span><br>
<span class="lineno">500</span><span class="op" id="4155907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4155910">var</span>&nbsp;<span class="op" id="4155914">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155917">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4155938">=</span>&nbsp;<span class="ident" id="4155940"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4155947">.</span><span class="ident" id="4155948">TypeOf</span><span class="op" id="4155954">(</span><span class="ident" id="4155955"><a href="/encoding/asn1/asn1.go.html#4146221">BitString</a></span><span class="op" id="4155964">{</span><span class="op" id="4155965">}</span><span class="op" id="4155966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155969">objectIdentifierType</span>&nbsp;<span class="op" id="4155990">=</span>&nbsp;<span class="ident" id="4155992"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4155999">.</span><span class="ident" id="4156000">TypeOf</span><span class="op" id="4156006">(</span><span class="ident" id="4156007"><a href="/encoding/asn1/asn1.go.html#4147620">ObjectIdentifier</a></span><span class="op" id="4156023">{</span><span class="op" id="4156024">}</span><span class="op" id="4156025">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156028">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156049">=</span>&nbsp;<span class="ident" id="4156051"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156058">.</span><span class="ident" id="4156059">TypeOf</span><span class="op" id="4156065">(</span><span class="ident" id="4156066"><a href="/encoding/asn1/asn1.go.html#4149221">Enumerated</a></span><span class="op" id="4156076">(</span><span class="num" id="4156077">0</span><span class="op" id="4156078">)</span><span class="op" id="4156079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156082">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156103">=</span>&nbsp;<span class="ident" id="4156105"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156112">.</span><span class="ident" id="4156113">TypeOf</span><span class="op" id="4156119">(</span><span class="ident" id="4156120"><a href="/encoding/asn1/asn1.go.html#4149309">Flag</a></span><span class="op" id="4156124">(</span><span class="builtintype" id="4156125">false</span><span class="op" id="4156130">)</span><span class="op" id="4156131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156134">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156155">=</span>&nbsp;<span class="ident" id="4156157"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156164">.</span><span class="ident" id="4156165">TypeOf</span><span class="op" id="4156171">(</span><span class="ident" id="4156172"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4156176">.</span><span class="ident" id="4156177">Time</span><span class="op" id="4156181">{</span><span class="op" id="4156182">}</span><span class="op" id="4156183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156186">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156207">=</span>&nbsp;<span class="ident" id="4156209"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156216">.</span><span class="ident" id="4156217">TypeOf</span><span class="op" id="4156223">(</span><span class="ident" id="4156224"><a href="/encoding/asn1/asn1.go.html#4152161">RawValue</a></span><span class="op" id="4156232">{</span><span class="op" id="4156233">}</span><span class="op" id="4156234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156237">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156258">=</span>&nbsp;<span class="ident" id="4156260"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156267">.</span><span class="ident" id="4156268">TypeOf</span><span class="op" id="4156274">(</span><span class="ident" id="4156275"><a href="/encoding/asn1/asn1.go.html#4152515">RawContent</a></span><span class="op" id="4156285">(</span><span class="ident" id="4156286">nil</span><span class="op" id="4156289">)</span><span class="op" id="4156290">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156293">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156314">=</span>&nbsp;<span class="ident" id="4156316"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156323">.</span><span class="ident" id="4156324">TypeOf</span><span class="op" id="4156330">(</span><span class="builtinfunc" id="4156331">new</span><span class="op" id="4156334">(</span><span class="ident" id="4156335"><a href="/encoding/asn1/asn1.go.html#4143662">big</a></span><span class="op" id="4156338">.</span><span class="ident" id="4156339">Int</span><span class="op" id="4156342">)</span><span class="op" id="4156343">)</span><br>
<span class="lineno"></span><span class="op" id="4156345">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4156348">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4156423">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4156451">func</span>&nbsp;<span class="ident" id="4156456">invalidLength</span><span class="op" id="4156469">(</span><span class="ident" id="4156470">offset</span><span class="op" id="4156476">,</span>&nbsp;<span class="ident" id="4156478">length</span><span class="op" id="4156484">,</span>&nbsp;<span class="ident" id="4156486">sliceLength</span>&nbsp;<span class="builtintype" id="4156498">int</span><span class="op" id="4156501">)</span>&nbsp;<span class="builtintype" id="4156503">bool</span>&nbsp;<span class="op" id="4156508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156511">return</span>&nbsp;<span class="ident" id="4156518"><a href="/encoding/asn1/asn1.go.html#4156470">offset</a></span><span class="op" id="4156524">+</span><span class="ident" id="4156525"><a href="/encoding/asn1/asn1.go.html#4156478">length</a></span>&nbsp;<span class="op" id="4156532">&lt;</span>&nbsp;<span class="ident" id="4156534"><a href="/encoding/asn1/asn1.go.html#4156470">offset</a></span>&nbsp;<span class="op" id="4156541">||</span>&nbsp;<span class="ident" id="4156544"><a href="/encoding/asn1/asn1.go.html#4156470">offset</a></span><span class="op" id="4156550">+</span><span class="ident" id="4156551"><a href="/encoding/asn1/asn1.go.html#4156478">length</a></span>&nbsp;<span class="op" id="4156558">&gt;</span>&nbsp;<span class="ident" id="4156560"><a href="/encoding/asn1/asn1.go.html#4156486">sliceLength</a></span><br>
<span class="lineno"></span><span class="op" id="4156572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4156575">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4156652">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4156732">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4156755">func</span>&nbsp;<span class="ident" id="4156760">parseField</span><span class="op" id="4156770">(</span><span class="ident" id="4156771">v</span>&nbsp;<span class="ident" id="4156773"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4156780">.</span><span class="ident" id="4156781">Value</span><span class="op" id="4156786">,</span>&nbsp;<span class="ident" id="4156788">bytes</span>&nbsp;<span class="op" id="4156794">[</span><span class="op" id="4156795">]</span><span class="builtintype" id="4156796">byte</span><span class="op" id="4156800">,</span>&nbsp;<span class="ident" id="4156802">initOffset</span>&nbsp;<span class="builtintype" id="4156813">int</span><span class="op" id="4156816">,</span>&nbsp;<span class="ident" id="4156818">params</span>&nbsp;<span class="ident" id="4156825"><a href="/encoding/asn1/common.go.html#4170591">fieldParameters</a></span><span class="op" id="4156840">)</span>&nbsp;<span class="op" id="4156842">(</span><span class="ident" id="4156843">offset</span>&nbsp;<span class="builtintype" id="4156850">int</span><span class="op" id="4156853">,</span>&nbsp;<span class="ident" id="4156855">err</span>&nbsp;<span class="builtintype" id="4156859">error</span><span class="op" id="4156864">)</span>&nbsp;<span class="op" id="4156866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156869"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4156876">=</span>&nbsp;<span class="ident" id="4156878"><a href="/encoding/asn1/asn1.go.html#4156802">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156890">fieldType</span>&nbsp;<span class="op" id="4156900">:=</span>&nbsp;<span class="ident" id="4156903"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4156904">.</span><span class="ident" id="4156905">Type</span><span class="op" id="4156909">(</span><span class="op" id="4156910">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4156914">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157001">if</span>&nbsp;<span class="ident" id="4157004"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4157011">==</span>&nbsp;<span class="builtinfunc" id="4157014">len</span><span class="op" id="4157017">(</span><span class="ident" id="4157018"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157023">)</span>&nbsp;<span class="op" id="4157025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157029">if</span>&nbsp;<span class="op" id="4157032">!</span><span class="ident" id="4157033"><a href="/encoding/asn1/asn1.go.html#4165596">setDefaultValue</a></span><span class="op" id="4157048">(</span><span class="ident" id="4157049"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4157050">,</span>&nbsp;<span class="ident" id="4157052"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4157058">)</span>&nbsp;<span class="op" id="4157060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157065"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157069">=</span>&nbsp;<span class="ident" id="4157071"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4157082">{</span><span class="string" id="4157083">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4157103">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157111">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157123">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157149">if</span>&nbsp;<span class="ident" id="4157152"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span>&nbsp;<span class="op" id="4157162">==</span>&nbsp;<span class="ident" id="4157165"><a href="/encoding/asn1/asn1.go.html#4156186">rawValueType</a></span>&nbsp;<span class="op" id="4157178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157182">var</span>&nbsp;<span class="ident" id="4157186">t</span>&nbsp;<span class="ident" id="4157188"><a href="/encoding/asn1/common.go.html#4169532">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157203"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157204">,</span>&nbsp;<span class="ident" id="4157206"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157212">,</span>&nbsp;<span class="ident" id="4157214"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157218">=</span>&nbsp;<span class="ident" id="4157220"><a href="/encoding/asn1/asn1.go.html#4152856">parseTagAndLength</a></span><span class="op" id="4157237">(</span><span class="ident" id="4157238"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157243">,</span>&nbsp;<span class="ident" id="4157245"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157255">if</span>&nbsp;<span class="ident" id="4157258"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157262">!=</span>&nbsp;<span class="ident" id="4157265">nil</span>&nbsp;<span class="op" id="4157269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157274">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157287">if</span>&nbsp;<span class="ident" id="4157290"><a href="/encoding/asn1/asn1.go.html#4156456">invalidLength</a></span><span class="op" id="4157303">(</span><span class="ident" id="4157304"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157310">,</span>&nbsp;<span class="ident" id="4157312"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157313">.</span><span class="ident" id="4157314">length</span><span class="op" id="4157320">,</span>&nbsp;<span class="builtinfunc" id="4157322">len</span><span class="op" id="4157325">(</span><span class="ident" id="4157326"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157331">)</span><span class="op" id="4157332">)</span>&nbsp;<span class="op" id="4157334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157339"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157343">=</span>&nbsp;<span class="ident" id="4157345"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4157356">{</span><span class="string" id="4157357">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4157373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157378">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157387">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157391">result</span>&nbsp;<span class="op" id="4157398">:=</span>&nbsp;<span class="ident" id="4157401"><a href="/encoding/asn1/asn1.go.html#4152161">RawValue</a></span><span class="op" id="4157409">{</span><span class="ident" id="4157410"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157411">.</span><span class="ident" id="4157412">class</span><span class="op" id="4157417">,</span>&nbsp;<span class="ident" id="4157419"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157420">.</span><span class="ident" id="4157421">tag</span><span class="op" id="4157424">,</span>&nbsp;<span class="ident" id="4157426"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157427">.</span><span class="ident" id="4157428">isCompound</span><span class="op" id="4157438">,</span>&nbsp;<span class="ident" id="4157440"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157445">[</span><span class="ident" id="4157446"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4157453">:</span>&nbsp;<span class="ident" id="4157455"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157461">+</span><span class="ident" id="4157462"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157463">.</span><span class="ident" id="4157464">length</span><span class="op" id="4157470">]</span><span class="op" id="4157471">,</span>&nbsp;<span class="ident" id="4157473"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157478">[</span><span class="ident" id="4157479"><a href="/encoding/asn1/asn1.go.html#4156802">initOffset</a></span>&nbsp;<span class="op" id="4157490">:</span>&nbsp;<span class="ident" id="4157492"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157498">+</span><span class="ident" id="4157499"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157500">.</span><span class="ident" id="4157501">length</span><span class="op" id="4157507">]</span><span class="op" id="4157508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157512"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4157519">+=</span>&nbsp;<span class="ident" id="4157522"><a href="/encoding/asn1/asn1.go.html#4157186">t</a></span><span class="op" id="4157523">.</span><span class="ident" id="4157524">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157533"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4157534">.</span><span class="ident" id="4157535">Set</span><span class="op" id="4157538">(</span><span class="ident" id="4157539"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4157546">.</span><span class="ident" id="4157547">ValueOf</span><span class="op" id="4157554">(</span><span class="ident" id="4157555"><a href="/encoding/asn1/asn1.go.html#4157391">result</a></span><span class="op" id="4157561">)</span><span class="op" id="4157562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157566">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157574">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4157578">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157606">if</span>&nbsp;<span class="ident" id="4157609">ifaceType</span>&nbsp;<span class="op" id="4157619">:=</span>&nbsp;<span class="ident" id="4157622"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><span class="op" id="4157631">;</span>&nbsp;<span class="ident" id="4157633"><a href="/encoding/asn1/asn1.go.html#4157609">ifaceType</a></span><span class="op" id="4157642">.</span><span class="ident" id="4157643">Kind</span><span class="op" id="4157647">(</span><span class="op" id="4157648">)</span>&nbsp;<span class="op" id="4157650">==</span>&nbsp;<span class="ident" id="4157653"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4157660">.</span><span class="ident" id="4157661">Interface</span>&nbsp;<span class="op" id="4157671">&amp;&amp;</span>&nbsp;<span class="ident" id="4157674"><a href="/encoding/asn1/asn1.go.html#4157609">ifaceType</a></span><span class="op" id="4157683">.</span><span class="ident" id="4157684">NumMethod</span><span class="op" id="4157693">(</span><span class="op" id="4157694">)</span>&nbsp;<span class="op" id="4157696">==</span>&nbsp;<span class="num" id="4157699">0</span>&nbsp;<span class="op" id="4157701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157705">var</span>&nbsp;<span class="ident" id="4157709">t</span>&nbsp;<span class="ident" id="4157711"><a href="/encoding/asn1/common.go.html#4169532">tagAndLength</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157726"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4157727">,</span>&nbsp;<span class="ident" id="4157729"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157735">,</span>&nbsp;<span class="ident" id="4157737"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157741">=</span>&nbsp;<span class="ident" id="4157743"><a href="/encoding/asn1/asn1.go.html#4152856">parseTagAndLength</a></span><span class="op" id="4157760">(</span><span class="ident" id="4157761"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157766">,</span>&nbsp;<span class="ident" id="4157768"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157774">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157778">if</span>&nbsp;<span class="ident" id="4157781"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157785">!=</span>&nbsp;<span class="ident" id="4157788">nil</span>&nbsp;<span class="op" id="4157792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157797">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157810">if</span>&nbsp;<span class="ident" id="4157813"><a href="/encoding/asn1/asn1.go.html#4156456">invalidLength</a></span><span class="op" id="4157826">(</span><span class="ident" id="4157827"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4157833">,</span>&nbsp;<span class="ident" id="4157835"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4157836">.</span><span class="ident" id="4157837">length</span><span class="op" id="4157843">,</span>&nbsp;<span class="builtinfunc" id="4157845">len</span><span class="op" id="4157848">(</span><span class="ident" id="4157849"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4157854">)</span><span class="op" id="4157855">)</span>&nbsp;<span class="op" id="4157857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157862"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4157866">=</span>&nbsp;<span class="ident" id="4157868"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4157879">{</span><span class="string" id="4157880">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4157896">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157901">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157914">var</span>&nbsp;<span class="ident" id="4157918">result</span>&nbsp;<span class="keyword" id="4157925">interface</span><span class="op" id="4157934">{</span><span class="op" id="4157935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157939">if</span>&nbsp;<span class="op" id="4157942">!</span><span class="ident" id="4157943"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4157944">.</span><span class="ident" id="4157945">isCompound</span>&nbsp;<span class="op" id="4157956">&amp;&amp;</span>&nbsp;<span class="ident" id="4157959"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4157960">.</span><span class="ident" id="4157961">class</span>&nbsp;<span class="op" id="4157967">==</span>&nbsp;<span class="ident" id="4157970"><a href="/encoding/asn1/common.go.html#4169421">classUniversal</a></span>&nbsp;<span class="op" id="4157985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157990">innerBytes</span>&nbsp;<span class="op" id="4158001">:=</span>&nbsp;<span class="ident" id="4158004"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4158009">[</span><span class="ident" id="4158010"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4158017">:</span>&nbsp;<span class="ident" id="4158019"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4158025">+</span><span class="ident" id="4158026"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4158027">.</span><span class="ident" id="4158028">length</span><span class="op" id="4158034">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158039">switch</span>&nbsp;<span class="ident" id="4158046"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4158047">.</span><span class="ident" id="4158048">tag</span>&nbsp;<span class="op" id="4158052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158057">case</span>&nbsp;<span class="ident" id="4158062"><a href="/encoding/asn1/common.go.html#4169260">tagPrintableString</a></span><span class="op" id="4158080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158086"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158092">,</span>&nbsp;<span class="ident" id="4158094"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158098">=</span>&nbsp;<span class="ident" id="4158100"><a href="/encoding/asn1/asn1.go.html#4150629">parsePrintableString</a></span><span class="op" id="4158120">(</span><span class="ident" id="4158121"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158136">case</span>&nbsp;<span class="ident" id="4158141"><a href="/encoding/asn1/common.go.html#4169310">tagIA5String</a></span><span class="op" id="4158153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158159"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158165">,</span>&nbsp;<span class="ident" id="4158167"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158171">=</span>&nbsp;<span class="ident" id="4158173"><a href="/encoding/asn1/asn1.go.html#4151474">parseIA5String</a></span><span class="op" id="4158187">(</span><span class="ident" id="4158188"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158198">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158203">case</span>&nbsp;<span class="ident" id="4158208"><a href="/encoding/asn1/common.go.html#4169285">tagT61String</a></span><span class="op" id="4158220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158226"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158232">,</span>&nbsp;<span class="ident" id="4158234"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158238">=</span>&nbsp;<span class="ident" id="4158240"><a href="/encoding/asn1/asn1.go.html#4151811">parseT61String</a></span><span class="op" id="4158254">(</span><span class="ident" id="4158255"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158270">case</span>&nbsp;<span class="ident" id="4158275"><a href="/encoding/asn1/common.go.html#4169185">tagUTF8String</a></span><span class="op" id="4158288">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158294"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158300">,</span>&nbsp;<span class="ident" id="4158302"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158306">=</span>&nbsp;<span class="ident" id="4158308"><a href="/encoding/asn1/asn1.go.html#4152018">parseUTF8String</a></span><span class="op" id="4158323">(</span><span class="ident" id="4158324"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158339">case</span>&nbsp;<span class="ident" id="4158344"><a href="/encoding/asn1/common.go.html#4169064">tagInteger</a></span><span class="op" id="4158354">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158360"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158366">,</span>&nbsp;<span class="ident" id="4158368"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158372">=</span>&nbsp;<span class="ident" id="4158374"><a href="/encoding/asn1/asn1.go.html#4144772">parseInt64</a></span><span class="op" id="4158384">(</span><span class="ident" id="4158385"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158400">case</span>&nbsp;<span class="ident" id="4158405"><a href="/encoding/asn1/common.go.html#4169088">tagBitString</a></span><span class="op" id="4158417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158423"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158429">,</span>&nbsp;<span class="ident" id="4158431"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158435">=</span>&nbsp;<span class="ident" id="4158437"><a href="/encoding/asn1/asn1.go.html#4147101">parseBitString</a></span><span class="op" id="4158451">(</span><span class="ident" id="4158452"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158467">case</span>&nbsp;<span class="ident" id="4158472"><a href="/encoding/asn1/common.go.html#4169136">tagOID</a></span><span class="op" id="4158478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158484"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158490">,</span>&nbsp;<span class="ident" id="4158492"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158496">=</span>&nbsp;<span class="ident" id="4158498"><a href="/encoding/asn1/asn1.go.html#4148271">parseObjectIdentifier</a></span><span class="op" id="4158519">(</span><span class="ident" id="4158520"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158530">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158535">case</span>&nbsp;<span class="ident" id="4158540"><a href="/encoding/asn1/common.go.html#4169335">tagUTCTime</a></span><span class="op" id="4158550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158556"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158562">,</span>&nbsp;<span class="ident" id="4158564"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158568">=</span>&nbsp;<span class="ident" id="4158570"><a href="/encoding/asn1/asn1.go.html#4149883">parseUTCTime</a></span><span class="op" id="4158582">(</span><span class="ident" id="4158583"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><span class="op" id="4158593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158598">case</span>&nbsp;<span class="ident" id="4158603"><a href="/encoding/asn1/common.go.html#4169112">tagOctetString</a></span><span class="op" id="4158617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158623"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span>&nbsp;<span class="op" id="4158630">=</span>&nbsp;<span class="ident" id="4158632"><a href="/encoding/asn1/asn1.go.html#4157990">innerBytes</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158646">default</span><span class="op" id="4158653">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158659">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158742"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4158749">+=</span>&nbsp;<span class="ident" id="4158752"><a href="/encoding/asn1/asn1.go.html#4157709">t</a></span><span class="op" id="4158753">.</span><span class="ident" id="4158754">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158763">if</span>&nbsp;<span class="ident" id="4158766"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158770">!=</span>&nbsp;<span class="ident" id="4158773">nil</span>&nbsp;<span class="op" id="4158777">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158782">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158795">if</span>&nbsp;<span class="ident" id="4158798"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span>&nbsp;<span class="op" id="4158805">!=</span>&nbsp;<span class="ident" id="4158808">nil</span>&nbsp;<span class="op" id="4158812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158817"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4158818">.</span><span class="ident" id="4158819">Set</span><span class="op" id="4158822">(</span><span class="ident" id="4158823"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4158830">.</span><span class="ident" id="4158831">ValueOf</span><span class="op" id="4158838">(</span><span class="ident" id="4158839"><a href="/encoding/asn1/asn1.go.html#4157918">result</a></span><span class="op" id="4158845">)</span><span class="op" id="4158846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158850">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158854">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158865">universalTag</span><span class="op" id="4158877">,</span>&nbsp;<span class="ident" id="4158879">compoundType</span><span class="op" id="4158891">,</span>&nbsp;<span class="ident" id="4158893">ok1</span>&nbsp;<span class="op" id="4158897">:=</span>&nbsp;<span class="ident" id="4158900"><a href="/encoding/asn1/common.go.html#4172493">getUniversalType</a></span><span class="op" id="4158916">(</span><span class="ident" id="4158917"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><span class="op" id="4158926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158929">if</span>&nbsp;<span class="op" id="4158932">!</span><span class="ident" id="4158933"><a href="/encoding/asn1/asn1.go.html#4158893">ok1</a></span>&nbsp;<span class="op" id="4158937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158941"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4158945">=</span>&nbsp;<span class="ident" id="4158947"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4158962">{</span><span class="ident" id="4158963"><a href="/encoding/asn1/asn1.go.html#4143655">fmt</a></span><span class="op" id="4158966">.</span><span class="ident" id="4158967">Sprintf</span><span class="op" id="4158974">(</span><span class="string" id="4158975">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4158996">,</span>&nbsp;<span class="ident" id="4158998"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><span class="op" id="4159007">)</span><span class="op" id="4159008">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159012">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159024">t</span><span class="op" id="4159025">,</span>&nbsp;<span class="ident" id="4159027"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4159033">,</span>&nbsp;<span class="ident" id="4159035"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159039">:=</span>&nbsp;<span class="ident" id="4159042"><a href="/encoding/asn1/asn1.go.html#4152856">parseTagAndLength</a></span><span class="op" id="4159059">(</span><span class="ident" id="4159060"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4159065">,</span>&nbsp;<span class="ident" id="4159067"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4159073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159076">if</span>&nbsp;<span class="ident" id="4159079"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159083">!=</span>&nbsp;<span class="ident" id="4159086">nil</span>&nbsp;<span class="op" id="4159090">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159094">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159105">if</span>&nbsp;<span class="ident" id="4159108"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4159114">.</span><span class="ident" id="4159115">explicit</span>&nbsp;<span class="op" id="4159124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159128">expectedClass</span>&nbsp;<span class="op" id="4159142">:=</span>&nbsp;<span class="ident" id="4159145"><a href="/encoding/asn1/common.go.html#4169473">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159168">if</span>&nbsp;<span class="ident" id="4159171"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4159177">.</span><span class="ident" id="4159178">application</span>&nbsp;<span class="op" id="4159190">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159195"><a href="/encoding/asn1/asn1.go.html#4159128">expectedClass</a></span>&nbsp;<span class="op" id="4159209">=</span>&nbsp;<span class="ident" id="4159211"><a href="/encoding/asn1/common.go.html#4169447">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159234">if</span>&nbsp;<span class="ident" id="4159237"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159238">.</span><span class="ident" id="4159239">class</span>&nbsp;<span class="op" id="4159245">==</span>&nbsp;<span class="ident" id="4159248"><a href="/encoding/asn1/asn1.go.html#4159128">expectedClass</a></span>&nbsp;<span class="op" id="4159262">&amp;&amp;</span>&nbsp;<span class="ident" id="4159265"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159266">.</span><span class="ident" id="4159267">tag</span>&nbsp;<span class="op" id="4159271">==</span>&nbsp;<span class="op" id="4159274">*</span><span class="ident" id="4159275"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4159281">.</span><span class="ident" id="4159282">tag</span>&nbsp;<span class="op" id="4159286">&amp;&amp;</span>&nbsp;<span class="op" id="4159289">(</span><span class="ident" id="4159290"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159291">.</span><span class="ident" id="4159292">length</span>&nbsp;<span class="op" id="4159299">==</span>&nbsp;<span class="num" id="4159302">0</span>&nbsp;<span class="op" id="4159304">||</span>&nbsp;<span class="ident" id="4159307"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159308">.</span><span class="ident" id="4159309">isCompound</span><span class="op" id="4159319">)</span>&nbsp;<span class="op" id="4159321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159326">if</span>&nbsp;<span class="ident" id="4159329"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159330">.</span><span class="ident" id="4159331">length</span>&nbsp;<span class="op" id="4159338">&gt;</span>&nbsp;<span class="num" id="4159340">0</span>&nbsp;<span class="op" id="4159342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159348"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4159349">,</span>&nbsp;<span class="ident" id="4159351"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4159357">,</span>&nbsp;<span class="ident" id="4159359"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159363">=</span>&nbsp;<span class="ident" id="4159365"><a href="/encoding/asn1/asn1.go.html#4152856">parseTagAndLength</a></span><span class="op" id="4159382">(</span><span class="ident" id="4159383"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4159388">,</span>&nbsp;<span class="ident" id="4159390"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4159396">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159402">if</span>&nbsp;<span class="ident" id="4159405"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159409">!=</span>&nbsp;<span class="ident" id="4159412">nil</span>&nbsp;<span class="op" id="4159416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159423">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159434">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159439">}</span>&nbsp;<span class="keyword" id="4159441">else</span>&nbsp;<span class="op" id="4159446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159452">if</span>&nbsp;<span class="ident" id="4159455"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span>&nbsp;<span class="op" id="4159465">!=</span>&nbsp;<span class="ident" id="4159468"><a href="/encoding/asn1/asn1.go.html#4156082">flagType</a></span>&nbsp;<span class="op" id="4159477">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159484"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159488">=</span>&nbsp;<span class="ident" id="4159490"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4159505">{</span><span class="string" id="4159506">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4159553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159560">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159577"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4159578">.</span><span class="ident" id="4159579">SetBool</span><span class="op" id="4159586">(</span><span class="builtintype" id="4159587">true</span><span class="op" id="4159591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159597">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159611">}</span>&nbsp;<span class="keyword" id="4159613">else</span>&nbsp;<span class="op" id="4159618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4159623">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159685">ok</span>&nbsp;<span class="op" id="4159688">:=</span>&nbsp;<span class="ident" id="4159691"><a href="/encoding/asn1/asn1.go.html#4165596">setDefaultValue</a></span><span class="op" id="4159706">(</span><span class="ident" id="4159707"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4159708">,</span>&nbsp;<span class="ident" id="4159710"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4159716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159721">if</span>&nbsp;<span class="ident" id="4159724"><a href="/encoding/asn1/asn1.go.html#4159685">ok</a></span>&nbsp;<span class="op" id="4159727">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159733"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4159740">=</span>&nbsp;<span class="ident" id="4159742"><a href="/encoding/asn1/asn1.go.html#4156802">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159756">}</span>&nbsp;<span class="keyword" id="4159758">else</span>&nbsp;<span class="op" id="4159763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159769"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4159773">=</span>&nbsp;<span class="ident" id="4159775"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4159790">{</span><span class="string" id="4159791">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4159830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159840">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4159856">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4159927">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4159997">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160068">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160117">if</span>&nbsp;<span class="ident" id="4160120"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160133">==</span>&nbsp;<span class="ident" id="4160136"><a href="/encoding/asn1/common.go.html#4169260">tagPrintableString</a></span>&nbsp;<span class="op" id="4160155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160159">if</span>&nbsp;<span class="ident" id="4160162"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4160163">.</span><span class="ident" id="4160164">class</span>&nbsp;<span class="op" id="4160170">==</span>&nbsp;<span class="ident" id="4160173"><a href="/encoding/asn1/common.go.html#4169421">classUniversal</a></span>&nbsp;<span class="op" id="4160188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160193">switch</span>&nbsp;<span class="ident" id="4160200"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4160201">.</span><span class="ident" id="4160202">tag</span>&nbsp;<span class="op" id="4160206">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160211">case</span>&nbsp;<span class="ident" id="4160216"><a href="/encoding/asn1/common.go.html#4169310">tagIA5String</a></span><span class="op" id="4160228">,</span>&nbsp;<span class="ident" id="4160230"><a href="/encoding/asn1/common.go.html#4169385">tagGeneralString</a></span><span class="op" id="4160246">,</span>&nbsp;<span class="ident" id="4160248"><a href="/encoding/asn1/common.go.html#4169285">tagT61String</a></span><span class="op" id="4160260">,</span>&nbsp;<span class="ident" id="4160262"><a href="/encoding/asn1/common.go.html#4169185">tagUTF8String</a></span><span class="op" id="4160275">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160281"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160294">=</span>&nbsp;<span class="ident" id="4160296"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4160297">.</span><span class="ident" id="4160298">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160309">}</span>&nbsp;<span class="keyword" id="4160311">else</span>&nbsp;<span class="keyword" id="4160316">if</span>&nbsp;<span class="ident" id="4160319"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160325">.</span><span class="ident" id="4160326">stringType</span>&nbsp;<span class="op" id="4160337">!=</span>&nbsp;<span class="num" id="4160340">0</span>&nbsp;<span class="op" id="4160342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160347"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160360">=</span>&nbsp;<span class="ident" id="4160362"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160368">.</span><span class="ident" id="4160369">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160389">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160460">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160483">if</span>&nbsp;<span class="ident" id="4160486"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160499">==</span>&nbsp;<span class="ident" id="4160502"><a href="/encoding/asn1/common.go.html#4169335">tagUTCTime</a></span>&nbsp;<span class="op" id="4160513">&amp;&amp;</span>&nbsp;<span class="ident" id="4160516"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4160517">.</span><span class="ident" id="4160518">tag</span>&nbsp;<span class="op" id="4160522">==</span>&nbsp;<span class="ident" id="4160525"><a href="/encoding/asn1/common.go.html#4169360">tagGeneralizedTime</a></span>&nbsp;<span class="op" id="4160544">&amp;&amp;</span>&nbsp;<span class="ident" id="4160547"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4160548">.</span><span class="ident" id="4160549">class</span>&nbsp;<span class="op" id="4160555">==</span>&nbsp;<span class="ident" id="4160558"><a href="/encoding/asn1/common.go.html#4169421">classUniversal</a></span>&nbsp;<span class="op" id="4160573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160577"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160590">=</span>&nbsp;<span class="ident" id="4160592"><a href="/encoding/asn1/common.go.html#4169360">tagGeneralizedTime</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160616">if</span>&nbsp;<span class="ident" id="4160619"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160625">.</span><span class="ident" id="4160626">set</span>&nbsp;<span class="op" id="4160630">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160634"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4160647">=</span>&nbsp;<span class="ident" id="4160649"><a href="/encoding/asn1/common.go.html#4169235">tagSet</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160661">expectedClass</span>&nbsp;<span class="op" id="4160675">:=</span>&nbsp;<span class="ident" id="4160678"><a href="/encoding/asn1/common.go.html#4169421">classUniversal</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160694">expectedTag</span>&nbsp;<span class="op" id="4160706">:=</span>&nbsp;<span class="ident" id="4160709"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160724">if</span>&nbsp;<span class="op" id="4160727">!</span><span class="ident" id="4160728"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160734">.</span><span class="ident" id="4160735">explicit</span>&nbsp;<span class="op" id="4160744">&amp;&amp;</span>&nbsp;<span class="ident" id="4160747"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160753">.</span><span class="ident" id="4160754">tag</span>&nbsp;<span class="op" id="4160758">!=</span>&nbsp;<span class="ident" id="4160761">nil</span>&nbsp;<span class="op" id="4160765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160769"><a href="/encoding/asn1/asn1.go.html#4160661">expectedClass</a></span>&nbsp;<span class="op" id="4160783">=</span>&nbsp;<span class="ident" id="4160785"><a href="/encoding/asn1/common.go.html#4169473">classContextSpecific</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160808"><a href="/encoding/asn1/asn1.go.html#4160694">expectedTag</a></span>&nbsp;<span class="op" id="4160820">=</span>&nbsp;<span class="op" id="4160822">*</span><span class="ident" id="4160823"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160829">.</span><span class="ident" id="4160830">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160835">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160839">if</span>&nbsp;<span class="op" id="4160842">!</span><span class="ident" id="4160843"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160849">.</span><span class="ident" id="4160850">explicit</span>&nbsp;<span class="op" id="4160859">&amp;&amp;</span>&nbsp;<span class="ident" id="4160862"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160868">.</span><span class="ident" id="4160869">application</span>&nbsp;<span class="op" id="4160881">&amp;&amp;</span>&nbsp;<span class="ident" id="4160884"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160890">.</span><span class="ident" id="4160891">tag</span>&nbsp;<span class="op" id="4160895">!=</span>&nbsp;<span class="ident" id="4160898">nil</span>&nbsp;<span class="op" id="4160902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160906"><a href="/encoding/asn1/asn1.go.html#4160661">expectedClass</a></span>&nbsp;<span class="op" id="4160920">=</span>&nbsp;<span class="ident" id="4160922"><a href="/encoding/asn1/common.go.html#4169447">classApplication</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160941"><a href="/encoding/asn1/asn1.go.html#4160694">expectedTag</a></span>&nbsp;<span class="op" id="4160953">=</span>&nbsp;<span class="op" id="4160955">*</span><span class="ident" id="4160956"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4160962">.</span><span class="ident" id="4160963">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160968">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4160972">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161030">if</span>&nbsp;<span class="ident" id="4161033"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161034">.</span><span class="ident" id="4161035">class</span>&nbsp;<span class="op" id="4161041">!=</span>&nbsp;<span class="ident" id="4161044"><a href="/encoding/asn1/asn1.go.html#4160661">expectedClass</a></span>&nbsp;<span class="op" id="4161058">||</span>&nbsp;<span class="ident" id="4161061"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161062">.</span><span class="ident" id="4161063">tag</span>&nbsp;<span class="op" id="4161067">!=</span>&nbsp;<span class="ident" id="4161070"><a href="/encoding/asn1/asn1.go.html#4160694">expectedTag</a></span>&nbsp;<span class="op" id="4161082">||</span>&nbsp;<span class="ident" id="4161085"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161086">.</span><span class="ident" id="4161087">isCompound</span>&nbsp;<span class="op" id="4161098">!=</span>&nbsp;<span class="ident" id="4161101"><a href="/encoding/asn1/asn1.go.html#4158879">compoundType</a></span>&nbsp;<span class="op" id="4161114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161118">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161181">ok</span>&nbsp;<span class="op" id="4161184">:=</span>&nbsp;<span class="ident" id="4161187"><a href="/encoding/asn1/asn1.go.html#4165596">setDefaultValue</a></span><span class="op" id="4161202">(</span><span class="ident" id="4161203"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4161204">,</span>&nbsp;<span class="ident" id="4161206"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4161212">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161216">if</span>&nbsp;<span class="ident" id="4161219"><a href="/encoding/asn1/asn1.go.html#4161181">ok</a></span>&nbsp;<span class="op" id="4161222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161227"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4161234">=</span>&nbsp;<span class="ident" id="4161236"><a href="/encoding/asn1/asn1.go.html#4156802">initOffset</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161249">}</span>&nbsp;<span class="keyword" id="4161251">else</span>&nbsp;<span class="op" id="4161256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161261"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4161265">=</span>&nbsp;<span class="ident" id="4161267"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4161282">{</span><span class="ident" id="4161283"><a href="/encoding/asn1/asn1.go.html#4143655">fmt</a></span><span class="op" id="4161286">.</span><span class="ident" id="4161287">Sprintf</span><span class="op" id="4161294">(</span><span class="string" id="4161295">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4161336">,</span>&nbsp;<span class="ident" id="4161338"><a href="/encoding/asn1/asn1.go.html#4160694">expectedTag</a></span><span class="op" id="4161349">,</span>&nbsp;<span class="ident" id="4161351"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161352">,</span>&nbsp;<span class="ident" id="4161354"><a href="/encoding/asn1/asn1.go.html#4156818">params</a></span><span class="op" id="4161360">,</span>&nbsp;<span class="ident" id="4161362"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><span class="op" id="4161371">.</span><span class="ident" id="4161372">Name</span><span class="op" id="4161376">(</span><span class="op" id="4161377">)</span><span class="op" id="4161378">,</span>&nbsp;<span class="ident" id="4161380"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4161386">)</span><span class="op" id="4161387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161391">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161395">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161406">if</span>&nbsp;<span class="ident" id="4161409"><a href="/encoding/asn1/asn1.go.html#4156456">invalidLength</a></span><span class="op" id="4161422">(</span><span class="ident" id="4161423"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4161429">,</span>&nbsp;<span class="ident" id="4161431"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161432">.</span><span class="ident" id="4161433">length</span><span class="op" id="4161439">,</span>&nbsp;<span class="builtinfunc" id="4161441">len</span><span class="op" id="4161444">(</span><span class="ident" id="4161445"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4161450">)</span><span class="op" id="4161451">)</span>&nbsp;<span class="op" id="4161453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161457"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4161461">=</span>&nbsp;<span class="ident" id="4161463"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4161474">{</span><span class="string" id="4161475">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4161491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161495">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161506">innerBytes</span>&nbsp;<span class="op" id="4161517">:=</span>&nbsp;<span class="ident" id="4161520"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4161525">[</span><span class="ident" id="4161526"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4161533">:</span>&nbsp;<span class="ident" id="4161535"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4161541">+</span><span class="ident" id="4161542"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161543">.</span><span class="ident" id="4161544">length</span><span class="op" id="4161550">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161553"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span>&nbsp;<span class="op" id="4161560">+=</span>&nbsp;<span class="ident" id="4161563"><a href="/encoding/asn1/asn1.go.html#4159024">t</a></span><span class="op" id="4161564">.</span><span class="ident" id="4161565">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4161574">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161637">switch</span>&nbsp;<span class="ident" id="4161644"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span>&nbsp;<span class="op" id="4161654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161657">case</span>&nbsp;<span class="ident" id="4161662"><a href="/encoding/asn1/asn1.go.html#4155969">objectIdentifierType</a></span><span class="op" id="4161682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161686">newSlice</span><span class="op" id="4161694">,</span>&nbsp;<span class="ident" id="4161696">err1</span>&nbsp;<span class="op" id="4161701">:=</span>&nbsp;<span class="ident" id="4161704"><a href="/encoding/asn1/asn1.go.html#4148271">parseObjectIdentifier</a></span><span class="op" id="4161725">(</span><span class="ident" id="4161726"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4161736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161740"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4161741">.</span><span class="ident" id="4161742">Set</span><span class="op" id="4161745">(</span><span class="ident" id="4161746"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4161753">.</span><span class="ident" id="4161754">MakeSlice</span><span class="op" id="4161763">(</span><span class="ident" id="4161764"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4161765">.</span><span class="ident" id="4161766">Type</span><span class="op" id="4161770">(</span><span class="op" id="4161771">)</span><span class="op" id="4161772">,</span>&nbsp;<span class="builtinfunc" id="4161774">len</span><span class="op" id="4161777">(</span><span class="ident" id="4161778"><a href="/encoding/asn1/asn1.go.html#4161686">newSlice</a></span><span class="op" id="4161786">)</span><span class="op" id="4161787">,</span>&nbsp;<span class="builtinfunc" id="4161789">len</span><span class="op" id="4161792">(</span><span class="ident" id="4161793"><a href="/encoding/asn1/asn1.go.html#4161686">newSlice</a></span><span class="op" id="4161801">)</span><span class="op" id="4161802">)</span><span class="op" id="4161803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161807">if</span>&nbsp;<span class="ident" id="4161810"><a href="/encoding/asn1/asn1.go.html#4161696">err1</a></span>&nbsp;<span class="op" id="4161815">==</span>&nbsp;<span class="ident" id="4161818">nil</span>&nbsp;<span class="op" id="4161822">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161827"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4161834">.</span><span class="ident" id="4161835">Copy</span><span class="op" id="4161839">(</span><span class="ident" id="4161840"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4161841">,</span>&nbsp;<span class="ident" id="4161843"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4161850">.</span><span class="ident" id="4161851">ValueOf</span><span class="op" id="4161858">(</span><span class="ident" id="4161859"><a href="/encoding/asn1/asn1.go.html#4161686">newSlice</a></span><span class="op" id="4161867">)</span><span class="op" id="4161868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161876"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4161880">=</span>&nbsp;<span class="ident" id="4161882"><a href="/encoding/asn1/asn1.go.html#4161696">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161889">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161897">case</span>&nbsp;<span class="ident" id="4161902"><a href="/encoding/asn1/asn1.go.html#4155917">bitStringType</a></span><span class="op" id="4161915">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161919">bs</span><span class="op" id="4161921">,</span>&nbsp;<span class="ident" id="4161923">err1</span>&nbsp;<span class="op" id="4161928">:=</span>&nbsp;<span class="ident" id="4161931"><a href="/encoding/asn1/asn1.go.html#4147101">parseBitString</a></span><span class="op" id="4161945">(</span><span class="ident" id="4161946"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4161956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161960">if</span>&nbsp;<span class="ident" id="4161963"><a href="/encoding/asn1/asn1.go.html#4161923">err1</a></span>&nbsp;<span class="op" id="4161968">==</span>&nbsp;<span class="ident" id="4161971">nil</span>&nbsp;<span class="op" id="4161975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161980"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4161981">.</span><span class="ident" id="4161982">Set</span><span class="op" id="4161985">(</span><span class="ident" id="4161986"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4161993">.</span><span class="ident" id="4161994">ValueOf</span><span class="op" id="4162001">(</span><span class="ident" id="4162002"><a href="/encoding/asn1/asn1.go.html#4161919">bs</a></span><span class="op" id="4162004">)</span><span class="op" id="4162005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162013"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4162017">=</span>&nbsp;<span class="ident" id="4162019"><a href="/encoding/asn1/asn1.go.html#4161923">err1</a></span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162034">case</span>&nbsp;<span class="ident" id="4162039"><a href="/encoding/asn1/asn1.go.html#4156134">timeType</a></span><span class="op" id="4162047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162051">var</span>&nbsp;<span class="ident" id="4162055">time</span>&nbsp;<span class="ident" id="4162060"><a href="/encoding/asn1/asn1.go.html#4143696">time</a></span><span class="op" id="4162064">.</span><span class="ident" id="4162065">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162072">var</span>&nbsp;<span class="ident" id="4162076">err1</span>&nbsp;<span class="builtintype" id="4162081">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162089">if</span>&nbsp;<span class="ident" id="4162092"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4162105">==</span>&nbsp;<span class="ident" id="4162108"><a href="/encoding/asn1/common.go.html#4169335">tagUTCTime</a></span>&nbsp;<span class="op" id="4162119">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162124"><a href="/encoding/asn1/asn1.go.html#4162055">time</a></span><span class="op" id="4162128">,</span>&nbsp;<span class="ident" id="4162130"><a href="/encoding/asn1/asn1.go.html#4162076">err1</a></span>&nbsp;<span class="op" id="4162135">=</span>&nbsp;<span class="ident" id="4162137"><a href="/encoding/asn1/asn1.go.html#4149883">parseUTCTime</a></span><span class="op" id="4162149">(</span><span class="ident" id="4162150"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162164">}</span>&nbsp;<span class="keyword" id="4162166">else</span>&nbsp;<span class="op" id="4162171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162176"><a href="/encoding/asn1/asn1.go.html#4162055">time</a></span><span class="op" id="4162180">,</span>&nbsp;<span class="ident" id="4162182"><a href="/encoding/asn1/asn1.go.html#4162076">err1</a></span>&nbsp;<span class="op" id="4162187">=</span>&nbsp;<span class="ident" id="4162189"><a href="/encoding/asn1/asn1.go.html#4150380">parseGeneralizedTime</a></span><span class="op" id="4162209">(</span><span class="ident" id="4162210"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162228">if</span>&nbsp;<span class="ident" id="4162231"><a href="/encoding/asn1/asn1.go.html#4162076">err1</a></span>&nbsp;<span class="op" id="4162236">==</span>&nbsp;<span class="ident" id="4162239">nil</span>&nbsp;<span class="op" id="4162243">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162248"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4162249">.</span><span class="ident" id="4162250">Set</span><span class="op" id="4162253">(</span><span class="ident" id="4162254"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162261">.</span><span class="ident" id="4162262">ValueOf</span><span class="op" id="4162269">(</span><span class="ident" id="4162270"><a href="/encoding/asn1/asn1.go.html#4162055">time</a></span><span class="op" id="4162274">)</span><span class="op" id="4162275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162283"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4162287">=</span>&nbsp;<span class="ident" id="4162289"><a href="/encoding/asn1/asn1.go.html#4162076">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162296">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162304">case</span>&nbsp;<span class="ident" id="4162309"><a href="/encoding/asn1/asn1.go.html#4156028">enumeratedType</a></span><span class="op" id="4162323">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162327">parsedInt</span><span class="op" id="4162336">,</span>&nbsp;<span class="ident" id="4162338">err1</span>&nbsp;<span class="op" id="4162343">:=</span>&nbsp;<span class="ident" id="4162346"><a href="/encoding/asn1/asn1.go.html#4145287">parseInt32</a></span><span class="op" id="4162356">(</span><span class="ident" id="4162357"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162371">if</span>&nbsp;<span class="ident" id="4162374"><a href="/encoding/asn1/asn1.go.html#4162338">err1</a></span>&nbsp;<span class="op" id="4162379">==</span>&nbsp;<span class="ident" id="4162382">nil</span>&nbsp;<span class="op" id="4162386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162391"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4162392">.</span><span class="ident" id="4162393">SetInt</span><span class="op" id="4162399">(</span><span class="ident" id="4162400">int64</span><span class="op" id="4162405">(</span><span class="ident" id="4162406"><a href="/encoding/asn1/asn1.go.html#4162327">parsedInt</a></span><span class="op" id="4162415">)</span><span class="op" id="4162416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162424"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4162428">=</span>&nbsp;<span class="ident" id="4162430"><a href="/encoding/asn1/asn1.go.html#4162338">err1</a></span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162437">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162445">case</span>&nbsp;<span class="ident" id="4162450"><a href="/encoding/asn1/asn1.go.html#4156082">flagType</a></span><span class="op" id="4162458">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162462"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4162463">.</span><span class="ident" id="4162464">SetBool</span><span class="op" id="4162471">(</span><span class="builtintype" id="4162472">true</span><span class="op" id="4162476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162480">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162488">case</span>&nbsp;<span class="ident" id="4162493"><a href="/encoding/asn1/asn1.go.html#4156293">bigIntType</a></span><span class="op" id="4162503">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162507">parsedInt</span>&nbsp;<span class="op" id="4162517">:=</span>&nbsp;<span class="ident" id="4162520"><a href="/encoding/asn1/asn1.go.html#4145644">parseBigInt</a></span><span class="op" id="4162531">(</span><span class="ident" id="4162532"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162546"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4162547">.</span><span class="ident" id="4162548">Set</span><span class="op" id="4162551">(</span><span class="ident" id="4162552"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162559">.</span><span class="ident" id="4162560">ValueOf</span><span class="op" id="4162567">(</span><span class="ident" id="4162568"><a href="/encoding/asn1/asn1.go.html#4162507">parsedInt</a></span><span class="op" id="4162577">)</span><span class="op" id="4162578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162582">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162593">switch</span>&nbsp;<span class="ident" id="4162600">val</span>&nbsp;<span class="op" id="4162604">:=</span>&nbsp;<span class="ident" id="4162607"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4162608">;</span>&nbsp;<span class="ident" id="4162610"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4162613">.</span><span class="ident" id="4162614">Kind</span><span class="op" id="4162618">(</span><span class="op" id="4162619">)</span>&nbsp;<span class="op" id="4162621">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162624">case</span>&nbsp;<span class="ident" id="4162629"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162636">.</span><span class="ident" id="4162637">Bool</span><span class="op" id="4162641">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162645">parsedBool</span><span class="op" id="4162655">,</span>&nbsp;<span class="ident" id="4162657">err1</span>&nbsp;<span class="op" id="4162662">:=</span>&nbsp;<span class="ident" id="4162665"><a href="/encoding/asn1/asn1.go.html#4144214">parseBool</a></span><span class="op" id="4162674">(</span><span class="ident" id="4162675"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162689">if</span>&nbsp;<span class="ident" id="4162692"><a href="/encoding/asn1/asn1.go.html#4162657">err1</a></span>&nbsp;<span class="op" id="4162697">==</span>&nbsp;<span class="ident" id="4162700">nil</span>&nbsp;<span class="op" id="4162704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162709"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4162712">.</span><span class="ident" id="4162713">SetBool</span><span class="op" id="4162720">(</span><span class="ident" id="4162721"><a href="/encoding/asn1/asn1.go.html#4162645">parsedBool</a></span><span class="op" id="4162731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162735">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162739"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4162743">=</span>&nbsp;<span class="ident" id="4162745"><a href="/encoding/asn1/asn1.go.html#4162657">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162752">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162760">case</span>&nbsp;<span class="ident" id="4162765"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162772">.</span><span class="ident" id="4162773">Int</span><span class="op" id="4162776">,</span>&nbsp;<span class="ident" id="4162778"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162785">.</span><span class="ident" id="4162786">Int32</span><span class="op" id="4162791">,</span>&nbsp;<span class="ident" id="4162793"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4162800">.</span><span class="ident" id="4162801">Int64</span><span class="op" id="4162806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162810">if</span>&nbsp;<span class="ident" id="4162813"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4162816">.</span><span class="ident" id="4162817">Type</span><span class="op" id="4162821">(</span><span class="op" id="4162822">)</span><span class="op" id="4162823">.</span><span class="ident" id="4162824">Size</span><span class="op" id="4162828">(</span><span class="op" id="4162829">)</span>&nbsp;<span class="op" id="4162831">==</span>&nbsp;<span class="num" id="4162834">4</span>&nbsp;<span class="op" id="4162836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162841">parsedInt</span><span class="op" id="4162850">,</span>&nbsp;<span class="ident" id="4162852">err1</span>&nbsp;<span class="op" id="4162857">:=</span>&nbsp;<span class="ident" id="4162860"><a href="/encoding/asn1/asn1.go.html#4145287">parseInt32</a></span><span class="op" id="4162870">(</span><span class="ident" id="4162871"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4162881">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162886">if</span>&nbsp;<span class="ident" id="4162889"><a href="/encoding/asn1/asn1.go.html#4162852">err1</a></span>&nbsp;<span class="op" id="4162894">==</span>&nbsp;<span class="ident" id="4162897">nil</span>&nbsp;<span class="op" id="4162901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162907"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4162910">.</span><span class="ident" id="4162911">SetInt</span><span class="op" id="4162917">(</span><span class="ident" id="4162918">int64</span><span class="op" id="4162923">(</span><span class="ident" id="4162924"><a href="/encoding/asn1/asn1.go.html#4162841">parsedInt</a></span><span class="op" id="4162933">)</span><span class="op" id="4162934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162944"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4162948">=</span>&nbsp;<span class="ident" id="4162950"><a href="/encoding/asn1/asn1.go.html#4162852">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162957">}</span>&nbsp;<span class="keyword" id="4162959">else</span>&nbsp;<span class="op" id="4162964">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162969">parsedInt</span><span class="op" id="4162978">,</span>&nbsp;<span class="ident" id="4162980">err1</span>&nbsp;<span class="op" id="4162985">:=</span>&nbsp;<span class="ident" id="4162988"><a href="/encoding/asn1/asn1.go.html#4144772">parseInt64</a></span><span class="op" id="4162998">(</span><span class="ident" id="4162999"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4163009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163014">if</span>&nbsp;<span class="ident" id="4163017"><a href="/encoding/asn1/asn1.go.html#4162980">err1</a></span>&nbsp;<span class="op" id="4163022">==</span>&nbsp;<span class="ident" id="4163025">nil</span>&nbsp;<span class="op" id="4163029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163035"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4163038">.</span><span class="ident" id="4163039">SetInt</span><span class="op" id="4163045">(</span><span class="ident" id="4163046"><a href="/encoding/asn1/asn1.go.html#4162969">parsedInt</a></span><span class="op" id="4163055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163065"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4163069">=</span>&nbsp;<span class="ident" id="4163071"><a href="/encoding/asn1/asn1.go.html#4162980">err1</a></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163082">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163090">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163148">case</span>&nbsp;<span class="ident" id="4163153"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4163160">.</span><span class="ident" id="4163161">Struct</span><span class="op" id="4163167">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163171">structType</span>&nbsp;<span class="op" id="4163182">:=</span>&nbsp;<span class="ident" id="4163185"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163198">if</span>&nbsp;<span class="ident" id="4163201"><a href="/encoding/asn1/asn1.go.html#4163171">structType</a></span><span class="op" id="4163211">.</span><span class="ident" id="4163212">NumField</span><span class="op" id="4163220">(</span><span class="op" id="4163221">)</span>&nbsp;<span class="op" id="4163223">&gt;</span>&nbsp;<span class="num" id="4163225">0</span>&nbsp;<span class="op" id="4163227">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163233"><a href="/encoding/asn1/asn1.go.html#4163171">structType</a></span><span class="op" id="4163243">.</span><span class="ident" id="4163244">Field</span><span class="op" id="4163249">(</span><span class="num" id="4163250">0</span><span class="op" id="4163251">)</span><span class="op" id="4163252">.</span><span class="ident" id="4163253">Type</span>&nbsp;<span class="op" id="4163258">==</span>&nbsp;<span class="ident" id="4163261"><a href="/encoding/asn1/asn1.go.html#4156237">rawContentsType</a></span>&nbsp;<span class="op" id="4163277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163282">bytes</span>&nbsp;<span class="op" id="4163288">:=</span>&nbsp;<span class="ident" id="4163291"><a href="/encoding/asn1/asn1.go.html#4156788">bytes</a></span><span class="op" id="4163296">[</span><span class="ident" id="4163297"><a href="/encoding/asn1/asn1.go.html#4156802">initOffset</a></span><span class="op" id="4163307">:</span><span class="ident" id="4163308"><a href="/encoding/asn1/asn1.go.html#4156843">offset</a></span><span class="op" id="4163314">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163319"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4163322">.</span><span class="ident" id="4163323">Field</span><span class="op" id="4163328">(</span><span class="num" id="4163329">0</span><span class="op" id="4163330">)</span><span class="op" id="4163331">.</span><span class="ident" id="4163332">Set</span><span class="op" id="4163335">(</span><span class="ident" id="4163336"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4163343">.</span><span class="ident" id="4163344">ValueOf</span><span class="op" id="4163351">(</span><span class="ident" id="4163352"><a href="/encoding/asn1/asn1.go.html#4152515">RawContent</a></span><span class="op" id="4163362">(</span><span class="ident" id="4163363"><a href="/encoding/asn1/asn1.go.html#4163282">bytes</a></span><span class="op" id="4163368">)</span><span class="op" id="4163369">)</span><span class="op" id="4163370">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163374">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163379">innerOffset</span>&nbsp;<span class="op" id="4163391">:=</span>&nbsp;<span class="num" id="4163394">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163398">for</span>&nbsp;<span class="ident" id="4163402">i</span>&nbsp;<span class="op" id="4163404">:=</span>&nbsp;<span class="num" id="4163407">0</span><span class="op" id="4163408">;</span>&nbsp;<span class="ident" id="4163410"><a href="/encoding/asn1/asn1.go.html#4163402">i</a></span>&nbsp;<span class="op" id="4163412">&lt;</span>&nbsp;<span class="ident" id="4163414"><a href="/encoding/asn1/asn1.go.html#4163171">structType</a></span><span class="op" id="4163424">.</span><span class="ident" id="4163425">NumField</span><span class="op" id="4163433">(</span><span class="op" id="4163434">)</span><span class="op" id="4163435">;</span>&nbsp;<span class="ident" id="4163437"><a href="/encoding/asn1/asn1.go.html#4163402">i</a></span><span class="op" id="4163438">++</span>&nbsp;<span class="op" id="4163441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163446">field</span>&nbsp;<span class="op" id="4163452">:=</span>&nbsp;<span class="ident" id="4163455"><a href="/encoding/asn1/asn1.go.html#4163171">structType</a></span><span class="op" id="4163465">.</span><span class="ident" id="4163466">Field</span><span class="op" id="4163471">(</span><span class="ident" id="4163472"><a href="/encoding/asn1/asn1.go.html#4163402">i</a></span><span class="op" id="4163473">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163478">if</span>&nbsp;<span class="ident" id="4163481"><a href="/encoding/asn1/asn1.go.html#4163402">i</a></span>&nbsp;<span class="op" id="4163483">==</span>&nbsp;<span class="num" id="4163486">0</span>&nbsp;<span class="op" id="4163488">&amp;&amp;</span>&nbsp;<span class="ident" id="4163491"><a href="/encoding/asn1/asn1.go.html#4163446">field</a></span><span class="op" id="4163496">.</span><span class="ident" id="4163497">Type</span>&nbsp;<span class="op" id="4163502">==</span>&nbsp;<span class="ident" id="4163505"><a href="/encoding/asn1/asn1.go.html#4156237">rawContentsType</a></span>&nbsp;<span class="op" id="4163521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163527">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163544"><a href="/encoding/asn1/asn1.go.html#4163379">innerOffset</a></span><span class="op" id="4163555">,</span>&nbsp;<span class="ident" id="4163557"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4163561">=</span>&nbsp;<span class="ident" id="4163563"><a href="/encoding/asn1/asn1.go.html#4156760">parseField</a></span><span class="op" id="4163573">(</span><span class="ident" id="4163574"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4163577">.</span><span class="ident" id="4163578">Field</span><span class="op" id="4163583">(</span><span class="ident" id="4163584"><a href="/encoding/asn1/asn1.go.html#4163402">i</a></span><span class="op" id="4163585">)</span><span class="op" id="4163586">,</span>&nbsp;<span class="ident" id="4163588"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4163598">,</span>&nbsp;<span class="ident" id="4163600"><a href="/encoding/asn1/asn1.go.html#4163379">innerOffset</a></span><span class="op" id="4163611">,</span>&nbsp;<span class="ident" id="4163613"><a href="/encoding/asn1/common.go.html#4171400">parseFieldParameters</a></span><span class="op" id="4163633">(</span><span class="ident" id="4163634"><a href="/encoding/asn1/asn1.go.html#4163446">field</a></span><span class="op" id="4163639">.</span><span class="ident" id="4163640">Tag</span><span class="op" id="4163643">.</span><span class="ident" id="4163644">Get</span><span class="op" id="4163647">(</span><span class="string" id="4163648">&#34;asn1&#34;</span><span class="op" id="4163654">)</span><span class="op" id="4163655">)</span><span class="op" id="4163656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163661">if</span>&nbsp;<span class="ident" id="4163664"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4163668">!=</span>&nbsp;<span class="ident" id="4163671">nil</span>&nbsp;<span class="op" id="4163675">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163681">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163699">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163760">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4163822">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163859">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163867">case</span>&nbsp;<span class="ident" id="4163872"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4163879">.</span><span class="ident" id="4163880">Slice</span><span class="op" id="4163885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163889">sliceType</span>&nbsp;<span class="op" id="4163899">:=</span>&nbsp;<span class="ident" id="4163902"><a href="/encoding/asn1/asn1.go.html#4156890">fieldType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163914">if</span>&nbsp;<span class="ident" id="4163917"><a href="/encoding/asn1/asn1.go.html#4163889">sliceType</a></span><span class="op" id="4163926">.</span><span class="ident" id="4163927">Elem</span><span class="op" id="4163931">(</span><span class="op" id="4163932">)</span><span class="op" id="4163933">.</span><span class="ident" id="4163934">Kind</span><span class="op" id="4163938">(</span><span class="op" id="4163939">)</span>&nbsp;<span class="op" id="4163941">==</span>&nbsp;<span class="ident" id="4163944"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4163951">.</span><span class="ident" id="4163952">Uint8</span>&nbsp;<span class="op" id="4163958">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163963"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4163966">.</span><span class="ident" id="4163967">Set</span><span class="op" id="4163970">(</span><span class="ident" id="4163971"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4163978">.</span><span class="ident" id="4163979">MakeSlice</span><span class="op" id="4163988">(</span><span class="ident" id="4163989"><a href="/encoding/asn1/asn1.go.html#4163889">sliceType</a></span><span class="op" id="4163998">,</span>&nbsp;<span class="builtinfunc" id="4164000">len</span><span class="op" id="4164003">(</span><span class="ident" id="4164004"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164014">)</span><span class="op" id="4164015">,</span>&nbsp;<span class="builtinfunc" id="4164017">len</span><span class="op" id="4164020">(</span><span class="ident" id="4164021"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164031">)</span><span class="op" id="4164032">)</span><span class="op" id="4164033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164038"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4164045">.</span><span class="ident" id="4164046">Copy</span><span class="op" id="4164050">(</span><span class="ident" id="4164051"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4164054">,</span>&nbsp;<span class="ident" id="4164056"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4164063">.</span><span class="ident" id="4164064">ValueOf</span><span class="op" id="4164071">(</span><span class="ident" id="4164072"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164082">)</span><span class="op" id="4164083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164088">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164101">newSlice</span><span class="op" id="4164109">,</span>&nbsp;<span class="ident" id="4164111">err1</span>&nbsp;<span class="op" id="4164116">:=</span>&nbsp;<span class="ident" id="4164119"><a href="/encoding/asn1/asn1.go.html#4154448">parseSequenceOf</a></span><span class="op" id="4164134">(</span><span class="ident" id="4164135"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164145">,</span>&nbsp;<span class="ident" id="4164147"><a href="/encoding/asn1/asn1.go.html#4163889">sliceType</a></span><span class="op" id="4164156">,</span>&nbsp;<span class="ident" id="4164158"><a href="/encoding/asn1/asn1.go.html#4163889">sliceType</a></span><span class="op" id="4164167">.</span><span class="ident" id="4164168">Elem</span><span class="op" id="4164172">(</span><span class="op" id="4164173">)</span><span class="op" id="4164174">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164178">if</span>&nbsp;<span class="ident" id="4164181"><a href="/encoding/asn1/asn1.go.html#4164111">err1</a></span>&nbsp;<span class="op" id="4164186">==</span>&nbsp;<span class="ident" id="4164189">nil</span>&nbsp;<span class="op" id="4164193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164198"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4164201">.</span><span class="ident" id="4164202">Set</span><span class="op" id="4164205">(</span><span class="ident" id="4164206"><a href="/encoding/asn1/asn1.go.html#4164101">newSlice</a></span><span class="op" id="4164214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164222"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164226">=</span>&nbsp;<span class="ident" id="4164228"><a href="/encoding/asn1/asn1.go.html#4164111">err1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164235">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164243">case</span>&nbsp;<span class="ident" id="4164248"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4164255">.</span><span class="ident" id="4164256">String</span><span class="op" id="4164262">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164266">var</span>&nbsp;<span class="ident" id="4164270">v</span>&nbsp;<span class="builtintype" id="4164272">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164281">switch</span>&nbsp;<span class="ident" id="4164288"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span>&nbsp;<span class="op" id="4164301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164305">case</span>&nbsp;<span class="ident" id="4164310"><a href="/encoding/asn1/common.go.html#4169260">tagPrintableString</a></span><span class="op" id="4164328">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164333"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164334">,</span>&nbsp;<span class="ident" id="4164336"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164340">=</span>&nbsp;<span class="ident" id="4164342"><a href="/encoding/asn1/asn1.go.html#4150629">parsePrintableString</a></span><span class="op" id="4164362">(</span><span class="ident" id="4164363"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164373">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164377">case</span>&nbsp;<span class="ident" id="4164382"><a href="/encoding/asn1/common.go.html#4169310">tagIA5String</a></span><span class="op" id="4164394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164399"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164400">,</span>&nbsp;<span class="ident" id="4164402"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164406">=</span>&nbsp;<span class="ident" id="4164408"><a href="/encoding/asn1/asn1.go.html#4151474">parseIA5String</a></span><span class="op" id="4164422">(</span><span class="ident" id="4164423"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164437">case</span>&nbsp;<span class="ident" id="4164442"><a href="/encoding/asn1/common.go.html#4169285">tagT61String</a></span><span class="op" id="4164454">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164459"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164460">,</span>&nbsp;<span class="ident" id="4164462"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164466">=</span>&nbsp;<span class="ident" id="4164468"><a href="/encoding/asn1/asn1.go.html#4151811">parseT61String</a></span><span class="op" id="4164482">(</span><span class="ident" id="4164483"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164497">case</span>&nbsp;<span class="ident" id="4164502"><a href="/encoding/asn1/common.go.html#4169185">tagUTF8String</a></span><span class="op" id="4164515">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164520"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164521">,</span>&nbsp;<span class="ident" id="4164523"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164527">=</span>&nbsp;<span class="ident" id="4164529"><a href="/encoding/asn1/asn1.go.html#4152018">parseUTF8String</a></span><span class="op" id="4164544">(</span><span class="ident" id="4164545"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164559">case</span>&nbsp;<span class="ident" id="4164564"><a href="/encoding/asn1/common.go.html#4169385">tagGeneralString</a></span><span class="op" id="4164580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164585">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164639">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164697">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164751">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164806"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164807">,</span>&nbsp;<span class="ident" id="4164809"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164813">=</span>&nbsp;<span class="ident" id="4164815"><a href="/encoding/asn1/asn1.go.html#4151811">parseT61String</a></span><span class="op" id="4164829">(</span><span class="ident" id="4164830"><a href="/encoding/asn1/asn1.go.html#4161506">innerBytes</a></span><span class="op" id="4164840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164844">default</span><span class="op" id="4164851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164856"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164860">=</span>&nbsp;<span class="ident" id="4164862"><a href="/encoding/asn1/asn1.go.html#4144016">SyntaxError</a></span><span class="op" id="4164873">{</span><span class="ident" id="4164874"><a href="/encoding/asn1/asn1.go.html#4143655">fmt</a></span><span class="op" id="4164877">.</span><span class="ident" id="4164878">Sprintf</span><span class="op" id="4164885">(</span><span class="string" id="4164886">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4164926">,</span>&nbsp;<span class="ident" id="4164928"><a href="/encoding/asn1/asn1.go.html#4158865">universalTag</a></span><span class="op" id="4164940">)</span><span class="op" id="4164941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164945">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164949">if</span>&nbsp;<span class="ident" id="4164952"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4164956">==</span>&nbsp;<span class="ident" id="4164959">nil</span>&nbsp;<span class="op" id="4164963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164968"><a href="/encoding/asn1/asn1.go.html#4162600">val</a></span><span class="op" id="4164971">.</span><span class="ident" id="4164972">SetString</span><span class="op" id="4164981">(</span><span class="ident" id="4164982"><a href="/encoding/asn1/asn1.go.html#4164270">v</a></span><span class="op" id="4164983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164991">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164999">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165002"><a href="/encoding/asn1/asn1.go.html#4156855">err</a></span>&nbsp;<span class="op" id="4165006">=</span>&nbsp;<span class="ident" id="4165008"><a href="/encoding/asn1/asn1.go.html#4143827">StructuralError</a></span><span class="op" id="4165023">{</span><span class="string" id="4165024">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4165040">+</span>&nbsp;<span class="ident" id="4165042"><a href="/encoding/asn1/asn1.go.html#4156771">v</a></span><span class="op" id="4165043">.</span><span class="ident" id="4165044">Type</span><span class="op" id="4165048">(</span><span class="op" id="4165049">)</span><span class="op" id="4165050">.</span><span class="ident" id="4165051">String</span><span class="op" id="4165057">(</span><span class="op" id="4165058">)</span><span class="op" id="4165059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165062">return</span><br>
<span class="lineno"></span><span class="op" id="4165069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4165072">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4165150">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4165197">func</span>&nbsp;<span class="ident" id="4165202">canHaveDefaultValue</span><span class="op" id="4165221">(</span><span class="ident" id="4165222">k</span>&nbsp;<span class="ident" id="4165224"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165231">.</span><span class="ident" id="4165232">Kind</span><span class="op" id="4165236">)</span>&nbsp;<span class="builtintype" id="4165238">bool</span>&nbsp;<span class="op" id="4165243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165246">switch</span>&nbsp;<span class="ident" id="4165253"><a href="/encoding/asn1/asn1.go.html#4165222">k</a></span>&nbsp;<span class="op" id="4165255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165258">case</span>&nbsp;<span class="ident" id="4165263"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165270">.</span><span class="ident" id="4165271">Int</span><span class="op" id="4165274">,</span>&nbsp;<span class="ident" id="4165276"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165283">.</span><span class="ident" id="4165284">Int8</span><span class="op" id="4165288">,</span>&nbsp;<span class="ident" id="4165290"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165297">.</span><span class="ident" id="4165298">Int16</span><span class="op" id="4165303">,</span>&nbsp;<span class="ident" id="4165305"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165312">.</span><span class="ident" id="4165313">Int32</span><span class="op" id="4165318">,</span>&nbsp;<span class="ident" id="4165320"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165327">.</span><span class="ident" id="4165328">Int64</span><span class="op" id="4165333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165337">return</span>&nbsp;<span class="builtintype" id="4165344">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165354">return</span>&nbsp;<span class="builtintype" id="4165361">false</span><br>
<span class="lineno"></span><span class="op" id="4165367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4165370">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4165449">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4165529">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4165591">func</span>&nbsp;<span class="ident" id="4165596">setDefaultValue</span><span class="op" id="4165611">(</span><span class="ident" id="4165612">v</span>&nbsp;<span class="ident" id="4165614"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4165621">.</span><span class="ident" id="4165622">Value</span><span class="op" id="4165627">,</span>&nbsp;<span class="ident" id="4165629">params</span>&nbsp;<span class="ident" id="4165636"><a href="/encoding/asn1/common.go.html#4170591">fieldParameters</a></span><span class="op" id="4165651">)</span>&nbsp;<span class="op" id="4165653">(</span><span class="ident" id="4165654">ok</span>&nbsp;<span class="builtintype" id="4165657">bool</span><span class="op" id="4165661">)</span>&nbsp;<span class="op" id="4165663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165666">if</span>&nbsp;<span class="op" id="4165669">!</span><span class="ident" id="4165670"><a href="/encoding/asn1/asn1.go.html#4165629">params</a></span><span class="op" id="4165676">.</span><span class="ident" id="4165677">optional</span>&nbsp;<span class="op" id="4165686">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165690">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165701"><a href="/encoding/asn1/asn1.go.html#4165654">ok</a></span>&nbsp;<span class="op" id="4165704">=</span>&nbsp;<span class="builtintype" id="4165706">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165712">if</span>&nbsp;<span class="ident" id="4165715"><a href="/encoding/asn1/asn1.go.html#4165629">params</a></span><span class="op" id="4165721">.</span><span class="ident" id="4165722">defaultValue</span>&nbsp;<span class="op" id="4165735">==</span>&nbsp;<span class="ident" id="4165738">nil</span>&nbsp;<span class="op" id="4165742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165746">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165757">if</span>&nbsp;<span class="ident" id="4165760"><a href="/encoding/asn1/asn1.go.html#4165202">canHaveDefaultValue</a></span><span class="op" id="4165779">(</span><span class="ident" id="4165780"><a href="/encoding/asn1/asn1.go.html#4165612">v</a></span><span class="op" id="4165781">.</span><span class="ident" id="4165782">Kind</span><span class="op" id="4165786">(</span><span class="op" id="4165787">)</span><span class="op" id="4165788">)</span>&nbsp;<span class="op" id="4165790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165794"><a href="/encoding/asn1/asn1.go.html#4165612">v</a></span><span class="op" id="4165795">.</span><span class="ident" id="4165796">SetInt</span><span class="op" id="4165802">(</span><span class="op" id="4165803">*</span><span class="ident" id="4165804"><a href="/encoding/asn1/asn1.go.html#4165629">params</a></span><span class="op" id="4165810">.</span><span class="ident" id="4165811">defaultValue</span><span class="op" id="4165823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165829">return</span><br>
<span class="lineno">855</span><span class="op" id="4165836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4165839">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4165898">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4165979">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4166038">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4166091">//</span><br>
<span class="lineno"></span><span class="comment" id="4166094">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4166154">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4166198">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4166251">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4166287">//</span><br>
<span class="lineno"></span><span class="comment" id="4166290">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4166344">//</span><br>
<span class="lineno"></span><span class="comment" id="4166347">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4166400">//</span><br>
<span class="lineno"></span><span class="comment" id="4166403">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4166454">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4166475">//</span><br>
<span class="lineno"></span><span class="comment" id="4166478">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4166534">//</span><br>
<span class="lineno"></span><span class="comment" id="4166537">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4166607">//</span><br>
<span class="lineno"></span><span class="comment" id="4166610">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4166679">//</span><br>
<span class="lineno">880</span><span class="comment" id="4166682">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4166749">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4166817">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4166854">//</span><br>
<span class="lineno"></span><span class="comment" id="4166857">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4166910">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4166976">//</span><br>
<span class="lineno"></span><span class="comment" id="4166979">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4167034">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4167084">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4167139">//</span><br>
<span class="lineno"></span><span class="comment" id="4167142">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4167216">//</span><br>
<span class="lineno"></span><span class="comment" id="4167219">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4167275">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4167339">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4167417">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4167463">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4167528">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4167601">//</span><br>
<span class="lineno">900</span><span class="comment" id="4167604">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4167680">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4167733">//</span><br>
<span class="lineno"></span><span class="comment" id="4167736">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4167815">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4167891">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4167922">//</span><br>
<span class="lineno"></span><span class="comment" id="4167925">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4167988">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4168024">func</span>&nbsp;<span class="ident" id="4168029">Unmarshal</span><span class="op" id="4168038">(</span><span class="ident" id="4168039">b</span>&nbsp;<span class="op" id="4168041">[</span><span class="op" id="4168042">]</span><span class="builtintype" id="4168043">byte</span><span class="op" id="4168047">,</span>&nbsp;<span class="ident" id="4168049">val</span>&nbsp;<span class="keyword" id="4168053">interface</span><span class="op" id="4168062">{</span><span class="op" id="4168063">}</span><span class="op" id="4168064">)</span>&nbsp;<span class="op" id="4168066">(</span><span class="ident" id="4168067">rest</span>&nbsp;<span class="op" id="4168072">[</span><span class="op" id="4168073">]</span><span class="builtintype" id="4168074">byte</span><span class="op" id="4168078">,</span>&nbsp;<span class="ident" id="4168080">err</span>&nbsp;<span class="builtintype" id="4168084">error</span><span class="op" id="4168089">)</span>&nbsp;<span class="op" id="4168091">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168094">return</span>&nbsp;<span class="ident" id="4168101"><a href="/encoding/asn1/asn1.go.html#4168288">UnmarshalWithParams</a></span><span class="op" id="4168120">(</span><span class="ident" id="4168121"><a href="/encoding/asn1/asn1.go.html#4168039">b</a></span><span class="op" id="4168122">,</span>&nbsp;<span class="ident" id="4168124"><a href="/encoding/asn1/asn1.go.html#4168049">val</a></span><span class="op" id="4168127">,</span>&nbsp;<span class="string" id="4168129">&#34;&#34;</span><span class="op" id="4168131">)</span><br>
<span class="lineno"></span><span class="op" id="4168133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4168136">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4168207">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4168283">func</span>&nbsp;<span class="ident" id="4168288">UnmarshalWithParams</span><span class="op" id="4168307">(</span><span class="ident" id="4168308">b</span>&nbsp;<span class="op" id="4168310">[</span><span class="op" id="4168311">]</span><span class="builtintype" id="4168312">byte</span><span class="op" id="4168316">,</span>&nbsp;<span class="ident" id="4168318">val</span>&nbsp;<span class="keyword" id="4168322">interface</span><span class="op" id="4168331">{</span><span class="op" id="4168332">}</span><span class="op" id="4168333">,</span>&nbsp;<span class="ident" id="4168335">params</span>&nbsp;<span class="builtintype" id="4168342">string</span><span class="op" id="4168348">)</span>&nbsp;<span class="op" id="4168350">(</span><span class="ident" id="4168351">rest</span>&nbsp;<span class="op" id="4168356">[</span><span class="op" id="4168357">]</span><span class="builtintype" id="4168358">byte</span><span class="op" id="4168362">,</span>&nbsp;<span class="ident" id="4168364">err</span>&nbsp;<span class="builtintype" id="4168368">error</span><span class="op" id="4168373">)</span>&nbsp;<span class="op" id="4168375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168378">v</span>&nbsp;<span class="op" id="4168380">:=</span>&nbsp;<span class="ident" id="4168383"><a href="/encoding/asn1/asn1.go.html#4143674">reflect</a></span><span class="op" id="4168390">.</span><span class="ident" id="4168391">ValueOf</span><span class="op" id="4168398">(</span><span class="ident" id="4168399"><a href="/encoding/asn1/asn1.go.html#4168318">val</a></span><span class="op" id="4168402">)</span><span class="op" id="4168403">.</span><span class="ident" id="4168404">Elem</span><span class="op" id="4168408">(</span><span class="op" id="4168409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4168412">offset</span><span class="op" id="4168418">,</span>&nbsp;<span class="ident" id="4168420"><a href="/encoding/asn1/asn1.go.html#4168364">err</a></span>&nbsp;<span class="op" id="4168424">:=</span>&nbsp;<span class="ident" id="4168427"><a href="/encoding/asn1/asn1.go.html#4156760">parseField</a></span><span class="op" id="4168437">(</span><span class="ident" id="4168438"><a href="/encoding/asn1/asn1.go.html#4168378">v</a></span><span class="op" id="4168439">,</span>&nbsp;<span class="ident" id="4168441"><a href="/encoding/asn1/asn1.go.html#4168308">b</a></span><span class="op" id="4168442">,</span>&nbsp;<span class="num" id="4168444">0</span><span class="op" id="4168445">,</span>&nbsp;<span class="ident" id="4168447"><a href="/encoding/asn1/common.go.html#4171400">parseFieldParameters</a></span><span class="op" id="4168467">(</span><span class="ident" id="4168468"><a href="/encoding/asn1/asn1.go.html#4168335">params</a></span><span class="op" id="4168474">)</span><span class="op" id="4168475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168478">if</span>&nbsp;<span class="ident" id="4168481"><a href="/encoding/asn1/asn1.go.html#4168364">err</a></span>&nbsp;<span class="op" id="4168485">!=</span>&nbsp;<span class="ident" id="4168488">nil</span>&nbsp;<span class="op" id="4168492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168496">return</span>&nbsp;<span class="ident" id="4168503">nil</span><span class="op" id="4168506">,</span>&nbsp;<span class="ident" id="4168508"><a href="/encoding/asn1/asn1.go.html#4168364">err</a></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4168513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4168516">return</span>&nbsp;<span class="ident" id="4168523"><a href="/encoding/asn1/asn1.go.html#4168308">b</a></span><span class="op" id="4168524">[</span><span class="ident" id="4168525"><a href="/encoding/asn1/asn1.go.html#4168412">offset</a></span><span class="op" id="4168531">:</span><span class="op" id="4168532">]</span><span class="op" id="4168533">,</span>&nbsp;<span class="ident" id="4168535">nil</span><br>
<span class="lineno"></span><span class="op" id="4168539">}</span>
</div>
</body>
</html>
