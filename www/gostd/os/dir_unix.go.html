<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>os</h2>
<ul>
<li><a href="/gostd/os/dir_unix.go.html" class="current">dir_unix.go</a></li>
<li><a href="/gostd/os/doc.go.html">doc.go</a></li>
<li><a href="/gostd/os/env.go.html">env.go</a></li>
<li><a href="/gostd/os/env_test.go.html">env_test.go</a></li>
<li><a href="/gostd/os/env_unix_test.go.html">env_unix_test.go</a></li>
<li><a href="/gostd/os/error.go.html">error.go</a></li>
<li><a href="/gostd/os/error_test.go.html">error_test.go</a></li>
<li><a href="/gostd/os/error_unix.go.html">error_unix.go</a></li>
<li><a href="/gostd/os/exec.go.html">exec.go</a></li>
<li><a href="/gostd/os/exec_posix.go.html">exec_posix.go</a></li>
<li><a href="/gostd/os/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/os/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/os/file.go.html">file.go</a></li>
<li><a href="/gostd/os/file_posix.go.html">file_posix.go</a></li>
<li><a href="/gostd/os/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/os/getwd.go.html">getwd.go</a></li>
<li><a href="/gostd/os/os_test.go.html">os_test.go</a></li>
<li><a href="/gostd/os/os_unix_test.go.html">os_unix_test.go</a></li>
<li><a href="/gostd/os/path.go.html">path.go</a></li>
<li><a href="/gostd/os/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/os/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/os/pipe_linux.go.html">pipe_linux.go</a></li>
<li><a href="/gostd/os/proc.go.html">proc.go</a></li>
<li><a href="/gostd/os/stat_linux.go.html">stat_linux.go</a></li>
<li><a href="/gostd/os/sys_linux.go.html">sys_linux.go</a></li>
<li><a href="/gostd/os/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/os/types.go.html">types.go</a></li>
<li><a href="/gostd/os/types_notwin.go.html">types_notwin.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2456747">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2456802">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2456856">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2456907">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456977">package</span>&nbsp;<span class="ident" id="2456985">os</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2456989">import</span>&nbsp;<span class="op" id="2456996">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2456999">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2457005">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="2457015">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2457018">const</span>&nbsp;<span class="op" id="2457024">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457027">blockSize</span>&nbsp;<span class="op" id="2457037">=</span>&nbsp;<span class="num" id="2457039">4096</span><br>
<span class="lineno"></span><span class="op" id="2457044">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2457047">func</span>&nbsp;<span class="op" id="2457052">(</span><span class="ident" id="2457053">f</span>&nbsp;<span class="op" id="2457055">*</span><span class="ident" id="2457056">File</span><span class="op" id="2457060">)</span>&nbsp;<span class="ident" id="2457062">readdirnames</span><span class="op" id="2457074">(</span><span class="ident" id="2457075">n</span>&nbsp;<span class="builtintype" id="2457077">int</span><span class="op" id="2457080">)</span>&nbsp;<span class="op" id="2457082">(</span><span class="ident" id="2457083">names</span>&nbsp;<span class="op" id="2457089">[</span><span class="op" id="2457090">]</span><span class="builtintype" id="2457091">string</span><span class="op" id="2457097">,</span>&nbsp;<span class="ident" id="2457099">err</span>&nbsp;<span class="builtintype" id="2457103">error</span><span class="op" id="2457108">)</span>&nbsp;<span class="op" id="2457110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2457113">//&nbsp;If&nbsp;this&nbsp;file&nbsp;has&nbsp;no&nbsp;dirinfo,&nbsp;create&nbsp;one.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457158">if</span>&nbsp;<span class="ident" id="2457161">f</span><span class="op" id="2457162">.</span><span class="ident" id="2457163">dirinfo</span>&nbsp;<span class="op" id="2457171">==</span>&nbsp;<span class="builtintype" id="2457174">nil</span>&nbsp;<span class="op" id="2457178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457182">f</span><span class="op" id="2457183">.</span><span class="ident" id="2457184">dirinfo</span>&nbsp;<span class="op" id="2457192">=</span>&nbsp;<span class="builtinfunc" id="2457194">new</span><span class="op" id="2457197">(</span><span class="ident" id="2457198">dirInfo</span><span class="op" id="2457205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2457209">//&nbsp;The&nbsp;buffer&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;a&nbsp;block&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457256">f</span><span class="op" id="2457257">.</span><span class="ident" id="2457258">dirinfo</span><span class="op" id="2457265">.</span><span class="ident" id="2457266">buf</span>&nbsp;<span class="op" id="2457270">=</span>&nbsp;<span class="builtinfunc" id="2457272">make</span><span class="op" id="2457276">(</span><span class="op" id="2457277">[</span><span class="op" id="2457278">]</span><span class="builtintype" id="2457279">byte</span><span class="op" id="2457283">,</span>&nbsp;<span class="ident" id="2457285">blockSize</span><span class="op" id="2457294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457297">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457300">d</span>&nbsp;<span class="op" id="2457302">:=</span>&nbsp;<span class="ident" id="2457305">f</span><span class="op" id="2457306">.</span><span class="ident" id="2457307">dirinfo</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457317">size</span>&nbsp;<span class="op" id="2457322">:=</span>&nbsp;<span class="ident" id="2457325">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457328">if</span>&nbsp;<span class="ident" id="2457331">size</span>&nbsp;<span class="op" id="2457336">&lt;=</span>&nbsp;<span class="num" id="2457339">0</span>&nbsp;<span class="op" id="2457341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457345">size</span>&nbsp;<span class="op" id="2457350">=</span>&nbsp;<span class="num" id="2457352">100</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457358">n</span>&nbsp;<span class="op" id="2457360">=</span>&nbsp;<span class="op" id="2457362">-</span><span class="num" id="2457363">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457370">names</span>&nbsp;<span class="op" id="2457376">=</span>&nbsp;<span class="builtinfunc" id="2457378">make</span><span class="op" id="2457382">(</span><span class="op" id="2457383">[</span><span class="op" id="2457384">]</span><span class="builtintype" id="2457385">string</span><span class="op" id="2457391">,</span>&nbsp;<span class="num" id="2457393">0</span><span class="op" id="2457394">,</span>&nbsp;<span class="ident" id="2457396">size</span><span class="op" id="2457400">)</span>&nbsp;<span class="comment" id="2457402">//&nbsp;Empty&nbsp;with&nbsp;room&nbsp;to&nbsp;grow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457431">for</span>&nbsp;<span class="ident" id="2457435">n</span>&nbsp;<span class="op" id="2457437">!=</span>&nbsp;<span class="num" id="2457440">0</span>&nbsp;<span class="op" id="2457442">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2457446">//&nbsp;Refill&nbsp;the&nbsp;buffer&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457482">if</span>&nbsp;<span class="ident" id="2457485">d</span><span class="op" id="2457486">.</span><span class="ident" id="2457487">bufp</span>&nbsp;<span class="op" id="2457492">&gt;=</span>&nbsp;<span class="ident" id="2457495">d</span><span class="op" id="2457496">.</span><span class="ident" id="2457497">nbuf</span>&nbsp;<span class="op" id="2457502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457507">d</span><span class="op" id="2457508">.</span><span class="ident" id="2457509">bufp</span>&nbsp;<span class="op" id="2457514">=</span>&nbsp;<span class="num" id="2457516">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457521">var</span>&nbsp;<span class="ident" id="2457525">errno</span>&nbsp;<span class="builtintype" id="2457531">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457540">d</span><span class="op" id="2457541">.</span><span class="ident" id="2457542">nbuf</span><span class="op" id="2457546">,</span>&nbsp;<span class="ident" id="2457548">errno</span>&nbsp;<span class="op" id="2457554">=</span>&nbsp;<span class="ident" id="2457556">fixCount</span><span class="op" id="2457564">(</span><span class="ident" id="2457565">syscall</span><span class="op" id="2457572">.</span><span class="ident" id="2457573">ReadDirent</span><span class="op" id="2457583">(</span><span class="ident" id="2457584">f</span><span class="op" id="2457585">.</span><span class="ident" id="2457586">fd</span><span class="op" id="2457588">,</span>&nbsp;<span class="ident" id="2457590">d</span><span class="op" id="2457591">.</span><span class="ident" id="2457592">buf</span><span class="op" id="2457595">)</span><span class="op" id="2457596">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457601">if</span>&nbsp;<span class="ident" id="2457604">errno</span>&nbsp;<span class="op" id="2457610">!=</span>&nbsp;<span class="builtintype" id="2457613">nil</span>&nbsp;<span class="op" id="2457617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457623">return</span>&nbsp;<span class="ident" id="2457630">names</span><span class="op" id="2457635">,</span>&nbsp;<span class="ident" id="2457637">NewSyscallError</span><span class="op" id="2457652">(</span><span class="string" id="2457653">&#34;readdirent&#34;</span><span class="op" id="2457665">,</span>&nbsp;<span class="ident" id="2457667">errno</span><span class="op" id="2457672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457682">if</span>&nbsp;<span class="ident" id="2457685">d</span><span class="op" id="2457686">.</span><span class="ident" id="2457687">nbuf</span>&nbsp;<span class="op" id="2457692">&lt;=</span>&nbsp;<span class="num" id="2457695">0</span>&nbsp;<span class="op" id="2457697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457703">break</span>&nbsp;<span class="comment" id="2457709">//&nbsp;EOF</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2457728">//&nbsp;Drain&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457750">var</span>&nbsp;<span class="ident" id="2457754">nb</span><span class="op" id="2457756">,</span>&nbsp;<span class="ident" id="2457758">nc</span>&nbsp;<span class="builtintype" id="2457761">int</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457767">nb</span><span class="op" id="2457769">,</span>&nbsp;<span class="ident" id="2457771">nc</span><span class="op" id="2457773">,</span>&nbsp;<span class="ident" id="2457775">names</span>&nbsp;<span class="op" id="2457781">=</span>&nbsp;<span class="ident" id="2457783">syscall</span><span class="op" id="2457790">.</span><span class="ident" id="2457791">ParseDirent</span><span class="op" id="2457802">(</span><span class="ident" id="2457803">d</span><span class="op" id="2457804">.</span><span class="ident" id="2457805">buf</span><span class="op" id="2457808">[</span><span class="ident" id="2457809">d</span><span class="op" id="2457810">.</span><span class="ident" id="2457811">bufp</span><span class="op" id="2457815">:</span><span class="ident" id="2457816">d</span><span class="op" id="2457817">.</span><span class="ident" id="2457818">nbuf</span><span class="op" id="2457822">]</span><span class="op" id="2457823">,</span>&nbsp;<span class="ident" id="2457825">n</span><span class="op" id="2457826">,</span>&nbsp;<span class="ident" id="2457828">names</span><span class="op" id="2457833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457837">d</span><span class="op" id="2457838">.</span><span class="ident" id="2457839">bufp</span>&nbsp;<span class="op" id="2457844">+=</span>&nbsp;<span class="ident" id="2457847">nb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2457852">n</span>&nbsp;<span class="op" id="2457854">-=</span>&nbsp;<span class="ident" id="2457857">nc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457864">if</span>&nbsp;<span class="ident" id="2457867">n</span>&nbsp;<span class="op" id="2457869">&gt;=</span>&nbsp;<span class="num" id="2457872">0</span>&nbsp;<span class="op" id="2457874">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2457877">len</span><span class="op" id="2457880">(</span><span class="ident" id="2457881">names</span><span class="op" id="2457886">)</span>&nbsp;<span class="op" id="2457888">==</span>&nbsp;<span class="num" id="2457891">0</span>&nbsp;<span class="op" id="2457893">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457897">return</span>&nbsp;<span class="ident" id="2457904">names</span><span class="op" id="2457909">,</span>&nbsp;<span class="ident" id="2457911">io</span><span class="op" id="2457913">.</span><span class="ident" id="2457914">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2457919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2457922">return</span>&nbsp;<span class="ident" id="2457929">names</span><span class="op" id="2457934">,</span>&nbsp;<span class="builtintype" id="2457936">nil</span><br>
<span class="lineno"></span><span class="op" id="2457940">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
