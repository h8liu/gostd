<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/tabwriter</h2>
<ul>
<li><a href="/gostd/text/tabwriter/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/tabwriter/tabwriter.go.html" class="current">tabwriter.go</a></li>
<li><a href="/gostd/text/tabwriter/tabwriter_test.go.html">tabwriter_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4747906">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4747961">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4748015">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4748066">//&nbsp;Package&nbsp;tabwriter&nbsp;implements&nbsp;a&nbsp;write&nbsp;filter&nbsp;(tabwriter.Writer)&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4748137">//&nbsp;translates&nbsp;tabbed&nbsp;columns&nbsp;in&nbsp;input&nbsp;into&nbsp;properly&nbsp;aligned&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="4748203">//</span><br>
<span class="lineno"></span><span class="comment" id="4748206">//&nbsp;The&nbsp;package&nbsp;is&nbsp;using&nbsp;the&nbsp;Elastic&nbsp;Tabstops&nbsp;algorithm&nbsp;described&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4748274">//&nbsp;http://nickgravgaard.com/elastictabstops/index.html.</span><br>
<span class="lineno">10</span><span class="comment" id="4748330">//</span><br>
<span class="lineno"></span><span class="keyword" id="4748333">package</span>&nbsp;<span class="ident" id="4748341">tabwriter</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4748352">import</span>&nbsp;<span class="op" id="4748359">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4748362">&#34;bytes&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4748371">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4748377">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4748392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748395">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">20</span><span class="comment" id="4748475">//&nbsp;Filter&nbsp;implementation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748501">//&nbsp;A&nbsp;cell&nbsp;represents&nbsp;a&nbsp;segment&nbsp;of&nbsp;text&nbsp;terminated&nbsp;by&nbsp;tabs&nbsp;or&nbsp;line&nbsp;breaks.</span><br>
<span class="lineno"></span><span class="comment" id="4748575">//&nbsp;The&nbsp;text&nbsp;itself&nbsp;is&nbsp;stored&nbsp;in&nbsp;a&nbsp;separate&nbsp;buffer;&nbsp;cell&nbsp;only&nbsp;describes&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4748650">//&nbsp;segment&#39;s&nbsp;size&nbsp;in&nbsp;bytes,&nbsp;its&nbsp;width&nbsp;in&nbsp;runes,&nbsp;and&nbsp;whether&nbsp;it&#39;s&nbsp;an&nbsp;htab</span><br>
<span class="lineno">25</span><span class="comment" id="4748723">//&nbsp;(&#39;\t&#39;)&nbsp;terminated&nbsp;cell.</span><br>
<span class="lineno"></span><span class="comment" id="4748750">//</span><br>
<span class="lineno"></span><span class="keyword" id="4748753">type</span>&nbsp;<span class="ident" id="4748758">cell</span>&nbsp;<span class="keyword" id="4748763">struct</span>&nbsp;<span class="op" id="4748770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748773">size</span>&nbsp;&nbsp;<span class="builtintype" id="4748779">int</span>&nbsp;&nbsp;<span class="comment" id="4748784">//&nbsp;cell&nbsp;size&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748807">width</span>&nbsp;<span class="builtintype" id="4748813">int</span>&nbsp;&nbsp;<span class="comment" id="4748818">//&nbsp;cell&nbsp;width&nbsp;in&nbsp;runes</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4748842">htab</span>&nbsp;&nbsp;<span class="builtintype" id="4748848">bool</span>&nbsp;<span class="comment" id="4748853">//&nbsp;true&nbsp;if&nbsp;the&nbsp;cell&nbsp;is&nbsp;terminated&nbsp;by&nbsp;an&nbsp;htab&nbsp;(&#39;\t&#39;)</span><br>
<span class="lineno"></span><span class="op" id="4748905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4748908">//&nbsp;A&nbsp;Writer&nbsp;is&nbsp;a&nbsp;filter&nbsp;that&nbsp;inserts&nbsp;padding&nbsp;around&nbsp;tab-delimited</span><br>
<span class="lineno"></span><span class="comment" id="4748974">//&nbsp;columns&nbsp;in&nbsp;its&nbsp;input&nbsp;to&nbsp;align&nbsp;them&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno">35</span><span class="comment" id="4749027">//</span><br>
<span class="lineno"></span><span class="comment" id="4749030">//&nbsp;The&nbsp;Writer&nbsp;treats&nbsp;incoming&nbsp;bytes&nbsp;as&nbsp;UTF-8&nbsp;encoded&nbsp;text&nbsp;consisting</span><br>
<span class="lineno"></span><span class="comment" id="4749099">//&nbsp;of&nbsp;cells&nbsp;terminated&nbsp;by&nbsp;(horizontal&nbsp;or&nbsp;vertical)&nbsp;tabs&nbsp;or&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4749163">//&nbsp;breaks&nbsp;(newline&nbsp;or&nbsp;formfeed&nbsp;characters).&nbsp;Cells&nbsp;in&nbsp;adjacent&nbsp;lines</span><br>
<span class="lineno"></span><span class="comment" id="4749231">//&nbsp;constitute&nbsp;a&nbsp;column.&nbsp;The&nbsp;Writer&nbsp;inserts&nbsp;padding&nbsp;as&nbsp;needed&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="4749295">//&nbsp;make&nbsp;all&nbsp;cells&nbsp;in&nbsp;a&nbsp;column&nbsp;have&nbsp;the&nbsp;same&nbsp;width,&nbsp;effectively</span><br>
<span class="lineno"></span><span class="comment" id="4749358">//&nbsp;aligning&nbsp;the&nbsp;columns.&nbsp;It&nbsp;assumes&nbsp;that&nbsp;all&nbsp;characters&nbsp;have&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4749423">//&nbsp;same&nbsp;width&nbsp;except&nbsp;for&nbsp;tabs&nbsp;for&nbsp;which&nbsp;a&nbsp;tabwidth&nbsp;must&nbsp;be&nbsp;specified.</span><br>
<span class="lineno"></span><span class="comment" id="4749493">//&nbsp;Note&nbsp;that&nbsp;cells&nbsp;are&nbsp;tab-terminated,&nbsp;not&nbsp;tab-separated:&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="4749560">//&nbsp;non-tab&nbsp;text&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;does&nbsp;not&nbsp;form&nbsp;a&nbsp;column&nbsp;cell.</span><br>
<span class="lineno">45</span><span class="comment" id="4749626">//</span><br>
<span class="lineno"></span><span class="comment" id="4749629">//&nbsp;The&nbsp;Writer&nbsp;assumes&nbsp;that&nbsp;all&nbsp;Unicode&nbsp;code&nbsp;points&nbsp;have&nbsp;the&nbsp;same&nbsp;width;</span><br>
<span class="lineno"></span><span class="comment" id="4749701">//&nbsp;this&nbsp;may&nbsp;not&nbsp;be&nbsp;true&nbsp;in&nbsp;some&nbsp;fonts.</span><br>
<span class="lineno"></span><span class="comment" id="4749740">//</span><br>
<span class="lineno"></span><span class="comment" id="4749743">//&nbsp;If&nbsp;DiscardEmptyColumns&nbsp;is&nbsp;set,&nbsp;empty&nbsp;columns&nbsp;that&nbsp;are&nbsp;terminated</span><br>
<span class="lineno">50</span><span class="comment" id="4749811">//&nbsp;entirely&nbsp;by&nbsp;vertical&nbsp;(or&nbsp;&#34;soft&#34;)&nbsp;tabs&nbsp;are&nbsp;discarded.&nbsp;Columns</span><br>
<span class="lineno"></span><span class="comment" id="4749875">//&nbsp;terminated&nbsp;by&nbsp;horizontal&nbsp;(or&nbsp;&#34;hard&#34;)&nbsp;tabs&nbsp;are&nbsp;not&nbsp;affected&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4749940">//&nbsp;this&nbsp;flag.</span><br>
<span class="lineno"></span><span class="comment" id="4749954">//</span><br>
<span class="lineno"></span><span class="comment" id="4749957">//&nbsp;If&nbsp;a&nbsp;Writer&nbsp;is&nbsp;configured&nbsp;to&nbsp;filter&nbsp;HTML,&nbsp;HTML&nbsp;tags&nbsp;and&nbsp;entities</span><br>
<span class="lineno">55</span><span class="comment" id="4750025">//&nbsp;are&nbsp;passed&nbsp;through.&nbsp;The&nbsp;widths&nbsp;of&nbsp;tags&nbsp;and&nbsp;entities&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4750084">//&nbsp;assumed&nbsp;to&nbsp;be&nbsp;zero&nbsp;(tags)&nbsp;and&nbsp;one&nbsp;(entities)&nbsp;for&nbsp;formatting&nbsp;purposes.</span><br>
<span class="lineno"></span><span class="comment" id="4750157">//</span><br>
<span class="lineno"></span><span class="comment" id="4750160">//&nbsp;A&nbsp;segment&nbsp;of&nbsp;text&nbsp;may&nbsp;be&nbsp;escaped&nbsp;by&nbsp;bracketing&nbsp;it&nbsp;with&nbsp;Escape</span><br>
<span class="lineno"></span><span class="comment" id="4750225">//&nbsp;characters.&nbsp;The&nbsp;tabwriter&nbsp;passes&nbsp;escaped&nbsp;text&nbsp;segments&nbsp;through</span><br>
<span class="lineno">60</span><span class="comment" id="4750291">//&nbsp;unchanged.&nbsp;In&nbsp;particular,&nbsp;it&nbsp;does&nbsp;not&nbsp;interpret&nbsp;any&nbsp;tabs&nbsp;or&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4750359">//&nbsp;breaks&nbsp;within&nbsp;the&nbsp;segment.&nbsp;If&nbsp;the&nbsp;StripEscape&nbsp;flag&nbsp;is&nbsp;set,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4750425">//&nbsp;Escape&nbsp;characters&nbsp;are&nbsp;stripped&nbsp;from&nbsp;the&nbsp;output;&nbsp;otherwise&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="4750491">//&nbsp;are&nbsp;passed&nbsp;through&nbsp;as&nbsp;well.&nbsp;For&nbsp;the&nbsp;purpose&nbsp;of&nbsp;formatting,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4750557">//&nbsp;width&nbsp;of&nbsp;the&nbsp;escaped&nbsp;text&nbsp;is&nbsp;always&nbsp;computed&nbsp;excluding&nbsp;the&nbsp;Escape</span><br>
<span class="lineno">65</span><span class="comment" id="4750626">//&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="4750641">//</span><br>
<span class="lineno"></span><span class="comment" id="4750644">//&nbsp;The&nbsp;formfeed&nbsp;character&nbsp;(&#39;\f&#39;)&nbsp;acts&nbsp;like&nbsp;a&nbsp;newline&nbsp;but&nbsp;it&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="4750709">//&nbsp;terminates&nbsp;all&nbsp;columns&nbsp;in&nbsp;the&nbsp;current&nbsp;line&nbsp;(effectively&nbsp;calling</span><br>
<span class="lineno"></span><span class="comment" id="4750776">//&nbsp;Flush).&nbsp;Cells&nbsp;in&nbsp;the&nbsp;next&nbsp;line&nbsp;start&nbsp;new&nbsp;columns.&nbsp;Unless&nbsp;found</span><br>
<span class="lineno">70</span><span class="comment" id="4750842">//&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag&nbsp;or&nbsp;inside&nbsp;an&nbsp;escaped&nbsp;text&nbsp;segment,&nbsp;formfeed</span><br>
<span class="lineno"></span><span class="comment" id="4750908">//&nbsp;characters&nbsp;appear&nbsp;as&nbsp;newlines&nbsp;in&nbsp;the&nbsp;output.</span><br>
<span class="lineno"></span><span class="comment" id="4750956">//</span><br>
<span class="lineno"></span><span class="comment" id="4750959">//&nbsp;The&nbsp;Writer&nbsp;must&nbsp;buffer&nbsp;input&nbsp;internally,&nbsp;because&nbsp;proper&nbsp;spacing</span><br>
<span class="lineno"></span><span class="comment" id="4751026">//&nbsp;of&nbsp;one&nbsp;line&nbsp;may&nbsp;depend&nbsp;on&nbsp;the&nbsp;cells&nbsp;in&nbsp;future&nbsp;lines.&nbsp;Clients&nbsp;must</span><br>
<span class="lineno">75</span><span class="comment" id="4751095">//&nbsp;call&nbsp;Flush&nbsp;when&nbsp;done&nbsp;calling&nbsp;Write.</span><br>
<span class="lineno"></span><span class="comment" id="4751134">//</span><br>
<span class="lineno"></span><span class="keyword" id="4751137">type</span>&nbsp;<span class="ident" id="4751142">Writer</span>&nbsp;<span class="keyword" id="4751149">struct</span>&nbsp;<span class="op" id="4751156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751159">//&nbsp;configuration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751177">output</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4751186">io</span><span class="op" id="4751188">.</span><span class="ident" id="4751189">Writer</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751197">minwidth</span>&nbsp;<span class="builtintype" id="4751206">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751211">tabwidth</span>&nbsp;<span class="builtintype" id="4751220">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751225">padding</span>&nbsp;&nbsp;<span class="builtintype" id="4751234">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751239">padbytes</span>&nbsp;<span class="op" id="4751248">[</span><span class="num" id="4751249">8</span><span class="op" id="4751250">]</span><span class="builtintype" id="4751251">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751257">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4751266">uint</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751273">//&nbsp;current&nbsp;state</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751291">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751299">bytes</span><span class="op" id="4751304">.</span><span class="ident" id="4751305">Buffer</span>&nbsp;<span class="comment" id="4751312">//&nbsp;collected&nbsp;text&nbsp;excluding&nbsp;tabs&nbsp;or&nbsp;line&nbsp;breaks</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751361">pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4751369">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751382">//&nbsp;buffer&nbsp;position&nbsp;up&nbsp;to&nbsp;which&nbsp;cell.width&nbsp;of&nbsp;incomplete&nbsp;cell&nbsp;has&nbsp;been&nbsp;computed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751462">cell</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751470">cell</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751483">//&nbsp;current&nbsp;incomplete&nbsp;cell;&nbsp;cell.width&nbsp;is&nbsp;up&nbsp;to&nbsp;buf[pos]&nbsp;excluding&nbsp;ignored&nbsp;sections</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751568">endChar</span>&nbsp;<span class="builtintype" id="4751576">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751589">//&nbsp;terminating&nbsp;char&nbsp;of&nbsp;escaped&nbsp;sequence&nbsp;(Escape&nbsp;for&nbsp;escapes,&nbsp;&#39;&gt;&#39;,&nbsp;&#39;;&#39;&nbsp;for&nbsp;HTML&nbsp;tags/entities,&nbsp;or&nbsp;0)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751690">lines</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4751698">[</span><span class="op" id="4751699">]</span><span class="op" id="4751700">[</span><span class="op" id="4751701">]</span><span class="ident" id="4751702">cell</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751711">//&nbsp;list&nbsp;of&nbsp;lines;&nbsp;each&nbsp;line&nbsp;is&nbsp;a&nbsp;list&nbsp;of&nbsp;cells</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751759">widths</span>&nbsp;&nbsp;<span class="op" id="4751767">[</span><span class="op" id="4751768">]</span><span class="builtintype" id="4751769">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4751780">//&nbsp;list&nbsp;of&nbsp;column&nbsp;widths&nbsp;in&nbsp;runes&nbsp;-&nbsp;re-used&nbsp;during&nbsp;formatting</span><br>
<span class="lineno"></span><span class="op" id="4751842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4751845">func</span>&nbsp;<span class="op" id="4751850">(</span><span class="ident" id="4751851">b</span>&nbsp;<span class="op" id="4751853">*</span><span class="ident" id="4751854">Writer</span><span class="op" id="4751860">)</span>&nbsp;<span class="ident" id="4751862">addLine</span><span class="op" id="4751869">(</span><span class="op" id="4751870">)</span>&nbsp;<span class="op" id="4751872">{</span>&nbsp;<span class="ident" id="4751874">b</span><span class="op" id="4751875">.</span><span class="ident" id="4751876">lines</span>&nbsp;<span class="op" id="4751882">=</span>&nbsp;<span class="builtinfunc" id="4751884">append</span><span class="op" id="4751890">(</span><span class="ident" id="4751891">b</span><span class="op" id="4751892">.</span><span class="ident" id="4751893">lines</span><span class="op" id="4751898">,</span>&nbsp;<span class="op" id="4751900">[</span><span class="op" id="4751901">]</span><span class="ident" id="4751902">cell</span><span class="op" id="4751906">{</span><span class="op" id="4751907">}</span><span class="op" id="4751908">)</span>&nbsp;<span class="op" id="4751910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4751913">//&nbsp;Reset&nbsp;the&nbsp;current&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="4751941">func</span>&nbsp;<span class="op" id="4751946">(</span><span class="ident" id="4751947">b</span>&nbsp;<span class="op" id="4751949">*</span><span class="ident" id="4751950">Writer</span><span class="op" id="4751956">)</span>&nbsp;<span class="ident" id="4751958">reset</span><span class="op" id="4751963">(</span><span class="op" id="4751964">)</span>&nbsp;<span class="op" id="4751966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751969">b</span><span class="op" id="4751970">.</span><span class="ident" id="4751971">buf</span><span class="op" id="4751974">.</span><span class="ident" id="4751975">Reset</span><span class="op" id="4751980">(</span><span class="op" id="4751981">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751984">b</span><span class="op" id="4751985">.</span><span class="ident" id="4751986">pos</span>&nbsp;<span class="op" id="4751990">=</span>&nbsp;<span class="num" id="4751992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4751995">b</span><span class="op" id="4751996">.</span><span class="ident" id="4751997">cell</span>&nbsp;<span class="op" id="4752002">=</span>&nbsp;<span class="ident" id="4752004">cell</span><span class="op" id="4752008">{</span><span class="op" id="4752009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752012">b</span><span class="op" id="4752013">.</span><span class="ident" id="4752014">endChar</span>&nbsp;<span class="op" id="4752022">=</span>&nbsp;<span class="num" id="4752024">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752027">b</span><span class="op" id="4752028">.</span><span class="ident" id="4752029">lines</span>&nbsp;<span class="op" id="4752035">=</span>&nbsp;<span class="ident" id="4752037">b</span><span class="op" id="4752038">.</span><span class="ident" id="4752039">lines</span><span class="op" id="4752044">[</span><span class="num" id="4752045">0</span><span class="op" id="4752046">:</span><span class="num" id="4752047">0</span><span class="op" id="4752048">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752051">b</span><span class="op" id="4752052">.</span><span class="ident" id="4752053">widths</span>&nbsp;<span class="op" id="4752060">=</span>&nbsp;<span class="ident" id="4752062">b</span><span class="op" id="4752063">.</span><span class="ident" id="4752064">widths</span><span class="op" id="4752070">[</span><span class="num" id="4752071">0</span><span class="op" id="4752072">:</span><span class="num" id="4752073">0</span><span class="op" id="4752074">]</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4752077">b</span><span class="op" id="4752078">.</span><span class="ident" id="4752079">addLine</span><span class="op" id="4752086">(</span><span class="op" id="4752087">)</span><br>
<span class="lineno"></span><span class="op" id="4752089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4752092">//&nbsp;Internal&nbsp;representation&nbsp;(current&nbsp;state):</span><br>
<span class="lineno"></span><span class="comment" id="4752136">//</span><br>
<span class="lineno">110</span><span class="comment" id="4752139">//&nbsp;-&nbsp;all&nbsp;text&nbsp;written&nbsp;is&nbsp;appended&nbsp;to&nbsp;buf;&nbsp;tabs&nbsp;and&nbsp;line&nbsp;breaks&nbsp;are&nbsp;stripped&nbsp;away</span><br>
<span class="lineno"></span><span class="comment" id="4752220">//&nbsp;-&nbsp;at&nbsp;any&nbsp;given&nbsp;time&nbsp;there&nbsp;is&nbsp;a&nbsp;(possibly&nbsp;empty)&nbsp;incomplete&nbsp;cell&nbsp;at&nbsp;the&nbsp;end</span><br>
<span class="lineno"></span><span class="comment" id="4752298">//&nbsp;&nbsp;&nbsp;(the&nbsp;cell&nbsp;starts&nbsp;after&nbsp;a&nbsp;tab&nbsp;or&nbsp;line&nbsp;break)</span><br>
<span class="lineno"></span><span class="comment" id="4752347">//&nbsp;-&nbsp;cell.size&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;belonging&nbsp;to&nbsp;the&nbsp;cell&nbsp;so&nbsp;far</span><br>
<span class="lineno"></span><span class="comment" id="4752414">//&nbsp;-&nbsp;cell.width&nbsp;is&nbsp;text&nbsp;width&nbsp;in&nbsp;runes&nbsp;of&nbsp;that&nbsp;cell&nbsp;from&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;cell&nbsp;to</span><br>
<span class="lineno">115</span><span class="comment" id="4752496">//&nbsp;&nbsp;&nbsp;position&nbsp;pos;&nbsp;html&nbsp;tags&nbsp;and&nbsp;entities&nbsp;are&nbsp;excluded&nbsp;from&nbsp;this&nbsp;width&nbsp;if&nbsp;html</span><br>
<span class="lineno"></span><span class="comment" id="4752575">//&nbsp;&nbsp;&nbsp;filtering&nbsp;is&nbsp;enabled</span><br>
<span class="lineno"></span><span class="comment" id="4752601">//&nbsp;-&nbsp;the&nbsp;sizes&nbsp;and&nbsp;widths&nbsp;of&nbsp;processed&nbsp;text&nbsp;are&nbsp;kept&nbsp;in&nbsp;the&nbsp;lines&nbsp;list</span><br>
<span class="lineno"></span><span class="comment" id="4752672">//&nbsp;&nbsp;&nbsp;which&nbsp;contains&nbsp;a&nbsp;list&nbsp;of&nbsp;cells&nbsp;for&nbsp;each&nbsp;line</span><br>
<span class="lineno"></span><span class="comment" id="4752722">//&nbsp;-&nbsp;the&nbsp;widths&nbsp;list&nbsp;is&nbsp;a&nbsp;temporary&nbsp;list&nbsp;with&nbsp;current&nbsp;widths&nbsp;used&nbsp;during</span><br>
<span class="lineno">120</span><span class="comment" id="4752795">//&nbsp;&nbsp;&nbsp;formatting;&nbsp;it&nbsp;is&nbsp;kept&nbsp;in&nbsp;Writer&nbsp;because&nbsp;it&#39;s&nbsp;re-used</span><br>
<span class="lineno"></span><span class="comment" id="4752854">//</span><br>
<span class="lineno"></span><span class="comment" id="4752857">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&lt;----------&nbsp;size&nbsp;----------&gt;|</span><br>
<span class="lineno"></span><span class="comment" id="4752910">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="4752963">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&lt;-&nbsp;width&nbsp;-&gt;|&lt;-&nbsp;ignored&nbsp;-&gt;|&nbsp;&nbsp;|</span><br>
<span class="lineno">125</span><span class="comment" id="4753016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="4753069">//&nbsp;[---processed---tab------------&lt;tag&gt;...&lt;/tag&gt;...]</span><br>
<span class="lineno"></span><span class="comment" id="4753122">//&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^</span><br>
<span class="lineno"></span><span class="comment" id="4753172">//&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="4753222">//&nbsp;buf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;of&nbsp;incomplete&nbsp;cell&nbsp;&nbsp;pos</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4753275">//&nbsp;Formatting&nbsp;can&nbsp;be&nbsp;controlled&nbsp;with&nbsp;these&nbsp;flags.</span><br>
<span class="lineno"></span><span class="keyword" id="4753325">const</span>&nbsp;<span class="op" id="4753331">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753334">//&nbsp;Ignore&nbsp;html&nbsp;tags&nbsp;and&nbsp;treat&nbsp;entities&nbsp;(starting&nbsp;with&nbsp;&#39;&amp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753393">//&nbsp;and&nbsp;ending&nbsp;in&nbsp;&#39;;&#39;)&nbsp;as&nbsp;single&nbsp;characters&nbsp;(width&nbsp;=&nbsp;1).</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753450">FilterHTML</span>&nbsp;<span class="builtintype" id="4753461">uint</span>&nbsp;<span class="op" id="4753466">=</span>&nbsp;<span class="num" id="4753468">1</span>&nbsp;<span class="op" id="4753470">&lt;&lt;</span>&nbsp;<span class="ident" id="4753473">iota</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753480">//&nbsp;Strip&nbsp;Escape&nbsp;characters&nbsp;bracketing&nbsp;escaped&nbsp;text&nbsp;segments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753541">//&nbsp;instead&nbsp;of&nbsp;passing&nbsp;them&nbsp;through&nbsp;unchanged&nbsp;with&nbsp;the&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753602">StripEscape</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753616">//&nbsp;Force&nbsp;right-alignment&nbsp;of&nbsp;cell&nbsp;content.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753659">//&nbsp;Default&nbsp;is&nbsp;left-alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753690">AlignRight</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753703">//&nbsp;Handle&nbsp;empty&nbsp;columns&nbsp;as&nbsp;if&nbsp;they&nbsp;were&nbsp;not&nbsp;present&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753759">//&nbsp;the&nbsp;input&nbsp;in&nbsp;the&nbsp;first&nbsp;place.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753793">DiscardEmptyColumns</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753815">//&nbsp;Always&nbsp;use&nbsp;tabs&nbsp;for&nbsp;indentation&nbsp;columns&nbsp;(i.e.,&nbsp;padding&nbsp;of</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753877">//&nbsp;leading&nbsp;empty&nbsp;cells&nbsp;on&nbsp;the&nbsp;left)&nbsp;independent&nbsp;of&nbsp;padchar.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4753938">TabIndent</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4753950">//&nbsp;Print&nbsp;a&nbsp;vertical&nbsp;bar&nbsp;(&#39;|&#39;)&nbsp;between&nbsp;columns&nbsp;(after&nbsp;formatting).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4754017">//&nbsp;Discarded&nbsp;columns&nbsp;appear&nbsp;as&nbsp;zero-width&nbsp;columns&nbsp;(&#34;||&#34;).</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4754076">Debug</span><br>
<span class="lineno"></span><span class="op" id="4754082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4754085">//&nbsp;A&nbsp;Writer&nbsp;must&nbsp;be&nbsp;initialized&nbsp;with&nbsp;a&nbsp;call&nbsp;to&nbsp;Init.&nbsp;The&nbsp;first&nbsp;parameter&nbsp;(output)</span><br>
<span class="lineno"></span><span class="comment" id="4754167">//&nbsp;specifies&nbsp;the&nbsp;filter&nbsp;output.&nbsp;The&nbsp;remaining&nbsp;parameters&nbsp;control&nbsp;the&nbsp;formatting:</span><br>
<span class="lineno">160</span><span class="comment" id="4754248">//</span><br>
<span class="lineno"></span><span class="comment" id="4754251">//&nbsp;&nbsp;&nbsp;&nbsp;minwidth&nbsp;&nbsp;&nbsp;&nbsp;minimal&nbsp;cell&nbsp;width&nbsp;including&nbsp;any&nbsp;padding</span><br>
<span class="lineno"></span><span class="comment" id="4754304">//&nbsp;&nbsp;&nbsp;&nbsp;tabwidth&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;of&nbsp;tab&nbsp;characters&nbsp;(equivalent&nbsp;number&nbsp;of&nbsp;spaces)</span><br>
<span class="lineno"></span><span class="comment" id="4754370">//&nbsp;&nbsp;&nbsp;&nbsp;padding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding&nbsp;added&nbsp;to&nbsp;a&nbsp;cell&nbsp;before&nbsp;computing&nbsp;its&nbsp;width</span><br>
<span class="lineno"></span><span class="comment" id="4754433">//&nbsp;&nbsp;&nbsp;&nbsp;padchar&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASCII&nbsp;char&nbsp;used&nbsp;for&nbsp;padding</span><br>
<span class="lineno">165</span><span class="comment" id="4754473">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;padchar&nbsp;==&nbsp;&#39;\t&#39;,&nbsp;the&nbsp;Writer&nbsp;will&nbsp;assume&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4754530">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;of&nbsp;a&nbsp;&#39;\t&#39;&nbsp;in&nbsp;the&nbsp;formatted&nbsp;output&nbsp;is&nbsp;tabwidth,</span><br>
<span class="lineno"></span><span class="comment" id="4754588">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;cells&nbsp;are&nbsp;left-aligned&nbsp;independent&nbsp;of&nbsp;align_left</span><br>
<span class="lineno"></span><span class="comment" id="4754646">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(for&nbsp;correct-looking&nbsp;results,&nbsp;tabwidth&nbsp;must&nbsp;correspond</span><br>
<span class="lineno"></span><span class="comment" id="4754706">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;tab&nbsp;width&nbsp;in&nbsp;the&nbsp;viewer&nbsp;displaying&nbsp;the&nbsp;result)</span><br>
<span class="lineno">170</span><span class="comment" id="4754765">//&nbsp;&nbsp;&nbsp;&nbsp;flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;formatting&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4754794">//</span><br>
<span class="lineno"></span><span class="keyword" id="4754797">func</span>&nbsp;<span class="op" id="4754802">(</span><span class="ident" id="4754803">b</span>&nbsp;<span class="op" id="4754805">*</span><span class="ident" id="4754806">Writer</span><span class="op" id="4754812">)</span>&nbsp;<span class="ident" id="4754814">Init</span><span class="op" id="4754818">(</span><span class="ident" id="4754819">output</span>&nbsp;<span class="ident" id="4754826">io</span><span class="op" id="4754828">.</span><span class="ident" id="4754829">Writer</span><span class="op" id="4754835">,</span>&nbsp;<span class="ident" id="4754837">minwidth</span><span class="op" id="4754845">,</span>&nbsp;<span class="ident" id="4754847">tabwidth</span><span class="op" id="4754855">,</span>&nbsp;<span class="ident" id="4754857">padding</span>&nbsp;<span class="builtintype" id="4754865">int</span><span class="op" id="4754868">,</span>&nbsp;<span class="ident" id="4754870">padchar</span>&nbsp;<span class="builtintype" id="4754878">byte</span><span class="op" id="4754882">,</span>&nbsp;<span class="ident" id="4754884">flags</span>&nbsp;<span class="builtintype" id="4754890">uint</span><span class="op" id="4754894">)</span>&nbsp;<span class="op" id="4754896">*</span><span class="ident" id="4754897">Writer</span>&nbsp;<span class="op" id="4754904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4754907">if</span>&nbsp;<span class="ident" id="4754910">minwidth</span>&nbsp;<span class="op" id="4754919">&lt;</span>&nbsp;<span class="num" id="4754921">0</span>&nbsp;<span class="op" id="4754923">||</span>&nbsp;<span class="ident" id="4754926">tabwidth</span>&nbsp;<span class="op" id="4754935">&lt;</span>&nbsp;<span class="num" id="4754937">0</span>&nbsp;<span class="op" id="4754939">||</span>&nbsp;<span class="ident" id="4754942">padding</span>&nbsp;<span class="op" id="4754950">&lt;</span>&nbsp;<span class="num" id="4754952">0</span>&nbsp;<span class="op" id="4754954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4754958">panic</span><span class="op" id="4754963">(</span><span class="string" id="4754964">&#34;negative&nbsp;minwidth,&nbsp;tabwidth,&nbsp;or&nbsp;padding&#34;</span><span class="op" id="4755005">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755011">b</span><span class="op" id="4755012">.</span><span class="ident" id="4755013">output</span>&nbsp;<span class="op" id="4755020">=</span>&nbsp;<span class="ident" id="4755022">output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755030">b</span><span class="op" id="4755031">.</span><span class="ident" id="4755032">minwidth</span>&nbsp;<span class="op" id="4755041">=</span>&nbsp;<span class="ident" id="4755043">minwidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755053">b</span><span class="op" id="4755054">.</span><span class="ident" id="4755055">tabwidth</span>&nbsp;<span class="op" id="4755064">=</span>&nbsp;<span class="ident" id="4755066">tabwidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755076">b</span><span class="op" id="4755077">.</span><span class="ident" id="4755078">padding</span>&nbsp;<span class="op" id="4755086">=</span>&nbsp;<span class="ident" id="4755088">padding</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755097">for</span>&nbsp;<span class="ident" id="4755101">i</span>&nbsp;<span class="op" id="4755103">:=</span>&nbsp;<span class="keyword" id="4755106">range</span>&nbsp;<span class="ident" id="4755112">b</span><span class="op" id="4755113">.</span><span class="ident" id="4755114">padbytes</span>&nbsp;<span class="op" id="4755123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755127">b</span><span class="op" id="4755128">.</span><span class="ident" id="4755129">padbytes</span><span class="op" id="4755137">[</span><span class="ident" id="4755138">i</span><span class="op" id="4755139">]</span>&nbsp;<span class="op" id="4755141">=</span>&nbsp;<span class="ident" id="4755143">padchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755155">if</span>&nbsp;<span class="ident" id="4755158">padchar</span>&nbsp;<span class="op" id="4755166">==</span>&nbsp;<span class="string" id="4755169">&#39;\t&#39;</span>&nbsp;<span class="op" id="4755174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4755178">//&nbsp;tab&nbsp;padding&nbsp;enforces&nbsp;left-alignment</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755219">flags</span>&nbsp;<span class="op" id="4755225">&amp;^=</span>&nbsp;<span class="ident" id="4755229">AlignRight</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755241">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755244">b</span><span class="op" id="4755245">.</span><span class="ident" id="4755246">flags</span>&nbsp;<span class="op" id="4755252">=</span>&nbsp;<span class="ident" id="4755254">flags</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755262">b</span><span class="op" id="4755263">.</span><span class="ident" id="4755264">reset</span><span class="op" id="4755269">(</span><span class="op" id="4755270">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755274">return</span>&nbsp;<span class="ident" id="4755281">b</span><br>
<span class="lineno"></span><span class="op" id="4755283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755286">//&nbsp;debugging&nbsp;support&nbsp;(keep&nbsp;code&nbsp;around)</span><br>
<span class="lineno">195</span><span class="keyword" id="4755326">func</span>&nbsp;<span class="op" id="4755331">(</span><span class="ident" id="4755332">b</span>&nbsp;<span class="op" id="4755334">*</span><span class="ident" id="4755335">Writer</span><span class="op" id="4755341">)</span>&nbsp;<span class="ident" id="4755343">dump</span><span class="op" id="4755347">(</span><span class="op" id="4755348">)</span>&nbsp;<span class="op" id="4755350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755353">pos</span>&nbsp;<span class="op" id="4755357">:=</span>&nbsp;<span class="num" id="4755360">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755363">for</span>&nbsp;<span class="ident" id="4755367">i</span><span class="op" id="4755368">,</span>&nbsp;<span class="ident" id="4755370">line</span>&nbsp;<span class="op" id="4755375">:=</span>&nbsp;<span class="keyword" id="4755378">range</span>&nbsp;<span class="ident" id="4755384">b</span><span class="op" id="4755385">.</span><span class="ident" id="4755386">lines</span>&nbsp;<span class="op" id="4755392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755396">print</span><span class="op" id="4755401">(</span><span class="string" id="4755402">&#34;(&#34;</span><span class="op" id="4755405">,</span>&nbsp;<span class="ident" id="4755407">i</span><span class="op" id="4755408">,</span>&nbsp;<span class="string" id="4755410">&#34;)&nbsp;&#34;</span><span class="op" id="4755414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755418">for</span>&nbsp;<span class="ident" id="4755422">_</span><span class="op" id="4755423">,</span>&nbsp;<span class="ident" id="4755425">c</span>&nbsp;<span class="op" id="4755427">:=</span>&nbsp;<span class="keyword" id="4755430">range</span>&nbsp;<span class="ident" id="4755436">line</span>&nbsp;<span class="op" id="4755441">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755446">print</span><span class="op" id="4755451">(</span><span class="string" id="4755452">&#34;[&#34;</span><span class="op" id="4755455">,</span>&nbsp;<span class="builtintype" id="4755457">string</span><span class="op" id="4755463">(</span><span class="ident" id="4755464">b</span><span class="op" id="4755465">.</span><span class="ident" id="4755466">buf</span><span class="op" id="4755469">.</span><span class="ident" id="4755470">Bytes</span><span class="op" id="4755475">(</span><span class="op" id="4755476">)</span><span class="op" id="4755477">[</span><span class="ident" id="4755478">pos</span><span class="op" id="4755481">:</span><span class="ident" id="4755482">pos</span><span class="op" id="4755485">+</span><span class="ident" id="4755486">c</span><span class="op" id="4755487">.</span><span class="ident" id="4755488">size</span><span class="op" id="4755492">]</span><span class="op" id="4755493">)</span><span class="op" id="4755494">,</span>&nbsp;<span class="string" id="4755496">&#34;]&#34;</span><span class="op" id="4755499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755504">pos</span>&nbsp;<span class="op" id="4755508">+=</span>&nbsp;<span class="ident" id="4755511">c</span><span class="op" id="4755512">.</span><span class="ident" id="4755513">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755524">print</span><span class="op" id="4755529">(</span><span class="string" id="4755530">&#34;\n&#34;</span><span class="op" id="4755534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755537">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755540">print</span><span class="op" id="4755545">(</span><span class="string" id="4755546">&#34;\n&#34;</span><span class="op" id="4755550">)</span><br>
<span class="lineno"></span><span class="op" id="4755552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4755555">//&nbsp;local&nbsp;error&nbsp;wrapper&nbsp;so&nbsp;we&nbsp;can&nbsp;distinguish&nbsp;errors&nbsp;we&nbsp;want&nbsp;to&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4755625">//&nbsp;as&nbsp;errors&nbsp;from&nbsp;genuine&nbsp;panics&nbsp;(which&nbsp;we&nbsp;don&#39;t&nbsp;want&nbsp;to&nbsp;return&nbsp;as&nbsp;errors)</span><br>
<span class="lineno">210</span><span class="keyword" id="4755700">type</span>&nbsp;<span class="ident" id="4755705">osError</span>&nbsp;<span class="keyword" id="4755713">struct</span>&nbsp;<span class="op" id="4755720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755723">err</span>&nbsp;<span class="builtintype" id="4755727">error</span><br>
<span class="lineno"></span><span class="op" id="4755733">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4755736">func</span>&nbsp;<span class="op" id="4755741">(</span><span class="ident" id="4755742">b</span>&nbsp;<span class="op" id="4755744">*</span><span class="ident" id="4755745">Writer</span><span class="op" id="4755751">)</span>&nbsp;<span class="ident" id="4755753">write0</span><span class="op" id="4755759">(</span><span class="ident" id="4755760">buf</span>&nbsp;<span class="op" id="4755764">[</span><span class="op" id="4755765">]</span><span class="builtintype" id="4755766">byte</span><span class="op" id="4755770">)</span>&nbsp;<span class="op" id="4755772">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755775">n</span><span class="op" id="4755776">,</span>&nbsp;<span class="ident" id="4755778">err</span>&nbsp;<span class="op" id="4755782">:=</span>&nbsp;<span class="ident" id="4755785">b</span><span class="op" id="4755786">.</span><span class="ident" id="4755787">output</span><span class="op" id="4755793">.</span><span class="ident" id="4755794">Write</span><span class="op" id="4755799">(</span><span class="ident" id="4755800">buf</span><span class="op" id="4755803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755806">if</span>&nbsp;<span class="ident" id="4755809">n</span>&nbsp;<span class="op" id="4755811">!=</span>&nbsp;<span class="builtinfunc" id="4755814">len</span><span class="op" id="4755817">(</span><span class="ident" id="4755818">buf</span><span class="op" id="4755821">)</span>&nbsp;<span class="op" id="4755823">&amp;&amp;</span>&nbsp;<span class="ident" id="4755826">err</span>&nbsp;<span class="op" id="4755830">==</span>&nbsp;<span class="builtintype" id="4755833">nil</span>&nbsp;<span class="op" id="4755837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755841">err</span>&nbsp;<span class="op" id="4755845">=</span>&nbsp;<span class="ident" id="4755847">io</span><span class="op" id="4755849">.</span><span class="ident" id="4755850">ErrShortWrite</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755868">if</span>&nbsp;<span class="ident" id="4755871">err</span>&nbsp;<span class="op" id="4755875">!=</span>&nbsp;<span class="builtintype" id="4755878">nil</span>&nbsp;<span class="op" id="4755882">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4755886">panic</span><span class="op" id="4755891">(</span><span class="ident" id="4755892">osError</span><span class="op" id="4755899">{</span><span class="ident" id="4755900">err</span><span class="op" id="4755903">}</span><span class="op" id="4755904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4755907">}</span><br>
<span class="lineno"></span><span class="op" id="4755909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4755912">func</span>&nbsp;<span class="op" id="4755917">(</span><span class="ident" id="4755918">b</span>&nbsp;<span class="op" id="4755920">*</span><span class="ident" id="4755921">Writer</span><span class="op" id="4755927">)</span>&nbsp;<span class="ident" id="4755929">writeN</span><span class="op" id="4755935">(</span><span class="ident" id="4755936">src</span>&nbsp;<span class="op" id="4755940">[</span><span class="op" id="4755941">]</span><span class="builtintype" id="4755942">byte</span><span class="op" id="4755946">,</span>&nbsp;<span class="ident" id="4755948">n</span>&nbsp;<span class="builtintype" id="4755950">int</span><span class="op" id="4755953">)</span>&nbsp;<span class="op" id="4755955">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4755958">for</span>&nbsp;<span class="ident" id="4755962">n</span>&nbsp;<span class="op" id="4755964">&gt;</span>&nbsp;<span class="builtinfunc" id="4755966">len</span><span class="op" id="4755969">(</span><span class="ident" id="4755970">src</span><span class="op" id="4755973">)</span>&nbsp;<span class="op" id="4755975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755979">b</span><span class="op" id="4755980">.</span><span class="ident" id="4755981">write0</span><span class="op" id="4755987">(</span><span class="ident" id="4755988">src</span><span class="op" id="4755991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4755995">n</span>&nbsp;<span class="op" id="4755997">-=</span>&nbsp;<span class="builtinfunc" id="4756000">len</span><span class="op" id="4756003">(</span><span class="ident" id="4756004">src</span><span class="op" id="4756007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756013">b</span><span class="op" id="4756014">.</span><span class="ident" id="4756015">write0</span><span class="op" id="4756021">(</span><span class="ident" id="4756022">src</span><span class="op" id="4756025">[</span><span class="num" id="4756026">0</span><span class="op" id="4756027">:</span><span class="ident" id="4756028">n</span><span class="op" id="4756029">]</span><span class="op" id="4756030">)</span><br>
<span class="lineno">230</span><span class="op" id="4756032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756035">var</span>&nbsp;<span class="op" id="4756039">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756042">newline</span>&nbsp;<span class="op" id="4756050">=</span>&nbsp;<span class="op" id="4756052">[</span><span class="op" id="4756053">]</span><span class="builtintype" id="4756054">byte</span><span class="op" id="4756058">{</span><span class="string" id="4756059">&#39;\n&#39;</span><span class="op" id="4756063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756066">tabs</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756074">=</span>&nbsp;<span class="op" id="4756076">[</span><span class="op" id="4756077">]</span><span class="builtintype" id="4756078">byte</span><span class="op" id="4756082">(</span><span class="string" id="4756083">&#34;\t\t\t\t\t\t\t\t&#34;</span><span class="op" id="4756101">)</span><br>
<span class="lineno">235</span><span class="op" id="4756103">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756106">func</span>&nbsp;<span class="op" id="4756111">(</span><span class="ident" id="4756112">b</span>&nbsp;<span class="op" id="4756114">*</span><span class="ident" id="4756115">Writer</span><span class="op" id="4756121">)</span>&nbsp;<span class="ident" id="4756123">writePadding</span><span class="op" id="4756135">(</span><span class="ident" id="4756136">textw</span><span class="op" id="4756141">,</span>&nbsp;<span class="ident" id="4756143">cellw</span>&nbsp;<span class="builtintype" id="4756149">int</span><span class="op" id="4756152">,</span>&nbsp;<span class="ident" id="4756154">useTabs</span>&nbsp;<span class="builtintype" id="4756162">bool</span><span class="op" id="4756166">)</span>&nbsp;<span class="op" id="4756168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756171">if</span>&nbsp;<span class="ident" id="4756174">b</span><span class="op" id="4756175">.</span><span class="ident" id="4756176">padbytes</span><span class="op" id="4756184">[</span><span class="num" id="4756185">0</span><span class="op" id="4756186">]</span>&nbsp;<span class="op" id="4756188">==</span>&nbsp;<span class="string" id="4756191">&#39;\t&#39;</span>&nbsp;<span class="op" id="4756196">||</span>&nbsp;<span class="ident" id="4756199">useTabs</span>&nbsp;<span class="op" id="4756207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756211">//&nbsp;padding&nbsp;is&nbsp;done&nbsp;with&nbsp;tabs</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756242">if</span>&nbsp;<span class="ident" id="4756245">b</span><span class="op" id="4756246">.</span><span class="ident" id="4756247">tabwidth</span>&nbsp;<span class="op" id="4756256">==</span>&nbsp;<span class="num" id="4756259">0</span>&nbsp;<span class="op" id="4756261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756266">return</span>&nbsp;<span class="comment" id="4756273">//&nbsp;tabs&nbsp;have&nbsp;no&nbsp;width&nbsp;-&nbsp;can&#39;t&nbsp;do&nbsp;any&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756324">//&nbsp;make&nbsp;cellw&nbsp;the&nbsp;smallest&nbsp;multiple&nbsp;of&nbsp;b.tabwidth</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756376">cellw</span>&nbsp;<span class="op" id="4756382">=</span>&nbsp;<span class="op" id="4756384">(</span><span class="ident" id="4756385">cellw</span>&nbsp;<span class="op" id="4756391">+</span>&nbsp;<span class="ident" id="4756393">b</span><span class="op" id="4756394">.</span><span class="ident" id="4756395">tabwidth</span>&nbsp;<span class="op" id="4756404">-</span>&nbsp;<span class="num" id="4756406">1</span><span class="op" id="4756407">)</span>&nbsp;<span class="op" id="4756409">/</span>&nbsp;<span class="ident" id="4756411">b</span><span class="op" id="4756412">.</span><span class="ident" id="4756413">tabwidth</span>&nbsp;<span class="op" id="4756422">*</span>&nbsp;<span class="ident" id="4756424">b</span><span class="op" id="4756425">.</span><span class="ident" id="4756426">tabwidth</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756437">n</span>&nbsp;<span class="op" id="4756439">:=</span>&nbsp;<span class="ident" id="4756442">cellw</span>&nbsp;<span class="op" id="4756448">-</span>&nbsp;<span class="ident" id="4756450">textw</span>&nbsp;<span class="comment" id="4756456">//&nbsp;amount&nbsp;of&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756479">if</span>&nbsp;<span class="ident" id="4756482">n</span>&nbsp;<span class="op" id="4756484">&lt;</span>&nbsp;<span class="num" id="4756486">0</span>&nbsp;<span class="op" id="4756488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4756493">panic</span><span class="op" id="4756498">(</span><span class="string" id="4756499">&#34;internal&nbsp;error&#34;</span><span class="op" id="4756515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756523">b</span><span class="op" id="4756524">.</span><span class="ident" id="4756525">writeN</span><span class="op" id="4756531">(</span><span class="ident" id="4756532">tabs</span><span class="op" id="4756536">,</span>&nbsp;<span class="op" id="4756538">(</span><span class="ident" id="4756539">n</span><span class="op" id="4756540">+</span><span class="ident" id="4756541">b</span><span class="op" id="4756542">.</span><span class="ident" id="4756543">tabwidth</span><span class="op" id="4756551">-</span><span class="num" id="4756552">1</span><span class="op" id="4756553">)</span><span class="op" id="4756554">/</span><span class="ident" id="4756555">b</span><span class="op" id="4756556">.</span><span class="ident" id="4756557">tabwidth</span><span class="op" id="4756565">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756569">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4756577">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756581">//&nbsp;padding&nbsp;is&nbsp;done&nbsp;with&nbsp;non-tab&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756625">b</span><span class="op" id="4756626">.</span><span class="ident" id="4756627">writeN</span><span class="op" id="4756633">(</span><span class="ident" id="4756634">b</span><span class="op" id="4756635">.</span><span class="ident" id="4756636">padbytes</span><span class="op" id="4756644">[</span><span class="num" id="4756645">0</span><span class="op" id="4756646">:</span><span class="op" id="4756647">]</span><span class="op" id="4756648">,</span>&nbsp;<span class="ident" id="4756650">cellw</span><span class="op" id="4756655">-</span><span class="ident" id="4756656">textw</span><span class="op" id="4756661">)</span><br>
<span class="lineno">255</span><span class="op" id="4756663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756666">var</span>&nbsp;<span class="ident" id="4756670">vbar</span>&nbsp;<span class="op" id="4756675">=</span>&nbsp;<span class="op" id="4756677">[</span><span class="op" id="4756678">]</span><span class="builtintype" id="4756679">byte</span><span class="op" id="4756683">{</span><span class="string" id="4756684">&#39;|&#39;</span><span class="op" id="4756687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4756690">func</span>&nbsp;<span class="op" id="4756695">(</span><span class="ident" id="4756696">b</span>&nbsp;<span class="op" id="4756698">*</span><span class="ident" id="4756699">Writer</span><span class="op" id="4756705">)</span>&nbsp;<span class="ident" id="4756707">writeLines</span><span class="op" id="4756717">(</span><span class="ident" id="4756718">pos0</span>&nbsp;<span class="builtintype" id="4756723">int</span><span class="op" id="4756726">,</span>&nbsp;<span class="ident" id="4756728">line0</span><span class="op" id="4756733">,</span>&nbsp;<span class="ident" id="4756735">line1</span>&nbsp;<span class="builtintype" id="4756741">int</span><span class="op" id="4756744">)</span>&nbsp;<span class="op" id="4756746">(</span><span class="ident" id="4756747">pos</span>&nbsp;<span class="builtintype" id="4756751">int</span><span class="op" id="4756754">)</span>&nbsp;<span class="op" id="4756756">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756759">pos</span>&nbsp;<span class="op" id="4756763">=</span>&nbsp;<span class="ident" id="4756765">pos0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756771">for</span>&nbsp;<span class="ident" id="4756775">i</span>&nbsp;<span class="op" id="4756777">:=</span>&nbsp;<span class="ident" id="4756780">line0</span><span class="op" id="4756785">;</span>&nbsp;<span class="ident" id="4756787">i</span>&nbsp;<span class="op" id="4756789">&lt;</span>&nbsp;<span class="ident" id="4756791">line1</span><span class="op" id="4756796">;</span>&nbsp;<span class="ident" id="4756798">i</span><span class="op" id="4756799">++</span>&nbsp;<span class="op" id="4756802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756806">line</span>&nbsp;<span class="op" id="4756811">:=</span>&nbsp;<span class="ident" id="4756814">b</span><span class="op" id="4756815">.</span><span class="ident" id="4756816">lines</span><span class="op" id="4756821">[</span><span class="ident" id="4756822">i</span><span class="op" id="4756823">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756828">//&nbsp;if&nbsp;TabIndent&nbsp;is&nbsp;set,&nbsp;use&nbsp;tabs&nbsp;to&nbsp;pad&nbsp;leading&nbsp;empty&nbsp;cells</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4756890">useTabs</span>&nbsp;<span class="op" id="4756898">:=</span>&nbsp;<span class="ident" id="4756901">b</span><span class="op" id="4756902">.</span><span class="ident" id="4756903">flags</span><span class="op" id="4756908">&amp;</span><span class="ident" id="4756909">TabIndent</span>&nbsp;<span class="op" id="4756919">!=</span>&nbsp;<span class="num" id="4756922">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756927">for</span>&nbsp;<span class="ident" id="4756931">j</span><span class="op" id="4756932">,</span>&nbsp;<span class="ident" id="4756934">c</span>&nbsp;<span class="op" id="4756936">:=</span>&nbsp;<span class="keyword" id="4756939">range</span>&nbsp;<span class="ident" id="4756945">line</span>&nbsp;<span class="op" id="4756950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4756955">if</span>&nbsp;<span class="ident" id="4756958">j</span>&nbsp;<span class="op" id="4756960">&gt;</span>&nbsp;<span class="num" id="4756962">0</span>&nbsp;<span class="op" id="4756964">&amp;&amp;</span>&nbsp;<span class="ident" id="4756967">b</span><span class="op" id="4756968">.</span><span class="ident" id="4756969">flags</span><span class="op" id="4756974">&amp;</span><span class="ident" id="4756975">Debug</span>&nbsp;<span class="op" id="4756981">!=</span>&nbsp;<span class="num" id="4756984">0</span>&nbsp;<span class="op" id="4756986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4756992">//&nbsp;indicate&nbsp;column&nbsp;break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757021">b</span><span class="op" id="4757022">.</span><span class="ident" id="4757023">write0</span><span class="op" id="4757029">(</span><span class="ident" id="4757030">vbar</span><span class="op" id="4757034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757045">if</span>&nbsp;<span class="ident" id="4757048">c</span><span class="op" id="4757049">.</span><span class="ident" id="4757050">size</span>&nbsp;<span class="op" id="4757055">==</span>&nbsp;<span class="num" id="4757058">0</span>&nbsp;<span class="op" id="4757060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757066">//&nbsp;empty&nbsp;cell</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757084">if</span>&nbsp;<span class="ident" id="4757087">j</span>&nbsp;<span class="op" id="4757089">&lt;</span>&nbsp;<span class="builtinfunc" id="4757091">len</span><span class="op" id="4757094">(</span><span class="ident" id="4757095">b</span><span class="op" id="4757096">.</span><span class="ident" id="4757097">widths</span><span class="op" id="4757103">)</span>&nbsp;<span class="op" id="4757105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757112">b</span><span class="op" id="4757113">.</span><span class="ident" id="4757114">writePadding</span><span class="op" id="4757126">(</span><span class="ident" id="4757127">c</span><span class="op" id="4757128">.</span><span class="ident" id="4757129">width</span><span class="op" id="4757134">,</span>&nbsp;<span class="ident" id="4757136">b</span><span class="op" id="4757137">.</span><span class="ident" id="4757138">widths</span><span class="op" id="4757144">[</span><span class="ident" id="4757145">j</span><span class="op" id="4757146">]</span><span class="op" id="4757147">,</span>&nbsp;<span class="ident" id="4757149">useTabs</span><span class="op" id="4757156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757167">}</span>&nbsp;<span class="keyword" id="4757169">else</span>&nbsp;<span class="op" id="4757174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757180">//&nbsp;non-empty&nbsp;cell</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757202">useTabs</span>&nbsp;<span class="op" id="4757210">=</span>&nbsp;<span class="builtintype" id="4757212">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757222">if</span>&nbsp;<span class="ident" id="4757225">b</span><span class="op" id="4757226">.</span><span class="ident" id="4757227">flags</span><span class="op" id="4757232">&amp;</span><span class="ident" id="4757233">AlignRight</span>&nbsp;<span class="op" id="4757244">==</span>&nbsp;<span class="num" id="4757247">0</span>&nbsp;<span class="op" id="4757249">{</span>&nbsp;<span class="comment" id="4757251">//&nbsp;align&nbsp;left</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757270">b</span><span class="op" id="4757271">.</span><span class="ident" id="4757272">write0</span><span class="op" id="4757278">(</span><span class="ident" id="4757279">b</span><span class="op" id="4757280">.</span><span class="ident" id="4757281">buf</span><span class="op" id="4757284">.</span><span class="ident" id="4757285">Bytes</span><span class="op" id="4757290">(</span><span class="op" id="4757291">)</span><span class="op" id="4757292">[</span><span class="ident" id="4757293">pos</span>&nbsp;<span class="op" id="4757297">:</span>&nbsp;<span class="ident" id="4757299">pos</span><span class="op" id="4757302">+</span><span class="ident" id="4757303">c</span><span class="op" id="4757304">.</span><span class="ident" id="4757305">size</span><span class="op" id="4757309">]</span><span class="op" id="4757310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757317">pos</span>&nbsp;<span class="op" id="4757321">+=</span>&nbsp;<span class="ident" id="4757324">c</span><span class="op" id="4757325">.</span><span class="ident" id="4757326">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757336">if</span>&nbsp;<span class="ident" id="4757339">j</span>&nbsp;<span class="op" id="4757341">&lt;</span>&nbsp;<span class="builtinfunc" id="4757343">len</span><span class="op" id="4757346">(</span><span class="ident" id="4757347">b</span><span class="op" id="4757348">.</span><span class="ident" id="4757349">widths</span><span class="op" id="4757355">)</span>&nbsp;<span class="op" id="4757357">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757365">b</span><span class="op" id="4757366">.</span><span class="ident" id="4757367">writePadding</span><span class="op" id="4757379">(</span><span class="ident" id="4757380">c</span><span class="op" id="4757381">.</span><span class="ident" id="4757382">width</span><span class="op" id="4757387">,</span>&nbsp;<span class="ident" id="4757389">b</span><span class="op" id="4757390">.</span><span class="ident" id="4757391">widths</span><span class="op" id="4757397">[</span><span class="ident" id="4757398">j</span><span class="op" id="4757399">]</span><span class="op" id="4757400">,</span>&nbsp;<span class="builtintype" id="4757402">false</span><span class="op" id="4757407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757420">}</span>&nbsp;<span class="keyword" id="4757422">else</span>&nbsp;<span class="op" id="4757427">{</span>&nbsp;<span class="comment" id="4757429">//&nbsp;align&nbsp;right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757449">if</span>&nbsp;<span class="ident" id="4757452">j</span>&nbsp;<span class="op" id="4757454">&lt;</span>&nbsp;<span class="builtinfunc" id="4757456">len</span><span class="op" id="4757459">(</span><span class="ident" id="4757460">b</span><span class="op" id="4757461">.</span><span class="ident" id="4757462">widths</span><span class="op" id="4757468">)</span>&nbsp;<span class="op" id="4757470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757478">b</span><span class="op" id="4757479">.</span><span class="ident" id="4757480">writePadding</span><span class="op" id="4757492">(</span><span class="ident" id="4757493">c</span><span class="op" id="4757494">.</span><span class="ident" id="4757495">width</span><span class="op" id="4757500">,</span>&nbsp;<span class="ident" id="4757502">b</span><span class="op" id="4757503">.</span><span class="ident" id="4757504">widths</span><span class="op" id="4757510">[</span><span class="ident" id="4757511">j</span><span class="op" id="4757512">]</span><span class="op" id="4757513">,</span>&nbsp;<span class="builtintype" id="4757515">false</span><span class="op" id="4757520">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757534">b</span><span class="op" id="4757535">.</span><span class="ident" id="4757536">write0</span><span class="op" id="4757542">(</span><span class="ident" id="4757543">b</span><span class="op" id="4757544">.</span><span class="ident" id="4757545">buf</span><span class="op" id="4757548">.</span><span class="ident" id="4757549">Bytes</span><span class="op" id="4757554">(</span><span class="op" id="4757555">)</span><span class="op" id="4757556">[</span><span class="ident" id="4757557">pos</span>&nbsp;<span class="op" id="4757561">:</span>&nbsp;<span class="ident" id="4757563">pos</span><span class="op" id="4757566">+</span><span class="ident" id="4757567">c</span><span class="op" id="4757568">.</span><span class="ident" id="4757569">size</span><span class="op" id="4757573">]</span><span class="op" id="4757574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757581">pos</span>&nbsp;<span class="op" id="4757585">+=</span>&nbsp;<span class="ident" id="4757588">c</span><span class="op" id="4757589">.</span><span class="ident" id="4757590">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757604">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757613">if</span>&nbsp;<span class="ident" id="4757616">i</span><span class="op" id="4757617">+</span><span class="num" id="4757618">1</span>&nbsp;<span class="op" id="4757620">==</span>&nbsp;<span class="builtinfunc" id="4757623">len</span><span class="op" id="4757626">(</span><span class="ident" id="4757627">b</span><span class="op" id="4757628">.</span><span class="ident" id="4757629">lines</span><span class="op" id="4757634">)</span>&nbsp;<span class="op" id="4757636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757641">//&nbsp;last&nbsp;buffered&nbsp;line&nbsp;-&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;a&nbsp;newline,&nbsp;so&nbsp;just&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757707">//&nbsp;any&nbsp;outstanding&nbsp;buffered&nbsp;data</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757743">b</span><span class="op" id="4757744">.</span><span class="ident" id="4757745">write0</span><span class="op" id="4757751">(</span><span class="ident" id="4757752">b</span><span class="op" id="4757753">.</span><span class="ident" id="4757754">buf</span><span class="op" id="4757757">.</span><span class="ident" id="4757758">Bytes</span><span class="op" id="4757763">(</span><span class="op" id="4757764">)</span><span class="op" id="4757765">[</span><span class="ident" id="4757766">pos</span>&nbsp;<span class="op" id="4757770">:</span>&nbsp;<span class="ident" id="4757772">pos</span><span class="op" id="4757775">+</span><span class="ident" id="4757776">b</span><span class="op" id="4757777">.</span><span class="ident" id="4757778">cell</span><span class="op" id="4757782">.</span><span class="ident" id="4757783">size</span><span class="op" id="4757787">]</span><span class="op" id="4757788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757793">pos</span>&nbsp;<span class="op" id="4757797">+=</span>&nbsp;<span class="ident" id="4757800">b</span><span class="op" id="4757801">.</span><span class="ident" id="4757802">cell</span><span class="op" id="4757806">.</span><span class="ident" id="4757807">size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757814">}</span>&nbsp;<span class="keyword" id="4757816">else</span>&nbsp;<span class="op" id="4757821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4757826">//&nbsp;not&nbsp;the&nbsp;last&nbsp;line&nbsp;-&nbsp;write&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4757866">b</span><span class="op" id="4757867">.</span><span class="ident" id="4757868">write0</span><span class="op" id="4757874">(</span><span class="ident" id="4757875">newline</span><span class="op" id="4757882">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4757889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4757892">return</span><br>
<span class="lineno"></span><span class="op" id="4757899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4757902">//&nbsp;Format&nbsp;the&nbsp;text&nbsp;between&nbsp;line0&nbsp;and&nbsp;line1&nbsp;(excluding&nbsp;line1);&nbsp;pos</span><br>
<span class="lineno"></span><span class="comment" id="4757968">//&nbsp;is&nbsp;the&nbsp;buffer&nbsp;position&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of&nbsp;line0.</span><br>
<span class="lineno"></span><span class="comment" id="4758035">//&nbsp;Returns&nbsp;the&nbsp;buffer&nbsp;position&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;beginning&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4758100">//&nbsp;line1&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="comment" id="4758131">//</span><br>
<span class="lineno">315</span><span class="keyword" id="4758134">func</span>&nbsp;<span class="op" id="4758139">(</span><span class="ident" id="4758140">b</span>&nbsp;<span class="op" id="4758142">*</span><span class="ident" id="4758143">Writer</span><span class="op" id="4758149">)</span>&nbsp;<span class="ident" id="4758151">format</span><span class="op" id="4758157">(</span><span class="ident" id="4758158">pos0</span>&nbsp;<span class="builtintype" id="4758163">int</span><span class="op" id="4758166">,</span>&nbsp;<span class="ident" id="4758168">line0</span><span class="op" id="4758173">,</span>&nbsp;<span class="ident" id="4758175">line1</span>&nbsp;<span class="builtintype" id="4758181">int</span><span class="op" id="4758184">)</span>&nbsp;<span class="op" id="4758186">(</span><span class="ident" id="4758187">pos</span>&nbsp;<span class="builtintype" id="4758191">int</span><span class="op" id="4758194">)</span>&nbsp;<span class="op" id="4758196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758199">pos</span>&nbsp;<span class="op" id="4758203">=</span>&nbsp;<span class="ident" id="4758205">pos0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758211">column</span>&nbsp;<span class="op" id="4758218">:=</span>&nbsp;<span class="builtinfunc" id="4758221">len</span><span class="op" id="4758224">(</span><span class="ident" id="4758225">b</span><span class="op" id="4758226">.</span><span class="ident" id="4758227">widths</span><span class="op" id="4758233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758236">for</span>&nbsp;<span class="ident" id="4758240">this</span>&nbsp;<span class="op" id="4758245">:=</span>&nbsp;<span class="ident" id="4758248">line0</span><span class="op" id="4758253">;</span>&nbsp;<span class="ident" id="4758255">this</span>&nbsp;<span class="op" id="4758260">&lt;</span>&nbsp;<span class="ident" id="4758262">line1</span><span class="op" id="4758267">;</span>&nbsp;<span class="ident" id="4758269">this</span><span class="op" id="4758273">++</span>&nbsp;<span class="op" id="4758276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758280">line</span>&nbsp;<span class="op" id="4758285">:=</span>&nbsp;<span class="ident" id="4758288">b</span><span class="op" id="4758289">.</span><span class="ident" id="4758290">lines</span><span class="op" id="4758295">[</span><span class="ident" id="4758296">this</span><span class="op" id="4758300">]</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758305">if</span>&nbsp;<span class="ident" id="4758308">column</span>&nbsp;<span class="op" id="4758315">&lt;</span>&nbsp;<span class="builtinfunc" id="4758317">len</span><span class="op" id="4758320">(</span><span class="ident" id="4758321">line</span><span class="op" id="4758325">)</span><span class="op" id="4758326">-</span><span class="num" id="4758327">1</span>&nbsp;<span class="op" id="4758329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758334">//&nbsp;cell&nbsp;exists&nbsp;in&nbsp;this&nbsp;column&nbsp;=&gt;&nbsp;this&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758380">//&nbsp;has&nbsp;more&nbsp;cells&nbsp;than&nbsp;the&nbsp;previous&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758424">//&nbsp;(the&nbsp;last&nbsp;cell&nbsp;per&nbsp;line&nbsp;is&nbsp;ignored&nbsp;because&nbsp;cells&nbsp;are</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758483">//&nbsp;tab-terminated;&nbsp;the&nbsp;last&nbsp;cell&nbsp;per&nbsp;line&nbsp;describes&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758542">//&nbsp;text&nbsp;before&nbsp;the&nbsp;newline/formfeed&nbsp;and&nbsp;does&nbsp;not&nbsp;belong</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758601">//&nbsp;to&nbsp;a&nbsp;column)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758621">//&nbsp;print&nbsp;unprinted&nbsp;lines&nbsp;until&nbsp;beginning&nbsp;of&nbsp;block</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758674">pos</span>&nbsp;<span class="op" id="4758678">=</span>&nbsp;<span class="ident" id="4758680">b</span><span class="op" id="4758681">.</span><span class="ident" id="4758682">writeLines</span><span class="op" id="4758692">(</span><span class="ident" id="4758693">pos</span><span class="op" id="4758696">,</span>&nbsp;<span class="ident" id="4758698">line0</span><span class="op" id="4758703">,</span>&nbsp;<span class="ident" id="4758705">this</span><span class="op" id="4758709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758714">line0</span>&nbsp;<span class="op" id="4758720">=</span>&nbsp;<span class="ident" id="4758722">this</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758731">//&nbsp;column&nbsp;block&nbsp;begin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758756">width</span>&nbsp;<span class="op" id="4758762">:=</span>&nbsp;<span class="ident" id="4758765">b</span><span class="op" id="4758766">.</span><span class="ident" id="4758767">minwidth</span>&nbsp;<span class="comment" id="4758776">//&nbsp;minimal&nbsp;column&nbsp;width</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758803">discardable</span>&nbsp;<span class="op" id="4758815">:=</span>&nbsp;<span class="builtintype" id="4758818">true</span>&nbsp;<span class="comment" id="4758823">//&nbsp;true&nbsp;if&nbsp;all&nbsp;cells&nbsp;in&nbsp;this&nbsp;column&nbsp;are&nbsp;empty&nbsp;and&nbsp;&#34;soft&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758883">for</span>&nbsp;<span class="op" id="4758887">;</span>&nbsp;<span class="ident" id="4758889">this</span>&nbsp;<span class="op" id="4758894">&lt;</span>&nbsp;<span class="ident" id="4758896">line1</span><span class="op" id="4758901">;</span>&nbsp;<span class="ident" id="4758903">this</span><span class="op" id="4758907">++</span>&nbsp;<span class="op" id="4758910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4758916">line</span>&nbsp;<span class="op" id="4758921">=</span>&nbsp;<span class="ident" id="4758923">b</span><span class="op" id="4758924">.</span><span class="ident" id="4758925">lines</span><span class="op" id="4758930">[</span><span class="ident" id="4758931">this</span><span class="op" id="4758935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4758941">if</span>&nbsp;<span class="ident" id="4758944">column</span>&nbsp;<span class="op" id="4758951">&lt;</span>&nbsp;<span class="builtinfunc" id="4758953">len</span><span class="op" id="4758956">(</span><span class="ident" id="4758957">line</span><span class="op" id="4758961">)</span><span class="op" id="4758962">-</span><span class="num" id="4758963">1</span>&nbsp;<span class="op" id="4758965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4758972">//&nbsp;cell&nbsp;exists&nbsp;in&nbsp;this&nbsp;column</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759007">c</span>&nbsp;<span class="op" id="4759009">:=</span>&nbsp;<span class="ident" id="4759012">line</span><span class="op" id="4759016">[</span><span class="ident" id="4759017">column</span><span class="op" id="4759023">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759030">//&nbsp;update&nbsp;width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759051">if</span>&nbsp;<span class="ident" id="4759054">w</span>&nbsp;<span class="op" id="4759056">:=</span>&nbsp;<span class="ident" id="4759059">c</span><span class="op" id="4759060">.</span><span class="ident" id="4759061">width</span>&nbsp;<span class="op" id="4759067">+</span>&nbsp;<span class="ident" id="4759069">b</span><span class="op" id="4759070">.</span><span class="ident" id="4759071">padding</span><span class="op" id="4759078">;</span>&nbsp;<span class="ident" id="4759080">w</span>&nbsp;<span class="op" id="4759082">&gt;</span>&nbsp;<span class="ident" id="4759084">width</span>&nbsp;<span class="op" id="4759090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759098">width</span>&nbsp;<span class="op" id="4759104">=</span>&nbsp;<span class="ident" id="4759106">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759113">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759120">//&nbsp;update&nbsp;discardable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759147">if</span>&nbsp;<span class="ident" id="4759150">c</span><span class="op" id="4759151">.</span><span class="ident" id="4759152">width</span>&nbsp;<span class="op" id="4759158">&gt;</span>&nbsp;<span class="num" id="4759160">0</span>&nbsp;<span class="op" id="4759162">||</span>&nbsp;<span class="ident" id="4759165">c</span><span class="op" id="4759166">.</span><span class="ident" id="4759167">htab</span>&nbsp;<span class="op" id="4759172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759180">discardable</span>&nbsp;<span class="op" id="4759192">=</span>&nbsp;<span class="builtintype" id="4759194">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759211">}</span>&nbsp;<span class="keyword" id="4759213">else</span>&nbsp;<span class="op" id="4759218">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759225">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759245">//&nbsp;column&nbsp;block&nbsp;end</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759269">//&nbsp;discard&nbsp;empty&nbsp;columns&nbsp;if&nbsp;necessary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759310">if</span>&nbsp;<span class="ident" id="4759313">discardable</span>&nbsp;<span class="op" id="4759325">&amp;&amp;</span>&nbsp;<span class="ident" id="4759328">b</span><span class="op" id="4759329">.</span><span class="ident" id="4759330">flags</span><span class="op" id="4759335">&amp;</span><span class="ident" id="4759336">DiscardEmptyColumns</span>&nbsp;<span class="op" id="4759356">!=</span>&nbsp;<span class="num" id="4759359">0</span>&nbsp;<span class="op" id="4759361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759367">width</span>&nbsp;<span class="op" id="4759373">=</span>&nbsp;<span class="num" id="4759375">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759386">//&nbsp;format&nbsp;and&nbsp;print&nbsp;all&nbsp;columns&nbsp;to&nbsp;the&nbsp;right&nbsp;of&nbsp;this&nbsp;column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759449">//&nbsp;(we&nbsp;know&nbsp;the&nbsp;widths&nbsp;of&nbsp;this&nbsp;column&nbsp;and&nbsp;all&nbsp;columns&nbsp;to&nbsp;the&nbsp;left)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759519">b</span><span class="op" id="4759520">.</span><span class="ident" id="4759521">widths</span>&nbsp;<span class="op" id="4759528">=</span>&nbsp;<span class="builtinfunc" id="4759530">append</span><span class="op" id="4759536">(</span><span class="ident" id="4759537">b</span><span class="op" id="4759538">.</span><span class="ident" id="4759539">widths</span><span class="op" id="4759545">,</span>&nbsp;<span class="ident" id="4759547">width</span><span class="op" id="4759552">)</span>&nbsp;<span class="comment" id="4759554">//&nbsp;push&nbsp;width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759571">pos</span>&nbsp;<span class="op" id="4759575">=</span>&nbsp;<span class="ident" id="4759577">b</span><span class="op" id="4759578">.</span><span class="ident" id="4759579">format</span><span class="op" id="4759585">(</span><span class="ident" id="4759586">pos</span><span class="op" id="4759589">,</span>&nbsp;<span class="ident" id="4759591">line0</span><span class="op" id="4759596">,</span>&nbsp;<span class="ident" id="4759598">this</span><span class="op" id="4759602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759607">b</span><span class="op" id="4759608">.</span><span class="ident" id="4759609">widths</span>&nbsp;<span class="op" id="4759616">=</span>&nbsp;<span class="ident" id="4759618">b</span><span class="op" id="4759619">.</span><span class="ident" id="4759620">widths</span><span class="op" id="4759626">[</span><span class="num" id="4759627">0</span>&nbsp;<span class="op" id="4759629">:</span>&nbsp;<span class="builtinfunc" id="4759631">len</span><span class="op" id="4759634">(</span><span class="ident" id="4759635">b</span><span class="op" id="4759636">.</span><span class="ident" id="4759637">widths</span><span class="op" id="4759643">)</span><span class="op" id="4759644">-</span><span class="num" id="4759645">1</span><span class="op" id="4759646">]</span>&nbsp;<span class="comment" id="4759648">//&nbsp;pop&nbsp;width</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759664">line0</span>&nbsp;<span class="op" id="4759670">=</span>&nbsp;<span class="ident" id="4759672">this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4759682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4759686">//&nbsp;print&nbsp;unprinted&nbsp;lines&nbsp;until&nbsp;end</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4759722">return</span>&nbsp;<span class="ident" id="4759729">b</span><span class="op" id="4759730">.</span><span class="ident" id="4759731">writeLines</span><span class="op" id="4759741">(</span><span class="ident" id="4759742">pos</span><span class="op" id="4759745">,</span>&nbsp;<span class="ident" id="4759747">line0</span><span class="op" id="4759752">,</span>&nbsp;<span class="ident" id="4759754">line1</span><span class="op" id="4759759">)</span><br>
<span class="lineno"></span><span class="op" id="4759761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4759764">//&nbsp;Append&nbsp;text&nbsp;to&nbsp;current&nbsp;cell.</span><br>
<span class="lineno"></span><span class="keyword" id="4759796">func</span>&nbsp;<span class="op" id="4759801">(</span><span class="ident" id="4759802">b</span>&nbsp;<span class="op" id="4759804">*</span><span class="ident" id="4759805">Writer</span><span class="op" id="4759811">)</span>&nbsp;<span class="builtinfunc" id="4759813">append</span><span class="op" id="4759819">(</span><span class="ident" id="4759820">text</span>&nbsp;<span class="op" id="4759825">[</span><span class="op" id="4759826">]</span><span class="builtintype" id="4759827">byte</span><span class="op" id="4759831">)</span>&nbsp;<span class="op" id="4759833">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759836">b</span><span class="op" id="4759837">.</span><span class="ident" id="4759838">buf</span><span class="op" id="4759841">.</span><span class="ident" id="4759842">Write</span><span class="op" id="4759847">(</span><span class="ident" id="4759848">text</span><span class="op" id="4759852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759855">b</span><span class="op" id="4759856">.</span><span class="ident" id="4759857">cell</span><span class="op" id="4759861">.</span><span class="ident" id="4759862">size</span>&nbsp;<span class="op" id="4759867">+=</span>&nbsp;<span class="builtinfunc" id="4759870">len</span><span class="op" id="4759873">(</span><span class="ident" id="4759874">text</span><span class="op" id="4759878">)</span><br>
<span class="lineno"></span><span class="op" id="4759880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4759883">//&nbsp;Update&nbsp;the&nbsp;cell&nbsp;width.</span><br>
<span class="lineno">380</span><span class="keyword" id="4759909">func</span>&nbsp;<span class="op" id="4759914">(</span><span class="ident" id="4759915">b</span>&nbsp;<span class="op" id="4759917">*</span><span class="ident" id="4759918">Writer</span><span class="op" id="4759924">)</span>&nbsp;<span class="ident" id="4759926">updateWidth</span><span class="op" id="4759937">(</span><span class="op" id="4759938">)</span>&nbsp;<span class="op" id="4759940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4759943">b</span><span class="op" id="4759944">.</span><span class="ident" id="4759945">cell</span><span class="op" id="4759949">.</span><span class="ident" id="4759950">width</span>&nbsp;<span class="op" id="4759956">+=</span>&nbsp;<span class="ident" id="4759959">utf8</span><span class="op" id="4759963">.</span><span class="ident" id="4759964">RuneCount</span><span class="op" id="4759973">(</span><span class="ident" id="4759974">b</span><span class="op" id="4759975">.</span><span class="ident" id="4759976">buf</span><span class="op" id="4759979">.</span><span class="ident" id="4759980">Bytes</span><span class="op" id="4759985">(</span><span class="op" id="4759986">)</span><span class="op" id="4759987">[</span><span class="ident" id="4759988">b</span><span class="op" id="4759989">.</span><span class="ident" id="4759990">pos</span><span class="op" id="4759993">:</span><span class="ident" id="4759994">b</span><span class="op" id="4759995">.</span><span class="ident" id="4759996">buf</span><span class="op" id="4759999">.</span><span class="ident" id="4760000">Len</span><span class="op" id="4760003">(</span><span class="op" id="4760004">)</span><span class="op" id="4760005">]</span><span class="op" id="4760006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760009">b</span><span class="op" id="4760010">.</span><span class="ident" id="4760011">pos</span>&nbsp;<span class="op" id="4760015">=</span>&nbsp;<span class="ident" id="4760017">b</span><span class="op" id="4760018">.</span><span class="ident" id="4760019">buf</span><span class="op" id="4760022">.</span><span class="ident" id="4760023">Len</span><span class="op" id="4760026">(</span><span class="op" id="4760027">)</span><br>
<span class="lineno"></span><span class="op" id="4760029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="comment" id="4760032">//&nbsp;To&nbsp;escape&nbsp;a&nbsp;text&nbsp;segment,&nbsp;bracket&nbsp;it&nbsp;with&nbsp;Escape&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="4760096">//&nbsp;For&nbsp;instance,&nbsp;the&nbsp;tab&nbsp;in&nbsp;this&nbsp;string&nbsp;&#34;Ignore&nbsp;this&nbsp;tab:&nbsp;\xff\t\xff&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4760166">//&nbsp;does&nbsp;not&nbsp;terminate&nbsp;a&nbsp;cell&nbsp;and&nbsp;constitutes&nbsp;a&nbsp;single&nbsp;character&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4760233">//&nbsp;width&nbsp;one&nbsp;for&nbsp;formatting&nbsp;purposes.</span><br>
<span class="lineno"></span><span class="comment" id="4760271">//</span><br>
<span class="lineno">390</span><span class="comment" id="4760274">//&nbsp;The&nbsp;value&nbsp;0xff&nbsp;was&nbsp;chosen&nbsp;because&nbsp;it&nbsp;cannot&nbsp;appear&nbsp;in&nbsp;a&nbsp;valid&nbsp;UTF-8&nbsp;sequence.</span><br>
<span class="lineno"></span><span class="comment" id="4760355">//</span><br>
<span class="lineno"></span><span class="keyword" id="4760358">const</span>&nbsp;<span class="ident" id="4760364">Escape</span>&nbsp;<span class="op" id="4760371">=</span>&nbsp;<span class="string" id="4760373">&#39;\xff&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4760381">//&nbsp;Start&nbsp;escaped&nbsp;mode.</span><br>
<span class="lineno">395</span><span class="keyword" id="4760404">func</span>&nbsp;<span class="op" id="4760409">(</span><span class="ident" id="4760410">b</span>&nbsp;<span class="op" id="4760412">*</span><span class="ident" id="4760413">Writer</span><span class="op" id="4760419">)</span>&nbsp;<span class="ident" id="4760421">startEscape</span><span class="op" id="4760432">(</span><span class="ident" id="4760433">ch</span>&nbsp;<span class="builtintype" id="4760436">byte</span><span class="op" id="4760440">)</span>&nbsp;<span class="op" id="4760442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760445">switch</span>&nbsp;<span class="ident" id="4760452">ch</span>&nbsp;<span class="op" id="4760455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760458">case</span>&nbsp;<span class="ident" id="4760463">Escape</span><span class="op" id="4760469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760473">b</span><span class="op" id="4760474">.</span><span class="ident" id="4760475">endChar</span>&nbsp;<span class="op" id="4760483">=</span>&nbsp;<span class="ident" id="4760485">Escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760493">case</span>&nbsp;<span class="string" id="4760498">&#39;&lt;&#39;</span><span class="op" id="4760501">:</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760505">b</span><span class="op" id="4760506">.</span><span class="ident" id="4760507">endChar</span>&nbsp;<span class="op" id="4760515">=</span>&nbsp;<span class="string" id="4760517">&#39;&gt;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760522">case</span>&nbsp;<span class="string" id="4760527">&#39;&amp;&#39;</span><span class="op" id="4760530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760534">b</span><span class="op" id="4760535">.</span><span class="ident" id="4760536">endChar</span>&nbsp;<span class="op" id="4760544">=</span>&nbsp;<span class="string" id="4760546">&#39;;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760551">}</span><br>
<span class="lineno"></span><span class="op" id="4760553">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="4760556">//&nbsp;Terminate&nbsp;escaped&nbsp;mode.&nbsp;If&nbsp;the&nbsp;escaped&nbsp;text&nbsp;was&nbsp;an&nbsp;HTML&nbsp;tag,&nbsp;its&nbsp;width</span><br>
<span class="lineno"></span><span class="comment" id="4760630">//&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;zero&nbsp;for&nbsp;formatting&nbsp;purposes;&nbsp;if&nbsp;it&nbsp;was&nbsp;an&nbsp;HTML&nbsp;entity,</span><br>
<span class="lineno"></span><span class="comment" id="4760706">//&nbsp;its&nbsp;width&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;one.&nbsp;In&nbsp;all&nbsp;other&nbsp;cases,&nbsp;the&nbsp;width&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4760778">//&nbsp;unicode&nbsp;width&nbsp;of&nbsp;the&nbsp;text.</span><br>
<span class="lineno">410</span><span class="comment" id="4760808">//</span><br>
<span class="lineno"></span><span class="keyword" id="4760811">func</span>&nbsp;<span class="op" id="4760816">(</span><span class="ident" id="4760817">b</span>&nbsp;<span class="op" id="4760819">*</span><span class="ident" id="4760820">Writer</span><span class="op" id="4760826">)</span>&nbsp;<span class="ident" id="4760828">endEscape</span><span class="op" id="4760837">(</span><span class="op" id="4760838">)</span>&nbsp;<span class="op" id="4760840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760843">switch</span>&nbsp;<span class="ident" id="4760850">b</span><span class="op" id="4760851">.</span><span class="ident" id="4760852">endChar</span>&nbsp;<span class="op" id="4760860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760863">case</span>&nbsp;<span class="ident" id="4760868">Escape</span><span class="op" id="4760874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760878">b</span><span class="op" id="4760879">.</span><span class="ident" id="4760880">updateWidth</span><span class="op" id="4760891">(</span><span class="op" id="4760892">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760896">if</span>&nbsp;<span class="ident" id="4760899">b</span><span class="op" id="4760900">.</span><span class="ident" id="4760901">flags</span><span class="op" id="4760906">&amp;</span><span class="ident" id="4760907">StripEscape</span>&nbsp;<span class="op" id="4760919">==</span>&nbsp;<span class="num" id="4760922">0</span>&nbsp;<span class="op" id="4760924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4760929">b</span><span class="op" id="4760930">.</span><span class="ident" id="4760931">cell</span><span class="op" id="4760935">.</span><span class="ident" id="4760936">width</span>&nbsp;<span class="op" id="4760942">-=</span>&nbsp;<span class="num" id="4760945">2</span>&nbsp;<span class="comment" id="4760947">//&nbsp;don&#39;t&nbsp;count&nbsp;the&nbsp;Escape&nbsp;chars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4760981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4760984">case</span>&nbsp;<span class="string" id="4760989">&#39;&gt;&#39;</span><span class="op" id="4760992">:</span>&nbsp;<span class="comment" id="4760994">//&nbsp;tag&nbsp;of&nbsp;zero&nbsp;width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761016">case</span>&nbsp;<span class="string" id="4761021">&#39;;&#39;</span><span class="op" id="4761024">:</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761028">b</span><span class="op" id="4761029">.</span><span class="ident" id="4761030">cell</span><span class="op" id="4761034">.</span><span class="ident" id="4761035">width</span><span class="op" id="4761040">++</span>&nbsp;<span class="comment" id="4761043">//&nbsp;entity,&nbsp;count&nbsp;as&nbsp;one&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761076">b</span><span class="op" id="4761077">.</span><span class="ident" id="4761078">pos</span>&nbsp;<span class="op" id="4761082">=</span>&nbsp;<span class="ident" id="4761084">b</span><span class="op" id="4761085">.</span><span class="ident" id="4761086">buf</span><span class="op" id="4761089">.</span><span class="ident" id="4761090">Len</span><span class="op" id="4761093">(</span><span class="op" id="4761094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761097">b</span><span class="op" id="4761098">.</span><span class="ident" id="4761099">endChar</span>&nbsp;<span class="op" id="4761107">=</span>&nbsp;<span class="num" id="4761109">0</span><br>
<span class="lineno"></span><span class="op" id="4761111">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="comment" id="4761114">//&nbsp;Terminate&nbsp;the&nbsp;current&nbsp;cell&nbsp;by&nbsp;adding&nbsp;it&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;cells&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4761185">//&nbsp;current&nbsp;line.&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;cells&nbsp;in&nbsp;that&nbsp;line.</span><br>
<span class="lineno"></span><span class="comment" id="4761244">//</span><br>
<span class="lineno"></span><span class="keyword" id="4761247">func</span>&nbsp;<span class="op" id="4761252">(</span><span class="ident" id="4761253">b</span>&nbsp;<span class="op" id="4761255">*</span><span class="ident" id="4761256">Writer</span><span class="op" id="4761262">)</span>&nbsp;<span class="ident" id="4761264">terminateCell</span><span class="op" id="4761277">(</span><span class="ident" id="4761278">htab</span>&nbsp;<span class="builtintype" id="4761283">bool</span><span class="op" id="4761287">)</span>&nbsp;<span class="builtintype" id="4761289">int</span>&nbsp;<span class="op" id="4761293">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761296">b</span><span class="op" id="4761297">.</span><span class="ident" id="4761298">cell</span><span class="op" id="4761302">.</span><span class="ident" id="4761303">htab</span>&nbsp;<span class="op" id="4761308">=</span>&nbsp;<span class="ident" id="4761310">htab</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761316">line</span>&nbsp;<span class="op" id="4761321">:=</span>&nbsp;<span class="op" id="4761324">&amp;</span><span class="ident" id="4761325">b</span><span class="op" id="4761326">.</span><span class="ident" id="4761327">lines</span><span class="op" id="4761332">[</span><span class="builtinfunc" id="4761333">len</span><span class="op" id="4761336">(</span><span class="ident" id="4761337">b</span><span class="op" id="4761338">.</span><span class="ident" id="4761339">lines</span><span class="op" id="4761344">)</span><span class="op" id="4761345">-</span><span class="num" id="4761346">1</span><span class="op" id="4761347">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761350">*</span><span class="ident" id="4761351">line</span>&nbsp;<span class="op" id="4761356">=</span>&nbsp;<span class="builtinfunc" id="4761358">append</span><span class="op" id="4761364">(</span><span class="op" id="4761365">*</span><span class="ident" id="4761366">line</span><span class="op" id="4761370">,</span>&nbsp;<span class="ident" id="4761372">b</span><span class="op" id="4761373">.</span><span class="ident" id="4761374">cell</span><span class="op" id="4761378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4761381">b</span><span class="op" id="4761382">.</span><span class="ident" id="4761383">cell</span>&nbsp;<span class="op" id="4761388">=</span>&nbsp;<span class="ident" id="4761390">cell</span><span class="op" id="4761394">{</span><span class="op" id="4761395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761398">return</span>&nbsp;<span class="builtinfunc" id="4761405">len</span><span class="op" id="4761408">(</span><span class="op" id="4761409">*</span><span class="ident" id="4761410">line</span><span class="op" id="4761414">)</span><br>
<span class="lineno">435</span><span class="op" id="4761416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4761419">func</span>&nbsp;<span class="ident" id="4761424">handlePanic</span><span class="op" id="4761435">(</span><span class="ident" id="4761436">err</span>&nbsp;<span class="op" id="4761440">*</span><span class="builtintype" id="4761441">error</span><span class="op" id="4761446">,</span>&nbsp;<span class="ident" id="4761448">op</span>&nbsp;<span class="builtintype" id="4761451">string</span><span class="op" id="4761457">)</span>&nbsp;<span class="op" id="4761459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761462">if</span>&nbsp;<span class="ident" id="4761465">e</span>&nbsp;<span class="op" id="4761467">:=</span>&nbsp;<span class="builtinfunc" id="4761470">recover</span><span class="op" id="4761477">(</span><span class="op" id="4761478">)</span><span class="op" id="4761479">;</span>&nbsp;<span class="ident" id="4761481">e</span>&nbsp;<span class="op" id="4761483">!=</span>&nbsp;<span class="builtintype" id="4761486">nil</span>&nbsp;<span class="op" id="4761490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761494">if</span>&nbsp;<span class="ident" id="4761497">nerr</span><span class="op" id="4761501">,</span>&nbsp;<span class="ident" id="4761503">ok</span>&nbsp;<span class="op" id="4761506">:=</span>&nbsp;<span class="ident" id="4761509">e</span><span class="op" id="4761510">.</span><span class="op" id="4761511">(</span><span class="ident" id="4761512">osError</span><span class="op" id="4761519">)</span><span class="op" id="4761520">;</span>&nbsp;<span class="ident" id="4761522">ok</span>&nbsp;<span class="op" id="4761525">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761530">*</span><span class="ident" id="4761531">err</span>&nbsp;<span class="op" id="4761535">=</span>&nbsp;<span class="ident" id="4761537">nerr</span><span class="op" id="4761541">.</span><span class="ident" id="4761542">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761549">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4761562">panic</span><span class="op" id="4761567">(</span><span class="string" id="4761568">&#34;tabwriter:&nbsp;panic&nbsp;during&nbsp;&#34;</span>&nbsp;<span class="op" id="4761595">+</span>&nbsp;<span class="ident" id="4761597">op</span><span class="op" id="4761599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4761602">}</span><br>
<span class="lineno">445</span><span class="op" id="4761604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4761607">//&nbsp;Flush&nbsp;should&nbsp;be&nbsp;called&nbsp;after&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Write&nbsp;to&nbsp;ensure</span><br>
<span class="lineno"></span><span class="comment" id="4761672">//&nbsp;that&nbsp;any&nbsp;data&nbsp;buffered&nbsp;in&nbsp;the&nbsp;Writer&nbsp;is&nbsp;written&nbsp;to&nbsp;output.&nbsp;Any</span><br>
<span class="lineno"></span><span class="comment" id="4761738">//&nbsp;incomplete&nbsp;escape&nbsp;sequence&nbsp;at&nbsp;the&nbsp;end&nbsp;is&nbsp;considered</span><br>
<span class="lineno">450</span><span class="comment" id="4761793">//&nbsp;complete&nbsp;for&nbsp;formatting&nbsp;purposes.</span><br>
<span class="lineno"></span><span class="comment" id="4761830">//</span><br>
<span class="lineno"></span><span class="keyword" id="4761833">func</span>&nbsp;<span class="op" id="4761838">(</span><span class="ident" id="4761839">b</span>&nbsp;<span class="op" id="4761841">*</span><span class="ident" id="4761842">Writer</span><span class="op" id="4761848">)</span>&nbsp;<span class="ident" id="4761850">Flush</span><span class="op" id="4761855">(</span><span class="op" id="4761856">)</span>&nbsp;<span class="op" id="4761858">(</span><span class="ident" id="4761859">err</span>&nbsp;<span class="builtintype" id="4761863">error</span><span class="op" id="4761868">)</span>&nbsp;<span class="op" id="4761870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761873">defer</span>&nbsp;<span class="ident" id="4761879">b</span><span class="op" id="4761880">.</span><span class="ident" id="4761881">reset</span><span class="op" id="4761886">(</span><span class="op" id="4761887">)</span>&nbsp;<span class="comment" id="4761889">//&nbsp;even&nbsp;in&nbsp;the&nbsp;presence&nbsp;of&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761924">defer</span>&nbsp;<span class="ident" id="4761930">handlePanic</span><span class="op" id="4761941">(</span><span class="op" id="4761942">&amp;</span><span class="ident" id="4761943">err</span><span class="op" id="4761946">,</span>&nbsp;<span class="string" id="4761948">&#34;Flush&#34;</span><span class="op" id="4761955">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4761959">//&nbsp;add&nbsp;current&nbsp;cell&nbsp;if&nbsp;not&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4761993">if</span>&nbsp;<span class="ident" id="4761996">b</span><span class="op" id="4761997">.</span><span class="ident" id="4761998">cell</span><span class="op" id="4762002">.</span><span class="ident" id="4762003">size</span>&nbsp;<span class="op" id="4762008">&gt;</span>&nbsp;<span class="num" id="4762010">0</span>&nbsp;<span class="op" id="4762012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762016">if</span>&nbsp;<span class="ident" id="4762019">b</span><span class="op" id="4762020">.</span><span class="ident" id="4762021">endChar</span>&nbsp;<span class="op" id="4762029">!=</span>&nbsp;<span class="num" id="4762032">0</span>&nbsp;<span class="op" id="4762034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762039">//&nbsp;inside&nbsp;escape&nbsp;-&nbsp;terminate&nbsp;it&nbsp;even&nbsp;if&nbsp;incomplete</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762093">b</span><span class="op" id="4762094">.</span><span class="ident" id="4762095">endEscape</span><span class="op" id="4762104">(</span><span class="op" id="4762105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762113">b</span><span class="op" id="4762114">.</span><span class="ident" id="4762115">terminateCell</span><span class="op" id="4762128">(</span><span class="builtintype" id="4762129">false</span><span class="op" id="4762134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4762137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762141">//&nbsp;format&nbsp;contents&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762171">b</span><span class="op" id="4762172">.</span><span class="ident" id="4762173">format</span><span class="op" id="4762179">(</span><span class="num" id="4762180">0</span><span class="op" id="4762181">,</span>&nbsp;<span class="num" id="4762183">0</span><span class="op" id="4762184">,</span>&nbsp;<span class="builtinfunc" id="4762186">len</span><span class="op" id="4762189">(</span><span class="ident" id="4762190">b</span><span class="op" id="4762191">.</span><span class="ident" id="4762192">lines</span><span class="op" id="4762197">)</span><span class="op" id="4762198">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762202">return</span><br>
<span class="lineno"></span><span class="op" id="4762209">}</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="4762212">var</span>&nbsp;<span class="ident" id="4762216">hbar</span>&nbsp;<span class="op" id="4762221">=</span>&nbsp;<span class="op" id="4762223">[</span><span class="op" id="4762224">]</span><span class="builtintype" id="4762225">byte</span><span class="op" id="4762229">(</span><span class="string" id="4762230">&#34;---\n&#34;</span><span class="op" id="4762237">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4762240">//&nbsp;Write&nbsp;writes&nbsp;buf&nbsp;to&nbsp;the&nbsp;writer&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="4762277">//&nbsp;The&nbsp;only&nbsp;errors&nbsp;returned&nbsp;are&nbsp;ones&nbsp;encountered</span><br>
<span class="lineno">475</span><span class="comment" id="4762326">//&nbsp;while&nbsp;writing&nbsp;to&nbsp;the&nbsp;underlying&nbsp;output&nbsp;stream.</span><br>
<span class="lineno"></span><span class="comment" id="4762376">//</span><br>
<span class="lineno"></span><span class="keyword" id="4762379">func</span>&nbsp;<span class="op" id="4762384">(</span><span class="ident" id="4762385">b</span>&nbsp;<span class="op" id="4762387">*</span><span class="ident" id="4762388">Writer</span><span class="op" id="4762394">)</span>&nbsp;<span class="ident" id="4762396">Write</span><span class="op" id="4762401">(</span><span class="ident" id="4762402">buf</span>&nbsp;<span class="op" id="4762406">[</span><span class="op" id="4762407">]</span><span class="builtintype" id="4762408">byte</span><span class="op" id="4762412">)</span>&nbsp;<span class="op" id="4762414">(</span><span class="ident" id="4762415">n</span>&nbsp;<span class="builtintype" id="4762417">int</span><span class="op" id="4762420">,</span>&nbsp;<span class="ident" id="4762422">err</span>&nbsp;<span class="builtintype" id="4762426">error</span><span class="op" id="4762431">)</span>&nbsp;<span class="op" id="4762433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762436">defer</span>&nbsp;<span class="ident" id="4762442">handlePanic</span><span class="op" id="4762453">(</span><span class="op" id="4762454">&amp;</span><span class="ident" id="4762455">err</span><span class="op" id="4762458">,</span>&nbsp;<span class="string" id="4762460">&#34;Write&#34;</span><span class="op" id="4762467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762471">//&nbsp;split&nbsp;text&nbsp;into&nbsp;cells</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762497">n</span>&nbsp;<span class="op" id="4762499">=</span>&nbsp;<span class="num" id="4762501">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762504">for</span>&nbsp;<span class="ident" id="4762508">i</span><span class="op" id="4762509">,</span>&nbsp;<span class="ident" id="4762511">ch</span>&nbsp;<span class="op" id="4762514">:=</span>&nbsp;<span class="keyword" id="4762517">range</span>&nbsp;<span class="ident" id="4762523">buf</span>&nbsp;<span class="op" id="4762527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762531">if</span>&nbsp;<span class="ident" id="4762534">b</span><span class="op" id="4762535">.</span><span class="ident" id="4762536">endChar</span>&nbsp;<span class="op" id="4762544">==</span>&nbsp;<span class="num" id="4762547">0</span>&nbsp;<span class="op" id="4762549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762554">//&nbsp;outside&nbsp;escape</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762575">switch</span>&nbsp;<span class="ident" id="4762582">ch</span>&nbsp;<span class="op" id="4762585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762590">case</span>&nbsp;<span class="string" id="4762595">&#39;\t&#39;</span><span class="op" id="4762599">,</span>&nbsp;<span class="string" id="4762601">&#39;\v&#39;</span><span class="op" id="4762605">,</span>&nbsp;<span class="string" id="4762607">&#39;\n&#39;</span><span class="op" id="4762611">,</span>&nbsp;<span class="string" id="4762613">&#39;\f&#39;</span><span class="op" id="4762617">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762623">//&nbsp;end&nbsp;of&nbsp;cell</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762642">b</span><span class="op" id="4762643">.</span><span class="builtinfunc" id="4762644">append</span><span class="op" id="4762650">(</span><span class="ident" id="4762651">buf</span><span class="op" id="4762654">[</span><span class="ident" id="4762655">n</span><span class="op" id="4762656">:</span><span class="ident" id="4762657">i</span><span class="op" id="4762658">]</span><span class="op" id="4762659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762665">b</span><span class="op" id="4762666">.</span><span class="ident" id="4762667">updateWidth</span><span class="op" id="4762678">(</span><span class="op" id="4762679">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762685">n</span>&nbsp;<span class="op" id="4762687">=</span>&nbsp;<span class="ident" id="4762689">i</span>&nbsp;<span class="op" id="4762691">+</span>&nbsp;<span class="num" id="4762693">1</span>&nbsp;<span class="comment" id="4762695">//&nbsp;ch&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762714">ncells</span>&nbsp;<span class="op" id="4762721">:=</span>&nbsp;<span class="ident" id="4762724">b</span><span class="op" id="4762725">.</span><span class="ident" id="4762726">terminateCell</span><span class="op" id="4762739">(</span><span class="ident" id="4762740">ch</span>&nbsp;<span class="op" id="4762743">==</span>&nbsp;<span class="string" id="4762746">&#39;\t&#39;</span><span class="op" id="4762750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762756">if</span>&nbsp;<span class="ident" id="4762759">ch</span>&nbsp;<span class="op" id="4762762">==</span>&nbsp;<span class="string" id="4762765">&#39;\n&#39;</span>&nbsp;<span class="op" id="4762770">||</span>&nbsp;<span class="ident" id="4762773">ch</span>&nbsp;<span class="op" id="4762776">==</span>&nbsp;<span class="string" id="4762779">&#39;\f&#39;</span>&nbsp;<span class="op" id="4762784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762791">//&nbsp;terminate&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4762814">b</span><span class="op" id="4762815">.</span><span class="ident" id="4762816">addLine</span><span class="op" id="4762823">(</span><span class="op" id="4762824">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4762831">if</span>&nbsp;<span class="ident" id="4762834">ch</span>&nbsp;<span class="op" id="4762837">==</span>&nbsp;<span class="string" id="4762840">&#39;\f&#39;</span>&nbsp;<span class="op" id="4762845">||</span>&nbsp;<span class="ident" id="4762848">ncells</span>&nbsp;<span class="op" id="4762855">==</span>&nbsp;<span class="num" id="4762858">1</span>&nbsp;<span class="op" id="4762860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762868">//&nbsp;A&nbsp;&#39;\f&#39;&nbsp;always&nbsp;forces&nbsp;a&nbsp;flush.&nbsp;Otherwise,&nbsp;if&nbsp;the&nbsp;previous</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762934">//&nbsp;line&nbsp;has&nbsp;only&nbsp;one&nbsp;cell&nbsp;which&nbsp;does&nbsp;not&nbsp;have&nbsp;an&nbsp;impact&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4762999">//&nbsp;the&nbsp;formatting&nbsp;of&nbsp;the&nbsp;following&nbsp;lines&nbsp;(the&nbsp;last&nbsp;cell&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763065">//&nbsp;line&nbsp;is&nbsp;ignored&nbsp;by&nbsp;format()),&nbsp;thus&nbsp;we&nbsp;can&nbsp;flush&nbsp;the</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763126">//&nbsp;Writer&nbsp;contents.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763152">if</span>&nbsp;<span class="ident" id="4763155">err</span>&nbsp;<span class="op" id="4763159">=</span>&nbsp;<span class="ident" id="4763161">b</span><span class="op" id="4763162">.</span><span class="ident" id="4763163">Flush</span><span class="op" id="4763168">(</span><span class="op" id="4763169">)</span><span class="op" id="4763170">;</span>&nbsp;<span class="ident" id="4763172">err</span>&nbsp;<span class="op" id="4763176">!=</span>&nbsp;<span class="builtintype" id="4763179">nil</span>&nbsp;<span class="op" id="4763183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763192">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763213">if</span>&nbsp;<span class="ident" id="4763216">ch</span>&nbsp;<span class="op" id="4763219">==</span>&nbsp;<span class="string" id="4763222">&#39;\f&#39;</span>&nbsp;<span class="op" id="4763227">&amp;&amp;</span>&nbsp;<span class="ident" id="4763230">b</span><span class="op" id="4763231">.</span><span class="ident" id="4763232">flags</span><span class="op" id="4763237">&amp;</span><span class="ident" id="4763238">Debug</span>&nbsp;<span class="op" id="4763244">!=</span>&nbsp;<span class="num" id="4763247">0</span>&nbsp;<span class="op" id="4763249">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763258">//&nbsp;indicate&nbsp;section&nbsp;break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763291">b</span><span class="op" id="4763292">.</span><span class="ident" id="4763293">write0</span><span class="op" id="4763299">(</span><span class="ident" id="4763300">hbar</span><span class="op" id="4763304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763325">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763331">case</span>&nbsp;<span class="ident" id="4763336">Escape</span><span class="op" id="4763342">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763348">//&nbsp;start&nbsp;of&nbsp;escaped&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763381">b</span><span class="op" id="4763382">.</span><span class="builtinfunc" id="4763383">append</span><span class="op" id="4763389">(</span><span class="ident" id="4763390">buf</span><span class="op" id="4763393">[</span><span class="ident" id="4763394">n</span><span class="op" id="4763395">:</span><span class="ident" id="4763396">i</span><span class="op" id="4763397">]</span><span class="op" id="4763398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763404">b</span><span class="op" id="4763405">.</span><span class="ident" id="4763406">updateWidth</span><span class="op" id="4763417">(</span><span class="op" id="4763418">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763424">n</span>&nbsp;<span class="op" id="4763426">=</span>&nbsp;<span class="ident" id="4763428">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763434">if</span>&nbsp;<span class="ident" id="4763437">b</span><span class="op" id="4763438">.</span><span class="ident" id="4763439">flags</span><span class="op" id="4763444">&amp;</span><span class="ident" id="4763445">StripEscape</span>&nbsp;<span class="op" id="4763457">!=</span>&nbsp;<span class="num" id="4763460">0</span>&nbsp;<span class="op" id="4763462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763469">n</span><span class="op" id="4763470">++</span>&nbsp;<span class="comment" id="4763473">//&nbsp;strip&nbsp;Escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763493">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763499">b</span><span class="op" id="4763500">.</span><span class="ident" id="4763501">startEscape</span><span class="op" id="4763512">(</span><span class="ident" id="4763513">Escape</span><span class="op" id="4763519">)</span><br>
<span class="lineno">520</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763525">case</span>&nbsp;<span class="string" id="4763530">&#39;&lt;&#39;</span><span class="op" id="4763533">,</span>&nbsp;<span class="string" id="4763535">&#39;&amp;&#39;</span><span class="op" id="4763538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763544">//&nbsp;possibly&nbsp;an&nbsp;html&nbsp;tag/entity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763579">if</span>&nbsp;<span class="ident" id="4763582">b</span><span class="op" id="4763583">.</span><span class="ident" id="4763584">flags</span><span class="op" id="4763589">&amp;</span><span class="ident" id="4763590">FilterHTML</span>&nbsp;<span class="op" id="4763601">!=</span>&nbsp;<span class="num" id="4763604">0</span>&nbsp;<span class="op" id="4763606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763613">//&nbsp;begin&nbsp;of&nbsp;tag/entity</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763641">b</span><span class="op" id="4763642">.</span><span class="builtinfunc" id="4763643">append</span><span class="op" id="4763649">(</span><span class="ident" id="4763650">buf</span><span class="op" id="4763653">[</span><span class="ident" id="4763654">n</span><span class="op" id="4763655">:</span><span class="ident" id="4763656">i</span><span class="op" id="4763657">]</span><span class="op" id="4763658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763665">b</span><span class="op" id="4763666">.</span><span class="ident" id="4763667">updateWidth</span><span class="op" id="4763678">(</span><span class="op" id="4763679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763686">n</span>&nbsp;<span class="op" id="4763688">=</span>&nbsp;<span class="ident" id="4763690">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763697">b</span><span class="op" id="4763698">.</span><span class="ident" id="4763699">startEscape</span><span class="op" id="4763710">(</span><span class="ident" id="4763711">ch</span><span class="op" id="4763713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763719">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763729">}</span>&nbsp;<span class="keyword" id="4763731">else</span>&nbsp;<span class="op" id="4763736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763741">//&nbsp;inside&nbsp;escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763761">if</span>&nbsp;<span class="ident" id="4763764">ch</span>&nbsp;<span class="op" id="4763767">==</span>&nbsp;<span class="ident" id="4763770">b</span><span class="op" id="4763771">.</span><span class="ident" id="4763772">endChar</span>&nbsp;<span class="op" id="4763780">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763786">//&nbsp;end&nbsp;of&nbsp;tag/entity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763811">j</span>&nbsp;<span class="op" id="4763813">:=</span>&nbsp;<span class="ident" id="4763816">i</span>&nbsp;<span class="op" id="4763818">+</span>&nbsp;<span class="num" id="4763820">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4763826">if</span>&nbsp;<span class="ident" id="4763829">ch</span>&nbsp;<span class="op" id="4763832">==</span>&nbsp;<span class="ident" id="4763835">Escape</span>&nbsp;<span class="op" id="4763842">&amp;&amp;</span>&nbsp;<span class="ident" id="4763845">b</span><span class="op" id="4763846">.</span><span class="ident" id="4763847">flags</span><span class="op" id="4763852">&amp;</span><span class="ident" id="4763853">StripEscape</span>&nbsp;<span class="op" id="4763865">!=</span>&nbsp;<span class="num" id="4763868">0</span>&nbsp;<span class="op" id="4763870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763877">j</span>&nbsp;<span class="op" id="4763879">=</span>&nbsp;<span class="ident" id="4763881">i</span>&nbsp;<span class="comment" id="4763883">//&nbsp;strip&nbsp;Escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763903">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763909">b</span><span class="op" id="4763910">.</span><span class="builtinfunc" id="4763911">append</span><span class="op" id="4763917">(</span><span class="ident" id="4763918">buf</span><span class="op" id="4763921">[</span><span class="ident" id="4763922">n</span><span class="op" id="4763923">:</span><span class="ident" id="4763924">j</span><span class="op" id="4763925">]</span><span class="op" id="4763926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763932">n</span>&nbsp;<span class="op" id="4763934">=</span>&nbsp;<span class="ident" id="4763936">i</span>&nbsp;<span class="op" id="4763938">+</span>&nbsp;<span class="num" id="4763940">1</span>&nbsp;<span class="comment" id="4763942">//&nbsp;ch&nbsp;consumed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4763961">b</span><span class="op" id="4763962">.</span><span class="ident" id="4763963">endEscape</span><span class="op" id="4763972">(</span><span class="op" id="4763973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763978">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763982">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4763985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4763989">//&nbsp;append&nbsp;leftover&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764014">b</span><span class="op" id="4764015">.</span><span class="builtinfunc" id="4764016">append</span><span class="op" id="4764022">(</span><span class="ident" id="4764023">buf</span><span class="op" id="4764026">[</span><span class="ident" id="4764027">n</span><span class="op" id="4764028">:</span><span class="op" id="4764029">]</span><span class="op" id="4764030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4764033">n</span>&nbsp;<span class="op" id="4764035">=</span>&nbsp;<span class="builtinfunc" id="4764037">len</span><span class="op" id="4764040">(</span><span class="ident" id="4764041">buf</span><span class="op" id="4764044">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764047">return</span><br>
<span class="lineno"></span><span class="op" id="4764054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4764057">//&nbsp;NewWriter&nbsp;allocates&nbsp;and&nbsp;initializes&nbsp;a&nbsp;new&nbsp;tabwriter.Writer.</span><br>
<span class="lineno"></span><span class="comment" id="4764120">//&nbsp;The&nbsp;parameters&nbsp;are&nbsp;the&nbsp;same&nbsp;as&nbsp;for&nbsp;the&nbsp;Init&nbsp;function.</span><br>
<span class="lineno">555</span><span class="comment" id="4764177">//</span><br>
<span class="lineno"></span><span class="keyword" id="4764180">func</span>&nbsp;<span class="ident" id="4764185">NewWriter</span><span class="op" id="4764194">(</span><span class="ident" id="4764195">output</span>&nbsp;<span class="ident" id="4764202">io</span><span class="op" id="4764204">.</span><span class="ident" id="4764205">Writer</span><span class="op" id="4764211">,</span>&nbsp;<span class="ident" id="4764213">minwidth</span><span class="op" id="4764221">,</span>&nbsp;<span class="ident" id="4764223">tabwidth</span><span class="op" id="4764231">,</span>&nbsp;<span class="ident" id="4764233">padding</span>&nbsp;<span class="builtintype" id="4764241">int</span><span class="op" id="4764244">,</span>&nbsp;<span class="ident" id="4764246">padchar</span>&nbsp;<span class="builtintype" id="4764254">byte</span><span class="op" id="4764258">,</span>&nbsp;<span class="ident" id="4764260">flags</span>&nbsp;<span class="builtintype" id="4764266">uint</span><span class="op" id="4764270">)</span>&nbsp;<span class="op" id="4764272">*</span><span class="ident" id="4764273">Writer</span>&nbsp;<span class="op" id="4764280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4764283">return</span>&nbsp;<span class="builtinfunc" id="4764290">new</span><span class="op" id="4764293">(</span><span class="ident" id="4764294">Writer</span><span class="op" id="4764300">)</span><span class="op" id="4764301">.</span><span class="ident" id="4764302">Init</span><span class="op" id="4764306">(</span><span class="ident" id="4764307">output</span><span class="op" id="4764313">,</span>&nbsp;<span class="ident" id="4764315">minwidth</span><span class="op" id="4764323">,</span>&nbsp;<span class="ident" id="4764325">tabwidth</span><span class="op" id="4764333">,</span>&nbsp;<span class="ident" id="4764335">padding</span><span class="op" id="4764342">,</span>&nbsp;<span class="ident" id="4764344">padchar</span><span class="op" id="4764351">,</span>&nbsp;<span class="ident" id="4764353">flags</span><span class="op" id="4764358">)</span><br>
<span class="lineno"></span><span class="op" id="4764360">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
