<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7121469">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7121524">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7121578">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7121629">package</span>&nbsp;<span class="ident" id="7121637">zlib</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7121643">import</span>&nbsp;<span class="op" id="7121650">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121653">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121662">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121669">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121675">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121688">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121694">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7121704">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7121707">var</span>&nbsp;<span class="ident" id="7121711">filenames</span>&nbsp;<span class="op" id="7121721">=</span>&nbsp;<span class="op" id="7121723">[</span><span class="op" id="7121724">]</span><span class="builtintype" id="7121725">string</span><span class="op" id="7121731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121734">&#34;../testdata/e.txt&#34;</span><span class="op" id="7121753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121756">&#34;../testdata/pi.txt&#34;</span><span class="op" id="7121776">,</span><br>
<span class="lineno"></span><span class="op" id="7121778">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7121781">var</span>&nbsp;<span class="ident" id="7121785">data</span>&nbsp;<span class="op" id="7121790">=</span>&nbsp;<span class="op" id="7121792">[</span><span class="op" id="7121793">]</span><span class="builtintype" id="7121794">string</span><span class="op" id="7121800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7121803">&#34;test&nbsp;a&nbsp;reasonable&nbsp;sized&nbsp;string&nbsp;that&nbsp;can&nbsp;be&nbsp;compressed&#34;</span><span class="op" id="7121858">,</span><br>
<span class="lineno"></span><span class="op" id="7121860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="7121863">//&nbsp;Tests&nbsp;that&nbsp;compressing&nbsp;and&nbsp;then&nbsp;decompressing&nbsp;the&nbsp;given&nbsp;file&nbsp;at&nbsp;the&nbsp;given&nbsp;compression&nbsp;level&nbsp;and&nbsp;dictionary</span><br>
<span class="lineno"></span><span class="comment" id="7121973">//&nbsp;yields&nbsp;equivalent&nbsp;bytes&nbsp;to&nbsp;the&nbsp;original&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="7122022">func</span>&nbsp;<span class="ident" id="7122027">testFileLevelDict</span><span class="op" id="7122044">(</span><span class="ident" id="7122045">t</span>&nbsp;<span class="op" id="7122047">*</span><span class="ident" id="7122048"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7122055">.</span><span class="ident" id="7122056">T</span><span class="op" id="7122057">,</span>&nbsp;<span class="ident" id="7122059">fn</span>&nbsp;<span class="builtintype" id="7122062">string</span><span class="op" id="7122068">,</span>&nbsp;<span class="ident" id="7122070">level</span>&nbsp;<span class="builtintype" id="7122076">int</span><span class="op" id="7122079">,</span>&nbsp;<span class="ident" id="7122081">d</span>&nbsp;<span class="builtintype" id="7122083">string</span><span class="op" id="7122089">)</span>&nbsp;<span class="op" id="7122091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7122094">//&nbsp;Read&nbsp;the&nbsp;file,&nbsp;as&nbsp;golden&nbsp;output.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122131">golden</span><span class="op" id="7122137">,</span>&nbsp;<span class="ident" id="7122139">err</span>&nbsp;<span class="op" id="7122143">:=</span>&nbsp;<span class="ident" id="7122146"><a href="/compress/zlib/writer_test.go.html#7121688">os</a></span><span class="op" id="7122148">.</span><span class="ident" id="7122149">Open</span><span class="op" id="7122153">(</span><span class="ident" id="7122154"><a href="/compress/zlib/writer_test.go.html#7122059">fn</a></span><span class="op" id="7122156">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122159">if</span>&nbsp;<span class="ident" id="7122162"><a href="/compress/zlib/writer_test.go.html#7122139">err</a></span>&nbsp;<span class="op" id="7122166">!=</span>&nbsp;<span class="ident" id="7122169">nil</span>&nbsp;<span class="op" id="7122173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122177"><a href="/compress/zlib/writer_test.go.html#7122045">t</a></span><span class="op" id="7122178">.</span><span class="ident" id="7122179">Errorf</span><span class="op" id="7122185">(</span><span class="string" id="7122186">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7122214">,</span>&nbsp;<span class="ident" id="7122216"><a href="/compress/zlib/writer_test.go.html#7122059">fn</a></span><span class="op" id="7122218">,</span>&nbsp;<span class="ident" id="7122220"><a href="/compress/zlib/writer_test.go.html#7122070">level</a></span><span class="op" id="7122225">,</span>&nbsp;<span class="ident" id="7122227"><a href="/compress/zlib/writer_test.go.html#7122081">d</a></span><span class="op" id="7122228">,</span>&nbsp;<span class="ident" id="7122230"><a href="/compress/zlib/writer_test.go.html#7122139">err</a></span><span class="op" id="7122233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122237">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122248">defer</span>&nbsp;<span class="ident" id="7122254"><a href="/compress/zlib/writer_test.go.html#7122131">golden</a></span><span class="op" id="7122260">.</span><span class="ident" id="7122261">Close</span><span class="op" id="7122266">(</span><span class="op" id="7122267">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122270">b0</span><span class="op" id="7122272">,</span>&nbsp;<span class="ident" id="7122274">err0</span>&nbsp;<span class="op" id="7122279">:=</span>&nbsp;<span class="ident" id="7122282"><a href="/compress/zlib/writer_test.go.html#7121675">ioutil</a></span><span class="op" id="7122288">.</span><span class="ident" id="7122289">ReadAll</span><span class="op" id="7122296">(</span><span class="ident" id="7122297"><a href="/compress/zlib/writer_test.go.html#7122131">golden</a></span><span class="op" id="7122303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122306">if</span>&nbsp;<span class="ident" id="7122309"><a href="/compress/zlib/writer_test.go.html#7122274">err0</a></span>&nbsp;<span class="op" id="7122314">!=</span>&nbsp;<span class="ident" id="7122317">nil</span>&nbsp;<span class="op" id="7122321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122325"><a href="/compress/zlib/writer_test.go.html#7122045">t</a></span><span class="op" id="7122326">.</span><span class="ident" id="7122327">Errorf</span><span class="op" id="7122333">(</span><span class="string" id="7122334">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7122362">,</span>&nbsp;<span class="ident" id="7122364"><a href="/compress/zlib/writer_test.go.html#7122059">fn</a></span><span class="op" id="7122366">,</span>&nbsp;<span class="ident" id="7122368"><a href="/compress/zlib/writer_test.go.html#7122070">level</a></span><span class="op" id="7122373">,</span>&nbsp;<span class="ident" id="7122375"><a href="/compress/zlib/writer_test.go.html#7122081">d</a></span><span class="op" id="7122376">,</span>&nbsp;<span class="ident" id="7122378"><a href="/compress/zlib/writer_test.go.html#7122274">err0</a></span><span class="op" id="7122382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122386">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122394">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122397"><a href="/compress/zlib/writer_test.go.html#7122440">testLevelDict</a></span><span class="op" id="7122410">(</span><span class="ident" id="7122411"><a href="/compress/zlib/writer_test.go.html#7122045">t</a></span><span class="op" id="7122412">,</span>&nbsp;<span class="ident" id="7122414"><a href="/compress/zlib/writer_test.go.html#7122059">fn</a></span><span class="op" id="7122416">,</span>&nbsp;<span class="ident" id="7122418"><a href="/compress/zlib/writer_test.go.html#7122270">b0</a></span><span class="op" id="7122420">,</span>&nbsp;<span class="ident" id="7122422"><a href="/compress/zlib/writer_test.go.html#7122070">level</a></span><span class="op" id="7122427">,</span>&nbsp;<span class="ident" id="7122429"><a href="/compress/zlib/writer_test.go.html#7122081">d</a></span><span class="op" id="7122430">)</span><br>
<span class="lineno"></span><span class="op" id="7122432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122435">func</span>&nbsp;<span class="ident" id="7122440">testLevelDict</span><span class="op" id="7122453">(</span><span class="ident" id="7122454">t</span>&nbsp;<span class="op" id="7122456">*</span><span class="ident" id="7122457"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7122464">.</span><span class="ident" id="7122465">T</span><span class="op" id="7122466">,</span>&nbsp;<span class="ident" id="7122468">fn</span>&nbsp;<span class="builtintype" id="7122471">string</span><span class="op" id="7122477">,</span>&nbsp;<span class="ident" id="7122479">b0</span>&nbsp;<span class="op" id="7122482">[</span><span class="op" id="7122483">]</span><span class="builtintype" id="7122484">byte</span><span class="op" id="7122488">,</span>&nbsp;<span class="ident" id="7122490">level</span>&nbsp;<span class="builtintype" id="7122496">int</span><span class="op" id="7122499">,</span>&nbsp;<span class="ident" id="7122501">d</span>&nbsp;<span class="builtintype" id="7122503">string</span><span class="op" id="7122509">)</span>&nbsp;<span class="op" id="7122511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7122514">//&nbsp;Make&nbsp;dictionary,&nbsp;if&nbsp;given.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122545">var</span>&nbsp;<span class="ident" id="7122549">dict</span>&nbsp;<span class="op" id="7122554">[</span><span class="op" id="7122555">]</span><span class="builtintype" id="7122556">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122562">if</span>&nbsp;<span class="ident" id="7122565"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span>&nbsp;<span class="op" id="7122567">!=</span>&nbsp;<span class="string" id="7122570">&#34;&#34;</span>&nbsp;<span class="op" id="7122573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122577"><a href="/compress/zlib/writer_test.go.html#7122549">dict</a></span>&nbsp;<span class="op" id="7122582">=</span>&nbsp;<span class="op" id="7122584">[</span><span class="op" id="7122585">]</span><span class="builtintype" id="7122586">byte</span><span class="op" id="7122590">(</span><span class="ident" id="7122591"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7122592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7122599">//&nbsp;Push&nbsp;data&nbsp;through&nbsp;a&nbsp;pipe&nbsp;that&nbsp;compresses&nbsp;at&nbsp;the&nbsp;write&nbsp;end,&nbsp;and&nbsp;decompresses&nbsp;at&nbsp;the&nbsp;read&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122696">piper</span><span class="op" id="7122701">,</span>&nbsp;<span class="ident" id="7122703">pipew</span>&nbsp;<span class="op" id="7122709">:=</span>&nbsp;<span class="ident" id="7122712"><a href="/compress/zlib/writer_test.go.html#7121669">io</a></span><span class="op" id="7122714">.</span><span class="ident" id="7122715">Pipe</span><span class="op" id="7122719">(</span><span class="op" id="7122720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122723">defer</span>&nbsp;<span class="ident" id="7122729"><a href="/compress/zlib/writer_test.go.html#7122696">piper</a></span><span class="op" id="7122734">.</span><span class="ident" id="7122735">Close</span><span class="op" id="7122740">(</span><span class="op" id="7122741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122744">go</span>&nbsp;<span class="keyword" id="7122747">func</span><span class="op" id="7122751">(</span><span class="op" id="7122752">)</span>&nbsp;<span class="op" id="7122754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122758">defer</span>&nbsp;<span class="ident" id="7122764"><a href="/compress/zlib/writer_test.go.html#7122703">pipew</a></span><span class="op" id="7122769">.</span><span class="ident" id="7122770">Close</span><span class="op" id="7122775">(</span><span class="op" id="7122776">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122780">zlibw</span><span class="op" id="7122785">,</span>&nbsp;<span class="ident" id="7122787">err</span>&nbsp;<span class="op" id="7122791">:=</span>&nbsp;<span class="ident" id="7122794"><a href="/compress/zlib/writer.go.html#4899827">NewWriterLevelDict</a></span><span class="op" id="7122812">(</span><span class="ident" id="7122813"><a href="/compress/zlib/writer_test.go.html#7122703">pipew</a></span><span class="op" id="7122818">,</span>&nbsp;<span class="ident" id="7122820"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7122825">,</span>&nbsp;<span class="ident" id="7122827"><a href="/compress/zlib/writer_test.go.html#7122549">dict</a></span><span class="op" id="7122831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122835">if</span>&nbsp;<span class="ident" id="7122838"><a href="/compress/zlib/writer_test.go.html#7122787">err</a></span>&nbsp;<span class="op" id="7122842">!=</span>&nbsp;<span class="ident" id="7122845">nil</span>&nbsp;<span class="op" id="7122849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122854"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7122855">.</span><span class="ident" id="7122856">Errorf</span><span class="op" id="7122862">(</span><span class="string" id="7122863">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7122891">,</span>&nbsp;<span class="ident" id="7122893"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7122895">,</span>&nbsp;<span class="ident" id="7122897"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7122902">,</span>&nbsp;<span class="ident" id="7122904"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7122905">,</span>&nbsp;<span class="ident" id="7122907"><a href="/compress/zlib/writer_test.go.html#7122787">err</a></span><span class="op" id="7122910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122915">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122924">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122928">defer</span>&nbsp;<span class="ident" id="7122934"><a href="/compress/zlib/writer_test.go.html#7122780">zlibw</a></span><span class="op" id="7122939">.</span><span class="ident" id="7122940">Close</span><span class="op" id="7122945">(</span><span class="op" id="7122946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122950">_</span><span class="op" id="7122951">,</span>&nbsp;<span class="ident" id="7122953"><a href="/compress/zlib/writer_test.go.html#7122787">err</a></span>&nbsp;<span class="op" id="7122957">=</span>&nbsp;<span class="ident" id="7122959"><a href="/compress/zlib/writer_test.go.html#7122780">zlibw</a></span><span class="op" id="7122964">.</span><span class="ident" id="7122965">Write</span><span class="op" id="7122970">(</span><span class="ident" id="7122971"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7122973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122977">if</span>&nbsp;<span class="ident" id="7122980"><a href="/compress/zlib/writer_test.go.html#7122787">err</a></span>&nbsp;<span class="op" id="7122984">!=</span>&nbsp;<span class="ident" id="7122987">nil</span>&nbsp;<span class="op" id="7122991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122996"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7122997">.</span><span class="ident" id="7122998">Errorf</span><span class="op" id="7123004">(</span><span class="string" id="7123005">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7123033">,</span>&nbsp;<span class="ident" id="7123035"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7123037">,</span>&nbsp;<span class="ident" id="7123039"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7123044">,</span>&nbsp;<span class="ident" id="7123046"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7123047">,</span>&nbsp;<span class="ident" id="7123049"><a href="/compress/zlib/writer_test.go.html#7122787">err</a></span><span class="op" id="7123052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123057">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123066">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123069">}</span><span class="op" id="7123070">(</span><span class="op" id="7123071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123074">zlibr</span><span class="op" id="7123079">,</span>&nbsp;<span class="ident" id="7123081">err</span>&nbsp;<span class="op" id="7123085">:=</span>&nbsp;<span class="ident" id="7123088"><a href="/compress/zlib/reader.go.html#4896034">NewReaderDict</a></span><span class="op" id="7123101">(</span><span class="ident" id="7123102"><a href="/compress/zlib/writer_test.go.html#7122696">piper</a></span><span class="op" id="7123107">,</span>&nbsp;<span class="ident" id="7123109"><a href="/compress/zlib/writer_test.go.html#7122549">dict</a></span><span class="op" id="7123113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123116">if</span>&nbsp;<span class="ident" id="7123119"><a href="/compress/zlib/writer_test.go.html#7123081">err</a></span>&nbsp;<span class="op" id="7123123">!=</span>&nbsp;<span class="ident" id="7123126">nil</span>&nbsp;<span class="op" id="7123130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123134"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7123135">.</span><span class="ident" id="7123136">Errorf</span><span class="op" id="7123142">(</span><span class="string" id="7123143">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7123171">,</span>&nbsp;<span class="ident" id="7123173"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7123175">,</span>&nbsp;<span class="ident" id="7123177"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7123182">,</span>&nbsp;<span class="ident" id="7123184"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7123185">,</span>&nbsp;<span class="ident" id="7123187"><a href="/compress/zlib/writer_test.go.html#7123081">err</a></span><span class="op" id="7123190">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123194">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123205">defer</span>&nbsp;<span class="ident" id="7123211"><a href="/compress/zlib/writer_test.go.html#7123074">zlibr</a></span><span class="op" id="7123216">.</span><span class="ident" id="7123217">Close</span><span class="op" id="7123222">(</span><span class="op" id="7123223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7123227">//&nbsp;Compare&nbsp;the&nbsp;decompressed&nbsp;data.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123262">b1</span><span class="op" id="7123264">,</span>&nbsp;<span class="ident" id="7123266">err1</span>&nbsp;<span class="op" id="7123271">:=</span>&nbsp;<span class="ident" id="7123274"><a href="/compress/zlib/writer_test.go.html#7121675">ioutil</a></span><span class="op" id="7123280">.</span><span class="ident" id="7123281">ReadAll</span><span class="op" id="7123288">(</span><span class="ident" id="7123289"><a href="/compress/zlib/writer_test.go.html#7123074">zlibr</a></span><span class="op" id="7123294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123297">if</span>&nbsp;<span class="ident" id="7123300"><a href="/compress/zlib/writer_test.go.html#7123266">err1</a></span>&nbsp;<span class="op" id="7123305">!=</span>&nbsp;<span class="ident" id="7123308">nil</span>&nbsp;<span class="op" id="7123312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123316"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7123317">.</span><span class="ident" id="7123318">Errorf</span><span class="op" id="7123324">(</span><span class="string" id="7123325">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;%v&#34;</span><span class="op" id="7123353">,</span>&nbsp;<span class="ident" id="7123355"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7123357">,</span>&nbsp;<span class="ident" id="7123359"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7123364">,</span>&nbsp;<span class="ident" id="7123366"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7123367">,</span>&nbsp;<span class="ident" id="7123369"><a href="/compress/zlib/writer_test.go.html#7123266">err1</a></span><span class="op" id="7123373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123377">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123385">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123388">if</span>&nbsp;<span class="builtinfunc" id="7123391">len</span><span class="op" id="7123394">(</span><span class="ident" id="7123395"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7123397">)</span>&nbsp;<span class="op" id="7123399">!=</span>&nbsp;<span class="builtinfunc" id="7123402">len</span><span class="op" id="7123405">(</span><span class="ident" id="7123406"><a href="/compress/zlib/writer_test.go.html#7123262">b1</a></span><span class="op" id="7123408">)</span>&nbsp;<span class="op" id="7123410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123414"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7123415">.</span><span class="ident" id="7123416">Errorf</span><span class="op" id="7123422">(</span><span class="string" id="7123423">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;length&nbsp;mismatch&nbsp;%d&nbsp;versus&nbsp;%d&#34;</span><span class="op" id="7123477">,</span>&nbsp;<span class="ident" id="7123479"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7123481">,</span>&nbsp;<span class="ident" id="7123483"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7123488">,</span>&nbsp;<span class="ident" id="7123490"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7123491">,</span>&nbsp;<span class="builtinfunc" id="7123493">len</span><span class="op" id="7123496">(</span><span class="ident" id="7123497"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7123499">)</span><span class="op" id="7123500">,</span>&nbsp;<span class="builtinfunc" id="7123502">len</span><span class="op" id="7123505">(</span><span class="ident" id="7123506"><a href="/compress/zlib/writer_test.go.html#7123262">b1</a></span><span class="op" id="7123508">)</span><span class="op" id="7123509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123524">for</span>&nbsp;<span class="ident" id="7123528">i</span>&nbsp;<span class="op" id="7123530">:=</span>&nbsp;<span class="num" id="7123533">0</span><span class="op" id="7123534">;</span>&nbsp;<span class="ident" id="7123536"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span>&nbsp;<span class="op" id="7123538">&lt;</span>&nbsp;<span class="builtinfunc" id="7123540">len</span><span class="op" id="7123543">(</span><span class="ident" id="7123544"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7123546">)</span><span class="op" id="7123547">;</span>&nbsp;<span class="ident" id="7123549"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123550">++</span>&nbsp;<span class="op" id="7123553">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123557">if</span>&nbsp;<span class="ident" id="7123560"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7123562">[</span><span class="ident" id="7123563"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123564">]</span>&nbsp;<span class="op" id="7123566">!=</span>&nbsp;<span class="ident" id="7123569"><a href="/compress/zlib/writer_test.go.html#7123262">b1</a></span><span class="op" id="7123571">[</span><span class="ident" id="7123572"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123573">]</span>&nbsp;<span class="op" id="7123575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123580"><a href="/compress/zlib/writer_test.go.html#7122454">t</a></span><span class="op" id="7123581">.</span><span class="ident" id="7123582">Errorf</span><span class="op" id="7123588">(</span><span class="string" id="7123589">&#34;%s&nbsp;(level=%d,&nbsp;dict=%q):&nbsp;mismatch&nbsp;at&nbsp;%d,&nbsp;0x%02x&nbsp;versus&nbsp;0x%02x\n&#34;</span><span class="op" id="7123653">,</span>&nbsp;<span class="ident" id="7123655"><a href="/compress/zlib/writer_test.go.html#7122468">fn</a></span><span class="op" id="7123657">,</span>&nbsp;<span class="ident" id="7123659"><a href="/compress/zlib/writer_test.go.html#7122490">level</a></span><span class="op" id="7123664">,</span>&nbsp;<span class="ident" id="7123666"><a href="/compress/zlib/writer_test.go.html#7122501">d</a></span><span class="op" id="7123667">,</span>&nbsp;<span class="ident" id="7123669"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123670">,</span>&nbsp;<span class="ident" id="7123672"><a href="/compress/zlib/writer_test.go.html#7122479">b0</a></span><span class="op" id="7123674">[</span><span class="ident" id="7123675"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123676">]</span><span class="op" id="7123677">,</span>&nbsp;<span class="ident" id="7123679"><a href="/compress/zlib/writer_test.go.html#7123262">b1</a></span><span class="op" id="7123681">[</span><span class="ident" id="7123682"><a href="/compress/zlib/writer_test.go.html#7123528">i</a></span><span class="op" id="7123683">]</span><span class="op" id="7123684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123689">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123701">}</span><br>
<span class="lineno">90</span><span class="op" id="7123703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7123706">func</span>&nbsp;<span class="ident" id="7123711">testFileLevelDictReset</span><span class="op" id="7123733">(</span><span class="ident" id="7123734">t</span>&nbsp;<span class="op" id="7123736">*</span><span class="ident" id="7123737"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7123744">.</span><span class="ident" id="7123745">T</span><span class="op" id="7123746">,</span>&nbsp;<span class="ident" id="7123748">fn</span>&nbsp;<span class="builtintype" id="7123751">string</span><span class="op" id="7123757">,</span>&nbsp;<span class="ident" id="7123759">level</span>&nbsp;<span class="builtintype" id="7123765">int</span><span class="op" id="7123768">,</span>&nbsp;<span class="ident" id="7123770">dict</span>&nbsp;<span class="op" id="7123775">[</span><span class="op" id="7123776">]</span><span class="builtintype" id="7123777">byte</span><span class="op" id="7123781">)</span>&nbsp;<span class="op" id="7123783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123786">var</span>&nbsp;<span class="ident" id="7123790">b0</span>&nbsp;<span class="op" id="7123793">[</span><span class="op" id="7123794">]</span><span class="builtintype" id="7123795">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123801">var</span>&nbsp;<span class="ident" id="7123805">err</span>&nbsp;<span class="builtintype" id="7123809">error</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123816">if</span>&nbsp;<span class="ident" id="7123819"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span>&nbsp;<span class="op" id="7123822">!=</span>&nbsp;<span class="string" id="7123825">&#34;&#34;</span>&nbsp;<span class="op" id="7123828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123832"><a href="/compress/zlib/writer_test.go.html#7123790">b0</a></span><span class="op" id="7123834">,</span>&nbsp;<span class="ident" id="7123836"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7123840">=</span>&nbsp;<span class="ident" id="7123842"><a href="/compress/zlib/writer_test.go.html#7121675">ioutil</a></span><span class="op" id="7123848">.</span><span class="ident" id="7123849">ReadFile</span><span class="op" id="7123857">(</span><span class="ident" id="7123858"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span><span class="op" id="7123860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123864">if</span>&nbsp;<span class="ident" id="7123867"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7123871">!=</span>&nbsp;<span class="ident" id="7123874">nil</span>&nbsp;<span class="op" id="7123878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123883"><a href="/compress/zlib/writer_test.go.html#7123734">t</a></span><span class="op" id="7123884">.</span><span class="ident" id="7123885">Errorf</span><span class="op" id="7123891">(</span><span class="string" id="7123892">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7123911">,</span>&nbsp;<span class="ident" id="7123913"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span><span class="op" id="7123915">,</span>&nbsp;<span class="ident" id="7123917"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7123922">,</span>&nbsp;<span class="ident" id="7123924"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span><span class="op" id="7123927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123932">return</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7123948">//&nbsp;Compress&nbsp;once.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123967">buf</span>&nbsp;<span class="op" id="7123971">:=</span>&nbsp;<span class="builtinfunc" id="7123974">new</span><span class="op" id="7123977">(</span><span class="ident" id="7123978"><a href="/compress/zlib/writer_test.go.html#7121653">bytes</a></span><span class="op" id="7123983">.</span><span class="ident" id="7123984">Buffer</span><span class="op" id="7123990">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7123993">var</span>&nbsp;<span class="ident" id="7123997">zlibw</span>&nbsp;<span class="op" id="7124003">*</span><span class="ident" id="7124004"><a href="/compress/zlib/writer.go.html#4898662">Writer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124012">if</span>&nbsp;<span class="ident" id="7124015"><a href="/compress/zlib/writer_test.go.html#7123770">dict</a></span>&nbsp;<span class="op" id="7124020">==</span>&nbsp;<span class="ident" id="7124023">nil</span>&nbsp;<span class="op" id="7124027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124031"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124036">,</span>&nbsp;<span class="ident" id="7124038"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124042">=</span>&nbsp;<span class="ident" id="7124044"><a href="/compress/zlib/writer.go.html#4899518">NewWriterLevel</a></span><span class="op" id="7124058">(</span><span class="ident" id="7124059"><a href="/compress/zlib/writer_test.go.html#7123967">buf</a></span><span class="op" id="7124062">,</span>&nbsp;<span class="ident" id="7124064"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7124069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124072">}</span>&nbsp;<span class="keyword" id="7124074">else</span>&nbsp;<span class="op" id="7124079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124083"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124088">,</span>&nbsp;<span class="ident" id="7124090"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124094">=</span>&nbsp;<span class="ident" id="7124096"><a href="/compress/zlib/writer.go.html#4899827">NewWriterLevelDict</a></span><span class="op" id="7124114">(</span><span class="ident" id="7124115"><a href="/compress/zlib/writer_test.go.html#7123967">buf</a></span><span class="op" id="7124118">,</span>&nbsp;<span class="ident" id="7124120"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7124125">,</span>&nbsp;<span class="ident" id="7124127"><a href="/compress/zlib/writer_test.go.html#7123770">dict</a></span><span class="op" id="7124131">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124137">if</span>&nbsp;<span class="ident" id="7124140"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124144">==</span>&nbsp;<span class="ident" id="7124147">nil</span>&nbsp;<span class="op" id="7124151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124155">_</span><span class="op" id="7124156">,</span>&nbsp;<span class="ident" id="7124158"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124162">=</span>&nbsp;<span class="ident" id="7124164"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124169">.</span><span class="ident" id="7124170">Write</span><span class="op" id="7124175">(</span><span class="ident" id="7124176"><a href="/compress/zlib/writer_test.go.html#7123790">b0</a></span><span class="op" id="7124178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124184">if</span>&nbsp;<span class="ident" id="7124187"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124191">==</span>&nbsp;<span class="ident" id="7124194">nil</span>&nbsp;<span class="op" id="7124198">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124202"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124206">=</span>&nbsp;<span class="ident" id="7124208"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124213">.</span><span class="ident" id="7124214">Close</span><span class="op" id="7124219">(</span><span class="op" id="7124220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124226">if</span>&nbsp;<span class="ident" id="7124229"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124233">!=</span>&nbsp;<span class="ident" id="7124236">nil</span>&nbsp;<span class="op" id="7124240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124244"><a href="/compress/zlib/writer_test.go.html#7123734">t</a></span><span class="op" id="7124245">.</span><span class="ident" id="7124246">Errorf</span><span class="op" id="7124252">(</span><span class="string" id="7124253">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7124272">,</span>&nbsp;<span class="ident" id="7124274"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span><span class="op" id="7124276">,</span>&nbsp;<span class="ident" id="7124278"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7124283">,</span>&nbsp;<span class="ident" id="7124285"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span><span class="op" id="7124288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124292">return</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124303">out</span>&nbsp;<span class="op" id="7124307">:=</span>&nbsp;<span class="ident" id="7124310"><a href="/compress/zlib/writer_test.go.html#7123967">buf</a></span><span class="op" id="7124313">.</span><span class="ident" id="7124314">String</span><span class="op" id="7124320">(</span><span class="op" id="7124321">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7124325">//&nbsp;Reset&nbsp;and&nbsp;compress&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124355">buf2</span>&nbsp;<span class="op" id="7124360">:=</span>&nbsp;<span class="builtinfunc" id="7124363">new</span><span class="op" id="7124366">(</span><span class="ident" id="7124367"><a href="/compress/zlib/writer_test.go.html#7121653">bytes</a></span><span class="op" id="7124372">.</span><span class="ident" id="7124373">Buffer</span><span class="op" id="7124379">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124382"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124387">.</span><span class="ident" id="7124388">Reset</span><span class="op" id="7124393">(</span><span class="ident" id="7124394"><a href="/compress/zlib/writer_test.go.html#7124355">buf2</a></span><span class="op" id="7124398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124401">_</span><span class="op" id="7124402">,</span>&nbsp;<span class="ident" id="7124404"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124408">=</span>&nbsp;<span class="ident" id="7124410"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124415">.</span><span class="ident" id="7124416">Write</span><span class="op" id="7124421">(</span><span class="ident" id="7124422"><a href="/compress/zlib/writer_test.go.html#7123790">b0</a></span><span class="op" id="7124424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124427">if</span>&nbsp;<span class="ident" id="7124430"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124434">==</span>&nbsp;<span class="ident" id="7124437">nil</span>&nbsp;<span class="op" id="7124441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124445"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124449">=</span>&nbsp;<span class="ident" id="7124451"><a href="/compress/zlib/writer_test.go.html#7123997">zlibw</a></span><span class="op" id="7124456">.</span><span class="ident" id="7124457">Close</span><span class="op" id="7124462">(</span><span class="op" id="7124463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124466">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124469">if</span>&nbsp;<span class="ident" id="7124472"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span>&nbsp;<span class="op" id="7124476">!=</span>&nbsp;<span class="ident" id="7124479">nil</span>&nbsp;<span class="op" id="7124483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124487"><a href="/compress/zlib/writer_test.go.html#7123734">t</a></span><span class="op" id="7124488">.</span><span class="ident" id="7124489">Errorf</span><span class="op" id="7124495">(</span><span class="string" id="7124496">&#34;%s&nbsp;(level=%d):&nbsp;%v&#34;</span><span class="op" id="7124515">,</span>&nbsp;<span class="ident" id="7124517"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span><span class="op" id="7124519">,</span>&nbsp;<span class="ident" id="7124521"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7124526">,</span>&nbsp;<span class="ident" id="7124528"><a href="/compress/zlib/writer_test.go.html#7123805">err</a></span><span class="op" id="7124531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124535">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124546">out2</span>&nbsp;<span class="op" id="7124551">:=</span>&nbsp;<span class="ident" id="7124554"><a href="/compress/zlib/writer_test.go.html#7124355">buf2</a></span><span class="op" id="7124558">.</span><span class="ident" id="7124559">String</span><span class="op" id="7124565">(</span><span class="op" id="7124566">)</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124570">if</span>&nbsp;<span class="ident" id="7124573"><a href="/compress/zlib/writer_test.go.html#7124546">out2</a></span>&nbsp;<span class="op" id="7124578">!=</span>&nbsp;<span class="ident" id="7124581"><a href="/compress/zlib/writer_test.go.html#7124303">out</a></span>&nbsp;<span class="op" id="7124585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124589"><a href="/compress/zlib/writer_test.go.html#7123734">t</a></span><span class="op" id="7124590">.</span><span class="ident" id="7124591">Errorf</span><span class="op" id="7124597">(</span><span class="string" id="7124598">&#34;%s&nbsp;(level=%d):&nbsp;different&nbsp;output&nbsp;after&nbsp;reset&nbsp;(got&nbsp;%d&nbsp;bytes,&nbsp;expected&nbsp;%d&#34;</span><span class="op" id="7124670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124675"><a href="/compress/zlib/writer_test.go.html#7123748">fn</a></span><span class="op" id="7124677">,</span>&nbsp;<span class="ident" id="7124679"><a href="/compress/zlib/writer_test.go.html#7123759">level</a></span><span class="op" id="7124684">,</span>&nbsp;<span class="builtinfunc" id="7124686">len</span><span class="op" id="7124689">(</span><span class="ident" id="7124690"><a href="/compress/zlib/writer_test.go.html#7124546">out2</a></span><span class="op" id="7124694">)</span><span class="op" id="7124695">,</span>&nbsp;<span class="builtinfunc" id="7124697">len</span><span class="op" id="7124700">(</span><span class="ident" id="7124701"><a href="/compress/zlib/writer_test.go.html#7124303">out</a></span><span class="op" id="7124704">)</span><span class="op" id="7124705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7124708">}</span><br>
<span class="lineno">140</span><span class="op" id="7124710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7124713">func</span>&nbsp;<span class="ident" id="7124718">TestWriter</span><span class="op" id="7124728">(</span><span class="ident" id="7124729">t</span>&nbsp;<span class="op" id="7124731">*</span><span class="ident" id="7124732"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7124739">.</span><span class="ident" id="7124740">T</span><span class="op" id="7124741">)</span>&nbsp;<span class="op" id="7124743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124746">for</span>&nbsp;<span class="ident" id="7124750">i</span><span class="op" id="7124751">,</span>&nbsp;<span class="ident" id="7124753">s</span>&nbsp;<span class="op" id="7124755">:=</span>&nbsp;<span class="keyword" id="7124758">range</span>&nbsp;<span class="ident" id="7124764"><a href="/compress/zlib/writer_test.go.html#7121785">data</a></span>&nbsp;<span class="op" id="7124769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124773">b</span>&nbsp;<span class="op" id="7124775">:=</span>&nbsp;<span class="op" id="7124778">[</span><span class="op" id="7124779">]</span><span class="builtintype" id="7124780">byte</span><span class="op" id="7124784">(</span><span class="ident" id="7124785"><a href="/compress/zlib/writer_test.go.html#7124753">s</a></span><span class="op" id="7124786">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124790">tag</span>&nbsp;<span class="op" id="7124794">:=</span>&nbsp;<span class="ident" id="7124797"><a href="/compress/zlib/writer_test.go.html#7121662">fmt</a></span><span class="op" id="7124800">.</span><span class="ident" id="7124801">Sprintf</span><span class="op" id="7124808">(</span><span class="string" id="7124809">&#34;#%d&#34;</span><span class="op" id="7124814">,</span>&nbsp;<span class="ident" id="7124816"><a href="/compress/zlib/writer_test.go.html#7124750">i</a></span><span class="op" id="7124817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124821"><a href="/compress/zlib/writer_test.go.html#7122440">testLevelDict</a></span><span class="op" id="7124834">(</span><span class="ident" id="7124835"><a href="/compress/zlib/writer_test.go.html#7124729">t</a></span><span class="op" id="7124836">,</span>&nbsp;<span class="ident" id="7124838"><a href="/compress/zlib/writer_test.go.html#7124790">tag</a></span><span class="op" id="7124841">,</span>&nbsp;<span class="ident" id="7124843"><a href="/compress/zlib/writer_test.go.html#7124773">b</a></span><span class="op" id="7124844">,</span>&nbsp;<span class="ident" id="7124846"><a href="/compress/zlib/writer.go.html#4898483">DefaultCompression</a></span><span class="op" id="7124864">,</span>&nbsp;<span class="string" id="7124866">&#34;&#34;</span><span class="op" id="7124868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124872"><a href="/compress/zlib/writer_test.go.html#7122440">testLevelDict</a></span><span class="op" id="7124885">(</span><span class="ident" id="7124886"><a href="/compress/zlib/writer_test.go.html#7124729">t</a></span><span class="op" id="7124887">,</span>&nbsp;<span class="ident" id="7124889"><a href="/compress/zlib/writer_test.go.html#7124790">tag</a></span><span class="op" id="7124892">,</span>&nbsp;<span class="ident" id="7124894"><a href="/compress/zlib/writer_test.go.html#7124773">b</a></span><span class="op" id="7124895">,</span>&nbsp;<span class="ident" id="7124897"><a href="/compress/zlib/writer.go.html#4898359">NoCompression</a></span><span class="op" id="7124910">,</span>&nbsp;<span class="string" id="7124912">&#34;&#34;</span><span class="op" id="7124914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7124918">for</span>&nbsp;<span class="ident" id="7124922">level</span>&nbsp;<span class="op" id="7124928">:=</span>&nbsp;<span class="ident" id="7124931"><a href="/compress/zlib/writer.go.html#4898401">BestSpeed</a></span><span class="op" id="7124940">;</span>&nbsp;<span class="ident" id="7124942"><a href="/compress/zlib/writer_test.go.html#7124922">level</a></span>&nbsp;<span class="op" id="7124948">&lt;=</span>&nbsp;<span class="ident" id="7124951"><a href="/compress/zlib/writer.go.html#4898439">BestCompression</a></span><span class="op" id="7124966">;</span>&nbsp;<span class="ident" id="7124968"><a href="/compress/zlib/writer_test.go.html#7124922">level</a></span><span class="op" id="7124973">++</span>&nbsp;<span class="op" id="7124976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124981"><a href="/compress/zlib/writer_test.go.html#7122440">testLevelDict</a></span><span class="op" id="7124994">(</span><span class="ident" id="7124995"><a href="/compress/zlib/writer_test.go.html#7124729">t</a></span><span class="op" id="7124996">,</span>&nbsp;<span class="ident" id="7124998"><a href="/compress/zlib/writer_test.go.html#7124790">tag</a></span><span class="op" id="7125001">,</span>&nbsp;<span class="ident" id="7125003"><a href="/compress/zlib/writer_test.go.html#7124773">b</a></span><span class="op" id="7125004">,</span>&nbsp;<span class="ident" id="7125006"><a href="/compress/zlib/writer_test.go.html#7124922">level</a></span><span class="op" id="7125011">,</span>&nbsp;<span class="string" id="7125013">&#34;&#34;</span><span class="op" id="7125015">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125022">}</span><br>
<span class="lineno"></span><span class="op" id="7125024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7125027">func</span>&nbsp;<span class="ident" id="7125032">TestWriterBig</span><span class="op" id="7125045">(</span><span class="ident" id="7125046">t</span>&nbsp;<span class="op" id="7125048">*</span><span class="ident" id="7125049"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7125056">.</span><span class="ident" id="7125057">T</span><span class="op" id="7125058">)</span>&nbsp;<span class="op" id="7125060">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125063">for</span>&nbsp;<span class="ident" id="7125067">_</span><span class="op" id="7125068">,</span>&nbsp;<span class="ident" id="7125070">fn</span>&nbsp;<span class="op" id="7125073">:=</span>&nbsp;<span class="keyword" id="7125076">range</span>&nbsp;<span class="ident" id="7125082"><a href="/compress/zlib/writer_test.go.html#7121711">filenames</a></span>&nbsp;<span class="op" id="7125092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125096"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125113">(</span><span class="ident" id="7125114"><a href="/compress/zlib/writer_test.go.html#7125046">t</a></span><span class="op" id="7125115">,</span>&nbsp;<span class="ident" id="7125117"><a href="/compress/zlib/writer_test.go.html#7125070">fn</a></span><span class="op" id="7125119">,</span>&nbsp;<span class="ident" id="7125121"><a href="/compress/zlib/writer.go.html#4898483">DefaultCompression</a></span><span class="op" id="7125139">,</span>&nbsp;<span class="string" id="7125141">&#34;&#34;</span><span class="op" id="7125143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125147"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125164">(</span><span class="ident" id="7125165"><a href="/compress/zlib/writer_test.go.html#7125046">t</a></span><span class="op" id="7125166">,</span>&nbsp;<span class="ident" id="7125168"><a href="/compress/zlib/writer_test.go.html#7125070">fn</a></span><span class="op" id="7125170">,</span>&nbsp;<span class="ident" id="7125172"><a href="/compress/zlib/writer.go.html#4898359">NoCompression</a></span><span class="op" id="7125185">,</span>&nbsp;<span class="string" id="7125187">&#34;&#34;</span><span class="op" id="7125189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125193">for</span>&nbsp;<span class="ident" id="7125197">level</span>&nbsp;<span class="op" id="7125203">:=</span>&nbsp;<span class="ident" id="7125206"><a href="/compress/zlib/writer.go.html#4898401">BestSpeed</a></span><span class="op" id="7125215">;</span>&nbsp;<span class="ident" id="7125217"><a href="/compress/zlib/writer_test.go.html#7125197">level</a></span>&nbsp;<span class="op" id="7125223">&lt;=</span>&nbsp;<span class="ident" id="7125226"><a href="/compress/zlib/writer.go.html#4898439">BestCompression</a></span><span class="op" id="7125241">;</span>&nbsp;<span class="ident" id="7125243"><a href="/compress/zlib/writer_test.go.html#7125197">level</a></span><span class="op" id="7125248">++</span>&nbsp;<span class="op" id="7125251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125256"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125273">(</span><span class="ident" id="7125274"><a href="/compress/zlib/writer_test.go.html#7125046">t</a></span><span class="op" id="7125275">,</span>&nbsp;<span class="ident" id="7125277"><a href="/compress/zlib/writer_test.go.html#7125070">fn</a></span><span class="op" id="7125279">,</span>&nbsp;<span class="ident" id="7125281"><a href="/compress/zlib/writer_test.go.html#7125197">level</a></span><span class="op" id="7125286">,</span>&nbsp;<span class="string" id="7125288">&#34;&#34;</span><span class="op" id="7125290">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125297">}</span><br>
<span class="lineno"></span><span class="op" id="7125299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7125302">func</span>&nbsp;<span class="ident" id="7125307">TestWriterDict</span><span class="op" id="7125321">(</span><span class="ident" id="7125322">t</span>&nbsp;<span class="op" id="7125324">*</span><span class="ident" id="7125325"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7125332">.</span><span class="ident" id="7125333">T</span><span class="op" id="7125334">)</span>&nbsp;<span class="op" id="7125336">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125339">const</span>&nbsp;<span class="ident" id="7125345">dictionary</span>&nbsp;<span class="op" id="7125356">=</span>&nbsp;<span class="string" id="7125358">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125373">for</span>&nbsp;<span class="ident" id="7125377">_</span><span class="op" id="7125378">,</span>&nbsp;<span class="ident" id="7125380">fn</span>&nbsp;<span class="op" id="7125383">:=</span>&nbsp;<span class="keyword" id="7125386">range</span>&nbsp;<span class="ident" id="7125392"><a href="/compress/zlib/writer_test.go.html#7121711">filenames</a></span>&nbsp;<span class="op" id="7125402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125406"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125423">(</span><span class="ident" id="7125424"><a href="/compress/zlib/writer_test.go.html#7125322">t</a></span><span class="op" id="7125425">,</span>&nbsp;<span class="ident" id="7125427"><a href="/compress/zlib/writer_test.go.html#7125380">fn</a></span><span class="op" id="7125429">,</span>&nbsp;<span class="ident" id="7125431"><a href="/compress/zlib/writer.go.html#4898483">DefaultCompression</a></span><span class="op" id="7125449">,</span>&nbsp;<span class="ident" id="7125451"><a href="/compress/zlib/writer_test.go.html#7125345">dictionary</a></span><span class="op" id="7125461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125465"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125482">(</span><span class="ident" id="7125483"><a href="/compress/zlib/writer_test.go.html#7125322">t</a></span><span class="op" id="7125484">,</span>&nbsp;<span class="ident" id="7125486"><a href="/compress/zlib/writer_test.go.html#7125380">fn</a></span><span class="op" id="7125488">,</span>&nbsp;<span class="ident" id="7125490"><a href="/compress/zlib/writer.go.html#4898359">NoCompression</a></span><span class="op" id="7125503">,</span>&nbsp;<span class="ident" id="7125505"><a href="/compress/zlib/writer_test.go.html#7125345">dictionary</a></span><span class="op" id="7125515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125519">for</span>&nbsp;<span class="ident" id="7125523">level</span>&nbsp;<span class="op" id="7125529">:=</span>&nbsp;<span class="ident" id="7125532"><a href="/compress/zlib/writer.go.html#4898401">BestSpeed</a></span><span class="op" id="7125541">;</span>&nbsp;<span class="ident" id="7125543"><a href="/compress/zlib/writer_test.go.html#7125523">level</a></span>&nbsp;<span class="op" id="7125549">&lt;=</span>&nbsp;<span class="ident" id="7125552"><a href="/compress/zlib/writer.go.html#4898439">BestCompression</a></span><span class="op" id="7125567">;</span>&nbsp;<span class="ident" id="7125569"><a href="/compress/zlib/writer_test.go.html#7125523">level</a></span><span class="op" id="7125574">++</span>&nbsp;<span class="op" id="7125577">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125582"><a href="/compress/zlib/writer_test.go.html#7122027">testFileLevelDict</a></span><span class="op" id="7125599">(</span><span class="ident" id="7125600"><a href="/compress/zlib/writer_test.go.html#7125322">t</a></span><span class="op" id="7125601">,</span>&nbsp;<span class="ident" id="7125603"><a href="/compress/zlib/writer_test.go.html#7125380">fn</a></span><span class="op" id="7125605">,</span>&nbsp;<span class="ident" id="7125607"><a href="/compress/zlib/writer_test.go.html#7125523">level</a></span><span class="op" id="7125612">,</span>&nbsp;<span class="ident" id="7125614"><a href="/compress/zlib/writer_test.go.html#7125345">dictionary</a></span><span class="op" id="7125624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125631">}</span><br>
<span class="lineno"></span><span class="op" id="7125633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="7125636">func</span>&nbsp;<span class="ident" id="7125641">TestWriterReset</span><span class="op" id="7125656">(</span><span class="ident" id="7125657">t</span>&nbsp;<span class="op" id="7125659">*</span><span class="ident" id="7125660"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7125667">.</span><span class="ident" id="7125668">T</span><span class="op" id="7125669">)</span>&nbsp;<span class="op" id="7125671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125674">const</span>&nbsp;<span class="ident" id="7125680">dictionary</span>&nbsp;<span class="op" id="7125691">=</span>&nbsp;<span class="string" id="7125693">&#34;0123456789.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125708">for</span>&nbsp;<span class="ident" id="7125712">_</span><span class="op" id="7125713">,</span>&nbsp;<span class="ident" id="7125715">fn</span>&nbsp;<span class="op" id="7125718">:=</span>&nbsp;<span class="keyword" id="7125721">range</span>&nbsp;<span class="ident" id="7125727"><a href="/compress/zlib/writer_test.go.html#7121711">filenames</a></span>&nbsp;<span class="op" id="7125737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125741"><a href="/compress/zlib/writer_test.go.html#7123711">testFileLevelDictReset</a></span><span class="op" id="7125763">(</span><span class="ident" id="7125764"><a href="/compress/zlib/writer_test.go.html#7125657">t</a></span><span class="op" id="7125765">,</span>&nbsp;<span class="ident" id="7125767"><a href="/compress/zlib/writer_test.go.html#7125715">fn</a></span><span class="op" id="7125769">,</span>&nbsp;<span class="ident" id="7125771"><a href="/compress/zlib/writer.go.html#4898359">NoCompression</a></span><span class="op" id="7125784">,</span>&nbsp;<span class="ident" id="7125786">nil</span><span class="op" id="7125789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125793"><a href="/compress/zlib/writer_test.go.html#7123711">testFileLevelDictReset</a></span><span class="op" id="7125815">(</span><span class="ident" id="7125816"><a href="/compress/zlib/writer_test.go.html#7125657">t</a></span><span class="op" id="7125817">,</span>&nbsp;<span class="ident" id="7125819"><a href="/compress/zlib/writer_test.go.html#7125715">fn</a></span><span class="op" id="7125821">,</span>&nbsp;<span class="ident" id="7125823"><a href="/compress/zlib/writer.go.html#4898483">DefaultCompression</a></span><span class="op" id="7125841">,</span>&nbsp;<span class="ident" id="7125843">nil</span><span class="op" id="7125846">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125850"><a href="/compress/zlib/writer_test.go.html#7123711">testFileLevelDictReset</a></span><span class="op" id="7125872">(</span><span class="ident" id="7125873"><a href="/compress/zlib/writer_test.go.html#7125657">t</a></span><span class="op" id="7125874">,</span>&nbsp;<span class="ident" id="7125876"><a href="/compress/zlib/writer_test.go.html#7125715">fn</a></span><span class="op" id="7125878">,</span>&nbsp;<span class="ident" id="7125880"><a href="/compress/zlib/writer.go.html#4898359">NoCompression</a></span><span class="op" id="7125893">,</span>&nbsp;<span class="op" id="7125895">[</span><span class="op" id="7125896">]</span><span class="builtintype" id="7125897">byte</span><span class="op" id="7125901">(</span><span class="ident" id="7125902"><a href="/compress/zlib/writer_test.go.html#7125680">dictionary</a></span><span class="op" id="7125912">)</span><span class="op" id="7125913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125917"><a href="/compress/zlib/writer_test.go.html#7123711">testFileLevelDictReset</a></span><span class="op" id="7125939">(</span><span class="ident" id="7125940"><a href="/compress/zlib/writer_test.go.html#7125657">t</a></span><span class="op" id="7125941">,</span>&nbsp;<span class="ident" id="7125943"><a href="/compress/zlib/writer_test.go.html#7125715">fn</a></span><span class="op" id="7125945">,</span>&nbsp;<span class="ident" id="7125947"><a href="/compress/zlib/writer.go.html#4898483">DefaultCompression</a></span><span class="op" id="7125965">,</span>&nbsp;<span class="op" id="7125967">[</span><span class="op" id="7125968">]</span><span class="builtintype" id="7125969">byte</span><span class="op" id="7125973">(</span><span class="ident" id="7125974"><a href="/compress/zlib/writer_test.go.html#7125680">dictionary</a></span><span class="op" id="7125984">)</span><span class="op" id="7125985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125989">if</span>&nbsp;<span class="op" id="7125992">!</span><span class="ident" id="7125993"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7126000">.</span><span class="ident" id="7126001">Short</span><span class="op" id="7126006">(</span><span class="op" id="7126007">)</span>&nbsp;<span class="op" id="7126009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126014">for</span>&nbsp;<span class="ident" id="7126018">level</span>&nbsp;<span class="op" id="7126024">:=</span>&nbsp;<span class="ident" id="7126027"><a href="/compress/zlib/writer.go.html#4898401">BestSpeed</a></span><span class="op" id="7126036">;</span>&nbsp;<span class="ident" id="7126038"><a href="/compress/zlib/writer_test.go.html#7126018">level</a></span>&nbsp;<span class="op" id="7126044">&lt;=</span>&nbsp;<span class="ident" id="7126047"><a href="/compress/zlib/writer.go.html#4898439">BestCompression</a></span><span class="op" id="7126062">;</span>&nbsp;<span class="ident" id="7126064"><a href="/compress/zlib/writer_test.go.html#7126018">level</a></span><span class="op" id="7126069">++</span>&nbsp;<span class="op" id="7126072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126078"><a href="/compress/zlib/writer_test.go.html#7123711">testFileLevelDictReset</a></span><span class="op" id="7126100">(</span><span class="ident" id="7126101"><a href="/compress/zlib/writer_test.go.html#7125657">t</a></span><span class="op" id="7126102">,</span>&nbsp;<span class="ident" id="7126104"><a href="/compress/zlib/writer_test.go.html#7125715">fn</a></span><span class="op" id="7126106">,</span>&nbsp;<span class="ident" id="7126108"><a href="/compress/zlib/writer_test.go.html#7126018">level</a></span><span class="op" id="7126113">,</span>&nbsp;<span class="ident" id="7126115">nil</span><span class="op" id="7126118">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126130">}</span><br>
<span class="lineno"></span><span class="op" id="7126132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="7126135">func</span>&nbsp;<span class="ident" id="7126140">TestWriterDictIsUsed</span><span class="op" id="7126160">(</span><span class="ident" id="7126161">t</span>&nbsp;<span class="op" id="7126163">*</span><span class="ident" id="7126164"><a href="/compress/zlib/writer_test.go.html#7121694">testing</a></span><span class="op" id="7126171">.</span><span class="ident" id="7126172">T</span><span class="op" id="7126173">)</span>&nbsp;<span class="op" id="7126175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126178">var</span>&nbsp;<span class="ident" id="7126182">input</span>&nbsp;<span class="op" id="7126188">=</span>&nbsp;<span class="op" id="7126190">[</span><span class="op" id="7126191">]</span><span class="builtintype" id="7126192">byte</span><span class="op" id="7126196">(</span><span class="string" id="7126197">&#34;Lorem&nbsp;ipsum&nbsp;dolor&nbsp;sit&nbsp;amet,&nbsp;consectetur&nbsp;adipisicing&nbsp;elit,&nbsp;sed&nbsp;do&nbsp;eiusmod&nbsp;tempor&nbsp;incididunt&nbsp;ut&nbsp;labore&nbsp;et&nbsp;dolore&nbsp;magna&nbsp;aliqua.&#34;</span><span class="op" id="7126323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126326">var</span>&nbsp;<span class="ident" id="7126330">buf</span>&nbsp;<span class="ident" id="7126334"><a href="/compress/zlib/writer_test.go.html#7121653">bytes</a></span><span class="op" id="7126339">.</span><span class="ident" id="7126340">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126348">compressor</span><span class="op" id="7126358">,</span>&nbsp;<span class="ident" id="7126360">err</span>&nbsp;<span class="op" id="7126364">:=</span>&nbsp;<span class="ident" id="7126367"><a href="/compress/zlib/writer.go.html#4899827">NewWriterLevelDict</a></span><span class="op" id="7126385">(</span><span class="op" id="7126386">&amp;</span><span class="ident" id="7126387"><a href="/compress/zlib/writer_test.go.html#7126330">buf</a></span><span class="op" id="7126390">,</span>&nbsp;<span class="ident" id="7126392"><a href="/compress/zlib/writer.go.html#4898439">BestCompression</a></span><span class="op" id="7126407">,</span>&nbsp;<span class="ident" id="7126409"><a href="/compress/zlib/writer_test.go.html#7126182">input</a></span><span class="op" id="7126414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126417">if</span>&nbsp;<span class="ident" id="7126420"><a href="/compress/zlib/writer_test.go.html#7126360">err</a></span>&nbsp;<span class="op" id="7126424">!=</span>&nbsp;<span class="ident" id="7126427">nil</span>&nbsp;<span class="op" id="7126431">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126435"><a href="/compress/zlib/writer_test.go.html#7126161">t</a></span><span class="op" id="7126436">.</span><span class="ident" id="7126437">Errorf</span><span class="op" id="7126443">(</span><span class="string" id="7126444">&#34;error&nbsp;in&nbsp;NewWriterLevelDict:&nbsp;%s&#34;</span><span class="op" id="7126477">,</span>&nbsp;<span class="ident" id="7126479"><a href="/compress/zlib/writer_test.go.html#7126360">err</a></span><span class="op" id="7126482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126486">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126497"><a href="/compress/zlib/writer_test.go.html#7126348">compressor</a></span><span class="op" id="7126507">.</span><span class="ident" id="7126508">Write</span><span class="op" id="7126513">(</span><span class="ident" id="7126514"><a href="/compress/zlib/writer_test.go.html#7126182">input</a></span><span class="op" id="7126519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126522"><a href="/compress/zlib/writer_test.go.html#7126348">compressor</a></span><span class="op" id="7126532">.</span><span class="ident" id="7126533">Close</span><span class="op" id="7126538">(</span><span class="op" id="7126539">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126542">const</span>&nbsp;<span class="ident" id="7126548">expectedMaxSize</span>&nbsp;<span class="op" id="7126564">=</span>&nbsp;<span class="num" id="7126566">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126570">output</span>&nbsp;<span class="op" id="7126577">:=</span>&nbsp;<span class="ident" id="7126580"><a href="/compress/zlib/writer_test.go.html#7126330">buf</a></span><span class="op" id="7126583">.</span><span class="ident" id="7126584">Bytes</span><span class="op" id="7126589">(</span><span class="op" id="7126590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126593">if</span>&nbsp;<span class="builtinfunc" id="7126596">len</span><span class="op" id="7126599">(</span><span class="ident" id="7126600"><a href="/compress/zlib/writer_test.go.html#7126570">output</a></span><span class="op" id="7126606">)</span>&nbsp;<span class="op" id="7126608">&gt;</span>&nbsp;<span class="ident" id="7126610"><a href="/compress/zlib/writer_test.go.html#7126548">expectedMaxSize</a></span>&nbsp;<span class="op" id="7126626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126630"><a href="/compress/zlib/writer_test.go.html#7126161">t</a></span><span class="op" id="7126631">.</span><span class="ident" id="7126632">Errorf</span><span class="op" id="7126638">(</span><span class="string" id="7126639">&#34;result&nbsp;too&nbsp;large&nbsp;(got&nbsp;%d,&nbsp;want&nbsp;&lt;=&nbsp;%d&nbsp;bytes).&nbsp;Is&nbsp;the&nbsp;dictionary&nbsp;being&nbsp;used?&#34;</span><span class="op" id="7126715">,</span>&nbsp;<span class="builtinfunc" id="7126717">len</span><span class="op" id="7126720">(</span><span class="ident" id="7126721"><a href="/compress/zlib/writer_test.go.html#7126570">output</a></span><span class="op" id="7126727">)</span><span class="op" id="7126728">,</span>&nbsp;<span class="ident" id="7126730"><a href="/compress/zlib/writer_test.go.html#7126548">expectedMaxSize</a></span><span class="op" id="7126745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126748">}</span><br>
<span class="lineno">205</span><span class="op" id="7126750">}</span>
</div>
</body>
</html>
