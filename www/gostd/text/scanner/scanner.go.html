<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/scanner</h2>
<ul>
<li><a href="/gostd/text/scanner/scanner.go.html" class="current">scanner.go</a></li>
<li><a href="/gostd/text/scanner/scanner_test.go.html">scanner_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6227878">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6227933">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6227987">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6228038">//&nbsp;Package&nbsp;scanner&nbsp;provides&nbsp;a&nbsp;scanner&nbsp;and&nbsp;tokenizer&nbsp;for&nbsp;UTF-8-encoded&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="6228114">//&nbsp;It&nbsp;takes&nbsp;an&nbsp;io.Reader&nbsp;providing&nbsp;the&nbsp;source,&nbsp;which&nbsp;then&nbsp;can&nbsp;be&nbsp;tokenized</span><br>
<span class="lineno"></span><span class="comment" id="6228189">//&nbsp;through&nbsp;repeated&nbsp;calls&nbsp;to&nbsp;the&nbsp;Scan&nbsp;function.&nbsp;&nbsp;For&nbsp;compatibility&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="6228261">//&nbsp;existing&nbsp;tools,&nbsp;the&nbsp;NUL&nbsp;character&nbsp;is&nbsp;not&nbsp;allowed.&nbsp;If&nbsp;the&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="6228337">//&nbsp;in&nbsp;the&nbsp;source&nbsp;is&nbsp;a&nbsp;UTF-8&nbsp;encoded&nbsp;byte&nbsp;order&nbsp;mark&nbsp;(BOM),&nbsp;it&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno">10</span><span class="comment" id="6228413">//</span><br>
<span class="lineno"></span><span class="comment" id="6228416">//&nbsp;By&nbsp;default,&nbsp;a&nbsp;Scanner&nbsp;skips&nbsp;white&nbsp;space&nbsp;and&nbsp;Go&nbsp;comments&nbsp;and&nbsp;recognizes&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="6228494">//&nbsp;literals&nbsp;as&nbsp;defined&nbsp;by&nbsp;the&nbsp;Go&nbsp;language&nbsp;specification.&nbsp;&nbsp;It&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6228562">//&nbsp;customized&nbsp;to&nbsp;recognize&nbsp;only&nbsp;a&nbsp;subset&nbsp;of&nbsp;those&nbsp;literals&nbsp;and&nbsp;to&nbsp;recognize</span><br>
<span class="lineno"></span><span class="comment" id="6228638">//&nbsp;different&nbsp;identifier&nbsp;and&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno">15</span><span class="comment" id="6228690">//</span><br>
<span class="lineno"></span><span class="comment" id="6228693">//&nbsp;Basic&nbsp;usage&nbsp;pattern:</span><br>
<span class="lineno"></span><span class="comment" id="6228717">//</span><br>
<span class="lineno"></span><span class="comment" id="6228720">//&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;scanner.Scanner</span><br>
<span class="lineno"></span><span class="comment" id="6228745">//&nbsp;&nbsp;&nbsp;&nbsp;s.Init(src)</span><br>
<span class="lineno">20</span><span class="comment" id="6228760">//&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;:=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6228779">//&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;tok&nbsp;!=&nbsp;scanner.EOF&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="6228807">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;something&nbsp;with&nbsp;tok</span><br>
<span class="lineno"></span><span class="comment" id="6228836">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tok&nbsp;=&nbsp;s.Scan()</span><br>
<span class="lineno"></span><span class="comment" id="6228855">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno">25</span><span class="comment" id="6228860">//</span><br>
<span class="lineno"></span><span class="keyword" id="6228863">package</span>&nbsp;<span class="ident" id="6228871">scanner</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6228880">import</span>&nbsp;<span class="op" id="6228887">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228890">&#34;bytes&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228899">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228906">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228912">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228918">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6228929">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">35</span><span class="op" id="6228944">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6228947">//&nbsp;A&nbsp;source&nbsp;position&nbsp;is&nbsp;represented&nbsp;by&nbsp;a&nbsp;Position&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="6229004">//&nbsp;A&nbsp;position&nbsp;is&nbsp;valid&nbsp;if&nbsp;Line&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="6229040">type</span>&nbsp;<span class="ident" id="6229045">Position</span>&nbsp;<span class="keyword" id="6229054">struct</span>&nbsp;<span class="op" id="6229061">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229064">Filename</span>&nbsp;<span class="builtintype" id="6229073">string</span>&nbsp;<span class="comment" id="6229080">//&nbsp;filename,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229101">Offset</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6229110">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229117">//&nbsp;byte&nbsp;offset,&nbsp;starting&nbsp;at&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229148">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6229157">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229164">//&nbsp;line&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229195">Column</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6229204">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6229211">//&nbsp;column&nbsp;number,&nbsp;starting&nbsp;at&nbsp;1&nbsp;(character&nbsp;count&nbsp;per&nbsp;line)</span><br>
<span class="lineno"></span><span class="op" id="6229270">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6229273">//&nbsp;IsValid&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;position&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="keyword" id="6229323">func</span>&nbsp;<span class="op" id="6229328">(</span><span class="ident" id="6229329">pos</span>&nbsp;<span class="op" id="6229333">*</span><span class="ident" id="6229334">Position</span><span class="op" id="6229342">)</span>&nbsp;<span class="ident" id="6229344">IsValid</span><span class="op" id="6229351">(</span><span class="op" id="6229352">)</span>&nbsp;<span class="builtintype" id="6229354">bool</span>&nbsp;<span class="op" id="6229359">{</span>&nbsp;<span class="keyword" id="6229361">return</span>&nbsp;<span class="ident" id="6229368">pos</span><span class="op" id="6229371">.</span><span class="ident" id="6229372">Line</span>&nbsp;<span class="op" id="6229377">&gt;</span>&nbsp;<span class="num" id="6229379">0</span>&nbsp;<span class="op" id="6229381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6229384">func</span>&nbsp;<span class="op" id="6229389">(</span><span class="ident" id="6229390">pos</span>&nbsp;<span class="ident" id="6229394">Position</span><span class="op" id="6229402">)</span>&nbsp;<span class="ident" id="6229404">String</span><span class="op" id="6229410">(</span><span class="op" id="6229411">)</span>&nbsp;<span class="builtintype" id="6229413">string</span>&nbsp;<span class="op" id="6229420">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229423">s</span>&nbsp;<span class="op" id="6229425">:=</span>&nbsp;<span class="ident" id="6229428">pos</span><span class="op" id="6229431">.</span><span class="ident" id="6229432">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6229442">if</span>&nbsp;<span class="ident" id="6229445">pos</span><span class="op" id="6229448">.</span><span class="ident" id="6229449">IsValid</span><span class="op" id="6229456">(</span><span class="op" id="6229457">)</span>&nbsp;<span class="op" id="6229459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6229463">if</span>&nbsp;<span class="ident" id="6229466">s</span>&nbsp;<span class="op" id="6229468">!=</span>&nbsp;<span class="string" id="6229471">&#34;&#34;</span>&nbsp;<span class="op" id="6229474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229479">s</span>&nbsp;<span class="op" id="6229481">+=</span>&nbsp;<span class="string" id="6229484">&#34;:&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6229490">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229494">s</span>&nbsp;<span class="op" id="6229496">+=</span>&nbsp;<span class="ident" id="6229499">fmt</span><span class="op" id="6229502">.</span><span class="ident" id="6229503">Sprintf</span><span class="op" id="6229510">(</span><span class="string" id="6229511">&#34;%d:%d&#34;</span><span class="op" id="6229518">,</span>&nbsp;<span class="ident" id="6229520">pos</span><span class="op" id="6229523">.</span><span class="ident" id="6229524">Line</span><span class="op" id="6229528">,</span>&nbsp;<span class="ident" id="6229530">pos</span><span class="op" id="6229533">.</span><span class="ident" id="6229534">Column</span><span class="op" id="6229540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6229543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6229546">if</span>&nbsp;<span class="ident" id="6229549">s</span>&nbsp;<span class="op" id="6229551">==</span>&nbsp;<span class="string" id="6229554">&#34;&#34;</span>&nbsp;<span class="op" id="6229557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6229561">s</span>&nbsp;<span class="op" id="6229563">=</span>&nbsp;<span class="string" id="6229565">&#34;???&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6229572">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6229575">return</span>&nbsp;<span class="ident" id="6229582">s</span><br>
<span class="lineno"></span><span class="op" id="6229584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6229587">//&nbsp;Predefined&nbsp;mode&nbsp;bits&nbsp;to&nbsp;control&nbsp;recognition&nbsp;of&nbsp;tokens.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span><span class="comment" id="6229659">//&nbsp;to&nbsp;configure&nbsp;a&nbsp;Scanner&nbsp;such&nbsp;that&nbsp;it&nbsp;only&nbsp;recognizes&nbsp;(Go)&nbsp;identifiers,</span><br>
<span class="lineno">65</span><span class="comment" id="6229732">//&nbsp;integers,&nbsp;and&nbsp;skips&nbsp;comments,&nbsp;set&nbsp;the&nbsp;Scanner&#39;s&nbsp;Mode&nbsp;field&nbsp;to:</span><br>
<span class="lineno"></span><span class="comment" id="6229798">//</span><br>
<span class="lineno"></span><span class="comment" id="6229801">//&nbsp;&nbsp;&nbsp;&nbsp;ScanIdents&nbsp;|&nbsp;ScanInts&nbsp;|&nbsp;SkipComments</span><br>
<span class="lineno"></span><span class="comment" id="6229841">//</span><br>
<span class="lineno"></span><span class="comment" id="6229844">//&nbsp;With&nbsp;the&nbsp;exceptions&nbsp;of&nbsp;comments,&nbsp;which&nbsp;are&nbsp;skipped&nbsp;if&nbsp;SkipComments&nbsp;is</span><br>
<span class="lineno">70</span><span class="comment" id="6229917">//&nbsp;set,&nbsp;unrecognized&nbsp;tokens&nbsp;are&nbsp;not&nbsp;ignored.&nbsp;Instead,&nbsp;the&nbsp;scanner&nbsp;simply</span><br>
<span class="lineno"></span><span class="comment" id="6229990">//&nbsp;returns&nbsp;the&nbsp;respective&nbsp;individual&nbsp;characters&nbsp;(or&nbsp;possibly&nbsp;sub-tokens).</span><br>
<span class="lineno"></span><span class="comment" id="6230064">//&nbsp;For&nbsp;instance,&nbsp;if&nbsp;the&nbsp;mode&nbsp;is&nbsp;ScanIdents&nbsp;(not&nbsp;ScanStrings),&nbsp;the&nbsp;string</span><br>
<span class="lineno"></span><span class="comment" id="6230137">//&nbsp;&#34;foo&#34;&nbsp;is&nbsp;scanned&nbsp;as&nbsp;the&nbsp;token&nbsp;sequence&nbsp;&#39;&#34;&#39;&nbsp;Ident&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="6230194">//</span><br>
<span class="lineno">75</span><span class="keyword" id="6230197">const</span>&nbsp;<span class="op" id="6230203">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230206">ScanIdents</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230221">=</span>&nbsp;<span class="num" id="6230223">1</span>&nbsp;<span class="op" id="6230225">&lt;&lt;</span>&nbsp;<span class="op" id="6230228">-</span><span class="ident" id="6230229">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230236">ScanInts</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230251">=</span>&nbsp;<span class="num" id="6230253">1</span>&nbsp;<span class="op" id="6230255">&lt;&lt;</span>&nbsp;<span class="op" id="6230258">-</span><span class="ident" id="6230259">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230264">ScanFloats</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230279">=</span>&nbsp;<span class="num" id="6230281">1</span>&nbsp;<span class="op" id="6230283">&lt;&lt;</span>&nbsp;<span class="op" id="6230286">-</span><span class="ident" id="6230287">Float</span>&nbsp;<span class="comment" id="6230293">//&nbsp;includes&nbsp;Ints</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230311">ScanChars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230326">=</span>&nbsp;<span class="num" id="6230328">1</span>&nbsp;<span class="op" id="6230330">&lt;&lt;</span>&nbsp;<span class="op" id="6230333">-</span><span class="ident" id="6230334">Char</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230340">ScanStrings</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230355">=</span>&nbsp;<span class="num" id="6230357">1</span>&nbsp;<span class="op" id="6230359">&lt;&lt;</span>&nbsp;<span class="op" id="6230362">-</span><span class="ident" id="6230363">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230371">ScanRawStrings</span>&nbsp;<span class="op" id="6230386">=</span>&nbsp;<span class="num" id="6230388">1</span>&nbsp;<span class="op" id="6230390">&lt;&lt;</span>&nbsp;<span class="op" id="6230393">-</span><span class="ident" id="6230394">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230405">ScanComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6230420">=</span>&nbsp;<span class="num" id="6230422">1</span>&nbsp;<span class="op" id="6230424">&lt;&lt;</span>&nbsp;<span class="op" id="6230427">-</span><span class="ident" id="6230428">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230437">SkipComments</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6230452">=</span>&nbsp;<span class="num" id="6230454">1</span>&nbsp;<span class="op" id="6230456">&lt;&lt;</span>&nbsp;<span class="op" id="6230459">-</span><span class="ident" id="6230460">skipComment</span>&nbsp;<span class="comment" id="6230472">//&nbsp;if&nbsp;set&nbsp;with&nbsp;ScanComments,&nbsp;comments&nbsp;become&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230530">GoTokens</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6230545">=</span>&nbsp;<span class="ident" id="6230547">ScanIdents</span>&nbsp;<span class="op" id="6230558">|</span>&nbsp;<span class="ident" id="6230560">ScanFloats</span>&nbsp;<span class="op" id="6230571">|</span>&nbsp;<span class="ident" id="6230573">ScanChars</span>&nbsp;<span class="op" id="6230583">|</span>&nbsp;<span class="ident" id="6230585">ScanStrings</span>&nbsp;<span class="op" id="6230597">|</span>&nbsp;<span class="ident" id="6230599">ScanRawStrings</span>&nbsp;<span class="op" id="6230614">|</span>&nbsp;<span class="ident" id="6230616">ScanComments</span>&nbsp;<span class="op" id="6230629">|</span>&nbsp;<span class="ident" id="6230631">SkipComments</span><br>
<span class="lineno">85</span><span class="op" id="6230644">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6230647">//&nbsp;The&nbsp;result&nbsp;of&nbsp;Scan&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;following&nbsp;tokens&nbsp;or&nbsp;a&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6230724">const</span>&nbsp;<span class="op" id="6230730">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230733">EOF</span>&nbsp;<span class="op" id="6230737">=</span>&nbsp;<span class="op" id="6230739">-</span><span class="op" id="6230740">(</span><span class="ident" id="6230741">iota</span>&nbsp;<span class="op" id="6230746">+</span>&nbsp;<span class="num" id="6230748">1</span><span class="op" id="6230749">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230752">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230759">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230764">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230771">Char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230777">String</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230785">RawString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230796">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230805">skipComment</span><br>
<span class="lineno"></span><span class="op" id="6230817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6230820">var</span>&nbsp;<span class="ident" id="6230824">tokenString</span>&nbsp;<span class="op" id="6230836">=</span>&nbsp;<span class="keyword" id="6230838">map</span><span class="op" id="6230841">[</span><span class="builtintype" id="6230842">rune</span><span class="op" id="6230846">]</span><span class="builtintype" id="6230847">string</span><span class="op" id="6230853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230856">EOF</span><span class="op" id="6230859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230867">&#34;EOF&#34;</span><span class="op" id="6230872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230875">Ident</span><span class="op" id="6230880">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230886">&#34;Ident&#34;</span><span class="op" id="6230893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230896">Int</span><span class="op" id="6230899">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230907">&#34;Int&#34;</span><span class="op" id="6230912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230915">Float</span><span class="op" id="6230920">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230926">&#34;Float&#34;</span><span class="op" id="6230933">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230936">Char</span><span class="op" id="6230940">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230947">&#34;Char&#34;</span><span class="op" id="6230953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230956">String</span><span class="op" id="6230962">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6230967">&#34;String&#34;</span><span class="op" id="6230975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6230978">RawString</span><span class="op" id="6230987">:</span>&nbsp;<span class="string" id="6230989">&#34;RawString&#34;</span><span class="op" id="6231000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231003">Comment</span><span class="op" id="6231010">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6231014">&#34;Comment&#34;</span><span class="op" id="6231023">,</span><br>
<span class="lineno"></span><span class="op" id="6231025">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="6231028">//&nbsp;TokenString&nbsp;returns&nbsp;a&nbsp;printable&nbsp;string&nbsp;for&nbsp;a&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6231104">func</span>&nbsp;<span class="ident" id="6231109">TokenString</span><span class="op" id="6231120">(</span><span class="ident" id="6231121">tok</span>&nbsp;<span class="builtintype" id="6231125">rune</span><span class="op" id="6231129">)</span>&nbsp;<span class="builtintype" id="6231131">string</span>&nbsp;<span class="op" id="6231138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6231141">if</span>&nbsp;<span class="ident" id="6231144">s</span><span class="op" id="6231145">,</span>&nbsp;<span class="ident" id="6231147">found</span>&nbsp;<span class="op" id="6231153">:=</span>&nbsp;<span class="ident" id="6231156">tokenString</span><span class="op" id="6231167">[</span><span class="ident" id="6231168">tok</span><span class="op" id="6231171">]</span><span class="op" id="6231172">;</span>&nbsp;<span class="ident" id="6231174">found</span>&nbsp;<span class="op" id="6231180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6231184">return</span>&nbsp;<span class="ident" id="6231191">s</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6231194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6231197">return</span>&nbsp;<span class="ident" id="6231204">fmt</span><span class="op" id="6231207">.</span><span class="ident" id="6231208">Sprintf</span><span class="op" id="6231215">(</span><span class="string" id="6231216">&#34;%q&#34;</span><span class="op" id="6231220">,</span>&nbsp;<span class="builtintype" id="6231222">string</span><span class="op" id="6231228">(</span><span class="ident" id="6231229">tok</span><span class="op" id="6231232">)</span><span class="op" id="6231233">)</span><br>
<span class="lineno"></span><span class="op" id="6231235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6231238">//&nbsp;GoWhitespace&nbsp;is&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;the&nbsp;Scanner&#39;s&nbsp;Whitespace&nbsp;field.</span><br>
<span class="lineno">120</span><span class="comment" id="6231311">//&nbsp;Its&nbsp;value&nbsp;selects&nbsp;Go&#39;s&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6231361">const</span>&nbsp;<span class="ident" id="6231367">GoWhitespace</span>&nbsp;<span class="op" id="6231380">=</span>&nbsp;<span class="num" id="6231382">1</span><span class="op" id="6231383">&lt;&lt;</span><span class="string" id="6231385">&#39;\t&#39;</span>&nbsp;<span class="op" id="6231390">|</span>&nbsp;<span class="num" id="6231392">1</span><span class="op" id="6231393">&lt;&lt;</span><span class="string" id="6231395">&#39;\n&#39;</span>&nbsp;<span class="op" id="6231400">|</span>&nbsp;<span class="num" id="6231402">1</span><span class="op" id="6231403">&lt;&lt;</span><span class="string" id="6231405">&#39;\r&#39;</span>&nbsp;<span class="op" id="6231410">|</span>&nbsp;<span class="num" id="6231412">1</span><span class="op" id="6231413">&lt;&lt;</span><span class="string" id="6231415">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6231420">const</span>&nbsp;<span class="ident" id="6231426">bufLen</span>&nbsp;<span class="op" id="6231433">=</span>&nbsp;<span class="num" id="6231435">1024</span>&nbsp;<span class="comment" id="6231440">//&nbsp;at&nbsp;least&nbsp;utf8.UTFMax</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6231465">//&nbsp;A&nbsp;Scanner&nbsp;implements&nbsp;reading&nbsp;of&nbsp;Unicode&nbsp;characters&nbsp;and&nbsp;tokens&nbsp;from&nbsp;an&nbsp;io.Reader.</span><br>
<span class="lineno"></span><span class="keyword" id="6231549">type</span>&nbsp;<span class="ident" id="6231554">Scanner</span>&nbsp;<span class="keyword" id="6231562">struct</span>&nbsp;<span class="op" id="6231569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6231572">//&nbsp;Input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231582">src</span>&nbsp;<span class="ident" id="6231586">io</span><span class="op" id="6231588">.</span><span class="ident" id="6231589">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6231598">//&nbsp;Source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231616">srcBuf</span>&nbsp;<span class="op" id="6231623">[</span><span class="ident" id="6231624">bufLen</span>&nbsp;<span class="op" id="6231631">+</span>&nbsp;<span class="num" id="6231633">1</span><span class="op" id="6231634">]</span><span class="builtintype" id="6231635">byte</span>&nbsp;<span class="comment" id="6231640">//&nbsp;+1&nbsp;for&nbsp;sentinel&nbsp;for&nbsp;common&nbsp;case&nbsp;of&nbsp;s.next()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231688">srcPos</span>&nbsp;<span class="builtintype" id="6231695">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6231712">//&nbsp;reading&nbsp;position&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231748">srcEnd</span>&nbsp;<span class="builtintype" id="6231755">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6231772">//&nbsp;source&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6231803">//&nbsp;Source&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231823">srcBufOffset</span>&nbsp;<span class="builtintype" id="6231836">int</span>&nbsp;<span class="comment" id="6231840">//&nbsp;byte&nbsp;offset&nbsp;of&nbsp;srcBuf[0]&nbsp;in&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231879">line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6231892">int</span>&nbsp;<span class="comment" id="6231896">//&nbsp;line&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231911">column</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6231924">int</span>&nbsp;<span class="comment" id="6231928">//&nbsp;character&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6231948">lastLineLen</span>&nbsp;&nbsp;<span class="builtintype" id="6231961">int</span>&nbsp;<span class="comment" id="6231965">//&nbsp;length&nbsp;of&nbsp;last&nbsp;line&nbsp;in&nbsp;characters&nbsp;(for&nbsp;correct&nbsp;column&nbsp;reporting)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232034">lastCharLen</span>&nbsp;&nbsp;<span class="builtintype" id="6232047">int</span>&nbsp;<span class="comment" id="6232051">//&nbsp;length&nbsp;of&nbsp;last&nbsp;character&nbsp;in&nbsp;bytes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232090">//&nbsp;Token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232112">//&nbsp;Typically,&nbsp;token&nbsp;text&nbsp;is&nbsp;stored&nbsp;completely&nbsp;in&nbsp;srcBuf,&nbsp;but&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232185">//&nbsp;the&nbsp;token&nbsp;text&#39;s&nbsp;head&nbsp;may&nbsp;be&nbsp;buffered&nbsp;in&nbsp;tokBuf&nbsp;while&nbsp;the&nbsp;token&nbsp;text&#39;s</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232260">//&nbsp;tail&nbsp;is&nbsp;stored&nbsp;in&nbsp;srcBuf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232290">tokBuf</span>&nbsp;<span class="ident" id="6232297">bytes</span><span class="op" id="6232302">.</span><span class="ident" id="6232303">Buffer</span>&nbsp;<span class="comment" id="6232310">//&nbsp;token&nbsp;text&nbsp;head&nbsp;that&nbsp;is&nbsp;not&nbsp;in&nbsp;srcBuf&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232360">tokPos</span>&nbsp;<span class="builtintype" id="6232367">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232380">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;position&nbsp;(srcBuf&nbsp;index);&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232439">tokEnd</span>&nbsp;<span class="builtintype" id="6232446">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232459">//&nbsp;token&nbsp;text&nbsp;tail&nbsp;end&nbsp;(srcBuf&nbsp;index)</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232499">//&nbsp;One&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232528">ch</span>&nbsp;<span class="builtintype" id="6232531">rune</span>&nbsp;<span class="comment" id="6232536">//&nbsp;character&nbsp;before&nbsp;current&nbsp;srcPos</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232573">//&nbsp;Error&nbsp;is&nbsp;called&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.&nbsp;If&nbsp;no&nbsp;Error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232633">//&nbsp;function&nbsp;is&nbsp;set,&nbsp;the&nbsp;error&nbsp;is&nbsp;reported&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232690">Error</span>&nbsp;<span class="keyword" id="6232696">func</span><span class="op" id="6232700">(</span><span class="ident" id="6232701">s</span>&nbsp;<span class="op" id="6232703">*</span><span class="ident" id="6232704">Scanner</span><span class="op" id="6232711">,</span>&nbsp;<span class="ident" id="6232713">msg</span>&nbsp;<span class="builtintype" id="6232717">string</span><span class="op" id="6232723">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232727">//&nbsp;ErrorCount&nbsp;is&nbsp;incremented&nbsp;by&nbsp;one&nbsp;for&nbsp;each&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232792">ErrorCount</span>&nbsp;<span class="builtintype" id="6232803">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232809">//&nbsp;The&nbsp;Mode&nbsp;field&nbsp;controls&nbsp;which&nbsp;tokens&nbsp;are&nbsp;recognized.&nbsp;For&nbsp;instance,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232880">//&nbsp;to&nbsp;recognize&nbsp;Ints,&nbsp;set&nbsp;the&nbsp;ScanInts&nbsp;bit&nbsp;in&nbsp;Mode.&nbsp;The&nbsp;field&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232950">//&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6232975">Mode</span>&nbsp;<span class="builtintype" id="6232980">uint</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6232987">//&nbsp;The&nbsp;Whitespace&nbsp;field&nbsp;controls&nbsp;which&nbsp;characters&nbsp;are&nbsp;recognized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233053">//&nbsp;as&nbsp;white&nbsp;space.&nbsp;To&nbsp;recognize&nbsp;a&nbsp;character&nbsp;ch&nbsp;&lt;=&nbsp;&#39;&nbsp;&#39;&nbsp;as&nbsp;white&nbsp;space,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233124">//&nbsp;set&nbsp;the&nbsp;ch&#39;th&nbsp;bit&nbsp;in&nbsp;Whitespace&nbsp;(the&nbsp;Scanner&#39;s&nbsp;behavior&nbsp;is&nbsp;undefined</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233197">//&nbsp;for&nbsp;values&nbsp;ch&nbsp;&gt;&nbsp;&#39;&nbsp;&#39;).&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6233261">Whitespace</span>&nbsp;<span class="ident" id="6233272">uint64</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233281">//&nbsp;IsIdentRune&nbsp;is&nbsp;a&nbsp;predicate&nbsp;controlling&nbsp;the&nbsp;characters&nbsp;accepted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233348">//&nbsp;as&nbsp;the&nbsp;ith&nbsp;rune&nbsp;in&nbsp;an&nbsp;identifier.&nbsp;The&nbsp;set&nbsp;of&nbsp;valid&nbsp;characters</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233414">//&nbsp;must&nbsp;not&nbsp;intersect&nbsp;with&nbsp;the&nbsp;set&nbsp;of&nbsp;white&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233477">//&nbsp;If&nbsp;no&nbsp;IsIdentRune&nbsp;function&nbsp;is&nbsp;set,&nbsp;regular&nbsp;Go&nbsp;identifiers&nbsp;are</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233543">//&nbsp;accepted&nbsp;instead.&nbsp;The&nbsp;field&nbsp;may&nbsp;be&nbsp;changed&nbsp;at&nbsp;any&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6233603">IsIdentRune</span>&nbsp;<span class="keyword" id="6233615">func</span><span class="op" id="6233619">(</span><span class="ident" id="6233620">ch</span>&nbsp;<span class="builtintype" id="6233623">rune</span><span class="op" id="6233627">,</span>&nbsp;<span class="ident" id="6233629">i</span>&nbsp;<span class="builtintype" id="6233631">int</span><span class="op" id="6233634">)</span>&nbsp;<span class="builtintype" id="6233636">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233643">//&nbsp;Start&nbsp;position&nbsp;of&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token;&nbsp;set&nbsp;by&nbsp;Scan.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233707">//&nbsp;Calling&nbsp;Init&nbsp;or&nbsp;Next&nbsp;invalidates&nbsp;the&nbsp;position&nbsp;(Line&nbsp;==&nbsp;0).</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233770">//&nbsp;The&nbsp;Filename&nbsp;field&nbsp;is&nbsp;always&nbsp;left&nbsp;untouched&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233834">//&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;reported&nbsp;(via&nbsp;Error)&nbsp;and&nbsp;Position&nbsp;is&nbsp;invalid,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233899">//&nbsp;the&nbsp;scanner&nbsp;is&nbsp;not&nbsp;inside&nbsp;a&nbsp;token.&nbsp;Call&nbsp;Pos&nbsp;to&nbsp;obtain&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6233966">//&nbsp;position&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6233993">Position</span><br>
<span class="lineno">185</span><span class="op" id="6234002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6234005">//&nbsp;Init&nbsp;initializes&nbsp;a&nbsp;Scanner&nbsp;with&nbsp;a&nbsp;new&nbsp;source&nbsp;and&nbsp;returns&nbsp;s.</span><br>
<span class="lineno"></span><span class="comment" id="6234068">//&nbsp;Error&nbsp;is&nbsp;set&nbsp;to&nbsp;nil,&nbsp;ErrorCount&nbsp;is&nbsp;set&nbsp;to&nbsp;0,&nbsp;Mode&nbsp;is&nbsp;set&nbsp;to&nbsp;GoTokens,</span><br>
<span class="lineno"></span><span class="comment" id="6234141">//&nbsp;and&nbsp;Whitespace&nbsp;is&nbsp;set&nbsp;to&nbsp;GoWhitespace.</span><br>
<span class="lineno">190</span><span class="keyword" id="6234183">func</span>&nbsp;<span class="op" id="6234188">(</span><span class="ident" id="6234189">s</span>&nbsp;<span class="op" id="6234191">*</span><span class="ident" id="6234192">Scanner</span><span class="op" id="6234199">)</span>&nbsp;<span class="ident" id="6234201">Init</span><span class="op" id="6234205">(</span><span class="ident" id="6234206">src</span>&nbsp;<span class="ident" id="6234210">io</span><span class="op" id="6234212">.</span><span class="ident" id="6234213">Reader</span><span class="op" id="6234219">)</span>&nbsp;<span class="op" id="6234221">*</span><span class="ident" id="6234222">Scanner</span>&nbsp;<span class="op" id="6234230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234233">s</span><span class="op" id="6234234">.</span><span class="ident" id="6234235">src</span>&nbsp;<span class="op" id="6234239">=</span>&nbsp;<span class="ident" id="6234241">src</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234247">//&nbsp;initialize&nbsp;source&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234276">//&nbsp;(the&nbsp;first&nbsp;call&nbsp;to&nbsp;next()&nbsp;will&nbsp;fill&nbsp;it&nbsp;by&nbsp;calling&nbsp;src.Read)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234340">s</span><span class="op" id="6234341">.</span><span class="ident" id="6234342">srcBuf</span><span class="op" id="6234348">[</span><span class="num" id="6234349">0</span><span class="op" id="6234350">]</span>&nbsp;<span class="op" id="6234352">=</span>&nbsp;<span class="ident" id="6234354">utf8</span><span class="op" id="6234358">.</span><span class="ident" id="6234359">RuneSelf</span>&nbsp;<span class="comment" id="6234368">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234381">s</span><span class="op" id="6234382">.</span><span class="ident" id="6234383">srcPos</span>&nbsp;<span class="op" id="6234390">=</span>&nbsp;<span class="num" id="6234392">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234395">s</span><span class="op" id="6234396">.</span><span class="ident" id="6234397">srcEnd</span>&nbsp;<span class="op" id="6234404">=</span>&nbsp;<span class="num" id="6234406">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234410">//&nbsp;initialize&nbsp;source&nbsp;position</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234441">s</span><span class="op" id="6234442">.</span><span class="ident" id="6234443">srcBufOffset</span>&nbsp;<span class="op" id="6234456">=</span>&nbsp;<span class="num" id="6234458">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234461">s</span><span class="op" id="6234462">.</span><span class="ident" id="6234463">line</span>&nbsp;<span class="op" id="6234468">=</span>&nbsp;<span class="num" id="6234470">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234473">s</span><span class="op" id="6234474">.</span><span class="ident" id="6234475">column</span>&nbsp;<span class="op" id="6234482">=</span>&nbsp;<span class="num" id="6234484">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234487">s</span><span class="op" id="6234488">.</span><span class="ident" id="6234489">lastLineLen</span>&nbsp;<span class="op" id="6234501">=</span>&nbsp;<span class="num" id="6234503">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234506">s</span><span class="op" id="6234507">.</span><span class="ident" id="6234508">lastCharLen</span>&nbsp;<span class="op" id="6234520">=</span>&nbsp;<span class="num" id="6234522">0</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234526">//&nbsp;initialize&nbsp;token&nbsp;text&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234559">//&nbsp;(required&nbsp;for&nbsp;first&nbsp;call&nbsp;to&nbsp;next()).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234600">s</span><span class="op" id="6234601">.</span><span class="ident" id="6234602">tokPos</span>&nbsp;<span class="op" id="6234609">=</span>&nbsp;<span class="op" id="6234611">-</span><span class="num" id="6234612">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234616">//&nbsp;initialize&nbsp;one&nbsp;character&nbsp;look-ahead</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234656">s</span><span class="op" id="6234657">.</span><span class="ident" id="6234658">ch</span>&nbsp;<span class="op" id="6234661">=</span>&nbsp;<span class="op" id="6234663">-</span><span class="num" id="6234664">1</span>&nbsp;<span class="comment" id="6234666">//&nbsp;no&nbsp;char&nbsp;read&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6234688">//&nbsp;initialize&nbsp;public&nbsp;fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234717">s</span><span class="op" id="6234718">.</span><span class="ident" id="6234719">Error</span>&nbsp;<span class="op" id="6234725">=</span>&nbsp;<span class="builtintype" id="6234727">nil</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234732">s</span><span class="op" id="6234733">.</span><span class="ident" id="6234734">ErrorCount</span>&nbsp;<span class="op" id="6234745">=</span>&nbsp;<span class="num" id="6234747">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234750">s</span><span class="op" id="6234751">.</span><span class="ident" id="6234752">Mode</span>&nbsp;<span class="op" id="6234757">=</span>&nbsp;<span class="ident" id="6234759">GoTokens</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234769">s</span><span class="op" id="6234770">.</span><span class="ident" id="6234771">Whitespace</span>&nbsp;<span class="op" id="6234782">=</span>&nbsp;<span class="ident" id="6234784">GoWhitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6234798">s</span><span class="op" id="6234799">.</span><span class="ident" id="6234800">Line</span>&nbsp;<span class="op" id="6234805">=</span>&nbsp;<span class="num" id="6234807">0</span>&nbsp;<span class="comment" id="6234809">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6234840">return</span>&nbsp;<span class="ident" id="6234847">s</span><br>
<span class="lineno"></span><span class="op" id="6234849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6234852">//&nbsp;next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.&nbsp;It&nbsp;is&nbsp;designed&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="6234926">//&nbsp;that&nbsp;only&nbsp;a&nbsp;minimal&nbsp;amount&nbsp;of&nbsp;work&nbsp;needs&nbsp;to&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;common&nbsp;ASCII</span><br>
<span class="lineno">225</span><span class="comment" id="6235001">//&nbsp;case&nbsp;(one&nbsp;test&nbsp;to&nbsp;check&nbsp;for&nbsp;both&nbsp;ASCII&nbsp;and&nbsp;end-of-buffer,&nbsp;and&nbsp;one&nbsp;test</span><br>
<span class="lineno"></span><span class="comment" id="6235075">//&nbsp;to&nbsp;check&nbsp;for&nbsp;newlines).</span><br>
<span class="lineno"></span><span class="keyword" id="6235102">func</span>&nbsp;<span class="op" id="6235107">(</span><span class="ident" id="6235108">s</span>&nbsp;<span class="op" id="6235110">*</span><span class="ident" id="6235111">Scanner</span><span class="op" id="6235118">)</span>&nbsp;<span class="ident" id="6235120">next</span><span class="op" id="6235124">(</span><span class="op" id="6235125">)</span>&nbsp;<span class="builtintype" id="6235127">rune</span>&nbsp;<span class="op" id="6235132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235135">ch</span><span class="op" id="6235137">,</span>&nbsp;<span class="ident" id="6235139">width</span>&nbsp;<span class="op" id="6235145">:=</span>&nbsp;<span class="builtintype" id="6235148">rune</span><span class="op" id="6235152">(</span><span class="ident" id="6235153">s</span><span class="op" id="6235154">.</span><span class="ident" id="6235155">srcBuf</span><span class="op" id="6235161">[</span><span class="ident" id="6235162">s</span><span class="op" id="6235163">.</span><span class="ident" id="6235164">srcPos</span><span class="op" id="6235170">]</span><span class="op" id="6235171">)</span><span class="op" id="6235172">,</span>&nbsp;<span class="num" id="6235174">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6235178">if</span>&nbsp;<span class="ident" id="6235181">ch</span>&nbsp;<span class="op" id="6235184">&gt;=</span>&nbsp;<span class="ident" id="6235187">utf8</span><span class="op" id="6235191">.</span><span class="ident" id="6235192">RuneSelf</span>&nbsp;<span class="op" id="6235201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235205">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII&nbsp;or&nbsp;not&nbsp;enough&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6235255">for</span>&nbsp;<span class="ident" id="6235259">s</span><span class="op" id="6235260">.</span><span class="ident" id="6235261">srcPos</span><span class="op" id="6235267">+</span><span class="ident" id="6235268">utf8</span><span class="op" id="6235272">.</span><span class="ident" id="6235273">UTFMax</span>&nbsp;<span class="op" id="6235280">&gt;</span>&nbsp;<span class="ident" id="6235282">s</span><span class="op" id="6235283">.</span><span class="ident" id="6235284">srcEnd</span>&nbsp;<span class="op" id="6235291">&amp;&amp;</span>&nbsp;<span class="op" id="6235294">!</span><span class="ident" id="6235295">utf8</span><span class="op" id="6235299">.</span><span class="ident" id="6235300">FullRune</span><span class="op" id="6235308">(</span><span class="ident" id="6235309">s</span><span class="op" id="6235310">.</span><span class="ident" id="6235311">srcBuf</span><span class="op" id="6235317">[</span><span class="ident" id="6235318">s</span><span class="op" id="6235319">.</span><span class="ident" id="6235320">srcPos</span><span class="op" id="6235326">:</span><span class="ident" id="6235327">s</span><span class="op" id="6235328">.</span><span class="ident" id="6235329">srcEnd</span><span class="op" id="6235335">]</span><span class="op" id="6235336">)</span>&nbsp;<span class="op" id="6235338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235343">//&nbsp;not&nbsp;enough&nbsp;bytes:&nbsp;read&nbsp;some&nbsp;more,&nbsp;but&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235393">//&nbsp;save&nbsp;away&nbsp;token&nbsp;text&nbsp;if&nbsp;any</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6235427">if</span>&nbsp;<span class="ident" id="6235430">s</span><span class="op" id="6235431">.</span><span class="ident" id="6235432">tokPos</span>&nbsp;<span class="op" id="6235439">&gt;=</span>&nbsp;<span class="num" id="6235442">0</span>&nbsp;<span class="op" id="6235444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235450">s</span><span class="op" id="6235451">.</span><span class="ident" id="6235452">tokBuf</span><span class="op" id="6235458">.</span><span class="ident" id="6235459">Write</span><span class="op" id="6235464">(</span><span class="ident" id="6235465">s</span><span class="op" id="6235466">.</span><span class="ident" id="6235467">srcBuf</span><span class="op" id="6235473">[</span><span class="ident" id="6235474">s</span><span class="op" id="6235475">.</span><span class="ident" id="6235476">tokPos</span><span class="op" id="6235482">:</span><span class="ident" id="6235483">s</span><span class="op" id="6235484">.</span><span class="ident" id="6235485">srcPos</span><span class="op" id="6235491">]</span><span class="op" id="6235492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235498">s</span><span class="op" id="6235499">.</span><span class="ident" id="6235500">tokPos</span>&nbsp;<span class="op" id="6235507">=</span>&nbsp;<span class="num" id="6235509">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235515">//&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;by&nbsp;Scan()</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6235547">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235552">//&nbsp;move&nbsp;unread&nbsp;bytes&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6235599">copy</span><span class="op" id="6235603">(</span><span class="ident" id="6235604">s</span><span class="op" id="6235605">.</span><span class="ident" id="6235606">srcBuf</span><span class="op" id="6235612">[</span><span class="num" id="6235613">0</span><span class="op" id="6235614">:</span><span class="op" id="6235615">]</span><span class="op" id="6235616">,</span>&nbsp;<span class="ident" id="6235618">s</span><span class="op" id="6235619">.</span><span class="ident" id="6235620">srcBuf</span><span class="op" id="6235626">[</span><span class="ident" id="6235627">s</span><span class="op" id="6235628">.</span><span class="ident" id="6235629">srcPos</span><span class="op" id="6235635">:</span><span class="ident" id="6235636">s</span><span class="op" id="6235637">.</span><span class="ident" id="6235638">srcEnd</span><span class="op" id="6235644">]</span><span class="op" id="6235645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235650">s</span><span class="op" id="6235651">.</span><span class="ident" id="6235652">srcBufOffset</span>&nbsp;<span class="op" id="6235665">+=</span>&nbsp;<span class="ident" id="6235668">s</span><span class="op" id="6235669">.</span><span class="ident" id="6235670">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235680">//&nbsp;read&nbsp;more&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235702">//&nbsp;(an&nbsp;io.Reader&nbsp;must&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;it&nbsp;reaches</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235757">//&nbsp;the&nbsp;end&nbsp;of&nbsp;what&nbsp;it&nbsp;is&nbsp;reading&nbsp;-&nbsp;simply&nbsp;returning</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235812">//&nbsp;n&nbsp;==&nbsp;0&nbsp;will&nbsp;make&nbsp;this&nbsp;loop&nbsp;retry&nbsp;forever;&nbsp;but&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6235868">//&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;reader&nbsp;implementation&nbsp;in&nbsp;that&nbsp;case)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235926">i</span>&nbsp;<span class="op" id="6235928">:=</span>&nbsp;<span class="ident" id="6235931">s</span><span class="op" id="6235932">.</span><span class="ident" id="6235933">srcEnd</span>&nbsp;<span class="op" id="6235940">-</span>&nbsp;<span class="ident" id="6235942">s</span><span class="op" id="6235943">.</span><span class="ident" id="6235944">srcPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235954">n</span><span class="op" id="6235955">,</span>&nbsp;<span class="ident" id="6235957">err</span>&nbsp;<span class="op" id="6235961">:=</span>&nbsp;<span class="ident" id="6235964">s</span><span class="op" id="6235965">.</span><span class="ident" id="6235966">src</span><span class="op" id="6235969">.</span><span class="ident" id="6235970">Read</span><span class="op" id="6235974">(</span><span class="ident" id="6235975">s</span><span class="op" id="6235976">.</span><span class="ident" id="6235977">srcBuf</span><span class="op" id="6235983">[</span><span class="ident" id="6235984">i</span><span class="op" id="6235985">:</span><span class="ident" id="6235986">bufLen</span><span class="op" id="6235992">]</span><span class="op" id="6235993">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6235998">s</span><span class="op" id="6235999">.</span><span class="ident" id="6236000">srcPos</span>&nbsp;<span class="op" id="6236007">=</span>&nbsp;<span class="num" id="6236009">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236014">s</span><span class="op" id="6236015">.</span><span class="ident" id="6236016">srcEnd</span>&nbsp;<span class="op" id="6236023">=</span>&nbsp;<span class="ident" id="6236025">i</span>&nbsp;<span class="op" id="6236027">+</span>&nbsp;<span class="ident" id="6236029">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236034">s</span><span class="op" id="6236035">.</span><span class="ident" id="6236036">srcBuf</span><span class="op" id="6236042">[</span><span class="ident" id="6236043">s</span><span class="op" id="6236044">.</span><span class="ident" id="6236045">srcEnd</span><span class="op" id="6236051">]</span>&nbsp;<span class="op" id="6236053">=</span>&nbsp;<span class="ident" id="6236055">utf8</span><span class="op" id="6236059">.</span><span class="ident" id="6236060">RuneSelf</span>&nbsp;<span class="comment" id="6236069">//&nbsp;sentinel</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236084">if</span>&nbsp;<span class="ident" id="6236087">err</span>&nbsp;<span class="op" id="6236091">!=</span>&nbsp;<span class="builtintype" id="6236094">nil</span>&nbsp;<span class="op" id="6236098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236104">if</span>&nbsp;<span class="ident" id="6236107">err</span>&nbsp;<span class="op" id="6236111">!=</span>&nbsp;<span class="ident" id="6236114">io</span><span class="op" id="6236116">.</span><span class="ident" id="6236117">EOF</span>&nbsp;<span class="op" id="6236121">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236128">s</span><span class="op" id="6236129">.</span><span class="builtintype" id="6236130">error</span><span class="op" id="6236135">(</span><span class="ident" id="6236136">err</span><span class="op" id="6236139">.</span><span class="ident" id="6236140">Error</span><span class="op" id="6236145">(</span><span class="op" id="6236146">)</span><span class="op" id="6236147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236159">if</span>&nbsp;<span class="ident" id="6236162">s</span><span class="op" id="6236163">.</span><span class="ident" id="6236164">srcEnd</span>&nbsp;<span class="op" id="6236171">==</span>&nbsp;<span class="num" id="6236174">0</span>&nbsp;<span class="op" id="6236176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236183">if</span>&nbsp;<span class="ident" id="6236186">s</span><span class="op" id="6236187">.</span><span class="ident" id="6236188">lastCharLen</span>&nbsp;<span class="op" id="6236200">&gt;</span>&nbsp;<span class="num" id="6236202">0</span>&nbsp;<span class="op" id="6236204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236212">//&nbsp;previous&nbsp;character&nbsp;was&nbsp;not&nbsp;EOF</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236252">s</span><span class="op" id="6236253">.</span><span class="ident" id="6236254">column</span><span class="op" id="6236260">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236275">s</span><span class="op" id="6236276">.</span><span class="ident" id="6236277">lastCharLen</span>&nbsp;<span class="op" id="6236289">=</span>&nbsp;<span class="num" id="6236291">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236298">return</span>&nbsp;<span class="ident" id="6236305">EOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236313">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236319">//&nbsp;If&nbsp;err&nbsp;==&nbsp;EOF,&nbsp;we&nbsp;won&#39;t&nbsp;be&nbsp;getting&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236366">//&nbsp;bytes;&nbsp;break&nbsp;to&nbsp;avoid&nbsp;infinite&nbsp;loop.&nbsp;If</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236413">//&nbsp;err&nbsp;is&nbsp;something&nbsp;else,&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;if</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236460">//&nbsp;we&nbsp;can&nbsp;get&nbsp;more&nbsp;bytes;&nbsp;thus&nbsp;also&nbsp;break.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236507">break</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236524">//&nbsp;at&nbsp;least&nbsp;one&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236547">ch</span>&nbsp;<span class="op" id="6236550">=</span>&nbsp;<span class="builtintype" id="6236552">rune</span><span class="op" id="6236556">(</span><span class="ident" id="6236557">s</span><span class="op" id="6236558">.</span><span class="ident" id="6236559">srcBuf</span><span class="op" id="6236565">[</span><span class="ident" id="6236566">s</span><span class="op" id="6236567">.</span><span class="ident" id="6236568">srcPos</span><span class="op" id="6236574">]</span><span class="op" id="6236575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236579">if</span>&nbsp;<span class="ident" id="6236582">ch</span>&nbsp;<span class="op" id="6236585">&gt;=</span>&nbsp;<span class="ident" id="6236588">utf8</span><span class="op" id="6236592">.</span><span class="ident" id="6236593">RuneSelf</span>&nbsp;<span class="op" id="6236602">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236607">//&nbsp;uncommon&nbsp;case:&nbsp;not&nbsp;ASCII</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236638">ch</span><span class="op" id="6236640">,</span>&nbsp;<span class="ident" id="6236642">width</span>&nbsp;<span class="op" id="6236648">=</span>&nbsp;<span class="ident" id="6236650">utf8</span><span class="op" id="6236654">.</span><span class="ident" id="6236655">DecodeRune</span><span class="op" id="6236665">(</span><span class="ident" id="6236666">s</span><span class="op" id="6236667">.</span><span class="ident" id="6236668">srcBuf</span><span class="op" id="6236674">[</span><span class="ident" id="6236675">s</span><span class="op" id="6236676">.</span><span class="ident" id="6236677">srcPos</span><span class="op" id="6236683">:</span><span class="ident" id="6236684">s</span><span class="op" id="6236685">.</span><span class="ident" id="6236686">srcEnd</span><span class="op" id="6236692">]</span><span class="op" id="6236693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236698">if</span>&nbsp;<span class="ident" id="6236701">ch</span>&nbsp;<span class="op" id="6236704">==</span>&nbsp;<span class="ident" id="6236707">utf8</span><span class="op" id="6236711">.</span><span class="ident" id="6236712">RuneError</span>&nbsp;<span class="op" id="6236722">&amp;&amp;</span>&nbsp;<span class="ident" id="6236725">width</span>&nbsp;<span class="op" id="6236731">==</span>&nbsp;<span class="num" id="6236734">1</span>&nbsp;<span class="op" id="6236736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236742">//&nbsp;advance&nbsp;for&nbsp;correct&nbsp;error&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236784">s</span><span class="op" id="6236785">.</span><span class="ident" id="6236786">srcPos</span>&nbsp;<span class="op" id="6236793">+=</span>&nbsp;<span class="ident" id="6236796">width</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236806">s</span><span class="op" id="6236807">.</span><span class="ident" id="6236808">lastCharLen</span>&nbsp;<span class="op" id="6236820">=</span>&nbsp;<span class="ident" id="6236822">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236832">s</span><span class="op" id="6236833">.</span><span class="ident" id="6236834">column</span><span class="op" id="6236840">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236847">s</span><span class="op" id="6236848">.</span><span class="builtintype" id="6236849">error</span><span class="op" id="6236854">(</span><span class="string" id="6236855">&#34;illegal&nbsp;UTF-8&nbsp;encoding&#34;</span><span class="op" id="6236879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236885">return</span>&nbsp;<span class="ident" id="6236892">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236898">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6236905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236909">//&nbsp;advance</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236921">s</span><span class="op" id="6236922">.</span><span class="ident" id="6236923">srcPos</span>&nbsp;<span class="op" id="6236930">+=</span>&nbsp;<span class="ident" id="6236933">width</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236940">s</span><span class="op" id="6236941">.</span><span class="ident" id="6236942">lastCharLen</span>&nbsp;<span class="op" id="6236954">=</span>&nbsp;<span class="ident" id="6236956">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6236963">s</span><span class="op" id="6236964">.</span><span class="ident" id="6236965">column</span><span class="op" id="6236971">++</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6236976">//&nbsp;special&nbsp;situations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6236999">switch</span>&nbsp;<span class="ident" id="6237006">ch</span>&nbsp;<span class="op" id="6237009">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237012">case</span>&nbsp;<span class="num" id="6237017">0</span><span class="op" id="6237018">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6237022">//&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;other&nbsp;tools</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237062">s</span><span class="op" id="6237063">.</span><span class="builtintype" id="6237064">error</span><span class="op" id="6237069">(</span><span class="string" id="6237070">&#34;illegal&nbsp;character&nbsp;NUL&#34;</span><span class="op" id="6237093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237096">case</span>&nbsp;<span class="string" id="6237101">&#39;\n&#39;</span><span class="op" id="6237105">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237109">s</span><span class="op" id="6237110">.</span><span class="ident" id="6237111">line</span><span class="op" id="6237115">++</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237120">s</span><span class="op" id="6237121">.</span><span class="ident" id="6237122">lastLineLen</span>&nbsp;<span class="op" id="6237134">=</span>&nbsp;<span class="ident" id="6237136">s</span><span class="op" id="6237137">.</span><span class="ident" id="6237138">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237147">s</span><span class="op" id="6237148">.</span><span class="ident" id="6237149">column</span>&nbsp;<span class="op" id="6237156">=</span>&nbsp;<span class="num" id="6237158">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6237161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237165">return</span>&nbsp;<span class="ident" id="6237172">ch</span><br>
<span class="lineno">305</span><span class="op" id="6237175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6237178">//&nbsp;Next&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6237232">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports</span><br>
<span class="lineno"></span><span class="comment" id="6237287">//&nbsp;a&nbsp;read&nbsp;error&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise</span><br>
<span class="lineno">310</span><span class="comment" id="6237345">//&nbsp;it&nbsp;prints&nbsp;an&nbsp;error&nbsp;message&nbsp;to&nbsp;os.Stderr.&nbsp;Next&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="6237403">//&nbsp;update&nbsp;the&nbsp;Scanner&#39;s&nbsp;Position&nbsp;field;&nbsp;use&nbsp;Pos()&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="6237456">//&nbsp;get&nbsp;the&nbsp;current&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="6237485">func</span>&nbsp;<span class="op" id="6237490">(</span><span class="ident" id="6237491">s</span>&nbsp;<span class="op" id="6237493">*</span><span class="ident" id="6237494">Scanner</span><span class="op" id="6237501">)</span>&nbsp;<span class="ident" id="6237503">Next</span><span class="op" id="6237507">(</span><span class="op" id="6237508">)</span>&nbsp;<span class="builtintype" id="6237510">rune</span>&nbsp;<span class="op" id="6237515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237518">s</span><span class="op" id="6237519">.</span><span class="ident" id="6237520">tokPos</span>&nbsp;<span class="op" id="6237527">=</span>&nbsp;<span class="op" id="6237529">-</span><span class="num" id="6237530">1</span>&nbsp;<span class="comment" id="6237532">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237561">s</span><span class="op" id="6237562">.</span><span class="ident" id="6237563">Line</span>&nbsp;<span class="op" id="6237568">=</span>&nbsp;<span class="num" id="6237570">0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6237575">//&nbsp;invalidate&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237605">ch</span>&nbsp;<span class="op" id="6237608">:=</span>&nbsp;<span class="ident" id="6237611">s</span><span class="op" id="6237612">.</span><span class="ident" id="6237613">Peek</span><span class="op" id="6237617">(</span><span class="op" id="6237618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237621">s</span><span class="op" id="6237622">.</span><span class="ident" id="6237623">ch</span>&nbsp;<span class="op" id="6237626">=</span>&nbsp;<span class="ident" id="6237628">s</span><span class="op" id="6237629">.</span><span class="ident" id="6237630">next</span><span class="op" id="6237634">(</span><span class="op" id="6237635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237638">return</span>&nbsp;<span class="ident" id="6237645">ch</span><br>
<span class="lineno"></span><span class="op" id="6237648">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="6237651">//&nbsp;Peek&nbsp;returns&nbsp;the&nbsp;next&nbsp;Unicode&nbsp;character&nbsp;in&nbsp;the&nbsp;source&nbsp;without&nbsp;advancing</span><br>
<span class="lineno"></span><span class="comment" id="6237726">//&nbsp;the&nbsp;scanner.&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;if&nbsp;the&nbsp;scanner&#39;s&nbsp;position&nbsp;is&nbsp;at&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span><span class="comment" id="6237798">//&nbsp;character&nbsp;of&nbsp;the&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="6237826">func</span>&nbsp;<span class="op" id="6237831">(</span><span class="ident" id="6237832">s</span>&nbsp;<span class="op" id="6237834">*</span><span class="ident" id="6237835">Scanner</span><span class="op" id="6237842">)</span>&nbsp;<span class="ident" id="6237844">Peek</span><span class="op" id="6237848">(</span><span class="op" id="6237849">)</span>&nbsp;<span class="builtintype" id="6237851">rune</span>&nbsp;<span class="op" id="6237856">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237859">if</span>&nbsp;<span class="ident" id="6237862">s</span><span class="op" id="6237863">.</span><span class="ident" id="6237864">ch</span>&nbsp;<span class="op" id="6237867">&lt;</span>&nbsp;<span class="num" id="6237869">0</span>&nbsp;<span class="op" id="6237871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6237875">//&nbsp;this&nbsp;code&nbsp;is&nbsp;only&nbsp;run&nbsp;for&nbsp;the&nbsp;very&nbsp;first&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237931">s</span><span class="op" id="6237932">.</span><span class="ident" id="6237933">ch</span>&nbsp;<span class="op" id="6237936">=</span>&nbsp;<span class="ident" id="6237938">s</span><span class="op" id="6237939">.</span><span class="ident" id="6237940">next</span><span class="op" id="6237944">(</span><span class="op" id="6237945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6237949">if</span>&nbsp;<span class="ident" id="6237952">s</span><span class="op" id="6237953">.</span><span class="ident" id="6237954">ch</span>&nbsp;<span class="op" id="6237957">==</span>&nbsp;<span class="string" id="6237960">&#39;\uFEFF&#39;</span>&nbsp;<span class="op" id="6237969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6237974">s</span><span class="op" id="6237975">.</span><span class="ident" id="6237976">ch</span>&nbsp;<span class="op" id="6237979">=</span>&nbsp;<span class="ident" id="6237981">s</span><span class="op" id="6237982">.</span><span class="ident" id="6237983">next</span><span class="op" id="6237987">(</span><span class="op" id="6237988">)</span>&nbsp;<span class="comment" id="6237990">//&nbsp;ignore&nbsp;BOM</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238012">return</span>&nbsp;<span class="ident" id="6238019">s</span><span class="op" id="6238020">.</span><span class="ident" id="6238021">ch</span><br>
<span class="lineno"></span><span class="op" id="6238024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="6238027">func</span>&nbsp;<span class="op" id="6238032">(</span><span class="ident" id="6238033">s</span>&nbsp;<span class="op" id="6238035">*</span><span class="ident" id="6238036">Scanner</span><span class="op" id="6238043">)</span>&nbsp;<span class="builtintype" id="6238045">error</span><span class="op" id="6238050">(</span><span class="ident" id="6238051">msg</span>&nbsp;<span class="builtintype" id="6238055">string</span><span class="op" id="6238061">)</span>&nbsp;<span class="op" id="6238063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238066">s</span><span class="op" id="6238067">.</span><span class="ident" id="6238068">ErrorCount</span><span class="op" id="6238078">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238082">if</span>&nbsp;<span class="ident" id="6238085">s</span><span class="op" id="6238086">.</span><span class="ident" id="6238087">Error</span>&nbsp;<span class="op" id="6238093">!=</span>&nbsp;<span class="builtintype" id="6238096">nil</span>&nbsp;<span class="op" id="6238100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238104">s</span><span class="op" id="6238105">.</span><span class="ident" id="6238106">Error</span><span class="op" id="6238111">(</span><span class="ident" id="6238112">s</span><span class="op" id="6238113">,</span>&nbsp;<span class="ident" id="6238115">msg</span><span class="op" id="6238118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238122">return</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238130">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238133">pos</span>&nbsp;<span class="op" id="6238137">:=</span>&nbsp;<span class="ident" id="6238140">s</span><span class="op" id="6238141">.</span><span class="ident" id="6238142">Position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238152">if</span>&nbsp;<span class="op" id="6238155">!</span><span class="ident" id="6238156">pos</span><span class="op" id="6238159">.</span><span class="ident" id="6238160">IsValid</span><span class="op" id="6238167">(</span><span class="op" id="6238168">)</span>&nbsp;<span class="op" id="6238170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238174">pos</span>&nbsp;<span class="op" id="6238178">=</span>&nbsp;<span class="ident" id="6238180">s</span><span class="op" id="6238181">.</span><span class="ident" id="6238182">Pos</span><span class="op" id="6238185">(</span><span class="op" id="6238186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238189">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238192">fmt</span><span class="op" id="6238195">.</span><span class="ident" id="6238196">Fprintf</span><span class="op" id="6238203">(</span><span class="ident" id="6238204">os</span><span class="op" id="6238206">.</span><span class="ident" id="6238207">Stderr</span><span class="op" id="6238213">,</span>&nbsp;<span class="string" id="6238215">&#34;%s:&nbsp;%s\n&#34;</span><span class="op" id="6238225">,</span>&nbsp;<span class="ident" id="6238227">pos</span><span class="op" id="6238230">,</span>&nbsp;<span class="ident" id="6238232">msg</span><span class="op" id="6238235">)</span><br>
<span class="lineno"></span><span class="op" id="6238237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238240">func</span>&nbsp;<span class="op" id="6238245">(</span><span class="ident" id="6238246">s</span>&nbsp;<span class="op" id="6238248">*</span><span class="ident" id="6238249">Scanner</span><span class="op" id="6238256">)</span>&nbsp;<span class="ident" id="6238258">isIdentRune</span><span class="op" id="6238269">(</span><span class="ident" id="6238270">ch</span>&nbsp;<span class="builtintype" id="6238273">rune</span><span class="op" id="6238277">,</span>&nbsp;<span class="ident" id="6238279">i</span>&nbsp;<span class="builtintype" id="6238281">int</span><span class="op" id="6238284">)</span>&nbsp;<span class="builtintype" id="6238286">bool</span>&nbsp;<span class="op" id="6238291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238294">if</span>&nbsp;<span class="ident" id="6238297">s</span><span class="op" id="6238298">.</span><span class="ident" id="6238299">IsIdentRune</span>&nbsp;<span class="op" id="6238311">!=</span>&nbsp;<span class="builtintype" id="6238314">nil</span>&nbsp;<span class="op" id="6238318">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238322">return</span>&nbsp;<span class="ident" id="6238329">s</span><span class="op" id="6238330">.</span><span class="ident" id="6238331">IsIdentRune</span><span class="op" id="6238342">(</span><span class="ident" id="6238343">ch</span><span class="op" id="6238345">,</span>&nbsp;<span class="ident" id="6238347">i</span><span class="op" id="6238348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238354">return</span>&nbsp;<span class="ident" id="6238361">ch</span>&nbsp;<span class="op" id="6238364">==</span>&nbsp;<span class="string" id="6238367">&#39;_&#39;</span>&nbsp;<span class="op" id="6238371">||</span>&nbsp;<span class="ident" id="6238374">unicode</span><span class="op" id="6238381">.</span><span class="ident" id="6238382">IsLetter</span><span class="op" id="6238390">(</span><span class="ident" id="6238391">ch</span><span class="op" id="6238393">)</span>&nbsp;<span class="op" id="6238395">||</span>&nbsp;<span class="ident" id="6238398">unicode</span><span class="op" id="6238405">.</span><span class="ident" id="6238406">IsDigit</span><span class="op" id="6238413">(</span><span class="ident" id="6238414">ch</span><span class="op" id="6238416">)</span>&nbsp;<span class="op" id="6238418">&amp;&amp;</span>&nbsp;<span class="ident" id="6238421">i</span>&nbsp;<span class="op" id="6238423">&gt;</span>&nbsp;<span class="num" id="6238425">0</span><br>
<span class="lineno"></span><span class="op" id="6238427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6238430">func</span>&nbsp;<span class="op" id="6238435">(</span><span class="ident" id="6238436">s</span>&nbsp;<span class="op" id="6238438">*</span><span class="ident" id="6238439">Scanner</span><span class="op" id="6238446">)</span>&nbsp;<span class="ident" id="6238448">scanIdentifier</span><span class="op" id="6238462">(</span><span class="op" id="6238463">)</span>&nbsp;<span class="builtintype" id="6238465">rune</span>&nbsp;<span class="op" id="6238470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6238473">//&nbsp;we&nbsp;know&nbsp;the&nbsp;zero&#39;th&nbsp;rune&nbsp;is&nbsp;OK;&nbsp;start&nbsp;scanning&nbsp;at&nbsp;the&nbsp;next&nbsp;one</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238540">ch</span>&nbsp;<span class="op" id="6238543">:=</span>&nbsp;<span class="ident" id="6238546">s</span><span class="op" id="6238547">.</span><span class="ident" id="6238548">next</span><span class="op" id="6238552">(</span><span class="op" id="6238553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238556">for</span>&nbsp;<span class="ident" id="6238560">i</span>&nbsp;<span class="op" id="6238562">:=</span>&nbsp;<span class="num" id="6238565">1</span><span class="op" id="6238566">;</span>&nbsp;<span class="ident" id="6238568">s</span><span class="op" id="6238569">.</span><span class="ident" id="6238570">isIdentRune</span><span class="op" id="6238581">(</span><span class="ident" id="6238582">ch</span><span class="op" id="6238584">,</span>&nbsp;<span class="ident" id="6238586">i</span><span class="op" id="6238587">)</span><span class="op" id="6238588">;</span>&nbsp;<span class="ident" id="6238590">i</span><span class="op" id="6238591">++</span>&nbsp;<span class="op" id="6238594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6238598">ch</span>&nbsp;<span class="op" id="6238601">=</span>&nbsp;<span class="ident" id="6238603">s</span><span class="op" id="6238604">.</span><span class="ident" id="6238605">next</span><span class="op" id="6238609">(</span><span class="op" id="6238610">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238616">return</span>&nbsp;<span class="ident" id="6238623">ch</span><br>
<span class="lineno"></span><span class="op" id="6238626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238629">func</span>&nbsp;<span class="ident" id="6238634">digitVal</span><span class="op" id="6238642">(</span><span class="ident" id="6238643">ch</span>&nbsp;<span class="builtintype" id="6238646">rune</span><span class="op" id="6238650">)</span>&nbsp;<span class="builtintype" id="6238652">int</span>&nbsp;<span class="op" id="6238656">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238659">switch</span>&nbsp;<span class="op" id="6238666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238669">case</span>&nbsp;<span class="string" id="6238674">&#39;0&#39;</span>&nbsp;<span class="op" id="6238678">&lt;=</span>&nbsp;<span class="ident" id="6238681">ch</span>&nbsp;<span class="op" id="6238684">&amp;&amp;</span>&nbsp;<span class="ident" id="6238687">ch</span>&nbsp;<span class="op" id="6238690">&lt;=</span>&nbsp;<span class="string" id="6238693">&#39;9&#39;</span><span class="op" id="6238696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238700">return</span>&nbsp;<span class="builtintype" id="6238707">int</span><span class="op" id="6238710">(</span><span class="ident" id="6238711">ch</span>&nbsp;<span class="op" id="6238714">-</span>&nbsp;<span class="string" id="6238716">&#39;0&#39;</span><span class="op" id="6238719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238722">case</span>&nbsp;<span class="string" id="6238727">&#39;a&#39;</span>&nbsp;<span class="op" id="6238731">&lt;=</span>&nbsp;<span class="ident" id="6238734">ch</span>&nbsp;<span class="op" id="6238737">&amp;&amp;</span>&nbsp;<span class="ident" id="6238740">ch</span>&nbsp;<span class="op" id="6238743">&lt;=</span>&nbsp;<span class="string" id="6238746">&#39;f&#39;</span><span class="op" id="6238749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238753">return</span>&nbsp;<span class="builtintype" id="6238760">int</span><span class="op" id="6238763">(</span><span class="ident" id="6238764">ch</span>&nbsp;<span class="op" id="6238767">-</span>&nbsp;<span class="string" id="6238769">&#39;a&#39;</span>&nbsp;<span class="op" id="6238773">+</span>&nbsp;<span class="num" id="6238775">10</span><span class="op" id="6238777">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238780">case</span>&nbsp;<span class="string" id="6238785">&#39;A&#39;</span>&nbsp;<span class="op" id="6238789">&lt;=</span>&nbsp;<span class="ident" id="6238792">ch</span>&nbsp;<span class="op" id="6238795">&amp;&amp;</span>&nbsp;<span class="ident" id="6238798">ch</span>&nbsp;<span class="op" id="6238801">&lt;=</span>&nbsp;<span class="string" id="6238804">&#39;F&#39;</span><span class="op" id="6238807">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238811">return</span>&nbsp;<span class="builtintype" id="6238818">int</span><span class="op" id="6238821">(</span><span class="ident" id="6238822">ch</span>&nbsp;<span class="op" id="6238825">-</span>&nbsp;<span class="string" id="6238827">&#39;A&#39;</span>&nbsp;<span class="op" id="6238831">+</span>&nbsp;<span class="num" id="6238833">10</span><span class="op" id="6238835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6238838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6238841">return</span>&nbsp;<span class="num" id="6238848">16</span>&nbsp;<span class="comment" id="6238851">//&nbsp;larger&nbsp;than&nbsp;any&nbsp;legal&nbsp;digit&nbsp;val</span><br>
<span class="lineno"></span><span class="op" id="6238886">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span><span class="keyword" id="6238889">func</span>&nbsp;<span class="ident" id="6238894">isDecimal</span><span class="op" id="6238903">(</span><span class="ident" id="6238904">ch</span>&nbsp;<span class="builtintype" id="6238907">rune</span><span class="op" id="6238911">)</span>&nbsp;<span class="builtintype" id="6238913">bool</span>&nbsp;<span class="op" id="6238918">{</span>&nbsp;<span class="keyword" id="6238920">return</span>&nbsp;<span class="string" id="6238927">&#39;0&#39;</span>&nbsp;<span class="op" id="6238931">&lt;=</span>&nbsp;<span class="ident" id="6238934">ch</span>&nbsp;<span class="op" id="6238937">&amp;&amp;</span>&nbsp;<span class="ident" id="6238940">ch</span>&nbsp;<span class="op" id="6238943">&lt;=</span>&nbsp;<span class="string" id="6238946">&#39;9&#39;</span>&nbsp;<span class="op" id="6238950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6238953">func</span>&nbsp;<span class="op" id="6238958">(</span><span class="ident" id="6238959">s</span>&nbsp;<span class="op" id="6238961">*</span><span class="ident" id="6238962">Scanner</span><span class="op" id="6238969">)</span>&nbsp;<span class="ident" id="6238971">scanMantissa</span><span class="op" id="6238983">(</span><span class="ident" id="6238984">ch</span>&nbsp;<span class="builtintype" id="6238987">rune</span><span class="op" id="6238991">)</span>&nbsp;<span class="builtintype" id="6238993">rune</span>&nbsp;<span class="op" id="6238998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239001">for</span>&nbsp;<span class="ident" id="6239005">isDecimal</span><span class="op" id="6239014">(</span><span class="ident" id="6239015">ch</span><span class="op" id="6239017">)</span>&nbsp;<span class="op" id="6239019">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239023">ch</span>&nbsp;<span class="op" id="6239026">=</span>&nbsp;<span class="ident" id="6239028">s</span><span class="op" id="6239029">.</span><span class="ident" id="6239030">next</span><span class="op" id="6239034">(</span><span class="op" id="6239035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239041">return</span>&nbsp;<span class="ident" id="6239048">ch</span><br>
<span class="lineno"></span><span class="op" id="6239051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6239054">func</span>&nbsp;<span class="op" id="6239059">(</span><span class="ident" id="6239060">s</span>&nbsp;<span class="op" id="6239062">*</span><span class="ident" id="6239063">Scanner</span><span class="op" id="6239070">)</span>&nbsp;<span class="ident" id="6239072">scanFraction</span><span class="op" id="6239084">(</span><span class="ident" id="6239085">ch</span>&nbsp;<span class="builtintype" id="6239088">rune</span><span class="op" id="6239092">)</span>&nbsp;<span class="builtintype" id="6239094">rune</span>&nbsp;<span class="op" id="6239099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239102">if</span>&nbsp;<span class="ident" id="6239105">ch</span>&nbsp;<span class="op" id="6239108">==</span>&nbsp;<span class="string" id="6239111">&#39;.&#39;</span>&nbsp;<span class="op" id="6239115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239119">ch</span>&nbsp;<span class="op" id="6239122">=</span>&nbsp;<span class="ident" id="6239124">s</span><span class="op" id="6239125">.</span><span class="ident" id="6239126">scanMantissa</span><span class="op" id="6239138">(</span><span class="ident" id="6239139">s</span><span class="op" id="6239140">.</span><span class="ident" id="6239141">next</span><span class="op" id="6239145">(</span><span class="op" id="6239146">)</span><span class="op" id="6239147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239153">return</span>&nbsp;<span class="ident" id="6239160">ch</span><br>
<span class="lineno">390</span><span class="op" id="6239163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239166">func</span>&nbsp;<span class="op" id="6239171">(</span><span class="ident" id="6239172">s</span>&nbsp;<span class="op" id="6239174">*</span><span class="ident" id="6239175">Scanner</span><span class="op" id="6239182">)</span>&nbsp;<span class="ident" id="6239184">scanExponent</span><span class="op" id="6239196">(</span><span class="ident" id="6239197">ch</span>&nbsp;<span class="builtintype" id="6239200">rune</span><span class="op" id="6239204">)</span>&nbsp;<span class="builtintype" id="6239206">rune</span>&nbsp;<span class="op" id="6239211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239214">if</span>&nbsp;<span class="ident" id="6239217">ch</span>&nbsp;<span class="op" id="6239220">==</span>&nbsp;<span class="string" id="6239223">&#39;e&#39;</span>&nbsp;<span class="op" id="6239227">||</span>&nbsp;<span class="ident" id="6239230">ch</span>&nbsp;<span class="op" id="6239233">==</span>&nbsp;<span class="string" id="6239236">&#39;E&#39;</span>&nbsp;<span class="op" id="6239240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239244">ch</span>&nbsp;<span class="op" id="6239247">=</span>&nbsp;<span class="ident" id="6239249">s</span><span class="op" id="6239250">.</span><span class="ident" id="6239251">next</span><span class="op" id="6239255">(</span><span class="op" id="6239256">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239260">if</span>&nbsp;<span class="ident" id="6239263">ch</span>&nbsp;<span class="op" id="6239266">==</span>&nbsp;<span class="string" id="6239269">&#39;-&#39;</span>&nbsp;<span class="op" id="6239273">||</span>&nbsp;<span class="ident" id="6239276">ch</span>&nbsp;<span class="op" id="6239279">==</span>&nbsp;<span class="string" id="6239282">&#39;+&#39;</span>&nbsp;<span class="op" id="6239286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239291">ch</span>&nbsp;<span class="op" id="6239294">=</span>&nbsp;<span class="ident" id="6239296">s</span><span class="op" id="6239297">.</span><span class="ident" id="6239298">next</span><span class="op" id="6239302">(</span><span class="op" id="6239303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239311">ch</span>&nbsp;<span class="op" id="6239314">=</span>&nbsp;<span class="ident" id="6239316">s</span><span class="op" id="6239317">.</span><span class="ident" id="6239318">scanMantissa</span><span class="op" id="6239330">(</span><span class="ident" id="6239331">ch</span><span class="op" id="6239333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239336">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239339">return</span>&nbsp;<span class="ident" id="6239346">ch</span><br>
<span class="lineno"></span><span class="op" id="6239349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6239352">func</span>&nbsp;<span class="op" id="6239357">(</span><span class="ident" id="6239358">s</span>&nbsp;<span class="op" id="6239360">*</span><span class="ident" id="6239361">Scanner</span><span class="op" id="6239368">)</span>&nbsp;<span class="ident" id="6239370">scanNumber</span><span class="op" id="6239380">(</span><span class="ident" id="6239381">ch</span>&nbsp;<span class="builtintype" id="6239384">rune</span><span class="op" id="6239388">)</span>&nbsp;<span class="op" id="6239390">(</span><span class="builtintype" id="6239391">rune</span><span class="op" id="6239395">,</span>&nbsp;<span class="builtintype" id="6239397">rune</span><span class="op" id="6239401">)</span>&nbsp;<span class="op" id="6239403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6239406">//&nbsp;isDecimal(ch)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239424">if</span>&nbsp;<span class="ident" id="6239427">ch</span>&nbsp;<span class="op" id="6239430">==</span>&nbsp;<span class="string" id="6239433">&#39;0&#39;</span>&nbsp;<span class="op" id="6239437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6239441">//&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239459">ch</span>&nbsp;<span class="op" id="6239462">=</span>&nbsp;<span class="ident" id="6239464">s</span><span class="op" id="6239465">.</span><span class="ident" id="6239466">next</span><span class="op" id="6239470">(</span><span class="op" id="6239471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239475">if</span>&nbsp;<span class="ident" id="6239478">ch</span>&nbsp;<span class="op" id="6239481">==</span>&nbsp;<span class="string" id="6239484">&#39;x&#39;</span>&nbsp;<span class="op" id="6239488">||</span>&nbsp;<span class="ident" id="6239491">ch</span>&nbsp;<span class="op" id="6239494">==</span>&nbsp;<span class="string" id="6239497">&#39;X&#39;</span>&nbsp;<span class="op" id="6239501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6239506">//&nbsp;hexadecimal&nbsp;int</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239528">ch</span>&nbsp;<span class="op" id="6239531">=</span>&nbsp;<span class="ident" id="6239533">s</span><span class="op" id="6239534">.</span><span class="ident" id="6239535">next</span><span class="op" id="6239539">(</span><span class="op" id="6239540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239545">hasMantissa</span>&nbsp;<span class="op" id="6239557">:=</span>&nbsp;<span class="builtintype" id="6239560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239569">for</span>&nbsp;<span class="ident" id="6239573">digitVal</span><span class="op" id="6239581">(</span><span class="ident" id="6239582">ch</span><span class="op" id="6239584">)</span>&nbsp;<span class="op" id="6239586">&lt;</span>&nbsp;<span class="num" id="6239588">16</span>&nbsp;<span class="op" id="6239591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239597">ch</span>&nbsp;<span class="op" id="6239600">=</span>&nbsp;<span class="ident" id="6239602">s</span><span class="op" id="6239603">.</span><span class="ident" id="6239604">next</span><span class="op" id="6239608">(</span><span class="op" id="6239609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239615">hasMantissa</span>&nbsp;<span class="op" id="6239627">=</span>&nbsp;<span class="builtintype" id="6239629">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239642">if</span>&nbsp;<span class="op" id="6239645">!</span><span class="ident" id="6239646">hasMantissa</span>&nbsp;<span class="op" id="6239658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239664">s</span><span class="op" id="6239665">.</span><span class="builtintype" id="6239666">error</span><span class="op" id="6239671">(</span><span class="string" id="6239672">&#34;illegal&nbsp;hexadecimal&nbsp;number&#34;</span><span class="op" id="6239700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239709">}</span>&nbsp;<span class="keyword" id="6239711">else</span>&nbsp;<span class="op" id="6239716">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6239721">//&nbsp;octal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239746">has8or9</span>&nbsp;<span class="op" id="6239754">:=</span>&nbsp;<span class="builtintype" id="6239757">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239766">for</span>&nbsp;<span class="ident" id="6239770">isDecimal</span><span class="op" id="6239779">(</span><span class="ident" id="6239780">ch</span><span class="op" id="6239782">)</span>&nbsp;<span class="op" id="6239784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239790">if</span>&nbsp;<span class="ident" id="6239793">ch</span>&nbsp;<span class="op" id="6239796">&gt;</span>&nbsp;<span class="string" id="6239798">&#39;7&#39;</span>&nbsp;<span class="op" id="6239802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239809">has8or9</span>&nbsp;<span class="op" id="6239817">=</span>&nbsp;<span class="builtintype" id="6239819">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239834">ch</span>&nbsp;<span class="op" id="6239837">=</span>&nbsp;<span class="ident" id="6239839">s</span><span class="op" id="6239840">.</span><span class="ident" id="6239841">next</span><span class="op" id="6239845">(</span><span class="op" id="6239846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6239851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239856">if</span>&nbsp;<span class="ident" id="6239859">s</span><span class="op" id="6239860">.</span><span class="ident" id="6239861">Mode</span><span class="op" id="6239865">&amp;</span><span class="ident" id="6239866">ScanFloats</span>&nbsp;<span class="op" id="6239877">!=</span>&nbsp;<span class="num" id="6239880">0</span>&nbsp;<span class="op" id="6239882">&amp;&amp;</span>&nbsp;<span class="op" id="6239885">(</span><span class="ident" id="6239886">ch</span>&nbsp;<span class="op" id="6239889">==</span>&nbsp;<span class="string" id="6239892">&#39;.&#39;</span>&nbsp;<span class="op" id="6239896">||</span>&nbsp;<span class="ident" id="6239899">ch</span>&nbsp;<span class="op" id="6239902">==</span>&nbsp;<span class="string" id="6239905">&#39;e&#39;</span>&nbsp;<span class="op" id="6239909">||</span>&nbsp;<span class="ident" id="6239912">ch</span>&nbsp;<span class="op" id="6239915">==</span>&nbsp;<span class="string" id="6239918">&#39;E&#39;</span><span class="op" id="6239921">)</span>&nbsp;<span class="op" id="6239923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6239929">//&nbsp;float</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239942">ch</span>&nbsp;<span class="op" id="6239945">=</span>&nbsp;<span class="ident" id="6239947">s</span><span class="op" id="6239948">.</span><span class="ident" id="6239949">scanFraction</span><span class="op" id="6239961">(</span><span class="ident" id="6239962">ch</span><span class="op" id="6239964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6239970">ch</span>&nbsp;<span class="op" id="6239973">=</span>&nbsp;<span class="ident" id="6239975">s</span><span class="op" id="6239976">.</span><span class="ident" id="6239977">scanExponent</span><span class="op" id="6239989">(</span><span class="ident" id="6239990">ch</span><span class="op" id="6239992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6239998">return</span>&nbsp;<span class="ident" id="6240005">Float</span><span class="op" id="6240010">,</span>&nbsp;<span class="ident" id="6240012">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6240023">//&nbsp;octal&nbsp;int</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240039">if</span>&nbsp;<span class="ident" id="6240042">has8or9</span>&nbsp;<span class="op" id="6240050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240056">s</span><span class="op" id="6240057">.</span><span class="builtintype" id="6240058">error</span><span class="op" id="6240063">(</span><span class="string" id="6240064">&#34;illegal&nbsp;octal&nbsp;number&#34;</span><span class="op" id="6240086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240099">return</span>&nbsp;<span class="ident" id="6240106">Int</span><span class="op" id="6240109">,</span>&nbsp;<span class="ident" id="6240111">ch</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6240118">//&nbsp;decimal&nbsp;int&nbsp;or&nbsp;float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240143">ch</span>&nbsp;<span class="op" id="6240146">=</span>&nbsp;<span class="ident" id="6240148">s</span><span class="op" id="6240149">.</span><span class="ident" id="6240150">scanMantissa</span><span class="op" id="6240162">(</span><span class="ident" id="6240163">ch</span><span class="op" id="6240165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240168">if</span>&nbsp;<span class="ident" id="6240171">s</span><span class="op" id="6240172">.</span><span class="ident" id="6240173">Mode</span><span class="op" id="6240177">&amp;</span><span class="ident" id="6240178">ScanFloats</span>&nbsp;<span class="op" id="6240189">!=</span>&nbsp;<span class="num" id="6240192">0</span>&nbsp;<span class="op" id="6240194">&amp;&amp;</span>&nbsp;<span class="op" id="6240197">(</span><span class="ident" id="6240198">ch</span>&nbsp;<span class="op" id="6240201">==</span>&nbsp;<span class="string" id="6240204">&#39;.&#39;</span>&nbsp;<span class="op" id="6240208">||</span>&nbsp;<span class="ident" id="6240211">ch</span>&nbsp;<span class="op" id="6240214">==</span>&nbsp;<span class="string" id="6240217">&#39;e&#39;</span>&nbsp;<span class="op" id="6240221">||</span>&nbsp;<span class="ident" id="6240224">ch</span>&nbsp;<span class="op" id="6240227">==</span>&nbsp;<span class="string" id="6240230">&#39;E&#39;</span><span class="op" id="6240233">)</span>&nbsp;<span class="op" id="6240235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6240239">//&nbsp;float</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240250">ch</span>&nbsp;<span class="op" id="6240253">=</span>&nbsp;<span class="ident" id="6240255">s</span><span class="op" id="6240256">.</span><span class="ident" id="6240257">scanFraction</span><span class="op" id="6240269">(</span><span class="ident" id="6240270">ch</span><span class="op" id="6240272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240276">ch</span>&nbsp;<span class="op" id="6240279">=</span>&nbsp;<span class="ident" id="6240281">s</span><span class="op" id="6240282">.</span><span class="ident" id="6240283">scanExponent</span><span class="op" id="6240295">(</span><span class="ident" id="6240296">ch</span><span class="op" id="6240298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240302">return</span>&nbsp;<span class="ident" id="6240309">Float</span><span class="op" id="6240314">,</span>&nbsp;<span class="ident" id="6240316">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240323">return</span>&nbsp;<span class="ident" id="6240330">Int</span><span class="op" id="6240333">,</span>&nbsp;<span class="ident" id="6240335">ch</span><br>
<span class="lineno">450</span><span class="op" id="6240338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6240341">func</span>&nbsp;<span class="op" id="6240346">(</span><span class="ident" id="6240347">s</span>&nbsp;<span class="op" id="6240349">*</span><span class="ident" id="6240350">Scanner</span><span class="op" id="6240357">)</span>&nbsp;<span class="ident" id="6240359">scanDigits</span><span class="op" id="6240369">(</span><span class="ident" id="6240370">ch</span>&nbsp;<span class="builtintype" id="6240373">rune</span><span class="op" id="6240377">,</span>&nbsp;<span class="ident" id="6240379">base</span><span class="op" id="6240383">,</span>&nbsp;<span class="ident" id="6240385">n</span>&nbsp;<span class="builtintype" id="6240387">int</span><span class="op" id="6240390">)</span>&nbsp;<span class="builtintype" id="6240392">rune</span>&nbsp;<span class="op" id="6240397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240400">for</span>&nbsp;<span class="ident" id="6240404">n</span>&nbsp;<span class="op" id="6240406">&gt;</span>&nbsp;<span class="num" id="6240408">0</span>&nbsp;<span class="op" id="6240410">&amp;&amp;</span>&nbsp;<span class="ident" id="6240413">digitVal</span><span class="op" id="6240421">(</span><span class="ident" id="6240422">ch</span><span class="op" id="6240424">)</span>&nbsp;<span class="op" id="6240426">&lt;</span>&nbsp;<span class="ident" id="6240428">base</span>&nbsp;<span class="op" id="6240433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240437">ch</span>&nbsp;<span class="op" id="6240440">=</span>&nbsp;<span class="ident" id="6240442">s</span><span class="op" id="6240443">.</span><span class="ident" id="6240444">next</span><span class="op" id="6240448">(</span><span class="op" id="6240449">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240453">n</span><span class="op" id="6240454">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240461">if</span>&nbsp;<span class="ident" id="6240464">n</span>&nbsp;<span class="op" id="6240466">&gt;</span>&nbsp;<span class="num" id="6240468">0</span>&nbsp;<span class="op" id="6240470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240474">s</span><span class="op" id="6240475">.</span><span class="builtintype" id="6240476">error</span><span class="op" id="6240481">(</span><span class="string" id="6240482">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6240503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240506">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240509">return</span>&nbsp;<span class="ident" id="6240516">ch</span><br>
<span class="lineno"></span><span class="op" id="6240519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6240522">func</span>&nbsp;<span class="op" id="6240527">(</span><span class="ident" id="6240528">s</span>&nbsp;<span class="op" id="6240530">*</span><span class="ident" id="6240531">Scanner</span><span class="op" id="6240538">)</span>&nbsp;<span class="ident" id="6240540">scanEscape</span><span class="op" id="6240550">(</span><span class="ident" id="6240551">quote</span>&nbsp;<span class="builtintype" id="6240557">rune</span><span class="op" id="6240561">)</span>&nbsp;<span class="builtintype" id="6240563">rune</span>&nbsp;<span class="op" id="6240568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240571">ch</span>&nbsp;<span class="op" id="6240574">:=</span>&nbsp;<span class="ident" id="6240577">s</span><span class="op" id="6240578">.</span><span class="ident" id="6240579">next</span><span class="op" id="6240583">(</span><span class="op" id="6240584">)</span>&nbsp;<span class="comment" id="6240586">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;/&#39;</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240615">switch</span>&nbsp;<span class="ident" id="6240622">ch</span>&nbsp;<span class="op" id="6240625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240628">case</span>&nbsp;<span class="string" id="6240633">&#39;a&#39;</span><span class="op" id="6240636">,</span>&nbsp;<span class="string" id="6240638">&#39;b&#39;</span><span class="op" id="6240641">,</span>&nbsp;<span class="string" id="6240643">&#39;f&#39;</span><span class="op" id="6240646">,</span>&nbsp;<span class="string" id="6240648">&#39;n&#39;</span><span class="op" id="6240651">,</span>&nbsp;<span class="string" id="6240653">&#39;r&#39;</span><span class="op" id="6240656">,</span>&nbsp;<span class="string" id="6240658">&#39;t&#39;</span><span class="op" id="6240661">,</span>&nbsp;<span class="string" id="6240663">&#39;v&#39;</span><span class="op" id="6240666">,</span>&nbsp;<span class="string" id="6240668">&#39;\\&#39;</span><span class="op" id="6240672">,</span>&nbsp;<span class="ident" id="6240674">quote</span><span class="op" id="6240679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6240683">//&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240702">ch</span>&nbsp;<span class="op" id="6240705">=</span>&nbsp;<span class="ident" id="6240707">s</span><span class="op" id="6240708">.</span><span class="ident" id="6240709">next</span><span class="op" id="6240713">(</span><span class="op" id="6240714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240717">case</span>&nbsp;<span class="string" id="6240722">&#39;0&#39;</span><span class="op" id="6240725">,</span>&nbsp;<span class="string" id="6240727">&#39;1&#39;</span><span class="op" id="6240730">,</span>&nbsp;<span class="string" id="6240732">&#39;2&#39;</span><span class="op" id="6240735">,</span>&nbsp;<span class="string" id="6240737">&#39;3&#39;</span><span class="op" id="6240740">,</span>&nbsp;<span class="string" id="6240742">&#39;4&#39;</span><span class="op" id="6240745">,</span>&nbsp;<span class="string" id="6240747">&#39;5&#39;</span><span class="op" id="6240750">,</span>&nbsp;<span class="string" id="6240752">&#39;6&#39;</span><span class="op" id="6240755">,</span>&nbsp;<span class="string" id="6240757">&#39;7&#39;</span><span class="op" id="6240760">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240764">ch</span>&nbsp;<span class="op" id="6240767">=</span>&nbsp;<span class="ident" id="6240769">s</span><span class="op" id="6240770">.</span><span class="ident" id="6240771">scanDigits</span><span class="op" id="6240781">(</span><span class="ident" id="6240782">ch</span><span class="op" id="6240784">,</span>&nbsp;<span class="num" id="6240786">8</span><span class="op" id="6240787">,</span>&nbsp;<span class="num" id="6240789">3</span><span class="op" id="6240790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240793">case</span>&nbsp;<span class="string" id="6240798">&#39;x&#39;</span><span class="op" id="6240801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240805">ch</span>&nbsp;<span class="op" id="6240808">=</span>&nbsp;<span class="ident" id="6240810">s</span><span class="op" id="6240811">.</span><span class="ident" id="6240812">scanDigits</span><span class="op" id="6240822">(</span><span class="ident" id="6240823">s</span><span class="op" id="6240824">.</span><span class="ident" id="6240825">next</span><span class="op" id="6240829">(</span><span class="op" id="6240830">)</span><span class="op" id="6240831">,</span>&nbsp;<span class="num" id="6240833">16</span><span class="op" id="6240835">,</span>&nbsp;<span class="num" id="6240837">2</span><span class="op" id="6240838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240841">case</span>&nbsp;<span class="string" id="6240846">&#39;u&#39;</span><span class="op" id="6240849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240853">ch</span>&nbsp;<span class="op" id="6240856">=</span>&nbsp;<span class="ident" id="6240858">s</span><span class="op" id="6240859">.</span><span class="ident" id="6240860">scanDigits</span><span class="op" id="6240870">(</span><span class="ident" id="6240871">s</span><span class="op" id="6240872">.</span><span class="ident" id="6240873">next</span><span class="op" id="6240877">(</span><span class="op" id="6240878">)</span><span class="op" id="6240879">,</span>&nbsp;<span class="num" id="6240881">16</span><span class="op" id="6240883">,</span>&nbsp;<span class="num" id="6240885">4</span><span class="op" id="6240886">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240889">case</span>&nbsp;<span class="string" id="6240894">&#39;U&#39;</span><span class="op" id="6240897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240901">ch</span>&nbsp;<span class="op" id="6240904">=</span>&nbsp;<span class="ident" id="6240906">s</span><span class="op" id="6240907">.</span><span class="ident" id="6240908">scanDigits</span><span class="op" id="6240918">(</span><span class="ident" id="6240919">s</span><span class="op" id="6240920">.</span><span class="ident" id="6240921">next</span><span class="op" id="6240925">(</span><span class="op" id="6240926">)</span><span class="op" id="6240927">,</span>&nbsp;<span class="num" id="6240929">16</span><span class="op" id="6240931">,</span>&nbsp;<span class="num" id="6240933">8</span><span class="op" id="6240934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240937">default</span><span class="op" id="6240944">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6240948">s</span><span class="op" id="6240949">.</span><span class="builtintype" id="6240950">error</span><span class="op" id="6240955">(</span><span class="string" id="6240956">&#34;illegal&nbsp;char&nbsp;escape&#34;</span><span class="op" id="6240977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6240980">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6240983">return</span>&nbsp;<span class="ident" id="6240990">ch</span><br>
<span class="lineno"></span><span class="op" id="6240993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6240996">func</span>&nbsp;<span class="op" id="6241001">(</span><span class="ident" id="6241002">s</span>&nbsp;<span class="op" id="6241004">*</span><span class="ident" id="6241005">Scanner</span><span class="op" id="6241012">)</span>&nbsp;<span class="ident" id="6241014">scanString</span><span class="op" id="6241024">(</span><span class="ident" id="6241025">quote</span>&nbsp;<span class="builtintype" id="6241031">rune</span><span class="op" id="6241035">)</span>&nbsp;<span class="op" id="6241037">(</span><span class="ident" id="6241038">n</span>&nbsp;<span class="builtintype" id="6241040">int</span><span class="op" id="6241043">)</span>&nbsp;<span class="op" id="6241045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241048">ch</span>&nbsp;<span class="op" id="6241051">:=</span>&nbsp;<span class="ident" id="6241054">s</span><span class="op" id="6241055">.</span><span class="ident" id="6241056">next</span><span class="op" id="6241060">(</span><span class="op" id="6241061">)</span>&nbsp;<span class="comment" id="6241063">//&nbsp;read&nbsp;character&nbsp;after&nbsp;quote</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241094">for</span>&nbsp;<span class="ident" id="6241098">ch</span>&nbsp;<span class="op" id="6241101">!=</span>&nbsp;<span class="ident" id="6241104">quote</span>&nbsp;<span class="op" id="6241110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241114">if</span>&nbsp;<span class="ident" id="6241117">ch</span>&nbsp;<span class="op" id="6241120">==</span>&nbsp;<span class="string" id="6241123">&#39;\n&#39;</span>&nbsp;<span class="op" id="6241128">||</span>&nbsp;<span class="ident" id="6241131">ch</span>&nbsp;<span class="op" id="6241134">&lt;</span>&nbsp;<span class="num" id="6241136">0</span>&nbsp;<span class="op" id="6241138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241143">s</span><span class="op" id="6241144">.</span><span class="builtintype" id="6241145">error</span><span class="op" id="6241150">(</span><span class="string" id="6241151">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6241175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241180">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241189">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241193">if</span>&nbsp;<span class="ident" id="6241196">ch</span>&nbsp;<span class="op" id="6241199">==</span>&nbsp;<span class="string" id="6241202">&#39;\\&#39;</span>&nbsp;<span class="op" id="6241207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241212">ch</span>&nbsp;<span class="op" id="6241215">=</span>&nbsp;<span class="ident" id="6241217">s</span><span class="op" id="6241218">.</span><span class="ident" id="6241219">scanEscape</span><span class="op" id="6241229">(</span><span class="ident" id="6241230">quote</span><span class="op" id="6241235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241239">}</span>&nbsp;<span class="keyword" id="6241241">else</span>&nbsp;<span class="op" id="6241246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241251">ch</span>&nbsp;<span class="op" id="6241254">=</span>&nbsp;<span class="ident" id="6241256">s</span><span class="op" id="6241257">.</span><span class="ident" id="6241258">next</span><span class="op" id="6241262">(</span><span class="op" id="6241263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241267">}</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241271">n</span><span class="op" id="6241272">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241279">return</span><br>
<span class="lineno"></span><span class="op" id="6241286">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="6241289">func</span>&nbsp;<span class="op" id="6241294">(</span><span class="ident" id="6241295">s</span>&nbsp;<span class="op" id="6241297">*</span><span class="ident" id="6241298">Scanner</span><span class="op" id="6241305">)</span>&nbsp;<span class="ident" id="6241307">scanRawString</span><span class="op" id="6241320">(</span><span class="op" id="6241321">)</span>&nbsp;<span class="op" id="6241323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241326">ch</span>&nbsp;<span class="op" id="6241329">:=</span>&nbsp;<span class="ident" id="6241332">s</span><span class="op" id="6241333">.</span><span class="ident" id="6241334">next</span><span class="op" id="6241338">(</span><span class="op" id="6241339">)</span>&nbsp;<span class="comment" id="6241341">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#39;`&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241370">for</span>&nbsp;<span class="ident" id="6241374">ch</span>&nbsp;<span class="op" id="6241377">!=</span>&nbsp;<span class="string" id="6241380">&#39;`&#39;</span>&nbsp;<span class="op" id="6241384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241388">if</span>&nbsp;<span class="ident" id="6241391">ch</span>&nbsp;<span class="op" id="6241394">&lt;</span>&nbsp;<span class="num" id="6241396">0</span>&nbsp;<span class="op" id="6241398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241403">s</span><span class="op" id="6241404">.</span><span class="builtintype" id="6241405">error</span><span class="op" id="6241410">(</span><span class="string" id="6241411">&#34;literal&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6241435">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241440">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241453">ch</span>&nbsp;<span class="op" id="6241456">=</span>&nbsp;<span class="ident" id="6241458">s</span><span class="op" id="6241459">.</span><span class="ident" id="6241460">next</span><span class="op" id="6241464">(</span><span class="op" id="6241465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241468">}</span><br>
<span class="lineno"></span><span class="op" id="6241470">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="6241473">func</span>&nbsp;<span class="op" id="6241478">(</span><span class="ident" id="6241479">s</span>&nbsp;<span class="op" id="6241481">*</span><span class="ident" id="6241482">Scanner</span><span class="op" id="6241489">)</span>&nbsp;<span class="ident" id="6241491">scanChar</span><span class="op" id="6241499">(</span><span class="op" id="6241500">)</span>&nbsp;<span class="op" id="6241502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241505">if</span>&nbsp;<span class="ident" id="6241508">s</span><span class="op" id="6241509">.</span><span class="ident" id="6241510">scanString</span><span class="op" id="6241520">(</span><span class="string" id="6241521">&#39;\&#39;&#39;</span><span class="op" id="6241525">)</span>&nbsp;<span class="op" id="6241527">!=</span>&nbsp;<span class="num" id="6241530">1</span>&nbsp;<span class="op" id="6241532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241536">s</span><span class="op" id="6241537">.</span><span class="builtintype" id="6241538">error</span><span class="op" id="6241543">(</span><span class="string" id="6241544">&#34;illegal&nbsp;char&nbsp;literal&#34;</span><span class="op" id="6241566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241569">}</span><br>
<span class="lineno">515</span><span class="op" id="6241571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6241574">func</span>&nbsp;<span class="op" id="6241579">(</span><span class="ident" id="6241580">s</span>&nbsp;<span class="op" id="6241582">*</span><span class="ident" id="6241583">Scanner</span><span class="op" id="6241590">)</span>&nbsp;<span class="ident" id="6241592">scanComment</span><span class="op" id="6241603">(</span><span class="ident" id="6241604">ch</span>&nbsp;<span class="builtintype" id="6241607">rune</span><span class="op" id="6241611">)</span>&nbsp;<span class="builtintype" id="6241613">rune</span>&nbsp;<span class="op" id="6241618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6241621">//&nbsp;ch&nbsp;==&nbsp;&#39;/&#39;&nbsp;||&nbsp;ch&nbsp;==&nbsp;&#39;*&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241648">if</span>&nbsp;<span class="ident" id="6241651">ch</span>&nbsp;<span class="op" id="6241654">==</span>&nbsp;<span class="string" id="6241657">&#39;/&#39;</span>&nbsp;<span class="op" id="6241661">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6241665">//&nbsp;line&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241683">ch</span>&nbsp;<span class="op" id="6241686">=</span>&nbsp;<span class="ident" id="6241688">s</span><span class="op" id="6241689">.</span><span class="ident" id="6241690">next</span><span class="op" id="6241694">(</span><span class="op" id="6241695">)</span>&nbsp;<span class="comment" id="6241697">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;//&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241728">for</span>&nbsp;<span class="ident" id="6241732">ch</span>&nbsp;<span class="op" id="6241735">!=</span>&nbsp;<span class="string" id="6241738">&#39;\n&#39;</span>&nbsp;<span class="op" id="6241743">&amp;&amp;</span>&nbsp;<span class="ident" id="6241746">ch</span>&nbsp;<span class="op" id="6241749">&gt;=</span>&nbsp;<span class="num" id="6241752">0</span>&nbsp;<span class="op" id="6241754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241759">ch</span>&nbsp;<span class="op" id="6241762">=</span>&nbsp;<span class="ident" id="6241764">s</span><span class="op" id="6241765">.</span><span class="ident" id="6241766">next</span><span class="op" id="6241770">(</span><span class="op" id="6241771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241775">}</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241779">return</span>&nbsp;<span class="ident" id="6241786">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6241794">//&nbsp;general&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241814">ch</span>&nbsp;<span class="op" id="6241817">=</span>&nbsp;<span class="ident" id="6241819">s</span><span class="op" id="6241820">.</span><span class="ident" id="6241821">next</span><span class="op" id="6241825">(</span><span class="op" id="6241826">)</span>&nbsp;<span class="comment" id="6241828">//&nbsp;read&nbsp;character&nbsp;after&nbsp;&#34;/*&#34;</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241858">for</span>&nbsp;<span class="op" id="6241862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241866">if</span>&nbsp;<span class="ident" id="6241869">ch</span>&nbsp;<span class="op" id="6241872">&lt;</span>&nbsp;<span class="num" id="6241874">0</span>&nbsp;<span class="op" id="6241876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241881">s</span><span class="op" id="6241882">.</span><span class="builtintype" id="6241883">error</span><span class="op" id="6241888">(</span><span class="string" id="6241889">&#34;comment&nbsp;not&nbsp;terminated&#34;</span><span class="op" id="6241913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241918">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6241926">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241930">ch0</span>&nbsp;<span class="op" id="6241934">:=</span>&nbsp;<span class="ident" id="6241937">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241942">ch</span>&nbsp;<span class="op" id="6241945">=</span>&nbsp;<span class="ident" id="6241947">s</span><span class="op" id="6241948">.</span><span class="ident" id="6241949">next</span><span class="op" id="6241953">(</span><span class="op" id="6241954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6241958">if</span>&nbsp;<span class="ident" id="6241961">ch0</span>&nbsp;<span class="op" id="6241965">==</span>&nbsp;<span class="string" id="6241968">&#39;*&#39;</span>&nbsp;<span class="op" id="6241972">&amp;&amp;</span>&nbsp;<span class="ident" id="6241975">ch</span>&nbsp;<span class="op" id="6241978">==</span>&nbsp;<span class="string" id="6241981">&#39;/&#39;</span>&nbsp;<span class="op" id="6241985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6241990">ch</span>&nbsp;<span class="op" id="6241993">=</span>&nbsp;<span class="ident" id="6241995">s</span><span class="op" id="6241996">.</span><span class="ident" id="6241997">next</span><span class="op" id="6242001">(</span><span class="op" id="6242002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6242007">break</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6242015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6242018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6242021">return</span>&nbsp;<span class="ident" id="6242028">ch</span><br>
<span class="lineno"></span><span class="op" id="6242031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="6242034">//&nbsp;Scan&nbsp;reads&nbsp;the&nbsp;next&nbsp;token&nbsp;or&nbsp;Unicode&nbsp;character&nbsp;from&nbsp;source&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="6242112">//&nbsp;It&nbsp;only&nbsp;recognizes&nbsp;tokens&nbsp;t&nbsp;for&nbsp;which&nbsp;the&nbsp;respective&nbsp;Mode&nbsp;bit&nbsp;(1&lt;&lt;-t)&nbsp;is&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="6242193">//&nbsp;It&nbsp;returns&nbsp;EOF&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;source.&nbsp;It&nbsp;reports&nbsp;scanner&nbsp;errors&nbsp;(read&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6242273">//&nbsp;token&nbsp;errors)&nbsp;by&nbsp;calling&nbsp;s.Error,&nbsp;if&nbsp;not&nbsp;nil;&nbsp;otherwise&nbsp;it&nbsp;prints&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="6242351">//&nbsp;message&nbsp;to&nbsp;os.Stderr.</span><br>
<span class="lineno">550</span><span class="keyword" id="6242376">func</span>&nbsp;<span class="op" id="6242381">(</span><span class="ident" id="6242382">s</span>&nbsp;<span class="op" id="6242384">*</span><span class="ident" id="6242385">Scanner</span><span class="op" id="6242392">)</span>&nbsp;<span class="ident" id="6242394">Scan</span><span class="op" id="6242398">(</span><span class="op" id="6242399">)</span>&nbsp;<span class="builtintype" id="6242401">rune</span>&nbsp;<span class="op" id="6242406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242409">ch</span>&nbsp;<span class="op" id="6242412">:=</span>&nbsp;<span class="ident" id="6242415">s</span><span class="op" id="6242416">.</span><span class="ident" id="6242417">Peek</span><span class="op" id="6242421">(</span><span class="op" id="6242422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242426">//&nbsp;reset&nbsp;token&nbsp;text&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242456">s</span><span class="op" id="6242457">.</span><span class="ident" id="6242458">tokPos</span>&nbsp;<span class="op" id="6242465">=</span>&nbsp;<span class="op" id="6242467">-</span><span class="num" id="6242468">1</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242471">s</span><span class="op" id="6242472">.</span><span class="ident" id="6242473">Line</span>&nbsp;<span class="op" id="6242478">=</span>&nbsp;<span class="num" id="6242480">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="6242483">redo</span><span class="op" id="6242487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242490">//&nbsp;skip&nbsp;white&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6242511">for</span>&nbsp;<span class="ident" id="6242515">s</span><span class="op" id="6242516">.</span><span class="ident" id="6242517">Whitespace</span><span class="op" id="6242527">&amp;</span><span class="op" id="6242528">(</span><span class="num" id="6242529">1</span><span class="op" id="6242530">&lt;&lt;</span><span class="builtintype" id="6242532">uint</span><span class="op" id="6242536">(</span><span class="ident" id="6242537">ch</span><span class="op" id="6242539">)</span><span class="op" id="6242540">)</span>&nbsp;<span class="op" id="6242542">!=</span>&nbsp;<span class="num" id="6242545">0</span>&nbsp;<span class="op" id="6242547">{</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242551">ch</span>&nbsp;<span class="op" id="6242554">=</span>&nbsp;<span class="ident" id="6242556">s</span><span class="op" id="6242557">.</span><span class="ident" id="6242558">next</span><span class="op" id="6242562">(</span><span class="op" id="6242563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6242566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242570">//&nbsp;start&nbsp;collecting&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242602">s</span><span class="op" id="6242603">.</span><span class="ident" id="6242604">tokBuf</span><span class="op" id="6242610">.</span><span class="ident" id="6242611">Reset</span><span class="op" id="6242616">(</span><span class="op" id="6242617">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242620">s</span><span class="op" id="6242621">.</span><span class="ident" id="6242622">tokPos</span>&nbsp;<span class="op" id="6242629">=</span>&nbsp;<span class="ident" id="6242631">s</span><span class="op" id="6242632">.</span><span class="ident" id="6242633">srcPos</span>&nbsp;<span class="op" id="6242640">-</span>&nbsp;<span class="ident" id="6242642">s</span><span class="op" id="6242643">.</span><span class="ident" id="6242644">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242658">//&nbsp;set&nbsp;token&nbsp;position</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242681">//&nbsp;(this&nbsp;is&nbsp;a&nbsp;slightly&nbsp;optimized&nbsp;version&nbsp;of&nbsp;the&nbsp;code&nbsp;in&nbsp;Pos())</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242745">s</span><span class="op" id="6242746">.</span><span class="ident" id="6242747">Offset</span>&nbsp;<span class="op" id="6242754">=</span>&nbsp;<span class="ident" id="6242756">s</span><span class="op" id="6242757">.</span><span class="ident" id="6242758">srcBufOffset</span>&nbsp;<span class="op" id="6242771">+</span>&nbsp;<span class="ident" id="6242773">s</span><span class="op" id="6242774">.</span><span class="ident" id="6242775">tokPos</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6242783">if</span>&nbsp;<span class="ident" id="6242786">s</span><span class="op" id="6242787">.</span><span class="ident" id="6242788">column</span>&nbsp;<span class="op" id="6242795">&gt;</span>&nbsp;<span class="num" id="6242797">0</span>&nbsp;<span class="op" id="6242799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242803">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242851">s</span><span class="op" id="6242852">.</span><span class="ident" id="6242853">Line</span>&nbsp;<span class="op" id="6242858">=</span>&nbsp;<span class="ident" id="6242860">s</span><span class="op" id="6242861">.</span><span class="ident" id="6242862">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6242869">s</span><span class="op" id="6242870">.</span><span class="ident" id="6242871">Column</span>&nbsp;<span class="op" id="6242878">=</span>&nbsp;<span class="ident" id="6242880">s</span><span class="op" id="6242881">.</span><span class="ident" id="6242882">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6242890">}</span>&nbsp;<span class="keyword" id="6242892">else</span>&nbsp;<span class="op" id="6242897">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242901">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242932">//&nbsp;(we&nbsp;cannot&nbsp;be&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6242982">//&nbsp;since&nbsp;we&nbsp;have&nbsp;called&nbsp;next()&nbsp;at&nbsp;least&nbsp;once)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243030">s</span><span class="op" id="6243031">.</span><span class="ident" id="6243032">Line</span>&nbsp;<span class="op" id="6243037">=</span>&nbsp;<span class="ident" id="6243039">s</span><span class="op" id="6243040">.</span><span class="ident" id="6243041">line</span>&nbsp;<span class="op" id="6243046">-</span>&nbsp;<span class="num" id="6243048">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243052">s</span><span class="op" id="6243053">.</span><span class="ident" id="6243054">Column</span>&nbsp;<span class="op" id="6243061">=</span>&nbsp;<span class="ident" id="6243063">s</span><span class="op" id="6243064">.</span><span class="ident" id="6243065">lastLineLen</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6243082">//&nbsp;determine&nbsp;token&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243108">tok</span>&nbsp;<span class="op" id="6243112">:=</span>&nbsp;<span class="ident" id="6243115">ch</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243119">switch</span>&nbsp;<span class="op" id="6243126">{</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243129">case</span>&nbsp;<span class="ident" id="6243134">s</span><span class="op" id="6243135">.</span><span class="ident" id="6243136">isIdentRune</span><span class="op" id="6243147">(</span><span class="ident" id="6243148">ch</span><span class="op" id="6243150">,</span>&nbsp;<span class="num" id="6243152">0</span><span class="op" id="6243153">)</span><span class="op" id="6243154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243158">if</span>&nbsp;<span class="ident" id="6243161">s</span><span class="op" id="6243162">.</span><span class="ident" id="6243163">Mode</span><span class="op" id="6243167">&amp;</span><span class="ident" id="6243168">ScanIdents</span>&nbsp;<span class="op" id="6243179">!=</span>&nbsp;<span class="num" id="6243182">0</span>&nbsp;<span class="op" id="6243184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243189">tok</span>&nbsp;<span class="op" id="6243193">=</span>&nbsp;<span class="ident" id="6243195">Ident</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243204">ch</span>&nbsp;<span class="op" id="6243207">=</span>&nbsp;<span class="ident" id="6243209">s</span><span class="op" id="6243210">.</span><span class="ident" id="6243211">scanIdentifier</span><span class="op" id="6243225">(</span><span class="op" id="6243226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243230">}</span>&nbsp;<span class="keyword" id="6243232">else</span>&nbsp;<span class="op" id="6243237">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243242">ch</span>&nbsp;<span class="op" id="6243245">=</span>&nbsp;<span class="ident" id="6243247">s</span><span class="op" id="6243248">.</span><span class="ident" id="6243249">next</span><span class="op" id="6243253">(</span><span class="op" id="6243254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243261">case</span>&nbsp;<span class="ident" id="6243266">isDecimal</span><span class="op" id="6243275">(</span><span class="ident" id="6243276">ch</span><span class="op" id="6243278">)</span><span class="op" id="6243279">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243283">if</span>&nbsp;<span class="ident" id="6243286">s</span><span class="op" id="6243287">.</span><span class="ident" id="6243288">Mode</span><span class="op" id="6243292">&amp;</span><span class="op" id="6243293">(</span><span class="ident" id="6243294">ScanInts</span><span class="op" id="6243302">|</span><span class="ident" id="6243303">ScanFloats</span><span class="op" id="6243313">)</span>&nbsp;<span class="op" id="6243315">!=</span>&nbsp;<span class="num" id="6243318">0</span>&nbsp;<span class="op" id="6243320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243325">tok</span><span class="op" id="6243328">,</span>&nbsp;<span class="ident" id="6243330">ch</span>&nbsp;<span class="op" id="6243333">=</span>&nbsp;<span class="ident" id="6243335">s</span><span class="op" id="6243336">.</span><span class="ident" id="6243337">scanNumber</span><span class="op" id="6243347">(</span><span class="ident" id="6243348">ch</span><span class="op" id="6243350">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243354">}</span>&nbsp;<span class="keyword" id="6243356">else</span>&nbsp;<span class="op" id="6243361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243366">ch</span>&nbsp;<span class="op" id="6243369">=</span>&nbsp;<span class="ident" id="6243371">s</span><span class="op" id="6243372">.</span><span class="ident" id="6243373">next</span><span class="op" id="6243377">(</span><span class="op" id="6243378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243385">default</span><span class="op" id="6243392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243396">switch</span>&nbsp;<span class="ident" id="6243403">ch</span>&nbsp;<span class="op" id="6243406">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243410">case</span>&nbsp;<span class="string" id="6243415">&#39;&#34;&#39;</span><span class="op" id="6243418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243423">if</span>&nbsp;<span class="ident" id="6243426">s</span><span class="op" id="6243427">.</span><span class="ident" id="6243428">Mode</span><span class="op" id="6243432">&amp;</span><span class="ident" id="6243433">ScanStrings</span>&nbsp;<span class="op" id="6243445">!=</span>&nbsp;<span class="num" id="6243448">0</span>&nbsp;<span class="op" id="6243450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243456">s</span><span class="op" id="6243457">.</span><span class="ident" id="6243458">scanString</span><span class="op" id="6243468">(</span><span class="string" id="6243469">&#39;&#34;&#39;</span><span class="op" id="6243472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243478">tok</span>&nbsp;<span class="op" id="6243482">=</span>&nbsp;<span class="ident" id="6243484">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243494">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243499">ch</span>&nbsp;<span class="op" id="6243502">=</span>&nbsp;<span class="ident" id="6243504">s</span><span class="op" id="6243505">.</span><span class="ident" id="6243506">next</span><span class="op" id="6243510">(</span><span class="op" id="6243511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243515">case</span>&nbsp;<span class="string" id="6243520">&#39;\&#39;&#39;</span><span class="op" id="6243524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243529">if</span>&nbsp;<span class="ident" id="6243532">s</span><span class="op" id="6243533">.</span><span class="ident" id="6243534">Mode</span><span class="op" id="6243538">&amp;</span><span class="ident" id="6243539">ScanChars</span>&nbsp;<span class="op" id="6243549">!=</span>&nbsp;<span class="num" id="6243552">0</span>&nbsp;<span class="op" id="6243554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243560">s</span><span class="op" id="6243561">.</span><span class="ident" id="6243562">scanChar</span><span class="op" id="6243570">(</span><span class="op" id="6243571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243577">tok</span>&nbsp;<span class="op" id="6243581">=</span>&nbsp;<span class="ident" id="6243583">Char</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243596">ch</span>&nbsp;<span class="op" id="6243599">=</span>&nbsp;<span class="ident" id="6243601">s</span><span class="op" id="6243602">.</span><span class="ident" id="6243603">next</span><span class="op" id="6243607">(</span><span class="op" id="6243608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243612">case</span>&nbsp;<span class="string" id="6243617">&#39;.&#39;</span><span class="op" id="6243620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243625">ch</span>&nbsp;<span class="op" id="6243628">=</span>&nbsp;<span class="ident" id="6243630">s</span><span class="op" id="6243631">.</span><span class="ident" id="6243632">next</span><span class="op" id="6243636">(</span><span class="op" id="6243637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243642">if</span>&nbsp;<span class="ident" id="6243645">isDecimal</span><span class="op" id="6243654">(</span><span class="ident" id="6243655">ch</span><span class="op" id="6243657">)</span>&nbsp;<span class="op" id="6243659">&amp;&amp;</span>&nbsp;<span class="ident" id="6243662">s</span><span class="op" id="6243663">.</span><span class="ident" id="6243664">Mode</span><span class="op" id="6243668">&amp;</span><span class="ident" id="6243669">ScanFloats</span>&nbsp;<span class="op" id="6243680">!=</span>&nbsp;<span class="num" id="6243683">0</span>&nbsp;<span class="op" id="6243685">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243691">tok</span>&nbsp;<span class="op" id="6243695">=</span>&nbsp;<span class="ident" id="6243697">Float</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243707">ch</span>&nbsp;<span class="op" id="6243710">=</span>&nbsp;<span class="ident" id="6243712">s</span><span class="op" id="6243713">.</span><span class="ident" id="6243714">scanMantissa</span><span class="op" id="6243726">(</span><span class="ident" id="6243727">ch</span><span class="op" id="6243729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243735">ch</span>&nbsp;<span class="op" id="6243738">=</span>&nbsp;<span class="ident" id="6243740">s</span><span class="op" id="6243741">.</span><span class="ident" id="6243742">scanExponent</span><span class="op" id="6243754">(</span><span class="ident" id="6243755">ch</span><span class="op" id="6243757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243766">case</span>&nbsp;<span class="string" id="6243771">&#39;/&#39;</span><span class="op" id="6243774">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243779">ch</span>&nbsp;<span class="op" id="6243782">=</span>&nbsp;<span class="ident" id="6243784">s</span><span class="op" id="6243785">.</span><span class="ident" id="6243786">next</span><span class="op" id="6243790">(</span><span class="op" id="6243791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243796">if</span>&nbsp;<span class="op" id="6243799">(</span><span class="ident" id="6243800">ch</span>&nbsp;<span class="op" id="6243803">==</span>&nbsp;<span class="string" id="6243806">&#39;/&#39;</span>&nbsp;<span class="op" id="6243810">||</span>&nbsp;<span class="ident" id="6243813">ch</span>&nbsp;<span class="op" id="6243816">==</span>&nbsp;<span class="string" id="6243819">&#39;*&#39;</span><span class="op" id="6243822">)</span>&nbsp;<span class="op" id="6243824">&amp;&amp;</span>&nbsp;<span class="ident" id="6243827">s</span><span class="op" id="6243828">.</span><span class="ident" id="6243829">Mode</span><span class="op" id="6243833">&amp;</span><span class="ident" id="6243834">ScanComments</span>&nbsp;<span class="op" id="6243847">!=</span>&nbsp;<span class="num" id="6243850">0</span>&nbsp;<span class="op" id="6243852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243858">if</span>&nbsp;<span class="ident" id="6243861">s</span><span class="op" id="6243862">.</span><span class="ident" id="6243863">Mode</span><span class="op" id="6243867">&amp;</span><span class="ident" id="6243868">SkipComments</span>&nbsp;<span class="op" id="6243881">!=</span>&nbsp;<span class="num" id="6243884">0</span>&nbsp;<span class="op" id="6243886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243893">s</span><span class="op" id="6243894">.</span><span class="ident" id="6243895">tokPos</span>&nbsp;<span class="op" id="6243902">=</span>&nbsp;<span class="op" id="6243904">-</span><span class="num" id="6243905">1</span>&nbsp;<span class="comment" id="6243907">//&nbsp;don&#39;t&nbsp;collect&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243940">ch</span>&nbsp;<span class="op" id="6243943">=</span>&nbsp;<span class="ident" id="6243945">s</span><span class="op" id="6243946">.</span><span class="ident" id="6243947">scanComment</span><span class="op" id="6243958">(</span><span class="ident" id="6243959">ch</span><span class="op" id="6243961">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6243968">goto</span>&nbsp;<span class="ident" id="6243973">redo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6243982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6243988">ch</span>&nbsp;<span class="op" id="6243991">=</span>&nbsp;<span class="ident" id="6243993">s</span><span class="op" id="6243994">.</span><span class="ident" id="6243995">scanComment</span><span class="op" id="6244006">(</span><span class="ident" id="6244007">ch</span><span class="op" id="6244009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244015">tok</span>&nbsp;<span class="op" id="6244019">=</span>&nbsp;<span class="ident" id="6244021">Comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6244032">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244036">case</span>&nbsp;<span class="string" id="6244041">&#39;`&#39;</span><span class="op" id="6244044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244049">if</span>&nbsp;<span class="ident" id="6244052">s</span><span class="op" id="6244053">.</span><span class="ident" id="6244054">Mode</span><span class="op" id="6244058">&amp;</span><span class="ident" id="6244059">ScanRawStrings</span>&nbsp;<span class="op" id="6244074">!=</span>&nbsp;<span class="num" id="6244077">0</span>&nbsp;<span class="op" id="6244079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244085">s</span><span class="op" id="6244086">.</span><span class="ident" id="6244087">scanRawString</span><span class="op" id="6244100">(</span><span class="op" id="6244101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244107">tok</span>&nbsp;<span class="op" id="6244111">=</span>&nbsp;<span class="ident" id="6244113">String</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6244123">}</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244128">ch</span>&nbsp;<span class="op" id="6244131">=</span>&nbsp;<span class="ident" id="6244133">s</span><span class="op" id="6244134">.</span><span class="ident" id="6244135">next</span><span class="op" id="6244139">(</span><span class="op" id="6244140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244144">default</span><span class="op" id="6244151">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244156">ch</span>&nbsp;<span class="op" id="6244159">=</span>&nbsp;<span class="ident" id="6244161">s</span><span class="op" id="6244162">.</span><span class="ident" id="6244163">next</span><span class="op" id="6244167">(</span><span class="op" id="6244168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6244172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6244175">}</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6244179">//&nbsp;end&nbsp;of&nbsp;token&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244201">s</span><span class="op" id="6244202">.</span><span class="ident" id="6244203">tokEnd</span>&nbsp;<span class="op" id="6244210">=</span>&nbsp;<span class="ident" id="6244212">s</span><span class="op" id="6244213">.</span><span class="ident" id="6244214">srcPos</span>&nbsp;<span class="op" id="6244221">-</span>&nbsp;<span class="ident" id="6244223">s</span><span class="op" id="6244224">.</span><span class="ident" id="6244225">lastCharLen</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244239">s</span><span class="op" id="6244240">.</span><span class="ident" id="6244241">ch</span>&nbsp;<span class="op" id="6244244">=</span>&nbsp;<span class="ident" id="6244246">ch</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244250">return</span>&nbsp;<span class="ident" id="6244257">tok</span><br>
<span class="lineno"></span><span class="op" id="6244261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6244264">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;character&nbsp;immediately&nbsp;after</span><br>
<span class="lineno"></span><span class="comment" id="6244327">//&nbsp;the&nbsp;character&nbsp;or&nbsp;token&nbsp;returned&nbsp;by&nbsp;the&nbsp;last&nbsp;call&nbsp;to&nbsp;Next&nbsp;or&nbsp;Scan.</span><br>
<span class="lineno">650</span><span class="keyword" id="6244396">func</span>&nbsp;<span class="op" id="6244401">(</span><span class="ident" id="6244402">s</span>&nbsp;<span class="op" id="6244404">*</span><span class="ident" id="6244405">Scanner</span><span class="op" id="6244412">)</span>&nbsp;<span class="ident" id="6244414">Pos</span><span class="op" id="6244417">(</span><span class="op" id="6244418">)</span>&nbsp;<span class="op" id="6244420">(</span><span class="ident" id="6244421">pos</span>&nbsp;<span class="ident" id="6244425">Position</span><span class="op" id="6244433">)</span>&nbsp;<span class="op" id="6244435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244438">pos</span><span class="op" id="6244441">.</span><span class="ident" id="6244442">Filename</span>&nbsp;<span class="op" id="6244451">=</span>&nbsp;<span class="ident" id="6244453">s</span><span class="op" id="6244454">.</span><span class="ident" id="6244455">Filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244465">pos</span><span class="op" id="6244468">.</span><span class="ident" id="6244469">Offset</span>&nbsp;<span class="op" id="6244476">=</span>&nbsp;<span class="ident" id="6244478">s</span><span class="op" id="6244479">.</span><span class="ident" id="6244480">srcBufOffset</span>&nbsp;<span class="op" id="6244493">+</span>&nbsp;<span class="ident" id="6244495">s</span><span class="op" id="6244496">.</span><span class="ident" id="6244497">srcPos</span>&nbsp;<span class="op" id="6244504">-</span>&nbsp;<span class="ident" id="6244506">s</span><span class="op" id="6244507">.</span><span class="ident" id="6244508">lastCharLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244521">switch</span>&nbsp;<span class="op" id="6244528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244531">case</span>&nbsp;<span class="ident" id="6244536">s</span><span class="op" id="6244537">.</span><span class="ident" id="6244538">column</span>&nbsp;<span class="op" id="6244545">&gt;</span>&nbsp;<span class="num" id="6244547">0</span><span class="op" id="6244548">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6244552">//&nbsp;common&nbsp;case:&nbsp;last&nbsp;character&nbsp;was&nbsp;not&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244600">pos</span><span class="op" id="6244603">.</span><span class="ident" id="6244604">Line</span>&nbsp;<span class="op" id="6244609">=</span>&nbsp;<span class="ident" id="6244611">s</span><span class="op" id="6244612">.</span><span class="ident" id="6244613">line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244620">pos</span><span class="op" id="6244623">.</span><span class="ident" id="6244624">Column</span>&nbsp;<span class="op" id="6244631">=</span>&nbsp;<span class="ident" id="6244633">s</span><span class="op" id="6244634">.</span><span class="ident" id="6244635">column</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244643">case</span>&nbsp;<span class="ident" id="6244648">s</span><span class="op" id="6244649">.</span><span class="ident" id="6244650">lastLineLen</span>&nbsp;<span class="op" id="6244662">&gt;</span>&nbsp;<span class="num" id="6244664">0</span><span class="op" id="6244665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6244669">//&nbsp;last&nbsp;character&nbsp;was&nbsp;a&nbsp;&#39;\n&#39;</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244700">pos</span><span class="op" id="6244703">.</span><span class="ident" id="6244704">Line</span>&nbsp;<span class="op" id="6244709">=</span>&nbsp;<span class="ident" id="6244711">s</span><span class="op" id="6244712">.</span><span class="ident" id="6244713">line</span>&nbsp;<span class="op" id="6244718">-</span>&nbsp;<span class="num" id="6244720">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244724">pos</span><span class="op" id="6244727">.</span><span class="ident" id="6244728">Column</span>&nbsp;<span class="op" id="6244735">=</span>&nbsp;<span class="ident" id="6244737">s</span><span class="op" id="6244738">.</span><span class="ident" id="6244739">lastLineLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244752">default</span><span class="op" id="6244759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6244763">//&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;source</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244799">pos</span><span class="op" id="6244802">.</span><span class="ident" id="6244803">Line</span>&nbsp;<span class="op" id="6244808">=</span>&nbsp;<span class="num" id="6244810">1</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6244814">pos</span><span class="op" id="6244817">.</span><span class="ident" id="6244818">Column</span>&nbsp;<span class="op" id="6244825">=</span>&nbsp;<span class="num" id="6244827">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6244830">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244833">return</span><br>
<span class="lineno"></span><span class="op" id="6244840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="6244843">//&nbsp;TokenText&nbsp;returns&nbsp;the&nbsp;string&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;most&nbsp;recently&nbsp;scanned&nbsp;token.</span><br>
<span class="lineno"></span><span class="comment" id="6244925">//&nbsp;Valid&nbsp;after&nbsp;calling&nbsp;Scan().</span><br>
<span class="lineno"></span><span class="keyword" id="6244956">func</span>&nbsp;<span class="op" id="6244961">(</span><span class="ident" id="6244962">s</span>&nbsp;<span class="op" id="6244964">*</span><span class="ident" id="6244965">Scanner</span><span class="op" id="6244972">)</span>&nbsp;<span class="ident" id="6244974">TokenText</span><span class="op" id="6244983">(</span><span class="op" id="6244984">)</span>&nbsp;<span class="builtintype" id="6244986">string</span>&nbsp;<span class="op" id="6244993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6244996">if</span>&nbsp;<span class="ident" id="6244999">s</span><span class="op" id="6245000">.</span><span class="ident" id="6245001">tokPos</span>&nbsp;<span class="op" id="6245008">&lt;</span>&nbsp;<span class="num" id="6245010">0</span>&nbsp;<span class="op" id="6245012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6245016">//&nbsp;no&nbsp;token&nbsp;text</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6245035">return</span>&nbsp;<span class="string" id="6245042">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6245046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6245050">if</span>&nbsp;<span class="ident" id="6245053">s</span><span class="op" id="6245054">.</span><span class="ident" id="6245055">tokEnd</span>&nbsp;<span class="op" id="6245062">&lt;</span>&nbsp;<span class="num" id="6245064">0</span>&nbsp;<span class="op" id="6245066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6245070">//&nbsp;if&nbsp;EOF&nbsp;was&nbsp;reached,&nbsp;s.tokEnd&nbsp;is&nbsp;set&nbsp;to&nbsp;-1&nbsp;(s.srcPos&nbsp;==&nbsp;0)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6245133">s</span><span class="op" id="6245134">.</span><span class="ident" id="6245135">tokEnd</span>&nbsp;<span class="op" id="6245142">=</span>&nbsp;<span class="ident" id="6245144">s</span><span class="op" id="6245145">.</span><span class="ident" id="6245146">tokPos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6245154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6245158">if</span>&nbsp;<span class="ident" id="6245161">s</span><span class="op" id="6245162">.</span><span class="ident" id="6245163">tokBuf</span><span class="op" id="6245169">.</span><span class="ident" id="6245170">Len</span><span class="op" id="6245173">(</span><span class="op" id="6245174">)</span>&nbsp;<span class="op" id="6245176">==</span>&nbsp;<span class="num" id="6245179">0</span>&nbsp;<span class="op" id="6245181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6245185">//&nbsp;common&nbsp;case:&nbsp;the&nbsp;entire&nbsp;token&nbsp;text&nbsp;is&nbsp;still&nbsp;in&nbsp;srcBuf</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6245244">return</span>&nbsp;<span class="builtintype" id="6245251">string</span><span class="op" id="6245257">(</span><span class="ident" id="6245258">s</span><span class="op" id="6245259">.</span><span class="ident" id="6245260">srcBuf</span><span class="op" id="6245266">[</span><span class="ident" id="6245267">s</span><span class="op" id="6245268">.</span><span class="ident" id="6245269">tokPos</span><span class="op" id="6245275">:</span><span class="ident" id="6245276">s</span><span class="op" id="6245277">.</span><span class="ident" id="6245278">tokEnd</span><span class="op" id="6245284">]</span><span class="op" id="6245285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6245288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6245292">//&nbsp;part&nbsp;of&nbsp;the&nbsp;token&nbsp;text&nbsp;was&nbsp;saved&nbsp;in&nbsp;tokBuf:&nbsp;save&nbsp;the&nbsp;rest&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6245357">//&nbsp;tokBuf&nbsp;as&nbsp;well&nbsp;and&nbsp;return&nbsp;its&nbsp;content</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6245399">s</span><span class="op" id="6245400">.</span><span class="ident" id="6245401">tokBuf</span><span class="op" id="6245407">.</span><span class="ident" id="6245408">Write</span><span class="op" id="6245413">(</span><span class="ident" id="6245414">s</span><span class="op" id="6245415">.</span><span class="ident" id="6245416">srcBuf</span><span class="op" id="6245422">[</span><span class="ident" id="6245423">s</span><span class="op" id="6245424">.</span><span class="ident" id="6245425">tokPos</span><span class="op" id="6245431">:</span><span class="ident" id="6245432">s</span><span class="op" id="6245433">.</span><span class="ident" id="6245434">tokEnd</span><span class="op" id="6245440">]</span><span class="op" id="6245441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6245444">s</span><span class="op" id="6245445">.</span><span class="ident" id="6245446">tokPos</span>&nbsp;<span class="op" id="6245453">=</span>&nbsp;<span class="ident" id="6245455">s</span><span class="op" id="6245456">.</span><span class="ident" id="6245457">tokEnd</span>&nbsp;<span class="comment" id="6245464">//&nbsp;ensure&nbsp;idempotency&nbsp;of&nbsp;TokenText()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6245507">return</span>&nbsp;<span class="ident" id="6245514">s</span><span class="op" id="6245515">.</span><span class="ident" id="6245516">tokBuf</span><span class="op" id="6245522">.</span><span class="ident" id="6245523">String</span><span class="op" id="6245529">(</span><span class="op" id="6245530">)</span><br>
<span class="lineno"></span><span class="op" id="6245532">}</span>
</div>
</body>
</html>
