<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6544535">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6544590">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6544644">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6544695">package</span>&nbsp;<span class="ident" id="6544703">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6544708">import</span>&nbsp;<span class="op" id="6544715">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544718">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544725">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544736">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544747">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6544757">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6544760">type</span>&nbsp;<span class="ident" id="6544765">URLTest</span>&nbsp;<span class="keyword" id="6544773">struct</span>&nbsp;<span class="op" id="6544780">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6544783">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6544793">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6544801">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6544811">*</span><span class="ident" id="6544812">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6544817">roundtrip</span>&nbsp;<span class="builtintype" id="6544827">string</span>&nbsp;<span class="comment" id="6544834">//&nbsp;expected&nbsp;result&nbsp;of&nbsp;reserializing&nbsp;the&nbsp;URL;&nbsp;empty&nbsp;means&nbsp;same&nbsp;as&nbsp;&#34;in&#34;.</span><br>
<span class="lineno"></span><span class="op" id="6544905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="6544908">var</span>&nbsp;<span class="ident" id="6544912">urltests</span>&nbsp;<span class="op" id="6544921">=</span>&nbsp;<span class="op" id="6544923">[</span><span class="op" id="6544924">]</span><span class="ident" id="6544925">URLTest</span><span class="op" id="6544932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6544935">//&nbsp;no&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6544951">&#34;http://www.google.com&#34;</span><span class="op" id="6544974">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6544978">&amp;</span><span class="ident" id="6544979">URL</span><span class="op" id="6544982">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6544987">Scheme</span><span class="op" id="6544993">:</span>&nbsp;<span class="string" id="6544995">&#34;http&#34;</span><span class="op" id="6545001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545006">Host</span><span class="op" id="6545010">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545014">&#34;www.google.com&#34;</span><span class="op" id="6545030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545034">}</span><span class="op" id="6545035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545039">&#34;&#34;</span><span class="op" id="6545041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545044">}</span><span class="op" id="6545045">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545048">//&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545061">&#34;http://www.google.com/&#34;</span><span class="op" id="6545085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545089">&amp;</span><span class="ident" id="6545090">URL</span><span class="op" id="6545093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545098">Scheme</span><span class="op" id="6545104">:</span>&nbsp;<span class="string" id="6545106">&#34;http&#34;</span><span class="op" id="6545112">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545117">Host</span><span class="op" id="6545121">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545125">&#34;www.google.com&#34;</span><span class="op" id="6545141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545146">Path</span><span class="op" id="6545150">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545154">&#34;/&#34;</span><span class="op" id="6545157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545161">}</span><span class="op" id="6545162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545166">&#34;&#34;</span><span class="op" id="6545168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545171">}</span><span class="op" id="6545172">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545175">//&nbsp;path&nbsp;with&nbsp;hex&nbsp;escaping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545206">&#34;http://www.google.com/file%20one%26two&#34;</span><span class="op" id="6545246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545250">&amp;</span><span class="ident" id="6545251">URL</span><span class="op" id="6545254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545259">Scheme</span><span class="op" id="6545265">:</span>&nbsp;<span class="string" id="6545267">&#34;http&#34;</span><span class="op" id="6545273">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545278">Host</span><span class="op" id="6545282">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545286">&#34;www.google.com&#34;</span><span class="op" id="6545302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545307">Path</span><span class="op" id="6545311">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545315">&#34;/file&nbsp;one&amp;two&#34;</span><span class="op" id="6545330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545334">}</span><span class="op" id="6545335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545339">&#34;http://www.google.com/file%20one&amp;two&#34;</span><span class="op" id="6545377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545380">}</span><span class="op" id="6545381">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545384">//&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545397">&#34;ftp://webmaster@www.google.com/&#34;</span><span class="op" id="6545430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545434">&amp;</span><span class="ident" id="6545435">URL</span><span class="op" id="6545438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545443">Scheme</span><span class="op" id="6545449">:</span>&nbsp;<span class="string" id="6545451">&#34;ftp&#34;</span><span class="op" id="6545456">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545461">User</span><span class="op" id="6545465">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6545469">User</span><span class="op" id="6545473">(</span><span class="string" id="6545474">&#34;webmaster&#34;</span><span class="op" id="6545485">)</span><span class="op" id="6545486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545491">Host</span><span class="op" id="6545495">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545499">&#34;www.google.com&#34;</span><span class="op" id="6545515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545520">Path</span><span class="op" id="6545524">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545528">&#34;/&#34;</span><span class="op" id="6545531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545535">}</span><span class="op" id="6545536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545540">&#34;&#34;</span><span class="op" id="6545542">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545545">}</span><span class="op" id="6545546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545549">//&nbsp;escape&nbsp;sequence&nbsp;in&nbsp;username</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545585">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6545619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545623">&amp;</span><span class="ident" id="6545624">URL</span><span class="op" id="6545627">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545632">Scheme</span><span class="op" id="6545638">:</span>&nbsp;<span class="string" id="6545640">&#34;ftp&#34;</span><span class="op" id="6545645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545650">User</span><span class="op" id="6545654">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6545658">User</span><span class="op" id="6545662">(</span><span class="string" id="6545663">&#34;john&nbsp;doe&#34;</span><span class="op" id="6545673">)</span><span class="op" id="6545674">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545679">Host</span><span class="op" id="6545683">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545687">&#34;www.google.com&#34;</span><span class="op" id="6545703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545708">Path</span><span class="op" id="6545712">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545716">&#34;/&#34;</span><span class="op" id="6545719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545723">}</span><span class="op" id="6545724">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545728">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="6545762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545765">}</span><span class="op" id="6545766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545769">//&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545783">&#34;http://www.google.com/?q=go+language&#34;</span><span class="op" id="6545821">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545825">&amp;</span><span class="ident" id="6545826">URL</span><span class="op" id="6545829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545834">Scheme</span><span class="op" id="6545840">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6545844">&#34;http&#34;</span><span class="op" id="6545850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545855">Host</span><span class="op" id="6545859">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6545865">&#34;www.google.com&#34;</span><span class="op" id="6545881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545886">Path</span><span class="op" id="6545890">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6545896">&#34;/&#34;</span><span class="op" id="6545899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6545904">RawQuery</span><span class="op" id="6545912">:</span>&nbsp;<span class="string" id="6545914">&#34;q=go+language&#34;</span><span class="op" id="6545929">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545933">}</span><span class="op" id="6545934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545938">&#34;&#34;</span><span class="op" id="6545940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545943">}</span><span class="op" id="6545944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6545947">//&nbsp;query&nbsp;with&nbsp;hex&nbsp;escaping:&nbsp;NOT&nbsp;parsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6545987">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6545991">&#34;http://www.google.com/?q=go%20language&#34;</span><span class="op" id="6546031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546035">&amp;</span><span class="ident" id="6546036">URL</span><span class="op" id="6546039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546044">Scheme</span><span class="op" id="6546050">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546054">&#34;http&#34;</span><span class="op" id="6546060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546065">Host</span><span class="op" id="6546069">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6546075">&#34;www.google.com&#34;</span><span class="op" id="6546091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546096">Path</span><span class="op" id="6546100">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6546106">&#34;/&#34;</span><span class="op" id="6546109">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546114">RawQuery</span><span class="op" id="6546122">:</span>&nbsp;<span class="string" id="6546124">&#34;q=go%20language&#34;</span><span class="op" id="6546141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546145">}</span><span class="op" id="6546146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546150">&#34;&#34;</span><span class="op" id="6546152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546155">}</span><span class="op" id="6546156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6546159">//&nbsp;%20&nbsp;outside&nbsp;query</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546185">&#34;http://www.google.com/a%20b?q=c+d&#34;</span><span class="op" id="6546220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546224">&amp;</span><span class="ident" id="6546225">URL</span><span class="op" id="6546228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546233">Scheme</span><span class="op" id="6546239">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546243">&#34;http&#34;</span><span class="op" id="6546249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546254">Host</span><span class="op" id="6546258">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6546264">&#34;www.google.com&#34;</span><span class="op" id="6546280">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546285">Path</span><span class="op" id="6546289">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6546295">&#34;/a&nbsp;b&#34;</span><span class="op" id="6546301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546306">RawQuery</span><span class="op" id="6546314">:</span>&nbsp;<span class="string" id="6546316">&#34;q=c+d&#34;</span><span class="op" id="6546323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546327">}</span><span class="op" id="6546328">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546332">&#34;&#34;</span><span class="op" id="6546334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546337">}</span><span class="op" id="6546338">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6546341">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546387">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6546423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546427">&amp;</span><span class="ident" id="6546428">URL</span><span class="op" id="6546431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546436">Scheme</span><span class="op" id="6546442">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546446">&#34;http&#34;</span><span class="op" id="6546452">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546457">Opaque</span><span class="op" id="6546463">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546467">&#34;www.google.com/&#34;</span><span class="op" id="6546484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546489">RawQuery</span><span class="op" id="6546497">:</span>&nbsp;<span class="string" id="6546499">&#34;q=go+language&#34;</span><span class="op" id="6546514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546518">}</span><span class="op" id="6546519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546523">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="6546559">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546562">}</span><span class="op" id="6546563">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6546566">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546612">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6546654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546658">&amp;</span><span class="ident" id="6546659">URL</span><span class="op" id="6546662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546667">Scheme</span><span class="op" id="6546673">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546677">&#34;http&#34;</span><span class="op" id="6546683">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546688">Opaque</span><span class="op" id="6546694">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546698">&#34;%2f%2fwww.google.com/&#34;</span><span class="op" id="6546721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546726">RawQuery</span><span class="op" id="6546734">:</span>&nbsp;<span class="string" id="6546736">&#34;q=go+language&#34;</span><span class="op" id="6546751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546755">}</span><span class="op" id="6546756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546760">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="6546802">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546805">}</span><span class="op" id="6546806">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6546809">//&nbsp;non-authority&nbsp;with&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546841">&#34;mailto:/webmaster@golang.org&#34;</span><span class="op" id="6546871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546875">&amp;</span><span class="ident" id="6546876">URL</span><span class="op" id="6546879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546884">Scheme</span><span class="op" id="6546890">:</span>&nbsp;<span class="string" id="6546892">&#34;mailto&#34;</span><span class="op" id="6546900">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6546905">Path</span><span class="op" id="6546909">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6546913">&#34;/webmaster@golang.org&#34;</span><span class="op" id="6546936">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6546940">}</span><span class="op" id="6546941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6546945">&#34;mailto:///webmaster@golang.org&#34;</span><span class="op" id="6546977">,</span>&nbsp;<span class="comment" id="6546979">//&nbsp;unfortunate&nbsp;compromise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547006">}</span><span class="op" id="6547007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547010">//&nbsp;non-authority</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547032">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6547061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547065">&amp;</span><span class="ident" id="6547066">URL</span><span class="op" id="6547069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547074">Scheme</span><span class="op" id="6547080">:</span>&nbsp;<span class="string" id="6547082">&#34;mailto&#34;</span><span class="op" id="6547090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547095">Opaque</span><span class="op" id="6547101">:</span>&nbsp;<span class="string" id="6547103">&#34;webmaster@golang.org&#34;</span><span class="op" id="6547125">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547129">}</span><span class="op" id="6547130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547134">&#34;&#34;</span><span class="op" id="6547136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547139">}</span><span class="op" id="6547140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547143">//&nbsp;unescaped&nbsp;://&nbsp;in&nbsp;query&nbsp;should&nbsp;not&nbsp;create&nbsp;a&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547197">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547201">&#34;/foo?query=http://bad&#34;</span><span class="op" id="6547224">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547228">&amp;</span><span class="ident" id="6547229">URL</span><span class="op" id="6547232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547237">Path</span><span class="op" id="6547241">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547247">&#34;/foo&#34;</span><span class="op" id="6547253">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547258">RawQuery</span><span class="op" id="6547266">:</span>&nbsp;<span class="string" id="6547268">&#34;query=http://bad&#34;</span><span class="op" id="6547286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547290">}</span><span class="op" id="6547291">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547295">&#34;&#34;</span><span class="op" id="6547297">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547300">}</span><span class="op" id="6547301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547304">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme&nbsp;should&nbsp;create&nbsp;an&nbsp;authority</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547365">&#34;//foo&#34;</span><span class="op" id="6547372">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547376">&amp;</span><span class="ident" id="6547377">URL</span><span class="op" id="6547380">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547385">Host</span><span class="op" id="6547389">:</span>&nbsp;<span class="string" id="6547391">&#34;foo&#34;</span><span class="op" id="6547396">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547400">}</span><span class="op" id="6547401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547405">&#34;&#34;</span><span class="op" id="6547407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547410">}</span><span class="op" id="6547411">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547414">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme,&nbsp;with&nbsp;userinfo,&nbsp;path,&nbsp;and&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547480">&#34;//user@foo/path?a=b&#34;</span><span class="op" id="6547501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547505">&amp;</span><span class="ident" id="6547506">URL</span><span class="op" id="6547509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547514">User</span><span class="op" id="6547518">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6547524">User</span><span class="op" id="6547528">(</span><span class="string" id="6547529">&#34;user&#34;</span><span class="op" id="6547535">)</span><span class="op" id="6547536">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547541">Host</span><span class="op" id="6547545">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547551">&#34;foo&#34;</span><span class="op" id="6547556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547561">Path</span><span class="op" id="6547565">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6547571">&#34;/path&#34;</span><span class="op" id="6547578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547583">RawQuery</span><span class="op" id="6547591">:</span>&nbsp;<span class="string" id="6547593">&#34;a=b&#34;</span><span class="op" id="6547598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547602">}</span><span class="op" id="6547603">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547607">&#34;&#34;</span><span class="op" id="6547609">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547612">}</span><span class="op" id="6547613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547616">//&nbsp;Three&nbsp;leading&nbsp;slashes&nbsp;isn&#39;t&nbsp;an&nbsp;authority,&nbsp;but&nbsp;doesn&#39;t&nbsp;return&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547691">//&nbsp;(We&nbsp;can&#39;t&nbsp;return&nbsp;an&nbsp;error,&nbsp;as&nbsp;this&nbsp;code&nbsp;is&nbsp;also&nbsp;used&nbsp;via</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547752">//&nbsp;ServeHTTP&nbsp;-&gt;&nbsp;ReadRequest&nbsp;-&gt;&nbsp;Parse,&nbsp;which&nbsp;is&nbsp;arguably&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547811">//&nbsp;different&nbsp;URL&nbsp;parsing&nbsp;context,&nbsp;but&nbsp;currently&nbsp;shares&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6547871">//&nbsp;same&nbsp;codepath)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547894">&#34;///threeslashes&#34;</span><span class="op" id="6547911">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547915">&amp;</span><span class="ident" id="6547916">URL</span><span class="op" id="6547919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6547924">Path</span><span class="op" id="6547928">:</span>&nbsp;<span class="string" id="6547930">&#34;///threeslashes&#34;</span><span class="op" id="6547947">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547951">}</span><span class="op" id="6547952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547956">&#34;&#34;</span><span class="op" id="6547958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547961">}</span><span class="op" id="6547962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6547965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6547969">&#34;http://user:password@google.com&#34;</span><span class="op" id="6548002">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548006">&amp;</span><span class="ident" id="6548007">URL</span><span class="op" id="6548010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548015">Scheme</span><span class="op" id="6548021">:</span>&nbsp;<span class="string" id="6548023">&#34;http&#34;</span><span class="op" id="6548029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548034">User</span><span class="op" id="6548038">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6548042">UserPassword</span><span class="op" id="6548054">(</span><span class="string" id="6548055">&#34;user&#34;</span><span class="op" id="6548061">,</span>&nbsp;<span class="string" id="6548063">&#34;password&#34;</span><span class="op" id="6548073">)</span><span class="op" id="6548074">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548079">Host</span><span class="op" id="6548083">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6548087">&#34;google.com&#34;</span><span class="op" id="6548099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548103">}</span><span class="op" id="6548104">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548108">&#34;http://user:password@google.com&#34;</span><span class="op" id="6548141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548144">}</span><span class="op" id="6548145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6548148">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;username&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548204">&#34;http://j@ne:password@google.com&#34;</span><span class="op" id="6548237">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548241">&amp;</span><span class="ident" id="6548242">URL</span><span class="op" id="6548245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548250">Scheme</span><span class="op" id="6548256">:</span>&nbsp;<span class="string" id="6548258">&#34;http&#34;</span><span class="op" id="6548264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548269">User</span><span class="op" id="6548273">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6548277">UserPassword</span><span class="op" id="6548289">(</span><span class="string" id="6548290">&#34;j@ne&#34;</span><span class="op" id="6548296">,</span>&nbsp;<span class="string" id="6548298">&#34;password&#34;</span><span class="op" id="6548308">)</span><span class="op" id="6548309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548314">Host</span><span class="op" id="6548318">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6548322">&#34;google.com&#34;</span><span class="op" id="6548334">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548338">}</span><span class="op" id="6548339">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548343">&#34;http://j%40ne:password@google.com&#34;</span><span class="op" id="6548378">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548381">}</span><span class="op" id="6548382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6548385">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;password&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548441">&#34;http://jane:p@ssword@google.com&#34;</span><span class="op" id="6548474">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548478">&amp;</span><span class="ident" id="6548479">URL</span><span class="op" id="6548482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548487">Scheme</span><span class="op" id="6548493">:</span>&nbsp;<span class="string" id="6548495">&#34;http&#34;</span><span class="op" id="6548501">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548506">User</span><span class="op" id="6548510">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6548514">UserPassword</span><span class="op" id="6548526">(</span><span class="string" id="6548527">&#34;jane&#34;</span><span class="op" id="6548533">,</span>&nbsp;<span class="string" id="6548535">&#34;p@ssword&#34;</span><span class="op" id="6548545">)</span><span class="op" id="6548546">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548551">Host</span><span class="op" id="6548555">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6548559">&#34;google.com&#34;</span><span class="op" id="6548571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548575">}</span><span class="op" id="6548576">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548580">&#34;http://jane:p%40ssword@google.com&#34;</span><span class="op" id="6548615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548618">}</span><span class="op" id="6548619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548626">&#34;http://j@ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6548670">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548674">&amp;</span><span class="ident" id="6548675">URL</span><span class="op" id="6548678">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548683">Scheme</span><span class="op" id="6548689">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6548693">&#34;http&#34;</span><span class="op" id="6548699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548704">User</span><span class="op" id="6548708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6548714">UserPassword</span><span class="op" id="6548726">(</span><span class="string" id="6548727">&#34;j@ne&#34;</span><span class="op" id="6548733">,</span>&nbsp;<span class="string" id="6548735">&#34;password&#34;</span><span class="op" id="6548745">)</span><span class="op" id="6548746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548751">Host</span><span class="op" id="6548755">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548761">&#34;google.com&#34;</span><span class="op" id="6548773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548778">Path</span><span class="op" id="6548782">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548788">&#34;/p@th&#34;</span><span class="op" id="6548795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548800">RawQuery</span><span class="op" id="6548808">:</span>&nbsp;<span class="string" id="6548810">&#34;q=@go&#34;</span><span class="op" id="6548817">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548821">}</span><span class="op" id="6548822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548826">&#34;http://j%40ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="6548872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548875">}</span><span class="op" id="6548876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6548883">&#34;http://www.google.com/?q=go+language#foo&#34;</span><span class="op" id="6548925">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6548929">&amp;</span><span class="ident" id="6548930">URL</span><span class="op" id="6548933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548938">Scheme</span><span class="op" id="6548944">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6548948">&#34;http&#34;</span><span class="op" id="6548954">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548959">Host</span><span class="op" id="6548963">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6548969">&#34;www.google.com&#34;</span><span class="op" id="6548985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6548990">Path</span><span class="op" id="6548994">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6549000">&#34;/&#34;</span><span class="op" id="6549003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549008">RawQuery</span><span class="op" id="6549016">:</span>&nbsp;<span class="string" id="6549018">&#34;q=go+language&#34;</span><span class="op" id="6549033">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549038">Fragment</span><span class="op" id="6549046">:</span>&nbsp;<span class="string" id="6549048">&#34;foo&#34;</span><span class="op" id="6549053">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549057">}</span><span class="op" id="6549058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549062">&#34;&#34;</span><span class="op" id="6549064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549067">}</span><span class="op" id="6549068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549071">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549075">&#34;http://www.google.com/?q=go+language#foo%26bar&#34;</span><span class="op" id="6549123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549127">&amp;</span><span class="ident" id="6549128">URL</span><span class="op" id="6549131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549136">Scheme</span><span class="op" id="6549142">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6549146">&#34;http&#34;</span><span class="op" id="6549152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549157">Host</span><span class="op" id="6549161">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6549167">&#34;www.google.com&#34;</span><span class="op" id="6549183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549188">Path</span><span class="op" id="6549192">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6549198">&#34;/&#34;</span><span class="op" id="6549201">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549206">RawQuery</span><span class="op" id="6549214">:</span>&nbsp;<span class="string" id="6549216">&#34;q=go+language&#34;</span><span class="op" id="6549231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549236">Fragment</span><span class="op" id="6549244">:</span>&nbsp;<span class="string" id="6549246">&#34;foo&amp;bar&#34;</span><span class="op" id="6549255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549259">}</span><span class="op" id="6549260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549264">&#34;http://www.google.com/?q=go+language#foo&amp;bar&#34;</span><span class="op" id="6549310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549313">}</span><span class="op" id="6549314">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549321">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6549347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549351">&amp;</span><span class="ident" id="6549352">URL</span><span class="op" id="6549355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549360">Scheme</span><span class="op" id="6549366">:</span>&nbsp;<span class="string" id="6549368">&#34;file&#34;</span><span class="op" id="6549374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549379">Host</span><span class="op" id="6549383">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6549387">&#34;&#34;</span><span class="op" id="6549389">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549394">Path</span><span class="op" id="6549398">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6549402">&#34;/home/adg/rabbits&#34;</span><span class="op" id="6549421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549425">}</span><span class="op" id="6549426">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549430">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="6549456">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549459">}</span><span class="op" id="6549460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549463">//&nbsp;&#34;Windows&#34;&nbsp;paths&nbsp;are&nbsp;no&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549513">//&nbsp;See&nbsp;golang.org/issue/6027,&nbsp;especially&nbsp;comment&nbsp;#9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549571">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6549598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549602">&amp;</span><span class="ident" id="6549603">URL</span><span class="op" id="6549606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549611">Scheme</span><span class="op" id="6549617">:</span>&nbsp;<span class="string" id="6549619">&#34;file&#34;</span><span class="op" id="6549625">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549630">Host</span><span class="op" id="6549634">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6549638">&#34;&#34;</span><span class="op" id="6549640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549645">Path</span><span class="op" id="6549649">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6549653">&#34;/C:/FooBar/Baz.txt&#34;</span><span class="op" id="6549673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549677">}</span><span class="op" id="6549678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549682">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="6549709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549712">}</span><span class="op" id="6549713">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549716">//&nbsp;case-insensitive&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549748">&#34;MaIlTo:webmaster@golang.org&#34;</span><span class="op" id="6549777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549781">&amp;</span><span class="ident" id="6549782">URL</span><span class="op" id="6549785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549790">Scheme</span><span class="op" id="6549796">:</span>&nbsp;<span class="string" id="6549798">&#34;mailto&#34;</span><span class="op" id="6549806">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549811">Opaque</span><span class="op" id="6549817">:</span>&nbsp;<span class="string" id="6549819">&#34;webmaster@golang.org&#34;</span><span class="op" id="6549841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549845">}</span><span class="op" id="6549846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549850">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="6549879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549882">}</span><span class="op" id="6549883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549886">//&nbsp;Relative&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549908">&#34;a/b/c&#34;</span><span class="op" id="6549915">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549919">&amp;</span><span class="ident" id="6549920">URL</span><span class="op" id="6549923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6549928">Path</span><span class="op" id="6549932">:</span>&nbsp;<span class="string" id="6549934">&#34;a/b/c&#34;</span><span class="op" id="6549941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549945">}</span><span class="op" id="6549946">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6549950">&#34;a/b/c&#34;</span><span class="op" id="6549957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6549960">}</span><span class="op" id="6549961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6549964">//&nbsp;escaped&nbsp;&#39;?&#39;&nbsp;in&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550009">&#34;http://%3Fam:pa%3Fsword@google.com&#34;</span><span class="op" id="6550045">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550049">&amp;</span><span class="ident" id="6550050">URL</span><span class="op" id="6550053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550058">Scheme</span><span class="op" id="6550064">:</span>&nbsp;<span class="string" id="6550066">&#34;http&#34;</span><span class="op" id="6550072">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550077">User</span><span class="op" id="6550081">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6550085">UserPassword</span><span class="op" id="6550097">(</span><span class="string" id="6550098">&#34;?am&#34;</span><span class="op" id="6550103">,</span>&nbsp;<span class="string" id="6550105">&#34;pa?sword&#34;</span><span class="op" id="6550115">)</span><span class="op" id="6550116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550121">Host</span><span class="op" id="6550125">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6550129">&#34;google.com&#34;</span><span class="op" id="6550141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550145">}</span><span class="op" id="6550146">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6550150">&#34;&#34;</span><span class="op" id="6550152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550155">}</span><span class="op" id="6550156">,</span><br>
<span class="lineno"></span><span class="op" id="6550158">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6550161">//&nbsp;more&nbsp;useful&nbsp;string&nbsp;for&nbsp;debugging&nbsp;than&nbsp;fmt&#39;s&nbsp;struct&nbsp;printer</span><br>
<span class="lineno">295</span><span class="keyword" id="6550223">func</span>&nbsp;<span class="ident" id="6550228">ufmt</span><span class="op" id="6550232">(</span><span class="ident" id="6550233">u</span>&nbsp;<span class="op" id="6550235">*</span><span class="ident" id="6550236">URL</span><span class="op" id="6550239">)</span>&nbsp;<span class="builtintype" id="6550241">string</span>&nbsp;<span class="op" id="6550248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550251">var</span>&nbsp;<span class="ident" id="6550255">user</span><span class="op" id="6550259">,</span>&nbsp;<span class="ident" id="6550261">pass</span>&nbsp;<span class="keyword" id="6550266">interface</span><span class="op" id="6550275">{</span><span class="op" id="6550276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550279">if</span>&nbsp;<span class="ident" id="6550282">u</span><span class="op" id="6550283">.</span><span class="ident" id="6550284">User</span>&nbsp;<span class="op" id="6550289">!=</span>&nbsp;<span class="ident" id="6550292">nil</span>&nbsp;<span class="op" id="6550296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550300">user</span>&nbsp;<span class="op" id="6550305">=</span>&nbsp;<span class="ident" id="6550307">u</span><span class="op" id="6550308">.</span><span class="ident" id="6550309">User</span><span class="op" id="6550313">.</span><span class="ident" id="6550314">Username</span><span class="op" id="6550322">(</span><span class="op" id="6550323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550327">if</span>&nbsp;<span class="ident" id="6550330">p</span><span class="op" id="6550331">,</span>&nbsp;<span class="ident" id="6550333">ok</span>&nbsp;<span class="op" id="6550336">:=</span>&nbsp;<span class="ident" id="6550339">u</span><span class="op" id="6550340">.</span><span class="ident" id="6550341">User</span><span class="op" id="6550345">.</span><span class="ident" id="6550346">Password</span><span class="op" id="6550354">(</span><span class="op" id="6550355">)</span><span class="op" id="6550356">;</span>&nbsp;<span class="ident" id="6550358">ok</span>&nbsp;<span class="op" id="6550361">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550366">pass</span>&nbsp;<span class="op" id="6550371">=</span>&nbsp;<span class="ident" id="6550373">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550383">return</span>&nbsp;<span class="ident" id="6550390">fmt</span><span class="op" id="6550393">.</span><span class="ident" id="6550394">Sprintf</span><span class="op" id="6550401">(</span><span class="string" id="6550402">&#34;opaque=%q,&nbsp;scheme=%q,&nbsp;user=%#v,&nbsp;pass=%#v,&nbsp;host=%q,&nbsp;path=%q,&nbsp;rawq=%q,&nbsp;frag=%q&#34;</span><span class="op" id="6550480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550484">u</span><span class="op" id="6550485">.</span><span class="ident" id="6550486">Opaque</span><span class="op" id="6550492">,</span>&nbsp;<span class="ident" id="6550494">u</span><span class="op" id="6550495">.</span><span class="ident" id="6550496">Scheme</span><span class="op" id="6550502">,</span>&nbsp;<span class="ident" id="6550504">user</span><span class="op" id="6550508">,</span>&nbsp;<span class="ident" id="6550510">pass</span><span class="op" id="6550514">,</span>&nbsp;<span class="ident" id="6550516">u</span><span class="op" id="6550517">.</span><span class="ident" id="6550518">Host</span><span class="op" id="6550522">,</span>&nbsp;<span class="ident" id="6550524">u</span><span class="op" id="6550525">.</span><span class="ident" id="6550526">Path</span><span class="op" id="6550530">,</span>&nbsp;<span class="ident" id="6550532">u</span><span class="op" id="6550533">.</span><span class="ident" id="6550534">RawQuery</span><span class="op" id="6550542">,</span>&nbsp;<span class="ident" id="6550544">u</span><span class="op" id="6550545">.</span><span class="ident" id="6550546">Fragment</span><span class="op" id="6550554">)</span><br>
<span class="lineno">305</span><span class="op" id="6550556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6550559">func</span>&nbsp;<span class="ident" id="6550564">DoTest</span><span class="op" id="6550570">(</span><span class="ident" id="6550571">t</span>&nbsp;<span class="op" id="6550573">*</span><span class="ident" id="6550574">testing</span><span class="op" id="6550581">.</span><span class="ident" id="6550582">T</span><span class="op" id="6550583">,</span>&nbsp;<span class="ident" id="6550585">parse</span>&nbsp;<span class="keyword" id="6550591">func</span><span class="op" id="6550595">(</span><span class="builtintype" id="6550596">string</span><span class="op" id="6550602">)</span>&nbsp;<span class="op" id="6550604">(</span><span class="op" id="6550605">*</span><span class="ident" id="6550606">URL</span><span class="op" id="6550609">,</span>&nbsp;<span class="builtintype" id="6550611">error</span><span class="op" id="6550616">)</span><span class="op" id="6550617">,</span>&nbsp;<span class="ident" id="6550619">name</span>&nbsp;<span class="builtintype" id="6550624">string</span><span class="op" id="6550630">,</span>&nbsp;<span class="ident" id="6550632">tests</span>&nbsp;<span class="op" id="6550638">[</span><span class="op" id="6550639">]</span><span class="ident" id="6550640">URLTest</span><span class="op" id="6550647">)</span>&nbsp;<span class="op" id="6550649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550652">for</span>&nbsp;<span class="ident" id="6550656">_</span><span class="op" id="6550657">,</span>&nbsp;<span class="ident" id="6550659">tt</span>&nbsp;<span class="op" id="6550662">:=</span>&nbsp;<span class="keyword" id="6550665">range</span>&nbsp;<span class="ident" id="6550671">tests</span>&nbsp;<span class="op" id="6550677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550681">u</span><span class="op" id="6550682">,</span>&nbsp;<span class="ident" id="6550684">err</span>&nbsp;<span class="op" id="6550688">:=</span>&nbsp;<span class="ident" id="6550691">parse</span><span class="op" id="6550696">(</span><span class="ident" id="6550697">tt</span><span class="op" id="6550699">.</span><span class="ident" id="6550700">in</span><span class="op" id="6550702">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550706">if</span>&nbsp;<span class="ident" id="6550709">err</span>&nbsp;<span class="op" id="6550713">!=</span>&nbsp;<span class="ident" id="6550716">nil</span>&nbsp;<span class="op" id="6550720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550725">t</span><span class="op" id="6550726">.</span><span class="ident" id="6550727">Errorf</span><span class="op" id="6550733">(</span><span class="string" id="6550734">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6550760">,</span>&nbsp;<span class="ident" id="6550762">name</span><span class="op" id="6550766">,</span>&nbsp;<span class="ident" id="6550768">tt</span><span class="op" id="6550770">.</span><span class="ident" id="6550771">in</span><span class="op" id="6550773">,</span>&nbsp;<span class="ident" id="6550775">err</span><span class="op" id="6550778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550783">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6550798">if</span>&nbsp;<span class="op" id="6550801">!</span><span class="ident" id="6550802">reflect</span><span class="op" id="6550809">.</span><span class="ident" id="6550810">DeepEqual</span><span class="op" id="6550819">(</span><span class="ident" id="6550820">u</span><span class="op" id="6550821">,</span>&nbsp;<span class="ident" id="6550823">tt</span><span class="op" id="6550825">.</span><span class="ident" id="6550826">out</span><span class="op" id="6550829">)</span>&nbsp;<span class="op" id="6550831">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550836">t</span><span class="op" id="6550837">.</span><span class="ident" id="6550838">Errorf</span><span class="op" id="6550844">(</span><span class="string" id="6550845">&#34;%s(%q):\n\thave&nbsp;%v\n\twant&nbsp;%v\n&#34;</span><span class="op" id="6550878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550884">name</span><span class="op" id="6550888">,</span>&nbsp;<span class="ident" id="6550890">tt</span><span class="op" id="6550892">.</span><span class="ident" id="6550893">in</span><span class="op" id="6550895">,</span>&nbsp;<span class="ident" id="6550897">ufmt</span><span class="op" id="6550901">(</span><span class="ident" id="6550902">u</span><span class="op" id="6550903">)</span><span class="op" id="6550904">,</span>&nbsp;<span class="ident" id="6550906">ufmt</span><span class="op" id="6550910">(</span><span class="ident" id="6550911">tt</span><span class="op" id="6550913">.</span><span class="ident" id="6550914">out</span><span class="op" id="6550917">)</span><span class="op" id="6550918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6550925">}</span><br>
<span class="lineno"></span><span class="op" id="6550927">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="keyword" id="6550930">func</span>&nbsp;<span class="ident" id="6550935">BenchmarkString</span><span class="op" id="6550950">(</span><span class="ident" id="6550951">b</span>&nbsp;<span class="op" id="6550953">*</span><span class="ident" id="6550954">testing</span><span class="op" id="6550961">.</span><span class="ident" id="6550962">B</span><span class="op" id="6550963">)</span>&nbsp;<span class="op" id="6550965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550968">b</span><span class="op" id="6550969">.</span><span class="ident" id="6550970">StopTimer</span><span class="op" id="6550979">(</span><span class="op" id="6550980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6550983">b</span><span class="op" id="6550984">.</span><span class="ident" id="6550985">ReportAllocs</span><span class="op" id="6550997">(</span><span class="op" id="6550998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551001">for</span>&nbsp;<span class="ident" id="6551005">_</span><span class="op" id="6551006">,</span>&nbsp;<span class="ident" id="6551008">tt</span>&nbsp;<span class="op" id="6551011">:=</span>&nbsp;<span class="keyword" id="6551014">range</span>&nbsp;<span class="ident" id="6551020">urltests</span>&nbsp;<span class="op" id="6551029">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551033">u</span><span class="op" id="6551034">,</span>&nbsp;<span class="ident" id="6551036">err</span>&nbsp;<span class="op" id="6551040">:=</span>&nbsp;<span class="ident" id="6551043">Parse</span><span class="op" id="6551048">(</span><span class="ident" id="6551049">tt</span><span class="op" id="6551051">.</span><span class="ident" id="6551052">in</span><span class="op" id="6551054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551058">if</span>&nbsp;<span class="ident" id="6551061">err</span>&nbsp;<span class="op" id="6551065">!=</span>&nbsp;<span class="ident" id="6551068">nil</span>&nbsp;<span class="op" id="6551072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551077">b</span><span class="op" id="6551078">.</span><span class="ident" id="6551079">Errorf</span><span class="op" id="6551085">(</span><span class="string" id="6551086">&#34;Parse(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6551115">,</span>&nbsp;<span class="ident" id="6551117">tt</span><span class="op" id="6551119">.</span><span class="ident" id="6551120">in</span><span class="op" id="6551122">,</span>&nbsp;<span class="ident" id="6551124">err</span><span class="op" id="6551127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551132">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551143">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551147">if</span>&nbsp;<span class="ident" id="6551150">tt</span><span class="op" id="6551152">.</span><span class="ident" id="6551153">roundtrip</span>&nbsp;<span class="op" id="6551163">==</span>&nbsp;<span class="string" id="6551166">&#34;&#34;</span>&nbsp;<span class="op" id="6551169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551174">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551189">b</span><span class="op" id="6551190">.</span><span class="ident" id="6551191">StartTimer</span><span class="op" id="6551201">(</span><span class="op" id="6551202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551206">var</span>&nbsp;<span class="ident" id="6551210">g</span>&nbsp;<span class="builtintype" id="6551212">string</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551221">for</span>&nbsp;<span class="ident" id="6551225">i</span>&nbsp;<span class="op" id="6551227">:=</span>&nbsp;<span class="num" id="6551230">0</span><span class="op" id="6551231">;</span>&nbsp;<span class="ident" id="6551233">i</span>&nbsp;<span class="op" id="6551235">&lt;</span>&nbsp;<span class="ident" id="6551237">b</span><span class="op" id="6551238">.</span><span class="ident" id="6551239">N</span><span class="op" id="6551240">;</span>&nbsp;<span class="ident" id="6551242">i</span><span class="op" id="6551243">++</span>&nbsp;<span class="op" id="6551246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551251">g</span>&nbsp;<span class="op" id="6551253">=</span>&nbsp;<span class="ident" id="6551255">u</span><span class="op" id="6551256">.</span><span class="ident" id="6551257">String</span><span class="op" id="6551263">(</span><span class="op" id="6551264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551272">b</span><span class="op" id="6551273">.</span><span class="ident" id="6551274">StopTimer</span><span class="op" id="6551283">(</span><span class="op" id="6551284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551288">if</span>&nbsp;<span class="ident" id="6551291">w</span>&nbsp;<span class="op" id="6551293">:=</span>&nbsp;<span class="ident" id="6551296">tt</span><span class="op" id="6551298">.</span><span class="ident" id="6551299">roundtrip</span><span class="op" id="6551308">;</span>&nbsp;<span class="ident" id="6551310">g</span>&nbsp;<span class="op" id="6551312">!=</span>&nbsp;<span class="ident" id="6551315">w</span>&nbsp;<span class="op" id="6551317">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551322">b</span><span class="op" id="6551323">.</span><span class="ident" id="6551324">Errorf</span><span class="op" id="6551330">(</span><span class="string" id="6551331">&#34;Parse(%q).String()&nbsp;==&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6551366">,</span>&nbsp;<span class="ident" id="6551368">tt</span><span class="op" id="6551370">.</span><span class="ident" id="6551371">in</span><span class="op" id="6551373">,</span>&nbsp;<span class="ident" id="6551375">g</span><span class="op" id="6551376">,</span>&nbsp;<span class="ident" id="6551378">w</span><span class="op" id="6551379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551386">}</span><br>
<span class="lineno"></span><span class="op" id="6551388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="6551391">func</span>&nbsp;<span class="ident" id="6551396">TestParse</span><span class="op" id="6551405">(</span><span class="ident" id="6551406">t</span>&nbsp;<span class="op" id="6551408">*</span><span class="ident" id="6551409">testing</span><span class="op" id="6551416">.</span><span class="ident" id="6551417">T</span><span class="op" id="6551418">)</span>&nbsp;<span class="op" id="6551420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551423">DoTest</span><span class="op" id="6551429">(</span><span class="ident" id="6551430">t</span><span class="op" id="6551431">,</span>&nbsp;<span class="ident" id="6551433">Parse</span><span class="op" id="6551438">,</span>&nbsp;<span class="string" id="6551440">&#34;Parse&#34;</span><span class="op" id="6551447">,</span>&nbsp;<span class="ident" id="6551449">urltests</span><span class="op" id="6551457">)</span><br>
<span class="lineno"></span><span class="op" id="6551459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6551462">const</span>&nbsp;<span class="ident" id="6551468">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6551496">=</span>&nbsp;<span class="string" id="6551498">&#34;//not.a.user@not.a.host/just/a/path&#34;</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span><span class="keyword" id="6551537">var</span>&nbsp;<span class="ident" id="6551541">parseRequestURLTests</span>&nbsp;<span class="op" id="6551562">=</span>&nbsp;<span class="op" id="6551564">[</span><span class="op" id="6551565">]</span><span class="keyword" id="6551566">struct</span>&nbsp;<span class="op" id="6551573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551576">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6551590">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551598">expectedValid</span>&nbsp;<span class="builtintype" id="6551612">bool</span><br>
<span class="lineno"></span><span class="op" id="6551617">}</span><span class="op" id="6551618">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551621">{</span><span class="string" id="6551622">&#34;http://foo.com&#34;</span><span class="op" id="6551638">,</span>&nbsp;<span class="builtintype" id="6551640">true</span><span class="op" id="6551644">}</span><span class="op" id="6551645">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551648">{</span><span class="string" id="6551649">&#34;http://foo.com/&#34;</span><span class="op" id="6551666">,</span>&nbsp;<span class="builtintype" id="6551668">true</span><span class="op" id="6551672">}</span><span class="op" id="6551673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551676">{</span><span class="string" id="6551677">&#34;http://foo.com/path&#34;</span><span class="op" id="6551698">,</span>&nbsp;<span class="builtintype" id="6551700">true</span><span class="op" id="6551704">}</span><span class="op" id="6551705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551708">{</span><span class="string" id="6551709">&#34;/&#34;</span><span class="op" id="6551712">,</span>&nbsp;<span class="builtintype" id="6551714">true</span><span class="op" id="6551718">}</span><span class="op" id="6551719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551722">{</span><span class="ident" id="6551723">pathThatLooksSchemeRelative</span><span class="op" id="6551750">,</span>&nbsp;<span class="builtintype" id="6551752">true</span><span class="op" id="6551756">}</span><span class="op" id="6551757">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551760">{</span><span class="string" id="6551761">&#34;//not.a.user@%66%6f%6f.com/just/a/path/also&#34;</span><span class="op" id="6551806">,</span>&nbsp;<span class="builtintype" id="6551808">true</span><span class="op" id="6551812">}</span><span class="op" id="6551813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551816">{</span><span class="string" id="6551817">&#34;foo.html&#34;</span><span class="op" id="6551827">,</span>&nbsp;<span class="builtintype" id="6551829">false</span><span class="op" id="6551834">}</span><span class="op" id="6551835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551838">{</span><span class="string" id="6551839">&#34;../dir/&#34;</span><span class="op" id="6551848">,</span>&nbsp;<span class="builtintype" id="6551850">false</span><span class="op" id="6551855">}</span><span class="op" id="6551856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6551859">{</span><span class="string" id="6551860">&#34;*&#34;</span><span class="op" id="6551863">,</span>&nbsp;<span class="builtintype" id="6551865">true</span><span class="op" id="6551869">}</span><span class="op" id="6551870">,</span><br>
<span class="lineno"></span><span class="op" id="6551872">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="6551875">func</span>&nbsp;<span class="ident" id="6551880">TestParseRequestURI</span><span class="op" id="6551899">(</span><span class="ident" id="6551900">t</span>&nbsp;<span class="op" id="6551902">*</span><span class="ident" id="6551903">testing</span><span class="op" id="6551910">.</span><span class="ident" id="6551911">T</span><span class="op" id="6551912">)</span>&nbsp;<span class="op" id="6551914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6551917">for</span>&nbsp;<span class="ident" id="6551921">_</span><span class="op" id="6551922">,</span>&nbsp;<span class="ident" id="6551924">test</span>&nbsp;<span class="op" id="6551929">:=</span>&nbsp;<span class="keyword" id="6551932">range</span>&nbsp;<span class="ident" id="6551938">parseRequestURLTests</span>&nbsp;<span class="op" id="6551959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6551963">_</span><span class="op" id="6551964">,</span>&nbsp;<span class="ident" id="6551966">err</span>&nbsp;<span class="op" id="6551970">:=</span>&nbsp;<span class="ident" id="6551973">ParseRequestURI</span><span class="op" id="6551988">(</span><span class="ident" id="6551989">test</span><span class="op" id="6551993">.</span><span class="ident" id="6551994">url</span><span class="op" id="6551997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552001">valid</span>&nbsp;<span class="op" id="6552007">:=</span>&nbsp;<span class="ident" id="6552010">err</span>&nbsp;<span class="op" id="6552014">==</span>&nbsp;<span class="ident" id="6552017">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552023">if</span>&nbsp;<span class="ident" id="6552026">valid</span>&nbsp;<span class="op" id="6552032">!=</span>&nbsp;<span class="ident" id="6552035">test</span><span class="op" id="6552039">.</span><span class="ident" id="6552040">expectedValid</span>&nbsp;<span class="op" id="6552054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552059">t</span><span class="op" id="6552060">.</span><span class="ident" id="6552061">Errorf</span><span class="op" id="6552067">(</span><span class="string" id="6552068">&#34;Expected&nbsp;valid=%v&nbsp;for&nbsp;%q;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="6552102">,</span>&nbsp;<span class="ident" id="6552104">test</span><span class="op" id="6552108">.</span><span class="ident" id="6552109">expectedValid</span><span class="op" id="6552122">,</span>&nbsp;<span class="ident" id="6552124">test</span><span class="op" id="6552128">.</span><span class="ident" id="6552129">url</span><span class="op" id="6552132">,</span>&nbsp;<span class="ident" id="6552134">valid</span><span class="op" id="6552139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552150">url</span><span class="op" id="6552153">,</span>&nbsp;<span class="ident" id="6552155">err</span>&nbsp;<span class="op" id="6552159">:=</span>&nbsp;<span class="ident" id="6552162">ParseRequestURI</span><span class="op" id="6552177">(</span><span class="ident" id="6552178">pathThatLooksSchemeRelative</span><span class="op" id="6552205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552208">if</span>&nbsp;<span class="ident" id="6552211">err</span>&nbsp;<span class="op" id="6552215">!=</span>&nbsp;<span class="ident" id="6552218">nil</span>&nbsp;<span class="op" id="6552222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552226">t</span><span class="op" id="6552227">.</span><span class="ident" id="6552228">Fatalf</span><span class="op" id="6552234">(</span><span class="string" id="6552235">&#34;Unexpected&nbsp;error&nbsp;%v&#34;</span><span class="op" id="6552256">,</span>&nbsp;<span class="ident" id="6552258">err</span><span class="op" id="6552261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552267">if</span>&nbsp;<span class="ident" id="6552270">url</span><span class="op" id="6552273">.</span><span class="ident" id="6552274">Path</span>&nbsp;<span class="op" id="6552279">!=</span>&nbsp;<span class="ident" id="6552282">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="6552310">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552314">t</span><span class="op" id="6552315">.</span><span class="ident" id="6552316">Errorf</span><span class="op" id="6552322">(</span><span class="string" id="6552323">&#34;Expected&nbsp;path&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6552349">,</span>&nbsp;<span class="ident" id="6552351">pathThatLooksSchemeRelative</span><span class="op" id="6552378">,</span>&nbsp;<span class="ident" id="6552380">url</span><span class="op" id="6552383">.</span><span class="ident" id="6552384">Path</span><span class="op" id="6552388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552391">}</span><br>
<span class="lineno"></span><span class="op" id="6552393">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6552396">func</span>&nbsp;<span class="ident" id="6552401">DoTestString</span><span class="op" id="6552413">(</span><span class="ident" id="6552414">t</span>&nbsp;<span class="op" id="6552416">*</span><span class="ident" id="6552417">testing</span><span class="op" id="6552424">.</span><span class="ident" id="6552425">T</span><span class="op" id="6552426">,</span>&nbsp;<span class="ident" id="6552428">parse</span>&nbsp;<span class="keyword" id="6552434">func</span><span class="op" id="6552438">(</span><span class="builtintype" id="6552439">string</span><span class="op" id="6552445">)</span>&nbsp;<span class="op" id="6552447">(</span><span class="op" id="6552448">*</span><span class="ident" id="6552449">URL</span><span class="op" id="6552452">,</span>&nbsp;<span class="builtintype" id="6552454">error</span><span class="op" id="6552459">)</span><span class="op" id="6552460">,</span>&nbsp;<span class="ident" id="6552462">name</span>&nbsp;<span class="builtintype" id="6552467">string</span><span class="op" id="6552473">,</span>&nbsp;<span class="ident" id="6552475">tests</span>&nbsp;<span class="op" id="6552481">[</span><span class="op" id="6552482">]</span><span class="ident" id="6552483">URLTest</span><span class="op" id="6552490">)</span>&nbsp;<span class="op" id="6552492">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552495">for</span>&nbsp;<span class="ident" id="6552499">_</span><span class="op" id="6552500">,</span>&nbsp;<span class="ident" id="6552502">tt</span>&nbsp;<span class="op" id="6552505">:=</span>&nbsp;<span class="keyword" id="6552508">range</span>&nbsp;<span class="ident" id="6552514">tests</span>&nbsp;<span class="op" id="6552520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552524">u</span><span class="op" id="6552525">,</span>&nbsp;<span class="ident" id="6552527">err</span>&nbsp;<span class="op" id="6552531">:=</span>&nbsp;<span class="ident" id="6552534">parse</span><span class="op" id="6552539">(</span><span class="ident" id="6552540">tt</span><span class="op" id="6552542">.</span><span class="ident" id="6552543">in</span><span class="op" id="6552545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552549">if</span>&nbsp;<span class="ident" id="6552552">err</span>&nbsp;<span class="op" id="6552556">!=</span>&nbsp;<span class="ident" id="6552559">nil</span>&nbsp;<span class="op" id="6552563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552568">t</span><span class="op" id="6552569">.</span><span class="ident" id="6552570">Errorf</span><span class="op" id="6552576">(</span><span class="string" id="6552577">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="6552603">,</span>&nbsp;<span class="ident" id="6552605">name</span><span class="op" id="6552609">,</span>&nbsp;<span class="ident" id="6552611">tt</span><span class="op" id="6552613">.</span><span class="ident" id="6552614">in</span><span class="op" id="6552616">,</span>&nbsp;<span class="ident" id="6552618">err</span><span class="op" id="6552621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552626">continue</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552641">expected</span>&nbsp;<span class="op" id="6552650">:=</span>&nbsp;<span class="ident" id="6552653">tt</span><span class="op" id="6552655">.</span><span class="ident" id="6552656">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552661">if</span>&nbsp;<span class="builtinfunc" id="6552664">len</span><span class="op" id="6552667">(</span><span class="ident" id="6552668">tt</span><span class="op" id="6552670">.</span><span class="ident" id="6552671">roundtrip</span><span class="op" id="6552680">)</span>&nbsp;<span class="op" id="6552682">&gt;</span>&nbsp;<span class="num" id="6552684">0</span>&nbsp;<span class="op" id="6552686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552691">expected</span>&nbsp;<span class="op" id="6552700">=</span>&nbsp;<span class="ident" id="6552702">tt</span><span class="op" id="6552704">.</span><span class="ident" id="6552705">roundtrip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552717">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552721">s</span>&nbsp;<span class="op" id="6552723">:=</span>&nbsp;<span class="ident" id="6552726">u</span><span class="op" id="6552727">.</span><span class="ident" id="6552728">String</span><span class="op" id="6552734">(</span><span class="op" id="6552735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6552739">if</span>&nbsp;<span class="ident" id="6552742">s</span>&nbsp;<span class="op" id="6552744">!=</span>&nbsp;<span class="ident" id="6552747">expected</span>&nbsp;<span class="op" id="6552756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552761">t</span><span class="op" id="6552762">.</span><span class="ident" id="6552763">Errorf</span><span class="op" id="6552769">(</span><span class="string" id="6552770">&#34;%s(%q).String()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6552807">,</span>&nbsp;<span class="ident" id="6552809">name</span><span class="op" id="6552813">,</span>&nbsp;<span class="ident" id="6552815">tt</span><span class="op" id="6552817">.</span><span class="ident" id="6552818">in</span><span class="op" id="6552820">,</span>&nbsp;<span class="ident" id="6552822">s</span><span class="op" id="6552823">,</span>&nbsp;<span class="ident" id="6552825">expected</span><span class="op" id="6552833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6552840">}</span><br>
<span class="lineno">400</span><span class="op" id="6552842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6552845">func</span>&nbsp;<span class="ident" id="6552850">TestURLString</span><span class="op" id="6552863">(</span><span class="ident" id="6552864">t</span>&nbsp;<span class="op" id="6552866">*</span><span class="ident" id="6552867">testing</span><span class="op" id="6552874">.</span><span class="ident" id="6552875">T</span><span class="op" id="6552876">)</span>&nbsp;<span class="op" id="6552878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552881">DoTestString</span><span class="op" id="6552893">(</span><span class="ident" id="6552894">t</span><span class="op" id="6552895">,</span>&nbsp;<span class="ident" id="6552897">Parse</span><span class="op" id="6552902">,</span>&nbsp;<span class="string" id="6552904">&#34;Parse&#34;</span><span class="op" id="6552911">,</span>&nbsp;<span class="ident" id="6552913">urltests</span><span class="op" id="6552921">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6552925">//&nbsp;no&nbsp;leading&nbsp;slash&nbsp;on&nbsp;path&nbsp;should&nbsp;prepend</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6552969">//&nbsp;slash&nbsp;on&nbsp;String()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6552996">noslash</span>&nbsp;<span class="op" id="6553004">:=</span>&nbsp;<span class="ident" id="6553007">URLTest</span><span class="op" id="6553014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553018">&#34;http://www.google.com/search&#34;</span><span class="op" id="6553048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553052">&amp;</span><span class="ident" id="6553053">URL</span><span class="op" id="6553056">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553061">Scheme</span><span class="op" id="6553067">:</span>&nbsp;<span class="string" id="6553069">&#34;http&#34;</span><span class="op" id="6553075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553080">Host</span><span class="op" id="6553084">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6553088">&#34;www.google.com&#34;</span><span class="op" id="6553104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553109">Path</span><span class="op" id="6553113">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6553117">&#34;search&#34;</span><span class="op" id="6553125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553129">}</span><span class="op" id="6553130">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553134">&#34;&#34;</span><span class="op" id="6553136">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553142">s</span>&nbsp;<span class="op" id="6553144">:=</span>&nbsp;<span class="ident" id="6553147">noslash</span><span class="op" id="6553154">.</span><span class="ident" id="6553155">out</span><span class="op" id="6553158">.</span><span class="ident" id="6553159">String</span><span class="op" id="6553165">(</span><span class="op" id="6553166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553169">if</span>&nbsp;<span class="ident" id="6553172">s</span>&nbsp;<span class="op" id="6553174">!=</span>&nbsp;<span class="ident" id="6553177">noslash</span><span class="op" id="6553184">.</span><span class="ident" id="6553185">in</span>&nbsp;<span class="op" id="6553188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553192">t</span><span class="op" id="6553193">.</span><span class="ident" id="6553194">Errorf</span><span class="op" id="6553200">(</span><span class="string" id="6553201">&#34;Expected&nbsp;%s;&nbsp;go&nbsp;%s&#34;</span><span class="op" id="6553221">,</span>&nbsp;<span class="ident" id="6553223">noslash</span><span class="op" id="6553230">.</span><span class="ident" id="6553231">in</span><span class="op" id="6553233">,</span>&nbsp;<span class="ident" id="6553235">s</span><span class="op" id="6553236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553239">}</span><br>
<span class="lineno">420</span><span class="op" id="6553241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6553244">type</span>&nbsp;<span class="ident" id="6553249">EscapeTest</span>&nbsp;<span class="keyword" id="6553260">struct</span>&nbsp;<span class="op" id="6553267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553270">in</span>&nbsp;&nbsp;<span class="builtintype" id="6553274">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553282">out</span>&nbsp;<span class="builtintype" id="6553286">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553294">err</span>&nbsp;<span class="builtintype" id="6553298">error</span><br>
<span class="lineno"></span><span class="op" id="6553304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6553307">var</span>&nbsp;<span class="ident" id="6553311">unescapeTests</span>&nbsp;<span class="op" id="6553325">=</span>&nbsp;<span class="op" id="6553327">[</span><span class="op" id="6553328">]</span><span class="ident" id="6553329">EscapeTest</span><span class="op" id="6553339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553342">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553346">&#34;&#34;</span><span class="op" id="6553348">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553352">&#34;&#34;</span><span class="op" id="6553354">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553358">nil</span><span class="op" id="6553361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553364">}</span><span class="op" id="6553365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553368">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553372">&#34;abc&#34;</span><span class="op" id="6553377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553381">&#34;abc&#34;</span><span class="op" id="6553386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553390">nil</span><span class="op" id="6553393">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553396">}</span><span class="op" id="6553397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553400">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553404">&#34;1%41&#34;</span><span class="op" id="6553410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553414">&#34;1A&#34;</span><span class="op" id="6553418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553422">nil</span><span class="op" id="6553425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553428">}</span><span class="op" id="6553429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553432">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553436">&#34;1%41%42%43&#34;</span><span class="op" id="6553448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553452">&#34;1ABC&#34;</span><span class="op" id="6553458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553462">nil</span><span class="op" id="6553465">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553468">}</span><span class="op" id="6553469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553472">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553476">&#34;%4a&#34;</span><span class="op" id="6553481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553485">&#34;J&#34;</span><span class="op" id="6553488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553492">nil</span><span class="op" id="6553495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553498">}</span><span class="op" id="6553499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553502">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553506">&#34;%6F&#34;</span><span class="op" id="6553511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553515">&#34;o&#34;</span><span class="op" id="6553518">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553522">nil</span><span class="op" id="6553525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553528">}</span><span class="op" id="6553529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553532">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553536">&#34;%&#34;</span><span class="op" id="6553539">,</span>&nbsp;<span class="comment" id="6553541">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553576">&#34;&#34;</span><span class="op" id="6553578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553582">EscapeError</span><span class="op" id="6553593">(</span><span class="string" id="6553594">&#34;%&#34;</span><span class="op" id="6553597">)</span><span class="op" id="6553598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553601">}</span><span class="op" id="6553602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553605">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553609">&#34;%a&#34;</span><span class="op" id="6553613">,</span>&nbsp;<span class="comment" id="6553615">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553650">&#34;&#34;</span><span class="op" id="6553652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553656">EscapeError</span><span class="op" id="6553667">(</span><span class="string" id="6553668">&#34;%a&#34;</span><span class="op" id="6553672">)</span><span class="op" id="6553673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553676">}</span><span class="op" id="6553677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553680">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553684">&#34;%1&#34;</span><span class="op" id="6553688">,</span>&nbsp;<span class="comment" id="6553690">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553725">&#34;&#34;</span><span class="op" id="6553727">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553731">EscapeError</span><span class="op" id="6553742">(</span><span class="string" id="6553743">&#34;%1&#34;</span><span class="op" id="6553747">)</span><span class="op" id="6553748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553751">}</span><span class="op" id="6553752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553755">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553759">&#34;123%45%6&#34;</span><span class="op" id="6553769">,</span>&nbsp;<span class="comment" id="6553771">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553806">&#34;&#34;</span><span class="op" id="6553808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553812">EscapeError</span><span class="op" id="6553823">(</span><span class="string" id="6553824">&#34;%6&#34;</span><span class="op" id="6553828">)</span><span class="op" id="6553829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553832">}</span><span class="op" id="6553833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553836">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553840">&#34;%zzzzz&#34;</span><span class="op" id="6553848">,</span>&nbsp;<span class="comment" id="6553850">//&nbsp;invalid&nbsp;hex&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6553874">&#34;&#34;</span><span class="op" id="6553876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553880">EscapeError</span><span class="op" id="6553891">(</span><span class="string" id="6553892">&#34;%zz&#34;</span><span class="op" id="6553897">)</span><span class="op" id="6553898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6553901">}</span><span class="op" id="6553902">,</span><br>
<span class="lineno"></span><span class="op" id="6553904">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="6553907">func</span>&nbsp;<span class="ident" id="6553912">TestUnescape</span><span class="op" id="6553924">(</span><span class="ident" id="6553925">t</span>&nbsp;<span class="op" id="6553927">*</span><span class="ident" id="6553928">testing</span><span class="op" id="6553935">.</span><span class="ident" id="6553936">T</span><span class="op" id="6553937">)</span>&nbsp;<span class="op" id="6553939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6553942">for</span>&nbsp;<span class="ident" id="6553946">_</span><span class="op" id="6553947">,</span>&nbsp;<span class="ident" id="6553949">tt</span>&nbsp;<span class="op" id="6553952">:=</span>&nbsp;<span class="keyword" id="6553955">range</span>&nbsp;<span class="ident" id="6553961">unescapeTests</span>&nbsp;<span class="op" id="6553975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6553979">actual</span><span class="op" id="6553985">,</span>&nbsp;<span class="ident" id="6553987">err</span>&nbsp;<span class="op" id="6553991">:=</span>&nbsp;<span class="ident" id="6553994">QueryUnescape</span><span class="op" id="6554007">(</span><span class="ident" id="6554008">tt</span><span class="op" id="6554010">.</span><span class="ident" id="6554011">in</span><span class="op" id="6554013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554017">if</span>&nbsp;<span class="ident" id="6554020">actual</span>&nbsp;<span class="op" id="6554027">!=</span>&nbsp;<span class="ident" id="6554030">tt</span><span class="op" id="6554032">.</span><span class="ident" id="6554033">out</span>&nbsp;<span class="op" id="6554037">||</span>&nbsp;<span class="op" id="6554040">(</span><span class="ident" id="6554041">err</span>&nbsp;<span class="op" id="6554045">!=</span>&nbsp;<span class="ident" id="6554048">nil</span><span class="op" id="6554051">)</span>&nbsp;<span class="op" id="6554053">!=</span>&nbsp;<span class="op" id="6554056">(</span><span class="ident" id="6554057">tt</span><span class="op" id="6554059">.</span><span class="ident" id="6554060">err</span>&nbsp;<span class="op" id="6554064">!=</span>&nbsp;<span class="ident" id="6554067">nil</span><span class="op" id="6554070">)</span>&nbsp;<span class="op" id="6554072">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554077">t</span><span class="op" id="6554078">.</span><span class="ident" id="6554079">Errorf</span><span class="op" id="6554085">(</span><span class="string" id="6554086">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6554127">,</span>&nbsp;<span class="ident" id="6554129">tt</span><span class="op" id="6554131">.</span><span class="ident" id="6554132">in</span><span class="op" id="6554134">,</span>&nbsp;<span class="ident" id="6554136">actual</span><span class="op" id="6554142">,</span>&nbsp;<span class="ident" id="6554144">err</span><span class="op" id="6554147">,</span>&nbsp;<span class="ident" id="6554149">tt</span><span class="op" id="6554151">.</span><span class="ident" id="6554152">out</span><span class="op" id="6554155">,</span>&nbsp;<span class="ident" id="6554157">tt</span><span class="op" id="6554159">.</span><span class="ident" id="6554160">err</span><span class="op" id="6554163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554170">}</span><br>
<span class="lineno"></span><span class="op" id="6554172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="keyword" id="6554175">var</span>&nbsp;<span class="ident" id="6554179">escapeTests</span>&nbsp;<span class="op" id="6554191">=</span>&nbsp;<span class="op" id="6554193">[</span><span class="op" id="6554194">]</span><span class="ident" id="6554195">EscapeTest</span><span class="op" id="6554205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554212">&#34;&#34;</span><span class="op" id="6554214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554218">&#34;&#34;</span><span class="op" id="6554220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554224">nil</span><span class="op" id="6554227">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554230">}</span><span class="op" id="6554231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554238">&#34;abc&#34;</span><span class="op" id="6554243">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554247">&#34;abc&#34;</span><span class="op" id="6554252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554256">nil</span><span class="op" id="6554259">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554262">}</span><span class="op" id="6554263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554270">&#34;one&nbsp;two&#34;</span><span class="op" id="6554279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554283">&#34;one+two&#34;</span><span class="op" id="6554292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554296">nil</span><span class="op" id="6554299">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554302">}</span><span class="op" id="6554303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554310">&#34;10%&#34;</span><span class="op" id="6554315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554319">&#34;10%25&#34;</span><span class="op" id="6554326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554330">nil</span><span class="op" id="6554333">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554336">}</span><span class="op" id="6554337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554344">&#34;&nbsp;?&amp;=#+%!&lt;&gt;#\&#34;{}|\\^[]`☺\t:/@$&#39;()*,;&#34;</span><span class="op" id="6554383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6554387">&#34;+%3F%26%3D%23%2B%25%21%3C%3E%23%22%7B%7D%7C%5C%5E%5B%5D%60%E2%98%BA%09%3A%2F%40%24%27%28%29%2A%2C%3B&#34;</span><span class="op" id="6554489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554493">nil</span><span class="op" id="6554496">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554499">}</span><span class="op" id="6554500">,</span><br>
<span class="lineno"></span><span class="op" id="6554502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6554505">func</span>&nbsp;<span class="ident" id="6554510">TestEscape</span><span class="op" id="6554520">(</span><span class="ident" id="6554521">t</span>&nbsp;<span class="op" id="6554523">*</span><span class="ident" id="6554524">testing</span><span class="op" id="6554531">.</span><span class="ident" id="6554532">T</span><span class="op" id="6554533">)</span>&nbsp;<span class="op" id="6554535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554538">for</span>&nbsp;<span class="ident" id="6554542">_</span><span class="op" id="6554543">,</span>&nbsp;<span class="ident" id="6554545">tt</span>&nbsp;<span class="op" id="6554548">:=</span>&nbsp;<span class="keyword" id="6554551">range</span>&nbsp;<span class="ident" id="6554557">escapeTests</span>&nbsp;<span class="op" id="6554569">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554573">actual</span>&nbsp;<span class="op" id="6554580">:=</span>&nbsp;<span class="ident" id="6554583">QueryEscape</span><span class="op" id="6554594">(</span><span class="ident" id="6554595">tt</span><span class="op" id="6554597">.</span><span class="ident" id="6554598">in</span><span class="op" id="6554600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554604">if</span>&nbsp;<span class="ident" id="6554607">tt</span><span class="op" id="6554609">.</span><span class="ident" id="6554610">out</span>&nbsp;<span class="op" id="6554614">!=</span>&nbsp;<span class="ident" id="6554617">actual</span>&nbsp;<span class="op" id="6554624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554629">t</span><span class="op" id="6554630">.</span><span class="ident" id="6554631">Errorf</span><span class="op" id="6554637">(</span><span class="string" id="6554638">&#34;QueryEscape(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6554669">,</span>&nbsp;<span class="ident" id="6554671">tt</span><span class="op" id="6554673">.</span><span class="ident" id="6554674">in</span><span class="op" id="6554676">,</span>&nbsp;<span class="ident" id="6554678">actual</span><span class="op" id="6554684">,</span>&nbsp;<span class="ident" id="6554686">tt</span><span class="op" id="6554688">.</span><span class="ident" id="6554689">out</span><span class="op" id="6554692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554696">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6554701">//&nbsp;for&nbsp;bonus&nbsp;points,&nbsp;verify&nbsp;that&nbsp;escape:unescape&nbsp;is&nbsp;an&nbsp;identity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554768">roundtrip</span><span class="op" id="6554777">,</span>&nbsp;<span class="ident" id="6554779">err</span>&nbsp;<span class="op" id="6554783">:=</span>&nbsp;<span class="ident" id="6554786">QueryUnescape</span><span class="op" id="6554799">(</span><span class="ident" id="6554800">actual</span><span class="op" id="6554806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6554810">if</span>&nbsp;<span class="ident" id="6554813">roundtrip</span>&nbsp;<span class="op" id="6554823">!=</span>&nbsp;<span class="ident" id="6554826">tt</span><span class="op" id="6554828">.</span><span class="ident" id="6554829">in</span>&nbsp;<span class="op" id="6554832">||</span>&nbsp;<span class="ident" id="6554835">err</span>&nbsp;<span class="op" id="6554839">!=</span>&nbsp;<span class="ident" id="6554842">nil</span>&nbsp;<span class="op" id="6554846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6554851">t</span><span class="op" id="6554852">.</span><span class="ident" id="6554853">Errorf</span><span class="op" id="6554859">(</span><span class="string" id="6554860">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="6554901">,</span>&nbsp;<span class="ident" id="6554903">actual</span><span class="op" id="6554909">,</span>&nbsp;<span class="ident" id="6554911">roundtrip</span><span class="op" id="6554920">,</span>&nbsp;<span class="ident" id="6554922">err</span><span class="op" id="6554925">,</span>&nbsp;<span class="ident" id="6554927">tt</span><span class="op" id="6554929">.</span><span class="ident" id="6554930">in</span><span class="op" id="6554932">,</span>&nbsp;<span class="string" id="6554934">&#34;[no&nbsp;error]&#34;</span><span class="op" id="6554946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554950">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6554953">}</span><br>
<span class="lineno"></span><span class="op" id="6554955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6554958">//var&nbsp;userinfoTests&nbsp;=&nbsp;[]UserinfoTest{</span><br>
<span class="lineno"></span><span class="comment" id="6554996">//&nbsp;&nbsp;&nbsp;&nbsp{&#34;user&#34;,&nbsp;&#34;password&#34;,&nbsp;&#34;user:password&#34;},</span><br>
<span class="lineno">540</span><span class="comment" id="6555038">//&nbsp;&nbsp;&nbsp;&nbsp{&#34;foo:bar&#34;,&nbsp;&#34;~!@#$%^&amp;*()_+{}|[]\\-=`:;&#39;\&#34;&lt;&gt;?,./&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="6555091">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&#34;foo%3Abar:~!%40%23$%25%5E&amp;*()_+%7B%7D%7C%5B%5D%5C-=%60%3A;&#39;%22%3C%3E?,.%2F&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="6555174">//}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555179">type</span>&nbsp;<span class="ident" id="6555184">EncodeQueryTest</span>&nbsp;<span class="keyword" id="6555200">struct</span>&nbsp;<span class="op" id="6555207">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555210">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6555219">Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555227">expected</span>&nbsp;<span class="builtintype" id="6555236">string</span><br>
<span class="lineno"></span><span class="op" id="6555243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555246">var</span>&nbsp;<span class="ident" id="6555250">encodeQueryTests</span>&nbsp;<span class="op" id="6555267">=</span>&nbsp;<span class="op" id="6555269">[</span><span class="op" id="6555270">]</span><span class="ident" id="6555271">EncodeQueryTest</span><span class="op" id="6555286">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555289">{</span><span class="ident" id="6555290">nil</span><span class="op" id="6555293">,</span>&nbsp;<span class="string" id="6555295">&#34;&#34;</span><span class="op" id="6555297">}</span><span class="op" id="6555298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555301">{</span><span class="ident" id="6555302">Values</span><span class="op" id="6555308">{</span><span class="string" id="6555309">&#34;q&#34;</span><span class="op" id="6555312">:</span>&nbsp;<span class="op" id="6555314">{</span><span class="string" id="6555315">&#34;puppies&#34;</span><span class="op" id="6555324">}</span><span class="op" id="6555325">,</span>&nbsp;<span class="string" id="6555327">&#34;oe&#34;</span><span class="op" id="6555331">:</span>&nbsp;<span class="op" id="6555333">{</span><span class="string" id="6555334">&#34;utf8&#34;</span><span class="op" id="6555340">}</span><span class="op" id="6555341">}</span><span class="op" id="6555342">,</span>&nbsp;<span class="string" id="6555344">&#34;oe=utf8&amp;q=puppies&#34;</span><span class="op" id="6555363">}</span><span class="op" id="6555364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555367">{</span><span class="ident" id="6555368">Values</span><span class="op" id="6555374">{</span><span class="string" id="6555375">&#34;q&#34;</span><span class="op" id="6555378">:</span>&nbsp;<span class="op" id="6555380">{</span><span class="string" id="6555381">&#34;dogs&#34;</span><span class="op" id="6555387">,</span>&nbsp;<span class="string" id="6555389">&#34;&amp;&#34;</span><span class="op" id="6555392">,</span>&nbsp;<span class="string" id="6555394">&#34;7&#34;</span><span class="op" id="6555397">}</span><span class="op" id="6555398">}</span><span class="op" id="6555399">,</span>&nbsp;<span class="string" id="6555401">&#34;q=dogs&amp;q=%26&amp;q=7&#34;</span><span class="op" id="6555419">}</span><span class="op" id="6555420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555423">{</span><span class="ident" id="6555424">Values</span><span class="op" id="6555430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555434">&#34;a&#34;</span><span class="op" id="6555437">:</span>&nbsp;<span class="op" id="6555439">{</span><span class="string" id="6555440">&#34;a1&#34;</span><span class="op" id="6555444">,</span>&nbsp;<span class="string" id="6555446">&#34;a2&#34;</span><span class="op" id="6555450">,</span>&nbsp;<span class="string" id="6555452">&#34;a3&#34;</span><span class="op" id="6555456">}</span><span class="op" id="6555457">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555461">&#34;b&#34;</span><span class="op" id="6555464">:</span>&nbsp;<span class="op" id="6555466">{</span><span class="string" id="6555467">&#34;b1&#34;</span><span class="op" id="6555471">,</span>&nbsp;<span class="string" id="6555473">&#34;b2&#34;</span><span class="op" id="6555477">,</span>&nbsp;<span class="string" id="6555479">&#34;b3&#34;</span><span class="op" id="6555483">}</span><span class="op" id="6555484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6555488">&#34;c&#34;</span><span class="op" id="6555491">:</span>&nbsp;<span class="op" id="6555493">{</span><span class="string" id="6555494">&#34;c1&#34;</span><span class="op" id="6555498">,</span>&nbsp;<span class="string" id="6555500">&#34;c2&#34;</span><span class="op" id="6555504">,</span>&nbsp;<span class="string" id="6555506">&#34;c3&#34;</span><span class="op" id="6555510">}</span><span class="op" id="6555511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555514">}</span><span class="op" id="6555515">,</span>&nbsp;<span class="string" id="6555517">&#34;a=a1&amp;a=a2&amp;a=a3&amp;b=b1&amp;b=b2&amp;b=b3&amp;c=c1&amp;c=c2&amp;c=c3&#34;</span><span class="op" id="6555563">}</span><span class="op" id="6555564">,</span><br>
<span class="lineno"></span><span class="op" id="6555566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="6555569">func</span>&nbsp;<span class="ident" id="6555574">TestEncodeQuery</span><span class="op" id="6555589">(</span><span class="ident" id="6555590">t</span>&nbsp;<span class="op" id="6555592">*</span><span class="ident" id="6555593">testing</span><span class="op" id="6555600">.</span><span class="ident" id="6555601">T</span><span class="op" id="6555602">)</span>&nbsp;<span class="op" id="6555604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555607">for</span>&nbsp;<span class="ident" id="6555611">_</span><span class="op" id="6555612">,</span>&nbsp;<span class="ident" id="6555614">tt</span>&nbsp;<span class="op" id="6555617">:=</span>&nbsp;<span class="keyword" id="6555620">range</span>&nbsp;<span class="ident" id="6555626">encodeQueryTests</span>&nbsp;<span class="op" id="6555643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6555647">if</span>&nbsp;<span class="ident" id="6555650">q</span>&nbsp;<span class="op" id="6555652">:=</span>&nbsp;<span class="ident" id="6555655">tt</span><span class="op" id="6555657">.</span><span class="ident" id="6555658">m</span><span class="op" id="6555659">.</span><span class="ident" id="6555660">Encode</span><span class="op" id="6555666">(</span><span class="op" id="6555667">)</span><span class="op" id="6555668">;</span>&nbsp;<span class="ident" id="6555670">q</span>&nbsp;<span class="op" id="6555672">!=</span>&nbsp;<span class="ident" id="6555675">tt</span><span class="op" id="6555677">.</span><span class="ident" id="6555678">expected</span>&nbsp;<span class="op" id="6555687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555692">t</span><span class="op" id="6555693">.</span><span class="ident" id="6555694">Errorf</span><span class="op" id="6555700">(</span><span class="string" id="6555701">`EncodeQuery(%+v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q`</span><span class="op" id="6555733">,</span>&nbsp;<span class="ident" id="6555735">tt</span><span class="op" id="6555737">.</span><span class="ident" id="6555738">m</span><span class="op" id="6555739">,</span>&nbsp;<span class="ident" id="6555741">q</span><span class="op" id="6555742">,</span>&nbsp;<span class="ident" id="6555744">tt</span><span class="op" id="6555746">.</span><span class="ident" id="6555747">expected</span><span class="op" id="6555755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555759">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555762">}</span><br>
<span class="lineno"></span><span class="op" id="6555764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6555767">var</span>&nbsp;<span class="ident" id="6555771">resolvePathTests</span>&nbsp;<span class="op" id="6555788">=</span>&nbsp;<span class="op" id="6555790">[</span><span class="op" id="6555791">]</span><span class="keyword" id="6555792">struct</span>&nbsp;<span class="op" id="6555799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6555802">base</span><span class="op" id="6555806">,</span>&nbsp;<span class="ident" id="6555808">ref</span><span class="op" id="6555811">,</span>&nbsp;<span class="ident" id="6555813">expected</span>&nbsp;<span class="builtintype" id="6555822">string</span><br>
<span class="lineno">570</span><span class="op" id="6555829">}</span><span class="op" id="6555830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555833">{</span><span class="string" id="6555834">&#34;a/b&#34;</span><span class="op" id="6555839">,</span>&nbsp;<span class="string" id="6555841">&#34;.&#34;</span><span class="op" id="6555844">,</span>&nbsp;<span class="string" id="6555846">&#34;/a/&#34;</span><span class="op" id="6555851">}</span><span class="op" id="6555852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555855">{</span><span class="string" id="6555856">&#34;a/b&#34;</span><span class="op" id="6555861">,</span>&nbsp;<span class="string" id="6555863">&#34;c&#34;</span><span class="op" id="6555866">,</span>&nbsp;<span class="string" id="6555868">&#34;/a/c&#34;</span><span class="op" id="6555874">}</span><span class="op" id="6555875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555878">{</span><span class="string" id="6555879">&#34;a/b&#34;</span><span class="op" id="6555884">,</span>&nbsp;<span class="string" id="6555886">&#34;..&#34;</span><span class="op" id="6555890">,</span>&nbsp;<span class="string" id="6555892">&#34;/&#34;</span><span class="op" id="6555895">}</span><span class="op" id="6555896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555899">{</span><span class="string" id="6555900">&#34;a/&#34;</span><span class="op" id="6555904">,</span>&nbsp;<span class="string" id="6555906">&#34;..&#34;</span><span class="op" id="6555910">,</span>&nbsp;<span class="string" id="6555912">&#34;/&#34;</span><span class="op" id="6555915">}</span><span class="op" id="6555916">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555919">{</span><span class="string" id="6555920">&#34;a/&#34;</span><span class="op" id="6555924">,</span>&nbsp;<span class="string" id="6555926">&#34;../..&#34;</span><span class="op" id="6555933">,</span>&nbsp;<span class="string" id="6555935">&#34;/&#34;</span><span class="op" id="6555938">}</span><span class="op" id="6555939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555942">{</span><span class="string" id="6555943">&#34;a/b/c&#34;</span><span class="op" id="6555950">,</span>&nbsp;<span class="string" id="6555952">&#34;..&#34;</span><span class="op" id="6555956">,</span>&nbsp;<span class="string" id="6555958">&#34;/a/&#34;</span><span class="op" id="6555963">}</span><span class="op" id="6555964">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555967">{</span><span class="string" id="6555968">&#34;a/b/c&#34;</span><span class="op" id="6555975">,</span>&nbsp;<span class="string" id="6555977">&#34;../d&#34;</span><span class="op" id="6555983">,</span>&nbsp;<span class="string" id="6555985">&#34;/a/d&#34;</span><span class="op" id="6555991">}</span><span class="op" id="6555992">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6555995">{</span><span class="string" id="6555996">&#34;a/b/c&#34;</span><span class="op" id="6556003">,</span>&nbsp;<span class="string" id="6556005">&#34;.././d&#34;</span><span class="op" id="6556013">,</span>&nbsp;<span class="string" id="6556015">&#34;/a/d&#34;</span><span class="op" id="6556021">}</span><span class="op" id="6556022">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556025">{</span><span class="string" id="6556026">&#34;a/b&#34;</span><span class="op" id="6556031">,</span>&nbsp;<span class="string" id="6556033">&#34;./..&#34;</span><span class="op" id="6556039">,</span>&nbsp;<span class="string" id="6556041">&#34;/&#34;</span><span class="op" id="6556044">}</span><span class="op" id="6556045">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556048">{</span><span class="string" id="6556049">&#34;a/./b&#34;</span><span class="op" id="6556056">,</span>&nbsp;<span class="string" id="6556058">&#34;.&#34;</span><span class="op" id="6556061">,</span>&nbsp;<span class="string" id="6556063">&#34;/a/&#34;</span><span class="op" id="6556068">}</span><span class="op" id="6556069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556072">{</span><span class="string" id="6556073">&#34;a/../&#34;</span><span class="op" id="6556080">,</span>&nbsp;<span class="string" id="6556082">&#34;.&#34;</span><span class="op" id="6556085">,</span>&nbsp;<span class="string" id="6556087">&#34;/&#34;</span><span class="op" id="6556090">}</span><span class="op" id="6556091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556094">{</span><span class="string" id="6556095">&#34;a/.././b&#34;</span><span class="op" id="6556105">,</span>&nbsp;<span class="string" id="6556107">&#34;c&#34;</span><span class="op" id="6556110">,</span>&nbsp;<span class="string" id="6556112">&#34;/c&#34;</span><span class="op" id="6556116">}</span><span class="op" id="6556117">,</span><br>
<span class="lineno"></span><span class="op" id="6556119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="6556122">func</span>&nbsp;<span class="ident" id="6556127">TestResolvePath</span><span class="op" id="6556142">(</span><span class="ident" id="6556143">t</span>&nbsp;<span class="op" id="6556145">*</span><span class="ident" id="6556146">testing</span><span class="op" id="6556153">.</span><span class="ident" id="6556154">T</span><span class="op" id="6556155">)</span>&nbsp;<span class="op" id="6556157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556160">for</span>&nbsp;<span class="ident" id="6556164">_</span><span class="op" id="6556165">,</span>&nbsp;<span class="ident" id="6556167">test</span>&nbsp;<span class="op" id="6556172">:=</span>&nbsp;<span class="keyword" id="6556175">range</span>&nbsp;<span class="ident" id="6556181">resolvePathTests</span>&nbsp;<span class="op" id="6556198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556202">got</span>&nbsp;<span class="op" id="6556206">:=</span>&nbsp;<span class="ident" id="6556209">resolvePath</span><span class="op" id="6556220">(</span><span class="ident" id="6556221">test</span><span class="op" id="6556225">.</span><span class="ident" id="6556226">base</span><span class="op" id="6556230">,</span>&nbsp;<span class="ident" id="6556232">test</span><span class="op" id="6556236">.</span><span class="ident" id="6556237">ref</span><span class="op" id="6556240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6556244">if</span>&nbsp;<span class="ident" id="6556247">got</span>&nbsp;<span class="op" id="6556251">!=</span>&nbsp;<span class="ident" id="6556254">test</span><span class="op" id="6556258">.</span><span class="ident" id="6556259">expected</span>&nbsp;<span class="op" id="6556268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556273">t</span><span class="op" id="6556274">.</span><span class="ident" id="6556275">Errorf</span><span class="op" id="6556281">(</span><span class="string" id="6556282">&#34;For&nbsp;%q&nbsp;+&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6556315">,</span>&nbsp;<span class="ident" id="6556317">test</span><span class="op" id="6556321">.</span><span class="ident" id="6556322">base</span><span class="op" id="6556326">,</span>&nbsp;<span class="ident" id="6556328">test</span><span class="op" id="6556332">.</span><span class="ident" id="6556333">ref</span><span class="op" id="6556336">,</span>&nbsp;<span class="ident" id="6556338">got</span><span class="op" id="6556341">,</span>&nbsp;<span class="ident" id="6556343">test</span><span class="op" id="6556347">.</span><span class="ident" id="6556348">expected</span><span class="op" id="6556356">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556363">}</span><br>
<span class="lineno"></span><span class="op" id="6556365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6556368">var</span>&nbsp;<span class="ident" id="6556372">resolveReferenceTests</span>&nbsp;<span class="op" id="6556394">=</span>&nbsp;<span class="op" id="6556396">[</span><span class="op" id="6556397">]</span><span class="keyword" id="6556398">struct</span>&nbsp;<span class="op" id="6556405">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6556408">base</span><span class="op" id="6556412">,</span>&nbsp;<span class="ident" id="6556414">rel</span><span class="op" id="6556417">,</span>&nbsp;<span class="ident" id="6556419">expected</span>&nbsp;<span class="builtintype" id="6556428">string</span><br>
<span class="lineno"></span><span class="op" id="6556435">}</span><span class="op" id="6556436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6556439">//&nbsp;Absolute&nbsp;URL&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556467">{</span><span class="string" id="6556468">&#34;http://foo.com?a=b&#34;</span><span class="op" id="6556488">,</span>&nbsp;<span class="string" id="6556490">&#34;https://bar.com/&#34;</span><span class="op" id="6556508">,</span>&nbsp;<span class="string" id="6556510">&#34;https://bar.com/&#34;</span><span class="op" id="6556528">}</span><span class="op" id="6556529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556532">{</span><span class="string" id="6556533">&#34;http://foo.com/&#34;</span><span class="op" id="6556550">,</span>&nbsp;<span class="string" id="6556552">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6556574">,</span>&nbsp;<span class="string" id="6556576">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="6556598">}</span><span class="op" id="6556599">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556602">{</span><span class="string" id="6556603">&#34;http://foo.com/bar&#34;</span><span class="op" id="6556623">,</span>&nbsp;<span class="string" id="6556625">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6556649">,</span>&nbsp;<span class="string" id="6556651">&#34;mailto:foo@example.com&#34;</span><span class="op" id="6556675">}</span><span class="op" id="6556676">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6556680">//&nbsp;Path-absolute&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556709">{</span><span class="string" id="6556710">&#34;http://foo.com/bar&#34;</span><span class="op" id="6556730">,</span>&nbsp;<span class="string" id="6556732">&#34;/baz&#34;</span><span class="op" id="6556738">,</span>&nbsp;<span class="string" id="6556740">&#34;http://foo.com/baz&#34;</span><span class="op" id="6556760">}</span><span class="op" id="6556761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556764">{</span><span class="string" id="6556765">&#34;http://foo.com/bar?a=b#f&#34;</span><span class="op" id="6556791">,</span>&nbsp;<span class="string" id="6556793">&#34;/baz&#34;</span><span class="op" id="6556799">,</span>&nbsp;<span class="string" id="6556801">&#34;http://foo.com/baz&#34;</span><span class="op" id="6556821">}</span><span class="op" id="6556822">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556825">{</span><span class="string" id="6556826">&#34;http://foo.com/bar?a=b&#34;</span><span class="op" id="6556850">,</span>&nbsp;<span class="string" id="6556852">&#34;/baz?c=d&#34;</span><span class="op" id="6556862">,</span>&nbsp;<span class="string" id="6556864">&#34;http://foo.com/baz?c=d&#34;</span><span class="op" id="6556888">}</span><span class="op" id="6556889">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6556893">//&nbsp;Scheme-relative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6556913">{</span><span class="string" id="6556914">&#34;https://foo.com/bar?a=b&#34;</span><span class="op" id="6556939">,</span>&nbsp;<span class="string" id="6556941">&#34;//bar.com/quux&#34;</span><span class="op" id="6556957">,</span>&nbsp;<span class="string" id="6556959">&#34;https://bar.com/quux&#34;</span><span class="op" id="6556981">}</span><span class="op" id="6556982">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6556986">//&nbsp;Path-relative&nbsp;references:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6557017">//&nbsp;...&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557043">{</span><span class="string" id="6557044">&#34;http://foo.com&#34;</span><span class="op" id="6557060">,</span>&nbsp;<span class="string" id="6557062">&#34;.&#34;</span><span class="op" id="6557065">,</span>&nbsp;<span class="string" id="6557067">&#34;http://foo.com/&#34;</span><span class="op" id="6557084">}</span><span class="op" id="6557085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557088">{</span><span class="string" id="6557089">&#34;http://foo.com/bar&#34;</span><span class="op" id="6557109">,</span>&nbsp;<span class="string" id="6557111">&#34;.&#34;</span><span class="op" id="6557114">,</span>&nbsp;<span class="string" id="6557116">&#34;http://foo.com/&#34;</span><span class="op" id="6557133">}</span><span class="op" id="6557134">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557137">{</span><span class="string" id="6557138">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6557159">,</span>&nbsp;<span class="string" id="6557161">&#34;.&#34;</span><span class="op" id="6557164">,</span>&nbsp;<span class="string" id="6557166">&#34;http://foo.com/bar/&#34;</span><span class="op" id="6557187">}</span><span class="op" id="6557188">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6557192">//&nbsp;...&nbsp;going&nbsp;down</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557211">{</span><span class="string" id="6557212">&#34;http://foo.com&#34;</span><span class="op" id="6557228">,</span>&nbsp;<span class="string" id="6557230">&#34;bar&#34;</span><span class="op" id="6557235">,</span>&nbsp;<span class="string" id="6557237">&#34;http://foo.com/bar&#34;</span><span class="op" id="6557257">}</span><span class="op" id="6557258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557261">{</span><span class="string" id="6557262">&#34;http://foo.com/&#34;</span><span class="op" id="6557279">,</span>&nbsp;<span class="string" id="6557281">&#34;bar&#34;</span><span class="op" id="6557286">,</span>&nbsp;<span class="string" id="6557288">&#34;http://foo.com/bar&#34;</span><span class="op" id="6557308">}</span><span class="op" id="6557309">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557312">{</span><span class="string" id="6557313">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557337">,</span>&nbsp;<span class="string" id="6557339">&#34;quux&#34;</span><span class="op" id="6557345">,</span>&nbsp;<span class="string" id="6557347">&#34;http://foo.com/bar/quux&#34;</span><span class="op" id="6557372">}</span><span class="op" id="6557373">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6557377">//&nbsp;...&nbsp;going&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557394">{</span><span class="string" id="6557395">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557419">,</span>&nbsp;<span class="string" id="6557421">&#34;../quux&#34;</span><span class="op" id="6557430">,</span>&nbsp;<span class="string" id="6557432">&#34;http://foo.com/quux&#34;</span><span class="op" id="6557453">}</span><span class="op" id="6557454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557457">{</span><span class="string" id="6557458">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557482">,</span>&nbsp;<span class="string" id="6557484">&#34;../../../../../quux&#34;</span><span class="op" id="6557505">,</span>&nbsp;<span class="string" id="6557507">&#34;http://foo.com/quux&#34;</span><span class="op" id="6557528">}</span><span class="op" id="6557529">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557532">{</span><span class="string" id="6557533">&#34;http://foo.com/bar&#34;</span><span class="op" id="6557553">,</span>&nbsp;<span class="string" id="6557555">&#34;..&#34;</span><span class="op" id="6557559">,</span>&nbsp;<span class="string" id="6557561">&#34;http://foo.com/&#34;</span><span class="op" id="6557578">}</span><span class="op" id="6557579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557582">{</span><span class="string" id="6557583">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557607">,</span>&nbsp;<span class="string" id="6557609">&#34;./..&#34;</span><span class="op" id="6557615">,</span>&nbsp;<span class="string" id="6557617">&#34;http://foo.com/&#34;</span><span class="op" id="6557634">}</span><span class="op" id="6557635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6557638">//&nbsp;&#34;..&#34;&nbsp;in&nbsp;the&nbsp;middle&nbsp;(issue&nbsp;3560)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557674">{</span><span class="string" id="6557675">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557699">,</span>&nbsp;<span class="string" id="6557701">&#34;quux/dotdot/../tail&#34;</span><span class="op" id="6557722">,</span>&nbsp;<span class="string" id="6557724">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6557754">}</span><span class="op" id="6557755">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557758">{</span><span class="string" id="6557759">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557783">,</span>&nbsp;<span class="string" id="6557785">&#34;quux/./dotdot/../tail&#34;</span><span class="op" id="6557808">,</span>&nbsp;<span class="string" id="6557810">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6557840">}</span><span class="op" id="6557841">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557844">{</span><span class="string" id="6557845">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557869">,</span>&nbsp;<span class="string" id="6557871">&#34;quux/./dotdot/.././tail&#34;</span><span class="op" id="6557896">,</span>&nbsp;<span class="string" id="6557898">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6557928">}</span><span class="op" id="6557929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6557932">{</span><span class="string" id="6557933">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6557957">,</span>&nbsp;<span class="string" id="6557959">&#34;quux/./dotdot/./../tail&#34;</span><span class="op" id="6557984">,</span>&nbsp;<span class="string" id="6557986">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6558016">}</span><span class="op" id="6558017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558020">{</span><span class="string" id="6558021">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6558045">,</span>&nbsp;<span class="string" id="6558047">&#34;quux/./dotdot/dotdot/././../../tail&#34;</span><span class="op" id="6558084">,</span>&nbsp;<span class="string" id="6558086">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6558116">}</span><span class="op" id="6558117">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558120">{</span><span class="string" id="6558121">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6558145">,</span>&nbsp;<span class="string" id="6558147">&#34;quux/./dotdot/dotdot/./.././../tail&#34;</span><span class="op" id="6558184">,</span>&nbsp;<span class="string" id="6558186">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6558216">}</span><span class="op" id="6558217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558220">{</span><span class="string" id="6558221">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6558245">,</span>&nbsp;<span class="string" id="6558247">&#34;quux/./dotdot/dotdot/dotdot/./../../.././././tail&#34;</span><span class="op" id="6558298">,</span>&nbsp;<span class="string" id="6558300">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="6558330">}</span><span class="op" id="6558331">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558334">{</span><span class="string" id="6558335">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="6558359">,</span>&nbsp;<span class="string" id="6558361">&#34;quux/./dotdot/../dotdot/../dot/./tail/..&#34;</span><span class="op" id="6558403">,</span>&nbsp;<span class="string" id="6558405">&#34;http://foo.com/bar/quux/dot/&#34;</span><span class="op" id="6558435">}</span><span class="op" id="6558436">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558440">//&nbsp;Remove&nbsp;any&nbsp;dot-segments&nbsp;prior&nbsp;to&nbsp;forming&nbsp;the&nbsp;target&nbsp;URI.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558501">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558554">{</span><span class="string" id="6558555">&#34;http://foo.com/dot/./dotdot/../foo/bar&#34;</span><span class="op" id="6558595">,</span>&nbsp;<span class="string" id="6558597">&#34;../baz&#34;</span><span class="op" id="6558605">,</span>&nbsp;<span class="string" id="6558607">&#34;http://foo.com/dot/baz&#34;</span><span class="op" id="6558631">}</span><span class="op" id="6558632">,</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558636">//&nbsp;Triple&nbsp;dot&nbsp;isn&#39;t&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558665">{</span><span class="string" id="6558666">&#34;http://foo.com/bar&#34;</span><span class="op" id="6558686">,</span>&nbsp;<span class="string" id="6558688">&#34;...&#34;</span><span class="op" id="6558693">,</span>&nbsp;<span class="string" id="6558695">&#34;http://foo.com/...&#34;</span><span class="op" id="6558715">}</span><span class="op" id="6558716">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558720">//&nbsp;Fragment</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558733">{</span><span class="string" id="6558734">&#34;http://foo.com/bar&#34;</span><span class="op" id="6558754">,</span>&nbsp;<span class="string" id="6558756">&#34;.#frag&#34;</span><span class="op" id="6558764">,</span>&nbsp;<span class="string" id="6558766">&#34;http://foo.com/#frag&#34;</span><span class="op" id="6558788">}</span><span class="op" id="6558789">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558793">//&nbsp;RFC&nbsp;3986:&nbsp;Normal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6558823">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558876">{</span><span class="string" id="6558877">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6558897">,</span>&nbsp;<span class="string" id="6558899">&#34;g:h&#34;</span><span class="op" id="6558904">,</span>&nbsp;<span class="string" id="6558906">&#34;g:h&#34;</span><span class="op" id="6558911">}</span><span class="op" id="6558912">,</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558915">{</span><span class="string" id="6558916">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6558936">,</span>&nbsp;<span class="string" id="6558938">&#34;g&#34;</span><span class="op" id="6558941">,</span>&nbsp;<span class="string" id="6558943">&#34;http://a/b/c/g&#34;</span><span class="op" id="6558959">}</span><span class="op" id="6558960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6558963">{</span><span class="string" id="6558964">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6558984">,</span>&nbsp;<span class="string" id="6558986">&#34;./g&#34;</span><span class="op" id="6558991">,</span>&nbsp;<span class="string" id="6558993">&#34;http://a/b/c/g&#34;</span><span class="op" id="6559009">}</span><span class="op" id="6559010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559013">{</span><span class="string" id="6559014">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559034">,</span>&nbsp;<span class="string" id="6559036">&#34;g/&#34;</span><span class="op" id="6559040">,</span>&nbsp;<span class="string" id="6559042">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6559059">}</span><span class="op" id="6559060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559063">{</span><span class="string" id="6559064">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559084">,</span>&nbsp;<span class="string" id="6559086">&#34;/g&#34;</span><span class="op" id="6559090">,</span>&nbsp;<span class="string" id="6559092">&#34;http://a/g&#34;</span><span class="op" id="6559104">}</span><span class="op" id="6559105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559108">{</span><span class="string" id="6559109">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559129">,</span>&nbsp;<span class="string" id="6559131">&#34;//g&#34;</span><span class="op" id="6559136">,</span>&nbsp;<span class="string" id="6559138">&#34;http://g&#34;</span><span class="op" id="6559148">}</span><span class="op" id="6559149">,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559152">{</span><span class="string" id="6559153">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559173">,</span>&nbsp;<span class="string" id="6559175">&#34;?y&#34;</span><span class="op" id="6559179">,</span>&nbsp;<span class="string" id="6559181">&#34;http://a/b/c/d;p?y&#34;</span><span class="op" id="6559201">}</span><span class="op" id="6559202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559205">{</span><span class="string" id="6559206">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559226">,</span>&nbsp;<span class="string" id="6559228">&#34;g?y&#34;</span><span class="op" id="6559233">,</span>&nbsp;<span class="string" id="6559235">&#34;http://a/b/c/g?y&#34;</span><span class="op" id="6559253">}</span><span class="op" id="6559254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559257">{</span><span class="string" id="6559258">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559278">,</span>&nbsp;<span class="string" id="6559280">&#34;#s&#34;</span><span class="op" id="6559284">,</span>&nbsp;<span class="string" id="6559286">&#34;http://a/b/c/d;p?q#s&#34;</span><span class="op" id="6559308">}</span><span class="op" id="6559309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559312">{</span><span class="string" id="6559313">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559333">,</span>&nbsp;<span class="string" id="6559335">&#34;g#s&#34;</span><span class="op" id="6559340">,</span>&nbsp;<span class="string" id="6559342">&#34;http://a/b/c/g#s&#34;</span><span class="op" id="6559360">}</span><span class="op" id="6559361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559364">{</span><span class="string" id="6559365">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559385">,</span>&nbsp;<span class="string" id="6559387">&#34;g?y#s&#34;</span><span class="op" id="6559394">,</span>&nbsp;<span class="string" id="6559396">&#34;http://a/b/c/g?y#s&#34;</span><span class="op" id="6559416">}</span><span class="op" id="6559417">,</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559420">{</span><span class="string" id="6559421">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559441">,</span>&nbsp;<span class="string" id="6559443">&#34;;x&#34;</span><span class="op" id="6559447">,</span>&nbsp;<span class="string" id="6559449">&#34;http://a/b/c/;x&#34;</span><span class="op" id="6559466">}</span><span class="op" id="6559467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559470">{</span><span class="string" id="6559471">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559491">,</span>&nbsp;<span class="string" id="6559493">&#34;g;x&#34;</span><span class="op" id="6559498">,</span>&nbsp;<span class="string" id="6559500">&#34;http://a/b/c/g;x&#34;</span><span class="op" id="6559518">}</span><span class="op" id="6559519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559522">{</span><span class="string" id="6559523">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559543">,</span>&nbsp;<span class="string" id="6559545">&#34;g;x?y#s&#34;</span><span class="op" id="6559554">,</span>&nbsp;<span class="string" id="6559556">&#34;http://a/b/c/g;x?y#s&#34;</span><span class="op" id="6559578">}</span><span class="op" id="6559579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559582">{</span><span class="string" id="6559583">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559603">,</span>&nbsp;<span class="string" id="6559605">&#34;&#34;</span><span class="op" id="6559607">,</span>&nbsp;<span class="string" id="6559609">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559629">}</span><span class="op" id="6559630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559633">{</span><span class="string" id="6559634">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559654">,</span>&nbsp;<span class="string" id="6559656">&#34;.&#34;</span><span class="op" id="6559659">,</span>&nbsp;<span class="string" id="6559661">&#34;http://a/b/c/&#34;</span><span class="op" id="6559676">}</span><span class="op" id="6559677">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559680">{</span><span class="string" id="6559681">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559701">,</span>&nbsp;<span class="string" id="6559703">&#34;./&#34;</span><span class="op" id="6559707">,</span>&nbsp;<span class="string" id="6559709">&#34;http://a/b/c/&#34;</span><span class="op" id="6559724">}</span><span class="op" id="6559725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559728">{</span><span class="string" id="6559729">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559749">,</span>&nbsp;<span class="string" id="6559751">&#34;..&#34;</span><span class="op" id="6559755">,</span>&nbsp;<span class="string" id="6559757">&#34;http://a/b/&#34;</span><span class="op" id="6559770">}</span><span class="op" id="6559771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559774">{</span><span class="string" id="6559775">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559795">,</span>&nbsp;<span class="string" id="6559797">&#34;../&#34;</span><span class="op" id="6559802">,</span>&nbsp;<span class="string" id="6559804">&#34;http://a/b/&#34;</span><span class="op" id="6559817">}</span><span class="op" id="6559818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559821">{</span><span class="string" id="6559822">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559842">,</span>&nbsp;<span class="string" id="6559844">&#34;../g&#34;</span><span class="op" id="6559850">,</span>&nbsp;<span class="string" id="6559852">&#34;http://a/b/g&#34;</span><span class="op" id="6559866">}</span><span class="op" id="6559867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559870">{</span><span class="string" id="6559871">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559891">,</span>&nbsp;<span class="string" id="6559893">&#34;../..&#34;</span><span class="op" id="6559900">,</span>&nbsp;<span class="string" id="6559902">&#34;http://a/&#34;</span><span class="op" id="6559913">}</span><span class="op" id="6559914">,</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559917">{</span><span class="string" id="6559918">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559938">,</span>&nbsp;<span class="string" id="6559940">&#34;../../&#34;</span><span class="op" id="6559948">,</span>&nbsp;<span class="string" id="6559950">&#34;http://a/&#34;</span><span class="op" id="6559961">}</span><span class="op" id="6559962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6559965">{</span><span class="string" id="6559966">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6559986">,</span>&nbsp;<span class="string" id="6559988">&#34;../../g&#34;</span><span class="op" id="6559997">,</span>&nbsp;<span class="string" id="6559999">&#34;http://a/g&#34;</span><span class="op" id="6560011">}</span><span class="op" id="6560012">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6560016">//&nbsp;RFC&nbsp;3986:&nbsp;Abnormal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6560048">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.2</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560101">{</span><span class="string" id="6560102">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560122">,</span>&nbsp;<span class="string" id="6560124">&#34;../../../g&#34;</span><span class="op" id="6560136">,</span>&nbsp;<span class="string" id="6560138">&#34;http://a/g&#34;</span><span class="op" id="6560150">}</span><span class="op" id="6560151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560154">{</span><span class="string" id="6560155">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560175">,</span>&nbsp;<span class="string" id="6560177">&#34;../../../../g&#34;</span><span class="op" id="6560192">,</span>&nbsp;<span class="string" id="6560194">&#34;http://a/g&#34;</span><span class="op" id="6560206">}</span><span class="op" id="6560207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560210">{</span><span class="string" id="6560211">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560231">,</span>&nbsp;<span class="string" id="6560233">&#34;/./g&#34;</span><span class="op" id="6560239">,</span>&nbsp;<span class="string" id="6560241">&#34;http://a/g&#34;</span><span class="op" id="6560253">}</span><span class="op" id="6560254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560257">{</span><span class="string" id="6560258">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560278">,</span>&nbsp;<span class="string" id="6560280">&#34;/../g&#34;</span><span class="op" id="6560287">,</span>&nbsp;<span class="string" id="6560289">&#34;http://a/g&#34;</span><span class="op" id="6560301">}</span><span class="op" id="6560302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560305">{</span><span class="string" id="6560306">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560326">,</span>&nbsp;<span class="string" id="6560328">&#34;g.&#34;</span><span class="op" id="6560332">,</span>&nbsp;<span class="string" id="6560334">&#34;http://a/b/c/g.&#34;</span><span class="op" id="6560351">}</span><span class="op" id="6560352">,</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560355">{</span><span class="string" id="6560356">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560376">,</span>&nbsp;<span class="string" id="6560378">&#34;.g&#34;</span><span class="op" id="6560382">,</span>&nbsp;<span class="string" id="6560384">&#34;http://a/b/c/.g&#34;</span><span class="op" id="6560401">}</span><span class="op" id="6560402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560405">{</span><span class="string" id="6560406">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560426">,</span>&nbsp;<span class="string" id="6560428">&#34;g..&#34;</span><span class="op" id="6560433">,</span>&nbsp;<span class="string" id="6560435">&#34;http://a/b/c/g..&#34;</span><span class="op" id="6560453">}</span><span class="op" id="6560454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560457">{</span><span class="string" id="6560458">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560478">,</span>&nbsp;<span class="string" id="6560480">&#34;..g&#34;</span><span class="op" id="6560485">,</span>&nbsp;<span class="string" id="6560487">&#34;http://a/b/c/..g&#34;</span><span class="op" id="6560505">}</span><span class="op" id="6560506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560509">{</span><span class="string" id="6560510">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560530">,</span>&nbsp;<span class="string" id="6560532">&#34;./../g&#34;</span><span class="op" id="6560540">,</span>&nbsp;<span class="string" id="6560542">&#34;http://a/b/g&#34;</span><span class="op" id="6560556">}</span><span class="op" id="6560557">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560560">{</span><span class="string" id="6560561">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560581">,</span>&nbsp;<span class="string" id="6560583">&#34;./g/.&#34;</span><span class="op" id="6560590">,</span>&nbsp;<span class="string" id="6560592">&#34;http://a/b/c/g/&#34;</span><span class="op" id="6560609">}</span><span class="op" id="6560610">,</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560613">{</span><span class="string" id="6560614">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560634">,</span>&nbsp;<span class="string" id="6560636">&#34;g/./h&#34;</span><span class="op" id="6560643">,</span>&nbsp;<span class="string" id="6560645">&#34;http://a/b/c/g/h&#34;</span><span class="op" id="6560663">}</span><span class="op" id="6560664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560667">{</span><span class="string" id="6560668">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560688">,</span>&nbsp;<span class="string" id="6560690">&#34;g/../h&#34;</span><span class="op" id="6560698">,</span>&nbsp;<span class="string" id="6560700">&#34;http://a/b/c/h&#34;</span><span class="op" id="6560716">}</span><span class="op" id="6560717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560720">{</span><span class="string" id="6560721">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560741">,</span>&nbsp;<span class="string" id="6560743">&#34;g;x=1/./y&#34;</span><span class="op" id="6560754">,</span>&nbsp;<span class="string" id="6560756">&#34;http://a/b/c/g;x=1/y&#34;</span><span class="op" id="6560778">}</span><span class="op" id="6560779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560782">{</span><span class="string" id="6560783">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560803">,</span>&nbsp;<span class="string" id="6560805">&#34;g;x=1/../y&#34;</span><span class="op" id="6560817">,</span>&nbsp;<span class="string" id="6560819">&#34;http://a/b/c/y&#34;</span><span class="op" id="6560835">}</span><span class="op" id="6560836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560839">{</span><span class="string" id="6560840">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560860">,</span>&nbsp;<span class="string" id="6560862">&#34;g?y/./x&#34;</span><span class="op" id="6560871">,</span>&nbsp;<span class="string" id="6560873">&#34;http://a/b/c/g?y/./x&#34;</span><span class="op" id="6560895">}</span><span class="op" id="6560896">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560899">{</span><span class="string" id="6560900">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560920">,</span>&nbsp;<span class="string" id="6560922">&#34;g?y/../x&#34;</span><span class="op" id="6560932">,</span>&nbsp;<span class="string" id="6560934">&#34;http://a/b/c/g?y/../x&#34;</span><span class="op" id="6560957">}</span><span class="op" id="6560958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6560961">{</span><span class="string" id="6560962">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6560982">,</span>&nbsp;<span class="string" id="6560984">&#34;g#s/./x&#34;</span><span class="op" id="6560993">,</span>&nbsp;<span class="string" id="6560995">&#34;http://a/b/c/g#s/./x&#34;</span><span class="op" id="6561017">}</span><span class="op" id="6561018">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561021">{</span><span class="string" id="6561022">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="6561042">,</span>&nbsp;<span class="string" id="6561044">&#34;g#s/../x&#34;</span><span class="op" id="6561054">,</span>&nbsp;<span class="string" id="6561056">&#34;http://a/b/c/g#s/../x&#34;</span><span class="op" id="6561079">}</span><span class="op" id="6561080">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6561084">//&nbsp;Extras.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561096">{</span><span class="string" id="6561097">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6561118">,</span>&nbsp;<span class="string" id="6561120">&#34;//g?q&#34;</span><span class="op" id="6561127">,</span>&nbsp;<span class="string" id="6561129">&#34;https://g?q&#34;</span><span class="op" id="6561142">}</span><span class="op" id="6561143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561146">{</span><span class="string" id="6561147">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6561168">,</span>&nbsp;<span class="string" id="6561170">&#34;//g#s&#34;</span><span class="op" id="6561177">,</span>&nbsp;<span class="string" id="6561179">&#34;https://g#s&#34;</span><span class="op" id="6561192">}</span><span class="op" id="6561193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561196">{</span><span class="string" id="6561197">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="6561218">,</span>&nbsp;<span class="string" id="6561220">&#34;//g/d/e/f?y#s&#34;</span><span class="op" id="6561235">,</span>&nbsp;<span class="string" id="6561237">&#34;https://g/d/e/f?y#s&#34;</span><span class="op" id="6561258">}</span><span class="op" id="6561259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561262">{</span><span class="string" id="6561263">&#34;https://a/b/c/d;p#s&#34;</span><span class="op" id="6561284">,</span>&nbsp;<span class="string" id="6561286">&#34;?y&#34;</span><span class="op" id="6561290">,</span>&nbsp;<span class="string" id="6561292">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6561313">}</span><span class="op" id="6561314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561317">{</span><span class="string" id="6561318">&#34;https://a/b/c/d;p?q#s&#34;</span><span class="op" id="6561341">,</span>&nbsp;<span class="string" id="6561343">&#34;?y&#34;</span><span class="op" id="6561347">,</span>&nbsp;<span class="string" id="6561349">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="6561370">}</span><span class="op" id="6561371">,</span><br>
<span class="lineno">700</span><span class="op" id="6561373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6561376">func</span>&nbsp;<span class="ident" id="6561381">TestResolveReference</span><span class="op" id="6561401">(</span><span class="ident" id="6561402">t</span>&nbsp;<span class="op" id="6561404">*</span><span class="ident" id="6561405">testing</span><span class="op" id="6561412">.</span><span class="ident" id="6561413">T</span><span class="op" id="6561414">)</span>&nbsp;<span class="op" id="6561416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561419">mustParse</span>&nbsp;<span class="op" id="6561429">:=</span>&nbsp;<span class="keyword" id="6561432">func</span><span class="op" id="6561436">(</span><span class="ident" id="6561437">url</span>&nbsp;<span class="builtintype" id="6561441">string</span><span class="op" id="6561447">)</span>&nbsp;<span class="op" id="6561449">*</span><span class="ident" id="6561450">URL</span>&nbsp;<span class="op" id="6561454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561458">u</span><span class="op" id="6561459">,</span>&nbsp;<span class="ident" id="6561461">err</span>&nbsp;<span class="op" id="6561465">:=</span>&nbsp;<span class="ident" id="6561468">Parse</span><span class="op" id="6561473">(</span><span class="ident" id="6561474">url</span><span class="op" id="6561477">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6561481">if</span>&nbsp;<span class="ident" id="6561484">err</span>&nbsp;<span class="op" id="6561488">!=</span>&nbsp;<span class="ident" id="6561491">nil</span>&nbsp;<span class="op" id="6561495">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561500">t</span><span class="op" id="6561501">.</span><span class="ident" id="6561502">Fatalf</span><span class="op" id="6561508">(</span><span class="string" id="6561509">&#34;Expected&nbsp;URL&nbsp;to&nbsp;parse:&nbsp;%q,&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6561551">,</span>&nbsp;<span class="ident" id="6561553">url</span><span class="op" id="6561556">,</span>&nbsp;<span class="ident" id="6561558">err</span><span class="op" id="6561561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6561569">return</span>&nbsp;<span class="ident" id="6561576">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561579">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561582">opaque</span>&nbsp;<span class="op" id="6561589">:=</span>&nbsp;<span class="op" id="6561592">&amp;</span><span class="ident" id="6561593">URL</span><span class="op" id="6561596">{</span><span class="ident" id="6561597">Scheme</span><span class="op" id="6561603">:</span>&nbsp;<span class="string" id="6561605">&#34;scheme&#34;</span><span class="op" id="6561613">,</span>&nbsp;<span class="ident" id="6561615">Opaque</span><span class="op" id="6561621">:</span>&nbsp;<span class="string" id="6561623">&#34;opaque&#34;</span><span class="op" id="6561631">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6561634">for</span>&nbsp;<span class="ident" id="6561638">_</span><span class="op" id="6561639">,</span>&nbsp;<span class="ident" id="6561641">test</span>&nbsp;<span class="op" id="6561646">:=</span>&nbsp;<span class="keyword" id="6561649">range</span>&nbsp;<span class="ident" id="6561655">resolveReferenceTests</span>&nbsp;<span class="op" id="6561677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561681">base</span>&nbsp;<span class="op" id="6561686">:=</span>&nbsp;<span class="ident" id="6561689">mustParse</span><span class="op" id="6561698">(</span><span class="ident" id="6561699">test</span><span class="op" id="6561703">.</span><span class="ident" id="6561704">base</span><span class="op" id="6561708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561712">rel</span>&nbsp;<span class="op" id="6561716">:=</span>&nbsp;<span class="ident" id="6561719">mustParse</span><span class="op" id="6561728">(</span><span class="ident" id="6561729">test</span><span class="op" id="6561733">.</span><span class="ident" id="6561734">rel</span><span class="op" id="6561737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561741">url</span>&nbsp;<span class="op" id="6561745">:=</span>&nbsp;<span class="ident" id="6561748">base</span><span class="op" id="6561752">.</span><span class="ident" id="6561753">ResolveReference</span><span class="op" id="6561769">(</span><span class="ident" id="6561770">rel</span><span class="op" id="6561773">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6561777">if</span>&nbsp;<span class="ident" id="6561780">url</span><span class="op" id="6561783">.</span><span class="ident" id="6561784">String</span><span class="op" id="6561790">(</span><span class="op" id="6561791">)</span>&nbsp;<span class="op" id="6561793">!=</span>&nbsp;<span class="ident" id="6561796">test</span><span class="op" id="6561800">.</span><span class="ident" id="6561801">expected</span>&nbsp;<span class="op" id="6561810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561815">t</span><span class="op" id="6561816">.</span><span class="ident" id="6561817">Errorf</span><span class="op" id="6561823">(</span><span class="string" id="6561824">&#34;URL(%q).ResolveReference(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6561868">,</span>&nbsp;<span class="ident" id="6561870">test</span><span class="op" id="6561874">.</span><span class="ident" id="6561875">base</span><span class="op" id="6561879">,</span>&nbsp;<span class="ident" id="6561881">test</span><span class="op" id="6561885">.</span><span class="ident" id="6561886">rel</span><span class="op" id="6561889">,</span>&nbsp;<span class="ident" id="6561891">test</span><span class="op" id="6561895">.</span><span class="ident" id="6561896">expected</span><span class="op" id="6561904">,</span>&nbsp;<span class="ident" id="6561906">url</span><span class="op" id="6561909">.</span><span class="ident" id="6561910">String</span><span class="op" id="6561916">(</span><span class="op" id="6561917">)</span><span class="op" id="6561918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6561922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6561926">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6561971">if</span>&nbsp;<span class="ident" id="6561974">base</span>&nbsp;<span class="op" id="6561979">==</span>&nbsp;<span class="ident" id="6561982">url</span>&nbsp;<span class="op" id="6561986">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6561991">t</span><span class="op" id="6561992">.</span><span class="ident" id="6561993">Errorf</span><span class="op" id="6561999">(</span><span class="string" id="6562000">&#34;Expected&nbsp;URL.ResolveReference&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6562059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6562067">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562106">url</span><span class="op" id="6562109">,</span>&nbsp;<span class="ident" id="6562111">err</span>&nbsp;<span class="op" id="6562115">:=</span>&nbsp;<span class="ident" id="6562118">base</span><span class="op" id="6562122">.</span><span class="ident" id="6562123">Parse</span><span class="op" id="6562128">(</span><span class="ident" id="6562129">test</span><span class="op" id="6562133">.</span><span class="ident" id="6562134">rel</span><span class="op" id="6562137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6562141">if</span>&nbsp;<span class="ident" id="6562144">err</span>&nbsp;<span class="op" id="6562148">!=</span>&nbsp;<span class="ident" id="6562151">nil</span>&nbsp;<span class="op" id="6562155">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562160">t</span><span class="op" id="6562161">.</span><span class="ident" id="6562162">Errorf</span><span class="op" id="6562168">(</span><span class="string" id="6562169">&#34;URL(%q).Parse(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6562199">,</span>&nbsp;<span class="ident" id="6562201">test</span><span class="op" id="6562205">.</span><span class="ident" id="6562206">base</span><span class="op" id="6562210">,</span>&nbsp;<span class="ident" id="6562212">test</span><span class="op" id="6562216">.</span><span class="ident" id="6562217">rel</span><span class="op" id="6562220">,</span>&nbsp;<span class="ident" id="6562222">err</span><span class="op" id="6562225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562229">}</span>&nbsp;<span class="keyword" id="6562231">else</span>&nbsp;<span class="keyword" id="6562236">if</span>&nbsp;<span class="ident" id="6562239">url</span><span class="op" id="6562242">.</span><span class="ident" id="6562243">String</span><span class="op" id="6562249">(</span><span class="op" id="6562250">)</span>&nbsp;<span class="op" id="6562252">!=</span>&nbsp;<span class="ident" id="6562255">test</span><span class="op" id="6562259">.</span><span class="ident" id="6562260">expected</span>&nbsp;<span class="op" id="6562269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562274">t</span><span class="op" id="6562275">.</span><span class="ident" id="6562276">Errorf</span><span class="op" id="6562282">(</span><span class="string" id="6562283">&#34;URL(%q).Parse(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6562316">,</span>&nbsp;<span class="ident" id="6562318">test</span><span class="op" id="6562322">.</span><span class="ident" id="6562323">base</span><span class="op" id="6562327">,</span>&nbsp;<span class="ident" id="6562329">test</span><span class="op" id="6562333">.</span><span class="ident" id="6562334">rel</span><span class="op" id="6562337">,</span>&nbsp;<span class="ident" id="6562339">test</span><span class="op" id="6562343">.</span><span class="ident" id="6562344">expected</span><span class="op" id="6562352">,</span>&nbsp;<span class="ident" id="6562354">url</span><span class="op" id="6562357">.</span><span class="ident" id="6562358">String</span><span class="op" id="6562364">(</span><span class="op" id="6562365">)</span><span class="op" id="6562366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562370">}</span>&nbsp;<span class="keyword" id="6562372">else</span>&nbsp;<span class="keyword" id="6562377">if</span>&nbsp;<span class="ident" id="6562380">base</span>&nbsp;<span class="op" id="6562385">==</span>&nbsp;<span class="ident" id="6562388">url</span>&nbsp;<span class="op" id="6562392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6562397">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned&nbsp;for&nbsp;the&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562463">t</span><span class="op" id="6562464">.</span><span class="ident" id="6562465">Errorf</span><span class="op" id="6562471">(</span><span class="string" id="6562472">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6562520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6562528">//&nbsp;Ensure&nbsp;Opaque&nbsp;resets&nbsp;the&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562563">url</span>&nbsp;<span class="op" id="6562567">=</span>&nbsp;<span class="ident" id="6562569">base</span><span class="op" id="6562573">.</span><span class="ident" id="6562574">ResolveReference</span><span class="op" id="6562590">(</span><span class="ident" id="6562591">opaque</span><span class="op" id="6562597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6562601">if</span>&nbsp;<span class="op" id="6562604">*</span><span class="ident" id="6562605">url</span>&nbsp;<span class="op" id="6562609">!=</span>&nbsp;<span class="op" id="6562612">*</span><span class="ident" id="6562613">opaque</span>&nbsp;<span class="op" id="6562620">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562625">t</span><span class="op" id="6562626">.</span><span class="ident" id="6562627">Errorf</span><span class="op" id="6562633">(</span><span class="string" id="6562634">&#34;ResolveReference&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6562700">,</span>&nbsp;<span class="ident" id="6562702">url</span><span class="op" id="6562705">,</span>&nbsp;<span class="ident" id="6562707">opaque</span><span class="op" id="6562713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6562721">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;with&nbsp;an&nbsp;opaque&nbsp;URL&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562779">url</span><span class="op" id="6562782">,</span>&nbsp;<span class="ident" id="6562784">err</span>&nbsp;<span class="op" id="6562788">=</span>&nbsp;<span class="ident" id="6562790">base</span><span class="op" id="6562794">.</span><span class="ident" id="6562795">Parse</span><span class="op" id="6562800">(</span><span class="string" id="6562801">&#34;scheme:opaque&#34;</span><span class="op" id="6562816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6562820">if</span>&nbsp;<span class="ident" id="6562823">err</span>&nbsp;<span class="op" id="6562827">!=</span>&nbsp;<span class="ident" id="6562830">nil</span>&nbsp;<span class="op" id="6562834">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562839">t</span><span class="op" id="6562840">.</span><span class="ident" id="6562841">Errorf</span><span class="op" id="6562847">(</span><span class="string" id="6562848">`URL(%q).Parse(&#34;scheme:opaque&#34;)&nbsp;failed:&nbsp;%v`</span><span class="op" id="6562891">,</span>&nbsp;<span class="ident" id="6562893">test</span><span class="op" id="6562897">.</span><span class="ident" id="6562898">base</span><span class="op" id="6562902">,</span>&nbsp;<span class="ident" id="6562904">err</span><span class="op" id="6562907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6562911">}</span>&nbsp;<span class="keyword" id="6562913">else</span>&nbsp;<span class="keyword" id="6562918">if</span>&nbsp;<span class="op" id="6562921">*</span><span class="ident" id="6562922">url</span>&nbsp;<span class="op" id="6562926">!=</span>&nbsp;<span class="op" id="6562929">*</span><span class="ident" id="6562930">opaque</span>&nbsp;<span class="op" id="6562937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6562942">t</span><span class="op" id="6562943">.</span><span class="ident" id="6562944">Errorf</span><span class="op" id="6562950">(</span><span class="string" id="6562951">&#34;Parse&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6563006">,</span>&nbsp;<span class="ident" id="6563008">url</span><span class="op" id="6563011">,</span>&nbsp;<span class="ident" id="6563013">opaque</span><span class="op" id="6563019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563023">}</span>&nbsp;<span class="keyword" id="6563025">else</span>&nbsp;<span class="keyword" id="6563030">if</span>&nbsp;<span class="ident" id="6563033">base</span>&nbsp;<span class="op" id="6563038">==</span>&nbsp;<span class="ident" id="6563041">url</span>&nbsp;<span class="op" id="6563045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6563050">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned,&nbsp;again.</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563103">t</span><span class="op" id="6563104">.</span><span class="ident" id="6563105">Errorf</span><span class="op" id="6563111">(</span><span class="string" id="6563112">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="6563160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563167">}</span><br>
<span class="lineno"></span><span class="op" id="6563169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">750</span><span class="keyword" id="6563172">func</span>&nbsp;<span class="ident" id="6563177">TestQueryValues</span><span class="op" id="6563192">(</span><span class="ident" id="6563193">t</span>&nbsp;<span class="op" id="6563195">*</span><span class="ident" id="6563196">testing</span><span class="op" id="6563203">.</span><span class="ident" id="6563204">T</span><span class="op" id="6563205">)</span>&nbsp;<span class="op" id="6563207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563210">u</span><span class="op" id="6563211">,</span>&nbsp;<span class="ident" id="6563213">_</span>&nbsp;<span class="op" id="6563215">:=</span>&nbsp;<span class="ident" id="6563218">Parse</span><span class="op" id="6563223">(</span><span class="string" id="6563224">&#34;http://x.com?foo=bar&amp;bar=1&amp;bar=2&#34;</span><span class="op" id="6563258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563261">v</span>&nbsp;<span class="op" id="6563263">:=</span>&nbsp;<span class="ident" id="6563266">u</span><span class="op" id="6563267">.</span><span class="ident" id="6563268">Query</span><span class="op" id="6563273">(</span><span class="op" id="6563274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563277">if</span>&nbsp;<span class="builtinfunc" id="6563280">len</span><span class="op" id="6563283">(</span><span class="ident" id="6563284">v</span><span class="op" id="6563285">)</span>&nbsp;<span class="op" id="6563287">!=</span>&nbsp;<span class="num" id="6563290">2</span>&nbsp;<span class="op" id="6563292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563296">t</span><span class="op" id="6563297">.</span><span class="ident" id="6563298">Errorf</span><span class="op" id="6563304">(</span><span class="string" id="6563305">&#34;got&nbsp;%d&nbsp;keys&nbsp;in&nbsp;Query&nbsp;values,&nbsp;want&nbsp;2&#34;</span><span class="op" id="6563342">,</span>&nbsp;<span class="builtinfunc" id="6563344">len</span><span class="op" id="6563347">(</span><span class="ident" id="6563348">v</span><span class="op" id="6563349">)</span><span class="op" id="6563350">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563356">if</span>&nbsp;<span class="ident" id="6563359">g</span><span class="op" id="6563360">,</span>&nbsp;<span class="ident" id="6563362">e</span>&nbsp;<span class="op" id="6563364">:=</span>&nbsp;<span class="ident" id="6563367">v</span><span class="op" id="6563368">.</span><span class="ident" id="6563369">Get</span><span class="op" id="6563372">(</span><span class="string" id="6563373">&#34;foo&#34;</span><span class="op" id="6563378">)</span><span class="op" id="6563379">,</span>&nbsp;<span class="string" id="6563381">&#34;bar&#34;</span><span class="op" id="6563386">;</span>&nbsp;<span class="ident" id="6563388">g</span>&nbsp;<span class="op" id="6563390">!=</span>&nbsp;<span class="ident" id="6563393">e</span>&nbsp;<span class="op" id="6563395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563399">t</span><span class="op" id="6563400">.</span><span class="ident" id="6563401">Errorf</span><span class="op" id="6563407">(</span><span class="string" id="6563408">&#34;Get(foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6563432">,</span>&nbsp;<span class="ident" id="6563434">g</span><span class="op" id="6563435">,</span>&nbsp;<span class="ident" id="6563437">e</span><span class="op" id="6563438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6563444">//&nbsp;Case&nbsp;sensitive:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563464">if</span>&nbsp;<span class="ident" id="6563467">g</span><span class="op" id="6563468">,</span>&nbsp;<span class="ident" id="6563470">e</span>&nbsp;<span class="op" id="6563472">:=</span>&nbsp;<span class="ident" id="6563475">v</span><span class="op" id="6563476">.</span><span class="ident" id="6563477">Get</span><span class="op" id="6563480">(</span><span class="string" id="6563481">&#34;Foo&#34;</span><span class="op" id="6563486">)</span><span class="op" id="6563487">,</span>&nbsp;<span class="string" id="6563489">&#34;&#34;</span><span class="op" id="6563491">;</span>&nbsp;<span class="ident" id="6563493">g</span>&nbsp;<span class="op" id="6563495">!=</span>&nbsp;<span class="ident" id="6563498">e</span>&nbsp;<span class="op" id="6563500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563504">t</span><span class="op" id="6563505">.</span><span class="ident" id="6563506">Errorf</span><span class="op" id="6563512">(</span><span class="string" id="6563513">&#34;Get(Foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6563537">,</span>&nbsp;<span class="ident" id="6563539">g</span><span class="op" id="6563540">,</span>&nbsp;<span class="ident" id="6563542">e</span><span class="op" id="6563543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563549">if</span>&nbsp;<span class="ident" id="6563552">g</span><span class="op" id="6563553">,</span>&nbsp;<span class="ident" id="6563555">e</span>&nbsp;<span class="op" id="6563557">:=</span>&nbsp;<span class="ident" id="6563560">v</span><span class="op" id="6563561">.</span><span class="ident" id="6563562">Get</span><span class="op" id="6563565">(</span><span class="string" id="6563566">&#34;bar&#34;</span><span class="op" id="6563571">)</span><span class="op" id="6563572">,</span>&nbsp;<span class="string" id="6563574">&#34;1&#34;</span><span class="op" id="6563577">;</span>&nbsp;<span class="ident" id="6563579">g</span>&nbsp;<span class="op" id="6563581">!=</span>&nbsp;<span class="ident" id="6563584">e</span>&nbsp;<span class="op" id="6563586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563590">t</span><span class="op" id="6563591">.</span><span class="ident" id="6563592">Errorf</span><span class="op" id="6563598">(</span><span class="string" id="6563599">&#34;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6563623">,</span>&nbsp;<span class="ident" id="6563625">g</span><span class="op" id="6563626">,</span>&nbsp;<span class="ident" id="6563628">e</span><span class="op" id="6563629">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563635">if</span>&nbsp;<span class="ident" id="6563638">g</span><span class="op" id="6563639">,</span>&nbsp;<span class="ident" id="6563641">e</span>&nbsp;<span class="op" id="6563643">:=</span>&nbsp;<span class="ident" id="6563646">v</span><span class="op" id="6563647">.</span><span class="ident" id="6563648">Get</span><span class="op" id="6563651">(</span><span class="string" id="6563652">&#34;baz&#34;</span><span class="op" id="6563657">)</span><span class="op" id="6563658">,</span>&nbsp;<span class="string" id="6563660">&#34;&#34;</span><span class="op" id="6563662">;</span>&nbsp;<span class="ident" id="6563664">g</span>&nbsp;<span class="op" id="6563666">!=</span>&nbsp;<span class="ident" id="6563669">e</span>&nbsp;<span class="op" id="6563671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563675">t</span><span class="op" id="6563676">.</span><span class="ident" id="6563677">Errorf</span><span class="op" id="6563683">(</span><span class="string" id="6563684">&#34;Get(baz)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6563708">,</span>&nbsp;<span class="ident" id="6563710">g</span><span class="op" id="6563711">,</span>&nbsp;<span class="ident" id="6563713">e</span><span class="op" id="6563714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563720">v</span><span class="op" id="6563721">.</span><span class="ident" id="6563722">Del</span><span class="op" id="6563725">(</span><span class="string" id="6563726">&#34;bar&#34;</span><span class="op" id="6563731">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6563734">if</span>&nbsp;<span class="ident" id="6563737">g</span><span class="op" id="6563738">,</span>&nbsp;<span class="ident" id="6563740">e</span>&nbsp;<span class="op" id="6563742">:=</span>&nbsp;<span class="ident" id="6563745">v</span><span class="op" id="6563746">.</span><span class="ident" id="6563747">Get</span><span class="op" id="6563750">(</span><span class="string" id="6563751">&#34;bar&#34;</span><span class="op" id="6563756">)</span><span class="op" id="6563757">,</span>&nbsp;<span class="string" id="6563759">&#34;&#34;</span><span class="op" id="6563761">;</span>&nbsp;<span class="ident" id="6563763">g</span>&nbsp;<span class="op" id="6563765">!=</span>&nbsp;<span class="ident" id="6563768">e</span>&nbsp;<span class="op" id="6563770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563774">t</span><span class="op" id="6563775">.</span><span class="ident" id="6563776">Errorf</span><span class="op" id="6563782">(</span><span class="string" id="6563783">&#34;second&nbsp;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6563814">,</span>&nbsp;<span class="ident" id="6563816">g</span><span class="op" id="6563817">,</span>&nbsp;<span class="ident" id="6563819">e</span><span class="op" id="6563820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563823">}</span><br>
<span class="lineno"></span><span class="op" id="6563825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="keyword" id="6563828">type</span>&nbsp;<span class="ident" id="6563833">parseTest</span>&nbsp;<span class="keyword" id="6563843">struct</span>&nbsp;<span class="op" id="6563850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563853">query</span>&nbsp;<span class="builtintype" id="6563859">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563867">out</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6563873">Values</span><br>
<span class="lineno"></span><span class="op" id="6563880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="keyword" id="6563883">var</span>&nbsp;<span class="ident" id="6563887">parseTests</span>&nbsp;<span class="op" id="6563898">=</span>&nbsp;<span class="op" id="6563900">[</span><span class="op" id="6563901">]</span><span class="ident" id="6563902">parseTest</span><span class="op" id="6563911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563918">query</span><span class="op" id="6563923">:</span>&nbsp;<span class="string" id="6563925">&#34;a=1&amp;b=2&#34;</span><span class="op" id="6563934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6563938">out</span><span class="op" id="6563941">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6563945">Values</span><span class="op" id="6563951">{</span><span class="string" id="6563952">&#34;a&#34;</span><span class="op" id="6563955">:</span>&nbsp;<span class="op" id="6563957">[</span><span class="op" id="6563958">]</span><span class="builtintype" id="6563959">string</span><span class="op" id="6563965">{</span><span class="string" id="6563966">&#34;1&#34;</span><span class="op" id="6563969">}</span><span class="op" id="6563970">,</span>&nbsp;<span class="string" id="6563972">&#34;b&#34;</span><span class="op" id="6563975">:</span>&nbsp;<span class="op" id="6563977">[</span><span class="op" id="6563978">]</span><span class="builtintype" id="6563979">string</span><span class="op" id="6563985">{</span><span class="string" id="6563986">&#34;2&#34;</span><span class="op" id="6563989">}</span><span class="op" id="6563990">}</span><span class="op" id="6563991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563994">}</span><span class="op" id="6563995">,</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6563998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564002">query</span><span class="op" id="6564007">:</span>&nbsp;<span class="string" id="6564009">&#34;a=1&amp;a=2&amp;a=banana&#34;</span><span class="op" id="6564027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564031">out</span><span class="op" id="6564034">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6564038">Values</span><span class="op" id="6564044">{</span><span class="string" id="6564045">&#34;a&#34;</span><span class="op" id="6564048">:</span>&nbsp;<span class="op" id="6564050">[</span><span class="op" id="6564051">]</span><span class="builtintype" id="6564052">string</span><span class="op" id="6564058">{</span><span class="string" id="6564059">&#34;1&#34;</span><span class="op" id="6564062">,</span>&nbsp;<span class="string" id="6564064">&#34;2&#34;</span><span class="op" id="6564067">,</span>&nbsp;<span class="string" id="6564069">&#34;banana&#34;</span><span class="op" id="6564077">}</span><span class="op" id="6564078">}</span><span class="op" id="6564079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564082">}</span><span class="op" id="6564083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564086">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564090">query</span><span class="op" id="6564095">:</span>&nbsp;<span class="string" id="6564097">&#34;ascii=%3Ckey%3A+0x90%3E&#34;</span><span class="op" id="6564122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564126">out</span><span class="op" id="6564129">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6564133">Values</span><span class="op" id="6564139">{</span><span class="string" id="6564140">&#34;ascii&#34;</span><span class="op" id="6564147">:</span>&nbsp;<span class="op" id="6564149">[</span><span class="op" id="6564150">]</span><span class="builtintype" id="6564151">string</span><span class="op" id="6564157">{</span><span class="string" id="6564158">&#34;&lt;key:&nbsp;0x90&gt;&#34;</span><span class="op" id="6564171">}</span><span class="op" id="6564172">}</span><span class="op" id="6564173">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564176">}</span><span class="op" id="6564177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564184">query</span><span class="op" id="6564189">:</span>&nbsp;<span class="string" id="6564191">&#34;a=1;b=2&#34;</span><span class="op" id="6564200">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564204">out</span><span class="op" id="6564207">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6564211">Values</span><span class="op" id="6564217">{</span><span class="string" id="6564218">&#34;a&#34;</span><span class="op" id="6564221">:</span>&nbsp;<span class="op" id="6564223">[</span><span class="op" id="6564224">]</span><span class="builtintype" id="6564225">string</span><span class="op" id="6564231">{</span><span class="string" id="6564232">&#34;1&#34;</span><span class="op" id="6564235">}</span><span class="op" id="6564236">,</span>&nbsp;<span class="string" id="6564238">&#34;b&#34;</span><span class="op" id="6564241">:</span>&nbsp;<span class="op" id="6564243">[</span><span class="op" id="6564244">]</span><span class="builtintype" id="6564245">string</span><span class="op" id="6564251">{</span><span class="string" id="6564252">&#34;2&#34;</span><span class="op" id="6564255">}</span><span class="op" id="6564256">}</span><span class="op" id="6564257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564260">}</span><span class="op" id="6564261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564268">query</span><span class="op" id="6564273">:</span>&nbsp;<span class="string" id="6564275">&#34;a=1&amp;a=2;a=banana&#34;</span><span class="op" id="6564293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564297">out</span><span class="op" id="6564300">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6564304">Values</span><span class="op" id="6564310">{</span><span class="string" id="6564311">&#34;a&#34;</span><span class="op" id="6564314">:</span>&nbsp;<span class="op" id="6564316">[</span><span class="op" id="6564317">]</span><span class="builtintype" id="6564318">string</span><span class="op" id="6564324">{</span><span class="string" id="6564325">&#34;1&#34;</span><span class="op" id="6564328">,</span>&nbsp;<span class="string" id="6564330">&#34;2&#34;</span><span class="op" id="6564333">,</span>&nbsp;<span class="string" id="6564335">&#34;banana&#34;</span><span class="op" id="6564343">}</span><span class="op" id="6564344">}</span><span class="op" id="6564345">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564348">}</span><span class="op" id="6564349">,</span><br>
<span class="lineno"></span><span class="op" id="6564351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6564354">func</span>&nbsp;<span class="ident" id="6564359">TestParseQuery</span><span class="op" id="6564373">(</span><span class="ident" id="6564374">t</span>&nbsp;<span class="op" id="6564376">*</span><span class="ident" id="6564377">testing</span><span class="op" id="6564384">.</span><span class="ident" id="6564385">T</span><span class="op" id="6564386">)</span>&nbsp;<span class="op" id="6564388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564391">for</span>&nbsp;<span class="ident" id="6564395">i</span><span class="op" id="6564396">,</span>&nbsp;<span class="ident" id="6564398">test</span>&nbsp;<span class="op" id="6564403">:=</span>&nbsp;<span class="keyword" id="6564406">range</span>&nbsp;<span class="ident" id="6564412">parseTests</span>&nbsp;<span class="op" id="6564423">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564427">form</span><span class="op" id="6564431">,</span>&nbsp;<span class="ident" id="6564433">err</span>&nbsp;<span class="op" id="6564437">:=</span>&nbsp;<span class="ident" id="6564440">ParseQuery</span><span class="op" id="6564450">(</span><span class="ident" id="6564451">test</span><span class="op" id="6564455">.</span><span class="ident" id="6564456">query</span><span class="op" id="6564461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564465">if</span>&nbsp;<span class="ident" id="6564468">err</span>&nbsp;<span class="op" id="6564472">!=</span>&nbsp;<span class="ident" id="6564475">nil</span>&nbsp;<span class="op" id="6564479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564484">t</span><span class="op" id="6564485">.</span><span class="ident" id="6564486">Errorf</span><span class="op" id="6564492">(</span><span class="string" id="6564493">&#34;test&nbsp;%d:&nbsp;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6564524">,</span>&nbsp;<span class="ident" id="6564526">i</span><span class="op" id="6564527">,</span>&nbsp;<span class="ident" id="6564529">err</span><span class="op" id="6564532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564537">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564548">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564552">if</span>&nbsp;<span class="builtinfunc" id="6564555">len</span><span class="op" id="6564558">(</span><span class="ident" id="6564559">form</span><span class="op" id="6564563">)</span>&nbsp;<span class="op" id="6564565">!=</span>&nbsp;<span class="builtinfunc" id="6564568">len</span><span class="op" id="6564571">(</span><span class="ident" id="6564572">test</span><span class="op" id="6564576">.</span><span class="ident" id="6564577">out</span><span class="op" id="6564580">)</span>&nbsp;<span class="op" id="6564582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564587">t</span><span class="op" id="6564588">.</span><span class="ident" id="6564589">Errorf</span><span class="op" id="6564595">(</span><span class="string" id="6564596">&#34;test&nbsp;%d:&nbsp;len(form)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6564630">,</span>&nbsp;<span class="ident" id="6564632">i</span><span class="op" id="6564633">,</span>&nbsp;<span class="builtinfunc" id="6564635">len</span><span class="op" id="6564638">(</span><span class="ident" id="6564639">form</span><span class="op" id="6564643">)</span><span class="op" id="6564644">,</span>&nbsp;<span class="builtinfunc" id="6564646">len</span><span class="op" id="6564649">(</span><span class="ident" id="6564650">test</span><span class="op" id="6564654">.</span><span class="ident" id="6564655">out</span><span class="op" id="6564658">)</span><span class="op" id="6564659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564667">for</span>&nbsp;<span class="ident" id="6564671">k</span><span class="op" id="6564672">,</span>&nbsp;<span class="ident" id="6564674">evs</span>&nbsp;<span class="op" id="6564678">:=</span>&nbsp;<span class="keyword" id="6564681">range</span>&nbsp;<span class="ident" id="6564687">test</span><span class="op" id="6564691">.</span><span class="ident" id="6564692">out</span>&nbsp;<span class="op" id="6564696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564701">vs</span><span class="op" id="6564703">,</span>&nbsp;<span class="ident" id="6564705">ok</span>&nbsp;<span class="op" id="6564708">:=</span>&nbsp;<span class="ident" id="6564711">form</span><span class="op" id="6564715">[</span><span class="ident" id="6564716">k</span><span class="op" id="6564717">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564722">if</span>&nbsp;<span class="op" id="6564725">!</span><span class="ident" id="6564726">ok</span>&nbsp;<span class="op" id="6564729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564735">t</span><span class="op" id="6564736">.</span><span class="ident" id="6564737">Errorf</span><span class="op" id="6564743">(</span><span class="string" id="6564744">&#34;test&nbsp;%d:&nbsp;Missing&nbsp;key&nbsp;%q&#34;</span><span class="op" id="6564769">,</span>&nbsp;<span class="ident" id="6564771">i</span><span class="op" id="6564772">,</span>&nbsp;<span class="ident" id="6564774">k</span><span class="op" id="6564775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564781">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564798">if</span>&nbsp;<span class="builtinfunc" id="6564801">len</span><span class="op" id="6564804">(</span><span class="ident" id="6564805">vs</span><span class="op" id="6564807">)</span>&nbsp;<span class="op" id="6564809">!=</span>&nbsp;<span class="builtinfunc" id="6564812">len</span><span class="op" id="6564815">(</span><span class="ident" id="6564816">evs</span><span class="op" id="6564819">)</span>&nbsp;<span class="op" id="6564821">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564827">t</span><span class="op" id="6564828">.</span><span class="ident" id="6564829">Errorf</span><span class="op" id="6564835">(</span><span class="string" id="6564836">&#34;test&nbsp;%d:&nbsp;len(form[%q])&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="6564874">,</span>&nbsp;<span class="ident" id="6564876">i</span><span class="op" id="6564877">,</span>&nbsp;<span class="ident" id="6564879">k</span><span class="op" id="6564880">,</span>&nbsp;<span class="builtinfunc" id="6564882">len</span><span class="op" id="6564885">(</span><span class="ident" id="6564886">vs</span><span class="op" id="6564888">)</span><span class="op" id="6564889">,</span>&nbsp;<span class="builtinfunc" id="6564891">len</span><span class="op" id="6564894">(</span><span class="ident" id="6564895">evs</span><span class="op" id="6564898">)</span><span class="op" id="6564899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564905">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6564917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564922">for</span>&nbsp;<span class="ident" id="6564926">j</span><span class="op" id="6564927">,</span>&nbsp;<span class="ident" id="6564929">ev</span>&nbsp;<span class="op" id="6564932">:=</span>&nbsp;<span class="keyword" id="6564935">range</span>&nbsp;<span class="ident" id="6564941">evs</span>&nbsp;<span class="op" id="6564945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6564951">if</span>&nbsp;<span class="ident" id="6564954">v</span>&nbsp;<span class="op" id="6564956">:=</span>&nbsp;<span class="ident" id="6564959">vs</span><span class="op" id="6564961">[</span><span class="ident" id="6564962">j</span><span class="op" id="6564963">]</span><span class="op" id="6564964">;</span>&nbsp;<span class="ident" id="6564966">v</span>&nbsp;<span class="op" id="6564968">!=</span>&nbsp;<span class="ident" id="6564971">ev</span>&nbsp;<span class="op" id="6564974">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6564981">t</span><span class="op" id="6564982">.</span><span class="ident" id="6564983">Errorf</span><span class="op" id="6564989">(</span><span class="string" id="6564990">&#34;test&nbsp;%d:&nbsp;form[%q][%d]&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6565027">,</span>&nbsp;<span class="ident" id="6565029">i</span><span class="op" id="6565030">,</span>&nbsp;<span class="ident" id="6565032">k</span><span class="op" id="6565033">,</span>&nbsp;<span class="ident" id="6565035">j</span><span class="op" id="6565036">,</span>&nbsp;<span class="ident" id="6565038">v</span><span class="op" id="6565039">,</span>&nbsp;<span class="ident" id="6565041">ev</span><span class="op" id="6565043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565061">}</span><br>
<span class="lineno">830</span><span class="op" id="6565063">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6565066">type</span>&nbsp;<span class="ident" id="6565071">RequestURITest</span>&nbsp;<span class="keyword" id="6565086">struct</span>&nbsp;<span class="op" id="6565093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565096">url</span>&nbsp;<span class="op" id="6565100">*</span><span class="ident" id="6565101">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565106">out</span>&nbsp;<span class="builtintype" id="6565110">string</span><br>
<span class="lineno">835</span><span class="op" id="6565117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6565120">var</span>&nbsp;<span class="ident" id="6565124">requritests</span>&nbsp;<span class="op" id="6565136">=</span>&nbsp;<span class="op" id="6565138">[</span><span class="op" id="6565139">]</span><span class="ident" id="6565140">RequestURITest</span><span class="op" id="6565154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565161">&amp;</span><span class="ident" id="6565162">URL</span><span class="op" id="6565165">{</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565170">Scheme</span><span class="op" id="6565176">:</span>&nbsp;<span class="string" id="6565178">&#34;http&#34;</span><span class="op" id="6565184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565189">Host</span><span class="op" id="6565193">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565197">&#34;example.com&#34;</span><span class="op" id="6565210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565215">Path</span><span class="op" id="6565219">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565223">&#34;&#34;</span><span class="op" id="6565225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565229">}</span><span class="op" id="6565230">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565234">&#34;/&#34;</span><span class="op" id="6565237">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565240">}</span><span class="op" id="6565241">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565248">&amp;</span><span class="ident" id="6565249">URL</span><span class="op" id="6565252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565257">Scheme</span><span class="op" id="6565263">:</span>&nbsp;<span class="string" id="6565265">&#34;http&#34;</span><span class="op" id="6565271">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565276">Host</span><span class="op" id="6565280">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565284">&#34;example.com&#34;</span><span class="op" id="6565297">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565302">Path</span><span class="op" id="6565306">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565310">&#34;/a&nbsp;b&#34;</span><span class="op" id="6565316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565320">}</span><span class="op" id="6565321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565325">&#34;/a%20b&#34;</span><span class="op" id="6565333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565336">}</span><span class="op" id="6565337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6565340">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;1</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565380">&amp;</span><span class="ident" id="6565381">URL</span><span class="op" id="6565384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565389">Scheme</span><span class="op" id="6565395">:</span>&nbsp;<span class="string" id="6565397">&#34;http&#34;</span><span class="op" id="6565403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565408">Host</span><span class="op" id="6565412">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565416">&#34;example.com&#34;</span><span class="op" id="6565429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565434">Opaque</span><span class="op" id="6565440">:</span>&nbsp;<span class="string" id="6565442">&#34;/%2F/%2F/&#34;</span><span class="op" id="6565453">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565457">}</span><span class="op" id="6565458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565462">&#34;/%2F/%2F/&#34;</span><span class="op" id="6565473">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565476">}</span><span class="op" id="6565477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6565480">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565516">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565520">&amp;</span><span class="ident" id="6565521">URL</span><span class="op" id="6565524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565529">Scheme</span><span class="op" id="6565535">:</span>&nbsp;<span class="string" id="6565537">&#34;http&#34;</span><span class="op" id="6565543">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565548">Host</span><span class="op" id="6565552">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565556">&#34;example.com&#34;</span><span class="op" id="6565569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565574">Opaque</span><span class="op" id="6565580">:</span>&nbsp;<span class="string" id="6565582">&#34;//other.example.com/%2F/%2F/&#34;</span><span class="op" id="6565612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565616">}</span><span class="op" id="6565617">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565621">&#34;http://other.example.com/%2F/%2F/&#34;</span><span class="op" id="6565656">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565659">}</span><span class="op" id="6565660">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565667">&amp;</span><span class="ident" id="6565668">URL</span><span class="op" id="6565671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565676">Scheme</span><span class="op" id="6565682">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565686">&#34;http&#34;</span><span class="op" id="6565692">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565697">Host</span><span class="op" id="6565701">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6565707">&#34;example.com&#34;</span><span class="op" id="6565720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565725">Path</span><span class="op" id="6565729">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6565735">&#34;/a&nbsp;b&#34;</span><span class="op" id="6565741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565746">RawQuery</span><span class="op" id="6565754">:</span>&nbsp;<span class="string" id="6565756">&#34;q=go+language&#34;</span><span class="op" id="6565771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565775">}</span><span class="op" id="6565776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565780">&#34;/a%20b?q=go+language&#34;</span><span class="op" id="6565802">,</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565805">}</span><span class="op" id="6565806">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565813">&amp;</span><span class="ident" id="6565814">URL</span><span class="op" id="6565817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565822">Scheme</span><span class="op" id="6565828">:</span>&nbsp;<span class="string" id="6565830">&#34;myschema&#34;</span><span class="op" id="6565840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565845">Opaque</span><span class="op" id="6565851">:</span>&nbsp;<span class="string" id="6565853">&#34;opaque&#34;</span><span class="op" id="6565861">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565865">}</span><span class="op" id="6565866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565870">&#34;opaque&#34;</span><span class="op" id="6565878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565881">}</span><span class="op" id="6565882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565889">&amp;</span><span class="ident" id="6565890">URL</span><span class="op" id="6565893">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565898">Scheme</span><span class="op" id="6565904">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565908">&#34;myschema&#34;</span><span class="op" id="6565918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565923">Opaque</span><span class="op" id="6565929">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6565933">&#34;opaque&#34;</span><span class="op" id="6565941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6565946">RawQuery</span><span class="op" id="6565954">:</span>&nbsp;<span class="string" id="6565956">&#34;q=go+language&#34;</span><span class="op" id="6565971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6565975">}</span><span class="op" id="6565976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6565980">&#34;opaque?q=go+language&#34;</span><span class="op" id="6566002">,</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566005">}</span><span class="op" id="6566006">,</span><br>
<span class="lineno"></span><span class="op" id="6566008">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566011">func</span>&nbsp;<span class="ident" id="6566016">TestRequestURI</span><span class="op" id="6566030">(</span><span class="ident" id="6566031">t</span>&nbsp;<span class="op" id="6566033">*</span><span class="ident" id="6566034">testing</span><span class="op" id="6566041">.</span><span class="ident" id="6566042">T</span><span class="op" id="6566043">)</span>&nbsp;<span class="op" id="6566045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566048">for</span>&nbsp;<span class="ident" id="6566052">_</span><span class="op" id="6566053">,</span>&nbsp;<span class="ident" id="6566055">tt</span>&nbsp;<span class="op" id="6566058">:=</span>&nbsp;<span class="keyword" id="6566061">range</span>&nbsp;<span class="ident" id="6566067">requritests</span>&nbsp;<span class="op" id="6566079">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566083">s</span>&nbsp;<span class="op" id="6566085">:=</span>&nbsp;<span class="ident" id="6566088">tt</span><span class="op" id="6566090">.</span><span class="ident" id="6566091">url</span><span class="op" id="6566094">.</span><span class="ident" id="6566095">RequestURI</span><span class="op" id="6566105">(</span><span class="op" id="6566106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566110">if</span>&nbsp;<span class="ident" id="6566113">s</span>&nbsp;<span class="op" id="6566115">!=</span>&nbsp;<span class="ident" id="6566118">tt</span><span class="op" id="6566120">.</span><span class="ident" id="6566121">out</span>&nbsp;<span class="op" id="6566125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566130">t</span><span class="op" id="6566131">.</span><span class="ident" id="6566132">Errorf</span><span class="op" id="6566138">(</span><span class="string" id="6566139">&#34;%#v.RequestURI()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="6566177">,</span>&nbsp;<span class="ident" id="6566179">tt</span><span class="op" id="6566181">.</span><span class="ident" id="6566182">url</span><span class="op" id="6566185">,</span>&nbsp;<span class="ident" id="6566187">s</span><span class="op" id="6566188">,</span>&nbsp;<span class="ident" id="6566190">tt</span><span class="op" id="6566192">.</span><span class="ident" id="6566193">out</span><span class="op" id="6566196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566203">}</span><br>
<span class="lineno">905</span><span class="op" id="6566205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566208">func</span>&nbsp;<span class="ident" id="6566213">TestParseFailure</span><span class="op" id="6566229">(</span><span class="ident" id="6566230">t</span>&nbsp;<span class="op" id="6566232">*</span><span class="ident" id="6566233">testing</span><span class="op" id="6566240">.</span><span class="ident" id="6566241">T</span><span class="op" id="6566242">)</span>&nbsp;<span class="op" id="6566244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566247">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;first&nbsp;parse&nbsp;error&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566296">const</span>&nbsp;<span class="ident" id="6566302">url</span>&nbsp;<span class="op" id="6566306">=</span>&nbsp;<span class="string" id="6566308">&#34;%gh&amp;%ij&#34;</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566319">_</span><span class="op" id="6566320">,</span>&nbsp;<span class="ident" id="6566322">err</span>&nbsp;<span class="op" id="6566326">:=</span>&nbsp;<span class="ident" id="6566329">ParseQuery</span><span class="op" id="6566339">(</span><span class="ident" id="6566340">url</span><span class="op" id="6566343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566346">errStr</span>&nbsp;<span class="op" id="6566353">:=</span>&nbsp;<span class="ident" id="6566356">fmt</span><span class="op" id="6566359">.</span><span class="ident" id="6566360">Sprint</span><span class="op" id="6566366">(</span><span class="ident" id="6566367">err</span><span class="op" id="6566370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6566373">if</span>&nbsp;<span class="op" id="6566376">!</span><span class="ident" id="6566377">strings</span><span class="op" id="6566384">.</span><span class="ident" id="6566385">Contains</span><span class="op" id="6566393">(</span><span class="ident" id="6566394">errStr</span><span class="op" id="6566400">,</span>&nbsp;<span class="string" id="6566402">&#34;%gh&#34;</span><span class="op" id="6566407">)</span>&nbsp;<span class="op" id="6566409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566413">t</span><span class="op" id="6566414">.</span><span class="ident" id="6566415">Errorf</span><span class="op" id="6566421">(</span><span class="string" id="6566422">`ParseQuery(%q)&nbsp;returned&nbsp;error&nbsp;%q,&nbsp;want&nbsp;something&nbsp;containing&nbsp;%q&#34;`</span><span class="op" id="6566487">,</span>&nbsp;<span class="ident" id="6566489">url</span><span class="op" id="6566492">,</span>&nbsp;<span class="ident" id="6566494">errStr</span><span class="op" id="6566500">,</span>&nbsp;<span class="string" id="6566502">&#34;%gh&#34;</span><span class="op" id="6566507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566510">}</span><br>
<span class="lineno">915</span><span class="op" id="6566512">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566515">type</span>&nbsp;<span class="ident" id="6566520">shouldEscapeTest</span>&nbsp;<span class="keyword" id="6566537">struct</span>&nbsp;<span class="op" id="6566544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566547">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6566554">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566560">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6566567">encoding</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6566577">escape</span>&nbsp;<span class="builtintype" id="6566584">bool</span><br>
<span class="lineno"></span><span class="op" id="6566589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6566592">var</span>&nbsp;<span class="ident" id="6566596">shouldEscapeTests</span>&nbsp;<span class="op" id="6566614">=</span>&nbsp;<span class="op" id="6566616">[</span><span class="op" id="6566617">]</span><span class="ident" id="6566618">shouldEscapeTest</span><span class="op" id="6566634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6566637">//&nbsp;Unreserved&nbsp;characters&nbsp;(§2.3)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566671">{</span><span class="string" id="6566672">&#39;a&#39;</span><span class="op" id="6566675">,</span>&nbsp;<span class="ident" id="6566677">encodePath</span><span class="op" id="6566687">,</span>&nbsp;<span class="builtintype" id="6566689">false</span><span class="op" id="6566694">}</span><span class="op" id="6566695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566698">{</span><span class="string" id="6566699">&#39;a&#39;</span><span class="op" id="6566702">,</span>&nbsp;<span class="ident" id="6566704">encodeUserPassword</span><span class="op" id="6566722">,</span>&nbsp;<span class="builtintype" id="6566724">false</span><span class="op" id="6566729">}</span><span class="op" id="6566730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566733">{</span><span class="string" id="6566734">&#39;a&#39;</span><span class="op" id="6566737">,</span>&nbsp;<span class="ident" id="6566739">encodeQueryComponent</span><span class="op" id="6566759">,</span>&nbsp;<span class="builtintype" id="6566761">false</span><span class="op" id="6566766">}</span><span class="op" id="6566767">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566770">{</span><span class="string" id="6566771">&#39;a&#39;</span><span class="op" id="6566774">,</span>&nbsp;<span class="ident" id="6566776">encodeFragment</span><span class="op" id="6566790">,</span>&nbsp;<span class="builtintype" id="6566792">false</span><span class="op" id="6566797">}</span><span class="op" id="6566798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566801">{</span><span class="string" id="6566802">&#39;z&#39;</span><span class="op" id="6566805">,</span>&nbsp;<span class="ident" id="6566807">encodePath</span><span class="op" id="6566817">,</span>&nbsp;<span class="builtintype" id="6566819">false</span><span class="op" id="6566824">}</span><span class="op" id="6566825">,</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566828">{</span><span class="string" id="6566829">&#39;A&#39;</span><span class="op" id="6566832">,</span>&nbsp;<span class="ident" id="6566834">encodePath</span><span class="op" id="6566844">,</span>&nbsp;<span class="builtintype" id="6566846">false</span><span class="op" id="6566851">}</span><span class="op" id="6566852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566855">{</span><span class="string" id="6566856">&#39;Z&#39;</span><span class="op" id="6566859">,</span>&nbsp;<span class="ident" id="6566861">encodePath</span><span class="op" id="6566871">,</span>&nbsp;<span class="builtintype" id="6566873">false</span><span class="op" id="6566878">}</span><span class="op" id="6566879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566882">{</span><span class="string" id="6566883">&#39;0&#39;</span><span class="op" id="6566886">,</span>&nbsp;<span class="ident" id="6566888">encodePath</span><span class="op" id="6566898">,</span>&nbsp;<span class="builtintype" id="6566900">false</span><span class="op" id="6566905">}</span><span class="op" id="6566906">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566909">{</span><span class="string" id="6566910">&#39;9&#39;</span><span class="op" id="6566913">,</span>&nbsp;<span class="ident" id="6566915">encodePath</span><span class="op" id="6566925">,</span>&nbsp;<span class="builtintype" id="6566927">false</span><span class="op" id="6566932">}</span><span class="op" id="6566933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566936">{</span><span class="string" id="6566937">&#39;-&#39;</span><span class="op" id="6566940">,</span>&nbsp;<span class="ident" id="6566942">encodePath</span><span class="op" id="6566952">,</span>&nbsp;<span class="builtintype" id="6566954">false</span><span class="op" id="6566959">}</span><span class="op" id="6566960">,</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566963">{</span><span class="string" id="6566964">&#39;-&#39;</span><span class="op" id="6566967">,</span>&nbsp;<span class="ident" id="6566969">encodeUserPassword</span><span class="op" id="6566987">,</span>&nbsp;<span class="builtintype" id="6566989">false</span><span class="op" id="6566994">}</span><span class="op" id="6566995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6566998">{</span><span class="string" id="6566999">&#39;-&#39;</span><span class="op" id="6567002">,</span>&nbsp;<span class="ident" id="6567004">encodeQueryComponent</span><span class="op" id="6567024">,</span>&nbsp;<span class="builtintype" id="6567026">false</span><span class="op" id="6567031">}</span><span class="op" id="6567032">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567035">{</span><span class="string" id="6567036">&#39;-&#39;</span><span class="op" id="6567039">,</span>&nbsp;<span class="ident" id="6567041">encodeFragment</span><span class="op" id="6567055">,</span>&nbsp;<span class="builtintype" id="6567057">false</span><span class="op" id="6567062">}</span><span class="op" id="6567063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567066">{</span><span class="string" id="6567067">&#39;.&#39;</span><span class="op" id="6567070">,</span>&nbsp;<span class="ident" id="6567072">encodePath</span><span class="op" id="6567082">,</span>&nbsp;<span class="builtintype" id="6567084">false</span><span class="op" id="6567089">}</span><span class="op" id="6567090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567093">{</span><span class="string" id="6567094">&#39;_&#39;</span><span class="op" id="6567097">,</span>&nbsp;<span class="ident" id="6567099">encodePath</span><span class="op" id="6567109">,</span>&nbsp;<span class="builtintype" id="6567111">false</span><span class="op" id="6567116">}</span><span class="op" id="6567117">,</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567120">{</span><span class="string" id="6567121">&#39;~&#39;</span><span class="op" id="6567124">,</span>&nbsp;<span class="ident" id="6567126">encodePath</span><span class="op" id="6567136">,</span>&nbsp;<span class="builtintype" id="6567138">false</span><span class="op" id="6567143">}</span><span class="op" id="6567144">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6567148">//&nbsp;User&nbsp;information&nbsp;(§3.2.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567179">{</span><span class="string" id="6567180">&#39;:&#39;</span><span class="op" id="6567183">,</span>&nbsp;<span class="ident" id="6567185">encodeUserPassword</span><span class="op" id="6567203">,</span>&nbsp;<span class="builtintype" id="6567205">true</span><span class="op" id="6567209">}</span><span class="op" id="6567210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567213">{</span><span class="string" id="6567214">&#39;/&#39;</span><span class="op" id="6567217">,</span>&nbsp;<span class="ident" id="6567219">encodeUserPassword</span><span class="op" id="6567237">,</span>&nbsp;<span class="builtintype" id="6567239">true</span><span class="op" id="6567243">}</span><span class="op" id="6567244">,</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567247">{</span><span class="string" id="6567248">&#39;?&#39;</span><span class="op" id="6567251">,</span>&nbsp;<span class="ident" id="6567253">encodeUserPassword</span><span class="op" id="6567271">,</span>&nbsp;<span class="builtintype" id="6567273">true</span><span class="op" id="6567277">}</span><span class="op" id="6567278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567281">{</span><span class="string" id="6567282">&#39;@&#39;</span><span class="op" id="6567285">,</span>&nbsp;<span class="ident" id="6567287">encodeUserPassword</span><span class="op" id="6567305">,</span>&nbsp;<span class="builtintype" id="6567307">true</span><span class="op" id="6567311">}</span><span class="op" id="6567312">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567315">{</span><span class="string" id="6567316">&#39;$&#39;</span><span class="op" id="6567319">,</span>&nbsp;<span class="ident" id="6567321">encodeUserPassword</span><span class="op" id="6567339">,</span>&nbsp;<span class="builtintype" id="6567341">false</span><span class="op" id="6567346">}</span><span class="op" id="6567347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567350">{</span><span class="string" id="6567351">&#39;&amp;&#39;</span><span class="op" id="6567354">,</span>&nbsp;<span class="ident" id="6567356">encodeUserPassword</span><span class="op" id="6567374">,</span>&nbsp;<span class="builtintype" id="6567376">false</span><span class="op" id="6567381">}</span><span class="op" id="6567382">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567385">{</span><span class="string" id="6567386">&#39;+&#39;</span><span class="op" id="6567389">,</span>&nbsp;<span class="ident" id="6567391">encodeUserPassword</span><span class="op" id="6567409">,</span>&nbsp;<span class="builtintype" id="6567411">false</span><span class="op" id="6567416">}</span><span class="op" id="6567417">,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567420">{</span><span class="string" id="6567421">&#39;,&#39;</span><span class="op" id="6567424">,</span>&nbsp;<span class="ident" id="6567426">encodeUserPassword</span><span class="op" id="6567444">,</span>&nbsp;<span class="builtintype" id="6567446">false</span><span class="op" id="6567451">}</span><span class="op" id="6567452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567455">{</span><span class="string" id="6567456">&#39;;&#39;</span><span class="op" id="6567459">,</span>&nbsp;<span class="ident" id="6567461">encodeUserPassword</span><span class="op" id="6567479">,</span>&nbsp;<span class="builtintype" id="6567481">false</span><span class="op" id="6567486">}</span><span class="op" id="6567487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567490">{</span><span class="string" id="6567491">&#39;=&#39;</span><span class="op" id="6567494">,</span>&nbsp;<span class="ident" id="6567496">encodeUserPassword</span><span class="op" id="6567514">,</span>&nbsp;<span class="builtintype" id="6567516">false</span><span class="op" id="6567521">}</span><span class="op" id="6567522">,</span><br>
<span class="lineno"></span><span class="op" id="6567524">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="keyword" id="6567527">func</span>&nbsp;<span class="ident" id="6567532">TestShouldEscape</span><span class="op" id="6567548">(</span><span class="ident" id="6567549">t</span>&nbsp;<span class="op" id="6567551">*</span><span class="ident" id="6567552">testing</span><span class="op" id="6567559">.</span><span class="ident" id="6567560">T</span><span class="op" id="6567561">)</span>&nbsp;<span class="op" id="6567563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567566">for</span>&nbsp;<span class="ident" id="6567570">_</span><span class="op" id="6567571">,</span>&nbsp;<span class="ident" id="6567573">tt</span>&nbsp;<span class="op" id="6567576">:=</span>&nbsp;<span class="keyword" id="6567579">range</span>&nbsp;<span class="ident" id="6567585">shouldEscapeTests</span>&nbsp;<span class="op" id="6567603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6567607">if</span>&nbsp;<span class="ident" id="6567610">shouldEscape</span><span class="op" id="6567622">(</span><span class="ident" id="6567623">tt</span><span class="op" id="6567625">.</span><span class="ident" id="6567626">in</span><span class="op" id="6567628">,</span>&nbsp;<span class="ident" id="6567630">tt</span><span class="op" id="6567632">.</span><span class="ident" id="6567633">mode</span><span class="op" id="6567637">)</span>&nbsp;<span class="op" id="6567639">!=</span>&nbsp;<span class="ident" id="6567642">tt</span><span class="op" id="6567644">.</span><span class="ident" id="6567645">escape</span>&nbsp;<span class="op" id="6567652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6567657">t</span><span class="op" id="6567658">.</span><span class="ident" id="6567659">Errorf</span><span class="op" id="6567665">(</span><span class="string" id="6567666">&#34;shouldEscape(%q,&nbsp;%v)&nbsp;returned&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="6567713">,</span>&nbsp;<span class="ident" id="6567715">tt</span><span class="op" id="6567717">.</span><span class="ident" id="6567718">in</span><span class="op" id="6567720">,</span>&nbsp;<span class="ident" id="6567722">tt</span><span class="op" id="6567724">.</span><span class="ident" id="6567725">mode</span><span class="op" id="6567729">,</span>&nbsp;<span class="op" id="6567731">!</span><span class="ident" id="6567732">tt</span><span class="op" id="6567734">.</span><span class="ident" id="6567735">escape</span><span class="op" id="6567741">,</span>&nbsp;<span class="ident" id="6567743">tt</span><span class="op" id="6567745">.</span><span class="ident" id="6567746">escape</span><span class="op" id="6567752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567756">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6567759">}</span><br>
<span class="lineno"></span><span class="op" id="6567761">}</span>
</div>
</body>
</html>
