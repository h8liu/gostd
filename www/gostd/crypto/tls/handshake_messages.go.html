<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4135502">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4135557">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4135611">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4135662">package</span>&nbsp;<span class="ident" id="4135670">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4135675">import</span>&nbsp;<span class="string" id="4135682">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4135691">type</span>&nbsp;<span class="ident" id="4135696">clientHelloMsg</span>&nbsp;<span class="keyword" id="4135711">struct</span>&nbsp;<span class="op" id="4135718">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135721">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4135741">[</span><span class="op" id="4135742">]</span><span class="builtintype" id="4135743">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135749">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4135769">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135777">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4135797">[</span><span class="op" id="4135798">]</span><span class="builtintype" id="4135799">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135805">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4135825">[</span><span class="op" id="4135826">]</span><span class="builtintype" id="4135827">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135833">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4135853">[</span><span class="op" id="4135854">]</span><span class="builtintype" id="4135855">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135863">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="4135883">[</span><span class="op" id="4135884">]</span><span class="builtintype" id="4135885">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135892">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4135912">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135918">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4135938">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135946">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4135966">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4135972">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4135992">[</span><span class="op" id="4135993">]</span><span class="ident" id="4135994">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136003">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4136023">[</span><span class="op" id="4136024">]</span><span class="builtintype" id="4136025">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136032">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4136052">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136058">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4136078">[</span><span class="op" id="4136079">]</span><span class="builtintype" id="4136080">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136087">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="4136107">[</span><span class="op" id="4136108">]</span><span class="ident" id="4136109">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136127">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4136147">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136153">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4136173">[</span><span class="op" id="4136174">]</span><span class="builtintype" id="4136175">string</span><br>
<span class="lineno"></span><span class="op" id="4136182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4136185">func</span>&nbsp;<span class="op" id="4136190">(</span><span class="ident" id="4136191">m</span>&nbsp;<span class="op" id="4136193">*</span><span class="ident" id="4136194">clientHelloMsg</span><span class="op" id="4136208">)</span>&nbsp;<span class="ident" id="4136210">equal</span><span class="op" id="4136215">(</span><span class="ident" id="4136216">i</span>&nbsp;<span class="keyword" id="4136218">interface</span><span class="op" id="4136227">{</span><span class="op" id="4136228">}</span><span class="op" id="4136229">)</span>&nbsp;<span class="builtintype" id="4136231">bool</span>&nbsp;<span class="op" id="4136236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136239">m1</span><span class="op" id="4136241">,</span>&nbsp;<span class="ident" id="4136243">ok</span>&nbsp;<span class="op" id="4136246">:=</span>&nbsp;<span class="ident" id="4136249">i</span><span class="op" id="4136250">.</span><span class="op" id="4136251">(</span><span class="op" id="4136252">*</span><span class="ident" id="4136253">clientHelloMsg</span><span class="op" id="4136267">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136270">if</span>&nbsp;<span class="op" id="4136273">!</span><span class="ident" id="4136274">ok</span>&nbsp;<span class="op" id="4136277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136281">return</span>&nbsp;<span class="builtintype" id="4136288">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4136295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4136299">return</span>&nbsp;<span class="ident" id="4136306">bytes</span><span class="op" id="4136311">.</span><span class="ident" id="4136312">Equal</span><span class="op" id="4136317">(</span><span class="ident" id="4136318">m</span><span class="op" id="4136319">.</span><span class="ident" id="4136320">raw</span><span class="op" id="4136323">,</span>&nbsp;<span class="ident" id="4136325">m1</span><span class="op" id="4136327">.</span><span class="ident" id="4136328">raw</span><span class="op" id="4136331">)</span>&nbsp;<span class="op" id="4136333">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136338">m</span><span class="op" id="4136339">.</span><span class="ident" id="4136340">vers</span>&nbsp;<span class="op" id="4136345">==</span>&nbsp;<span class="ident" id="4136348">m1</span><span class="op" id="4136350">.</span><span class="ident" id="4136351">vers</span>&nbsp;<span class="op" id="4136356">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136361">bytes</span><span class="op" id="4136366">.</span><span class="ident" id="4136367">Equal</span><span class="op" id="4136372">(</span><span class="ident" id="4136373">m</span><span class="op" id="4136374">.</span><span class="ident" id="4136375">random</span><span class="op" id="4136381">,</span>&nbsp;<span class="ident" id="4136383">m1</span><span class="op" id="4136385">.</span><span class="ident" id="4136386">random</span><span class="op" id="4136392">)</span>&nbsp;<span class="op" id="4136394">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136399">bytes</span><span class="op" id="4136404">.</span><span class="ident" id="4136405">Equal</span><span class="op" id="4136410">(</span><span class="ident" id="4136411">m</span><span class="op" id="4136412">.</span><span class="ident" id="4136413">sessionId</span><span class="op" id="4136422">,</span>&nbsp;<span class="ident" id="4136424">m1</span><span class="op" id="4136426">.</span><span class="ident" id="4136427">sessionId</span><span class="op" id="4136436">)</span>&nbsp;<span class="op" id="4136438">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136443">eqUint16s</span><span class="op" id="4136452">(</span><span class="ident" id="4136453">m</span><span class="op" id="4136454">.</span><span class="ident" id="4136455">cipherSuites</span><span class="op" id="4136467">,</span>&nbsp;<span class="ident" id="4136469">m1</span><span class="op" id="4136471">.</span><span class="ident" id="4136472">cipherSuites</span><span class="op" id="4136484">)</span>&nbsp;<span class="op" id="4136486">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136491">bytes</span><span class="op" id="4136496">.</span><span class="ident" id="4136497">Equal</span><span class="op" id="4136502">(</span><span class="ident" id="4136503">m</span><span class="op" id="4136504">.</span><span class="ident" id="4136505">compressionMethods</span><span class="op" id="4136523">,</span>&nbsp;<span class="ident" id="4136525">m1</span><span class="op" id="4136527">.</span><span class="ident" id="4136528">compressionMethods</span><span class="op" id="4136546">)</span>&nbsp;<span class="op" id="4136548">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136553">m</span><span class="op" id="4136554">.</span><span class="ident" id="4136555">nextProtoNeg</span>&nbsp;<span class="op" id="4136568">==</span>&nbsp;<span class="ident" id="4136571">m1</span><span class="op" id="4136573">.</span><span class="ident" id="4136574">nextProtoNeg</span>&nbsp;<span class="op" id="4136587">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136592">m</span><span class="op" id="4136593">.</span><span class="ident" id="4136594">serverName</span>&nbsp;<span class="op" id="4136605">==</span>&nbsp;<span class="ident" id="4136608">m1</span><span class="op" id="4136610">.</span><span class="ident" id="4136611">serverName</span>&nbsp;<span class="op" id="4136622">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136627">m</span><span class="op" id="4136628">.</span><span class="ident" id="4136629">ocspStapling</span>&nbsp;<span class="op" id="4136642">==</span>&nbsp;<span class="ident" id="4136645">m1</span><span class="op" id="4136647">.</span><span class="ident" id="4136648">ocspStapling</span>&nbsp;<span class="op" id="4136661">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136666">eqCurveIDs</span><span class="op" id="4136676">(</span><span class="ident" id="4136677">m</span><span class="op" id="4136678">.</span><span class="ident" id="4136679">supportedCurves</span><span class="op" id="4136694">,</span>&nbsp;<span class="ident" id="4136696">m1</span><span class="op" id="4136698">.</span><span class="ident" id="4136699">supportedCurves</span><span class="op" id="4136714">)</span>&nbsp;<span class="op" id="4136716">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136721">bytes</span><span class="op" id="4136726">.</span><span class="ident" id="4136727">Equal</span><span class="op" id="4136732">(</span><span class="ident" id="4136733">m</span><span class="op" id="4136734">.</span><span class="ident" id="4136735">supportedPoints</span><span class="op" id="4136750">,</span>&nbsp;<span class="ident" id="4136752">m1</span><span class="op" id="4136754">.</span><span class="ident" id="4136755">supportedPoints</span><span class="op" id="4136770">)</span>&nbsp;<span class="op" id="4136772">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136777">m</span><span class="op" id="4136778">.</span><span class="ident" id="4136779">ticketSupported</span>&nbsp;<span class="op" id="4136795">==</span>&nbsp;<span class="ident" id="4136798">m1</span><span class="op" id="4136800">.</span><span class="ident" id="4136801">ticketSupported</span>&nbsp;<span class="op" id="4136817">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136822">bytes</span><span class="op" id="4136827">.</span><span class="ident" id="4136828">Equal</span><span class="op" id="4136833">(</span><span class="ident" id="4136834">m</span><span class="op" id="4136835">.</span><span class="ident" id="4136836">sessionTicket</span><span class="op" id="4136849">,</span>&nbsp;<span class="ident" id="4136851">m1</span><span class="op" id="4136853">.</span><span class="ident" id="4136854">sessionTicket</span><span class="op" id="4136867">)</span>&nbsp;<span class="op" id="4136869">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136874">eqSignatureAndHashes</span><span class="op" id="4136894">(</span><span class="ident" id="4136895">m</span><span class="op" id="4136896">.</span><span class="ident" id="4136897">signatureAndHashes</span><span class="op" id="4136915">,</span>&nbsp;<span class="ident" id="4136917">m1</span><span class="op" id="4136919">.</span><span class="ident" id="4136920">signatureAndHashes</span><span class="op" id="4136938">)</span>&nbsp;<span class="op" id="4136940">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136945">m</span><span class="op" id="4136946">.</span><span class="ident" id="4136947">secureRenegotiation</span>&nbsp;<span class="op" id="4136967">==</span>&nbsp;<span class="ident" id="4136970">m1</span><span class="op" id="4136972">.</span><span class="ident" id="4136973">secureRenegotiation</span>&nbsp;<span class="op" id="4136993">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4136998">eqStrings</span><span class="op" id="4137007">(</span><span class="ident" id="4137008">m</span><span class="op" id="4137009">.</span><span class="ident" id="4137010">alpnProtocols</span><span class="op" id="4137023">,</span>&nbsp;<span class="ident" id="4137025">m1</span><span class="op" id="4137027">.</span><span class="ident" id="4137028">alpnProtocols</span><span class="op" id="4137041">)</span><br>
<span class="lineno">50</span><span class="op" id="4137043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4137046">func</span>&nbsp;<span class="op" id="4137051">(</span><span class="ident" id="4137052">m</span>&nbsp;<span class="op" id="4137054">*</span><span class="ident" id="4137055">clientHelloMsg</span><span class="op" id="4137069">)</span>&nbsp;<span class="ident" id="4137071">marshal</span><span class="op" id="4137078">(</span><span class="op" id="4137079">)</span>&nbsp;<span class="op" id="4137081">[</span><span class="op" id="4137082">]</span><span class="builtintype" id="4137083">byte</span>&nbsp;<span class="op" id="4137088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137091">if</span>&nbsp;<span class="ident" id="4137094">m</span><span class="op" id="4137095">.</span><span class="ident" id="4137096">raw</span>&nbsp;<span class="op" id="4137100">!=</span>&nbsp;<span class="ident" id="4137103">nil</span>&nbsp;<span class="op" id="4137107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137111">return</span>&nbsp;<span class="ident" id="4137118">m</span><span class="op" id="4137119">.</span><span class="ident" id="4137120">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137129">length</span>&nbsp;<span class="op" id="4137136">:=</span>&nbsp;<span class="num" id="4137139">2</span>&nbsp;<span class="op" id="4137141">+</span>&nbsp;<span class="num" id="4137143">32</span>&nbsp;<span class="op" id="4137146">+</span>&nbsp;<span class="num" id="4137148">1</span>&nbsp;<span class="op" id="4137150">+</span>&nbsp;<span class="builtinfunc" id="4137152">len</span><span class="op" id="4137155">(</span><span class="ident" id="4137156">m</span><span class="op" id="4137157">.</span><span class="ident" id="4137158">sessionId</span><span class="op" id="4137167">)</span>&nbsp;<span class="op" id="4137169">+</span>&nbsp;<span class="num" id="4137171">2</span>&nbsp;<span class="op" id="4137173">+</span>&nbsp;<span class="builtinfunc" id="4137175">len</span><span class="op" id="4137178">(</span><span class="ident" id="4137179">m</span><span class="op" id="4137180">.</span><span class="ident" id="4137181">cipherSuites</span><span class="op" id="4137193">)</span><span class="op" id="4137194">*</span><span class="num" id="4137195">2</span>&nbsp;<span class="op" id="4137197">+</span>&nbsp;<span class="num" id="4137199">1</span>&nbsp;<span class="op" id="4137201">+</span>&nbsp;<span class="builtinfunc" id="4137203">len</span><span class="op" id="4137206">(</span><span class="ident" id="4137207">m</span><span class="op" id="4137208">.</span><span class="ident" id="4137209">compressionMethods</span><span class="op" id="4137227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137230">numExtensions</span>&nbsp;<span class="op" id="4137244">:=</span>&nbsp;<span class="num" id="4137247">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137250">extensionsLength</span>&nbsp;<span class="op" id="4137267">:=</span>&nbsp;<span class="num" id="4137270">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137273">if</span>&nbsp;<span class="ident" id="4137276">m</span><span class="op" id="4137277">.</span><span class="ident" id="4137278">nextProtoNeg</span>&nbsp;<span class="op" id="4137291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137295">numExtensions</span><span class="op" id="4137308">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137315">if</span>&nbsp;<span class="ident" id="4137318">m</span><span class="op" id="4137319">.</span><span class="ident" id="4137320">ocspStapling</span>&nbsp;<span class="op" id="4137333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137337">extensionsLength</span>&nbsp;<span class="op" id="4137354">+=</span>&nbsp;<span class="num" id="4137357">1</span>&nbsp;<span class="op" id="4137359">+</span>&nbsp;<span class="num" id="4137361">2</span>&nbsp;<span class="op" id="4137363">+</span>&nbsp;<span class="num" id="4137365">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137369">numExtensions</span><span class="op" id="4137382">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137389">if</span>&nbsp;<span class="builtinfunc" id="4137392">len</span><span class="op" id="4137395">(</span><span class="ident" id="4137396">m</span><span class="op" id="4137397">.</span><span class="ident" id="4137398">serverName</span><span class="op" id="4137408">)</span>&nbsp;<span class="op" id="4137410">&gt;</span>&nbsp;<span class="num" id="4137412">0</span>&nbsp;<span class="op" id="4137414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137418">extensionsLength</span>&nbsp;<span class="op" id="4137435">+=</span>&nbsp;<span class="num" id="4137438">5</span>&nbsp;<span class="op" id="4137440">+</span>&nbsp;<span class="builtinfunc" id="4137442">len</span><span class="op" id="4137445">(</span><span class="ident" id="4137446">m</span><span class="op" id="4137447">.</span><span class="ident" id="4137448">serverName</span><span class="op" id="4137458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137462">numExtensions</span><span class="op" id="4137475">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137482">if</span>&nbsp;<span class="builtinfunc" id="4137485">len</span><span class="op" id="4137488">(</span><span class="ident" id="4137489">m</span><span class="op" id="4137490">.</span><span class="ident" id="4137491">supportedCurves</span><span class="op" id="4137506">)</span>&nbsp;<span class="op" id="4137508">&gt;</span>&nbsp;<span class="num" id="4137510">0</span>&nbsp;<span class="op" id="4137512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137516">extensionsLength</span>&nbsp;<span class="op" id="4137533">+=</span>&nbsp;<span class="num" id="4137536">2</span>&nbsp;<span class="op" id="4137538">+</span>&nbsp;<span class="num" id="4137540">2</span><span class="op" id="4137541">*</span><span class="builtinfunc" id="4137542">len</span><span class="op" id="4137545">(</span><span class="ident" id="4137546">m</span><span class="op" id="4137547">.</span><span class="ident" id="4137548">supportedCurves</span><span class="op" id="4137563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137567">numExtensions</span><span class="op" id="4137580">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137584">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137587">if</span>&nbsp;<span class="builtinfunc" id="4137590">len</span><span class="op" id="4137593">(</span><span class="ident" id="4137594">m</span><span class="op" id="4137595">.</span><span class="ident" id="4137596">supportedPoints</span><span class="op" id="4137611">)</span>&nbsp;<span class="op" id="4137613">&gt;</span>&nbsp;<span class="num" id="4137615">0</span>&nbsp;<span class="op" id="4137617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137621">extensionsLength</span>&nbsp;<span class="op" id="4137638">+=</span>&nbsp;<span class="num" id="4137641">1</span>&nbsp;<span class="op" id="4137643">+</span>&nbsp;<span class="builtinfunc" id="4137645">len</span><span class="op" id="4137648">(</span><span class="ident" id="4137649">m</span><span class="op" id="4137650">.</span><span class="ident" id="4137651">supportedPoints</span><span class="op" id="4137666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137670">numExtensions</span><span class="op" id="4137683">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137690">if</span>&nbsp;<span class="ident" id="4137693">m</span><span class="op" id="4137694">.</span><span class="ident" id="4137695">ticketSupported</span>&nbsp;<span class="op" id="4137711">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137715">extensionsLength</span>&nbsp;<span class="op" id="4137732">+=</span>&nbsp;<span class="builtinfunc" id="4137735">len</span><span class="op" id="4137738">(</span><span class="ident" id="4137739">m</span><span class="op" id="4137740">.</span><span class="ident" id="4137741">sessionTicket</span><span class="op" id="4137754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137758">numExtensions</span><span class="op" id="4137771">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137778">if</span>&nbsp;<span class="builtinfunc" id="4137781">len</span><span class="op" id="4137784">(</span><span class="ident" id="4137785">m</span><span class="op" id="4137786">.</span><span class="ident" id="4137787">signatureAndHashes</span><span class="op" id="4137805">)</span>&nbsp;<span class="op" id="4137807">&gt;</span>&nbsp;<span class="num" id="4137809">0</span>&nbsp;<span class="op" id="4137811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137815">extensionsLength</span>&nbsp;<span class="op" id="4137832">+=</span>&nbsp;<span class="num" id="4137835">2</span>&nbsp;<span class="op" id="4137837">+</span>&nbsp;<span class="num" id="4137839">2</span><span class="op" id="4137840">*</span><span class="builtinfunc" id="4137841">len</span><span class="op" id="4137844">(</span><span class="ident" id="4137845">m</span><span class="op" id="4137846">.</span><span class="ident" id="4137847">signatureAndHashes</span><span class="op" id="4137865">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137869">numExtensions</span><span class="op" id="4137882">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137889">if</span>&nbsp;<span class="ident" id="4137892">m</span><span class="op" id="4137893">.</span><span class="ident" id="4137894">secureRenegotiation</span>&nbsp;<span class="op" id="4137914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137918">extensionsLength</span>&nbsp;<span class="op" id="4137935">+=</span>&nbsp;<span class="num" id="4137938">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137942">numExtensions</span><span class="op" id="4137955">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4137959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4137962">if</span>&nbsp;<span class="builtinfunc" id="4137965">len</span><span class="op" id="4137968">(</span><span class="ident" id="4137969">m</span><span class="op" id="4137970">.</span><span class="ident" id="4137971">alpnProtocols</span><span class="op" id="4137984">)</span>&nbsp;<span class="op" id="4137986">&gt;</span>&nbsp;<span class="num" id="4137988">0</span>&nbsp;<span class="op" id="4137990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4137994">extensionsLength</span>&nbsp;<span class="op" id="4138011">+=</span>&nbsp;<span class="num" id="4138014">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138018">for</span>&nbsp;<span class="ident" id="4138022">_</span><span class="op" id="4138023">,</span>&nbsp;<span class="ident" id="4138025">s</span>&nbsp;<span class="op" id="4138027">:=</span>&nbsp;<span class="keyword" id="4138030">range</span>&nbsp;<span class="ident" id="4138036">m</span><span class="op" id="4138037">.</span><span class="ident" id="4138038">alpnProtocols</span>&nbsp;<span class="op" id="4138052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138057">if</span>&nbsp;<span class="ident" id="4138060">l</span>&nbsp;<span class="op" id="4138062">:=</span>&nbsp;<span class="builtinfunc" id="4138065">len</span><span class="op" id="4138068">(</span><span class="ident" id="4138069">s</span><span class="op" id="4138070">)</span><span class="op" id="4138071">;</span>&nbsp;<span class="ident" id="4138073">l</span>&nbsp;<span class="op" id="4138075">==</span>&nbsp;<span class="num" id="4138078">0</span>&nbsp;<span class="op" id="4138080">||</span>&nbsp;<span class="ident" id="4138083">l</span>&nbsp;<span class="op" id="4138085">&gt;</span>&nbsp;<span class="num" id="4138087">255</span>&nbsp;<span class="op" id="4138091">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4138097">panic</span><span class="op" id="4138102">(</span><span class="string" id="4138103">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4138126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138136">extensionsLength</span><span class="op" id="4138152">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138158">extensionsLength</span>&nbsp;<span class="op" id="4138175">+=</span>&nbsp;<span class="builtinfunc" id="4138178">len</span><span class="op" id="4138181">(</span><span class="ident" id="4138182">s</span><span class="op" id="4138183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138187">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138191">numExtensions</span><span class="op" id="4138204">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138211">if</span>&nbsp;<span class="ident" id="4138214">numExtensions</span>&nbsp;<span class="op" id="4138228">&gt;</span>&nbsp;<span class="num" id="4138230">0</span>&nbsp;<span class="op" id="4138232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138236">extensionsLength</span>&nbsp;<span class="op" id="4138253">+=</span>&nbsp;<span class="num" id="4138256">4</span>&nbsp;<span class="op" id="4138258">*</span>&nbsp;<span class="ident" id="4138260">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138276">length</span>&nbsp;<span class="op" id="4138283">+=</span>&nbsp;<span class="num" id="4138286">2</span>&nbsp;<span class="op" id="4138288">+</span>&nbsp;<span class="ident" id="4138290">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138312">x</span>&nbsp;<span class="op" id="4138314">:=</span>&nbsp;<span class="builtinfunc" id="4138317">make</span><span class="op" id="4138321">(</span><span class="op" id="4138322">[</span><span class="op" id="4138323">]</span><span class="builtintype" id="4138324">byte</span><span class="op" id="4138328">,</span>&nbsp;<span class="num" id="4138330">4</span><span class="op" id="4138331">+</span><span class="ident" id="4138332">length</span><span class="op" id="4138338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138341">x</span><span class="op" id="4138342">[</span><span class="num" id="4138343">0</span><span class="op" id="4138344">]</span>&nbsp;<span class="op" id="4138346">=</span>&nbsp;<span class="ident" id="4138348">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138365">x</span><span class="op" id="4138366">[</span><span class="num" id="4138367">1</span><span class="op" id="4138368">]</span>&nbsp;<span class="op" id="4138370">=</span>&nbsp;<span class="builtintype" id="4138372">uint8</span><span class="op" id="4138377">(</span><span class="ident" id="4138378">length</span>&nbsp;<span class="op" id="4138385">&gt;&gt;</span>&nbsp;<span class="num" id="4138388">16</span><span class="op" id="4138390">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138393">x</span><span class="op" id="4138394">[</span><span class="num" id="4138395">2</span><span class="op" id="4138396">]</span>&nbsp;<span class="op" id="4138398">=</span>&nbsp;<span class="builtintype" id="4138400">uint8</span><span class="op" id="4138405">(</span><span class="ident" id="4138406">length</span>&nbsp;<span class="op" id="4138413">&gt;&gt;</span>&nbsp;<span class="num" id="4138416">8</span><span class="op" id="4138417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138420">x</span><span class="op" id="4138421">[</span><span class="num" id="4138422">3</span><span class="op" id="4138423">]</span>&nbsp;<span class="op" id="4138425">=</span>&nbsp;<span class="builtintype" id="4138427">uint8</span><span class="op" id="4138432">(</span><span class="ident" id="4138433">length</span><span class="op" id="4138439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138442">x</span><span class="op" id="4138443">[</span><span class="num" id="4138444">4</span><span class="op" id="4138445">]</span>&nbsp;<span class="op" id="4138447">=</span>&nbsp;<span class="builtintype" id="4138449">uint8</span><span class="op" id="4138454">(</span><span class="ident" id="4138455">m</span><span class="op" id="4138456">.</span><span class="ident" id="4138457">vers</span>&nbsp;<span class="op" id="4138462">&gt;&gt;</span>&nbsp;<span class="num" id="4138465">8</span><span class="op" id="4138466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138469">x</span><span class="op" id="4138470">[</span><span class="num" id="4138471">5</span><span class="op" id="4138472">]</span>&nbsp;<span class="op" id="4138474">=</span>&nbsp;<span class="builtintype" id="4138476">uint8</span><span class="op" id="4138481">(</span><span class="ident" id="4138482">m</span><span class="op" id="4138483">.</span><span class="ident" id="4138484">vers</span><span class="op" id="4138488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4138491">copy</span><span class="op" id="4138495">(</span><span class="ident" id="4138496">x</span><span class="op" id="4138497">[</span><span class="num" id="4138498">6</span><span class="op" id="4138499">:</span><span class="num" id="4138500">38</span><span class="op" id="4138502">]</span><span class="op" id="4138503">,</span>&nbsp;<span class="ident" id="4138505">m</span><span class="op" id="4138506">.</span><span class="ident" id="4138507">random</span><span class="op" id="4138513">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138516">x</span><span class="op" id="4138517">[</span><span class="num" id="4138518">38</span><span class="op" id="4138520">]</span>&nbsp;<span class="op" id="4138522">=</span>&nbsp;<span class="builtintype" id="4138524">uint8</span><span class="op" id="4138529">(</span><span class="builtinfunc" id="4138530">len</span><span class="op" id="4138533">(</span><span class="ident" id="4138534">m</span><span class="op" id="4138535">.</span><span class="ident" id="4138536">sessionId</span><span class="op" id="4138545">)</span><span class="op" id="4138546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4138549">copy</span><span class="op" id="4138553">(</span><span class="ident" id="4138554">x</span><span class="op" id="4138555">[</span><span class="num" id="4138556">39</span><span class="op" id="4138558">:</span><span class="num" id="4138559">39</span><span class="op" id="4138561">+</span><span class="builtinfunc" id="4138562">len</span><span class="op" id="4138565">(</span><span class="ident" id="4138566">m</span><span class="op" id="4138567">.</span><span class="ident" id="4138568">sessionId</span><span class="op" id="4138577">)</span><span class="op" id="4138578">]</span><span class="op" id="4138579">,</span>&nbsp;<span class="ident" id="4138581">m</span><span class="op" id="4138582">.</span><span class="ident" id="4138583">sessionId</span><span class="op" id="4138592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138595">y</span>&nbsp;<span class="op" id="4138597">:=</span>&nbsp;<span class="ident" id="4138600">x</span><span class="op" id="4138601">[</span><span class="num" id="4138602">39</span><span class="op" id="4138604">+</span><span class="builtinfunc" id="4138605">len</span><span class="op" id="4138608">(</span><span class="ident" id="4138609">m</span><span class="op" id="4138610">.</span><span class="ident" id="4138611">sessionId</span><span class="op" id="4138620">)</span><span class="op" id="4138621">:</span><span class="op" id="4138622">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138625">y</span><span class="op" id="4138626">[</span><span class="num" id="4138627">0</span><span class="op" id="4138628">]</span>&nbsp;<span class="op" id="4138630">=</span>&nbsp;<span class="builtintype" id="4138632">uint8</span><span class="op" id="4138637">(</span><span class="builtinfunc" id="4138638">len</span><span class="op" id="4138641">(</span><span class="ident" id="4138642">m</span><span class="op" id="4138643">.</span><span class="ident" id="4138644">cipherSuites</span><span class="op" id="4138656">)</span>&nbsp;<span class="op" id="4138658">&gt;&gt;</span>&nbsp;<span class="num" id="4138661">7</span><span class="op" id="4138662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138665">y</span><span class="op" id="4138666">[</span><span class="num" id="4138667">1</span><span class="op" id="4138668">]</span>&nbsp;<span class="op" id="4138670">=</span>&nbsp;<span class="builtintype" id="4138672">uint8</span><span class="op" id="4138677">(</span><span class="builtinfunc" id="4138678">len</span><span class="op" id="4138681">(</span><span class="ident" id="4138682">m</span><span class="op" id="4138683">.</span><span class="ident" id="4138684">cipherSuites</span><span class="op" id="4138696">)</span>&nbsp;<span class="op" id="4138698">&lt;&lt;</span>&nbsp;<span class="num" id="4138701">1</span><span class="op" id="4138702">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138705">for</span>&nbsp;<span class="ident" id="4138709">i</span><span class="op" id="4138710">,</span>&nbsp;<span class="ident" id="4138712">suite</span>&nbsp;<span class="op" id="4138718">:=</span>&nbsp;<span class="keyword" id="4138721">range</span>&nbsp;<span class="ident" id="4138727">m</span><span class="op" id="4138728">.</span><span class="ident" id="4138729">cipherSuites</span>&nbsp;<span class="op" id="4138742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138746">y</span><span class="op" id="4138747">[</span><span class="num" id="4138748">2</span><span class="op" id="4138749">+</span><span class="ident" id="4138750">i</span><span class="op" id="4138751">*</span><span class="num" id="4138752">2</span><span class="op" id="4138753">]</span>&nbsp;<span class="op" id="4138755">=</span>&nbsp;<span class="builtintype" id="4138757">uint8</span><span class="op" id="4138762">(</span><span class="ident" id="4138763">suite</span>&nbsp;<span class="op" id="4138769">&gt;&gt;</span>&nbsp;<span class="num" id="4138772">8</span><span class="op" id="4138773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138777">y</span><span class="op" id="4138778">[</span><span class="num" id="4138779">3</span><span class="op" id="4138780">+</span><span class="ident" id="4138781">i</span><span class="op" id="4138782">*</span><span class="num" id="4138783">2</span><span class="op" id="4138784">]</span>&nbsp;<span class="op" id="4138786">=</span>&nbsp;<span class="builtintype" id="4138788">uint8</span><span class="op" id="4138793">(</span><span class="ident" id="4138794">suite</span><span class="op" id="4138799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4138802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138805">z</span>&nbsp;<span class="op" id="4138807">:=</span>&nbsp;<span class="ident" id="4138810">y</span><span class="op" id="4138811">[</span><span class="num" id="4138812">2</span><span class="op" id="4138813">+</span><span class="builtinfunc" id="4138814">len</span><span class="op" id="4138817">(</span><span class="ident" id="4138818">m</span><span class="op" id="4138819">.</span><span class="ident" id="4138820">cipherSuites</span><span class="op" id="4138832">)</span><span class="op" id="4138833">*</span><span class="num" id="4138834">2</span><span class="op" id="4138835">:</span><span class="op" id="4138836">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138839">z</span><span class="op" id="4138840">[</span><span class="num" id="4138841">0</span><span class="op" id="4138842">]</span>&nbsp;<span class="op" id="4138844">=</span>&nbsp;<span class="builtintype" id="4138846">uint8</span><span class="op" id="4138851">(</span><span class="builtinfunc" id="4138852">len</span><span class="op" id="4138855">(</span><span class="ident" id="4138856">m</span><span class="op" id="4138857">.</span><span class="ident" id="4138858">compressionMethods</span><span class="op" id="4138876">)</span><span class="op" id="4138877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4138880">copy</span><span class="op" id="4138884">(</span><span class="ident" id="4138885">z</span><span class="op" id="4138886">[</span><span class="num" id="4138887">1</span><span class="op" id="4138888">:</span><span class="op" id="4138889">]</span><span class="op" id="4138890">,</span>&nbsp;<span class="ident" id="4138892">m</span><span class="op" id="4138893">.</span><span class="ident" id="4138894">compressionMethods</span><span class="op" id="4138912">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138916">z</span>&nbsp;<span class="op" id="4138918">=</span>&nbsp;<span class="ident" id="4138920">z</span><span class="op" id="4138921">[</span><span class="num" id="4138922">1</span><span class="op" id="4138923">+</span><span class="builtinfunc" id="4138924">len</span><span class="op" id="4138927">(</span><span class="ident" id="4138928">m</span><span class="op" id="4138929">.</span><span class="ident" id="4138930">compressionMethods</span><span class="op" id="4138948">)</span><span class="op" id="4138949">:</span><span class="op" id="4138950">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4138953">if</span>&nbsp;<span class="ident" id="4138956">numExtensions</span>&nbsp;<span class="op" id="4138970">&gt;</span>&nbsp;<span class="num" id="4138972">0</span>&nbsp;<span class="op" id="4138974">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4138978">z</span><span class="op" id="4138979">[</span><span class="num" id="4138980">0</span><span class="op" id="4138981">]</span>&nbsp;<span class="op" id="4138983">=</span>&nbsp;<span class="builtintype" id="4138985">byte</span><span class="op" id="4138989">(</span><span class="ident" id="4138990">extensionsLength</span>&nbsp;<span class="op" id="4139007">&gt;&gt;</span>&nbsp;<span class="num" id="4139010">8</span><span class="op" id="4139011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139015">z</span><span class="op" id="4139016">[</span><span class="num" id="4139017">1</span><span class="op" id="4139018">]</span>&nbsp;<span class="op" id="4139020">=</span>&nbsp;<span class="builtintype" id="4139022">byte</span><span class="op" id="4139026">(</span><span class="ident" id="4139027">extensionsLength</span><span class="op" id="4139043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139047">z</span>&nbsp;<span class="op" id="4139049">=</span>&nbsp;<span class="ident" id="4139051">z</span><span class="op" id="4139052">[</span><span class="num" id="4139053">2</span><span class="op" id="4139054">:</span><span class="op" id="4139055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139061">if</span>&nbsp;<span class="ident" id="4139064">m</span><span class="op" id="4139065">.</span><span class="ident" id="4139066">nextProtoNeg</span>&nbsp;<span class="op" id="4139079">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139083">z</span><span class="op" id="4139084">[</span><span class="num" id="4139085">0</span><span class="op" id="4139086">]</span>&nbsp;<span class="op" id="4139088">=</span>&nbsp;<span class="builtintype" id="4139090">byte</span><span class="op" id="4139094">(</span><span class="ident" id="4139095">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4139117">&gt;&gt;</span>&nbsp;<span class="num" id="4139120">8</span><span class="op" id="4139121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139125">z</span><span class="op" id="4139126">[</span><span class="num" id="4139127">1</span><span class="op" id="4139128">]</span>&nbsp;<span class="op" id="4139130">=</span>&nbsp;<span class="builtintype" id="4139132">byte</span><span class="op" id="4139136">(</span><span class="ident" id="4139137">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4139159">&amp;</span>&nbsp;<span class="num" id="4139161">0xff</span><span class="op" id="4139165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139169">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139197">z</span>&nbsp;<span class="op" id="4139199">=</span>&nbsp;<span class="ident" id="4139201">z</span><span class="op" id="4139202">[</span><span class="num" id="4139203">4</span><span class="op" id="4139204">:</span><span class="op" id="4139205">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139208">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139211">if</span>&nbsp;<span class="builtinfunc" id="4139214">len</span><span class="op" id="4139217">(</span><span class="ident" id="4139218">m</span><span class="op" id="4139219">.</span><span class="ident" id="4139220">serverName</span><span class="op" id="4139230">)</span>&nbsp;<span class="op" id="4139232">&gt;</span>&nbsp;<span class="num" id="4139234">0</span>&nbsp;<span class="op" id="4139236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139240">z</span><span class="op" id="4139241">[</span><span class="num" id="4139242">0</span><span class="op" id="4139243">]</span>&nbsp;<span class="op" id="4139245">=</span>&nbsp;<span class="builtintype" id="4139247">byte</span><span class="op" id="4139251">(</span><span class="ident" id="4139252">extensionServerName</span>&nbsp;<span class="op" id="4139272">&gt;&gt;</span>&nbsp;<span class="num" id="4139275">8</span><span class="op" id="4139276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139280">z</span><span class="op" id="4139281">[</span><span class="num" id="4139282">1</span><span class="op" id="4139283">]</span>&nbsp;<span class="op" id="4139285">=</span>&nbsp;<span class="builtintype" id="4139287">byte</span><span class="op" id="4139291">(</span><span class="ident" id="4139292">extensionServerName</span>&nbsp;<span class="op" id="4139312">&amp;</span>&nbsp;<span class="num" id="4139314">0xff</span><span class="op" id="4139318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139322">l</span>&nbsp;<span class="op" id="4139324">:=</span>&nbsp;<span class="builtinfunc" id="4139327">len</span><span class="op" id="4139330">(</span><span class="ident" id="4139331">m</span><span class="op" id="4139332">.</span><span class="ident" id="4139333">serverName</span><span class="op" id="4139343">)</span>&nbsp;<span class="op" id="4139345">+</span>&nbsp;<span class="num" id="4139347">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139351">z</span><span class="op" id="4139352">[</span><span class="num" id="4139353">2</span><span class="op" id="4139354">]</span>&nbsp;<span class="op" id="4139356">=</span>&nbsp;<span class="builtintype" id="4139358">byte</span><span class="op" id="4139362">(</span><span class="ident" id="4139363">l</span>&nbsp;<span class="op" id="4139365">&gt;&gt;</span>&nbsp;<span class="num" id="4139368">8</span><span class="op" id="4139369">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139373">z</span><span class="op" id="4139374">[</span><span class="num" id="4139375">3</span><span class="op" id="4139376">]</span>&nbsp;<span class="op" id="4139378">=</span>&nbsp;<span class="builtintype" id="4139380">byte</span><span class="op" id="4139384">(</span><span class="ident" id="4139385">l</span><span class="op" id="4139386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139390">z</span>&nbsp;<span class="op" id="4139392">=</span>&nbsp;<span class="ident" id="4139394">z</span><span class="op" id="4139395">[</span><span class="num" id="4139396">4</span><span class="op" id="4139397">:</span><span class="op" id="4139398">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139403">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139430">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139435">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139449">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139478">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139508">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139547">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139564">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139583">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139588">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139600">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139629">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139646">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139651">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139684">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139689">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139703">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139751">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139775">z</span><span class="op" id="4139776">[</span><span class="num" id="4139777">0</span><span class="op" id="4139778">]</span>&nbsp;<span class="op" id="4139780">=</span>&nbsp;<span class="builtintype" id="4139782">byte</span><span class="op" id="4139786">(</span><span class="op" id="4139787">(</span><span class="builtinfunc" id="4139788">len</span><span class="op" id="4139791">(</span><span class="ident" id="4139792">m</span><span class="op" id="4139793">.</span><span class="ident" id="4139794">serverName</span><span class="op" id="4139804">)</span>&nbsp;<span class="op" id="4139806">+</span>&nbsp;<span class="num" id="4139808">3</span><span class="op" id="4139809">)</span>&nbsp;<span class="op" id="4139811">&gt;&gt;</span>&nbsp;<span class="num" id="4139814">8</span><span class="op" id="4139815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139819">z</span><span class="op" id="4139820">[</span><span class="num" id="4139821">1</span><span class="op" id="4139822">]</span>&nbsp;<span class="op" id="4139824">=</span>&nbsp;<span class="builtintype" id="4139826">byte</span><span class="op" id="4139830">(</span><span class="builtinfunc" id="4139831">len</span><span class="op" id="4139834">(</span><span class="ident" id="4139835">m</span><span class="op" id="4139836">.</span><span class="ident" id="4139837">serverName</span><span class="op" id="4139847">)</span>&nbsp;<span class="op" id="4139849">+</span>&nbsp;<span class="num" id="4139851">3</span><span class="op" id="4139852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139856">z</span><span class="op" id="4139857">[</span><span class="num" id="4139858">3</span><span class="op" id="4139859">]</span>&nbsp;<span class="op" id="4139861">=</span>&nbsp;<span class="builtintype" id="4139863">byte</span><span class="op" id="4139867">(</span><span class="builtinfunc" id="4139868">len</span><span class="op" id="4139871">(</span><span class="ident" id="4139872">m</span><span class="op" id="4139873">.</span><span class="ident" id="4139874">serverName</span><span class="op" id="4139884">)</span>&nbsp;<span class="op" id="4139886">&gt;&gt;</span>&nbsp;<span class="num" id="4139889">8</span><span class="op" id="4139890">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139894">z</span><span class="op" id="4139895">[</span><span class="num" id="4139896">4</span><span class="op" id="4139897">]</span>&nbsp;<span class="op" id="4139899">=</span>&nbsp;<span class="builtintype" id="4139901">byte</span><span class="op" id="4139905">(</span><span class="builtinfunc" id="4139906">len</span><span class="op" id="4139909">(</span><span class="ident" id="4139910">m</span><span class="op" id="4139911">.</span><span class="ident" id="4139912">serverName</span><span class="op" id="4139922">)</span><span class="op" id="4139923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4139927">copy</span><span class="op" id="4139931">(</span><span class="ident" id="4139932">z</span><span class="op" id="4139933">[</span><span class="num" id="4139934">5</span><span class="op" id="4139935">:</span><span class="op" id="4139936">]</span><span class="op" id="4139937">,</span>&nbsp;<span class="op" id="4139939">[</span><span class="op" id="4139940">]</span><span class="builtintype" id="4139941">byte</span><span class="op" id="4139945">(</span><span class="ident" id="4139946">m</span><span class="op" id="4139947">.</span><span class="ident" id="4139948">serverName</span><span class="op" id="4139958">)</span><span class="op" id="4139959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139963">z</span>&nbsp;<span class="op" id="4139965">=</span>&nbsp;<span class="ident" id="4139967">z</span><span class="op" id="4139968">[</span><span class="ident" id="4139969">l</span><span class="op" id="4139970">:</span><span class="op" id="4139971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4139974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4139977">if</span>&nbsp;<span class="ident" id="4139980">m</span><span class="op" id="4139981">.</span><span class="ident" id="4139982">ocspStapling</span>&nbsp;<span class="op" id="4139995">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139999">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140026">z</span><span class="op" id="4140027">[</span><span class="num" id="4140028">0</span><span class="op" id="4140029">]</span>&nbsp;<span class="op" id="4140031">=</span>&nbsp;<span class="builtintype" id="4140033">byte</span><span class="op" id="4140037">(</span><span class="ident" id="4140038">extensionStatusRequest</span>&nbsp;<span class="op" id="4140061">&gt;&gt;</span>&nbsp;<span class="num" id="4140064">8</span><span class="op" id="4140065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140069">z</span><span class="op" id="4140070">[</span><span class="num" id="4140071">1</span><span class="op" id="4140072">]</span>&nbsp;<span class="op" id="4140074">=</span>&nbsp;<span class="builtintype" id="4140076">byte</span><span class="op" id="4140080">(</span><span class="ident" id="4140081">extensionStatusRequest</span><span class="op" id="4140103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140107">z</span><span class="op" id="4140108">[</span><span class="num" id="4140109">2</span><span class="op" id="4140110">]</span>&nbsp;<span class="op" id="4140112">=</span>&nbsp;<span class="num" id="4140114">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140118">z</span><span class="op" id="4140119">[</span><span class="num" id="4140120">3</span><span class="op" id="4140121">]</span>&nbsp;<span class="op" id="4140123">=</span>&nbsp;<span class="num" id="4140125">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140129">z</span><span class="op" id="4140130">[</span><span class="num" id="4140131">4</span><span class="op" id="4140132">]</span>&nbsp;<span class="op" id="4140134">=</span>&nbsp;<span class="num" id="4140136">1</span>&nbsp;<span class="comment" id="4140138">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140153">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140203">z</span>&nbsp;<span class="op" id="4140205">=</span>&nbsp;<span class="ident" id="4140207">z</span><span class="op" id="4140208">[</span><span class="num" id="4140209">9</span><span class="op" id="4140210">:</span><span class="op" id="4140211">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140217">if</span>&nbsp;<span class="builtinfunc" id="4140220">len</span><span class="op" id="4140223">(</span><span class="ident" id="4140224">m</span><span class="op" id="4140225">.</span><span class="ident" id="4140226">supportedCurves</span><span class="op" id="4140241">)</span>&nbsp;<span class="op" id="4140243">&gt;</span>&nbsp;<span class="num" id="4140245">0</span>&nbsp;<span class="op" id="4140247">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140251">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140305">z</span><span class="op" id="4140306">[</span><span class="num" id="4140307">0</span><span class="op" id="4140308">]</span>&nbsp;<span class="op" id="4140310">=</span>&nbsp;<span class="builtintype" id="4140312">byte</span><span class="op" id="4140316">(</span><span class="ident" id="4140317">extensionSupportedCurves</span>&nbsp;<span class="op" id="4140342">&gt;&gt;</span>&nbsp;<span class="num" id="4140345">8</span><span class="op" id="4140346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140350">z</span><span class="op" id="4140351">[</span><span class="num" id="4140352">1</span><span class="op" id="4140353">]</span>&nbsp;<span class="op" id="4140355">=</span>&nbsp;<span class="builtintype" id="4140357">byte</span><span class="op" id="4140361">(</span><span class="ident" id="4140362">extensionSupportedCurves</span><span class="op" id="4140386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140390">l</span>&nbsp;<span class="op" id="4140392">:=</span>&nbsp;<span class="num" id="4140395">2</span>&nbsp;<span class="op" id="4140397">+</span>&nbsp;<span class="num" id="4140399">2</span><span class="op" id="4140400">*</span><span class="builtinfunc" id="4140401">len</span><span class="op" id="4140404">(</span><span class="ident" id="4140405">m</span><span class="op" id="4140406">.</span><span class="ident" id="4140407">supportedCurves</span><span class="op" id="4140422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140426">z</span><span class="op" id="4140427">[</span><span class="num" id="4140428">2</span><span class="op" id="4140429">]</span>&nbsp;<span class="op" id="4140431">=</span>&nbsp;<span class="builtintype" id="4140433">byte</span><span class="op" id="4140437">(</span><span class="ident" id="4140438">l</span>&nbsp;<span class="op" id="4140440">&gt;&gt;</span>&nbsp;<span class="num" id="4140443">8</span><span class="op" id="4140444">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140448">z</span><span class="op" id="4140449">[</span><span class="num" id="4140450">3</span><span class="op" id="4140451">]</span>&nbsp;<span class="op" id="4140453">=</span>&nbsp;<span class="builtintype" id="4140455">byte</span><span class="op" id="4140459">(</span><span class="ident" id="4140460">l</span><span class="op" id="4140461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140465">l</span>&nbsp;<span class="op" id="4140467">-=</span>&nbsp;<span class="num" id="4140470">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140474">z</span><span class="op" id="4140475">[</span><span class="num" id="4140476">4</span><span class="op" id="4140477">]</span>&nbsp;<span class="op" id="4140479">=</span>&nbsp;<span class="builtintype" id="4140481">byte</span><span class="op" id="4140485">(</span><span class="ident" id="4140486">l</span>&nbsp;<span class="op" id="4140488">&gt;&gt;</span>&nbsp;<span class="num" id="4140491">8</span><span class="op" id="4140492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140496">z</span><span class="op" id="4140497">[</span><span class="num" id="4140498">5</span><span class="op" id="4140499">]</span>&nbsp;<span class="op" id="4140501">=</span>&nbsp;<span class="builtintype" id="4140503">byte</span><span class="op" id="4140507">(</span><span class="ident" id="4140508">l</span><span class="op" id="4140509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140513">z</span>&nbsp;<span class="op" id="4140515">=</span>&nbsp;<span class="ident" id="4140517">z</span><span class="op" id="4140518">[</span><span class="num" id="4140519">6</span><span class="op" id="4140520">:</span><span class="op" id="4140521">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140525">for</span>&nbsp;<span class="ident" id="4140529">_</span><span class="op" id="4140530">,</span>&nbsp;<span class="ident" id="4140532">curve</span>&nbsp;<span class="op" id="4140538">:=</span>&nbsp;<span class="keyword" id="4140541">range</span>&nbsp;<span class="ident" id="4140547">m</span><span class="op" id="4140548">.</span><span class="ident" id="4140549">supportedCurves</span>&nbsp;<span class="op" id="4140565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140570">z</span><span class="op" id="4140571">[</span><span class="num" id="4140572">0</span><span class="op" id="4140573">]</span>&nbsp;<span class="op" id="4140575">=</span>&nbsp;<span class="builtintype" id="4140577">byte</span><span class="op" id="4140581">(</span><span class="ident" id="4140582">curve</span>&nbsp;<span class="op" id="4140588">&gt;&gt;</span>&nbsp;<span class="num" id="4140591">8</span><span class="op" id="4140592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140597">z</span><span class="op" id="4140598">[</span><span class="num" id="4140599">1</span><span class="op" id="4140600">]</span>&nbsp;<span class="op" id="4140602">=</span>&nbsp;<span class="builtintype" id="4140604">byte</span><span class="op" id="4140608">(</span><span class="ident" id="4140609">curve</span><span class="op" id="4140614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140619">z</span>&nbsp;<span class="op" id="4140621">=</span>&nbsp;<span class="ident" id="4140623">z</span><span class="op" id="4140624">[</span><span class="num" id="4140625">2</span><span class="op" id="4140626">:</span><span class="op" id="4140627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140631">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4140634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140637">if</span>&nbsp;<span class="builtinfunc" id="4140640">len</span><span class="op" id="4140643">(</span><span class="ident" id="4140644">m</span><span class="op" id="4140645">.</span><span class="ident" id="4140646">supportedPoints</span><span class="op" id="4140661">)</span>&nbsp;<span class="op" id="4140663">&gt;</span>&nbsp;<span class="num" id="4140665">0</span>&nbsp;<span class="op" id="4140667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140671">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140725">z</span><span class="op" id="4140726">[</span><span class="num" id="4140727">0</span><span class="op" id="4140728">]</span>&nbsp;<span class="op" id="4140730">=</span>&nbsp;<span class="builtintype" id="4140732">byte</span><span class="op" id="4140736">(</span><span class="ident" id="4140737">extensionSupportedPoints</span>&nbsp;<span class="op" id="4140762">&gt;&gt;</span>&nbsp;<span class="num" id="4140765">8</span><span class="op" id="4140766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140770">z</span><span class="op" id="4140771">[</span><span class="num" id="4140772">1</span><span class="op" id="4140773">]</span>&nbsp;<span class="op" id="4140775">=</span>&nbsp;<span class="builtintype" id="4140777">byte</span><span class="op" id="4140781">(</span><span class="ident" id="4140782">extensionSupportedPoints</span><span class="op" id="4140806">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140810">l</span>&nbsp;<span class="op" id="4140812">:=</span>&nbsp;<span class="num" id="4140815">1</span>&nbsp;<span class="op" id="4140817">+</span>&nbsp;<span class="builtinfunc" id="4140819">len</span><span class="op" id="4140822">(</span><span class="ident" id="4140823">m</span><span class="op" id="4140824">.</span><span class="ident" id="4140825">supportedPoints</span><span class="op" id="4140840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140844">z</span><span class="op" id="4140845">[</span><span class="num" id="4140846">2</span><span class="op" id="4140847">]</span>&nbsp;<span class="op" id="4140849">=</span>&nbsp;<span class="builtintype" id="4140851">byte</span><span class="op" id="4140855">(</span><span class="ident" id="4140856">l</span>&nbsp;<span class="op" id="4140858">&gt;&gt;</span>&nbsp;<span class="num" id="4140861">8</span><span class="op" id="4140862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140866">z</span><span class="op" id="4140867">[</span><span class="num" id="4140868">3</span><span class="op" id="4140869">]</span>&nbsp;<span class="op" id="4140871">=</span>&nbsp;<span class="builtintype" id="4140873">byte</span><span class="op" id="4140877">(</span><span class="ident" id="4140878">l</span><span class="op" id="4140879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140883">l</span><span class="op" id="4140884">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140889">z</span><span class="op" id="4140890">[</span><span class="num" id="4140891">4</span><span class="op" id="4140892">]</span>&nbsp;<span class="op" id="4140894">=</span>&nbsp;<span class="builtintype" id="4140896">byte</span><span class="op" id="4140900">(</span><span class="ident" id="4140901">l</span><span class="op" id="4140902">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140906">z</span>&nbsp;<span class="op" id="4140908">=</span>&nbsp;<span class="ident" id="4140910">z</span><span class="op" id="4140911">[</span><span class="num" id="4140912">5</span><span class="op" id="4140913">:</span><span class="op" id="4140914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140918">for</span>&nbsp;<span class="ident" id="4140922">_</span><span class="op" id="4140923">,</span>&nbsp;<span class="ident" id="4140925">pointFormat</span>&nbsp;<span class="op" id="4140937">:=</span>&nbsp;<span class="keyword" id="4140940">range</span>&nbsp;<span class="ident" id="4140946">m</span><span class="op" id="4140947">.</span><span class="ident" id="4140948">supportedPoints</span>&nbsp;<span class="op" id="4140964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140969">z</span><span class="op" id="4140970">[</span><span class="num" id="4140971">0</span><span class="op" id="4140972">]</span>&nbsp;<span class="op" id="4140974">=</span>&nbsp;<span class="builtintype" id="4140976">byte</span><span class="op" id="4140980">(</span><span class="ident" id="4140981">pointFormat</span><span class="op" id="4140992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140997">z</span>&nbsp;<span class="op" id="4140999">=</span>&nbsp;<span class="ident" id="4141001">z</span><span class="op" id="4141002">[</span><span class="num" id="4141003">1</span><span class="op" id="4141004">:</span><span class="op" id="4141005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141009">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141012">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141015">if</span>&nbsp;<span class="ident" id="4141018">m</span><span class="op" id="4141019">.</span><span class="ident" id="4141020">ticketSupported</span>&nbsp;<span class="op" id="4141036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141040">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141092">z</span><span class="op" id="4141093">[</span><span class="num" id="4141094">0</span><span class="op" id="4141095">]</span>&nbsp;<span class="op" id="4141097">=</span>&nbsp;<span class="builtintype" id="4141099">byte</span><span class="op" id="4141103">(</span><span class="ident" id="4141104">extensionSessionTicket</span>&nbsp;<span class="op" id="4141127">&gt;&gt;</span>&nbsp;<span class="num" id="4141130">8</span><span class="op" id="4141131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141135">z</span><span class="op" id="4141136">[</span><span class="num" id="4141137">1</span><span class="op" id="4141138">]</span>&nbsp;<span class="op" id="4141140">=</span>&nbsp;<span class="builtintype" id="4141142">byte</span><span class="op" id="4141146">(</span><span class="ident" id="4141147">extensionSessionTicket</span><span class="op" id="4141169">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141173">l</span>&nbsp;<span class="op" id="4141175">:=</span>&nbsp;<span class="builtinfunc" id="4141178">len</span><span class="op" id="4141181">(</span><span class="ident" id="4141182">m</span><span class="op" id="4141183">.</span><span class="ident" id="4141184">sessionTicket</span><span class="op" id="4141197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141201">z</span><span class="op" id="4141202">[</span><span class="num" id="4141203">2</span><span class="op" id="4141204">]</span>&nbsp;<span class="op" id="4141206">=</span>&nbsp;<span class="builtintype" id="4141208">byte</span><span class="op" id="4141212">(</span><span class="ident" id="4141213">l</span>&nbsp;<span class="op" id="4141215">&gt;&gt;</span>&nbsp;<span class="num" id="4141218">8</span><span class="op" id="4141219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141223">z</span><span class="op" id="4141224">[</span><span class="num" id="4141225">3</span><span class="op" id="4141226">]</span>&nbsp;<span class="op" id="4141228">=</span>&nbsp;<span class="builtintype" id="4141230">byte</span><span class="op" id="4141234">(</span><span class="ident" id="4141235">l</span><span class="op" id="4141236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141240">z</span>&nbsp;<span class="op" id="4141242">=</span>&nbsp;<span class="ident" id="4141244">z</span><span class="op" id="4141245">[</span><span class="num" id="4141246">4</span><span class="op" id="4141247">:</span><span class="op" id="4141248">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4141252">copy</span><span class="op" id="4141256">(</span><span class="ident" id="4141257">z</span><span class="op" id="4141258">,</span>&nbsp;<span class="ident" id="4141260">m</span><span class="op" id="4141261">.</span><span class="ident" id="4141262">sessionTicket</span><span class="op" id="4141275">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141279">z</span>&nbsp;<span class="op" id="4141281">=</span>&nbsp;<span class="ident" id="4141283">z</span><span class="op" id="4141284">[</span><span class="builtinfunc" id="4141285">len</span><span class="op" id="4141288">(</span><span class="ident" id="4141289">m</span><span class="op" id="4141290">.</span><span class="ident" id="4141291">sessionTicket</span><span class="op" id="4141304">)</span><span class="op" id="4141305">:</span><span class="op" id="4141306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141312">if</span>&nbsp;<span class="builtinfunc" id="4141315">len</span><span class="op" id="4141318">(</span><span class="ident" id="4141319">m</span><span class="op" id="4141320">.</span><span class="ident" id="4141321">signatureAndHashes</span><span class="op" id="4141339">)</span>&nbsp;<span class="op" id="4141341">&gt;</span>&nbsp;<span class="num" id="4141343">0</span>&nbsp;<span class="op" id="4141345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4141349">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141408">z</span><span class="op" id="4141409">[</span><span class="num" id="4141410">0</span><span class="op" id="4141411">]</span>&nbsp;<span class="op" id="4141413">=</span>&nbsp;<span class="builtintype" id="4141415">byte</span><span class="op" id="4141419">(</span><span class="ident" id="4141420">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="4141449">&gt;&gt;</span>&nbsp;<span class="num" id="4141452">8</span><span class="op" id="4141453">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141457">z</span><span class="op" id="4141458">[</span><span class="num" id="4141459">1</span><span class="op" id="4141460">]</span>&nbsp;<span class="op" id="4141462">=</span>&nbsp;<span class="builtintype" id="4141464">byte</span><span class="op" id="4141468">(</span><span class="ident" id="4141469">extensionSignatureAlgorithms</span><span class="op" id="4141497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141501">l</span>&nbsp;<span class="op" id="4141503">:=</span>&nbsp;<span class="num" id="4141506">2</span>&nbsp;<span class="op" id="4141508">+</span>&nbsp;<span class="num" id="4141510">2</span><span class="op" id="4141511">*</span><span class="builtinfunc" id="4141512">len</span><span class="op" id="4141515">(</span><span class="ident" id="4141516">m</span><span class="op" id="4141517">.</span><span class="ident" id="4141518">signatureAndHashes</span><span class="op" id="4141536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141540">z</span><span class="op" id="4141541">[</span><span class="num" id="4141542">2</span><span class="op" id="4141543">]</span>&nbsp;<span class="op" id="4141545">=</span>&nbsp;<span class="builtintype" id="4141547">byte</span><span class="op" id="4141551">(</span><span class="ident" id="4141552">l</span>&nbsp;<span class="op" id="4141554">&gt;&gt;</span>&nbsp;<span class="num" id="4141557">8</span><span class="op" id="4141558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141562">z</span><span class="op" id="4141563">[</span><span class="num" id="4141564">3</span><span class="op" id="4141565">]</span>&nbsp;<span class="op" id="4141567">=</span>&nbsp;<span class="builtintype" id="4141569">byte</span><span class="op" id="4141573">(</span><span class="ident" id="4141574">l</span><span class="op" id="4141575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141579">z</span>&nbsp;<span class="op" id="4141581">=</span>&nbsp;<span class="ident" id="4141583">z</span><span class="op" id="4141584">[</span><span class="num" id="4141585">4</span><span class="op" id="4141586">:</span><span class="op" id="4141587">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141592">l</span>&nbsp;<span class="op" id="4141594">-=</span>&nbsp;<span class="num" id="4141597">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141601">z</span><span class="op" id="4141602">[</span><span class="num" id="4141603">0</span><span class="op" id="4141604">]</span>&nbsp;<span class="op" id="4141606">=</span>&nbsp;<span class="builtintype" id="4141608">byte</span><span class="op" id="4141612">(</span><span class="ident" id="4141613">l</span>&nbsp;<span class="op" id="4141615">&gt;&gt;</span>&nbsp;<span class="num" id="4141618">8</span><span class="op" id="4141619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141623">z</span><span class="op" id="4141624">[</span><span class="num" id="4141625">1</span><span class="op" id="4141626">]</span>&nbsp;<span class="op" id="4141628">=</span>&nbsp;<span class="builtintype" id="4141630">byte</span><span class="op" id="4141634">(</span><span class="ident" id="4141635">l</span><span class="op" id="4141636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141640">z</span>&nbsp;<span class="op" id="4141642">=</span>&nbsp;<span class="ident" id="4141644">z</span><span class="op" id="4141645">[</span><span class="num" id="4141646">2</span><span class="op" id="4141647">:</span><span class="op" id="4141648">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141652">for</span>&nbsp;<span class="ident" id="4141656">_</span><span class="op" id="4141657">,</span>&nbsp;<span class="ident" id="4141659">sigAndHash</span>&nbsp;<span class="op" id="4141670">:=</span>&nbsp;<span class="keyword" id="4141673">range</span>&nbsp;<span class="ident" id="4141679">m</span><span class="op" id="4141680">.</span><span class="ident" id="4141681">signatureAndHashes</span>&nbsp;<span class="op" id="4141700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141705">z</span><span class="op" id="4141706">[</span><span class="num" id="4141707">0</span><span class="op" id="4141708">]</span>&nbsp;<span class="op" id="4141710">=</span>&nbsp;<span class="ident" id="4141712">sigAndHash</span><span class="op" id="4141722">.</span><span class="ident" id="4141723">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141731">z</span><span class="op" id="4141732">[</span><span class="num" id="4141733">1</span><span class="op" id="4141734">]</span>&nbsp;<span class="op" id="4141736">=</span>&nbsp;<span class="ident" id="4141738">sigAndHash</span><span class="op" id="4141748">.</span><span class="ident" id="4141749">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141762">z</span>&nbsp;<span class="op" id="4141764">=</span>&nbsp;<span class="ident" id="4141766">z</span><span class="op" id="4141767">[</span><span class="num" id="4141768">2</span><span class="op" id="4141769">:</span><span class="op" id="4141770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141774">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141780">if</span>&nbsp;<span class="ident" id="4141783">m</span><span class="op" id="4141784">.</span><span class="ident" id="4141785">secureRenegotiation</span>&nbsp;<span class="op" id="4141805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141809">z</span><span class="op" id="4141810">[</span><span class="num" id="4141811">0</span><span class="op" id="4141812">]</span>&nbsp;<span class="op" id="4141814">=</span>&nbsp;<span class="builtintype" id="4141816">byte</span><span class="op" id="4141820">(</span><span class="ident" id="4141821">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4141848">&gt;&gt;</span>&nbsp;<span class="num" id="4141851">8</span><span class="op" id="4141852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141856">z</span><span class="op" id="4141857">[</span><span class="num" id="4141858">1</span><span class="op" id="4141859">]</span>&nbsp;<span class="op" id="4141861">=</span>&nbsp;<span class="builtintype" id="4141863">byte</span><span class="op" id="4141867">(</span><span class="ident" id="4141868">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4141895">&amp;</span>&nbsp;<span class="num" id="4141897">0xff</span><span class="op" id="4141901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141905">z</span><span class="op" id="4141906">[</span><span class="num" id="4141907">2</span><span class="op" id="4141908">]</span>&nbsp;<span class="op" id="4141910">=</span>&nbsp;<span class="num" id="4141912">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141916">z</span><span class="op" id="4141917">[</span><span class="num" id="4141918">3</span><span class="op" id="4141919">]</span>&nbsp;<span class="op" id="4141921">=</span>&nbsp;<span class="num" id="4141923">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141927">z</span>&nbsp;<span class="op" id="4141929">=</span>&nbsp;<span class="ident" id="4141931">z</span><span class="op" id="4141932">[</span><span class="num" id="4141933">5</span><span class="op" id="4141934">:</span><span class="op" id="4141935">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141941">if</span>&nbsp;<span class="builtinfunc" id="4141944">len</span><span class="op" id="4141947">(</span><span class="ident" id="4141948">m</span><span class="op" id="4141949">.</span><span class="ident" id="4141950">alpnProtocols</span><span class="op" id="4141963">)</span>&nbsp;<span class="op" id="4141965">&gt;</span>&nbsp;<span class="num" id="4141967">0</span>&nbsp;<span class="op" id="4141969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141973">z</span><span class="op" id="4141974">[</span><span class="num" id="4141975">0</span><span class="op" id="4141976">]</span>&nbsp;<span class="op" id="4141978">=</span>&nbsp;<span class="builtintype" id="4141980">byte</span><span class="op" id="4141984">(</span><span class="ident" id="4141985">extensionALPN</span>&nbsp;<span class="op" id="4141999">&gt;&gt;</span>&nbsp;<span class="num" id="4142002">8</span><span class="op" id="4142003">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142007">z</span><span class="op" id="4142008">[</span><span class="num" id="4142009">1</span><span class="op" id="4142010">]</span>&nbsp;<span class="op" id="4142012">=</span>&nbsp;<span class="builtintype" id="4142014">byte</span><span class="op" id="4142018">(</span><span class="ident" id="4142019">extensionALPN</span>&nbsp;<span class="op" id="4142033">&amp;</span>&nbsp;<span class="num" id="4142035">0xff</span><span class="op" id="4142039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142043">lengths</span>&nbsp;<span class="op" id="4142051">:=</span>&nbsp;<span class="ident" id="4142054">z</span><span class="op" id="4142055">[</span><span class="num" id="4142056">2</span><span class="op" id="4142057">:</span><span class="op" id="4142058">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142062">z</span>&nbsp;<span class="op" id="4142064">=</span>&nbsp;<span class="ident" id="4142066">z</span><span class="op" id="4142067">[</span><span class="num" id="4142068">6</span><span class="op" id="4142069">:</span><span class="op" id="4142070">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142075">stringsLength</span>&nbsp;<span class="op" id="4142089">:=</span>&nbsp;<span class="num" id="4142092">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142096">for</span>&nbsp;<span class="ident" id="4142100">_</span><span class="op" id="4142101">,</span>&nbsp;<span class="ident" id="4142103">s</span>&nbsp;<span class="op" id="4142105">:=</span>&nbsp;<span class="keyword" id="4142108">range</span>&nbsp;<span class="ident" id="4142114">m</span><span class="op" id="4142115">.</span><span class="ident" id="4142116">alpnProtocols</span>&nbsp;<span class="op" id="4142130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142135">l</span>&nbsp;<span class="op" id="4142137">:=</span>&nbsp;<span class="builtinfunc" id="4142140">len</span><span class="op" id="4142143">(</span><span class="ident" id="4142144">s</span><span class="op" id="4142145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142150">z</span><span class="op" id="4142151">[</span><span class="num" id="4142152">0</span><span class="op" id="4142153">]</span>&nbsp;<span class="op" id="4142155">=</span>&nbsp;<span class="builtintype" id="4142157">byte</span><span class="op" id="4142161">(</span><span class="ident" id="4142162">l</span><span class="op" id="4142163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4142168">copy</span><span class="op" id="4142172">(</span><span class="ident" id="4142173">z</span><span class="op" id="4142174">[</span><span class="num" id="4142175">1</span><span class="op" id="4142176">:</span><span class="op" id="4142177">]</span><span class="op" id="4142178">,</span>&nbsp;<span class="ident" id="4142180">s</span><span class="op" id="4142181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142186">z</span>&nbsp;<span class="op" id="4142188">=</span>&nbsp;<span class="ident" id="4142190">z</span><span class="op" id="4142191">[</span><span class="num" id="4142192">1</span><span class="op" id="4142193">+</span><span class="ident" id="4142194">l</span><span class="op" id="4142195">:</span><span class="op" id="4142196">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142201">stringsLength</span>&nbsp;<span class="op" id="4142215">+=</span>&nbsp;<span class="num" id="4142218">1</span>&nbsp;<span class="op" id="4142220">+</span>&nbsp;<span class="ident" id="4142222">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142231">lengths</span><span class="op" id="4142238">[</span><span class="num" id="4142239">2</span><span class="op" id="4142240">]</span>&nbsp;<span class="op" id="4142242">=</span>&nbsp;<span class="builtintype" id="4142244">byte</span><span class="op" id="4142248">(</span><span class="ident" id="4142249">stringsLength</span>&nbsp;<span class="op" id="4142263">&gt;&gt;</span>&nbsp;<span class="num" id="4142266">8</span><span class="op" id="4142267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142271">lengths</span><span class="op" id="4142278">[</span><span class="num" id="4142279">3</span><span class="op" id="4142280">]</span>&nbsp;<span class="op" id="4142282">=</span>&nbsp;<span class="builtintype" id="4142284">byte</span><span class="op" id="4142288">(</span><span class="ident" id="4142289">stringsLength</span><span class="op" id="4142302">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142306">stringsLength</span>&nbsp;<span class="op" id="4142320">+=</span>&nbsp;<span class="num" id="4142323">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142327">lengths</span><span class="op" id="4142334">[</span><span class="num" id="4142335">0</span><span class="op" id="4142336">]</span>&nbsp;<span class="op" id="4142338">=</span>&nbsp;<span class="builtintype" id="4142340">byte</span><span class="op" id="4142344">(</span><span class="ident" id="4142345">stringsLength</span>&nbsp;<span class="op" id="4142359">&gt;&gt;</span>&nbsp;<span class="num" id="4142362">8</span><span class="op" id="4142363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142367">lengths</span><span class="op" id="4142374">[</span><span class="num" id="4142375">1</span><span class="op" id="4142376">]</span>&nbsp;<span class="op" id="4142378">=</span>&nbsp;<span class="builtintype" id="4142380">byte</span><span class="op" id="4142384">(</span><span class="ident" id="4142385">stringsLength</span><span class="op" id="4142398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142405">m</span><span class="op" id="4142406">.</span><span class="ident" id="4142407">raw</span>&nbsp;<span class="op" id="4142411">=</span>&nbsp;<span class="ident" id="4142413">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142417">return</span>&nbsp;<span class="ident" id="4142424">x</span><br>
<span class="lineno"></span><span class="op" id="4142426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="4142429">func</span>&nbsp;<span class="op" id="4142434">(</span><span class="ident" id="4142435">m</span>&nbsp;<span class="op" id="4142437">*</span><span class="ident" id="4142438">clientHelloMsg</span><span class="op" id="4142452">)</span>&nbsp;<span class="ident" id="4142454">unmarshal</span><span class="op" id="4142463">(</span><span class="ident" id="4142464">data</span>&nbsp;<span class="op" id="4142469">[</span><span class="op" id="4142470">]</span><span class="builtintype" id="4142471">byte</span><span class="op" id="4142475">)</span>&nbsp;<span class="builtintype" id="4142477">bool</span>&nbsp;<span class="op" id="4142482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142485">if</span>&nbsp;<span class="builtinfunc" id="4142488">len</span><span class="op" id="4142491">(</span><span class="ident" id="4142492">data</span><span class="op" id="4142496">)</span>&nbsp;<span class="op" id="4142498">&lt;</span>&nbsp;<span class="num" id="4142500">42</span>&nbsp;<span class="op" id="4142503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142507">return</span>&nbsp;<span class="builtintype" id="4142514">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142521">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142524">m</span><span class="op" id="4142525">.</span><span class="ident" id="4142526">raw</span>&nbsp;<span class="op" id="4142530">=</span>&nbsp;<span class="ident" id="4142532">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142538">m</span><span class="op" id="4142539">.</span><span class="ident" id="4142540">vers</span>&nbsp;<span class="op" id="4142545">=</span>&nbsp;<span class="builtintype" id="4142547">uint16</span><span class="op" id="4142553">(</span><span class="ident" id="4142554">data</span><span class="op" id="4142558">[</span><span class="num" id="4142559">4</span><span class="op" id="4142560">]</span><span class="op" id="4142561">)</span><span class="op" id="4142562">&lt;&lt;</span><span class="num" id="4142564">8</span>&nbsp;<span class="op" id="4142566">|</span>&nbsp;<span class="builtintype" id="4142568">uint16</span><span class="op" id="4142574">(</span><span class="ident" id="4142575">data</span><span class="op" id="4142579">[</span><span class="num" id="4142580">5</span><span class="op" id="4142581">]</span><span class="op" id="4142582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142585">m</span><span class="op" id="4142586">.</span><span class="ident" id="4142587">random</span>&nbsp;<span class="op" id="4142594">=</span>&nbsp;<span class="ident" id="4142596">data</span><span class="op" id="4142600">[</span><span class="num" id="4142601">6</span><span class="op" id="4142602">:</span><span class="num" id="4142603">38</span><span class="op" id="4142605">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142608">sessionIdLen</span>&nbsp;<span class="op" id="4142621">:=</span>&nbsp;<span class="builtintype" id="4142624">int</span><span class="op" id="4142627">(</span><span class="ident" id="4142628">data</span><span class="op" id="4142632">[</span><span class="num" id="4142633">38</span><span class="op" id="4142635">]</span><span class="op" id="4142636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142639">if</span>&nbsp;<span class="ident" id="4142642">sessionIdLen</span>&nbsp;<span class="op" id="4142655">&gt;</span>&nbsp;<span class="num" id="4142657">32</span>&nbsp;<span class="op" id="4142660">||</span>&nbsp;<span class="builtinfunc" id="4142663">len</span><span class="op" id="4142666">(</span><span class="ident" id="4142667">data</span><span class="op" id="4142671">)</span>&nbsp;<span class="op" id="4142673">&lt;</span>&nbsp;<span class="num" id="4142675">39</span><span class="op" id="4142677">+</span><span class="ident" id="4142678">sessionIdLen</span>&nbsp;<span class="op" id="4142691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142695">return</span>&nbsp;<span class="builtintype" id="4142702">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142712">m</span><span class="op" id="4142713">.</span><span class="ident" id="4142714">sessionId</span>&nbsp;<span class="op" id="4142724">=</span>&nbsp;<span class="ident" id="4142726">data</span><span class="op" id="4142730">[</span><span class="num" id="4142731">39</span>&nbsp;<span class="op" id="4142734">:</span>&nbsp;<span class="num" id="4142736">39</span><span class="op" id="4142738">+</span><span class="ident" id="4142739">sessionIdLen</span><span class="op" id="4142751">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142754">data</span>&nbsp;<span class="op" id="4142759">=</span>&nbsp;<span class="ident" id="4142761">data</span><span class="op" id="4142765">[</span><span class="num" id="4142766">39</span><span class="op" id="4142768">+</span><span class="ident" id="4142769">sessionIdLen</span><span class="op" id="4142781">:</span><span class="op" id="4142782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142785">if</span>&nbsp;<span class="builtinfunc" id="4142788">len</span><span class="op" id="4142791">(</span><span class="ident" id="4142792">data</span><span class="op" id="4142796">)</span>&nbsp;<span class="op" id="4142798">&lt;</span>&nbsp;<span class="num" id="4142800">2</span>&nbsp;<span class="op" id="4142802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142806">return</span>&nbsp;<span class="builtintype" id="4142813">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142823">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142896">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142943">cipherSuiteLen</span>&nbsp;<span class="op" id="4142958">:=</span>&nbsp;<span class="builtintype" id="4142961">int</span><span class="op" id="4142964">(</span><span class="ident" id="4142965">data</span><span class="op" id="4142969">[</span><span class="num" id="4142970">0</span><span class="op" id="4142971">]</span><span class="op" id="4142972">)</span><span class="op" id="4142973">&lt;&lt;</span><span class="num" id="4142975">8</span>&nbsp;<span class="op" id="4142977">|</span>&nbsp;<span class="builtintype" id="4142979">int</span><span class="op" id="4142982">(</span><span class="ident" id="4142983">data</span><span class="op" id="4142987">[</span><span class="num" id="4142988">1</span><span class="op" id="4142989">]</span><span class="op" id="4142990">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142993">if</span>&nbsp;<span class="ident" id="4142996">cipherSuiteLen</span><span class="op" id="4143010">%</span><span class="num" id="4143011">2</span>&nbsp;<span class="op" id="4143013">==</span>&nbsp;<span class="num" id="4143016">1</span>&nbsp;<span class="op" id="4143018">||</span>&nbsp;<span class="builtinfunc" id="4143021">len</span><span class="op" id="4143024">(</span><span class="ident" id="4143025">data</span><span class="op" id="4143029">)</span>&nbsp;<span class="op" id="4143031">&lt;</span>&nbsp;<span class="num" id="4143033">2</span><span class="op" id="4143034">+</span><span class="ident" id="4143035">cipherSuiteLen</span>&nbsp;<span class="op" id="4143050">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143054">return</span>&nbsp;<span class="builtintype" id="4143061">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143071">numCipherSuites</span>&nbsp;<span class="op" id="4143087">:=</span>&nbsp;<span class="ident" id="4143090">cipherSuiteLen</span>&nbsp;<span class="op" id="4143105">/</span>&nbsp;<span class="num" id="4143107">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143110">m</span><span class="op" id="4143111">.</span><span class="ident" id="4143112">cipherSuites</span>&nbsp;<span class="op" id="4143125">=</span>&nbsp;<span class="builtinfunc" id="4143127">make</span><span class="op" id="4143131">(</span><span class="op" id="4143132">[</span><span class="op" id="4143133">]</span><span class="builtintype" id="4143134">uint16</span><span class="op" id="4143140">,</span>&nbsp;<span class="ident" id="4143142">numCipherSuites</span><span class="op" id="4143157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143160">for</span>&nbsp;<span class="ident" id="4143164">i</span>&nbsp;<span class="op" id="4143166">:=</span>&nbsp;<span class="num" id="4143169">0</span><span class="op" id="4143170">;</span>&nbsp;<span class="ident" id="4143172">i</span>&nbsp;<span class="op" id="4143174">&lt;</span>&nbsp;<span class="ident" id="4143176">numCipherSuites</span><span class="op" id="4143191">;</span>&nbsp;<span class="ident" id="4143193">i</span><span class="op" id="4143194">++</span>&nbsp;<span class="op" id="4143197">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143201">m</span><span class="op" id="4143202">.</span><span class="ident" id="4143203">cipherSuites</span><span class="op" id="4143215">[</span><span class="ident" id="4143216">i</span><span class="op" id="4143217">]</span>&nbsp;<span class="op" id="4143219">=</span>&nbsp;<span class="builtintype" id="4143221">uint16</span><span class="op" id="4143227">(</span><span class="ident" id="4143228">data</span><span class="op" id="4143232">[</span><span class="num" id="4143233">2</span><span class="op" id="4143234">+</span><span class="num" id="4143235">2</span><span class="op" id="4143236">*</span><span class="ident" id="4143237">i</span><span class="op" id="4143238">]</span><span class="op" id="4143239">)</span><span class="op" id="4143240">&lt;&lt;</span><span class="num" id="4143242">8</span>&nbsp;<span class="op" id="4143244">|</span>&nbsp;<span class="builtintype" id="4143246">uint16</span><span class="op" id="4143252">(</span><span class="ident" id="4143253">data</span><span class="op" id="4143257">[</span><span class="num" id="4143258">3</span><span class="op" id="4143259">+</span><span class="num" id="4143260">2</span><span class="op" id="4143261">*</span><span class="ident" id="4143262">i</span><span class="op" id="4143263">]</span><span class="op" id="4143264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143268">if</span>&nbsp;<span class="ident" id="4143271">m</span><span class="op" id="4143272">.</span><span class="ident" id="4143273">cipherSuites</span><span class="op" id="4143285">[</span><span class="ident" id="4143286">i</span><span class="op" id="4143287">]</span>&nbsp;<span class="op" id="4143289">==</span>&nbsp;<span class="ident" id="4143292">scsvRenegotiation</span>&nbsp;<span class="op" id="4143310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143315">m</span><span class="op" id="4143316">.</span><span class="ident" id="4143317">secureRenegotiation</span>&nbsp;<span class="op" id="4143337">=</span>&nbsp;<span class="builtintype" id="4143339">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143349">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143352">data</span>&nbsp;<span class="op" id="4143357">=</span>&nbsp;<span class="ident" id="4143359">data</span><span class="op" id="4143363">[</span><span class="num" id="4143364">2</span><span class="op" id="4143365">+</span><span class="ident" id="4143366">cipherSuiteLen</span><span class="op" id="4143380">:</span><span class="op" id="4143381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143384">if</span>&nbsp;<span class="builtinfunc" id="4143387">len</span><span class="op" id="4143390">(</span><span class="ident" id="4143391">data</span><span class="op" id="4143395">)</span>&nbsp;<span class="op" id="4143397">&lt;</span>&nbsp;<span class="num" id="4143399">1</span>&nbsp;<span class="op" id="4143401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143405">return</span>&nbsp;<span class="builtintype" id="4143412">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143422">compressionMethodsLen</span>&nbsp;<span class="op" id="4143444">:=</span>&nbsp;<span class="builtintype" id="4143447">int</span><span class="op" id="4143450">(</span><span class="ident" id="4143451">data</span><span class="op" id="4143455">[</span><span class="num" id="4143456">0</span><span class="op" id="4143457">]</span><span class="op" id="4143458">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143461">if</span>&nbsp;<span class="builtinfunc" id="4143464">len</span><span class="op" id="4143467">(</span><span class="ident" id="4143468">data</span><span class="op" id="4143472">)</span>&nbsp;<span class="op" id="4143474">&lt;</span>&nbsp;<span class="num" id="4143476">1</span><span class="op" id="4143477">+</span><span class="ident" id="4143478">compressionMethodsLen</span>&nbsp;<span class="op" id="4143500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143504">return</span>&nbsp;<span class="builtintype" id="4143511">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143521">m</span><span class="op" id="4143522">.</span><span class="ident" id="4143523">compressionMethods</span>&nbsp;<span class="op" id="4143542">=</span>&nbsp;<span class="ident" id="4143544">data</span><span class="op" id="4143548">[</span><span class="num" id="4143549">1</span>&nbsp;<span class="op" id="4143551">:</span>&nbsp;<span class="num" id="4143553">1</span><span class="op" id="4143554">+</span><span class="ident" id="4143555">compressionMethodsLen</span><span class="op" id="4143576">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143580">data</span>&nbsp;<span class="op" id="4143585">=</span>&nbsp;<span class="ident" id="4143587">data</span><span class="op" id="4143591">[</span><span class="num" id="4143592">1</span><span class="op" id="4143593">+</span><span class="ident" id="4143594">compressionMethodsLen</span><span class="op" id="4143615">:</span><span class="op" id="4143616">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143620">m</span><span class="op" id="4143621">.</span><span class="ident" id="4143622">nextProtoNeg</span>&nbsp;<span class="op" id="4143635">=</span>&nbsp;<span class="builtintype" id="4143637">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143644">m</span><span class="op" id="4143645">.</span><span class="ident" id="4143646">serverName</span>&nbsp;<span class="op" id="4143657">=</span>&nbsp;<span class="string" id="4143659">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143663">m</span><span class="op" id="4143664">.</span><span class="ident" id="4143665">ocspStapling</span>&nbsp;<span class="op" id="4143678">=</span>&nbsp;<span class="builtintype" id="4143680">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143687">m</span><span class="op" id="4143688">.</span><span class="ident" id="4143689">ticketSupported</span>&nbsp;<span class="op" id="4143705">=</span>&nbsp;<span class="builtintype" id="4143707">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143714">m</span><span class="op" id="4143715">.</span><span class="ident" id="4143716">sessionTicket</span>&nbsp;<span class="op" id="4143730">=</span>&nbsp;<span class="ident" id="4143732">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143737">m</span><span class="op" id="4143738">.</span><span class="ident" id="4143739">signatureAndHashes</span>&nbsp;<span class="op" id="4143758">=</span>&nbsp;<span class="ident" id="4143760">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143765">m</span><span class="op" id="4143766">.</span><span class="ident" id="4143767">alpnProtocols</span>&nbsp;<span class="op" id="4143781">=</span>&nbsp;<span class="ident" id="4143783">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143789">if</span>&nbsp;<span class="builtinfunc" id="4143792">len</span><span class="op" id="4143795">(</span><span class="ident" id="4143796">data</span><span class="op" id="4143800">)</span>&nbsp;<span class="op" id="4143802">==</span>&nbsp;<span class="num" id="4143805">0</span>&nbsp;<span class="op" id="4143807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4143811">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143869">return</span>&nbsp;<span class="builtintype" id="4143876">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143885">if</span>&nbsp;<span class="builtinfunc" id="4143888">len</span><span class="op" id="4143891">(</span><span class="ident" id="4143892">data</span><span class="op" id="4143896">)</span>&nbsp;<span class="op" id="4143898">&lt;</span>&nbsp;<span class="num" id="4143900">2</span>&nbsp;<span class="op" id="4143902">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143906">return</span>&nbsp;<span class="builtintype" id="4143913">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143924">extensionsLength</span>&nbsp;<span class="op" id="4143941">:=</span>&nbsp;<span class="builtintype" id="4143944">int</span><span class="op" id="4143947">(</span><span class="ident" id="4143948">data</span><span class="op" id="4143952">[</span><span class="num" id="4143953">0</span><span class="op" id="4143954">]</span><span class="op" id="4143955">)</span><span class="op" id="4143956">&lt;&lt;</span><span class="num" id="4143958">8</span>&nbsp;<span class="op" id="4143960">|</span>&nbsp;<span class="builtintype" id="4143962">int</span><span class="op" id="4143965">(</span><span class="ident" id="4143966">data</span><span class="op" id="4143970">[</span><span class="num" id="4143971">1</span><span class="op" id="4143972">]</span><span class="op" id="4143973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143976">data</span>&nbsp;<span class="op" id="4143981">=</span>&nbsp;<span class="ident" id="4143983">data</span><span class="op" id="4143987">[</span><span class="num" id="4143988">2</span><span class="op" id="4143989">:</span><span class="op" id="4143990">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143993">if</span>&nbsp;<span class="ident" id="4143996">extensionsLength</span>&nbsp;<span class="op" id="4144013">!=</span>&nbsp;<span class="builtinfunc" id="4144016">len</span><span class="op" id="4144019">(</span><span class="ident" id="4144020">data</span><span class="op" id="4144024">)</span>&nbsp;<span class="op" id="4144026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144030">return</span>&nbsp;<span class="builtintype" id="4144037">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144048">for</span>&nbsp;<span class="builtinfunc" id="4144052">len</span><span class="op" id="4144055">(</span><span class="ident" id="4144056">data</span><span class="op" id="4144060">)</span>&nbsp;<span class="op" id="4144062">!=</span>&nbsp;<span class="num" id="4144065">0</span>&nbsp;<span class="op" id="4144067">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144071">if</span>&nbsp;<span class="builtinfunc" id="4144074">len</span><span class="op" id="4144077">(</span><span class="ident" id="4144078">data</span><span class="op" id="4144082">)</span>&nbsp;<span class="op" id="4144084">&lt;</span>&nbsp;<span class="num" id="4144086">4</span>&nbsp;<span class="op" id="4144088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144093">return</span>&nbsp;<span class="builtintype" id="4144100">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144112">extension</span>&nbsp;<span class="op" id="4144122">:=</span>&nbsp;<span class="builtintype" id="4144125">uint16</span><span class="op" id="4144131">(</span><span class="ident" id="4144132">data</span><span class="op" id="4144136">[</span><span class="num" id="4144137">0</span><span class="op" id="4144138">]</span><span class="op" id="4144139">)</span><span class="op" id="4144140">&lt;&lt;</span><span class="num" id="4144142">8</span>&nbsp;<span class="op" id="4144144">|</span>&nbsp;<span class="builtintype" id="4144146">uint16</span><span class="op" id="4144152">(</span><span class="ident" id="4144153">data</span><span class="op" id="4144157">[</span><span class="num" id="4144158">1</span><span class="op" id="4144159">]</span><span class="op" id="4144160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144164">length</span>&nbsp;<span class="op" id="4144171">:=</span>&nbsp;<span class="builtintype" id="4144174">int</span><span class="op" id="4144177">(</span><span class="ident" id="4144178">data</span><span class="op" id="4144182">[</span><span class="num" id="4144183">2</span><span class="op" id="4144184">]</span><span class="op" id="4144185">)</span><span class="op" id="4144186">&lt;&lt;</span><span class="num" id="4144188">8</span>&nbsp;<span class="op" id="4144190">|</span>&nbsp;<span class="builtintype" id="4144192">int</span><span class="op" id="4144195">(</span><span class="ident" id="4144196">data</span><span class="op" id="4144200">[</span><span class="num" id="4144201">3</span><span class="op" id="4144202">]</span><span class="op" id="4144203">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144207">data</span>&nbsp;<span class="op" id="4144212">=</span>&nbsp;<span class="ident" id="4144214">data</span><span class="op" id="4144218">[</span><span class="num" id="4144219">4</span><span class="op" id="4144220">:</span><span class="op" id="4144221">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144225">if</span>&nbsp;<span class="builtinfunc" id="4144228">len</span><span class="op" id="4144231">(</span><span class="ident" id="4144232">data</span><span class="op" id="4144236">)</span>&nbsp;<span class="op" id="4144238">&lt;</span>&nbsp;<span class="ident" id="4144240">length</span>&nbsp;<span class="op" id="4144247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144252">return</span>&nbsp;<span class="builtintype" id="4144259">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144272">switch</span>&nbsp;<span class="ident" id="4144279">extension</span>&nbsp;<span class="op" id="4144289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144293">case</span>&nbsp;<span class="ident" id="4144298">extensionServerName</span><span class="op" id="4144317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144322">if</span>&nbsp;<span class="ident" id="4144325">length</span>&nbsp;<span class="op" id="4144332">&lt;</span>&nbsp;<span class="num" id="4144334">2</span>&nbsp;<span class="op" id="4144336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144342">return</span>&nbsp;<span class="builtintype" id="4144349">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144358">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144363">numNames</span>&nbsp;<span class="op" id="4144372">:=</span>&nbsp;<span class="builtintype" id="4144375">int</span><span class="op" id="4144378">(</span><span class="ident" id="4144379">data</span><span class="op" id="4144383">[</span><span class="num" id="4144384">0</span><span class="op" id="4144385">]</span><span class="op" id="4144386">)</span><span class="op" id="4144387">&lt;&lt;</span><span class="num" id="4144389">8</span>&nbsp;<span class="op" id="4144391">|</span>&nbsp;<span class="builtintype" id="4144393">int</span><span class="op" id="4144396">(</span><span class="ident" id="4144397">data</span><span class="op" id="4144401">[</span><span class="num" id="4144402">1</span><span class="op" id="4144403">]</span><span class="op" id="4144404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144409">d</span>&nbsp;<span class="op" id="4144411">:=</span>&nbsp;<span class="ident" id="4144414">data</span><span class="op" id="4144418">[</span><span class="num" id="4144419">2</span><span class="op" id="4144420">:</span><span class="op" id="4144421">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144426">for</span>&nbsp;<span class="ident" id="4144430">i</span>&nbsp;<span class="op" id="4144432">:=</span>&nbsp;<span class="num" id="4144435">0</span><span class="op" id="4144436">;</span>&nbsp;<span class="ident" id="4144438">i</span>&nbsp;<span class="op" id="4144440">&lt;</span>&nbsp;<span class="ident" id="4144442">numNames</span><span class="op" id="4144450">;</span>&nbsp;<span class="ident" id="4144452">i</span><span class="op" id="4144453">++</span>&nbsp;<span class="op" id="4144456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144462">if</span>&nbsp;<span class="builtinfunc" id="4144465">len</span><span class="op" id="4144468">(</span><span class="ident" id="4144469">d</span><span class="op" id="4144470">)</span>&nbsp;<span class="op" id="4144472">&lt;</span>&nbsp;<span class="num" id="4144474">3</span>&nbsp;<span class="op" id="4144476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144483">return</span>&nbsp;<span class="builtintype" id="4144490">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144506">nameType</span>&nbsp;<span class="op" id="4144515">:=</span>&nbsp;<span class="ident" id="4144518">d</span><span class="op" id="4144519">[</span><span class="num" id="4144520">0</span><span class="op" id="4144521">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144527">nameLen</span>&nbsp;<span class="op" id="4144535">:=</span>&nbsp;<span class="builtintype" id="4144538">int</span><span class="op" id="4144541">(</span><span class="ident" id="4144542">d</span><span class="op" id="4144543">[</span><span class="num" id="4144544">1</span><span class="op" id="4144545">]</span><span class="op" id="4144546">)</span><span class="op" id="4144547">&lt;&lt;</span><span class="num" id="4144549">8</span>&nbsp;<span class="op" id="4144551">|</span>&nbsp;<span class="builtintype" id="4144553">int</span><span class="op" id="4144556">(</span><span class="ident" id="4144557">d</span><span class="op" id="4144558">[</span><span class="num" id="4144559">2</span><span class="op" id="4144560">]</span><span class="op" id="4144561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144567">d</span>&nbsp;<span class="op" id="4144569">=</span>&nbsp;<span class="ident" id="4144571">d</span><span class="op" id="4144572">[</span><span class="num" id="4144573">3</span><span class="op" id="4144574">:</span><span class="op" id="4144575">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144581">if</span>&nbsp;<span class="builtinfunc" id="4144584">len</span><span class="op" id="4144587">(</span><span class="ident" id="4144588">d</span><span class="op" id="4144589">)</span>&nbsp;<span class="op" id="4144591">&lt;</span>&nbsp;<span class="ident" id="4144593">nameLen</span>&nbsp;<span class="op" id="4144601">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144608">return</span>&nbsp;<span class="builtintype" id="4144615">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144631">if</span>&nbsp;<span class="ident" id="4144634">nameType</span>&nbsp;<span class="op" id="4144643">==</span>&nbsp;<span class="num" id="4144646">0</span>&nbsp;<span class="op" id="4144648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144655">m</span><span class="op" id="4144656">.</span><span class="ident" id="4144657">serverName</span>&nbsp;<span class="op" id="4144668">=</span>&nbsp;<span class="builtintype" id="4144670">string</span><span class="op" id="4144676">(</span><span class="ident" id="4144677">d</span><span class="op" id="4144678">[</span><span class="num" id="4144679">0</span><span class="op" id="4144680">:</span><span class="ident" id="4144681">nameLen</span><span class="op" id="4144688">]</span><span class="op" id="4144689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144696">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144712">d</span>&nbsp;<span class="op" id="4144714">=</span>&nbsp;<span class="ident" id="4144716">d</span><span class="op" id="4144717">[</span><span class="ident" id="4144718">nameLen</span><span class="op" id="4144725">:</span><span class="op" id="4144726">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144735">case</span>&nbsp;<span class="ident" id="4144740">extensionNextProtoNeg</span><span class="op" id="4144761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144766">if</span>&nbsp;<span class="ident" id="4144769">length</span>&nbsp;<span class="op" id="4144776">&gt;</span>&nbsp;<span class="num" id="4144778">0</span>&nbsp;<span class="op" id="4144780">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144786">return</span>&nbsp;<span class="builtintype" id="4144793">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144807">m</span><span class="op" id="4144808">.</span><span class="ident" id="4144809">nextProtoNeg</span>&nbsp;<span class="op" id="4144822">=</span>&nbsp;<span class="builtintype" id="4144824">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144831">case</span>&nbsp;<span class="ident" id="4144836">extensionStatusRequest</span><span class="op" id="4144858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144863">m</span><span class="op" id="4144864">.</span><span class="ident" id="4144865">ocspStapling</span>&nbsp;<span class="op" id="4144878">=</span>&nbsp;<span class="ident" id="4144880">length</span>&nbsp;<span class="op" id="4144887">&gt;</span>&nbsp;<span class="num" id="4144889">0</span>&nbsp;<span class="op" id="4144891">&amp;&amp;</span>&nbsp;<span class="ident" id="4144894">data</span><span class="op" id="4144898">[</span><span class="num" id="4144899">0</span><span class="op" id="4144900">]</span>&nbsp;<span class="op" id="4144902">==</span>&nbsp;<span class="ident" id="4144905">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144922">case</span>&nbsp;<span class="ident" id="4144927">extensionSupportedCurves</span><span class="op" id="4144951">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144956">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145011">if</span>&nbsp;<span class="ident" id="4145014">length</span>&nbsp;<span class="op" id="4145021">&lt;</span>&nbsp;<span class="num" id="4145023">2</span>&nbsp;<span class="op" id="4145025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145031">return</span>&nbsp;<span class="builtintype" id="4145038">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145047">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145052">l</span>&nbsp;<span class="op" id="4145054">:=</span>&nbsp;<span class="builtintype" id="4145057">int</span><span class="op" id="4145060">(</span><span class="ident" id="4145061">data</span><span class="op" id="4145065">[</span><span class="num" id="4145066">0</span><span class="op" id="4145067">]</span><span class="op" id="4145068">)</span><span class="op" id="4145069">&lt;&lt;</span><span class="num" id="4145071">8</span>&nbsp;<span class="op" id="4145073">|</span>&nbsp;<span class="builtintype" id="4145075">int</span><span class="op" id="4145078">(</span><span class="ident" id="4145079">data</span><span class="op" id="4145083">[</span><span class="num" id="4145084">1</span><span class="op" id="4145085">]</span><span class="op" id="4145086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145091">if</span>&nbsp;<span class="ident" id="4145094">l</span><span class="op" id="4145095">%</span><span class="num" id="4145096">2</span>&nbsp;<span class="op" id="4145098">==</span>&nbsp;<span class="num" id="4145101">1</span>&nbsp;<span class="op" id="4145103">||</span>&nbsp;<span class="ident" id="4145106">length</span>&nbsp;<span class="op" id="4145113">!=</span>&nbsp;<span class="ident" id="4145116">l</span><span class="op" id="4145117">+</span><span class="num" id="4145118">2</span>&nbsp;<span class="op" id="4145120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145126">return</span>&nbsp;<span class="builtintype" id="4145133">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145147">numCurves</span>&nbsp;<span class="op" id="4145157">:=</span>&nbsp;<span class="ident" id="4145160">l</span>&nbsp;<span class="op" id="4145162">/</span>&nbsp;<span class="num" id="4145164">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145169">m</span><span class="op" id="4145170">.</span><span class="ident" id="4145171">supportedCurves</span>&nbsp;<span class="op" id="4145187">=</span>&nbsp;<span class="builtinfunc" id="4145189">make</span><span class="op" id="4145193">(</span><span class="op" id="4145194">[</span><span class="op" id="4145195">]</span><span class="ident" id="4145196">CurveID</span><span class="op" id="4145203">,</span>&nbsp;<span class="ident" id="4145205">numCurves</span><span class="op" id="4145214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145219">d</span>&nbsp;<span class="op" id="4145221">:=</span>&nbsp;<span class="ident" id="4145224">data</span><span class="op" id="4145228">[</span><span class="num" id="4145229">2</span><span class="op" id="4145230">:</span><span class="op" id="4145231">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145236">for</span>&nbsp;<span class="ident" id="4145240">i</span>&nbsp;<span class="op" id="4145242">:=</span>&nbsp;<span class="num" id="4145245">0</span><span class="op" id="4145246">;</span>&nbsp;<span class="ident" id="4145248">i</span>&nbsp;<span class="op" id="4145250">&lt;</span>&nbsp;<span class="ident" id="4145252">numCurves</span><span class="op" id="4145261">;</span>&nbsp;<span class="ident" id="4145263">i</span><span class="op" id="4145264">++</span>&nbsp;<span class="op" id="4145267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145273">m</span><span class="op" id="4145274">.</span><span class="ident" id="4145275">supportedCurves</span><span class="op" id="4145290">[</span><span class="ident" id="4145291">i</span><span class="op" id="4145292">]</span>&nbsp;<span class="op" id="4145294">=</span>&nbsp;<span class="ident" id="4145296">CurveID</span><span class="op" id="4145303">(</span><span class="ident" id="4145304">d</span><span class="op" id="4145305">[</span><span class="num" id="4145306">0</span><span class="op" id="4145307">]</span><span class="op" id="4145308">)</span><span class="op" id="4145309">&lt;&lt;</span><span class="num" id="4145311">8</span>&nbsp;<span class="op" id="4145313">|</span>&nbsp;<span class="ident" id="4145315">CurveID</span><span class="op" id="4145322">(</span><span class="ident" id="4145323">d</span><span class="op" id="4145324">[</span><span class="num" id="4145325">1</span><span class="op" id="4145326">]</span><span class="op" id="4145327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145333">d</span>&nbsp;<span class="op" id="4145335">=</span>&nbsp;<span class="ident" id="4145337">d</span><span class="op" id="4145338">[</span><span class="num" id="4145339">2</span><span class="op" id="4145340">:</span><span class="op" id="4145341">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145350">case</span>&nbsp;<span class="ident" id="4145355">extensionSupportedPoints</span><span class="op" id="4145379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145384">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145439">if</span>&nbsp;<span class="ident" id="4145442">length</span>&nbsp;<span class="op" id="4145449">&lt;</span>&nbsp;<span class="num" id="4145451">1</span>&nbsp;<span class="op" id="4145453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145459">return</span>&nbsp;<span class="builtintype" id="4145466">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145480">l</span>&nbsp;<span class="op" id="4145482">:=</span>&nbsp;<span class="builtintype" id="4145485">int</span><span class="op" id="4145488">(</span><span class="ident" id="4145489">data</span><span class="op" id="4145493">[</span><span class="num" id="4145494">0</span><span class="op" id="4145495">]</span><span class="op" id="4145496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145501">if</span>&nbsp;<span class="ident" id="4145504">length</span>&nbsp;<span class="op" id="4145511">!=</span>&nbsp;<span class="ident" id="4145514">l</span><span class="op" id="4145515">+</span><span class="num" id="4145516">1</span>&nbsp;<span class="op" id="4145518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145524">return</span>&nbsp;<span class="builtintype" id="4145531">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145540">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145545">m</span><span class="op" id="4145546">.</span><span class="ident" id="4145547">supportedPoints</span>&nbsp;<span class="op" id="4145563">=</span>&nbsp;<span class="builtinfunc" id="4145565">make</span><span class="op" id="4145569">(</span><span class="op" id="4145570">[</span><span class="op" id="4145571">]</span><span class="builtintype" id="4145572">uint8</span><span class="op" id="4145577">,</span>&nbsp;<span class="ident" id="4145579">l</span><span class="op" id="4145580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4145585">copy</span><span class="op" id="4145589">(</span><span class="ident" id="4145590">m</span><span class="op" id="4145591">.</span><span class="ident" id="4145592">supportedPoints</span><span class="op" id="4145607">,</span>&nbsp;<span class="ident" id="4145609">data</span><span class="op" id="4145613">[</span><span class="num" id="4145614">1</span><span class="op" id="4145615">:</span><span class="op" id="4145616">]</span><span class="op" id="4145617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145621">case</span>&nbsp;<span class="ident" id="4145626">extensionSessionTicket</span><span class="op" id="4145648">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145653">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145706">m</span><span class="op" id="4145707">.</span><span class="ident" id="4145708">ticketSupported</span>&nbsp;<span class="op" id="4145724">=</span>&nbsp;<span class="builtintype" id="4145726">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145734">m</span><span class="op" id="4145735">.</span><span class="ident" id="4145736">sessionTicket</span>&nbsp;<span class="op" id="4145750">=</span>&nbsp;<span class="ident" id="4145752">data</span><span class="op" id="4145756">[</span><span class="op" id="4145757">:</span><span class="ident" id="4145758">length</span><span class="op" id="4145764">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145768">case</span>&nbsp;<span class="ident" id="4145773">extensionSignatureAlgorithms</span><span class="op" id="4145801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4145806">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145866">if</span>&nbsp;<span class="ident" id="4145869">length</span>&nbsp;<span class="op" id="4145876">&lt;</span>&nbsp;<span class="num" id="4145878">2</span>&nbsp;<span class="op" id="4145880">||</span>&nbsp;<span class="ident" id="4145883">length</span><span class="op" id="4145889">&amp;</span><span class="num" id="4145890">1</span>&nbsp;<span class="op" id="4145892">!=</span>&nbsp;<span class="num" id="4145895">0</span>&nbsp;<span class="op" id="4145897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145903">return</span>&nbsp;<span class="builtintype" id="4145910">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145924">l</span>&nbsp;<span class="op" id="4145926">:=</span>&nbsp;<span class="builtintype" id="4145929">int</span><span class="op" id="4145932">(</span><span class="ident" id="4145933">data</span><span class="op" id="4145937">[</span><span class="num" id="4145938">0</span><span class="op" id="4145939">]</span><span class="op" id="4145940">)</span><span class="op" id="4145941">&lt;&lt;</span><span class="num" id="4145943">8</span>&nbsp;<span class="op" id="4145945">|</span>&nbsp;<span class="builtintype" id="4145947">int</span><span class="op" id="4145950">(</span><span class="ident" id="4145951">data</span><span class="op" id="4145955">[</span><span class="num" id="4145956">1</span><span class="op" id="4145957">]</span><span class="op" id="4145958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145963">if</span>&nbsp;<span class="ident" id="4145966">l</span>&nbsp;<span class="op" id="4145968">!=</span>&nbsp;<span class="ident" id="4145971">length</span><span class="op" id="4145977">-</span><span class="num" id="4145978">2</span>&nbsp;<span class="op" id="4145980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145986">return</span>&nbsp;<span class="builtintype" id="4145993">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146002">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146007">n</span>&nbsp;<span class="op" id="4146009">:=</span>&nbsp;<span class="ident" id="4146012">l</span>&nbsp;<span class="op" id="4146014">/</span>&nbsp;<span class="num" id="4146016">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146021">d</span>&nbsp;<span class="op" id="4146023">:=</span>&nbsp;<span class="ident" id="4146026">data</span><span class="op" id="4146030">[</span><span class="num" id="4146031">2</span><span class="op" id="4146032">:</span><span class="op" id="4146033">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146038">m</span><span class="op" id="4146039">.</span><span class="ident" id="4146040">signatureAndHashes</span>&nbsp;<span class="op" id="4146059">=</span>&nbsp;<span class="builtinfunc" id="4146061">make</span><span class="op" id="4146065">(</span><span class="op" id="4146066">[</span><span class="op" id="4146067">]</span><span class="ident" id="4146068">signatureAndHash</span><span class="op" id="4146084">,</span>&nbsp;<span class="ident" id="4146086">n</span><span class="op" id="4146087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146092">for</span>&nbsp;<span class="ident" id="4146096">i</span>&nbsp;<span class="op" id="4146098">:=</span>&nbsp;<span class="keyword" id="4146101">range</span>&nbsp;<span class="ident" id="4146107">m</span><span class="op" id="4146108">.</span><span class="ident" id="4146109">signatureAndHashes</span>&nbsp;<span class="op" id="4146128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146134">m</span><span class="op" id="4146135">.</span><span class="ident" id="4146136">signatureAndHashes</span><span class="op" id="4146154">[</span><span class="ident" id="4146155">i</span><span class="op" id="4146156">]</span><span class="op" id="4146157">.</span><span class="ident" id="4146158">hash</span>&nbsp;<span class="op" id="4146163">=</span>&nbsp;<span class="ident" id="4146165">d</span><span class="op" id="4146166">[</span><span class="num" id="4146167">0</span><span class="op" id="4146168">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146174">m</span><span class="op" id="4146175">.</span><span class="ident" id="4146176">signatureAndHashes</span><span class="op" id="4146194">[</span><span class="ident" id="4146195">i</span><span class="op" id="4146196">]</span><span class="op" id="4146197">.</span><span class="ident" id="4146198">signature</span>&nbsp;<span class="op" id="4146208">=</span>&nbsp;<span class="ident" id="4146210">d</span><span class="op" id="4146211">[</span><span class="num" id="4146212">1</span><span class="op" id="4146213">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146219">d</span>&nbsp;<span class="op" id="4146221">=</span>&nbsp;<span class="ident" id="4146223">d</span><span class="op" id="4146224">[</span><span class="num" id="4146225">2</span><span class="op" id="4146226">:</span><span class="op" id="4146227">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146236">case</span>&nbsp;<span class="ident" id="4146241">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4146268">+</span>&nbsp;<span class="num" id="4146270">1</span><span class="op" id="4146271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146276">if</span>&nbsp;<span class="ident" id="4146279">length</span>&nbsp;<span class="op" id="4146286">!=</span>&nbsp;<span class="num" id="4146289">1</span>&nbsp;<span class="op" id="4146291">||</span>&nbsp;<span class="ident" id="4146294">data</span><span class="op" id="4146298">[</span><span class="num" id="4146299">0</span><span class="op" id="4146300">]</span>&nbsp;<span class="op" id="4146302">!=</span>&nbsp;<span class="num" id="4146305">0</span>&nbsp;<span class="op" id="4146307">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146313">return</span>&nbsp;<span class="builtintype" id="4146320">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146334">m</span><span class="op" id="4146335">.</span><span class="ident" id="4146336">secureRenegotiation</span>&nbsp;<span class="op" id="4146356">=</span>&nbsp;<span class="builtintype" id="4146358">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146365">case</span>&nbsp;<span class="ident" id="4146370">extensionALPN</span><span class="op" id="4146383">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146388">if</span>&nbsp;<span class="ident" id="4146391">length</span>&nbsp;<span class="op" id="4146398">&lt;</span>&nbsp;<span class="num" id="4146400">2</span>&nbsp;<span class="op" id="4146402">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146408">return</span>&nbsp;<span class="builtintype" id="4146415">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146429">l</span>&nbsp;<span class="op" id="4146431">:=</span>&nbsp;<span class="builtintype" id="4146434">int</span><span class="op" id="4146437">(</span><span class="ident" id="4146438">data</span><span class="op" id="4146442">[</span><span class="num" id="4146443">0</span><span class="op" id="4146444">]</span><span class="op" id="4146445">)</span><span class="op" id="4146446">&lt;&lt;</span><span class="num" id="4146448">8</span>&nbsp;<span class="op" id="4146450">|</span>&nbsp;<span class="builtintype" id="4146452">int</span><span class="op" id="4146455">(</span><span class="ident" id="4146456">data</span><span class="op" id="4146460">[</span><span class="num" id="4146461">1</span><span class="op" id="4146462">]</span><span class="op" id="4146463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146468">if</span>&nbsp;<span class="ident" id="4146471">l</span>&nbsp;<span class="op" id="4146473">!=</span>&nbsp;<span class="ident" id="4146476">length</span><span class="op" id="4146482">-</span><span class="num" id="4146483">2</span>&nbsp;<span class="op" id="4146485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146491">return</span>&nbsp;<span class="builtintype" id="4146498">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146512">d</span>&nbsp;<span class="op" id="4146514">:=</span>&nbsp;<span class="ident" id="4146517">data</span><span class="op" id="4146521">[</span><span class="num" id="4146522">2</span><span class="op" id="4146523">:</span><span class="ident" id="4146524">length</span><span class="op" id="4146530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146535">for</span>&nbsp;<span class="builtinfunc" id="4146539">len</span><span class="op" id="4146542">(</span><span class="ident" id="4146543">d</span><span class="op" id="4146544">)</span>&nbsp;<span class="op" id="4146546">!=</span>&nbsp;<span class="num" id="4146549">0</span>&nbsp;<span class="op" id="4146551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146557">stringLen</span>&nbsp;<span class="op" id="4146567">:=</span>&nbsp;<span class="builtintype" id="4146570">int</span><span class="op" id="4146573">(</span><span class="ident" id="4146574">d</span><span class="op" id="4146575">[</span><span class="num" id="4146576">0</span><span class="op" id="4146577">]</span><span class="op" id="4146578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146584">d</span>&nbsp;<span class="op" id="4146586">=</span>&nbsp;<span class="ident" id="4146588">d</span><span class="op" id="4146589">[</span><span class="num" id="4146590">1</span><span class="op" id="4146591">:</span><span class="op" id="4146592">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146598">if</span>&nbsp;<span class="ident" id="4146601">stringLen</span>&nbsp;<span class="op" id="4146611">==</span>&nbsp;<span class="num" id="4146614">0</span>&nbsp;<span class="op" id="4146616">||</span>&nbsp;<span class="ident" id="4146619">stringLen</span>&nbsp;<span class="op" id="4146629">&gt;</span>&nbsp;<span class="builtinfunc" id="4146631">len</span><span class="op" id="4146634">(</span><span class="ident" id="4146635">d</span><span class="op" id="4146636">)</span>&nbsp;<span class="op" id="4146638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146645">return</span>&nbsp;<span class="builtintype" id="4146652">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146668">m</span><span class="op" id="4146669">.</span><span class="ident" id="4146670">alpnProtocols</span>&nbsp;<span class="op" id="4146684">=</span>&nbsp;<span class="builtinfunc" id="4146686">append</span><span class="op" id="4146692">(</span><span class="ident" id="4146693">m</span><span class="op" id="4146694">.</span><span class="ident" id="4146695">alpnProtocols</span><span class="op" id="4146708">,</span>&nbsp;<span class="builtintype" id="4146710">string</span><span class="op" id="4146716">(</span><span class="ident" id="4146717">d</span><span class="op" id="4146718">[</span><span class="op" id="4146719">:</span><span class="ident" id="4146720">stringLen</span><span class="op" id="4146729">]</span><span class="op" id="4146730">)</span><span class="op" id="4146731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146737">d</span>&nbsp;<span class="op" id="4146739">=</span>&nbsp;<span class="ident" id="4146741">d</span><span class="op" id="4146742">[</span><span class="ident" id="4146743">stringLen</span><span class="op" id="4146752">:</span><span class="op" id="4146753">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146766">data</span>&nbsp;<span class="op" id="4146771">=</span>&nbsp;<span class="ident" id="4146773">data</span><span class="op" id="4146777">[</span><span class="ident" id="4146778">length</span><span class="op" id="4146784">:</span><span class="op" id="4146785">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146788">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146792">return</span>&nbsp;<span class="builtintype" id="4146799">true</span><br>
<span class="lineno"></span><span class="op" id="4146804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4146807">type</span>&nbsp;<span class="ident" id="4146812">serverHelloMsg</span>&nbsp;<span class="keyword" id="4146827">struct</span>&nbsp;<span class="op" id="4146834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146837">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4146857">[</span><span class="op" id="4146858">]</span><span class="builtintype" id="4146859">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146865">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4146885">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146893">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4146913">[</span><span class="op" id="4146914">]</span><span class="builtintype" id="4146915">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146921">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4146941">[</span><span class="op" id="4146942">]</span><span class="builtintype" id="4146943">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146949">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4146969">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146977">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4146997">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147004">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4147024">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147030">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4147050">[</span><span class="op" id="4147051">]</span><span class="builtintype" id="4147052">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147060">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4147080">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147086">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4147106">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147112">secureRenegotiation</span>&nbsp;<span class="builtintype" id="4147132">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147138">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4147158">string</span><br>
<span class="lineno"></span><span class="op" id="4147165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147168">func</span>&nbsp;<span class="op" id="4147173">(</span><span class="ident" id="4147174">m</span>&nbsp;<span class="op" id="4147176">*</span><span class="ident" id="4147177">serverHelloMsg</span><span class="op" id="4147191">)</span>&nbsp;<span class="ident" id="4147193">equal</span><span class="op" id="4147198">(</span><span class="ident" id="4147199">i</span>&nbsp;<span class="keyword" id="4147201">interface</span><span class="op" id="4147210">{</span><span class="op" id="4147211">}</span><span class="op" id="4147212">)</span>&nbsp;<span class="builtintype" id="4147214">bool</span>&nbsp;<span class="op" id="4147219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147222">m1</span><span class="op" id="4147224">,</span>&nbsp;<span class="ident" id="4147226">ok</span>&nbsp;<span class="op" id="4147229">:=</span>&nbsp;<span class="ident" id="4147232">i</span><span class="op" id="4147233">.</span><span class="op" id="4147234">(</span><span class="op" id="4147235">*</span><span class="ident" id="4147236">serverHelloMsg</span><span class="op" id="4147250">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147253">if</span>&nbsp;<span class="op" id="4147256">!</span><span class="ident" id="4147257">ok</span>&nbsp;<span class="op" id="4147260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147264">return</span>&nbsp;<span class="builtintype" id="4147271">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147282">return</span>&nbsp;<span class="ident" id="4147289">bytes</span><span class="op" id="4147294">.</span><span class="ident" id="4147295">Equal</span><span class="op" id="4147300">(</span><span class="ident" id="4147301">m</span><span class="op" id="4147302">.</span><span class="ident" id="4147303">raw</span><span class="op" id="4147306">,</span>&nbsp;<span class="ident" id="4147308">m1</span><span class="op" id="4147310">.</span><span class="ident" id="4147311">raw</span><span class="op" id="4147314">)</span>&nbsp;<span class="op" id="4147316">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147321">m</span><span class="op" id="4147322">.</span><span class="ident" id="4147323">vers</span>&nbsp;<span class="op" id="4147328">==</span>&nbsp;<span class="ident" id="4147331">m1</span><span class="op" id="4147333">.</span><span class="ident" id="4147334">vers</span>&nbsp;<span class="op" id="4147339">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147344">bytes</span><span class="op" id="4147349">.</span><span class="ident" id="4147350">Equal</span><span class="op" id="4147355">(</span><span class="ident" id="4147356">m</span><span class="op" id="4147357">.</span><span class="ident" id="4147358">random</span><span class="op" id="4147364">,</span>&nbsp;<span class="ident" id="4147366">m1</span><span class="op" id="4147368">.</span><span class="ident" id="4147369">random</span><span class="op" id="4147375">)</span>&nbsp;<span class="op" id="4147377">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147382">bytes</span><span class="op" id="4147387">.</span><span class="ident" id="4147388">Equal</span><span class="op" id="4147393">(</span><span class="ident" id="4147394">m</span><span class="op" id="4147395">.</span><span class="ident" id="4147396">sessionId</span><span class="op" id="4147405">,</span>&nbsp;<span class="ident" id="4147407">m1</span><span class="op" id="4147409">.</span><span class="ident" id="4147410">sessionId</span><span class="op" id="4147419">)</span>&nbsp;<span class="op" id="4147421">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147426">m</span><span class="op" id="4147427">.</span><span class="ident" id="4147428">cipherSuite</span>&nbsp;<span class="op" id="4147440">==</span>&nbsp;<span class="ident" id="4147443">m1</span><span class="op" id="4147445">.</span><span class="ident" id="4147446">cipherSuite</span>&nbsp;<span class="op" id="4147458">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147463">m</span><span class="op" id="4147464">.</span><span class="ident" id="4147465">compressionMethod</span>&nbsp;<span class="op" id="4147483">==</span>&nbsp;<span class="ident" id="4147486">m1</span><span class="op" id="4147488">.</span><span class="ident" id="4147489">compressionMethod</span>&nbsp;<span class="op" id="4147507">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147512">m</span><span class="op" id="4147513">.</span><span class="ident" id="4147514">nextProtoNeg</span>&nbsp;<span class="op" id="4147527">==</span>&nbsp;<span class="ident" id="4147530">m1</span><span class="op" id="4147532">.</span><span class="ident" id="4147533">nextProtoNeg</span>&nbsp;<span class="op" id="4147546">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147551">eqStrings</span><span class="op" id="4147560">(</span><span class="ident" id="4147561">m</span><span class="op" id="4147562">.</span><span class="ident" id="4147563">nextProtos</span><span class="op" id="4147573">,</span>&nbsp;<span class="ident" id="4147575">m1</span><span class="op" id="4147577">.</span><span class="ident" id="4147578">nextProtos</span><span class="op" id="4147588">)</span>&nbsp;<span class="op" id="4147590">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147595">m</span><span class="op" id="4147596">.</span><span class="ident" id="4147597">ocspStapling</span>&nbsp;<span class="op" id="4147610">==</span>&nbsp;<span class="ident" id="4147613">m1</span><span class="op" id="4147615">.</span><span class="ident" id="4147616">ocspStapling</span>&nbsp;<span class="op" id="4147629">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147634">m</span><span class="op" id="4147635">.</span><span class="ident" id="4147636">ticketSupported</span>&nbsp;<span class="op" id="4147652">==</span>&nbsp;<span class="ident" id="4147655">m1</span><span class="op" id="4147657">.</span><span class="ident" id="4147658">ticketSupported</span>&nbsp;<span class="op" id="4147674">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147679">m</span><span class="op" id="4147680">.</span><span class="ident" id="4147681">secureRenegotiation</span>&nbsp;<span class="op" id="4147701">==</span>&nbsp;<span class="ident" id="4147704">m1</span><span class="op" id="4147706">.</span><span class="ident" id="4147707">secureRenegotiation</span>&nbsp;<span class="op" id="4147727">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147732">m</span><span class="op" id="4147733">.</span><span class="ident" id="4147734">alpnProtocol</span>&nbsp;<span class="op" id="4147747">==</span>&nbsp;<span class="ident" id="4147750">m1</span><span class="op" id="4147752">.</span><span class="ident" id="4147753">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="4147766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147769">func</span>&nbsp;<span class="op" id="4147774">(</span><span class="ident" id="4147775">m</span>&nbsp;<span class="op" id="4147777">*</span><span class="ident" id="4147778">serverHelloMsg</span><span class="op" id="4147792">)</span>&nbsp;<span class="ident" id="4147794">marshal</span><span class="op" id="4147801">(</span><span class="op" id="4147802">)</span>&nbsp;<span class="op" id="4147804">[</span><span class="op" id="4147805">]</span><span class="builtintype" id="4147806">byte</span>&nbsp;<span class="op" id="4147811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147814">if</span>&nbsp;<span class="ident" id="4147817">m</span><span class="op" id="4147818">.</span><span class="ident" id="4147819">raw</span>&nbsp;<span class="op" id="4147823">!=</span>&nbsp;<span class="ident" id="4147826">nil</span>&nbsp;<span class="op" id="4147830">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147834">return</span>&nbsp;<span class="ident" id="4147841">m</span><span class="op" id="4147842">.</span><span class="ident" id="4147843">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147852">length</span>&nbsp;<span class="op" id="4147859">:=</span>&nbsp;<span class="num" id="4147862">38</span>&nbsp;<span class="op" id="4147865">+</span>&nbsp;<span class="builtinfunc" id="4147867">len</span><span class="op" id="4147870">(</span><span class="ident" id="4147871">m</span><span class="op" id="4147872">.</span><span class="ident" id="4147873">sessionId</span><span class="op" id="4147882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147885">numExtensions</span>&nbsp;<span class="op" id="4147899">:=</span>&nbsp;<span class="num" id="4147902">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147905">extensionsLength</span>&nbsp;<span class="op" id="4147922">:=</span>&nbsp;<span class="num" id="4147925">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147929">nextProtoLen</span>&nbsp;<span class="op" id="4147942">:=</span>&nbsp;<span class="num" id="4147945">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147948">if</span>&nbsp;<span class="ident" id="4147951">m</span><span class="op" id="4147952">.</span><span class="ident" id="4147953">nextProtoNeg</span>&nbsp;<span class="op" id="4147966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147970">numExtensions</span><span class="op" id="4147983">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147988">for</span>&nbsp;<span class="ident" id="4147992">_</span><span class="op" id="4147993">,</span>&nbsp;<span class="ident" id="4147995">v</span>&nbsp;<span class="op" id="4147997">:=</span>&nbsp;<span class="keyword" id="4148000">range</span>&nbsp;<span class="ident" id="4148006">m</span><span class="op" id="4148007">.</span><span class="ident" id="4148008">nextProtos</span>&nbsp;<span class="op" id="4148019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148024">nextProtoLen</span>&nbsp;<span class="op" id="4148037">+=</span>&nbsp;<span class="builtinfunc" id="4148040">len</span><span class="op" id="4148043">(</span><span class="ident" id="4148044">v</span><span class="op" id="4148045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148053">nextProtoLen</span>&nbsp;<span class="op" id="4148066">+=</span>&nbsp;<span class="builtinfunc" id="4148069">len</span><span class="op" id="4148072">(</span><span class="ident" id="4148073">m</span><span class="op" id="4148074">.</span><span class="ident" id="4148075">nextProtos</span><span class="op" id="4148085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148089">extensionsLength</span>&nbsp;<span class="op" id="4148106">+=</span>&nbsp;<span class="ident" id="4148109">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148126">if</span>&nbsp;<span class="ident" id="4148129">m</span><span class="op" id="4148130">.</span><span class="ident" id="4148131">ocspStapling</span>&nbsp;<span class="op" id="4148144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148148">numExtensions</span><span class="op" id="4148161">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148168">if</span>&nbsp;<span class="ident" id="4148171">m</span><span class="op" id="4148172">.</span><span class="ident" id="4148173">ticketSupported</span>&nbsp;<span class="op" id="4148189">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148193">numExtensions</span><span class="op" id="4148206">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148213">if</span>&nbsp;<span class="ident" id="4148216">m</span><span class="op" id="4148217">.</span><span class="ident" id="4148218">secureRenegotiation</span>&nbsp;<span class="op" id="4148238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148242">extensionsLength</span>&nbsp;<span class="op" id="4148259">+=</span>&nbsp;<span class="num" id="4148262">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148266">numExtensions</span><span class="op" id="4148279">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148286">if</span>&nbsp;<span class="ident" id="4148289">alpnLen</span>&nbsp;<span class="op" id="4148297">:=</span>&nbsp;<span class="builtinfunc" id="4148300">len</span><span class="op" id="4148303">(</span><span class="ident" id="4148304">m</span><span class="op" id="4148305">.</span><span class="ident" id="4148306">alpnProtocol</span><span class="op" id="4148318">)</span><span class="op" id="4148319">;</span>&nbsp;<span class="ident" id="4148321">alpnLen</span>&nbsp;<span class="op" id="4148329">&gt;</span>&nbsp;<span class="num" id="4148331">0</span>&nbsp;<span class="op" id="4148333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148337">if</span>&nbsp;<span class="ident" id="4148340">alpnLen</span>&nbsp;<span class="op" id="4148348">&gt;=</span>&nbsp;<span class="num" id="4148351">256</span>&nbsp;<span class="op" id="4148355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4148360">panic</span><span class="op" id="4148365">(</span><span class="string" id="4148366">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="4148389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148393">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148397">extensionsLength</span>&nbsp;<span class="op" id="4148414">+=</span>&nbsp;<span class="num" id="4148417">2</span>&nbsp;<span class="op" id="4148419">+</span>&nbsp;<span class="num" id="4148421">1</span>&nbsp;<span class="op" id="4148423">+</span>&nbsp;<span class="ident" id="4148425">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148435">numExtensions</span><span class="op" id="4148448">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148456">if</span>&nbsp;<span class="ident" id="4148459">numExtensions</span>&nbsp;<span class="op" id="4148473">&gt;</span>&nbsp;<span class="num" id="4148475">0</span>&nbsp;<span class="op" id="4148477">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148481">extensionsLength</span>&nbsp;<span class="op" id="4148498">+=</span>&nbsp;<span class="num" id="4148501">4</span>&nbsp;<span class="op" id="4148503">*</span>&nbsp;<span class="ident" id="4148505">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148521">length</span>&nbsp;<span class="op" id="4148528">+=</span>&nbsp;<span class="num" id="4148531">2</span>&nbsp;<span class="op" id="4148533">+</span>&nbsp;<span class="ident" id="4148535">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4148553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148557">x</span>&nbsp;<span class="op" id="4148559">:=</span>&nbsp;<span class="builtinfunc" id="4148562">make</span><span class="op" id="4148566">(</span><span class="op" id="4148567">[</span><span class="op" id="4148568">]</span><span class="builtintype" id="4148569">byte</span><span class="op" id="4148573">,</span>&nbsp;<span class="num" id="4148575">4</span><span class="op" id="4148576">+</span><span class="ident" id="4148577">length</span><span class="op" id="4148583">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148586">x</span><span class="op" id="4148587">[</span><span class="num" id="4148588">0</span><span class="op" id="4148589">]</span>&nbsp;<span class="op" id="4148591">=</span>&nbsp;<span class="ident" id="4148593">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148610">x</span><span class="op" id="4148611">[</span><span class="num" id="4148612">1</span><span class="op" id="4148613">]</span>&nbsp;<span class="op" id="4148615">=</span>&nbsp;<span class="builtintype" id="4148617">uint8</span><span class="op" id="4148622">(</span><span class="ident" id="4148623">length</span>&nbsp;<span class="op" id="4148630">&gt;&gt;</span>&nbsp;<span class="num" id="4148633">16</span><span class="op" id="4148635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148638">x</span><span class="op" id="4148639">[</span><span class="num" id="4148640">2</span><span class="op" id="4148641">]</span>&nbsp;<span class="op" id="4148643">=</span>&nbsp;<span class="builtintype" id="4148645">uint8</span><span class="op" id="4148650">(</span><span class="ident" id="4148651">length</span>&nbsp;<span class="op" id="4148658">&gt;&gt;</span>&nbsp;<span class="num" id="4148661">8</span><span class="op" id="4148662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148665">x</span><span class="op" id="4148666">[</span><span class="num" id="4148667">3</span><span class="op" id="4148668">]</span>&nbsp;<span class="op" id="4148670">=</span>&nbsp;<span class="builtintype" id="4148672">uint8</span><span class="op" id="4148677">(</span><span class="ident" id="4148678">length</span><span class="op" id="4148684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148687">x</span><span class="op" id="4148688">[</span><span class="num" id="4148689">4</span><span class="op" id="4148690">]</span>&nbsp;<span class="op" id="4148692">=</span>&nbsp;<span class="builtintype" id="4148694">uint8</span><span class="op" id="4148699">(</span><span class="ident" id="4148700">m</span><span class="op" id="4148701">.</span><span class="ident" id="4148702">vers</span>&nbsp;<span class="op" id="4148707">&gt;&gt;</span>&nbsp;<span class="num" id="4148710">8</span><span class="op" id="4148711">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148714">x</span><span class="op" id="4148715">[</span><span class="num" id="4148716">5</span><span class="op" id="4148717">]</span>&nbsp;<span class="op" id="4148719">=</span>&nbsp;<span class="builtintype" id="4148721">uint8</span><span class="op" id="4148726">(</span><span class="ident" id="4148727">m</span><span class="op" id="4148728">.</span><span class="ident" id="4148729">vers</span><span class="op" id="4148733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4148736">copy</span><span class="op" id="4148740">(</span><span class="ident" id="4148741">x</span><span class="op" id="4148742">[</span><span class="num" id="4148743">6</span><span class="op" id="4148744">:</span><span class="num" id="4148745">38</span><span class="op" id="4148747">]</span><span class="op" id="4148748">,</span>&nbsp;<span class="ident" id="4148750">m</span><span class="op" id="4148751">.</span><span class="ident" id="4148752">random</span><span class="op" id="4148758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148761">x</span><span class="op" id="4148762">[</span><span class="num" id="4148763">38</span><span class="op" id="4148765">]</span>&nbsp;<span class="op" id="4148767">=</span>&nbsp;<span class="builtintype" id="4148769">uint8</span><span class="op" id="4148774">(</span><span class="builtinfunc" id="4148775">len</span><span class="op" id="4148778">(</span><span class="ident" id="4148779">m</span><span class="op" id="4148780">.</span><span class="ident" id="4148781">sessionId</span><span class="op" id="4148790">)</span><span class="op" id="4148791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4148794">copy</span><span class="op" id="4148798">(</span><span class="ident" id="4148799">x</span><span class="op" id="4148800">[</span><span class="num" id="4148801">39</span><span class="op" id="4148803">:</span><span class="num" id="4148804">39</span><span class="op" id="4148806">+</span><span class="builtinfunc" id="4148807">len</span><span class="op" id="4148810">(</span><span class="ident" id="4148811">m</span><span class="op" id="4148812">.</span><span class="ident" id="4148813">sessionId</span><span class="op" id="4148822">)</span><span class="op" id="4148823">]</span><span class="op" id="4148824">,</span>&nbsp;<span class="ident" id="4148826">m</span><span class="op" id="4148827">.</span><span class="ident" id="4148828">sessionId</span><span class="op" id="4148837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148840">z</span>&nbsp;<span class="op" id="4148842">:=</span>&nbsp;<span class="ident" id="4148845">x</span><span class="op" id="4148846">[</span><span class="num" id="4148847">39</span><span class="op" id="4148849">+</span><span class="builtinfunc" id="4148850">len</span><span class="op" id="4148853">(</span><span class="ident" id="4148854">m</span><span class="op" id="4148855">.</span><span class="ident" id="4148856">sessionId</span><span class="op" id="4148865">)</span><span class="op" id="4148866">:</span><span class="op" id="4148867">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148870">z</span><span class="op" id="4148871">[</span><span class="num" id="4148872">0</span><span class="op" id="4148873">]</span>&nbsp;<span class="op" id="4148875">=</span>&nbsp;<span class="builtintype" id="4148877">uint8</span><span class="op" id="4148882">(</span><span class="ident" id="4148883">m</span><span class="op" id="4148884">.</span><span class="ident" id="4148885">cipherSuite</span>&nbsp;<span class="op" id="4148897">&gt;&gt;</span>&nbsp;<span class="num" id="4148900">8</span><span class="op" id="4148901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148904">z</span><span class="op" id="4148905">[</span><span class="num" id="4148906">1</span><span class="op" id="4148907">]</span>&nbsp;<span class="op" id="4148909">=</span>&nbsp;<span class="builtintype" id="4148911">uint8</span><span class="op" id="4148916">(</span><span class="ident" id="4148917">m</span><span class="op" id="4148918">.</span><span class="ident" id="4148919">cipherSuite</span><span class="op" id="4148930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148933">z</span><span class="op" id="4148934">[</span><span class="num" id="4148935">2</span><span class="op" id="4148936">]</span>&nbsp;<span class="op" id="4148938">=</span>&nbsp;<span class="builtintype" id="4148940">uint8</span><span class="op" id="4148945">(</span><span class="ident" id="4148946">m</span><span class="op" id="4148947">.</span><span class="ident" id="4148948">compressionMethod</span><span class="op" id="4148965">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148969">z</span>&nbsp;<span class="op" id="4148971">=</span>&nbsp;<span class="ident" id="4148973">z</span><span class="op" id="4148974">[</span><span class="num" id="4148975">3</span><span class="op" id="4148976">:</span><span class="op" id="4148977">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4148980">if</span>&nbsp;<span class="ident" id="4148983">numExtensions</span>&nbsp;<span class="op" id="4148997">&gt;</span>&nbsp;<span class="num" id="4148999">0</span>&nbsp;<span class="op" id="4149001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149005">z</span><span class="op" id="4149006">[</span><span class="num" id="4149007">0</span><span class="op" id="4149008">]</span>&nbsp;<span class="op" id="4149010">=</span>&nbsp;<span class="builtintype" id="4149012">byte</span><span class="op" id="4149016">(</span><span class="ident" id="4149017">extensionsLength</span>&nbsp;<span class="op" id="4149034">&gt;&gt;</span>&nbsp;<span class="num" id="4149037">8</span><span class="op" id="4149038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149042">z</span><span class="op" id="4149043">[</span><span class="num" id="4149044">1</span><span class="op" id="4149045">]</span>&nbsp;<span class="op" id="4149047">=</span>&nbsp;<span class="builtintype" id="4149049">byte</span><span class="op" id="4149053">(</span><span class="ident" id="4149054">extensionsLength</span><span class="op" id="4149070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149074">z</span>&nbsp;<span class="op" id="4149076">=</span>&nbsp;<span class="ident" id="4149078">z</span><span class="op" id="4149079">[</span><span class="num" id="4149080">2</span><span class="op" id="4149081">:</span><span class="op" id="4149082">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149085">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149088">if</span>&nbsp;<span class="ident" id="4149091">m</span><span class="op" id="4149092">.</span><span class="ident" id="4149093">nextProtoNeg</span>&nbsp;<span class="op" id="4149106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149110">z</span><span class="op" id="4149111">[</span><span class="num" id="4149112">0</span><span class="op" id="4149113">]</span>&nbsp;<span class="op" id="4149115">=</span>&nbsp;<span class="builtintype" id="4149117">byte</span><span class="op" id="4149121">(</span><span class="ident" id="4149122">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4149144">&gt;&gt;</span>&nbsp;<span class="num" id="4149147">8</span><span class="op" id="4149148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149152">z</span><span class="op" id="4149153">[</span><span class="num" id="4149154">1</span><span class="op" id="4149155">]</span>&nbsp;<span class="op" id="4149157">=</span>&nbsp;<span class="builtintype" id="4149159">byte</span><span class="op" id="4149163">(</span><span class="ident" id="4149164">extensionNextProtoNeg</span>&nbsp;<span class="op" id="4149186">&amp;</span>&nbsp;<span class="num" id="4149188">0xff</span><span class="op" id="4149192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149196">z</span><span class="op" id="4149197">[</span><span class="num" id="4149198">2</span><span class="op" id="4149199">]</span>&nbsp;<span class="op" id="4149201">=</span>&nbsp;<span class="builtintype" id="4149203">byte</span><span class="op" id="4149207">(</span><span class="ident" id="4149208">nextProtoLen</span>&nbsp;<span class="op" id="4149221">&gt;&gt;</span>&nbsp;<span class="num" id="4149224">8</span><span class="op" id="4149225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149229">z</span><span class="op" id="4149230">[</span><span class="num" id="4149231">3</span><span class="op" id="4149232">]</span>&nbsp;<span class="op" id="4149234">=</span>&nbsp;<span class="builtintype" id="4149236">byte</span><span class="op" id="4149240">(</span><span class="ident" id="4149241">nextProtoLen</span><span class="op" id="4149253">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149257">z</span>&nbsp;<span class="op" id="4149259">=</span>&nbsp;<span class="ident" id="4149261">z</span><span class="op" id="4149262">[</span><span class="num" id="4149263">4</span><span class="op" id="4149264">:</span><span class="op" id="4149265">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149270">for</span>&nbsp;<span class="ident" id="4149274">_</span><span class="op" id="4149275">,</span>&nbsp;<span class="ident" id="4149277">v</span>&nbsp;<span class="op" id="4149279">:=</span>&nbsp;<span class="keyword" id="4149282">range</span>&nbsp;<span class="ident" id="4149288">m</span><span class="op" id="4149289">.</span><span class="ident" id="4149290">nextProtos</span>&nbsp;<span class="op" id="4149301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149306">l</span>&nbsp;<span class="op" id="4149308">:=</span>&nbsp;<span class="builtinfunc" id="4149311">len</span><span class="op" id="4149314">(</span><span class="ident" id="4149315">v</span><span class="op" id="4149316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149321">if</span>&nbsp;<span class="ident" id="4149324">l</span>&nbsp;<span class="op" id="4149326">&gt;</span>&nbsp;<span class="num" id="4149328">255</span>&nbsp;<span class="op" id="4149332">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149338">l</span>&nbsp;<span class="op" id="4149340">=</span>&nbsp;<span class="num" id="4149342">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149354">z</span><span class="op" id="4149355">[</span><span class="num" id="4149356">0</span><span class="op" id="4149357">]</span>&nbsp;<span class="op" id="4149359">=</span>&nbsp;<span class="builtintype" id="4149361">byte</span><span class="op" id="4149365">(</span><span class="ident" id="4149366">l</span><span class="op" id="4149367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4149372">copy</span><span class="op" id="4149376">(</span><span class="ident" id="4149377">z</span><span class="op" id="4149378">[</span><span class="num" id="4149379">1</span><span class="op" id="4149380">:</span><span class="op" id="4149381">]</span><span class="op" id="4149382">,</span>&nbsp;<span class="op" id="4149384">[</span><span class="op" id="4149385">]</span><span class="builtintype" id="4149386">byte</span><span class="op" id="4149390">(</span><span class="ident" id="4149391">v</span><span class="op" id="4149392">[</span><span class="num" id="4149393">0</span><span class="op" id="4149394">:</span><span class="ident" id="4149395">l</span><span class="op" id="4149396">]</span><span class="op" id="4149397">)</span><span class="op" id="4149398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149403">z</span>&nbsp;<span class="op" id="4149405">=</span>&nbsp;<span class="ident" id="4149407">z</span><span class="op" id="4149408">[</span><span class="num" id="4149409">1</span><span class="op" id="4149410">+</span><span class="ident" id="4149411">l</span><span class="op" id="4149412">:</span><span class="op" id="4149413">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149423">if</span>&nbsp;<span class="ident" id="4149426">m</span><span class="op" id="4149427">.</span><span class="ident" id="4149428">ocspStapling</span>&nbsp;<span class="op" id="4149441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149445">z</span><span class="op" id="4149446">[</span><span class="num" id="4149447">0</span><span class="op" id="4149448">]</span>&nbsp;<span class="op" id="4149450">=</span>&nbsp;<span class="builtintype" id="4149452">byte</span><span class="op" id="4149456">(</span><span class="ident" id="4149457">extensionStatusRequest</span>&nbsp;<span class="op" id="4149480">&gt;&gt;</span>&nbsp;<span class="num" id="4149483">8</span><span class="op" id="4149484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149488">z</span><span class="op" id="4149489">[</span><span class="num" id="4149490">1</span><span class="op" id="4149491">]</span>&nbsp;<span class="op" id="4149493">=</span>&nbsp;<span class="builtintype" id="4149495">byte</span><span class="op" id="4149499">(</span><span class="ident" id="4149500">extensionStatusRequest</span><span class="op" id="4149522">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149526">z</span>&nbsp;<span class="op" id="4149528">=</span>&nbsp;<span class="ident" id="4149530">z</span><span class="op" id="4149531">[</span><span class="num" id="4149532">4</span><span class="op" id="4149533">:</span><span class="op" id="4149534">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149540">if</span>&nbsp;<span class="ident" id="4149543">m</span><span class="op" id="4149544">.</span><span class="ident" id="4149545">ticketSupported</span>&nbsp;<span class="op" id="4149561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149565">z</span><span class="op" id="4149566">[</span><span class="num" id="4149567">0</span><span class="op" id="4149568">]</span>&nbsp;<span class="op" id="4149570">=</span>&nbsp;<span class="builtintype" id="4149572">byte</span><span class="op" id="4149576">(</span><span class="ident" id="4149577">extensionSessionTicket</span>&nbsp;<span class="op" id="4149600">&gt;&gt;</span>&nbsp;<span class="num" id="4149603">8</span><span class="op" id="4149604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149608">z</span><span class="op" id="4149609">[</span><span class="num" id="4149610">1</span><span class="op" id="4149611">]</span>&nbsp;<span class="op" id="4149613">=</span>&nbsp;<span class="builtintype" id="4149615">byte</span><span class="op" id="4149619">(</span><span class="ident" id="4149620">extensionSessionTicket</span><span class="op" id="4149642">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149646">z</span>&nbsp;<span class="op" id="4149648">=</span>&nbsp;<span class="ident" id="4149650">z</span><span class="op" id="4149651">[</span><span class="num" id="4149652">4</span><span class="op" id="4149653">:</span><span class="op" id="4149654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149660">if</span>&nbsp;<span class="ident" id="4149663">m</span><span class="op" id="4149664">.</span><span class="ident" id="4149665">secureRenegotiation</span>&nbsp;<span class="op" id="4149685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149689">z</span><span class="op" id="4149690">[</span><span class="num" id="4149691">0</span><span class="op" id="4149692">]</span>&nbsp;<span class="op" id="4149694">=</span>&nbsp;<span class="builtintype" id="4149696">byte</span><span class="op" id="4149700">(</span><span class="ident" id="4149701">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4149728">&gt;&gt;</span>&nbsp;<span class="num" id="4149731">8</span><span class="op" id="4149732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149736">z</span><span class="op" id="4149737">[</span><span class="num" id="4149738">1</span><span class="op" id="4149739">]</span>&nbsp;<span class="op" id="4149741">=</span>&nbsp;<span class="builtintype" id="4149743">byte</span><span class="op" id="4149747">(</span><span class="ident" id="4149748">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="4149775">&amp;</span>&nbsp;<span class="num" id="4149777">0xff</span><span class="op" id="4149781">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149785">z</span><span class="op" id="4149786">[</span><span class="num" id="4149787">2</span><span class="op" id="4149788">]</span>&nbsp;<span class="op" id="4149790">=</span>&nbsp;<span class="num" id="4149792">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149796">z</span><span class="op" id="4149797">[</span><span class="num" id="4149798">3</span><span class="op" id="4149799">]</span>&nbsp;<span class="op" id="4149801">=</span>&nbsp;<span class="num" id="4149803">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149807">z</span>&nbsp;<span class="op" id="4149809">=</span>&nbsp;<span class="ident" id="4149811">z</span><span class="op" id="4149812">[</span><span class="num" id="4149813">5</span><span class="op" id="4149814">:</span><span class="op" id="4149815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4149818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149821">if</span>&nbsp;<span class="ident" id="4149824">alpnLen</span>&nbsp;<span class="op" id="4149832">:=</span>&nbsp;<span class="builtinfunc" id="4149835">len</span><span class="op" id="4149838">(</span><span class="ident" id="4149839">m</span><span class="op" id="4149840">.</span><span class="ident" id="4149841">alpnProtocol</span><span class="op" id="4149853">)</span><span class="op" id="4149854">;</span>&nbsp;<span class="ident" id="4149856">alpnLen</span>&nbsp;<span class="op" id="4149864">&gt;</span>&nbsp;<span class="num" id="4149866">0</span>&nbsp;<span class="op" id="4149868">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149872">z</span><span class="op" id="4149873">[</span><span class="num" id="4149874">0</span><span class="op" id="4149875">]</span>&nbsp;<span class="op" id="4149877">=</span>&nbsp;<span class="builtintype" id="4149879">byte</span><span class="op" id="4149883">(</span><span class="ident" id="4149884">extensionALPN</span>&nbsp;<span class="op" id="4149898">&gt;&gt;</span>&nbsp;<span class="num" id="4149901">8</span><span class="op" id="4149902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149906">z</span><span class="op" id="4149907">[</span><span class="num" id="4149908">1</span><span class="op" id="4149909">]</span>&nbsp;<span class="op" id="4149911">=</span>&nbsp;<span class="builtintype" id="4149913">byte</span><span class="op" id="4149917">(</span><span class="ident" id="4149918">extensionALPN</span>&nbsp;<span class="op" id="4149932">&amp;</span>&nbsp;<span class="num" id="4149934">0xff</span><span class="op" id="4149938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149942">l</span>&nbsp;<span class="op" id="4149944">:=</span>&nbsp;<span class="num" id="4149947">2</span>&nbsp;<span class="op" id="4149949">+</span>&nbsp;<span class="num" id="4149951">1</span>&nbsp;<span class="op" id="4149953">+</span>&nbsp;<span class="ident" id="4149955">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149965">z</span><span class="op" id="4149966">[</span><span class="num" id="4149967">2</span><span class="op" id="4149968">]</span>&nbsp;<span class="op" id="4149970">=</span>&nbsp;<span class="builtintype" id="4149972">byte</span><span class="op" id="4149976">(</span><span class="ident" id="4149977">l</span>&nbsp;<span class="op" id="4149979">&gt;&gt;</span>&nbsp;<span class="num" id="4149982">8</span><span class="op" id="4149983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149987">z</span><span class="op" id="4149988">[</span><span class="num" id="4149989">3</span><span class="op" id="4149990">]</span>&nbsp;<span class="op" id="4149992">=</span>&nbsp;<span class="builtintype" id="4149994">byte</span><span class="op" id="4149998">(</span><span class="ident" id="4149999">l</span><span class="op" id="4150000">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150004">l</span>&nbsp;<span class="op" id="4150006">-=</span>&nbsp;<span class="num" id="4150009">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150013">z</span><span class="op" id="4150014">[</span><span class="num" id="4150015">4</span><span class="op" id="4150016">]</span>&nbsp;<span class="op" id="4150018">=</span>&nbsp;<span class="builtintype" id="4150020">byte</span><span class="op" id="4150024">(</span><span class="ident" id="4150025">l</span>&nbsp;<span class="op" id="4150027">&gt;&gt;</span>&nbsp;<span class="num" id="4150030">8</span><span class="op" id="4150031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150035">z</span><span class="op" id="4150036">[</span><span class="num" id="4150037">5</span><span class="op" id="4150038">]</span>&nbsp;<span class="op" id="4150040">=</span>&nbsp;<span class="builtintype" id="4150042">byte</span><span class="op" id="4150046">(</span><span class="ident" id="4150047">l</span><span class="op" id="4150048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150052">l</span>&nbsp;<span class="op" id="4150054">-=</span>&nbsp;<span class="num" id="4150057">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150061">z</span><span class="op" id="4150062">[</span><span class="num" id="4150063">6</span><span class="op" id="4150064">]</span>&nbsp;<span class="op" id="4150066">=</span>&nbsp;<span class="builtintype" id="4150068">byte</span><span class="op" id="4150072">(</span><span class="ident" id="4150073">l</span><span class="op" id="4150074">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4150078">copy</span><span class="op" id="4150082">(</span><span class="ident" id="4150083">z</span><span class="op" id="4150084">[</span><span class="num" id="4150085">7</span><span class="op" id="4150086">:</span><span class="op" id="4150087">]</span><span class="op" id="4150088">,</span>&nbsp;<span class="op" id="4150090">[</span><span class="op" id="4150091">]</span><span class="builtintype" id="4150092">byte</span><span class="op" id="4150096">(</span><span class="ident" id="4150097">m</span><span class="op" id="4150098">.</span><span class="ident" id="4150099">alpnProtocol</span><span class="op" id="4150111">)</span><span class="op" id="4150112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150116">z</span>&nbsp;<span class="op" id="4150118">=</span>&nbsp;<span class="ident" id="4150120">z</span><span class="op" id="4150121">[</span><span class="num" id="4150122">7</span><span class="op" id="4150123">+</span><span class="ident" id="4150124">alpnLen</span><span class="op" id="4150131">:</span><span class="op" id="4150132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150139">m</span><span class="op" id="4150140">.</span><span class="ident" id="4150141">raw</span>&nbsp;<span class="op" id="4150145">=</span>&nbsp;<span class="ident" id="4150147">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150151">return</span>&nbsp;<span class="ident" id="4150158">x</span><br>
<span class="lineno"></span><span class="op" id="4150160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4150163">func</span>&nbsp;<span class="op" id="4150168">(</span><span class="ident" id="4150169">m</span>&nbsp;<span class="op" id="4150171">*</span><span class="ident" id="4150172">serverHelloMsg</span><span class="op" id="4150186">)</span>&nbsp;<span class="ident" id="4150188">unmarshal</span><span class="op" id="4150197">(</span><span class="ident" id="4150198">data</span>&nbsp;<span class="op" id="4150203">[</span><span class="op" id="4150204">]</span><span class="builtintype" id="4150205">byte</span><span class="op" id="4150209">)</span>&nbsp;<span class="builtintype" id="4150211">bool</span>&nbsp;<span class="op" id="4150216">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150219">if</span>&nbsp;<span class="builtinfunc" id="4150222">len</span><span class="op" id="4150225">(</span><span class="ident" id="4150226">data</span><span class="op" id="4150230">)</span>&nbsp;<span class="op" id="4150232">&lt;</span>&nbsp;<span class="num" id="4150234">42</span>&nbsp;<span class="op" id="4150237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150241">return</span>&nbsp;<span class="builtintype" id="4150248">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150258">m</span><span class="op" id="4150259">.</span><span class="ident" id="4150260">raw</span>&nbsp;<span class="op" id="4150264">=</span>&nbsp;<span class="ident" id="4150266">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150272">m</span><span class="op" id="4150273">.</span><span class="ident" id="4150274">vers</span>&nbsp;<span class="op" id="4150279">=</span>&nbsp;<span class="builtintype" id="4150281">uint16</span><span class="op" id="4150287">(</span><span class="ident" id="4150288">data</span><span class="op" id="4150292">[</span><span class="num" id="4150293">4</span><span class="op" id="4150294">]</span><span class="op" id="4150295">)</span><span class="op" id="4150296">&lt;&lt;</span><span class="num" id="4150298">8</span>&nbsp;<span class="op" id="4150300">|</span>&nbsp;<span class="builtintype" id="4150302">uint16</span><span class="op" id="4150308">(</span><span class="ident" id="4150309">data</span><span class="op" id="4150313">[</span><span class="num" id="4150314">5</span><span class="op" id="4150315">]</span><span class="op" id="4150316">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150319">m</span><span class="op" id="4150320">.</span><span class="ident" id="4150321">random</span>&nbsp;<span class="op" id="4150328">=</span>&nbsp;<span class="ident" id="4150330">data</span><span class="op" id="4150334">[</span><span class="num" id="4150335">6</span><span class="op" id="4150336">:</span><span class="num" id="4150337">38</span><span class="op" id="4150339">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150342">sessionIdLen</span>&nbsp;<span class="op" id="4150355">:=</span>&nbsp;<span class="builtintype" id="4150358">int</span><span class="op" id="4150361">(</span><span class="ident" id="4150362">data</span><span class="op" id="4150366">[</span><span class="num" id="4150367">38</span><span class="op" id="4150369">]</span><span class="op" id="4150370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150373">if</span>&nbsp;<span class="ident" id="4150376">sessionIdLen</span>&nbsp;<span class="op" id="4150389">&gt;</span>&nbsp;<span class="num" id="4150391">32</span>&nbsp;<span class="op" id="4150394">||</span>&nbsp;<span class="builtinfunc" id="4150397">len</span><span class="op" id="4150400">(</span><span class="ident" id="4150401">data</span><span class="op" id="4150405">)</span>&nbsp;<span class="op" id="4150407">&lt;</span>&nbsp;<span class="num" id="4150409">39</span><span class="op" id="4150411">+</span><span class="ident" id="4150412">sessionIdLen</span>&nbsp;<span class="op" id="4150425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150429">return</span>&nbsp;<span class="builtintype" id="4150436">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150443">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150446">m</span><span class="op" id="4150447">.</span><span class="ident" id="4150448">sessionId</span>&nbsp;<span class="op" id="4150458">=</span>&nbsp;<span class="ident" id="4150460">data</span><span class="op" id="4150464">[</span><span class="num" id="4150465">39</span>&nbsp;<span class="op" id="4150468">:</span>&nbsp;<span class="num" id="4150470">39</span><span class="op" id="4150472">+</span><span class="ident" id="4150473">sessionIdLen</span><span class="op" id="4150485">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150488">data</span>&nbsp;<span class="op" id="4150493">=</span>&nbsp;<span class="ident" id="4150495">data</span><span class="op" id="4150499">[</span><span class="num" id="4150500">39</span><span class="op" id="4150502">+</span><span class="ident" id="4150503">sessionIdLen</span><span class="op" id="4150515">:</span><span class="op" id="4150516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150519">if</span>&nbsp;<span class="builtinfunc" id="4150522">len</span><span class="op" id="4150525">(</span><span class="ident" id="4150526">data</span><span class="op" id="4150530">)</span>&nbsp;<span class="op" id="4150532">&lt;</span>&nbsp;<span class="num" id="4150534">3</span>&nbsp;<span class="op" id="4150536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150540">return</span>&nbsp;<span class="builtintype" id="4150547">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150554">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150557">m</span><span class="op" id="4150558">.</span><span class="ident" id="4150559">cipherSuite</span>&nbsp;<span class="op" id="4150571">=</span>&nbsp;<span class="builtintype" id="4150573">uint16</span><span class="op" id="4150579">(</span><span class="ident" id="4150580">data</span><span class="op" id="4150584">[</span><span class="num" id="4150585">0</span><span class="op" id="4150586">]</span><span class="op" id="4150587">)</span><span class="op" id="4150588">&lt;&lt;</span><span class="num" id="4150590">8</span>&nbsp;<span class="op" id="4150592">|</span>&nbsp;<span class="builtintype" id="4150594">uint16</span><span class="op" id="4150600">(</span><span class="ident" id="4150601">data</span><span class="op" id="4150605">[</span><span class="num" id="4150606">1</span><span class="op" id="4150607">]</span><span class="op" id="4150608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150611">m</span><span class="op" id="4150612">.</span><span class="ident" id="4150613">compressionMethod</span>&nbsp;<span class="op" id="4150631">=</span>&nbsp;<span class="ident" id="4150633">data</span><span class="op" id="4150637">[</span><span class="num" id="4150638">2</span><span class="op" id="4150639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150642">data</span>&nbsp;<span class="op" id="4150647">=</span>&nbsp;<span class="ident" id="4150649">data</span><span class="op" id="4150653">[</span><span class="num" id="4150654">3</span><span class="op" id="4150655">:</span><span class="op" id="4150656">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150660">m</span><span class="op" id="4150661">.</span><span class="ident" id="4150662">nextProtoNeg</span>&nbsp;<span class="op" id="4150675">=</span>&nbsp;<span class="builtintype" id="4150677">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150684">m</span><span class="op" id="4150685">.</span><span class="ident" id="4150686">nextProtos</span>&nbsp;<span class="op" id="4150697">=</span>&nbsp;<span class="ident" id="4150699">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150704">m</span><span class="op" id="4150705">.</span><span class="ident" id="4150706">ocspStapling</span>&nbsp;<span class="op" id="4150719">=</span>&nbsp;<span class="builtintype" id="4150721">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150728">m</span><span class="op" id="4150729">.</span><span class="ident" id="4150730">ticketSupported</span>&nbsp;<span class="op" id="4150746">=</span>&nbsp;<span class="builtintype" id="4150748">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150755">m</span><span class="op" id="4150756">.</span><span class="ident" id="4150757">alpnProtocol</span>&nbsp;<span class="op" id="4150770">=</span>&nbsp;<span class="string" id="4150772">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150777">if</span>&nbsp;<span class="builtinfunc" id="4150780">len</span><span class="op" id="4150783">(</span><span class="ident" id="4150784">data</span><span class="op" id="4150788">)</span>&nbsp;<span class="op" id="4150790">==</span>&nbsp;<span class="num" id="4150793">0</span>&nbsp;<span class="op" id="4150795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4150799">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150857">return</span>&nbsp;<span class="builtintype" id="4150864">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150873">if</span>&nbsp;<span class="builtinfunc" id="4150876">len</span><span class="op" id="4150879">(</span><span class="ident" id="4150880">data</span><span class="op" id="4150884">)</span>&nbsp;<span class="op" id="4150886">&lt;</span>&nbsp;<span class="num" id="4150888">2</span>&nbsp;<span class="op" id="4150890">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150894">return</span>&nbsp;<span class="builtintype" id="4150901">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4150908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150912">extensionsLength</span>&nbsp;<span class="op" id="4150929">:=</span>&nbsp;<span class="builtintype" id="4150932">int</span><span class="op" id="4150935">(</span><span class="ident" id="4150936">data</span><span class="op" id="4150940">[</span><span class="num" id="4150941">0</span><span class="op" id="4150942">]</span><span class="op" id="4150943">)</span><span class="op" id="4150944">&lt;&lt;</span><span class="num" id="4150946">8</span>&nbsp;<span class="op" id="4150948">|</span>&nbsp;<span class="builtintype" id="4150950">int</span><span class="op" id="4150953">(</span><span class="ident" id="4150954">data</span><span class="op" id="4150958">[</span><span class="num" id="4150959">1</span><span class="op" id="4150960">]</span><span class="op" id="4150961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150964">data</span>&nbsp;<span class="op" id="4150969">=</span>&nbsp;<span class="ident" id="4150971">data</span><span class="op" id="4150975">[</span><span class="num" id="4150976">2</span><span class="op" id="4150977">:</span><span class="op" id="4150978">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150981">if</span>&nbsp;<span class="builtinfunc" id="4150984">len</span><span class="op" id="4150987">(</span><span class="ident" id="4150988">data</span><span class="op" id="4150992">)</span>&nbsp;<span class="op" id="4150994">!=</span>&nbsp;<span class="ident" id="4150997">extensionsLength</span>&nbsp;<span class="op" id="4151014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151018">return</span>&nbsp;<span class="builtintype" id="4151025">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151036">for</span>&nbsp;<span class="builtinfunc" id="4151040">len</span><span class="op" id="4151043">(</span><span class="ident" id="4151044">data</span><span class="op" id="4151048">)</span>&nbsp;<span class="op" id="4151050">!=</span>&nbsp;<span class="num" id="4151053">0</span>&nbsp;<span class="op" id="4151055">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151059">if</span>&nbsp;<span class="builtinfunc" id="4151062">len</span><span class="op" id="4151065">(</span><span class="ident" id="4151066">data</span><span class="op" id="4151070">)</span>&nbsp;<span class="op" id="4151072">&lt;</span>&nbsp;<span class="num" id="4151074">4</span>&nbsp;<span class="op" id="4151076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151081">return</span>&nbsp;<span class="builtintype" id="4151088">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151100">extension</span>&nbsp;<span class="op" id="4151110">:=</span>&nbsp;<span class="builtintype" id="4151113">uint16</span><span class="op" id="4151119">(</span><span class="ident" id="4151120">data</span><span class="op" id="4151124">[</span><span class="num" id="4151125">0</span><span class="op" id="4151126">]</span><span class="op" id="4151127">)</span><span class="op" id="4151128">&lt;&lt;</span><span class="num" id="4151130">8</span>&nbsp;<span class="op" id="4151132">|</span>&nbsp;<span class="builtintype" id="4151134">uint16</span><span class="op" id="4151140">(</span><span class="ident" id="4151141">data</span><span class="op" id="4151145">[</span><span class="num" id="4151146">1</span><span class="op" id="4151147">]</span><span class="op" id="4151148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151152">length</span>&nbsp;<span class="op" id="4151159">:=</span>&nbsp;<span class="builtintype" id="4151162">int</span><span class="op" id="4151165">(</span><span class="ident" id="4151166">data</span><span class="op" id="4151170">[</span><span class="num" id="4151171">2</span><span class="op" id="4151172">]</span><span class="op" id="4151173">)</span><span class="op" id="4151174">&lt;&lt;</span><span class="num" id="4151176">8</span>&nbsp;<span class="op" id="4151178">|</span>&nbsp;<span class="builtintype" id="4151180">int</span><span class="op" id="4151183">(</span><span class="ident" id="4151184">data</span><span class="op" id="4151188">[</span><span class="num" id="4151189">3</span><span class="op" id="4151190">]</span><span class="op" id="4151191">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151195">data</span>&nbsp;<span class="op" id="4151200">=</span>&nbsp;<span class="ident" id="4151202">data</span><span class="op" id="4151206">[</span><span class="num" id="4151207">4</span><span class="op" id="4151208">:</span><span class="op" id="4151209">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151213">if</span>&nbsp;<span class="builtinfunc" id="4151216">len</span><span class="op" id="4151219">(</span><span class="ident" id="4151220">data</span><span class="op" id="4151224">)</span>&nbsp;<span class="op" id="4151226">&lt;</span>&nbsp;<span class="ident" id="4151228">length</span>&nbsp;<span class="op" id="4151235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151240">return</span>&nbsp;<span class="builtintype" id="4151247">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151255">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151260">switch</span>&nbsp;<span class="ident" id="4151267">extension</span>&nbsp;<span class="op" id="4151277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151281">case</span>&nbsp;<span class="ident" id="4151286">extensionNextProtoNeg</span><span class="op" id="4151307">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151312">m</span><span class="op" id="4151313">.</span><span class="ident" id="4151314">nextProtoNeg</span>&nbsp;<span class="op" id="4151327">=</span>&nbsp;<span class="builtintype" id="4151329">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151337">d</span>&nbsp;<span class="op" id="4151339">:=</span>&nbsp;<span class="ident" id="4151342">data</span><span class="op" id="4151346">[</span><span class="op" id="4151347">:</span><span class="ident" id="4151348">length</span><span class="op" id="4151354">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151359">for</span>&nbsp;<span class="builtinfunc" id="4151363">len</span><span class="op" id="4151366">(</span><span class="ident" id="4151367">d</span><span class="op" id="4151368">)</span>&nbsp;<span class="op" id="4151370">&gt;</span>&nbsp;<span class="num" id="4151372">0</span>&nbsp;<span class="op" id="4151374">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151380">l</span>&nbsp;<span class="op" id="4151382">:=</span>&nbsp;<span class="builtintype" id="4151385">int</span><span class="op" id="4151388">(</span><span class="ident" id="4151389">d</span><span class="op" id="4151390">[</span><span class="num" id="4151391">0</span><span class="op" id="4151392">]</span><span class="op" id="4151393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151399">d</span>&nbsp;<span class="op" id="4151401">=</span>&nbsp;<span class="ident" id="4151403">d</span><span class="op" id="4151404">[</span><span class="num" id="4151405">1</span><span class="op" id="4151406">:</span><span class="op" id="4151407">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151413">if</span>&nbsp;<span class="ident" id="4151416">l</span>&nbsp;<span class="op" id="4151418">==</span>&nbsp;<span class="num" id="4151421">0</span>&nbsp;<span class="op" id="4151423">||</span>&nbsp;<span class="ident" id="4151426">l</span>&nbsp;<span class="op" id="4151428">&gt;</span>&nbsp;<span class="builtinfunc" id="4151430">len</span><span class="op" id="4151433">(</span><span class="ident" id="4151434">d</span><span class="op" id="4151435">)</span>&nbsp;<span class="op" id="4151437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151444">return</span>&nbsp;<span class="builtintype" id="4151451">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151461">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151467">m</span><span class="op" id="4151468">.</span><span class="ident" id="4151469">nextProtos</span>&nbsp;<span class="op" id="4151480">=</span>&nbsp;<span class="builtinfunc" id="4151482">append</span><span class="op" id="4151488">(</span><span class="ident" id="4151489">m</span><span class="op" id="4151490">.</span><span class="ident" id="4151491">nextProtos</span><span class="op" id="4151501">,</span>&nbsp;<span class="builtintype" id="4151503">string</span><span class="op" id="4151509">(</span><span class="ident" id="4151510">d</span><span class="op" id="4151511">[</span><span class="op" id="4151512">:</span><span class="ident" id="4151513">l</span><span class="op" id="4151514">]</span><span class="op" id="4151515">)</span><span class="op" id="4151516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151522">d</span>&nbsp;<span class="op" id="4151524">=</span>&nbsp;<span class="ident" id="4151526">d</span><span class="op" id="4151527">[</span><span class="ident" id="4151528">l</span><span class="op" id="4151529">:</span><span class="op" id="4151530">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151539">case</span>&nbsp;<span class="ident" id="4151544">extensionStatusRequest</span><span class="op" id="4151566">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151571">if</span>&nbsp;<span class="ident" id="4151574">length</span>&nbsp;<span class="op" id="4151581">&gt;</span>&nbsp;<span class="num" id="4151583">0</span>&nbsp;<span class="op" id="4151585">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151591">return</span>&nbsp;<span class="builtintype" id="4151598">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151612">m</span><span class="op" id="4151613">.</span><span class="ident" id="4151614">ocspStapling</span>&nbsp;<span class="op" id="4151627">=</span>&nbsp;<span class="builtintype" id="4151629">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151636">case</span>&nbsp;<span class="ident" id="4151641">extensionSessionTicket</span><span class="op" id="4151663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151668">if</span>&nbsp;<span class="ident" id="4151671">length</span>&nbsp;<span class="op" id="4151678">&gt;</span>&nbsp;<span class="num" id="4151680">0</span>&nbsp;<span class="op" id="4151682">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151688">return</span>&nbsp;<span class="builtintype" id="4151695">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151709">m</span><span class="op" id="4151710">.</span><span class="ident" id="4151711">ticketSupported</span>&nbsp;<span class="op" id="4151727">=</span>&nbsp;<span class="builtintype" id="4151729">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151736">case</span>&nbsp;<span class="ident" id="4151741">extensionRenegotiationInfo</span><span class="op" id="4151767">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151772">if</span>&nbsp;<span class="ident" id="4151775">length</span>&nbsp;<span class="op" id="4151782">!=</span>&nbsp;<span class="num" id="4151785">1</span>&nbsp;<span class="op" id="4151787">||</span>&nbsp;<span class="ident" id="4151790">data</span><span class="op" id="4151794">[</span><span class="num" id="4151795">0</span><span class="op" id="4151796">]</span>&nbsp;<span class="op" id="4151798">!=</span>&nbsp;<span class="num" id="4151801">0</span>&nbsp;<span class="op" id="4151803">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151809">return</span>&nbsp;<span class="builtintype" id="4151816">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151830">m</span><span class="op" id="4151831">.</span><span class="ident" id="4151832">secureRenegotiation</span>&nbsp;<span class="op" id="4151852">=</span>&nbsp;<span class="builtintype" id="4151854">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151861">case</span>&nbsp;<span class="ident" id="4151866">extensionALPN</span><span class="op" id="4151879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151884">d</span>&nbsp;<span class="op" id="4151886">:=</span>&nbsp;<span class="ident" id="4151889">data</span><span class="op" id="4151893">[</span><span class="op" id="4151894">:</span><span class="ident" id="4151895">length</span><span class="op" id="4151901">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151906">if</span>&nbsp;<span class="builtinfunc" id="4151909">len</span><span class="op" id="4151912">(</span><span class="ident" id="4151913">d</span><span class="op" id="4151914">)</span>&nbsp;<span class="op" id="4151916">&lt;</span>&nbsp;<span class="num" id="4151918">3</span>&nbsp;<span class="op" id="4151920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151926">return</span>&nbsp;<span class="builtintype" id="4151933">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4151942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4151947">l</span>&nbsp;<span class="op" id="4151949">:=</span>&nbsp;<span class="builtintype" id="4151952">int</span><span class="op" id="4151955">(</span><span class="ident" id="4151956">d</span><span class="op" id="4151957">[</span><span class="num" id="4151958">0</span><span class="op" id="4151959">]</span><span class="op" id="4151960">)</span><span class="op" id="4151961">&lt;&lt;</span><span class="num" id="4151963">8</span>&nbsp;<span class="op" id="4151965">|</span>&nbsp;<span class="builtintype" id="4151967">int</span><span class="op" id="4151970">(</span><span class="ident" id="4151971">d</span><span class="op" id="4151972">[</span><span class="num" id="4151973">1</span><span class="op" id="4151974">]</span><span class="op" id="4151975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4151980">if</span>&nbsp;<span class="ident" id="4151983">l</span>&nbsp;<span class="op" id="4151985">!=</span>&nbsp;<span class="builtinfunc" id="4151988">len</span><span class="op" id="4151991">(</span><span class="ident" id="4151992">d</span><span class="op" id="4151993">)</span><span class="op" id="4151994">-</span><span class="num" id="4151995">2</span>&nbsp;<span class="op" id="4151997">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152003">return</span>&nbsp;<span class="builtintype" id="4152010">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152024">d</span>&nbsp;<span class="op" id="4152026">=</span>&nbsp;<span class="ident" id="4152028">d</span><span class="op" id="4152029">[</span><span class="num" id="4152030">2</span><span class="op" id="4152031">:</span><span class="op" id="4152032">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152037">l</span>&nbsp;<span class="op" id="4152039">=</span>&nbsp;<span class="builtintype" id="4152041">int</span><span class="op" id="4152044">(</span><span class="ident" id="4152045">d</span><span class="op" id="4152046">[</span><span class="num" id="4152047">0</span><span class="op" id="4152048">]</span><span class="op" id="4152049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152054">if</span>&nbsp;<span class="ident" id="4152057">l</span>&nbsp;<span class="op" id="4152059">!=</span>&nbsp;<span class="builtinfunc" id="4152062">len</span><span class="op" id="4152065">(</span><span class="ident" id="4152066">d</span><span class="op" id="4152067">)</span><span class="op" id="4152068">-</span><span class="num" id="4152069">1</span>&nbsp;<span class="op" id="4152071">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152077">return</span>&nbsp;<span class="builtintype" id="4152084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152098">d</span>&nbsp;<span class="op" id="4152100">=</span>&nbsp;<span class="ident" id="4152102">d</span><span class="op" id="4152103">[</span><span class="num" id="4152104">1</span><span class="op" id="4152105">:</span><span class="op" id="4152106">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152111">m</span><span class="op" id="4152112">.</span><span class="ident" id="4152113">alpnProtocol</span>&nbsp;<span class="op" id="4152126">=</span>&nbsp;<span class="builtintype" id="4152128">string</span><span class="op" id="4152134">(</span><span class="ident" id="4152135">d</span><span class="op" id="4152136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152140">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152144">data</span>&nbsp;<span class="op" id="4152149">=</span>&nbsp;<span class="ident" id="4152151">data</span><span class="op" id="4152155">[</span><span class="ident" id="4152156">length</span><span class="op" id="4152162">:</span><span class="op" id="4152163">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152170">return</span>&nbsp;<span class="builtintype" id="4152177">true</span><br>
<span class="lineno"></span><span class="op" id="4152182">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="4152185">type</span>&nbsp;<span class="ident" id="4152190">certificateMsg</span>&nbsp;<span class="keyword" id="4152205">struct</span>&nbsp;<span class="op" id="4152212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152215">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4152228">[</span><span class="op" id="4152229">]</span><span class="builtintype" id="4152230">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152236">certificates</span>&nbsp;<span class="op" id="4152249">[</span><span class="op" id="4152250">]</span><span class="op" id="4152251">[</span><span class="op" id="4152252">]</span><span class="builtintype" id="4152253">byte</span><br>
<span class="lineno"></span><span class="op" id="4152258">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="4152261">func</span>&nbsp;<span class="op" id="4152266">(</span><span class="ident" id="4152267">m</span>&nbsp;<span class="op" id="4152269">*</span><span class="ident" id="4152270">certificateMsg</span><span class="op" id="4152284">)</span>&nbsp;<span class="ident" id="4152286">equal</span><span class="op" id="4152291">(</span><span class="ident" id="4152292">i</span>&nbsp;<span class="keyword" id="4152294">interface</span><span class="op" id="4152303">{</span><span class="op" id="4152304">}</span><span class="op" id="4152305">)</span>&nbsp;<span class="builtintype" id="4152307">bool</span>&nbsp;<span class="op" id="4152312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152315">m1</span><span class="op" id="4152317">,</span>&nbsp;<span class="ident" id="4152319">ok</span>&nbsp;<span class="op" id="4152322">:=</span>&nbsp;<span class="ident" id="4152325">i</span><span class="op" id="4152326">.</span><span class="op" id="4152327">(</span><span class="op" id="4152328">*</span><span class="ident" id="4152329">certificateMsg</span><span class="op" id="4152343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152346">if</span>&nbsp;<span class="op" id="4152349">!</span><span class="ident" id="4152350">ok</span>&nbsp;<span class="op" id="4152353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152357">return</span>&nbsp;<span class="builtintype" id="4152364">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152375">return</span>&nbsp;<span class="ident" id="4152382">bytes</span><span class="op" id="4152387">.</span><span class="ident" id="4152388">Equal</span><span class="op" id="4152393">(</span><span class="ident" id="4152394">m</span><span class="op" id="4152395">.</span><span class="ident" id="4152396">raw</span><span class="op" id="4152399">,</span>&nbsp;<span class="ident" id="4152401">m1</span><span class="op" id="4152403">.</span><span class="ident" id="4152404">raw</span><span class="op" id="4152407">)</span>&nbsp;<span class="op" id="4152409">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152414">eqByteSlices</span><span class="op" id="4152426">(</span><span class="ident" id="4152427">m</span><span class="op" id="4152428">.</span><span class="ident" id="4152429">certificates</span><span class="op" id="4152441">,</span>&nbsp;<span class="ident" id="4152443">m1</span><span class="op" id="4152445">.</span><span class="ident" id="4152446">certificates</span><span class="op" id="4152458">)</span><br>
<span class="lineno"></span><span class="op" id="4152460">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="4152463">func</span>&nbsp;<span class="op" id="4152468">(</span><span class="ident" id="4152469">m</span>&nbsp;<span class="op" id="4152471">*</span><span class="ident" id="4152472">certificateMsg</span><span class="op" id="4152486">)</span>&nbsp;<span class="ident" id="4152488">marshal</span><span class="op" id="4152495">(</span><span class="op" id="4152496">)</span>&nbsp;<span class="op" id="4152498">(</span><span class="ident" id="4152499">x</span>&nbsp;<span class="op" id="4152501">[</span><span class="op" id="4152502">]</span><span class="builtintype" id="4152503">byte</span><span class="op" id="4152507">)</span>&nbsp;<span class="op" id="4152509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152512">if</span>&nbsp;<span class="ident" id="4152515">m</span><span class="op" id="4152516">.</span><span class="ident" id="4152517">raw</span>&nbsp;<span class="op" id="4152521">!=</span>&nbsp;<span class="ident" id="4152524">nil</span>&nbsp;<span class="op" id="4152528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152532">return</span>&nbsp;<span class="ident" id="4152539">m</span><span class="op" id="4152540">.</span><span class="ident" id="4152541">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152546">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152550">var</span>&nbsp;<span class="ident" id="4152554">i</span>&nbsp;<span class="builtintype" id="4152556">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152561">for</span>&nbsp;<span class="ident" id="4152565">_</span><span class="op" id="4152566">,</span>&nbsp;<span class="ident" id="4152568">slice</span>&nbsp;<span class="op" id="4152574">:=</span>&nbsp;<span class="keyword" id="4152577">range</span>&nbsp;<span class="ident" id="4152583">m</span><span class="op" id="4152584">.</span><span class="ident" id="4152585">certificates</span>&nbsp;<span class="op" id="4152598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152602">i</span>&nbsp;<span class="op" id="4152604">+=</span>&nbsp;<span class="builtinfunc" id="4152607">len</span><span class="op" id="4152610">(</span><span class="ident" id="4152611">slice</span><span class="op" id="4152616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4152619">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152623">length</span>&nbsp;<span class="op" id="4152630">:=</span>&nbsp;<span class="num" id="4152633">3</span>&nbsp;<span class="op" id="4152635">+</span>&nbsp;<span class="num" id="4152637">3</span><span class="op" id="4152638">*</span><span class="builtinfunc" id="4152639">len</span><span class="op" id="4152642">(</span><span class="ident" id="4152643">m</span><span class="op" id="4152644">.</span><span class="ident" id="4152645">certificates</span><span class="op" id="4152657">)</span>&nbsp;<span class="op" id="4152659">+</span>&nbsp;<span class="ident" id="4152661">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152664">x</span>&nbsp;<span class="op" id="4152666">=</span>&nbsp;<span class="builtinfunc" id="4152668">make</span><span class="op" id="4152672">(</span><span class="op" id="4152673">[</span><span class="op" id="4152674">]</span><span class="builtintype" id="4152675">byte</span><span class="op" id="4152679">,</span>&nbsp;<span class="num" id="4152681">4</span><span class="op" id="4152682">+</span><span class="ident" id="4152683">length</span><span class="op" id="4152689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152692">x</span><span class="op" id="4152693">[</span><span class="num" id="4152694">0</span><span class="op" id="4152695">]</span>&nbsp;<span class="op" id="4152697">=</span>&nbsp;<span class="ident" id="4152699">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152716">x</span><span class="op" id="4152717">[</span><span class="num" id="4152718">1</span><span class="op" id="4152719">]</span>&nbsp;<span class="op" id="4152721">=</span>&nbsp;<span class="builtintype" id="4152723">uint8</span><span class="op" id="4152728">(</span><span class="ident" id="4152729">length</span>&nbsp;<span class="op" id="4152736">&gt;&gt;</span>&nbsp;<span class="num" id="4152739">16</span><span class="op" id="4152741">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152744">x</span><span class="op" id="4152745">[</span><span class="num" id="4152746">2</span><span class="op" id="4152747">]</span>&nbsp;<span class="op" id="4152749">=</span>&nbsp;<span class="builtintype" id="4152751">uint8</span><span class="op" id="4152756">(</span><span class="ident" id="4152757">length</span>&nbsp;<span class="op" id="4152764">&gt;&gt;</span>&nbsp;<span class="num" id="4152767">8</span><span class="op" id="4152768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152771">x</span><span class="op" id="4152772">[</span><span class="num" id="4152773">3</span><span class="op" id="4152774">]</span>&nbsp;<span class="op" id="4152776">=</span>&nbsp;<span class="builtintype" id="4152778">uint8</span><span class="op" id="4152783">(</span><span class="ident" id="4152784">length</span><span class="op" id="4152790">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152794">certificateOctets</span>&nbsp;<span class="op" id="4152812">:=</span>&nbsp;<span class="ident" id="4152815">length</span>&nbsp;<span class="op" id="4152822">-</span>&nbsp;<span class="num" id="4152824">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152827">x</span><span class="op" id="4152828">[</span><span class="num" id="4152829">4</span><span class="op" id="4152830">]</span>&nbsp;<span class="op" id="4152832">=</span>&nbsp;<span class="builtintype" id="4152834">uint8</span><span class="op" id="4152839">(</span><span class="ident" id="4152840">certificateOctets</span>&nbsp;<span class="op" id="4152858">&gt;&gt;</span>&nbsp;<span class="num" id="4152861">16</span><span class="op" id="4152863">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152866">x</span><span class="op" id="4152867">[</span><span class="num" id="4152868">5</span><span class="op" id="4152869">]</span>&nbsp;<span class="op" id="4152871">=</span>&nbsp;<span class="builtintype" id="4152873">uint8</span><span class="op" id="4152878">(</span><span class="ident" id="4152879">certificateOctets</span>&nbsp;<span class="op" id="4152897">&gt;&gt;</span>&nbsp;<span class="num" id="4152900">8</span><span class="op" id="4152901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152904">x</span><span class="op" id="4152905">[</span><span class="num" id="4152906">6</span><span class="op" id="4152907">]</span>&nbsp;<span class="op" id="4152909">=</span>&nbsp;<span class="builtintype" id="4152911">uint8</span><span class="op" id="4152916">(</span><span class="ident" id="4152917">certificateOctets</span><span class="op" id="4152934">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152938">y</span>&nbsp;<span class="op" id="4152940">:=</span>&nbsp;<span class="ident" id="4152943">x</span><span class="op" id="4152944">[</span><span class="num" id="4152945">7</span><span class="op" id="4152946">:</span><span class="op" id="4152947">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4152950">for</span>&nbsp;<span class="ident" id="4152954">_</span><span class="op" id="4152955">,</span>&nbsp;<span class="ident" id="4152957">slice</span>&nbsp;<span class="op" id="4152963">:=</span>&nbsp;<span class="keyword" id="4152966">range</span>&nbsp;<span class="ident" id="4152972">m</span><span class="op" id="4152973">.</span><span class="ident" id="4152974">certificates</span>&nbsp;<span class="op" id="4152987">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4152991">y</span><span class="op" id="4152992">[</span><span class="num" id="4152993">0</span><span class="op" id="4152994">]</span>&nbsp;<span class="op" id="4152996">=</span>&nbsp;<span class="builtintype" id="4152998">uint8</span><span class="op" id="4153003">(</span><span class="builtinfunc" id="4153004">len</span><span class="op" id="4153007">(</span><span class="ident" id="4153008">slice</span><span class="op" id="4153013">)</span>&nbsp;<span class="op" id="4153015">&gt;&gt;</span>&nbsp;<span class="num" id="4153018">16</span><span class="op" id="4153020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153024">y</span><span class="op" id="4153025">[</span><span class="num" id="4153026">1</span><span class="op" id="4153027">]</span>&nbsp;<span class="op" id="4153029">=</span>&nbsp;<span class="builtintype" id="4153031">uint8</span><span class="op" id="4153036">(</span><span class="builtinfunc" id="4153037">len</span><span class="op" id="4153040">(</span><span class="ident" id="4153041">slice</span><span class="op" id="4153046">)</span>&nbsp;<span class="op" id="4153048">&gt;&gt;</span>&nbsp;<span class="num" id="4153051">8</span><span class="op" id="4153052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153056">y</span><span class="op" id="4153057">[</span><span class="num" id="4153058">2</span><span class="op" id="4153059">]</span>&nbsp;<span class="op" id="4153061">=</span>&nbsp;<span class="builtintype" id="4153063">uint8</span><span class="op" id="4153068">(</span><span class="builtinfunc" id="4153069">len</span><span class="op" id="4153072">(</span><span class="ident" id="4153073">slice</span><span class="op" id="4153078">)</span><span class="op" id="4153079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4153083">copy</span><span class="op" id="4153087">(</span><span class="ident" id="4153088">y</span><span class="op" id="4153089">[</span><span class="num" id="4153090">3</span><span class="op" id="4153091">:</span><span class="op" id="4153092">]</span><span class="op" id="4153093">,</span>&nbsp;<span class="ident" id="4153095">slice</span><span class="op" id="4153100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153104">y</span>&nbsp;<span class="op" id="4153106">=</span>&nbsp;<span class="ident" id="4153108">y</span><span class="op" id="4153109">[</span><span class="num" id="4153110">3</span><span class="op" id="4153111">+</span><span class="builtinfunc" id="4153112">len</span><span class="op" id="4153115">(</span><span class="ident" id="4153116">slice</span><span class="op" id="4153121">)</span><span class="op" id="4153122">:</span><span class="op" id="4153123">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153130">m</span><span class="op" id="4153131">.</span><span class="ident" id="4153132">raw</span>&nbsp;<span class="op" id="4153136">=</span>&nbsp;<span class="ident" id="4153138">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153141">return</span><br>
<span class="lineno"></span><span class="op" id="4153148">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="4153151">func</span>&nbsp;<span class="op" id="4153156">(</span><span class="ident" id="4153157">m</span>&nbsp;<span class="op" id="4153159">*</span><span class="ident" id="4153160">certificateMsg</span><span class="op" id="4153174">)</span>&nbsp;<span class="ident" id="4153176">unmarshal</span><span class="op" id="4153185">(</span><span class="ident" id="4153186">data</span>&nbsp;<span class="op" id="4153191">[</span><span class="op" id="4153192">]</span><span class="builtintype" id="4153193">byte</span><span class="op" id="4153197">)</span>&nbsp;<span class="builtintype" id="4153199">bool</span>&nbsp;<span class="op" id="4153204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153207">if</span>&nbsp;<span class="builtinfunc" id="4153210">len</span><span class="op" id="4153213">(</span><span class="ident" id="4153214">data</span><span class="op" id="4153218">)</span>&nbsp;<span class="op" id="4153220">&lt;</span>&nbsp;<span class="num" id="4153222">7</span>&nbsp;<span class="op" id="4153224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153228">return</span>&nbsp;<span class="builtintype" id="4153235">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153242">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153246">m</span><span class="op" id="4153247">.</span><span class="ident" id="4153248">raw</span>&nbsp;<span class="op" id="4153252">=</span>&nbsp;<span class="ident" id="4153254">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153260">certsLen</span>&nbsp;<span class="op" id="4153269">:=</span>&nbsp;<span class="builtintype" id="4153272">uint32</span><span class="op" id="4153278">(</span><span class="ident" id="4153279">data</span><span class="op" id="4153283">[</span><span class="num" id="4153284">4</span><span class="op" id="4153285">]</span><span class="op" id="4153286">)</span><span class="op" id="4153287">&lt;&lt;</span><span class="num" id="4153289">16</span>&nbsp;<span class="op" id="4153292">|</span>&nbsp;<span class="builtintype" id="4153294">uint32</span><span class="op" id="4153300">(</span><span class="ident" id="4153301">data</span><span class="op" id="4153305">[</span><span class="num" id="4153306">5</span><span class="op" id="4153307">]</span><span class="op" id="4153308">)</span><span class="op" id="4153309">&lt;&lt;</span><span class="num" id="4153311">8</span>&nbsp;<span class="op" id="4153313">|</span>&nbsp;<span class="builtintype" id="4153315">uint32</span><span class="op" id="4153321">(</span><span class="ident" id="4153322">data</span><span class="op" id="4153326">[</span><span class="num" id="4153327">6</span><span class="op" id="4153328">]</span><span class="op" id="4153329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153332">if</span>&nbsp;<span class="builtintype" id="4153335">uint32</span><span class="op" id="4153341">(</span><span class="builtinfunc" id="4153342">len</span><span class="op" id="4153345">(</span><span class="ident" id="4153346">data</span><span class="op" id="4153350">)</span><span class="op" id="4153351">)</span>&nbsp;<span class="op" id="4153353">!=</span>&nbsp;<span class="ident" id="4153356">certsLen</span><span class="op" id="4153364">+</span><span class="num" id="4153365">7</span>&nbsp;<span class="op" id="4153367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153371">return</span>&nbsp;<span class="builtintype" id="4153378">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153389">numCerts</span>&nbsp;<span class="op" id="4153398">:=</span>&nbsp;<span class="num" id="4153401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153404">d</span>&nbsp;<span class="op" id="4153406">:=</span>&nbsp;<span class="ident" id="4153409">data</span><span class="op" id="4153413">[</span><span class="num" id="4153414">7</span><span class="op" id="4153415">:</span><span class="op" id="4153416">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153419">for</span>&nbsp;<span class="ident" id="4153423">certsLen</span>&nbsp;<span class="op" id="4153432">&gt;</span>&nbsp;<span class="num" id="4153434">0</span>&nbsp;<span class="op" id="4153436">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153440">if</span>&nbsp;<span class="builtinfunc" id="4153443">len</span><span class="op" id="4153446">(</span><span class="ident" id="4153447">d</span><span class="op" id="4153448">)</span>&nbsp;<span class="op" id="4153450">&lt;</span>&nbsp;<span class="num" id="4153452">4</span>&nbsp;<span class="op" id="4153454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153459">return</span>&nbsp;<span class="builtintype" id="4153466">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153478">certLen</span>&nbsp;<span class="op" id="4153486">:=</span>&nbsp;<span class="builtintype" id="4153489">uint32</span><span class="op" id="4153495">(</span><span class="ident" id="4153496">d</span><span class="op" id="4153497">[</span><span class="num" id="4153498">0</span><span class="op" id="4153499">]</span><span class="op" id="4153500">)</span><span class="op" id="4153501">&lt;&lt;</span><span class="num" id="4153503">16</span>&nbsp;<span class="op" id="4153506">|</span>&nbsp;<span class="builtintype" id="4153508">uint32</span><span class="op" id="4153514">(</span><span class="ident" id="4153515">d</span><span class="op" id="4153516">[</span><span class="num" id="4153517">1</span><span class="op" id="4153518">]</span><span class="op" id="4153519">)</span><span class="op" id="4153520">&lt;&lt;</span><span class="num" id="4153522">8</span>&nbsp;<span class="op" id="4153524">|</span>&nbsp;<span class="builtintype" id="4153526">uint32</span><span class="op" id="4153532">(</span><span class="ident" id="4153533">d</span><span class="op" id="4153534">[</span><span class="num" id="4153535">2</span><span class="op" id="4153536">]</span><span class="op" id="4153537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153541">if</span>&nbsp;<span class="builtintype" id="4153544">uint32</span><span class="op" id="4153550">(</span><span class="builtinfunc" id="4153551">len</span><span class="op" id="4153554">(</span><span class="ident" id="4153555">d</span><span class="op" id="4153556">)</span><span class="op" id="4153557">)</span>&nbsp;<span class="op" id="4153559">&lt;</span>&nbsp;<span class="num" id="4153561">3</span><span class="op" id="4153562">+</span><span class="ident" id="4153563">certLen</span>&nbsp;<span class="op" id="4153571">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153576">return</span>&nbsp;<span class="builtintype" id="4153583">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153595">d</span>&nbsp;<span class="op" id="4153597">=</span>&nbsp;<span class="ident" id="4153599">d</span><span class="op" id="4153600">[</span><span class="num" id="4153601">3</span><span class="op" id="4153602">+</span><span class="ident" id="4153603">certLen</span><span class="op" id="4153610">:</span><span class="op" id="4153611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153615">certsLen</span>&nbsp;<span class="op" id="4153624">-=</span>&nbsp;<span class="num" id="4153627">3</span>&nbsp;<span class="op" id="4153629">+</span>&nbsp;<span class="ident" id="4153631">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153641">numCerts</span><span class="op" id="4153649">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153657">m</span><span class="op" id="4153658">.</span><span class="ident" id="4153659">certificates</span>&nbsp;<span class="op" id="4153672">=</span>&nbsp;<span class="builtinfunc" id="4153674">make</span><span class="op" id="4153678">(</span><span class="op" id="4153679">[</span><span class="op" id="4153680">]</span><span class="op" id="4153681">[</span><span class="op" id="4153682">]</span><span class="builtintype" id="4153683">byte</span><span class="op" id="4153687">,</span>&nbsp;<span class="ident" id="4153689">numCerts</span><span class="op" id="4153697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153700">d</span>&nbsp;<span class="op" id="4153702">=</span>&nbsp;<span class="ident" id="4153704">data</span><span class="op" id="4153708">[</span><span class="num" id="4153709">7</span><span class="op" id="4153710">:</span><span class="op" id="4153711">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153714">for</span>&nbsp;<span class="ident" id="4153718">i</span>&nbsp;<span class="op" id="4153720">:=</span>&nbsp;<span class="num" id="4153723">0</span><span class="op" id="4153724">;</span>&nbsp;<span class="ident" id="4153726">i</span>&nbsp;<span class="op" id="4153728">&lt;</span>&nbsp;<span class="ident" id="4153730">numCerts</span><span class="op" id="4153738">;</span>&nbsp;<span class="ident" id="4153740">i</span><span class="op" id="4153741">++</span>&nbsp;<span class="op" id="4153744">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153748">certLen</span>&nbsp;<span class="op" id="4153756">:=</span>&nbsp;<span class="builtintype" id="4153759">uint32</span><span class="op" id="4153765">(</span><span class="ident" id="4153766">d</span><span class="op" id="4153767">[</span><span class="num" id="4153768">0</span><span class="op" id="4153769">]</span><span class="op" id="4153770">)</span><span class="op" id="4153771">&lt;&lt;</span><span class="num" id="4153773">16</span>&nbsp;<span class="op" id="4153776">|</span>&nbsp;<span class="builtintype" id="4153778">uint32</span><span class="op" id="4153784">(</span><span class="ident" id="4153785">d</span><span class="op" id="4153786">[</span><span class="num" id="4153787">1</span><span class="op" id="4153788">]</span><span class="op" id="4153789">)</span><span class="op" id="4153790">&lt;&lt;</span><span class="num" id="4153792">8</span>&nbsp;<span class="op" id="4153794">|</span>&nbsp;<span class="builtintype" id="4153796">uint32</span><span class="op" id="4153802">(</span><span class="ident" id="4153803">d</span><span class="op" id="4153804">[</span><span class="num" id="4153805">2</span><span class="op" id="4153806">]</span><span class="op" id="4153807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153811">m</span><span class="op" id="4153812">.</span><span class="ident" id="4153813">certificates</span><span class="op" id="4153825">[</span><span class="ident" id="4153826">i</span><span class="op" id="4153827">]</span>&nbsp;<span class="op" id="4153829">=</span>&nbsp;<span class="ident" id="4153831">d</span><span class="op" id="4153832">[</span><span class="num" id="4153833">3</span>&nbsp;<span class="op" id="4153835">:</span>&nbsp;<span class="num" id="4153837">3</span><span class="op" id="4153838">+</span><span class="ident" id="4153839">certLen</span><span class="op" id="4153846">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153850">d</span>&nbsp;<span class="op" id="4153852">=</span>&nbsp;<span class="ident" id="4153854">d</span><span class="op" id="4153855">[</span><span class="num" id="4153856">3</span><span class="op" id="4153857">+</span><span class="ident" id="4153858">certLen</span><span class="op" id="4153865">:</span><span class="op" id="4153866">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4153869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4153873">return</span>&nbsp;<span class="builtintype" id="4153880">true</span><br>
<span class="lineno"></span><span class="op" id="4153885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4153888">type</span>&nbsp;<span class="ident" id="4153893">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4153914">struct</span>&nbsp;<span class="op" id="4153921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153924">raw</span>&nbsp;<span class="op" id="4153928">[</span><span class="op" id="4153929">]</span><span class="builtintype" id="4153930">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4153936">key</span>&nbsp;<span class="op" id="4153940">[</span><span class="op" id="4153941">]</span><span class="builtintype" id="4153942">byte</span><br>
<span class="lineno"></span><span class="op" id="4153947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4153950">func</span>&nbsp;<span class="op" id="4153955">(</span><span class="ident" id="4153956">m</span>&nbsp;<span class="op" id="4153958">*</span><span class="ident" id="4153959">serverKeyExchangeMsg</span><span class="op" id="4153979">)</span>&nbsp;<span class="ident" id="4153981">equal</span><span class="op" id="4153986">(</span><span class="ident" id="4153987">i</span>&nbsp;<span class="keyword" id="4153989">interface</span><span class="op" id="4153998">{</span><span class="op" id="4153999">}</span><span class="op" id="4154000">)</span>&nbsp;<span class="builtintype" id="4154002">bool</span>&nbsp;<span class="op" id="4154007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154010">m1</span><span class="op" id="4154012">,</span>&nbsp;<span class="ident" id="4154014">ok</span>&nbsp;<span class="op" id="4154017">:=</span>&nbsp;<span class="ident" id="4154020">i</span><span class="op" id="4154021">.</span><span class="op" id="4154022">(</span><span class="op" id="4154023">*</span><span class="ident" id="4154024">serverKeyExchangeMsg</span><span class="op" id="4154044">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154047">if</span>&nbsp;<span class="op" id="4154050">!</span><span class="ident" id="4154051">ok</span>&nbsp;<span class="op" id="4154054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154058">return</span>&nbsp;<span class="builtintype" id="4154065">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154076">return</span>&nbsp;<span class="ident" id="4154083">bytes</span><span class="op" id="4154088">.</span><span class="ident" id="4154089">Equal</span><span class="op" id="4154094">(</span><span class="ident" id="4154095">m</span><span class="op" id="4154096">.</span><span class="ident" id="4154097">raw</span><span class="op" id="4154100">,</span>&nbsp;<span class="ident" id="4154102">m1</span><span class="op" id="4154104">.</span><span class="ident" id="4154105">raw</span><span class="op" id="4154108">)</span>&nbsp;<span class="op" id="4154110">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154115">bytes</span><span class="op" id="4154120">.</span><span class="ident" id="4154121">Equal</span><span class="op" id="4154126">(</span><span class="ident" id="4154127">m</span><span class="op" id="4154128">.</span><span class="ident" id="4154129">key</span><span class="op" id="4154132">,</span>&nbsp;<span class="ident" id="4154134">m1</span><span class="op" id="4154136">.</span><span class="ident" id="4154137">key</span><span class="op" id="4154140">)</span><br>
<span class="lineno"></span><span class="op" id="4154142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4154145">func</span>&nbsp;<span class="op" id="4154150">(</span><span class="ident" id="4154151">m</span>&nbsp;<span class="op" id="4154153">*</span><span class="ident" id="4154154">serverKeyExchangeMsg</span><span class="op" id="4154174">)</span>&nbsp;<span class="ident" id="4154176">marshal</span><span class="op" id="4154183">(</span><span class="op" id="4154184">)</span>&nbsp;<span class="op" id="4154186">[</span><span class="op" id="4154187">]</span><span class="builtintype" id="4154188">byte</span>&nbsp;<span class="op" id="4154193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154196">if</span>&nbsp;<span class="ident" id="4154199">m</span><span class="op" id="4154200">.</span><span class="ident" id="4154201">raw</span>&nbsp;<span class="op" id="4154205">!=</span>&nbsp;<span class="ident" id="4154208">nil</span>&nbsp;<span class="op" id="4154212">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154216">return</span>&nbsp;<span class="ident" id="4154223">m</span><span class="op" id="4154224">.</span><span class="ident" id="4154225">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154233">length</span>&nbsp;<span class="op" id="4154240">:=</span>&nbsp;<span class="builtinfunc" id="4154243">len</span><span class="op" id="4154246">(</span><span class="ident" id="4154247">m</span><span class="op" id="4154248">.</span><span class="ident" id="4154249">key</span><span class="op" id="4154252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154255">x</span>&nbsp;<span class="op" id="4154257">:=</span>&nbsp;<span class="builtinfunc" id="4154260">make</span><span class="op" id="4154264">(</span><span class="op" id="4154265">[</span><span class="op" id="4154266">]</span><span class="builtintype" id="4154267">byte</span><span class="op" id="4154271">,</span>&nbsp;<span class="ident" id="4154273">length</span><span class="op" id="4154279">+</span><span class="num" id="4154280">4</span><span class="op" id="4154281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154284">x</span><span class="op" id="4154285">[</span><span class="num" id="4154286">0</span><span class="op" id="4154287">]</span>&nbsp;<span class="op" id="4154289">=</span>&nbsp;<span class="ident" id="4154291">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154314">x</span><span class="op" id="4154315">[</span><span class="num" id="4154316">1</span><span class="op" id="4154317">]</span>&nbsp;<span class="op" id="4154319">=</span>&nbsp;<span class="builtintype" id="4154321">uint8</span><span class="op" id="4154326">(</span><span class="ident" id="4154327">length</span>&nbsp;<span class="op" id="4154334">&gt;&gt;</span>&nbsp;<span class="num" id="4154337">16</span><span class="op" id="4154339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154342">x</span><span class="op" id="4154343">[</span><span class="num" id="4154344">2</span><span class="op" id="4154345">]</span>&nbsp;<span class="op" id="4154347">=</span>&nbsp;<span class="builtintype" id="4154349">uint8</span><span class="op" id="4154354">(</span><span class="ident" id="4154355">length</span>&nbsp;<span class="op" id="4154362">&gt;&gt;</span>&nbsp;<span class="num" id="4154365">8</span><span class="op" id="4154366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154369">x</span><span class="op" id="4154370">[</span><span class="num" id="4154371">3</span><span class="op" id="4154372">]</span>&nbsp;<span class="op" id="4154374">=</span>&nbsp;<span class="builtintype" id="4154376">uint8</span><span class="op" id="4154381">(</span><span class="ident" id="4154382">length</span><span class="op" id="4154388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4154391">copy</span><span class="op" id="4154395">(</span><span class="ident" id="4154396">x</span><span class="op" id="4154397">[</span><span class="num" id="4154398">4</span><span class="op" id="4154399">:</span><span class="op" id="4154400">]</span><span class="op" id="4154401">,</span>&nbsp;<span class="ident" id="4154403">m</span><span class="op" id="4154404">.</span><span class="ident" id="4154405">key</span><span class="op" id="4154408">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154412">m</span><span class="op" id="4154413">.</span><span class="ident" id="4154414">raw</span>&nbsp;<span class="op" id="4154418">=</span>&nbsp;<span class="ident" id="4154420">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154423">return</span>&nbsp;<span class="ident" id="4154430">x</span><br>
<span class="lineno"></span><span class="op" id="4154432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4154435">func</span>&nbsp;<span class="op" id="4154440">(</span><span class="ident" id="4154441">m</span>&nbsp;<span class="op" id="4154443">*</span><span class="ident" id="4154444">serverKeyExchangeMsg</span><span class="op" id="4154464">)</span>&nbsp;<span class="ident" id="4154466">unmarshal</span><span class="op" id="4154475">(</span><span class="ident" id="4154476">data</span>&nbsp;<span class="op" id="4154481">[</span><span class="op" id="4154482">]</span><span class="builtintype" id="4154483">byte</span><span class="op" id="4154487">)</span>&nbsp;<span class="builtintype" id="4154489">bool</span>&nbsp;<span class="op" id="4154494">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154497">m</span><span class="op" id="4154498">.</span><span class="ident" id="4154499">raw</span>&nbsp;<span class="op" id="4154503">=</span>&nbsp;<span class="ident" id="4154505">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154511">if</span>&nbsp;<span class="builtinfunc" id="4154514">len</span><span class="op" id="4154517">(</span><span class="ident" id="4154518">data</span><span class="op" id="4154522">)</span>&nbsp;<span class="op" id="4154524">&lt;</span>&nbsp;<span class="num" id="4154526">4</span>&nbsp;<span class="op" id="4154528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154532">return</span>&nbsp;<span class="builtintype" id="4154539">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154549">m</span><span class="op" id="4154550">.</span><span class="ident" id="4154551">key</span>&nbsp;<span class="op" id="4154555">=</span>&nbsp;<span class="ident" id="4154557">data</span><span class="op" id="4154561">[</span><span class="num" id="4154562">4</span><span class="op" id="4154563">:</span><span class="op" id="4154564">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154567">return</span>&nbsp;<span class="builtintype" id="4154574">true</span><br>
<span class="lineno"></span><span class="op" id="4154579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4154582">type</span>&nbsp;<span class="ident" id="4154587">certificateStatusMsg</span>&nbsp;<span class="keyword" id="4154608">struct</span>&nbsp;<span class="op" id="4154615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154618">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4154629">[</span><span class="op" id="4154630">]</span><span class="builtintype" id="4154631">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154637">statusType</span>&nbsp;<span class="builtintype" id="4154648">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154655">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4154666">[</span><span class="op" id="4154667">]</span><span class="builtintype" id="4154668">byte</span><br>
<span class="lineno"></span><span class="op" id="4154673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4154676">func</span>&nbsp;<span class="op" id="4154681">(</span><span class="ident" id="4154682">m</span>&nbsp;<span class="op" id="4154684">*</span><span class="ident" id="4154685">certificateStatusMsg</span><span class="op" id="4154705">)</span>&nbsp;<span class="ident" id="4154707">equal</span><span class="op" id="4154712">(</span><span class="ident" id="4154713">i</span>&nbsp;<span class="keyword" id="4154715">interface</span><span class="op" id="4154724">{</span><span class="op" id="4154725">}</span><span class="op" id="4154726">)</span>&nbsp;<span class="builtintype" id="4154728">bool</span>&nbsp;<span class="op" id="4154733">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154736">m1</span><span class="op" id="4154738">,</span>&nbsp;<span class="ident" id="4154740">ok</span>&nbsp;<span class="op" id="4154743">:=</span>&nbsp;<span class="ident" id="4154746">i</span><span class="op" id="4154747">.</span><span class="op" id="4154748">(</span><span class="op" id="4154749">*</span><span class="ident" id="4154750">certificateStatusMsg</span><span class="op" id="4154770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154773">if</span>&nbsp;<span class="op" id="4154776">!</span><span class="ident" id="4154777">ok</span>&nbsp;<span class="op" id="4154780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154784">return</span>&nbsp;<span class="builtintype" id="4154791">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4154798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154802">return</span>&nbsp;<span class="ident" id="4154809">bytes</span><span class="op" id="4154814">.</span><span class="ident" id="4154815">Equal</span><span class="op" id="4154820">(</span><span class="ident" id="4154821">m</span><span class="op" id="4154822">.</span><span class="ident" id="4154823">raw</span><span class="op" id="4154826">,</span>&nbsp;<span class="ident" id="4154828">m1</span><span class="op" id="4154830">.</span><span class="ident" id="4154831">raw</span><span class="op" id="4154834">)</span>&nbsp;<span class="op" id="4154836">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154841">m</span><span class="op" id="4154842">.</span><span class="ident" id="4154843">statusType</span>&nbsp;<span class="op" id="4154854">==</span>&nbsp;<span class="ident" id="4154857">m1</span><span class="op" id="4154859">.</span><span class="ident" id="4154860">statusType</span>&nbsp;<span class="op" id="4154871">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4154876">bytes</span><span class="op" id="4154881">.</span><span class="ident" id="4154882">Equal</span><span class="op" id="4154887">(</span><span class="ident" id="4154888">m</span><span class="op" id="4154889">.</span><span class="ident" id="4154890">response</span><span class="op" id="4154898">,</span>&nbsp;<span class="ident" id="4154900">m1</span><span class="op" id="4154902">.</span><span class="ident" id="4154903">response</span><span class="op" id="4154911">)</span><br>
<span class="lineno"></span><span class="op" id="4154913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4154916">func</span>&nbsp;<span class="op" id="4154921">(</span><span class="ident" id="4154922">m</span>&nbsp;<span class="op" id="4154924">*</span><span class="ident" id="4154925">certificateStatusMsg</span><span class="op" id="4154945">)</span>&nbsp;<span class="ident" id="4154947">marshal</span><span class="op" id="4154954">(</span><span class="op" id="4154955">)</span>&nbsp;<span class="op" id="4154957">[</span><span class="op" id="4154958">]</span><span class="builtintype" id="4154959">byte</span>&nbsp;<span class="op" id="4154964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154967">if</span>&nbsp;<span class="ident" id="4154970">m</span><span class="op" id="4154971">.</span><span class="ident" id="4154972">raw</span>&nbsp;<span class="op" id="4154976">!=</span>&nbsp;<span class="ident" id="4154979">nil</span>&nbsp;<span class="op" id="4154983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4154987">return</span>&nbsp;<span class="ident" id="4154994">m</span><span class="op" id="4154995">.</span><span class="ident" id="4154996">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155005">var</span>&nbsp;<span class="ident" id="4155009">x</span>&nbsp;<span class="op" id="4155011">[</span><span class="op" id="4155012">]</span><span class="builtintype" id="4155013">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155019">if</span>&nbsp;<span class="ident" id="4155022">m</span><span class="op" id="4155023">.</span><span class="ident" id="4155024">statusType</span>&nbsp;<span class="op" id="4155035">==</span>&nbsp;<span class="ident" id="4155038">statusTypeOCSP</span>&nbsp;<span class="op" id="4155053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155057">x</span>&nbsp;<span class="op" id="4155059">=</span>&nbsp;<span class="builtinfunc" id="4155061">make</span><span class="op" id="4155065">(</span><span class="op" id="4155066">[</span><span class="op" id="4155067">]</span><span class="builtintype" id="4155068">byte</span><span class="op" id="4155072">,</span>&nbsp;<span class="num" id="4155074">4</span><span class="op" id="4155075">+</span><span class="num" id="4155076">4</span><span class="op" id="4155077">+</span><span class="builtinfunc" id="4155078">len</span><span class="op" id="4155081">(</span><span class="ident" id="4155082">m</span><span class="op" id="4155083">.</span><span class="ident" id="4155084">response</span><span class="op" id="4155092">)</span><span class="op" id="4155093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155097">x</span><span class="op" id="4155098">[</span><span class="num" id="4155099">0</span><span class="op" id="4155100">]</span>&nbsp;<span class="op" id="4155102">=</span>&nbsp;<span class="ident" id="4155104">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155128">l</span>&nbsp;<span class="op" id="4155130">:=</span>&nbsp;<span class="builtinfunc" id="4155133">len</span><span class="op" id="4155136">(</span><span class="ident" id="4155137">m</span><span class="op" id="4155138">.</span><span class="ident" id="4155139">response</span><span class="op" id="4155147">)</span>&nbsp;<span class="op" id="4155149">+</span>&nbsp;<span class="num" id="4155151">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155155">x</span><span class="op" id="4155156">[</span><span class="num" id="4155157">1</span><span class="op" id="4155158">]</span>&nbsp;<span class="op" id="4155160">=</span>&nbsp;<span class="builtintype" id="4155162">byte</span><span class="op" id="4155166">(</span><span class="ident" id="4155167">l</span>&nbsp;<span class="op" id="4155169">&gt;&gt;</span>&nbsp;<span class="num" id="4155172">16</span><span class="op" id="4155174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155178">x</span><span class="op" id="4155179">[</span><span class="num" id="4155180">2</span><span class="op" id="4155181">]</span>&nbsp;<span class="op" id="4155183">=</span>&nbsp;<span class="builtintype" id="4155185">byte</span><span class="op" id="4155189">(</span><span class="ident" id="4155190">l</span>&nbsp;<span class="op" id="4155192">&gt;&gt;</span>&nbsp;<span class="num" id="4155195">8</span><span class="op" id="4155196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155200">x</span><span class="op" id="4155201">[</span><span class="num" id="4155202">3</span><span class="op" id="4155203">]</span>&nbsp;<span class="op" id="4155205">=</span>&nbsp;<span class="builtintype" id="4155207">byte</span><span class="op" id="4155211">(</span><span class="ident" id="4155212">l</span><span class="op" id="4155213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155217">x</span><span class="op" id="4155218">[</span><span class="num" id="4155219">4</span><span class="op" id="4155220">]</span>&nbsp;<span class="op" id="4155222">=</span>&nbsp;<span class="ident" id="4155224">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155242">l</span>&nbsp;<span class="op" id="4155244">-=</span>&nbsp;<span class="num" id="4155247">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155251">x</span><span class="op" id="4155252">[</span><span class="num" id="4155253">5</span><span class="op" id="4155254">]</span>&nbsp;<span class="op" id="4155256">=</span>&nbsp;<span class="builtintype" id="4155258">byte</span><span class="op" id="4155262">(</span><span class="ident" id="4155263">l</span>&nbsp;<span class="op" id="4155265">&gt;&gt;</span>&nbsp;<span class="num" id="4155268">16</span><span class="op" id="4155270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155274">x</span><span class="op" id="4155275">[</span><span class="num" id="4155276">6</span><span class="op" id="4155277">]</span>&nbsp;<span class="op" id="4155279">=</span>&nbsp;<span class="builtintype" id="4155281">byte</span><span class="op" id="4155285">(</span><span class="ident" id="4155286">l</span>&nbsp;<span class="op" id="4155288">&gt;&gt;</span>&nbsp;<span class="num" id="4155291">8</span><span class="op" id="4155292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155296">x</span><span class="op" id="4155297">[</span><span class="num" id="4155298">7</span><span class="op" id="4155299">]</span>&nbsp;<span class="op" id="4155301">=</span>&nbsp;<span class="builtintype" id="4155303">byte</span><span class="op" id="4155307">(</span><span class="ident" id="4155308">l</span><span class="op" id="4155309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4155313">copy</span><span class="op" id="4155317">(</span><span class="ident" id="4155318">x</span><span class="op" id="4155319">[</span><span class="num" id="4155320">8</span><span class="op" id="4155321">:</span><span class="op" id="4155322">]</span><span class="op" id="4155323">,</span>&nbsp;<span class="ident" id="4155325">m</span><span class="op" id="4155326">.</span><span class="ident" id="4155327">response</span><span class="op" id="4155335">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155338">}</span>&nbsp;<span class="keyword" id="4155340">else</span>&nbsp;<span class="op" id="4155345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155349">x</span>&nbsp;<span class="op" id="4155351">=</span>&nbsp;<span class="op" id="4155353">[</span><span class="op" id="4155354">]</span><span class="builtintype" id="4155355">byte</span><span class="op" id="4155359">{</span><span class="ident" id="4155360">typeCertificateStatus</span><span class="op" id="4155381">,</span>&nbsp;<span class="num" id="4155383">0</span><span class="op" id="4155384">,</span>&nbsp;<span class="num" id="4155386">0</span><span class="op" id="4155387">,</span>&nbsp;<span class="num" id="4155389">1</span><span class="op" id="4155390">,</span>&nbsp;<span class="ident" id="4155392">m</span><span class="op" id="4155393">.</span><span class="ident" id="4155394">statusType</span><span class="op" id="4155404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155411">m</span><span class="op" id="4155412">.</span><span class="ident" id="4155413">raw</span>&nbsp;<span class="op" id="4155417">=</span>&nbsp;<span class="ident" id="4155419">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155422">return</span>&nbsp;<span class="ident" id="4155429">x</span><br>
<span class="lineno"></span><span class="op" id="4155431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4155434">func</span>&nbsp;<span class="op" id="4155439">(</span><span class="ident" id="4155440">m</span>&nbsp;<span class="op" id="4155442">*</span><span class="ident" id="4155443">certificateStatusMsg</span><span class="op" id="4155463">)</span>&nbsp;<span class="ident" id="4155465">unmarshal</span><span class="op" id="4155474">(</span><span class="ident" id="4155475">data</span>&nbsp;<span class="op" id="4155480">[</span><span class="op" id="4155481">]</span><span class="builtintype" id="4155482">byte</span><span class="op" id="4155486">)</span>&nbsp;<span class="builtintype" id="4155488">bool</span>&nbsp;<span class="op" id="4155493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155496">m</span><span class="op" id="4155497">.</span><span class="ident" id="4155498">raw</span>&nbsp;<span class="op" id="4155502">=</span>&nbsp;<span class="ident" id="4155504">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155510">if</span>&nbsp;<span class="builtinfunc" id="4155513">len</span><span class="op" id="4155516">(</span><span class="ident" id="4155517">data</span><span class="op" id="4155521">)</span>&nbsp;<span class="op" id="4155523">&lt;</span>&nbsp;<span class="num" id="4155525">5</span>&nbsp;<span class="op" id="4155527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155531">return</span>&nbsp;<span class="builtintype" id="4155538">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155548">m</span><span class="op" id="4155549">.</span><span class="ident" id="4155550">statusType</span>&nbsp;<span class="op" id="4155561">=</span>&nbsp;<span class="ident" id="4155563">data</span><span class="op" id="4155567">[</span><span class="num" id="4155568">4</span><span class="op" id="4155569">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155573">m</span><span class="op" id="4155574">.</span><span class="ident" id="4155575">response</span>&nbsp;<span class="op" id="4155584">=</span>&nbsp;<span class="ident" id="4155586">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155591">if</span>&nbsp;<span class="ident" id="4155594">m</span><span class="op" id="4155595">.</span><span class="ident" id="4155596">statusType</span>&nbsp;<span class="op" id="4155607">==</span>&nbsp;<span class="ident" id="4155610">statusTypeOCSP</span>&nbsp;<span class="op" id="4155625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155629">if</span>&nbsp;<span class="builtinfunc" id="4155632">len</span><span class="op" id="4155635">(</span><span class="ident" id="4155636">data</span><span class="op" id="4155640">)</span>&nbsp;<span class="op" id="4155642">&lt;</span>&nbsp;<span class="num" id="4155644">8</span>&nbsp;<span class="op" id="4155646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155651">return</span>&nbsp;<span class="builtintype" id="4155658">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155666">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155670">respLen</span>&nbsp;<span class="op" id="4155678">:=</span>&nbsp;<span class="builtintype" id="4155681">uint32</span><span class="op" id="4155687">(</span><span class="ident" id="4155688">data</span><span class="op" id="4155692">[</span><span class="num" id="4155693">5</span><span class="op" id="4155694">]</span><span class="op" id="4155695">)</span><span class="op" id="4155696">&lt;&lt;</span><span class="num" id="4155698">16</span>&nbsp;<span class="op" id="4155701">|</span>&nbsp;<span class="builtintype" id="4155703">uint32</span><span class="op" id="4155709">(</span><span class="ident" id="4155710">data</span><span class="op" id="4155714">[</span><span class="num" id="4155715">6</span><span class="op" id="4155716">]</span><span class="op" id="4155717">)</span><span class="op" id="4155718">&lt;&lt;</span><span class="num" id="4155720">8</span>&nbsp;<span class="op" id="4155722">|</span>&nbsp;<span class="builtintype" id="4155724">uint32</span><span class="op" id="4155730">(</span><span class="ident" id="4155731">data</span><span class="op" id="4155735">[</span><span class="num" id="4155736">7</span><span class="op" id="4155737">]</span><span class="op" id="4155738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155742">if</span>&nbsp;<span class="builtintype" id="4155745">uint32</span><span class="op" id="4155751">(</span><span class="builtinfunc" id="4155752">len</span><span class="op" id="4155755">(</span><span class="ident" id="4155756">data</span><span class="op" id="4155760">)</span><span class="op" id="4155761">)</span>&nbsp;<span class="op" id="4155763">!=</span>&nbsp;<span class="num" id="4155766">4</span><span class="op" id="4155767">+</span><span class="num" id="4155768">4</span><span class="op" id="4155769">+</span><span class="ident" id="4155770">respLen</span>&nbsp;<span class="op" id="4155778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155783">return</span>&nbsp;<span class="builtintype" id="4155790">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155802">m</span><span class="op" id="4155803">.</span><span class="ident" id="4155804">response</span>&nbsp;<span class="op" id="4155813">=</span>&nbsp;<span class="ident" id="4155815">data</span><span class="op" id="4155819">[</span><span class="num" id="4155820">8</span><span class="op" id="4155821">:</span><span class="op" id="4155822">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4155825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155828">return</span>&nbsp;<span class="builtintype" id="4155835">true</span><br>
<span class="lineno"></span><span class="op" id="4155840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4155843">type</span>&nbsp;<span class="ident" id="4155848">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="4155867">struct</span><span class="op" id="4155873">{</span><span class="op" id="4155874">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="4155877">func</span>&nbsp;<span class="op" id="4155882">(</span><span class="ident" id="4155883">m</span>&nbsp;<span class="op" id="4155885">*</span><span class="ident" id="4155886">serverHelloDoneMsg</span><span class="op" id="4155904">)</span>&nbsp;<span class="ident" id="4155906">equal</span><span class="op" id="4155911">(</span><span class="ident" id="4155912">i</span>&nbsp;<span class="keyword" id="4155914">interface</span><span class="op" id="4155923">{</span><span class="op" id="4155924">}</span><span class="op" id="4155925">)</span>&nbsp;<span class="builtintype" id="4155927">bool</span>&nbsp;<span class="op" id="4155932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4155935">_</span><span class="op" id="4155936">,</span>&nbsp;<span class="ident" id="4155938">ok</span>&nbsp;<span class="op" id="4155941">:=</span>&nbsp;<span class="ident" id="4155944">i</span><span class="op" id="4155945">.</span><span class="op" id="4155946">(</span><span class="op" id="4155947">*</span><span class="ident" id="4155948">serverHelloDoneMsg</span><span class="op" id="4155966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4155969">return</span>&nbsp;<span class="ident" id="4155976">ok</span><br>
<span class="lineno"></span><span class="op" id="4155979">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="4155982">func</span>&nbsp;<span class="op" id="4155987">(</span><span class="ident" id="4155988">m</span>&nbsp;<span class="op" id="4155990">*</span><span class="ident" id="4155991">serverHelloDoneMsg</span><span class="op" id="4156009">)</span>&nbsp;<span class="ident" id="4156011">marshal</span><span class="op" id="4156018">(</span><span class="op" id="4156019">)</span>&nbsp;<span class="op" id="4156021">[</span><span class="op" id="4156022">]</span><span class="builtintype" id="4156023">byte</span>&nbsp;<span class="op" id="4156028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156031">x</span>&nbsp;<span class="op" id="4156033">:=</span>&nbsp;<span class="builtinfunc" id="4156036">make</span><span class="op" id="4156040">(</span><span class="op" id="4156041">[</span><span class="op" id="4156042">]</span><span class="builtintype" id="4156043">byte</span><span class="op" id="4156047">,</span>&nbsp;<span class="num" id="4156049">4</span><span class="op" id="4156050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156053">x</span><span class="op" id="4156054">[</span><span class="num" id="4156055">0</span><span class="op" id="4156056">]</span>&nbsp;<span class="op" id="4156058">=</span>&nbsp;<span class="ident" id="4156060">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156081">return</span>&nbsp;<span class="ident" id="4156088">x</span><br>
<span class="lineno">920</span><span class="op" id="4156090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4156093">func</span>&nbsp;<span class="op" id="4156098">(</span><span class="ident" id="4156099">m</span>&nbsp;<span class="op" id="4156101">*</span><span class="ident" id="4156102">serverHelloDoneMsg</span><span class="op" id="4156120">)</span>&nbsp;<span class="ident" id="4156122">unmarshal</span><span class="op" id="4156131">(</span><span class="ident" id="4156132">data</span>&nbsp;<span class="op" id="4156137">[</span><span class="op" id="4156138">]</span><span class="builtintype" id="4156139">byte</span><span class="op" id="4156143">)</span>&nbsp;<span class="builtintype" id="4156145">bool</span>&nbsp;<span class="op" id="4156150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156153">return</span>&nbsp;<span class="builtinfunc" id="4156160">len</span><span class="op" id="4156163">(</span><span class="ident" id="4156164">data</span><span class="op" id="4156168">)</span>&nbsp;<span class="op" id="4156170">==</span>&nbsp;<span class="num" id="4156173">4</span><br>
<span class="lineno"></span><span class="op" id="4156175">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="4156178">type</span>&nbsp;<span class="ident" id="4156183">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="4156204">struct</span>&nbsp;<span class="op" id="4156211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156214">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4156225">[</span><span class="op" id="4156226">]</span><span class="builtintype" id="4156227">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156233">ciphertext</span>&nbsp;<span class="op" id="4156244">[</span><span class="op" id="4156245">]</span><span class="builtintype" id="4156246">byte</span><br>
<span class="lineno"></span><span class="op" id="4156251">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="4156254">func</span>&nbsp;<span class="op" id="4156259">(</span><span class="ident" id="4156260">m</span>&nbsp;<span class="op" id="4156262">*</span><span class="ident" id="4156263">clientKeyExchangeMsg</span><span class="op" id="4156283">)</span>&nbsp;<span class="ident" id="4156285">equal</span><span class="op" id="4156290">(</span><span class="ident" id="4156291">i</span>&nbsp;<span class="keyword" id="4156293">interface</span><span class="op" id="4156302">{</span><span class="op" id="4156303">}</span><span class="op" id="4156304">)</span>&nbsp;<span class="builtintype" id="4156306">bool</span>&nbsp;<span class="op" id="4156311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156314">m1</span><span class="op" id="4156316">,</span>&nbsp;<span class="ident" id="4156318">ok</span>&nbsp;<span class="op" id="4156321">:=</span>&nbsp;<span class="ident" id="4156324">i</span><span class="op" id="4156325">.</span><span class="op" id="4156326">(</span><span class="op" id="4156327">*</span><span class="ident" id="4156328">clientKeyExchangeMsg</span><span class="op" id="4156348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156351">if</span>&nbsp;<span class="op" id="4156354">!</span><span class="ident" id="4156355">ok</span>&nbsp;<span class="op" id="4156358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156362">return</span>&nbsp;<span class="builtintype" id="4156369">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156380">return</span>&nbsp;<span class="ident" id="4156387">bytes</span><span class="op" id="4156392">.</span><span class="ident" id="4156393">Equal</span><span class="op" id="4156398">(</span><span class="ident" id="4156399">m</span><span class="op" id="4156400">.</span><span class="ident" id="4156401">raw</span><span class="op" id="4156404">,</span>&nbsp;<span class="ident" id="4156406">m1</span><span class="op" id="4156408">.</span><span class="ident" id="4156409">raw</span><span class="op" id="4156412">)</span>&nbsp;<span class="op" id="4156414">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156419">bytes</span><span class="op" id="4156424">.</span><span class="ident" id="4156425">Equal</span><span class="op" id="4156430">(</span><span class="ident" id="4156431">m</span><span class="op" id="4156432">.</span><span class="ident" id="4156433">ciphertext</span><span class="op" id="4156443">,</span>&nbsp;<span class="ident" id="4156445">m1</span><span class="op" id="4156447">.</span><span class="ident" id="4156448">ciphertext</span><span class="op" id="4156458">)</span><br>
<span class="lineno"></span><span class="op" id="4156460">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="4156463">func</span>&nbsp;<span class="op" id="4156468">(</span><span class="ident" id="4156469">m</span>&nbsp;<span class="op" id="4156471">*</span><span class="ident" id="4156472">clientKeyExchangeMsg</span><span class="op" id="4156492">)</span>&nbsp;<span class="ident" id="4156494">marshal</span><span class="op" id="4156501">(</span><span class="op" id="4156502">)</span>&nbsp;<span class="op" id="4156504">[</span><span class="op" id="4156505">]</span><span class="builtintype" id="4156506">byte</span>&nbsp;<span class="op" id="4156511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156514">if</span>&nbsp;<span class="ident" id="4156517">m</span><span class="op" id="4156518">.</span><span class="ident" id="4156519">raw</span>&nbsp;<span class="op" id="4156523">!=</span>&nbsp;<span class="ident" id="4156526">nil</span>&nbsp;<span class="op" id="4156530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156534">return</span>&nbsp;<span class="ident" id="4156541">m</span><span class="op" id="4156542">.</span><span class="ident" id="4156543">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156548">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156551">length</span>&nbsp;<span class="op" id="4156558">:=</span>&nbsp;<span class="builtinfunc" id="4156561">len</span><span class="op" id="4156564">(</span><span class="ident" id="4156565">m</span><span class="op" id="4156566">.</span><span class="ident" id="4156567">ciphertext</span><span class="op" id="4156577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156580">x</span>&nbsp;<span class="op" id="4156582">:=</span>&nbsp;<span class="builtinfunc" id="4156585">make</span><span class="op" id="4156589">(</span><span class="op" id="4156590">[</span><span class="op" id="4156591">]</span><span class="builtintype" id="4156592">byte</span><span class="op" id="4156596">,</span>&nbsp;<span class="ident" id="4156598">length</span><span class="op" id="4156604">+</span><span class="num" id="4156605">4</span><span class="op" id="4156606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156609">x</span><span class="op" id="4156610">[</span><span class="num" id="4156611">0</span><span class="op" id="4156612">]</span>&nbsp;<span class="op" id="4156614">=</span>&nbsp;<span class="ident" id="4156616">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156639">x</span><span class="op" id="4156640">[</span><span class="num" id="4156641">1</span><span class="op" id="4156642">]</span>&nbsp;<span class="op" id="4156644">=</span>&nbsp;<span class="builtintype" id="4156646">uint8</span><span class="op" id="4156651">(</span><span class="ident" id="4156652">length</span>&nbsp;<span class="op" id="4156659">&gt;&gt;</span>&nbsp;<span class="num" id="4156662">16</span><span class="op" id="4156664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156667">x</span><span class="op" id="4156668">[</span><span class="num" id="4156669">2</span><span class="op" id="4156670">]</span>&nbsp;<span class="op" id="4156672">=</span>&nbsp;<span class="builtintype" id="4156674">uint8</span><span class="op" id="4156679">(</span><span class="ident" id="4156680">length</span>&nbsp;<span class="op" id="4156687">&gt;&gt;</span>&nbsp;<span class="num" id="4156690">8</span><span class="op" id="4156691">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156694">x</span><span class="op" id="4156695">[</span><span class="num" id="4156696">3</span><span class="op" id="4156697">]</span>&nbsp;<span class="op" id="4156699">=</span>&nbsp;<span class="builtintype" id="4156701">uint8</span><span class="op" id="4156706">(</span><span class="ident" id="4156707">length</span><span class="op" id="4156713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4156716">copy</span><span class="op" id="4156720">(</span><span class="ident" id="4156721">x</span><span class="op" id="4156722">[</span><span class="num" id="4156723">4</span><span class="op" id="4156724">:</span><span class="op" id="4156725">]</span><span class="op" id="4156726">,</span>&nbsp;<span class="ident" id="4156728">m</span><span class="op" id="4156729">.</span><span class="ident" id="4156730">ciphertext</span><span class="op" id="4156740">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156744">m</span><span class="op" id="4156745">.</span><span class="ident" id="4156746">raw</span>&nbsp;<span class="op" id="4156750">=</span>&nbsp;<span class="ident" id="4156752">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156755">return</span>&nbsp;<span class="ident" id="4156762">x</span><br>
<span class="lineno">955</span><span class="op" id="4156764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4156767">func</span>&nbsp;<span class="op" id="4156772">(</span><span class="ident" id="4156773">m</span>&nbsp;<span class="op" id="4156775">*</span><span class="ident" id="4156776">clientKeyExchangeMsg</span><span class="op" id="4156796">)</span>&nbsp;<span class="ident" id="4156798">unmarshal</span><span class="op" id="4156807">(</span><span class="ident" id="4156808">data</span>&nbsp;<span class="op" id="4156813">[</span><span class="op" id="4156814">]</span><span class="builtintype" id="4156815">byte</span><span class="op" id="4156819">)</span>&nbsp;<span class="builtintype" id="4156821">bool</span>&nbsp;<span class="op" id="4156826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156829">m</span><span class="op" id="4156830">.</span><span class="ident" id="4156831">raw</span>&nbsp;<span class="op" id="4156835">=</span>&nbsp;<span class="ident" id="4156837">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156843">if</span>&nbsp;<span class="builtinfunc" id="4156846">len</span><span class="op" id="4156849">(</span><span class="ident" id="4156850">data</span><span class="op" id="4156854">)</span>&nbsp;<span class="op" id="4156856">&lt;</span>&nbsp;<span class="num" id="4156858">4</span>&nbsp;<span class="op" id="4156860">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156864">return</span>&nbsp;<span class="builtintype" id="4156871">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156881">l</span>&nbsp;<span class="op" id="4156883">:=</span>&nbsp;<span class="builtintype" id="4156886">int</span><span class="op" id="4156889">(</span><span class="ident" id="4156890">data</span><span class="op" id="4156894">[</span><span class="num" id="4156895">1</span><span class="op" id="4156896">]</span><span class="op" id="4156897">)</span><span class="op" id="4156898">&lt;&lt;</span><span class="num" id="4156900">16</span>&nbsp;<span class="op" id="4156903">|</span>&nbsp;<span class="builtintype" id="4156905">int</span><span class="op" id="4156908">(</span><span class="ident" id="4156909">data</span><span class="op" id="4156913">[</span><span class="num" id="4156914">2</span><span class="op" id="4156915">]</span><span class="op" id="4156916">)</span><span class="op" id="4156917">&lt;&lt;</span><span class="num" id="4156919">8</span>&nbsp;<span class="op" id="4156921">|</span>&nbsp;<span class="builtintype" id="4156923">int</span><span class="op" id="4156926">(</span><span class="ident" id="4156927">data</span><span class="op" id="4156931">[</span><span class="num" id="4156932">3</span><span class="op" id="4156933">]</span><span class="op" id="4156934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156937">if</span>&nbsp;<span class="ident" id="4156940">l</span>&nbsp;<span class="op" id="4156942">!=</span>&nbsp;<span class="builtinfunc" id="4156945">len</span><span class="op" id="4156948">(</span><span class="ident" id="4156949">data</span><span class="op" id="4156953">)</span><span class="op" id="4156954">-</span><span class="num" id="4156955">4</span>&nbsp;<span class="op" id="4156957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4156961">return</span>&nbsp;<span class="builtintype" id="4156968">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4156975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4156978">m</span><span class="op" id="4156979">.</span><span class="ident" id="4156980">ciphertext</span>&nbsp;<span class="op" id="4156991">=</span>&nbsp;<span class="ident" id="4156993">data</span><span class="op" id="4156997">[</span><span class="num" id="4156998">4</span><span class="op" id="4156999">:</span><span class="op" id="4157000">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157003">return</span>&nbsp;<span class="builtintype" id="4157010">true</span><br>
<span class="lineno"></span><span class="op" id="4157015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="4157018">type</span>&nbsp;<span class="ident" id="4157023">finishedMsg</span>&nbsp;<span class="keyword" id="4157035">struct</span>&nbsp;<span class="op" id="4157042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157045">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4157056">[</span><span class="op" id="4157057">]</span><span class="builtintype" id="4157058">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157064">verifyData</span>&nbsp;<span class="op" id="4157075">[</span><span class="op" id="4157076">]</span><span class="builtintype" id="4157077">byte</span><br>
<span class="lineno"></span><span class="op" id="4157082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="4157085">func</span>&nbsp;<span class="op" id="4157090">(</span><span class="ident" id="4157091">m</span>&nbsp;<span class="op" id="4157093">*</span><span class="ident" id="4157094">finishedMsg</span><span class="op" id="4157105">)</span>&nbsp;<span class="ident" id="4157107">equal</span><span class="op" id="4157112">(</span><span class="ident" id="4157113">i</span>&nbsp;<span class="keyword" id="4157115">interface</span><span class="op" id="4157124">{</span><span class="op" id="4157125">}</span><span class="op" id="4157126">)</span>&nbsp;<span class="builtintype" id="4157128">bool</span>&nbsp;<span class="op" id="4157133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157136">m1</span><span class="op" id="4157138">,</span>&nbsp;<span class="ident" id="4157140">ok</span>&nbsp;<span class="op" id="4157143">:=</span>&nbsp;<span class="ident" id="4157146">i</span><span class="op" id="4157147">.</span><span class="op" id="4157148">(</span><span class="op" id="4157149">*</span><span class="ident" id="4157150">finishedMsg</span><span class="op" id="4157161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157164">if</span>&nbsp;<span class="op" id="4157167">!</span><span class="ident" id="4157168">ok</span>&nbsp;<span class="op" id="4157171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157175">return</span>&nbsp;<span class="builtintype" id="4157182">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157189">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157193">return</span>&nbsp;<span class="ident" id="4157200">bytes</span><span class="op" id="4157205">.</span><span class="ident" id="4157206">Equal</span><span class="op" id="4157211">(</span><span class="ident" id="4157212">m</span><span class="op" id="4157213">.</span><span class="ident" id="4157214">raw</span><span class="op" id="4157217">,</span>&nbsp;<span class="ident" id="4157219">m1</span><span class="op" id="4157221">.</span><span class="ident" id="4157222">raw</span><span class="op" id="4157225">)</span>&nbsp;<span class="op" id="4157227">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157232">bytes</span><span class="op" id="4157237">.</span><span class="ident" id="4157238">Equal</span><span class="op" id="4157243">(</span><span class="ident" id="4157244">m</span><span class="op" id="4157245">.</span><span class="ident" id="4157246">verifyData</span><span class="op" id="4157256">,</span>&nbsp;<span class="ident" id="4157258">m1</span><span class="op" id="4157260">.</span><span class="ident" id="4157261">verifyData</span><span class="op" id="4157271">)</span><br>
<span class="lineno"></span><span class="op" id="4157273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="4157276">func</span>&nbsp;<span class="op" id="4157281">(</span><span class="ident" id="4157282">m</span>&nbsp;<span class="op" id="4157284">*</span><span class="ident" id="4157285">finishedMsg</span><span class="op" id="4157296">)</span>&nbsp;<span class="ident" id="4157298">marshal</span><span class="op" id="4157305">(</span><span class="op" id="4157306">)</span>&nbsp;<span class="op" id="4157308">(</span><span class="ident" id="4157309">x</span>&nbsp;<span class="op" id="4157311">[</span><span class="op" id="4157312">]</span><span class="builtintype" id="4157313">byte</span><span class="op" id="4157317">)</span>&nbsp;<span class="op" id="4157319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157322">if</span>&nbsp;<span class="ident" id="4157325">m</span><span class="op" id="4157326">.</span><span class="ident" id="4157327">raw</span>&nbsp;<span class="op" id="4157331">!=</span>&nbsp;<span class="ident" id="4157334">nil</span>&nbsp;<span class="op" id="4157338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157342">return</span>&nbsp;<span class="ident" id="4157349">m</span><span class="op" id="4157350">.</span><span class="ident" id="4157351">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157360">x</span>&nbsp;<span class="op" id="4157362">=</span>&nbsp;<span class="builtinfunc" id="4157364">make</span><span class="op" id="4157368">(</span><span class="op" id="4157369">[</span><span class="op" id="4157370">]</span><span class="builtintype" id="4157371">byte</span><span class="op" id="4157375">,</span>&nbsp;<span class="num" id="4157377">4</span><span class="op" id="4157378">+</span><span class="builtinfunc" id="4157379">len</span><span class="op" id="4157382">(</span><span class="ident" id="4157383">m</span><span class="op" id="4157384">.</span><span class="ident" id="4157385">verifyData</span><span class="op" id="4157395">)</span><span class="op" id="4157396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157399">x</span><span class="op" id="4157400">[</span><span class="num" id="4157401">0</span><span class="op" id="4157402">]</span>&nbsp;<span class="op" id="4157404">=</span>&nbsp;<span class="ident" id="4157406">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157420">x</span><span class="op" id="4157421">[</span><span class="num" id="4157422">3</span><span class="op" id="4157423">]</span>&nbsp;<span class="op" id="4157425">=</span>&nbsp;<span class="builtintype" id="4157427">byte</span><span class="op" id="4157431">(</span><span class="builtinfunc" id="4157432">len</span><span class="op" id="4157435">(</span><span class="ident" id="4157436">m</span><span class="op" id="4157437">.</span><span class="ident" id="4157438">verifyData</span><span class="op" id="4157448">)</span><span class="op" id="4157449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4157452">copy</span><span class="op" id="4157456">(</span><span class="ident" id="4157457">x</span><span class="op" id="4157458">[</span><span class="num" id="4157459">4</span><span class="op" id="4157460">:</span><span class="op" id="4157461">]</span><span class="op" id="4157462">,</span>&nbsp;<span class="ident" id="4157464">m</span><span class="op" id="4157465">.</span><span class="ident" id="4157466">verifyData</span><span class="op" id="4157476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157479">m</span><span class="op" id="4157480">.</span><span class="ident" id="4157481">raw</span>&nbsp;<span class="op" id="4157485">=</span>&nbsp;<span class="ident" id="4157487">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157490">return</span><br>
<span class="lineno"></span><span class="op" id="4157497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4157500">func</span>&nbsp;<span class="op" id="4157505">(</span><span class="ident" id="4157506">m</span>&nbsp;<span class="op" id="4157508">*</span><span class="ident" id="4157509">finishedMsg</span><span class="op" id="4157520">)</span>&nbsp;<span class="ident" id="4157522">unmarshal</span><span class="op" id="4157531">(</span><span class="ident" id="4157532">data</span>&nbsp;<span class="op" id="4157537">[</span><span class="op" id="4157538">]</span><span class="builtintype" id="4157539">byte</span><span class="op" id="4157543">)</span>&nbsp;<span class="builtintype" id="4157545">bool</span>&nbsp;<span class="op" id="4157550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157553">m</span><span class="op" id="4157554">.</span><span class="ident" id="4157555">raw</span>&nbsp;<span class="op" id="4157559">=</span>&nbsp;<span class="ident" id="4157561">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157567">if</span>&nbsp;<span class="builtinfunc" id="4157570">len</span><span class="op" id="4157573">(</span><span class="ident" id="4157574">data</span><span class="op" id="4157578">)</span>&nbsp;<span class="op" id="4157580">&lt;</span>&nbsp;<span class="num" id="4157582">4</span>&nbsp;<span class="op" id="4157584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157588">return</span>&nbsp;<span class="builtintype" id="4157595">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157605">m</span><span class="op" id="4157606">.</span><span class="ident" id="4157607">verifyData</span>&nbsp;<span class="op" id="4157618">=</span>&nbsp;<span class="ident" id="4157620">data</span><span class="op" id="4157624">[</span><span class="num" id="4157625">4</span><span class="op" id="4157626">:</span><span class="op" id="4157627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157630">return</span>&nbsp;<span class="builtintype" id="4157637">true</span><br>
<span class="lineno">1005</span><span class="op" id="4157642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4157645">type</span>&nbsp;<span class="ident" id="4157650">nextProtoMsg</span>&nbsp;<span class="keyword" id="4157663">struct</span>&nbsp;<span class="op" id="4157670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157673">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4157679">[</span><span class="op" id="4157680">]</span><span class="builtintype" id="4157681">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157687">proto</span>&nbsp;<span class="builtintype" id="4157693">string</span><br>
<span class="lineno">1010</span><span class="op" id="4157700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4157703">func</span>&nbsp;<span class="op" id="4157708">(</span><span class="ident" id="4157709">m</span>&nbsp;<span class="op" id="4157711">*</span><span class="ident" id="4157712">nextProtoMsg</span><span class="op" id="4157724">)</span>&nbsp;<span class="ident" id="4157726">equal</span><span class="op" id="4157731">(</span><span class="ident" id="4157732">i</span>&nbsp;<span class="keyword" id="4157734">interface</span><span class="op" id="4157743">{</span><span class="op" id="4157744">}</span><span class="op" id="4157745">)</span>&nbsp;<span class="builtintype" id="4157747">bool</span>&nbsp;<span class="op" id="4157752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157755">m1</span><span class="op" id="4157757">,</span>&nbsp;<span class="ident" id="4157759">ok</span>&nbsp;<span class="op" id="4157762">:=</span>&nbsp;<span class="ident" id="4157765">i</span><span class="op" id="4157766">.</span><span class="op" id="4157767">(</span><span class="op" id="4157768">*</span><span class="ident" id="4157769">nextProtoMsg</span><span class="op" id="4157781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157784">if</span>&nbsp;<span class="op" id="4157787">!</span><span class="ident" id="4157788">ok</span>&nbsp;<span class="op" id="4157791">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157795">return</span>&nbsp;<span class="builtintype" id="4157802">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157813">return</span>&nbsp;<span class="ident" id="4157820">bytes</span><span class="op" id="4157825">.</span><span class="ident" id="4157826">Equal</span><span class="op" id="4157831">(</span><span class="ident" id="4157832">m</span><span class="op" id="4157833">.</span><span class="ident" id="4157834">raw</span><span class="op" id="4157837">,</span>&nbsp;<span class="ident" id="4157839">m1</span><span class="op" id="4157841">.</span><span class="ident" id="4157842">raw</span><span class="op" id="4157845">)</span>&nbsp;<span class="op" id="4157847">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157852">m</span><span class="op" id="4157853">.</span><span class="ident" id="4157854">proto</span>&nbsp;<span class="op" id="4157860">==</span>&nbsp;<span class="ident" id="4157863">m1</span><span class="op" id="4157865">.</span><span class="ident" id="4157866">proto</span><br>
<span class="lineno">1020</span><span class="op" id="4157872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4157875">func</span>&nbsp;<span class="op" id="4157880">(</span><span class="ident" id="4157881">m</span>&nbsp;<span class="op" id="4157883">*</span><span class="ident" id="4157884">nextProtoMsg</span><span class="op" id="4157896">)</span>&nbsp;<span class="ident" id="4157898">marshal</span><span class="op" id="4157905">(</span><span class="op" id="4157906">)</span>&nbsp;<span class="op" id="4157908">[</span><span class="op" id="4157909">]</span><span class="builtintype" id="4157910">byte</span>&nbsp;<span class="op" id="4157915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157918">if</span>&nbsp;<span class="ident" id="4157921">m</span><span class="op" id="4157922">.</span><span class="ident" id="4157923">raw</span>&nbsp;<span class="op" id="4157927">!=</span>&nbsp;<span class="ident" id="4157930">nil</span>&nbsp;<span class="op" id="4157934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157938">return</span>&nbsp;<span class="ident" id="4157945">m</span><span class="op" id="4157946">.</span><span class="ident" id="4157947">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157955">l</span>&nbsp;<span class="op" id="4157957">:=</span>&nbsp;<span class="builtinfunc" id="4157960">len</span><span class="op" id="4157963">(</span><span class="ident" id="4157964">m</span><span class="op" id="4157965">.</span><span class="ident" id="4157966">proto</span><span class="op" id="4157971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4157974">if</span>&nbsp;<span class="ident" id="4157977">l</span>&nbsp;<span class="op" id="4157979">&gt;</span>&nbsp;<span class="num" id="4157981">255</span>&nbsp;<span class="op" id="4157985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4157989">l</span>&nbsp;<span class="op" id="4157991">=</span>&nbsp;<span class="num" id="4157993">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4157998">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158002">padding</span>&nbsp;<span class="op" id="4158010">:=</span>&nbsp;<span class="num" id="4158013">32</span>&nbsp;<span class="op" id="4158016">-</span>&nbsp;<span class="op" id="4158018">(</span><span class="ident" id="4158019">l</span><span class="op" id="4158020">+</span><span class="num" id="4158021">2</span><span class="op" id="4158022">)</span><span class="op" id="4158023">%</span><span class="num" id="4158024">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158028">length</span>&nbsp;<span class="op" id="4158035">:=</span>&nbsp;<span class="ident" id="4158038">l</span>&nbsp;<span class="op" id="4158040">+</span>&nbsp;<span class="ident" id="4158042">padding</span>&nbsp;<span class="op" id="4158050">+</span>&nbsp;<span class="num" id="4158052">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158055">x</span>&nbsp;<span class="op" id="4158057">:=</span>&nbsp;<span class="builtinfunc" id="4158060">make</span><span class="op" id="4158064">(</span><span class="op" id="4158065">[</span><span class="op" id="4158066">]</span><span class="builtintype" id="4158067">byte</span><span class="op" id="4158071">,</span>&nbsp;<span class="ident" id="4158073">length</span><span class="op" id="4158079">+</span><span class="num" id="4158080">4</span><span class="op" id="4158081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158084">x</span><span class="op" id="4158085">[</span><span class="num" id="4158086">0</span><span class="op" id="4158087">]</span>&nbsp;<span class="op" id="4158089">=</span>&nbsp;<span class="ident" id="4158091">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158109">x</span><span class="op" id="4158110">[</span><span class="num" id="4158111">1</span><span class="op" id="4158112">]</span>&nbsp;<span class="op" id="4158114">=</span>&nbsp;<span class="builtintype" id="4158116">uint8</span><span class="op" id="4158121">(</span><span class="ident" id="4158122">length</span>&nbsp;<span class="op" id="4158129">&gt;&gt;</span>&nbsp;<span class="num" id="4158132">16</span><span class="op" id="4158134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158137">x</span><span class="op" id="4158138">[</span><span class="num" id="4158139">2</span><span class="op" id="4158140">]</span>&nbsp;<span class="op" id="4158142">=</span>&nbsp;<span class="builtintype" id="4158144">uint8</span><span class="op" id="4158149">(</span><span class="ident" id="4158150">length</span>&nbsp;<span class="op" id="4158157">&gt;&gt;</span>&nbsp;<span class="num" id="4158160">8</span><span class="op" id="4158161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158164">x</span><span class="op" id="4158165">[</span><span class="num" id="4158166">3</span><span class="op" id="4158167">]</span>&nbsp;<span class="op" id="4158169">=</span>&nbsp;<span class="builtintype" id="4158171">uint8</span><span class="op" id="4158176">(</span><span class="ident" id="4158177">length</span><span class="op" id="4158183">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158187">y</span>&nbsp;<span class="op" id="4158189">:=</span>&nbsp;<span class="ident" id="4158192">x</span><span class="op" id="4158193">[</span><span class="num" id="4158194">4</span><span class="op" id="4158195">:</span><span class="op" id="4158196">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158199">y</span><span class="op" id="4158200">[</span><span class="num" id="4158201">0</span><span class="op" id="4158202">]</span>&nbsp;<span class="op" id="4158204">=</span>&nbsp;<span class="builtintype" id="4158206">byte</span><span class="op" id="4158210">(</span><span class="ident" id="4158211">l</span><span class="op" id="4158212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4158215">copy</span><span class="op" id="4158219">(</span><span class="ident" id="4158220">y</span><span class="op" id="4158221">[</span><span class="num" id="4158222">1</span><span class="op" id="4158223">:</span><span class="op" id="4158224">]</span><span class="op" id="4158225">,</span>&nbsp;<span class="op" id="4158227">[</span><span class="op" id="4158228">]</span><span class="builtintype" id="4158229">byte</span><span class="op" id="4158233">(</span><span class="ident" id="4158234">m</span><span class="op" id="4158235">.</span><span class="ident" id="4158236">proto</span><span class="op" id="4158241">[</span><span class="num" id="4158242">0</span><span class="op" id="4158243">:</span><span class="ident" id="4158244">l</span><span class="op" id="4158245">]</span><span class="op" id="4158246">)</span><span class="op" id="4158247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158250">y</span>&nbsp;<span class="op" id="4158252">=</span>&nbsp;<span class="ident" id="4158254">y</span><span class="op" id="4158255">[</span><span class="num" id="4158256">1</span><span class="op" id="4158257">+</span><span class="ident" id="4158258">l</span><span class="op" id="4158259">:</span><span class="op" id="4158260">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158263">y</span><span class="op" id="4158264">[</span><span class="num" id="4158265">0</span><span class="op" id="4158266">]</span>&nbsp;<span class="op" id="4158268">=</span>&nbsp;<span class="builtintype" id="4158270">byte</span><span class="op" id="4158274">(</span><span class="ident" id="4158275">padding</span><span class="op" id="4158282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158286">m</span><span class="op" id="4158287">.</span><span class="ident" id="4158288">raw</span>&nbsp;<span class="op" id="4158292">=</span>&nbsp;<span class="ident" id="4158294">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158298">return</span>&nbsp;<span class="ident" id="4158305">x</span><br>
<span class="lineno"></span><span class="op" id="4158307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="4158310">func</span>&nbsp;<span class="op" id="4158315">(</span><span class="ident" id="4158316">m</span>&nbsp;<span class="op" id="4158318">*</span><span class="ident" id="4158319">nextProtoMsg</span><span class="op" id="4158331">)</span>&nbsp;<span class="ident" id="4158333">unmarshal</span><span class="op" id="4158342">(</span><span class="ident" id="4158343">data</span>&nbsp;<span class="op" id="4158348">[</span><span class="op" id="4158349">]</span><span class="builtintype" id="4158350">byte</span><span class="op" id="4158354">)</span>&nbsp;<span class="builtintype" id="4158356">bool</span>&nbsp;<span class="op" id="4158361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158364">m</span><span class="op" id="4158365">.</span><span class="ident" id="4158366">raw</span>&nbsp;<span class="op" id="4158370">=</span>&nbsp;<span class="ident" id="4158372">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158379">if</span>&nbsp;<span class="builtinfunc" id="4158382">len</span><span class="op" id="4158385">(</span><span class="ident" id="4158386">data</span><span class="op" id="4158390">)</span>&nbsp;<span class="op" id="4158392">&lt;</span>&nbsp;<span class="num" id="4158394">5</span>&nbsp;<span class="op" id="4158396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158400">return</span>&nbsp;<span class="builtintype" id="4158407">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158417">data</span>&nbsp;<span class="op" id="4158422">=</span>&nbsp;<span class="ident" id="4158424">data</span><span class="op" id="4158428">[</span><span class="num" id="4158429">4</span><span class="op" id="4158430">:</span><span class="op" id="4158431">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158434">protoLen</span>&nbsp;<span class="op" id="4158443">:=</span>&nbsp;<span class="builtintype" id="4158446">int</span><span class="op" id="4158449">(</span><span class="ident" id="4158450">data</span><span class="op" id="4158454">[</span><span class="num" id="4158455">0</span><span class="op" id="4158456">]</span><span class="op" id="4158457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158460">data</span>&nbsp;<span class="op" id="4158465">=</span>&nbsp;<span class="ident" id="4158467">data</span><span class="op" id="4158471">[</span><span class="num" id="4158472">1</span><span class="op" id="4158473">:</span><span class="op" id="4158474">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158477">if</span>&nbsp;<span class="builtinfunc" id="4158480">len</span><span class="op" id="4158483">(</span><span class="ident" id="4158484">data</span><span class="op" id="4158488">)</span>&nbsp;<span class="op" id="4158490">&lt;</span>&nbsp;<span class="ident" id="4158492">protoLen</span>&nbsp;<span class="op" id="4158501">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158505">return</span>&nbsp;<span class="builtintype" id="4158512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158522">m</span><span class="op" id="4158523">.</span><span class="ident" id="4158524">proto</span>&nbsp;<span class="op" id="4158530">=</span>&nbsp;<span class="builtintype" id="4158532">string</span><span class="op" id="4158538">(</span><span class="ident" id="4158539">data</span><span class="op" id="4158543">[</span><span class="num" id="4158544">0</span><span class="op" id="4158545">:</span><span class="ident" id="4158546">protoLen</span><span class="op" id="4158554">]</span><span class="op" id="4158555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158558">data</span>&nbsp;<span class="op" id="4158563">=</span>&nbsp;<span class="ident" id="4158565">data</span><span class="op" id="4158569">[</span><span class="ident" id="4158570">protoLen</span><span class="op" id="4158578">:</span><span class="op" id="4158579">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158583">if</span>&nbsp;<span class="builtinfunc" id="4158586">len</span><span class="op" id="4158589">(</span><span class="ident" id="4158590">data</span><span class="op" id="4158594">)</span>&nbsp;<span class="op" id="4158596">&lt;</span>&nbsp;<span class="num" id="4158598">1</span>&nbsp;<span class="op" id="4158600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158604">return</span>&nbsp;<span class="builtintype" id="4158611">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158621">paddingLen</span>&nbsp;<span class="op" id="4158632">:=</span>&nbsp;<span class="builtintype" id="4158635">int</span><span class="op" id="4158638">(</span><span class="ident" id="4158639">data</span><span class="op" id="4158643">[</span><span class="num" id="4158644">0</span><span class="op" id="4158645">]</span><span class="op" id="4158646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158649">data</span>&nbsp;<span class="op" id="4158654">=</span>&nbsp;<span class="ident" id="4158656">data</span><span class="op" id="4158660">[</span><span class="num" id="4158661">1</span><span class="op" id="4158662">:</span><span class="op" id="4158663">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158666">if</span>&nbsp;<span class="builtinfunc" id="4158669">len</span><span class="op" id="4158672">(</span><span class="ident" id="4158673">data</span><span class="op" id="4158677">)</span>&nbsp;<span class="op" id="4158679">!=</span>&nbsp;<span class="ident" id="4158682">paddingLen</span>&nbsp;<span class="op" id="4158693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158697">return</span>&nbsp;<span class="builtintype" id="4158704">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4158711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4158715">return</span>&nbsp;<span class="builtintype" id="4158722">true</span><br>
<span class="lineno">1075</span><span class="op" id="4158727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4158730">type</span>&nbsp;<span class="ident" id="4158735">certificateRequestMsg</span>&nbsp;<span class="keyword" id="4158757">struct</span>&nbsp;<span class="op" id="4158764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158767">raw</span>&nbsp;<span class="op" id="4158771">[</span><span class="op" id="4158772">]</span><span class="builtintype" id="4158773">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158779">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158850">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4158923">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158932">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4158952">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158959">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4158982">[</span><span class="op" id="4158983">]</span><span class="builtintype" id="4158984">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4158990">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4159013">[</span><span class="op" id="4159014">]</span><span class="ident" id="4159015">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159033">certificateAuthorities</span>&nbsp;<span class="op" id="4159056">[</span><span class="op" id="4159057">]</span><span class="op" id="4159058">[</span><span class="op" id="4159059">]</span><span class="builtintype" id="4159060">byte</span><br>
<span class="lineno"></span><span class="op" id="4159065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4159068">func</span>&nbsp;<span class="op" id="4159073">(</span><span class="ident" id="4159074">m</span>&nbsp;<span class="op" id="4159076">*</span><span class="ident" id="4159077">certificateRequestMsg</span><span class="op" id="4159098">)</span>&nbsp;<span class="ident" id="4159100">equal</span><span class="op" id="4159105">(</span><span class="ident" id="4159106">i</span>&nbsp;<span class="keyword" id="4159108">interface</span><span class="op" id="4159117">{</span><span class="op" id="4159118">}</span><span class="op" id="4159119">)</span>&nbsp;<span class="builtintype" id="4159121">bool</span>&nbsp;<span class="op" id="4159126">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159129">m1</span><span class="op" id="4159131">,</span>&nbsp;<span class="ident" id="4159133">ok</span>&nbsp;<span class="op" id="4159136">:=</span>&nbsp;<span class="ident" id="4159139">i</span><span class="op" id="4159140">.</span><span class="op" id="4159141">(</span><span class="op" id="4159142">*</span><span class="ident" id="4159143">certificateRequestMsg</span><span class="op" id="4159164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159167">if</span>&nbsp;<span class="op" id="4159170">!</span><span class="ident" id="4159171">ok</span>&nbsp;<span class="op" id="4159174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159178">return</span>&nbsp;<span class="builtintype" id="4159185">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159196">return</span>&nbsp;<span class="ident" id="4159203">bytes</span><span class="op" id="4159208">.</span><span class="ident" id="4159209">Equal</span><span class="op" id="4159214">(</span><span class="ident" id="4159215">m</span><span class="op" id="4159216">.</span><span class="ident" id="4159217">raw</span><span class="op" id="4159220">,</span>&nbsp;<span class="ident" id="4159222">m1</span><span class="op" id="4159224">.</span><span class="ident" id="4159225">raw</span><span class="op" id="4159228">)</span>&nbsp;<span class="op" id="4159230">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159235">bytes</span><span class="op" id="4159240">.</span><span class="ident" id="4159241">Equal</span><span class="op" id="4159246">(</span><span class="ident" id="4159247">m</span><span class="op" id="4159248">.</span><span class="ident" id="4159249">certificateTypes</span><span class="op" id="4159265">,</span>&nbsp;<span class="ident" id="4159267">m1</span><span class="op" id="4159269">.</span><span class="ident" id="4159270">certificateTypes</span><span class="op" id="4159286">)</span>&nbsp;<span class="op" id="4159288">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159293">eqByteSlices</span><span class="op" id="4159305">(</span><span class="ident" id="4159306">m</span><span class="op" id="4159307">.</span><span class="ident" id="4159308">certificateAuthorities</span><span class="op" id="4159330">,</span>&nbsp;<span class="ident" id="4159332">m1</span><span class="op" id="4159334">.</span><span class="ident" id="4159335">certificateAuthorities</span><span class="op" id="4159357">)</span>&nbsp;<span class="op" id="4159359">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159364">eqSignatureAndHashes</span><span class="op" id="4159384">(</span><span class="ident" id="4159385">m</span><span class="op" id="4159386">.</span><span class="ident" id="4159387">signatureAndHashes</span><span class="op" id="4159405">,</span>&nbsp;<span class="ident" id="4159407">m1</span><span class="op" id="4159409">.</span><span class="ident" id="4159410">signatureAndHashes</span><span class="op" id="4159428">)</span><br>
<span class="lineno"></span><span class="op" id="4159430">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="4159433">func</span>&nbsp;<span class="op" id="4159438">(</span><span class="ident" id="4159439">m</span>&nbsp;<span class="op" id="4159441">*</span><span class="ident" id="4159442">certificateRequestMsg</span><span class="op" id="4159463">)</span>&nbsp;<span class="ident" id="4159465">marshal</span><span class="op" id="4159472">(</span><span class="op" id="4159473">)</span>&nbsp;<span class="op" id="4159475">(</span><span class="ident" id="4159476">x</span>&nbsp;<span class="op" id="4159478">[</span><span class="op" id="4159479">]</span><span class="builtintype" id="4159480">byte</span><span class="op" id="4159484">)</span>&nbsp;<span class="op" id="4159486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159489">if</span>&nbsp;<span class="ident" id="4159492">m</span><span class="op" id="4159493">.</span><span class="ident" id="4159494">raw</span>&nbsp;<span class="op" id="4159498">!=</span>&nbsp;<span class="ident" id="4159501">nil</span>&nbsp;<span class="op" id="4159505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159509">return</span>&nbsp;<span class="ident" id="4159516">m</span><span class="op" id="4159517">.</span><span class="ident" id="4159518">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159523">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4159527">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159584">length</span>&nbsp;<span class="op" id="4159591">:=</span>&nbsp;<span class="num" id="4159594">1</span>&nbsp;<span class="op" id="4159596">+</span>&nbsp;<span class="builtinfunc" id="4159598">len</span><span class="op" id="4159601">(</span><span class="ident" id="4159602">m</span><span class="op" id="4159603">.</span><span class="ident" id="4159604">certificateTypes</span><span class="op" id="4159620">)</span>&nbsp;<span class="op" id="4159622">+</span>&nbsp;<span class="num" id="4159624">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159627">casLength</span>&nbsp;<span class="op" id="4159637">:=</span>&nbsp;<span class="num" id="4159640">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159643">for</span>&nbsp;<span class="ident" id="4159647">_</span><span class="op" id="4159648">,</span>&nbsp;<span class="ident" id="4159650">ca</span>&nbsp;<span class="op" id="4159653">:=</span>&nbsp;<span class="keyword" id="4159656">range</span>&nbsp;<span class="ident" id="4159662">m</span><span class="op" id="4159663">.</span><span class="ident" id="4159664">certificateAuthorities</span>&nbsp;<span class="op" id="4159687">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159691">casLength</span>&nbsp;<span class="op" id="4159701">+=</span>&nbsp;<span class="num" id="4159704">2</span>&nbsp;<span class="op" id="4159706">+</span>&nbsp;<span class="builtinfunc" id="4159708">len</span><span class="op" id="4159711">(</span><span class="ident" id="4159712">ca</span><span class="op" id="4159714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159720">length</span>&nbsp;<span class="op" id="4159727">+=</span>&nbsp;<span class="ident" id="4159730">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4159742">if</span>&nbsp;<span class="ident" id="4159745">m</span><span class="op" id="4159746">.</span><span class="ident" id="4159747">hasSignatureAndHash</span>&nbsp;<span class="op" id="4159767">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159771">length</span>&nbsp;<span class="op" id="4159778">+=</span>&nbsp;<span class="num" id="4159781">2</span>&nbsp;<span class="op" id="4159783">+</span>&nbsp;<span class="num" id="4159785">2</span><span class="op" id="4159786">*</span><span class="builtinfunc" id="4159787">len</span><span class="op" id="4159790">(</span><span class="ident" id="4159791">m</span><span class="op" id="4159792">.</span><span class="ident" id="4159793">signatureAndHashes</span><span class="op" id="4159811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4159814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159818">x</span>&nbsp;<span class="op" id="4159820">=</span>&nbsp;<span class="builtinfunc" id="4159822">make</span><span class="op" id="4159826">(</span><span class="op" id="4159827">[</span><span class="op" id="4159828">]</span><span class="builtintype" id="4159829">byte</span><span class="op" id="4159833">,</span>&nbsp;<span class="num" id="4159835">4</span><span class="op" id="4159836">+</span><span class="ident" id="4159837">length</span><span class="op" id="4159843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159846">x</span><span class="op" id="4159847">[</span><span class="num" id="4159848">0</span><span class="op" id="4159849">]</span>&nbsp;<span class="op" id="4159851">=</span>&nbsp;<span class="ident" id="4159853">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159877">x</span><span class="op" id="4159878">[</span><span class="num" id="4159879">1</span><span class="op" id="4159880">]</span>&nbsp;<span class="op" id="4159882">=</span>&nbsp;<span class="builtintype" id="4159884">uint8</span><span class="op" id="4159889">(</span><span class="ident" id="4159890">length</span>&nbsp;<span class="op" id="4159897">&gt;&gt;</span>&nbsp;<span class="num" id="4159900">16</span><span class="op" id="4159902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159905">x</span><span class="op" id="4159906">[</span><span class="num" id="4159907">2</span><span class="op" id="4159908">]</span>&nbsp;<span class="op" id="4159910">=</span>&nbsp;<span class="builtintype" id="4159912">uint8</span><span class="op" id="4159917">(</span><span class="ident" id="4159918">length</span>&nbsp;<span class="op" id="4159925">&gt;&gt;</span>&nbsp;<span class="num" id="4159928">8</span><span class="op" id="4159929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159932">x</span><span class="op" id="4159933">[</span><span class="num" id="4159934">3</span><span class="op" id="4159935">]</span>&nbsp;<span class="op" id="4159937">=</span>&nbsp;<span class="builtintype" id="4159939">uint8</span><span class="op" id="4159944">(</span><span class="ident" id="4159945">length</span><span class="op" id="4159951">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4159955">x</span><span class="op" id="4159956">[</span><span class="num" id="4159957">4</span><span class="op" id="4159958">]</span>&nbsp;<span class="op" id="4159960">=</span>&nbsp;<span class="builtintype" id="4159962">uint8</span><span class="op" id="4159967">(</span><span class="builtinfunc" id="4159968">len</span><span class="op" id="4159971">(</span><span class="ident" id="4159972">m</span><span class="op" id="4159973">.</span><span class="ident" id="4159974">certificateTypes</span><span class="op" id="4159990">)</span><span class="op" id="4159991">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4159995">copy</span><span class="op" id="4159999">(</span><span class="ident" id="4160000">x</span><span class="op" id="4160001">[</span><span class="num" id="4160002">5</span><span class="op" id="4160003">:</span><span class="op" id="4160004">]</span><span class="op" id="4160005">,</span>&nbsp;<span class="ident" id="4160007">m</span><span class="op" id="4160008">.</span><span class="ident" id="4160009">certificateTypes</span><span class="op" id="4160025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160028">y</span>&nbsp;<span class="op" id="4160030">:=</span>&nbsp;<span class="ident" id="4160033">x</span><span class="op" id="4160034">[</span><span class="num" id="4160035">5</span><span class="op" id="4160036">+</span><span class="builtinfunc" id="4160037">len</span><span class="op" id="4160040">(</span><span class="ident" id="4160041">m</span><span class="op" id="4160042">.</span><span class="ident" id="4160043">certificateTypes</span><span class="op" id="4160059">)</span><span class="op" id="4160060">:</span><span class="op" id="4160061">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160065">if</span>&nbsp;<span class="ident" id="4160068">m</span><span class="op" id="4160069">.</span><span class="ident" id="4160070">hasSignatureAndHash</span>&nbsp;<span class="op" id="4160090">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160094">n</span>&nbsp;<span class="op" id="4160096">:=</span>&nbsp;<span class="builtinfunc" id="4160099">len</span><span class="op" id="4160102">(</span><span class="ident" id="4160103">m</span><span class="op" id="4160104">.</span><span class="ident" id="4160105">signatureAndHashes</span><span class="op" id="4160123">)</span>&nbsp;<span class="op" id="4160125">*</span>&nbsp;<span class="num" id="4160127">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160131">y</span><span class="op" id="4160132">[</span><span class="num" id="4160133">0</span><span class="op" id="4160134">]</span>&nbsp;<span class="op" id="4160136">=</span>&nbsp;<span class="builtintype" id="4160138">uint8</span><span class="op" id="4160143">(</span><span class="ident" id="4160144">n</span>&nbsp;<span class="op" id="4160146">&gt;&gt;</span>&nbsp;<span class="num" id="4160149">8</span><span class="op" id="4160150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160154">y</span><span class="op" id="4160155">[</span><span class="num" id="4160156">1</span><span class="op" id="4160157">]</span>&nbsp;<span class="op" id="4160159">=</span>&nbsp;<span class="builtintype" id="4160161">uint8</span><span class="op" id="4160166">(</span><span class="ident" id="4160167">n</span><span class="op" id="4160168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160172">y</span>&nbsp;<span class="op" id="4160174">=</span>&nbsp;<span class="ident" id="4160176">y</span><span class="op" id="4160177">[</span><span class="num" id="4160178">2</span><span class="op" id="4160179">:</span><span class="op" id="4160180">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160184">for</span>&nbsp;<span class="ident" id="4160188">_</span><span class="op" id="4160189">,</span>&nbsp;<span class="ident" id="4160191">sigAndHash</span>&nbsp;<span class="op" id="4160202">:=</span>&nbsp;<span class="keyword" id="4160205">range</span>&nbsp;<span class="ident" id="4160211">m</span><span class="op" id="4160212">.</span><span class="ident" id="4160213">signatureAndHashes</span>&nbsp;<span class="op" id="4160232">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160237">y</span><span class="op" id="4160238">[</span><span class="num" id="4160239">0</span><span class="op" id="4160240">]</span>&nbsp;<span class="op" id="4160242">=</span>&nbsp;<span class="ident" id="4160244">sigAndHash</span><span class="op" id="4160254">.</span><span class="ident" id="4160255">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160263">y</span><span class="op" id="4160264">[</span><span class="num" id="4160265">1</span><span class="op" id="4160266">]</span>&nbsp;<span class="op" id="4160268">=</span>&nbsp;<span class="ident" id="4160270">sigAndHash</span><span class="op" id="4160280">.</span><span class="ident" id="4160281">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160294">y</span>&nbsp;<span class="op" id="4160296">=</span>&nbsp;<span class="ident" id="4160298">y</span><span class="op" id="4160299">[</span><span class="num" id="4160300">2</span><span class="op" id="4160301">:</span><span class="op" id="4160302">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160309">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160313">y</span><span class="op" id="4160314">[</span><span class="num" id="4160315">0</span><span class="op" id="4160316">]</span>&nbsp;<span class="op" id="4160318">=</span>&nbsp;<span class="builtintype" id="4160320">uint8</span><span class="op" id="4160325">(</span><span class="ident" id="4160326">casLength</span>&nbsp;<span class="op" id="4160336">&gt;&gt;</span>&nbsp;<span class="num" id="4160339">8</span><span class="op" id="4160340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160343">y</span><span class="op" id="4160344">[</span><span class="num" id="4160345">1</span><span class="op" id="4160346">]</span>&nbsp;<span class="op" id="4160348">=</span>&nbsp;<span class="builtintype" id="4160350">uint8</span><span class="op" id="4160355">(</span><span class="ident" id="4160356">casLength</span><span class="op" id="4160365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160368">y</span>&nbsp;<span class="op" id="4160370">=</span>&nbsp;<span class="ident" id="4160372">y</span><span class="op" id="4160373">[</span><span class="num" id="4160374">2</span><span class="op" id="4160375">:</span><span class="op" id="4160376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160379">for</span>&nbsp;<span class="ident" id="4160383">_</span><span class="op" id="4160384">,</span>&nbsp;<span class="ident" id="4160386">ca</span>&nbsp;<span class="op" id="4160389">:=</span>&nbsp;<span class="keyword" id="4160392">range</span>&nbsp;<span class="ident" id="4160398">m</span><span class="op" id="4160399">.</span><span class="ident" id="4160400">certificateAuthorities</span>&nbsp;<span class="op" id="4160423">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160427">y</span><span class="op" id="4160428">[</span><span class="num" id="4160429">0</span><span class="op" id="4160430">]</span>&nbsp;<span class="op" id="4160432">=</span>&nbsp;<span class="builtintype" id="4160434">uint8</span><span class="op" id="4160439">(</span><span class="builtinfunc" id="4160440">len</span><span class="op" id="4160443">(</span><span class="ident" id="4160444">ca</span><span class="op" id="4160446">)</span>&nbsp;<span class="op" id="4160448">&gt;&gt;</span>&nbsp;<span class="num" id="4160451">8</span><span class="op" id="4160452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160456">y</span><span class="op" id="4160457">[</span><span class="num" id="4160458">1</span><span class="op" id="4160459">]</span>&nbsp;<span class="op" id="4160461">=</span>&nbsp;<span class="builtintype" id="4160463">uint8</span><span class="op" id="4160468">(</span><span class="builtinfunc" id="4160469">len</span><span class="op" id="4160472">(</span><span class="ident" id="4160473">ca</span><span class="op" id="4160475">)</span><span class="op" id="4160476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160480">y</span>&nbsp;<span class="op" id="4160482">=</span>&nbsp;<span class="ident" id="4160484">y</span><span class="op" id="4160485">[</span><span class="num" id="4160486">2</span><span class="op" id="4160487">:</span><span class="op" id="4160488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4160492">copy</span><span class="op" id="4160496">(</span><span class="ident" id="4160497">y</span><span class="op" id="4160498">,</span>&nbsp;<span class="ident" id="4160500">ca</span><span class="op" id="4160502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160506">y</span>&nbsp;<span class="op" id="4160508">=</span>&nbsp;<span class="ident" id="4160510">y</span><span class="op" id="4160511">[</span><span class="builtinfunc" id="4160512">len</span><span class="op" id="4160515">(</span><span class="ident" id="4160516">ca</span><span class="op" id="4160518">)</span><span class="op" id="4160519">:</span><span class="op" id="4160520">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160527">m</span><span class="op" id="4160528">.</span><span class="ident" id="4160529">raw</span>&nbsp;<span class="op" id="4160533">=</span>&nbsp;<span class="ident" id="4160535">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160538">return</span><br>
<span class="lineno"></span><span class="op" id="4160545">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="4160548">func</span>&nbsp;<span class="op" id="4160553">(</span><span class="ident" id="4160554">m</span>&nbsp;<span class="op" id="4160556">*</span><span class="ident" id="4160557">certificateRequestMsg</span><span class="op" id="4160578">)</span>&nbsp;<span class="ident" id="4160580">unmarshal</span><span class="op" id="4160589">(</span><span class="ident" id="4160590">data</span>&nbsp;<span class="op" id="4160595">[</span><span class="op" id="4160596">]</span><span class="builtintype" id="4160597">byte</span><span class="op" id="4160601">)</span>&nbsp;<span class="builtintype" id="4160603">bool</span>&nbsp;<span class="op" id="4160608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160611">m</span><span class="op" id="4160612">.</span><span class="ident" id="4160613">raw</span>&nbsp;<span class="op" id="4160617">=</span>&nbsp;<span class="ident" id="4160619">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160626">if</span>&nbsp;<span class="builtinfunc" id="4160629">len</span><span class="op" id="4160632">(</span><span class="ident" id="4160633">data</span><span class="op" id="4160637">)</span>&nbsp;<span class="op" id="4160639">&lt;</span>&nbsp;<span class="num" id="4160641">5</span>&nbsp;<span class="op" id="4160643">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160647">return</span>&nbsp;<span class="builtintype" id="4160654">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160665">length</span>&nbsp;<span class="op" id="4160672">:=</span>&nbsp;<span class="builtintype" id="4160675">uint32</span><span class="op" id="4160681">(</span><span class="ident" id="4160682">data</span><span class="op" id="4160686">[</span><span class="num" id="4160687">1</span><span class="op" id="4160688">]</span><span class="op" id="4160689">)</span><span class="op" id="4160690">&lt;&lt;</span><span class="num" id="4160692">16</span>&nbsp;<span class="op" id="4160695">|</span>&nbsp;<span class="builtintype" id="4160697">uint32</span><span class="op" id="4160703">(</span><span class="ident" id="4160704">data</span><span class="op" id="4160708">[</span><span class="num" id="4160709">2</span><span class="op" id="4160710">]</span><span class="op" id="4160711">)</span><span class="op" id="4160712">&lt;&lt;</span><span class="num" id="4160714">8</span>&nbsp;<span class="op" id="4160716">|</span>&nbsp;<span class="builtintype" id="4160718">uint32</span><span class="op" id="4160724">(</span><span class="ident" id="4160725">data</span><span class="op" id="4160729">[</span><span class="num" id="4160730">3</span><span class="op" id="4160731">]</span><span class="op" id="4160732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160735">if</span>&nbsp;<span class="builtintype" id="4160738">uint32</span><span class="op" id="4160744">(</span><span class="builtinfunc" id="4160745">len</span><span class="op" id="4160748">(</span><span class="ident" id="4160749">data</span><span class="op" id="4160753">)</span><span class="op" id="4160754">)</span><span class="op" id="4160755">-</span><span class="num" id="4160756">4</span>&nbsp;<span class="op" id="4160758">!=</span>&nbsp;<span class="ident" id="4160761">length</span>&nbsp;<span class="op" id="4160768">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160772">return</span>&nbsp;<span class="builtintype" id="4160779">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160790">numCertTypes</span>&nbsp;<span class="op" id="4160803">:=</span>&nbsp;<span class="builtintype" id="4160806">int</span><span class="op" id="4160809">(</span><span class="ident" id="4160810">data</span><span class="op" id="4160814">[</span><span class="num" id="4160815">4</span><span class="op" id="4160816">]</span><span class="op" id="4160817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160820">data</span>&nbsp;<span class="op" id="4160825">=</span>&nbsp;<span class="ident" id="4160827">data</span><span class="op" id="4160831">[</span><span class="num" id="4160832">5</span><span class="op" id="4160833">:</span><span class="op" id="4160834">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160837">if</span>&nbsp;<span class="ident" id="4160840">numCertTypes</span>&nbsp;<span class="op" id="4160853">==</span>&nbsp;<span class="num" id="4160856">0</span>&nbsp;<span class="op" id="4160858">||</span>&nbsp;<span class="builtinfunc" id="4160861">len</span><span class="op" id="4160864">(</span><span class="ident" id="4160865">data</span><span class="op" id="4160869">)</span>&nbsp;<span class="op" id="4160871">&lt;=</span>&nbsp;<span class="ident" id="4160874">numCertTypes</span>&nbsp;<span class="op" id="4160887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160891">return</span>&nbsp;<span class="builtintype" id="4160898">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4160905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4160909">m</span><span class="op" id="4160910">.</span><span class="ident" id="4160911">certificateTypes</span>&nbsp;<span class="op" id="4160928">=</span>&nbsp;<span class="builtinfunc" id="4160930">make</span><span class="op" id="4160934">(</span><span class="op" id="4160935">[</span><span class="op" id="4160936">]</span><span class="builtintype" id="4160937">byte</span><span class="op" id="4160941">,</span>&nbsp;<span class="ident" id="4160943">numCertTypes</span><span class="op" id="4160955">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4160958">if</span>&nbsp;<span class="builtinfunc" id="4160961">copy</span><span class="op" id="4160965">(</span><span class="ident" id="4160966">m</span><span class="op" id="4160967">.</span><span class="ident" id="4160968">certificateTypes</span><span class="op" id="4160984">,</span>&nbsp;<span class="ident" id="4160986">data</span><span class="op" id="4160990">)</span>&nbsp;<span class="op" id="4160992">!=</span>&nbsp;<span class="ident" id="4160995">numCertTypes</span>&nbsp;<span class="op" id="4161008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161012">return</span>&nbsp;<span class="builtintype" id="4161019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161030">data</span>&nbsp;<span class="op" id="4161035">=</span>&nbsp;<span class="ident" id="4161037">data</span><span class="op" id="4161041">[</span><span class="ident" id="4161042">numCertTypes</span><span class="op" id="4161054">:</span><span class="op" id="4161055">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161059">if</span>&nbsp;<span class="ident" id="4161062">m</span><span class="op" id="4161063">.</span><span class="ident" id="4161064">hasSignatureAndHash</span>&nbsp;<span class="op" id="4161084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161088">if</span>&nbsp;<span class="builtinfunc" id="4161091">len</span><span class="op" id="4161094">(</span><span class="ident" id="4161095">data</span><span class="op" id="4161099">)</span>&nbsp;<span class="op" id="4161101">&lt;</span>&nbsp;<span class="num" id="4161103">2</span>&nbsp;<span class="op" id="4161105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161110">return</span>&nbsp;<span class="builtintype" id="4161117">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161125">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161129">sigAndHashLen</span>&nbsp;<span class="op" id="4161143">:=</span>&nbsp;<span class="builtintype" id="4161146">uint16</span><span class="op" id="4161152">(</span><span class="ident" id="4161153">data</span><span class="op" id="4161157">[</span><span class="num" id="4161158">0</span><span class="op" id="4161159">]</span><span class="op" id="4161160">)</span><span class="op" id="4161161">&lt;&lt;</span><span class="num" id="4161163">8</span>&nbsp;<span class="op" id="4161165">|</span>&nbsp;<span class="builtintype" id="4161167">uint16</span><span class="op" id="4161173">(</span><span class="ident" id="4161174">data</span><span class="op" id="4161178">[</span><span class="num" id="4161179">1</span><span class="op" id="4161180">]</span><span class="op" id="4161181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161185">data</span>&nbsp;<span class="op" id="4161190">=</span>&nbsp;<span class="ident" id="4161192">data</span><span class="op" id="4161196">[</span><span class="num" id="4161197">2</span><span class="op" id="4161198">:</span><span class="op" id="4161199">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161203">if</span>&nbsp;<span class="ident" id="4161206">sigAndHashLen</span><span class="op" id="4161219">&amp;</span><span class="num" id="4161220">1</span>&nbsp;<span class="op" id="4161222">!=</span>&nbsp;<span class="num" id="4161225">0</span>&nbsp;<span class="op" id="4161227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161232">return</span>&nbsp;<span class="builtintype" id="4161239">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161247">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161251">if</span>&nbsp;<span class="builtinfunc" id="4161254">len</span><span class="op" id="4161257">(</span><span class="ident" id="4161258">data</span><span class="op" id="4161262">)</span>&nbsp;<span class="op" id="4161264">&lt;</span>&nbsp;<span class="builtintype" id="4161266">int</span><span class="op" id="4161269">(</span><span class="ident" id="4161270">sigAndHashLen</span><span class="op" id="4161283">)</span>&nbsp;<span class="op" id="4161285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161290">return</span>&nbsp;<span class="builtintype" id="4161297">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161309">numSigAndHash</span>&nbsp;<span class="op" id="4161323">:=</span>&nbsp;<span class="ident" id="4161326">sigAndHashLen</span>&nbsp;<span class="op" id="4161340">/</span>&nbsp;<span class="num" id="4161342">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161346">m</span><span class="op" id="4161347">.</span><span class="ident" id="4161348">signatureAndHashes</span>&nbsp;<span class="op" id="4161367">=</span>&nbsp;<span class="builtinfunc" id="4161369">make</span><span class="op" id="4161373">(</span><span class="op" id="4161374">[</span><span class="op" id="4161375">]</span><span class="ident" id="4161376">signatureAndHash</span><span class="op" id="4161392">,</span>&nbsp;<span class="ident" id="4161394">numSigAndHash</span><span class="op" id="4161407">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161411">for</span>&nbsp;<span class="ident" id="4161415">i</span>&nbsp;<span class="op" id="4161417">:=</span>&nbsp;<span class="keyword" id="4161420">range</span>&nbsp;<span class="ident" id="4161426">m</span><span class="op" id="4161427">.</span><span class="ident" id="4161428">signatureAndHashes</span>&nbsp;<span class="op" id="4161447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161452">m</span><span class="op" id="4161453">.</span><span class="ident" id="4161454">signatureAndHashes</span><span class="op" id="4161472">[</span><span class="ident" id="4161473">i</span><span class="op" id="4161474">]</span><span class="op" id="4161475">.</span><span class="ident" id="4161476">hash</span>&nbsp;<span class="op" id="4161481">=</span>&nbsp;<span class="ident" id="4161483">data</span><span class="op" id="4161487">[</span><span class="num" id="4161488">0</span><span class="op" id="4161489">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161494">m</span><span class="op" id="4161495">.</span><span class="ident" id="4161496">signatureAndHashes</span><span class="op" id="4161514">[</span><span class="ident" id="4161515">i</span><span class="op" id="4161516">]</span><span class="op" id="4161517">.</span><span class="ident" id="4161518">signature</span>&nbsp;<span class="op" id="4161528">=</span>&nbsp;<span class="ident" id="4161530">data</span><span class="op" id="4161534">[</span><span class="num" id="4161535">1</span><span class="op" id="4161536">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161541">data</span>&nbsp;<span class="op" id="4161546">=</span>&nbsp;<span class="ident" id="4161548">data</span><span class="op" id="4161552">[</span><span class="num" id="4161553">2</span><span class="op" id="4161554">:</span><span class="op" id="4161555">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161559">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161566">if</span>&nbsp;<span class="builtinfunc" id="4161569">len</span><span class="op" id="4161572">(</span><span class="ident" id="4161573">data</span><span class="op" id="4161577">)</span>&nbsp;<span class="op" id="4161579">&lt;</span>&nbsp;<span class="num" id="4161581">2</span>&nbsp;<span class="op" id="4161583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161587">return</span>&nbsp;<span class="builtintype" id="4161594">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161601">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161604">casLength</span>&nbsp;<span class="op" id="4161614">:=</span>&nbsp;<span class="builtintype" id="4161617">uint16</span><span class="op" id="4161623">(</span><span class="ident" id="4161624">data</span><span class="op" id="4161628">[</span><span class="num" id="4161629">0</span><span class="op" id="4161630">]</span><span class="op" id="4161631">)</span><span class="op" id="4161632">&lt;&lt;</span><span class="num" id="4161634">8</span>&nbsp;<span class="op" id="4161636">|</span>&nbsp;<span class="builtintype" id="4161638">uint16</span><span class="op" id="4161644">(</span><span class="ident" id="4161645">data</span><span class="op" id="4161649">[</span><span class="num" id="4161650">1</span><span class="op" id="4161651">]</span><span class="op" id="4161652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161655">data</span>&nbsp;<span class="op" id="4161660">=</span>&nbsp;<span class="ident" id="4161662">data</span><span class="op" id="4161666">[</span><span class="num" id="4161667">2</span><span class="op" id="4161668">:</span><span class="op" id="4161669">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161672">if</span>&nbsp;<span class="builtinfunc" id="4161675">len</span><span class="op" id="4161678">(</span><span class="ident" id="4161679">data</span><span class="op" id="4161683">)</span>&nbsp;<span class="op" id="4161685">&lt;</span>&nbsp;<span class="builtintype" id="4161687">int</span><span class="op" id="4161690">(</span><span class="ident" id="4161691">casLength</span><span class="op" id="4161700">)</span>&nbsp;<span class="op" id="4161702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161706">return</span>&nbsp;<span class="builtintype" id="4161713">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161720">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161723">cas</span>&nbsp;<span class="op" id="4161727">:=</span>&nbsp;<span class="builtinfunc" id="4161730">make</span><span class="op" id="4161734">(</span><span class="op" id="4161735">[</span><span class="op" id="4161736">]</span><span class="builtintype" id="4161737">byte</span><span class="op" id="4161741">,</span>&nbsp;<span class="ident" id="4161743">casLength</span><span class="op" id="4161752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4161755">copy</span><span class="op" id="4161759">(</span><span class="ident" id="4161760">cas</span><span class="op" id="4161763">,</span>&nbsp;<span class="ident" id="4161765">data</span><span class="op" id="4161769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161772">data</span>&nbsp;<span class="op" id="4161777">=</span>&nbsp;<span class="ident" id="4161779">data</span><span class="op" id="4161783">[</span><span class="ident" id="4161784">casLength</span><span class="op" id="4161793">:</span><span class="op" id="4161794">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161798">m</span><span class="op" id="4161799">.</span><span class="ident" id="4161800">certificateAuthorities</span>&nbsp;<span class="op" id="4161823">=</span>&nbsp;<span class="ident" id="4161825">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161830">for</span>&nbsp;<span class="builtinfunc" id="4161834">len</span><span class="op" id="4161837">(</span><span class="ident" id="4161838">cas</span><span class="op" id="4161841">)</span>&nbsp;<span class="op" id="4161843">&gt;</span>&nbsp;<span class="num" id="4161845">0</span>&nbsp;<span class="op" id="4161847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161851">if</span>&nbsp;<span class="builtinfunc" id="4161854">len</span><span class="op" id="4161857">(</span><span class="ident" id="4161858">cas</span><span class="op" id="4161861">)</span>&nbsp;<span class="op" id="4161863">&lt;</span>&nbsp;<span class="num" id="4161865">2</span>&nbsp;<span class="op" id="4161867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161872">return</span>&nbsp;<span class="builtintype" id="4161879">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161887">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161891">caLen</span>&nbsp;<span class="op" id="4161897">:=</span>&nbsp;<span class="builtintype" id="4161900">uint16</span><span class="op" id="4161906">(</span><span class="ident" id="4161907">cas</span><span class="op" id="4161910">[</span><span class="num" id="4161911">0</span><span class="op" id="4161912">]</span><span class="op" id="4161913">)</span><span class="op" id="4161914">&lt;&lt;</span><span class="num" id="4161916">8</span>&nbsp;<span class="op" id="4161918">|</span>&nbsp;<span class="builtintype" id="4161920">uint16</span><span class="op" id="4161926">(</span><span class="ident" id="4161927">cas</span><span class="op" id="4161930">[</span><span class="num" id="4161931">1</span><span class="op" id="4161932">]</span><span class="op" id="4161933">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4161937">cas</span>&nbsp;<span class="op" id="4161941">=</span>&nbsp;<span class="ident" id="4161943">cas</span><span class="op" id="4161946">[</span><span class="num" id="4161947">2</span><span class="op" id="4161948">:</span><span class="op" id="4161949">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161954">if</span>&nbsp;<span class="builtinfunc" id="4161957">len</span><span class="op" id="4161960">(</span><span class="ident" id="4161961">cas</span><span class="op" id="4161964">)</span>&nbsp;<span class="op" id="4161966">&lt;</span>&nbsp;<span class="builtintype" id="4161968">int</span><span class="op" id="4161971">(</span><span class="ident" id="4161972">caLen</span><span class="op" id="4161977">)</span>&nbsp;<span class="op" id="4161979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4161984">return</span>&nbsp;<span class="builtintype" id="4161991">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4161999">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162004">m</span><span class="op" id="4162005">.</span><span class="ident" id="4162006">certificateAuthorities</span>&nbsp;<span class="op" id="4162029">=</span>&nbsp;<span class="builtinfunc" id="4162031">append</span><span class="op" id="4162037">(</span><span class="ident" id="4162038">m</span><span class="op" id="4162039">.</span><span class="ident" id="4162040">certificateAuthorities</span><span class="op" id="4162062">,</span>&nbsp;<span class="ident" id="4162064">cas</span><span class="op" id="4162067">[</span><span class="op" id="4162068">:</span><span class="ident" id="4162069">caLen</span><span class="op" id="4162074">]</span><span class="op" id="4162075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162079">cas</span>&nbsp;<span class="op" id="4162083">=</span>&nbsp;<span class="ident" id="4162085">cas</span><span class="op" id="4162088">[</span><span class="ident" id="4162089">caLen</span><span class="op" id="4162094">:</span><span class="op" id="4162095">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162101">if</span>&nbsp;<span class="builtinfunc" id="4162104">len</span><span class="op" id="4162107">(</span><span class="ident" id="4162108">data</span><span class="op" id="4162112">)</span>&nbsp;<span class="op" id="4162114">&gt;</span>&nbsp;<span class="num" id="4162116">0</span>&nbsp;<span class="op" id="4162118">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162122">return</span>&nbsp;<span class="builtintype" id="4162129">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162140">return</span>&nbsp;<span class="builtintype" id="4162147">true</span><br>
<span class="lineno"></span><span class="op" id="4162152">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="4162155">type</span>&nbsp;<span class="ident" id="4162160">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="4162181">struct</span>&nbsp;<span class="op" id="4162188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162191">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4162211">[</span><span class="op" id="4162212">]</span><span class="builtintype" id="4162213">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162219">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="4162239">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162245">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4162265">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162283">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4162303">[</span><span class="op" id="4162304">]</span><span class="builtintype" id="4162305">byte</span><br>
<span class="lineno"></span><span class="op" id="4162310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4162313">func</span>&nbsp;<span class="op" id="4162318">(</span><span class="ident" id="4162319">m</span>&nbsp;<span class="op" id="4162321">*</span><span class="ident" id="4162322">certificateVerifyMsg</span><span class="op" id="4162342">)</span>&nbsp;<span class="ident" id="4162344">equal</span><span class="op" id="4162349">(</span><span class="ident" id="4162350">i</span>&nbsp;<span class="keyword" id="4162352">interface</span><span class="op" id="4162361">{</span><span class="op" id="4162362">}</span><span class="op" id="4162363">)</span>&nbsp;<span class="builtintype" id="4162365">bool</span>&nbsp;<span class="op" id="4162370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162373">m1</span><span class="op" id="4162375">,</span>&nbsp;<span class="ident" id="4162377">ok</span>&nbsp;<span class="op" id="4162380">:=</span>&nbsp;<span class="ident" id="4162383">i</span><span class="op" id="4162384">.</span><span class="op" id="4162385">(</span><span class="op" id="4162386">*</span><span class="ident" id="4162387">certificateVerifyMsg</span><span class="op" id="4162407">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162410">if</span>&nbsp;<span class="op" id="4162413">!</span><span class="ident" id="4162414">ok</span>&nbsp;<span class="op" id="4162417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162421">return</span>&nbsp;<span class="builtintype" id="4162428">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162439">return</span>&nbsp;<span class="ident" id="4162446">bytes</span><span class="op" id="4162451">.</span><span class="ident" id="4162452">Equal</span><span class="op" id="4162457">(</span><span class="ident" id="4162458">m</span><span class="op" id="4162459">.</span><span class="ident" id="4162460">raw</span><span class="op" id="4162463">,</span>&nbsp;<span class="ident" id="4162465">m1</span><span class="op" id="4162467">.</span><span class="ident" id="4162468">raw</span><span class="op" id="4162471">)</span>&nbsp;<span class="op" id="4162473">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162478">m</span><span class="op" id="4162479">.</span><span class="ident" id="4162480">hasSignatureAndHash</span>&nbsp;<span class="op" id="4162500">==</span>&nbsp;<span class="ident" id="4162503">m1</span><span class="op" id="4162505">.</span><span class="ident" id="4162506">hasSignatureAndHash</span>&nbsp;<span class="op" id="4162526">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162531">m</span><span class="op" id="4162532">.</span><span class="ident" id="4162533">signatureAndHash</span><span class="op" id="4162549">.</span><span class="ident" id="4162550">hash</span>&nbsp;<span class="op" id="4162555">==</span>&nbsp;<span class="ident" id="4162558">m1</span><span class="op" id="4162560">.</span><span class="ident" id="4162561">signatureAndHash</span><span class="op" id="4162577">.</span><span class="ident" id="4162578">hash</span>&nbsp;<span class="op" id="4162583">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162588">m</span><span class="op" id="4162589">.</span><span class="ident" id="4162590">signatureAndHash</span><span class="op" id="4162606">.</span><span class="ident" id="4162607">signature</span>&nbsp;<span class="op" id="4162617">==</span>&nbsp;<span class="ident" id="4162620">m1</span><span class="op" id="4162622">.</span><span class="ident" id="4162623">signatureAndHash</span><span class="op" id="4162639">.</span><span class="ident" id="4162640">signature</span>&nbsp;<span class="op" id="4162650">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162655">bytes</span><span class="op" id="4162660">.</span><span class="ident" id="4162661">Equal</span><span class="op" id="4162666">(</span><span class="ident" id="4162667">m</span><span class="op" id="4162668">.</span><span class="ident" id="4162669">signature</span><span class="op" id="4162678">,</span>&nbsp;<span class="ident" id="4162680">m1</span><span class="op" id="4162682">.</span><span class="ident" id="4162683">signature</span><span class="op" id="4162692">)</span><br>
<span class="lineno"></span><span class="op" id="4162694">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="4162697">func</span>&nbsp;<span class="op" id="4162702">(</span><span class="ident" id="4162703">m</span>&nbsp;<span class="op" id="4162705">*</span><span class="ident" id="4162706">certificateVerifyMsg</span><span class="op" id="4162726">)</span>&nbsp;<span class="ident" id="4162728">marshal</span><span class="op" id="4162735">(</span><span class="op" id="4162736">)</span>&nbsp;<span class="op" id="4162738">(</span><span class="ident" id="4162739">x</span>&nbsp;<span class="op" id="4162741">[</span><span class="op" id="4162742">]</span><span class="builtintype" id="4162743">byte</span><span class="op" id="4162747">)</span>&nbsp;<span class="op" id="4162749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162752">if</span>&nbsp;<span class="ident" id="4162755">m</span><span class="op" id="4162756">.</span><span class="ident" id="4162757">raw</span>&nbsp;<span class="op" id="4162761">!=</span>&nbsp;<span class="ident" id="4162764">nil</span>&nbsp;<span class="op" id="4162768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162772">return</span>&nbsp;<span class="ident" id="4162779">m</span><span class="op" id="4162780">.</span><span class="ident" id="4162781">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162786">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4162790">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162847">siglength</span>&nbsp;<span class="op" id="4162857">:=</span>&nbsp;<span class="builtinfunc" id="4162860">len</span><span class="op" id="4162863">(</span><span class="ident" id="4162864">m</span><span class="op" id="4162865">.</span><span class="ident" id="4162866">signature</span><span class="op" id="4162875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162878">length</span>&nbsp;<span class="op" id="4162885">:=</span>&nbsp;<span class="num" id="4162888">2</span>&nbsp;<span class="op" id="4162890">+</span>&nbsp;<span class="ident" id="4162892">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4162903">if</span>&nbsp;<span class="ident" id="4162906">m</span><span class="op" id="4162907">.</span><span class="ident" id="4162908">hasSignatureAndHash</span>&nbsp;<span class="op" id="4162928">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162932">length</span>&nbsp;<span class="op" id="4162939">+=</span>&nbsp;<span class="num" id="4162942">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4162945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162948">x</span>&nbsp;<span class="op" id="4162950">=</span>&nbsp;<span class="builtinfunc" id="4162952">make</span><span class="op" id="4162956">(</span><span class="op" id="4162957">[</span><span class="op" id="4162958">]</span><span class="builtintype" id="4162959">byte</span><span class="op" id="4162963">,</span>&nbsp;<span class="num" id="4162965">4</span><span class="op" id="4162966">+</span><span class="ident" id="4162967">length</span><span class="op" id="4162973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4162976">x</span><span class="op" id="4162977">[</span><span class="num" id="4162978">0</span><span class="op" id="4162979">]</span>&nbsp;<span class="op" id="4162981">=</span>&nbsp;<span class="ident" id="4162983">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163006">x</span><span class="op" id="4163007">[</span><span class="num" id="4163008">1</span><span class="op" id="4163009">]</span>&nbsp;<span class="op" id="4163011">=</span>&nbsp;<span class="builtintype" id="4163013">uint8</span><span class="op" id="4163018">(</span><span class="ident" id="4163019">length</span>&nbsp;<span class="op" id="4163026">&gt;&gt;</span>&nbsp;<span class="num" id="4163029">16</span><span class="op" id="4163031">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163034">x</span><span class="op" id="4163035">[</span><span class="num" id="4163036">2</span><span class="op" id="4163037">]</span>&nbsp;<span class="op" id="4163039">=</span>&nbsp;<span class="builtintype" id="4163041">uint8</span><span class="op" id="4163046">(</span><span class="ident" id="4163047">length</span>&nbsp;<span class="op" id="4163054">&gt;&gt;</span>&nbsp;<span class="num" id="4163057">8</span><span class="op" id="4163058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163061">x</span><span class="op" id="4163062">[</span><span class="num" id="4163063">3</span><span class="op" id="4163064">]</span>&nbsp;<span class="op" id="4163066">=</span>&nbsp;<span class="builtintype" id="4163068">uint8</span><span class="op" id="4163073">(</span><span class="ident" id="4163074">length</span><span class="op" id="4163080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163083">y</span>&nbsp;<span class="op" id="4163085">:=</span>&nbsp;<span class="ident" id="4163088">x</span><span class="op" id="4163089">[</span><span class="num" id="4163090">4</span><span class="op" id="4163091">:</span><span class="op" id="4163092">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163095">if</span>&nbsp;<span class="ident" id="4163098">m</span><span class="op" id="4163099">.</span><span class="ident" id="4163100">hasSignatureAndHash</span>&nbsp;<span class="op" id="4163120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163124">y</span><span class="op" id="4163125">[</span><span class="num" id="4163126">0</span><span class="op" id="4163127">]</span>&nbsp;<span class="op" id="4163129">=</span>&nbsp;<span class="ident" id="4163131">m</span><span class="op" id="4163132">.</span><span class="ident" id="4163133">signatureAndHash</span><span class="op" id="4163149">.</span><span class="ident" id="4163150">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163157">y</span><span class="op" id="4163158">[</span><span class="num" id="4163159">1</span><span class="op" id="4163160">]</span>&nbsp;<span class="op" id="4163162">=</span>&nbsp;<span class="ident" id="4163164">m</span><span class="op" id="4163165">.</span><span class="ident" id="4163166">signatureAndHash</span><span class="op" id="4163182">.</span><span class="ident" id="4163183">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163195">y</span>&nbsp;<span class="op" id="4163197">=</span>&nbsp;<span class="ident" id="4163199">y</span><span class="op" id="4163200">[</span><span class="num" id="4163201">2</span><span class="op" id="4163202">:</span><span class="op" id="4163203">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163209">y</span><span class="op" id="4163210">[</span><span class="num" id="4163211">0</span><span class="op" id="4163212">]</span>&nbsp;<span class="op" id="4163214">=</span>&nbsp;<span class="builtintype" id="4163216">uint8</span><span class="op" id="4163221">(</span><span class="ident" id="4163222">siglength</span>&nbsp;<span class="op" id="4163232">&gt;&gt;</span>&nbsp;<span class="num" id="4163235">8</span><span class="op" id="4163236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163239">y</span><span class="op" id="4163240">[</span><span class="num" id="4163241">1</span><span class="op" id="4163242">]</span>&nbsp;<span class="op" id="4163244">=</span>&nbsp;<span class="builtintype" id="4163246">uint8</span><span class="op" id="4163251">(</span><span class="ident" id="4163252">siglength</span><span class="op" id="4163261">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4163264">copy</span><span class="op" id="4163268">(</span><span class="ident" id="4163269">y</span><span class="op" id="4163270">[</span><span class="num" id="4163271">2</span><span class="op" id="4163272">:</span><span class="op" id="4163273">]</span><span class="op" id="4163274">,</span>&nbsp;<span class="ident" id="4163276">m</span><span class="op" id="4163277">.</span><span class="ident" id="4163278">signature</span><span class="op" id="4163287">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163291">m</span><span class="op" id="4163292">.</span><span class="ident" id="4163293">raw</span>&nbsp;<span class="op" id="4163297">=</span>&nbsp;<span class="ident" id="4163299">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163303">return</span><br>
<span class="lineno">1285</span><span class="op" id="4163310">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4163313">func</span>&nbsp;<span class="op" id="4163318">(</span><span class="ident" id="4163319">m</span>&nbsp;<span class="op" id="4163321">*</span><span class="ident" id="4163322">certificateVerifyMsg</span><span class="op" id="4163342">)</span>&nbsp;<span class="ident" id="4163344">unmarshal</span><span class="op" id="4163353">(</span><span class="ident" id="4163354">data</span>&nbsp;<span class="op" id="4163359">[</span><span class="op" id="4163360">]</span><span class="builtintype" id="4163361">byte</span><span class="op" id="4163365">)</span>&nbsp;<span class="builtintype" id="4163367">bool</span>&nbsp;<span class="op" id="4163372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163375">m</span><span class="op" id="4163376">.</span><span class="ident" id="4163377">raw</span>&nbsp;<span class="op" id="4163381">=</span>&nbsp;<span class="ident" id="4163383">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163390">if</span>&nbsp;<span class="builtinfunc" id="4163393">len</span><span class="op" id="4163396">(</span><span class="ident" id="4163397">data</span><span class="op" id="4163401">)</span>&nbsp;<span class="op" id="4163403">&lt;</span>&nbsp;<span class="num" id="4163405">6</span>&nbsp;<span class="op" id="4163407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163411">return</span>&nbsp;<span class="builtintype" id="4163418">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163429">length</span>&nbsp;<span class="op" id="4163436">:=</span>&nbsp;<span class="builtintype" id="4163439">uint32</span><span class="op" id="4163445">(</span><span class="ident" id="4163446">data</span><span class="op" id="4163450">[</span><span class="num" id="4163451">1</span><span class="op" id="4163452">]</span><span class="op" id="4163453">)</span><span class="op" id="4163454">&lt;&lt;</span><span class="num" id="4163456">16</span>&nbsp;<span class="op" id="4163459">|</span>&nbsp;<span class="builtintype" id="4163461">uint32</span><span class="op" id="4163467">(</span><span class="ident" id="4163468">data</span><span class="op" id="4163472">[</span><span class="num" id="4163473">2</span><span class="op" id="4163474">]</span><span class="op" id="4163475">)</span><span class="op" id="4163476">&lt;&lt;</span><span class="num" id="4163478">8</span>&nbsp;<span class="op" id="4163480">|</span>&nbsp;<span class="builtintype" id="4163482">uint32</span><span class="op" id="4163488">(</span><span class="ident" id="4163489">data</span><span class="op" id="4163493">[</span><span class="num" id="4163494">3</span><span class="op" id="4163495">]</span><span class="op" id="4163496">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163499">if</span>&nbsp;<span class="builtintype" id="4163502">uint32</span><span class="op" id="4163508">(</span><span class="builtinfunc" id="4163509">len</span><span class="op" id="4163512">(</span><span class="ident" id="4163513">data</span><span class="op" id="4163517">)</span><span class="op" id="4163518">)</span><span class="op" id="4163519">-</span><span class="num" id="4163520">4</span>&nbsp;<span class="op" id="4163522">!=</span>&nbsp;<span class="ident" id="4163525">length</span>&nbsp;<span class="op" id="4163532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163536">return</span>&nbsp;<span class="builtintype" id="4163543">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163554">data</span>&nbsp;<span class="op" id="4163559">=</span>&nbsp;<span class="ident" id="4163561">data</span><span class="op" id="4163565">[</span><span class="num" id="4163566">4</span><span class="op" id="4163567">:</span><span class="op" id="4163568">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163571">if</span>&nbsp;<span class="ident" id="4163574">m</span><span class="op" id="4163575">.</span><span class="ident" id="4163576">hasSignatureAndHash</span>&nbsp;<span class="op" id="4163596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163600">m</span><span class="op" id="4163601">.</span><span class="ident" id="4163602">signatureAndHash</span><span class="op" id="4163618">.</span><span class="ident" id="4163619">hash</span>&nbsp;<span class="op" id="4163624">=</span>&nbsp;<span class="ident" id="4163626">data</span><span class="op" id="4163630">[</span><span class="num" id="4163631">0</span><span class="op" id="4163632">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163636">m</span><span class="op" id="4163637">.</span><span class="ident" id="4163638">signatureAndHash</span><span class="op" id="4163654">.</span><span class="ident" id="4163655">signature</span>&nbsp;<span class="op" id="4163665">=</span>&nbsp;<span class="ident" id="4163667">data</span><span class="op" id="4163671">[</span><span class="num" id="4163672">1</span><span class="op" id="4163673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163677">data</span>&nbsp;<span class="op" id="4163682">=</span>&nbsp;<span class="ident" id="4163684">data</span><span class="op" id="4163688">[</span><span class="num" id="4163689">2</span><span class="op" id="4163690">:</span><span class="op" id="4163691">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163694">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163698">if</span>&nbsp;<span class="builtinfunc" id="4163701">len</span><span class="op" id="4163704">(</span><span class="ident" id="4163705">data</span><span class="op" id="4163709">)</span>&nbsp;<span class="op" id="4163711">&lt;</span>&nbsp;<span class="num" id="4163713">2</span>&nbsp;<span class="op" id="4163715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163719">return</span>&nbsp;<span class="builtintype" id="4163726">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163736">siglength</span>&nbsp;<span class="op" id="4163746">:=</span>&nbsp;<span class="builtintype" id="4163749">int</span><span class="op" id="4163752">(</span><span class="ident" id="4163753">data</span><span class="op" id="4163757">[</span><span class="num" id="4163758">0</span><span class="op" id="4163759">]</span><span class="op" id="4163760">)</span><span class="op" id="4163761">&lt;&lt;</span><span class="num" id="4163763">8</span>&nbsp;<span class="op" id="4163765">+</span>&nbsp;<span class="builtintype" id="4163767">int</span><span class="op" id="4163770">(</span><span class="ident" id="4163771">data</span><span class="op" id="4163775">[</span><span class="num" id="4163776">1</span><span class="op" id="4163777">]</span><span class="op" id="4163778">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163781">data</span>&nbsp;<span class="op" id="4163786">=</span>&nbsp;<span class="ident" id="4163788">data</span><span class="op" id="4163792">[</span><span class="num" id="4163793">2</span><span class="op" id="4163794">:</span><span class="op" id="4163795">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163798">if</span>&nbsp;<span class="builtinfunc" id="4163801">len</span><span class="op" id="4163804">(</span><span class="ident" id="4163805">data</span><span class="op" id="4163809">)</span>&nbsp;<span class="op" id="4163811">!=</span>&nbsp;<span class="ident" id="4163814">siglength</span>&nbsp;<span class="op" id="4163824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163828">return</span>&nbsp;<span class="builtintype" id="4163835">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4163842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163846">m</span><span class="op" id="4163847">.</span><span class="ident" id="4163848">signature</span>&nbsp;<span class="op" id="4163858">=</span>&nbsp;<span class="ident" id="4163860">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4163867">return</span>&nbsp;<span class="builtintype" id="4163874">true</span><br>
<span class="lineno"></span><span class="op" id="4163879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="4163882">type</span>&nbsp;<span class="ident" id="4163887">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="4163907">struct</span>&nbsp;<span class="op" id="4163914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163917">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4163924">[</span><span class="op" id="4163925">]</span><span class="builtintype" id="4163926">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4163932">ticket</span>&nbsp;<span class="op" id="4163939">[</span><span class="op" id="4163940">]</span><span class="builtintype" id="4163941">byte</span><br>
<span class="lineno"></span><span class="op" id="4163946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="4163949">func</span>&nbsp;<span class="op" id="4163954">(</span><span class="ident" id="4163955">m</span>&nbsp;<span class="op" id="4163957">*</span><span class="ident" id="4163958">newSessionTicketMsg</span><span class="op" id="4163977">)</span>&nbsp;<span class="ident" id="4163979">equal</span><span class="op" id="4163984">(</span><span class="ident" id="4163985">i</span>&nbsp;<span class="keyword" id="4163987">interface</span><span class="op" id="4163996">{</span><span class="op" id="4163997">}</span><span class="op" id="4163998">)</span>&nbsp;<span class="builtintype" id="4164000">bool</span>&nbsp;<span class="op" id="4164005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164008">m1</span><span class="op" id="4164010">,</span>&nbsp;<span class="ident" id="4164012">ok</span>&nbsp;<span class="op" id="4164015">:=</span>&nbsp;<span class="ident" id="4164018">i</span><span class="op" id="4164019">.</span><span class="op" id="4164020">(</span><span class="op" id="4164021">*</span><span class="ident" id="4164022">newSessionTicketMsg</span><span class="op" id="4164041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164044">if</span>&nbsp;<span class="op" id="4164047">!</span><span class="ident" id="4164048">ok</span>&nbsp;<span class="op" id="4164051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164055">return</span>&nbsp;<span class="builtintype" id="4164062">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164069">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164073">return</span>&nbsp;<span class="ident" id="4164080">bytes</span><span class="op" id="4164085">.</span><span class="ident" id="4164086">Equal</span><span class="op" id="4164091">(</span><span class="ident" id="4164092">m</span><span class="op" id="4164093">.</span><span class="ident" id="4164094">raw</span><span class="op" id="4164097">,</span>&nbsp;<span class="ident" id="4164099">m1</span><span class="op" id="4164101">.</span><span class="ident" id="4164102">raw</span><span class="op" id="4164105">)</span>&nbsp;<span class="op" id="4164107">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164112">bytes</span><span class="op" id="4164117">.</span><span class="ident" id="4164118">Equal</span><span class="op" id="4164123">(</span><span class="ident" id="4164124">m</span><span class="op" id="4164125">.</span><span class="ident" id="4164126">ticket</span><span class="op" id="4164132">,</span>&nbsp;<span class="ident" id="4164134">m1</span><span class="op" id="4164136">.</span><span class="ident" id="4164137">ticket</span><span class="op" id="4164143">)</span><br>
<span class="lineno"></span><span class="op" id="4164145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="4164148">func</span>&nbsp;<span class="op" id="4164153">(</span><span class="ident" id="4164154">m</span>&nbsp;<span class="op" id="4164156">*</span><span class="ident" id="4164157">newSessionTicketMsg</span><span class="op" id="4164176">)</span>&nbsp;<span class="ident" id="4164178">marshal</span><span class="op" id="4164185">(</span><span class="op" id="4164186">)</span>&nbsp;<span class="op" id="4164188">(</span><span class="ident" id="4164189">x</span>&nbsp;<span class="op" id="4164191">[</span><span class="op" id="4164192">]</span><span class="builtintype" id="4164193">byte</span><span class="op" id="4164197">)</span>&nbsp;<span class="op" id="4164199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164202">if</span>&nbsp;<span class="ident" id="4164205">m</span><span class="op" id="4164206">.</span><span class="ident" id="4164207">raw</span>&nbsp;<span class="op" id="4164211">!=</span>&nbsp;<span class="ident" id="4164214">nil</span>&nbsp;<span class="op" id="4164218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164222">return</span>&nbsp;<span class="ident" id="4164229">m</span><span class="op" id="4164230">.</span><span class="ident" id="4164231">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4164240">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164295">ticketLen</span>&nbsp;<span class="op" id="4164305">:=</span>&nbsp;<span class="builtinfunc" id="4164308">len</span><span class="op" id="4164311">(</span><span class="ident" id="4164312">m</span><span class="op" id="4164313">.</span><span class="ident" id="4164314">ticket</span><span class="op" id="4164320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164323">length</span>&nbsp;<span class="op" id="4164330">:=</span>&nbsp;<span class="num" id="4164333">2</span>&nbsp;<span class="op" id="4164335">+</span>&nbsp;<span class="num" id="4164337">4</span>&nbsp;<span class="op" id="4164339">+</span>&nbsp;<span class="ident" id="4164341">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164352">x</span>&nbsp;<span class="op" id="4164354">=</span>&nbsp;<span class="builtinfunc" id="4164356">make</span><span class="op" id="4164360">(</span><span class="op" id="4164361">[</span><span class="op" id="4164362">]</span><span class="builtintype" id="4164363">byte</span><span class="op" id="4164367">,</span>&nbsp;<span class="num" id="4164369">4</span><span class="op" id="4164370">+</span><span class="ident" id="4164371">length</span><span class="op" id="4164377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164380">x</span><span class="op" id="4164381">[</span><span class="num" id="4164382">0</span><span class="op" id="4164383">]</span>&nbsp;<span class="op" id="4164385">=</span>&nbsp;<span class="ident" id="4164387">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164409">x</span><span class="op" id="4164410">[</span><span class="num" id="4164411">1</span><span class="op" id="4164412">]</span>&nbsp;<span class="op" id="4164414">=</span>&nbsp;<span class="builtintype" id="4164416">uint8</span><span class="op" id="4164421">(</span><span class="ident" id="4164422">length</span>&nbsp;<span class="op" id="4164429">&gt;&gt;</span>&nbsp;<span class="num" id="4164432">16</span><span class="op" id="4164434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164437">x</span><span class="op" id="4164438">[</span><span class="num" id="4164439">2</span><span class="op" id="4164440">]</span>&nbsp;<span class="op" id="4164442">=</span>&nbsp;<span class="builtintype" id="4164444">uint8</span><span class="op" id="4164449">(</span><span class="ident" id="4164450">length</span>&nbsp;<span class="op" id="4164457">&gt;&gt;</span>&nbsp;<span class="num" id="4164460">8</span><span class="op" id="4164461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164464">x</span><span class="op" id="4164465">[</span><span class="num" id="4164466">3</span><span class="op" id="4164467">]</span>&nbsp;<span class="op" id="4164469">=</span>&nbsp;<span class="builtintype" id="4164471">uint8</span><span class="op" id="4164476">(</span><span class="ident" id="4164477">length</span><span class="op" id="4164483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164486">x</span><span class="op" id="4164487">[</span><span class="num" id="4164488">8</span><span class="op" id="4164489">]</span>&nbsp;<span class="op" id="4164491">=</span>&nbsp;<span class="builtintype" id="4164493">uint8</span><span class="op" id="4164498">(</span><span class="ident" id="4164499">ticketLen</span>&nbsp;<span class="op" id="4164509">&gt;&gt;</span>&nbsp;<span class="num" id="4164512">8</span><span class="op" id="4164513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164516">x</span><span class="op" id="4164517">[</span><span class="num" id="4164518">9</span><span class="op" id="4164519">]</span>&nbsp;<span class="op" id="4164521">=</span>&nbsp;<span class="builtintype" id="4164523">uint8</span><span class="op" id="4164528">(</span><span class="ident" id="4164529">ticketLen</span><span class="op" id="4164538">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4164541">copy</span><span class="op" id="4164545">(</span><span class="ident" id="4164546">x</span><span class="op" id="4164547">[</span><span class="num" id="4164548">10</span><span class="op" id="4164550">:</span><span class="op" id="4164551">]</span><span class="op" id="4164552">,</span>&nbsp;<span class="ident" id="4164554">m</span><span class="op" id="4164555">.</span><span class="ident" id="4164556">ticket</span><span class="op" id="4164562">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164566">m</span><span class="op" id="4164567">.</span><span class="ident" id="4164568">raw</span>&nbsp;<span class="op" id="4164572">=</span>&nbsp;<span class="ident" id="4164574">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164578">return</span><br>
<span class="lineno">1355</span><span class="op" id="4164585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4164588">func</span>&nbsp;<span class="op" id="4164593">(</span><span class="ident" id="4164594">m</span>&nbsp;<span class="op" id="4164596">*</span><span class="ident" id="4164597">newSessionTicketMsg</span><span class="op" id="4164616">)</span>&nbsp;<span class="ident" id="4164618">unmarshal</span><span class="op" id="4164627">(</span><span class="ident" id="4164628">data</span>&nbsp;<span class="op" id="4164633">[</span><span class="op" id="4164634">]</span><span class="builtintype" id="4164635">byte</span><span class="op" id="4164639">)</span>&nbsp;<span class="builtintype" id="4164641">bool</span>&nbsp;<span class="op" id="4164646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164649">m</span><span class="op" id="4164650">.</span><span class="ident" id="4164651">raw</span>&nbsp;<span class="op" id="4164655">=</span>&nbsp;<span class="ident" id="4164657">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164664">if</span>&nbsp;<span class="builtinfunc" id="4164667">len</span><span class="op" id="4164670">(</span><span class="ident" id="4164671">data</span><span class="op" id="4164675">)</span>&nbsp;<span class="op" id="4164677">&lt;</span>&nbsp;<span class="num" id="4164679">10</span>&nbsp;<span class="op" id="4164682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164686">return</span>&nbsp;<span class="builtintype" id="4164693">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164700">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164704">length</span>&nbsp;<span class="op" id="4164711">:=</span>&nbsp;<span class="builtintype" id="4164714">uint32</span><span class="op" id="4164720">(</span><span class="ident" id="4164721">data</span><span class="op" id="4164725">[</span><span class="num" id="4164726">1</span><span class="op" id="4164727">]</span><span class="op" id="4164728">)</span><span class="op" id="4164729">&lt;&lt;</span><span class="num" id="4164731">16</span>&nbsp;<span class="op" id="4164734">|</span>&nbsp;<span class="builtintype" id="4164736">uint32</span><span class="op" id="4164742">(</span><span class="ident" id="4164743">data</span><span class="op" id="4164747">[</span><span class="num" id="4164748">2</span><span class="op" id="4164749">]</span><span class="op" id="4164750">)</span><span class="op" id="4164751">&lt;&lt;</span><span class="num" id="4164753">8</span>&nbsp;<span class="op" id="4164755">|</span>&nbsp;<span class="builtintype" id="4164757">uint32</span><span class="op" id="4164763">(</span><span class="ident" id="4164764">data</span><span class="op" id="4164768">[</span><span class="num" id="4164769">3</span><span class="op" id="4164770">]</span><span class="op" id="4164771">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164774">if</span>&nbsp;<span class="builtintype" id="4164777">uint32</span><span class="op" id="4164783">(</span><span class="builtinfunc" id="4164784">len</span><span class="op" id="4164787">(</span><span class="ident" id="4164788">data</span><span class="op" id="4164792">)</span><span class="op" id="4164793">)</span><span class="op" id="4164794">-</span><span class="num" id="4164795">4</span>&nbsp;<span class="op" id="4164797">!=</span>&nbsp;<span class="ident" id="4164800">length</span>&nbsp;<span class="op" id="4164807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164811">return</span>&nbsp;<span class="builtintype" id="4164818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164829">ticketLen</span>&nbsp;<span class="op" id="4164839">:=</span>&nbsp;<span class="builtintype" id="4164842">int</span><span class="op" id="4164845">(</span><span class="ident" id="4164846">data</span><span class="op" id="4164850">[</span><span class="num" id="4164851">8</span><span class="op" id="4164852">]</span><span class="op" id="4164853">)</span><span class="op" id="4164854">&lt;&lt;</span><span class="num" id="4164856">8</span>&nbsp;<span class="op" id="4164858">+</span>&nbsp;<span class="builtintype" id="4164860">int</span><span class="op" id="4164863">(</span><span class="ident" id="4164864">data</span><span class="op" id="4164868">[</span><span class="num" id="4164869">9</span><span class="op" id="4164870">]</span><span class="op" id="4164871">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164874">if</span>&nbsp;<span class="builtinfunc" id="4164877">len</span><span class="op" id="4164880">(</span><span class="ident" id="4164881">data</span><span class="op" id="4164885">)</span><span class="op" id="4164886">-</span><span class="num" id="4164887">10</span>&nbsp;<span class="op" id="4164890">!=</span>&nbsp;<span class="ident" id="4164893">ticketLen</span>&nbsp;<span class="op" id="4164903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164907">return</span>&nbsp;<span class="builtintype" id="4164914">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4164921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4164925">m</span><span class="op" id="4164926">.</span><span class="ident" id="4164927">ticket</span>&nbsp;<span class="op" id="4164934">=</span>&nbsp;<span class="ident" id="4164936">data</span><span class="op" id="4164940">[</span><span class="num" id="4164941">10</span><span class="op" id="4164943">:</span><span class="op" id="4164944">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4164948">return</span>&nbsp;<span class="builtintype" id="4164955">true</span><br>
<span class="lineno"></span><span class="op" id="4164960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4164963">func</span>&nbsp;<span class="ident" id="4164968">eqUint16s</span><span class="op" id="4164977">(</span><span class="ident" id="4164978">x</span><span class="op" id="4164979">,</span>&nbsp;<span class="ident" id="4164981">y</span>&nbsp;<span class="op" id="4164983">[</span><span class="op" id="4164984">]</span><span class="builtintype" id="4164985">uint16</span><span class="op" id="4164991">)</span>&nbsp;<span class="builtintype" id="4164993">bool</span>&nbsp;<span class="op" id="4164998">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165001">if</span>&nbsp;<span class="builtinfunc" id="4165004">len</span><span class="op" id="4165007">(</span><span class="ident" id="4165008">x</span><span class="op" id="4165009">)</span>&nbsp;<span class="op" id="4165011">!=</span>&nbsp;<span class="builtinfunc" id="4165014">len</span><span class="op" id="4165017">(</span><span class="ident" id="4165018">y</span><span class="op" id="4165019">)</span>&nbsp;<span class="op" id="4165021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165025">return</span>&nbsp;<span class="builtintype" id="4165032">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165042">for</span>&nbsp;<span class="ident" id="4165046">i</span><span class="op" id="4165047">,</span>&nbsp;<span class="ident" id="4165049">v</span>&nbsp;<span class="op" id="4165051">:=</span>&nbsp;<span class="keyword" id="4165054">range</span>&nbsp;<span class="ident" id="4165060">x</span>&nbsp;<span class="op" id="4165062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165066">if</span>&nbsp;<span class="ident" id="4165069">y</span><span class="op" id="4165070">[</span><span class="ident" id="4165071">i</span><span class="op" id="4165072">]</span>&nbsp;<span class="op" id="4165074">!=</span>&nbsp;<span class="ident" id="4165077">v</span>&nbsp;<span class="op" id="4165079">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165084">return</span>&nbsp;<span class="builtintype" id="4165091">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165105">return</span>&nbsp;<span class="builtintype" id="4165112">true</span><br>
<span class="lineno"></span><span class="op" id="4165117">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="4165120">func</span>&nbsp;<span class="ident" id="4165125">eqCurveIDs</span><span class="op" id="4165135">(</span><span class="ident" id="4165136">x</span><span class="op" id="4165137">,</span>&nbsp;<span class="ident" id="4165139">y</span>&nbsp;<span class="op" id="4165141">[</span><span class="op" id="4165142">]</span><span class="ident" id="4165143">CurveID</span><span class="op" id="4165150">)</span>&nbsp;<span class="builtintype" id="4165152">bool</span>&nbsp;<span class="op" id="4165157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165160">if</span>&nbsp;<span class="builtinfunc" id="4165163">len</span><span class="op" id="4165166">(</span><span class="ident" id="4165167">x</span><span class="op" id="4165168">)</span>&nbsp;<span class="op" id="4165170">!=</span>&nbsp;<span class="builtinfunc" id="4165173">len</span><span class="op" id="4165176">(</span><span class="ident" id="4165177">y</span><span class="op" id="4165178">)</span>&nbsp;<span class="op" id="4165180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165184">return</span>&nbsp;<span class="builtintype" id="4165191">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165198">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165201">for</span>&nbsp;<span class="ident" id="4165205">i</span><span class="op" id="4165206">,</span>&nbsp;<span class="ident" id="4165208">v</span>&nbsp;<span class="op" id="4165210">:=</span>&nbsp;<span class="keyword" id="4165213">range</span>&nbsp;<span class="ident" id="4165219">x</span>&nbsp;<span class="op" id="4165221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165225">if</span>&nbsp;<span class="ident" id="4165228">y</span><span class="op" id="4165229">[</span><span class="ident" id="4165230">i</span><span class="op" id="4165231">]</span>&nbsp;<span class="op" id="4165233">!=</span>&nbsp;<span class="ident" id="4165236">v</span>&nbsp;<span class="op" id="4165238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165243">return</span>&nbsp;<span class="builtintype" id="4165250">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165261">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165264">return</span>&nbsp;<span class="builtintype" id="4165271">true</span><br>
<span class="lineno"></span><span class="op" id="4165276">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4165279">func</span>&nbsp;<span class="ident" id="4165284">eqStrings</span><span class="op" id="4165293">(</span><span class="ident" id="4165294">x</span><span class="op" id="4165295">,</span>&nbsp;<span class="ident" id="4165297">y</span>&nbsp;<span class="op" id="4165299">[</span><span class="op" id="4165300">]</span><span class="builtintype" id="4165301">string</span><span class="op" id="4165307">)</span>&nbsp;<span class="builtintype" id="4165309">bool</span>&nbsp;<span class="op" id="4165314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165317">if</span>&nbsp;<span class="builtinfunc" id="4165320">len</span><span class="op" id="4165323">(</span><span class="ident" id="4165324">x</span><span class="op" id="4165325">)</span>&nbsp;<span class="op" id="4165327">!=</span>&nbsp;<span class="builtinfunc" id="4165330">len</span><span class="op" id="4165333">(</span><span class="ident" id="4165334">y</span><span class="op" id="4165335">)</span>&nbsp;<span class="op" id="4165337">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165341">return</span>&nbsp;<span class="builtintype" id="4165348">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165358">for</span>&nbsp;<span class="ident" id="4165362">i</span><span class="op" id="4165363">,</span>&nbsp;<span class="ident" id="4165365">v</span>&nbsp;<span class="op" id="4165367">:=</span>&nbsp;<span class="keyword" id="4165370">range</span>&nbsp;<span class="ident" id="4165376">x</span>&nbsp;<span class="op" id="4165378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165382">if</span>&nbsp;<span class="ident" id="4165385">y</span><span class="op" id="4165386">[</span><span class="ident" id="4165387">i</span><span class="op" id="4165388">]</span>&nbsp;<span class="op" id="4165390">!=</span>&nbsp;<span class="ident" id="4165393">v</span>&nbsp;<span class="op" id="4165395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165400">return</span>&nbsp;<span class="builtintype" id="4165407">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165421">return</span>&nbsp;<span class="builtintype" id="4165428">true</span><br>
<span class="lineno"></span><span class="op" id="4165433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="4165436">func</span>&nbsp;<span class="ident" id="4165441">eqByteSlices</span><span class="op" id="4165453">(</span><span class="ident" id="4165454">x</span><span class="op" id="4165455">,</span>&nbsp;<span class="ident" id="4165457">y</span>&nbsp;<span class="op" id="4165459">[</span><span class="op" id="4165460">]</span><span class="op" id="4165461">[</span><span class="op" id="4165462">]</span><span class="builtintype" id="4165463">byte</span><span class="op" id="4165467">)</span>&nbsp;<span class="builtintype" id="4165469">bool</span>&nbsp;<span class="op" id="4165474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165477">if</span>&nbsp;<span class="builtinfunc" id="4165480">len</span><span class="op" id="4165483">(</span><span class="ident" id="4165484">x</span><span class="op" id="4165485">)</span>&nbsp;<span class="op" id="4165487">!=</span>&nbsp;<span class="builtinfunc" id="4165490">len</span><span class="op" id="4165493">(</span><span class="ident" id="4165494">y</span><span class="op" id="4165495">)</span>&nbsp;<span class="op" id="4165497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165501">return</span>&nbsp;<span class="builtintype" id="4165508">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165518">for</span>&nbsp;<span class="ident" id="4165522">i</span><span class="op" id="4165523">,</span>&nbsp;<span class="ident" id="4165525">v</span>&nbsp;<span class="op" id="4165527">:=</span>&nbsp;<span class="keyword" id="4165530">range</span>&nbsp;<span class="ident" id="4165536">x</span>&nbsp;<span class="op" id="4165538">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165542">if</span>&nbsp;<span class="op" id="4165545">!</span><span class="ident" id="4165546">bytes</span><span class="op" id="4165551">.</span><span class="ident" id="4165552">Equal</span><span class="op" id="4165557">(</span><span class="ident" id="4165558">v</span><span class="op" id="4165559">,</span>&nbsp;<span class="ident" id="4165561">y</span><span class="op" id="4165562">[</span><span class="ident" id="4165563">i</span><span class="op" id="4165564">]</span><span class="op" id="4165565">)</span>&nbsp;<span class="op" id="4165567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165572">return</span>&nbsp;<span class="builtintype" id="4165579">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165593">return</span>&nbsp;<span class="builtintype" id="4165600">true</span><br>
<span class="lineno">1425</span><span class="op" id="4165605">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4165608">func</span>&nbsp;<span class="ident" id="4165613">eqSignatureAndHashes</span><span class="op" id="4165633">(</span><span class="ident" id="4165634">x</span><span class="op" id="4165635">,</span>&nbsp;<span class="ident" id="4165637">y</span>&nbsp;<span class="op" id="4165639">[</span><span class="op" id="4165640">]</span><span class="ident" id="4165641">signatureAndHash</span><span class="op" id="4165657">)</span>&nbsp;<span class="builtintype" id="4165659">bool</span>&nbsp;<span class="op" id="4165664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165667">if</span>&nbsp;<span class="builtinfunc" id="4165670">len</span><span class="op" id="4165673">(</span><span class="ident" id="4165674">x</span><span class="op" id="4165675">)</span>&nbsp;<span class="op" id="4165677">!=</span>&nbsp;<span class="builtinfunc" id="4165680">len</span><span class="op" id="4165683">(</span><span class="ident" id="4165684">y</span><span class="op" id="4165685">)</span>&nbsp;<span class="op" id="4165687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165691">return</span>&nbsp;<span class="builtintype" id="4165698">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165708">for</span>&nbsp;<span class="ident" id="4165712">i</span><span class="op" id="4165713">,</span>&nbsp;<span class="ident" id="4165715">v</span>&nbsp;<span class="op" id="4165717">:=</span>&nbsp;<span class="keyword" id="4165720">range</span>&nbsp;<span class="ident" id="4165726">x</span>&nbsp;<span class="op" id="4165728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4165732">v2</span>&nbsp;<span class="op" id="4165735">:=</span>&nbsp;<span class="ident" id="4165738">y</span><span class="op" id="4165739">[</span><span class="ident" id="4165740">i</span><span class="op" id="4165741">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165745">if</span>&nbsp;<span class="ident" id="4165748">v</span><span class="op" id="4165749">.</span><span class="ident" id="4165750">hash</span>&nbsp;<span class="op" id="4165755">!=</span>&nbsp;<span class="ident" id="4165758">v2</span><span class="op" id="4165760">.</span><span class="ident" id="4165761">hash</span>&nbsp;<span class="op" id="4165766">||</span>&nbsp;<span class="ident" id="4165769">v</span><span class="op" id="4165770">.</span><span class="ident" id="4165771">signature</span>&nbsp;<span class="op" id="4165781">!=</span>&nbsp;<span class="ident" id="4165784">v2</span><span class="op" id="4165786">.</span><span class="ident" id="4165787">signature</span>&nbsp;<span class="op" id="4165797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165802">return</span>&nbsp;<span class="builtintype" id="4165809">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165817">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4165820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4165823">return</span>&nbsp;<span class="builtintype" id="4165830">true</span><br>
<span class="lineno"></span><span class="op" id="4165835">}</span>
</div>
</body>
</html>
