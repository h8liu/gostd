<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7119359">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7119414">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7119468">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7119519">package</span>&nbsp;<span class="ident" id="7119527">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7119533">import</span>&nbsp;<span class="op" id="7119540">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119543">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119552">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119566">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119582">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119601">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119616">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7119630">_</span>&nbsp;<span class="string" id="7119632">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7119649">_</span>&nbsp;<span class="string" id="7119651">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119668">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119688">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119705">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119724">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119740">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119756">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119768">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119775">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119786">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119797">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119808">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7119819">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7119826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7119829">func</span>&nbsp;<span class="ident" id="7119834">TestParsePKCS1PrivateKey</span><span class="op" id="7119858">(</span><span class="ident" id="7119859">t</span>&nbsp;<span class="op" id="7119861">*</span><span class="ident" id="7119862">testing</span><span class="op" id="7119869">.</span><span class="ident" id="7119870">T</span><span class="op" id="7119871">)</span>&nbsp;<span class="op" id="7119873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7119876">block</span><span class="op" id="7119881">,</span>&nbsp;<span class="ident" id="7119883">_</span>&nbsp;<span class="op" id="7119885">:=</span>&nbsp;<span class="ident" id="7119888">pem</span><span class="op" id="7119891">.</span><span class="ident" id="7119892">Decode</span><span class="op" id="7119898">(</span><span class="op" id="7119899">[</span><span class="op" id="7119900">]</span><span class="builtintype" id="7119901">byte</span><span class="op" id="7119905">(</span><span class="ident" id="7119906">pemPrivateKey</span><span class="op" id="7119919">)</span><span class="op" id="7119920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7119923">priv</span><span class="op" id="7119927">,</span>&nbsp;<span class="ident" id="7119929">err</span>&nbsp;<span class="op" id="7119933">:=</span>&nbsp;<span class="ident" id="7119936">ParsePKCS1PrivateKey</span><span class="op" id="7119956">(</span><span class="ident" id="7119957">block</span><span class="op" id="7119962">.</span><span class="ident" id="7119963">Bytes</span><span class="op" id="7119968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7119971">if</span>&nbsp;<span class="ident" id="7119974">err</span>&nbsp;<span class="op" id="7119978">!=</span>&nbsp;<span class="ident" id="7119981">nil</span>&nbsp;<span class="op" id="7119985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7119989">t</span><span class="op" id="7119990">.</span><span class="ident" id="7119991">Errorf</span><span class="op" id="7119997">(</span><span class="string" id="7119998">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7120031">,</span>&nbsp;<span class="ident" id="7120033">err</span><span class="op" id="7120036">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120040">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7120048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120051">if</span>&nbsp;<span class="ident" id="7120054">priv</span><span class="op" id="7120058">.</span><span class="ident" id="7120059">PublicKey</span><span class="op" id="7120068">.</span><span class="ident" id="7120069">N</span><span class="op" id="7120070">.</span><span class="ident" id="7120071">Cmp</span><span class="op" id="7120074">(</span><span class="ident" id="7120075">rsaPrivateKey</span><span class="op" id="7120088">.</span><span class="ident" id="7120089">PublicKey</span><span class="op" id="7120098">.</span><span class="ident" id="7120099">N</span><span class="op" id="7120100">)</span>&nbsp;<span class="op" id="7120102">!=</span>&nbsp;<span class="num" id="7120105">0</span>&nbsp;<span class="op" id="7120107">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120112">priv</span><span class="op" id="7120116">.</span><span class="ident" id="7120117">PublicKey</span><span class="op" id="7120126">.</span><span class="ident" id="7120127">E</span>&nbsp;<span class="op" id="7120129">!=</span>&nbsp;<span class="ident" id="7120132">rsaPrivateKey</span><span class="op" id="7120145">.</span><span class="ident" id="7120146">PublicKey</span><span class="op" id="7120155">.</span><span class="ident" id="7120156">E</span>&nbsp;<span class="op" id="7120158">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120163">priv</span><span class="op" id="7120167">.</span><span class="ident" id="7120168">D</span><span class="op" id="7120169">.</span><span class="ident" id="7120170">Cmp</span><span class="op" id="7120173">(</span><span class="ident" id="7120174">rsaPrivateKey</span><span class="op" id="7120187">.</span><span class="ident" id="7120188">D</span><span class="op" id="7120189">)</span>&nbsp;<span class="op" id="7120191">!=</span>&nbsp;<span class="num" id="7120194">0</span>&nbsp;<span class="op" id="7120196">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120201">priv</span><span class="op" id="7120205">.</span><span class="ident" id="7120206">Primes</span><span class="op" id="7120212">[</span><span class="num" id="7120213">0</span><span class="op" id="7120214">]</span><span class="op" id="7120215">.</span><span class="ident" id="7120216">Cmp</span><span class="op" id="7120219">(</span><span class="ident" id="7120220">rsaPrivateKey</span><span class="op" id="7120233">.</span><span class="ident" id="7120234">Primes</span><span class="op" id="7120240">[</span><span class="num" id="7120241">0</span><span class="op" id="7120242">]</span><span class="op" id="7120243">)</span>&nbsp;<span class="op" id="7120245">!=</span>&nbsp;<span class="num" id="7120248">0</span>&nbsp;<span class="op" id="7120250">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120255">priv</span><span class="op" id="7120259">.</span><span class="ident" id="7120260">Primes</span><span class="op" id="7120266">[</span><span class="num" id="7120267">1</span><span class="op" id="7120268">]</span><span class="op" id="7120269">.</span><span class="ident" id="7120270">Cmp</span><span class="op" id="7120273">(</span><span class="ident" id="7120274">rsaPrivateKey</span><span class="op" id="7120287">.</span><span class="ident" id="7120288">Primes</span><span class="op" id="7120294">[</span><span class="num" id="7120295">1</span><span class="op" id="7120296">]</span><span class="op" id="7120297">)</span>&nbsp;<span class="op" id="7120299">!=</span>&nbsp;<span class="num" id="7120302">0</span>&nbsp;<span class="op" id="7120304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120308">t</span><span class="op" id="7120309">.</span><span class="ident" id="7120310">Errorf</span><span class="op" id="7120316">(</span><span class="string" id="7120317">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7120335">,</span>&nbsp;<span class="ident" id="7120337">priv</span><span class="op" id="7120341">,</span>&nbsp;<span class="ident" id="7120343">rsaPrivateKey</span><span class="op" id="7120356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7120359">}</span><br>
<span class="lineno"></span><span class="op" id="7120361">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7120364">func</span>&nbsp;<span class="ident" id="7120369">TestParsePKIXPublicKey</span><span class="op" id="7120391">(</span><span class="ident" id="7120392">t</span>&nbsp;<span class="op" id="7120394">*</span><span class="ident" id="7120395">testing</span><span class="op" id="7120402">.</span><span class="ident" id="7120403">T</span><span class="op" id="7120404">)</span>&nbsp;<span class="op" id="7120406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120409">block</span><span class="op" id="7120414">,</span>&nbsp;<span class="ident" id="7120416">_</span>&nbsp;<span class="op" id="7120418">:=</span>&nbsp;<span class="ident" id="7120421">pem</span><span class="op" id="7120424">.</span><span class="ident" id="7120425">Decode</span><span class="op" id="7120431">(</span><span class="op" id="7120432">[</span><span class="op" id="7120433">]</span><span class="builtintype" id="7120434">byte</span><span class="op" id="7120438">(</span><span class="ident" id="7120439">pemPublicKey</span><span class="op" id="7120451">)</span><span class="op" id="7120452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120455">pub</span><span class="op" id="7120458">,</span>&nbsp;<span class="ident" id="7120460">err</span>&nbsp;<span class="op" id="7120464">:=</span>&nbsp;<span class="ident" id="7120467">ParsePKIXPublicKey</span><span class="op" id="7120485">(</span><span class="ident" id="7120486">block</span><span class="op" id="7120491">.</span><span class="ident" id="7120492">Bytes</span><span class="op" id="7120497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120500">if</span>&nbsp;<span class="ident" id="7120503">err</span>&nbsp;<span class="op" id="7120507">!=</span>&nbsp;<span class="ident" id="7120510">nil</span>&nbsp;<span class="op" id="7120514">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120518">t</span><span class="op" id="7120519">.</span><span class="ident" id="7120520">Errorf</span><span class="op" id="7120526">(</span><span class="string" id="7120527">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7120563">,</span>&nbsp;<span class="ident" id="7120565">err</span><span class="op" id="7120568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120572">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7120580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120583">rsaPub</span><span class="op" id="7120589">,</span>&nbsp;<span class="ident" id="7120591">ok</span>&nbsp;<span class="op" id="7120594">:=</span>&nbsp;<span class="ident" id="7120597">pub</span><span class="op" id="7120600">.</span><span class="op" id="7120601">(</span><span class="op" id="7120602">*</span><span class="ident" id="7120603">rsa</span><span class="op" id="7120606">.</span><span class="ident" id="7120607">PublicKey</span><span class="op" id="7120616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120619">if</span>&nbsp;<span class="op" id="7120622">!</span><span class="ident" id="7120623">ok</span>&nbsp;<span class="op" id="7120626">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120630">t</span><span class="op" id="7120631">.</span><span class="ident" id="7120632">Errorf</span><span class="op" id="7120638">(</span><span class="string" id="7120639">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7120705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120709">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7120717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120721">pubBytes2</span><span class="op" id="7120730">,</span>&nbsp;<span class="ident" id="7120732">err</span>&nbsp;<span class="op" id="7120736">:=</span>&nbsp;<span class="ident" id="7120739">MarshalPKIXPublicKey</span><span class="op" id="7120759">(</span><span class="ident" id="7120760">rsaPub</span><span class="op" id="7120766">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120769">if</span>&nbsp;<span class="ident" id="7120772">err</span>&nbsp;<span class="op" id="7120776">!=</span>&nbsp;<span class="ident" id="7120779">nil</span>&nbsp;<span class="op" id="7120783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120787">t</span><span class="op" id="7120788">.</span><span class="ident" id="7120789">Errorf</span><span class="op" id="7120795">(</span><span class="string" id="7120796">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7120854">,</span>&nbsp;<span class="ident" id="7120856">err</span><span class="op" id="7120859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120863">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7120871">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7120874">if</span>&nbsp;<span class="op" id="7120877">!</span><span class="ident" id="7120878">bytes</span><span class="op" id="7120883">.</span><span class="ident" id="7120884">Equal</span><span class="op" id="7120889">(</span><span class="ident" id="7120890">pubBytes2</span><span class="op" id="7120899">,</span>&nbsp;<span class="ident" id="7120901">block</span><span class="op" id="7120906">.</span><span class="ident" id="7120907">Bytes</span><span class="op" id="7120912">)</span>&nbsp;<span class="op" id="7120914">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7120918">t</span><span class="op" id="7120919">.</span><span class="ident" id="7120920">Errorf</span><span class="op" id="7120926">(</span><span class="string" id="7120927">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7120988">,</span>&nbsp;<span class="ident" id="7120990">pubBytes2</span><span class="op" id="7120999">,</span>&nbsp;<span class="ident" id="7121001">block</span><span class="op" id="7121006">.</span><span class="ident" id="7121007">Bytes</span><span class="op" id="7121012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7121015">}</span><br>
<span class="lineno"></span><span class="op" id="7121017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7121020">var</span>&nbsp;<span class="ident" id="7121024">pemPublicKey</span>&nbsp;<span class="op" id="7121037">=</span>&nbsp;<span class="string" id="7121039">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7121494">var</span>&nbsp;<span class="ident" id="7121498">pemPrivateKey</span>&nbsp;<span class="op" id="7121512">=</span>&nbsp;<span class="string" id="7121514">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7122011">func</span>&nbsp;<span class="ident" id="7122016">bigFromString</span><span class="op" id="7122029">(</span><span class="ident" id="7122030">s</span>&nbsp;<span class="builtintype" id="7122032">string</span><span class="op" id="7122038">)</span>&nbsp;<span class="op" id="7122040">*</span><span class="ident" id="7122041">big</span><span class="op" id="7122044">.</span><span class="ident" id="7122045">Int</span>&nbsp;<span class="op" id="7122049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122052">ret</span>&nbsp;<span class="op" id="7122056">:=</span>&nbsp;<span class="builtinfunc" id="7122059">new</span><span class="op" id="7122062">(</span><span class="ident" id="7122063">big</span><span class="op" id="7122066">.</span><span class="ident" id="7122067">Int</span><span class="op" id="7122070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122073">ret</span><span class="op" id="7122076">.</span><span class="ident" id="7122077">SetString</span><span class="op" id="7122086">(</span><span class="ident" id="7122087">s</span><span class="op" id="7122088">,</span>&nbsp;<span class="num" id="7122090">10</span><span class="op" id="7122092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122095">return</span>&nbsp;<span class="ident" id="7122102">ret</span><br>
<span class="lineno">95</span><span class="op" id="7122106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122109">func</span>&nbsp;<span class="ident" id="7122114">fromBase10</span><span class="op" id="7122124">(</span><span class="ident" id="7122125">base10</span>&nbsp;<span class="builtintype" id="7122132">string</span><span class="op" id="7122138">)</span>&nbsp;<span class="op" id="7122140">*</span><span class="ident" id="7122141">big</span><span class="op" id="7122144">.</span><span class="ident" id="7122145">Int</span>&nbsp;<span class="op" id="7122149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122152">i</span>&nbsp;<span class="op" id="7122154">:=</span>&nbsp;<span class="builtinfunc" id="7122157">new</span><span class="op" id="7122160">(</span><span class="ident" id="7122161">big</span><span class="op" id="7122164">.</span><span class="ident" id="7122165">Int</span><span class="op" id="7122168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122171">i</span><span class="op" id="7122172">.</span><span class="ident" id="7122173">SetString</span><span class="op" id="7122182">(</span><span class="ident" id="7122183">base10</span><span class="op" id="7122189">,</span>&nbsp;<span class="num" id="7122191">10</span><span class="op" id="7122193">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122196">return</span>&nbsp;<span class="ident" id="7122203">i</span><br>
<span class="lineno"></span><span class="op" id="7122205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122208">func</span>&nbsp;<span class="ident" id="7122213">bigFromHexString</span><span class="op" id="7122229">(</span><span class="ident" id="7122230">s</span>&nbsp;<span class="builtintype" id="7122232">string</span><span class="op" id="7122238">)</span>&nbsp;<span class="op" id="7122240">*</span><span class="ident" id="7122241">big</span><span class="op" id="7122244">.</span><span class="ident" id="7122245">Int</span>&nbsp;<span class="op" id="7122249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122252">ret</span>&nbsp;<span class="op" id="7122256">:=</span>&nbsp;<span class="builtinfunc" id="7122259">new</span><span class="op" id="7122262">(</span><span class="ident" id="7122263">big</span><span class="op" id="7122266">.</span><span class="ident" id="7122267">Int</span><span class="op" id="7122270">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122273">ret</span><span class="op" id="7122276">.</span><span class="ident" id="7122277">SetString</span><span class="op" id="7122286">(</span><span class="ident" id="7122287">s</span><span class="op" id="7122288">,</span>&nbsp;<span class="num" id="7122290">16</span><span class="op" id="7122292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7122295">return</span>&nbsp;<span class="ident" id="7122302">ret</span><br>
<span class="lineno"></span><span class="op" id="7122306">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7122309">var</span>&nbsp;<span class="ident" id="7122313">rsaPrivateKey</span>&nbsp;<span class="op" id="7122327">=</span>&nbsp;<span class="op" id="7122329">&amp;</span><span class="ident" id="7122330">rsa</span><span class="op" id="7122333">.</span><span class="ident" id="7122334">PrivateKey</span><span class="op" id="7122344">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122347">PublicKey</span><span class="op" id="7122356">:</span>&nbsp;<span class="ident" id="7122358">rsa</span><span class="op" id="7122361">.</span><span class="ident" id="7122362">PublicKey</span><span class="op" id="7122371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122375">N</span><span class="op" id="7122376">:</span>&nbsp;<span class="ident" id="7122378">bigFromString</span><span class="op" id="7122391">(</span><span class="string" id="7122392">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7122548">)</span><span class="op" id="7122549">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122553">E</span><span class="op" id="7122554">:</span>&nbsp;<span class="num" id="7122556">65537</span><span class="op" id="7122561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122564">}</span><span class="op" id="7122565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122568">D</span><span class="op" id="7122569">:</span>&nbsp;<span class="ident" id="7122571">bigFromString</span><span class="op" id="7122584">(</span><span class="string" id="7122585">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7122741">)</span><span class="op" id="7122742">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122745">Primes</span><span class="op" id="7122751">:</span>&nbsp;<span class="op" id="7122753">[</span><span class="op" id="7122754">]</span><span class="op" id="7122755">*</span><span class="ident" id="7122756">big</span><span class="op" id="7122759">.</span><span class="ident" id="7122760">Int</span><span class="op" id="7122763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122767">bigFromString</span><span class="op" id="7122780">(</span><span class="string" id="7122781">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7122860">)</span><span class="op" id="7122861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7122865">bigFromString</span><span class="op" id="7122878">(</span><span class="string" id="7122879">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7122958">)</span><span class="op" id="7122959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7122962">}</span><span class="op" id="7122963">,</span><br>
<span class="lineno"></span><span class="op" id="7122965">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7122968">func</span>&nbsp;<span class="ident" id="7122973">TestMarshalRSAPrivateKey</span><span class="op" id="7122997">(</span><span class="ident" id="7122998">t</span>&nbsp;<span class="op" id="7123000">*</span><span class="ident" id="7123001">testing</span><span class="op" id="7123008">.</span><span class="ident" id="7123009">T</span><span class="op" id="7123010">)</span>&nbsp;<span class="op" id="7123012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123015">priv</span>&nbsp;<span class="op" id="7123020">:=</span>&nbsp;<span class="op" id="7123023">&amp;</span><span class="ident" id="7123024">rsa</span><span class="op" id="7123027">.</span><span class="ident" id="7123028">PrivateKey</span><span class="op" id="7123038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123042">PublicKey</span><span class="op" id="7123051">:</span>&nbsp;<span class="ident" id="7123053">rsa</span><span class="op" id="7123056">.</span><span class="ident" id="7123057">PublicKey</span><span class="op" id="7123066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123071">N</span><span class="op" id="7123072">:</span>&nbsp;<span class="ident" id="7123074">fromBase10</span><span class="op" id="7123084">(</span><span class="string" id="7123085">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7123704">)</span><span class="op" id="7123705">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123710">E</span><span class="op" id="7123711">:</span>&nbsp;<span class="num" id="7123713">3</span><span class="op" id="7123714">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7123718">}</span><span class="op" id="7123719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7123723">D</span><span class="op" id="7123724">:</span>&nbsp;<span class="ident" id="7123726">fromBase10</span><span class="op" id="7123736">(</span><span class="string" id="7123737">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7124356">)</span><span class="op" id="7124357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124361">Primes</span><span class="op" id="7124367">:</span>&nbsp;<span class="op" id="7124369">[</span><span class="op" id="7124370">]</span><span class="op" id="7124371">*</span><span class="ident" id="7124372">big</span><span class="op" id="7124375">.</span><span class="ident" id="7124376">Int</span><span class="op" id="7124379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124384">fromBase10</span><span class="op" id="7124394">(</span><span class="string" id="7124395">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7124605">)</span><span class="op" id="7124606">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124611">fromBase10</span><span class="op" id="7124621">(</span><span class="string" id="7124622">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7124829">)</span><span class="op" id="7124830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7124835">fromBase10</span><span class="op" id="7124845">(</span><span class="string" id="7124846">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7125053">)</span><span class="op" id="7125054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125058">}</span><span class="op" id="7125059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125066">derBytes</span>&nbsp;<span class="op" id="7125075">:=</span>&nbsp;<span class="ident" id="7125078">MarshalPKCS1PrivateKey</span><span class="op" id="7125100">(</span><span class="ident" id="7125101">priv</span><span class="op" id="7125105">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125109">priv2</span><span class="op" id="7125114">,</span>&nbsp;<span class="ident" id="7125116">err</span>&nbsp;<span class="op" id="7125120">:=</span>&nbsp;<span class="ident" id="7125123">ParsePKCS1PrivateKey</span><span class="op" id="7125143">(</span><span class="ident" id="7125144">derBytes</span><span class="op" id="7125152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125155">if</span>&nbsp;<span class="ident" id="7125158">err</span>&nbsp;<span class="op" id="7125162">!=</span>&nbsp;<span class="ident" id="7125165">nil</span>&nbsp;<span class="op" id="7125169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125173">t</span><span class="op" id="7125174">.</span><span class="ident" id="7125175">Errorf</span><span class="op" id="7125181">(</span><span class="string" id="7125182">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7125216">,</span>&nbsp;<span class="ident" id="7125218">err</span><span class="op" id="7125221">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125225">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7125236">if</span>&nbsp;<span class="ident" id="7125239">priv</span><span class="op" id="7125243">.</span><span class="ident" id="7125244">PublicKey</span><span class="op" id="7125253">.</span><span class="ident" id="7125254">N</span><span class="op" id="7125255">.</span><span class="ident" id="7125256">Cmp</span><span class="op" id="7125259">(</span><span class="ident" id="7125260">priv2</span><span class="op" id="7125265">.</span><span class="ident" id="7125266">PublicKey</span><span class="op" id="7125275">.</span><span class="ident" id="7125276">N</span><span class="op" id="7125277">)</span>&nbsp;<span class="op" id="7125279">!=</span>&nbsp;<span class="num" id="7125282">0</span>&nbsp;<span class="op" id="7125284">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125289">priv</span><span class="op" id="7125293">.</span><span class="ident" id="7125294">PublicKey</span><span class="op" id="7125303">.</span><span class="ident" id="7125304">E</span>&nbsp;<span class="op" id="7125306">!=</span>&nbsp;<span class="ident" id="7125309">priv2</span><span class="op" id="7125314">.</span><span class="ident" id="7125315">PublicKey</span><span class="op" id="7125324">.</span><span class="ident" id="7125325">E</span>&nbsp;<span class="op" id="7125327">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125332">priv</span><span class="op" id="7125336">.</span><span class="ident" id="7125337">D</span><span class="op" id="7125338">.</span><span class="ident" id="7125339">Cmp</span><span class="op" id="7125342">(</span><span class="ident" id="7125343">priv2</span><span class="op" id="7125348">.</span><span class="ident" id="7125349">D</span><span class="op" id="7125350">)</span>&nbsp;<span class="op" id="7125352">!=</span>&nbsp;<span class="num" id="7125355">0</span>&nbsp;<span class="op" id="7125357">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7125362">len</span><span class="op" id="7125365">(</span><span class="ident" id="7125366">priv2</span><span class="op" id="7125371">.</span><span class="ident" id="7125372">Primes</span><span class="op" id="7125378">)</span>&nbsp;<span class="op" id="7125380">!=</span>&nbsp;<span class="num" id="7125383">3</span>&nbsp;<span class="op" id="7125385">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125390">priv</span><span class="op" id="7125394">.</span><span class="ident" id="7125395">Primes</span><span class="op" id="7125401">[</span><span class="num" id="7125402">0</span><span class="op" id="7125403">]</span><span class="op" id="7125404">.</span><span class="ident" id="7125405">Cmp</span><span class="op" id="7125408">(</span><span class="ident" id="7125409">priv2</span><span class="op" id="7125414">.</span><span class="ident" id="7125415">Primes</span><span class="op" id="7125421">[</span><span class="num" id="7125422">0</span><span class="op" id="7125423">]</span><span class="op" id="7125424">)</span>&nbsp;<span class="op" id="7125426">!=</span>&nbsp;<span class="num" id="7125429">0</span>&nbsp;<span class="op" id="7125431">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125436">priv</span><span class="op" id="7125440">.</span><span class="ident" id="7125441">Primes</span><span class="op" id="7125447">[</span><span class="num" id="7125448">1</span><span class="op" id="7125449">]</span><span class="op" id="7125450">.</span><span class="ident" id="7125451">Cmp</span><span class="op" id="7125454">(</span><span class="ident" id="7125455">priv2</span><span class="op" id="7125460">.</span><span class="ident" id="7125461">Primes</span><span class="op" id="7125467">[</span><span class="num" id="7125468">1</span><span class="op" id="7125469">]</span><span class="op" id="7125470">)</span>&nbsp;<span class="op" id="7125472">!=</span>&nbsp;<span class="num" id="7125475">0</span>&nbsp;<span class="op" id="7125477">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125482">priv</span><span class="op" id="7125486">.</span><span class="ident" id="7125487">Primes</span><span class="op" id="7125493">[</span><span class="num" id="7125494">2</span><span class="op" id="7125495">]</span><span class="op" id="7125496">.</span><span class="ident" id="7125497">Cmp</span><span class="op" id="7125500">(</span><span class="ident" id="7125501">priv2</span><span class="op" id="7125506">.</span><span class="ident" id="7125507">Primes</span><span class="op" id="7125513">[</span><span class="num" id="7125514">2</span><span class="op" id="7125515">]</span><span class="op" id="7125516">)</span>&nbsp;<span class="op" id="7125518">!=</span>&nbsp;<span class="num" id="7125521">0</span>&nbsp;<span class="op" id="7125523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125527">t</span><span class="op" id="7125528">.</span><span class="ident" id="7125529">Errorf</span><span class="op" id="7125535">(</span><span class="string" id="7125536">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7125554">,</span>&nbsp;<span class="ident" id="7125556">priv</span><span class="op" id="7125560">,</span>&nbsp;<span class="ident" id="7125562">priv2</span><span class="op" id="7125567">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125570">}</span><br>
<span class="lineno"></span><span class="op" id="7125572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7125575">type</span>&nbsp;<span class="ident" id="7125580">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7125599">struct</span>&nbsp;<span class="op" id="7125606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125609">pattern</span><span class="op" id="7125616">,</span>&nbsp;<span class="ident" id="7125618">host</span>&nbsp;<span class="builtintype" id="7125623">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7125631">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7125645">bool</span><br>
<span class="lineno"></span><span class="op" id="7125650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7125653">var</span>&nbsp;<span class="ident" id="7125657">matchHostnamesTests</span>&nbsp;<span class="op" id="7125677">=</span>&nbsp;<span class="op" id="7125679">[</span><span class="op" id="7125680">]</span><span class="ident" id="7125681">matchHostnamesTest</span><span class="op" id="7125699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125702">{</span><span class="string" id="7125703">&#34;a.b.c&#34;</span><span class="op" id="7125710">,</span>&nbsp;<span class="string" id="7125712">&#34;a.b.c&#34;</span><span class="op" id="7125719">,</span>&nbsp;<span class="builtintype" id="7125721">true</span><span class="op" id="7125725">}</span><span class="op" id="7125726">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125729">{</span><span class="string" id="7125730">&#34;a.b.c&#34;</span><span class="op" id="7125737">,</span>&nbsp;<span class="string" id="7125739">&#34;b.b.c&#34;</span><span class="op" id="7125746">,</span>&nbsp;<span class="builtintype" id="7125748">false</span><span class="op" id="7125753">}</span><span class="op" id="7125754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125757">{</span><span class="string" id="7125758">&#34;&#34;</span><span class="op" id="7125760">,</span>&nbsp;<span class="string" id="7125762">&#34;b.b.c&#34;</span><span class="op" id="7125769">,</span>&nbsp;<span class="builtintype" id="7125771">false</span><span class="op" id="7125776">}</span><span class="op" id="7125777">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125780">{</span><span class="string" id="7125781">&#34;a.b.c&#34;</span><span class="op" id="7125788">,</span>&nbsp;<span class="string" id="7125790">&#34;&#34;</span><span class="op" id="7125792">,</span>&nbsp;<span class="builtintype" id="7125794">false</span><span class="op" id="7125799">}</span><span class="op" id="7125800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125803">{</span><span class="string" id="7125804">&#34;example.com&#34;</span><span class="op" id="7125817">,</span>&nbsp;<span class="string" id="7125819">&#34;example.com&#34;</span><span class="op" id="7125832">,</span>&nbsp;<span class="builtintype" id="7125834">true</span><span class="op" id="7125838">}</span><span class="op" id="7125839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125842">{</span><span class="string" id="7125843">&#34;example.com&#34;</span><span class="op" id="7125856">,</span>&nbsp;<span class="string" id="7125858">&#34;www.example.com&#34;</span><span class="op" id="7125875">,</span>&nbsp;<span class="builtintype" id="7125877">false</span><span class="op" id="7125882">}</span><span class="op" id="7125883">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125886">{</span><span class="string" id="7125887">&#34;*.example.com&#34;</span><span class="op" id="7125902">,</span>&nbsp;<span class="string" id="7125904">&#34;www.example.com&#34;</span><span class="op" id="7125921">,</span>&nbsp;<span class="builtintype" id="7125923">true</span><span class="op" id="7125927">}</span><span class="op" id="7125928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125931">{</span><span class="string" id="7125932">&#34;*.example.com&#34;</span><span class="op" id="7125947">,</span>&nbsp;<span class="string" id="7125949">&#34;xyz.www.example.com&#34;</span><span class="op" id="7125970">,</span>&nbsp;<span class="builtintype" id="7125972">false</span><span class="op" id="7125977">}</span><span class="op" id="7125978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7125981">{</span><span class="string" id="7125982">&#34;*.*.example.com&#34;</span><span class="op" id="7125999">,</span>&nbsp;<span class="string" id="7126001">&#34;xyz.www.example.com&#34;</span><span class="op" id="7126022">,</span>&nbsp;<span class="builtintype" id="7126024">true</span><span class="op" id="7126028">}</span><span class="op" id="7126029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126032">{</span><span class="string" id="7126033">&#34;*.www.*.com&#34;</span><span class="op" id="7126046">,</span>&nbsp;<span class="string" id="7126048">&#34;xyz.www.example.com&#34;</span><span class="op" id="7126069">,</span>&nbsp;<span class="builtintype" id="7126071">true</span><span class="op" id="7126075">}</span><span class="op" id="7126076">,</span><br>
<span class="lineno"></span><span class="op" id="7126078">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7126081">func</span>&nbsp;<span class="ident" id="7126086">TestMatchHostnames</span><span class="op" id="7126104">(</span><span class="ident" id="7126105">t</span>&nbsp;<span class="op" id="7126107">*</span><span class="ident" id="7126108">testing</span><span class="op" id="7126115">.</span><span class="ident" id="7126116">T</span><span class="op" id="7126117">)</span>&nbsp;<span class="op" id="7126119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126122">for</span>&nbsp;<span class="ident" id="7126126">i</span><span class="op" id="7126127">,</span>&nbsp;<span class="ident" id="7126129">test</span>&nbsp;<span class="op" id="7126134">:=</span>&nbsp;<span class="keyword" id="7126137">range</span>&nbsp;<span class="ident" id="7126143">matchHostnamesTests</span>&nbsp;<span class="op" id="7126163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126167">r</span>&nbsp;<span class="op" id="7126169">:=</span>&nbsp;<span class="ident" id="7126172">matchHostnames</span><span class="op" id="7126186">(</span><span class="ident" id="7126187">test</span><span class="op" id="7126191">.</span><span class="ident" id="7126192">pattern</span><span class="op" id="7126199">,</span>&nbsp;<span class="ident" id="7126201">test</span><span class="op" id="7126205">.</span><span class="ident" id="7126206">host</span><span class="op" id="7126210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126214">if</span>&nbsp;<span class="ident" id="7126217">r</span>&nbsp;<span class="op" id="7126219">!=</span>&nbsp;<span class="ident" id="7126222">test</span><span class="op" id="7126226">.</span><span class="ident" id="7126227">ok</span>&nbsp;<span class="op" id="7126230">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126235">t</span><span class="op" id="7126236">.</span><span class="ident" id="7126237">Errorf</span><span class="op" id="7126243">(</span><span class="string" id="7126244">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7126275">,</span>&nbsp;<span class="ident" id="7126277">i</span><span class="op" id="7126278">,</span>&nbsp;<span class="ident" id="7126280">r</span><span class="op" id="7126281">,</span>&nbsp;<span class="ident" id="7126283">test</span><span class="op" id="7126287">.</span><span class="ident" id="7126288">ok</span><span class="op" id="7126290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126297">}</span><br>
<span class="lineno"></span><span class="op" id="7126299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7126302">func</span>&nbsp;<span class="ident" id="7126307">TestMatchIP</span><span class="op" id="7126318">(</span><span class="ident" id="7126319">t</span>&nbsp;<span class="op" id="7126321">*</span><span class="ident" id="7126322">testing</span><span class="op" id="7126329">.</span><span class="ident" id="7126330">T</span><span class="op" id="7126331">)</span>&nbsp;<span class="op" id="7126333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7126336">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126380">c</span>&nbsp;<span class="op" id="7126382">:=</span>&nbsp;<span class="op" id="7126385">&amp;</span><span class="ident" id="7126386">Certificate</span><span class="op" id="7126397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126401">DNSNames</span><span class="op" id="7126409">:</span>&nbsp;<span class="op" id="7126411">[</span><span class="op" id="7126412">]</span><span class="builtintype" id="7126413">string</span><span class="op" id="7126419">{</span><span class="string" id="7126420">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7126435">}</span><span class="op" id="7126436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126440">Subject</span><span class="op" id="7126447">:</span>&nbsp;<span class="ident" id="7126449">pkix</span><span class="op" id="7126453">.</span><span class="ident" id="7126454">Name</span><span class="op" id="7126458">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126463">CommonName</span><span class="op" id="7126473">:</span>&nbsp;<span class="string" id="7126475">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7126490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126494">}</span><span class="op" id="7126495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126501">err</span>&nbsp;<span class="op" id="7126505">:=</span>&nbsp;<span class="ident" id="7126508">c</span><span class="op" id="7126509">.</span><span class="ident" id="7126510">VerifyHostname</span><span class="op" id="7126524">(</span><span class="string" id="7126525">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7126543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126546">if</span>&nbsp;<span class="ident" id="7126549">err</span>&nbsp;<span class="op" id="7126553">!=</span>&nbsp;<span class="ident" id="7126556">nil</span>&nbsp;<span class="op" id="7126560">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126564">t</span><span class="op" id="7126565">.</span><span class="ident" id="7126566">Fatalf</span><span class="op" id="7126572">(</span><span class="string" id="7126573">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7126611">,</span>&nbsp;<span class="ident" id="7126613">err</span><span class="op" id="7126616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7126623">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7126696">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126716">c</span>&nbsp;<span class="op" id="7126718">=</span>&nbsp;<span class="op" id="7126720">&amp;</span><span class="ident" id="7126721">Certificate</span><span class="op" id="7126732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126736">DNSNames</span><span class="op" id="7126744">:</span>&nbsp;<span class="op" id="7126746">[</span><span class="op" id="7126747">]</span><span class="builtintype" id="7126748">string</span><span class="op" id="7126754">{</span><span class="string" id="7126755">&#34;*.2.3.4&#34;</span><span class="op" id="7126764">}</span><span class="op" id="7126765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126769">Subject</span><span class="op" id="7126776">:</span>&nbsp;<span class="ident" id="7126778">pkix</span><span class="op" id="7126782">.</span><span class="ident" id="7126783">Name</span><span class="op" id="7126787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126792">CommonName</span><span class="op" id="7126802">:</span>&nbsp;<span class="string" id="7126804">&#34;*.2.3.4&#34;</span><span class="op" id="7126813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126817">}</span><span class="op" id="7126818">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126824">err</span>&nbsp;<span class="op" id="7126828">=</span>&nbsp;<span class="ident" id="7126830">c</span><span class="op" id="7126831">.</span><span class="ident" id="7126832">VerifyHostname</span><span class="op" id="7126846">(</span><span class="string" id="7126847">&#34;1.2.3.4&#34;</span><span class="op" id="7126856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7126859">if</span>&nbsp;<span class="ident" id="7126862">err</span>&nbsp;<span class="op" id="7126866">==</span>&nbsp;<span class="ident" id="7126869">nil</span>&nbsp;<span class="op" id="7126873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126877">t</span><span class="op" id="7126878">.</span><span class="ident" id="7126879">Fatalf</span><span class="op" id="7126885">(</span><span class="string" id="7126886">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7126939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7126942">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126946">c</span>&nbsp;<span class="op" id="7126948">=</span>&nbsp;<span class="op" id="7126950">&amp;</span><span class="ident" id="7126951">Certificate</span><span class="op" id="7126962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7126966">IPAddresses</span><span class="op" id="7126977">:</span>&nbsp;<span class="op" id="7126979">[</span><span class="op" id="7126980">]</span><span class="ident" id="7126981">net</span><span class="op" id="7126984">.</span><span class="ident" id="7126985">IP</span><span class="op" id="7126987">{</span><span class="ident" id="7126988">net</span><span class="op" id="7126991">.</span><span class="ident" id="7126992">ParseIP</span><span class="op" id="7126999">(</span><span class="string" id="7127000">&#34;127.0.0.1&#34;</span><span class="op" id="7127011">)</span><span class="op" id="7127012">,</span>&nbsp;<span class="ident" id="7127014">net</span><span class="op" id="7127017">.</span><span class="ident" id="7127018">ParseIP</span><span class="op" id="7127025">(</span><span class="string" id="7127026">&#34;::1&#34;</span><span class="op" id="7127031">)</span><span class="op" id="7127032">}</span><span class="op" id="7127033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127039">err</span>&nbsp;<span class="op" id="7127043">=</span>&nbsp;<span class="ident" id="7127045">c</span><span class="op" id="7127046">.</span><span class="ident" id="7127047">VerifyHostname</span><span class="op" id="7127061">(</span><span class="string" id="7127062">&#34;127.0.0.1&#34;</span><span class="op" id="7127073">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127076">if</span>&nbsp;<span class="ident" id="7127079">err</span>&nbsp;<span class="op" id="7127083">!=</span>&nbsp;<span class="ident" id="7127086">nil</span>&nbsp;<span class="op" id="7127090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127094">t</span><span class="op" id="7127095">.</span><span class="ident" id="7127096">Fatalf</span><span class="op" id="7127102">(</span><span class="string" id="7127103">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7127134">,</span>&nbsp;<span class="ident" id="7127136">err</span><span class="op" id="7127139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127145">err</span>&nbsp;<span class="op" id="7127149">=</span>&nbsp;<span class="ident" id="7127151">c</span><span class="op" id="7127152">.</span><span class="ident" id="7127153">VerifyHostname</span><span class="op" id="7127167">(</span><span class="string" id="7127168">&#34;::1&#34;</span><span class="op" id="7127173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127176">if</span>&nbsp;<span class="ident" id="7127179">err</span>&nbsp;<span class="op" id="7127183">!=</span>&nbsp;<span class="ident" id="7127186">nil</span>&nbsp;<span class="op" id="7127190">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127194">t</span><span class="op" id="7127195">.</span><span class="ident" id="7127196">Fatalf</span><span class="op" id="7127202">(</span><span class="string" id="7127203">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7127228">,</span>&nbsp;<span class="ident" id="7127230">err</span><span class="op" id="7127233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127239">err</span>&nbsp;<span class="op" id="7127243">=</span>&nbsp;<span class="ident" id="7127245">c</span><span class="op" id="7127246">.</span><span class="ident" id="7127247">VerifyHostname</span><span class="op" id="7127261">(</span><span class="string" id="7127262">&#34;[::1]&#34;</span><span class="op" id="7127269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127272">if</span>&nbsp;<span class="ident" id="7127275">err</span>&nbsp;<span class="op" id="7127279">!=</span>&nbsp;<span class="ident" id="7127282">nil</span>&nbsp;<span class="op" id="7127286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127290">t</span><span class="op" id="7127291">.</span><span class="ident" id="7127292">Fatalf</span><span class="op" id="7127298">(</span><span class="string" id="7127299">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7127326">,</span>&nbsp;<span class="ident" id="7127328">err</span><span class="op" id="7127331">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127334">}</span><br>
<span class="lineno"></span><span class="op" id="7127336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7127339">func</span>&nbsp;<span class="ident" id="7127344">TestCertificateParse</span><span class="op" id="7127364">(</span><span class="ident" id="7127365">t</span>&nbsp;<span class="op" id="7127367">*</span><span class="ident" id="7127368">testing</span><span class="op" id="7127375">.</span><span class="ident" id="7127376">T</span><span class="op" id="7127377">)</span>&nbsp;<span class="op" id="7127379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127382">s</span><span class="op" id="7127383">,</span>&nbsp;<span class="ident" id="7127385">_</span>&nbsp;<span class="op" id="7127387">:=</span>&nbsp;<span class="ident" id="7127390">hex</span><span class="op" id="7127393">.</span><span class="ident" id="7127394">DecodeString</span><span class="op" id="7127406">(</span><span class="ident" id="7127407">certBytes</span><span class="op" id="7127416">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127419">certs</span><span class="op" id="7127424">,</span>&nbsp;<span class="ident" id="7127426">err</span>&nbsp;<span class="op" id="7127430">:=</span>&nbsp;<span class="ident" id="7127433">ParseCertificates</span><span class="op" id="7127450">(</span><span class="ident" id="7127451">s</span><span class="op" id="7127452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127455">if</span>&nbsp;<span class="ident" id="7127458">err</span>&nbsp;<span class="op" id="7127462">!=</span>&nbsp;<span class="ident" id="7127465">nil</span>&nbsp;<span class="op" id="7127469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127473">t</span><span class="op" id="7127474">.</span><span class="ident" id="7127475">Error</span><span class="op" id="7127480">(</span><span class="ident" id="7127481">err</span><span class="op" id="7127484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127490">if</span>&nbsp;<span class="builtinfunc" id="7127493">len</span><span class="op" id="7127496">(</span><span class="ident" id="7127497">certs</span><span class="op" id="7127502">)</span>&nbsp;<span class="op" id="7127504">!=</span>&nbsp;<span class="num" id="7127507">2</span>&nbsp;<span class="op" id="7127509">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127513">t</span><span class="op" id="7127514">.</span><span class="ident" id="7127515">Errorf</span><span class="op" id="7127521">(</span><span class="string" id="7127522">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7127560">,</span>&nbsp;<span class="builtinfunc" id="7127562">len</span><span class="op" id="7127565">(</span><span class="ident" id="7127566">certs</span><span class="op" id="7127571">)</span><span class="op" id="7127572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127576">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127588">err</span>&nbsp;<span class="op" id="7127592">=</span>&nbsp;<span class="ident" id="7127594">certs</span><span class="op" id="7127599">[</span><span class="num" id="7127600">0</span><span class="op" id="7127601">]</span><span class="op" id="7127602">.</span><span class="ident" id="7127603">CheckSignatureFrom</span><span class="op" id="7127621">(</span><span class="ident" id="7127622">certs</span><span class="op" id="7127627">[</span><span class="num" id="7127628">1</span><span class="op" id="7127629">]</span><span class="op" id="7127630">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127633">if</span>&nbsp;<span class="ident" id="7127636">err</span>&nbsp;<span class="op" id="7127640">!=</span>&nbsp;<span class="ident" id="7127643">nil</span>&nbsp;<span class="op" id="7127647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127651">t</span><span class="op" id="7127652">.</span><span class="ident" id="7127653">Error</span><span class="op" id="7127658">(</span><span class="ident" id="7127659">err</span><span class="op" id="7127662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127669">if</span>&nbsp;<span class="ident" id="7127672">err</span>&nbsp;<span class="op" id="7127676">:=</span>&nbsp;<span class="ident" id="7127679">certs</span><span class="op" id="7127684">[</span><span class="num" id="7127685">0</span><span class="op" id="7127686">]</span><span class="op" id="7127687">.</span><span class="ident" id="7127688">VerifyHostname</span><span class="op" id="7127702">(</span><span class="string" id="7127703">&#34;mail.google.com&#34;</span><span class="op" id="7127720">)</span><span class="op" id="7127721">;</span>&nbsp;<span class="ident" id="7127723">err</span>&nbsp;<span class="op" id="7127727">!=</span>&nbsp;<span class="ident" id="7127730">nil</span>&nbsp;<span class="op" id="7127734">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127738">t</span><span class="op" id="7127739">.</span><span class="ident" id="7127740">Error</span><span class="op" id="7127745">(</span><span class="ident" id="7127746">err</span><span class="op" id="7127749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127756">const</span>&nbsp;<span class="ident" id="7127762">expectedExtensions</span>&nbsp;<span class="op" id="7127781">=</span>&nbsp;<span class="num" id="7127783">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7127786">if</span>&nbsp;<span class="ident" id="7127789">n</span>&nbsp;<span class="op" id="7127791">:=</span>&nbsp;<span class="builtinfunc" id="7127794">len</span><span class="op" id="7127797">(</span><span class="ident" id="7127798">certs</span><span class="op" id="7127803">[</span><span class="num" id="7127804">0</span><span class="op" id="7127805">]</span><span class="op" id="7127806">.</span><span class="ident" id="7127807">Extensions</span><span class="op" id="7127817">)</span><span class="op" id="7127818">;</span>&nbsp;<span class="ident" id="7127820">n</span>&nbsp;<span class="op" id="7127822">!=</span>&nbsp;<span class="ident" id="7127825">expectedExtensions</span>&nbsp;<span class="op" id="7127844">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7127848">t</span><span class="op" id="7127849">.</span><span class="ident" id="7127850">Errorf</span><span class="op" id="7127856">(</span><span class="string" id="7127857">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7127885">,</span>&nbsp;<span class="ident" id="7127887">expectedExtensions</span><span class="op" id="7127905">,</span>&nbsp;<span class="ident" id="7127907">n</span><span class="op" id="7127908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7127911">}</span><br>
<span class="lineno"></span><span class="op" id="7127913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7127916">var</span>&nbsp;<span class="ident" id="7127920">certBytes</span>&nbsp;<span class="op" id="7127930">=</span>&nbsp;<span class="string" id="7127932">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7128013">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128016">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7128097">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128100">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7128181">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128184">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7128265">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128268">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7128349">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128352">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7128433">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128436">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7128517">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128520">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7128601">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128604">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7128685">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128688">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7128769">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128772">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7128853">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128856">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7128937">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7128940">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7129021">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129024">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7129105">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129108">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7129189">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129192">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7129273">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129276">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7129357">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129360">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7129441">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129444">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7129525">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129528">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7129609">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129612">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7129693">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129696">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7129777">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129780">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7129861">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129864">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7129945">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7129948">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7130029">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130032">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7130113">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130116">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7130197">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130200">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7130281">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130284">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7130365">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130368">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7130449">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130452">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7130533">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130536">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7130617">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130620">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7130701">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130704">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7130785">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130788">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7130869">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130872">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7130953">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7130956">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7131037">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7131040">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7131121">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7131124">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7131205">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7131208">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7131289">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7131292">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7131373">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7131376">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7131408">func</span>&nbsp;<span class="ident" id="7131413">TestCreateSelfSignedCertificate</span><span class="op" id="7131444">(</span><span class="ident" id="7131445">t</span>&nbsp;<span class="op" id="7131447">*</span><span class="ident" id="7131448">testing</span><span class="op" id="7131455">.</span><span class="ident" id="7131456">T</span><span class="op" id="7131457">)</span>&nbsp;<span class="op" id="7131459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131462">random</span>&nbsp;<span class="op" id="7131469">:=</span>&nbsp;<span class="ident" id="7131472">rand</span><span class="op" id="7131476">.</span><span class="ident" id="7131477">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131486">block</span><span class="op" id="7131491">,</span>&nbsp;<span class="ident" id="7131493">_</span>&nbsp;<span class="op" id="7131495">:=</span>&nbsp;<span class="ident" id="7131498">pem</span><span class="op" id="7131501">.</span><span class="ident" id="7131502">Decode</span><span class="op" id="7131508">(</span><span class="op" id="7131509">[</span><span class="op" id="7131510">]</span><span class="builtintype" id="7131511">byte</span><span class="op" id="7131515">(</span><span class="ident" id="7131516">pemPrivateKey</span><span class="op" id="7131529">)</span><span class="op" id="7131530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131533">rsaPriv</span><span class="op" id="7131540">,</span>&nbsp;<span class="ident" id="7131542">err</span>&nbsp;<span class="op" id="7131546">:=</span>&nbsp;<span class="ident" id="7131549">ParsePKCS1PrivateKey</span><span class="op" id="7131569">(</span><span class="ident" id="7131570">block</span><span class="op" id="7131575">.</span><span class="ident" id="7131576">Bytes</span><span class="op" id="7131581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7131584">if</span>&nbsp;<span class="ident" id="7131587">err</span>&nbsp;<span class="op" id="7131591">!=</span>&nbsp;<span class="ident" id="7131594">nil</span>&nbsp;<span class="op" id="7131598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131602">t</span><span class="op" id="7131603">.</span><span class="ident" id="7131604">Fatalf</span><span class="op" id="7131610">(</span><span class="string" id="7131611">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7131644">,</span>&nbsp;<span class="ident" id="7131646">err</span><span class="op" id="7131649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7131652">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131656">ecdsaPriv</span><span class="op" id="7131665">,</span>&nbsp;<span class="ident" id="7131667">err</span>&nbsp;<span class="op" id="7131671">:=</span>&nbsp;<span class="ident" id="7131674">ecdsa</span><span class="op" id="7131679">.</span><span class="ident" id="7131680">GenerateKey</span><span class="op" id="7131691">(</span><span class="ident" id="7131692">elliptic</span><span class="op" id="7131700">.</span><span class="ident" id="7131701">P256</span><span class="op" id="7131705">(</span><span class="op" id="7131706">)</span><span class="op" id="7131707">,</span>&nbsp;<span class="ident" id="7131709">rand</span><span class="op" id="7131713">.</span><span class="ident" id="7131714">Reader</span><span class="op" id="7131720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7131723">if</span>&nbsp;<span class="ident" id="7131726">err</span>&nbsp;<span class="op" id="7131730">!=</span>&nbsp;<span class="ident" id="7131733">nil</span>&nbsp;<span class="op" id="7131737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131741">t</span><span class="op" id="7131742">.</span><span class="ident" id="7131743">Fatalf</span><span class="op" id="7131749">(</span><span class="string" id="7131750">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7131784">,</span>&nbsp;<span class="ident" id="7131786">err</span><span class="op" id="7131789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7131792">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131796">tests</span>&nbsp;<span class="op" id="7131802">:=</span>&nbsp;<span class="op" id="7131805">[</span><span class="op" id="7131806">]</span><span class="keyword" id="7131807">struct</span>&nbsp;<span class="op" id="7131814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131818">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7131828">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131837">pub</span><span class="op" id="7131840">,</span>&nbsp;<span class="ident" id="7131842">priv</span>&nbsp;<span class="keyword" id="7131847">interface</span><span class="op" id="7131856">{</span><span class="op" id="7131857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131861">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7131871">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7131878">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7131888">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7131908">}</span><span class="op" id="7131909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7131913">{</span><span class="string" id="7131914">&#34;RSA/RSA&#34;</span><span class="op" id="7131923">,</span>&nbsp;<span class="op" id="7131925">&amp;</span><span class="ident" id="7131926">rsaPriv</span><span class="op" id="7131933">.</span><span class="ident" id="7131934">PublicKey</span><span class="op" id="7131943">,</span>&nbsp;<span class="ident" id="7131945">rsaPriv</span><span class="op" id="7131952">,</span>&nbsp;<span class="builtintype" id="7131954">true</span><span class="op" id="7131958">,</span>&nbsp;<span class="ident" id="7131960">SHA1WithRSA</span><span class="op" id="7131971">}</span><span class="op" id="7131972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7131976">{</span><span class="string" id="7131977">&#34;RSA/ECDSA&#34;</span><span class="op" id="7131988">,</span>&nbsp;<span class="op" id="7131990">&amp;</span><span class="ident" id="7131991">rsaPriv</span><span class="op" id="7131998">.</span><span class="ident" id="7131999">PublicKey</span><span class="op" id="7132008">,</span>&nbsp;<span class="ident" id="7132010">ecdsaPriv</span><span class="op" id="7132019">,</span>&nbsp;<span class="builtintype" id="7132021">false</span><span class="op" id="7132026">,</span>&nbsp;<span class="ident" id="7132028">ECDSAWithSHA384</span><span class="op" id="7132043">}</span><span class="op" id="7132044">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7132048">{</span><span class="string" id="7132049">&#34;ECDSA/RSA&#34;</span><span class="op" id="7132060">,</span>&nbsp;<span class="op" id="7132062">&amp;</span><span class="ident" id="7132063">ecdsaPriv</span><span class="op" id="7132072">.</span><span class="ident" id="7132073">PublicKey</span><span class="op" id="7132082">,</span>&nbsp;<span class="ident" id="7132084">rsaPriv</span><span class="op" id="7132091">,</span>&nbsp;<span class="builtintype" id="7132093">false</span><span class="op" id="7132098">,</span>&nbsp;<span class="ident" id="7132100">SHA256WithRSA</span><span class="op" id="7132113">}</span><span class="op" id="7132114">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7132118">{</span><span class="string" id="7132119">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7132132">,</span>&nbsp;<span class="op" id="7132134">&amp;</span><span class="ident" id="7132135">ecdsaPriv</span><span class="op" id="7132144">.</span><span class="ident" id="7132145">PublicKey</span><span class="op" id="7132154">,</span>&nbsp;<span class="ident" id="7132156">ecdsaPriv</span><span class="op" id="7132165">,</span>&nbsp;<span class="builtintype" id="7132167">true</span><span class="op" id="7132171">,</span>&nbsp;<span class="ident" id="7132173">ECDSAWithSHA1</span><span class="op" id="7132186">}</span><span class="op" id="7132187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7132190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132194">testExtKeyUsage</span>&nbsp;<span class="op" id="7132210">:=</span>&nbsp;<span class="op" id="7132213">[</span><span class="op" id="7132214">]</span><span class="ident" id="7132215">ExtKeyUsage</span><span class="op" id="7132226">{</span><span class="ident" id="7132227">ExtKeyUsageClientAuth</span><span class="op" id="7132248">,</span>&nbsp;<span class="ident" id="7132250">ExtKeyUsageServerAuth</span><span class="op" id="7132271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132274">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7132297">:=</span>&nbsp;<span class="op" id="7132300">[</span><span class="op" id="7132301">]</span><span class="ident" id="7132302">asn1</span><span class="op" id="7132306">.</span><span class="ident" id="7132307">ObjectIdentifier</span><span class="op" id="7132323">{</span><span class="op" id="7132324">[</span><span class="op" id="7132325">]</span><span class="builtintype" id="7132326">int</span><span class="op" id="7132329">{</span><span class="num" id="7132330">1</span><span class="op" id="7132331">,</span>&nbsp;<span class="num" id="7132333">2</span><span class="op" id="7132334">,</span>&nbsp;<span class="num" id="7132336">3</span><span class="op" id="7132337">}</span><span class="op" id="7132338">,</span>&nbsp;<span class="op" id="7132340">[</span><span class="op" id="7132341">]</span><span class="builtintype" id="7132342">int</span><span class="op" id="7132345">{</span><span class="num" id="7132346">2</span><span class="op" id="7132347">,</span>&nbsp;<span class="num" id="7132349">59</span><span class="op" id="7132351">,</span>&nbsp;<span class="num" id="7132353">1</span><span class="op" id="7132354">}</span><span class="op" id="7132355">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132358">extraExtensionData</span>&nbsp;<span class="op" id="7132377">:=</span>&nbsp;<span class="op" id="7132380">[</span><span class="op" id="7132381">]</span><span class="builtintype" id="7132382">byte</span><span class="op" id="7132386">(</span><span class="string" id="7132387">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7132404">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7132408">for</span>&nbsp;<span class="ident" id="7132412">_</span><span class="op" id="7132413">,</span>&nbsp;<span class="ident" id="7132415">test</span>&nbsp;<span class="op" id="7132420">:=</span>&nbsp;<span class="keyword" id="7132423">range</span>&nbsp;<span class="ident" id="7132429">tests</span>&nbsp;<span class="op" id="7132435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132439">commonName</span>&nbsp;<span class="op" id="7132450">:=</span>&nbsp;<span class="string" id="7132453">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132474">template</span>&nbsp;<span class="op" id="7132483">:=</span>&nbsp;<span class="ident" id="7132486">Certificate</span><span class="op" id="7132497">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132502">SerialNumber</span><span class="op" id="7132514">:</span>&nbsp;<span class="ident" id="7132516">big</span><span class="op" id="7132519">.</span><span class="ident" id="7132520">NewInt</span><span class="op" id="7132526">(</span><span class="num" id="7132527">1</span><span class="op" id="7132528">)</span><span class="op" id="7132529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132534">Subject</span><span class="op" id="7132541">:</span>&nbsp;<span class="ident" id="7132543">pkix</span><span class="op" id="7132547">.</span><span class="ident" id="7132548">Name</span><span class="op" id="7132552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132558">CommonName</span><span class="op" id="7132568">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7132572">commonName</span><span class="op" id="7132582">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132588">Organization</span><span class="op" id="7132600">:</span>&nbsp;<span class="op" id="7132602">[</span><span class="op" id="7132603">]</span><span class="builtintype" id="7132604">string</span><span class="op" id="7132610">{</span><span class="string" id="7132611">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7132623">}</span><span class="op" id="7132624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7132629">}</span><span class="op" id="7132630">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132635">NotBefore</span><span class="op" id="7132644">:</span>&nbsp;<span class="ident" id="7132646">time</span><span class="op" id="7132650">.</span><span class="ident" id="7132651">Unix</span><span class="op" id="7132655">(</span><span class="num" id="7132656">1000</span><span class="op" id="7132660">,</span>&nbsp;<span class="num" id="7132662">0</span><span class="op" id="7132663">)</span><span class="op" id="7132664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132669">NotAfter</span><span class="op" id="7132677">:</span>&nbsp;&nbsp;<span class="ident" id="7132680">time</span><span class="op" id="7132684">.</span><span class="ident" id="7132685">Unix</span><span class="op" id="7132689">(</span><span class="num" id="7132690">100000</span><span class="op" id="7132696">,</span>&nbsp;<span class="num" id="7132698">0</span><span class="op" id="7132699">)</span><span class="op" id="7132700">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132706">SignatureAlgorithm</span><span class="op" id="7132724">:</span>&nbsp;<span class="ident" id="7132726">test</span><span class="op" id="7132730">.</span><span class="ident" id="7132731">sigAlgo</span><span class="op" id="7132738">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132744">SubjectKeyId</span><span class="op" id="7132756">:</span>&nbsp;<span class="op" id="7132758">[</span><span class="op" id="7132759">]</span><span class="builtintype" id="7132760">byte</span><span class="op" id="7132764">{</span><span class="num" id="7132765">1</span><span class="op" id="7132766">,</span>&nbsp;<span class="num" id="7132768">2</span><span class="op" id="7132769">,</span>&nbsp;<span class="num" id="7132771">3</span><span class="op" id="7132772">,</span>&nbsp;<span class="num" id="7132774">4</span><span class="op" id="7132775">}</span><span class="op" id="7132776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132781">KeyUsage</span><span class="op" id="7132789">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132795">KeyUsageCertSign</span><span class="op" id="7132811">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132817">ExtKeyUsage</span><span class="op" id="7132828">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7132837">testExtKeyUsage</span><span class="op" id="7132852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132857">UnknownExtKeyUsage</span><span class="op" id="7132875">:</span>&nbsp;<span class="ident" id="7132877">testUnknownExtKeyUsage</span><span class="op" id="7132899">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132905">BasicConstraintsValid</span><span class="op" id="7132926">:</span>&nbsp;<span class="builtintype" id="7132928">true</span><span class="op" id="7132932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132937">IsCA</span><span class="op" id="7132941">:</span>&nbsp;<span class="builtintype" id="7132943">true</span><span class="op" id="7132947">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7132953">OCSPServer</span><span class="op" id="7132963">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7132976">[</span><span class="op" id="7132977">]</span><span class="builtintype" id="7132978">string</span><span class="op" id="7132984">{</span><span class="string" id="7132985">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7133010">}</span><span class="op" id="7133011">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133016">IssuingCertificateURL</span><span class="op" id="7133037">:</span>&nbsp;<span class="op" id="7133039">[</span><span class="op" id="7133040">]</span><span class="builtintype" id="7133041">string</span><span class="op" id="7133047">{</span><span class="string" id="7133048">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7133080">}</span><span class="op" id="7133081">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133087">DNSNames</span><span class="op" id="7133095">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7133103">[</span><span class="op" id="7133104">]</span><span class="builtintype" id="7133105">string</span><span class="op" id="7133111">{</span><span class="string" id="7133112">&#34;test.example.com&#34;</span><span class="op" id="7133130">}</span><span class="op" id="7133131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133136">EmailAddresses</span><span class="op" id="7133150">:</span>&nbsp;<span class="op" id="7133152">[</span><span class="op" id="7133153">]</span><span class="builtintype" id="7133154">string</span><span class="op" id="7133160">{</span><span class="string" id="7133161">&#34;gopher@golang.org&#34;</span><span class="op" id="7133180">}</span><span class="op" id="7133181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133186">IPAddresses</span><span class="op" id="7133197">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7133202">[</span><span class="op" id="7133203">]</span><span class="ident" id="7133204">net</span><span class="op" id="7133207">.</span><span class="ident" id="7133208">IP</span><span class="op" id="7133210">{</span><span class="ident" id="7133211">net</span><span class="op" id="7133214">.</span><span class="ident" id="7133215">IPv4</span><span class="op" id="7133219">(</span><span class="num" id="7133220">127</span><span class="op" id="7133223">,</span>&nbsp;<span class="num" id="7133225">0</span><span class="op" id="7133226">,</span>&nbsp;<span class="num" id="7133228">0</span><span class="op" id="7133229">,</span>&nbsp;<span class="num" id="7133231">1</span><span class="op" id="7133232">)</span><span class="op" id="7133233">.</span><span class="ident" id="7133234">To4</span><span class="op" id="7133237">(</span><span class="op" id="7133238">)</span><span class="op" id="7133239">,</span>&nbsp;<span class="ident" id="7133241">net</span><span class="op" id="7133244">.</span><span class="ident" id="7133245">ParseIP</span><span class="op" id="7133252">(</span><span class="string" id="7133253">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7133275">)</span><span class="op" id="7133276">}</span><span class="op" id="7133277">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133283">PolicyIdentifiers</span><span class="op" id="7133300">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7133304">[</span><span class="op" id="7133305">]</span><span class="ident" id="7133306">asn1</span><span class="op" id="7133310">.</span><span class="ident" id="7133311">ObjectIdentifier</span><span class="op" id="7133327">{</span><span class="op" id="7133328">[</span><span class="op" id="7133329">]</span><span class="builtintype" id="7133330">int</span><span class="op" id="7133333">{</span><span class="num" id="7133334">1</span><span class="op" id="7133335">,</span>&nbsp;<span class="num" id="7133337">2</span><span class="op" id="7133338">,</span>&nbsp;<span class="num" id="7133340">3</span><span class="op" id="7133341">}</span><span class="op" id="7133342">}</span><span class="op" id="7133343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133348">PermittedDNSDomains</span><span class="op" id="7133367">:</span>&nbsp;<span class="op" id="7133369">[</span><span class="op" id="7133370">]</span><span class="builtintype" id="7133371">string</span><span class="op" id="7133377">{</span><span class="string" id="7133378">&#34;.example.com&#34;</span><span class="op" id="7133392">,</span>&nbsp;<span class="string" id="7133394">&#34;example.com&#34;</span><span class="op" id="7133407">}</span><span class="op" id="7133408">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133414">CRLDistributionPoints</span><span class="op" id="7133435">:</span>&nbsp;<span class="op" id="7133437">[</span><span class="op" id="7133438">]</span><span class="builtintype" id="7133439">string</span><span class="op" id="7133445">{</span><span class="string" id="7133446">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7133479">,</span>&nbsp;<span class="string" id="7133481">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7133514">}</span><span class="op" id="7133515">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133521">ExtraExtensions</span><span class="op" id="7133536">:</span>&nbsp;<span class="op" id="7133538">[</span><span class="op" id="7133539">]</span><span class="ident" id="7133540">pkix</span><span class="op" id="7133544">.</span><span class="ident" id="7133545">Extension</span><span class="op" id="7133554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133567">Id</span><span class="op" id="7133569">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7133574">[</span><span class="op" id="7133575">]</span><span class="builtintype" id="7133576">int</span><span class="op" id="7133579">{</span><span class="num" id="7133580">1</span><span class="op" id="7133581">,</span>&nbsp;<span class="num" id="7133583">2</span><span class="op" id="7133584">,</span>&nbsp;<span class="num" id="7133586">3</span><span class="op" id="7133587">,</span>&nbsp;<span class="num" id="7133589">4</span><span class="op" id="7133590">}</span><span class="op" id="7133591">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133598">Value</span><span class="op" id="7133603">:</span>&nbsp;<span class="ident" id="7133605">extraExtensionData</span><span class="op" id="7133623">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133629">}</span><span class="op" id="7133630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7133636">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133706">Id</span><span class="op" id="7133708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7133716">oidExtensionSubjectKeyId</span><span class="op" id="7133740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133747">Critical</span><span class="op" id="7133755">:</span>&nbsp;<span class="builtintype" id="7133757">false</span><span class="op" id="7133762">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133769">Value</span><span class="op" id="7133774">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7133779">[</span><span class="op" id="7133780">]</span><span class="builtintype" id="7133781">byte</span><span class="op" id="7133785">{</span><span class="num" id="7133786">0x04</span><span class="op" id="7133790">,</span>&nbsp;<span class="num" id="7133792">0x04</span><span class="op" id="7133796">,</span>&nbsp;<span class="num" id="7133798">4</span><span class="op" id="7133799">,</span>&nbsp;<span class="num" id="7133801">3</span><span class="op" id="7133802">,</span>&nbsp;<span class="num" id="7133804">2</span><span class="op" id="7133805">,</span>&nbsp;<span class="num" id="7133807">1</span><span class="op" id="7133808">}</span><span class="op" id="7133809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133815">}</span><span class="op" id="7133816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133821">}</span><span class="op" id="7133822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7133826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133831">derBytes</span><span class="op" id="7133839">,</span>&nbsp;<span class="ident" id="7133841">err</span>&nbsp;<span class="op" id="7133845">:=</span>&nbsp;<span class="ident" id="7133848">CreateCertificate</span><span class="op" id="7133865">(</span><span class="ident" id="7133866">random</span><span class="op" id="7133872">,</span>&nbsp;<span class="op" id="7133874">&amp;</span><span class="ident" id="7133875">template</span><span class="op" id="7133883">,</span>&nbsp;<span class="op" id="7133885">&amp;</span><span class="ident" id="7133886">template</span><span class="op" id="7133894">,</span>&nbsp;<span class="ident" id="7133896">test</span><span class="op" id="7133900">.</span><span class="ident" id="7133901">pub</span><span class="op" id="7133904">,</span>&nbsp;<span class="ident" id="7133906">test</span><span class="op" id="7133910">.</span><span class="ident" id="7133911">priv</span><span class="op" id="7133915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7133919">if</span>&nbsp;<span class="ident" id="7133922">err</span>&nbsp;<span class="op" id="7133926">!=</span>&nbsp;<span class="ident" id="7133929">nil</span>&nbsp;<span class="op" id="7133933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7133938">t</span><span class="op" id="7133939">.</span><span class="ident" id="7133940">Errorf</span><span class="op" id="7133946">(</span><span class="string" id="7133947">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7133985">,</span>&nbsp;<span class="ident" id="7133987">test</span><span class="op" id="7133991">.</span><span class="ident" id="7133992">name</span><span class="op" id="7133996">,</span>&nbsp;<span class="ident" id="7133998">err</span><span class="op" id="7134001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134006">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7134017">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134022">cert</span><span class="op" id="7134026">,</span>&nbsp;<span class="ident" id="7134028">err</span>&nbsp;<span class="op" id="7134032">:=</span>&nbsp;<span class="ident" id="7134035">ParseCertificate</span><span class="op" id="7134051">(</span><span class="ident" id="7134052">derBytes</span><span class="op" id="7134060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134064">if</span>&nbsp;<span class="ident" id="7134067">err</span>&nbsp;<span class="op" id="7134071">!=</span>&nbsp;<span class="ident" id="7134074">nil</span>&nbsp;<span class="op" id="7134078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134083">t</span><span class="op" id="7134084">.</span><span class="ident" id="7134085">Errorf</span><span class="op" id="7134091">(</span><span class="string" id="7134092">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7134129">,</span>&nbsp;<span class="ident" id="7134131">test</span><span class="op" id="7134135">.</span><span class="ident" id="7134136">name</span><span class="op" id="7134140">,</span>&nbsp;<span class="ident" id="7134142">err</span><span class="op" id="7134145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134150">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7134161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134166">if</span>&nbsp;<span class="builtinfunc" id="7134169">len</span><span class="op" id="7134172">(</span><span class="ident" id="7134173">cert</span><span class="op" id="7134177">.</span><span class="ident" id="7134178">PolicyIdentifiers</span><span class="op" id="7134195">)</span>&nbsp;<span class="op" id="7134197">!=</span>&nbsp;<span class="num" id="7134200">1</span>&nbsp;<span class="op" id="7134202">||</span>&nbsp;<span class="op" id="7134205">!</span><span class="ident" id="7134206">cert</span><span class="op" id="7134210">.</span><span class="ident" id="7134211">PolicyIdentifiers</span><span class="op" id="7134228">[</span><span class="num" id="7134229">0</span><span class="op" id="7134230">]</span><span class="op" id="7134231">.</span><span class="ident" id="7134232">Equal</span><span class="op" id="7134237">(</span><span class="ident" id="7134238">template</span><span class="op" id="7134246">.</span><span class="ident" id="7134247">PolicyIdentifiers</span><span class="op" id="7134264">[</span><span class="num" id="7134265">0</span><span class="op" id="7134266">]</span><span class="op" id="7134267">)</span>&nbsp;<span class="op" id="7134269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134274">t</span><span class="op" id="7134275">.</span><span class="ident" id="7134276">Errorf</span><span class="op" id="7134282">(</span><span class="string" id="7134283">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7134341">,</span>&nbsp;<span class="ident" id="7134343">test</span><span class="op" id="7134347">.</span><span class="ident" id="7134348">name</span><span class="op" id="7134352">,</span>&nbsp;<span class="ident" id="7134354">cert</span><span class="op" id="7134358">.</span><span class="ident" id="7134359">PolicyIdentifiers</span><span class="op" id="7134376">,</span>&nbsp;<span class="ident" id="7134378">template</span><span class="op" id="7134386">.</span><span class="ident" id="7134387">PolicyIdentifiers</span><span class="op" id="7134404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7134408">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134413">if</span>&nbsp;<span class="builtinfunc" id="7134416">len</span><span class="op" id="7134419">(</span><span class="ident" id="7134420">cert</span><span class="op" id="7134424">.</span><span class="ident" id="7134425">PermittedDNSDomains</span><span class="op" id="7134444">)</span>&nbsp;<span class="op" id="7134446">!=</span>&nbsp;<span class="num" id="7134449">2</span>&nbsp;<span class="op" id="7134451">||</span>&nbsp;<span class="ident" id="7134454">cert</span><span class="op" id="7134458">.</span><span class="ident" id="7134459">PermittedDNSDomains</span><span class="op" id="7134478">[</span><span class="num" id="7134479">0</span><span class="op" id="7134480">]</span>&nbsp;<span class="op" id="7134482">!=</span>&nbsp;<span class="string" id="7134485">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7134500">||</span>&nbsp;<span class="ident" id="7134503">cert</span><span class="op" id="7134507">.</span><span class="ident" id="7134508">PermittedDNSDomains</span><span class="op" id="7134527">[</span><span class="num" id="7134528">1</span><span class="op" id="7134529">]</span>&nbsp;<span class="op" id="7134531">!=</span>&nbsp;<span class="string" id="7134534">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7134548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134553">t</span><span class="op" id="7134554">.</span><span class="ident" id="7134555">Errorf</span><span class="op" id="7134561">(</span><span class="string" id="7134562">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7134605">,</span>&nbsp;<span class="ident" id="7134607">test</span><span class="op" id="7134611">.</span><span class="ident" id="7134612">name</span><span class="op" id="7134616">,</span>&nbsp;<span class="ident" id="7134618">cert</span><span class="op" id="7134622">.</span><span class="ident" id="7134623">PermittedDNSDomains</span><span class="op" id="7134642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7134646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134651">if</span>&nbsp;<span class="ident" id="7134654">cert</span><span class="op" id="7134658">.</span><span class="ident" id="7134659">Subject</span><span class="op" id="7134666">.</span><span class="ident" id="7134667">CommonName</span>&nbsp;<span class="op" id="7134678">!=</span>&nbsp;<span class="ident" id="7134681">commonName</span>&nbsp;<span class="op" id="7134692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134697">t</span><span class="op" id="7134698">.</span><span class="ident" id="7134699">Errorf</span><span class="op" id="7134705">(</span><span class="string" id="7134706">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7134778">,</span>&nbsp;<span class="ident" id="7134780">test</span><span class="op" id="7134784">.</span><span class="ident" id="7134785">name</span><span class="op" id="7134789">,</span>&nbsp;<span class="ident" id="7134791">cert</span><span class="op" id="7134795">.</span><span class="ident" id="7134796">Subject</span><span class="op" id="7134803">.</span><span class="ident" id="7134804">CommonName</span><span class="op" id="7134814">,</span>&nbsp;<span class="ident" id="7134816">commonName</span><span class="op" id="7134826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7134830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7134835">if</span>&nbsp;<span class="ident" id="7134838">cert</span><span class="op" id="7134842">.</span><span class="ident" id="7134843">Issuer</span><span class="op" id="7134849">.</span><span class="ident" id="7134850">CommonName</span>&nbsp;<span class="op" id="7134861">!=</span>&nbsp;<span class="ident" id="7134864">commonName</span>&nbsp;<span class="op" id="7134875">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7134880">t</span><span class="op" id="7134881">.</span><span class="ident" id="7134882">Errorf</span><span class="op" id="7134888">(</span><span class="string" id="7134889">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7134960">,</span>&nbsp;<span class="ident" id="7134962">test</span><span class="op" id="7134966">.</span><span class="ident" id="7134967">name</span><span class="op" id="7134971">,</span>&nbsp;<span class="ident" id="7134973">cert</span><span class="op" id="7134977">.</span><span class="ident" id="7134978">Issuer</span><span class="op" id="7134984">.</span><span class="ident" id="7134985">CommonName</span><span class="op" id="7134995">,</span>&nbsp;<span class="ident" id="7134997">commonName</span><span class="op" id="7135007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7135011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7135016">if</span>&nbsp;<span class="ident" id="7135019">cert</span><span class="op" id="7135023">.</span><span class="ident" id="7135024">SignatureAlgorithm</span>&nbsp;<span class="op" id="7135043">!=</span>&nbsp;<span class="ident" id="7135046">test</span><span class="op" id="7135050">.</span><span class="ident" id="7135051">sigAlgo</span>&nbsp;<span class="op" id="7135059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7135064">t</span><span class="op" id="7135065">.</span><span class="ident" id="7135066">Errorf</span><span class="op" id="7135072">(</span><span class="string" id="7135073">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7135142">,</span>&nbsp;<span class="ident" id="7135144">test</span><span class="op" id="7135148">.</span><span class="ident" id="7135149">name</span><span class="op" id="7135153">,</span>&nbsp;<span class="ident" id="7135155">cert</span><span class="op" id="7135159">.</span><span class="ident" id="7135160">SignatureAlgorithm</span><span class="op" id="7135178">,</span>&nbsp;<span class="ident" id="7135180">test</span><span class="op" id="7135184">.</span><span class="ident" id="7135185">sigAlgo</span><span class="op" id="7135192">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7135196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7135201">if</span>&nbsp;<span class="op" id="7135204">!</span><span class="ident" id="7135205">reflect</span><span class="op" id="7135212">.</span><span class="ident" id="7135213">DeepEqual</span><span class="op" id="7135222">(</span><span class="ident" id="7135223">cert</span><span class="op" id="7135227">.</span><span class="ident" id="7135228">ExtKeyUsage</span><span class="op" id="7135239">,</span>&nbsp;<span class="ident" id="7135241">testExtKeyUsage</span><span class="op" id="7135256">)</span>&nbsp;<span class="op" id="7135258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7135263">t</span><span class="op" id="7135264">.</span><span class="ident" id="7135265">Errorf</span><span class="op" id="7135271">(</span><span class="string" id="7135272">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7135348">,</span>&nbsp;<span class="ident" id="7135350">test</span><span class="op" id="7135354">.</span><span class="ident" id="7135355">name</span><span class="op" id="7135359">,</span>&nbsp;<span class="ident" id="7135361">cert</span><span class="op" id="7135365">.</span><span class="ident" id="7135366">ExtKeyUsage</span><span class="op" id="7135377">,</span>&nbsp;<span class="ident" id="7135379">testExtKeyUsage</span><span class="op" id="7135394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7135398">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7135403">if</span>&nbsp;<span class="op" id="7135406">!</span><span class="ident" id="7135407">reflect</span><span class="op" id="7135414">.</span><span class="ident" id="7135415">DeepEqual</span><span class="op" id="7135424">(</span><span class="ident" id="7135425">cert</span><span class="op" id="7135429">.</span><span class="ident" id="7135430">UnknownExtKeyUsage</span><span class="op" id="7135448">,</span>&nbsp;<span class="ident" id="7135450">testUnknownExtKeyUsage</span><span class="op" id="7135472">)</span>&nbsp;<span class="op" id="7135474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7135479">t</span><span class="op" id="7135480">.</span><span class="ident" id="7135481">Errorf</span><span class="op" id="7135487">(</span><span class="string" id="7135488">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7135572">,</span>&nbsp;<span class="ident" id="7135574">test</span><span class="op" id="7135578">.</span><span class="ident" id="7135579">name</span><span class="op" id="7135583">,</span>&nbsp;<span class="ident" id="7135585">cert</span><span class="op" id="7135589">.</span><span class="ident" id="7135590">UnknownExtKeyUsage</span><span class="op" id="7135608">,</span>&nbsp;<span class="ident" id="7135610">testUnknownExtKeyUsage</span><span class="op" id="7135632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7135636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7135641">if</span>&nbsp;<span class="op" id="7135644">!</span><span class="ident" id="7135645">reflect</span><span class="op" id="7135652">.</span><span class="ident" id="7135653">DeepEqual</span><span class="op" id="7135662">(</span><span class="ident" id="7135663">cert</span><span class="op" id="7135667">.</span><span class="ident" id="7135668">OCSPServer</span><span class="op" id="7135678">,</span>&nbsp;<span class="ident" id="7135680">template</span><span class="op" id="7135688">.</span><span class="ident" id="7135689">OCSPServer</span><span class="op" id="7135699">)</span>&nbsp;<span class="op" id="7135701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7135706">t</span><span class="op" id="7135707">.</span><span class="ident" id="7135708">Errorf</span><span class="op" id="7135714">(</span><span class="string" id="7135715">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7135771">,</span>&nbsp;<span class="ident" id="7135773">test</span><span class="op" id="7135777">.</span><span class="ident" id="7135778">name</span><span class="op" id="7135782">,</span>&nbsp;<span class="ident" id="7135784">cert</span><span class="op" id="7135788">.</span><span class="ident" id="7135789">OCSPServer</span><span class="op" id="7135799">,</span>&nbsp;<span class="ident" id="7135801">template</span><span class="op" id="7135809">.</span><span class="ident" id="7135810">OCSPServer</span><span class="op" id="7135820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7135824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7135829">if</span>&nbsp;<span class="op" id="7135832">!</span><span class="ident" id="7135833">reflect</span><span class="op" id="7135840">.</span><span class="ident" id="7135841">DeepEqual</span><span class="op" id="7135850">(</span><span class="ident" id="7135851">cert</span><span class="op" id="7135855">.</span><span class="ident" id="7135856">IssuingCertificateURL</span><span class="op" id="7135877">,</span>&nbsp;<span class="ident" id="7135879">template</span><span class="op" id="7135887">.</span><span class="ident" id="7135888">IssuingCertificateURL</span><span class="op" id="7135909">)</span>&nbsp;<span class="op" id="7135911">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7135916">t</span><span class="op" id="7135917">.</span><span class="ident" id="7135918">Errorf</span><span class="op" id="7135924">(</span><span class="string" id="7135925">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7135993">,</span>&nbsp;<span class="ident" id="7135995">test</span><span class="op" id="7135999">.</span><span class="ident" id="7136000">name</span><span class="op" id="7136004">,</span>&nbsp;<span class="ident" id="7136006">cert</span><span class="op" id="7136010">.</span><span class="ident" id="7136011">IssuingCertificateURL</span><span class="op" id="7136032">,</span>&nbsp;<span class="ident" id="7136034">template</span><span class="op" id="7136042">.</span><span class="ident" id="7136043">IssuingCertificateURL</span><span class="op" id="7136064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7136068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7136073">if</span>&nbsp;<span class="op" id="7136076">!</span><span class="ident" id="7136077">reflect</span><span class="op" id="7136084">.</span><span class="ident" id="7136085">DeepEqual</span><span class="op" id="7136094">(</span><span class="ident" id="7136095">cert</span><span class="op" id="7136099">.</span><span class="ident" id="7136100">DNSNames</span><span class="op" id="7136108">,</span>&nbsp;<span class="ident" id="7136110">template</span><span class="op" id="7136118">.</span><span class="ident" id="7136119">DNSNames</span><span class="op" id="7136127">)</span>&nbsp;<span class="op" id="7136129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7136134">t</span><span class="op" id="7136135">.</span><span class="ident" id="7136136">Errorf</span><span class="op" id="7136142">(</span><span class="string" id="7136143">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7136200">,</span>&nbsp;<span class="ident" id="7136202">test</span><span class="op" id="7136206">.</span><span class="ident" id="7136207">name</span><span class="op" id="7136211">,</span>&nbsp;<span class="ident" id="7136213">cert</span><span class="op" id="7136217">.</span><span class="ident" id="7136218">DNSNames</span><span class="op" id="7136226">,</span>&nbsp;<span class="ident" id="7136228">template</span><span class="op" id="7136236">.</span><span class="ident" id="7136237">DNSNames</span><span class="op" id="7136245">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7136249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7136254">if</span>&nbsp;<span class="op" id="7136257">!</span><span class="ident" id="7136258">reflect</span><span class="op" id="7136265">.</span><span class="ident" id="7136266">DeepEqual</span><span class="op" id="7136275">(</span><span class="ident" id="7136276">cert</span><span class="op" id="7136280">.</span><span class="ident" id="7136281">EmailAddresses</span><span class="op" id="7136295">,</span>&nbsp;<span class="ident" id="7136297">template</span><span class="op" id="7136305">.</span><span class="ident" id="7136306">EmailAddresses</span><span class="op" id="7136320">)</span>&nbsp;<span class="op" id="7136322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7136327">t</span><span class="op" id="7136328">.</span><span class="ident" id="7136329">Errorf</span><span class="op" id="7136335">(</span><span class="string" id="7136336">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7136390">,</span>&nbsp;<span class="ident" id="7136392">test</span><span class="op" id="7136396">.</span><span class="ident" id="7136397">name</span><span class="op" id="7136401">,</span>&nbsp;<span class="ident" id="7136403">cert</span><span class="op" id="7136407">.</span><span class="ident" id="7136408">EmailAddresses</span><span class="op" id="7136422">,</span>&nbsp;<span class="ident" id="7136424">template</span><span class="op" id="7136432">.</span><span class="ident" id="7136433">EmailAddresses</span><span class="op" id="7136447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7136451">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7136456">if</span>&nbsp;<span class="op" id="7136459">!</span><span class="ident" id="7136460">reflect</span><span class="op" id="7136467">.</span><span class="ident" id="7136468">DeepEqual</span><span class="op" id="7136477">(</span><span class="ident" id="7136478">cert</span><span class="op" id="7136482">.</span><span class="ident" id="7136483">IPAddresses</span><span class="op" id="7136494">,</span>&nbsp;<span class="ident" id="7136496">template</span><span class="op" id="7136504">.</span><span class="ident" id="7136505">IPAddresses</span><span class="op" id="7136516">)</span>&nbsp;<span class="op" id="7136518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7136523">t</span><span class="op" id="7136524">.</span><span class="ident" id="7136525">Errorf</span><span class="op" id="7136531">(</span><span class="string" id="7136532">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7136583">,</span>&nbsp;<span class="ident" id="7136585">test</span><span class="op" id="7136589">.</span><span class="ident" id="7136590">name</span><span class="op" id="7136594">,</span>&nbsp;<span class="ident" id="7136596">cert</span><span class="op" id="7136600">.</span><span class="ident" id="7136601">IPAddresses</span><span class="op" id="7136612">,</span>&nbsp;<span class="ident" id="7136614">template</span><span class="op" id="7136622">.</span><span class="ident" id="7136623">IPAddresses</span><span class="op" id="7136634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7136638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7136643">if</span>&nbsp;<span class="op" id="7136646">!</span><span class="ident" id="7136647">reflect</span><span class="op" id="7136654">.</span><span class="ident" id="7136655">DeepEqual</span><span class="op" id="7136664">(</span><span class="ident" id="7136665">cert</span><span class="op" id="7136669">.</span><span class="ident" id="7136670">CRLDistributionPoints</span><span class="op" id="7136691">,</span>&nbsp;<span class="ident" id="7136693">template</span><span class="op" id="7136701">.</span><span class="ident" id="7136702">CRLDistributionPoints</span><span class="op" id="7136723">)</span>&nbsp;<span class="op" id="7136725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7136730">t</span><span class="op" id="7136731">.</span><span class="ident" id="7136732">Errorf</span><span class="op" id="7136738">(</span><span class="string" id="7136739">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7136806">,</span>&nbsp;<span class="ident" id="7136808">test</span><span class="op" id="7136812">.</span><span class="ident" id="7136813">name</span><span class="op" id="7136817">,</span>&nbsp;<span class="ident" id="7136819">cert</span><span class="op" id="7136823">.</span><span class="ident" id="7136824">CRLDistributionPoints</span><span class="op" id="7136845">,</span>&nbsp;<span class="ident" id="7136847">template</span><span class="op" id="7136855">.</span><span class="ident" id="7136856">CRLDistributionPoints</span><span class="op" id="7136877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7136881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7136886">if</span>&nbsp;<span class="op" id="7136889">!</span><span class="ident" id="7136890">bytes</span><span class="op" id="7136895">.</span><span class="ident" id="7136896">Equal</span><span class="op" id="7136901">(</span><span class="ident" id="7136902">cert</span><span class="op" id="7136906">.</span><span class="ident" id="7136907">SubjectKeyId</span><span class="op" id="7136919">,</span>&nbsp;<span class="op" id="7136921">[</span><span class="op" id="7136922">]</span><span class="builtintype" id="7136923">byte</span><span class="op" id="7136927">{</span><span class="num" id="7136928">4</span><span class="op" id="7136929">,</span>&nbsp;<span class="num" id="7136931">3</span><span class="op" id="7136932">,</span>&nbsp;<span class="num" id="7136934">2</span><span class="op" id="7136935">,</span>&nbsp;<span class="num" id="7136937">1</span><span class="op" id="7136938">}</span><span class="op" id="7136939">)</span>&nbsp;<span class="op" id="7136941">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7136946">t</span><span class="op" id="7136947">.</span><span class="ident" id="7136948">Errorf</span><span class="op" id="7136954">(</span><span class="string" id="7136955">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7137005">,</span>&nbsp;<span class="ident" id="7137007">test</span><span class="op" id="7137011">.</span><span class="ident" id="7137012">name</span><span class="op" id="7137016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7137020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7137025">if</span>&nbsp;<span class="ident" id="7137028">bytes</span><span class="op" id="7137033">.</span><span class="ident" id="7137034">Index</span><span class="op" id="7137039">(</span><span class="ident" id="7137040">derBytes</span><span class="op" id="7137048">,</span>&nbsp;<span class="ident" id="7137050">extraExtensionData</span><span class="op" id="7137068">)</span>&nbsp;<span class="op" id="7137070">==</span>&nbsp;<span class="op" id="7137073">-</span><span class="num" id="7137074">1</span>&nbsp;<span class="op" id="7137076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7137081">t</span><span class="op" id="7137082">.</span><span class="ident" id="7137083">Errorf</span><span class="op" id="7137089">(</span><span class="string" id="7137090">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7137137">,</span>&nbsp;<span class="ident" id="7137139">test</span><span class="op" id="7137143">.</span><span class="ident" id="7137144">name</span><span class="op" id="7137148">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7137152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7137157">if</span>&nbsp;<span class="ident" id="7137160">test</span><span class="op" id="7137164">.</span><span class="ident" id="7137165">checkSig</span>&nbsp;<span class="op" id="7137174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7137179">err</span>&nbsp;<span class="op" id="7137183">=</span>&nbsp;<span class="ident" id="7137185">cert</span><span class="op" id="7137189">.</span><span class="ident" id="7137190">CheckSignatureFrom</span><span class="op" id="7137208">(</span><span class="ident" id="7137209">cert</span><span class="op" id="7137213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7137218">if</span>&nbsp;<span class="ident" id="7137221">err</span>&nbsp;<span class="op" id="7137225">!=</span>&nbsp;<span class="ident" id="7137228">nil</span>&nbsp;<span class="op" id="7137232">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7137238">t</span><span class="op" id="7137239">.</span><span class="ident" id="7137240">Errorf</span><span class="op" id="7137246">(</span><span class="string" id="7137247">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7137286">,</span>&nbsp;<span class="ident" id="7137288">test</span><span class="op" id="7137292">.</span><span class="ident" id="7137293">name</span><span class="op" id="7137297">,</span>&nbsp;<span class="ident" id="7137299">err</span><span class="op" id="7137302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7137307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7137311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7137314">}</span><br>
<span class="lineno"></span><span class="op" id="7137316">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7137319">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7137380">var</span>&nbsp;<span class="ident" id="7137384">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7137401">=</span>&nbsp;<span class="string" id="7137403">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7138182">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7138245">var</span>&nbsp;<span class="ident" id="7138249">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7138272">=</span>&nbsp;<span class="string" id="7138274">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7139053">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7139116">var</span>&nbsp;<span class="ident" id="7139120">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7139143">=</span>&nbsp;<span class="string" id="7139145">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7140005">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7140068">var</span>&nbsp;<span class="ident" id="7140072">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7140095">=</span>&nbsp;<span class="string" id="7140097">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7141058">var</span>&nbsp;<span class="ident" id="7141062">ecdsaTests</span>&nbsp;<span class="op" id="7141073">=</span>&nbsp;<span class="op" id="7141075">[</span><span class="op" id="7141076">]</span><span class="keyword" id="7141077">struct</span>&nbsp;<span class="op" id="7141084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141087">sigAlgo</span>&nbsp;<span class="ident" id="7141095">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141115">pemCert</span>&nbsp;<span class="builtintype" id="7141123">string</span><br>
<span class="lineno"></span><span class="op" id="7141130">}</span><span class="op" id="7141131">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141134">{</span><span class="ident" id="7141135">ECDSAWithSHA1</span><span class="op" id="7141148">,</span>&nbsp;<span class="ident" id="7141150">ecdsaSHA1CertPem</span><span class="op" id="7141166">}</span><span class="op" id="7141167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141170">{</span><span class="ident" id="7141171">ECDSAWithSHA256</span><span class="op" id="7141186">,</span>&nbsp;<span class="ident" id="7141188">ecdsaSHA256p256CertPem</span><span class="op" id="7141210">}</span><span class="op" id="7141211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141214">{</span><span class="ident" id="7141215">ECDSAWithSHA256</span><span class="op" id="7141230">,</span>&nbsp;<span class="ident" id="7141232">ecdsaSHA256p384CertPem</span><span class="op" id="7141254">}</span><span class="op" id="7141255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141258">{</span><span class="ident" id="7141259">ECDSAWithSHA384</span><span class="op" id="7141274">,</span>&nbsp;<span class="ident" id="7141276">ecdsaSHA384p521CertPem</span><span class="op" id="7141298">}</span><span class="op" id="7141299">,</span><br>
<span class="lineno"></span><span class="op" id="7141301">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7141304">func</span>&nbsp;<span class="ident" id="7141309">TestECDSA</span><span class="op" id="7141318">(</span><span class="ident" id="7141319">t</span>&nbsp;<span class="op" id="7141321">*</span><span class="ident" id="7141322">testing</span><span class="op" id="7141329">.</span><span class="ident" id="7141330">T</span><span class="op" id="7141331">)</span>&nbsp;<span class="op" id="7141333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141336">for</span>&nbsp;<span class="ident" id="7141340">i</span><span class="op" id="7141341">,</span>&nbsp;<span class="ident" id="7141343">test</span>&nbsp;<span class="op" id="7141348">:=</span>&nbsp;<span class="keyword" id="7141351">range</span>&nbsp;<span class="ident" id="7141357">ecdsaTests</span>&nbsp;<span class="op" id="7141368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141372">pemBlock</span><span class="op" id="7141380">,</span>&nbsp;<span class="ident" id="7141382">_</span>&nbsp;<span class="op" id="7141384">:=</span>&nbsp;<span class="ident" id="7141387">pem</span><span class="op" id="7141390">.</span><span class="ident" id="7141391">Decode</span><span class="op" id="7141397">(</span><span class="op" id="7141398">[</span><span class="op" id="7141399">]</span><span class="builtintype" id="7141400">byte</span><span class="op" id="7141404">(</span><span class="ident" id="7141405">test</span><span class="op" id="7141409">.</span><span class="ident" id="7141410">pemCert</span><span class="op" id="7141417">)</span><span class="op" id="7141418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141422">cert</span><span class="op" id="7141426">,</span>&nbsp;<span class="ident" id="7141428">err</span>&nbsp;<span class="op" id="7141432">:=</span>&nbsp;<span class="ident" id="7141435">ParseCertificate</span><span class="op" id="7141451">(</span><span class="ident" id="7141452">pemBlock</span><span class="op" id="7141460">.</span><span class="ident" id="7141461">Bytes</span><span class="op" id="7141466">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141470">if</span>&nbsp;<span class="ident" id="7141473">err</span>&nbsp;<span class="op" id="7141477">!=</span>&nbsp;<span class="ident" id="7141480">nil</span>&nbsp;<span class="op" id="7141484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141489">t</span><span class="op" id="7141490">.</span><span class="ident" id="7141491">Errorf</span><span class="op" id="7141497">(</span><span class="string" id="7141498">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7141535">,</span>&nbsp;<span class="ident" id="7141537">i</span><span class="op" id="7141538">,</span>&nbsp;<span class="ident" id="7141540">err</span><span class="op" id="7141543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141548">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141563">if</span>&nbsp;<span class="ident" id="7141566">sa</span>&nbsp;<span class="op" id="7141569">:=</span>&nbsp;<span class="ident" id="7141572">cert</span><span class="op" id="7141576">.</span><span class="ident" id="7141577">SignatureAlgorithm</span><span class="op" id="7141595">;</span>&nbsp;<span class="ident" id="7141597">sa</span>&nbsp;<span class="op" id="7141600">!=</span>&nbsp;<span class="ident" id="7141603">test</span><span class="op" id="7141607">.</span><span class="ident" id="7141608">sigAlgo</span>&nbsp;<span class="op" id="7141616">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141621">t</span><span class="op" id="7141622">.</span><span class="ident" id="7141623">Errorf</span><span class="op" id="7141629">(</span><span class="string" id="7141630">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7141670">,</span>&nbsp;<span class="ident" id="7141672">i</span><span class="op" id="7141673">,</span>&nbsp;<span class="ident" id="7141675">sa</span><span class="op" id="7141677">,</span>&nbsp;<span class="ident" id="7141679">test</span><span class="op" id="7141683">.</span><span class="ident" id="7141684">sigAlgo</span><span class="op" id="7141691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141699">if</span>&nbsp;<span class="ident" id="7141702">parsedKey</span><span class="op" id="7141711">,</span>&nbsp;<span class="ident" id="7141713">ok</span>&nbsp;<span class="op" id="7141716">:=</span>&nbsp;<span class="ident" id="7141719">cert</span><span class="op" id="7141723">.</span><span class="ident" id="7141724">PublicKey</span><span class="op" id="7141733">.</span><span class="op" id="7141734">(</span><span class="op" id="7141735">*</span><span class="ident" id="7141736">ecdsa</span><span class="op" id="7141741">.</span><span class="ident" id="7141742">PublicKey</span><span class="op" id="7141751">)</span><span class="op" id="7141752">;</span>&nbsp;<span class="op" id="7141754">!</span><span class="ident" id="7141755">ok</span>&nbsp;<span class="op" id="7141758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141763">t</span><span class="op" id="7141764">.</span><span class="ident" id="7141765">Errorf</span><span class="op" id="7141771">(</span><span class="string" id="7141772">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7141819">,</span>&nbsp;<span class="ident" id="7141821">i</span><span class="op" id="7141822">,</span>&nbsp;<span class="ident" id="7141824">parsedKey</span><span class="op" id="7141833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141837">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141841">if</span>&nbsp;<span class="ident" id="7141844">pka</span>&nbsp;<span class="op" id="7141848">:=</span>&nbsp;<span class="ident" id="7141851">cert</span><span class="op" id="7141855">.</span><span class="ident" id="7141856">PublicKeyAlgorithm</span><span class="op" id="7141874">;</span>&nbsp;<span class="ident" id="7141876">pka</span>&nbsp;<span class="op" id="7141880">!=</span>&nbsp;<span class="ident" id="7141883">ECDSA</span>&nbsp;<span class="op" id="7141889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7141894">t</span><span class="op" id="7141895">.</span><span class="ident" id="7141896">Errorf</span><span class="op" id="7141902">(</span><span class="string" id="7141903">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7141947">,</span>&nbsp;<span class="ident" id="7141949">i</span><span class="op" id="7141950">,</span>&nbsp;<span class="ident" id="7141952">pka</span><span class="op" id="7141955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7141959">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7141963">if</span>&nbsp;<span class="ident" id="7141966">err</span>&nbsp;<span class="op" id="7141970">=</span>&nbsp;<span class="ident" id="7141972">cert</span><span class="op" id="7141976">.</span><span class="ident" id="7141977">CheckSignatureFrom</span><span class="op" id="7141995">(</span><span class="ident" id="7141996">cert</span><span class="op" id="7142000">)</span><span class="op" id="7142001">;</span>&nbsp;<span class="ident" id="7142003">err</span>&nbsp;<span class="op" id="7142007">!=</span>&nbsp;<span class="ident" id="7142010">nil</span>&nbsp;<span class="op" id="7142014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7142019">t</span><span class="op" id="7142020">.</span><span class="ident" id="7142021">Errorf</span><span class="op" id="7142027">(</span><span class="string" id="7142028">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7142069">,</span>&nbsp;<span class="ident" id="7142071">i</span><span class="op" id="7142072">,</span>&nbsp;<span class="ident" id="7142074">err</span><span class="op" id="7142077">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7142081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7142084">}</span><br>
<span class="lineno"></span><span class="op" id="7142086">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7142089">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7142136">var</span>&nbsp;<span class="ident" id="7142140">dsaCertPem</span>&nbsp;<span class="op" id="7142151">=</span>&nbsp;<span class="string" id="7142153">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7143621">func</span>&nbsp;<span class="ident" id="7143626">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7143662">(</span><span class="ident" id="7143663">t</span>&nbsp;<span class="op" id="7143665">*</span><span class="ident" id="7143666">testing</span><span class="op" id="7143673">.</span><span class="ident" id="7143674">T</span><span class="op" id="7143675">)</span>&nbsp;<span class="op" id="7143677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7143680">expectedKey</span>&nbsp;<span class="op" id="7143692">:=</span>&nbsp;<span class="op" id="7143695">&amp;</span><span class="ident" id="7143696">dsa</span><span class="op" id="7143699">.</span><span class="ident" id="7143700">PublicKey</span><span class="op" id="7143709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7143713">Parameters</span><span class="op" id="7143723">:</span>&nbsp;<span class="ident" id="7143725">dsa</span><span class="op" id="7143728">.</span><span class="ident" id="7143729">Parameters</span><span class="op" id="7143739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7143744">P</span><span class="op" id="7143745">:</span>&nbsp;<span class="ident" id="7143747">bigFromHexString</span><span class="op" id="7143763">(</span><span class="string" id="7143764">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7144024">)</span><span class="op" id="7144025">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144030">Q</span><span class="op" id="7144031">:</span>&nbsp;<span class="ident" id="7144033">bigFromHexString</span><span class="op" id="7144049">(</span><span class="string" id="7144050">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7144094">)</span><span class="op" id="7144095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144100">G</span><span class="op" id="7144101">:</span>&nbsp;<span class="ident" id="7144103">bigFromHexString</span><span class="op" id="7144119">(</span><span class="string" id="7144120">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7144380">)</span><span class="op" id="7144381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7144385">}</span><span class="op" id="7144386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144390">Y</span><span class="op" id="7144391">:</span>&nbsp;<span class="ident" id="7144393">bigFromHexString</span><span class="op" id="7144409">(</span><span class="string" id="7144410">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7144668">)</span><span class="op" id="7144669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7144672">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144675">pemBlock</span><span class="op" id="7144683">,</span>&nbsp;<span class="ident" id="7144685">_</span>&nbsp;<span class="op" id="7144687">:=</span>&nbsp;<span class="ident" id="7144690">pem</span><span class="op" id="7144693">.</span><span class="ident" id="7144694">Decode</span><span class="op" id="7144700">(</span><span class="op" id="7144701">[</span><span class="op" id="7144702">]</span><span class="builtintype" id="7144703">byte</span><span class="op" id="7144707">(</span><span class="ident" id="7144708">dsaCertPem</span><span class="op" id="7144718">)</span><span class="op" id="7144719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144722">cert</span><span class="op" id="7144726">,</span>&nbsp;<span class="ident" id="7144728">err</span>&nbsp;<span class="op" id="7144732">:=</span>&nbsp;<span class="ident" id="7144735">ParseCertificate</span><span class="op" id="7144751">(</span><span class="ident" id="7144752">pemBlock</span><span class="op" id="7144760">.</span><span class="ident" id="7144761">Bytes</span><span class="op" id="7144766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7144769">if</span>&nbsp;<span class="ident" id="7144772">err</span>&nbsp;<span class="op" id="7144776">!=</span>&nbsp;<span class="ident" id="7144779">nil</span>&nbsp;<span class="op" id="7144783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144787">t</span><span class="op" id="7144788">.</span><span class="ident" id="7144789">Fatalf</span><span class="op" id="7144795">(</span><span class="string" id="7144796">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7144829">,</span>&nbsp;<span class="ident" id="7144831">err</span><span class="op" id="7144834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7144837">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7144840">if</span>&nbsp;<span class="ident" id="7144843">cert</span><span class="op" id="7144847">.</span><span class="ident" id="7144848">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7144867">!=</span>&nbsp;<span class="ident" id="7144870">DSA</span>&nbsp;<span class="op" id="7144874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144878">t</span><span class="op" id="7144879">.</span><span class="ident" id="7144880">Errorf</span><span class="op" id="7144886">(</span><span class="string" id="7144887">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7144921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7144924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144927">parsedKey</span><span class="op" id="7144936">,</span>&nbsp;<span class="ident" id="7144938">ok</span>&nbsp;<span class="op" id="7144941">:=</span>&nbsp;<span class="ident" id="7144944">cert</span><span class="op" id="7144948">.</span><span class="ident" id="7144949">PublicKey</span><span class="op" id="7144958">.</span><span class="op" id="7144959">(</span><span class="op" id="7144960">*</span><span class="ident" id="7144961">dsa</span><span class="op" id="7144964">.</span><span class="ident" id="7144965">PublicKey</span><span class="op" id="7144974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7144977">if</span>&nbsp;<span class="op" id="7144980">!</span><span class="ident" id="7144981">ok</span>&nbsp;<span class="op" id="7144984">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7144988">t</span><span class="op" id="7144989">.</span><span class="ident" id="7144990">Fatalf</span><span class="op" id="7144996">(</span><span class="string" id="7144997">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7145031">,</span>&nbsp;<span class="ident" id="7145033">err</span><span class="op" id="7145036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7145042">if</span>&nbsp;<span class="ident" id="7145045">expectedKey</span><span class="op" id="7145056">.</span><span class="ident" id="7145057">Y</span><span class="op" id="7145058">.</span><span class="ident" id="7145059">Cmp</span><span class="op" id="7145062">(</span><span class="ident" id="7145063">parsedKey</span><span class="op" id="7145072">.</span><span class="ident" id="7145073">Y</span><span class="op" id="7145074">)</span>&nbsp;<span class="op" id="7145076">!=</span>&nbsp;<span class="num" id="7145079">0</span>&nbsp;<span class="op" id="7145081">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145086">expectedKey</span><span class="op" id="7145097">.</span><span class="ident" id="7145098">P</span><span class="op" id="7145099">.</span><span class="ident" id="7145100">Cmp</span><span class="op" id="7145103">(</span><span class="ident" id="7145104">parsedKey</span><span class="op" id="7145113">.</span><span class="ident" id="7145114">P</span><span class="op" id="7145115">)</span>&nbsp;<span class="op" id="7145117">!=</span>&nbsp;<span class="num" id="7145120">0</span>&nbsp;<span class="op" id="7145122">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145127">expectedKey</span><span class="op" id="7145138">.</span><span class="ident" id="7145139">Q</span><span class="op" id="7145140">.</span><span class="ident" id="7145141">Cmp</span><span class="op" id="7145144">(</span><span class="ident" id="7145145">parsedKey</span><span class="op" id="7145154">.</span><span class="ident" id="7145155">Q</span><span class="op" id="7145156">)</span>&nbsp;<span class="op" id="7145158">!=</span>&nbsp;<span class="num" id="7145161">0</span>&nbsp;<span class="op" id="7145163">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145168">expectedKey</span><span class="op" id="7145179">.</span><span class="ident" id="7145180">G</span><span class="op" id="7145181">.</span><span class="ident" id="7145182">Cmp</span><span class="op" id="7145185">(</span><span class="ident" id="7145186">parsedKey</span><span class="op" id="7145195">.</span><span class="ident" id="7145196">G</span><span class="op" id="7145197">)</span>&nbsp;<span class="op" id="7145199">!=</span>&nbsp;<span class="num" id="7145202">0</span>&nbsp;<span class="op" id="7145204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145208">t</span><span class="op" id="7145209">.</span><span class="ident" id="7145210">Fatal</span><span class="op" id="7145215">(</span><span class="string" id="7145216">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7145254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145257">}</span><br>
<span class="lineno"></span><span class="op" id="7145259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7145262">func</span>&nbsp;<span class="ident" id="7145267">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7145312">(</span><span class="ident" id="7145313">t</span>&nbsp;<span class="op" id="7145315">*</span><span class="ident" id="7145316">testing</span><span class="op" id="7145323">.</span><span class="ident" id="7145324">T</span><span class="op" id="7145325">)</span>&nbsp;<span class="op" id="7145327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145330">pemBlock</span><span class="op" id="7145338">,</span>&nbsp;<span class="ident" id="7145340">_</span>&nbsp;<span class="op" id="7145342">:=</span>&nbsp;<span class="ident" id="7145345">pem</span><span class="op" id="7145348">.</span><span class="ident" id="7145349">Decode</span><span class="op" id="7145355">(</span><span class="op" id="7145356">[</span><span class="op" id="7145357">]</span><span class="builtintype" id="7145358">byte</span><span class="op" id="7145362">(</span><span class="ident" id="7145363">dsaCertPem</span><span class="op" id="7145373">)</span><span class="op" id="7145374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145377">cert</span><span class="op" id="7145381">,</span>&nbsp;<span class="ident" id="7145383">err</span>&nbsp;<span class="op" id="7145387">:=</span>&nbsp;<span class="ident" id="7145390">ParseCertificate</span><span class="op" id="7145406">(</span><span class="ident" id="7145407">pemBlock</span><span class="op" id="7145415">.</span><span class="ident" id="7145416">Bytes</span><span class="op" id="7145421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7145424">if</span>&nbsp;<span class="ident" id="7145427">err</span>&nbsp;<span class="op" id="7145431">!=</span>&nbsp;<span class="ident" id="7145434">nil</span>&nbsp;<span class="op" id="7145438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145442">t</span><span class="op" id="7145443">.</span><span class="ident" id="7145444">Fatalf</span><span class="op" id="7145450">(</span><span class="string" id="7145451">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7145484">,</span>&nbsp;<span class="ident" id="7145486">err</span><span class="op" id="7145489">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7145495">if</span>&nbsp;<span class="ident" id="7145498">cert</span><span class="op" id="7145502">.</span><span class="ident" id="7145503">SignatureAlgorithm</span>&nbsp;<span class="op" id="7145522">!=</span>&nbsp;<span class="ident" id="7145525">DSAWithSHA1</span>&nbsp;<span class="op" id="7145537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145541">t</span><span class="op" id="7145542">.</span><span class="ident" id="7145543">Errorf</span><span class="op" id="7145549">(</span><span class="string" id="7145550">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7145598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145601">}</span><br>
<span class="lineno"></span><span class="op" id="7145603">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7145606">func</span>&nbsp;<span class="ident" id="7145611">TestVerifyCertificateWithDSASignature</span><span class="op" id="7145648">(</span><span class="ident" id="7145649">t</span>&nbsp;<span class="op" id="7145651">*</span><span class="ident" id="7145652">testing</span><span class="op" id="7145659">.</span><span class="ident" id="7145660">T</span><span class="op" id="7145661">)</span>&nbsp;<span class="op" id="7145663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145666">pemBlock</span><span class="op" id="7145674">,</span>&nbsp;<span class="ident" id="7145676">_</span>&nbsp;<span class="op" id="7145678">:=</span>&nbsp;<span class="ident" id="7145681">pem</span><span class="op" id="7145684">.</span><span class="ident" id="7145685">Decode</span><span class="op" id="7145691">(</span><span class="op" id="7145692">[</span><span class="op" id="7145693">]</span><span class="builtintype" id="7145694">byte</span><span class="op" id="7145698">(</span><span class="ident" id="7145699">dsaCertPem</span><span class="op" id="7145709">)</span><span class="op" id="7145710">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145713">cert</span><span class="op" id="7145717">,</span>&nbsp;<span class="ident" id="7145719">err</span>&nbsp;<span class="op" id="7145723">:=</span>&nbsp;<span class="ident" id="7145726">ParseCertificate</span><span class="op" id="7145742">(</span><span class="ident" id="7145743">pemBlock</span><span class="op" id="7145751">.</span><span class="ident" id="7145752">Bytes</span><span class="op" id="7145757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7145760">if</span>&nbsp;<span class="ident" id="7145763">err</span>&nbsp;<span class="op" id="7145767">!=</span>&nbsp;<span class="ident" id="7145770">nil</span>&nbsp;<span class="op" id="7145774">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145778">t</span><span class="op" id="7145779">.</span><span class="ident" id="7145780">Fatalf</span><span class="op" id="7145786">(</span><span class="string" id="7145787">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7145820">,</span>&nbsp;<span class="ident" id="7145822">err</span><span class="op" id="7145825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7145831">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7145860">if</span>&nbsp;<span class="ident" id="7145863">err</span>&nbsp;<span class="op" id="7145867">=</span>&nbsp;<span class="ident" id="7145869">cert</span><span class="op" id="7145873">.</span><span class="ident" id="7145874">CheckSignatureFrom</span><span class="op" id="7145892">(</span><span class="ident" id="7145893">cert</span><span class="op" id="7145897">)</span><span class="op" id="7145898">;</span>&nbsp;<span class="ident" id="7145900">err</span>&nbsp;<span class="op" id="7145904">!=</span>&nbsp;<span class="ident" id="7145907">nil</span>&nbsp;<span class="op" id="7145911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7145915">t</span><span class="op" id="7145916">.</span><span class="ident" id="7145917">Fatalf</span><span class="op" id="7145923">(</span><span class="string" id="7145924">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7145965">,</span>&nbsp;<span class="ident" id="7145967">err</span><span class="op" id="7145970">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7145973">}</span><br>
<span class="lineno"></span><span class="op" id="7145975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7145978">const</span>&nbsp;<span class="ident" id="7145984">pemCertificate</span>&nbsp;<span class="op" id="7145999">=</span>&nbsp;<span class="string" id="7146001">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7146719">func</span>&nbsp;<span class="ident" id="7146724">TestCRLCreation</span><span class="op" id="7146739">(</span><span class="ident" id="7146740">t</span>&nbsp;<span class="op" id="7146742">*</span><span class="ident" id="7146743">testing</span><span class="op" id="7146750">.</span><span class="ident" id="7146751">T</span><span class="op" id="7146752">)</span>&nbsp;<span class="op" id="7146754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146757">block</span><span class="op" id="7146762">,</span>&nbsp;<span class="ident" id="7146764">_</span>&nbsp;<span class="op" id="7146766">:=</span>&nbsp;<span class="ident" id="7146769">pem</span><span class="op" id="7146772">.</span><span class="ident" id="7146773">Decode</span><span class="op" id="7146779">(</span><span class="op" id="7146780">[</span><span class="op" id="7146781">]</span><span class="builtintype" id="7146782">byte</span><span class="op" id="7146786">(</span><span class="ident" id="7146787">pemPrivateKey</span><span class="op" id="7146800">)</span><span class="op" id="7146801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146804">priv</span><span class="op" id="7146808">,</span>&nbsp;<span class="ident" id="7146810">_</span>&nbsp;<span class="op" id="7146812">:=</span>&nbsp;<span class="ident" id="7146815">ParsePKCS1PrivateKey</span><span class="op" id="7146835">(</span><span class="ident" id="7146836">block</span><span class="op" id="7146841">.</span><span class="ident" id="7146842">Bytes</span><span class="op" id="7146847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146850">block</span><span class="op" id="7146855">,</span>&nbsp;<span class="ident" id="7146857">_</span>&nbsp;<span class="op" id="7146859">=</span>&nbsp;<span class="ident" id="7146861">pem</span><span class="op" id="7146864">.</span><span class="ident" id="7146865">Decode</span><span class="op" id="7146871">(</span><span class="op" id="7146872">[</span><span class="op" id="7146873">]</span><span class="builtintype" id="7146874">byte</span><span class="op" id="7146878">(</span><span class="ident" id="7146879">pemCertificate</span><span class="op" id="7146893">)</span><span class="op" id="7146894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146897">cert</span><span class="op" id="7146901">,</span>&nbsp;<span class="ident" id="7146903">_</span>&nbsp;<span class="op" id="7146905">:=</span>&nbsp;<span class="ident" id="7146908">ParseCertificate</span><span class="op" id="7146924">(</span><span class="ident" id="7146925">block</span><span class="op" id="7146930">.</span><span class="ident" id="7146931">Bytes</span><span class="op" id="7146936">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146940">now</span>&nbsp;<span class="op" id="7146944">:=</span>&nbsp;<span class="ident" id="7146947">time</span><span class="op" id="7146951">.</span><span class="ident" id="7146952">Unix</span><span class="op" id="7146956">(</span><span class="num" id="7146957">1000</span><span class="op" id="7146961">,</span>&nbsp;<span class="num" id="7146963">0</span><span class="op" id="7146964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146967">expiry</span>&nbsp;<span class="op" id="7146974">:=</span>&nbsp;<span class="ident" id="7146977">time</span><span class="op" id="7146981">.</span><span class="ident" id="7146982">Unix</span><span class="op" id="7146986">(</span><span class="num" id="7146987">10000</span><span class="op" id="7146992">,</span>&nbsp;<span class="num" id="7146994">0</span><span class="op" id="7146995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7146999">revokedCerts</span>&nbsp;<span class="op" id="7147012">:=</span>&nbsp;<span class="op" id="7147015">[</span><span class="op" id="7147016">]</span><span class="ident" id="7147017">pkix</span><span class="op" id="7147021">.</span><span class="ident" id="7147022">RevokedCertificate</span><span class="op" id="7147040">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147049">SerialNumber</span><span class="op" id="7147061">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7147065">big</span><span class="op" id="7147068">.</span><span class="ident" id="7147069">NewInt</span><span class="op" id="7147075">(</span><span class="num" id="7147076">1</span><span class="op" id="7147077">)</span><span class="op" id="7147078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147083">RevocationTime</span><span class="op" id="7147097">:</span>&nbsp;<span class="ident" id="7147099">now</span><span class="op" id="7147102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147106">}</span><span class="op" id="7147107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147111">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147116">SerialNumber</span><span class="op" id="7147128">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7147132">big</span><span class="op" id="7147135">.</span><span class="ident" id="7147136">NewInt</span><span class="op" id="7147142">(</span><span class="num" id="7147143">42</span><span class="op" id="7147145">)</span><span class="op" id="7147146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147151">RevocationTime</span><span class="op" id="7147165">:</span>&nbsp;<span class="ident" id="7147167">now</span><span class="op" id="7147170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147174">}</span><span class="op" id="7147175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147182">crlBytes</span><span class="op" id="7147190">,</span>&nbsp;<span class="ident" id="7147192">err</span>&nbsp;<span class="op" id="7147196">:=</span>&nbsp;<span class="ident" id="7147199">cert</span><span class="op" id="7147203">.</span><span class="ident" id="7147204">CreateCRL</span><span class="op" id="7147213">(</span><span class="ident" id="7147214">rand</span><span class="op" id="7147218">.</span><span class="ident" id="7147219">Reader</span><span class="op" id="7147225">,</span>&nbsp;<span class="ident" id="7147227">priv</span><span class="op" id="7147231">,</span>&nbsp;<span class="ident" id="7147233">revokedCerts</span><span class="op" id="7147245">,</span>&nbsp;<span class="ident" id="7147247">now</span><span class="op" id="7147250">,</span>&nbsp;<span class="ident" id="7147252">expiry</span><span class="op" id="7147258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147261">if</span>&nbsp;<span class="ident" id="7147264">err</span>&nbsp;<span class="op" id="7147268">!=</span>&nbsp;<span class="ident" id="7147271">nil</span>&nbsp;<span class="op" id="7147275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147279">t</span><span class="op" id="7147280">.</span><span class="ident" id="7147281">Errorf</span><span class="op" id="7147287">(</span><span class="string" id="7147288">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7147312">,</span>&nbsp;<span class="ident" id="7147314">err</span><span class="op" id="7147317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147324">_</span><span class="op" id="7147325">,</span>&nbsp;<span class="ident" id="7147327">err</span>&nbsp;<span class="op" id="7147331">=</span>&nbsp;<span class="ident" id="7147333">ParseDERCRL</span><span class="op" id="7147344">(</span><span class="ident" id="7147345">crlBytes</span><span class="op" id="7147353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147356">if</span>&nbsp;<span class="ident" id="7147359">err</span>&nbsp;<span class="op" id="7147363">!=</span>&nbsp;<span class="ident" id="7147366">nil</span>&nbsp;<span class="op" id="7147370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147374">t</span><span class="op" id="7147375">.</span><span class="ident" id="7147376">Errorf</span><span class="op" id="7147382">(</span><span class="string" id="7147383">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7147408">,</span>&nbsp;<span class="ident" id="7147410">err</span><span class="op" id="7147413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147416">}</span><br>
<span class="lineno"></span><span class="op" id="7147418">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7147421">func</span>&nbsp;<span class="ident" id="7147426">fromBase64</span><span class="op" id="7147436">(</span><span class="ident" id="7147437">in</span>&nbsp;<span class="builtintype" id="7147440">string</span><span class="op" id="7147446">)</span>&nbsp;<span class="op" id="7147448">[</span><span class="op" id="7147449">]</span><span class="builtintype" id="7147450">byte</span>&nbsp;<span class="op" id="7147455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147458">out</span>&nbsp;<span class="op" id="7147462">:=</span>&nbsp;<span class="builtinfunc" id="7147465">make</span><span class="op" id="7147469">(</span><span class="op" id="7147470">[</span><span class="op" id="7147471">]</span><span class="builtintype" id="7147472">byte</span><span class="op" id="7147476">,</span>&nbsp;<span class="ident" id="7147478">base64</span><span class="op" id="7147484">.</span><span class="ident" id="7147485">StdEncoding</span><span class="op" id="7147496">.</span><span class="ident" id="7147497">DecodedLen</span><span class="op" id="7147507">(</span><span class="builtinfunc" id="7147508">len</span><span class="op" id="7147511">(</span><span class="ident" id="7147512">in</span><span class="op" id="7147514">)</span><span class="op" id="7147515">)</span><span class="op" id="7147516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147519">n</span><span class="op" id="7147520">,</span>&nbsp;<span class="ident" id="7147522">err</span>&nbsp;<span class="op" id="7147526">:=</span>&nbsp;<span class="ident" id="7147529">base64</span><span class="op" id="7147535">.</span><span class="ident" id="7147536">StdEncoding</span><span class="op" id="7147547">.</span><span class="ident" id="7147548">Decode</span><span class="op" id="7147554">(</span><span class="ident" id="7147555">out</span><span class="op" id="7147558">,</span>&nbsp;<span class="op" id="7147560">[</span><span class="op" id="7147561">]</span><span class="builtintype" id="7147562">byte</span><span class="op" id="7147566">(</span><span class="ident" id="7147567">in</span><span class="op" id="7147569">)</span><span class="op" id="7147570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147573">if</span>&nbsp;<span class="ident" id="7147576">err</span>&nbsp;<span class="op" id="7147580">!=</span>&nbsp;<span class="ident" id="7147583">nil</span>&nbsp;<span class="op" id="7147587">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7147591">panic</span><span class="op" id="7147596">(</span><span class="string" id="7147597">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7147622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147628">return</span>&nbsp;<span class="ident" id="7147635">out</span><span class="op" id="7147638">[</span><span class="op" id="7147639">:</span><span class="ident" id="7147640">n</span><span class="op" id="7147641">]</span><br>
<span class="lineno"></span><span class="op" id="7147643">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7147646">func</span>&nbsp;<span class="ident" id="7147651">TestParseDERCRL</span><span class="op" id="7147666">(</span><span class="ident" id="7147667">t</span>&nbsp;<span class="op" id="7147669">*</span><span class="ident" id="7147670">testing</span><span class="op" id="7147677">.</span><span class="ident" id="7147678">T</span><span class="op" id="7147679">)</span>&nbsp;<span class="op" id="7147681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147684">derBytes</span>&nbsp;<span class="op" id="7147693">:=</span>&nbsp;<span class="ident" id="7147696">fromBase64</span><span class="op" id="7147706">(</span><span class="ident" id="7147707">derCRLBase64</span><span class="op" id="7147719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147722">certList</span><span class="op" id="7147730">,</span>&nbsp;<span class="ident" id="7147732">err</span>&nbsp;<span class="op" id="7147736">:=</span>&nbsp;<span class="ident" id="7147739">ParseDERCRL</span><span class="op" id="7147750">(</span><span class="ident" id="7147751">derBytes</span><span class="op" id="7147759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147762">if</span>&nbsp;<span class="ident" id="7147765">err</span>&nbsp;<span class="op" id="7147769">!=</span>&nbsp;<span class="ident" id="7147772">nil</span>&nbsp;<span class="op" id="7147776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147780">t</span><span class="op" id="7147781">.</span><span class="ident" id="7147782">Errorf</span><span class="op" id="7147788">(</span><span class="string" id="7147789">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7147808">,</span>&nbsp;<span class="ident" id="7147810">err</span><span class="op" id="7147813">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147817">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7147825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147828">numCerts</span>&nbsp;<span class="op" id="7147837">:=</span>&nbsp;<span class="builtinfunc" id="7147840">len</span><span class="op" id="7147843">(</span><span class="ident" id="7147844">certList</span><span class="op" id="7147852">.</span><span class="ident" id="7147853">TBSCertList</span><span class="op" id="7147864">.</span><span class="ident" id="7147865">RevokedCertificates</span><span class="op" id="7147884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147887">expected</span>&nbsp;<span class="op" id="7147896">:=</span>&nbsp;<span class="num" id="7147899">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7147903">if</span>&nbsp;<span class="ident" id="7147906">numCerts</span>&nbsp;<span class="op" id="7147915">!=</span>&nbsp;<span class="ident" id="7147918">expected</span>&nbsp;<span class="op" id="7147927">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7147931">t</span><span class="op" id="7147932">.</span><span class="ident" id="7147933">Errorf</span><span class="op" id="7147939">(</span><span class="string" id="7147940">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7147994">,</span>&nbsp;<span class="ident" id="7147996">numCerts</span><span class="op" id="7148004">,</span>&nbsp;<span class="ident" id="7148006">expected</span><span class="op" id="7148014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7148017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148021">if</span>&nbsp;<span class="ident" id="7148024">certList</span><span class="op" id="7148032">.</span><span class="ident" id="7148033">HasExpired</span><span class="op" id="7148043">(</span><span class="ident" id="7148044">time</span><span class="op" id="7148048">.</span><span class="ident" id="7148049">Unix</span><span class="op" id="7148053">(</span><span class="num" id="7148054">1302517272</span><span class="op" id="7148064">,</span>&nbsp;<span class="num" id="7148066">0</span><span class="op" id="7148067">)</span><span class="op" id="7148068">)</span>&nbsp;<span class="op" id="7148070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148074">t</span><span class="op" id="7148075">.</span><span class="ident" id="7148076">Errorf</span><span class="op" id="7148082">(</span><span class="string" id="7148083">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7148121">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7148124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7148128">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7148187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7148190">func</span>&nbsp;<span class="ident" id="7148195">TestCRLWithoutExpiry</span><span class="op" id="7148215">(</span><span class="ident" id="7148216">t</span>&nbsp;<span class="op" id="7148218">*</span><span class="ident" id="7148219">testing</span><span class="op" id="7148226">.</span><span class="ident" id="7148227">T</span><span class="op" id="7148228">)</span>&nbsp;<span class="op" id="7148230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148233">derBytes</span>&nbsp;<span class="op" id="7148242">:=</span>&nbsp;<span class="ident" id="7148245">fromBase64</span><span class="op" id="7148255">(</span><span class="string" id="7148256">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7148550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148553">certList</span><span class="op" id="7148561">,</span>&nbsp;<span class="ident" id="7148563">err</span>&nbsp;<span class="op" id="7148567">:=</span>&nbsp;<span class="ident" id="7148570">ParseDERCRL</span><span class="op" id="7148581">(</span><span class="ident" id="7148582">derBytes</span><span class="op" id="7148590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148593">if</span>&nbsp;<span class="ident" id="7148596">err</span>&nbsp;<span class="op" id="7148600">!=</span>&nbsp;<span class="ident" id="7148603">nil</span>&nbsp;<span class="op" id="7148607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148611">t</span><span class="op" id="7148612">.</span><span class="ident" id="7148613">Fatal</span><span class="op" id="7148618">(</span><span class="ident" id="7148619">err</span><span class="op" id="7148622">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7148625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148628">if</span>&nbsp;<span class="op" id="7148631">!</span><span class="ident" id="7148632">certList</span><span class="op" id="7148640">.</span><span class="ident" id="7148641">TBSCertList</span><span class="op" id="7148652">.</span><span class="ident" id="7148653">NextUpdate</span><span class="op" id="7148663">.</span><span class="ident" id="7148664">IsZero</span><span class="op" id="7148670">(</span><span class="op" id="7148671">)</span>&nbsp;<span class="op" id="7148673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148677">t</span><span class="op" id="7148678">.</span><span class="ident" id="7148679">Errorf</span><span class="op" id="7148685">(</span><span class="string" id="7148686">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7148720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7148723">}</span><br>
<span class="lineno"></span><span class="op" id="7148725">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7148728">func</span>&nbsp;<span class="ident" id="7148733">TestParsePEMCRL</span><span class="op" id="7148748">(</span><span class="ident" id="7148749">t</span>&nbsp;<span class="op" id="7148751">*</span><span class="ident" id="7148752">testing</span><span class="op" id="7148759">.</span><span class="ident" id="7148760">T</span><span class="op" id="7148761">)</span>&nbsp;<span class="op" id="7148763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148766">pemBytes</span>&nbsp;<span class="op" id="7148775">:=</span>&nbsp;<span class="ident" id="7148778">fromBase64</span><span class="op" id="7148788">(</span><span class="ident" id="7148789">pemCRLBase64</span><span class="op" id="7148801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148804">certList</span><span class="op" id="7148812">,</span>&nbsp;<span class="ident" id="7148814">err</span>&nbsp;<span class="op" id="7148818">:=</span>&nbsp;<span class="ident" id="7148821">ParseCRL</span><span class="op" id="7148829">(</span><span class="ident" id="7148830">pemBytes</span><span class="op" id="7148838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148841">if</span>&nbsp;<span class="ident" id="7148844">err</span>&nbsp;<span class="op" id="7148848">!=</span>&nbsp;<span class="ident" id="7148851">nil</span>&nbsp;<span class="op" id="7148855">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148859">t</span><span class="op" id="7148860">.</span><span class="ident" id="7148861">Errorf</span><span class="op" id="7148867">(</span><span class="string" id="7148868">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7148887">,</span>&nbsp;<span class="ident" id="7148889">err</span><span class="op" id="7148892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148896">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7148904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148907">numCerts</span>&nbsp;<span class="op" id="7148916">:=</span>&nbsp;<span class="builtinfunc" id="7148919">len</span><span class="op" id="7148922">(</span><span class="ident" id="7148923">certList</span><span class="op" id="7148931">.</span><span class="ident" id="7148932">TBSCertList</span><span class="op" id="7148943">.</span><span class="ident" id="7148944">RevokedCertificates</span><span class="op" id="7148963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7148966">expected</span>&nbsp;<span class="op" id="7148975">:=</span>&nbsp;<span class="num" id="7148978">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7148981">if</span>&nbsp;<span class="ident" id="7148984">numCerts</span>&nbsp;<span class="op" id="7148993">!=</span>&nbsp;<span class="ident" id="7148996">expected</span>&nbsp;<span class="op" id="7149005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7149009">t</span><span class="op" id="7149010">.</span><span class="ident" id="7149011">Errorf</span><span class="op" id="7149017">(</span><span class="string" id="7149018">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7149072">,</span>&nbsp;<span class="ident" id="7149074">numCerts</span><span class="op" id="7149082">,</span>&nbsp;<span class="ident" id="7149084">expected</span><span class="op" id="7149092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7149095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7149099">if</span>&nbsp;<span class="ident" id="7149102">certList</span><span class="op" id="7149110">.</span><span class="ident" id="7149111">HasExpired</span><span class="op" id="7149121">(</span><span class="ident" id="7149122">time</span><span class="op" id="7149126">.</span><span class="ident" id="7149127">Unix</span><span class="op" id="7149131">(</span><span class="num" id="7149132">1302517272</span><span class="op" id="7149142">,</span>&nbsp;<span class="num" id="7149144">0</span><span class="op" id="7149145">)</span><span class="op" id="7149146">)</span>&nbsp;<span class="op" id="7149148">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7149152">t</span><span class="op" id="7149153">.</span><span class="ident" id="7149154">Errorf</span><span class="op" id="7149160">(</span><span class="string" id="7149161">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7149199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7149202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7149206">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7149265">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7149268">func</span>&nbsp;<span class="ident" id="7149273">TestImports</span><span class="op" id="7149284">(</span><span class="ident" id="7149285">t</span>&nbsp;<span class="op" id="7149287">*</span><span class="ident" id="7149288">testing</span><span class="op" id="7149295">.</span><span class="ident" id="7149296">T</span><span class="op" id="7149297">)</span>&nbsp;<span class="op" id="7149299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7149302">switch</span>&nbsp;<span class="ident" id="7149309">runtime</span><span class="op" id="7149316">.</span><span class="ident" id="7149317">GOOS</span>&nbsp;<span class="op" id="7149322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7149325">case</span>&nbsp;<span class="string" id="7149330">&#34;android&#34;</span><span class="op" id="7149339">,</span>&nbsp;<span class="string" id="7149341">&#34;nacl&#34;</span><span class="op" id="7149347">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7149351">t</span><span class="op" id="7149352">.</span><span class="ident" id="7149353">Skipf</span><span class="op" id="7149358">(</span><span class="string" id="7149359">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7149375">,</span>&nbsp;<span class="ident" id="7149377">runtime</span><span class="op" id="7149384">.</span><span class="ident" id="7149385">GOOS</span><span class="op" id="7149389">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7149392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7149396">if</span>&nbsp;<span class="ident" id="7149399">err</span>&nbsp;<span class="op" id="7149403">:=</span>&nbsp;<span class="ident" id="7149406">exec</span><span class="op" id="7149410">.</span><span class="ident" id="7149411">Command</span><span class="op" id="7149418">(</span><span class="string" id="7149419">&#34;go&#34;</span><span class="op" id="7149423">,</span>&nbsp;<span class="string" id="7149425">&#34;run&#34;</span><span class="op" id="7149430">,</span>&nbsp;<span class="string" id="7149432">&#34;x509_test_import.go&#34;</span><span class="op" id="7149453">)</span><span class="op" id="7149454">.</span><span class="ident" id="7149455">Run</span><span class="op" id="7149458">(</span><span class="op" id="7149459">)</span><span class="op" id="7149460">;</span>&nbsp;<span class="ident" id="7149462">err</span>&nbsp;<span class="op" id="7149466">!=</span>&nbsp;<span class="ident" id="7149469">nil</span>&nbsp;<span class="op" id="7149473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7149477">t</span><span class="op" id="7149478">.</span><span class="ident" id="7149479">Errorf</span><span class="op" id="7149485">(</span><span class="string" id="7149486">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7149525">,</span>&nbsp;<span class="ident" id="7149527">err</span><span class="op" id="7149530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7149533">}</span><br>
<span class="lineno">750</span><span class="op" id="7149535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7149538">const</span>&nbsp;<span class="ident" id="7149544">derCRLBase64</span>&nbsp;<span class="op" id="7149557">=</span>&nbsp;<span class="string" id="7149559">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7154235">const</span>&nbsp;<span class="ident" id="7154241">pemCRLBase64</span>&nbsp;<span class="op" id="7154254">=</span>&nbsp;<span class="string" id="7154256">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7155260">func</span>&nbsp;<span class="ident" id="7155265">TestCreateCertificateRequest</span><span class="op" id="7155293">(</span><span class="ident" id="7155294">t</span>&nbsp;<span class="op" id="7155296">*</span><span class="ident" id="7155297">testing</span><span class="op" id="7155304">.</span><span class="ident" id="7155305">T</span><span class="op" id="7155306">)</span>&nbsp;<span class="op" id="7155308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155311">random</span>&nbsp;<span class="op" id="7155318">:=</span>&nbsp;<span class="ident" id="7155321">rand</span><span class="op" id="7155325">.</span><span class="ident" id="7155326">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155335">block</span><span class="op" id="7155340">,</span>&nbsp;<span class="ident" id="7155342">_</span>&nbsp;<span class="op" id="7155344">:=</span>&nbsp;<span class="ident" id="7155347">pem</span><span class="op" id="7155350">.</span><span class="ident" id="7155351">Decode</span><span class="op" id="7155357">(</span><span class="op" id="7155358">[</span><span class="op" id="7155359">]</span><span class="builtintype" id="7155360">byte</span><span class="op" id="7155364">(</span><span class="ident" id="7155365">pemPrivateKey</span><span class="op" id="7155378">)</span><span class="op" id="7155379">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155382">rsaPriv</span><span class="op" id="7155389">,</span>&nbsp;<span class="ident" id="7155391">err</span>&nbsp;<span class="op" id="7155395">:=</span>&nbsp;<span class="ident" id="7155398">ParsePKCS1PrivateKey</span><span class="op" id="7155418">(</span><span class="ident" id="7155419">block</span><span class="op" id="7155424">.</span><span class="ident" id="7155425">Bytes</span><span class="op" id="7155430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155433">if</span>&nbsp;<span class="ident" id="7155436">err</span>&nbsp;<span class="op" id="7155440">!=</span>&nbsp;<span class="ident" id="7155443">nil</span>&nbsp;<span class="op" id="7155447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155451">t</span><span class="op" id="7155452">.</span><span class="ident" id="7155453">Fatalf</span><span class="op" id="7155459">(</span><span class="string" id="7155460">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7155493">,</span>&nbsp;<span class="ident" id="7155495">err</span><span class="op" id="7155498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155505">ecdsa256Priv</span><span class="op" id="7155517">,</span>&nbsp;<span class="ident" id="7155519">err</span>&nbsp;<span class="op" id="7155523">:=</span>&nbsp;<span class="ident" id="7155526">ecdsa</span><span class="op" id="7155531">.</span><span class="ident" id="7155532">GenerateKey</span><span class="op" id="7155543">(</span><span class="ident" id="7155544">elliptic</span><span class="op" id="7155552">.</span><span class="ident" id="7155553">P256</span><span class="op" id="7155557">(</span><span class="op" id="7155558">)</span><span class="op" id="7155559">,</span>&nbsp;<span class="ident" id="7155561">rand</span><span class="op" id="7155565">.</span><span class="ident" id="7155566">Reader</span><span class="op" id="7155572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155575">if</span>&nbsp;<span class="ident" id="7155578">err</span>&nbsp;<span class="op" id="7155582">!=</span>&nbsp;<span class="ident" id="7155585">nil</span>&nbsp;<span class="op" id="7155589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155593">t</span><span class="op" id="7155594">.</span><span class="ident" id="7155595">Fatalf</span><span class="op" id="7155601">(</span><span class="string" id="7155602">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7155636">,</span>&nbsp;<span class="ident" id="7155638">err</span><span class="op" id="7155641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155648">ecdsa384Priv</span><span class="op" id="7155660">,</span>&nbsp;<span class="ident" id="7155662">err</span>&nbsp;<span class="op" id="7155666">:=</span>&nbsp;<span class="ident" id="7155669">ecdsa</span><span class="op" id="7155674">.</span><span class="ident" id="7155675">GenerateKey</span><span class="op" id="7155686">(</span><span class="ident" id="7155687">elliptic</span><span class="op" id="7155695">.</span><span class="ident" id="7155696">P384</span><span class="op" id="7155700">(</span><span class="op" id="7155701">)</span><span class="op" id="7155702">,</span>&nbsp;<span class="ident" id="7155704">rand</span><span class="op" id="7155708">.</span><span class="ident" id="7155709">Reader</span><span class="op" id="7155715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155718">if</span>&nbsp;<span class="ident" id="7155721">err</span>&nbsp;<span class="op" id="7155725">!=</span>&nbsp;<span class="ident" id="7155728">nil</span>&nbsp;<span class="op" id="7155732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155736">t</span><span class="op" id="7155737">.</span><span class="ident" id="7155738">Fatalf</span><span class="op" id="7155744">(</span><span class="string" id="7155745">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7155779">,</span>&nbsp;<span class="ident" id="7155781">err</span><span class="op" id="7155784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155791">ecdsa521Priv</span><span class="op" id="7155803">,</span>&nbsp;<span class="ident" id="7155805">err</span>&nbsp;<span class="op" id="7155809">:=</span>&nbsp;<span class="ident" id="7155812">ecdsa</span><span class="op" id="7155817">.</span><span class="ident" id="7155818">GenerateKey</span><span class="op" id="7155829">(</span><span class="ident" id="7155830">elliptic</span><span class="op" id="7155838">.</span><span class="ident" id="7155839">P521</span><span class="op" id="7155843">(</span><span class="op" id="7155844">)</span><span class="op" id="7155845">,</span>&nbsp;<span class="ident" id="7155847">rand</span><span class="op" id="7155851">.</span><span class="ident" id="7155852">Reader</span><span class="op" id="7155858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7155861">if</span>&nbsp;<span class="ident" id="7155864">err</span>&nbsp;<span class="op" id="7155868">!=</span>&nbsp;<span class="ident" id="7155871">nil</span>&nbsp;<span class="op" id="7155875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155879">t</span><span class="op" id="7155880">.</span><span class="ident" id="7155881">Fatalf</span><span class="op" id="7155887">(</span><span class="string" id="7155888">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7155922">,</span>&nbsp;<span class="ident" id="7155924">err</span><span class="op" id="7155927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7155930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155934">tests</span>&nbsp;<span class="op" id="7155940">:=</span>&nbsp;<span class="op" id="7155943">[</span><span class="op" id="7155944">]</span><span class="keyword" id="7155945">struct</span>&nbsp;<span class="op" id="7155952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155956">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7155964">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155973">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7155981">interface</span><span class="op" id="7155990">{</span><span class="op" id="7155991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7155995">sigAlgo</span>&nbsp;<span class="ident" id="7156003">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156023">}</span><span class="op" id="7156024">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156028">{</span><span class="string" id="7156029">&#34;RSA&#34;</span><span class="op" id="7156034">,</span>&nbsp;<span class="ident" id="7156036">rsaPriv</span><span class="op" id="7156043">,</span>&nbsp;<span class="ident" id="7156045">SHA1WithRSA</span><span class="op" id="7156056">}</span><span class="op" id="7156057">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156061">{</span><span class="string" id="7156062">&#34;ECDSA-256&#34;</span><span class="op" id="7156073">,</span>&nbsp;<span class="ident" id="7156075">ecdsa256Priv</span><span class="op" id="7156087">,</span>&nbsp;<span class="ident" id="7156089">ECDSAWithSHA1</span><span class="op" id="7156102">}</span><span class="op" id="7156103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156107">{</span><span class="string" id="7156108">&#34;ECDSA-384&#34;</span><span class="op" id="7156119">,</span>&nbsp;<span class="ident" id="7156121">ecdsa384Priv</span><span class="op" id="7156133">,</span>&nbsp;<span class="ident" id="7156135">ECDSAWithSHA1</span><span class="op" id="7156148">}</span><span class="op" id="7156149">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156153">{</span><span class="string" id="7156154">&#34;ECDSA-521&#34;</span><span class="op" id="7156165">,</span>&nbsp;<span class="ident" id="7156167">ecdsa521Priv</span><span class="op" id="7156179">,</span>&nbsp;<span class="ident" id="7156181">ECDSAWithSHA1</span><span class="op" id="7156194">}</span><span class="op" id="7156195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156198">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156202">for</span>&nbsp;<span class="ident" id="7156206">_</span><span class="op" id="7156207">,</span>&nbsp;<span class="ident" id="7156209">test</span>&nbsp;<span class="op" id="7156214">:=</span>&nbsp;<span class="keyword" id="7156217">range</span>&nbsp;<span class="ident" id="7156223">tests</span>&nbsp;<span class="op" id="7156229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156233">template</span>&nbsp;<span class="op" id="7156242">:=</span>&nbsp;<span class="ident" id="7156245">CertificateRequest</span><span class="op" id="7156263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156268">Subject</span><span class="op" id="7156275">:</span>&nbsp;<span class="ident" id="7156277">pkix</span><span class="op" id="7156281">.</span><span class="ident" id="7156282">Name</span><span class="op" id="7156286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156292">CommonName</span><span class="op" id="7156302">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7156306">&#34;test.example.com&#34;</span><span class="op" id="7156324">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156330">Organization</span><span class="op" id="7156342">:</span>&nbsp;<span class="op" id="7156344">[</span><span class="op" id="7156345">]</span><span class="builtintype" id="7156346">string</span><span class="op" id="7156352">{</span><span class="string" id="7156353">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7156365">}</span><span class="op" id="7156366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156371">}</span><span class="op" id="7156372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156377">SignatureAlgorithm</span><span class="op" id="7156395">:</span>&nbsp;<span class="ident" id="7156397">test</span><span class="op" id="7156401">.</span><span class="ident" id="7156402">sigAlgo</span><span class="op" id="7156409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156414">DNSNames</span><span class="op" id="7156422">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156434">[</span><span class="op" id="7156435">]</span><span class="builtintype" id="7156436">string</span><span class="op" id="7156442">{</span><span class="string" id="7156443">&#34;test.example.com&#34;</span><span class="op" id="7156461">}</span><span class="op" id="7156462">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156467">EmailAddresses</span><span class="op" id="7156481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156487">[</span><span class="op" id="7156488">]</span><span class="builtintype" id="7156489">string</span><span class="op" id="7156495">{</span><span class="string" id="7156496">&#34;gopher@golang.org&#34;</span><span class="op" id="7156515">}</span><span class="op" id="7156516">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156521">IPAddresses</span><span class="op" id="7156532">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7156541">[</span><span class="op" id="7156542">]</span><span class="ident" id="7156543">net</span><span class="op" id="7156546">.</span><span class="ident" id="7156547">IP</span><span class="op" id="7156549">{</span><span class="ident" id="7156550">net</span><span class="op" id="7156553">.</span><span class="ident" id="7156554">IPv4</span><span class="op" id="7156558">(</span><span class="num" id="7156559">127</span><span class="op" id="7156562">,</span>&nbsp;<span class="num" id="7156564">0</span><span class="op" id="7156565">,</span>&nbsp;<span class="num" id="7156567">0</span><span class="op" id="7156568">,</span>&nbsp;<span class="num" id="7156570">1</span><span class="op" id="7156571">)</span><span class="op" id="7156572">.</span><span class="ident" id="7156573">To4</span><span class="op" id="7156576">(</span><span class="op" id="7156577">)</span><span class="op" id="7156578">,</span>&nbsp;<span class="ident" id="7156580">net</span><span class="op" id="7156583">.</span><span class="ident" id="7156584">ParseIP</span><span class="op" id="7156591">(</span><span class="string" id="7156592">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7156614">)</span><span class="op" id="7156615">}</span><span class="op" id="7156616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156625">derBytes</span><span class="op" id="7156633">,</span>&nbsp;<span class="ident" id="7156635">err</span>&nbsp;<span class="op" id="7156639">:=</span>&nbsp;<span class="ident" id="7156642">CreateCertificateRequest</span><span class="op" id="7156666">(</span><span class="ident" id="7156667">random</span><span class="op" id="7156673">,</span>&nbsp;<span class="op" id="7156675">&amp;</span><span class="ident" id="7156676">template</span><span class="op" id="7156684">,</span>&nbsp;<span class="ident" id="7156686">test</span><span class="op" id="7156690">.</span><span class="ident" id="7156691">priv</span><span class="op" id="7156695">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156699">if</span>&nbsp;<span class="ident" id="7156702">err</span>&nbsp;<span class="op" id="7156706">!=</span>&nbsp;<span class="ident" id="7156709">nil</span>&nbsp;<span class="op" id="7156713">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156718">t</span><span class="op" id="7156719">.</span><span class="ident" id="7156720">Errorf</span><span class="op" id="7156726">(</span><span class="string" id="7156727">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7156773">,</span>&nbsp;<span class="ident" id="7156775">test</span><span class="op" id="7156779">.</span><span class="ident" id="7156780">name</span><span class="op" id="7156784">,</span>&nbsp;<span class="ident" id="7156786">err</span><span class="op" id="7156789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156794">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156810">out</span><span class="op" id="7156813">,</span>&nbsp;<span class="ident" id="7156815">err</span>&nbsp;<span class="op" id="7156819">:=</span>&nbsp;<span class="ident" id="7156822">ParseCertificateRequest</span><span class="op" id="7156845">(</span><span class="ident" id="7156846">derBytes</span><span class="op" id="7156854">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156858">if</span>&nbsp;<span class="ident" id="7156861">err</span>&nbsp;<span class="op" id="7156865">!=</span>&nbsp;<span class="ident" id="7156868">nil</span>&nbsp;<span class="op" id="7156872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7156877">t</span><span class="op" id="7156878">.</span><span class="ident" id="7156879">Errorf</span><span class="op" id="7156885">(</span><span class="string" id="7156886">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7156932">,</span>&nbsp;<span class="ident" id="7156934">test</span><span class="op" id="7156938">.</span><span class="ident" id="7156939">name</span><span class="op" id="7156943">,</span>&nbsp;<span class="ident" id="7156945">err</span><span class="op" id="7156948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156953">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7156964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7156969">if</span>&nbsp;<span class="ident" id="7156972">out</span><span class="op" id="7156975">.</span><span class="ident" id="7156976">Subject</span><span class="op" id="7156983">.</span><span class="ident" id="7156984">CommonName</span>&nbsp;<span class="op" id="7156995">!=</span>&nbsp;<span class="ident" id="7156998">template</span><span class="op" id="7157006">.</span><span class="ident" id="7157007">Subject</span><span class="op" id="7157014">.</span><span class="ident" id="7157015">CommonName</span>&nbsp;<span class="op" id="7157026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157031">t</span><span class="op" id="7157032">.</span><span class="ident" id="7157033">Errorf</span><span class="op" id="7157039">(</span><span class="string" id="7157040">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7157117">,</span>&nbsp;<span class="ident" id="7157119">test</span><span class="op" id="7157123">.</span><span class="ident" id="7157124">name</span><span class="op" id="7157128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157132">}</span>&nbsp;<span class="keyword" id="7157134">else</span>&nbsp;<span class="keyword" id="7157139">if</span>&nbsp;<span class="builtinfunc" id="7157142">len</span><span class="op" id="7157145">(</span><span class="ident" id="7157146">out</span><span class="op" id="7157149">.</span><span class="ident" id="7157150">Subject</span><span class="op" id="7157157">.</span><span class="ident" id="7157158">Organization</span><span class="op" id="7157170">)</span>&nbsp;<span class="op" id="7157172">!=</span>&nbsp;<span class="builtinfunc" id="7157175">len</span><span class="op" id="7157178">(</span><span class="ident" id="7157179">template</span><span class="op" id="7157187">.</span><span class="ident" id="7157188">Subject</span><span class="op" id="7157195">.</span><span class="ident" id="7157196">Organization</span><span class="op" id="7157208">)</span>&nbsp;<span class="op" id="7157210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157215">t</span><span class="op" id="7157216">.</span><span class="ident" id="7157217">Errorf</span><span class="op" id="7157223">(</span><span class="string" id="7157224">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7157303">,</span>&nbsp;<span class="ident" id="7157305">test</span><span class="op" id="7157309">.</span><span class="ident" id="7157310">name</span><span class="op" id="7157314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157318">}</span>&nbsp;<span class="keyword" id="7157320">else</span>&nbsp;<span class="keyword" id="7157325">if</span>&nbsp;<span class="builtinfunc" id="7157328">len</span><span class="op" id="7157331">(</span><span class="ident" id="7157332">out</span><span class="op" id="7157335">.</span><span class="ident" id="7157336">DNSNames</span><span class="op" id="7157344">)</span>&nbsp;<span class="op" id="7157346">!=</span>&nbsp;<span class="builtinfunc" id="7157349">len</span><span class="op" id="7157352">(</span><span class="ident" id="7157353">template</span><span class="op" id="7157361">.</span><span class="ident" id="7157362">DNSNames</span><span class="op" id="7157370">)</span>&nbsp;<span class="op" id="7157372">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157377">t</span><span class="op" id="7157378">.</span><span class="ident" id="7157379">Errorf</span><span class="op" id="7157385">(</span><span class="string" id="7157386">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7157443">,</span>&nbsp;<span class="ident" id="7157445">test</span><span class="op" id="7157449">.</span><span class="ident" id="7157450">name</span><span class="op" id="7157454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157458">}</span>&nbsp;<span class="keyword" id="7157460">else</span>&nbsp;<span class="keyword" id="7157465">if</span>&nbsp;<span class="builtinfunc" id="7157468">len</span><span class="op" id="7157471">(</span><span class="ident" id="7157472">out</span><span class="op" id="7157475">.</span><span class="ident" id="7157476">EmailAddresses</span><span class="op" id="7157490">)</span>&nbsp;<span class="op" id="7157492">!=</span>&nbsp;<span class="builtinfunc" id="7157495">len</span><span class="op" id="7157498">(</span><span class="ident" id="7157499">template</span><span class="op" id="7157507">.</span><span class="ident" id="7157508">EmailAddresses</span><span class="op" id="7157522">)</span>&nbsp;<span class="op" id="7157524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157529">t</span><span class="op" id="7157530">.</span><span class="ident" id="7157531">Errorf</span><span class="op" id="7157537">(</span><span class="string" id="7157538">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7157607">,</span>&nbsp;<span class="ident" id="7157609">test</span><span class="op" id="7157613">.</span><span class="ident" id="7157614">name</span><span class="op" id="7157618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157622">}</span>&nbsp;<span class="keyword" id="7157624">else</span>&nbsp;<span class="keyword" id="7157629">if</span>&nbsp;<span class="builtinfunc" id="7157632">len</span><span class="op" id="7157635">(</span><span class="ident" id="7157636">out</span><span class="op" id="7157639">.</span><span class="ident" id="7157640">IPAddresses</span><span class="op" id="7157651">)</span>&nbsp;<span class="op" id="7157653">!=</span>&nbsp;<span class="builtinfunc" id="7157656">len</span><span class="op" id="7157659">(</span><span class="ident" id="7157660">template</span><span class="op" id="7157668">.</span><span class="ident" id="7157669">IPAddresses</span><span class="op" id="7157680">)</span>&nbsp;<span class="op" id="7157682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157687">t</span><span class="op" id="7157688">.</span><span class="ident" id="7157689">Errorf</span><span class="op" id="7157695">(</span><span class="string" id="7157696">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7157765">,</span>&nbsp;<span class="ident" id="7157767">test</span><span class="op" id="7157771">.</span><span class="ident" id="7157772">name</span><span class="op" id="7157776">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7157783">}</span><br>
<span class="lineno"></span><span class="op" id="7157785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7157788">func</span>&nbsp;<span class="ident" id="7157793">marshalAndParseCSR</span><span class="op" id="7157811">(</span><span class="ident" id="7157812">t</span>&nbsp;<span class="op" id="7157814">*</span><span class="ident" id="7157815">testing</span><span class="op" id="7157822">.</span><span class="ident" id="7157823">T</span><span class="op" id="7157824">,</span>&nbsp;<span class="ident" id="7157826">template</span>&nbsp;<span class="op" id="7157835">*</span><span class="ident" id="7157836">CertificateRequest</span><span class="op" id="7157854">)</span>&nbsp;<span class="op" id="7157856">*</span><span class="ident" id="7157857">CertificateRequest</span>&nbsp;<span class="op" id="7157876">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157879">block</span><span class="op" id="7157884">,</span>&nbsp;<span class="ident" id="7157886">_</span>&nbsp;<span class="op" id="7157888">:=</span>&nbsp;<span class="ident" id="7157891">pem</span><span class="op" id="7157894">.</span><span class="ident" id="7157895">Decode</span><span class="op" id="7157901">(</span><span class="op" id="7157902">[</span><span class="op" id="7157903">]</span><span class="builtintype" id="7157904">byte</span><span class="op" id="7157908">(</span><span class="ident" id="7157909">pemPrivateKey</span><span class="op" id="7157922">)</span><span class="op" id="7157923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157926">rsaPriv</span><span class="op" id="7157933">,</span>&nbsp;<span class="ident" id="7157935">err</span>&nbsp;<span class="op" id="7157939">:=</span>&nbsp;<span class="ident" id="7157942">ParsePKCS1PrivateKey</span><span class="op" id="7157962">(</span><span class="ident" id="7157963">block</span><span class="op" id="7157968">.</span><span class="ident" id="7157969">Bytes</span><span class="op" id="7157974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7157977">if</span>&nbsp;<span class="ident" id="7157980">err</span>&nbsp;<span class="op" id="7157984">!=</span>&nbsp;<span class="ident" id="7157987">nil</span>&nbsp;<span class="op" id="7157991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7157995">t</span><span class="op" id="7157996">.</span><span class="ident" id="7157997">Fatal</span><span class="op" id="7158002">(</span><span class="ident" id="7158003">err</span><span class="op" id="7158006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158009">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158013">derBytes</span><span class="op" id="7158021">,</span>&nbsp;<span class="ident" id="7158023">err</span>&nbsp;<span class="op" id="7158027">:=</span>&nbsp;<span class="ident" id="7158030">CreateCertificateRequest</span><span class="op" id="7158054">(</span><span class="ident" id="7158055">rand</span><span class="op" id="7158059">.</span><span class="ident" id="7158060">Reader</span><span class="op" id="7158066">,</span>&nbsp;<span class="ident" id="7158068">template</span><span class="op" id="7158076">,</span>&nbsp;<span class="ident" id="7158078">rsaPriv</span><span class="op" id="7158085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7158088">if</span>&nbsp;<span class="ident" id="7158091">err</span>&nbsp;<span class="op" id="7158095">!=</span>&nbsp;<span class="ident" id="7158098">nil</span>&nbsp;<span class="op" id="7158102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158106">t</span><span class="op" id="7158107">.</span><span class="ident" id="7158108">Fatal</span><span class="op" id="7158113">(</span><span class="ident" id="7158114">err</span><span class="op" id="7158117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158120">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158124">csr</span><span class="op" id="7158127">,</span>&nbsp;<span class="ident" id="7158129">err</span>&nbsp;<span class="op" id="7158133">:=</span>&nbsp;<span class="ident" id="7158136">ParseCertificateRequest</span><span class="op" id="7158159">(</span><span class="ident" id="7158160">derBytes</span><span class="op" id="7158168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7158171">if</span>&nbsp;<span class="ident" id="7158174">err</span>&nbsp;<span class="op" id="7158178">!=</span>&nbsp;<span class="ident" id="7158181">nil</span>&nbsp;<span class="op" id="7158185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158189">t</span><span class="op" id="7158190">.</span><span class="ident" id="7158191">Fatal</span><span class="op" id="7158196">(</span><span class="ident" id="7158197">err</span><span class="op" id="7158200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158203">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7158207">return</span>&nbsp;<span class="ident" id="7158214">csr</span><br>
<span class="lineno"></span><span class="op" id="7158218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7158221">func</span>&nbsp;<span class="ident" id="7158226">TestCertificateRequestOverrides</span><span class="op" id="7158257">(</span><span class="ident" id="7158258">t</span>&nbsp;<span class="op" id="7158260">*</span><span class="ident" id="7158261">testing</span><span class="op" id="7158268">.</span><span class="ident" id="7158269">T</span><span class="op" id="7158270">)</span>&nbsp;<span class="op" id="7158272">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158275">sanContents</span><span class="op" id="7158286">,</span>&nbsp;<span class="ident" id="7158288">err</span>&nbsp;<span class="op" id="7158292">:=</span>&nbsp;<span class="ident" id="7158295">marshalSANs</span><span class="op" id="7158306">(</span><span class="op" id="7158307">[</span><span class="op" id="7158308">]</span><span class="builtintype" id="7158309">string</span><span class="op" id="7158315">{</span><span class="string" id="7158316">&#34;foo.example.com&#34;</span><span class="op" id="7158333">}</span><span class="op" id="7158334">,</span>&nbsp;<span class="ident" id="7158336">nil</span><span class="op" id="7158339">,</span>&nbsp;<span class="ident" id="7158341">nil</span><span class="op" id="7158344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7158347">if</span>&nbsp;<span class="ident" id="7158350">err</span>&nbsp;<span class="op" id="7158354">!=</span>&nbsp;<span class="ident" id="7158357">nil</span>&nbsp;<span class="op" id="7158361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158365">t</span><span class="op" id="7158366">.</span><span class="ident" id="7158367">Fatal</span><span class="op" id="7158372">(</span><span class="ident" id="7158373">err</span><span class="op" id="7158376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158383">template</span>&nbsp;<span class="op" id="7158392">:=</span>&nbsp;<span class="ident" id="7158395">CertificateRequest</span><span class="op" id="7158413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158417">Subject</span><span class="op" id="7158424">:</span>&nbsp;<span class="ident" id="7158426">pkix</span><span class="op" id="7158430">.</span><span class="ident" id="7158431">Name</span><span class="op" id="7158435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158440">CommonName</span><span class="op" id="7158450">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7158454">&#34;test.example.com&#34;</span><span class="op" id="7158472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158477">Organization</span><span class="op" id="7158489">:</span>&nbsp;<span class="op" id="7158491">[</span><span class="op" id="7158492">]</span><span class="builtintype" id="7158493">string</span><span class="op" id="7158499">{</span><span class="string" id="7158500">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7158512">}</span><span class="op" id="7158513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158517">}</span><span class="op" id="7158518">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158522">DNSNames</span><span class="op" id="7158530">:</span>&nbsp;<span class="op" id="7158532">[</span><span class="op" id="7158533">]</span><span class="builtintype" id="7158534">string</span><span class="op" id="7158540">{</span><span class="string" id="7158541">&#34;test.example.com&#34;</span><span class="op" id="7158559">}</span><span class="op" id="7158560">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7158565">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7158630">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158645">ExtraExtensions</span><span class="op" id="7158660">:</span>&nbsp;<span class="op" id="7158662">[</span><span class="op" id="7158663">]</span><span class="ident" id="7158664">pkix</span><span class="op" id="7158668">.</span><span class="ident" id="7158669">Extension</span><span class="op" id="7158678">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158689">Id</span><span class="op" id="7158691">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7158696">oidExtensionSubjectAltName</span><span class="op" id="7158722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158728">Value</span><span class="op" id="7158733">:</span>&nbsp;<span class="ident" id="7158735">sanContents</span><span class="op" id="7158746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158751">}</span><span class="op" id="7158752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158756">}</span><span class="op" id="7158757">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158764">csr</span>&nbsp;<span class="op" id="7158768">:=</span>&nbsp;<span class="ident" id="7158771">marshalAndParseCSR</span><span class="op" id="7158789">(</span><span class="ident" id="7158790">t</span><span class="op" id="7158791">,</span>&nbsp;<span class="op" id="7158793">&amp;</span><span class="ident" id="7158794">template</span><span class="op" id="7158802">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7158806">if</span>&nbsp;<span class="builtinfunc" id="7158809">len</span><span class="op" id="7158812">(</span><span class="ident" id="7158813">csr</span><span class="op" id="7158816">.</span><span class="ident" id="7158817">DNSNames</span><span class="op" id="7158825">)</span>&nbsp;<span class="op" id="7158827">!=</span>&nbsp;<span class="num" id="7158830">1</span>&nbsp;<span class="op" id="7158832">||</span>&nbsp;<span class="ident" id="7158835">csr</span><span class="op" id="7158838">.</span><span class="ident" id="7158839">DNSNames</span><span class="op" id="7158847">[</span><span class="num" id="7158848">0</span><span class="op" id="7158849">]</span>&nbsp;<span class="op" id="7158851">!=</span>&nbsp;<span class="string" id="7158854">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7158872">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7158876">t</span><span class="op" id="7158877">.</span><span class="ident" id="7158878">Errorf</span><span class="op" id="7158884">(</span><span class="string" id="7158885">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7158932">,</span>&nbsp;<span class="ident" id="7158934">csr</span><span class="op" id="7158937">.</span><span class="ident" id="7158938">DNSNames</span><span class="op" id="7158946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7158949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7158953">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7159021">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7159091">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159127">template</span><span class="op" id="7159135">.</span><span class="ident" id="7159136">Attributes</span>&nbsp;<span class="op" id="7159147">=</span>&nbsp;<span class="op" id="7159149">[</span><span class="op" id="7159150">]</span><span class="ident" id="7159151">pkix</span><span class="op" id="7159155">.</span><span class="ident" id="7159156">AttributeTypeAndValueSET</span><span class="op" id="7159180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159189">Type</span><span class="op" id="7159193">:</span>&nbsp;<span class="ident" id="7159195">oidExtensionRequest</span><span class="op" id="7159214">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159219">Value</span><span class="op" id="7159224">:</span>&nbsp;<span class="op" id="7159226">[</span><span class="op" id="7159227">]</span><span class="op" id="7159228">[</span><span class="op" id="7159229">]</span><span class="ident" id="7159230">pkix</span><span class="op" id="7159234">.</span><span class="ident" id="7159235">AttributeTypeAndValue</span><span class="op" id="7159256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159277">Type</span><span class="op" id="7159281">:</span>&nbsp;&nbsp;<span class="ident" id="7159284">oidExtensionAuthorityInfoAccess</span><span class="op" id="7159315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159323">Value</span><span class="op" id="7159328">:</span>&nbsp;<span class="op" id="7159330">[</span><span class="op" id="7159331">]</span><span class="builtintype" id="7159332">byte</span><span class="op" id="7159336">(</span><span class="string" id="7159337">&#34;foo&#34;</span><span class="op" id="7159342">)</span><span class="op" id="7159343">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159350">}</span><span class="op" id="7159351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159357">}</span><span class="op" id="7159358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159363">}</span><span class="op" id="7159364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159368">}</span><span class="op" id="7159369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159372">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159376">csr</span>&nbsp;<span class="op" id="7159380">=</span>&nbsp;<span class="ident" id="7159382">marshalAndParseCSR</span><span class="op" id="7159400">(</span><span class="ident" id="7159401">t</span><span class="op" id="7159402">,</span>&nbsp;<span class="op" id="7159404">&amp;</span><span class="ident" id="7159405">template</span><span class="op" id="7159413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7159416">if</span>&nbsp;<span class="ident" id="7159419">l</span>&nbsp;<span class="op" id="7159421">:=</span>&nbsp;<span class="builtinfunc" id="7159424">len</span><span class="op" id="7159427">(</span><span class="ident" id="7159428">csr</span><span class="op" id="7159431">.</span><span class="ident" id="7159432">Attributes</span><span class="op" id="7159442">)</span><span class="op" id="7159443">;</span>&nbsp;<span class="ident" id="7159445">l</span>&nbsp;<span class="op" id="7159447">!=</span>&nbsp;<span class="num" id="7159450">1</span>&nbsp;<span class="op" id="7159452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159456">t</span><span class="op" id="7159457">.</span><span class="ident" id="7159458">Errorf</span><span class="op" id="7159464">(</span><span class="string" id="7159465">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7159503">,</span>&nbsp;<span class="ident" id="7159505">l</span><span class="op" id="7159506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159509">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7159513">if</span>&nbsp;<span class="op" id="7159516">!</span><span class="ident" id="7159517">csr</span><span class="op" id="7159520">.</span><span class="ident" id="7159521">Attributes</span><span class="op" id="7159531">[</span><span class="num" id="7159532">0</span><span class="op" id="7159533">]</span><span class="op" id="7159534">.</span><span class="ident" id="7159535">Type</span><span class="op" id="7159539">.</span><span class="ident" id="7159540">Equal</span><span class="op" id="7159545">(</span><span class="ident" id="7159546">oidExtensionRequest</span><span class="op" id="7159565">)</span>&nbsp;<span class="op" id="7159567">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7159572">len</span><span class="op" id="7159575">(</span><span class="ident" id="7159576">csr</span><span class="op" id="7159579">.</span><span class="ident" id="7159580">Attributes</span><span class="op" id="7159590">[</span><span class="num" id="7159591">0</span><span class="op" id="7159592">]</span><span class="op" id="7159593">.</span><span class="ident" id="7159594">Value</span><span class="op" id="7159599">)</span>&nbsp;<span class="op" id="7159601">!=</span>&nbsp;<span class="num" id="7159604">1</span>&nbsp;<span class="op" id="7159606">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7159611">len</span><span class="op" id="7159614">(</span><span class="ident" id="7159615">csr</span><span class="op" id="7159618">.</span><span class="ident" id="7159619">Attributes</span><span class="op" id="7159629">[</span><span class="num" id="7159630">0</span><span class="op" id="7159631">]</span><span class="op" id="7159632">.</span><span class="ident" id="7159633">Value</span><span class="op" id="7159638">[</span><span class="num" id="7159639">0</span><span class="op" id="7159640">]</span><span class="op" id="7159641">)</span>&nbsp;<span class="op" id="7159643">!=</span>&nbsp;<span class="num" id="7159646">2</span>&nbsp;<span class="op" id="7159648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159652">t</span><span class="op" id="7159653">.</span><span class="ident" id="7159654">Errorf</span><span class="op" id="7159660">(</span><span class="string" id="7159661">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7159684">,</span>&nbsp;<span class="ident" id="7159686">csr</span><span class="op" id="7159689">.</span><span class="ident" id="7159690">Attributes</span><span class="op" id="7159700">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159703">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159707">sanContents2</span><span class="op" id="7159719">,</span>&nbsp;<span class="ident" id="7159721">err</span>&nbsp;<span class="op" id="7159725">:=</span>&nbsp;<span class="ident" id="7159728">marshalSANs</span><span class="op" id="7159739">(</span><span class="op" id="7159740">[</span><span class="op" id="7159741">]</span><span class="builtintype" id="7159742">string</span><span class="op" id="7159748">{</span><span class="string" id="7159749">&#34;foo2.example.com&#34;</span><span class="op" id="7159767">}</span><span class="op" id="7159768">,</span>&nbsp;<span class="ident" id="7159770">nil</span><span class="op" id="7159773">,</span>&nbsp;<span class="ident" id="7159775">nil</span><span class="op" id="7159778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7159781">if</span>&nbsp;<span class="ident" id="7159784">err</span>&nbsp;<span class="op" id="7159788">!=</span>&nbsp;<span class="ident" id="7159791">nil</span>&nbsp;<span class="op" id="7159795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159799">t</span><span class="op" id="7159800">.</span><span class="ident" id="7159801">Fatal</span><span class="op" id="7159806">(</span><span class="ident" id="7159807">err</span><span class="op" id="7159810">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7159813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7159817">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159888">template</span><span class="op" id="7159896">.</span><span class="ident" id="7159897">Attributes</span><span class="op" id="7159907">[</span><span class="num" id="7159908">0</span><span class="op" id="7159909">]</span><span class="op" id="7159910">.</span><span class="ident" id="7159911">Value</span><span class="op" id="7159916">[</span><span class="num" id="7159917">0</span><span class="op" id="7159918">]</span>&nbsp;<span class="op" id="7159920">=</span>&nbsp;<span class="builtinfunc" id="7159922">append</span><span class="op" id="7159928">(</span><span class="ident" id="7159929">template</span><span class="op" id="7159937">.</span><span class="ident" id="7159938">Attributes</span><span class="op" id="7159948">[</span><span class="num" id="7159949">0</span><span class="op" id="7159950">]</span><span class="op" id="7159951">.</span><span class="ident" id="7159952">Value</span><span class="op" id="7159957">[</span><span class="num" id="7159958">0</span><span class="op" id="7159959">]</span><span class="op" id="7159960">,</span>&nbsp;<span class="ident" id="7159962">pkix</span><span class="op" id="7159966">.</span><span class="ident" id="7159967">AttributeTypeAndValue</span><span class="op" id="7159988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7159992">Type</span><span class="op" id="7159996">:</span>&nbsp;&nbsp;<span class="ident" id="7159999">oidExtensionSubjectAltName</span><span class="op" id="7160025">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160029">Value</span><span class="op" id="7160034">:</span>&nbsp;<span class="ident" id="7160036">sanContents2</span><span class="op" id="7160048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160051">}</span><span class="op" id="7160052">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160056">csr</span>&nbsp;<span class="op" id="7160060">=</span>&nbsp;<span class="ident" id="7160062">marshalAndParseCSR</span><span class="op" id="7160080">(</span><span class="ident" id="7160081">t</span><span class="op" id="7160082">,</span>&nbsp;<span class="op" id="7160084">&amp;</span><span class="ident" id="7160085">template</span><span class="op" id="7160093">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160097">if</span>&nbsp;<span class="builtinfunc" id="7160100">len</span><span class="op" id="7160103">(</span><span class="ident" id="7160104">csr</span><span class="op" id="7160107">.</span><span class="ident" id="7160108">DNSNames</span><span class="op" id="7160116">)</span>&nbsp;<span class="op" id="7160118">!=</span>&nbsp;<span class="num" id="7160121">1</span>&nbsp;<span class="op" id="7160123">||</span>&nbsp;<span class="ident" id="7160126">csr</span><span class="op" id="7160129">.</span><span class="ident" id="7160130">DNSNames</span><span class="op" id="7160138">[</span><span class="num" id="7160139">0</span><span class="op" id="7160140">]</span>&nbsp;<span class="op" id="7160142">!=</span>&nbsp;<span class="string" id="7160145">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7160164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160168">t</span><span class="op" id="7160169">.</span><span class="ident" id="7160170">Errorf</span><span class="op" id="7160176">(</span><span class="string" id="7160177">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7160232">,</span>&nbsp;<span class="ident" id="7160234">csr</span><span class="op" id="7160237">.</span><span class="ident" id="7160238">DNSNames</span><span class="op" id="7160246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160249">}</span><br>
<span class="lineno"></span><span class="op" id="7160251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7160254">func</span>&nbsp;<span class="ident" id="7160259">TestParseCertificateRequest</span><span class="op" id="7160286">(</span><span class="ident" id="7160287">t</span>&nbsp;<span class="op" id="7160289">*</span><span class="ident" id="7160290">testing</span><span class="op" id="7160297">.</span><span class="ident" id="7160298">T</span><span class="op" id="7160299">)</span>&nbsp;<span class="op" id="7160301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160304">csrBytes</span>&nbsp;<span class="op" id="7160313">:=</span>&nbsp;<span class="ident" id="7160316">fromBase64</span><span class="op" id="7160326">(</span><span class="ident" id="7160327">csrBase64</span><span class="op" id="7160336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160339">csr</span><span class="op" id="7160342">,</span>&nbsp;<span class="ident" id="7160344">err</span>&nbsp;<span class="op" id="7160348">:=</span>&nbsp;<span class="ident" id="7160351">ParseCertificateRequest</span><span class="op" id="7160374">(</span><span class="ident" id="7160375">csrBytes</span><span class="op" id="7160383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160386">if</span>&nbsp;<span class="ident" id="7160389">err</span>&nbsp;<span class="op" id="7160393">!=</span>&nbsp;<span class="ident" id="7160396">nil</span>&nbsp;<span class="op" id="7160400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160404">t</span><span class="op" id="7160405">.</span><span class="ident" id="7160406">Fatalf</span><span class="op" id="7160412">(</span><span class="string" id="7160413">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7160438">,</span>&nbsp;<span class="ident" id="7160440">err</span><span class="op" id="7160443">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160450">if</span>&nbsp;<span class="builtinfunc" id="7160453">len</span><span class="op" id="7160456">(</span><span class="ident" id="7160457">csr</span><span class="op" id="7160460">.</span><span class="ident" id="7160461">EmailAddresses</span><span class="op" id="7160475">)</span>&nbsp;<span class="op" id="7160477">!=</span>&nbsp;<span class="num" id="7160480">1</span>&nbsp;<span class="op" id="7160482">||</span>&nbsp;<span class="ident" id="7160485">csr</span><span class="op" id="7160488">.</span><span class="ident" id="7160489">EmailAddresses</span><span class="op" id="7160503">[</span><span class="num" id="7160504">0</span><span class="op" id="7160505">]</span>&nbsp;<span class="op" id="7160507">!=</span>&nbsp;<span class="string" id="7160510">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7160530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160534">t</span><span class="op" id="7160535">.</span><span class="ident" id="7160536">Errorf</span><span class="op" id="7160542">(</span><span class="string" id="7160543">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7160580">,</span>&nbsp;<span class="ident" id="7160582">csr</span><span class="op" id="7160585">.</span><span class="ident" id="7160586">EmailAddresses</span><span class="op" id="7160600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160603">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160607">if</span>&nbsp;<span class="builtinfunc" id="7160610">len</span><span class="op" id="7160613">(</span><span class="ident" id="7160614">csr</span><span class="op" id="7160617">.</span><span class="ident" id="7160618">DNSNames</span><span class="op" id="7160626">)</span>&nbsp;<span class="op" id="7160628">!=</span>&nbsp;<span class="num" id="7160631">1</span>&nbsp;<span class="op" id="7160633">||</span>&nbsp;<span class="ident" id="7160636">csr</span><span class="op" id="7160639">.</span><span class="ident" id="7160640">DNSNames</span><span class="op" id="7160648">[</span><span class="num" id="7160649">0</span><span class="op" id="7160650">]</span>&nbsp;<span class="op" id="7160652">!=</span>&nbsp;<span class="string" id="7160655">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7160674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160678">t</span><span class="op" id="7160679">.</span><span class="ident" id="7160680">Errorf</span><span class="op" id="7160686">(</span><span class="string" id="7160687">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7160718">,</span>&nbsp;<span class="ident" id="7160720">csr</span><span class="op" id="7160723">.</span><span class="ident" id="7160724">DNSNames</span><span class="op" id="7160732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160739">if</span>&nbsp;<span class="builtinfunc" id="7160742">len</span><span class="op" id="7160745">(</span><span class="ident" id="7160746">csr</span><span class="op" id="7160749">.</span><span class="ident" id="7160750">Subject</span><span class="op" id="7160757">.</span><span class="ident" id="7160758">Country</span><span class="op" id="7160765">)</span>&nbsp;<span class="op" id="7160767">!=</span>&nbsp;<span class="num" id="7160770">1</span>&nbsp;<span class="op" id="7160772">||</span>&nbsp;<span class="ident" id="7160775">csr</span><span class="op" id="7160778">.</span><span class="ident" id="7160779">Subject</span><span class="op" id="7160786">.</span><span class="ident" id="7160787">Country</span><span class="op" id="7160794">[</span><span class="num" id="7160795">0</span><span class="op" id="7160796">]</span>&nbsp;<span class="op" id="7160798">!=</span>&nbsp;<span class="string" id="7160801">&#34;AU&#34;</span>&nbsp;<span class="op" id="7160806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160810">t</span><span class="op" id="7160811">.</span><span class="ident" id="7160812">Errorf</span><span class="op" id="7160818">(</span><span class="string" id="7160819">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7160847">,</span>&nbsp;<span class="ident" id="7160849">csr</span><span class="op" id="7160852">.</span><span class="ident" id="7160853">Subject</span><span class="op" id="7160860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160867">found</span>&nbsp;<span class="op" id="7160873">:=</span>&nbsp;<span class="builtintype" id="7160876">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160883">for</span>&nbsp;<span class="ident" id="7160887">_</span><span class="op" id="7160888">,</span>&nbsp;<span class="ident" id="7160890">e</span>&nbsp;<span class="op" id="7160892">:=</span>&nbsp;<span class="keyword" id="7160895">range</span>&nbsp;<span class="ident" id="7160901">csr</span><span class="op" id="7160904">.</span><span class="ident" id="7160905">Extensions</span>&nbsp;<span class="op" id="7160916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160920">if</span>&nbsp;<span class="ident" id="7160923">e</span><span class="op" id="7160924">.</span><span class="ident" id="7160925">Id</span><span class="op" id="7160927">.</span><span class="ident" id="7160928">Equal</span><span class="op" id="7160933">(</span><span class="ident" id="7160934">oidExtensionBasicConstraints</span><span class="op" id="7160962">)</span>&nbsp;<span class="op" id="7160964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7160969">found</span>&nbsp;<span class="op" id="7160975">=</span>&nbsp;<span class="builtintype" id="7160977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160985">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160993">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7160996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7160999">if</span>&nbsp;<span class="op" id="7161002">!</span><span class="ident" id="7161003">found</span>&nbsp;<span class="op" id="7161009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161013">t</span><span class="op" id="7161014">.</span><span class="ident" id="7161015">Errorf</span><span class="op" id="7161021">(</span><span class="string" id="7161022">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7161068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161071">}</span><br>
<span class="lineno"></span><span class="op" id="7161073">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7161076">func</span>&nbsp;<span class="ident" id="7161081">TestMaxPathLen</span><span class="op" id="7161095">(</span><span class="ident" id="7161096">t</span>&nbsp;<span class="op" id="7161098">*</span><span class="ident" id="7161099">testing</span><span class="op" id="7161106">.</span><span class="ident" id="7161107">T</span><span class="op" id="7161108">)</span>&nbsp;<span class="op" id="7161110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161113">block</span><span class="op" id="7161118">,</span>&nbsp;<span class="ident" id="7161120">_</span>&nbsp;<span class="op" id="7161122">:=</span>&nbsp;<span class="ident" id="7161125">pem</span><span class="op" id="7161128">.</span><span class="ident" id="7161129">Decode</span><span class="op" id="7161135">(</span><span class="op" id="7161136">[</span><span class="op" id="7161137">]</span><span class="builtintype" id="7161138">byte</span><span class="op" id="7161142">(</span><span class="ident" id="7161143">pemPrivateKey</span><span class="op" id="7161156">)</span><span class="op" id="7161157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161160">rsaPriv</span><span class="op" id="7161167">,</span>&nbsp;<span class="ident" id="7161169">err</span>&nbsp;<span class="op" id="7161173">:=</span>&nbsp;<span class="ident" id="7161176">ParsePKCS1PrivateKey</span><span class="op" id="7161196">(</span><span class="ident" id="7161197">block</span><span class="op" id="7161202">.</span><span class="ident" id="7161203">Bytes</span><span class="op" id="7161208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161211">if</span>&nbsp;<span class="ident" id="7161214">err</span>&nbsp;<span class="op" id="7161218">!=</span>&nbsp;<span class="ident" id="7161221">nil</span>&nbsp;<span class="op" id="7161225">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161229">t</span><span class="op" id="7161230">.</span><span class="ident" id="7161231">Fatalf</span><span class="op" id="7161237">(</span><span class="string" id="7161238">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7161271">,</span>&nbsp;<span class="ident" id="7161273">err</span><span class="op" id="7161276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161283">template</span>&nbsp;<span class="op" id="7161292">:=</span>&nbsp;<span class="op" id="7161295">&amp;</span><span class="ident" id="7161296">Certificate</span><span class="op" id="7161307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161311">SerialNumber</span><span class="op" id="7161323">:</span>&nbsp;<span class="ident" id="7161325">big</span><span class="op" id="7161328">.</span><span class="ident" id="7161329">NewInt</span><span class="op" id="7161335">(</span><span class="num" id="7161336">1</span><span class="op" id="7161337">)</span><span class="op" id="7161338">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161342">Subject</span><span class="op" id="7161349">:</span>&nbsp;<span class="ident" id="7161351">pkix</span><span class="op" id="7161355">.</span><span class="ident" id="7161356">Name</span><span class="op" id="7161360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161365">CommonName</span><span class="op" id="7161375">:</span>&nbsp;<span class="string" id="7161377">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7161389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161393">}</span><span class="op" id="7161394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161398">NotBefore</span><span class="op" id="7161407">:</span>&nbsp;<span class="ident" id="7161409">time</span><span class="op" id="7161413">.</span><span class="ident" id="7161414">Unix</span><span class="op" id="7161418">(</span><span class="num" id="7161419">1000</span><span class="op" id="7161423">,</span>&nbsp;<span class="num" id="7161425">0</span><span class="op" id="7161426">)</span><span class="op" id="7161427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161431">NotAfter</span><span class="op" id="7161439">:</span>&nbsp;&nbsp;<span class="ident" id="7161442">time</span><span class="op" id="7161446">.</span><span class="ident" id="7161447">Unix</span><span class="op" id="7161451">(</span><span class="num" id="7161452">100000</span><span class="op" id="7161458">,</span>&nbsp;<span class="num" id="7161460">0</span><span class="op" id="7161461">)</span><span class="op" id="7161462">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161467">BasicConstraintsValid</span><span class="op" id="7161488">:</span>&nbsp;<span class="builtintype" id="7161490">true</span><span class="op" id="7161494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161498">IsCA</span><span class="op" id="7161502">:</span>&nbsp;<span class="builtintype" id="7161504">true</span><span class="op" id="7161508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161515">serialiseAndParse</span>&nbsp;<span class="op" id="7161533">:=</span>&nbsp;<span class="keyword" id="7161536">func</span><span class="op" id="7161540">(</span><span class="ident" id="7161541">template</span>&nbsp;<span class="op" id="7161550">*</span><span class="ident" id="7161551">Certificate</span><span class="op" id="7161562">)</span>&nbsp;<span class="op" id="7161564">*</span><span class="ident" id="7161565">Certificate</span>&nbsp;<span class="op" id="7161577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161581">derBytes</span><span class="op" id="7161589">,</span>&nbsp;<span class="ident" id="7161591">err</span>&nbsp;<span class="op" id="7161595">:=</span>&nbsp;<span class="ident" id="7161598">CreateCertificate</span><span class="op" id="7161615">(</span><span class="ident" id="7161616">rand</span><span class="op" id="7161620">.</span><span class="ident" id="7161621">Reader</span><span class="op" id="7161627">,</span>&nbsp;<span class="ident" id="7161629">template</span><span class="op" id="7161637">,</span>&nbsp;<span class="ident" id="7161639">template</span><span class="op" id="7161647">,</span>&nbsp;<span class="op" id="7161649">&amp;</span><span class="ident" id="7161650">rsaPriv</span><span class="op" id="7161657">.</span><span class="ident" id="7161658">PublicKey</span><span class="op" id="7161667">,</span>&nbsp;<span class="ident" id="7161669">rsaPriv</span><span class="op" id="7161676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161680">if</span>&nbsp;<span class="ident" id="7161683">err</span>&nbsp;<span class="op" id="7161687">!=</span>&nbsp;<span class="ident" id="7161690">nil</span>&nbsp;<span class="op" id="7161694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161699">t</span><span class="op" id="7161700">.</span><span class="ident" id="7161701">Fatalf</span><span class="op" id="7161707">(</span><span class="string" id="7161708">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7161742">,</span>&nbsp;<span class="ident" id="7161744">err</span><span class="op" id="7161747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161752">return</span>&nbsp;<span class="ident" id="7161759">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161770">cert</span><span class="op" id="7161774">,</span>&nbsp;<span class="ident" id="7161776">err</span>&nbsp;<span class="op" id="7161780">:=</span>&nbsp;<span class="ident" id="7161783">ParseCertificate</span><span class="op" id="7161799">(</span><span class="ident" id="7161800">derBytes</span><span class="op" id="7161808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161812">if</span>&nbsp;<span class="ident" id="7161815">err</span>&nbsp;<span class="op" id="7161819">!=</span>&nbsp;<span class="ident" id="7161822">nil</span>&nbsp;<span class="op" id="7161826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161831">t</span><span class="op" id="7161832">.</span><span class="ident" id="7161833">Fatalf</span><span class="op" id="7161839">(</span><span class="string" id="7161840">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7161873">,</span>&nbsp;<span class="ident" id="7161875">err</span><span class="op" id="7161878">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161883">return</span>&nbsp;<span class="ident" id="7161890">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161901">return</span>&nbsp;<span class="ident" id="7161908">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7161914">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161918">cert1</span>&nbsp;<span class="op" id="7161924">:=</span>&nbsp;<span class="ident" id="7161927">serialiseAndParse</span><span class="op" id="7161944">(</span><span class="ident" id="7161945">template</span><span class="op" id="7161953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7161956">if</span>&nbsp;<span class="ident" id="7161959">m</span>&nbsp;<span class="op" id="7161961">:=</span>&nbsp;<span class="ident" id="7161964">cert1</span><span class="op" id="7161969">.</span><span class="ident" id="7161970">MaxPathLen</span><span class="op" id="7161980">;</span>&nbsp;<span class="ident" id="7161982">m</span>&nbsp;<span class="op" id="7161984">!=</span>&nbsp;<span class="op" id="7161987">-</span><span class="num" id="7161988">1</span>&nbsp;<span class="op" id="7161990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7161994">t</span><span class="op" id="7161995">.</span><span class="ident" id="7161996">Errorf</span><span class="op" id="7162002">(</span><span class="string" id="7162003">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7162052">,</span>&nbsp;<span class="ident" id="7162054">m</span><span class="op" id="7162055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162058">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7162061">if</span>&nbsp;<span class="ident" id="7162064">cert1</span><span class="op" id="7162069">.</span><span class="ident" id="7162070">MaxPathLenZero</span>&nbsp;<span class="op" id="7162085">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162089">t</span><span class="op" id="7162090">.</span><span class="ident" id="7162091">Errorf</span><span class="op" id="7162097">(</span><span class="string" id="7162098">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7162146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162153">template</span><span class="op" id="7162161">.</span><span class="ident" id="7162162">MaxPathLen</span>&nbsp;<span class="op" id="7162173">=</span>&nbsp;<span class="num" id="7162175">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162178">cert2</span>&nbsp;<span class="op" id="7162184">:=</span>&nbsp;<span class="ident" id="7162187">serialiseAndParse</span><span class="op" id="7162204">(</span><span class="ident" id="7162205">template</span><span class="op" id="7162213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7162216">if</span>&nbsp;<span class="ident" id="7162219">m</span>&nbsp;<span class="op" id="7162221">:=</span>&nbsp;<span class="ident" id="7162224">cert2</span><span class="op" id="7162229">.</span><span class="ident" id="7162230">MaxPathLen</span><span class="op" id="7162240">;</span>&nbsp;<span class="ident" id="7162242">m</span>&nbsp;<span class="op" id="7162244">!=</span>&nbsp;<span class="num" id="7162247">1</span>&nbsp;<span class="op" id="7162249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162253">t</span><span class="op" id="7162254">.</span><span class="ident" id="7162255">Errorf</span><span class="op" id="7162261">(</span><span class="string" id="7162262">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7162312">,</span>&nbsp;<span class="ident" id="7162314">m</span><span class="op" id="7162315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7162321">if</span>&nbsp;<span class="ident" id="7162324">cert2</span><span class="op" id="7162329">.</span><span class="ident" id="7162330">MaxPathLenZero</span>&nbsp;<span class="op" id="7162345">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162349">t</span><span class="op" id="7162350">.</span><span class="ident" id="7162351">Errorf</span><span class="op" id="7162357">(</span><span class="string" id="7162358">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7162405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162412">template</span><span class="op" id="7162420">.</span><span class="ident" id="7162421">MaxPathLen</span>&nbsp;<span class="op" id="7162432">=</span>&nbsp;<span class="num" id="7162434">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162437">template</span><span class="op" id="7162445">.</span><span class="ident" id="7162446">MaxPathLenZero</span>&nbsp;<span class="op" id="7162461">=</span>&nbsp;<span class="builtintype" id="7162463">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162469">cert3</span>&nbsp;<span class="op" id="7162475">:=</span>&nbsp;<span class="ident" id="7162478">serialiseAndParse</span><span class="op" id="7162495">(</span><span class="ident" id="7162496">template</span><span class="op" id="7162504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7162507">if</span>&nbsp;<span class="ident" id="7162510">m</span>&nbsp;<span class="op" id="7162512">:=</span>&nbsp;<span class="ident" id="7162515">cert3</span><span class="op" id="7162520">.</span><span class="ident" id="7162521">MaxPathLen</span><span class="op" id="7162531">;</span>&nbsp;<span class="ident" id="7162533">m</span>&nbsp;<span class="op" id="7162535">!=</span>&nbsp;<span class="num" id="7162538">0</span>&nbsp;<span class="op" id="7162540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162544">t</span><span class="op" id="7162545">.</span><span class="ident" id="7162546">Errorf</span><span class="op" id="7162552">(</span><span class="string" id="7162553">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7162597">,</span>&nbsp;<span class="ident" id="7162599">m</span><span class="op" id="7162600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7162606">if</span>&nbsp;<span class="op" id="7162609">!</span><span class="ident" id="7162610">cert3</span><span class="op" id="7162615">.</span><span class="ident" id="7162616">MaxPathLenZero</span>&nbsp;<span class="op" id="7162631">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7162635">t</span><span class="op" id="7162636">.</span><span class="ident" id="7162637">Errorf</span><span class="op" id="7162643">(</span><span class="string" id="7162644">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7162704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7162707">}</span><br>
<span class="lineno"></span><span class="op" id="7162709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7162712">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7162752">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7162853">//</span><br>
<span class="lineno"></span><span class="comment" id="7162856">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7162906">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7162922">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7162955">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7163021">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7163088">const</span>&nbsp;<span class="ident" id="7163094">csrBase64</span>&nbsp;<span class="op" id="7163104">=</span>&nbsp;<span class="string" id="7163106">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
