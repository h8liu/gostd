<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html" class="current">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4306608">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4306664">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4306718">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4306769">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="4306849">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="4306900">//</span><br>
<span class="lineno"></span><span class="comment" id="4306903">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="4306928">//</span><br>
<span class="lineno">10</span><span class="comment" id="4306931">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4306988">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="4307001">//</span><br>
<span class="lineno"></span><span class="comment" id="4307004">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="4307060">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="4307076">//</span><br>
<span class="lineno"></span><span class="comment" id="4307079">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="4307127">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="4307184">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="4307239">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="4307274">//</span><br>
<span class="lineno"></span><span class="comment" id="4307277">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="4307322">//</span><br>
<span class="lineno"></span><span class="comment" id="4307325">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="4307397">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="4307434">//</span><br>
<span class="lineno"></span><span class="keyword" id="4307437">package</span>&nbsp;<span class="ident" id="4307445">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4307456">import</span>&nbsp;<span class="op" id="4307463">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4307466">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4307475">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4307482">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4307488">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="4307494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4307497">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="4307560">type</span>&nbsp;<span class="ident" id="4307565">Error</span>&nbsp;<span class="keyword" id="4307571">struct</span>&nbsp;<span class="op" id="4307578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4307581">Code</span>&nbsp;<span class="builtintype" id="4307586">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4307591">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="4307596">string</span><br>
<span class="lineno"></span><span class="op" id="4307603">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4307606">func</span>&nbsp;<span class="op" id="4307611">(</span><span class="ident" id="4307612">e</span>&nbsp;<span class="op" id="4307614">*</span><span class="ident" id="4307615">Error</span><span class="op" id="4307620">)</span>&nbsp;<span class="ident" id="4307622">Error</span><span class="op" id="4307627">(</span><span class="op" id="4307628">)</span>&nbsp;<span class="builtintype" id="4307630">string</span>&nbsp;<span class="op" id="4307637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4307640">return</span>&nbsp;<span class="ident" id="4307647">fmt</span><span class="op" id="4307650">.</span><span class="ident" id="4307651">Sprintf</span><span class="op" id="4307658">(</span><span class="string" id="4307659">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="4307668">,</span>&nbsp;<span class="ident" id="4307670">e</span><span class="op" id="4307671">.</span><span class="ident" id="4307672">Code</span><span class="op" id="4307676">,</span>&nbsp;<span class="ident" id="4307678">e</span><span class="op" id="4307679">.</span><span class="ident" id="4307680">Msg</span><span class="op" id="4307683">)</span><br>
<span class="lineno"></span><span class="op" id="4307685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4307688">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4307743">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4307794">type</span>&nbsp;<span class="ident" id="4307799">ProtocolError</span>&nbsp;<span class="builtintype" id="4307813">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4307821">func</span>&nbsp;<span class="op" id="4307826">(</span><span class="ident" id="4307827">p</span>&nbsp;<span class="ident" id="4307829">ProtocolError</span><span class="op" id="4307842">)</span>&nbsp;<span class="ident" id="4307844">Error</span><span class="op" id="4307849">(</span><span class="op" id="4307850">)</span>&nbsp;<span class="builtintype" id="4307852">string</span>&nbsp;<span class="op" id="4307859">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4307862">return</span>&nbsp;<span class="builtintype" id="4307869">string</span><span class="op" id="4307875">(</span><span class="ident" id="4307876">p</span><span class="op" id="4307877">)</span><br>
<span class="lineno"></span><span class="op" id="4307879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4307882">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4307942">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="4307994">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4308063">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="4308112">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="4308165">type</span>&nbsp;<span class="ident" id="4308170">Conn</span>&nbsp;<span class="keyword" id="4308175">struct</span>&nbsp;<span class="op" id="4308182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308185">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308193">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308201">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308211">conn</span>&nbsp;<span class="ident" id="4308216">io</span><span class="op" id="4308218">.</span><span class="ident" id="4308219">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="4308235">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4308238">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="4308288">func</span>&nbsp;<span class="ident" id="4308293">NewConn</span><span class="op" id="4308300">(</span><span class="ident" id="4308301">conn</span>&nbsp;<span class="ident" id="4308306">io</span><span class="op" id="4308308">.</span><span class="ident" id="4308309">ReadWriteCloser</span><span class="op" id="4308324">)</span>&nbsp;<span class="op" id="4308326">*</span><span class="ident" id="4308327">Conn</span>&nbsp;<span class="op" id="4308332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4308335">return</span>&nbsp;<span class="op" id="4308342">&amp;</span><span class="ident" id="4308343">Conn</span><span class="op" id="4308347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308351">Reader</span><span class="op" id="4308357">:</span>&nbsp;<span class="ident" id="4308359">Reader</span><span class="op" id="4308365">{</span><span class="ident" id="4308366">R</span><span class="op" id="4308367">:</span>&nbsp;<span class="ident" id="4308369">bufio</span><span class="op" id="4308374">.</span><span class="ident" id="4308375">NewReader</span><span class="op" id="4308384">(</span><span class="ident" id="4308385">conn</span><span class="op" id="4308389">)</span><span class="op" id="4308390">}</span><span class="op" id="4308391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308395">Writer</span><span class="op" id="4308401">:</span>&nbsp;<span class="ident" id="4308403">Writer</span><span class="op" id="4308409">{</span><span class="ident" id="4308410">W</span><span class="op" id="4308411">:</span>&nbsp;<span class="ident" id="4308413">bufio</span><span class="op" id="4308418">.</span><span class="ident" id="4308419">NewWriter</span><span class="op" id="4308428">(</span><span class="ident" id="4308429">conn</span><span class="op" id="4308433">)</span><span class="op" id="4308434">}</span><span class="op" id="4308435">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308439">conn</span><span class="op" id="4308443">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4308447">conn</span><span class="op" id="4308451">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4308454">}</span><br>
<span class="lineno"></span><span class="op" id="4308456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4308459">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="4308491">func</span>&nbsp;<span class="op" id="4308496">(</span><span class="ident" id="4308497">c</span>&nbsp;<span class="op" id="4308499">*</span><span class="ident" id="4308500">Conn</span><span class="op" id="4308504">)</span>&nbsp;<span class="ident" id="4308506">Close</span><span class="op" id="4308511">(</span><span class="op" id="4308512">)</span>&nbsp;<span class="builtintype" id="4308514">error</span>&nbsp;<span class="op" id="4308520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4308523">return</span>&nbsp;<span class="ident" id="4308530">c</span><span class="op" id="4308531">.</span><span class="ident" id="4308532">conn</span><span class="op" id="4308536">.</span><span class="ident" id="4308537">Close</span><span class="op" id="4308542">(</span><span class="op" id="4308543">)</span><br>
<span class="lineno"></span><span class="op" id="4308545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4308548">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="4308622">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4308673">func</span>&nbsp;<span class="ident" id="4308678">Dial</span><span class="op" id="4308682">(</span><span class="ident" id="4308683">network</span><span class="op" id="4308690">,</span>&nbsp;<span class="ident" id="4308692">addr</span>&nbsp;<span class="builtintype" id="4308697">string</span><span class="op" id="4308703">)</span>&nbsp;<span class="op" id="4308705">(</span><span class="op" id="4308706">*</span><span class="ident" id="4308707">Conn</span><span class="op" id="4308711">,</span>&nbsp;<span class="builtintype" id="4308713">error</span><span class="op" id="4308718">)</span>&nbsp;<span class="op" id="4308720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4308723">c</span><span class="op" id="4308724">,</span>&nbsp;<span class="ident" id="4308726">err</span>&nbsp;<span class="op" id="4308730">:=</span>&nbsp;<span class="ident" id="4308733">net</span><span class="op" id="4308736">.</span><span class="ident" id="4308737">Dial</span><span class="op" id="4308741">(</span><span class="ident" id="4308742">network</span><span class="op" id="4308749">,</span>&nbsp;<span class="ident" id="4308751">addr</span><span class="op" id="4308755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4308758">if</span>&nbsp;<span class="ident" id="4308761">err</span>&nbsp;<span class="op" id="4308765">!=</span>&nbsp;<span class="builtintype" id="4308768">nil</span>&nbsp;<span class="op" id="4308772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4308776">return</span>&nbsp;<span class="builtintype" id="4308783">nil</span><span class="op" id="4308786">,</span>&nbsp;<span class="ident" id="4308788">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4308793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4308796">return</span>&nbsp;<span class="ident" id="4308803">NewConn</span><span class="op" id="4308810">(</span><span class="ident" id="4308811">c</span><span class="op" id="4308812">)</span><span class="op" id="4308813">,</span>&nbsp;<span class="builtintype" id="4308815">nil</span><br>
<span class="lineno"></span><span class="op" id="4308819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4308822">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="4308880">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4308942">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="4309003">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="4309085">//</span><br>
<span class="lineno"></span><span class="comment" id="4309088">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="4309162">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="4309175">//</span><br>
<span class="lineno"></span><span class="comment" id="4309178">//&nbsp;&nbsp;&nbsp;&nbsp;id,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4309206">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4309225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="4309245">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4309250">//</span><br>
<span class="lineno"></span><span class="comment" id="4309253">//&nbsp;&nbsp;&nbsp;&nbsp;c.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4309276">//&nbsp;&nbsp;&nbsp;&nbsp;defer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4309303">//</span><br>
<span class="lineno">105</span><span class="comment" id="4309306">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4309358">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4309378">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4309383">//&nbsp;&nbsp;&nbsp;&nbsp;text,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="4309416">//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="4309435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4309455">//&nbsp;&nbsp;&nbsp;&nbsp;}</span><br>
<span class="lineno"></span><span class="comment" id="4309460">//&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="4309490">//</span><br>
<span class="lineno"></span><span class="keyword" id="4309493">func</span>&nbsp;<span class="op" id="4309498">(</span><span class="ident" id="4309499">c</span>&nbsp;<span class="op" id="4309501">*</span><span class="ident" id="4309502">Conn</span><span class="op" id="4309506">)</span>&nbsp;<span class="ident" id="4309508">Cmd</span><span class="op" id="4309511">(</span><span class="ident" id="4309512">format</span>&nbsp;<span class="builtintype" id="4309519">string</span><span class="op" id="4309525">,</span>&nbsp;<span class="ident" id="4309527">args</span>&nbsp;<span class="op" id="4309532">...</span><span class="keyword" id="4309535">interface</span><span class="op" id="4309544">{</span><span class="op" id="4309545">}</span><span class="op" id="4309546">)</span>&nbsp;<span class="op" id="4309548">(</span><span class="ident" id="4309549">id</span>&nbsp;<span class="builtintype" id="4309552">uint</span><span class="op" id="4309556">,</span>&nbsp;<span class="ident" id="4309558">err</span>&nbsp;<span class="builtintype" id="4309562">error</span><span class="op" id="4309567">)</span>&nbsp;<span class="op" id="4309569">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309572">id</span>&nbsp;<span class="op" id="4309575">=</span>&nbsp;<span class="ident" id="4309577">c</span><span class="op" id="4309578">.</span><span class="ident" id="4309579">Next</span><span class="op" id="4309583">(</span><span class="op" id="4309584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309587">c</span><span class="op" id="4309588">.</span><span class="ident" id="4309589">StartRequest</span><span class="op" id="4309601">(</span><span class="ident" id="4309602">id</span><span class="op" id="4309604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309607">err</span>&nbsp;<span class="op" id="4309611">=</span>&nbsp;<span class="ident" id="4309613">c</span><span class="op" id="4309614">.</span><span class="ident" id="4309615">PrintfLine</span><span class="op" id="4309625">(</span><span class="ident" id="4309626">format</span><span class="op" id="4309632">,</span>&nbsp;<span class="ident" id="4309634">args</span><span class="op" id="4309638">...</span><span class="op" id="4309641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309644">c</span><span class="op" id="4309645">.</span><span class="ident" id="4309646">EndRequest</span><span class="op" id="4309656">(</span><span class="ident" id="4309657">id</span><span class="op" id="4309659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309662">if</span>&nbsp;<span class="ident" id="4309665">err</span>&nbsp;<span class="op" id="4309669">!=</span>&nbsp;<span class="builtintype" id="4309672">nil</span>&nbsp;<span class="op" id="4309676">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309680">return</span>&nbsp;<span class="num" id="4309687">0</span><span class="op" id="4309688">,</span>&nbsp;<span class="ident" id="4309690">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4309695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309698">return</span>&nbsp;<span class="ident" id="4309705">id</span><span class="op" id="4309707">,</span>&nbsp;<span class="builtintype" id="4309709">nil</span><br>
<span class="lineno"></span><span class="op" id="4309713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4309716">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4309782">func</span>&nbsp;<span class="ident" id="4309787">TrimString</span><span class="op" id="4309797">(</span><span class="ident" id="4309798">s</span>&nbsp;<span class="builtintype" id="4309800">string</span><span class="op" id="4309806">)</span>&nbsp;<span class="builtintype" id="4309808">string</span>&nbsp;<span class="op" id="4309815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309818">for</span>&nbsp;<span class="builtinfunc" id="4309822">len</span><span class="op" id="4309825">(</span><span class="ident" id="4309826">s</span><span class="op" id="4309827">)</span>&nbsp;<span class="op" id="4309829">&gt;</span>&nbsp;<span class="num" id="4309831">0</span>&nbsp;<span class="op" id="4309833">&amp;&amp;</span>&nbsp;<span class="ident" id="4309836">isASCIISpace</span><span class="op" id="4309848">(</span><span class="ident" id="4309849">s</span><span class="op" id="4309850">[</span><span class="num" id="4309851">0</span><span class="op" id="4309852">]</span><span class="op" id="4309853">)</span>&nbsp;<span class="op" id="4309855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309859">s</span>&nbsp;<span class="op" id="4309861">=</span>&nbsp;<span class="ident" id="4309863">s</span><span class="op" id="4309864">[</span><span class="num" id="4309865">1</span><span class="op" id="4309866">:</span><span class="op" id="4309867">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4309870">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309873">for</span>&nbsp;<span class="builtinfunc" id="4309877">len</span><span class="op" id="4309880">(</span><span class="ident" id="4309881">s</span><span class="op" id="4309882">)</span>&nbsp;<span class="op" id="4309884">&gt;</span>&nbsp;<span class="num" id="4309886">0</span>&nbsp;<span class="op" id="4309888">&amp;&amp;</span>&nbsp;<span class="ident" id="4309891">isASCIISpace</span><span class="op" id="4309903">(</span><span class="ident" id="4309904">s</span><span class="op" id="4309905">[</span><span class="builtinfunc" id="4309906">len</span><span class="op" id="4309909">(</span><span class="ident" id="4309910">s</span><span class="op" id="4309911">)</span><span class="op" id="4309912">-</span><span class="num" id="4309913">1</span><span class="op" id="4309914">]</span><span class="op" id="4309915">)</span>&nbsp;<span class="op" id="4309917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4309921">s</span>&nbsp;<span class="op" id="4309923">=</span>&nbsp;<span class="ident" id="4309925">s</span><span class="op" id="4309926">[</span><span class="op" id="4309927">:</span><span class="builtinfunc" id="4309928">len</span><span class="op" id="4309931">(</span><span class="ident" id="4309932">s</span><span class="op" id="4309933">)</span><span class="op" id="4309934">-</span><span class="num" id="4309935">1</span><span class="op" id="4309936">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4309939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4309942">return</span>&nbsp;<span class="ident" id="4309949">s</span><br>
<span class="lineno"></span><span class="op" id="4309951">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4309954">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4310019">func</span>&nbsp;<span class="ident" id="4310024">TrimBytes</span><span class="op" id="4310033">(</span><span class="ident" id="4310034">b</span>&nbsp;<span class="op" id="4310036">[</span><span class="op" id="4310037">]</span><span class="builtintype" id="4310038">byte</span><span class="op" id="4310042">)</span>&nbsp;<span class="op" id="4310044">[</span><span class="op" id="4310045">]</span><span class="builtintype" id="4310046">byte</span>&nbsp;<span class="op" id="4310051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310054">for</span>&nbsp;<span class="builtinfunc" id="4310058">len</span><span class="op" id="4310061">(</span><span class="ident" id="4310062">b</span><span class="op" id="4310063">)</span>&nbsp;<span class="op" id="4310065">&gt;</span>&nbsp;<span class="num" id="4310067">0</span>&nbsp;<span class="op" id="4310069">&amp;&amp;</span>&nbsp;<span class="ident" id="4310072">isASCIISpace</span><span class="op" id="4310084">(</span><span class="ident" id="4310085">b</span><span class="op" id="4310086">[</span><span class="num" id="4310087">0</span><span class="op" id="4310088">]</span><span class="op" id="4310089">)</span>&nbsp;<span class="op" id="4310091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4310095">b</span>&nbsp;<span class="op" id="4310097">=</span>&nbsp;<span class="ident" id="4310099">b</span><span class="op" id="4310100">[</span><span class="num" id="4310101">1</span><span class="op" id="4310102">:</span><span class="op" id="4310103">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4310106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310109">for</span>&nbsp;<span class="builtinfunc" id="4310113">len</span><span class="op" id="4310116">(</span><span class="ident" id="4310117">b</span><span class="op" id="4310118">)</span>&nbsp;<span class="op" id="4310120">&gt;</span>&nbsp;<span class="num" id="4310122">0</span>&nbsp;<span class="op" id="4310124">&amp;&amp;</span>&nbsp;<span class="ident" id="4310127">isASCIISpace</span><span class="op" id="4310139">(</span><span class="ident" id="4310140">b</span><span class="op" id="4310141">[</span><span class="builtinfunc" id="4310142">len</span><span class="op" id="4310145">(</span><span class="ident" id="4310146">b</span><span class="op" id="4310147">)</span><span class="op" id="4310148">-</span><span class="num" id="4310149">1</span><span class="op" id="4310150">]</span><span class="op" id="4310151">)</span>&nbsp;<span class="op" id="4310153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4310157">b</span>&nbsp;<span class="op" id="4310159">=</span>&nbsp;<span class="ident" id="4310161">b</span><span class="op" id="4310162">[</span><span class="op" id="4310163">:</span><span class="builtinfunc" id="4310164">len</span><span class="op" id="4310167">(</span><span class="ident" id="4310168">b</span><span class="op" id="4310169">)</span><span class="op" id="4310170">-</span><span class="num" id="4310171">1</span><span class="op" id="4310172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4310175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310178">return</span>&nbsp;<span class="ident" id="4310185">b</span><br>
<span class="lineno">145</span><span class="op" id="4310187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4310190">func</span>&nbsp;<span class="ident" id="4310195">isASCIISpace</span><span class="op" id="4310207">(</span><span class="ident" id="4310208">b</span>&nbsp;<span class="builtintype" id="4310210">byte</span><span class="op" id="4310214">)</span>&nbsp;<span class="builtintype" id="4310216">bool</span>&nbsp;<span class="op" id="4310221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310224">return</span>&nbsp;<span class="ident" id="4310231">b</span>&nbsp;<span class="op" id="4310233">==</span>&nbsp;<span class="string" id="4310236">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4310240">||</span>&nbsp;<span class="ident" id="4310243">b</span>&nbsp;<span class="op" id="4310245">==</span>&nbsp;<span class="string" id="4310248">&#39;\t&#39;</span>&nbsp;<span class="op" id="4310253">||</span>&nbsp;<span class="ident" id="4310256">b</span>&nbsp;<span class="op" id="4310258">==</span>&nbsp;<span class="string" id="4310261">&#39;\n&#39;</span>&nbsp;<span class="op" id="4310266">||</span>&nbsp;<span class="ident" id="4310269">b</span>&nbsp;<span class="op" id="4310271">==</span>&nbsp;<span class="string" id="4310274">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="4310279">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="4310282">func</span>&nbsp;<span class="ident" id="4310287">isASCIILetter</span><span class="op" id="4310300">(</span><span class="ident" id="4310301">b</span>&nbsp;<span class="builtintype" id="4310303">byte</span><span class="op" id="4310307">)</span>&nbsp;<span class="builtintype" id="4310309">bool</span>&nbsp;<span class="op" id="4310314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4310317">b</span>&nbsp;<span class="op" id="4310319">|=</span>&nbsp;<span class="num" id="4310322">0x20</span>&nbsp;<span class="comment" id="4310327">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4310347">return</span>&nbsp;<span class="string" id="4310354">&#39;a&#39;</span>&nbsp;<span class="op" id="4310358">&lt;=</span>&nbsp;<span class="ident" id="4310361">b</span>&nbsp;<span class="op" id="4310363">&amp;&amp;</span>&nbsp;<span class="ident" id="4310366">b</span>&nbsp;<span class="op" id="4310368">&lt;=</span>&nbsp;<span class="string" id="4310371">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="4310375">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
