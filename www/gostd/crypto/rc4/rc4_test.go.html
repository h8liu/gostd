<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7691045">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7691100">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7691154">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7691205">package</span>&nbsp;<span class="ident" id="7691213">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7691218">import</span>&nbsp;<span class="op" id="7691225">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7691228">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7691237">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7691244">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7691254">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7691257">type</span>&nbsp;<span class="ident" id="7691262">rc4Test</span>&nbsp;<span class="keyword" id="7691270">struct</span>&nbsp;<span class="op" id="7691277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7691280">key</span><span class="op" id="7691283">,</span>&nbsp;<span class="ident" id="7691285">keystream</span>&nbsp;<span class="op" id="7691295">[</span><span class="op" id="7691296">]</span><span class="builtintype" id="7691297">byte</span><br>
<span class="lineno">15</span><span class="op" id="7691302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7691305">var</span>&nbsp;<span class="ident" id="7691309">golden</span>&nbsp;<span class="op" id="7691316">=</span>&nbsp;<span class="op" id="7691318">[</span><span class="op" id="7691319">]</span><span class="ident" id="7691320">rc4Test</span><span class="op" id="7691327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7691330">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7691393">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691471">[</span><span class="op" id="7691472">]</span><span class="builtintype" id="7691473">byte</span><span class="op" id="7691477">{</span><span class="num" id="7691478">0x01</span><span class="op" id="7691482">,</span>&nbsp;<span class="num" id="7691484">0x23</span><span class="op" id="7691488">,</span>&nbsp;<span class="num" id="7691490">0x45</span><span class="op" id="7691494">,</span>&nbsp;<span class="num" id="7691496">0x67</span><span class="op" id="7691500">,</span>&nbsp;<span class="num" id="7691502">0x89</span><span class="op" id="7691506">,</span>&nbsp;<span class="num" id="7691508">0xab</span><span class="op" id="7691512">,</span>&nbsp;<span class="num" id="7691514">0xcd</span><span class="op" id="7691518">,</span>&nbsp;<span class="num" id="7691520">0xef</span><span class="op" id="7691524">}</span><span class="op" id="7691525">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691529">[</span><span class="op" id="7691530">]</span><span class="builtintype" id="7691531">byte</span><span class="op" id="7691535">{</span><span class="num" id="7691536">0x74</span><span class="op" id="7691540">,</span>&nbsp;<span class="num" id="7691542">0x94</span><span class="op" id="7691546">,</span>&nbsp;<span class="num" id="7691548">0xc2</span><span class="op" id="7691552">,</span>&nbsp;<span class="num" id="7691554">0xe7</span><span class="op" id="7691558">,</span>&nbsp;<span class="num" id="7691560">0x10</span><span class="op" id="7691564">,</span>&nbsp;<span class="num" id="7691566">0x4b</span><span class="op" id="7691570">,</span>&nbsp;<span class="num" id="7691572">0x08</span><span class="op" id="7691576">,</span>&nbsp;<span class="num" id="7691578">0x79</span><span class="op" id="7691582">}</span><span class="op" id="7691583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691586">}</span><span class="op" id="7691587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691590">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691594">[</span><span class="op" id="7691595">]</span><span class="builtintype" id="7691596">byte</span><span class="op" id="7691600">{</span><span class="num" id="7691601">0x00</span><span class="op" id="7691605">,</span>&nbsp;<span class="num" id="7691607">0x00</span><span class="op" id="7691611">,</span>&nbsp;<span class="num" id="7691613">0x00</span><span class="op" id="7691617">,</span>&nbsp;<span class="num" id="7691619">0x00</span><span class="op" id="7691623">,</span>&nbsp;<span class="num" id="7691625">0x00</span><span class="op" id="7691629">,</span>&nbsp;<span class="num" id="7691631">0x00</span><span class="op" id="7691635">,</span>&nbsp;<span class="num" id="7691637">0x00</span><span class="op" id="7691641">,</span>&nbsp;<span class="num" id="7691643">0x00</span><span class="op" id="7691647">}</span><span class="op" id="7691648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691652">[</span><span class="op" id="7691653">]</span><span class="builtintype" id="7691654">byte</span><span class="op" id="7691658">{</span><span class="num" id="7691659">0xde</span><span class="op" id="7691663">,</span>&nbsp;<span class="num" id="7691665">0x18</span><span class="op" id="7691669">,</span>&nbsp;<span class="num" id="7691671">0x89</span><span class="op" id="7691675">,</span>&nbsp;<span class="num" id="7691677">0x41</span><span class="op" id="7691681">,</span>&nbsp;<span class="num" id="7691683">0xa3</span><span class="op" id="7691687">,</span>&nbsp;<span class="num" id="7691689">0x37</span><span class="op" id="7691693">,</span>&nbsp;<span class="num" id="7691695">0x5d</span><span class="op" id="7691699">,</span>&nbsp;<span class="num" id="7691701">0x3a</span><span class="op" id="7691705">}</span><span class="op" id="7691706">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691709">}</span><span class="op" id="7691710">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691717">[</span><span class="op" id="7691718">]</span><span class="builtintype" id="7691719">byte</span><span class="op" id="7691723">{</span><span class="num" id="7691724">0xef</span><span class="op" id="7691728">,</span>&nbsp;<span class="num" id="7691730">0x01</span><span class="op" id="7691734">,</span>&nbsp;<span class="num" id="7691736">0x23</span><span class="op" id="7691740">,</span>&nbsp;<span class="num" id="7691742">0x45</span><span class="op" id="7691746">}</span><span class="op" id="7691747">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691751">[</span><span class="op" id="7691752">]</span><span class="builtintype" id="7691753">byte</span><span class="op" id="7691757">{</span><span class="num" id="7691758">0xd6</span><span class="op" id="7691762">,</span>&nbsp;<span class="num" id="7691764">0xa1</span><span class="op" id="7691768">,</span>&nbsp;<span class="num" id="7691770">0x41</span><span class="op" id="7691774">,</span>&nbsp;<span class="num" id="7691776">0xa7</span><span class="op" id="7691780">,</span>&nbsp;<span class="num" id="7691782">0xec</span><span class="op" id="7691786">,</span>&nbsp;<span class="num" id="7691788">0x3c</span><span class="op" id="7691792">,</span>&nbsp;<span class="num" id="7691794">0x38</span><span class="op" id="7691798">,</span>&nbsp;<span class="num" id="7691800">0xdf</span><span class="op" id="7691804">,</span>&nbsp;<span class="num" id="7691806">0xbd</span><span class="op" id="7691810">,</span>&nbsp;<span class="num" id="7691812">0x61</span><span class="op" id="7691816">}</span><span class="op" id="7691817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691820">}</span><span class="op" id="7691821">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7691825">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691900">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691904">[</span><span class="op" id="7691905">]</span><span class="builtintype" id="7691906">byte</span><span class="op" id="7691910">{</span><span class="num" id="7691911">0x4b</span><span class="op" id="7691915">,</span>&nbsp;<span class="num" id="7691917">0x65</span><span class="op" id="7691921">,</span>&nbsp;<span class="num" id="7691923">0x79</span><span class="op" id="7691927">}</span><span class="op" id="7691928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7691932">[</span><span class="op" id="7691933">]</span><span class="builtintype" id="7691934">byte</span><span class="op" id="7691938">{</span><span class="num" id="7691939">0xeb</span><span class="op" id="7691943">,</span>&nbsp;<span class="num" id="7691945">0x9f</span><span class="op" id="7691949">,</span>&nbsp;<span class="num" id="7691951">0x77</span><span class="op" id="7691955">,</span>&nbsp;<span class="num" id="7691957">0x81</span><span class="op" id="7691961">,</span>&nbsp;<span class="num" id="7691963">0xb7</span><span class="op" id="7691967">,</span>&nbsp;<span class="num" id="7691969">0x34</span><span class="op" id="7691973">,</span>&nbsp;<span class="num" id="7691975">0xca</span><span class="op" id="7691979">,</span>&nbsp;<span class="num" id="7691981">0x72</span><span class="op" id="7691985">,</span>&nbsp;<span class="num" id="7691987">0xa7</span><span class="op" id="7691991">,</span>&nbsp;<span class="num" id="7691993">0x19</span><span class="op" id="7691997">}</span><span class="op" id="7691998">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692001">}</span><span class="op" id="7692002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692009">[</span><span class="op" id="7692010">]</span><span class="builtintype" id="7692011">byte</span><span class="op" id="7692015">{</span><span class="num" id="7692016">0x57</span><span class="op" id="7692020">,</span>&nbsp;<span class="num" id="7692022">0x69</span><span class="op" id="7692026">,</span>&nbsp;<span class="num" id="7692028">0x6b</span><span class="op" id="7692032">,</span>&nbsp;<span class="num" id="7692034">0x69</span><span class="op" id="7692038">}</span><span class="op" id="7692039">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692043">[</span><span class="op" id="7692044">]</span><span class="builtintype" id="7692045">byte</span><span class="op" id="7692049">{</span><span class="num" id="7692050">0x60</span><span class="op" id="7692054">,</span>&nbsp;<span class="num" id="7692056">0x44</span><span class="op" id="7692060">,</span>&nbsp;<span class="num" id="7692062">0xdb</span><span class="op" id="7692066">,</span>&nbsp;<span class="num" id="7692068">0x6d</span><span class="op" id="7692072">,</span>&nbsp;<span class="num" id="7692074">0x41</span><span class="op" id="7692078">,</span>&nbsp;<span class="num" id="7692080">0xb7</span><span class="op" id="7692084">}</span><span class="op" id="7692085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692088">}</span><span class="op" id="7692089">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692096">[</span><span class="op" id="7692097">]</span><span class="builtintype" id="7692098">byte</span><span class="op" id="7692102">{</span><span class="num" id="7692103">0x00</span><span class="op" id="7692107">,</span>&nbsp;<span class="num" id="7692109">0x00</span><span class="op" id="7692113">,</span>&nbsp;<span class="num" id="7692115">0x00</span><span class="op" id="7692119">,</span>&nbsp;<span class="num" id="7692121">0x00</span><span class="op" id="7692125">,</span>&nbsp;<span class="num" id="7692127">0x00</span><span class="op" id="7692131">,</span>&nbsp;<span class="num" id="7692133">0x00</span><span class="op" id="7692137">,</span>&nbsp;<span class="num" id="7692139">0x00</span><span class="op" id="7692143">,</span>&nbsp;<span class="num" id="7692145">0x00</span><span class="op" id="7692149">}</span><span class="op" id="7692150">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7692154">[</span><span class="op" id="7692155">]</span><span class="builtintype" id="7692156">byte</span><span class="op" id="7692160">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692165">0xde</span><span class="op" id="7692169">,</span>&nbsp;<span class="num" id="7692171">0x18</span><span class="op" id="7692175">,</span>&nbsp;<span class="num" id="7692177">0x89</span><span class="op" id="7692181">,</span>&nbsp;<span class="num" id="7692183">0x41</span><span class="op" id="7692187">,</span>&nbsp;<span class="num" id="7692189">0xa3</span><span class="op" id="7692193">,</span>&nbsp;<span class="num" id="7692195">0x37</span><span class="op" id="7692199">,</span>&nbsp;<span class="num" id="7692201">0x5d</span><span class="op" id="7692205">,</span>&nbsp;<span class="num" id="7692207">0x3a</span><span class="op" id="7692211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692216">0x8a</span><span class="op" id="7692220">,</span>&nbsp;<span class="num" id="7692222">0x06</span><span class="op" id="7692226">,</span>&nbsp;<span class="num" id="7692228">0x1e</span><span class="op" id="7692232">,</span>&nbsp;<span class="num" id="7692234">0x67</span><span class="op" id="7692238">,</span>&nbsp;<span class="num" id="7692240">0x57</span><span class="op" id="7692244">,</span>&nbsp;<span class="num" id="7692246">0x6e</span><span class="op" id="7692250">,</span>&nbsp;<span class="num" id="7692252">0x92</span><span class="op" id="7692256">,</span>&nbsp;<span class="num" id="7692258">0x6d</span><span class="op" id="7692262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692267">0xc7</span><span class="op" id="7692271">,</span>&nbsp;<span class="num" id="7692273">0x1a</span><span class="op" id="7692277">,</span>&nbsp;<span class="num" id="7692279">0x7f</span><span class="op" id="7692283">,</span>&nbsp;<span class="num" id="7692285">0xa3</span><span class="op" id="7692289">,</span>&nbsp;<span class="num" id="7692291">0xf0</span><span class="op" id="7692295">,</span>&nbsp;<span class="num" id="7692297">0xcc</span><span class="op" id="7692301">,</span>&nbsp;<span class="num" id="7692303">0xeb</span><span class="op" id="7692307">,</span>&nbsp;<span class="num" id="7692309">0x97</span><span class="op" id="7692313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692318">0x45</span><span class="op" id="7692322">,</span>&nbsp;<span class="num" id="7692324">0x2b</span><span class="op" id="7692328">,</span>&nbsp;<span class="num" id="7692330">0x4d</span><span class="op" id="7692334">,</span>&nbsp;<span class="num" id="7692336">0x32</span><span class="op" id="7692340">,</span>&nbsp;<span class="num" id="7692342">0x27</span><span class="op" id="7692346">,</span>&nbsp;<span class="num" id="7692348">0x96</span><span class="op" id="7692352">,</span>&nbsp;<span class="num" id="7692354">0x5f</span><span class="op" id="7692358">,</span>&nbsp;<span class="num" id="7692360">0x9e</span><span class="op" id="7692364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692369">0xa8</span><span class="op" id="7692373">,</span>&nbsp;<span class="num" id="7692375">0xcc</span><span class="op" id="7692379">,</span>&nbsp;<span class="num" id="7692381">0x75</span><span class="op" id="7692385">,</span>&nbsp;<span class="num" id="7692387">0x07</span><span class="op" id="7692391">,</span>&nbsp;<span class="num" id="7692393">0x6d</span><span class="op" id="7692397">,</span>&nbsp;<span class="num" id="7692399">0x9f</span><span class="op" id="7692403">,</span>&nbsp;<span class="num" id="7692405">0xb9</span><span class="op" id="7692409">,</span>&nbsp;<span class="num" id="7692411">0xc5</span><span class="op" id="7692415">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692420">0x41</span><span class="op" id="7692424">,</span>&nbsp;<span class="num" id="7692426">0x7a</span><span class="op" id="7692430">,</span>&nbsp;<span class="num" id="7692432">0xa5</span><span class="op" id="7692436">,</span>&nbsp;<span class="num" id="7692438">0xcb</span><span class="op" id="7692442">,</span>&nbsp;<span class="num" id="7692444">0x30</span><span class="op" id="7692448">,</span>&nbsp;<span class="num" id="7692450">0xfc</span><span class="op" id="7692454">,</span>&nbsp;<span class="num" id="7692456">0x22</span><span class="op" id="7692460">,</span>&nbsp;<span class="num" id="7692462">0x19</span><span class="op" id="7692466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692471">0x8b</span><span class="op" id="7692475">,</span>&nbsp;<span class="num" id="7692477">0x34</span><span class="op" id="7692481">,</span>&nbsp;<span class="num" id="7692483">0x98</span><span class="op" id="7692487">,</span>&nbsp;<span class="num" id="7692489">0x2d</span><span class="op" id="7692493">,</span>&nbsp;<span class="num" id="7692495">0xbb</span><span class="op" id="7692499">,</span>&nbsp;<span class="num" id="7692501">0x62</span><span class="op" id="7692505">,</span>&nbsp;<span class="num" id="7692507">0x9e</span><span class="op" id="7692511">,</span>&nbsp;<span class="num" id="7692513">0xc0</span><span class="op" id="7692517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692522">0x4b</span><span class="op" id="7692526">,</span>&nbsp;<span class="num" id="7692528">0x4f</span><span class="op" id="7692532">,</span>&nbsp;<span class="num" id="7692534">0x8b</span><span class="op" id="7692538">,</span>&nbsp;<span class="num" id="7692540">0x05</span><span class="op" id="7692544">,</span>&nbsp;<span class="num" id="7692546">0xa0</span><span class="op" id="7692550">,</span>&nbsp;<span class="num" id="7692552">0x71</span><span class="op" id="7692556">,</span>&nbsp;<span class="num" id="7692558">0x08</span><span class="op" id="7692562">,</span>&nbsp;<span class="num" id="7692564">0x50</span><span class="op" id="7692568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692573">0x92</span><span class="op" id="7692577">,</span>&nbsp;<span class="num" id="7692579">0xa0</span><span class="op" id="7692583">,</span>&nbsp;<span class="num" id="7692585">0xc3</span><span class="op" id="7692589">,</span>&nbsp;<span class="num" id="7692591">0x58</span><span class="op" id="7692595">,</span>&nbsp;<span class="num" id="7692597">0x4a</span><span class="op" id="7692601">,</span>&nbsp;<span class="num" id="7692603">0x48</span><span class="op" id="7692607">,</span>&nbsp;<span class="num" id="7692609">0xe4</span><span class="op" id="7692613">,</span>&nbsp;<span class="num" id="7692615">0xa3</span><span class="op" id="7692619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692624">0x0a</span><span class="op" id="7692628">,</span>&nbsp;<span class="num" id="7692630">0x39</span><span class="op" id="7692634">,</span>&nbsp;<span class="num" id="7692636">0x7b</span><span class="op" id="7692640">,</span>&nbsp;<span class="num" id="7692642">0x8a</span><span class="op" id="7692646">,</span>&nbsp;<span class="num" id="7692648">0xcd</span><span class="op" id="7692652">,</span>&nbsp;<span class="num" id="7692654">0x1d</span><span class="op" id="7692658">,</span>&nbsp;<span class="num" id="7692660">0x00</span><span class="op" id="7692664">,</span>&nbsp;<span class="num" id="7692666">0x9e</span><span class="op" id="7692670">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692675">0xc8</span><span class="op" id="7692679">,</span>&nbsp;<span class="num" id="7692681">0x7d</span><span class="op" id="7692685">,</span>&nbsp;<span class="num" id="7692687">0x68</span><span class="op" id="7692691">,</span>&nbsp;<span class="num" id="7692693">0x11</span><span class="op" id="7692697">,</span>&nbsp;<span class="num" id="7692699">0xf2</span><span class="op" id="7692703">,</span>&nbsp;<span class="num" id="7692705">0x2c</span><span class="op" id="7692709">,</span>&nbsp;<span class="num" id="7692711">0xf4</span><span class="op" id="7692715">,</span>&nbsp;<span class="num" id="7692717">0x9c</span><span class="op" id="7692721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692726">0xa3</span><span class="op" id="7692730">,</span>&nbsp;<span class="num" id="7692732">0xe5</span><span class="op" id="7692736">,</span>&nbsp;<span class="num" id="7692738">0x93</span><span class="op" id="7692742">,</span>&nbsp;<span class="num" id="7692744">0x54</span><span class="op" id="7692748">,</span>&nbsp;<span class="num" id="7692750">0xb9</span><span class="op" id="7692754">,</span>&nbsp;<span class="num" id="7692756">0x45</span><span class="op" id="7692760">,</span>&nbsp;<span class="num" id="7692762">0x15</span><span class="op" id="7692766">,</span>&nbsp;<span class="num" id="7692768">0x35</span><span class="op" id="7692772">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692777">0xa2</span><span class="op" id="7692781">,</span>&nbsp;<span class="num" id="7692783">0x18</span><span class="op" id="7692787">,</span>&nbsp;<span class="num" id="7692789">0x7a</span><span class="op" id="7692793">,</span>&nbsp;<span class="num" id="7692795">0x86</span><span class="op" id="7692799">,</span>&nbsp;<span class="num" id="7692801">0x42</span><span class="op" id="7692805">,</span>&nbsp;<span class="num" id="7692807">0x6c</span><span class="op" id="7692811">,</span>&nbsp;<span class="num" id="7692813">0xca</span><span class="op" id="7692817">,</span>&nbsp;<span class="num" id="7692819">0x7d</span><span class="op" id="7692823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692828">0x5e</span><span class="op" id="7692832">,</span>&nbsp;<span class="num" id="7692834">0x82</span><span class="op" id="7692838">,</span>&nbsp;<span class="num" id="7692840">0x3e</span><span class="op" id="7692844">,</span>&nbsp;<span class="num" id="7692846">0xba</span><span class="op" id="7692850">,</span>&nbsp;<span class="num" id="7692852">0x00</span><span class="op" id="7692856">,</span>&nbsp;<span class="num" id="7692858">0x44</span><span class="op" id="7692862">,</span>&nbsp;<span class="num" id="7692864">0x12</span><span class="op" id="7692868">,</span>&nbsp;<span class="num" id="7692870">0x67</span><span class="op" id="7692874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692879">0x12</span><span class="op" id="7692883">,</span>&nbsp;<span class="num" id="7692885">0x57</span><span class="op" id="7692889">,</span>&nbsp;<span class="num" id="7692891">0xb8</span><span class="op" id="7692895">,</span>&nbsp;<span class="num" id="7692897">0xd8</span><span class="op" id="7692901">,</span>&nbsp;<span class="num" id="7692903">0x60</span><span class="op" id="7692907">,</span>&nbsp;<span class="num" id="7692909">0xae</span><span class="op" id="7692913">,</span>&nbsp;<span class="num" id="7692915">0x4c</span><span class="op" id="7692919">,</span>&nbsp;<span class="num" id="7692921">0xbd</span><span class="op" id="7692925">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692930">0x4c</span><span class="op" id="7692934">,</span>&nbsp;<span class="num" id="7692936">0x49</span><span class="op" id="7692940">,</span>&nbsp;<span class="num" id="7692942">0x06</span><span class="op" id="7692946">,</span>&nbsp;<span class="num" id="7692948">0xbb</span><span class="op" id="7692952">,</span>&nbsp;<span class="num" id="7692954">0xc5</span><span class="op" id="7692958">,</span>&nbsp;<span class="num" id="7692960">0x35</span><span class="op" id="7692964">,</span>&nbsp;<span class="num" id="7692966">0xef</span><span class="op" id="7692970">,</span>&nbsp;<span class="num" id="7692972">0xe1</span><span class="op" id="7692976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7692981">0x58</span><span class="op" id="7692985">,</span>&nbsp;<span class="num" id="7692987">0x7f</span><span class="op" id="7692991">,</span>&nbsp;<span class="num" id="7692993">0x08</span><span class="op" id="7692997">,</span>&nbsp;<span class="num" id="7692999">0xdb</span><span class="op" id="7693003">,</span>&nbsp;<span class="num" id="7693005">0x33</span><span class="op" id="7693009">,</span>&nbsp;<span class="num" id="7693011">0x95</span><span class="op" id="7693015">,</span>&nbsp;<span class="num" id="7693017">0x5c</span><span class="op" id="7693021">,</span>&nbsp;<span class="num" id="7693023">0xdb</span><span class="op" id="7693027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693032">0xcb</span><span class="op" id="7693036">,</span>&nbsp;<span class="num" id="7693038">0xad</span><span class="op" id="7693042">,</span>&nbsp;<span class="num" id="7693044">0x9b</span><span class="op" id="7693048">,</span>&nbsp;<span class="num" id="7693050">0x10</span><span class="op" id="7693054">,</span>&nbsp;<span class="num" id="7693056">0xf5</span><span class="op" id="7693060">,</span>&nbsp;<span class="num" id="7693062">0x3f</span><span class="op" id="7693066">,</span>&nbsp;<span class="num" id="7693068">0xc4</span><span class="op" id="7693072">,</span>&nbsp;<span class="num" id="7693074">0xe5</span><span class="op" id="7693078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693083">0x2c</span><span class="op" id="7693087">,</span>&nbsp;<span class="num" id="7693089">0x59</span><span class="op" id="7693093">,</span>&nbsp;<span class="num" id="7693095">0x15</span><span class="op" id="7693099">,</span>&nbsp;<span class="num" id="7693101">0x65</span><span class="op" id="7693105">,</span>&nbsp;<span class="num" id="7693107">0x51</span><span class="op" id="7693111">,</span>&nbsp;<span class="num" id="7693113">0x84</span><span class="op" id="7693117">,</span>&nbsp;<span class="num" id="7693119">0x87</span><span class="op" id="7693123">,</span>&nbsp;<span class="num" id="7693125">0xfe</span><span class="op" id="7693129">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693134">0x08</span><span class="op" id="7693138">,</span>&nbsp;<span class="num" id="7693140">0x4d</span><span class="op" id="7693144">,</span>&nbsp;<span class="num" id="7693146">0x0e</span><span class="op" id="7693150">,</span>&nbsp;<span class="num" id="7693152">0x3f</span><span class="op" id="7693156">,</span>&nbsp;<span class="num" id="7693158">0x03</span><span class="op" id="7693162">,</span>&nbsp;<span class="num" id="7693164">0xde</span><span class="op" id="7693168">,</span>&nbsp;<span class="num" id="7693170">0xbc</span><span class="op" id="7693174">,</span>&nbsp;<span class="num" id="7693176">0xc9</span><span class="op" id="7693180">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693185">0xda</span><span class="op" id="7693189">,</span>&nbsp;<span class="num" id="7693191">0x1c</span><span class="op" id="7693195">,</span>&nbsp;<span class="num" id="7693197">0xe9</span><span class="op" id="7693201">,</span>&nbsp;<span class="num" id="7693203">0x0d</span><span class="op" id="7693207">,</span>&nbsp;<span class="num" id="7693209">0x08</span><span class="op" id="7693213">,</span>&nbsp;<span class="num" id="7693215">0x5c</span><span class="op" id="7693219">,</span>&nbsp;<span class="num" id="7693221">0x2d</span><span class="op" id="7693225">,</span>&nbsp;<span class="num" id="7693227">0x8a</span><span class="op" id="7693231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693236">0x19</span><span class="op" id="7693240">,</span>&nbsp;<span class="num" id="7693242">0xd8</span><span class="op" id="7693246">,</span>&nbsp;<span class="num" id="7693248">0x37</span><span class="op" id="7693252">,</span>&nbsp;<span class="num" id="7693254">0x30</span><span class="op" id="7693258">,</span>&nbsp;<span class="num" id="7693260">0x86</span><span class="op" id="7693264">,</span>&nbsp;<span class="num" id="7693266">0x16</span><span class="op" id="7693270">,</span>&nbsp;<span class="num" id="7693272">0x36</span><span class="op" id="7693276">,</span>&nbsp;<span class="num" id="7693278">0x92</span><span class="op" id="7693282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693287">0x14</span><span class="op" id="7693291">,</span>&nbsp;<span class="num" id="7693293">0x2b</span><span class="op" id="7693297">,</span>&nbsp;<span class="num" id="7693299">0xd8</span><span class="op" id="7693303">,</span>&nbsp;<span class="num" id="7693305">0xfc</span><span class="op" id="7693309">,</span>&nbsp;<span class="num" id="7693311">0x5d</span><span class="op" id="7693315">,</span>&nbsp;<span class="num" id="7693317">0x7a</span><span class="op" id="7693321">,</span>&nbsp;<span class="num" id="7693323">0x73</span><span class="op" id="7693327">,</span>&nbsp;<span class="num" id="7693329">0x49</span><span class="op" id="7693333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693338">0x6a</span><span class="op" id="7693342">,</span>&nbsp;<span class="num" id="7693344">0x8e</span><span class="op" id="7693348">,</span>&nbsp;<span class="num" id="7693350">0x59</span><span class="op" id="7693354">,</span>&nbsp;<span class="num" id="7693356">0xee</span><span class="op" id="7693360">,</span>&nbsp;<span class="num" id="7693362">0x7e</span><span class="op" id="7693366">,</span>&nbsp;<span class="num" id="7693368">0xcf</span><span class="op" id="7693372">,</span>&nbsp;<span class="num" id="7693374">0x6b</span><span class="op" id="7693378">,</span>&nbsp;<span class="num" id="7693380">0x94</span><span class="op" id="7693384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693389">0x06</span><span class="op" id="7693393">,</span>&nbsp;<span class="num" id="7693395">0x63</span><span class="op" id="7693399">,</span>&nbsp;<span class="num" id="7693401">0xf4</span><span class="op" id="7693405">,</span>&nbsp;<span class="num" id="7693407">0xa6</span><span class="op" id="7693411">,</span>&nbsp;<span class="num" id="7693413">0xbe</span><span class="op" id="7693417">,</span>&nbsp;<span class="num" id="7693419">0xe6</span><span class="op" id="7693423">,</span>&nbsp;<span class="num" id="7693425">0x5b</span><span class="op" id="7693429">,</span>&nbsp;<span class="num" id="7693431">0xd2</span><span class="op" id="7693435">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693440">0xc8</span><span class="op" id="7693444">,</span>&nbsp;<span class="num" id="7693446">0x5c</span><span class="op" id="7693450">,</span>&nbsp;<span class="num" id="7693452">0x46</span><span class="op" id="7693456">,</span>&nbsp;<span class="num" id="7693458">0x98</span><span class="op" id="7693462">,</span>&nbsp;<span class="num" id="7693464">0x6c</span><span class="op" id="7693468">,</span>&nbsp;<span class="num" id="7693470">0x1b</span><span class="op" id="7693474">,</span>&nbsp;<span class="num" id="7693476">0xef</span><span class="op" id="7693480">,</span>&nbsp;<span class="num" id="7693482">0x34</span><span class="op" id="7693486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693491">0x90</span><span class="op" id="7693495">,</span>&nbsp;<span class="num" id="7693497">0xd3</span><span class="op" id="7693501">,</span>&nbsp;<span class="num" id="7693503">0x7b</span><span class="op" id="7693507">,</span>&nbsp;<span class="num" id="7693509">0x38</span><span class="op" id="7693513">,</span>&nbsp;<span class="num" id="7693515">0xda</span><span class="op" id="7693519">,</span>&nbsp;<span class="num" id="7693521">0x85</span><span class="op" id="7693525">,</span>&nbsp;<span class="num" id="7693527">0xd3</span><span class="op" id="7693531">,</span>&nbsp;<span class="num" id="7693533">0x2e</span><span class="op" id="7693537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7693542">0x97</span><span class="op" id="7693546">,</span>&nbsp;<span class="num" id="7693548">0x39</span><span class="op" id="7693552">,</span>&nbsp;<span class="num" id="7693554">0xcb</span><span class="op" id="7693558">,</span>&nbsp;<span class="num" id="7693560">0x23</span><span class="op" id="7693564">,</span>&nbsp;<span class="num" id="7693566">0x4a</span><span class="op" id="7693570">,</span>&nbsp;<span class="num" id="7693572">0x2b</span><span class="op" id="7693576">,</span>&nbsp;<span class="num" id="7693578">0xe7</span><span class="op" id="7693582">,</span>&nbsp;<span class="num" id="7693584">0x40</span><span class="op" id="7693588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7693592">}</span><span class="op" id="7693593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7693596">}</span><span class="op" id="7693597">,</span><br>
<span class="lineno">75</span><span class="op" id="7693599">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7693602">func</span>&nbsp;<span class="ident" id="7693607">testEncrypt</span><span class="op" id="7693618">(</span><span class="ident" id="7693619">t</span>&nbsp;<span class="op" id="7693621">*</span><span class="ident" id="7693622">testing</span><span class="op" id="7693629">.</span><span class="ident" id="7693630">T</span><span class="op" id="7693631">,</span>&nbsp;<span class="ident" id="7693633">desc</span>&nbsp;<span class="builtintype" id="7693638">string</span><span class="op" id="7693644">,</span>&nbsp;<span class="ident" id="7693646">c</span>&nbsp;<span class="op" id="7693648">*</span><span class="ident" id="7693649">Cipher</span><span class="op" id="7693655">,</span>&nbsp;<span class="ident" id="7693657">src</span><span class="op" id="7693660">,</span>&nbsp;<span class="ident" id="7693662">expect</span>&nbsp;<span class="op" id="7693669">[</span><span class="op" id="7693670">]</span><span class="builtintype" id="7693671">byte</span><span class="op" id="7693675">)</span>&nbsp;<span class="op" id="7693677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7693680">dst</span>&nbsp;<span class="op" id="7693684">:=</span>&nbsp;<span class="builtinfunc" id="7693687">make</span><span class="op" id="7693691">(</span><span class="op" id="7693692">[</span><span class="op" id="7693693">]</span><span class="builtintype" id="7693694">byte</span><span class="op" id="7693698">,</span>&nbsp;<span class="builtinfunc" id="7693700">len</span><span class="op" id="7693703">(</span><span class="ident" id="7693704">src</span><span class="op" id="7693707">)</span><span class="op" id="7693708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7693711">c</span><span class="op" id="7693712">.</span><span class="ident" id="7693713">XORKeyStream</span><span class="op" id="7693725">(</span><span class="ident" id="7693726">dst</span><span class="op" id="7693729">,</span>&nbsp;<span class="ident" id="7693731">src</span><span class="op" id="7693734">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7693737">for</span>&nbsp;<span class="ident" id="7693741">i</span><span class="op" id="7693742">,</span>&nbsp;<span class="ident" id="7693744">v</span>&nbsp;<span class="op" id="7693746">:=</span>&nbsp;<span class="keyword" id="7693749">range</span>&nbsp;<span class="ident" id="7693755">dst</span>&nbsp;<span class="op" id="7693759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7693763">if</span>&nbsp;<span class="ident" id="7693766">v</span>&nbsp;<span class="op" id="7693768">!=</span>&nbsp;<span class="ident" id="7693771">expect</span><span class="op" id="7693777">[</span><span class="ident" id="7693778">i</span><span class="op" id="7693779">]</span>&nbsp;<span class="op" id="7693781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7693786">t</span><span class="op" id="7693787">.</span><span class="ident" id="7693788">Fatalf</span><span class="op" id="7693794">(</span><span class="string" id="7693795">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7693839">,</span>&nbsp;<span class="ident" id="7693841">desc</span><span class="op" id="7693845">,</span>&nbsp;<span class="ident" id="7693847">i</span><span class="op" id="7693848">,</span>&nbsp;<span class="ident" id="7693850">dst</span><span class="op" id="7693853">,</span>&nbsp;<span class="ident" id="7693855">expect</span><span class="op" id="7693861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7693865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7693868">}</span><br>
<span class="lineno">85</span><span class="op" id="7693870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7693873">func</span>&nbsp;<span class="ident" id="7693878">TestGolden</span><span class="op" id="7693888">(</span><span class="ident" id="7693889">t</span>&nbsp;<span class="op" id="7693891">*</span><span class="ident" id="7693892">testing</span><span class="op" id="7693899">.</span><span class="ident" id="7693900">T</span><span class="op" id="7693901">)</span>&nbsp;<span class="op" id="7693903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7693906">for</span>&nbsp;<span class="ident" id="7693910">gi</span><span class="op" id="7693912">,</span>&nbsp;<span class="ident" id="7693914">g</span>&nbsp;<span class="op" id="7693916">:=</span>&nbsp;<span class="keyword" id="7693919">range</span>&nbsp;<span class="ident" id="7693925">golden</span>&nbsp;<span class="op" id="7693932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7693936">data</span>&nbsp;<span class="op" id="7693941">:=</span>&nbsp;<span class="builtinfunc" id="7693944">make</span><span class="op" id="7693948">(</span><span class="op" id="7693949">[</span><span class="op" id="7693950">]</span><span class="builtintype" id="7693951">byte</span><span class="op" id="7693955">,</span>&nbsp;<span class="builtinfunc" id="7693957">len</span><span class="op" id="7693960">(</span><span class="ident" id="7693961">g</span><span class="op" id="7693962">.</span><span class="ident" id="7693963">keystream</span><span class="op" id="7693972">)</span><span class="op" id="7693973">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7693977">for</span>&nbsp;<span class="ident" id="7693981">i</span>&nbsp;<span class="op" id="7693983">:=</span>&nbsp;<span class="keyword" id="7693986">range</span>&nbsp;<span class="ident" id="7693992">data</span>&nbsp;<span class="op" id="7693997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694002">data</span><span class="op" id="7694006">[</span><span class="ident" id="7694007">i</span><span class="op" id="7694008">]</span>&nbsp;<span class="op" id="7694010">=</span>&nbsp;<span class="builtintype" id="7694012">byte</span><span class="op" id="7694016">(</span><span class="ident" id="7694017">i</span><span class="op" id="7694018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694027">expect</span>&nbsp;<span class="op" id="7694034">:=</span>&nbsp;<span class="builtinfunc" id="7694037">make</span><span class="op" id="7694041">(</span><span class="op" id="7694042">[</span><span class="op" id="7694043">]</span><span class="builtintype" id="7694044">byte</span><span class="op" id="7694048">,</span>&nbsp;<span class="builtinfunc" id="7694050">len</span><span class="op" id="7694053">(</span><span class="ident" id="7694054">g</span><span class="op" id="7694055">.</span><span class="ident" id="7694056">keystream</span><span class="op" id="7694065">)</span><span class="op" id="7694066">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7694070">for</span>&nbsp;<span class="ident" id="7694074">i</span>&nbsp;<span class="op" id="7694076">:=</span>&nbsp;<span class="keyword" id="7694079">range</span>&nbsp;<span class="ident" id="7694085">expect</span>&nbsp;<span class="op" id="7694092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694097">expect</span><span class="op" id="7694103">[</span><span class="ident" id="7694104">i</span><span class="op" id="7694105">]</span>&nbsp;<span class="op" id="7694107">=</span>&nbsp;<span class="builtintype" id="7694109">byte</span><span class="op" id="7694113">(</span><span class="ident" id="7694114">i</span><span class="op" id="7694115">)</span>&nbsp;<span class="op" id="7694117">^</span>&nbsp;<span class="ident" id="7694119">g</span><span class="op" id="7694120">.</span><span class="ident" id="7694121">keystream</span><span class="op" id="7694130">[</span><span class="ident" id="7694131">i</span><span class="op" id="7694132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7694141">for</span>&nbsp;<span class="ident" id="7694145">size</span>&nbsp;<span class="op" id="7694150">:=</span>&nbsp;<span class="num" id="7694153">1</span><span class="op" id="7694154">;</span>&nbsp;<span class="ident" id="7694156">size</span>&nbsp;<span class="op" id="7694161">&lt;=</span>&nbsp;<span class="builtinfunc" id="7694164">len</span><span class="op" id="7694167">(</span><span class="ident" id="7694168">g</span><span class="op" id="7694169">.</span><span class="ident" id="7694170">keystream</span><span class="op" id="7694179">)</span><span class="op" id="7694180">;</span>&nbsp;<span class="ident" id="7694182">size</span><span class="op" id="7694186">++</span>&nbsp;<span class="op" id="7694189">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694194">c</span><span class="op" id="7694195">,</span>&nbsp;<span class="ident" id="7694197">err</span>&nbsp;<span class="op" id="7694201">:=</span>&nbsp;<span class="ident" id="7694204">NewCipher</span><span class="op" id="7694213">(</span><span class="ident" id="7694214">g</span><span class="op" id="7694215">.</span><span class="ident" id="7694216">key</span><span class="op" id="7694219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7694224">if</span>&nbsp;<span class="ident" id="7694227">err</span>&nbsp;<span class="op" id="7694231">!=</span>&nbsp;<span class="ident" id="7694234">nil</span>&nbsp;<span class="op" id="7694238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694244">t</span><span class="op" id="7694245">.</span><span class="ident" id="7694246">Fatalf</span><span class="op" id="7694252">(</span><span class="string" id="7694253">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7694273">,</span>&nbsp;<span class="ident" id="7694275">gi</span><span class="op" id="7694277">,</span>&nbsp;<span class="ident" id="7694279">err</span><span class="op" id="7694282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694293">off</span>&nbsp;<span class="op" id="7694297">:=</span>&nbsp;<span class="num" id="7694300">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7694305">for</span>&nbsp;<span class="ident" id="7694309">off</span>&nbsp;<span class="op" id="7694313">&lt;</span>&nbsp;<span class="builtinfunc" id="7694315">len</span><span class="op" id="7694318">(</span><span class="ident" id="7694319">g</span><span class="op" id="7694320">.</span><span class="ident" id="7694321">keystream</span><span class="op" id="7694330">)</span>&nbsp;<span class="op" id="7694332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694338">n</span>&nbsp;<span class="op" id="7694340">:=</span>&nbsp;<span class="builtinfunc" id="7694343">len</span><span class="op" id="7694346">(</span><span class="ident" id="7694347">g</span><span class="op" id="7694348">.</span><span class="ident" id="7694349">keystream</span><span class="op" id="7694358">)</span>&nbsp;<span class="op" id="7694360">-</span>&nbsp;<span class="ident" id="7694362">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7694370">if</span>&nbsp;<span class="ident" id="7694373">n</span>&nbsp;<span class="op" id="7694375">&gt;</span>&nbsp;<span class="ident" id="7694377">size</span>&nbsp;<span class="op" id="7694382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694389">n</span>&nbsp;<span class="op" id="7694391">=</span>&nbsp;<span class="ident" id="7694393">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694408">desc</span>&nbsp;<span class="op" id="7694413">:=</span>&nbsp;<span class="ident" id="7694416">fmt</span><span class="op" id="7694419">.</span><span class="ident" id="7694420">Sprintf</span><span class="op" id="7694427">(</span><span class="string" id="7694428">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7694441">,</span>&nbsp;<span class="ident" id="7694443">gi</span><span class="op" id="7694445">,</span>&nbsp;<span class="ident" id="7694447">off</span><span class="op" id="7694450">,</span>&nbsp;<span class="ident" id="7694452">off</span><span class="op" id="7694455">+</span><span class="ident" id="7694456">n</span><span class="op" id="7694457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694463">testEncrypt</span><span class="op" id="7694474">(</span><span class="ident" id="7694475">t</span><span class="op" id="7694476">,</span>&nbsp;<span class="ident" id="7694478">desc</span><span class="op" id="7694482">,</span>&nbsp;<span class="ident" id="7694484">c</span><span class="op" id="7694485">,</span>&nbsp;<span class="ident" id="7694487">data</span><span class="op" id="7694491">[</span><span class="ident" id="7694492">off</span><span class="op" id="7694495">:</span><span class="ident" id="7694496">off</span><span class="op" id="7694499">+</span><span class="ident" id="7694500">n</span><span class="op" id="7694501">]</span><span class="op" id="7694502">,</span>&nbsp;<span class="ident" id="7694504">expect</span><span class="op" id="7694510">[</span><span class="ident" id="7694511">off</span><span class="op" id="7694514">:</span><span class="ident" id="7694515">off</span><span class="op" id="7694518">+</span><span class="ident" id="7694519">n</span><span class="op" id="7694520">]</span><span class="op" id="7694521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694527">off</span>&nbsp;<span class="op" id="7694531">+=</span>&nbsp;<span class="ident" id="7694534">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694539">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7694546">}</span><br>
<span class="lineno"></span><span class="op" id="7694548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7694551">func</span>&nbsp;<span class="ident" id="7694556">TestBlock</span><span class="op" id="7694565">(</span><span class="ident" id="7694566">t</span>&nbsp;<span class="op" id="7694568">*</span><span class="ident" id="7694569">testing</span><span class="op" id="7694576">.</span><span class="ident" id="7694577">T</span><span class="op" id="7694578">)</span>&nbsp;<span class="op" id="7694580">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694583">testBlock</span><span class="op" id="7694592">(</span><span class="ident" id="7694593">t</span><span class="op" id="7694594">,</span>&nbsp;<span class="op" id="7694596">(</span><span class="op" id="7694597">*</span><span class="ident" id="7694598">Cipher</span><span class="op" id="7694604">)</span><span class="op" id="7694605">.</span><span class="ident" id="7694606">XORKeyStream</span><span class="op" id="7694618">)</span><br>
<span class="lineno"></span><span class="op" id="7694620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7694623">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7694652">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7694719">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7694763">func</span>&nbsp;<span class="ident" id="7694768">TestBlockGeneric</span><span class="op" id="7694784">(</span><span class="ident" id="7694785">t</span>&nbsp;<span class="op" id="7694787">*</span><span class="ident" id="7694788">testing</span><span class="op" id="7694795">.</span><span class="ident" id="7694796">T</span><span class="op" id="7694797">)</span>&nbsp;<span class="op" id="7694799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694802">testBlock</span><span class="op" id="7694811">(</span><span class="ident" id="7694812">t</span><span class="op" id="7694813">,</span>&nbsp;<span class="op" id="7694815">(</span><span class="op" id="7694816">*</span><span class="ident" id="7694817">Cipher</span><span class="op" id="7694823">)</span><span class="op" id="7694824">.</span><span class="ident" id="7694825">xorKeyStreamGeneric</span><span class="op" id="7694844">)</span><br>
<span class="lineno"></span><span class="op" id="7694846">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7694849">func</span>&nbsp;<span class="ident" id="7694854">testBlock</span><span class="op" id="7694863">(</span><span class="ident" id="7694864">t</span>&nbsp;<span class="op" id="7694866">*</span><span class="ident" id="7694867">testing</span><span class="op" id="7694874">.</span><span class="ident" id="7694875">T</span><span class="op" id="7694876">,</span>&nbsp;<span class="ident" id="7694878">xor</span>&nbsp;<span class="keyword" id="7694882">func</span><span class="op" id="7694886">(</span><span class="ident" id="7694887">c</span>&nbsp;<span class="op" id="7694889">*</span><span class="ident" id="7694890">Cipher</span><span class="op" id="7694896">,</span>&nbsp;<span class="ident" id="7694898">dst</span><span class="op" id="7694901">,</span>&nbsp;<span class="ident" id="7694903">src</span>&nbsp;<span class="op" id="7694907">[</span><span class="op" id="7694908">]</span><span class="builtintype" id="7694909">byte</span><span class="op" id="7694913">)</span><span class="op" id="7694914">)</span>&nbsp;<span class="op" id="7694916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694919">c1a</span><span class="op" id="7694922">,</span>&nbsp;<span class="ident" id="7694924">_</span>&nbsp;<span class="op" id="7694926">:=</span>&nbsp;<span class="ident" id="7694929">NewCipher</span><span class="op" id="7694938">(</span><span class="ident" id="7694939">golden</span><span class="op" id="7694945">[</span><span class="num" id="7694946">0</span><span class="op" id="7694947">]</span><span class="op" id="7694948">.</span><span class="ident" id="7694949">key</span><span class="op" id="7694952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694955">c1b</span><span class="op" id="7694958">,</span>&nbsp;<span class="ident" id="7694960">_</span>&nbsp;<span class="op" id="7694962">:=</span>&nbsp;<span class="ident" id="7694965">NewCipher</span><span class="op" id="7694974">(</span><span class="ident" id="7694975">golden</span><span class="op" id="7694981">[</span><span class="num" id="7694982">1</span><span class="op" id="7694983">]</span><span class="op" id="7694984">.</span><span class="ident" id="7694985">key</span><span class="op" id="7694988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7694991">data1</span>&nbsp;<span class="op" id="7694997">:=</span>&nbsp;<span class="builtinfunc" id="7695000">make</span><span class="op" id="7695004">(</span><span class="op" id="7695005">[</span><span class="op" id="7695006">]</span><span class="builtintype" id="7695007">byte</span><span class="op" id="7695011">,</span>&nbsp;<span class="num" id="7695013">1</span><span class="op" id="7695014">&lt;&lt;</span><span class="num" id="7695016">20</span><span class="op" id="7695018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7695021">for</span>&nbsp;<span class="ident" id="7695025">i</span>&nbsp;<span class="op" id="7695027">:=</span>&nbsp;<span class="keyword" id="7695030">range</span>&nbsp;<span class="ident" id="7695036">data1</span>&nbsp;<span class="op" id="7695042">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695046">xor</span><span class="op" id="7695049">(</span><span class="ident" id="7695050">c1a</span><span class="op" id="7695053">,</span>&nbsp;<span class="ident" id="7695055">data1</span><span class="op" id="7695060">[</span><span class="ident" id="7695061">i</span><span class="op" id="7695062">:</span><span class="ident" id="7695063">i</span><span class="op" id="7695064">+</span><span class="num" id="7695065">1</span><span class="op" id="7695066">]</span><span class="op" id="7695067">,</span>&nbsp;<span class="ident" id="7695069">data1</span><span class="op" id="7695074">[</span><span class="ident" id="7695075">i</span><span class="op" id="7695076">:</span><span class="ident" id="7695077">i</span><span class="op" id="7695078">+</span><span class="num" id="7695079">1</span><span class="op" id="7695080">]</span><span class="op" id="7695081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695085">xor</span><span class="op" id="7695088">(</span><span class="ident" id="7695089">c1b</span><span class="op" id="7695092">,</span>&nbsp;<span class="ident" id="7695094">data1</span><span class="op" id="7695099">[</span><span class="ident" id="7695100">i</span><span class="op" id="7695101">:</span><span class="ident" id="7695102">i</span><span class="op" id="7695103">+</span><span class="num" id="7695104">1</span><span class="op" id="7695105">]</span><span class="op" id="7695106">,</span>&nbsp;<span class="ident" id="7695108">data1</span><span class="op" id="7695113">[</span><span class="ident" id="7695114">i</span><span class="op" id="7695115">:</span><span class="ident" id="7695116">i</span><span class="op" id="7695117">+</span><span class="num" id="7695118">1</span><span class="op" id="7695119">]</span><span class="op" id="7695120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7695123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695127">c2a</span><span class="op" id="7695130">,</span>&nbsp;<span class="ident" id="7695132">_</span>&nbsp;<span class="op" id="7695134">:=</span>&nbsp;<span class="ident" id="7695137">NewCipher</span><span class="op" id="7695146">(</span><span class="ident" id="7695147">golden</span><span class="op" id="7695153">[</span><span class="num" id="7695154">0</span><span class="op" id="7695155">]</span><span class="op" id="7695156">.</span><span class="ident" id="7695157">key</span><span class="op" id="7695160">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695163">c2b</span><span class="op" id="7695166">,</span>&nbsp;<span class="ident" id="7695168">_</span>&nbsp;<span class="op" id="7695170">:=</span>&nbsp;<span class="ident" id="7695173">NewCipher</span><span class="op" id="7695182">(</span><span class="ident" id="7695183">golden</span><span class="op" id="7695189">[</span><span class="num" id="7695190">1</span><span class="op" id="7695191">]</span><span class="op" id="7695192">.</span><span class="ident" id="7695193">key</span><span class="op" id="7695196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695199">data2</span>&nbsp;<span class="op" id="7695205">:=</span>&nbsp;<span class="builtinfunc" id="7695208">make</span><span class="op" id="7695212">(</span><span class="op" id="7695213">[</span><span class="op" id="7695214">]</span><span class="builtintype" id="7695215">byte</span><span class="op" id="7695219">,</span>&nbsp;<span class="num" id="7695221">1</span><span class="op" id="7695222">&lt;&lt;</span><span class="num" id="7695224">20</span><span class="op" id="7695226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695229">xor</span><span class="op" id="7695232">(</span><span class="ident" id="7695233">c2a</span><span class="op" id="7695236">,</span>&nbsp;<span class="ident" id="7695238">data2</span><span class="op" id="7695243">,</span>&nbsp;<span class="ident" id="7695245">data2</span><span class="op" id="7695250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695253">xor</span><span class="op" id="7695256">(</span><span class="ident" id="7695257">c2b</span><span class="op" id="7695260">,</span>&nbsp;<span class="ident" id="7695262">data2</span><span class="op" id="7695267">,</span>&nbsp;<span class="ident" id="7695269">data2</span><span class="op" id="7695274">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7695278">if</span>&nbsp;<span class="op" id="7695281">!</span><span class="ident" id="7695282">bytes</span><span class="op" id="7695287">.</span><span class="ident" id="7695288">Equal</span><span class="op" id="7695293">(</span><span class="ident" id="7695294">data1</span><span class="op" id="7695299">,</span>&nbsp;<span class="ident" id="7695301">data2</span><span class="op" id="7695306">)</span>&nbsp;<span class="op" id="7695308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695312">t</span><span class="op" id="7695313">.</span><span class="ident" id="7695314">Fatalf</span><span class="op" id="7695320">(</span><span class="string" id="7695321">&#34;bad&nbsp;block&#34;</span><span class="op" id="7695332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7695335">}</span><br>
<span class="lineno"></span><span class="op" id="7695337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7695340">func</span>&nbsp;<span class="ident" id="7695345">benchmark</span><span class="op" id="7695354">(</span><span class="ident" id="7695355">b</span>&nbsp;<span class="op" id="7695357">*</span><span class="ident" id="7695358">testing</span><span class="op" id="7695365">.</span><span class="ident" id="7695366">B</span><span class="op" id="7695367">,</span>&nbsp;<span class="ident" id="7695369">size</span>&nbsp;<span class="ident" id="7695374">int64</span><span class="op" id="7695379">)</span>&nbsp;<span class="op" id="7695381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695384">buf</span>&nbsp;<span class="op" id="7695388">:=</span>&nbsp;<span class="builtinfunc" id="7695391">make</span><span class="op" id="7695395">(</span><span class="op" id="7695396">[</span><span class="op" id="7695397">]</span><span class="builtintype" id="7695398">byte</span><span class="op" id="7695402">,</span>&nbsp;<span class="ident" id="7695404">size</span><span class="op" id="7695408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695411">c</span><span class="op" id="7695412">,</span>&nbsp;<span class="ident" id="7695414">err</span>&nbsp;<span class="op" id="7695418">:=</span>&nbsp;<span class="ident" id="7695421">NewCipher</span><span class="op" id="7695430">(</span><span class="ident" id="7695431">golden</span><span class="op" id="7695437">[</span><span class="num" id="7695438">0</span><span class="op" id="7695439">]</span><span class="op" id="7695440">.</span><span class="ident" id="7695441">key</span><span class="op" id="7695444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7695447">if</span>&nbsp;<span class="ident" id="7695450">err</span>&nbsp;<span class="op" id="7695454">!=</span>&nbsp;<span class="ident" id="7695457">nil</span>&nbsp;<span class="op" id="7695461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7695465">panic</span><span class="op" id="7695470">(</span><span class="ident" id="7695471">err</span><span class="op" id="7695474">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7695477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695480">b</span><span class="op" id="7695481">.</span><span class="ident" id="7695482">SetBytes</span><span class="op" id="7695490">(</span><span class="ident" id="7695491">size</span><span class="op" id="7695495">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7695499">for</span>&nbsp;<span class="ident" id="7695503">i</span>&nbsp;<span class="op" id="7695505">:=</span>&nbsp;<span class="num" id="7695508">0</span><span class="op" id="7695509">;</span>&nbsp;<span class="ident" id="7695511">i</span>&nbsp;<span class="op" id="7695513">&lt;</span>&nbsp;<span class="ident" id="7695515">b</span><span class="op" id="7695516">.</span><span class="ident" id="7695517">N</span><span class="op" id="7695518">;</span>&nbsp;<span class="ident" id="7695520">i</span><span class="op" id="7695521">++</span>&nbsp;<span class="op" id="7695524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695528">c</span><span class="op" id="7695529">.</span><span class="ident" id="7695530">XORKeyStream</span><span class="op" id="7695542">(</span><span class="ident" id="7695543">buf</span><span class="op" id="7695546">,</span>&nbsp;<span class="ident" id="7695548">buf</span><span class="op" id="7695551">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7695554">}</span><br>
<span class="lineno"></span><span class="op" id="7695556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7695559">func</span>&nbsp;<span class="ident" id="7695564">BenchmarkRC4_128</span><span class="op" id="7695580">(</span><span class="ident" id="7695581">b</span>&nbsp;<span class="op" id="7695583">*</span><span class="ident" id="7695584">testing</span><span class="op" id="7695591">.</span><span class="ident" id="7695592">B</span><span class="op" id="7695593">)</span>&nbsp;<span class="op" id="7695595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695598">benchmark</span><span class="op" id="7695607">(</span><span class="ident" id="7695608">b</span><span class="op" id="7695609">,</span>&nbsp;<span class="num" id="7695611">128</span><span class="op" id="7695614">)</span><br>
<span class="lineno">165</span><span class="op" id="7695616">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7695619">func</span>&nbsp;<span class="ident" id="7695624">BenchmarkRC4_1K</span><span class="op" id="7695639">(</span><span class="ident" id="7695640">b</span>&nbsp;<span class="op" id="7695642">*</span><span class="ident" id="7695643">testing</span><span class="op" id="7695650">.</span><span class="ident" id="7695651">B</span><span class="op" id="7695652">)</span>&nbsp;<span class="op" id="7695654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695657">benchmark</span><span class="op" id="7695666">(</span><span class="ident" id="7695667">b</span><span class="op" id="7695668">,</span>&nbsp;<span class="num" id="7695670">1024</span><span class="op" id="7695674">)</span><br>
<span class="lineno"></span><span class="op" id="7695676">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7695679">func</span>&nbsp;<span class="ident" id="7695684">BenchmarkRC4_8K</span><span class="op" id="7695699">(</span><span class="ident" id="7695700">b</span>&nbsp;<span class="op" id="7695702">*</span><span class="ident" id="7695703">testing</span><span class="op" id="7695710">.</span><span class="ident" id="7695711">B</span><span class="op" id="7695712">)</span>&nbsp;<span class="op" id="7695714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7695717">benchmark</span><span class="op" id="7695726">(</span><span class="ident" id="7695727">b</span><span class="op" id="7695728">,</span>&nbsp;<span class="num" id="7695730">8096</span><span class="op" id="7695734">)</span><br>
<span class="lineno"></span><span class="op" id="7695736">}</span>
</div>
</body>
</html>
