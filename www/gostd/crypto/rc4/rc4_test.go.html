<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/rc4</h2>
<ul>
<li><a href="/gostd/crypto/rc4/rc4.go.html">rc4.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_asm.go.html">rc4_asm.go</a></li>
<li><a href="/gostd/crypto/rc4/rc4_test.go.html" class="current">rc4_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7044966">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7045021">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7045075">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7045126">package</span>&nbsp;<span class="ident" id="7045134">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7045139">import</span>&nbsp;<span class="op" id="7045146">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7045149">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7045158">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7045165">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7045175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7045178">type</span>&nbsp;<span class="ident" id="7045183">rc4Test</span>&nbsp;<span class="keyword" id="7045191">struct</span>&nbsp;<span class="op" id="7045198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7045201">key</span><span class="op" id="7045204">,</span>&nbsp;<span class="ident" id="7045206">keystream</span>&nbsp;<span class="op" id="7045216">[</span><span class="op" id="7045217">]</span><span class="builtintype" id="7045218">byte</span><br>
<span class="lineno">15</span><span class="op" id="7045223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7045226">var</span>&nbsp;<span class="ident" id="7045230">golden</span>&nbsp;<span class="op" id="7045237">=</span>&nbsp;<span class="op" id="7045239">[</span><span class="op" id="7045240">]</span><span class="ident" id="7045241">rc4Test</span><span class="op" id="7045248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7045251">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7045314">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045392">[</span><span class="op" id="7045393">]</span><span class="builtintype" id="7045394">byte</span><span class="op" id="7045398">{</span><span class="num" id="7045399">0x01</span><span class="op" id="7045403">,</span>&nbsp;<span class="num" id="7045405">0x23</span><span class="op" id="7045409">,</span>&nbsp;<span class="num" id="7045411">0x45</span><span class="op" id="7045415">,</span>&nbsp;<span class="num" id="7045417">0x67</span><span class="op" id="7045421">,</span>&nbsp;<span class="num" id="7045423">0x89</span><span class="op" id="7045427">,</span>&nbsp;<span class="num" id="7045429">0xab</span><span class="op" id="7045433">,</span>&nbsp;<span class="num" id="7045435">0xcd</span><span class="op" id="7045439">,</span>&nbsp;<span class="num" id="7045441">0xef</span><span class="op" id="7045445">}</span><span class="op" id="7045446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045450">[</span><span class="op" id="7045451">]</span><span class="builtintype" id="7045452">byte</span><span class="op" id="7045456">{</span><span class="num" id="7045457">0x74</span><span class="op" id="7045461">,</span>&nbsp;<span class="num" id="7045463">0x94</span><span class="op" id="7045467">,</span>&nbsp;<span class="num" id="7045469">0xc2</span><span class="op" id="7045473">,</span>&nbsp;<span class="num" id="7045475">0xe7</span><span class="op" id="7045479">,</span>&nbsp;<span class="num" id="7045481">0x10</span><span class="op" id="7045485">,</span>&nbsp;<span class="num" id="7045487">0x4b</span><span class="op" id="7045491">,</span>&nbsp;<span class="num" id="7045493">0x08</span><span class="op" id="7045497">,</span>&nbsp;<span class="num" id="7045499">0x79</span><span class="op" id="7045503">}</span><span class="op" id="7045504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045507">}</span><span class="op" id="7045508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045511">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045515">[</span><span class="op" id="7045516">]</span><span class="builtintype" id="7045517">byte</span><span class="op" id="7045521">{</span><span class="num" id="7045522">0x00</span><span class="op" id="7045526">,</span>&nbsp;<span class="num" id="7045528">0x00</span><span class="op" id="7045532">,</span>&nbsp;<span class="num" id="7045534">0x00</span><span class="op" id="7045538">,</span>&nbsp;<span class="num" id="7045540">0x00</span><span class="op" id="7045544">,</span>&nbsp;<span class="num" id="7045546">0x00</span><span class="op" id="7045550">,</span>&nbsp;<span class="num" id="7045552">0x00</span><span class="op" id="7045556">,</span>&nbsp;<span class="num" id="7045558">0x00</span><span class="op" id="7045562">,</span>&nbsp;<span class="num" id="7045564">0x00</span><span class="op" id="7045568">}</span><span class="op" id="7045569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045573">[</span><span class="op" id="7045574">]</span><span class="builtintype" id="7045575">byte</span><span class="op" id="7045579">{</span><span class="num" id="7045580">0xde</span><span class="op" id="7045584">,</span>&nbsp;<span class="num" id="7045586">0x18</span><span class="op" id="7045590">,</span>&nbsp;<span class="num" id="7045592">0x89</span><span class="op" id="7045596">,</span>&nbsp;<span class="num" id="7045598">0x41</span><span class="op" id="7045602">,</span>&nbsp;<span class="num" id="7045604">0xa3</span><span class="op" id="7045608">,</span>&nbsp;<span class="num" id="7045610">0x37</span><span class="op" id="7045614">,</span>&nbsp;<span class="num" id="7045616">0x5d</span><span class="op" id="7045620">,</span>&nbsp;<span class="num" id="7045622">0x3a</span><span class="op" id="7045626">}</span><span class="op" id="7045627">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045630">}</span><span class="op" id="7045631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045638">[</span><span class="op" id="7045639">]</span><span class="builtintype" id="7045640">byte</span><span class="op" id="7045644">{</span><span class="num" id="7045645">0xef</span><span class="op" id="7045649">,</span>&nbsp;<span class="num" id="7045651">0x01</span><span class="op" id="7045655">,</span>&nbsp;<span class="num" id="7045657">0x23</span><span class="op" id="7045661">,</span>&nbsp;<span class="num" id="7045663">0x45</span><span class="op" id="7045667">}</span><span class="op" id="7045668">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045672">[</span><span class="op" id="7045673">]</span><span class="builtintype" id="7045674">byte</span><span class="op" id="7045678">{</span><span class="num" id="7045679">0xd6</span><span class="op" id="7045683">,</span>&nbsp;<span class="num" id="7045685">0xa1</span><span class="op" id="7045689">,</span>&nbsp;<span class="num" id="7045691">0x41</span><span class="op" id="7045695">,</span>&nbsp;<span class="num" id="7045697">0xa7</span><span class="op" id="7045701">,</span>&nbsp;<span class="num" id="7045703">0xec</span><span class="op" id="7045707">,</span>&nbsp;<span class="num" id="7045709">0x3c</span><span class="op" id="7045713">,</span>&nbsp;<span class="num" id="7045715">0x38</span><span class="op" id="7045719">,</span>&nbsp;<span class="num" id="7045721">0xdf</span><span class="op" id="7045725">,</span>&nbsp;<span class="num" id="7045727">0xbd</span><span class="op" id="7045731">,</span>&nbsp;<span class="num" id="7045733">0x61</span><span class="op" id="7045737">}</span><span class="op" id="7045738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045741">}</span><span class="op" id="7045742">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7045746">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045821">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045825">[</span><span class="op" id="7045826">]</span><span class="builtintype" id="7045827">byte</span><span class="op" id="7045831">{</span><span class="num" id="7045832">0x4b</span><span class="op" id="7045836">,</span>&nbsp;<span class="num" id="7045838">0x65</span><span class="op" id="7045842">,</span>&nbsp;<span class="num" id="7045844">0x79</span><span class="op" id="7045848">}</span><span class="op" id="7045849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045853">[</span><span class="op" id="7045854">]</span><span class="builtintype" id="7045855">byte</span><span class="op" id="7045859">{</span><span class="num" id="7045860">0xeb</span><span class="op" id="7045864">,</span>&nbsp;<span class="num" id="7045866">0x9f</span><span class="op" id="7045870">,</span>&nbsp;<span class="num" id="7045872">0x77</span><span class="op" id="7045876">,</span>&nbsp;<span class="num" id="7045878">0x81</span><span class="op" id="7045882">,</span>&nbsp;<span class="num" id="7045884">0xb7</span><span class="op" id="7045888">,</span>&nbsp;<span class="num" id="7045890">0x34</span><span class="op" id="7045894">,</span>&nbsp;<span class="num" id="7045896">0xca</span><span class="op" id="7045900">,</span>&nbsp;<span class="num" id="7045902">0x72</span><span class="op" id="7045906">,</span>&nbsp;<span class="num" id="7045908">0xa7</span><span class="op" id="7045912">,</span>&nbsp;<span class="num" id="7045914">0x19</span><span class="op" id="7045918">}</span><span class="op" id="7045919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045922">}</span><span class="op" id="7045923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045930">[</span><span class="op" id="7045931">]</span><span class="builtintype" id="7045932">byte</span><span class="op" id="7045936">{</span><span class="num" id="7045937">0x57</span><span class="op" id="7045941">,</span>&nbsp;<span class="num" id="7045943">0x69</span><span class="op" id="7045947">,</span>&nbsp;<span class="num" id="7045949">0x6b</span><span class="op" id="7045953">,</span>&nbsp;<span class="num" id="7045955">0x69</span><span class="op" id="7045959">}</span><span class="op" id="7045960">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7045964">[</span><span class="op" id="7045965">]</span><span class="builtintype" id="7045966">byte</span><span class="op" id="7045970">{</span><span class="num" id="7045971">0x60</span><span class="op" id="7045975">,</span>&nbsp;<span class="num" id="7045977">0x44</span><span class="op" id="7045981">,</span>&nbsp;<span class="num" id="7045983">0xdb</span><span class="op" id="7045987">,</span>&nbsp;<span class="num" id="7045989">0x6d</span><span class="op" id="7045993">,</span>&nbsp;<span class="num" id="7045995">0x41</span><span class="op" id="7045999">,</span>&nbsp;<span class="num" id="7046001">0xb7</span><span class="op" id="7046005">}</span><span class="op" id="7046006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7046009">}</span><span class="op" id="7046010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7046013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7046017">[</span><span class="op" id="7046018">]</span><span class="builtintype" id="7046019">byte</span><span class="op" id="7046023">{</span><span class="num" id="7046024">0x00</span><span class="op" id="7046028">,</span>&nbsp;<span class="num" id="7046030">0x00</span><span class="op" id="7046034">,</span>&nbsp;<span class="num" id="7046036">0x00</span><span class="op" id="7046040">,</span>&nbsp;<span class="num" id="7046042">0x00</span><span class="op" id="7046046">,</span>&nbsp;<span class="num" id="7046048">0x00</span><span class="op" id="7046052">,</span>&nbsp;<span class="num" id="7046054">0x00</span><span class="op" id="7046058">,</span>&nbsp;<span class="num" id="7046060">0x00</span><span class="op" id="7046064">,</span>&nbsp;<span class="num" id="7046066">0x00</span><span class="op" id="7046070">}</span><span class="op" id="7046071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7046075">[</span><span class="op" id="7046076">]</span><span class="builtintype" id="7046077">byte</span><span class="op" id="7046081">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046086">0xde</span><span class="op" id="7046090">,</span>&nbsp;<span class="num" id="7046092">0x18</span><span class="op" id="7046096">,</span>&nbsp;<span class="num" id="7046098">0x89</span><span class="op" id="7046102">,</span>&nbsp;<span class="num" id="7046104">0x41</span><span class="op" id="7046108">,</span>&nbsp;<span class="num" id="7046110">0xa3</span><span class="op" id="7046114">,</span>&nbsp;<span class="num" id="7046116">0x37</span><span class="op" id="7046120">,</span>&nbsp;<span class="num" id="7046122">0x5d</span><span class="op" id="7046126">,</span>&nbsp;<span class="num" id="7046128">0x3a</span><span class="op" id="7046132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046137">0x8a</span><span class="op" id="7046141">,</span>&nbsp;<span class="num" id="7046143">0x06</span><span class="op" id="7046147">,</span>&nbsp;<span class="num" id="7046149">0x1e</span><span class="op" id="7046153">,</span>&nbsp;<span class="num" id="7046155">0x67</span><span class="op" id="7046159">,</span>&nbsp;<span class="num" id="7046161">0x57</span><span class="op" id="7046165">,</span>&nbsp;<span class="num" id="7046167">0x6e</span><span class="op" id="7046171">,</span>&nbsp;<span class="num" id="7046173">0x92</span><span class="op" id="7046177">,</span>&nbsp;<span class="num" id="7046179">0x6d</span><span class="op" id="7046183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046188">0xc7</span><span class="op" id="7046192">,</span>&nbsp;<span class="num" id="7046194">0x1a</span><span class="op" id="7046198">,</span>&nbsp;<span class="num" id="7046200">0x7f</span><span class="op" id="7046204">,</span>&nbsp;<span class="num" id="7046206">0xa3</span><span class="op" id="7046210">,</span>&nbsp;<span class="num" id="7046212">0xf0</span><span class="op" id="7046216">,</span>&nbsp;<span class="num" id="7046218">0xcc</span><span class="op" id="7046222">,</span>&nbsp;<span class="num" id="7046224">0xeb</span><span class="op" id="7046228">,</span>&nbsp;<span class="num" id="7046230">0x97</span><span class="op" id="7046234">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046239">0x45</span><span class="op" id="7046243">,</span>&nbsp;<span class="num" id="7046245">0x2b</span><span class="op" id="7046249">,</span>&nbsp;<span class="num" id="7046251">0x4d</span><span class="op" id="7046255">,</span>&nbsp;<span class="num" id="7046257">0x32</span><span class="op" id="7046261">,</span>&nbsp;<span class="num" id="7046263">0x27</span><span class="op" id="7046267">,</span>&nbsp;<span class="num" id="7046269">0x96</span><span class="op" id="7046273">,</span>&nbsp;<span class="num" id="7046275">0x5f</span><span class="op" id="7046279">,</span>&nbsp;<span class="num" id="7046281">0x9e</span><span class="op" id="7046285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046290">0xa8</span><span class="op" id="7046294">,</span>&nbsp;<span class="num" id="7046296">0xcc</span><span class="op" id="7046300">,</span>&nbsp;<span class="num" id="7046302">0x75</span><span class="op" id="7046306">,</span>&nbsp;<span class="num" id="7046308">0x07</span><span class="op" id="7046312">,</span>&nbsp;<span class="num" id="7046314">0x6d</span><span class="op" id="7046318">,</span>&nbsp;<span class="num" id="7046320">0x9f</span><span class="op" id="7046324">,</span>&nbsp;<span class="num" id="7046326">0xb9</span><span class="op" id="7046330">,</span>&nbsp;<span class="num" id="7046332">0xc5</span><span class="op" id="7046336">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046341">0x41</span><span class="op" id="7046345">,</span>&nbsp;<span class="num" id="7046347">0x7a</span><span class="op" id="7046351">,</span>&nbsp;<span class="num" id="7046353">0xa5</span><span class="op" id="7046357">,</span>&nbsp;<span class="num" id="7046359">0xcb</span><span class="op" id="7046363">,</span>&nbsp;<span class="num" id="7046365">0x30</span><span class="op" id="7046369">,</span>&nbsp;<span class="num" id="7046371">0xfc</span><span class="op" id="7046375">,</span>&nbsp;<span class="num" id="7046377">0x22</span><span class="op" id="7046381">,</span>&nbsp;<span class="num" id="7046383">0x19</span><span class="op" id="7046387">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046392">0x8b</span><span class="op" id="7046396">,</span>&nbsp;<span class="num" id="7046398">0x34</span><span class="op" id="7046402">,</span>&nbsp;<span class="num" id="7046404">0x98</span><span class="op" id="7046408">,</span>&nbsp;<span class="num" id="7046410">0x2d</span><span class="op" id="7046414">,</span>&nbsp;<span class="num" id="7046416">0xbb</span><span class="op" id="7046420">,</span>&nbsp;<span class="num" id="7046422">0x62</span><span class="op" id="7046426">,</span>&nbsp;<span class="num" id="7046428">0x9e</span><span class="op" id="7046432">,</span>&nbsp;<span class="num" id="7046434">0xc0</span><span class="op" id="7046438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046443">0x4b</span><span class="op" id="7046447">,</span>&nbsp;<span class="num" id="7046449">0x4f</span><span class="op" id="7046453">,</span>&nbsp;<span class="num" id="7046455">0x8b</span><span class="op" id="7046459">,</span>&nbsp;<span class="num" id="7046461">0x05</span><span class="op" id="7046465">,</span>&nbsp;<span class="num" id="7046467">0xa0</span><span class="op" id="7046471">,</span>&nbsp;<span class="num" id="7046473">0x71</span><span class="op" id="7046477">,</span>&nbsp;<span class="num" id="7046479">0x08</span><span class="op" id="7046483">,</span>&nbsp;<span class="num" id="7046485">0x50</span><span class="op" id="7046489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046494">0x92</span><span class="op" id="7046498">,</span>&nbsp;<span class="num" id="7046500">0xa0</span><span class="op" id="7046504">,</span>&nbsp;<span class="num" id="7046506">0xc3</span><span class="op" id="7046510">,</span>&nbsp;<span class="num" id="7046512">0x58</span><span class="op" id="7046516">,</span>&nbsp;<span class="num" id="7046518">0x4a</span><span class="op" id="7046522">,</span>&nbsp;<span class="num" id="7046524">0x48</span><span class="op" id="7046528">,</span>&nbsp;<span class="num" id="7046530">0xe4</span><span class="op" id="7046534">,</span>&nbsp;<span class="num" id="7046536">0xa3</span><span class="op" id="7046540">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046545">0x0a</span><span class="op" id="7046549">,</span>&nbsp;<span class="num" id="7046551">0x39</span><span class="op" id="7046555">,</span>&nbsp;<span class="num" id="7046557">0x7b</span><span class="op" id="7046561">,</span>&nbsp;<span class="num" id="7046563">0x8a</span><span class="op" id="7046567">,</span>&nbsp;<span class="num" id="7046569">0xcd</span><span class="op" id="7046573">,</span>&nbsp;<span class="num" id="7046575">0x1d</span><span class="op" id="7046579">,</span>&nbsp;<span class="num" id="7046581">0x00</span><span class="op" id="7046585">,</span>&nbsp;<span class="num" id="7046587">0x9e</span><span class="op" id="7046591">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046596">0xc8</span><span class="op" id="7046600">,</span>&nbsp;<span class="num" id="7046602">0x7d</span><span class="op" id="7046606">,</span>&nbsp;<span class="num" id="7046608">0x68</span><span class="op" id="7046612">,</span>&nbsp;<span class="num" id="7046614">0x11</span><span class="op" id="7046618">,</span>&nbsp;<span class="num" id="7046620">0xf2</span><span class="op" id="7046624">,</span>&nbsp;<span class="num" id="7046626">0x2c</span><span class="op" id="7046630">,</span>&nbsp;<span class="num" id="7046632">0xf4</span><span class="op" id="7046636">,</span>&nbsp;<span class="num" id="7046638">0x9c</span><span class="op" id="7046642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046647">0xa3</span><span class="op" id="7046651">,</span>&nbsp;<span class="num" id="7046653">0xe5</span><span class="op" id="7046657">,</span>&nbsp;<span class="num" id="7046659">0x93</span><span class="op" id="7046663">,</span>&nbsp;<span class="num" id="7046665">0x54</span><span class="op" id="7046669">,</span>&nbsp;<span class="num" id="7046671">0xb9</span><span class="op" id="7046675">,</span>&nbsp;<span class="num" id="7046677">0x45</span><span class="op" id="7046681">,</span>&nbsp;<span class="num" id="7046683">0x15</span><span class="op" id="7046687">,</span>&nbsp;<span class="num" id="7046689">0x35</span><span class="op" id="7046693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046698">0xa2</span><span class="op" id="7046702">,</span>&nbsp;<span class="num" id="7046704">0x18</span><span class="op" id="7046708">,</span>&nbsp;<span class="num" id="7046710">0x7a</span><span class="op" id="7046714">,</span>&nbsp;<span class="num" id="7046716">0x86</span><span class="op" id="7046720">,</span>&nbsp;<span class="num" id="7046722">0x42</span><span class="op" id="7046726">,</span>&nbsp;<span class="num" id="7046728">0x6c</span><span class="op" id="7046732">,</span>&nbsp;<span class="num" id="7046734">0xca</span><span class="op" id="7046738">,</span>&nbsp;<span class="num" id="7046740">0x7d</span><span class="op" id="7046744">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046749">0x5e</span><span class="op" id="7046753">,</span>&nbsp;<span class="num" id="7046755">0x82</span><span class="op" id="7046759">,</span>&nbsp;<span class="num" id="7046761">0x3e</span><span class="op" id="7046765">,</span>&nbsp;<span class="num" id="7046767">0xba</span><span class="op" id="7046771">,</span>&nbsp;<span class="num" id="7046773">0x00</span><span class="op" id="7046777">,</span>&nbsp;<span class="num" id="7046779">0x44</span><span class="op" id="7046783">,</span>&nbsp;<span class="num" id="7046785">0x12</span><span class="op" id="7046789">,</span>&nbsp;<span class="num" id="7046791">0x67</span><span class="op" id="7046795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046800">0x12</span><span class="op" id="7046804">,</span>&nbsp;<span class="num" id="7046806">0x57</span><span class="op" id="7046810">,</span>&nbsp;<span class="num" id="7046812">0xb8</span><span class="op" id="7046816">,</span>&nbsp;<span class="num" id="7046818">0xd8</span><span class="op" id="7046822">,</span>&nbsp;<span class="num" id="7046824">0x60</span><span class="op" id="7046828">,</span>&nbsp;<span class="num" id="7046830">0xae</span><span class="op" id="7046834">,</span>&nbsp;<span class="num" id="7046836">0x4c</span><span class="op" id="7046840">,</span>&nbsp;<span class="num" id="7046842">0xbd</span><span class="op" id="7046846">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046851">0x4c</span><span class="op" id="7046855">,</span>&nbsp;<span class="num" id="7046857">0x49</span><span class="op" id="7046861">,</span>&nbsp;<span class="num" id="7046863">0x06</span><span class="op" id="7046867">,</span>&nbsp;<span class="num" id="7046869">0xbb</span><span class="op" id="7046873">,</span>&nbsp;<span class="num" id="7046875">0xc5</span><span class="op" id="7046879">,</span>&nbsp;<span class="num" id="7046881">0x35</span><span class="op" id="7046885">,</span>&nbsp;<span class="num" id="7046887">0xef</span><span class="op" id="7046891">,</span>&nbsp;<span class="num" id="7046893">0xe1</span><span class="op" id="7046897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046902">0x58</span><span class="op" id="7046906">,</span>&nbsp;<span class="num" id="7046908">0x7f</span><span class="op" id="7046912">,</span>&nbsp;<span class="num" id="7046914">0x08</span><span class="op" id="7046918">,</span>&nbsp;<span class="num" id="7046920">0xdb</span><span class="op" id="7046924">,</span>&nbsp;<span class="num" id="7046926">0x33</span><span class="op" id="7046930">,</span>&nbsp;<span class="num" id="7046932">0x95</span><span class="op" id="7046936">,</span>&nbsp;<span class="num" id="7046938">0x5c</span><span class="op" id="7046942">,</span>&nbsp;<span class="num" id="7046944">0xdb</span><span class="op" id="7046948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7046953">0xcb</span><span class="op" id="7046957">,</span>&nbsp;<span class="num" id="7046959">0xad</span><span class="op" id="7046963">,</span>&nbsp;<span class="num" id="7046965">0x9b</span><span class="op" id="7046969">,</span>&nbsp;<span class="num" id="7046971">0x10</span><span class="op" id="7046975">,</span>&nbsp;<span class="num" id="7046977">0xf5</span><span class="op" id="7046981">,</span>&nbsp;<span class="num" id="7046983">0x3f</span><span class="op" id="7046987">,</span>&nbsp;<span class="num" id="7046989">0xc4</span><span class="op" id="7046993">,</span>&nbsp;<span class="num" id="7046995">0xe5</span><span class="op" id="7046999">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047004">0x2c</span><span class="op" id="7047008">,</span>&nbsp;<span class="num" id="7047010">0x59</span><span class="op" id="7047014">,</span>&nbsp;<span class="num" id="7047016">0x15</span><span class="op" id="7047020">,</span>&nbsp;<span class="num" id="7047022">0x65</span><span class="op" id="7047026">,</span>&nbsp;<span class="num" id="7047028">0x51</span><span class="op" id="7047032">,</span>&nbsp;<span class="num" id="7047034">0x84</span><span class="op" id="7047038">,</span>&nbsp;<span class="num" id="7047040">0x87</span><span class="op" id="7047044">,</span>&nbsp;<span class="num" id="7047046">0xfe</span><span class="op" id="7047050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047055">0x08</span><span class="op" id="7047059">,</span>&nbsp;<span class="num" id="7047061">0x4d</span><span class="op" id="7047065">,</span>&nbsp;<span class="num" id="7047067">0x0e</span><span class="op" id="7047071">,</span>&nbsp;<span class="num" id="7047073">0x3f</span><span class="op" id="7047077">,</span>&nbsp;<span class="num" id="7047079">0x03</span><span class="op" id="7047083">,</span>&nbsp;<span class="num" id="7047085">0xde</span><span class="op" id="7047089">,</span>&nbsp;<span class="num" id="7047091">0xbc</span><span class="op" id="7047095">,</span>&nbsp;<span class="num" id="7047097">0xc9</span><span class="op" id="7047101">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047106">0xda</span><span class="op" id="7047110">,</span>&nbsp;<span class="num" id="7047112">0x1c</span><span class="op" id="7047116">,</span>&nbsp;<span class="num" id="7047118">0xe9</span><span class="op" id="7047122">,</span>&nbsp;<span class="num" id="7047124">0x0d</span><span class="op" id="7047128">,</span>&nbsp;<span class="num" id="7047130">0x08</span><span class="op" id="7047134">,</span>&nbsp;<span class="num" id="7047136">0x5c</span><span class="op" id="7047140">,</span>&nbsp;<span class="num" id="7047142">0x2d</span><span class="op" id="7047146">,</span>&nbsp;<span class="num" id="7047148">0x8a</span><span class="op" id="7047152">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047157">0x19</span><span class="op" id="7047161">,</span>&nbsp;<span class="num" id="7047163">0xd8</span><span class="op" id="7047167">,</span>&nbsp;<span class="num" id="7047169">0x37</span><span class="op" id="7047173">,</span>&nbsp;<span class="num" id="7047175">0x30</span><span class="op" id="7047179">,</span>&nbsp;<span class="num" id="7047181">0x86</span><span class="op" id="7047185">,</span>&nbsp;<span class="num" id="7047187">0x16</span><span class="op" id="7047191">,</span>&nbsp;<span class="num" id="7047193">0x36</span><span class="op" id="7047197">,</span>&nbsp;<span class="num" id="7047199">0x92</span><span class="op" id="7047203">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047208">0x14</span><span class="op" id="7047212">,</span>&nbsp;<span class="num" id="7047214">0x2b</span><span class="op" id="7047218">,</span>&nbsp;<span class="num" id="7047220">0xd8</span><span class="op" id="7047224">,</span>&nbsp;<span class="num" id="7047226">0xfc</span><span class="op" id="7047230">,</span>&nbsp;<span class="num" id="7047232">0x5d</span><span class="op" id="7047236">,</span>&nbsp;<span class="num" id="7047238">0x7a</span><span class="op" id="7047242">,</span>&nbsp;<span class="num" id="7047244">0x73</span><span class="op" id="7047248">,</span>&nbsp;<span class="num" id="7047250">0x49</span><span class="op" id="7047254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047259">0x6a</span><span class="op" id="7047263">,</span>&nbsp;<span class="num" id="7047265">0x8e</span><span class="op" id="7047269">,</span>&nbsp;<span class="num" id="7047271">0x59</span><span class="op" id="7047275">,</span>&nbsp;<span class="num" id="7047277">0xee</span><span class="op" id="7047281">,</span>&nbsp;<span class="num" id="7047283">0x7e</span><span class="op" id="7047287">,</span>&nbsp;<span class="num" id="7047289">0xcf</span><span class="op" id="7047293">,</span>&nbsp;<span class="num" id="7047295">0x6b</span><span class="op" id="7047299">,</span>&nbsp;<span class="num" id="7047301">0x94</span><span class="op" id="7047305">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047310">0x06</span><span class="op" id="7047314">,</span>&nbsp;<span class="num" id="7047316">0x63</span><span class="op" id="7047320">,</span>&nbsp;<span class="num" id="7047322">0xf4</span><span class="op" id="7047326">,</span>&nbsp;<span class="num" id="7047328">0xa6</span><span class="op" id="7047332">,</span>&nbsp;<span class="num" id="7047334">0xbe</span><span class="op" id="7047338">,</span>&nbsp;<span class="num" id="7047340">0xe6</span><span class="op" id="7047344">,</span>&nbsp;<span class="num" id="7047346">0x5b</span><span class="op" id="7047350">,</span>&nbsp;<span class="num" id="7047352">0xd2</span><span class="op" id="7047356">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047361">0xc8</span><span class="op" id="7047365">,</span>&nbsp;<span class="num" id="7047367">0x5c</span><span class="op" id="7047371">,</span>&nbsp;<span class="num" id="7047373">0x46</span><span class="op" id="7047377">,</span>&nbsp;<span class="num" id="7047379">0x98</span><span class="op" id="7047383">,</span>&nbsp;<span class="num" id="7047385">0x6c</span><span class="op" id="7047389">,</span>&nbsp;<span class="num" id="7047391">0x1b</span><span class="op" id="7047395">,</span>&nbsp;<span class="num" id="7047397">0xef</span><span class="op" id="7047401">,</span>&nbsp;<span class="num" id="7047403">0x34</span><span class="op" id="7047407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047412">0x90</span><span class="op" id="7047416">,</span>&nbsp;<span class="num" id="7047418">0xd3</span><span class="op" id="7047422">,</span>&nbsp;<span class="num" id="7047424">0x7b</span><span class="op" id="7047428">,</span>&nbsp;<span class="num" id="7047430">0x38</span><span class="op" id="7047434">,</span>&nbsp;<span class="num" id="7047436">0xda</span><span class="op" id="7047440">,</span>&nbsp;<span class="num" id="7047442">0x85</span><span class="op" id="7047446">,</span>&nbsp;<span class="num" id="7047448">0xd3</span><span class="op" id="7047452">,</span>&nbsp;<span class="num" id="7047454">0x2e</span><span class="op" id="7047458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="7047463">0x97</span><span class="op" id="7047467">,</span>&nbsp;<span class="num" id="7047469">0x39</span><span class="op" id="7047473">,</span>&nbsp;<span class="num" id="7047475">0xcb</span><span class="op" id="7047479">,</span>&nbsp;<span class="num" id="7047481">0x23</span><span class="op" id="7047485">,</span>&nbsp;<span class="num" id="7047487">0x4a</span><span class="op" id="7047491">,</span>&nbsp;<span class="num" id="7047493">0x2b</span><span class="op" id="7047497">,</span>&nbsp;<span class="num" id="7047499">0xe7</span><span class="op" id="7047503">,</span>&nbsp;<span class="num" id="7047505">0x40</span><span class="op" id="7047509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7047513">}</span><span class="op" id="7047514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7047517">}</span><span class="op" id="7047518">,</span><br>
<span class="lineno">75</span><span class="op" id="7047520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7047523">func</span>&nbsp;<span class="ident" id="7047528">testEncrypt</span><span class="op" id="7047539">(</span><span class="ident" id="7047540">t</span>&nbsp;<span class="op" id="7047542">*</span><span class="ident" id="7047543">testing</span><span class="op" id="7047550">.</span><span class="ident" id="7047551">T</span><span class="op" id="7047552">,</span>&nbsp;<span class="ident" id="7047554">desc</span>&nbsp;<span class="builtintype" id="7047559">string</span><span class="op" id="7047565">,</span>&nbsp;<span class="ident" id="7047567">c</span>&nbsp;<span class="op" id="7047569">*</span><span class="ident" id="7047570">Cipher</span><span class="op" id="7047576">,</span>&nbsp;<span class="ident" id="7047578">src</span><span class="op" id="7047581">,</span>&nbsp;<span class="ident" id="7047583">expect</span>&nbsp;<span class="op" id="7047590">[</span><span class="op" id="7047591">]</span><span class="builtintype" id="7047592">byte</span><span class="op" id="7047596">)</span>&nbsp;<span class="op" id="7047598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047601">dst</span>&nbsp;<span class="op" id="7047605">:=</span>&nbsp;<span class="builtinfunc" id="7047608">make</span><span class="op" id="7047612">(</span><span class="op" id="7047613">[</span><span class="op" id="7047614">]</span><span class="builtintype" id="7047615">byte</span><span class="op" id="7047619">,</span>&nbsp;<span class="builtinfunc" id="7047621">len</span><span class="op" id="7047624">(</span><span class="ident" id="7047625">src</span><span class="op" id="7047628">)</span><span class="op" id="7047629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047632">c</span><span class="op" id="7047633">.</span><span class="ident" id="7047634">XORKeyStream</span><span class="op" id="7047646">(</span><span class="ident" id="7047647">dst</span><span class="op" id="7047650">,</span>&nbsp;<span class="ident" id="7047652">src</span><span class="op" id="7047655">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7047658">for</span>&nbsp;<span class="ident" id="7047662">i</span><span class="op" id="7047663">,</span>&nbsp;<span class="ident" id="7047665">v</span>&nbsp;<span class="op" id="7047667">:=</span>&nbsp;<span class="keyword" id="7047670">range</span>&nbsp;<span class="ident" id="7047676">dst</span>&nbsp;<span class="op" id="7047680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7047684">if</span>&nbsp;<span class="ident" id="7047687">v</span>&nbsp;<span class="op" id="7047689">!=</span>&nbsp;<span class="ident" id="7047692">expect</span><span class="op" id="7047698">[</span><span class="ident" id="7047699">i</span><span class="op" id="7047700">]</span>&nbsp;<span class="op" id="7047702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047707">t</span><span class="op" id="7047708">.</span><span class="ident" id="7047709">Fatalf</span><span class="op" id="7047715">(</span><span class="string" id="7047716">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7047760">,</span>&nbsp;<span class="ident" id="7047762">desc</span><span class="op" id="7047766">,</span>&nbsp;<span class="ident" id="7047768">i</span><span class="op" id="7047769">,</span>&nbsp;<span class="ident" id="7047771">dst</span><span class="op" id="7047774">,</span>&nbsp;<span class="ident" id="7047776">expect</span><span class="op" id="7047782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7047786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7047789">}</span><br>
<span class="lineno">85</span><span class="op" id="7047791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7047794">func</span>&nbsp;<span class="ident" id="7047799">TestGolden</span><span class="op" id="7047809">(</span><span class="ident" id="7047810">t</span>&nbsp;<span class="op" id="7047812">*</span><span class="ident" id="7047813">testing</span><span class="op" id="7047820">.</span><span class="ident" id="7047821">T</span><span class="op" id="7047822">)</span>&nbsp;<span class="op" id="7047824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7047827">for</span>&nbsp;<span class="ident" id="7047831">gi</span><span class="op" id="7047833">,</span>&nbsp;<span class="ident" id="7047835">g</span>&nbsp;<span class="op" id="7047837">:=</span>&nbsp;<span class="keyword" id="7047840">range</span>&nbsp;<span class="ident" id="7047846">golden</span>&nbsp;<span class="op" id="7047853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047857">data</span>&nbsp;<span class="op" id="7047862">:=</span>&nbsp;<span class="builtinfunc" id="7047865">make</span><span class="op" id="7047869">(</span><span class="op" id="7047870">[</span><span class="op" id="7047871">]</span><span class="builtintype" id="7047872">byte</span><span class="op" id="7047876">,</span>&nbsp;<span class="builtinfunc" id="7047878">len</span><span class="op" id="7047881">(</span><span class="ident" id="7047882">g</span><span class="op" id="7047883">.</span><span class="ident" id="7047884">keystream</span><span class="op" id="7047893">)</span><span class="op" id="7047894">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7047898">for</span>&nbsp;<span class="ident" id="7047902">i</span>&nbsp;<span class="op" id="7047904">:=</span>&nbsp;<span class="keyword" id="7047907">range</span>&nbsp;<span class="ident" id="7047913">data</span>&nbsp;<span class="op" id="7047918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047923">data</span><span class="op" id="7047927">[</span><span class="ident" id="7047928">i</span><span class="op" id="7047929">]</span>&nbsp;<span class="op" id="7047931">=</span>&nbsp;<span class="builtintype" id="7047933">byte</span><span class="op" id="7047937">(</span><span class="ident" id="7047938">i</span><span class="op" id="7047939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7047943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7047948">expect</span>&nbsp;<span class="op" id="7047955">:=</span>&nbsp;<span class="builtinfunc" id="7047958">make</span><span class="op" id="7047962">(</span><span class="op" id="7047963">[</span><span class="op" id="7047964">]</span><span class="builtintype" id="7047965">byte</span><span class="op" id="7047969">,</span>&nbsp;<span class="builtinfunc" id="7047971">len</span><span class="op" id="7047974">(</span><span class="ident" id="7047975">g</span><span class="op" id="7047976">.</span><span class="ident" id="7047977">keystream</span><span class="op" id="7047986">)</span><span class="op" id="7047987">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7047991">for</span>&nbsp;<span class="ident" id="7047995">i</span>&nbsp;<span class="op" id="7047997">:=</span>&nbsp;<span class="keyword" id="7048000">range</span>&nbsp;<span class="ident" id="7048006">expect</span>&nbsp;<span class="op" id="7048013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048018">expect</span><span class="op" id="7048024">[</span><span class="ident" id="7048025">i</span><span class="op" id="7048026">]</span>&nbsp;<span class="op" id="7048028">=</span>&nbsp;<span class="builtintype" id="7048030">byte</span><span class="op" id="7048034">(</span><span class="ident" id="7048035">i</span><span class="op" id="7048036">)</span>&nbsp;<span class="op" id="7048038">^</span>&nbsp;<span class="ident" id="7048040">g</span><span class="op" id="7048041">.</span><span class="ident" id="7048042">keystream</span><span class="op" id="7048051">[</span><span class="ident" id="7048052">i</span><span class="op" id="7048053">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7048062">for</span>&nbsp;<span class="ident" id="7048066">size</span>&nbsp;<span class="op" id="7048071">:=</span>&nbsp;<span class="num" id="7048074">1</span><span class="op" id="7048075">;</span>&nbsp;<span class="ident" id="7048077">size</span>&nbsp;<span class="op" id="7048082">&lt;=</span>&nbsp;<span class="builtinfunc" id="7048085">len</span><span class="op" id="7048088">(</span><span class="ident" id="7048089">g</span><span class="op" id="7048090">.</span><span class="ident" id="7048091">keystream</span><span class="op" id="7048100">)</span><span class="op" id="7048101">;</span>&nbsp;<span class="ident" id="7048103">size</span><span class="op" id="7048107">++</span>&nbsp;<span class="op" id="7048110">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048115">c</span><span class="op" id="7048116">,</span>&nbsp;<span class="ident" id="7048118">err</span>&nbsp;<span class="op" id="7048122">:=</span>&nbsp;<span class="ident" id="7048125">NewCipher</span><span class="op" id="7048134">(</span><span class="ident" id="7048135">g</span><span class="op" id="7048136">.</span><span class="ident" id="7048137">key</span><span class="op" id="7048140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7048145">if</span>&nbsp;<span class="ident" id="7048148">err</span>&nbsp;<span class="op" id="7048152">!=</span>&nbsp;<span class="builtintype" id="7048155">nil</span>&nbsp;<span class="op" id="7048159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048165">t</span><span class="op" id="7048166">.</span><span class="ident" id="7048167">Fatalf</span><span class="op" id="7048173">(</span><span class="string" id="7048174">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7048194">,</span>&nbsp;<span class="ident" id="7048196">gi</span><span class="op" id="7048198">,</span>&nbsp;<span class="ident" id="7048200">err</span><span class="op" id="7048203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048214">off</span>&nbsp;<span class="op" id="7048218">:=</span>&nbsp;<span class="num" id="7048221">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7048226">for</span>&nbsp;<span class="ident" id="7048230">off</span>&nbsp;<span class="op" id="7048234">&lt;</span>&nbsp;<span class="builtinfunc" id="7048236">len</span><span class="op" id="7048239">(</span><span class="ident" id="7048240">g</span><span class="op" id="7048241">.</span><span class="ident" id="7048242">keystream</span><span class="op" id="7048251">)</span>&nbsp;<span class="op" id="7048253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048259">n</span>&nbsp;<span class="op" id="7048261">:=</span>&nbsp;<span class="builtinfunc" id="7048264">len</span><span class="op" id="7048267">(</span><span class="ident" id="7048268">g</span><span class="op" id="7048269">.</span><span class="ident" id="7048270">keystream</span><span class="op" id="7048279">)</span>&nbsp;<span class="op" id="7048281">-</span>&nbsp;<span class="ident" id="7048283">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7048291">if</span>&nbsp;<span class="ident" id="7048294">n</span>&nbsp;<span class="op" id="7048296">&gt;</span>&nbsp;<span class="ident" id="7048298">size</span>&nbsp;<span class="op" id="7048303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048310">n</span>&nbsp;<span class="op" id="7048312">=</span>&nbsp;<span class="ident" id="7048314">size</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048329">desc</span>&nbsp;<span class="op" id="7048334">:=</span>&nbsp;<span class="ident" id="7048337">fmt</span><span class="op" id="7048340">.</span><span class="ident" id="7048341">Sprintf</span><span class="op" id="7048348">(</span><span class="string" id="7048349">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7048362">,</span>&nbsp;<span class="ident" id="7048364">gi</span><span class="op" id="7048366">,</span>&nbsp;<span class="ident" id="7048368">off</span><span class="op" id="7048371">,</span>&nbsp;<span class="ident" id="7048373">off</span><span class="op" id="7048376">+</span><span class="ident" id="7048377">n</span><span class="op" id="7048378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048384">testEncrypt</span><span class="op" id="7048395">(</span><span class="ident" id="7048396">t</span><span class="op" id="7048397">,</span>&nbsp;<span class="ident" id="7048399">desc</span><span class="op" id="7048403">,</span>&nbsp;<span class="ident" id="7048405">c</span><span class="op" id="7048406">,</span>&nbsp;<span class="ident" id="7048408">data</span><span class="op" id="7048412">[</span><span class="ident" id="7048413">off</span><span class="op" id="7048416">:</span><span class="ident" id="7048417">off</span><span class="op" id="7048420">+</span><span class="ident" id="7048421">n</span><span class="op" id="7048422">]</span><span class="op" id="7048423">,</span>&nbsp;<span class="ident" id="7048425">expect</span><span class="op" id="7048431">[</span><span class="ident" id="7048432">off</span><span class="op" id="7048435">:</span><span class="ident" id="7048436">off</span><span class="op" id="7048439">+</span><span class="ident" id="7048440">n</span><span class="op" id="7048441">]</span><span class="op" id="7048442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048448">off</span>&nbsp;<span class="op" id="7048452">+=</span>&nbsp;<span class="ident" id="7048455">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048460">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048464">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7048467">}</span><br>
<span class="lineno"></span><span class="op" id="7048469">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7048472">func</span>&nbsp;<span class="ident" id="7048477">TestBlock</span><span class="op" id="7048486">(</span><span class="ident" id="7048487">t</span>&nbsp;<span class="op" id="7048489">*</span><span class="ident" id="7048490">testing</span><span class="op" id="7048497">.</span><span class="ident" id="7048498">T</span><span class="op" id="7048499">)</span>&nbsp;<span class="op" id="7048501">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048504">testBlock</span><span class="op" id="7048513">(</span><span class="ident" id="7048514">t</span><span class="op" id="7048515">,</span>&nbsp;<span class="op" id="7048517">(</span><span class="op" id="7048518">*</span><span class="ident" id="7048519">Cipher</span><span class="op" id="7048525">)</span><span class="op" id="7048526">.</span><span class="ident" id="7048527">XORKeyStream</span><span class="op" id="7048539">)</span><br>
<span class="lineno"></span><span class="op" id="7048541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7048544">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7048573">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7048640">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7048684">func</span>&nbsp;<span class="ident" id="7048689">TestBlockGeneric</span><span class="op" id="7048705">(</span><span class="ident" id="7048706">t</span>&nbsp;<span class="op" id="7048708">*</span><span class="ident" id="7048709">testing</span><span class="op" id="7048716">.</span><span class="ident" id="7048717">T</span><span class="op" id="7048718">)</span>&nbsp;<span class="op" id="7048720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048723">testBlock</span><span class="op" id="7048732">(</span><span class="ident" id="7048733">t</span><span class="op" id="7048734">,</span>&nbsp;<span class="op" id="7048736">(</span><span class="op" id="7048737">*</span><span class="ident" id="7048738">Cipher</span><span class="op" id="7048744">)</span><span class="op" id="7048745">.</span><span class="ident" id="7048746">xorKeyStreamGeneric</span><span class="op" id="7048765">)</span><br>
<span class="lineno"></span><span class="op" id="7048767">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7048770">func</span>&nbsp;<span class="ident" id="7048775">testBlock</span><span class="op" id="7048784">(</span><span class="ident" id="7048785">t</span>&nbsp;<span class="op" id="7048787">*</span><span class="ident" id="7048788">testing</span><span class="op" id="7048795">.</span><span class="ident" id="7048796">T</span><span class="op" id="7048797">,</span>&nbsp;<span class="ident" id="7048799">xor</span>&nbsp;<span class="keyword" id="7048803">func</span><span class="op" id="7048807">(</span><span class="ident" id="7048808">c</span>&nbsp;<span class="op" id="7048810">*</span><span class="ident" id="7048811">Cipher</span><span class="op" id="7048817">,</span>&nbsp;<span class="ident" id="7048819">dst</span><span class="op" id="7048822">,</span>&nbsp;<span class="ident" id="7048824">src</span>&nbsp;<span class="op" id="7048828">[</span><span class="op" id="7048829">]</span><span class="builtintype" id="7048830">byte</span><span class="op" id="7048834">)</span><span class="op" id="7048835">)</span>&nbsp;<span class="op" id="7048837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048840">c1a</span><span class="op" id="7048843">,</span>&nbsp;<span class="ident" id="7048845">_</span>&nbsp;<span class="op" id="7048847">:=</span>&nbsp;<span class="ident" id="7048850">NewCipher</span><span class="op" id="7048859">(</span><span class="ident" id="7048860">golden</span><span class="op" id="7048866">[</span><span class="num" id="7048867">0</span><span class="op" id="7048868">]</span><span class="op" id="7048869">.</span><span class="ident" id="7048870">key</span><span class="op" id="7048873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048876">c1b</span><span class="op" id="7048879">,</span>&nbsp;<span class="ident" id="7048881">_</span>&nbsp;<span class="op" id="7048883">:=</span>&nbsp;<span class="ident" id="7048886">NewCipher</span><span class="op" id="7048895">(</span><span class="ident" id="7048896">golden</span><span class="op" id="7048902">[</span><span class="num" id="7048903">1</span><span class="op" id="7048904">]</span><span class="op" id="7048905">.</span><span class="ident" id="7048906">key</span><span class="op" id="7048909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048912">data1</span>&nbsp;<span class="op" id="7048918">:=</span>&nbsp;<span class="builtinfunc" id="7048921">make</span><span class="op" id="7048925">(</span><span class="op" id="7048926">[</span><span class="op" id="7048927">]</span><span class="builtintype" id="7048928">byte</span><span class="op" id="7048932">,</span>&nbsp;<span class="num" id="7048934">1</span><span class="op" id="7048935">&lt;&lt;</span><span class="num" id="7048937">20</span><span class="op" id="7048939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7048942">for</span>&nbsp;<span class="ident" id="7048946">i</span>&nbsp;<span class="op" id="7048948">:=</span>&nbsp;<span class="keyword" id="7048951">range</span>&nbsp;<span class="ident" id="7048957">data1</span>&nbsp;<span class="op" id="7048963">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7048967">xor</span><span class="op" id="7048970">(</span><span class="ident" id="7048971">c1a</span><span class="op" id="7048974">,</span>&nbsp;<span class="ident" id="7048976">data1</span><span class="op" id="7048981">[</span><span class="ident" id="7048982">i</span><span class="op" id="7048983">:</span><span class="ident" id="7048984">i</span><span class="op" id="7048985">+</span><span class="num" id="7048986">1</span><span class="op" id="7048987">]</span><span class="op" id="7048988">,</span>&nbsp;<span class="ident" id="7048990">data1</span><span class="op" id="7048995">[</span><span class="ident" id="7048996">i</span><span class="op" id="7048997">:</span><span class="ident" id="7048998">i</span><span class="op" id="7048999">+</span><span class="num" id="7049000">1</span><span class="op" id="7049001">]</span><span class="op" id="7049002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049006">xor</span><span class="op" id="7049009">(</span><span class="ident" id="7049010">c1b</span><span class="op" id="7049013">,</span>&nbsp;<span class="ident" id="7049015">data1</span><span class="op" id="7049020">[</span><span class="ident" id="7049021">i</span><span class="op" id="7049022">:</span><span class="ident" id="7049023">i</span><span class="op" id="7049024">+</span><span class="num" id="7049025">1</span><span class="op" id="7049026">]</span><span class="op" id="7049027">,</span>&nbsp;<span class="ident" id="7049029">data1</span><span class="op" id="7049034">[</span><span class="ident" id="7049035">i</span><span class="op" id="7049036">:</span><span class="ident" id="7049037">i</span><span class="op" id="7049038">+</span><span class="num" id="7049039">1</span><span class="op" id="7049040">]</span><span class="op" id="7049041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7049044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049048">c2a</span><span class="op" id="7049051">,</span>&nbsp;<span class="ident" id="7049053">_</span>&nbsp;<span class="op" id="7049055">:=</span>&nbsp;<span class="ident" id="7049058">NewCipher</span><span class="op" id="7049067">(</span><span class="ident" id="7049068">golden</span><span class="op" id="7049074">[</span><span class="num" id="7049075">0</span><span class="op" id="7049076">]</span><span class="op" id="7049077">.</span><span class="ident" id="7049078">key</span><span class="op" id="7049081">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049084">c2b</span><span class="op" id="7049087">,</span>&nbsp;<span class="ident" id="7049089">_</span>&nbsp;<span class="op" id="7049091">:=</span>&nbsp;<span class="ident" id="7049094">NewCipher</span><span class="op" id="7049103">(</span><span class="ident" id="7049104">golden</span><span class="op" id="7049110">[</span><span class="num" id="7049111">1</span><span class="op" id="7049112">]</span><span class="op" id="7049113">.</span><span class="ident" id="7049114">key</span><span class="op" id="7049117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049120">data2</span>&nbsp;<span class="op" id="7049126">:=</span>&nbsp;<span class="builtinfunc" id="7049129">make</span><span class="op" id="7049133">(</span><span class="op" id="7049134">[</span><span class="op" id="7049135">]</span><span class="builtintype" id="7049136">byte</span><span class="op" id="7049140">,</span>&nbsp;<span class="num" id="7049142">1</span><span class="op" id="7049143">&lt;&lt;</span><span class="num" id="7049145">20</span><span class="op" id="7049147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049150">xor</span><span class="op" id="7049153">(</span><span class="ident" id="7049154">c2a</span><span class="op" id="7049157">,</span>&nbsp;<span class="ident" id="7049159">data2</span><span class="op" id="7049164">,</span>&nbsp;<span class="ident" id="7049166">data2</span><span class="op" id="7049171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049174">xor</span><span class="op" id="7049177">(</span><span class="ident" id="7049178">c2b</span><span class="op" id="7049181">,</span>&nbsp;<span class="ident" id="7049183">data2</span><span class="op" id="7049188">,</span>&nbsp;<span class="ident" id="7049190">data2</span><span class="op" id="7049195">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049199">if</span>&nbsp;<span class="op" id="7049202">!</span><span class="ident" id="7049203">bytes</span><span class="op" id="7049208">.</span><span class="ident" id="7049209">Equal</span><span class="op" id="7049214">(</span><span class="ident" id="7049215">data1</span><span class="op" id="7049220">,</span>&nbsp;<span class="ident" id="7049222">data2</span><span class="op" id="7049227">)</span>&nbsp;<span class="op" id="7049229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049233">t</span><span class="op" id="7049234">.</span><span class="ident" id="7049235">Fatalf</span><span class="op" id="7049241">(</span><span class="string" id="7049242">&#34;bad&nbsp;block&#34;</span><span class="op" id="7049253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7049256">}</span><br>
<span class="lineno"></span><span class="op" id="7049258">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7049261">func</span>&nbsp;<span class="ident" id="7049266">benchmark</span><span class="op" id="7049275">(</span><span class="ident" id="7049276">b</span>&nbsp;<span class="op" id="7049278">*</span><span class="ident" id="7049279">testing</span><span class="op" id="7049286">.</span><span class="ident" id="7049287">B</span><span class="op" id="7049288">,</span>&nbsp;<span class="ident" id="7049290">size</span>&nbsp;<span class="ident" id="7049295">int64</span><span class="op" id="7049300">)</span>&nbsp;<span class="op" id="7049302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049305">buf</span>&nbsp;<span class="op" id="7049309">:=</span>&nbsp;<span class="builtinfunc" id="7049312">make</span><span class="op" id="7049316">(</span><span class="op" id="7049317">[</span><span class="op" id="7049318">]</span><span class="builtintype" id="7049319">byte</span><span class="op" id="7049323">,</span>&nbsp;<span class="ident" id="7049325">size</span><span class="op" id="7049329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049332">c</span><span class="op" id="7049333">,</span>&nbsp;<span class="ident" id="7049335">err</span>&nbsp;<span class="op" id="7049339">:=</span>&nbsp;<span class="ident" id="7049342">NewCipher</span><span class="op" id="7049351">(</span><span class="ident" id="7049352">golden</span><span class="op" id="7049358">[</span><span class="num" id="7049359">0</span><span class="op" id="7049360">]</span><span class="op" id="7049361">.</span><span class="ident" id="7049362">key</span><span class="op" id="7049365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049368">if</span>&nbsp;<span class="ident" id="7049371">err</span>&nbsp;<span class="op" id="7049375">!=</span>&nbsp;<span class="builtintype" id="7049378">nil</span>&nbsp;<span class="op" id="7049382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7049386">panic</span><span class="op" id="7049391">(</span><span class="ident" id="7049392">err</span><span class="op" id="7049395">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7049398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049401">b</span><span class="op" id="7049402">.</span><span class="ident" id="7049403">SetBytes</span><span class="op" id="7049411">(</span><span class="ident" id="7049412">size</span><span class="op" id="7049416">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7049420">for</span>&nbsp;<span class="ident" id="7049424">i</span>&nbsp;<span class="op" id="7049426">:=</span>&nbsp;<span class="num" id="7049429">0</span><span class="op" id="7049430">;</span>&nbsp;<span class="ident" id="7049432">i</span>&nbsp;<span class="op" id="7049434">&lt;</span>&nbsp;<span class="ident" id="7049436">b</span><span class="op" id="7049437">.</span><span class="ident" id="7049438">N</span><span class="op" id="7049439">;</span>&nbsp;<span class="ident" id="7049441">i</span><span class="op" id="7049442">++</span>&nbsp;<span class="op" id="7049445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049449">c</span><span class="op" id="7049450">.</span><span class="ident" id="7049451">XORKeyStream</span><span class="op" id="7049463">(</span><span class="ident" id="7049464">buf</span><span class="op" id="7049467">,</span>&nbsp;<span class="ident" id="7049469">buf</span><span class="op" id="7049472">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7049475">}</span><br>
<span class="lineno"></span><span class="op" id="7049477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049480">func</span>&nbsp;<span class="ident" id="7049485">BenchmarkRC4_128</span><span class="op" id="7049501">(</span><span class="ident" id="7049502">b</span>&nbsp;<span class="op" id="7049504">*</span><span class="ident" id="7049505">testing</span><span class="op" id="7049512">.</span><span class="ident" id="7049513">B</span><span class="op" id="7049514">)</span>&nbsp;<span class="op" id="7049516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049519">benchmark</span><span class="op" id="7049528">(</span><span class="ident" id="7049529">b</span><span class="op" id="7049530">,</span>&nbsp;<span class="num" id="7049532">128</span><span class="op" id="7049535">)</span><br>
<span class="lineno">165</span><span class="op" id="7049537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7049540">func</span>&nbsp;<span class="ident" id="7049545">BenchmarkRC4_1K</span><span class="op" id="7049560">(</span><span class="ident" id="7049561">b</span>&nbsp;<span class="op" id="7049563">*</span><span class="ident" id="7049564">testing</span><span class="op" id="7049571">.</span><span class="ident" id="7049572">B</span><span class="op" id="7049573">)</span>&nbsp;<span class="op" id="7049575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049578">benchmark</span><span class="op" id="7049587">(</span><span class="ident" id="7049588">b</span><span class="op" id="7049589">,</span>&nbsp;<span class="num" id="7049591">1024</span><span class="op" id="7049595">)</span><br>
<span class="lineno"></span><span class="op" id="7049597">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7049600">func</span>&nbsp;<span class="ident" id="7049605">BenchmarkRC4_8K</span><span class="op" id="7049620">(</span><span class="ident" id="7049621">b</span>&nbsp;<span class="op" id="7049623">*</span><span class="ident" id="7049624">testing</span><span class="op" id="7049631">.</span><span class="ident" id="7049632">B</span><span class="op" id="7049633">)</span>&nbsp;<span class="op" id="7049635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7049638">benchmark</span><span class="op" id="7049647">(</span><span class="ident" id="7049648">b</span><span class="op" id="7049649">,</span>&nbsp;<span class="num" id="7049651">8096</span><span class="op" id="7049655">)</span><br>
<span class="lineno"></span><span class="op" id="7049657">}</span>
</div>
</body>
</html>
