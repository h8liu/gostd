<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4006727">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4006782">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4006836">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4006887">package</span>&nbsp;<span class="ident" id="4006895">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4006901">import</span>&nbsp;<span class="op" id="4006908">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006911">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006925">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006942">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4006952">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4006963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4006966">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4007055">type</span>&nbsp;<span class="ident" id="4007060">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4007076">struct</span>&nbsp;<span class="op" id="4007083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007086">Version</span>&nbsp;<span class="builtintype" id="4007094">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007099">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007107">*</span><span class="ident" id="4007108"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007111">.</span><span class="ident" id="4007112">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007117">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4007125">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007130">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007138">*</span><span class="ident" id="4007139"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007142">.</span><span class="ident" id="4007143">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007148">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007156">*</span><span class="ident" id="4007157"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007160">.</span><span class="ident" id="4007161">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007166">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4007174">*</span><span class="ident" id="4007175"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007178">.</span><span class="ident" id="4007179">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4007184">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007257">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4007262">*</span><span class="ident" id="4007263"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007266">.</span><span class="ident" id="4007267">Int</span>&nbsp;<span class="string" id="4007271">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007290">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4007295">*</span><span class="ident" id="4007296"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007299">.</span><span class="ident" id="4007300">Int</span>&nbsp;<span class="string" id="4007304">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007323">Qinv</span>&nbsp;<span class="op" id="4007328">*</span><span class="ident" id="4007329"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007332">.</span><span class="ident" id="4007333">Int</span>&nbsp;<span class="string" id="4007337">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007357">AdditionalPrimes</span>&nbsp;<span class="op" id="4007374">[</span><span class="op" id="4007375">]</span><span class="ident" id="4007376"><a href="/crypto/x509/pkcs1.go.html#4007436">pkcs1AdditionalRSAPrime</a></span>&nbsp;<span class="string" id="4007400">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4007428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4007431">type</span>&nbsp;<span class="ident" id="4007436">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4007460">struct</span>&nbsp;<span class="op" id="4007467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007470">Prime</span>&nbsp;<span class="op" id="4007476">*</span><span class="ident" id="4007477"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007480">.</span><span class="ident" id="4007481">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4007487">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007547">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4007553">*</span><span class="ident" id="4007554"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007557">.</span><span class="ident" id="4007558">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007563">Coeff</span>&nbsp;<span class="op" id="4007569">*</span><span class="ident" id="4007570"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4007573">.</span><span class="ident" id="4007574">Int</span><br>
<span class="lineno"></span><span class="op" id="4007578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4007581">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4007672">func</span>&nbsp;<span class="ident" id="4007677">ParsePKCS1PrivateKey</span><span class="op" id="4007697">(</span><span class="ident" id="4007698">der</span>&nbsp;<span class="op" id="4007702">[</span><span class="op" id="4007703">]</span><span class="builtintype" id="4007704">byte</span><span class="op" id="4007708">)</span>&nbsp;<span class="op" id="4007710">(</span><span class="ident" id="4007711">key</span>&nbsp;<span class="op" id="4007715">*</span><span class="ident" id="4007716"><a href="/crypto/x509/pkcs1.go.html#4006911">rsa</a></span><span class="op" id="4007719">.</span><span class="ident" id="4007720">PrivateKey</span><span class="op" id="4007730">,</span>&nbsp;<span class="ident" id="4007732">err</span>&nbsp;<span class="builtintype" id="4007736">error</span><span class="op" id="4007741">)</span>&nbsp;<span class="op" id="4007743">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007746">var</span>&nbsp;<span class="ident" id="4007750">priv</span>&nbsp;<span class="ident" id="4007755"><a href="/crypto/x509/pkcs1.go.html#4007060">pkcs1PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007772">rest</span><span class="op" id="4007776">,</span>&nbsp;<span class="ident" id="4007778"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span>&nbsp;<span class="op" id="4007782">:=</span>&nbsp;<span class="ident" id="4007785"><a href="/crypto/x509/pkcs1.go.html#4006925">asn1</a></span><span class="op" id="4007789">.</span><span class="ident" id="4007790">Unmarshal</span><span class="op" id="4007799">(</span><span class="ident" id="4007800"><a href="/crypto/x509/pkcs1.go.html#4007698">der</a></span><span class="op" id="4007803">,</span>&nbsp;<span class="op" id="4007805">&amp;</span><span class="ident" id="4007806"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4007810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007813">if</span>&nbsp;<span class="builtinfunc" id="4007816">len</span><span class="op" id="4007819">(</span><span class="ident" id="4007820"><a href="/crypto/x509/pkcs1.go.html#4007772">rest</a></span><span class="op" id="4007824">)</span>&nbsp;<span class="op" id="4007826">&gt;</span>&nbsp;<span class="num" id="4007828">0</span>&nbsp;<span class="op" id="4007830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4007834"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span>&nbsp;<span class="op" id="4007838">=</span>&nbsp;<span class="ident" id="4007840"><a href="/crypto/x509/pkcs1.go.html#4006925">asn1</a></span><span class="op" id="4007844">.</span><span class="ident" id="4007845">SyntaxError</span><span class="op" id="4007856">{</span><span class="ident" id="4007857">Msg</span><span class="op" id="4007860">:</span>&nbsp;<span class="string" id="4007862">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4007877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007881">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007892">if</span>&nbsp;<span class="ident" id="4007895"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span>&nbsp;<span class="op" id="4007899">!=</span>&nbsp;<span class="ident" id="4007902">nil</span>&nbsp;<span class="op" id="4007906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007910">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4007918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007922">if</span>&nbsp;<span class="ident" id="4007925"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4007929">.</span><span class="ident" id="4007930">Version</span>&nbsp;<span class="op" id="4007938">&gt;</span>&nbsp;<span class="num" id="4007940">1</span>&nbsp;<span class="op" id="4007942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4007946">return</span>&nbsp;<span class="ident" id="4007953">nil</span><span class="op" id="4007956">,</span>&nbsp;<span class="ident" id="4007958"><a href="/crypto/x509/pkcs1.go.html#4006942">errors</a></span><span class="op" id="4007964">.</span><span class="ident" id="4007965">New</span><span class="op" id="4007968">(</span><span class="string" id="4007969">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4008008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008015">if</span>&nbsp;<span class="ident" id="4008018"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008022">.</span><span class="ident" id="4008023">N</span><span class="op" id="4008024">.</span><span class="ident" id="4008025">Sign</span><span class="op" id="4008029">(</span><span class="op" id="4008030">)</span>&nbsp;<span class="op" id="4008032">&lt;=</span>&nbsp;<span class="num" id="4008035">0</span>&nbsp;<span class="op" id="4008037">||</span>&nbsp;<span class="ident" id="4008040"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008044">.</span><span class="ident" id="4008045">D</span><span class="op" id="4008046">.</span><span class="ident" id="4008047">Sign</span><span class="op" id="4008051">(</span><span class="op" id="4008052">)</span>&nbsp;<span class="op" id="4008054">&lt;=</span>&nbsp;<span class="num" id="4008057">0</span>&nbsp;<span class="op" id="4008059">||</span>&nbsp;<span class="ident" id="4008062"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008066">.</span><span class="ident" id="4008067">P</span><span class="op" id="4008068">.</span><span class="ident" id="4008069">Sign</span><span class="op" id="4008073">(</span><span class="op" id="4008074">)</span>&nbsp;<span class="op" id="4008076">&lt;=</span>&nbsp;<span class="num" id="4008079">0</span>&nbsp;<span class="op" id="4008081">||</span>&nbsp;<span class="ident" id="4008084"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008088">.</span><span class="ident" id="4008089">Q</span><span class="op" id="4008090">.</span><span class="ident" id="4008091">Sign</span><span class="op" id="4008095">(</span><span class="op" id="4008096">)</span>&nbsp;<span class="op" id="4008098">&lt;=</span>&nbsp;<span class="num" id="4008101">0</span>&nbsp;<span class="op" id="4008103">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008107">return</span>&nbsp;<span class="ident" id="4008114">nil</span><span class="op" id="4008117">,</span>&nbsp;<span class="ident" id="4008119"><a href="/crypto/x509/pkcs1.go.html#4006942">errors</a></span><span class="op" id="4008125">.</span><span class="ident" id="4008126">New</span><span class="op" id="4008129">(</span><span class="string" id="4008130">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4008181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008184">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008188"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span>&nbsp;<span class="op" id="4008192">=</span>&nbsp;<span class="builtinfunc" id="4008194">new</span><span class="op" id="4008197">(</span><span class="ident" id="4008198"><a href="/crypto/x509/pkcs1.go.html#4006911">rsa</a></span><span class="op" id="4008201">.</span><span class="ident" id="4008202">PrivateKey</span><span class="op" id="4008212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008215"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008218">.</span><span class="ident" id="4008219">PublicKey</span>&nbsp;<span class="op" id="4008229">=</span>&nbsp;<span class="ident" id="4008231"><a href="/crypto/x509/pkcs1.go.html#4006911">rsa</a></span><span class="op" id="4008234">.</span><span class="ident" id="4008235">PublicKey</span><span class="op" id="4008244">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008248">E</span><span class="op" id="4008249">:</span>&nbsp;<span class="ident" id="4008251"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008255">.</span><span class="ident" id="4008256">E</span><span class="op" id="4008257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008261">N</span><span class="op" id="4008262">:</span>&nbsp;<span class="ident" id="4008264"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008268">.</span><span class="ident" id="4008269">N</span><span class="op" id="4008270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008277"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008280">.</span><span class="ident" id="4008281">D</span>&nbsp;<span class="op" id="4008283">=</span>&nbsp;<span class="ident" id="4008285"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008289">.</span><span class="ident" id="4008290">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008293"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008296">.</span><span class="ident" id="4008297">Primes</span>&nbsp;<span class="op" id="4008304">=</span>&nbsp;<span class="builtinfunc" id="4008306">make</span><span class="op" id="4008310">(</span><span class="op" id="4008311">[</span><span class="op" id="4008312">]</span><span class="op" id="4008313">*</span><span class="ident" id="4008314"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4008317">.</span><span class="ident" id="4008318">Int</span><span class="op" id="4008321">,</span>&nbsp;<span class="num" id="4008323">2</span><span class="op" id="4008324">+</span><span class="builtinfunc" id="4008325">len</span><span class="op" id="4008328">(</span><span class="ident" id="4008329"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008333">.</span><span class="ident" id="4008334">AdditionalPrimes</span><span class="op" id="4008350">)</span><span class="op" id="4008351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008354"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008357">.</span><span class="ident" id="4008358">Primes</span><span class="op" id="4008364">[</span><span class="num" id="4008365">0</span><span class="op" id="4008366">]</span>&nbsp;<span class="op" id="4008368">=</span>&nbsp;<span class="ident" id="4008370"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008374">.</span><span class="ident" id="4008375">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008378"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008381">.</span><span class="ident" id="4008382">Primes</span><span class="op" id="4008388">[</span><span class="num" id="4008389">1</span><span class="op" id="4008390">]</span>&nbsp;<span class="op" id="4008392">=</span>&nbsp;<span class="ident" id="4008394"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008398">.</span><span class="ident" id="4008399">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008402">for</span>&nbsp;<span class="ident" id="4008406">i</span><span class="op" id="4008407">,</span>&nbsp;<span class="ident" id="4008409">a</span>&nbsp;<span class="op" id="4008411">:=</span>&nbsp;<span class="keyword" id="4008414">range</span>&nbsp;<span class="ident" id="4008420"><a href="/crypto/x509/pkcs1.go.html#4007750">priv</a></span><span class="op" id="4008424">.</span><span class="ident" id="4008425">AdditionalPrimes</span>&nbsp;<span class="op" id="4008442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008446">if</span>&nbsp;<span class="ident" id="4008449"><a href="/crypto/x509/pkcs1.go.html#4008409">a</a></span><span class="op" id="4008450">.</span><span class="ident" id="4008451">Prime</span><span class="op" id="4008456">.</span><span class="ident" id="4008457">Sign</span><span class="op" id="4008461">(</span><span class="op" id="4008462">)</span>&nbsp;<span class="op" id="4008464">&lt;=</span>&nbsp;<span class="num" id="4008467">0</span>&nbsp;<span class="op" id="4008469">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008474">return</span>&nbsp;<span class="ident" id="4008481">nil</span><span class="op" id="4008484">,</span>&nbsp;<span class="ident" id="4008486"><a href="/crypto/x509/pkcs1.go.html#4006942">errors</a></span><span class="op" id="4008492">.</span><span class="ident" id="4008493">New</span><span class="op" id="4008496">(</span><span class="string" id="4008497">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4008548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008556"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008559">.</span><span class="ident" id="4008560">Primes</span><span class="op" id="4008566">[</span><span class="ident" id="4008567"><a href="/crypto/x509/pkcs1.go.html#4008406">i</a></span><span class="op" id="4008568">+</span><span class="num" id="4008569">2</span><span class="op" id="4008570">]</span>&nbsp;<span class="op" id="4008572">=</span>&nbsp;<span class="ident" id="4008574"><a href="/crypto/x509/pkcs1.go.html#4008409">a</a></span><span class="op" id="4008575">.</span><span class="ident" id="4008576">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4008584">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4008647">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008671"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span>&nbsp;<span class="op" id="4008675">=</span>&nbsp;<span class="ident" id="4008677"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008680">.</span><span class="ident" id="4008681">Validate</span><span class="op" id="4008689">(</span><span class="op" id="4008690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008693">if</span>&nbsp;<span class="ident" id="4008696"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span>&nbsp;<span class="op" id="4008700">!=</span>&nbsp;<span class="ident" id="4008703">nil</span>&nbsp;<span class="op" id="4008707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008711">return</span>&nbsp;<span class="ident" id="4008718">nil</span><span class="op" id="4008721">,</span>&nbsp;<span class="ident" id="4008723"><a href="/crypto/x509/pkcs1.go.html#4007732">err</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008731"><a href="/crypto/x509/pkcs1.go.html#4007711">key</a></span><span class="op" id="4008734">.</span><span class="ident" id="4008735">Precompute</span><span class="op" id="4008745">(</span><span class="op" id="4008746">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008750">return</span><br>
<span class="lineno"></span><span class="op" id="4008757">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4008760">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4008836">func</span>&nbsp;<span class="ident" id="4008841">MarshalPKCS1PrivateKey</span><span class="op" id="4008863">(</span><span class="ident" id="4008864">key</span>&nbsp;<span class="op" id="4008868">*</span><span class="ident" id="4008869"><a href="/crypto/x509/pkcs1.go.html#4006911">rsa</a></span><span class="op" id="4008872">.</span><span class="ident" id="4008873">PrivateKey</span><span class="op" id="4008883">)</span>&nbsp;<span class="op" id="4008885">[</span><span class="op" id="4008886">]</span><span class="builtintype" id="4008887">byte</span>&nbsp;<span class="op" id="4008892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008895"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4008898">.</span><span class="ident" id="4008899">Precompute</span><span class="op" id="4008909">(</span><span class="op" id="4008910">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008914">version</span>&nbsp;<span class="op" id="4008922">:=</span>&nbsp;<span class="num" id="4008925">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4008928">if</span>&nbsp;<span class="builtinfunc" id="4008931">len</span><span class="op" id="4008934">(</span><span class="ident" id="4008935"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4008938">.</span><span class="ident" id="4008939">Primes</span><span class="op" id="4008945">)</span>&nbsp;<span class="op" id="4008947">&gt;</span>&nbsp;<span class="num" id="4008949">2</span>&nbsp;<span class="op" id="4008951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008955"><a href="/crypto/x509/pkcs1.go.html#4008914">version</a></span>&nbsp;<span class="op" id="4008963">=</span>&nbsp;<span class="num" id="4008965">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4008968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008972">priv</span>&nbsp;<span class="op" id="4008977">:=</span>&nbsp;<span class="ident" id="4008980"><a href="/crypto/x509/pkcs1.go.html#4007060">pkcs1PrivateKey</a></span><span class="op" id="4008995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4008999">Version</span><span class="op" id="4009006">:</span>&nbsp;<span class="ident" id="4009008"><a href="/crypto/x509/pkcs1.go.html#4008914">version</a></span><span class="op" id="4009015">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009019">N</span><span class="op" id="4009020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009028"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009031">.</span><span class="ident" id="4009032">N</span><span class="op" id="4009033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009037">E</span><span class="op" id="4009038">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009046"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009049">.</span><span class="ident" id="4009050">PublicKey</span><span class="op" id="4009059">.</span><span class="ident" id="4009060">E</span><span class="op" id="4009061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009065">D</span><span class="op" id="4009066">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009074"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009077">.</span><span class="ident" id="4009078">D</span><span class="op" id="4009079">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009083">P</span><span class="op" id="4009084">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009092"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009095">.</span><span class="ident" id="4009096">Primes</span><span class="op" id="4009102">[</span><span class="num" id="4009103">0</span><span class="op" id="4009104">]</span><span class="op" id="4009105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009109">Q</span><span class="op" id="4009110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009118"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009121">.</span><span class="ident" id="4009122">Primes</span><span class="op" id="4009128">[</span><span class="num" id="4009129">1</span><span class="op" id="4009130">]</span><span class="op" id="4009131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009135">Dp</span><span class="op" id="4009137">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009144"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009147">.</span><span class="ident" id="4009148">Precomputed</span><span class="op" id="4009159">.</span><span class="ident" id="4009160">Dp</span><span class="op" id="4009162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009166">Dq</span><span class="op" id="4009168">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009175"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009178">.</span><span class="ident" id="4009179">Precomputed</span><span class="op" id="4009190">.</span><span class="ident" id="4009191">Dq</span><span class="op" id="4009193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009197">Qinv</span><span class="op" id="4009201">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4009206"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009209">.</span><span class="ident" id="4009210">Precomputed</span><span class="op" id="4009221">.</span><span class="ident" id="4009222">Qinv</span><span class="op" id="4009226">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009233"><a href="/crypto/x509/pkcs1.go.html#4008972">priv</a></span><span class="op" id="4009237">.</span><span class="ident" id="4009238">AdditionalPrimes</span>&nbsp;<span class="op" id="4009255">=</span>&nbsp;<span class="builtinfunc" id="4009257">make</span><span class="op" id="4009261">(</span><span class="op" id="4009262">[</span><span class="op" id="4009263">]</span><span class="ident" id="4009264"><a href="/crypto/x509/pkcs1.go.html#4007436">pkcs1AdditionalRSAPrime</a></span><span class="op" id="4009287">,</span>&nbsp;<span class="builtinfunc" id="4009289">len</span><span class="op" id="4009292">(</span><span class="ident" id="4009293"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009296">.</span><span class="ident" id="4009297">Precomputed</span><span class="op" id="4009308">.</span><span class="ident" id="4009309">CRTValues</span><span class="op" id="4009318">)</span><span class="op" id="4009319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009322">for</span>&nbsp;<span class="ident" id="4009326">i</span><span class="op" id="4009327">,</span>&nbsp;<span class="ident" id="4009329">values</span>&nbsp;<span class="op" id="4009336">:=</span>&nbsp;<span class="keyword" id="4009339">range</span>&nbsp;<span class="ident" id="4009345"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009348">.</span><span class="ident" id="4009349">Precomputed</span><span class="op" id="4009360">.</span><span class="ident" id="4009361">CRTValues</span>&nbsp;<span class="op" id="4009371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009375"><a href="/crypto/x509/pkcs1.go.html#4008972">priv</a></span><span class="op" id="4009379">.</span><span class="ident" id="4009380">AdditionalPrimes</span><span class="op" id="4009396">[</span><span class="ident" id="4009397"><a href="/crypto/x509/pkcs1.go.html#4009326">i</a></span><span class="op" id="4009398">]</span><span class="op" id="4009399">.</span><span class="ident" id="4009400">Prime</span>&nbsp;<span class="op" id="4009406">=</span>&nbsp;<span class="ident" id="4009408"><a href="/crypto/x509/pkcs1.go.html#4008864">key</a></span><span class="op" id="4009411">.</span><span class="ident" id="4009412">Primes</span><span class="op" id="4009418">[</span><span class="num" id="4009419">2</span><span class="op" id="4009420">+</span><span class="ident" id="4009421"><a href="/crypto/x509/pkcs1.go.html#4009326">i</a></span><span class="op" id="4009422">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009426"><a href="/crypto/x509/pkcs1.go.html#4008972">priv</a></span><span class="op" id="4009430">.</span><span class="ident" id="4009431">AdditionalPrimes</span><span class="op" id="4009447">[</span><span class="ident" id="4009448"><a href="/crypto/x509/pkcs1.go.html#4009326">i</a></span><span class="op" id="4009449">]</span><span class="op" id="4009450">.</span><span class="ident" id="4009451">Exp</span>&nbsp;<span class="op" id="4009455">=</span>&nbsp;<span class="ident" id="4009457"><a href="/crypto/x509/pkcs1.go.html#4009329">values</a></span><span class="op" id="4009463">.</span><span class="ident" id="4009464">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009470"><a href="/crypto/x509/pkcs1.go.html#4008972">priv</a></span><span class="op" id="4009474">.</span><span class="ident" id="4009475">AdditionalPrimes</span><span class="op" id="4009491">[</span><span class="ident" id="4009492"><a href="/crypto/x509/pkcs1.go.html#4009326">i</a></span><span class="op" id="4009493">]</span><span class="op" id="4009494">.</span><span class="ident" id="4009495">Coeff</span>&nbsp;<span class="op" id="4009501">=</span>&nbsp;<span class="ident" id="4009503"><a href="/crypto/x509/pkcs1.go.html#4009329">values</a></span><span class="op" id="4009509">.</span><span class="ident" id="4009510">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4009517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009521">b</span><span class="op" id="4009522">,</span>&nbsp;<span class="ident" id="4009524">_</span>&nbsp;<span class="op" id="4009526">:=</span>&nbsp;<span class="ident" id="4009529"><a href="/crypto/x509/pkcs1.go.html#4006925">asn1</a></span><span class="op" id="4009533">.</span><span class="ident" id="4009534">Marshal</span><span class="op" id="4009541">(</span><span class="ident" id="4009542"><a href="/crypto/x509/pkcs1.go.html#4008972">priv</a></span><span class="op" id="4009546">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4009549">return</span>&nbsp;<span class="ident" id="4009556"><a href="/crypto/x509/pkcs1.go.html#4009521">b</a></span><br>
<span class="lineno"></span><span class="op" id="4009558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4009561">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4009630">type</span>&nbsp;<span class="ident" id="4009635">rsaPublicKey</span>&nbsp;<span class="keyword" id="4009648">struct</span>&nbsp;<span class="op" id="4009655">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009658">N</span>&nbsp;<span class="op" id="4009660">*</span><span class="ident" id="4009661"><a href="/crypto/x509/pkcs1.go.html#4006952">big</a></span><span class="op" id="4009664">.</span><span class="ident" id="4009665">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4009670">E</span>&nbsp;<span class="builtintype" id="4009672">int</span><br>
<span class="lineno"></span><span class="op" id="4009676">}</span>
</div>
</body>
</html>
