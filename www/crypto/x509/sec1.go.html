<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4013430">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4013485">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4013539">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4013590">package</span>&nbsp;<span class="ident" id="4013598">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4013604">import</span>&nbsp;<span class="op" id="4013611">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013614">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013630">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013649">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013666">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013676">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4013683">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4013694">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4013697">const</span>&nbsp;<span class="ident" id="4013703">ecPrivKeyVersion</span>&nbsp;<span class="op" id="4013720">=</span>&nbsp;<span class="num" id="4013722">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4013725">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4013797">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="4013812">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="4013825">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="4013886">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4013959">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="4013984">type</span>&nbsp;<span class="ident" id="4013989">ecPrivateKey</span>&nbsp;<span class="keyword" id="4014002">struct</span>&nbsp;<span class="op" id="4014009">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014012">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4014026">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014031">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4014045">[</span><span class="op" id="4014046">]</span><span class="builtintype" id="4014047">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014053">NamedCurveOID</span>&nbsp;<span class="ident" id="4014067"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4014071">.</span><span class="ident" id="4014072">ObjectIdentifier</span>&nbsp;<span class="string" id="4014089">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014123">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014137"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4014141">.</span><span class="ident" id="4014142">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4014159">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4014192">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4014195">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4014270">func</span>&nbsp;<span class="ident" id="4014275">ParseECPrivateKey</span><span class="op" id="4014292">(</span><span class="ident" id="4014293">der</span>&nbsp;<span class="op" id="4014297">[</span><span class="op" id="4014298">]</span><span class="builtintype" id="4014299">byte</span><span class="op" id="4014303">)</span>&nbsp;<span class="op" id="4014305">(</span><span class="ident" id="4014306">key</span>&nbsp;<span class="op" id="4014310">*</span><span class="ident" id="4014311"><a href="/crypto/x509/sec1.go.html#4013614">ecdsa</a></span><span class="op" id="4014316">.</span><span class="ident" id="4014317">PrivateKey</span><span class="op" id="4014327">,</span>&nbsp;<span class="ident" id="4014329">err</span>&nbsp;<span class="builtintype" id="4014333">error</span><span class="op" id="4014338">)</span>&nbsp;<span class="op" id="4014340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014343">return</span>&nbsp;<span class="ident" id="4014350"><a href="/crypto/x509/sec1.go.html#4015115">parseECPrivateKey</a></span><span class="op" id="4014367">(</span><span class="ident" id="4014368">nil</span><span class="op" id="4014371">,</span>&nbsp;<span class="ident" id="4014373"><a href="/crypto/x509/sec1.go.html#4014293">der</a></span><span class="op" id="4014376">)</span><br>
<span class="lineno"></span><span class="op" id="4014378">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4014381">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="4014455">func</span>&nbsp;<span class="ident" id="4014460">MarshalECPrivateKey</span><span class="op" id="4014479">(</span><span class="ident" id="4014480">key</span>&nbsp;<span class="op" id="4014484">*</span><span class="ident" id="4014485"><a href="/crypto/x509/sec1.go.html#4013614">ecdsa</a></span><span class="op" id="4014490">.</span><span class="ident" id="4014491">PrivateKey</span><span class="op" id="4014501">)</span>&nbsp;<span class="op" id="4014503">(</span><span class="op" id="4014504">[</span><span class="op" id="4014505">]</span><span class="builtintype" id="4014506">byte</span><span class="op" id="4014510">,</span>&nbsp;<span class="builtintype" id="4014512">error</span><span class="op" id="4014517">)</span>&nbsp;<span class="op" id="4014519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014522">oid</span><span class="op" id="4014525">,</span>&nbsp;<span class="ident" id="4014527">ok</span>&nbsp;<span class="op" id="4014530">:=</span>&nbsp;<span class="ident" id="4014533"><a href="/crypto/x509/x509.go.html#4039971">oidFromNamedCurve</a></span><span class="op" id="4014550">(</span><span class="ident" id="4014551"><a href="/crypto/x509/sec1.go.html#4014480">key</a></span><span class="op" id="4014554">.</span><span class="ident" id="4014555">Curve</span><span class="op" id="4014560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014563">if</span>&nbsp;<span class="op" id="4014566">!</span><span class="ident" id="4014567"><a href="/crypto/x509/sec1.go.html#4014527">ok</a></span>&nbsp;<span class="op" id="4014570">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014574">return</span>&nbsp;<span class="ident" id="4014581">nil</span><span class="op" id="4014584">,</span>&nbsp;<span class="ident" id="4014586"><a href="/crypto/x509/sec1.go.html#4013666">errors</a></span><span class="op" id="4014592">.</span><span class="ident" id="4014593">New</span><span class="op" id="4014596">(</span><span class="string" id="4014597">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4014627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4014633">return</span>&nbsp;<span class="ident" id="4014640"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4014644">.</span><span class="ident" id="4014645">Marshal</span><span class="op" id="4014652">(</span><span class="ident" id="4014653"><a href="/crypto/x509/sec1.go.html#4013989">ecPrivateKey</a></span><span class="op" id="4014665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014669">Version</span><span class="op" id="4014676">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4014684">1</span><span class="op" id="4014685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014689">PrivateKey</span><span class="op" id="4014699">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014704"><a href="/crypto/x509/sec1.go.html#4014480">key</a></span><span class="op" id="4014707">.</span><span class="ident" id="4014708">D</span><span class="op" id="4014709">.</span><span class="ident" id="4014710">Bytes</span><span class="op" id="4014715">(</span><span class="op" id="4014716">)</span><span class="op" id="4014717">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014721">NamedCurveOID</span><span class="op" id="4014734">:</span>&nbsp;<span class="ident" id="4014736"><a href="/crypto/x509/sec1.go.html#4014522">oid</a></span><span class="op" id="4014739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4014743">PublicKey</span><span class="op" id="4014752">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4014758"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4014762">.</span><span class="ident" id="4014763">BitString</span><span class="op" id="4014772">{</span><span class="ident" id="4014773">Bytes</span><span class="op" id="4014778">:</span>&nbsp;<span class="ident" id="4014780"><a href="/crypto/x509/sec1.go.html#4013630">elliptic</a></span><span class="op" id="4014788">.</span><span class="ident" id="4014789">Marshal</span><span class="op" id="4014796">(</span><span class="ident" id="4014797"><a href="/crypto/x509/sec1.go.html#4014480">key</a></span><span class="op" id="4014800">.</span><span class="ident" id="4014801">Curve</span><span class="op" id="4014806">,</span>&nbsp;<span class="ident" id="4014808"><a href="/crypto/x509/sec1.go.html#4014480">key</a></span><span class="op" id="4014811">.</span><span class="ident" id="4014812">X</span><span class="op" id="4014813">,</span>&nbsp;<span class="ident" id="4014815"><a href="/crypto/x509/sec1.go.html#4014480">key</a></span><span class="op" id="4014818">.</span><span class="ident" id="4014819">Y</span><span class="op" id="4014820">)</span><span class="op" id="4014821">}</span><span class="op" id="4014822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4014825">}</span><span class="op" id="4014826">)</span><br>
<span class="lineno"></span><span class="op" id="4014828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4014831">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="4014906">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4014982">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="4015059">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="4015110">func</span>&nbsp;<span class="ident" id="4015115">parseECPrivateKey</span><span class="op" id="4015132">(</span><span class="ident" id="4015133">namedCurveOID</span>&nbsp;<span class="op" id="4015147">*</span><span class="ident" id="4015148"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4015152">.</span><span class="ident" id="4015153">ObjectIdentifier</span><span class="op" id="4015169">,</span>&nbsp;<span class="ident" id="4015171">der</span>&nbsp;<span class="op" id="4015175">[</span><span class="op" id="4015176">]</span><span class="builtintype" id="4015177">byte</span><span class="op" id="4015181">)</span>&nbsp;<span class="op" id="4015183">(</span><span class="ident" id="4015184">key</span>&nbsp;<span class="op" id="4015188">*</span><span class="ident" id="4015189"><a href="/crypto/x509/sec1.go.html#4013614">ecdsa</a></span><span class="op" id="4015194">.</span><span class="ident" id="4015195">PrivateKey</span><span class="op" id="4015205">,</span>&nbsp;<span class="ident" id="4015207">err</span>&nbsp;<span class="builtintype" id="4015211">error</span><span class="op" id="4015216">)</span>&nbsp;<span class="op" id="4015218">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015221">var</span>&nbsp;<span class="ident" id="4015225">privKey</span>&nbsp;<span class="ident" id="4015233"><a href="/crypto/x509/sec1.go.html#4013989">ecPrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015247">if</span>&nbsp;<span class="ident" id="4015250">_</span><span class="op" id="4015251">,</span>&nbsp;<span class="ident" id="4015253">err</span>&nbsp;<span class="op" id="4015257">:=</span>&nbsp;<span class="ident" id="4015260"><a href="/crypto/x509/sec1.go.html#4013649">asn1</a></span><span class="op" id="4015264">.</span><span class="ident" id="4015265">Unmarshal</span><span class="op" id="4015274">(</span><span class="ident" id="4015275"><a href="/crypto/x509/sec1.go.html#4015171">der</a></span><span class="op" id="4015278">,</span>&nbsp;<span class="op" id="4015280">&amp;</span><span class="ident" id="4015281"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4015288">)</span><span class="op" id="4015289">;</span>&nbsp;<span class="ident" id="4015291"><a href="/crypto/x509/sec1.go.html#4015253">err</a></span>&nbsp;<span class="op" id="4015295">!=</span>&nbsp;<span class="ident" id="4015298">nil</span>&nbsp;<span class="op" id="4015302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015306">return</span>&nbsp;<span class="ident" id="4015313">nil</span><span class="op" id="4015316">,</span>&nbsp;<span class="ident" id="4015318"><a href="/crypto/x509/sec1.go.html#4013666">errors</a></span><span class="op" id="4015324">.</span><span class="ident" id="4015325">New</span><span class="op" id="4015328">(</span><span class="string" id="4015329">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="4015370">+</span>&nbsp;<span class="ident" id="4015372"><a href="/crypto/x509/sec1.go.html#4015253">err</a></span><span class="op" id="4015375">.</span><span class="ident" id="4015376">Error</span><span class="op" id="4015381">(</span><span class="op" id="4015382">)</span><span class="op" id="4015383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015389">if</span>&nbsp;<span class="ident" id="4015392"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4015399">.</span><span class="ident" id="4015400">Version</span>&nbsp;<span class="op" id="4015408">!=</span>&nbsp;<span class="ident" id="4015411"><a href="/crypto/x509/sec1.go.html#4013703">ecPrivKeyVersion</a></span>&nbsp;<span class="op" id="4015428">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015432">return</span>&nbsp;<span class="ident" id="4015439">nil</span><span class="op" id="4015442">,</span>&nbsp;<span class="ident" id="4015444"><a href="/crypto/x509/sec1.go.html#4013676">fmt</a></span><span class="op" id="4015447">.</span><span class="ident" id="4015448">Errorf</span><span class="op" id="4015454">(</span><span class="string" id="4015455">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="4015496">,</span>&nbsp;<span class="ident" id="4015498"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4015505">.</span><span class="ident" id="4015506">Version</span><span class="op" id="4015513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015520">var</span>&nbsp;<span class="ident" id="4015524">curve</span>&nbsp;<span class="ident" id="4015530"><a href="/crypto/x509/sec1.go.html#4013630">elliptic</a></span><span class="op" id="4015538">.</span><span class="ident" id="4015539">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015546">if</span>&nbsp;<span class="ident" id="4015549"><a href="/crypto/x509/sec1.go.html#4015133">namedCurveOID</a></span>&nbsp;<span class="op" id="4015563">!=</span>&nbsp;<span class="ident" id="4015566">nil</span>&nbsp;<span class="op" id="4015570">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015574"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span>&nbsp;<span class="op" id="4015580">=</span>&nbsp;<span class="ident" id="4015582"><a href="/crypto/x509/x509.go.html#4039632">namedCurveFromOID</a></span><span class="op" id="4015599">(</span><span class="op" id="4015600">*</span><span class="ident" id="4015601"><a href="/crypto/x509/sec1.go.html#4015133">namedCurveOID</a></span><span class="op" id="4015614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015617">}</span>&nbsp;<span class="keyword" id="4015619">else</span>&nbsp;<span class="op" id="4015624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015628"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span>&nbsp;<span class="op" id="4015634">=</span>&nbsp;<span class="ident" id="4015636"><a href="/crypto/x509/x509.go.html#4039632">namedCurveFromOID</a></span><span class="op" id="4015653">(</span><span class="ident" id="4015654"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4015661">.</span><span class="ident" id="4015662">NamedCurveOID</span><span class="op" id="4015675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015681">if</span>&nbsp;<span class="ident" id="4015684"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span>&nbsp;<span class="op" id="4015690">==</span>&nbsp;<span class="ident" id="4015693">nil</span>&nbsp;<span class="op" id="4015697">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015701">return</span>&nbsp;<span class="ident" id="4015708">nil</span><span class="op" id="4015711">,</span>&nbsp;<span class="ident" id="4015713"><a href="/crypto/x509/sec1.go.html#4013666">errors</a></span><span class="op" id="4015719">.</span><span class="ident" id="4015720">New</span><span class="op" id="4015723">(</span><span class="string" id="4015724">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="4015754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015761">k</span>&nbsp;<span class="op" id="4015763">:=</span>&nbsp;<span class="builtinfunc" id="4015766">new</span><span class="op" id="4015769">(</span><span class="ident" id="4015770"><a href="/crypto/x509/sec1.go.html#4013683">big</a></span><span class="op" id="4015773">.</span><span class="ident" id="4015774">Int</span><span class="op" id="4015777">)</span><span class="op" id="4015778">.</span><span class="ident" id="4015779">SetBytes</span><span class="op" id="4015787">(</span><span class="ident" id="4015788"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4015795">.</span><span class="ident" id="4015796">PrivateKey</span><span class="op" id="4015806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015809">if</span>&nbsp;<span class="ident" id="4015812"><a href="/crypto/x509/sec1.go.html#4015761">k</a></span><span class="op" id="4015813">.</span><span class="ident" id="4015814">Cmp</span><span class="op" id="4015817">(</span><span class="ident" id="4015818"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span><span class="op" id="4015823">.</span><span class="ident" id="4015824">Params</span><span class="op" id="4015830">(</span><span class="op" id="4015831">)</span><span class="op" id="4015832">.</span><span class="ident" id="4015833">N</span><span class="op" id="4015834">)</span>&nbsp;<span class="op" id="4015836">&gt;=</span>&nbsp;<span class="num" id="4015839">0</span>&nbsp;<span class="op" id="4015841">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4015845">return</span>&nbsp;<span class="ident" id="4015852">nil</span><span class="op" id="4015855">,</span>&nbsp;<span class="ident" id="4015857"><a href="/crypto/x509/sec1.go.html#4013666">errors</a></span><span class="op" id="4015863">.</span><span class="ident" id="4015864">New</span><span class="op" id="4015867">(</span><span class="string" id="4015868">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="4015916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4015919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015922">priv</span>&nbsp;<span class="op" id="4015927">:=</span>&nbsp;<span class="builtinfunc" id="4015930">new</span><span class="op" id="4015933">(</span><span class="ident" id="4015934"><a href="/crypto/x509/sec1.go.html#4013614">ecdsa</a></span><span class="op" id="4015939">.</span><span class="ident" id="4015940">PrivateKey</span><span class="op" id="4015950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015953"><a href="/crypto/x509/sec1.go.html#4015922">priv</a></span><span class="op" id="4015957">.</span><span class="ident" id="4015958">Curve</span>&nbsp;<span class="op" id="4015964">=</span>&nbsp;<span class="ident" id="4015966"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015973"><a href="/crypto/x509/sec1.go.html#4015922">priv</a></span><span class="op" id="4015977">.</span><span class="ident" id="4015978">D</span>&nbsp;<span class="op" id="4015980">=</span>&nbsp;<span class="ident" id="4015982"><a href="/crypto/x509/sec1.go.html#4015761">k</a></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4015985"><a href="/crypto/x509/sec1.go.html#4015922">priv</a></span><span class="op" id="4015989">.</span><span class="ident" id="4015990">X</span><span class="op" id="4015991">,</span>&nbsp;<span class="ident" id="4015993"><a href="/crypto/x509/sec1.go.html#4015922">priv</a></span><span class="op" id="4015997">.</span><span class="ident" id="4015998">Y</span>&nbsp;<span class="op" id="4016000">=</span>&nbsp;<span class="ident" id="4016002"><a href="/crypto/x509/sec1.go.html#4015524">curve</a></span><span class="op" id="4016007">.</span><span class="ident" id="4016008">ScalarBaseMult</span><span class="op" id="4016022">(</span><span class="ident" id="4016023"><a href="/crypto/x509/sec1.go.html#4015225">privKey</a></span><span class="op" id="4016030">.</span><span class="ident" id="4016031">PrivateKey</span><span class="op" id="4016041">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4016045">return</span>&nbsp;<span class="ident" id="4016052"><a href="/crypto/x509/sec1.go.html#4015922">priv</a></span><span class="op" id="4016056">,</span>&nbsp;<span class="ident" id="4016058">nil</span><br>
<span class="lineno"></span><span class="op" id="4016062">}</span>
</div>
</body>
</html>
