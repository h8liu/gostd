<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html" class="current">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4508155">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4508210">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4508264">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4508315">package</span>&nbsp;<span class="ident" id="4508323">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4508329">import</span>&nbsp;<span class="op" id="4508336">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4508339">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4508359">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4508376">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4508386">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4508392">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4508395">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4508446">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4508506">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4508522">type</span>&nbsp;<span class="ident" id="4508527">pkcs8</span>&nbsp;<span class="keyword" id="4508533">struct</span>&nbsp;<span class="op" id="4508540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508543">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4508554">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508559">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508570">pkix</span><span class="op" id="4508574">.</span><span class="ident" id="4508575">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508596">PrivateKey</span>&nbsp;<span class="op" id="4508607">[</span><span class="op" id="4508608">]</span><span class="builtintype" id="4508609">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4508615">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4508647">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4508650">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4508721">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4508781">func</span>&nbsp;<span class="ident" id="4508786">ParsePKCS8PrivateKey</span><span class="op" id="4508806">(</span><span class="ident" id="4508807">der</span>&nbsp;<span class="op" id="4508811">[</span><span class="op" id="4508812">]</span><span class="builtintype" id="4508813">byte</span><span class="op" id="4508817">)</span>&nbsp;<span class="op" id="4508819">(</span><span class="ident" id="4508820">key</span>&nbsp;<span class="keyword" id="4508824">interface</span><span class="op" id="4508833">{</span><span class="op" id="4508834">}</span><span class="op" id="4508835">,</span>&nbsp;<span class="ident" id="4508837">err</span>&nbsp;<span class="builtintype" id="4508841">error</span><span class="op" id="4508846">)</span>&nbsp;<span class="op" id="4508848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508851">var</span>&nbsp;<span class="ident" id="4508855">privKey</span>&nbsp;<span class="ident" id="4508863">pkcs8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508870">if</span>&nbsp;<span class="ident" id="4508873">_</span><span class="op" id="4508874">,</span>&nbsp;<span class="ident" id="4508876">err</span>&nbsp;<span class="op" id="4508880">:=</span>&nbsp;<span class="ident" id="4508883">asn1</span><span class="op" id="4508887">.</span><span class="ident" id="4508888">Unmarshal</span><span class="op" id="4508897">(</span><span class="ident" id="4508898">der</span><span class="op" id="4508901">,</span>&nbsp;<span class="op" id="4508903">&amp;</span><span class="ident" id="4508904">privKey</span><span class="op" id="4508911">)</span><span class="op" id="4508912">;</span>&nbsp;<span class="ident" id="4508914">err</span>&nbsp;<span class="op" id="4508918">!=</span>&nbsp;<span class="builtintype" id="4508921">nil</span>&nbsp;<span class="op" id="4508925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508929">return</span>&nbsp;<span class="builtintype" id="4508936">nil</span><span class="op" id="4508939">,</span>&nbsp;<span class="ident" id="4508941">err</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508949">switch</span>&nbsp;<span class="op" id="4508956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508959">case</span>&nbsp;<span class="ident" id="4508964">privKey</span><span class="op" id="4508971">.</span><span class="ident" id="4508972">Algo</span><span class="op" id="4508976">.</span><span class="ident" id="4508977">Algorithm</span><span class="op" id="4508986">.</span><span class="ident" id="4508987">Equal</span><span class="op" id="4508992">(</span><span class="ident" id="4508993">oidPublicKeyRSA</span><span class="op" id="4509008">)</span><span class="op" id="4509009">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509013">key</span><span class="op" id="4509016">,</span>&nbsp;<span class="ident" id="4509018">err</span>&nbsp;<span class="op" id="4509022">=</span>&nbsp;<span class="ident" id="4509024">ParsePKCS1PrivateKey</span><span class="op" id="4509044">(</span><span class="ident" id="4509045">privKey</span><span class="op" id="4509052">.</span><span class="ident" id="4509053">PrivateKey</span><span class="op" id="4509063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509067">if</span>&nbsp;<span class="ident" id="4509070">err</span>&nbsp;<span class="op" id="4509074">!=</span>&nbsp;<span class="builtintype" id="4509077">nil</span>&nbsp;<span class="op" id="4509081">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509086">return</span>&nbsp;<span class="builtintype" id="4509093">nil</span><span class="op" id="4509096">,</span>&nbsp;<span class="ident" id="4509098">errors</span><span class="op" id="4509104">.</span><span class="ident" id="4509105">New</span><span class="op" id="4509108">(</span><span class="string" id="4509109">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4509170">+</span>&nbsp;<span class="ident" id="4509172">err</span><span class="op" id="4509175">.</span><span class="ident" id="4509176">Error</span><span class="op" id="4509181">(</span><span class="op" id="4509182">)</span><span class="op" id="4509183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509191">return</span>&nbsp;<span class="ident" id="4509198">key</span><span class="op" id="4509201">,</span>&nbsp;<span class="builtintype" id="4509203">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509209">case</span>&nbsp;<span class="ident" id="4509214">privKey</span><span class="op" id="4509221">.</span><span class="ident" id="4509222">Algo</span><span class="op" id="4509226">.</span><span class="ident" id="4509227">Algorithm</span><span class="op" id="4509236">.</span><span class="ident" id="4509237">Equal</span><span class="op" id="4509242">(</span><span class="ident" id="4509243">oidPublicKeyECDSA</span><span class="op" id="4509260">)</span><span class="op" id="4509261">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509265">bytes</span>&nbsp;<span class="op" id="4509271">:=</span>&nbsp;<span class="ident" id="4509274">privKey</span><span class="op" id="4509281">.</span><span class="ident" id="4509282">Algo</span><span class="op" id="4509286">.</span><span class="ident" id="4509287">Parameters</span><span class="op" id="4509297">.</span><span class="ident" id="4509298">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509310">namedCurveOID</span>&nbsp;<span class="op" id="4509324">:=</span>&nbsp;<span class="builtinfunc" id="4509327">new</span><span class="op" id="4509330">(</span><span class="ident" id="4509331">asn1</span><span class="op" id="4509335">.</span><span class="ident" id="4509336">ObjectIdentifier</span><span class="op" id="4509352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509356">if</span>&nbsp;<span class="ident" id="4509359">_</span><span class="op" id="4509360">,</span>&nbsp;<span class="ident" id="4509362">err</span>&nbsp;<span class="op" id="4509366">:=</span>&nbsp;<span class="ident" id="4509369">asn1</span><span class="op" id="4509373">.</span><span class="ident" id="4509374">Unmarshal</span><span class="op" id="4509383">(</span><span class="ident" id="4509384">bytes</span><span class="op" id="4509389">,</span>&nbsp;<span class="ident" id="4509391">namedCurveOID</span><span class="op" id="4509404">)</span><span class="op" id="4509405">;</span>&nbsp;<span class="ident" id="4509407">err</span>&nbsp;<span class="op" id="4509411">!=</span>&nbsp;<span class="builtintype" id="4509414">nil</span>&nbsp;<span class="op" id="4509418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509423">namedCurveOID</span>&nbsp;<span class="op" id="4509437">=</span>&nbsp;<span class="builtintype" id="4509439">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509445">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509449">key</span><span class="op" id="4509452">,</span>&nbsp;<span class="ident" id="4509454">err</span>&nbsp;<span class="op" id="4509458">=</span>&nbsp;<span class="ident" id="4509460">parseECPrivateKey</span><span class="op" id="4509477">(</span><span class="ident" id="4509478">namedCurveOID</span><span class="op" id="4509491">,</span>&nbsp;<span class="ident" id="4509493">privKey</span><span class="op" id="4509500">.</span><span class="ident" id="4509501">PrivateKey</span><span class="op" id="4509511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509515">if</span>&nbsp;<span class="ident" id="4509518">err</span>&nbsp;<span class="op" id="4509522">!=</span>&nbsp;<span class="builtintype" id="4509525">nil</span>&nbsp;<span class="op" id="4509529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509534">return</span>&nbsp;<span class="builtintype" id="4509541">nil</span><span class="op" id="4509544">,</span>&nbsp;<span class="ident" id="4509546">errors</span><span class="op" id="4509552">.</span><span class="ident" id="4509553">New</span><span class="op" id="4509556">(</span><span class="string" id="4509557">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4509617">+</span>&nbsp;<span class="ident" id="4509619">err</span><span class="op" id="4509622">.</span><span class="ident" id="4509623">Error</span><span class="op" id="4509628">(</span><span class="op" id="4509629">)</span><span class="op" id="4509630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509638">return</span>&nbsp;<span class="ident" id="4509645">key</span><span class="op" id="4509648">,</span>&nbsp;<span class="builtintype" id="4509650">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509656">default</span><span class="op" id="4509663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509667">return</span>&nbsp;<span class="builtintype" id="4509674">nil</span><span class="op" id="4509677">,</span>&nbsp;<span class="ident" id="4509679">fmt</span><span class="op" id="4509682">.</span><span class="ident" id="4509683">Errorf</span><span class="op" id="4509689">(</span><span class="string" id="4509690">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4509762">,</span>&nbsp;<span class="ident" id="4509764">privKey</span><span class="op" id="4509771">.</span><span class="ident" id="4509772">Algo</span><span class="op" id="4509776">.</span><span class="ident" id="4509777">Algorithm</span><span class="op" id="4509786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509789">}</span><br>
<span class="lineno"></span><span class="op" id="4509791">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
