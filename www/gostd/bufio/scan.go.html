<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>bufio</h2>
<ul>
<li><a href="/gostd/bufio/bufio.go.html">bufio.go</a></li>
<li><a href="/gostd/bufio/bufio_test.go.html">bufio_test.go</a></li>
<li><a href="/gostd/bufio/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/bufio/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/bufio/scan.go.html">scan.go</a></li>
<li><a href="/gostd/bufio/scan_test.go.html">scan_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3362465">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3362520">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3362574">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3362625">package</span>&nbsp;<span class="ident" id="3362633">bufio</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3362640">import</span>&nbsp;<span class="op" id="3362647">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3362650">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3362659">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3362669">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3362675">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3362690">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3362693">//&nbsp;Scanner&nbsp;provides&nbsp;a&nbsp;convenient&nbsp;interface&nbsp;for&nbsp;reading&nbsp;data&nbsp;such&nbsp;as</span><br>
<span class="lineno">15</span><span class="comment" id="3362761">//&nbsp;a&nbsp;file&nbsp;of&nbsp;newline-delimited&nbsp;lines&nbsp;of&nbsp;text.&nbsp;Successive&nbsp;calls&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3362827">//&nbsp;the&nbsp;Scan&nbsp;method&nbsp;will&nbsp;step&nbsp;through&nbsp;the&nbsp;&#39;tokens&#39;&nbsp;of&nbsp;a&nbsp;file,&nbsp;skipping</span><br>
<span class="lineno"></span><span class="comment" id="3362897">//&nbsp;the&nbsp;bytes&nbsp;between&nbsp;the&nbsp;tokens.&nbsp;The&nbsp;specification&nbsp;of&nbsp;a&nbsp;token&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3362962">//&nbsp;defined&nbsp;by&nbsp;a&nbsp;split&nbsp;function&nbsp;of&nbsp;type&nbsp;SplitFunc;&nbsp;the&nbsp;default&nbsp;split</span><br>
<span class="lineno"></span><span class="comment" id="3363030">//&nbsp;function&nbsp;breaks&nbsp;the&nbsp;input&nbsp;into&nbsp;lines&nbsp;with&nbsp;line&nbsp;termination&nbsp;stripped.&nbsp;Split</span><br>
<span class="lineno">20</span><span class="comment" id="3363108">//&nbsp;functions&nbsp;are&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;for&nbsp;scanning&nbsp;a&nbsp;file&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3363174">//&nbsp;lines,&nbsp;bytes,&nbsp;UTF-8-encoded&nbsp;runes,&nbsp;and&nbsp;space-delimited&nbsp;words.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="3363243">//&nbsp;client&nbsp;may&nbsp;instead&nbsp;provide&nbsp;a&nbsp;custom&nbsp;split&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="3363298">//</span><br>
<span class="lineno"></span><span class="comment" id="3363301">//&nbsp;Scanning&nbsp;stops&nbsp;unrecoverably&nbsp;at&nbsp;EOF,&nbsp;the&nbsp;first&nbsp;I/O&nbsp;error,&nbsp;or&nbsp;a&nbsp;token&nbsp;too</span><br>
<span class="lineno">25</span><span class="comment" id="3363377">//&nbsp;large&nbsp;to&nbsp;fit&nbsp;in&nbsp;the&nbsp;buffer.&nbsp;When&nbsp;a&nbsp;scan&nbsp;stops,&nbsp;the&nbsp;reader&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="3363447">//&nbsp;advanced&nbsp;arbitrarily&nbsp;far&nbsp;past&nbsp;the&nbsp;last&nbsp;token.&nbsp;Programs&nbsp;that&nbsp;need&nbsp;more</span><br>
<span class="lineno"></span><span class="comment" id="3363520">//&nbsp;control&nbsp;over&nbsp;error&nbsp;handling&nbsp;or&nbsp;large&nbsp;tokens,&nbsp;or&nbsp;must&nbsp;run&nbsp;sequential&nbsp;scans</span><br>
<span class="lineno"></span><span class="comment" id="3363597">//&nbsp;on&nbsp;a&nbsp;reader,&nbsp;should&nbsp;use&nbsp;bufio.Reader&nbsp;instead.</span><br>
<span class="lineno"></span><span class="comment" id="3363646">//</span><br>
<span class="lineno">30</span><span class="keyword" id="3363649">type</span>&nbsp;<span class="ident" id="3363654">Scanner</span>&nbsp;<span class="keyword" id="3363662">struct</span>&nbsp;<span class="op" id="3363669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363672">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363685">io</span><span class="op" id="3363687">.</span><span class="ident" id="3363688">Reader</span>&nbsp;<span class="comment" id="3363695">//&nbsp;The&nbsp;reader&nbsp;provided&nbsp;by&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363734">split</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3363747">SplitFunc</span>&nbsp;<span class="comment" id="3363757">//&nbsp;The&nbsp;function&nbsp;to&nbsp;split&nbsp;the&nbsp;tokens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363795">maxTokenSize</span>&nbsp;<span class="builtintype" id="3363808">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363818">//&nbsp;Maximum&nbsp;size&nbsp;of&nbsp;a&nbsp;token;&nbsp;modified&nbsp;by&nbsp;tests.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363866">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363879">[</span><span class="op" id="3363880">]</span><span class="builtintype" id="3363881">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363889">//&nbsp;Last&nbsp;token&nbsp;returned&nbsp;by&nbsp;split.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363923">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3363936">[</span><span class="op" id="3363937">]</span><span class="builtintype" id="3363938">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3363946">//&nbsp;Buffer&nbsp;used&nbsp;as&nbsp;argument&nbsp;to&nbsp;split.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3363984">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3363997">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364007">//&nbsp;First&nbsp;non-processed&nbsp;byte&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364044">end</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3364057">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364067">//&nbsp;End&nbsp;of&nbsp;data&nbsp;in&nbsp;buf.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364091">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3364104">error</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364114">//&nbsp;Sticky&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3364132">empties</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3364145">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3364155">//&nbsp;Count&nbsp;of&nbsp;successive&nbsp;empty&nbsp;tokens.</span><br>
<span class="lineno">40</span><span class="op" id="3364192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3364195">//&nbsp;SplitFunc&nbsp;is&nbsp;the&nbsp;signature&nbsp;of&nbsp;the&nbsp;split&nbsp;function&nbsp;used&nbsp;to&nbsp;tokenize&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3364268">//&nbsp;input.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;an&nbsp;initial&nbsp;substring&nbsp;of&nbsp;the&nbsp;remaining&nbsp;unprocessed</span><br>
<span class="lineno"></span><span class="comment" id="3364346">//&nbsp;data&nbsp;and&nbsp;a&nbsp;flag,&nbsp;atEOF,&nbsp;that&nbsp;reports&nbsp;whether&nbsp;the&nbsp;Reader&nbsp;has&nbsp;no&nbsp;more&nbsp;data</span><br>
<span class="lineno">45</span><span class="comment" id="3364422">//&nbsp;to&nbsp;give.&nbsp;The&nbsp;return&nbsp;values&nbsp;are&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;advance&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span><span class="comment" id="3364497">//&nbsp;and&nbsp;the&nbsp;next&nbsp;token&nbsp;to&nbsp;return&nbsp;to&nbsp;the&nbsp;user,&nbsp;plus&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3364572">//&nbsp;data&nbsp;does&nbsp;not&nbsp;yet&nbsp;hold&nbsp;a&nbsp;complete&nbsp;token,&nbsp;for&nbsp;instance&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;newline</span><br>
<span class="lineno"></span><span class="comment" id="3364650">//&nbsp;while&nbsp;scanning&nbsp;lines,&nbsp;SplitFunc&nbsp;can&nbsp;return&nbsp;(0,&nbsp;nil,&nbsp;nil)&nbsp;to&nbsp;signal&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3364724">//&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;more&nbsp;data&nbsp;into&nbsp;the&nbsp;slice&nbsp;and&nbsp;try&nbsp;again&nbsp;with&nbsp;a&nbsp;longer&nbsp;slice</span><br>
<span class="lineno">50</span><span class="comment" id="3364802">//&nbsp;starting&nbsp;at&nbsp;the&nbsp;same&nbsp;point&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="comment" id="3364846">//</span><br>
<span class="lineno"></span><span class="comment" id="3364849">//&nbsp;If&nbsp;the&nbsp;returned&nbsp;error&nbsp;is&nbsp;non-nil,&nbsp;scanning&nbsp;stops&nbsp;and&nbsp;the&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="3364915">//&nbsp;is&nbsp;returned&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="comment" id="3364945">//</span><br>
<span class="lineno">55</span><span class="comment" id="3364948">//&nbsp;The&nbsp;function&nbsp;is&nbsp;never&nbsp;called&nbsp;with&nbsp;an&nbsp;empty&nbsp;data&nbsp;slice&nbsp;unless&nbsp;atEOF</span><br>
<span class="lineno"></span><span class="comment" id="3365018">//&nbsp;is&nbsp;true.&nbsp;If&nbsp;atEOF&nbsp;is&nbsp;true,&nbsp;however,&nbsp;data&nbsp;may&nbsp;be&nbsp;non-empty&nbsp;and,</span><br>
<span class="lineno"></span><span class="comment" id="3365084">//&nbsp;as&nbsp;always,&nbsp;holds&nbsp;unprocessed&nbsp;text.</span><br>
<span class="lineno"></span><span class="keyword" id="3365122">type</span>&nbsp;<span class="ident" id="3365127">SplitFunc</span>&nbsp;<span class="keyword" id="3365137">func</span><span class="op" id="3365141">(</span><span class="ident" id="3365142">data</span>&nbsp;<span class="op" id="3365147">[</span><span class="op" id="3365148">]</span><span class="builtintype" id="3365149">byte</span><span class="op" id="3365153">,</span>&nbsp;<span class="ident" id="3365155">atEOF</span>&nbsp;<span class="builtintype" id="3365161">bool</span><span class="op" id="3365165">)</span>&nbsp;<span class="op" id="3365167">(</span><span class="ident" id="3365168">advance</span>&nbsp;<span class="builtintype" id="3365176">int</span><span class="op" id="3365179">,</span>&nbsp;<span class="ident" id="3365181">token</span>&nbsp;<span class="op" id="3365187">[</span><span class="op" id="3365188">]</span><span class="builtintype" id="3365189">byte</span><span class="op" id="3365193">,</span>&nbsp;<span class="ident" id="3365195">err</span>&nbsp;<span class="builtintype" id="3365199">error</span><span class="op" id="3365204">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="3365207">//&nbsp;Errors&nbsp;returned&nbsp;by&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3365238">var</span>&nbsp;<span class="op" id="3365242">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365245">ErrTooLong</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3365264">=</span>&nbsp;<span class="ident" id="3365266">errors</span><span class="op" id="3365272">.</span><span class="ident" id="3365273">New</span><span class="op" id="3365276">(</span><span class="string" id="3365277">&#34;bufio.Scanner:&nbsp;token&nbsp;too&nbsp;long&#34;</span><span class="op" id="3365308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365311">ErrNegativeAdvance</span>&nbsp;<span class="op" id="3365330">=</span>&nbsp;<span class="ident" id="3365332">errors</span><span class="op" id="3365338">.</span><span class="ident" id="3365339">New</span><span class="op" id="3365342">(</span><span class="string" id="3365343">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;negative&nbsp;advance&nbsp;count&#34;</span><span class="op" id="3365400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365403">ErrAdvanceTooFar</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3365422">=</span>&nbsp;<span class="ident" id="3365424">errors</span><span class="op" id="3365430">.</span><span class="ident" id="3365431">New</span><span class="op" id="3365434">(</span><span class="string" id="3365435">&#34;bufio.Scanner:&nbsp;SplitFunc&nbsp;returns&nbsp;advance&nbsp;count&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="3365496">)</span><br>
<span class="lineno">65</span><span class="op" id="3365498">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3365501">const</span>&nbsp;<span class="op" id="3365507">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3365510">//&nbsp;MaxScanTokenSize&nbsp;is&nbsp;the&nbsp;maximum&nbsp;size&nbsp;used&nbsp;to&nbsp;buffer&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3365575">//&nbsp;The&nbsp;actual&nbsp;maximum&nbsp;token&nbsp;size&nbsp;may&nbsp;be&nbsp;smaller&nbsp;as&nbsp;the&nbsp;buffer</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3365638">//&nbsp;may&nbsp;need&nbsp;to&nbsp;include,&nbsp;for&nbsp;instance,&nbsp;a&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365688">MaxScanTokenSize</span>&nbsp;<span class="op" id="3365705">=</span>&nbsp;<span class="num" id="3365707">64</span>&nbsp;<span class="op" id="3365710">*</span>&nbsp;<span class="num" id="3365712">1024</span><br>
<span class="lineno"></span><span class="op" id="3365717">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3365720">//&nbsp;NewScanner&nbsp;returns&nbsp;a&nbsp;new&nbsp;Scanner&nbsp;to&nbsp;read&nbsp;from&nbsp;r.</span><br>
<span class="lineno">75</span><span class="comment" id="3365772">//&nbsp;The&nbsp;split&nbsp;function&nbsp;defaults&nbsp;to&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3365817">func</span>&nbsp;<span class="ident" id="3365822">NewScanner</span><span class="op" id="3365832">(</span><span class="ident" id="3365833">r</span>&nbsp;<span class="ident" id="3365835">io</span><span class="op" id="3365837">.</span><span class="ident" id="3365838">Reader</span><span class="op" id="3365844">)</span>&nbsp;<span class="op" id="3365846">*</span><span class="ident" id="3365847">Scanner</span>&nbsp;<span class="op" id="3365855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3365858">return</span>&nbsp;<span class="op" id="3365865">&amp;</span><span class="ident" id="3365866">Scanner</span><span class="op" id="3365873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365877">r</span><span class="op" id="3365878">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365891">r</span><span class="op" id="3365892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365896">split</span><span class="op" id="3365901">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3365910">ScanLines</span><span class="op" id="3365919">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365923">maxTokenSize</span><span class="op" id="3365935">:</span>&nbsp;<span class="ident" id="3365937">MaxScanTokenSize</span><span class="op" id="3365953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3365957">buf</span><span class="op" id="3365960">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3365971">make</span><span class="op" id="3365975">(</span><span class="op" id="3365976">[</span><span class="op" id="3365977">]</span><span class="builtintype" id="3365978">byte</span><span class="op" id="3365982">,</span>&nbsp;<span class="num" id="3365984">4096</span><span class="op" id="3365988">)</span><span class="op" id="3365989">,</span>&nbsp;<span class="comment" id="3365991">//&nbsp;Plausible&nbsp;starting&nbsp;size;&nbsp;needn&#39;t&nbsp;be&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3366038">}</span><br>
<span class="lineno"></span><span class="op" id="3366040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3366043">//&nbsp;Err&nbsp;returns&nbsp;the&nbsp;first&nbsp;non-EOF&nbsp;error&nbsp;that&nbsp;was&nbsp;encountered&nbsp;by&nbsp;the&nbsp;Scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="3366119">func</span>&nbsp;<span class="op" id="3366124">(</span><span class="ident" id="3366125">s</span>&nbsp;<span class="op" id="3366127">*</span><span class="ident" id="3366128">Scanner</span><span class="op" id="3366135">)</span>&nbsp;<span class="ident" id="3366137">Err</span><span class="op" id="3366140">(</span><span class="op" id="3366141">)</span>&nbsp;<span class="builtintype" id="3366143">error</span>&nbsp;<span class="op" id="3366149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3366152">if</span>&nbsp;<span class="ident" id="3366155">s</span><span class="op" id="3366156">.</span><span class="ident" id="3366157">err</span>&nbsp;<span class="op" id="3366161">==</span>&nbsp;<span class="ident" id="3366164">io</span><span class="op" id="3366166">.</span><span class="ident" id="3366167">EOF</span>&nbsp;<span class="op" id="3366171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3366175">return</span>&nbsp;<span class="ident" id="3366182">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3366187">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3366190">return</span>&nbsp;<span class="ident" id="3366197">s</span><span class="op" id="3366198">.</span><span class="ident" id="3366199">err</span><br>
<span class="lineno"></span><span class="op" id="3366203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3366206">//&nbsp;Bytes&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan.</span><br>
<span class="lineno"></span><span class="comment" id="3366274">//&nbsp;The&nbsp;underlying&nbsp;array&nbsp;may&nbsp;point&nbsp;to&nbsp;data&nbsp;that&nbsp;will&nbsp;be&nbsp;overwritten</span><br>
<span class="lineno">95</span><span class="comment" id="3366341">//&nbsp;by&nbsp;a&nbsp;subsequent&nbsp;call&nbsp;to&nbsp;Scan.&nbsp;It&nbsp;does&nbsp;no&nbsp;allocation.</span><br>
<span class="lineno"></span><span class="keyword" id="3366397">func</span>&nbsp;<span class="op" id="3366402">(</span><span class="ident" id="3366403">s</span>&nbsp;<span class="op" id="3366405">*</span><span class="ident" id="3366406">Scanner</span><span class="op" id="3366413">)</span>&nbsp;<span class="ident" id="3366415">Bytes</span><span class="op" id="3366420">(</span><span class="op" id="3366421">)</span>&nbsp;<span class="op" id="3366423">[</span><span class="op" id="3366424">]</span><span class="builtintype" id="3366425">byte</span>&nbsp;<span class="op" id="3366430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3366433">return</span>&nbsp;<span class="ident" id="3366440">s</span><span class="op" id="3366441">.</span><span class="ident" id="3366442">token</span><br>
<span class="lineno"></span><span class="op" id="3366448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="3366451">//&nbsp;Text&nbsp;returns&nbsp;the&nbsp;most&nbsp;recent&nbsp;token&nbsp;generated&nbsp;by&nbsp;a&nbsp;call&nbsp;to&nbsp;Scan</span><br>
<span class="lineno"></span><span class="comment" id="3366517">//&nbsp;as&nbsp;a&nbsp;newly&nbsp;allocated&nbsp;string&nbsp;holding&nbsp;its&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3366567">func</span>&nbsp;<span class="op" id="3366572">(</span><span class="ident" id="3366573">s</span>&nbsp;<span class="op" id="3366575">*</span><span class="ident" id="3366576">Scanner</span><span class="op" id="3366583">)</span>&nbsp;<span class="ident" id="3366585">Text</span><span class="op" id="3366589">(</span><span class="op" id="3366590">)</span>&nbsp;<span class="builtintype" id="3366592">string</span>&nbsp;<span class="op" id="3366599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3366602">return</span>&nbsp;<span class="builtintype" id="3366609">string</span><span class="op" id="3366615">(</span><span class="ident" id="3366616">s</span><span class="op" id="3366617">.</span><span class="ident" id="3366618">token</span><span class="op" id="3366623">)</span><br>
<span class="lineno"></span><span class="op" id="3366625">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="3366628">//&nbsp;Scan&nbsp;advances&nbsp;the&nbsp;Scanner&nbsp;to&nbsp;the&nbsp;next&nbsp;token,&nbsp;which&nbsp;will&nbsp;then&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3366695">//&nbsp;available&nbsp;through&nbsp;the&nbsp;Bytes&nbsp;or&nbsp;Text&nbsp;method.&nbsp;It&nbsp;returns&nbsp;false&nbsp;when&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3366768">//&nbsp;scan&nbsp;stops,&nbsp;either&nbsp;by&nbsp;reaching&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;input&nbsp;or&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="3366836">//&nbsp;After&nbsp;Scan&nbsp;returns&nbsp;false,&nbsp;the&nbsp;Err&nbsp;method&nbsp;will&nbsp;return&nbsp;any&nbsp;error&nbsp;that</span><br>
<span class="lineno">110</span><span class="comment" id="3366907">//&nbsp;occurred&nbsp;during&nbsp;scanning,&nbsp;except&nbsp;that&nbsp;if&nbsp;it&nbsp;was&nbsp;io.EOF,&nbsp;Err</span><br>
<span class="lineno"></span><span class="comment" id="3366970">//&nbsp;will&nbsp;return&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3366990">//&nbsp;Split&nbsp;panics&nbsp;if&nbsp;the&nbsp;split&nbsp;function&nbsp;returns&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3367061">//&nbsp;advancing&nbsp;the&nbsp;input.&nbsp;This&nbsp;is&nbsp;a&nbsp;common&nbsp;error&nbsp;mode&nbsp;for&nbsp;scanners.</span><br>
<span class="lineno"></span><span class="keyword" id="3367127">func</span>&nbsp;<span class="op" id="3367132">(</span><span class="ident" id="3367133">s</span>&nbsp;<span class="op" id="3367135">*</span><span class="ident" id="3367136">Scanner</span><span class="op" id="3367143">)</span>&nbsp;<span class="ident" id="3367145">Scan</span><span class="op" id="3367149">(</span><span class="op" id="3367150">)</span>&nbsp;<span class="builtintype" id="3367152">bool</span>&nbsp;<span class="op" id="3367157">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367160">//&nbsp;Loop&nbsp;until&nbsp;we&nbsp;have&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367192">for</span>&nbsp;<span class="op" id="3367196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367200">//&nbsp;See&nbsp;if&nbsp;we&nbsp;can&nbsp;get&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;already&nbsp;have.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367258">//&nbsp;If&nbsp;we&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;data&nbsp;but&nbsp;have&nbsp;an&nbsp;error,&nbsp;give&nbsp;the&nbsp;split&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367331">//&nbsp;a&nbsp;chance&nbsp;to&nbsp;recover&nbsp;any&nbsp;remaining,&nbsp;possibly&nbsp;empty&nbsp;token.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367393">if</span>&nbsp;<span class="ident" id="3367396">s</span><span class="op" id="3367397">.</span><span class="ident" id="3367398">end</span>&nbsp;<span class="op" id="3367402">&gt;</span>&nbsp;<span class="ident" id="3367404">s</span><span class="op" id="3367405">.</span><span class="ident" id="3367406">start</span>&nbsp;<span class="op" id="3367412">||</span>&nbsp;<span class="ident" id="3367415">s</span><span class="op" id="3367416">.</span><span class="ident" id="3367417">err</span>&nbsp;<span class="op" id="3367421">!=</span>&nbsp;<span class="ident" id="3367424">nil</span>&nbsp;<span class="op" id="3367428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367433">advance</span><span class="op" id="3367440">,</span>&nbsp;<span class="ident" id="3367442">token</span><span class="op" id="3367447">,</span>&nbsp;<span class="ident" id="3367449">err</span>&nbsp;<span class="op" id="3367453">:=</span>&nbsp;<span class="ident" id="3367456">s</span><span class="op" id="3367457">.</span><span class="ident" id="3367458">split</span><span class="op" id="3367463">(</span><span class="ident" id="3367464">s</span><span class="op" id="3367465">.</span><span class="ident" id="3367466">buf</span><span class="op" id="3367469">[</span><span class="ident" id="3367470">s</span><span class="op" id="3367471">.</span><span class="ident" id="3367472">start</span><span class="op" id="3367477">:</span><span class="ident" id="3367478">s</span><span class="op" id="3367479">.</span><span class="ident" id="3367480">end</span><span class="op" id="3367483">]</span><span class="op" id="3367484">,</span>&nbsp;<span class="ident" id="3367486">s</span><span class="op" id="3367487">.</span><span class="ident" id="3367488">err</span>&nbsp;<span class="op" id="3367492">!=</span>&nbsp;<span class="ident" id="3367495">nil</span><span class="op" id="3367498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367503">if</span>&nbsp;<span class="ident" id="3367506">err</span>&nbsp;<span class="op" id="3367510">!=</span>&nbsp;<span class="ident" id="3367513">nil</span>&nbsp;<span class="op" id="3367517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367523">s</span><span class="op" id="3367524">.</span><span class="ident" id="3367525">setErr</span><span class="op" id="3367531">(</span><span class="ident" id="3367532">err</span><span class="op" id="3367535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367541">return</span>&nbsp;<span class="builtintype" id="3367548">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367562">if</span>&nbsp;<span class="op" id="3367565">!</span><span class="ident" id="3367566">s</span><span class="op" id="3367567">.</span><span class="ident" id="3367568">advance</span><span class="op" id="3367575">(</span><span class="ident" id="3367576">advance</span><span class="op" id="3367583">)</span>&nbsp;<span class="op" id="3367585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367591">return</span>&nbsp;<span class="builtintype" id="3367598">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367612">s</span><span class="op" id="3367613">.</span><span class="ident" id="3367614">token</span>&nbsp;<span class="op" id="3367620">=</span>&nbsp;<span class="ident" id="3367622">token</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367631">if</span>&nbsp;<span class="ident" id="3367634">token</span>&nbsp;<span class="op" id="3367640">!=</span>&nbsp;<span class="ident" id="3367643">nil</span>&nbsp;<span class="op" id="3367647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367653">if</span>&nbsp;<span class="ident" id="3367656">s</span><span class="op" id="3367657">.</span><span class="ident" id="3367658">err</span>&nbsp;<span class="op" id="3367662">==</span>&nbsp;<span class="ident" id="3367665">nil</span>&nbsp;<span class="op" id="3367669">||</span>&nbsp;<span class="ident" id="3367672">advance</span>&nbsp;<span class="op" id="3367680">&gt;</span>&nbsp;<span class="num" id="3367682">0</span>&nbsp;<span class="op" id="3367684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367691">s</span><span class="op" id="3367692">.</span><span class="ident" id="3367693">empties</span>&nbsp;<span class="op" id="3367701">=</span>&nbsp;<span class="num" id="3367703">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367709">}</span>&nbsp;<span class="keyword" id="3367711">else</span>&nbsp;<span class="op" id="3367716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367723">//&nbsp;Returning&nbsp;tokens&nbsp;not&nbsp;advancing&nbsp;input&nbsp;at&nbsp;EOF.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3367776">s</span><span class="op" id="3367777">.</span><span class="ident" id="3367778">empties</span><span class="op" id="3367785">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367793">if</span>&nbsp;<span class="ident" id="3367796">s</span><span class="op" id="3367797">.</span><span class="ident" id="3367798">empties</span>&nbsp;<span class="op" id="3367806">&gt;</span>&nbsp;<span class="num" id="3367808">100</span>&nbsp;<span class="op" id="3367812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3367820">panic</span><span class="op" id="3367825">(</span><span class="string" id="3367826">&#34;bufio.Scan:&nbsp;100&nbsp;empty&nbsp;tokens&nbsp;without&nbsp;progressing&#34;</span><span class="op" id="3367876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367889">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3367895">return</span>&nbsp;<span class="builtintype" id="3367902">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3367914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367918">//&nbsp;We&nbsp;cannot&nbsp;generate&nbsp;a&nbsp;token&nbsp;with&nbsp;what&nbsp;we&nbsp;are&nbsp;holding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3367976">//&nbsp;If&nbsp;we&#39;ve&nbsp;already&nbsp;hit&nbsp;EOF&nbsp;or&nbsp;an&nbsp;I/O&nbsp;error,&nbsp;we&nbsp;are&nbsp;done.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368036">if</span>&nbsp;<span class="ident" id="3368039">s</span><span class="op" id="3368040">.</span><span class="ident" id="3368041">err</span>&nbsp;<span class="op" id="3368045">!=</span>&nbsp;<span class="ident" id="3368048">nil</span>&nbsp;<span class="op" id="3368052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368057">//&nbsp;Shut&nbsp;it&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368077">s</span><span class="op" id="3368078">.</span><span class="ident" id="3368079">start</span>&nbsp;<span class="op" id="3368085">=</span>&nbsp;<span class="num" id="3368087">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368092">s</span><span class="op" id="3368093">.</span><span class="ident" id="3368094">end</span>&nbsp;<span class="op" id="3368098">=</span>&nbsp;<span class="num" id="3368100">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368105">return</span>&nbsp;<span class="builtintype" id="3368112">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3368120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368124">//&nbsp;Must&nbsp;read&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368150">//&nbsp;First,&nbsp;shift&nbsp;data&nbsp;to&nbsp;beginning&nbsp;of&nbsp;buffer&nbsp;if&nbsp;there&#39;s&nbsp;lots&nbsp;of&nbsp;empty&nbsp;space</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368227">//&nbsp;or&nbsp;space&nbsp;is&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368252">if</span>&nbsp;<span class="ident" id="3368255">s</span><span class="op" id="3368256">.</span><span class="ident" id="3368257">start</span>&nbsp;<span class="op" id="3368263">&gt;</span>&nbsp;<span class="num" id="3368265">0</span>&nbsp;<span class="op" id="3368267">&amp;&amp;</span>&nbsp;<span class="op" id="3368270">(</span><span class="ident" id="3368271">s</span><span class="op" id="3368272">.</span><span class="ident" id="3368273">end</span>&nbsp;<span class="op" id="3368277">==</span>&nbsp;<span class="builtinfunc" id="3368280">len</span><span class="op" id="3368283">(</span><span class="ident" id="3368284">s</span><span class="op" id="3368285">.</span><span class="ident" id="3368286">buf</span><span class="op" id="3368289">)</span>&nbsp;<span class="op" id="3368291">||</span>&nbsp;<span class="ident" id="3368294">s</span><span class="op" id="3368295">.</span><span class="ident" id="3368296">start</span>&nbsp;<span class="op" id="3368302">&gt;</span>&nbsp;<span class="builtinfunc" id="3368304">len</span><span class="op" id="3368307">(</span><span class="ident" id="3368308">s</span><span class="op" id="3368309">.</span><span class="ident" id="3368310">buf</span><span class="op" id="3368313">)</span><span class="op" id="3368314">/</span><span class="num" id="3368315">2</span><span class="op" id="3368316">)</span>&nbsp;<span class="op" id="3368318">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3368323">copy</span><span class="op" id="3368327">(</span><span class="ident" id="3368328">s</span><span class="op" id="3368329">.</span><span class="ident" id="3368330">buf</span><span class="op" id="3368333">,</span>&nbsp;<span class="ident" id="3368335">s</span><span class="op" id="3368336">.</span><span class="ident" id="3368337">buf</span><span class="op" id="3368340">[</span><span class="ident" id="3368341">s</span><span class="op" id="3368342">.</span><span class="ident" id="3368343">start</span><span class="op" id="3368348">:</span><span class="ident" id="3368349">s</span><span class="op" id="3368350">.</span><span class="ident" id="3368351">end</span><span class="op" id="3368354">]</span><span class="op" id="3368355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368360">s</span><span class="op" id="3368361">.</span><span class="ident" id="3368362">end</span>&nbsp;<span class="op" id="3368366">-=</span>&nbsp;<span class="ident" id="3368369">s</span><span class="op" id="3368370">.</span><span class="ident" id="3368371">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368380">s</span><span class="op" id="3368381">.</span><span class="ident" id="3368382">start</span>&nbsp;<span class="op" id="3368388">=</span>&nbsp;<span class="num" id="3368390">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3368394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368398">//&nbsp;Is&nbsp;the&nbsp;buffer&nbsp;full?&nbsp;If&nbsp;so,&nbsp;resize.</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368438">if</span>&nbsp;<span class="ident" id="3368441">s</span><span class="op" id="3368442">.</span><span class="ident" id="3368443">end</span>&nbsp;<span class="op" id="3368447">==</span>&nbsp;<span class="builtinfunc" id="3368450">len</span><span class="op" id="3368453">(</span><span class="ident" id="3368454">s</span><span class="op" id="3368455">.</span><span class="ident" id="3368456">buf</span><span class="op" id="3368459">)</span>&nbsp;<span class="op" id="3368461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368466">if</span>&nbsp;<span class="builtinfunc" id="3368469">len</span><span class="op" id="3368472">(</span><span class="ident" id="3368473">s</span><span class="op" id="3368474">.</span><span class="ident" id="3368475">buf</span><span class="op" id="3368478">)</span>&nbsp;<span class="op" id="3368480">&gt;=</span>&nbsp;<span class="ident" id="3368483">s</span><span class="op" id="3368484">.</span><span class="ident" id="3368485">maxTokenSize</span>&nbsp;<span class="op" id="3368498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368504">s</span><span class="op" id="3368505">.</span><span class="ident" id="3368506">setErr</span><span class="op" id="3368512">(</span><span class="ident" id="3368513">ErrTooLong</span><span class="op" id="3368523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368529">return</span>&nbsp;<span class="builtintype" id="3368536">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3368545">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368550">newSize</span>&nbsp;<span class="op" id="3368558">:=</span>&nbsp;<span class="builtinfunc" id="3368561">len</span><span class="op" id="3368564">(</span><span class="ident" id="3368565">s</span><span class="op" id="3368566">.</span><span class="ident" id="3368567">buf</span><span class="op" id="3368570">)</span>&nbsp;<span class="op" id="3368572">*</span>&nbsp;<span class="num" id="3368574">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368579">if</span>&nbsp;<span class="ident" id="3368582">newSize</span>&nbsp;<span class="op" id="3368590">&gt;</span>&nbsp;<span class="ident" id="3368592">s</span><span class="op" id="3368593">.</span><span class="ident" id="3368594">maxTokenSize</span>&nbsp;<span class="op" id="3368607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368613">newSize</span>&nbsp;<span class="op" id="3368621">=</span>&nbsp;<span class="ident" id="3368623">s</span><span class="op" id="3368624">.</span><span class="ident" id="3368625">maxTokenSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3368641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368646">newBuf</span>&nbsp;<span class="op" id="3368653">:=</span>&nbsp;<span class="builtinfunc" id="3368656">make</span><span class="op" id="3368660">(</span><span class="op" id="3368661">[</span><span class="op" id="3368662">]</span><span class="builtintype" id="3368663">byte</span><span class="op" id="3368667">,</span>&nbsp;<span class="ident" id="3368669">newSize</span><span class="op" id="3368676">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3368681">copy</span><span class="op" id="3368685">(</span><span class="ident" id="3368686">newBuf</span><span class="op" id="3368692">,</span>&nbsp;<span class="ident" id="3368694">s</span><span class="op" id="3368695">.</span><span class="ident" id="3368696">buf</span><span class="op" id="3368699">[</span><span class="ident" id="3368700">s</span><span class="op" id="3368701">.</span><span class="ident" id="3368702">start</span><span class="op" id="3368707">:</span><span class="ident" id="3368708">s</span><span class="op" id="3368709">.</span><span class="ident" id="3368710">end</span><span class="op" id="3368713">]</span><span class="op" id="3368714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368719">s</span><span class="op" id="3368720">.</span><span class="ident" id="3368721">buf</span>&nbsp;<span class="op" id="3368725">=</span>&nbsp;<span class="ident" id="3368727">newBuf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368737">s</span><span class="op" id="3368738">.</span><span class="ident" id="3368739">end</span>&nbsp;<span class="op" id="3368743">-=</span>&nbsp;<span class="ident" id="3368746">s</span><span class="op" id="3368747">.</span><span class="ident" id="3368748">start</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3368757">s</span><span class="op" id="3368758">.</span><span class="ident" id="3368759">start</span>&nbsp;<span class="op" id="3368765">=</span>&nbsp;<span class="num" id="3368767">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368772">continue</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3368783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368787">//&nbsp;Finally&nbsp;we&nbsp;can&nbsp;read&nbsp;some&nbsp;input.&nbsp;Make&nbsp;sure&nbsp;we&nbsp;don&#39;t&nbsp;get&nbsp;stuck&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368858">//&nbsp;a&nbsp;misbehaving&nbsp;Reader.&nbsp;Officially&nbsp;we&nbsp;don&#39;t&nbsp;need&nbsp;to&nbsp;do&nbsp;this,&nbsp;but&nbsp;let&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3368932">//&nbsp;be&nbsp;extra&nbsp;careful:&nbsp;Scanner&nbsp;is&nbsp;for&nbsp;safe,&nbsp;simple&nbsp;jobs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3368989">for</span>&nbsp;<span class="ident" id="3368993">loop</span>&nbsp;<span class="op" id="3368998">:=</span>&nbsp;<span class="num" id="3369001">0</span><span class="op" id="3369002">;</span>&nbsp;<span class="op" id="3369004">;</span>&nbsp;<span class="op" id="3369006">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369011">n</span><span class="op" id="3369012">,</span>&nbsp;<span class="ident" id="3369014">err</span>&nbsp;<span class="op" id="3369018">:=</span>&nbsp;<span class="ident" id="3369021">s</span><span class="op" id="3369022">.</span><span class="ident" id="3369023">r</span><span class="op" id="3369024">.</span><span class="ident" id="3369025">Read</span><span class="op" id="3369029">(</span><span class="ident" id="3369030">s</span><span class="op" id="3369031">.</span><span class="ident" id="3369032">buf</span><span class="op" id="3369035">[</span><span class="ident" id="3369036">s</span><span class="op" id="3369037">.</span><span class="ident" id="3369038">end</span><span class="op" id="3369041">:</span><span class="builtinfunc" id="3369042">len</span><span class="op" id="3369045">(</span><span class="ident" id="3369046">s</span><span class="op" id="3369047">.</span><span class="ident" id="3369048">buf</span><span class="op" id="3369051">)</span><span class="op" id="3369052">]</span><span class="op" id="3369053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369058">s</span><span class="op" id="3369059">.</span><span class="ident" id="3369060">end</span>&nbsp;<span class="op" id="3369064">+=</span>&nbsp;<span class="ident" id="3369067">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369072">if</span>&nbsp;<span class="ident" id="3369075">err</span>&nbsp;<span class="op" id="3369079">!=</span>&nbsp;<span class="ident" id="3369082">nil</span>&nbsp;<span class="op" id="3369086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369092">s</span><span class="op" id="3369093">.</span><span class="ident" id="3369094">setErr</span><span class="op" id="3369100">(</span><span class="ident" id="3369101">err</span><span class="op" id="3369104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369110">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369124">if</span>&nbsp;<span class="ident" id="3369127">n</span>&nbsp;<span class="op" id="3369129">&gt;</span>&nbsp;<span class="num" id="3369131">0</span>&nbsp;<span class="op" id="3369133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369139">s</span><span class="op" id="3369140">.</span><span class="ident" id="3369141">empties</span>&nbsp;<span class="op" id="3369149">=</span>&nbsp;<span class="num" id="3369151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369157">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369166">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369171">loop</span><span class="op" id="3369175">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369181">if</span>&nbsp;<span class="ident" id="3369184">loop</span>&nbsp;<span class="op" id="3369189">&gt;</span>&nbsp;<span class="ident" id="3369191">maxConsecutiveEmptyReads</span>&nbsp;<span class="op" id="3369216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369222">s</span><span class="op" id="3369223">.</span><span class="ident" id="3369224">setErr</span><span class="op" id="3369230">(</span><span class="ident" id="3369231">io</span><span class="op" id="3369233">.</span><span class="ident" id="3369234">ErrNoProgress</span><span class="op" id="3369247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369253">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369262">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369269">}</span><br>
<span class="lineno"></span><span class="op" id="3369271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3369274">//&nbsp;advance&nbsp;consumes&nbsp;n&nbsp;bytes&nbsp;of&nbsp;the&nbsp;buffer.&nbsp;It&nbsp;reports&nbsp;whether&nbsp;the&nbsp;advance&nbsp;was&nbsp;legal.</span><br>
<span class="lineno">200</span><span class="keyword" id="3369359">func</span>&nbsp;<span class="op" id="3369364">(</span><span class="ident" id="3369365">s</span>&nbsp;<span class="op" id="3369367">*</span><span class="ident" id="3369368">Scanner</span><span class="op" id="3369375">)</span>&nbsp;<span class="ident" id="3369377">advance</span><span class="op" id="3369384">(</span><span class="ident" id="3369385">n</span>&nbsp;<span class="builtintype" id="3369387">int</span><span class="op" id="3369390">)</span>&nbsp;<span class="builtintype" id="3369392">bool</span>&nbsp;<span class="op" id="3369397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369400">if</span>&nbsp;<span class="ident" id="3369403">n</span>&nbsp;<span class="op" id="3369405">&lt;</span>&nbsp;<span class="num" id="3369407">0</span>&nbsp;<span class="op" id="3369409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369413">s</span><span class="op" id="3369414">.</span><span class="ident" id="3369415">setErr</span><span class="op" id="3369421">(</span><span class="ident" id="3369422">ErrNegativeAdvance</span><span class="op" id="3369440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369444">return</span>&nbsp;<span class="builtintype" id="3369451">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369458">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369461">if</span>&nbsp;<span class="ident" id="3369464">n</span>&nbsp;<span class="op" id="3369466">&gt;</span>&nbsp;<span class="ident" id="3369468">s</span><span class="op" id="3369469">.</span><span class="ident" id="3369470">end</span><span class="op" id="3369473">-</span><span class="ident" id="3369474">s</span><span class="op" id="3369475">.</span><span class="ident" id="3369476">start</span>&nbsp;<span class="op" id="3369482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369486">s</span><span class="op" id="3369487">.</span><span class="ident" id="3369488">setErr</span><span class="op" id="3369494">(</span><span class="ident" id="3369495">ErrAdvanceTooFar</span><span class="op" id="3369511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369515">return</span>&nbsp;<span class="builtintype" id="3369522">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369532">s</span><span class="op" id="3369533">.</span><span class="ident" id="3369534">start</span>&nbsp;<span class="op" id="3369540">+=</span>&nbsp;<span class="ident" id="3369543">n</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369546">return</span>&nbsp;<span class="builtintype" id="3369553">true</span><br>
<span class="lineno"></span><span class="op" id="3369558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3369561">//&nbsp;setErr&nbsp;records&nbsp;the&nbsp;first&nbsp;error&nbsp;encountered.</span><br>
<span class="lineno"></span><span class="keyword" id="3369608">func</span>&nbsp;<span class="op" id="3369613">(</span><span class="ident" id="3369614">s</span>&nbsp;<span class="op" id="3369616">*</span><span class="ident" id="3369617">Scanner</span><span class="op" id="3369624">)</span>&nbsp;<span class="ident" id="3369626">setErr</span><span class="op" id="3369632">(</span><span class="ident" id="3369633">err</span>&nbsp;<span class="builtintype" id="3369637">error</span><span class="op" id="3369642">)</span>&nbsp;<span class="op" id="3369644">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3369647">if</span>&nbsp;<span class="ident" id="3369650">s</span><span class="op" id="3369651">.</span><span class="ident" id="3369652">err</span>&nbsp;<span class="op" id="3369656">==</span>&nbsp;<span class="ident" id="3369659">nil</span>&nbsp;<span class="op" id="3369663">||</span>&nbsp;<span class="ident" id="3369666">s</span><span class="op" id="3369667">.</span><span class="ident" id="3369668">err</span>&nbsp;<span class="op" id="3369672">==</span>&nbsp;<span class="ident" id="3369675">io</span><span class="op" id="3369677">.</span><span class="ident" id="3369678">EOF</span>&nbsp;<span class="op" id="3369682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369686">s</span><span class="op" id="3369687">.</span><span class="ident" id="3369688">err</span>&nbsp;<span class="op" id="3369692">=</span>&nbsp;<span class="ident" id="3369694">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3369699">}</span><br>
<span class="lineno"></span><span class="op" id="3369701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="3369704">//&nbsp;Split&nbsp;sets&nbsp;the&nbsp;split&nbsp;function&nbsp;for&nbsp;the&nbsp;Scanner.&nbsp;If&nbsp;called,&nbsp;it&nbsp;must&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="3369776">//&nbsp;called&nbsp;before&nbsp;Scan.&nbsp;The&nbsp;default&nbsp;split&nbsp;function&nbsp;is&nbsp;ScanLines.</span><br>
<span class="lineno"></span><span class="keyword" id="3369840">func</span>&nbsp;<span class="op" id="3369845">(</span><span class="ident" id="3369846">s</span>&nbsp;<span class="op" id="3369848">*</span><span class="ident" id="3369849">Scanner</span><span class="op" id="3369856">)</span>&nbsp;<span class="ident" id="3369858">Split</span><span class="op" id="3369863">(</span><span class="ident" id="3369864">split</span>&nbsp;<span class="ident" id="3369870">SplitFunc</span><span class="op" id="3369879">)</span>&nbsp;<span class="op" id="3369881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3369884">s</span><span class="op" id="3369885">.</span><span class="ident" id="3369886">split</span>&nbsp;<span class="op" id="3369892">=</span>&nbsp;<span class="ident" id="3369894">split</span><br>
<span class="lineno"></span><span class="op" id="3369900">}</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span><span class="comment" id="3369903">//&nbsp;Split&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3369923">//&nbsp;ScanBytes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;byte&nbsp;as&nbsp;a&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="3370005">func</span>&nbsp;<span class="ident" id="3370010">ScanBytes</span><span class="op" id="3370019">(</span><span class="ident" id="3370020">data</span>&nbsp;<span class="op" id="3370025">[</span><span class="op" id="3370026">]</span><span class="builtintype" id="3370027">byte</span><span class="op" id="3370031">,</span>&nbsp;<span class="ident" id="3370033">atEOF</span>&nbsp;<span class="builtintype" id="3370039">bool</span><span class="op" id="3370043">)</span>&nbsp;<span class="op" id="3370045">(</span><span class="ident" id="3370046">advance</span>&nbsp;<span class="builtintype" id="3370054">int</span><span class="op" id="3370057">,</span>&nbsp;<span class="ident" id="3370059">token</span>&nbsp;<span class="op" id="3370065">[</span><span class="op" id="3370066">]</span><span class="builtintype" id="3370067">byte</span><span class="op" id="3370071">,</span>&nbsp;<span class="ident" id="3370073">err</span>&nbsp;<span class="builtintype" id="3370077">error</span><span class="op" id="3370082">)</span>&nbsp;<span class="op" id="3370084">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370087">if</span>&nbsp;<span class="ident" id="3370090">atEOF</span>&nbsp;<span class="op" id="3370096">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3370099">len</span><span class="op" id="3370102">(</span><span class="ident" id="3370103">data</span><span class="op" id="3370107">)</span>&nbsp;<span class="op" id="3370109">==</span>&nbsp;<span class="num" id="3370112">0</span>&nbsp;<span class="op" id="3370114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370118">return</span>&nbsp;<span class="num" id="3370125">0</span><span class="op" id="3370126">,</span>&nbsp;<span class="ident" id="3370128">nil</span><span class="op" id="3370131">,</span>&nbsp;<span class="ident" id="3370133">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3370138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370141">return</span>&nbsp;<span class="num" id="3370148">1</span><span class="op" id="3370149">,</span>&nbsp;<span class="ident" id="3370151">data</span><span class="op" id="3370155">[</span><span class="num" id="3370156">0</span><span class="op" id="3370157">:</span><span class="num" id="3370158">1</span><span class="op" id="3370159">]</span><span class="op" id="3370160">,</span>&nbsp;<span class="ident" id="3370162">nil</span><br>
<span class="lineno"></span><span class="op" id="3370166">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="3370169">var</span>&nbsp;<span class="ident" id="3370173">errorRune</span>&nbsp;<span class="op" id="3370183">=</span>&nbsp;<span class="op" id="3370185">[</span><span class="op" id="3370186">]</span><span class="builtintype" id="3370187">byte</span><span class="op" id="3370191">(</span><span class="builtintype" id="3370192">string</span><span class="op" id="3370198">(</span><span class="ident" id="3370199">utf8</span><span class="op" id="3370203">.</span><span class="ident" id="3370204">RuneError</span><span class="op" id="3370213">)</span><span class="op" id="3370214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3370217">//&nbsp;ScanRunes&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3370282">//&nbsp;UTF-8-encoded&nbsp;rune&nbsp;as&nbsp;a&nbsp;token.&nbsp;The&nbsp;sequence&nbsp;of&nbsp;runes&nbsp;returned&nbsp;is</span><br>
<span class="lineno">240</span><span class="comment" id="3370350">//&nbsp;equivalent&nbsp;to&nbsp;that&nbsp;from&nbsp;a&nbsp;range&nbsp;loop&nbsp;over&nbsp;the&nbsp;input&nbsp;as&nbsp;a&nbsp;string,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3370424">//&nbsp;means&nbsp;that&nbsp;erroneous&nbsp;UTF-8&nbsp;encodings&nbsp;translate&nbsp;to&nbsp;U+FFFD&nbsp;=&nbsp;&#34;\xef\xbf\xbd&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3370502">//&nbsp;Because&nbsp;of&nbsp;the&nbsp;Scan&nbsp;interface,&nbsp;this&nbsp;makes&nbsp;it&nbsp;impossible&nbsp;for&nbsp;the&nbsp;client&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3370579">//&nbsp;distinguish&nbsp;correctly&nbsp;encoded&nbsp;replacement&nbsp;runes&nbsp;from&nbsp;encoding&nbsp;errors.</span><br>
<span class="lineno"></span><span class="keyword" id="3370652">func</span>&nbsp;<span class="ident" id="3370657">ScanRunes</span><span class="op" id="3370666">(</span><span class="ident" id="3370667">data</span>&nbsp;<span class="op" id="3370672">[</span><span class="op" id="3370673">]</span><span class="builtintype" id="3370674">byte</span><span class="op" id="3370678">,</span>&nbsp;<span class="ident" id="3370680">atEOF</span>&nbsp;<span class="builtintype" id="3370686">bool</span><span class="op" id="3370690">)</span>&nbsp;<span class="op" id="3370692">(</span><span class="ident" id="3370693">advance</span>&nbsp;<span class="builtintype" id="3370701">int</span><span class="op" id="3370704">,</span>&nbsp;<span class="ident" id="3370706">token</span>&nbsp;<span class="op" id="3370712">[</span><span class="op" id="3370713">]</span><span class="builtintype" id="3370714">byte</span><span class="op" id="3370718">,</span>&nbsp;<span class="ident" id="3370720">err</span>&nbsp;<span class="builtintype" id="3370724">error</span><span class="op" id="3370729">)</span>&nbsp;<span class="op" id="3370731">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370734">if</span>&nbsp;<span class="ident" id="3370737">atEOF</span>&nbsp;<span class="op" id="3370743">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3370746">len</span><span class="op" id="3370749">(</span><span class="ident" id="3370750">data</span><span class="op" id="3370754">)</span>&nbsp;<span class="op" id="3370756">==</span>&nbsp;<span class="num" id="3370759">0</span>&nbsp;<span class="op" id="3370761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370765">return</span>&nbsp;<span class="num" id="3370772">0</span><span class="op" id="3370773">,</span>&nbsp;<span class="ident" id="3370775">nil</span><span class="op" id="3370778">,</span>&nbsp;<span class="ident" id="3370780">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3370785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370789">//&nbsp;Fast&nbsp;path&nbsp;1:&nbsp;ASCII.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370813">if</span>&nbsp;<span class="ident" id="3370816">data</span><span class="op" id="3370820">[</span><span class="num" id="3370821">0</span><span class="op" id="3370822">]</span>&nbsp;<span class="op" id="3370824">&lt;</span>&nbsp;<span class="ident" id="3370826">utf8</span><span class="op" id="3370830">.</span><span class="ident" id="3370831">RuneSelf</span>&nbsp;<span class="op" id="3370840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370844">return</span>&nbsp;<span class="num" id="3370851">1</span><span class="op" id="3370852">,</span>&nbsp;<span class="ident" id="3370854">data</span><span class="op" id="3370858">[</span><span class="num" id="3370859">0</span><span class="op" id="3370860">:</span><span class="num" id="3370861">1</span><span class="op" id="3370862">]</span><span class="op" id="3370863">,</span>&nbsp;<span class="ident" id="3370865">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3370870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370874">//&nbsp;Fast&nbsp;path&nbsp;2:&nbsp;Correct&nbsp;UTF-8&nbsp;decode&nbsp;without&nbsp;error.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3370927">_</span><span class="op" id="3370928">,</span>&nbsp;<span class="ident" id="3370930">width</span>&nbsp;<span class="op" id="3370936">:=</span>&nbsp;<span class="ident" id="3370939">utf8</span><span class="op" id="3370943">.</span><span class="ident" id="3370944">DecodeRune</span><span class="op" id="3370954">(</span><span class="ident" id="3370955">data</span><span class="op" id="3370959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3370962">if</span>&nbsp;<span class="ident" id="3370965">width</span>&nbsp;<span class="op" id="3370971">&gt;</span>&nbsp;<span class="num" id="3370973">1</span>&nbsp;<span class="op" id="3370975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3370979">//&nbsp;It&#39;s&nbsp;a&nbsp;valid&nbsp;encoding.&nbsp;Width&nbsp;cannot&nbsp;be&nbsp;one&nbsp;for&nbsp;a&nbsp;correctly&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371051">//&nbsp;non-ASCII&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371072">return</span>&nbsp;<span class="ident" id="3371079">width</span><span class="op" id="3371084">,</span>&nbsp;<span class="ident" id="3371086">data</span><span class="op" id="3371090">[</span><span class="num" id="3371091">0</span><span class="op" id="3371092">:</span><span class="ident" id="3371093">width</span><span class="op" id="3371098">]</span><span class="op" id="3371099">,</span>&nbsp;<span class="ident" id="3371101">nil</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3371106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371110">//&nbsp;We&nbsp;know&nbsp;it&#39;s&nbsp;an&nbsp;error:&nbsp;we&nbsp;have&nbsp;width==1&nbsp;and&nbsp;implicitly&nbsp;r==utf8.RuneError.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371188">//&nbsp;Is&nbsp;the&nbsp;error&nbsp;because&nbsp;there&nbsp;wasn&#39;t&nbsp;a&nbsp;full&nbsp;rune&nbsp;to&nbsp;be&nbsp;decoded?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371253">//&nbsp;FullRune&nbsp;distinguishes&nbsp;correctly&nbsp;between&nbsp;erroneous&nbsp;and&nbsp;incomplete&nbsp;encodings.</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371334">if</span>&nbsp;<span class="op" id="3371337">!</span><span class="ident" id="3371338">atEOF</span>&nbsp;<span class="op" id="3371344">&amp;&amp;</span>&nbsp;<span class="op" id="3371347">!</span><span class="ident" id="3371348">utf8</span><span class="op" id="3371352">.</span><span class="ident" id="3371353">FullRune</span><span class="op" id="3371361">(</span><span class="ident" id="3371362">data</span><span class="op" id="3371366">)</span>&nbsp;<span class="op" id="3371368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371372">//&nbsp;Incomplete;&nbsp;get&nbsp;more&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371405">return</span>&nbsp;<span class="num" id="3371412">0</span><span class="op" id="3371413">,</span>&nbsp;<span class="ident" id="3371415">nil</span><span class="op" id="3371418">,</span>&nbsp;<span class="ident" id="3371420">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3371425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371429">//&nbsp;We&nbsp;have&nbsp;a&nbsp;real&nbsp;UTF-8&nbsp;encoding&nbsp;error.&nbsp;Return&nbsp;a&nbsp;properly&nbsp;encoded&nbsp;error&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371507">//&nbsp;but&nbsp;advance&nbsp;only&nbsp;one&nbsp;byte.&nbsp;This&nbsp;matches&nbsp;the&nbsp;behavior&nbsp;of&nbsp;a&nbsp;range&nbsp;loop&nbsp;over</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3371585">//&nbsp;an&nbsp;incorrectly&nbsp;encoded&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371620">return</span>&nbsp;<span class="num" id="3371627">1</span><span class="op" id="3371628">,</span>&nbsp;<span class="ident" id="3371630">errorRune</span><span class="op" id="3371639">,</span>&nbsp;<span class="ident" id="3371641">nil</span><br>
<span class="lineno"></span><span class="op" id="3371645">}</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span><span class="comment" id="3371648">//&nbsp;dropCR&nbsp;drops&nbsp;a&nbsp;terminal&nbsp;\r&nbsp;from&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3371693">func</span>&nbsp;<span class="ident" id="3371698">dropCR</span><span class="op" id="3371704">(</span><span class="ident" id="3371705">data</span>&nbsp;<span class="op" id="3371710">[</span><span class="op" id="3371711">]</span><span class="builtintype" id="3371712">byte</span><span class="op" id="3371716">)</span>&nbsp;<span class="op" id="3371718">[</span><span class="op" id="3371719">]</span><span class="builtintype" id="3371720">byte</span>&nbsp;<span class="op" id="3371725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371728">if</span>&nbsp;<span class="builtinfunc" id="3371731">len</span><span class="op" id="3371734">(</span><span class="ident" id="3371735">data</span><span class="op" id="3371739">)</span>&nbsp;<span class="op" id="3371741">&gt;</span>&nbsp;<span class="num" id="3371743">0</span>&nbsp;<span class="op" id="3371745">&amp;&amp;</span>&nbsp;<span class="ident" id="3371748">data</span><span class="op" id="3371752">[</span><span class="builtinfunc" id="3371753">len</span><span class="op" id="3371756">(</span><span class="ident" id="3371757">data</span><span class="op" id="3371761">)</span><span class="op" id="3371762">-</span><span class="num" id="3371763">1</span><span class="op" id="3371764">]</span>&nbsp;<span class="op" id="3371766">==</span>&nbsp;<span class="string" id="3371769">&#39;\r&#39;</span>&nbsp;<span class="op" id="3371774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371778">return</span>&nbsp;<span class="ident" id="3371785">data</span><span class="op" id="3371789">[</span><span class="num" id="3371790">0</span>&nbsp;<span class="op" id="3371792">:</span>&nbsp;<span class="builtinfunc" id="3371794">len</span><span class="op" id="3371797">(</span><span class="ident" id="3371798">data</span><span class="op" id="3371802">)</span><span class="op" id="3371803">-</span><span class="num" id="3371804">1</span><span class="op" id="3371805">]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3371808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3371811">return</span>&nbsp;<span class="ident" id="3371818">data</span><br>
<span class="lineno"></span><span class="op" id="3371823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3371826">//&nbsp;ScanLines&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each&nbsp;line&nbsp;of</span><br>
<span class="lineno">285</span><span class="comment" id="3371899">//&nbsp;text,&nbsp;stripped&nbsp;of&nbsp;any&nbsp;trailing&nbsp;end-of-line&nbsp;marker.&nbsp;The&nbsp;returned&nbsp;line&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="3371975">//&nbsp;be&nbsp;empty.&nbsp;The&nbsp;end-of-line&nbsp;marker&nbsp;is&nbsp;one&nbsp;optional&nbsp;carriage&nbsp;return&nbsp;followed</span><br>
<span class="lineno"></span><span class="comment" id="3372052">//&nbsp;by&nbsp;one&nbsp;mandatory&nbsp;newline.&nbsp;In&nbsp;regular&nbsp;expression&nbsp;notation,&nbsp;it&nbsp;is&nbsp;`\r?\n`.</span><br>
<span class="lineno"></span><span class="comment" id="3372128">//&nbsp;The&nbsp;last&nbsp;non-empty&nbsp;line&nbsp;of&nbsp;input&nbsp;will&nbsp;be&nbsp;returned&nbsp;even&nbsp;if&nbsp;it&nbsp;has&nbsp;no</span><br>
<span class="lineno"></span><span class="comment" id="3372199">//&nbsp;newline.</span><br>
<span class="lineno">290</span><span class="keyword" id="3372211">func</span>&nbsp;<span class="ident" id="3372216">ScanLines</span><span class="op" id="3372225">(</span><span class="ident" id="3372226">data</span>&nbsp;<span class="op" id="3372231">[</span><span class="op" id="3372232">]</span><span class="builtintype" id="3372233">byte</span><span class="op" id="3372237">,</span>&nbsp;<span class="ident" id="3372239">atEOF</span>&nbsp;<span class="builtintype" id="3372245">bool</span><span class="op" id="3372249">)</span>&nbsp;<span class="op" id="3372251">(</span><span class="ident" id="3372252">advance</span>&nbsp;<span class="builtintype" id="3372260">int</span><span class="op" id="3372263">,</span>&nbsp;<span class="ident" id="3372265">token</span>&nbsp;<span class="op" id="3372271">[</span><span class="op" id="3372272">]</span><span class="builtintype" id="3372273">byte</span><span class="op" id="3372277">,</span>&nbsp;<span class="ident" id="3372279">err</span>&nbsp;<span class="builtintype" id="3372283">error</span><span class="op" id="3372288">)</span>&nbsp;<span class="op" id="3372290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372293">if</span>&nbsp;<span class="ident" id="3372296">atEOF</span>&nbsp;<span class="op" id="3372302">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3372305">len</span><span class="op" id="3372308">(</span><span class="ident" id="3372309">data</span><span class="op" id="3372313">)</span>&nbsp;<span class="op" id="3372315">==</span>&nbsp;<span class="num" id="3372318">0</span>&nbsp;<span class="op" id="3372320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372324">return</span>&nbsp;<span class="num" id="3372331">0</span><span class="op" id="3372332">,</span>&nbsp;<span class="ident" id="3372334">nil</span><span class="op" id="3372337">,</span>&nbsp;<span class="ident" id="3372339">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3372344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372347">if</span>&nbsp;<span class="ident" id="3372350">i</span>&nbsp;<span class="op" id="3372352">:=</span>&nbsp;<span class="ident" id="3372355">bytes</span><span class="op" id="3372360">.</span><span class="ident" id="3372361">IndexByte</span><span class="op" id="3372370">(</span><span class="ident" id="3372371">data</span><span class="op" id="3372375">,</span>&nbsp;<span class="string" id="3372377">&#39;\n&#39;</span><span class="op" id="3372381">)</span><span class="op" id="3372382">;</span>&nbsp;<span class="ident" id="3372384">i</span>&nbsp;<span class="op" id="3372386">&gt;=</span>&nbsp;<span class="num" id="3372389">0</span>&nbsp;<span class="op" id="3372391">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372395">//&nbsp;We&nbsp;have&nbsp;a&nbsp;full&nbsp;newline-terminated&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372440">return</span>&nbsp;<span class="ident" id="3372447">i</span>&nbsp;<span class="op" id="3372449">+</span>&nbsp;<span class="num" id="3372451">1</span><span class="op" id="3372452">,</span>&nbsp;<span class="ident" id="3372454">dropCR</span><span class="op" id="3372460">(</span><span class="ident" id="3372461">data</span><span class="op" id="3372465">[</span><span class="num" id="3372466">0</span><span class="op" id="3372467">:</span><span class="ident" id="3372468">i</span><span class="op" id="3372469">]</span><span class="op" id="3372470">)</span><span class="op" id="3372471">,</span>&nbsp;<span class="ident" id="3372473">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3372478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372481">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-terminated&nbsp;line.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372551">if</span>&nbsp;<span class="ident" id="3372554">atEOF</span>&nbsp;<span class="op" id="3372560">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372564">return</span>&nbsp;<span class="builtinfunc" id="3372571">len</span><span class="op" id="3372574">(</span><span class="ident" id="3372575">data</span><span class="op" id="3372579">)</span><span class="op" id="3372580">,</span>&nbsp;<span class="ident" id="3372582">dropCR</span><span class="op" id="3372588">(</span><span class="ident" id="3372589">data</span><span class="op" id="3372593">)</span><span class="op" id="3372594">,</span>&nbsp;<span class="ident" id="3372596">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3372601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372604">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372627">return</span>&nbsp;<span class="num" id="3372634">0</span><span class="op" id="3372635">,</span>&nbsp;<span class="ident" id="3372637">nil</span><span class="op" id="3372640">,</span>&nbsp;<span class="ident" id="3372642">nil</span><br>
<span class="lineno"></span><span class="op" id="3372646">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="comment" id="3372649">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;the&nbsp;character&nbsp;is&nbsp;a&nbsp;Unicode&nbsp;white&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="3372726">//&nbsp;We&nbsp;avoid&nbsp;dependency&nbsp;on&nbsp;the&nbsp;unicode&nbsp;package,&nbsp;but&nbsp;check&nbsp;validity&nbsp;of&nbsp;the&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3372814">//&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno"></span><span class="keyword" id="3372831">func</span>&nbsp;<span class="ident" id="3372836">isSpace</span><span class="op" id="3372843">(</span><span class="ident" id="3372844">r</span>&nbsp;<span class="builtintype" id="3372846">rune</span><span class="op" id="3372850">)</span>&nbsp;<span class="builtintype" id="3372852">bool</span>&nbsp;<span class="op" id="3372857">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372860">if</span>&nbsp;<span class="ident" id="3372863">r</span>&nbsp;<span class="op" id="3372865">&lt;=</span>&nbsp;<span class="string" id="3372868">&#39;\u00FF&#39;</span>&nbsp;<span class="op" id="3372877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3372881">//&nbsp;Obvious&nbsp;ASCII&nbsp;ones:&nbsp;\t&nbsp;through&nbsp;\r&nbsp;plus&nbsp;space.&nbsp;Plus&nbsp;two&nbsp;Latin-1&nbsp;oddballs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372959">switch</span>&nbsp;<span class="ident" id="3372966">r</span>&nbsp;<span class="op" id="3372968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3372972">case</span>&nbsp;<span class="string" id="3372977">&#39;&nbsp;&#39;</span><span class="op" id="3372980">,</span>&nbsp;<span class="string" id="3372982">&#39;\t&#39;</span><span class="op" id="3372986">,</span>&nbsp;<span class="string" id="3372988">&#39;\n&#39;</span><span class="op" id="3372992">,</span>&nbsp;<span class="string" id="3372994">&#39;\v&#39;</span><span class="op" id="3372998">,</span>&nbsp;<span class="string" id="3373000">&#39;\f&#39;</span><span class="op" id="3373004">,</span>&nbsp;<span class="string" id="3373006">&#39;\r&#39;</span><span class="op" id="3373010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373015">return</span>&nbsp;<span class="builtintype" id="3373022">true</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373029">case</span>&nbsp;<span class="string" id="3373034">&#39;\u0085&#39;</span><span class="op" id="3373042">,</span>&nbsp;<span class="string" id="3373044">&#39;\u00A0&#39;</span><span class="op" id="3373052">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373057">return</span>&nbsp;<span class="builtintype" id="3373064">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373075">return</span>&nbsp;<span class="builtintype" id="3373082">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373089">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3373092">//&nbsp;High-valued&nbsp;ones.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373114">if</span>&nbsp;<span class="string" id="3373117">&#39;\u2000&#39;</span>&nbsp;<span class="op" id="3373126">&lt;=</span>&nbsp;<span class="ident" id="3373129">r</span>&nbsp;<span class="op" id="3373131">&amp;&amp;</span>&nbsp;<span class="ident" id="3373134">r</span>&nbsp;<span class="op" id="3373136">&lt;=</span>&nbsp;<span class="string" id="3373139">&#39;\u200a&#39;</span>&nbsp;<span class="op" id="3373148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373152">return</span>&nbsp;<span class="builtintype" id="3373159">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373168">switch</span>&nbsp;<span class="ident" id="3373175">r</span>&nbsp;<span class="op" id="3373177">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373180">case</span>&nbsp;<span class="string" id="3373185">&#39;\u1680&#39;</span><span class="op" id="3373193">,</span>&nbsp;<span class="string" id="3373195">&#39;\u2028&#39;</span><span class="op" id="3373203">,</span>&nbsp;<span class="string" id="3373205">&#39;\u2029&#39;</span><span class="op" id="3373213">,</span>&nbsp;<span class="string" id="3373215">&#39;\u202f&#39;</span><span class="op" id="3373223">,</span>&nbsp;<span class="string" id="3373225">&#39;\u205f&#39;</span><span class="op" id="3373233">,</span>&nbsp;<span class="string" id="3373235">&#39;\u3000&#39;</span><span class="op" id="3373243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373247">return</span>&nbsp;<span class="builtintype" id="3373254">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373263">return</span>&nbsp;<span class="builtintype" id="3373270">false</span><br>
<span class="lineno"></span><span class="op" id="3373276">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3373279">//&nbsp;ScanWords&nbsp;is&nbsp;a&nbsp;split&nbsp;function&nbsp;for&nbsp;a&nbsp;Scanner&nbsp;that&nbsp;returns&nbsp;each</span><br>
<span class="lineno"></span><span class="comment" id="3373344">//&nbsp;space-separated&nbsp;word&nbsp;of&nbsp;text,&nbsp;with&nbsp;surrounding&nbsp;spaces&nbsp;deleted.&nbsp;It&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3373418">//&nbsp;never&nbsp;return&nbsp;an&nbsp;empty&nbsp;string.&nbsp;The&nbsp;definition&nbsp;of&nbsp;space&nbsp;is&nbsp;set&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3373485">//&nbsp;unicode.IsSpace.</span><br>
<span class="lineno">335</span><span class="keyword" id="3373505">func</span>&nbsp;<span class="ident" id="3373510">ScanWords</span><span class="op" id="3373519">(</span><span class="ident" id="3373520">data</span>&nbsp;<span class="op" id="3373525">[</span><span class="op" id="3373526">]</span><span class="builtintype" id="3373527">byte</span><span class="op" id="3373531">,</span>&nbsp;<span class="ident" id="3373533">atEOF</span>&nbsp;<span class="builtintype" id="3373539">bool</span><span class="op" id="3373543">)</span>&nbsp;<span class="op" id="3373545">(</span><span class="ident" id="3373546">advance</span>&nbsp;<span class="builtintype" id="3373554">int</span><span class="op" id="3373557">,</span>&nbsp;<span class="ident" id="3373559">token</span>&nbsp;<span class="op" id="3373565">[</span><span class="op" id="3373566">]</span><span class="builtintype" id="3373567">byte</span><span class="op" id="3373571">,</span>&nbsp;<span class="ident" id="3373573">err</span>&nbsp;<span class="builtintype" id="3373577">error</span><span class="op" id="3373582">)</span>&nbsp;<span class="op" id="3373584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3373587">//&nbsp;Skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373612">start</span>&nbsp;<span class="op" id="3373618">:=</span>&nbsp;<span class="num" id="3373621">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373624">for</span>&nbsp;<span class="ident" id="3373628">width</span>&nbsp;<span class="op" id="3373634">:=</span>&nbsp;<span class="num" id="3373637">0</span><span class="op" id="3373638">;</span>&nbsp;<span class="ident" id="3373640">start</span>&nbsp;<span class="op" id="3373646">&lt;</span>&nbsp;<span class="builtinfunc" id="3373648">len</span><span class="op" id="3373651">(</span><span class="ident" id="3373652">data</span><span class="op" id="3373656">)</span><span class="op" id="3373657">;</span>&nbsp;<span class="ident" id="3373659">start</span>&nbsp;<span class="op" id="3373665">+=</span>&nbsp;<span class="ident" id="3373668">width</span>&nbsp;<span class="op" id="3373674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373678">var</span>&nbsp;<span class="ident" id="3373682">r</span>&nbsp;<span class="builtintype" id="3373684">rune</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373691">r</span><span class="op" id="3373692">,</span>&nbsp;<span class="ident" id="3373694">width</span>&nbsp;<span class="op" id="3373700">=</span>&nbsp;<span class="ident" id="3373702">utf8</span><span class="op" id="3373706">.</span><span class="ident" id="3373707">DecodeRune</span><span class="op" id="3373717">(</span><span class="ident" id="3373718">data</span><span class="op" id="3373722">[</span><span class="ident" id="3373723">start</span><span class="op" id="3373728">:</span><span class="op" id="3373729">]</span><span class="op" id="3373730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373734">if</span>&nbsp;<span class="op" id="3373737">!</span><span class="ident" id="3373738">isSpace</span><span class="op" id="3373745">(</span><span class="ident" id="3373746">r</span><span class="op" id="3373747">)</span>&nbsp;<span class="op" id="3373749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373754">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373765">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3373768">//&nbsp;Scan&nbsp;until&nbsp;space,&nbsp;marking&nbsp;end&nbsp;of&nbsp;word.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373811">for</span>&nbsp;<span class="ident" id="3373815">width</span><span class="op" id="3373820">,</span>&nbsp;<span class="ident" id="3373822">i</span>&nbsp;<span class="op" id="3373824">:=</span>&nbsp;<span class="num" id="3373827">0</span><span class="op" id="3373828">,</span>&nbsp;<span class="ident" id="3373830">start</span><span class="op" id="3373835">;</span>&nbsp;<span class="ident" id="3373837">i</span>&nbsp;<span class="op" id="3373839">&lt;</span>&nbsp;<span class="builtinfunc" id="3373841">len</span><span class="op" id="3373844">(</span><span class="ident" id="3373845">data</span><span class="op" id="3373849">)</span><span class="op" id="3373850">;</span>&nbsp;<span class="ident" id="3373852">i</span>&nbsp;<span class="op" id="3373854">+=</span>&nbsp;<span class="ident" id="3373857">width</span>&nbsp;<span class="op" id="3373863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373867">var</span>&nbsp;<span class="ident" id="3373871">r</span>&nbsp;<span class="builtintype" id="3373873">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3373880">r</span><span class="op" id="3373881">,</span>&nbsp;<span class="ident" id="3373883">width</span>&nbsp;<span class="op" id="3373889">=</span>&nbsp;<span class="ident" id="3373891">utf8</span><span class="op" id="3373895">.</span><span class="ident" id="3373896">DecodeRune</span><span class="op" id="3373906">(</span><span class="ident" id="3373907">data</span><span class="op" id="3373911">[</span><span class="ident" id="3373912">i</span><span class="op" id="3373913">:</span><span class="op" id="3373914">]</span><span class="op" id="3373915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373919">if</span>&nbsp;<span class="ident" id="3373922">isSpace</span><span class="op" id="3373929">(</span><span class="ident" id="3373930">r</span><span class="op" id="3373931">)</span>&nbsp;<span class="op" id="3373933">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3373938">return</span>&nbsp;<span class="ident" id="3373945">i</span>&nbsp;<span class="op" id="3373947">+</span>&nbsp;<span class="ident" id="3373949">width</span><span class="op" id="3373954">,</span>&nbsp;<span class="ident" id="3373956">data</span><span class="op" id="3373960">[</span><span class="ident" id="3373961">start</span><span class="op" id="3373966">:</span><span class="ident" id="3373967">i</span><span class="op" id="3373968">]</span><span class="op" id="3373969">,</span>&nbsp;<span class="ident" id="3373971">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3373980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3373983">//&nbsp;If&nbsp;we&#39;re&nbsp;at&nbsp;EOF,&nbsp;we&nbsp;have&nbsp;a&nbsp;final,&nbsp;non-empty,&nbsp;non-terminated&nbsp;word.&nbsp;Return&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374064">if</span>&nbsp;<span class="ident" id="3374067">atEOF</span>&nbsp;<span class="op" id="3374073">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3374076">len</span><span class="op" id="3374079">(</span><span class="ident" id="3374080">data</span><span class="op" id="3374084">)</span>&nbsp;<span class="op" id="3374086">&gt;</span>&nbsp;<span class="ident" id="3374088">start</span>&nbsp;<span class="op" id="3374094">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374098">return</span>&nbsp;<span class="builtinfunc" id="3374105">len</span><span class="op" id="3374108">(</span><span class="ident" id="3374109">data</span><span class="op" id="3374113">)</span><span class="op" id="3374114">,</span>&nbsp;<span class="ident" id="3374116">data</span><span class="op" id="3374120">[</span><span class="ident" id="3374121">start</span><span class="op" id="3374126">:</span><span class="op" id="3374127">]</span><span class="op" id="3374128">,</span>&nbsp;<span class="ident" id="3374130">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3374135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3374138">//&nbsp;Request&nbsp;more&nbsp;data.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3374161">return</span>&nbsp;<span class="ident" id="3374168">start</span><span class="op" id="3374173">,</span>&nbsp;<span class="ident" id="3374175">nil</span><span class="op" id="3374178">,</span>&nbsp;<span class="ident" id="3374180">nil</span><br>
<span class="lineno"></span><span class="op" id="3374184">}</span>
</div>
</body>
</html>
