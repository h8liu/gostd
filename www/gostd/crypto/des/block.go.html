<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3874300">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3874355">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3874409">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3874460">package</span>&nbsp;<span class="ident" id="3874468">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3874473">import</span>&nbsp;<span class="op" id="3874480">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3874483">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="3874501">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3874504">func</span>&nbsp;<span class="ident" id="3874509">cryptBlock</span><span class="op" id="3874519">(</span><span class="ident" id="3874520">subkeys</span>&nbsp;<span class="op" id="3874528">[</span><span class="op" id="3874529">]</span><span class="ident" id="3874530">uint64</span><span class="op" id="3874536">,</span>&nbsp;<span class="ident" id="3874538">dst</span><span class="op" id="3874541">,</span>&nbsp;<span class="ident" id="3874543">src</span>&nbsp;<span class="op" id="3874547">[</span><span class="op" id="3874548">]</span><span class="builtintype" id="3874549">byte</span><span class="op" id="3874553">,</span>&nbsp;<span class="ident" id="3874555">decrypt</span>&nbsp;<span class="builtintype" id="3874563">bool</span><span class="op" id="3874567">)</span>&nbsp;<span class="op" id="3874569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874572">b</span>&nbsp;<span class="op" id="3874574">:=</span>&nbsp;<span class="ident" id="3874577">binary</span><span class="op" id="3874583">.</span><span class="ident" id="3874584">BigEndian</span><span class="op" id="3874593">.</span><span class="ident" id="3874594">Uint64</span><span class="op" id="3874600">(</span><span class="ident" id="3874601">src</span><span class="op" id="3874604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874607">b</span>&nbsp;<span class="op" id="3874609">=</span>&nbsp;<span class="ident" id="3874611">permuteInitialBlock</span><span class="op" id="3874630">(</span><span class="ident" id="3874631">b</span><span class="op" id="3874632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874635">left</span><span class="op" id="3874639">,</span>&nbsp;<span class="ident" id="3874641">right</span>&nbsp;<span class="op" id="3874647">:=</span>&nbsp;<span class="builtintype" id="3874650">uint32</span><span class="op" id="3874656">(</span><span class="ident" id="3874657">b</span><span class="op" id="3874658">&gt;&gt;</span><span class="num" id="3874660">32</span><span class="op" id="3874662">)</span><span class="op" id="3874663">,</span>&nbsp;<span class="builtintype" id="3874665">uint32</span><span class="op" id="3874671">(</span><span class="ident" id="3874672">b</span><span class="op" id="3874673">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874677">var</span>&nbsp;<span class="ident" id="3874681">subkey</span>&nbsp;<span class="ident" id="3874688">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874696">for</span>&nbsp;<span class="ident" id="3874700">i</span>&nbsp;<span class="op" id="3874702">:=</span>&nbsp;<span class="num" id="3874705">0</span><span class="op" id="3874706">;</span>&nbsp;<span class="ident" id="3874708">i</span>&nbsp;<span class="op" id="3874710">&lt;</span>&nbsp;<span class="num" id="3874712">16</span><span class="op" id="3874714">;</span>&nbsp;<span class="ident" id="3874716">i</span><span class="op" id="3874717">++</span>&nbsp;<span class="op" id="3874720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3874724">if</span>&nbsp;<span class="ident" id="3874727">decrypt</span>&nbsp;<span class="op" id="3874735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874740">subkey</span>&nbsp;<span class="op" id="3874747">=</span>&nbsp;<span class="ident" id="3874749">subkeys</span><span class="op" id="3874756">[</span><span class="num" id="3874757">15</span><span class="op" id="3874759">-</span><span class="ident" id="3874760">i</span><span class="op" id="3874761">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874765">}</span>&nbsp;<span class="keyword" id="3874767">else</span>&nbsp;<span class="op" id="3874772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874777">subkey</span>&nbsp;<span class="op" id="3874784">=</span>&nbsp;<span class="ident" id="3874786">subkeys</span><span class="op" id="3874793">[</span><span class="ident" id="3874794">i</span><span class="op" id="3874795">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874804">left</span><span class="op" id="3874808">,</span>&nbsp;<span class="ident" id="3874810">right</span>&nbsp;<span class="op" id="3874816">=</span>&nbsp;<span class="ident" id="3874818">right</span><span class="op" id="3874823">,</span>&nbsp;<span class="ident" id="3874825">left</span><span class="op" id="3874829">^</span><span class="ident" id="3874830">feistel</span><span class="op" id="3874837">(</span><span class="ident" id="3874838">right</span><span class="op" id="3874843">,</span>&nbsp;<span class="ident" id="3874845">subkey</span><span class="op" id="3874851">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3874854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3874857">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874911">preOutput</span>&nbsp;<span class="op" id="3874921">:=</span>&nbsp;<span class="op" id="3874924">(</span><span class="ident" id="3874925">uint64</span><span class="op" id="3874931">(</span><span class="ident" id="3874932">right</span><span class="op" id="3874937">)</span>&nbsp;<span class="op" id="3874939">&lt;&lt;</span>&nbsp;<span class="num" id="3874942">32</span><span class="op" id="3874944">)</span>&nbsp;<span class="op" id="3874946">|</span>&nbsp;<span class="ident" id="3874948">uint64</span><span class="op" id="3874954">(</span><span class="ident" id="3874955">left</span><span class="op" id="3874959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3874962">binary</span><span class="op" id="3874968">.</span><span class="ident" id="3874969">BigEndian</span><span class="op" id="3874978">.</span><span class="ident" id="3874979">PutUint64</span><span class="op" id="3874988">(</span><span class="ident" id="3874989">dst</span><span class="op" id="3874992">,</span>&nbsp;<span class="ident" id="3874994">permuteFinalBlock</span><span class="op" id="3875011">(</span><span class="ident" id="3875012">preOutput</span><span class="op" id="3875021">)</span><span class="op" id="3875022">)</span><br>
<span class="lineno"></span><span class="op" id="3875024">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3875027">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3875086">func</span>&nbsp;<span class="ident" id="3875091">encryptBlock</span><span class="op" id="3875103">(</span><span class="ident" id="3875104">subkeys</span>&nbsp;<span class="op" id="3875112">[</span><span class="op" id="3875113">]</span><span class="ident" id="3875114">uint64</span><span class="op" id="3875120">,</span>&nbsp;<span class="ident" id="3875122">dst</span><span class="op" id="3875125">,</span>&nbsp;<span class="ident" id="3875127">src</span>&nbsp;<span class="op" id="3875131">[</span><span class="op" id="3875132">]</span><span class="builtintype" id="3875133">byte</span><span class="op" id="3875137">)</span>&nbsp;<span class="op" id="3875139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875142">cryptBlock</span><span class="op" id="3875152">(</span><span class="ident" id="3875153">subkeys</span><span class="op" id="3875160">,</span>&nbsp;<span class="ident" id="3875162">dst</span><span class="op" id="3875165">,</span>&nbsp;<span class="ident" id="3875167">src</span><span class="op" id="3875170">,</span>&nbsp;<span class="builtintype" id="3875172">false</span><span class="op" id="3875177">)</span><br>
<span class="lineno"></span><span class="op" id="3875179">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3875182">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="3875241">func</span>&nbsp;<span class="ident" id="3875246">decryptBlock</span><span class="op" id="3875258">(</span><span class="ident" id="3875259">subkeys</span>&nbsp;<span class="op" id="3875267">[</span><span class="op" id="3875268">]</span><span class="ident" id="3875269">uint64</span><span class="op" id="3875275">,</span>&nbsp;<span class="ident" id="3875277">dst</span><span class="op" id="3875280">,</span>&nbsp;<span class="ident" id="3875282">src</span>&nbsp;<span class="op" id="3875286">[</span><span class="op" id="3875287">]</span><span class="builtintype" id="3875288">byte</span><span class="op" id="3875292">)</span>&nbsp;<span class="op" id="3875294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875297">cryptBlock</span><span class="op" id="3875307">(</span><span class="ident" id="3875308">subkeys</span><span class="op" id="3875315">,</span>&nbsp;<span class="ident" id="3875317">dst</span><span class="op" id="3875320">,</span>&nbsp;<span class="ident" id="3875322">src</span><span class="op" id="3875325">,</span>&nbsp;<span class="builtintype" id="3875327">true</span><span class="op" id="3875331">)</span><br>
<span class="lineno"></span><span class="op" id="3875333">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="3875336">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="3875360">func</span>&nbsp;<span class="ident" id="3875365">feistel</span><span class="op" id="3875372">(</span><span class="ident" id="3875373">right</span>&nbsp;<span class="builtintype" id="3875379">uint32</span><span class="op" id="3875385">,</span>&nbsp;<span class="ident" id="3875387">key</span>&nbsp;<span class="ident" id="3875391">uint64</span><span class="op" id="3875397">)</span>&nbsp;<span class="op" id="3875399">(</span><span class="ident" id="3875400">result</span>&nbsp;<span class="builtintype" id="3875407">uint32</span><span class="op" id="3875413">)</span>&nbsp;<span class="op" id="3875415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875418">sBoxLocations</span>&nbsp;<span class="op" id="3875432">:=</span>&nbsp;<span class="ident" id="3875435">key</span>&nbsp;<span class="op" id="3875439">^</span>&nbsp;<span class="ident" id="3875441">expandBlock</span><span class="op" id="3875452">(</span><span class="ident" id="3875453">right</span><span class="op" id="3875458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875461">var</span>&nbsp;<span class="ident" id="3875465">sBoxResult</span>&nbsp;<span class="builtintype" id="3875476">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875484">for</span>&nbsp;<span class="ident" id="3875488">i</span>&nbsp;<span class="op" id="3875490">:=</span>&nbsp;<span class="builtintype" id="3875493">uint8</span><span class="op" id="3875498">(</span><span class="num" id="3875499">0</span><span class="op" id="3875500">)</span><span class="op" id="3875501">;</span>&nbsp;<span class="ident" id="3875503">i</span>&nbsp;<span class="op" id="3875505">&lt;</span>&nbsp;<span class="num" id="3875507">8</span><span class="op" id="3875508">;</span>&nbsp;<span class="ident" id="3875510">i</span><span class="op" id="3875511">++</span>&nbsp;<span class="op" id="3875514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875518">sBoxLocation</span>&nbsp;<span class="op" id="3875531">:=</span>&nbsp;<span class="builtintype" id="3875534">uint8</span><span class="op" id="3875539">(</span><span class="ident" id="3875540">sBoxLocations</span><span class="op" id="3875553">&gt;&gt;</span><span class="num" id="3875555">42</span><span class="op" id="3875557">)</span>&nbsp;<span class="op" id="3875559">&amp;</span>&nbsp;<span class="num" id="3875561">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875568">sBoxLocations</span>&nbsp;<span class="op" id="3875582">&lt;&lt;=</span>&nbsp;<span class="num" id="3875586">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3875590">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3875629">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875661">row</span>&nbsp;<span class="op" id="3875665">:=</span>&nbsp;<span class="op" id="3875668">(</span><span class="ident" id="3875669">sBoxLocation</span>&nbsp;<span class="op" id="3875682">&amp;</span>&nbsp;<span class="num" id="3875684">0x1</span><span class="op" id="3875687">)</span>&nbsp;<span class="op" id="3875689">|</span>&nbsp;<span class="op" id="3875691">(</span><span class="op" id="3875692">(</span><span class="ident" id="3875693">sBoxLocation</span>&nbsp;<span class="op" id="3875706">&amp;</span>&nbsp;<span class="num" id="3875708">0x20</span><span class="op" id="3875712">)</span>&nbsp;<span class="op" id="3875714">&gt;&gt;</span>&nbsp;<span class="num" id="3875717">4</span><span class="op" id="3875718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875722">column</span>&nbsp;<span class="op" id="3875729">:=</span>&nbsp;<span class="op" id="3875732">(</span><span class="ident" id="3875733">sBoxLocation</span>&nbsp;<span class="op" id="3875746">&gt;&gt;</span>&nbsp;<span class="num" id="3875749">1</span><span class="op" id="3875750">)</span>&nbsp;<span class="op" id="3875752">&amp;</span>&nbsp;<span class="num" id="3875754">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3875760">sBoxResult</span>&nbsp;<span class="op" id="3875771">^=</span>&nbsp;<span class="ident" id="3875774">feistelBox</span><span class="op" id="3875784">[</span><span class="ident" id="3875785">i</span><span class="op" id="3875786">]</span><span class="op" id="3875787">[</span><span class="num" id="3875788">16</span><span class="op" id="3875790">*</span><span class="ident" id="3875791">row</span><span class="op" id="3875794">+</span><span class="ident" id="3875795">column</span><span class="op" id="3875801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3875804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3875807">return</span>&nbsp;<span class="ident" id="3875814">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="3875825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3875828">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="3875896">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="3875930">var</span>&nbsp;<span class="ident" id="3875934">feistelBox</span>&nbsp;<span class="op" id="3875945">[</span><span class="num" id="3875946">8</span><span class="op" id="3875947">]</span><span class="op" id="3875948">[</span><span class="num" id="3875949">64</span><span class="op" id="3875951">]</span><span class="builtintype" id="3875952">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="3875960">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="3876022">func</span>&nbsp;<span class="ident" id="3876027">permuteBlock</span><span class="op" id="3876039">(</span><span class="ident" id="3876040">src</span>&nbsp;<span class="ident" id="3876044">uint64</span><span class="op" id="3876050">,</span>&nbsp;<span class="ident" id="3876052">permutation</span>&nbsp;<span class="op" id="3876064">[</span><span class="op" id="3876065">]</span><span class="builtintype" id="3876066">uint8</span><span class="op" id="3876071">)</span>&nbsp;<span class="op" id="3876073">(</span><span class="ident" id="3876074">block</span>&nbsp;<span class="ident" id="3876080">uint64</span><span class="op" id="3876086">)</span>&nbsp;<span class="op" id="3876088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876091">for</span>&nbsp;<span class="ident" id="3876095">position</span><span class="op" id="3876103">,</span>&nbsp;<span class="ident" id="3876105">n</span>&nbsp;<span class="op" id="3876107">:=</span>&nbsp;<span class="keyword" id="3876110">range</span>&nbsp;<span class="ident" id="3876116">permutation</span>&nbsp;<span class="op" id="3876128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876132">bit</span>&nbsp;<span class="op" id="3876136">:=</span>&nbsp;<span class="op" id="3876139">(</span><span class="ident" id="3876140">src</span>&nbsp;<span class="op" id="3876144">&gt;&gt;</span>&nbsp;<span class="ident" id="3876147">n</span><span class="op" id="3876148">)</span>&nbsp;<span class="op" id="3876150">&amp;</span>&nbsp;<span class="num" id="3876152">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876156">block</span>&nbsp;<span class="op" id="3876162">|=</span>&nbsp;<span class="ident" id="3876165">bit</span>&nbsp;<span class="op" id="3876169">&lt;&lt;</span>&nbsp;<span class="builtintype" id="3876172">uint</span><span class="op" id="3876176">(</span><span class="op" id="3876177">(</span><span class="builtinfunc" id="3876178">len</span><span class="op" id="3876181">(</span><span class="ident" id="3876182">permutation</span><span class="op" id="3876193">)</span><span class="op" id="3876194">-</span><span class="num" id="3876195">1</span><span class="op" id="3876196">)</span><span class="op" id="3876197">-</span><span class="ident" id="3876198">position</span><span class="op" id="3876206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876212">return</span><br>
<span class="lineno"></span><span class="op" id="3876219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="3876222">func</span>&nbsp;<span class="ident" id="3876227">init</span><span class="op" id="3876231">(</span><span class="op" id="3876232">)</span>&nbsp;<span class="op" id="3876234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876237">for</span>&nbsp;<span class="ident" id="3876241">s</span>&nbsp;<span class="op" id="3876243">:=</span>&nbsp;<span class="keyword" id="3876246">range</span>&nbsp;<span class="ident" id="3876252">sBoxes</span>&nbsp;<span class="op" id="3876259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876263">for</span>&nbsp;<span class="ident" id="3876267">i</span>&nbsp;<span class="op" id="3876269">:=</span>&nbsp;<span class="num" id="3876272">0</span><span class="op" id="3876273">;</span>&nbsp;<span class="ident" id="3876275">i</span>&nbsp;<span class="op" id="3876277">&lt;</span>&nbsp;<span class="num" id="3876279">4</span><span class="op" id="3876280">;</span>&nbsp;<span class="ident" id="3876282">i</span><span class="op" id="3876283">++</span>&nbsp;<span class="op" id="3876286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876291">for</span>&nbsp;<span class="ident" id="3876295">j</span>&nbsp;<span class="op" id="3876297">:=</span>&nbsp;<span class="num" id="3876300">0</span><span class="op" id="3876301">;</span>&nbsp;<span class="ident" id="3876303">j</span>&nbsp;<span class="op" id="3876305">&lt;</span>&nbsp;<span class="num" id="3876307">16</span><span class="op" id="3876309">;</span>&nbsp;<span class="ident" id="3876311">j</span><span class="op" id="3876312">++</span>&nbsp;<span class="op" id="3876315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876321">f</span>&nbsp;<span class="op" id="3876323">:=</span>&nbsp;<span class="ident" id="3876326">uint64</span><span class="op" id="3876332">(</span><span class="ident" id="3876333">sBoxes</span><span class="op" id="3876339">[</span><span class="ident" id="3876340">s</span><span class="op" id="3876341">]</span><span class="op" id="3876342">[</span><span class="ident" id="3876343">i</span><span class="op" id="3876344">]</span><span class="op" id="3876345">[</span><span class="ident" id="3876346">j</span><span class="op" id="3876347">]</span><span class="op" id="3876348">)</span>&nbsp;<span class="op" id="3876350">&lt;&lt;</span>&nbsp;<span class="op" id="3876353">(</span><span class="num" id="3876354">4</span>&nbsp;<span class="op" id="3876356">*</span>&nbsp;<span class="op" id="3876358">(</span><span class="num" id="3876359">7</span>&nbsp;<span class="op" id="3876361">-</span>&nbsp;<span class="builtintype" id="3876363">uint</span><span class="op" id="3876367">(</span><span class="ident" id="3876368">s</span><span class="op" id="3876369">)</span><span class="op" id="3876370">)</span><span class="op" id="3876371">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876377">f</span>&nbsp;<span class="op" id="3876379">=</span>&nbsp;<span class="ident" id="3876381">permuteBlock</span><span class="op" id="3876393">(</span><span class="ident" id="3876394">uint64</span><span class="op" id="3876400">(</span><span class="ident" id="3876401">f</span><span class="op" id="3876402">)</span><span class="op" id="3876403">,</span>&nbsp;<span class="ident" id="3876405">permutationFunction</span><span class="op" id="3876424">[</span><span class="op" id="3876425">:</span><span class="op" id="3876426">]</span><span class="op" id="3876427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876433">feistelBox</span><span class="op" id="3876443">[</span><span class="ident" id="3876444">s</span><span class="op" id="3876445">]</span><span class="op" id="3876446">[</span><span class="num" id="3876447">16</span><span class="op" id="3876449">*</span><span class="ident" id="3876450">i</span><span class="op" id="3876451">+</span><span class="ident" id="3876452">j</span><span class="op" id="3876453">]</span>&nbsp;<span class="op" id="3876455">=</span>&nbsp;<span class="builtintype" id="3876457">uint32</span><span class="op" id="3876463">(</span><span class="ident" id="3876464">f</span><span class="op" id="3876465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876477">}</span><br>
<span class="lineno">80</span><span class="op" id="3876479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876482">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="3876532">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="3876573">func</span>&nbsp;<span class="ident" id="3876578">expandBlock</span><span class="op" id="3876589">(</span><span class="ident" id="3876590">src</span>&nbsp;<span class="builtintype" id="3876594">uint32</span><span class="op" id="3876600">)</span>&nbsp;<span class="op" id="3876602">(</span><span class="ident" id="3876603">block</span>&nbsp;<span class="ident" id="3876609">uint64</span><span class="op" id="3876615">)</span>&nbsp;<span class="op" id="3876617">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876620">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876664">src</span>&nbsp;<span class="op" id="3876668">=</span>&nbsp;<span class="op" id="3876670">(</span><span class="ident" id="3876671">src</span>&nbsp;<span class="op" id="3876675">&lt;&lt;</span>&nbsp;<span class="num" id="3876678">5</span><span class="op" id="3876679">)</span>&nbsp;<span class="op" id="3876681">|</span>&nbsp;<span class="op" id="3876683">(</span><span class="ident" id="3876684">src</span>&nbsp;<span class="op" id="3876688">&gt;&gt;</span>&nbsp;<span class="num" id="3876691">27</span><span class="op" id="3876693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876696">for</span>&nbsp;<span class="ident" id="3876700">i</span>&nbsp;<span class="op" id="3876702">:=</span>&nbsp;<span class="num" id="3876705">0</span><span class="op" id="3876706">;</span>&nbsp;<span class="ident" id="3876708">i</span>&nbsp;<span class="op" id="3876710">&lt;</span>&nbsp;<span class="num" id="3876712">8</span><span class="op" id="3876713">;</span>&nbsp;<span class="ident" id="3876715">i</span><span class="op" id="3876716">++</span>&nbsp;<span class="op" id="3876719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876723">block</span>&nbsp;<span class="op" id="3876729">&lt;&lt;=</span>&nbsp;<span class="num" id="3876733">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876737">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876771">block</span>&nbsp;<span class="op" id="3876777">|=</span>&nbsp;<span class="ident" id="3876780">uint64</span><span class="op" id="3876786">(</span><span class="ident" id="3876787">src</span><span class="op" id="3876790">)</span>&nbsp;<span class="op" id="3876792">&amp;</span>&nbsp;<span class="op" id="3876794">(</span><span class="num" id="3876795">1</span><span class="op" id="3876796">&lt;&lt;</span><span class="num" id="3876798">6</span>&nbsp;<span class="op" id="3876800">-</span>&nbsp;<span class="num" id="3876802">1</span><span class="op" id="3876803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3876807">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3876831">src</span>&nbsp;<span class="op" id="3876835">=</span>&nbsp;<span class="op" id="3876837">(</span><span class="ident" id="3876838">src</span>&nbsp;<span class="op" id="3876842">&lt;&lt;</span>&nbsp;<span class="num" id="3876845">4</span><span class="op" id="3876846">)</span>&nbsp;<span class="op" id="3876848">|</span>&nbsp;<span class="op" id="3876850">(</span><span class="ident" id="3876851">src</span>&nbsp;<span class="op" id="3876855">&gt;&gt;</span>&nbsp;<span class="num" id="3876858">28</span><span class="op" id="3876860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3876863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3876866">return</span><br>
<span class="lineno">95</span><span class="op" id="3876873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3876876">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3876940">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3876966">func</span>&nbsp;<span class="ident" id="3876971">permuteInitialBlock</span><span class="op" id="3876990">(</span><span class="ident" id="3876991">block</span>&nbsp;<span class="ident" id="3876997">uint64</span><span class="op" id="3877003">)</span>&nbsp;<span class="ident" id="3877005">uint64</span>&nbsp;<span class="op" id="3877012">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877015">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877061">b1</span>&nbsp;<span class="op" id="3877064">:=</span>&nbsp;<span class="ident" id="3877067">block</span>&nbsp;<span class="op" id="3877073">&gt;&gt;</span>&nbsp;<span class="num" id="3877076">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877080">b2</span>&nbsp;<span class="op" id="3877083">:=</span>&nbsp;<span class="ident" id="3877086">block</span>&nbsp;<span class="op" id="3877092">&lt;&lt;</span>&nbsp;<span class="num" id="3877095">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877099">block</span>&nbsp;<span class="op" id="3877105">^=</span>&nbsp;<span class="ident" id="3877108">b1</span>&nbsp;<span class="op" id="3877111">^</span>&nbsp;<span class="ident" id="3877113">b2</span>&nbsp;<span class="op" id="3877116">^</span>&nbsp;<span class="ident" id="3877118">b1</span><span class="op" id="3877120">&lt;&lt;</span><span class="num" id="3877122">48</span>&nbsp;<span class="op" id="3877125">^</span>&nbsp;<span class="ident" id="3877127">b2</span><span class="op" id="3877129">&gt;&gt;</span><span class="num" id="3877131">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877136">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877172">b1</span>&nbsp;<span class="op" id="3877175">=</span>&nbsp;<span class="ident" id="3877177">block</span>&nbsp;<span class="op" id="3877183">&gt;&gt;</span>&nbsp;<span class="num" id="3877186">32</span>&nbsp;<span class="op" id="3877189">&amp;</span>&nbsp;<span class="num" id="3877191">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877201">b2</span>&nbsp;<span class="op" id="3877204">=</span>&nbsp;<span class="op" id="3877206">(</span><span class="ident" id="3877207">block</span>&nbsp;<span class="op" id="3877213">&amp;</span>&nbsp;<span class="num" id="3877215">0xff00ff00</span><span class="op" id="3877225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877228">block</span>&nbsp;<span class="op" id="3877234">^=</span>&nbsp;<span class="ident" id="3877237">b1</span><span class="op" id="3877239">&lt;&lt;</span><span class="num" id="3877241">32</span>&nbsp;<span class="op" id="3877244">^</span>&nbsp;<span class="ident" id="3877246">b2</span>&nbsp;<span class="op" id="3877249">^</span>&nbsp;<span class="ident" id="3877251">b1</span><span class="op" id="3877253">&lt;&lt;</span><span class="num" id="3877255">8</span>&nbsp;<span class="op" id="3877257">^</span>&nbsp;<span class="ident" id="3877259">b2</span><span class="op" id="3877261">&lt;&lt;</span><span class="num" id="3877263">24</span>&nbsp;<span class="comment" id="3877266">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877297">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877356">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877384">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877412">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877440">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877468">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877496">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877524">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877552">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877581">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877624">b1</span>&nbsp;<span class="op" id="3877627">=</span>&nbsp;<span class="ident" id="3877629">block</span>&nbsp;<span class="op" id="3877635">&amp;</span>&nbsp;<span class="num" id="3877637">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877657">b2</span>&nbsp;<span class="op" id="3877660">=</span>&nbsp;<span class="ident" id="3877662">block</span>&nbsp;<span class="op" id="3877668">&amp;</span>&nbsp;<span class="num" id="3877670">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877690">block</span>&nbsp;<span class="op" id="3877696">^=</span>&nbsp;<span class="ident" id="3877699">b1</span>&nbsp;<span class="op" id="3877702">^</span>&nbsp;<span class="ident" id="3877704">b2</span>&nbsp;<span class="op" id="3877707">^</span>&nbsp;<span class="ident" id="3877709">b1</span><span class="op" id="3877711">&gt;&gt;</span><span class="num" id="3877713">12</span>&nbsp;<span class="op" id="3877716">^</span>&nbsp;<span class="ident" id="3877718">b2</span><span class="op" id="3877720">&lt;&lt;</span><span class="num" id="3877722">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877727">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877757">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877761">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877786">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877790">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877806">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877822">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877838">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3877864">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877902">b1</span>&nbsp;<span class="op" id="3877905">=</span>&nbsp;<span class="ident" id="3877907">block</span>&nbsp;<span class="op" id="3877913">&amp;</span>&nbsp;<span class="num" id="3877915">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877935">b2</span>&nbsp;<span class="op" id="3877938">=</span>&nbsp;<span class="ident" id="3877940">block</span>&nbsp;<span class="op" id="3877946">&amp;</span>&nbsp;<span class="num" id="3877948">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3877968">block</span>&nbsp;<span class="op" id="3877974">^=</span>&nbsp;<span class="ident" id="3877977">b1</span>&nbsp;<span class="op" id="3877980">^</span>&nbsp;<span class="ident" id="3877982">b2</span>&nbsp;<span class="op" id="3877985">^</span>&nbsp;<span class="ident" id="3877987">b1</span><span class="op" id="3877989">&gt;&gt;</span><span class="num" id="3877991">6</span>&nbsp;<span class="op" id="3877993">^</span>&nbsp;<span class="ident" id="3877995">b2</span><span class="op" id="3877997">&lt;&lt;</span><span class="num" id="3877999">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878003">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878033">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878043">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878053">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878063">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878073">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878083">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878093">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878103">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878132">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878170">b1</span>&nbsp;<span class="op" id="3878173">=</span>&nbsp;<span class="ident" id="3878175">block</span>&nbsp;<span class="op" id="3878181">&amp;</span>&nbsp;<span class="num" id="3878183">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878203">block</span>&nbsp;<span class="op" id="3878209">^=</span>&nbsp;<span class="ident" id="3878212">b1</span>&nbsp;<span class="op" id="3878215">^</span>&nbsp;<span class="ident" id="3878217">b1</span><span class="op" id="3878219">&gt;&gt;</span><span class="num" id="3878221">33</span>&nbsp;<span class="op" id="3878224">^</span>&nbsp;<span class="ident" id="3878226">b1</span><span class="op" id="3878228">&lt;&lt;</span><span class="num" id="3878230">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878235">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878265">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878292">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878319">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878346">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878373">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878400">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878427">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878454">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3878481">return</span>&nbsp;<span class="ident" id="3878488">block</span><br>
<span class="lineno"></span><span class="op" id="3878494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3878497">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3878561">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="3878585">func</span>&nbsp;<span class="ident" id="3878590">permuteFinalBlock</span><span class="op" id="3878607">(</span><span class="ident" id="3878608">block</span>&nbsp;<span class="ident" id="3878614">uint64</span><span class="op" id="3878620">)</span>&nbsp;<span class="ident" id="3878622">uint64</span>&nbsp;<span class="op" id="3878629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878632">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3878690">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878716">b1</span>&nbsp;<span class="op" id="3878719">:=</span>&nbsp;<span class="ident" id="3878722">block</span>&nbsp;<span class="op" id="3878728">&amp;</span>&nbsp;<span class="num" id="3878730">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878750">block</span>&nbsp;<span class="op" id="3878756">^=</span>&nbsp;<span class="ident" id="3878759">b1</span>&nbsp;<span class="op" id="3878762">^</span>&nbsp;<span class="ident" id="3878764">b1</span><span class="op" id="3878766">&gt;&gt;</span><span class="num" id="3878768">33</span>&nbsp;<span class="op" id="3878771">^</span>&nbsp;<span class="ident" id="3878773">b1</span><span class="op" id="3878775">&lt;&lt;</span><span class="num" id="3878777">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878782">b1</span>&nbsp;<span class="op" id="3878785">=</span>&nbsp;<span class="ident" id="3878787">block</span>&nbsp;<span class="op" id="3878793">&amp;</span>&nbsp;<span class="num" id="3878795">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878815">b2</span>&nbsp;<span class="op" id="3878818">:=</span>&nbsp;<span class="ident" id="3878821">block</span>&nbsp;<span class="op" id="3878827">&amp;</span>&nbsp;<span class="num" id="3878829">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878849">block</span>&nbsp;<span class="op" id="3878855">^=</span>&nbsp;<span class="ident" id="3878858">b1</span>&nbsp;<span class="op" id="3878861">^</span>&nbsp;<span class="ident" id="3878863">b2</span>&nbsp;<span class="op" id="3878866">^</span>&nbsp;<span class="ident" id="3878868">b1</span><span class="op" id="3878870">&gt;&gt;</span><span class="num" id="3878872">6</span>&nbsp;<span class="op" id="3878874">^</span>&nbsp;<span class="ident" id="3878876">b2</span><span class="op" id="3878878">&lt;&lt;</span><span class="num" id="3878880">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878884">b1</span>&nbsp;<span class="op" id="3878887">=</span>&nbsp;<span class="ident" id="3878889">block</span>&nbsp;<span class="op" id="3878895">&amp;</span>&nbsp;<span class="num" id="3878897">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878917">b2</span>&nbsp;<span class="op" id="3878920">=</span>&nbsp;<span class="ident" id="3878922">block</span>&nbsp;<span class="op" id="3878928">&amp;</span>&nbsp;<span class="num" id="3878930">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878950">block</span>&nbsp;<span class="op" id="3878956">^=</span>&nbsp;<span class="ident" id="3878959">b1</span>&nbsp;<span class="op" id="3878962">^</span>&nbsp;<span class="ident" id="3878964">b2</span>&nbsp;<span class="op" id="3878967">^</span>&nbsp;<span class="ident" id="3878969">b1</span><span class="op" id="3878971">&gt;&gt;</span><span class="num" id="3878973">12</span>&nbsp;<span class="op" id="3878976">^</span>&nbsp;<span class="ident" id="3878978">b2</span><span class="op" id="3878980">&lt;&lt;</span><span class="num" id="3878982">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3878987">b1</span>&nbsp;<span class="op" id="3878990">=</span>&nbsp;<span class="ident" id="3878992">block</span>&nbsp;<span class="op" id="3878998">&gt;&gt;</span>&nbsp;<span class="num" id="3879001">32</span>&nbsp;<span class="op" id="3879004">&amp;</span>&nbsp;<span class="num" id="3879006">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879016">b2</span>&nbsp;<span class="op" id="3879019">=</span>&nbsp;<span class="op" id="3879021">(</span><span class="ident" id="3879022">block</span>&nbsp;<span class="op" id="3879028">&amp;</span>&nbsp;<span class="num" id="3879030">0xff00ff00</span><span class="op" id="3879040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879043">block</span>&nbsp;<span class="op" id="3879049">^=</span>&nbsp;<span class="ident" id="3879052">b1</span><span class="op" id="3879054">&lt;&lt;</span><span class="num" id="3879056">32</span>&nbsp;<span class="op" id="3879059">^</span>&nbsp;<span class="ident" id="3879061">b2</span>&nbsp;<span class="op" id="3879064">^</span>&nbsp;<span class="ident" id="3879066">b1</span><span class="op" id="3879068">&lt;&lt;</span><span class="num" id="3879070">8</span>&nbsp;<span class="op" id="3879072">^</span>&nbsp;<span class="ident" id="3879074">b2</span><span class="op" id="3879076">&lt;&lt;</span><span class="num" id="3879078">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879083">b1</span>&nbsp;<span class="op" id="3879086">=</span>&nbsp;<span class="ident" id="3879088">block</span>&nbsp;<span class="op" id="3879094">&gt;&gt;</span>&nbsp;<span class="num" id="3879097">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879101">b2</span>&nbsp;<span class="op" id="3879104">=</span>&nbsp;<span class="ident" id="3879106">block</span>&nbsp;<span class="op" id="3879112">&lt;&lt;</span>&nbsp;<span class="num" id="3879115">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879119">block</span>&nbsp;<span class="op" id="3879125">^=</span>&nbsp;<span class="ident" id="3879128">b1</span>&nbsp;<span class="op" id="3879131">^</span>&nbsp;<span class="ident" id="3879133">b2</span>&nbsp;<span class="op" id="3879136">^</span>&nbsp;<span class="ident" id="3879138">b1</span><span class="op" id="3879140">&lt;&lt;</span><span class="num" id="3879142">48</span>&nbsp;<span class="op" id="3879145">^</span>&nbsp;<span class="ident" id="3879147">b2</span><span class="op" id="3879149">&gt;&gt;</span><span class="num" id="3879151">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879155">return</span>&nbsp;<span class="ident" id="3879162">block</span><br>
<span class="lineno"></span><span class="op" id="3879168">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="3879171">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="3879217">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="3879245">func</span>&nbsp;<span class="ident" id="3879250">ksRotate</span><span class="op" id="3879258">(</span><span class="ident" id="3879259">in</span>&nbsp;<span class="builtintype" id="3879262">uint32</span><span class="op" id="3879268">)</span>&nbsp;<span class="op" id="3879270">(</span><span class="ident" id="3879271">out</span>&nbsp;<span class="op" id="3879275">[</span><span class="op" id="3879276">]</span><span class="builtintype" id="3879277">uint32</span><span class="op" id="3879283">)</span>&nbsp;<span class="op" id="3879285">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879288">out</span>&nbsp;<span class="op" id="3879292">=</span>&nbsp;<span class="builtinfunc" id="3879294">make</span><span class="op" id="3879298">(</span><span class="op" id="3879299">[</span><span class="op" id="3879300">]</span><span class="builtintype" id="3879301">uint32</span><span class="op" id="3879307">,</span>&nbsp;<span class="num" id="3879309">16</span><span class="op" id="3879311">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879314">last</span>&nbsp;<span class="op" id="3879319">:=</span>&nbsp;<span class="ident" id="3879322">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879326">for</span>&nbsp;<span class="ident" id="3879330">i</span>&nbsp;<span class="op" id="3879332">:=</span>&nbsp;<span class="num" id="3879335">0</span><span class="op" id="3879336">;</span>&nbsp;<span class="ident" id="3879338">i</span>&nbsp;<span class="op" id="3879340">&lt;</span>&nbsp;<span class="num" id="3879342">16</span><span class="op" id="3879344">;</span>&nbsp;<span class="ident" id="3879346">i</span><span class="op" id="3879347">++</span>&nbsp;<span class="op" id="3879350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879354">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879386">left</span>&nbsp;<span class="op" id="3879391">:=</span>&nbsp;<span class="op" id="3879394">(</span><span class="ident" id="3879395">last</span>&nbsp;<span class="op" id="3879400">&lt;&lt;</span>&nbsp;<span class="op" id="3879403">(</span><span class="num" id="3879404">4</span>&nbsp;<span class="op" id="3879406">+</span>&nbsp;<span class="ident" id="3879408">ksRotations</span><span class="op" id="3879419">[</span><span class="ident" id="3879420">i</span><span class="op" id="3879421">]</span><span class="op" id="3879422">)</span><span class="op" id="3879423">)</span>&nbsp;<span class="op" id="3879425">&gt;&gt;</span>&nbsp;<span class="num" id="3879428">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879432">right</span>&nbsp;<span class="op" id="3879438">:=</span>&nbsp;<span class="op" id="3879441">(</span><span class="ident" id="3879442">last</span>&nbsp;<span class="op" id="3879447">&lt;&lt;</span>&nbsp;<span class="num" id="3879450">4</span><span class="op" id="3879451">)</span>&nbsp;<span class="op" id="3879453">&gt;&gt;</span>&nbsp;<span class="op" id="3879456">(</span><span class="num" id="3879457">32</span>&nbsp;<span class="op" id="3879460">-</span>&nbsp;<span class="ident" id="3879462">ksRotations</span><span class="op" id="3879473">[</span><span class="ident" id="3879474">i</span><span class="op" id="3879475">]</span><span class="op" id="3879476">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879480">out</span><span class="op" id="3879483">[</span><span class="ident" id="3879484">i</span><span class="op" id="3879485">]</span>&nbsp;<span class="op" id="3879487">=</span>&nbsp;<span class="ident" id="3879489">left</span>&nbsp;<span class="op" id="3879494">|</span>&nbsp;<span class="ident" id="3879496">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879504">last</span>&nbsp;<span class="op" id="3879509">=</span>&nbsp;<span class="ident" id="3879511">out</span><span class="op" id="3879514">[</span><span class="ident" id="3879515">i</span><span class="op" id="3879516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3879519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879522">return</span><br>
<span class="lineno"></span><span class="op" id="3879529">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="3879532">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="3879583">func</span>&nbsp;<span class="op" id="3879588">(</span><span class="ident" id="3879589">c</span>&nbsp;<span class="op" id="3879591">*</span><span class="ident" id="3879592">desCipher</span><span class="op" id="3879601">)</span>&nbsp;<span class="ident" id="3879603">generateSubkeys</span><span class="op" id="3879618">(</span><span class="ident" id="3879619">keyBytes</span>&nbsp;<span class="op" id="3879628">[</span><span class="op" id="3879629">]</span><span class="builtintype" id="3879630">byte</span><span class="op" id="3879634">)</span>&nbsp;<span class="op" id="3879636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879639">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879672">key</span>&nbsp;<span class="op" id="3879676">:=</span>&nbsp;<span class="ident" id="3879679">binary</span><span class="op" id="3879685">.</span><span class="ident" id="3879686">BigEndian</span><span class="op" id="3879695">.</span><span class="ident" id="3879696">Uint64</span><span class="op" id="3879702">(</span><span class="ident" id="3879703">keyBytes</span><span class="op" id="3879711">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879714">permutedKey</span>&nbsp;<span class="op" id="3879726">:=</span>&nbsp;<span class="ident" id="3879729">permuteBlock</span><span class="op" id="3879741">(</span><span class="ident" id="3879742">key</span><span class="op" id="3879745">,</span>&nbsp;<span class="ident" id="3879747">permutedChoice1</span><span class="op" id="3879762">[</span><span class="op" id="3879763">:</span><span class="op" id="3879764">]</span><span class="op" id="3879765">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879769">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879838">leftRotations</span>&nbsp;<span class="op" id="3879852">:=</span>&nbsp;<span class="ident" id="3879855">ksRotate</span><span class="op" id="3879863">(</span><span class="builtintype" id="3879864">uint32</span><span class="op" id="3879870">(</span><span class="ident" id="3879871">permutedKey</span>&nbsp;<span class="op" id="3879883">&gt;&gt;</span>&nbsp;<span class="num" id="3879886">28</span><span class="op" id="3879888">)</span><span class="op" id="3879889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3879892">rightRotations</span>&nbsp;<span class="op" id="3879907">:=</span>&nbsp;<span class="ident" id="3879910">ksRotate</span><span class="op" id="3879918">(</span><span class="builtintype" id="3879919">uint32</span><span class="op" id="3879925">(</span><span class="ident" id="3879926">permutedKey</span><span class="op" id="3879937">&lt;&lt;</span><span class="num" id="3879939">4</span><span class="op" id="3879940">)</span>&nbsp;<span class="op" id="3879942">&gt;&gt;</span>&nbsp;<span class="num" id="3879945">4</span><span class="op" id="3879946">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879950">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3879971">for</span>&nbsp;<span class="ident" id="3879975">i</span>&nbsp;<span class="op" id="3879977">:=</span>&nbsp;<span class="num" id="3879980">0</span><span class="op" id="3879981">;</span>&nbsp;<span class="ident" id="3879983">i</span>&nbsp;<span class="op" id="3879985">&lt;</span>&nbsp;<span class="num" id="3879987">16</span><span class="op" id="3879989">;</span>&nbsp;<span class="ident" id="3879991">i</span><span class="op" id="3879992">++</span>&nbsp;<span class="op" id="3879995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3879999">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880047">pc2Input</span>&nbsp;<span class="op" id="3880056">:=</span>&nbsp;<span class="ident" id="3880059">uint64</span><span class="op" id="3880065">(</span><span class="ident" id="3880066">leftRotations</span><span class="op" id="3880079">[</span><span class="ident" id="3880080">i</span><span class="op" id="3880081">]</span><span class="op" id="3880082">)</span><span class="op" id="3880083">&lt;&lt;</span><span class="num" id="3880085">28</span>&nbsp;<span class="op" id="3880088">|</span>&nbsp;<span class="ident" id="3880090">uint64</span><span class="op" id="3880096">(</span><span class="ident" id="3880097">rightRotations</span><span class="op" id="3880111">[</span><span class="ident" id="3880112">i</span><span class="op" id="3880113">]</span><span class="op" id="3880114">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3880118">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3880161">c</span><span class="op" id="3880162">.</span><span class="ident" id="3880163">subkeys</span><span class="op" id="3880170">[</span><span class="ident" id="3880171">i</span><span class="op" id="3880172">]</span>&nbsp;<span class="op" id="3880174">=</span>&nbsp;<span class="ident" id="3880176">permuteBlock</span><span class="op" id="3880188">(</span><span class="ident" id="3880189">pc2Input</span><span class="op" id="3880197">,</span>&nbsp;<span class="ident" id="3880199">permutedChoice2</span><span class="op" id="3880214">[</span><span class="op" id="3880215">:</span><span class="op" id="3880216">]</span><span class="op" id="3880217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3880220">}</span><br>
<span class="lineno"></span><span class="op" id="3880222">}</span>
</div>
</body>
</html>
