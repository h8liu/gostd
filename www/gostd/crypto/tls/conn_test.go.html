<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7899173">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7899228">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7899282">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7899333">package</span>&nbsp;<span class="ident" id="7899341">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7899346">import</span>&nbsp;<span class="op" id="7899353">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7899356">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7899366">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7899369">func</span>&nbsp;<span class="ident" id="7899374">TestRoundUp</span><span class="op" id="7899385">(</span><span class="ident" id="7899386">t</span>&nbsp;<span class="op" id="7899388">*</span><span class="ident" id="7899389">testing</span><span class="op" id="7899396">.</span><span class="ident" id="7899397">T</span><span class="op" id="7899398">)</span>&nbsp;<span class="op" id="7899400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7899403">if</span>&nbsp;<span class="ident" id="7899406">roundUp</span><span class="op" id="7899413">(</span><span class="num" id="7899414">0</span><span class="op" id="7899415">,</span>&nbsp;<span class="num" id="7899417">16</span><span class="op" id="7899419">)</span>&nbsp;<span class="op" id="7899421">!=</span>&nbsp;<span class="num" id="7899424">0</span>&nbsp;<span class="op" id="7899426">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899431">roundUp</span><span class="op" id="7899438">(</span><span class="num" id="7899439">1</span><span class="op" id="7899440">,</span>&nbsp;<span class="num" id="7899442">16</span><span class="op" id="7899444">)</span>&nbsp;<span class="op" id="7899446">!=</span>&nbsp;<span class="num" id="7899449">16</span>&nbsp;<span class="op" id="7899452">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899457">roundUp</span><span class="op" id="7899464">(</span><span class="num" id="7899465">15</span><span class="op" id="7899467">,</span>&nbsp;<span class="num" id="7899469">16</span><span class="op" id="7899471">)</span>&nbsp;<span class="op" id="7899473">!=</span>&nbsp;<span class="num" id="7899476">16</span>&nbsp;<span class="op" id="7899479">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899484">roundUp</span><span class="op" id="7899491">(</span><span class="num" id="7899492">16</span><span class="op" id="7899494">,</span>&nbsp;<span class="num" id="7899496">16</span><span class="op" id="7899498">)</span>&nbsp;<span class="op" id="7899500">!=</span>&nbsp;<span class="num" id="7899503">16</span>&nbsp;<span class="op" id="7899506">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899511">roundUp</span><span class="op" id="7899518">(</span><span class="num" id="7899519">17</span><span class="op" id="7899521">,</span>&nbsp;<span class="num" id="7899523">16</span><span class="op" id="7899525">)</span>&nbsp;<span class="op" id="7899527">!=</span>&nbsp;<span class="num" id="7899530">32</span>&nbsp;<span class="op" id="7899533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899537">t</span><span class="op" id="7899538">.</span><span class="ident" id="7899539">Error</span><span class="op" id="7899544">(</span><span class="string" id="7899545">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7899561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899564">}</span><br>
<span class="lineno"></span><span class="op" id="7899566">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7899569">var</span>&nbsp;<span class="ident" id="7899573">paddingTests</span>&nbsp;<span class="op" id="7899586">=</span>&nbsp;<span class="op" id="7899588">[</span><span class="op" id="7899589">]</span><span class="keyword" id="7899590">struct</span>&nbsp;<span class="op" id="7899597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899600">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7899612">[</span><span class="op" id="7899613">]</span><span class="builtintype" id="7899614">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899620">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7899632">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7899638">expectedLen</span>&nbsp;<span class="builtintype" id="7899650">int</span><br>
<span class="lineno">25</span><span class="op" id="7899654">}</span><span class="op" id="7899655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899658">{</span><span class="op" id="7899659">[</span><span class="op" id="7899660">]</span><span class="builtintype" id="7899661">byte</span><span class="op" id="7899665">{</span><span class="num" id="7899666">1</span><span class="op" id="7899667">,</span>&nbsp;<span class="num" id="7899669">2</span><span class="op" id="7899670">,</span>&nbsp;<span class="num" id="7899672">3</span><span class="op" id="7899673">,</span>&nbsp;<span class="num" id="7899675">4</span><span class="op" id="7899676">,</span>&nbsp;<span class="num" id="7899678">0</span><span class="op" id="7899679">}</span><span class="op" id="7899680">,</span>&nbsp;<span class="builtintype" id="7899682">true</span><span class="op" id="7899686">,</span>&nbsp;<span class="num" id="7899688">4</span><span class="op" id="7899689">}</span><span class="op" id="7899690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899693">{</span><span class="op" id="7899694">[</span><span class="op" id="7899695">]</span><span class="builtintype" id="7899696">byte</span><span class="op" id="7899700">{</span><span class="num" id="7899701">1</span><span class="op" id="7899702">,</span>&nbsp;<span class="num" id="7899704">2</span><span class="op" id="7899705">,</span>&nbsp;<span class="num" id="7899707">3</span><span class="op" id="7899708">,</span>&nbsp;<span class="num" id="7899710">4</span><span class="op" id="7899711">,</span>&nbsp;<span class="num" id="7899713">0</span><span class="op" id="7899714">,</span>&nbsp;<span class="num" id="7899716">1</span><span class="op" id="7899717">}</span><span class="op" id="7899718">,</span>&nbsp;<span class="builtintype" id="7899720">false</span><span class="op" id="7899725">,</span>&nbsp;<span class="num" id="7899727">0</span><span class="op" id="7899728">}</span><span class="op" id="7899729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899732">{</span><span class="op" id="7899733">[</span><span class="op" id="7899734">]</span><span class="builtintype" id="7899735">byte</span><span class="op" id="7899739">{</span><span class="num" id="7899740">1</span><span class="op" id="7899741">,</span>&nbsp;<span class="num" id="7899743">2</span><span class="op" id="7899744">,</span>&nbsp;<span class="num" id="7899746">3</span><span class="op" id="7899747">,</span>&nbsp;<span class="num" id="7899749">4</span><span class="op" id="7899750">,</span>&nbsp;<span class="num" id="7899752">99</span><span class="op" id="7899754">,</span>&nbsp;<span class="num" id="7899756">99</span><span class="op" id="7899758">}</span><span class="op" id="7899759">,</span>&nbsp;<span class="builtintype" id="7899761">false</span><span class="op" id="7899766">,</span>&nbsp;<span class="num" id="7899768">0</span><span class="op" id="7899769">}</span><span class="op" id="7899770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899773">{</span><span class="op" id="7899774">[</span><span class="op" id="7899775">]</span><span class="builtintype" id="7899776">byte</span><span class="op" id="7899780">{</span><span class="num" id="7899781">1</span><span class="op" id="7899782">,</span>&nbsp;<span class="num" id="7899784">2</span><span class="op" id="7899785">,</span>&nbsp;<span class="num" id="7899787">3</span><span class="op" id="7899788">,</span>&nbsp;<span class="num" id="7899790">4</span><span class="op" id="7899791">,</span>&nbsp;<span class="num" id="7899793">1</span><span class="op" id="7899794">,</span>&nbsp;<span class="num" id="7899796">1</span><span class="op" id="7899797">}</span><span class="op" id="7899798">,</span>&nbsp;<span class="builtintype" id="7899800">true</span><span class="op" id="7899804">,</span>&nbsp;<span class="num" id="7899806">4</span><span class="op" id="7899807">}</span><span class="op" id="7899808">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899811">{</span><span class="op" id="7899812">[</span><span class="op" id="7899813">]</span><span class="builtintype" id="7899814">byte</span><span class="op" id="7899818">{</span><span class="num" id="7899819">1</span><span class="op" id="7899820">,</span>&nbsp;<span class="num" id="7899822">2</span><span class="op" id="7899823">,</span>&nbsp;<span class="num" id="7899825">3</span><span class="op" id="7899826">,</span>&nbsp;<span class="num" id="7899828">2</span><span class="op" id="7899829">,</span>&nbsp;<span class="num" id="7899831">2</span><span class="op" id="7899832">,</span>&nbsp;<span class="num" id="7899834">2</span><span class="op" id="7899835">}</span><span class="op" id="7899836">,</span>&nbsp;<span class="builtintype" id="7899838">true</span><span class="op" id="7899842">,</span>&nbsp;<span class="num" id="7899844">3</span><span class="op" id="7899845">}</span><span class="op" id="7899846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899849">{</span><span class="op" id="7899850">[</span><span class="op" id="7899851">]</span><span class="builtintype" id="7899852">byte</span><span class="op" id="7899856">{</span><span class="num" id="7899857">1</span><span class="op" id="7899858">,</span>&nbsp;<span class="num" id="7899860">2</span><span class="op" id="7899861">,</span>&nbsp;<span class="num" id="7899863">3</span><span class="op" id="7899864">,</span>&nbsp;<span class="num" id="7899866">3</span><span class="op" id="7899867">,</span>&nbsp;<span class="num" id="7899869">3</span><span class="op" id="7899870">,</span>&nbsp;<span class="num" id="7899872">3</span><span class="op" id="7899873">}</span><span class="op" id="7899874">,</span>&nbsp;<span class="builtintype" id="7899876">true</span><span class="op" id="7899880">,</span>&nbsp;<span class="num" id="7899882">2</span><span class="op" id="7899883">}</span><span class="op" id="7899884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899887">{</span><span class="op" id="7899888">[</span><span class="op" id="7899889">]</span><span class="builtintype" id="7899890">byte</span><span class="op" id="7899894">{</span><span class="num" id="7899895">1</span><span class="op" id="7899896">,</span>&nbsp;<span class="num" id="7899898">2</span><span class="op" id="7899899">,</span>&nbsp;<span class="num" id="7899901">3</span><span class="op" id="7899902">,</span>&nbsp;<span class="num" id="7899904">4</span><span class="op" id="7899905">,</span>&nbsp;<span class="num" id="7899907">3</span><span class="op" id="7899908">,</span>&nbsp;<span class="num" id="7899910">3</span><span class="op" id="7899911">}</span><span class="op" id="7899912">,</span>&nbsp;<span class="builtintype" id="7899914">false</span><span class="op" id="7899919">,</span>&nbsp;<span class="num" id="7899921">0</span><span class="op" id="7899922">}</span><span class="op" id="7899923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899926">{</span><span class="op" id="7899927">[</span><span class="op" id="7899928">]</span><span class="builtintype" id="7899929">byte</span><span class="op" id="7899933">{</span><span class="num" id="7899934">1</span><span class="op" id="7899935">,</span>&nbsp;<span class="num" id="7899937">4</span><span class="op" id="7899938">,</span>&nbsp;<span class="num" id="7899940">4</span><span class="op" id="7899941">,</span>&nbsp;<span class="num" id="7899943">4</span><span class="op" id="7899944">,</span>&nbsp;<span class="num" id="7899946">4</span><span class="op" id="7899947">,</span>&nbsp;<span class="num" id="7899949">4</span><span class="op" id="7899950">}</span><span class="op" id="7899951">,</span>&nbsp;<span class="builtintype" id="7899953">true</span><span class="op" id="7899957">,</span>&nbsp;<span class="num" id="7899959">1</span><span class="op" id="7899960">}</span><span class="op" id="7899961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7899964">{</span><span class="op" id="7899965">[</span><span class="op" id="7899966">]</span><span class="builtintype" id="7899967">byte</span><span class="op" id="7899971">{</span><span class="num" id="7899972">5</span><span class="op" id="7899973">,</span>&nbsp;<span class="num" id="7899975">5</span><span class="op" id="7899976">,</span>&nbsp;<span class="num" id="7899978">5</span><span class="op" id="7899979">,</span>&nbsp;<span class="num" id="7899981">5</span><span class="op" id="7899982">,</span>&nbsp;<span class="num" id="7899984">5</span><span class="op" id="7899985">,</span>&nbsp;<span class="num" id="7899987">5</span><span class="op" id="7899988">}</span><span class="op" id="7899989">,</span>&nbsp;<span class="builtintype" id="7899991">true</span><span class="op" id="7899995">,</span>&nbsp;<span class="num" id="7899997">0</span><span class="op" id="7899998">}</span><span class="op" id="7899999">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7900002">{</span><span class="op" id="7900003">[</span><span class="op" id="7900004">]</span><span class="builtintype" id="7900005">byte</span><span class="op" id="7900009">{</span><span class="num" id="7900010">6</span><span class="op" id="7900011">,</span>&nbsp;<span class="num" id="7900013">6</span><span class="op" id="7900014">,</span>&nbsp;<span class="num" id="7900016">6</span><span class="op" id="7900017">,</span>&nbsp;<span class="num" id="7900019">6</span><span class="op" id="7900020">,</span>&nbsp;<span class="num" id="7900022">6</span><span class="op" id="7900023">,</span>&nbsp;<span class="num" id="7900025">6</span><span class="op" id="7900026">}</span><span class="op" id="7900027">,</span>&nbsp;<span class="builtintype" id="7900029">false</span><span class="op" id="7900034">,</span>&nbsp;<span class="num" id="7900036">0</span><span class="op" id="7900037">}</span><span class="op" id="7900038">,</span><br>
<span class="lineno"></span><span class="op" id="7900040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7900043">func</span>&nbsp;<span class="ident" id="7900048">TestRemovePadding</span><span class="op" id="7900065">(</span><span class="ident" id="7900066">t</span>&nbsp;<span class="op" id="7900068">*</span><span class="ident" id="7900069">testing</span><span class="op" id="7900076">.</span><span class="ident" id="7900077">T</span><span class="op" id="7900078">)</span>&nbsp;<span class="op" id="7900080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7900083">for</span>&nbsp;<span class="ident" id="7900087">i</span><span class="op" id="7900088">,</span>&nbsp;<span class="ident" id="7900090">test</span>&nbsp;<span class="op" id="7900095">:=</span>&nbsp;<span class="keyword" id="7900098">range</span>&nbsp;<span class="ident" id="7900104">paddingTests</span>&nbsp;<span class="op" id="7900117">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7900121">payload</span><span class="op" id="7900128">,</span>&nbsp;<span class="ident" id="7900130">good</span>&nbsp;<span class="op" id="7900135">:=</span>&nbsp;<span class="ident" id="7900138">removePadding</span><span class="op" id="7900151">(</span><span class="ident" id="7900152">test</span><span class="op" id="7900156">.</span><span class="ident" id="7900157">in</span><span class="op" id="7900159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7900163">expectedGood</span>&nbsp;<span class="op" id="7900176">:=</span>&nbsp;<span class="builtintype" id="7900179">byte</span><span class="op" id="7900183">(</span><span class="num" id="7900184">255</span><span class="op" id="7900187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7900191">if</span>&nbsp;<span class="op" id="7900194">!</span><span class="ident" id="7900195">test</span><span class="op" id="7900199">.</span><span class="ident" id="7900200">good</span>&nbsp;<span class="op" id="7900205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7900210">expectedGood</span>&nbsp;<span class="op" id="7900223">=</span>&nbsp;<span class="num" id="7900225">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7900229">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7900233">if</span>&nbsp;<span class="ident" id="7900236">good</span>&nbsp;<span class="op" id="7900241">!=</span>&nbsp;<span class="ident" id="7900244">expectedGood</span>&nbsp;<span class="op" id="7900257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7900262">t</span><span class="op" id="7900263">.</span><span class="ident" id="7900264">Errorf</span><span class="op" id="7900270">(</span><span class="string" id="7900271">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7900308">,</span>&nbsp;<span class="ident" id="7900310">i</span><span class="op" id="7900311">,</span>&nbsp;<span class="ident" id="7900313">expectedGood</span><span class="op" id="7900325">,</span>&nbsp;<span class="ident" id="7900327">good</span><span class="op" id="7900331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7900335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7900339">if</span>&nbsp;<span class="ident" id="7900342">good</span>&nbsp;<span class="op" id="7900347">==</span>&nbsp;<span class="num" id="7900350">255</span>&nbsp;<span class="op" id="7900354">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7900357">len</span><span class="op" id="7900360">(</span><span class="ident" id="7900361">payload</span><span class="op" id="7900368">)</span>&nbsp;<span class="op" id="7900370">!=</span>&nbsp;<span class="ident" id="7900373">test</span><span class="op" id="7900377">.</span><span class="ident" id="7900378">expectedLen</span>&nbsp;<span class="op" id="7900390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7900395">t</span><span class="op" id="7900396">.</span><span class="ident" id="7900397">Errorf</span><span class="op" id="7900403">(</span><span class="string" id="7900404">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7900426">,</span>&nbsp;<span class="ident" id="7900428">i</span><span class="op" id="7900429">,</span>&nbsp;<span class="builtinfunc" id="7900431">len</span><span class="op" id="7900434">(</span><span class="ident" id="7900435">payload</span><span class="op" id="7900442">)</span><span class="op" id="7900443">,</span>&nbsp;<span class="ident" id="7900445">test</span><span class="op" id="7900449">.</span><span class="ident" id="7900450">expectedLen</span><span class="op" id="7900461">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7900465">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7900468">}</span><br>
<span class="lineno"></span><span class="op" id="7900470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7900473">var</span>&nbsp;<span class="ident" id="7900477">certExampleCom</span>&nbsp;<span class="op" id="7900492">=</span>&nbsp;<span class="string" id="7900494">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7901146">var</span>&nbsp;<span class="ident" id="7901150">certWildcardExampleCom</span>&nbsp;<span class="op" id="7901173">=</span>&nbsp;<span class="string" id="7901175">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7901831">var</span>&nbsp;<span class="ident" id="7901835">certFooExampleCom</span>&nbsp;<span class="op" id="7901853">=</span>&nbsp;<span class="string" id="7901855">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7902515">var</span>&nbsp;<span class="ident" id="7902519">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7902548">=</span>&nbsp;<span class="string" id="7902550">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7903210">func</span>&nbsp;<span class="ident" id="7903215">TestCertificateSelection</span><span class="op" id="7903239">(</span><span class="ident" id="7903240">t</span>&nbsp;<span class="op" id="7903242">*</span><span class="ident" id="7903243">testing</span><span class="op" id="7903250">.</span><span class="ident" id="7903251">T</span><span class="op" id="7903252">)</span>&nbsp;<span class="op" id="7903254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903257">config</span>&nbsp;<span class="op" id="7903264">:=</span>&nbsp;<span class="ident" id="7903267">Config</span><span class="op" id="7903273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903277">Certificates</span><span class="op" id="7903289">:</span>&nbsp;<span class="op" id="7903291">[</span><span class="op" id="7903292">]</span><span class="ident" id="7903293">Certificate</span><span class="op" id="7903304">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903315">Certificate</span><span class="op" id="7903326">:</span>&nbsp;<span class="op" id="7903328">[</span><span class="op" id="7903329">]</span><span class="op" id="7903330">[</span><span class="op" id="7903331">]</span><span class="builtintype" id="7903332">byte</span><span class="op" id="7903336">{</span><span class="ident" id="7903337">fromHex</span><span class="op" id="7903344">(</span><span class="ident" id="7903345">certExampleCom</span><span class="op" id="7903359">)</span><span class="op" id="7903360">}</span><span class="op" id="7903361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903366">}</span><span class="op" id="7903367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903378">Certificate</span><span class="op" id="7903389">:</span>&nbsp;<span class="op" id="7903391">[</span><span class="op" id="7903392">]</span><span class="op" id="7903393">[</span><span class="op" id="7903394">]</span><span class="builtintype" id="7903395">byte</span><span class="op" id="7903399">{</span><span class="ident" id="7903400">fromHex</span><span class="op" id="7903407">(</span><span class="ident" id="7903408">certWildcardExampleCom</span><span class="op" id="7903430">)</span><span class="op" id="7903431">}</span><span class="op" id="7903432">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903437">}</span><span class="op" id="7903438">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903449">Certificate</span><span class="op" id="7903460">:</span>&nbsp;<span class="op" id="7903462">[</span><span class="op" id="7903463">]</span><span class="op" id="7903464">[</span><span class="op" id="7903465">]</span><span class="builtintype" id="7903466">byte</span><span class="op" id="7903470">{</span><span class="ident" id="7903471">fromHex</span><span class="op" id="7903478">(</span><span class="ident" id="7903479">certFooExampleCom</span><span class="op" id="7903496">)</span><span class="op" id="7903497">}</span><span class="op" id="7903498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903503">}</span><span class="op" id="7903504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903509">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903515">Certificate</span><span class="op" id="7903526">:</span>&nbsp;<span class="op" id="7903528">[</span><span class="op" id="7903529">]</span><span class="op" id="7903530">[</span><span class="op" id="7903531">]</span><span class="builtintype" id="7903532">byte</span><span class="op" id="7903536">{</span><span class="ident" id="7903537">fromHex</span><span class="op" id="7903544">(</span><span class="ident" id="7903545">certDoubleWildcardExampleCom</span><span class="op" id="7903573">)</span><span class="op" id="7903574">}</span><span class="op" id="7903575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903580">}</span><span class="op" id="7903581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903585">}</span><span class="op" id="7903586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903593">config</span><span class="op" id="7903599">.</span><span class="ident" id="7903600">BuildNameToCertificate</span><span class="op" id="7903622">(</span><span class="op" id="7903623">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903627">pointerToIndex</span>&nbsp;<span class="op" id="7903642">:=</span>&nbsp;<span class="keyword" id="7903645">func</span><span class="op" id="7903649">(</span><span class="ident" id="7903650">c</span>&nbsp;<span class="op" id="7903652">*</span><span class="ident" id="7903653">Certificate</span><span class="op" id="7903664">)</span>&nbsp;<span class="builtintype" id="7903666">int</span>&nbsp;<span class="op" id="7903670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903674">for</span>&nbsp;<span class="ident" id="7903678">i</span>&nbsp;<span class="op" id="7903680">:=</span>&nbsp;<span class="keyword" id="7903683">range</span>&nbsp;<span class="ident" id="7903689">config</span><span class="op" id="7903695">.</span><span class="ident" id="7903696">Certificates</span>&nbsp;<span class="op" id="7903709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903714">if</span>&nbsp;<span class="ident" id="7903717">c</span>&nbsp;<span class="op" id="7903719">==</span>&nbsp;<span class="op" id="7903722">&amp;</span><span class="ident" id="7903723">config</span><span class="op" id="7903729">.</span><span class="ident" id="7903730">Certificates</span><span class="op" id="7903742">[</span><span class="ident" id="7903743">i</span><span class="op" id="7903744">]</span>&nbsp;<span class="op" id="7903746">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903752">return</span>&nbsp;<span class="ident" id="7903759">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903772">return</span>&nbsp;<span class="op" id="7903779">-</span><span class="num" id="7903780">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903783">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903787">certificateForName</span>&nbsp;<span class="op" id="7903806">:=</span>&nbsp;<span class="keyword" id="7903809">func</span><span class="op" id="7903813">(</span><span class="ident" id="7903814">name</span>&nbsp;<span class="builtintype" id="7903819">string</span><span class="op" id="7903825">)</span>&nbsp;<span class="op" id="7903827">*</span><span class="ident" id="7903828">Certificate</span>&nbsp;<span class="op" id="7903840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903844">clientHello</span>&nbsp;<span class="op" id="7903856">:=</span>&nbsp;<span class="op" id="7903859">&amp;</span><span class="ident" id="7903860">ClientHelloInfo</span><span class="op" id="7903875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903880">ServerName</span><span class="op" id="7903890">:</span>&nbsp;<span class="ident" id="7903892">name</span><span class="op" id="7903896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7903900">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7903904">if</span>&nbsp;<span class="ident" id="7903907">cert</span><span class="op" id="7903911">,</span>&nbsp;<span class="ident" id="7903913">err</span>&nbsp;<span class="op" id="7903917">:=</span>&nbsp;<span class="ident" id="7903920">config</span><span class="op" id="7903926">.</span><span class="ident" id="7903927">getCertificate</span><span class="op" id="7903941">(</span><span class="ident" id="7903942">clientHello</span><span class="op" id="7903953">)</span><span class="op" id="7903954">;</span>&nbsp;<span class="ident" id="7903956">err</span>&nbsp;<span class="op" id="7903960">!=</span>&nbsp;<span class="ident" id="7903963">nil</span>&nbsp;<span class="op" id="7903967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7903972">t</span><span class="op" id="7903973">.</span><span class="ident" id="7903974">Errorf</span><span class="op" id="7903980">(</span><span class="string" id="7903981">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7904026">,</span>&nbsp;<span class="ident" id="7904028">name</span><span class="op" id="7904032">,</span>&nbsp;<span class="ident" id="7904034">err</span><span class="op" id="7904037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904042">return</span>&nbsp;<span class="ident" id="7904049">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904055">}</span>&nbsp;<span class="keyword" id="7904057">else</span>&nbsp;<span class="op" id="7904062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904067">return</span>&nbsp;<span class="ident" id="7904074">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904084">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904088">if</span>&nbsp;<span class="ident" id="7904091">n</span>&nbsp;<span class="op" id="7904093">:=</span>&nbsp;<span class="ident" id="7904096">pointerToIndex</span><span class="op" id="7904110">(</span><span class="ident" id="7904111">certificateForName</span><span class="op" id="7904129">(</span><span class="string" id="7904130">&#34;example.com&#34;</span><span class="op" id="7904143">)</span><span class="op" id="7904144">)</span><span class="op" id="7904145">;</span>&nbsp;<span class="ident" id="7904147">n</span>&nbsp;<span class="op" id="7904149">!=</span>&nbsp;<span class="num" id="7904152">0</span>&nbsp;<span class="op" id="7904154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904158">t</span><span class="op" id="7904159">.</span><span class="ident" id="7904160">Errorf</span><span class="op" id="7904166">(</span><span class="string" id="7904167">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7904211">,</span>&nbsp;<span class="ident" id="7904213">n</span><span class="op" id="7904214">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904220">if</span>&nbsp;<span class="ident" id="7904223">n</span>&nbsp;<span class="op" id="7904225">:=</span>&nbsp;<span class="ident" id="7904228">pointerToIndex</span><span class="op" id="7904242">(</span><span class="ident" id="7904243">certificateForName</span><span class="op" id="7904261">(</span><span class="string" id="7904262">&#34;bar.example.com&#34;</span><span class="op" id="7904279">)</span><span class="op" id="7904280">)</span><span class="op" id="7904281">;</span>&nbsp;<span class="ident" id="7904283">n</span>&nbsp;<span class="op" id="7904285">!=</span>&nbsp;<span class="num" id="7904288">1</span>&nbsp;<span class="op" id="7904290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904294">t</span><span class="op" id="7904295">.</span><span class="ident" id="7904296">Errorf</span><span class="op" id="7904302">(</span><span class="string" id="7904303">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7904351">,</span>&nbsp;<span class="ident" id="7904353">n</span><span class="op" id="7904354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904360">if</span>&nbsp;<span class="ident" id="7904363">n</span>&nbsp;<span class="op" id="7904365">:=</span>&nbsp;<span class="ident" id="7904368">pointerToIndex</span><span class="op" id="7904382">(</span><span class="ident" id="7904383">certificateForName</span><span class="op" id="7904401">(</span><span class="string" id="7904402">&#34;foo.example.com&#34;</span><span class="op" id="7904419">)</span><span class="op" id="7904420">)</span><span class="op" id="7904421">;</span>&nbsp;<span class="ident" id="7904423">n</span>&nbsp;<span class="op" id="7904425">!=</span>&nbsp;<span class="num" id="7904428">2</span>&nbsp;<span class="op" id="7904430">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904434">t</span><span class="op" id="7904435">.</span><span class="ident" id="7904436">Errorf</span><span class="op" id="7904442">(</span><span class="string" id="7904443">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7904491">,</span>&nbsp;<span class="ident" id="7904493">n</span><span class="op" id="7904494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904500">if</span>&nbsp;<span class="ident" id="7904503">n</span>&nbsp;<span class="op" id="7904505">:=</span>&nbsp;<span class="ident" id="7904508">pointerToIndex</span><span class="op" id="7904522">(</span><span class="ident" id="7904523">certificateForName</span><span class="op" id="7904541">(</span><span class="string" id="7904542">&#34;foo.bar.example.com&#34;</span><span class="op" id="7904563">)</span><span class="op" id="7904564">)</span><span class="op" id="7904565">;</span>&nbsp;<span class="ident" id="7904567">n</span>&nbsp;<span class="op" id="7904569">!=</span>&nbsp;<span class="num" id="7904572">3</span>&nbsp;<span class="op" id="7904574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904578">t</span><span class="op" id="7904579">.</span><span class="ident" id="7904580">Errorf</span><span class="op" id="7904586">(</span><span class="string" id="7904587">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7904639">,</span>&nbsp;<span class="ident" id="7904641">n</span><span class="op" id="7904642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904645">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7904648">if</span>&nbsp;<span class="ident" id="7904651">n</span>&nbsp;<span class="op" id="7904653">:=</span>&nbsp;<span class="ident" id="7904656">pointerToIndex</span><span class="op" id="7904670">(</span><span class="ident" id="7904671">certificateForName</span><span class="op" id="7904689">(</span><span class="string" id="7904690">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7904715">)</span><span class="op" id="7904716">)</span><span class="op" id="7904717">;</span>&nbsp;<span class="ident" id="7904719">n</span>&nbsp;<span class="op" id="7904721">!=</span>&nbsp;<span class="num" id="7904724">0</span>&nbsp;<span class="op" id="7904726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7904730">t</span><span class="op" id="7904731">.</span><span class="ident" id="7904732">Errorf</span><span class="op" id="7904738">(</span><span class="string" id="7904739">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7904795">,</span>&nbsp;<span class="ident" id="7904797">n</span><span class="op" id="7904798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7904801">}</span><br>
<span class="lineno"></span><span class="op" id="7904803">}</span>
</div>
</body>
</html>
