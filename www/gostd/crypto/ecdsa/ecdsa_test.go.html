<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/ecdsa</h2>
<ul>
<li><a href="/gostd/crypto/ecdsa/ecdsa.go.html">ecdsa.go</a></li>
<li><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html" class="current">ecdsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6558360">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6558415">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6558469">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6558520">package</span>&nbsp;<span class="ident" id="6558528">ecdsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558535">import</span>&nbsp;<span class="op" id="6558542">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558545">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558554">&#34;compress/bzip2&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558572">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558591">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558606">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558621">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558638">&#34;crypto/sha512&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558655">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558671">&#34;hash&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558679">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558685">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558697">&#34;os&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558703">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6558714">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6558724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6558727">func</span>&nbsp;<span class="ident" id="6558732">testKeyGeneration</span><span class="op" id="6558749">(</span><span class="ident" id="6558750">t</span>&nbsp;<span class="op" id="6558752">*</span><span class="ident" id="6558753"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6558760">.</span><span class="ident" id="6558761"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6558762">,</span>&nbsp;<span class="ident" id="6558764">c</span>&nbsp;<span class="ident" id="6558766"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6558774">.</span><span class="ident" id="6558775"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="6558780">,</span>&nbsp;<span class="ident" id="6558782">tag</span>&nbsp;<span class="builtintype" id="6558786">string</span><span class="op" id="6558792">)</span>&nbsp;<span class="op" id="6558794">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6558797">priv</span><span class="op" id="6558801">,</span>&nbsp;<span class="ident" id="6558803">err</span>&nbsp;<span class="op" id="6558807">:=</span>&nbsp;<span class="ident" id="6558810"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="6558821">(</span><span class="ident" id="6558822"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558764">c</a></span><span class="op" id="6558823">,</span>&nbsp;<span class="ident" id="6558825"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558591">rand</a></span><span class="op" id="6558829">.</span><span class="ident" id="6558830"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6558836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6558839">if</span>&nbsp;<span class="ident" id="6558842"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558803">err</a></span>&nbsp;<span class="op" id="6558846">!=</span>&nbsp;<span class="builtintype" id="6558849">nil</span>&nbsp;<span class="op" id="6558853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6558857"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558750">t</a></span><span class="op" id="6558858">.</span><span class="ident" id="6558859"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6558865">(</span><span class="string" id="6558866">&#34;%s:&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6558881">,</span>&nbsp;<span class="ident" id="6558883"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558782">tag</a></span><span class="op" id="6558886">,</span>&nbsp;<span class="ident" id="6558888"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558803">err</a></span><span class="op" id="6558891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6558895">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6558903">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6558906">if</span>&nbsp;<span class="op" id="6558909">!</span><span class="ident" id="6558910"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558764">c</a></span><span class="op" id="6558911">.</span><span class="ident" id="6558912"><a href="/gostd/crypto/elliptic/elliptic.go.html#3016033">IsOnCurve</a></span><span class="op" id="6558921">(</span><span class="ident" id="6558922"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558797">priv</a></span><span class="op" id="6558926">.</span><span class="ident" id="6558927"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="6558936">.</span><span class="ident" id="6558937"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span><span class="op" id="6558938">,</span>&nbsp;<span class="ident" id="6558940"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558797">priv</a></span><span class="op" id="6558944">.</span><span class="ident" id="6558945"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="6558954">.</span><span class="ident" id="6558955"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span><span class="op" id="6558956">)</span>&nbsp;<span class="op" id="6558958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6558962"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558750">t</a></span><span class="op" id="6558963">.</span><span class="ident" id="6558964"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6558970">(</span><span class="string" id="6558971">&#34;%s:&nbsp;public&nbsp;key&nbsp;invalid:&nbsp;%s&#34;</span><span class="op" id="6558999">,</span>&nbsp;<span class="ident" id="6559001"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558782">tag</a></span><span class="op" id="6559004">,</span>&nbsp;<span class="ident" id="6559006"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558803">err</a></span><span class="op" id="6559009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559012">}</span><br>
<span class="lineno"></span><span class="op" id="6559014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="6559017">func</span>&nbsp;<span class="ident" id="6559022">TestKeyGeneration</span><span class="op" id="6559039">(</span><span class="ident" id="6559040">t</span>&nbsp;<span class="op" id="6559042">*</span><span class="ident" id="6559043"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6559050">.</span><span class="ident" id="6559051"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6559052">)</span>&nbsp;<span class="op" id="6559054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559057"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558732">testKeyGeneration</a></span><span class="op" id="6559074">(</span><span class="ident" id="6559075"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559040">t</a></span><span class="op" id="6559076">,</span>&nbsp;<span class="ident" id="6559078"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559086">.</span><span class="ident" id="6559087"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="6559091">(</span><span class="op" id="6559092">)</span><span class="op" id="6559093">,</span>&nbsp;<span class="string" id="6559095">&#34;p224&#34;</span><span class="op" id="6559101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559104">if</span>&nbsp;<span class="ident" id="6559107"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6559114">.</span><span class="ident" id="6559115"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6559120">(</span><span class="op" id="6559121">)</span>&nbsp;<span class="op" id="6559123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559127">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559135">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559138"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558732">testKeyGeneration</a></span><span class="op" id="6559155">(</span><span class="ident" id="6559156"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559040">t</a></span><span class="op" id="6559157">,</span>&nbsp;<span class="ident" id="6559159"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559167">.</span><span class="ident" id="6559168"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="6559172">(</span><span class="op" id="6559173">)</span><span class="op" id="6559174">,</span>&nbsp;<span class="string" id="6559176">&#34;p256&#34;</span><span class="op" id="6559182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559185"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558732">testKeyGeneration</a></span><span class="op" id="6559202">(</span><span class="ident" id="6559203"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559040">t</a></span><span class="op" id="6559204">,</span>&nbsp;<span class="ident" id="6559206"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559214">.</span><span class="ident" id="6559215"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="6559219">(</span><span class="op" id="6559220">)</span><span class="op" id="6559221">,</span>&nbsp;<span class="string" id="6559223">&#34;p384&#34;</span><span class="op" id="6559229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559232"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558732">testKeyGeneration</a></span><span class="op" id="6559249">(</span><span class="ident" id="6559250"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559040">t</a></span><span class="op" id="6559251">,</span>&nbsp;<span class="ident" id="6559253"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559261">.</span><span class="ident" id="6559262"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="6559266">(</span><span class="op" id="6559267">)</span><span class="op" id="6559268">,</span>&nbsp;<span class="string" id="6559270">&#34;p521&#34;</span><span class="op" id="6559276">)</span><br>
<span class="lineno"></span><span class="op" id="6559278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="6559281">func</span>&nbsp;<span class="ident" id="6559286">testSignAndVerify</span><span class="op" id="6559303">(</span><span class="ident" id="6559304">t</span>&nbsp;<span class="op" id="6559306">*</span><span class="ident" id="6559307"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6559314">.</span><span class="ident" id="6559315"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6559316">,</span>&nbsp;<span class="ident" id="6559318">c</span>&nbsp;<span class="ident" id="6559320"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559328">.</span><span class="ident" id="6559329"><a href="/gostd/crypto/elliptic/elliptic.go.html#3015877">Curve</a></span><span class="op" id="6559334">,</span>&nbsp;<span class="ident" id="6559336">tag</span>&nbsp;<span class="builtintype" id="6559340">string</span><span class="op" id="6559346">)</span>&nbsp;<span class="op" id="6559348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559351">priv</span><span class="op" id="6559355">,</span>&nbsp;<span class="ident" id="6559357">_</span>&nbsp;<span class="op" id="6559359">:=</span>&nbsp;<span class="ident" id="6559362"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3006741">GenerateKey</a></span><span class="op" id="6559373">(</span><span class="ident" id="6559374"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559318">c</a></span><span class="op" id="6559375">,</span>&nbsp;<span class="ident" id="6559377"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558591">rand</a></span><span class="op" id="6559381">.</span><span class="ident" id="6559382"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6559388">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559392">hashed</span>&nbsp;<span class="op" id="6559399">:=</span>&nbsp;<span class="op" id="6559402">[</span><span class="op" id="6559403">]</span><span class="builtintype" id="6559404">byte</span><span class="op" id="6559408">(</span><span class="string" id="6559409">&#34;testing&#34;</span><span class="op" id="6559418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559421">r</span><span class="op" id="6559422">,</span>&nbsp;<span class="ident" id="6559424">s</span><span class="op" id="6559425">,</span>&nbsp;<span class="ident" id="6559427">err</span>&nbsp;<span class="op" id="6559431">:=</span>&nbsp;<span class="ident" id="6559434"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3008419">Sign</a></span><span class="op" id="6559438">(</span><span class="ident" id="6559439"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558591">rand</a></span><span class="op" id="6559443">.</span><span class="ident" id="6559444"><a href="/gostd/crypto/rand/rand.go.html#4355686">Reader</a></span><span class="op" id="6559450">,</span>&nbsp;<span class="ident" id="6559452"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559351">priv</a></span><span class="op" id="6559456">,</span>&nbsp;<span class="ident" id="6559458"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559392">hashed</a></span><span class="op" id="6559464">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559467">if</span>&nbsp;<span class="ident" id="6559470"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559427">err</a></span>&nbsp;<span class="op" id="6559474">!=</span>&nbsp;<span class="builtintype" id="6559477">nil</span>&nbsp;<span class="op" id="6559481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559485"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559304">t</a></span><span class="op" id="6559486">.</span><span class="ident" id="6559487"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6559493">(</span><span class="string" id="6559494">&#34;%s:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="6559517">,</span>&nbsp;<span class="ident" id="6559519"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559336">tag</a></span><span class="op" id="6559522">,</span>&nbsp;<span class="ident" id="6559524"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559427">err</a></span><span class="op" id="6559527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559531">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559543">if</span>&nbsp;<span class="op" id="6559546">!</span><span class="ident" id="6559547"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009119">Verify</a></span><span class="op" id="6559553">(</span><span class="op" id="6559554">&amp;</span><span class="ident" id="6559555"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559351">priv</a></span><span class="op" id="6559559">.</span><span class="ident" id="6559560"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="6559569">,</span>&nbsp;<span class="ident" id="6559571"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559392">hashed</a></span><span class="op" id="6559577">,</span>&nbsp;<span class="ident" id="6559579"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559421">r</a></span><span class="op" id="6559580">,</span>&nbsp;<span class="ident" id="6559582"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559424">s</a></span><span class="op" id="6559583">)</span>&nbsp;<span class="op" id="6559585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559589"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559304">t</a></span><span class="op" id="6559590">.</span><span class="ident" id="6559591"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6559597">(</span><span class="string" id="6559598">&#34;%s:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="6559617">,</span>&nbsp;<span class="ident" id="6559619"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559336">tag</a></span><span class="op" id="6559622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559629"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559392">hashed</a></span><span class="op" id="6559635">[</span><span class="num" id="6559636">0</span><span class="op" id="6559637">]</span>&nbsp;<span class="op" id="6559639">^=</span>&nbsp;<span class="num" id="6559642">0xff</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559648">if</span>&nbsp;<span class="ident" id="6559651"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009119">Verify</a></span><span class="op" id="6559657">(</span><span class="op" id="6559658">&amp;</span><span class="ident" id="6559659"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559351">priv</a></span><span class="op" id="6559663">.</span><span class="ident" id="6559664"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005534">PublicKey</a></span><span class="op" id="6559673">,</span>&nbsp;<span class="ident" id="6559675"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559392">hashed</a></span><span class="op" id="6559681">,</span>&nbsp;<span class="ident" id="6559683"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559421">r</a></span><span class="op" id="6559684">,</span>&nbsp;<span class="ident" id="6559686"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559424">s</a></span><span class="op" id="6559687">)</span>&nbsp;<span class="op" id="6559689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559693"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559304">t</a></span><span class="op" id="6559694">.</span><span class="ident" id="6559695"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="6559701">(</span><span class="string" id="6559702">&#34;%s:&nbsp;Verify&nbsp;always&nbsp;works!&#34;</span><span class="op" id="6559728">,</span>&nbsp;<span class="ident" id="6559730"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559336">tag</a></span><span class="op" id="6559733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559736">}</span><br>
<span class="lineno"></span><span class="op" id="6559738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="6559741">func</span>&nbsp;<span class="ident" id="6559746">TestSignAndVerify</span><span class="op" id="6559763">(</span><span class="ident" id="6559764">t</span>&nbsp;<span class="op" id="6559766">*</span><span class="ident" id="6559767"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6559774">.</span><span class="ident" id="6559775"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6559776">)</span>&nbsp;<span class="op" id="6559778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559781"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559286">testSignAndVerify</a></span><span class="op" id="6559798">(</span><span class="ident" id="6559799"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559764">t</a></span><span class="op" id="6559800">,</span>&nbsp;<span class="ident" id="6559802"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559810">.</span><span class="ident" id="6559811"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="6559815">(</span><span class="op" id="6559816">)</span><span class="op" id="6559817">,</span>&nbsp;<span class="string" id="6559819">&#34;p224&#34;</span><span class="op" id="6559825">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559828">if</span>&nbsp;<span class="ident" id="6559831"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6559838">.</span><span class="ident" id="6559839"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6559844">(</span><span class="op" id="6559845">)</span>&nbsp;<span class="op" id="6559847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6559851">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6559859">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559862"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559286">testSignAndVerify</a></span><span class="op" id="6559879">(</span><span class="ident" id="6559880"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559764">t</a></span><span class="op" id="6559881">,</span>&nbsp;<span class="ident" id="6559883"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559891">.</span><span class="ident" id="6559892"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="6559896">(</span><span class="op" id="6559897">)</span><span class="op" id="6559898">,</span>&nbsp;<span class="string" id="6559900">&#34;p256&#34;</span><span class="op" id="6559906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559909"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559286">testSignAndVerify</a></span><span class="op" id="6559926">(</span><span class="ident" id="6559927"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559764">t</a></span><span class="op" id="6559928">,</span>&nbsp;<span class="ident" id="6559930"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559938">.</span><span class="ident" id="6559939"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="6559943">(</span><span class="op" id="6559944">)</span><span class="op" id="6559945">,</span>&nbsp;<span class="string" id="6559947">&#34;p384&#34;</span><span class="op" id="6559953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6559956"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559286">testSignAndVerify</a></span><span class="op" id="6559973">(</span><span class="ident" id="6559974"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6559764">t</a></span><span class="op" id="6559975">,</span>&nbsp;<span class="ident" id="6559977"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6559985">.</span><span class="ident" id="6559986"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="6559990">(</span><span class="op" id="6559991">)</span><span class="op" id="6559992">,</span>&nbsp;<span class="string" id="6559994">&#34;p521&#34;</span><span class="op" id="6560000">)</span><br>
<span class="lineno"></span><span class="op" id="6560002">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6560005">func</span>&nbsp;<span class="ident" id="6560010">fromHex</span><span class="op" id="6560017">(</span><span class="ident" id="6560018">s</span>&nbsp;<span class="builtintype" id="6560020">string</span><span class="op" id="6560026">)</span>&nbsp;<span class="op" id="6560028">*</span><span class="ident" id="6560029"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558685">big</a></span><span class="op" id="6560032">.</span><span class="ident" id="6560033"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span>&nbsp;<span class="op" id="6560037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560040">r</span><span class="op" id="6560041">,</span>&nbsp;<span class="ident" id="6560043">ok</span>&nbsp;<span class="op" id="6560046">:=</span>&nbsp;<span class="builtinfunc" id="6560049">new</span><span class="op" id="6560052">(</span><span class="ident" id="6560053"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558685">big</a></span><span class="op" id="6560056">.</span><span class="ident" id="6560057"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><span class="op" id="6560060">)</span><span class="op" id="6560061">.</span><span class="ident" id="6560062"><a href="/gostd/math/big/int.go.html#2049625">SetString</a></span><span class="op" id="6560071">(</span><span class="ident" id="6560072"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560018">s</a></span><span class="op" id="6560073">,</span>&nbsp;<span class="num" id="6560075">16</span><span class="op" id="6560077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560080">if</span>&nbsp;<span class="op" id="6560083">!</span><span class="ident" id="6560084"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560043">ok</a></span>&nbsp;<span class="op" id="6560087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6560091">panic</span><span class="op" id="6560096">(</span><span class="string" id="6560097">&#34;bad&nbsp;hex&#34;</span><span class="op" id="6560106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560109">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560112">return</span>&nbsp;<span class="ident" id="6560119"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560040">r</a></span><br>
<span class="lineno"></span><span class="op" id="6560121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6560124">func</span>&nbsp;<span class="ident" id="6560129">TestVectors</span><span class="op" id="6560140">(</span><span class="ident" id="6560141">t</span>&nbsp;<span class="op" id="6560143">*</span><span class="ident" id="6560144"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6560151">.</span><span class="ident" id="6560152"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="6560153">)</span>&nbsp;<span class="op" id="6560155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560158">//&nbsp;This&nbsp;test&nbsp;runs&nbsp;the&nbsp;full&nbsp;set&nbsp;of&nbsp;NIST&nbsp;test&nbsp;vectors&nbsp;from</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560216">//&nbsp;http://csrc.nist.gov/groups/STM/cavp/documents/dss/186-3ecdsatestvectors.zip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560297">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560301">//&nbsp;The&nbsp;SigVer.rsp&nbsp;file&nbsp;has&nbsp;been&nbsp;edited&nbsp;to&nbsp;remove&nbsp;test&nbsp;vectors&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560368">//&nbsp;unsupported&nbsp;algorithms&nbsp;and&nbsp;has&nbsp;been&nbsp;compressed.</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560421">if</span>&nbsp;<span class="ident" id="6560424"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558714">testing</a></span><span class="op" id="6560431">.</span><span class="ident" id="6560432"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="6560437">(</span><span class="op" id="6560438">)</span>&nbsp;<span class="op" id="6560440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560444">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560452">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560456">f</span><span class="op" id="6560457">,</span>&nbsp;<span class="ident" id="6560459">err</span>&nbsp;<span class="op" id="6560463">:=</span>&nbsp;<span class="ident" id="6560466"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558697">os</a></span><span class="op" id="6560468">.</span><span class="ident" id="6560469"><a href="/gostd/os/file.go.html#2446863">Open</a></span><span class="op" id="6560473">(</span><span class="string" id="6560474">&#34;testdata/SigVer.rsp.bz2&#34;</span><span class="op" id="6560499">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560502">if</span>&nbsp;<span class="ident" id="6560505"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560459">err</a></span>&nbsp;<span class="op" id="6560509">!=</span>&nbsp;<span class="builtintype" id="6560512">nil</span>&nbsp;<span class="op" id="6560516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560520"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6560521">.</span><span class="ident" id="6560522"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="6560527">(</span><span class="ident" id="6560528"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560459">err</a></span><span class="op" id="6560531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560538">buf</span>&nbsp;<span class="op" id="6560542">:=</span>&nbsp;<span class="ident" id="6560545"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558545">bufio</a></span><span class="op" id="6560550">.</span><span class="ident" id="6560551"><a href="/gostd/bufio/bufio.go.html#1355792">NewReader</a></span><span class="op" id="6560560">(</span><span class="ident" id="6560561"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558554">bzip2</a></span><span class="op" id="6560566">.</span><span class="ident" id="6560567"><a href="/gostd/compress/bzip2/bzip2.go.html#1333497">NewReader</a></span><span class="op" id="6560576">(</span><span class="ident" id="6560577"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560456">f</a></span><span class="op" id="6560578">)</span><span class="op" id="6560579">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560583">lineNo</span>&nbsp;<span class="op" id="6560590">:=</span>&nbsp;<span class="num" id="6560593">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560596">var</span>&nbsp;<span class="ident" id="6560600">h</span>&nbsp;<span class="ident" id="6560602"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558671">hash</a></span><span class="op" id="6560606">.</span><span class="ident" id="6560607"><a href="/gostd/hash/hash.go.html#3014105">Hash</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560613">var</span>&nbsp;<span class="ident" id="6560617">msg</span>&nbsp;<span class="op" id="6560621">[</span><span class="op" id="6560622">]</span><span class="builtintype" id="6560623">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560629">var</span>&nbsp;<span class="ident" id="6560633">hashed</span>&nbsp;<span class="op" id="6560640">[</span><span class="op" id="6560641">]</span><span class="builtintype" id="6560642">byte</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560648">var</span>&nbsp;<span class="ident" id="6560652">r</span><span class="op" id="6560653">,</span>&nbsp;<span class="ident" id="6560655">s</span>&nbsp;<span class="op" id="6560657">*</span><span class="ident" id="6560658"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558685">big</a></span><span class="op" id="6560661">.</span><span class="ident" id="6560662"><a href="/gostd/math/big/int.go.html#2035985">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560667">pub</span>&nbsp;<span class="op" id="6560671">:=</span>&nbsp;<span class="builtinfunc" id="6560674">new</span><span class="op" id="6560677">(</span><span class="ident" id="6560678"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005409">PublicKey</a></span><span class="op" id="6560687">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560691">for</span>&nbsp;<span class="op" id="6560695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560699">line</span><span class="op" id="6560703">,</span>&nbsp;<span class="ident" id="6560705">err</span>&nbsp;<span class="op" id="6560709">:=</span>&nbsp;<span class="ident" id="6560712"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560538">buf</a></span><span class="op" id="6560715">.</span><span class="ident" id="6560716"><a href="/gostd/bufio/bufio.go.html#1365145">ReadString</a></span><span class="op" id="6560726">(</span><span class="string" id="6560727">&#39;\n&#39;</span><span class="op" id="6560731">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560735">if</span>&nbsp;<span class="builtinfunc" id="6560738">len</span><span class="op" id="6560741">(</span><span class="ident" id="6560742"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6560746">)</span>&nbsp;<span class="op" id="6560748">==</span>&nbsp;<span class="num" id="6560751">0</span>&nbsp;<span class="op" id="6560753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560758">if</span>&nbsp;<span class="ident" id="6560761"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560705">err</a></span>&nbsp;<span class="op" id="6560765">==</span>&nbsp;<span class="ident" id="6560768"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558679">io</a></span><span class="op" id="6560770">.</span><span class="ident" id="6560771"><a href="/gostd/io/io.go.html#1419950">EOF</a></span>&nbsp;<span class="op" id="6560775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560781">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560795"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6560796">.</span><span class="ident" id="6560797"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6560803">(</span><span class="string" id="6560804">&#34;error&nbsp;reading&nbsp;from&nbsp;input:&nbsp;%s&#34;</span><span class="op" id="6560834">,</span>&nbsp;<span class="ident" id="6560836"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560705">err</a></span><span class="op" id="6560839">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6560843">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560847"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560583">lineNo</a></span><span class="op" id="6560853">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6560858">//&nbsp;Need&nbsp;to&nbsp;remove&nbsp;\r\n&nbsp;from&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6560909">if</span>&nbsp;<span class="op" id="6560912">!</span><span class="ident" id="6560913"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6560920">.</span><span class="ident" id="6560921"><a href="/gostd/strings/strings.go.html#2975527">HasSuffix</a></span><span class="op" id="6560930">(</span><span class="ident" id="6560931"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6560935">,</span>&nbsp;<span class="string" id="6560937">&#34;\r\n&#34;</span><span class="op" id="6560943">)</span>&nbsp;<span class="op" id="6560945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6560950"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6560951">.</span><span class="ident" id="6560952"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6560958">(</span><span class="string" id="6560959">&#34;bad&nbsp;line&nbsp;ending&nbsp;(expected&nbsp;\\r\\n)&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6561005">,</span>&nbsp;<span class="ident" id="6561007"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560583">lineNo</a></span><span class="op" id="6561013">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561021"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span>&nbsp;<span class="op" id="6561026">=</span>&nbsp;<span class="ident" id="6561028"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561032">[</span><span class="op" id="6561033">:</span><span class="builtinfunc" id="6561034">len</span><span class="op" id="6561037">(</span><span class="ident" id="6561038"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561042">)</span><span class="op" id="6561043">-</span><span class="num" id="6561044">2</span><span class="op" id="6561045">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561050">if</span>&nbsp;<span class="builtinfunc" id="6561053">len</span><span class="op" id="6561056">(</span><span class="ident" id="6561057"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561061">)</span>&nbsp;<span class="op" id="6561063">==</span>&nbsp;<span class="num" id="6561066">0</span>&nbsp;<span class="op" id="6561068">||</span>&nbsp;<span class="ident" id="6561071"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561075">[</span><span class="num" id="6561076">0</span><span class="op" id="6561077">]</span>&nbsp;<span class="op" id="6561079">==</span>&nbsp;<span class="string" id="6561082">&#39;#&#39;</span>&nbsp;<span class="op" id="6561086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561091">continue</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561107">if</span>&nbsp;<span class="ident" id="6561110"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561114">[</span><span class="num" id="6561115">0</span><span class="op" id="6561116">]</span>&nbsp;<span class="op" id="6561118">==</span>&nbsp;<span class="string" id="6561121">&#39;[&#39;</span>&nbsp;<span class="op" id="6561125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561130"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span>&nbsp;<span class="op" id="6561135">=</span>&nbsp;<span class="ident" id="6561137"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561141">[</span><span class="num" id="6561142">1</span>&nbsp;<span class="op" id="6561144">:</span>&nbsp;<span class="builtinfunc" id="6561146">len</span><span class="op" id="6561149">(</span><span class="ident" id="6561150"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561154">)</span><span class="op" id="6561155">-</span><span class="num" id="6561156">1</span><span class="op" id="6561157">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561162">parts</span>&nbsp;<span class="op" id="6561168">:=</span>&nbsp;<span class="ident" id="6561171"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6561178">.</span><span class="ident" id="6561179"><a href="/gostd/strings/strings.go.html#2972338">SplitN</a></span><span class="op" id="6561185">(</span><span class="ident" id="6561186"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561190">,</span>&nbsp;<span class="string" id="6561192">&#34;,&#34;</span><span class="op" id="6561195">,</span>&nbsp;<span class="num" id="6561197">2</span><span class="op" id="6561198">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561204">switch</span>&nbsp;<span class="ident" id="6561211"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6561162">parts</a></span><span class="op" id="6561216">[</span><span class="num" id="6561217">0</span><span class="op" id="6561218">]</span>&nbsp;<span class="op" id="6561220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561225">case</span>&nbsp;<span class="string" id="6561230">&#34;P-224&#34;</span><span class="op" id="6561237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561243"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561246">.</span><span class="ident" id="6561247"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561253">=</span>&nbsp;<span class="ident" id="6561255"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6561263">.</span><span class="ident" id="6561264"><a href="/gostd/crypto/elliptic/p224.go.html#3027431">P224</a></span><span class="op" id="6561268">(</span><span class="op" id="6561269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561274">case</span>&nbsp;<span class="string" id="6561279">&#34;P-256&#34;</span><span class="op" id="6561286">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561292"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561295">.</span><span class="ident" id="6561296"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561302">=</span>&nbsp;<span class="ident" id="6561304"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6561312">.</span><span class="ident" id="6561313"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025819">P256</a></span><span class="op" id="6561317">(</span><span class="op" id="6561318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561323">case</span>&nbsp;<span class="string" id="6561328">&#34;P-384&#34;</span><span class="op" id="6561335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561341"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561344">.</span><span class="ident" id="6561345"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561351">=</span>&nbsp;<span class="ident" id="6561353"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6561361">.</span><span class="ident" id="6561362"><a href="/gostd/crypto/elliptic/elliptic.go.html#3025956">P384</a></span><span class="op" id="6561366">(</span><span class="op" id="6561367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561372">case</span>&nbsp;<span class="string" id="6561377">&#34;P-521&#34;</span><span class="op" id="6561384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561390"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561393">.</span><span class="ident" id="6561394"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561400">=</span>&nbsp;<span class="ident" id="6561402"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558572">elliptic</a></span><span class="op" id="6561410">.</span><span class="ident" id="6561411"><a href="/gostd/crypto/elliptic/elliptic.go.html#3026093">P521</a></span><span class="op" id="6561415">(</span><span class="op" id="6561416">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561421">default</span><span class="op" id="6561428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561434"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561437">.</span><span class="ident" id="6561438"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561444">=</span>&nbsp;<span class="builtintype" id="6561446">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561459">switch</span>&nbsp;<span class="ident" id="6561466"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6561162">parts</a></span><span class="op" id="6561471">[</span><span class="num" id="6561472">1</span><span class="op" id="6561473">]</span>&nbsp;<span class="op" id="6561475">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561480">case</span>&nbsp;<span class="string" id="6561485">&#34;SHA-1&#34;</span><span class="op" id="6561492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561498"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561500">=</span>&nbsp;<span class="ident" id="6561502"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558606">sha1</a></span><span class="op" id="6561506">.</span><span class="ident" id="6561507"><a href="/gostd/crypto/sha1/sha1.go.html#4609140">New</a></span><span class="op" id="6561510">(</span><span class="op" id="6561511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561516">case</span>&nbsp;<span class="string" id="6561521">&#34;SHA-224&#34;</span><span class="op" id="6561530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561536"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561538">=</span>&nbsp;<span class="ident" id="6561540"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558621">sha256</a></span><span class="op" id="6561546">.</span><span class="ident" id="6561547"><a href="/gostd/crypto/sha256/sha256.go.html#4760023">New224</a></span><span class="op" id="6561553">(</span><span class="op" id="6561554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561559">case</span>&nbsp;<span class="string" id="6561564">&#34;SHA-256&#34;</span><span class="op" id="6561573">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561579"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561581">=</span>&nbsp;<span class="ident" id="6561583"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558621">sha256</a></span><span class="op" id="6561589">.</span><span class="ident" id="6561590"><a href="/gostd/crypto/sha256/sha256.go.html#4759893">New</a></span><span class="op" id="6561593">(</span><span class="op" id="6561594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561599">case</span>&nbsp;<span class="string" id="6561604">&#34;SHA-384&#34;</span><span class="op" id="6561613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561619"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561621">=</span>&nbsp;<span class="ident" id="6561623"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558638">sha512</a></span><span class="op" id="6561629">.</span><span class="ident" id="6561630"><a href="/gostd/crypto/sha512/sha512.go.html#4763991">New384</a></span><span class="op" id="6561636">(</span><span class="op" id="6561637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561642">case</span>&nbsp;<span class="string" id="6561647">&#34;SHA-512&#34;</span><span class="op" id="6561656">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561662"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561664">=</span>&nbsp;<span class="ident" id="6561666"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558638">sha512</a></span><span class="op" id="6561672">.</span><span class="ident" id="6561673"><a href="/gostd/crypto/sha512/sha512.go.html#4763861">New</a></span><span class="op" id="6561676">(</span><span class="op" id="6561677">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561682">default</span><span class="op" id="6561689">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561695"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561697">=</span>&nbsp;<span class="builtintype" id="6561699">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561706">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561712">continue</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561728">if</span>&nbsp;<span class="ident" id="6561731"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span>&nbsp;<span class="op" id="6561733">==</span>&nbsp;<span class="builtintype" id="6561736">nil</span>&nbsp;<span class="op" id="6561740">||</span>&nbsp;<span class="ident" id="6561743"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6561746">.</span><span class="ident" id="6561747"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005429">Curve</a></span>&nbsp;<span class="op" id="6561753">==</span>&nbsp;<span class="builtintype" id="6561756">nil</span>&nbsp;<span class="op" id="6561760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561765">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561776">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561781">switch</span>&nbsp;<span class="op" id="6561788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561792">case</span>&nbsp;<span class="ident" id="6561797"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6561804">.</span><span class="ident" id="6561805"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6561814">(</span><span class="ident" id="6561815"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561819">,</span>&nbsp;<span class="string" id="6561821">&#34;Msg&nbsp;=&nbsp;&#34;</span><span class="op" id="6561829">)</span><span class="op" id="6561830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561835">if</span>&nbsp;<span class="ident" id="6561838"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560617">msg</a></span><span class="op" id="6561841">,</span>&nbsp;<span class="ident" id="6561843"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560705">err</a></span>&nbsp;<span class="op" id="6561847">=</span>&nbsp;<span class="ident" id="6561849"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558655">hex</a></span><span class="op" id="6561852">.</span><span class="ident" id="6561853"><a href="/gostd/encoding/hex/hex.go.html#4721563">DecodeString</a></span><span class="op" id="6561865">(</span><span class="ident" id="6561866"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561870">[</span><span class="num" id="6561871">6</span><span class="op" id="6561872">:</span><span class="op" id="6561873">]</span><span class="op" id="6561874">)</span><span class="op" id="6561875">;</span>&nbsp;<span class="ident" id="6561877"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560705">err</a></span>&nbsp;<span class="op" id="6561881">!=</span>&nbsp;<span class="builtintype" id="6561884">nil</span>&nbsp;<span class="op" id="6561888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6561894"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6561895">.</span><span class="ident" id="6561896"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6561902">(</span><span class="string" id="6561903">&#34;failed&nbsp;to&nbsp;decode&nbsp;message&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6561944">,</span>&nbsp;<span class="ident" id="6561946"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560583">lineNo</a></span><span class="op" id="6561952">,</span>&nbsp;<span class="ident" id="6561954"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560705">err</a></span><span class="op" id="6561957">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6561962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6561966">case</span>&nbsp;<span class="ident" id="6561971"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6561978">.</span><span class="ident" id="6561979"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6561988">(</span><span class="ident" id="6561989"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6561993">,</span>&nbsp;<span class="string" id="6561995">&#34;Qx&nbsp;=&nbsp;&#34;</span><span class="op" id="6562002">)</span><span class="op" id="6562003">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562008"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6562011">.</span><span class="ident" id="6562012"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005445">X</a></span>&nbsp;<span class="op" id="6562014">=</span>&nbsp;<span class="ident" id="6562016"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560010">fromHex</a></span><span class="op" id="6562023">(</span><span class="ident" id="6562024"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562028">[</span><span class="num" id="6562029">5</span><span class="op" id="6562030">:</span><span class="op" id="6562031">]</span><span class="op" id="6562032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562036">case</span>&nbsp;<span class="ident" id="6562041"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6562048">.</span><span class="ident" id="6562049"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6562058">(</span><span class="ident" id="6562059"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562063">,</span>&nbsp;<span class="string" id="6562065">&#34;Qy&nbsp;=&nbsp;&#34;</span><span class="op" id="6562072">)</span><span class="op" id="6562073">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562078"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6562081">.</span><span class="ident" id="6562082"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3005448">Y</a></span>&nbsp;<span class="op" id="6562084">=</span>&nbsp;<span class="ident" id="6562086"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560010">fromHex</a></span><span class="op" id="6562093">(</span><span class="ident" id="6562094"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562098">[</span><span class="num" id="6562099">5</span><span class="op" id="6562100">:</span><span class="op" id="6562101">]</span><span class="op" id="6562102">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562106">case</span>&nbsp;<span class="ident" id="6562111"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6562118">.</span><span class="ident" id="6562119"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6562128">(</span><span class="ident" id="6562129"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562133">,</span>&nbsp;<span class="string" id="6562135">&#34;R&nbsp;=&nbsp;&#34;</span><span class="op" id="6562141">)</span><span class="op" id="6562142">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562147"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560652">r</a></span>&nbsp;<span class="op" id="6562149">=</span>&nbsp;<span class="ident" id="6562151"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560010">fromHex</a></span><span class="op" id="6562158">(</span><span class="ident" id="6562159"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562163">[</span><span class="num" id="6562164">4</span><span class="op" id="6562165">:</span><span class="op" id="6562166">]</span><span class="op" id="6562167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562171">case</span>&nbsp;<span class="ident" id="6562176"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6562183">.</span><span class="ident" id="6562184"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6562193">(</span><span class="ident" id="6562194"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562198">,</span>&nbsp;<span class="string" id="6562200">&#34;S&nbsp;=&nbsp;&#34;</span><span class="op" id="6562206">)</span><span class="op" id="6562207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562212"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560655">s</a></span>&nbsp;<span class="op" id="6562214">=</span>&nbsp;<span class="ident" id="6562216"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560010">fromHex</a></span><span class="op" id="6562223">(</span><span class="ident" id="6562224"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562228">[</span><span class="num" id="6562229">4</span><span class="op" id="6562230">:</span><span class="op" id="6562231">]</span><span class="op" id="6562232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562236">case</span>&nbsp;<span class="ident" id="6562241"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6558703">strings</a></span><span class="op" id="6562248">.</span><span class="ident" id="6562249"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="6562258">(</span><span class="ident" id="6562259"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562263">,</span>&nbsp;<span class="string" id="6562265">&#34;Result&nbsp;=&nbsp;&#34;</span><span class="op" id="6562276">)</span><span class="op" id="6562277">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562282">expected</span>&nbsp;<span class="op" id="6562291">:=</span>&nbsp;<span class="ident" id="6562294"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562298">[</span><span class="num" id="6562299">9</span><span class="op" id="6562300">]</span>&nbsp;<span class="op" id="6562302">==</span>&nbsp;<span class="string" id="6562305">&#39;P&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562312"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span><span class="op" id="6562313">.</span><span class="ident" id="6562314"><a href="/gostd/hash/hash.go.html#3014443">Reset</a></span><span class="op" id="6562319">(</span><span class="op" id="6562320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562325"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span><span class="op" id="6562326">.</span><span class="ident" id="6562327"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="6562332">(</span><span class="ident" id="6562333"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560617">msg</a></span><span class="op" id="6562336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562341">hashed</span>&nbsp;<span class="op" id="6562348">:=</span>&nbsp;<span class="ident" id="6562351"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560600">h</a></span><span class="op" id="6562352">.</span><span class="ident" id="6562353"><a href="/gostd/hash/hash.go.html#3014372">Sum</a></span><span class="op" id="6562356">(</span><span class="ident" id="6562357"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560633">hashed</a></span><span class="op" id="6562363">[</span><span class="op" id="6562364">:</span><span class="num" id="6562365">0</span><span class="op" id="6562366">]</span><span class="op" id="6562367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562372">if</span>&nbsp;<span class="ident" id="6562375"><a href="/gostd/crypto/ecdsa/ecdsa.go.html#3009119">Verify</a></span><span class="op" id="6562381">(</span><span class="ident" id="6562382"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560667">pub</a></span><span class="op" id="6562385">,</span>&nbsp;<span class="ident" id="6562387"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6562341">hashed</a></span><span class="op" id="6562393">,</span>&nbsp;<span class="ident" id="6562395"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560652">r</a></span><span class="op" id="6562396">,</span>&nbsp;<span class="ident" id="6562398"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560655">s</a></span><span class="op" id="6562399">)</span>&nbsp;<span class="op" id="6562401">!=</span>&nbsp;<span class="ident" id="6562404"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6562282">expected</a></span>&nbsp;<span class="op" id="6562413">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562419"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6562420">.</span><span class="ident" id="6562421"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6562427">(</span><span class="string" id="6562428">&#34;incorrect&nbsp;result&nbsp;on&nbsp;line&nbsp;%d&#34;</span><span class="op" id="6562457">,</span>&nbsp;<span class="ident" id="6562459"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560583">lineNo</a></span><span class="op" id="6562465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6562470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6562474">default</span><span class="op" id="6562481">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6562486"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560141">t</a></span><span class="op" id="6562487">.</span><span class="ident" id="6562488"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="6562494">(</span><span class="string" id="6562495">&#34;unknown&nbsp;variable&nbsp;on&nbsp;line&nbsp;%d:&nbsp;%s&#34;</span><span class="op" id="6562528">,</span>&nbsp;<span class="ident" id="6562530"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560583">lineNo</a></span><span class="op" id="6562536">,</span>&nbsp;<span class="ident" id="6562538"><a href="/gostd/crypto/ecdsa/ecdsa_test.go.html#6560699">line</a></span><span class="op" id="6562542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6562546">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6562549">}</span><br>
<span class="lineno"></span><span class="op" id="6562551">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
