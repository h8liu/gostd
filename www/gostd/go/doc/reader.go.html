<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>go/doc</h2>
<ul>
<li><a href="/gostd/go/doc/comment.go.html">comment.go</a></li>
<li><a href="/gostd/go/doc/comment_test.go.html">comment_test.go</a></li>
<li><a href="/gostd/go/doc/doc.go.html">doc.go</a></li>
<li><a href="/gostd/go/doc/doc_test.go.html">doc_test.go</a></li>
<li><a href="/gostd/go/doc/example.go.html">example.go</a></li>
<li><a href="/gostd/go/doc/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/go/doc/exports.go.html">exports.go</a></li>
<li><a href="/gostd/go/doc/filter.go.html">filter.go</a></li>
<li><a href="/gostd/go/doc/reader.go.html">reader.go</a></li>
<li><a href="/gostd/go/doc/synopsis.go.html">synopsis.go</a></li>
<li><a href="/gostd/go/doc/synopsis_test.go.html">synopsis_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4368299">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4368354">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4368408">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4368459">package</span>&nbsp;<span class="ident" id="4368467">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4368472">import</span>&nbsp;<span class="op" id="4368479">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4368482">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4368492">&#34;go/token&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4368504">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4368514">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4368522">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="4368532">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4368535">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4368615">//&nbsp;function/method&nbsp;sets</span><br>
<span class="lineno"></span><span class="comment" id="4368639">//</span><br>
<span class="lineno"></span><span class="comment" id="4368642">//&nbsp;Internally,&nbsp;we&nbsp;treat&nbsp;functions&nbsp;like&nbsp;methods&nbsp;and&nbsp;collect&nbsp;them&nbsp;in&nbsp;method&nbsp;sets.</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4368723">//&nbsp;A&nbsp;methodSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;methods.&nbsp;Entries&nbsp;where&nbsp;Decl&nbsp;==&nbsp;nil&nbsp;are&nbsp;conflict</span><br>
<span class="lineno"></span><span class="comment" id="4368805">//&nbsp;entries&nbsp;(more&nbsp;then&nbsp;one&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;embedding&nbsp;level).</span><br>
<span class="lineno"></span><span class="comment" id="4368887">//</span><br>
<span class="lineno"></span><span class="keyword" id="4368890">type</span>&nbsp;<span class="ident" id="4368895">methodSet</span>&nbsp;<span class="keyword" id="4368905">map</span><span class="op" id="4368908">[</span><span class="builtintype" id="4368909">string</span><span class="op" id="4368915">]</span><span class="op" id="4368916">*</span><span class="ident" id="4368917">Func</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4368923">//&nbsp;recvString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;recv&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4368984">//&nbsp;form&nbsp;&#34;T&#34;,&nbsp;&#34;*T&#34;,&nbsp;or&nbsp;&#34;BADRECV&#34;&nbsp;(if&nbsp;not&nbsp;a&nbsp;proper&nbsp;receiver&nbsp;type).</span><br>
<span class="lineno"></span><span class="comment" id="4369049">//</span><br>
<span class="lineno"></span><span class="keyword" id="4369052">func</span>&nbsp;<span class="ident" id="4369057">recvString</span><span class="op" id="4369067">(</span><span class="ident" id="4369068">recv</span>&nbsp;<span class="ident" id="4369073">ast</span><span class="op" id="4369076">.</span><span class="ident" id="4369077">Expr</span><span class="op" id="4369081">)</span>&nbsp;<span class="builtintype" id="4369083">string</span>&nbsp;<span class="op" id="4369090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369093">switch</span>&nbsp;<span class="ident" id="4369100">t</span>&nbsp;<span class="op" id="4369102">:=</span>&nbsp;<span class="ident" id="4369105">recv</span><span class="op" id="4369109">.</span><span class="op" id="4369110">(</span><span class="keyword" id="4369111">type</span><span class="op" id="4369115">)</span>&nbsp;<span class="op" id="4369117">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369120">case</span>&nbsp;<span class="op" id="4369125">*</span><span class="ident" id="4369126">ast</span><span class="op" id="4369129">.</span><span class="ident" id="4369130">Ident</span><span class="op" id="4369135">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369139">return</span>&nbsp;<span class="ident" id="4369146">t</span><span class="op" id="4369147">.</span><span class="ident" id="4369148">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369154">case</span>&nbsp;<span class="op" id="4369159">*</span><span class="ident" id="4369160">ast</span><span class="op" id="4369163">.</span><span class="ident" id="4369164">StarExpr</span><span class="op" id="4369172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369176">return</span>&nbsp;<span class="string" id="4369183">&#34;*&#34;</span>&nbsp;<span class="op" id="4369187">+</span>&nbsp;<span class="ident" id="4369189">recvString</span><span class="op" id="4369199">(</span><span class="ident" id="4369200">t</span><span class="op" id="4369201">.</span><span class="ident" id="4369202">X</span><span class="op" id="4369203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369206">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369209">return</span>&nbsp;<span class="string" id="4369216">&#34;BADRECV&#34;</span><br>
<span class="lineno"></span><span class="op" id="4369226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4369229">//&nbsp;set&nbsp;creates&nbsp;the&nbsp;corresponding&nbsp;Func&nbsp;for&nbsp;f&nbsp;and&nbsp;adds&nbsp;it&nbsp;to&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="4369294">//&nbsp;If&nbsp;there&nbsp;are&nbsp;multiple&nbsp;f&#39;s&nbsp;with&nbsp;the&nbsp;same&nbsp;name,&nbsp;set&nbsp;keeps&nbsp;the&nbsp;first</span><br>
<span class="lineno">40</span><span class="comment" id="4369363">//&nbsp;one&nbsp;with&nbsp;documentation;&nbsp;conflicts&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="4369413">//</span><br>
<span class="lineno"></span><span class="keyword" id="4369416">func</span>&nbsp;<span class="op" id="4369421">(</span><span class="ident" id="4369422">mset</span>&nbsp;<span class="ident" id="4369427">methodSet</span><span class="op" id="4369436">)</span>&nbsp;<span class="ident" id="4369438">set</span><span class="op" id="4369441">(</span><span class="ident" id="4369442">f</span>&nbsp;<span class="op" id="4369444">*</span><span class="ident" id="4369445">ast</span><span class="op" id="4369448">.</span><span class="ident" id="4369449">FuncDecl</span><span class="op" id="4369457">)</span>&nbsp;<span class="op" id="4369459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369462">name</span>&nbsp;<span class="op" id="4369467">:=</span>&nbsp;<span class="ident" id="4369470">f</span><span class="op" id="4369471">.</span><span class="ident" id="4369472">Name</span><span class="op" id="4369476">.</span><span class="ident" id="4369477">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369483">if</span>&nbsp;<span class="ident" id="4369486">g</span>&nbsp;<span class="op" id="4369488">:=</span>&nbsp;<span class="ident" id="4369491">mset</span><span class="op" id="4369495">[</span><span class="ident" id="4369496">name</span><span class="op" id="4369500">]</span><span class="op" id="4369501">;</span>&nbsp;<span class="ident" id="4369503">g</span>&nbsp;<span class="op" id="4369505">!=</span>&nbsp;<span class="ident" id="4369508">nil</span>&nbsp;<span class="op" id="4369512">&amp;&amp;</span>&nbsp;<span class="ident" id="4369515">g</span><span class="op" id="4369516">.</span><span class="ident" id="4369517">Doc</span>&nbsp;<span class="op" id="4369521">!=</span>&nbsp;<span class="string" id="4369524">&#34;&#34;</span>&nbsp;<span class="op" id="4369527">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369531">//&nbsp;A&nbsp;function&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;has&nbsp;already&nbsp;been&nbsp;registered;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369595">//&nbsp;since&nbsp;it&nbsp;has&nbsp;documentation,&nbsp;assume&nbsp;f&nbsp;is&nbsp;simply&nbsp;another</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369655">//&nbsp;implementation&nbsp;and&nbsp;ignore&nbsp;it.&nbsp;This&nbsp;does&nbsp;not&nbsp;happen&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369718">//&nbsp;caller&nbsp;is&nbsp;using&nbsp;go/build.ScanDir&nbsp;to&nbsp;determine&nbsp;the&nbsp;list&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369781">//&nbsp;files&nbsp;implementing&nbsp;a&nbsp;package.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369816">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4369824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369827">//&nbsp;function&nbsp;doesn&#39;t&nbsp;exist&nbsp;or&nbsp;has&nbsp;no&nbsp;documentation;&nbsp;use&nbsp;f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4369885">recv</span>&nbsp;<span class="op" id="4369890">:=</span>&nbsp;<span class="string" id="4369893">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369897">if</span>&nbsp;<span class="ident" id="4369900">f</span><span class="op" id="4369901">.</span><span class="ident" id="4369902">Recv</span>&nbsp;<span class="op" id="4369907">!=</span>&nbsp;<span class="ident" id="4369910">nil</span>&nbsp;<span class="op" id="4369914">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369918">var</span>&nbsp;<span class="ident" id="4369922">typ</span>&nbsp;<span class="ident" id="4369926">ast</span><span class="op" id="4369929">.</span><span class="ident" id="4369930">Expr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4369937">//&nbsp;be&nbsp;careful&nbsp;in&nbsp;case&nbsp;of&nbsp;incorrect&nbsp;ASTs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4369979">if</span>&nbsp;<span class="ident" id="4369982">list</span>&nbsp;<span class="op" id="4369987">:=</span>&nbsp;<span class="ident" id="4369990">f</span><span class="op" id="4369991">.</span><span class="ident" id="4369992">Recv</span><span class="op" id="4369996">.</span><span class="ident" id="4369997">List</span><span class="op" id="4370001">;</span>&nbsp;<span class="builtinfunc" id="4370003">len</span><span class="op" id="4370006">(</span><span class="ident" id="4370007">list</span><span class="op" id="4370011">)</span>&nbsp;<span class="op" id="4370013">==</span>&nbsp;<span class="num" id="4370016">1</span>&nbsp;<span class="op" id="4370018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370023">typ</span>&nbsp;<span class="op" id="4370027">=</span>&nbsp;<span class="ident" id="4370029">list</span><span class="op" id="4370033">[</span><span class="num" id="4370034">0</span><span class="op" id="4370035">]</span><span class="op" id="4370036">.</span><span class="ident" id="4370037">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370044">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370048">recv</span>&nbsp;<span class="op" id="4370053">=</span>&nbsp;<span class="ident" id="4370055">recvString</span><span class="op" id="4370065">(</span><span class="ident" id="4370066">typ</span><span class="op" id="4370069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370075">mset</span><span class="op" id="4370079">[</span><span class="ident" id="4370080">name</span><span class="op" id="4370084">]</span>&nbsp;<span class="op" id="4370086">=</span>&nbsp;<span class="op" id="4370088">&amp;</span><span class="ident" id="4370089">Func</span><span class="op" id="4370093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370097">Doc</span><span class="op" id="4370100">:</span>&nbsp;&nbsp;<span class="ident" id="4370103">f</span><span class="op" id="4370104">.</span><span class="ident" id="4370105">Doc</span><span class="op" id="4370108">.</span><span class="ident" id="4370109">Text</span><span class="op" id="4370113">(</span><span class="op" id="4370114">)</span><span class="op" id="4370115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370119">Name</span><span class="op" id="4370123">:</span>&nbsp;<span class="ident" id="4370125">name</span><span class="op" id="4370129">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370133">Decl</span><span class="op" id="4370137">:</span>&nbsp;<span class="ident" id="4370139">f</span><span class="op" id="4370140">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370144">Recv</span><span class="op" id="4370148">:</span>&nbsp;<span class="ident" id="4370150">recv</span><span class="op" id="4370154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370158">Orig</span><span class="op" id="4370162">:</span>&nbsp;<span class="ident" id="4370164">recv</span><span class="op" id="4370168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370174">f</span><span class="op" id="4370175">.</span><span class="ident" id="4370176">Doc</span>&nbsp;<span class="op" id="4370180">=</span>&nbsp;<span class="ident" id="4370182">nil</span>&nbsp;<span class="comment" id="4370186">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno">70</span><span class="op" id="4370220">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4370223">//&nbsp;add&nbsp;adds&nbsp;method&nbsp;m&nbsp;to&nbsp;the&nbsp;method&nbsp;set;&nbsp;m&nbsp;is&nbsp;ignored&nbsp;if&nbsp;the&nbsp;method&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4370294">//&nbsp;already&nbsp;contains&nbsp;a&nbsp;method&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;at&nbsp;the&nbsp;same&nbsp;or&nbsp;a&nbsp;higher</span><br>
<span class="lineno"></span><span class="comment" id="4370366">//&nbsp;level&nbsp;then&nbsp;m.</span><br>
<span class="lineno">75</span><span class="comment" id="4370383">//</span><br>
<span class="lineno"></span><span class="keyword" id="4370386">func</span>&nbsp;<span class="op" id="4370391">(</span><span class="ident" id="4370392">mset</span>&nbsp;<span class="ident" id="4370397">methodSet</span><span class="op" id="4370406">)</span>&nbsp;<span class="ident" id="4370408">add</span><span class="op" id="4370411">(</span><span class="ident" id="4370412">m</span>&nbsp;<span class="op" id="4370414">*</span><span class="ident" id="4370415">Func</span><span class="op" id="4370419">)</span>&nbsp;<span class="op" id="4370421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370424">old</span>&nbsp;<span class="op" id="4370428">:=</span>&nbsp;<span class="ident" id="4370431">mset</span><span class="op" id="4370435">[</span><span class="ident" id="4370436">m</span><span class="op" id="4370437">.</span><span class="ident" id="4370438">Name</span><span class="op" id="4370442">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370445">if</span>&nbsp;<span class="ident" id="4370448">old</span>&nbsp;<span class="op" id="4370452">==</span>&nbsp;<span class="ident" id="4370455">nil</span>&nbsp;<span class="op" id="4370459">||</span>&nbsp;<span class="ident" id="4370462">m</span><span class="op" id="4370463">.</span><span class="ident" id="4370464">Level</span>&nbsp;<span class="op" id="4370470">&lt;</span>&nbsp;<span class="ident" id="4370472">old</span><span class="op" id="4370475">.</span><span class="ident" id="4370476">Level</span>&nbsp;<span class="op" id="4370482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370486">mset</span><span class="op" id="4370490">[</span><span class="ident" id="4370491">m</span><span class="op" id="4370492">.</span><span class="ident" id="4370493">Name</span><span class="op" id="4370497">]</span>&nbsp;<span class="op" id="4370499">=</span>&nbsp;<span class="ident" id="4370501">m</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370505">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370516">if</span>&nbsp;<span class="ident" id="4370519">old</span>&nbsp;<span class="op" id="4370523">!=</span>&nbsp;<span class="ident" id="4370526">nil</span>&nbsp;<span class="op" id="4370530">&amp;&amp;</span>&nbsp;<span class="ident" id="4370533">m</span><span class="op" id="4370534">.</span><span class="ident" id="4370535">Level</span>&nbsp;<span class="op" id="4370541">==</span>&nbsp;<span class="ident" id="4370544">old</span><span class="op" id="4370547">.</span><span class="ident" id="4370548">Level</span>&nbsp;<span class="op" id="4370554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4370558">//&nbsp;conflict&nbsp;-&nbsp;mark&nbsp;it&nbsp;using&nbsp;a&nbsp;method&nbsp;with&nbsp;nil&nbsp;Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370611">mset</span><span class="op" id="4370615">[</span><span class="ident" id="4370616">m</span><span class="op" id="4370617">.</span><span class="ident" id="4370618">Name</span><span class="op" id="4370622">]</span>&nbsp;<span class="op" id="4370624">=</span>&nbsp;<span class="op" id="4370626">&amp;</span><span class="ident" id="4370627">Func</span><span class="op" id="4370631">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370636">Name</span><span class="op" id="4370640">:</span>&nbsp;&nbsp;<span class="ident" id="4370643">m</span><span class="op" id="4370644">.</span><span class="ident" id="4370645">Name</span><span class="op" id="4370649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4370654">Level</span><span class="op" id="4370659">:</span>&nbsp;<span class="ident" id="4370661">m</span><span class="op" id="4370662">.</span><span class="ident" id="4370663">Level</span><span class="op" id="4370668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4370675">}</span><br>
<span class="lineno"></span><span class="op" id="4370677">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4370680">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4370760">//&nbsp;Named&nbsp;types</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4370776">//&nbsp;baseTypeName&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;base&nbsp;type&nbsp;of&nbsp;x&nbsp;(or&nbsp;&#34;&#34;)</span><br>
<span class="lineno">95</span><span class="comment" id="4370839">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;type&nbsp;is&nbsp;imported&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span><span class="comment" id="4370883">//</span><br>
<span class="lineno"></span><span class="keyword" id="4370886">func</span>&nbsp;<span class="ident" id="4370891">baseTypeName</span><span class="op" id="4370903">(</span><span class="ident" id="4370904">x</span>&nbsp;<span class="ident" id="4370906">ast</span><span class="op" id="4370909">.</span><span class="ident" id="4370910">Expr</span><span class="op" id="4370914">)</span>&nbsp;<span class="op" id="4370916">(</span><span class="ident" id="4370917">name</span>&nbsp;<span class="builtintype" id="4370922">string</span><span class="op" id="4370928">,</span>&nbsp;<span class="ident" id="4370930">imported</span>&nbsp;<span class="builtintype" id="4370939">bool</span><span class="op" id="4370943">)</span>&nbsp;<span class="op" id="4370945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370948">switch</span>&nbsp;<span class="ident" id="4370955">t</span>&nbsp;<span class="op" id="4370957">:=</span>&nbsp;<span class="ident" id="4370960">x</span><span class="op" id="4370961">.</span><span class="op" id="4370962">(</span><span class="keyword" id="4370963">type</span><span class="op" id="4370967">)</span>&nbsp;<span class="op" id="4370969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370972">case</span>&nbsp;<span class="op" id="4370977">*</span><span class="ident" id="4370978">ast</span><span class="op" id="4370981">.</span><span class="ident" id="4370982">Ident</span><span class="op" id="4370987">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4370991">return</span>&nbsp;<span class="ident" id="4370998">t</span><span class="op" id="4370999">.</span><span class="ident" id="4371000">Name</span><span class="op" id="4371004">,</span>&nbsp;<span class="builtintype" id="4371006">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371013">case</span>&nbsp;<span class="op" id="4371018">*</span><span class="ident" id="4371019">ast</span><span class="op" id="4371022">.</span><span class="ident" id="4371023">SelectorExpr</span><span class="op" id="4371035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371039">if</span>&nbsp;<span class="ident" id="4371042">_</span><span class="op" id="4371043">,</span>&nbsp;<span class="ident" id="4371045">ok</span>&nbsp;<span class="op" id="4371048">:=</span>&nbsp;<span class="ident" id="4371051">t</span><span class="op" id="4371052">.</span><span class="ident" id="4371053">X</span><span class="op" id="4371054">.</span><span class="op" id="4371055">(</span><span class="op" id="4371056">*</span><span class="ident" id="4371057">ast</span><span class="op" id="4371060">.</span><span class="ident" id="4371061">Ident</span><span class="op" id="4371066">)</span><span class="op" id="4371067">;</span>&nbsp;<span class="ident" id="4371069">ok</span>&nbsp;<span class="op" id="4371072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371077">//&nbsp;only&nbsp;possible&nbsp;for&nbsp;qualified&nbsp;type&nbsp;names;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371123">//&nbsp;assume&nbsp;type&nbsp;is&nbsp;imported</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371153">return</span>&nbsp;<span class="ident" id="4371160">t</span><span class="op" id="4371161">.</span><span class="ident" id="4371162">Sel</span><span class="op" id="4371165">.</span><span class="ident" id="4371166">Name</span><span class="op" id="4371170">,</span>&nbsp;<span class="builtintype" id="4371172">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371182">case</span>&nbsp;<span class="op" id="4371187">*</span><span class="ident" id="4371188">ast</span><span class="op" id="4371191">.</span><span class="ident" id="4371192">StarExpr</span><span class="op" id="4371200">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371204">return</span>&nbsp;<span class="ident" id="4371211">baseTypeName</span><span class="op" id="4371223">(</span><span class="ident" id="4371224">t</span><span class="op" id="4371225">.</span><span class="ident" id="4371226">X</span><span class="op" id="4371227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4371230">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4371233">return</span><br>
<span class="lineno"></span><span class="op" id="4371240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4371243">//&nbsp;An&nbsp;embeddedSet&nbsp;describes&nbsp;a&nbsp;set&nbsp;of&nbsp;embedded&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4371296">type</span>&nbsp;<span class="ident" id="4371301">embeddedSet</span>&nbsp;<span class="keyword" id="4371313">map</span><span class="op" id="4371316">[</span><span class="op" id="4371317">*</span><span class="ident" id="4371318">namedType</span><span class="op" id="4371327">]</span><span class="builtintype" id="4371328">bool</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="4371334">//&nbsp;A&nbsp;namedType&nbsp;represents&nbsp;a&nbsp;named&nbsp;unqualified&nbsp;(package&nbsp;local,&nbsp;or&nbsp;possibly</span><br>
<span class="lineno"></span><span class="comment" id="4371408">//&nbsp;predeclared)&nbsp;type.&nbsp;The&nbsp;namedType&nbsp;for&nbsp;a&nbsp;type&nbsp;name&nbsp;is&nbsp;always&nbsp;found&nbsp;via</span><br>
<span class="lineno"></span><span class="comment" id="4371480">//&nbsp;reader.lookupType.</span><br>
<span class="lineno"></span><span class="comment" id="4371502">//</span><br>
<span class="lineno">120</span><span class="keyword" id="4371505">type</span>&nbsp;<span class="ident" id="4371510">namedType</span>&nbsp;<span class="keyword" id="4371520">struct</span>&nbsp;<span class="op" id="4371527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371530">doc</span>&nbsp;&nbsp;<span class="builtintype" id="4371535">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4371548">//&nbsp;doc&nbsp;comment&nbsp;for&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371573">name</span>&nbsp;<span class="builtintype" id="4371578">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4371591">//&nbsp;type&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371605">decl</span>&nbsp;<span class="op" id="4371610">*</span><span class="ident" id="4371611">ast</span><span class="op" id="4371614">.</span><span class="ident" id="4371615">GenDecl</span>&nbsp;<span class="comment" id="4371623">//&nbsp;nil&nbsp;if&nbsp;declaration&nbsp;hasn&#39;t&nbsp;been&nbsp;seen&nbsp;yet</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371668">isEmbedded</span>&nbsp;<span class="builtintype" id="4371679">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4371691">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371725">isStruct</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4371736">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4371748">//&nbsp;true&nbsp;if&nbsp;this&nbsp;type&nbsp;is&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371782">embedded</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4371793">embeddedSet</span>&nbsp;<span class="comment" id="4371805">//&nbsp;true&nbsp;if&nbsp;the&nbsp;embedded&nbsp;type&nbsp;is&nbsp;a&nbsp;pointer</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4371849">//&nbsp;associated&nbsp;declarations</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371877">values</span>&nbsp;&nbsp;<span class="op" id="4371885">[</span><span class="op" id="4371886">]</span><span class="op" id="4371887">*</span><span class="ident" id="4371888">Value</span>&nbsp;<span class="comment" id="4371894">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371914">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4371922">methodSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4371933">methods</span>&nbsp;<span class="ident" id="4371941">methodSet</span><br>
<span class="lineno"></span><span class="op" id="4371951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4371954">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4372034">//&nbsp;AST&nbsp;reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4372049">//&nbsp;reader&nbsp;accumulates&nbsp;documentation&nbsp;for&nbsp;a&nbsp;single&nbsp;package.</span><br>
<span class="lineno"></span><span class="comment" id="4372107">//&nbsp;It&nbsp;modifies&nbsp;the&nbsp;AST:&nbsp;Comments&nbsp;(declaration&nbsp;documentation)</span><br>
<span class="lineno">140</span><span class="comment" id="4372168">//&nbsp;that&nbsp;have&nbsp;been&nbsp;collected&nbsp;by&nbsp;the&nbsp;reader&nbsp;are&nbsp;set&nbsp;to&nbsp;nil</span><br>
<span class="lineno"></span><span class="comment" id="4372225">//&nbsp;in&nbsp;the&nbsp;respective&nbsp;AST&nbsp;nodes&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;printed</span><br>
<span class="lineno"></span><span class="comment" id="4372285">//&nbsp;twice&nbsp;(once&nbsp;when&nbsp;printing&nbsp;the&nbsp;documentation&nbsp;and&nbsp;once&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="4372346">//&nbsp;printing&nbsp;the&nbsp;corresponding&nbsp;AST&nbsp;node).</span><br>
<span class="lineno"></span><span class="comment" id="4372387">//</span><br>
<span class="lineno">145</span><span class="keyword" id="4372390">type</span>&nbsp;<span class="ident" id="4372395">reader</span>&nbsp;<span class="keyword" id="4372402">struct</span>&nbsp;<span class="op" id="4372409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372412">mode</span>&nbsp;<span class="ident" id="4372417">Mode</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4372424">//&nbsp;package&nbsp;properties</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372447">doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4372457">string</span>&nbsp;<span class="comment" id="4372464">//&nbsp;package&nbsp;documentation,&nbsp;if&nbsp;any</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372498">filenames</span>&nbsp;<span class="op" id="4372508">[</span><span class="op" id="4372509">]</span><span class="builtintype" id="4372510">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372518">notes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372528">map</span><span class="op" id="4372531">[</span><span class="builtintype" id="4372532">string</span><span class="op" id="4372538">]</span><span class="op" id="4372539">[</span><span class="op" id="4372540">]</span><span class="op" id="4372541">*</span><span class="ident" id="4372542">Note</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4372549">//&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372566">imports</span>&nbsp;<span class="keyword" id="4372574">map</span><span class="op" id="4372577">[</span><span class="builtintype" id="4372578">string</span><span class="op" id="4372584">]</span><span class="builtintype" id="4372585">int</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372590">values</span>&nbsp;&nbsp;<span class="op" id="4372598">[</span><span class="op" id="4372599">]</span><span class="op" id="4372600">*</span><span class="ident" id="4372601">Value</span>&nbsp;<span class="comment" id="4372607">//&nbsp;consts&nbsp;and&nbsp;vars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372627">types</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4372635">map</span><span class="op" id="4372638">[</span><span class="builtintype" id="4372639">string</span><span class="op" id="4372645">]</span><span class="op" id="4372646">*</span><span class="ident" id="4372647">namedType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372658">funcs</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4372666">methodSet</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4372678">//&nbsp;support&nbsp;for&nbsp;package-local&nbsp;error&nbsp;type&nbsp;declarations</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372732">errorDecl</span>&nbsp;<span class="builtintype" id="4372742">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4372763">//&nbsp;if&nbsp;set,&nbsp;type&nbsp;&#34;error&#34;&nbsp;was&nbsp;declared&nbsp;locally</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4372809">fixlist</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4372819">[</span><span class="op" id="4372820">]</span><span class="op" id="4372821">*</span><span class="ident" id="4372822">ast</span><span class="op" id="4372825">.</span><span class="ident" id="4372826">InterfaceType</span>&nbsp;<span class="comment" id="4372840">//&nbsp;list&nbsp;of&nbsp;interfaces&nbsp;containing&nbsp;anonymous&nbsp;field&nbsp;&#34;error&#34;</span><br>
<span class="lineno"></span><span class="op" id="4372897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4372900">func</span>&nbsp;<span class="op" id="4372905">(</span><span class="ident" id="4372906">r</span>&nbsp;<span class="op" id="4372908">*</span><span class="ident" id="4372909">reader</span><span class="op" id="4372915">)</span>&nbsp;<span class="ident" id="4372917">isVisible</span><span class="op" id="4372926">(</span><span class="ident" id="4372927">name</span>&nbsp;<span class="builtintype" id="4372932">string</span><span class="op" id="4372938">)</span>&nbsp;<span class="builtintype" id="4372940">bool</span>&nbsp;<span class="op" id="4372945">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4372948">return</span>&nbsp;<span class="ident" id="4372955">r</span><span class="op" id="4372956">.</span><span class="ident" id="4372957">mode</span><span class="op" id="4372961">&amp;</span><span class="ident" id="4372962">AllDecls</span>&nbsp;<span class="op" id="4372971">!=</span>&nbsp;<span class="num" id="4372974">0</span>&nbsp;<span class="op" id="4372976">||</span>&nbsp;<span class="ident" id="4372979">ast</span><span class="op" id="4372982">.</span><span class="ident" id="4372983">IsExported</span><span class="op" id="4372993">(</span><span class="ident" id="4372994">name</span><span class="op" id="4372998">)</span><br>
<span class="lineno"></span><span class="op" id="4373000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4373003">//&nbsp;lookupType&nbsp;returns&nbsp;the&nbsp;base&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4373060">//&nbsp;If&nbsp;the&nbsp;base&nbsp;type&nbsp;has&nbsp;not&nbsp;been&nbsp;encountered&nbsp;yet,&nbsp;a&nbsp;new</span><br>
<span class="lineno">170</span><span class="comment" id="4373116">//&nbsp;type&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;but&nbsp;no&nbsp;associated&nbsp;declaration</span><br>
<span class="lineno"></span><span class="comment" id="4373174">//&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;type&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4373203">//</span><br>
<span class="lineno"></span><span class="keyword" id="4373206">func</span>&nbsp;<span class="op" id="4373211">(</span><span class="ident" id="4373212">r</span>&nbsp;<span class="op" id="4373214">*</span><span class="ident" id="4373215">reader</span><span class="op" id="4373221">)</span>&nbsp;<span class="ident" id="4373223">lookupType</span><span class="op" id="4373233">(</span><span class="ident" id="4373234">name</span>&nbsp;<span class="builtintype" id="4373239">string</span><span class="op" id="4373245">)</span>&nbsp;<span class="op" id="4373247">*</span><span class="ident" id="4373248">namedType</span>&nbsp;<span class="op" id="4373258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373261">if</span>&nbsp;<span class="ident" id="4373264">name</span>&nbsp;<span class="op" id="4373269">==</span>&nbsp;<span class="string" id="4373272">&#34;&#34;</span>&nbsp;<span class="op" id="4373275">||</span>&nbsp;<span class="ident" id="4373278">name</span>&nbsp;<span class="op" id="4373283">==</span>&nbsp;<span class="string" id="4373286">&#34;_&#34;</span>&nbsp;<span class="op" id="4373290">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373294">return</span>&nbsp;<span class="ident" id="4373301">nil</span>&nbsp;<span class="comment" id="4373305">//&nbsp;no&nbsp;type&nbsp;docs&nbsp;for&nbsp;anonymous&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373345">if</span>&nbsp;<span class="ident" id="4373348">typ</span><span class="op" id="4373351">,</span>&nbsp;<span class="ident" id="4373353">found</span>&nbsp;<span class="op" id="4373359">:=</span>&nbsp;<span class="ident" id="4373362">r</span><span class="op" id="4373363">.</span><span class="ident" id="4373364">types</span><span class="op" id="4373369">[</span><span class="ident" id="4373370">name</span><span class="op" id="4373374">]</span><span class="op" id="4373375">;</span>&nbsp;<span class="ident" id="4373377">found</span>&nbsp;<span class="op" id="4373383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373387">return</span>&nbsp;<span class="ident" id="4373394">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373399">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4373402">//&nbsp;type&nbsp;not&nbsp;found&nbsp;-&nbsp;add&nbsp;one&nbsp;without&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373451">typ</span>&nbsp;<span class="op" id="4373455">:=</span>&nbsp;<span class="op" id="4373458">&amp;</span><span class="ident" id="4373459">namedType</span><span class="op" id="4373468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373472">name</span><span class="op" id="4373476">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4373482">name</span><span class="op" id="4373486">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373490">embedded</span><span class="op" id="4373498">:</span>&nbsp;<span class="builtinfunc" id="4373500">make</span><span class="op" id="4373504">(</span><span class="ident" id="4373505">embeddedSet</span><span class="op" id="4373516">)</span><span class="op" id="4373517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373521">funcs</span><span class="op" id="4373526">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4373531">make</span><span class="op" id="4373535">(</span><span class="ident" id="4373536">methodSet</span><span class="op" id="4373545">)</span><span class="op" id="4373546">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373550">methods</span><span class="op" id="4373557">:</span>&nbsp;&nbsp;<span class="builtinfunc" id="4373560">make</span><span class="op" id="4373564">(</span><span class="ident" id="4373565">methodSet</span><span class="op" id="4373574">)</span><span class="op" id="4373575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4373578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373581">r</span><span class="op" id="4373582">.</span><span class="ident" id="4373583">types</span><span class="op" id="4373588">[</span><span class="ident" id="4373589">name</span><span class="op" id="4373593">]</span>&nbsp;<span class="op" id="4373595">=</span>&nbsp;<span class="ident" id="4373597">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373602">return</span>&nbsp;<span class="ident" id="4373609">typ</span><br>
<span class="lineno"></span><span class="op" id="4373613">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4373616">//&nbsp;recordAnonymousField&nbsp;registers&nbsp;fieldType&nbsp;as&nbsp;the&nbsp;type&nbsp;of&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4373678">//&nbsp;anonymous&nbsp;field&nbsp;in&nbsp;the&nbsp;parent&nbsp;type.&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;imported</span><br>
<span class="lineno"></span><span class="comment" id="4373742">//&nbsp;(qualified&nbsp;name)&nbsp;or&nbsp;the&nbsp;parent&nbsp;is&nbsp;nil,&nbsp;the&nbsp;field&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="comment" id="4373806">//&nbsp;The&nbsp;function&nbsp;returns&nbsp;the&nbsp;field&nbsp;name.</span><br>
<span class="lineno">195</span><span class="comment" id="4373846">//</span><br>
<span class="lineno"></span><span class="keyword" id="4373849">func</span>&nbsp;<span class="op" id="4373854">(</span><span class="ident" id="4373855">r</span>&nbsp;<span class="op" id="4373857">*</span><span class="ident" id="4373858">reader</span><span class="op" id="4373864">)</span>&nbsp;<span class="ident" id="4373866">recordAnonymousField</span><span class="op" id="4373886">(</span><span class="ident" id="4373887">parent</span>&nbsp;<span class="op" id="4373894">*</span><span class="ident" id="4373895">namedType</span><span class="op" id="4373904">,</span>&nbsp;<span class="ident" id="4373906">fieldType</span>&nbsp;<span class="ident" id="4373916">ast</span><span class="op" id="4373919">.</span><span class="ident" id="4373920">Expr</span><span class="op" id="4373924">)</span>&nbsp;<span class="op" id="4373926">(</span><span class="ident" id="4373927">fname</span>&nbsp;<span class="builtintype" id="4373933">string</span><span class="op" id="4373939">)</span>&nbsp;<span class="op" id="4373941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4373944">fname</span><span class="op" id="4373949">,</span>&nbsp;<span class="ident" id="4373951">imp</span>&nbsp;<span class="op" id="4373955">:=</span>&nbsp;<span class="ident" id="4373958">baseTypeName</span><span class="op" id="4373970">(</span><span class="ident" id="4373971">fieldType</span><span class="op" id="4373980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4373983">if</span>&nbsp;<span class="ident" id="4373986">parent</span>&nbsp;<span class="op" id="4373993">==</span>&nbsp;<span class="ident" id="4373996">nil</span>&nbsp;<span class="op" id="4374000">||</span>&nbsp;<span class="ident" id="4374003">imp</span>&nbsp;<span class="op" id="4374007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374011">return</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374019">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374022">if</span>&nbsp;<span class="ident" id="4374025">ftype</span>&nbsp;<span class="op" id="4374031">:=</span>&nbsp;<span class="ident" id="4374034">r</span><span class="op" id="4374035">.</span><span class="ident" id="4374036">lookupType</span><span class="op" id="4374046">(</span><span class="ident" id="4374047">fname</span><span class="op" id="4374052">)</span><span class="op" id="4374053">;</span>&nbsp;<span class="ident" id="4374055">ftype</span>&nbsp;<span class="op" id="4374061">!=</span>&nbsp;<span class="ident" id="4374064">nil</span>&nbsp;<span class="op" id="4374068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374072">ftype</span><span class="op" id="4374077">.</span><span class="ident" id="4374078">isEmbedded</span>&nbsp;<span class="op" id="4374089">=</span>&nbsp;<span class="builtintype" id="4374091">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374098">_</span><span class="op" id="4374099">,</span>&nbsp;<span class="ident" id="4374101">ptr</span>&nbsp;<span class="op" id="4374105">:=</span>&nbsp;<span class="ident" id="4374108">fieldType</span><span class="op" id="4374117">.</span><span class="op" id="4374118">(</span><span class="op" id="4374119">*</span><span class="ident" id="4374120">ast</span><span class="op" id="4374123">.</span><span class="ident" id="4374124">StarExpr</span><span class="op" id="4374132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374136">parent</span><span class="op" id="4374142">.</span><span class="ident" id="4374143">embedded</span><span class="op" id="4374151">[</span><span class="ident" id="4374152">ftype</span><span class="op" id="4374157">]</span>&nbsp;<span class="op" id="4374159">=</span>&nbsp;<span class="ident" id="4374161">ptr</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374169">return</span><br>
<span class="lineno"></span><span class="op" id="4374176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4374179">func</span>&nbsp;<span class="op" id="4374184">(</span><span class="ident" id="4374185">r</span>&nbsp;<span class="op" id="4374187">*</span><span class="ident" id="4374188">reader</span><span class="op" id="4374194">)</span>&nbsp;<span class="ident" id="4374196">readDoc</span><span class="op" id="4374203">(</span><span class="ident" id="4374204">comment</span>&nbsp;<span class="op" id="4374212">*</span><span class="ident" id="4374213">ast</span><span class="op" id="4374216">.</span><span class="ident" id="4374217">CommentGroup</span><span class="op" id="4374229">)</span>&nbsp;<span class="op" id="4374231">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4374234">//&nbsp;By&nbsp;convention&nbsp;there&nbsp;should&nbsp;be&nbsp;only&nbsp;one&nbsp;package&nbsp;comment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4374293">//&nbsp;but&nbsp;collect&nbsp;all&nbsp;of&nbsp;them&nbsp;if&nbsp;there&nbsp;are&nbsp;more&nbsp;then&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374349">text</span>&nbsp;<span class="op" id="4374354">:=</span>&nbsp;<span class="ident" id="4374357">comment</span><span class="op" id="4374364">.</span><span class="ident" id="4374365">Text</span><span class="op" id="4374369">(</span><span class="op" id="4374370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374373">if</span>&nbsp;<span class="ident" id="4374376">r</span><span class="op" id="4374377">.</span><span class="ident" id="4374378">doc</span>&nbsp;<span class="op" id="4374382">==</span>&nbsp;<span class="string" id="4374385">&#34;&#34;</span>&nbsp;<span class="op" id="4374388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374392">r</span><span class="op" id="4374393">.</span><span class="ident" id="4374394">doc</span>&nbsp;<span class="op" id="4374398">=</span>&nbsp;<span class="ident" id="4374400">text</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374407">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374418">r</span><span class="op" id="4374419">.</span><span class="ident" id="4374420">doc</span>&nbsp;<span class="op" id="4374424">+=</span>&nbsp;<span class="string" id="4374427">&#34;\n&#34;</span>&nbsp;<span class="op" id="4374432">+</span>&nbsp;<span class="ident" id="4374434">text</span><br>
<span class="lineno"></span><span class="op" id="4374439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4374442">func</span>&nbsp;<span class="op" id="4374447">(</span><span class="ident" id="4374448">r</span>&nbsp;<span class="op" id="4374450">*</span><span class="ident" id="4374451">reader</span><span class="op" id="4374457">)</span>&nbsp;<span class="ident" id="4374459">remember</span><span class="op" id="4374467">(</span><span class="ident" id="4374468">typ</span>&nbsp;<span class="op" id="4374472">*</span><span class="ident" id="4374473">ast</span><span class="op" id="4374476">.</span><span class="ident" id="4374477">InterfaceType</span><span class="op" id="4374490">)</span>&nbsp;<span class="op" id="4374492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374495">r</span><span class="op" id="4374496">.</span><span class="ident" id="4374497">fixlist</span>&nbsp;<span class="op" id="4374505">=</span>&nbsp;<span class="builtinfunc" id="4374507">append</span><span class="op" id="4374513">(</span><span class="ident" id="4374514">r</span><span class="op" id="4374515">.</span><span class="ident" id="4374516">fixlist</span><span class="op" id="4374523">,</span>&nbsp;<span class="ident" id="4374525">typ</span><span class="op" id="4374528">)</span><br>
<span class="lineno"></span><span class="op" id="4374530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4374533">func</span>&nbsp;<span class="ident" id="4374538">specNames</span><span class="op" id="4374547">(</span><span class="ident" id="4374548">specs</span>&nbsp;<span class="op" id="4374554">[</span><span class="op" id="4374555">]</span><span class="ident" id="4374556">ast</span><span class="op" id="4374559">.</span><span class="ident" id="4374560">Spec</span><span class="op" id="4374564">)</span>&nbsp;<span class="op" id="4374566">[</span><span class="op" id="4374567">]</span><span class="builtintype" id="4374568">string</span>&nbsp;<span class="op" id="4374575">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374578">names</span>&nbsp;<span class="op" id="4374584">:=</span>&nbsp;<span class="builtinfunc" id="4374587">make</span><span class="op" id="4374591">(</span><span class="op" id="4374592">[</span><span class="op" id="4374593">]</span><span class="builtintype" id="4374594">string</span><span class="op" id="4374600">,</span>&nbsp;<span class="num" id="4374602">0</span><span class="op" id="4374603">,</span>&nbsp;<span class="builtinfunc" id="4374605">len</span><span class="op" id="4374608">(</span><span class="ident" id="4374609">specs</span><span class="op" id="4374614">)</span><span class="op" id="4374615">)</span>&nbsp;<span class="comment" id="4374617">//&nbsp;reasonable&nbsp;estimate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374641">for</span>&nbsp;<span class="ident" id="4374645">_</span><span class="op" id="4374646">,</span>&nbsp;<span class="ident" id="4374648">s</span>&nbsp;<span class="op" id="4374650">:=</span>&nbsp;<span class="keyword" id="4374653">range</span>&nbsp;<span class="ident" id="4374659">specs</span>&nbsp;<span class="op" id="4374665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4374669">//&nbsp;s&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;an&nbsp;*ast.ValueSpec&nbsp;by&nbsp;readValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374724">for</span>&nbsp;<span class="ident" id="4374728">_</span><span class="op" id="4374729">,</span>&nbsp;<span class="ident" id="4374731">ident</span>&nbsp;<span class="op" id="4374737">:=</span>&nbsp;<span class="keyword" id="4374740">range</span>&nbsp;<span class="ident" id="4374746">s</span><span class="op" id="4374747">.</span><span class="op" id="4374748">(</span><span class="op" id="4374749">*</span><span class="ident" id="4374750">ast</span><span class="op" id="4374753">.</span><span class="ident" id="4374754">ValueSpec</span><span class="op" id="4374763">)</span><span class="op" id="4374764">.</span><span class="ident" id="4374765">Names</span>&nbsp;<span class="op" id="4374771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4374776">names</span>&nbsp;<span class="op" id="4374782">=</span>&nbsp;<span class="builtinfunc" id="4374784">append</span><span class="op" id="4374790">(</span><span class="ident" id="4374791">names</span><span class="op" id="4374796">,</span>&nbsp;<span class="ident" id="4374798">ident</span><span class="op" id="4374803">.</span><span class="ident" id="4374804">Name</span><span class="op" id="4374808">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4374815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4374818">return</span>&nbsp;<span class="ident" id="4374825">names</span><br>
<span class="lineno"></span><span class="op" id="4374831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="4374834">//&nbsp;readValue&nbsp;processes&nbsp;a&nbsp;const&nbsp;or&nbsp;var&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="4374885">//</span><br>
<span class="lineno"></span><span class="keyword" id="4374888">func</span>&nbsp;<span class="op" id="4374893">(</span><span class="ident" id="4374894">r</span>&nbsp;<span class="op" id="4374896">*</span><span class="ident" id="4374897">reader</span><span class="op" id="4374903">)</span>&nbsp;<span class="ident" id="4374905">readValue</span><span class="op" id="4374914">(</span><span class="ident" id="4374915">decl</span>&nbsp;<span class="op" id="4374920">*</span><span class="ident" id="4374921">ast</span><span class="op" id="4374924">.</span><span class="ident" id="4374925">GenDecl</span><span class="op" id="4374932">)</span>&nbsp;<span class="op" id="4374934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4374937">//&nbsp;determine&nbsp;if&nbsp;decl&nbsp;should&nbsp;be&nbsp;associated&nbsp;with&nbsp;a&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4374992">//&nbsp;Heuristic:&nbsp;For&nbsp;each&nbsp;typed&nbsp;entry,&nbsp;determine&nbsp;the&nbsp;type&nbsp;name,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;exactly&nbsp;one&nbsp;type&nbsp;name&nbsp;that&nbsp;is&nbsp;sufficiently</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequent,&nbsp;associate&nbsp;the&nbsp;decl&nbsp;with&nbsp;the&nbsp;respective&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375202">domName</span>&nbsp;<span class="op" id="4375210">:=</span>&nbsp;<span class="string" id="4375213">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375217">domFreq</span>&nbsp;<span class="op" id="4375225">:=</span>&nbsp;<span class="num" id="4375228">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375231">prev</span>&nbsp;<span class="op" id="4375236">:=</span>&nbsp;<span class="string" id="4375239">&#34;&#34;</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375243">n</span>&nbsp;<span class="op" id="4375245">:=</span>&nbsp;<span class="num" id="4375248">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375251">for</span>&nbsp;<span class="ident" id="4375255">_</span><span class="op" id="4375256">,</span>&nbsp;<span class="ident" id="4375258">spec</span>&nbsp;<span class="op" id="4375263">:=</span>&nbsp;<span class="keyword" id="4375266">range</span>&nbsp;<span class="ident" id="4375272">decl</span><span class="op" id="4375276">.</span><span class="ident" id="4375277">Specs</span>&nbsp;<span class="op" id="4375283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375287">s</span><span class="op" id="4375288">,</span>&nbsp;<span class="ident" id="4375290">ok</span>&nbsp;<span class="op" id="4375293">:=</span>&nbsp;<span class="ident" id="4375296">spec</span><span class="op" id="4375300">.</span><span class="op" id="4375301">(</span><span class="op" id="4375302">*</span><span class="ident" id="4375303">ast</span><span class="op" id="4375306">.</span><span class="ident" id="4375307">ValueSpec</span><span class="op" id="4375316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375320">if</span>&nbsp;<span class="op" id="4375323">!</span><span class="ident" id="4375324">ok</span>&nbsp;<span class="op" id="4375327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375332">continue</span>&nbsp;<span class="comment" id="4375341">//&nbsp;should&nbsp;not&nbsp;happen,&nbsp;but&nbsp;be&nbsp;conservative</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375389">name</span>&nbsp;<span class="op" id="4375394">:=</span>&nbsp;<span class="string" id="4375397">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375402">switch</span>&nbsp;<span class="op" id="4375409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375413">case</span>&nbsp;<span class="ident" id="4375418">s</span><span class="op" id="4375419">.</span><span class="ident" id="4375420">Type</span>&nbsp;<span class="op" id="4375425">!=</span>&nbsp;<span class="ident" id="4375428">nil</span><span class="op" id="4375431">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375436">//&nbsp;a&nbsp;type&nbsp;is&nbsp;present;&nbsp;determine&nbsp;its&nbsp;name</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375480">if</span>&nbsp;<span class="ident" id="4375483">n</span><span class="op" id="4375484">,</span>&nbsp;<span class="ident" id="4375486">imp</span>&nbsp;<span class="op" id="4375490">:=</span>&nbsp;<span class="ident" id="4375493">baseTypeName</span><span class="op" id="4375505">(</span><span class="ident" id="4375506">s</span><span class="op" id="4375507">.</span><span class="ident" id="4375508">Type</span><span class="op" id="4375512">)</span><span class="op" id="4375513">;</span>&nbsp;<span class="op" id="4375515">!</span><span class="ident" id="4375516">imp</span>&nbsp;<span class="op" id="4375520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375526">name</span>&nbsp;<span class="op" id="4375531">=</span>&nbsp;<span class="ident" id="4375533">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375542">case</span>&nbsp;<span class="ident" id="4375547">decl</span><span class="op" id="4375551">.</span><span class="ident" id="4375552">Tok</span>&nbsp;<span class="op" id="4375556">==</span>&nbsp;<span class="ident" id="4375559">token</span><span class="op" id="4375564">.</span><span class="ident" id="4375565">CONST</span><span class="op" id="4375570">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375575">//&nbsp;no&nbsp;type&nbsp;is&nbsp;present&nbsp;but&nbsp;we&nbsp;have&nbsp;a&nbsp;constant&nbsp;declaration;</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375636">//&nbsp;use&nbsp;the&nbsp;previous&nbsp;type&nbsp;name&nbsp;(w/o&nbsp;more&nbsp;type&nbsp;information</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375696">//&nbsp;we&nbsp;cannot&nbsp;handle&nbsp;the&nbsp;case&nbsp;of&nbsp;unnamed&nbsp;variables&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375754">//&nbsp;initializer&nbsp;expressions&nbsp;except&nbsp;for&nbsp;some&nbsp;trivial&nbsp;cases)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375815">name</span>&nbsp;<span class="op" id="4375820">=</span>&nbsp;<span class="ident" id="4375822">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4375829">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375833">if</span>&nbsp;<span class="ident" id="4375836">name</span>&nbsp;<span class="op" id="4375841">!=</span>&nbsp;<span class="string" id="4375844">&#34;&#34;</span>&nbsp;<span class="op" id="4375847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375852">//&nbsp;entry&nbsp;has&nbsp;a&nbsp;named&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4375881">if</span>&nbsp;<span class="ident" id="4375884">domName</span>&nbsp;<span class="op" id="4375892">!=</span>&nbsp;<span class="string" id="4375895">&#34;&#34;</span>&nbsp;<span class="op" id="4375898">&amp;&amp;</span>&nbsp;<span class="ident" id="4375901">domName</span>&nbsp;<span class="op" id="4375909">!=</span>&nbsp;<span class="ident" id="4375912">name</span>&nbsp;<span class="op" id="4375917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375923">//&nbsp;more&nbsp;than&nbsp;one&nbsp;type&nbsp;name&nbsp;-&nbsp;do&nbsp;not&nbsp;associate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4375973">//&nbsp;with&nbsp;any&nbsp;type</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4375994">domName</span>&nbsp;<span class="op" id="4376002">=</span>&nbsp;<span class="string" id="4376004">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376011">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376025">domName</span>&nbsp;<span class="op" id="4376033">=</span>&nbsp;<span class="ident" id="4376035">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376043">domFreq</span><span class="op" id="4376050">++</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376059">prev</span>&nbsp;<span class="op" id="4376064">=</span>&nbsp;<span class="ident" id="4376066">name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376073">n</span><span class="op" id="4376074">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376078">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4376082">//&nbsp;nothing&nbsp;to&nbsp;do&nbsp;w/o&nbsp;a&nbsp;legal&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376124">if</span>&nbsp;<span class="ident" id="4376127">n</span>&nbsp;<span class="op" id="4376129">==</span>&nbsp;<span class="num" id="4376132">0</span>&nbsp;<span class="op" id="4376134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376138">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4376150">//&nbsp;determine&nbsp;values&nbsp;list&nbsp;with&nbsp;which&nbsp;to&nbsp;associate&nbsp;the&nbsp;Value&nbsp;for&nbsp;this&nbsp;decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376224">values</span>&nbsp;<span class="op" id="4376231">:=</span>&nbsp;<span class="op" id="4376234">&amp;</span><span class="ident" id="4376235">r</span><span class="op" id="4376236">.</span><span class="ident" id="4376237">values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376245">const</span>&nbsp;<span class="ident" id="4376251">threshold</span>&nbsp;<span class="op" id="4376261">=</span>&nbsp;<span class="num" id="4376263">0.75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376269">if</span>&nbsp;<span class="ident" id="4376272">domName</span>&nbsp;<span class="op" id="4376280">!=</span>&nbsp;<span class="string" id="4376283">&#34;&#34;</span>&nbsp;<span class="op" id="4376286">&amp;&amp;</span>&nbsp;<span class="ident" id="4376289">r</span><span class="op" id="4376290">.</span><span class="ident" id="4376291">isVisible</span><span class="op" id="4376300">(</span><span class="ident" id="4376301">domName</span><span class="op" id="4376308">)</span>&nbsp;<span class="op" id="4376310">&amp;&amp;</span>&nbsp;<span class="ident" id="4376313">domFreq</span>&nbsp;<span class="op" id="4376321">&gt;=</span>&nbsp;<span class="builtintype" id="4376324">int</span><span class="op" id="4376327">(</span><span class="builtintype" id="4376328">float64</span><span class="op" id="4376335">(</span><span class="builtinfunc" id="4376336">len</span><span class="op" id="4376339">(</span><span class="ident" id="4376340">decl</span><span class="op" id="4376344">.</span><span class="ident" id="4376345">Specs</span><span class="op" id="4376350">)</span><span class="op" id="4376351">)</span><span class="op" id="4376352">*</span><span class="ident" id="4376353">threshold</span><span class="op" id="4376362">)</span>&nbsp;<span class="op" id="4376364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4376368">//&nbsp;typed&nbsp;entries&nbsp;are&nbsp;sufficiently&nbsp;frequent</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376413">if</span>&nbsp;<span class="ident" id="4376416">typ</span>&nbsp;<span class="op" id="4376420">:=</span>&nbsp;<span class="ident" id="4376423">r</span><span class="op" id="4376424">.</span><span class="ident" id="4376425">lookupType</span><span class="op" id="4376435">(</span><span class="ident" id="4376436">domName</span><span class="op" id="4376443">)</span><span class="op" id="4376444">;</span>&nbsp;<span class="ident" id="4376446">typ</span>&nbsp;<span class="op" id="4376450">!=</span>&nbsp;<span class="ident" id="4376453">nil</span>&nbsp;<span class="op" id="4376457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376462">values</span>&nbsp;<span class="op" id="4376469">=</span>&nbsp;<span class="op" id="4376471">&amp;</span><span class="ident" id="4376472">typ</span><span class="op" id="4376475">.</span><span class="ident" id="4376476">values</span>&nbsp;<span class="comment" id="4376483">//&nbsp;associate&nbsp;with&nbsp;that&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376520">*</span><span class="ident" id="4376521">values</span>&nbsp;<span class="op" id="4376528">=</span>&nbsp;<span class="builtinfunc" id="4376530">append</span><span class="op" id="4376536">(</span><span class="op" id="4376537">*</span><span class="ident" id="4376538">values</span><span class="op" id="4376544">,</span>&nbsp;<span class="op" id="4376546">&amp;</span><span class="ident" id="4376547">Value</span><span class="op" id="4376552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376556">Doc</span><span class="op" id="4376559">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4376563">decl</span><span class="op" id="4376567">.</span><span class="ident" id="4376568">Doc</span><span class="op" id="4376571">.</span><span class="ident" id="4376572">Text</span><span class="op" id="4376576">(</span><span class="op" id="4376577">)</span><span class="op" id="4376578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376582">Names</span><span class="op" id="4376587">:</span>&nbsp;<span class="ident" id="4376589">specNames</span><span class="op" id="4376598">(</span><span class="ident" id="4376599">decl</span><span class="op" id="4376603">.</span><span class="ident" id="4376604">Specs</span><span class="op" id="4376609">)</span><span class="op" id="4376610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376614">Decl</span><span class="op" id="4376618">:</span>&nbsp;&nbsp;<span class="ident" id="4376621">decl</span><span class="op" id="4376625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376629">order</span><span class="op" id="4376634">:</span>&nbsp;<span class="builtinfunc" id="4376636">len</span><span class="op" id="4376639">(</span><span class="op" id="4376640">*</span><span class="ident" id="4376641">values</span><span class="op" id="4376647">)</span><span class="op" id="4376648">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376651">}</span><span class="op" id="4376652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376655">decl</span><span class="op" id="4376659">.</span><span class="ident" id="4376660">Doc</span>&nbsp;<span class="op" id="4376664">=</span>&nbsp;<span class="ident" id="4376666">nil</span>&nbsp;<span class="comment" id="4376670">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="4376704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4376707">//&nbsp;fields&nbsp;returns&nbsp;a&nbsp;struct&#39;s&nbsp;fields&nbsp;or&nbsp;an&nbsp;interface&#39;s&nbsp;methods.</span><br>
<span class="lineno">305</span><span class="comment" id="4376770">//</span><br>
<span class="lineno"></span><span class="keyword" id="4376773">func</span>&nbsp;<span class="ident" id="4376778">fields</span><span class="op" id="4376784">(</span><span class="ident" id="4376785">typ</span>&nbsp;<span class="ident" id="4376789">ast</span><span class="op" id="4376792">.</span><span class="ident" id="4376793">Expr</span><span class="op" id="4376797">)</span>&nbsp;<span class="op" id="4376799">(</span><span class="ident" id="4376800">list</span>&nbsp;<span class="op" id="4376805">[</span><span class="op" id="4376806">]</span><span class="op" id="4376807">*</span><span class="ident" id="4376808">ast</span><span class="op" id="4376811">.</span><span class="ident" id="4376812">Field</span><span class="op" id="4376817">,</span>&nbsp;<span class="ident" id="4376819">isStruct</span>&nbsp;<span class="builtintype" id="4376828">bool</span><span class="op" id="4376832">)</span>&nbsp;<span class="op" id="4376834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376837">var</span>&nbsp;<span class="ident" id="4376841">fields</span>&nbsp;<span class="op" id="4376848">*</span><span class="ident" id="4376849">ast</span><span class="op" id="4376852">.</span><span class="ident" id="4376853">FieldList</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376864">switch</span>&nbsp;<span class="ident" id="4376871">t</span>&nbsp;<span class="op" id="4376873">:=</span>&nbsp;<span class="ident" id="4376876">typ</span><span class="op" id="4376879">.</span><span class="op" id="4376880">(</span><span class="keyword" id="4376881">type</span><span class="op" id="4376885">)</span>&nbsp;<span class="op" id="4376887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376890">case</span>&nbsp;<span class="op" id="4376895">*</span><span class="ident" id="4376896">ast</span><span class="op" id="4376899">.</span><span class="ident" id="4376900">StructType</span><span class="op" id="4376910">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376914">fields</span>&nbsp;<span class="op" id="4376921">=</span>&nbsp;<span class="ident" id="4376923">t</span><span class="op" id="4376924">.</span><span class="ident" id="4376925">Fields</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376934">isStruct</span>&nbsp;<span class="op" id="4376943">=</span>&nbsp;<span class="builtintype" id="4376945">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4376951">case</span>&nbsp;<span class="op" id="4376956">*</span><span class="ident" id="4376957">ast</span><span class="op" id="4376960">.</span><span class="ident" id="4376961">InterfaceType</span><span class="op" id="4376974">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376978">fields</span>&nbsp;<span class="op" id="4376985">=</span>&nbsp;<span class="ident" id="4376987">t</span><span class="op" id="4376988">.</span><span class="ident" id="4376989">Methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4376998">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377001">if</span>&nbsp;<span class="ident" id="4377004">fields</span>&nbsp;<span class="op" id="4377011">!=</span>&nbsp;<span class="ident" id="4377014">nil</span>&nbsp;<span class="op" id="4377018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377022">list</span>&nbsp;<span class="op" id="4377027">=</span>&nbsp;<span class="ident" id="4377029">fields</span><span class="op" id="4377035">.</span><span class="ident" id="4377036">List</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377045">return</span><br>
<span class="lineno"></span><span class="op" id="4377052">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4377055">//&nbsp;readType&nbsp;processes&nbsp;a&nbsp;type&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="4377097">//</span><br>
<span class="lineno"></span><span class="keyword" id="4377100">func</span>&nbsp;<span class="op" id="4377105">(</span><span class="ident" id="4377106">r</span>&nbsp;<span class="op" id="4377108">*</span><span class="ident" id="4377109">reader</span><span class="op" id="4377115">)</span>&nbsp;<span class="ident" id="4377117">readType</span><span class="op" id="4377125">(</span><span class="ident" id="4377126">decl</span>&nbsp;<span class="op" id="4377131">*</span><span class="ident" id="4377132">ast</span><span class="op" id="4377135">.</span><span class="ident" id="4377136">GenDecl</span><span class="op" id="4377143">,</span>&nbsp;<span class="ident" id="4377145">spec</span>&nbsp;<span class="op" id="4377150">*</span><span class="ident" id="4377151">ast</span><span class="op" id="4377154">.</span><span class="ident" id="4377155">TypeSpec</span><span class="op" id="4377163">)</span>&nbsp;<span class="op" id="4377165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377168">typ</span>&nbsp;<span class="op" id="4377172">:=</span>&nbsp;<span class="ident" id="4377175">r</span><span class="op" id="4377176">.</span><span class="ident" id="4377177">lookupType</span><span class="op" id="4377187">(</span><span class="ident" id="4377188">spec</span><span class="op" id="4377192">.</span><span class="ident" id="4377193">Name</span><span class="op" id="4377197">.</span><span class="ident" id="4377198">Name</span><span class="op" id="4377202">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377205">if</span>&nbsp;<span class="ident" id="4377208">typ</span>&nbsp;<span class="op" id="4377212">==</span>&nbsp;<span class="ident" id="4377215">nil</span>&nbsp;<span class="op" id="4377219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377223">return</span>&nbsp;<span class="comment" id="4377230">//&nbsp;no&nbsp;name&nbsp;or&nbsp;blank&nbsp;name&nbsp;-&nbsp;ignore&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377278">//&nbsp;A&nbsp;type&nbsp;should&nbsp;be&nbsp;added&nbsp;at&nbsp;most&nbsp;once,&nbsp;so&nbsp;typ.decl</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377331">//&nbsp;should&nbsp;be&nbsp;nil&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;not,&nbsp;simply&nbsp;overwrite&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377386">typ</span><span class="op" id="4377389">.</span><span class="ident" id="4377390">decl</span>&nbsp;<span class="op" id="4377395">=</span>&nbsp;<span class="ident" id="4377397">decl</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377404">//&nbsp;compute&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377430">doc</span>&nbsp;<span class="op" id="4377434">:=</span>&nbsp;<span class="ident" id="4377437">spec</span><span class="op" id="4377441">.</span><span class="ident" id="4377442">Doc</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377447">spec</span><span class="op" id="4377451">.</span><span class="ident" id="4377452">Doc</span>&nbsp;<span class="op" id="4377456">=</span>&nbsp;<span class="ident" id="4377458">nil</span>&nbsp;<span class="comment" id="4377462">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377497">if</span>&nbsp;<span class="ident" id="4377500">doc</span>&nbsp;<span class="op" id="4377504">==</span>&nbsp;<span class="ident" id="4377507">nil</span>&nbsp;<span class="op" id="4377511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377515">//&nbsp;no&nbsp;doc&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec,&nbsp;use&nbsp;the&nbsp;declaration&nbsp;doc,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377585">doc</span>&nbsp;<span class="op" id="4377589">=</span>&nbsp;<span class="ident" id="4377591">decl</span><span class="op" id="4377595">.</span><span class="ident" id="4377596">Doc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377601">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377604">decl</span><span class="op" id="4377608">.</span><span class="ident" id="4377609">Doc</span>&nbsp;<span class="op" id="4377613">=</span>&nbsp;<span class="ident" id="4377615">nil</span>&nbsp;<span class="comment" id="4377619">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377654">typ</span><span class="op" id="4377657">.</span><span class="ident" id="4377658">doc</span>&nbsp;<span class="op" id="4377662">=</span>&nbsp;<span class="ident" id="4377664">doc</span><span class="op" id="4377667">.</span><span class="ident" id="4377668">Text</span><span class="op" id="4377672">(</span><span class="op" id="4377673">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377677">//&nbsp;record&nbsp;anonymous&nbsp;fields&nbsp;(they&nbsp;may&nbsp;contribute&nbsp;methods)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377735">//&nbsp;(some&nbsp;fields&nbsp;may&nbsp;have&nbsp;been&nbsp;recorded&nbsp;already&nbsp;when&nbsp;filtering</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377798">//&nbsp;exports,&nbsp;but&nbsp;that&#39;s&nbsp;ok)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377826">var</span>&nbsp;<span class="ident" id="4377830">list</span>&nbsp;<span class="op" id="4377835">[</span><span class="op" id="4377836">]</span><span class="op" id="4377837">*</span><span class="ident" id="4377838">ast</span><span class="op" id="4377841">.</span><span class="ident" id="4377842">Field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377849">list</span><span class="op" id="4377853">,</span>&nbsp;<span class="ident" id="4377855">typ</span><span class="op" id="4377858">.</span><span class="ident" id="4377859">isStruct</span>&nbsp;<span class="op" id="4377868">=</span>&nbsp;<span class="ident" id="4377870">fields</span><span class="op" id="4377876">(</span><span class="ident" id="4377877">spec</span><span class="op" id="4377881">.</span><span class="ident" id="4377882">Type</span><span class="op" id="4377886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377889">for</span>&nbsp;<span class="ident" id="4377893">_</span><span class="op" id="4377894">,</span>&nbsp;<span class="ident" id="4377896">field</span>&nbsp;<span class="op" id="4377902">:=</span>&nbsp;<span class="keyword" id="4377905">range</span>&nbsp;<span class="ident" id="4377911">list</span>&nbsp;<span class="op" id="4377916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377920">if</span>&nbsp;<span class="builtinfunc" id="4377923">len</span><span class="op" id="4377926">(</span><span class="ident" id="4377927">field</span><span class="op" id="4377932">.</span><span class="ident" id="4377933">Names</span><span class="op" id="4377938">)</span>&nbsp;<span class="op" id="4377940">==</span>&nbsp;<span class="num" id="4377943">0</span>&nbsp;<span class="op" id="4377945">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377950">r</span><span class="op" id="4377951">.</span><span class="ident" id="4377952">recordAnonymousField</span><span class="op" id="4377972">(</span><span class="ident" id="4377973">typ</span><span class="op" id="4377976">,</span>&nbsp;<span class="ident" id="4377978">field</span><span class="op" id="4377983">.</span><span class="ident" id="4377984">Type</span><span class="op" id="4377988">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377995">}</span><br>
<span class="lineno"></span><span class="op" id="4377997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4378000">//&nbsp;readFunc&nbsp;processes&nbsp;a&nbsp;func&nbsp;or&nbsp;method&nbsp;declaration.</span><br>
<span class="lineno"></span><span class="comment" id="4378052">//</span><br>
<span class="lineno"></span><span class="keyword" id="4378055">func</span>&nbsp;<span class="op" id="4378060">(</span><span class="ident" id="4378061">r</span>&nbsp;<span class="op" id="4378063">*</span><span class="ident" id="4378064">reader</span><span class="op" id="4378070">)</span>&nbsp;<span class="ident" id="4378072">readFunc</span><span class="op" id="4378080">(</span><span class="ident" id="4378081">fun</span>&nbsp;<span class="op" id="4378085">*</span><span class="ident" id="4378086">ast</span><span class="op" id="4378089">.</span><span class="ident" id="4378090">FuncDecl</span><span class="op" id="4378098">)</span>&nbsp;<span class="op" id="4378100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378103">//&nbsp;strip&nbsp;function&nbsp;body</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378127">fun</span><span class="op" id="4378130">.</span><span class="ident" id="4378131">Body</span>&nbsp;<span class="op" id="4378136">=</span>&nbsp;<span class="ident" id="4378138">nil</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378144">//&nbsp;associate&nbsp;methods&nbsp;with&nbsp;the&nbsp;receiver&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378197">if</span>&nbsp;<span class="ident" id="4378200">fun</span><span class="op" id="4378203">.</span><span class="ident" id="4378204">Recv</span>&nbsp;<span class="op" id="4378209">!=</span>&nbsp;<span class="ident" id="4378212">nil</span>&nbsp;<span class="op" id="4378216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378220">//&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378232">recvTypeName</span><span class="op" id="4378244">,</span>&nbsp;<span class="ident" id="4378246">imp</span>&nbsp;<span class="op" id="4378250">:=</span>&nbsp;<span class="ident" id="4378253">baseTypeName</span><span class="op" id="4378265">(</span><span class="ident" id="4378266">fun</span><span class="op" id="4378269">.</span><span class="ident" id="4378270">Recv</span><span class="op" id="4378274">.</span><span class="ident" id="4378275">List</span><span class="op" id="4378279">[</span><span class="num" id="4378280">0</span><span class="op" id="4378281">]</span><span class="op" id="4378282">.</span><span class="ident" id="4378283">Type</span><span class="op" id="4378287">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378291">if</span>&nbsp;<span class="ident" id="4378294">imp</span>&nbsp;<span class="op" id="4378298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378303">//&nbsp;should&nbsp;not&nbsp;happen&nbsp;(incorrect&nbsp;AST);</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378344">//&nbsp;don&#39;t&nbsp;show&nbsp;this&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378373">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378382">}</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378386">if</span>&nbsp;<span class="ident" id="4378389">typ</span>&nbsp;<span class="op" id="4378393">:=</span>&nbsp;<span class="ident" id="4378396">r</span><span class="op" id="4378397">.</span><span class="ident" id="4378398">lookupType</span><span class="op" id="4378408">(</span><span class="ident" id="4378409">recvTypeName</span><span class="op" id="4378421">)</span><span class="op" id="4378422">;</span>&nbsp;<span class="ident" id="4378424">typ</span>&nbsp;<span class="op" id="4378428">!=</span>&nbsp;<span class="ident" id="4378431">nil</span>&nbsp;<span class="op" id="4378435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378440">typ</span><span class="op" id="4378443">.</span><span class="ident" id="4378444">methods</span><span class="op" id="4378451">.</span><span class="ident" id="4378452">set</span><span class="op" id="4378455">(</span><span class="ident" id="4378456">fun</span><span class="op" id="4378459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378467">//&nbsp;otherwise&nbsp;ignore&nbsp;the&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378500">//&nbsp;TODO(gri):&nbsp;There&nbsp;may&nbsp;be&nbsp;exported&nbsp;methods&nbsp;of&nbsp;non-exported&nbsp;types</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378568">//&nbsp;that&nbsp;can&nbsp;be&nbsp;called&nbsp;because&nbsp;of&nbsp;exported&nbsp;values&nbsp;(consts,&nbsp;vars,&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378637">//&nbsp;function&nbsp;results)&nbsp;of&nbsp;that&nbsp;type.&nbsp;Could&nbsp;determine&nbsp;if&nbsp;that&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378705">//&nbsp;case&nbsp;and&nbsp;then&nbsp;show&nbsp;those&nbsp;methods&nbsp;in&nbsp;an&nbsp;appropriate&nbsp;section.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378770">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378778">}</span><br>
<span class="lineno">380</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378782">//&nbsp;associate&nbsp;factory&nbsp;functions&nbsp;with&nbsp;the&nbsp;first&nbsp;visible&nbsp;result&nbsp;type,&nbsp;if&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378857">if</span>&nbsp;<span class="ident" id="4378860">fun</span><span class="op" id="4378863">.</span><span class="ident" id="4378864">Type</span><span class="op" id="4378868">.</span><span class="ident" id="4378869">Results</span><span class="op" id="4378876">.</span><span class="ident" id="4378877">NumFields</span><span class="op" id="4378886">(</span><span class="op" id="4378887">)</span>&nbsp;<span class="op" id="4378889">&gt;=</span>&nbsp;<span class="num" id="4378892">1</span>&nbsp;<span class="op" id="4378894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378898">res</span>&nbsp;<span class="op" id="4378902">:=</span>&nbsp;<span class="ident" id="4378905">fun</span><span class="op" id="4378908">.</span><span class="ident" id="4378909">Type</span><span class="op" id="4378913">.</span><span class="ident" id="4378914">Results</span><span class="op" id="4378921">.</span><span class="ident" id="4378922">List</span><span class="op" id="4378926">[</span><span class="num" id="4378927">0</span><span class="op" id="4378928">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378932">if</span>&nbsp;<span class="builtinfunc" id="4378935">len</span><span class="op" id="4378938">(</span><span class="ident" id="4378939">res</span><span class="op" id="4378942">.</span><span class="ident" id="4378943">Names</span><span class="op" id="4378948">)</span>&nbsp;<span class="op" id="4378950">&lt;=</span>&nbsp;<span class="num" id="4378953">1</span>&nbsp;<span class="op" id="4378955">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378960">//&nbsp;exactly&nbsp;one&nbsp;(named&nbsp;or&nbsp;anonymous)&nbsp;result&nbsp;associated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379017">//&nbsp;with&nbsp;the&nbsp;first&nbsp;type&nbsp;in&nbsp;result&nbsp;signature&nbsp;(there&nbsp;may</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379074">//&nbsp;be&nbsp;more&nbsp;than&nbsp;one&nbsp;result)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379105">if</span>&nbsp;<span class="ident" id="4379108">n</span><span class="op" id="4379109">,</span>&nbsp;<span class="ident" id="4379111">imp</span>&nbsp;<span class="op" id="4379115">:=</span>&nbsp;<span class="ident" id="4379118">baseTypeName</span><span class="op" id="4379130">(</span><span class="ident" id="4379131">res</span><span class="op" id="4379134">.</span><span class="ident" id="4379135">Type</span><span class="op" id="4379139">)</span><span class="op" id="4379140">;</span>&nbsp;<span class="op" id="4379142">!</span><span class="ident" id="4379143">imp</span>&nbsp;<span class="op" id="4379147">&amp;&amp;</span>&nbsp;<span class="ident" id="4379150">r</span><span class="op" id="4379151">.</span><span class="ident" id="4379152">isVisible</span><span class="op" id="4379161">(</span><span class="ident" id="4379162">n</span><span class="op" id="4379163">)</span>&nbsp;<span class="op" id="4379165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379171">if</span>&nbsp;<span class="ident" id="4379174">typ</span>&nbsp;<span class="op" id="4379178">:=</span>&nbsp;<span class="ident" id="4379181">r</span><span class="op" id="4379182">.</span><span class="ident" id="4379183">lookupType</span><span class="op" id="4379193">(</span><span class="ident" id="4379194">n</span><span class="op" id="4379195">)</span><span class="op" id="4379196">;</span>&nbsp;<span class="ident" id="4379198">typ</span>&nbsp;<span class="op" id="4379202">!=</span>&nbsp;<span class="ident" id="4379205">nil</span>&nbsp;<span class="op" id="4379209">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379216">//&nbsp;associate&nbsp;function&nbsp;with&nbsp;typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379252">typ</span><span class="op" id="4379255">.</span><span class="ident" id="4379256">funcs</span><span class="op" id="4379261">.</span><span class="ident" id="4379262">set</span><span class="op" id="4379265">(</span><span class="ident" id="4379266">fun</span><span class="op" id="4379269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379276">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379292">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379303">//&nbsp;just&nbsp;an&nbsp;ordinary&nbsp;function</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379333">r</span><span class="op" id="4379334">.</span><span class="ident" id="4379335">funcs</span><span class="op" id="4379340">.</span><span class="ident" id="4379341">set</span><span class="op" id="4379344">(</span><span class="ident" id="4379345">fun</span><span class="op" id="4379348">)</span><br>
<span class="lineno">400</span><span class="op" id="4379350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4379353">var</span>&nbsp;<span class="op" id="4379357">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379360">noteMarker</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4379374">=</span>&nbsp;<span class="string" id="4379376">`([A-Z][A-Z]+)\(([^)]+)\):?`</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379424">//&nbsp;MARKER(uid),&nbsp;MARKER&nbsp;at&nbsp;least&nbsp;2&nbsp;chars,&nbsp;uid&nbsp;at&nbsp;least&nbsp;1&nbsp;char</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379486">noteMarkerRx</span>&nbsp;&nbsp;<span class="op" id="4379500">=</span>&nbsp;<span class="ident" id="4379502">regexp</span><span class="op" id="4379508">.</span><span class="ident" id="4379509">MustCompile</span><span class="op" id="4379520">(</span><span class="string" id="4379521">`^[&nbsp;\t]*`</span>&nbsp;<span class="op" id="4379531">+</span>&nbsp;<span class="ident" id="4379533">noteMarker</span><span class="op" id="4379543">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4379550">//&nbsp;MARKER(uid)&nbsp;at&nbsp;text&nbsp;start</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379580">noteCommentRx</span>&nbsp;<span class="op" id="4379594">=</span>&nbsp;<span class="ident" id="4379596">regexp</span><span class="op" id="4379602">.</span><span class="ident" id="4379603">MustCompile</span><span class="op" id="4379614">(</span><span class="string" id="4379615">`^/[/*][&nbsp;\t]*`</span>&nbsp;<span class="op" id="4379630">+</span>&nbsp;<span class="ident" id="4379632">noteMarker</span><span class="op" id="4379642">)</span>&nbsp;<span class="comment" id="4379644">//&nbsp;MARKER(uid)&nbsp;at&nbsp;comment&nbsp;start</span><br>
<span class="lineno"></span><span class="op" id="4379676">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4379679">//&nbsp;readNote&nbsp;collects&nbsp;a&nbsp;single&nbsp;note&nbsp;from&nbsp;a&nbsp;sequence&nbsp;of&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="4379743">//</span><br>
<span class="lineno">410</span><span class="keyword" id="4379746">func</span>&nbsp;<span class="op" id="4379751">(</span><span class="ident" id="4379752">r</span>&nbsp;<span class="op" id="4379754">*</span><span class="ident" id="4379755">reader</span><span class="op" id="4379761">)</span>&nbsp;<span class="ident" id="4379763">readNote</span><span class="op" id="4379771">(</span><span class="ident" id="4379772">list</span>&nbsp;<span class="op" id="4379777">[</span><span class="op" id="4379778">]</span><span class="op" id="4379779">*</span><span class="ident" id="4379780">ast</span><span class="op" id="4379783">.</span><span class="ident" id="4379784">Comment</span><span class="op" id="4379791">)</span>&nbsp;<span class="op" id="4379793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379796">text</span>&nbsp;<span class="op" id="4379801">:=</span>&nbsp;<span class="op" id="4379804">(</span><span class="op" id="4379805">&amp;</span><span class="ident" id="4379806">ast</span><span class="op" id="4379809">.</span><span class="ident" id="4379810">CommentGroup</span><span class="op" id="4379822">{</span><span class="ident" id="4379823">List</span><span class="op" id="4379827">:</span>&nbsp;<span class="ident" id="4379829">list</span><span class="op" id="4379833">}</span><span class="op" id="4379834">)</span><span class="op" id="4379835">.</span><span class="ident" id="4379836">Text</span><span class="op" id="4379840">(</span><span class="op" id="4379841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379844">if</span>&nbsp;<span class="ident" id="4379847">m</span>&nbsp;<span class="op" id="4379849">:=</span>&nbsp;<span class="ident" id="4379852">noteMarkerRx</span><span class="op" id="4379864">.</span><span class="ident" id="4379865">FindStringSubmatchIndex</span><span class="op" id="4379888">(</span><span class="ident" id="4379889">text</span><span class="op" id="4379893">)</span><span class="op" id="4379894">;</span>&nbsp;<span class="ident" id="4379896">m</span>&nbsp;<span class="op" id="4379898">!=</span>&nbsp;<span class="ident" id="4379901">nil</span>&nbsp;<span class="op" id="4379905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379909">//&nbsp;The&nbsp;note&nbsp;body&nbsp;starts&nbsp;after&nbsp;the&nbsp;marker.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379953">//&nbsp;We&nbsp;remove&nbsp;any&nbsp;formatting&nbsp;so&nbsp;that&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4380000">//&nbsp;get&nbsp;spurious&nbsp;line&nbsp;breaks/indentation&nbsp;when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4380047">//&nbsp;showing&nbsp;the&nbsp;TODO&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380075">body</span>&nbsp;<span class="op" id="4380080">:=</span>&nbsp;<span class="ident" id="4380083">clean</span><span class="op" id="4380088">(</span><span class="ident" id="4380089">text</span><span class="op" id="4380093">[</span><span class="ident" id="4380094">m</span><span class="op" id="4380095">[</span><span class="num" id="4380096">1</span><span class="op" id="4380097">]</span><span class="op" id="4380098">:</span><span class="op" id="4380099">]</span><span class="op" id="4380100">,</span>&nbsp;<span class="ident" id="4380102">keepNL</span><span class="op" id="4380108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380112">if</span>&nbsp;<span class="ident" id="4380115">body</span>&nbsp;<span class="op" id="4380120">!=</span>&nbsp;<span class="string" id="4380123">&#34;&#34;</span>&nbsp;<span class="op" id="4380126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380131">marker</span>&nbsp;<span class="op" id="4380138">:=</span>&nbsp;<span class="ident" id="4380141">text</span><span class="op" id="4380145">[</span><span class="ident" id="4380146">m</span><span class="op" id="4380147">[</span><span class="num" id="4380148">2</span><span class="op" id="4380149">]</span><span class="op" id="4380150">:</span><span class="ident" id="4380151">m</span><span class="op" id="4380152">[</span><span class="num" id="4380153">3</span><span class="op" id="4380154">]</span><span class="op" id="4380155">]</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380160">r</span><span class="op" id="4380161">.</span><span class="ident" id="4380162">notes</span><span class="op" id="4380167">[</span><span class="ident" id="4380168">marker</span><span class="op" id="4380174">]</span>&nbsp;<span class="op" id="4380176">=</span>&nbsp;<span class="builtinfunc" id="4380178">append</span><span class="op" id="4380184">(</span><span class="ident" id="4380185">r</span><span class="op" id="4380186">.</span><span class="ident" id="4380187">notes</span><span class="op" id="4380192">[</span><span class="ident" id="4380193">marker</span><span class="op" id="4380199">]</span><span class="op" id="4380200">,</span>&nbsp;<span class="op" id="4380202">&amp;</span><span class="ident" id="4380203">Note</span><span class="op" id="4380207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380213">Pos</span><span class="op" id="4380216">:</span>&nbsp;&nbsp;<span class="ident" id="4380219">list</span><span class="op" id="4380223">[</span><span class="num" id="4380224">0</span><span class="op" id="4380225">]</span><span class="op" id="4380226">.</span><span class="ident" id="4380227">Pos</span><span class="op" id="4380230">(</span><span class="op" id="4380231">)</span><span class="op" id="4380232">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380238">End</span><span class="op" id="4380241">:</span>&nbsp;&nbsp;<span class="ident" id="4380244">list</span><span class="op" id="4380248">[</span><span class="builtinfunc" id="4380249">len</span><span class="op" id="4380252">(</span><span class="ident" id="4380253">list</span><span class="op" id="4380257">)</span><span class="op" id="4380258">-</span><span class="num" id="4380259">1</span><span class="op" id="4380260">]</span><span class="op" id="4380261">.</span><span class="ident" id="4380262">End</span><span class="op" id="4380265">(</span><span class="op" id="4380266">)</span><span class="op" id="4380267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380273">UID</span><span class="op" id="4380276">:</span>&nbsp;&nbsp;<span class="ident" id="4380279">text</span><span class="op" id="4380283">[</span><span class="ident" id="4380284">m</span><span class="op" id="4380285">[</span><span class="num" id="4380286">4</span><span class="op" id="4380287">]</span><span class="op" id="4380288">:</span><span class="ident" id="4380289">m</span><span class="op" id="4380290">[</span><span class="num" id="4380291">5</span><span class="op" id="4380292">]</span><span class="op" id="4380293">]</span><span class="op" id="4380294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380300">Body</span><span class="op" id="4380304">:</span>&nbsp;<span class="ident" id="4380306">body</span><span class="op" id="4380310">,</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380315">}</span><span class="op" id="4380316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380323">}</span><br>
<span class="lineno"></span><span class="op" id="4380325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="comment" id="4380328">//&nbsp;readNotes&nbsp;extracts&nbsp;notes&nbsp;from&nbsp;comments.</span><br>
<span class="lineno"></span><span class="comment" id="4380371">//&nbsp;A&nbsp;note&nbsp;must&nbsp;start&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;comment&nbsp;with&nbsp;&#34;MARKER(uid):&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4380442">//&nbsp;and&nbsp;is&nbsp;followed&nbsp;by&nbsp;the&nbsp;note&nbsp;body&nbsp;(e.g.,&nbsp;&#34;//&nbsp;BUG(gri):&nbsp;fix&nbsp;this&#34;).</span><br>
<span class="lineno"></span><span class="comment" id="4380511">//&nbsp;The&nbsp;note&nbsp;ends&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;comment&nbsp;group&nbsp;or&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4380579">//&nbsp;another&nbsp;note&nbsp;in&nbsp;the&nbsp;same&nbsp;comment&nbsp;group,&nbsp;whichever&nbsp;comes&nbsp;first.</span><br>
<span class="lineno">435</span><span class="comment" id="4380645">//</span><br>
<span class="lineno"></span><span class="keyword" id="4380648">func</span>&nbsp;<span class="op" id="4380653">(</span><span class="ident" id="4380654">r</span>&nbsp;<span class="op" id="4380656">*</span><span class="ident" id="4380657">reader</span><span class="op" id="4380663">)</span>&nbsp;<span class="ident" id="4380665">readNotes</span><span class="op" id="4380674">(</span><span class="ident" id="4380675">comments</span>&nbsp;<span class="op" id="4380684">[</span><span class="op" id="4380685">]</span><span class="op" id="4380686">*</span><span class="ident" id="4380687">ast</span><span class="op" id="4380690">.</span><span class="ident" id="4380691">CommentGroup</span><span class="op" id="4380703">)</span>&nbsp;<span class="op" id="4380705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380708">for</span>&nbsp;<span class="ident" id="4380712">_</span><span class="op" id="4380713">,</span>&nbsp;<span class="ident" id="4380715">group</span>&nbsp;<span class="op" id="4380721">:=</span>&nbsp;<span class="keyword" id="4380724">range</span>&nbsp;<span class="ident" id="4380730">comments</span>&nbsp;<span class="op" id="4380739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380743">i</span>&nbsp;<span class="op" id="4380745">:=</span>&nbsp;<span class="op" id="4380748">-</span><span class="num" id="4380749">1</span>&nbsp;<span class="comment" id="4380751">//&nbsp;comment&nbsp;index&nbsp;of&nbsp;most&nbsp;recent&nbsp;note&nbsp;start,&nbsp;valid&nbsp;if&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380811">list</span>&nbsp;<span class="op" id="4380816">:=</span>&nbsp;<span class="ident" id="4380819">group</span><span class="op" id="4380824">.</span><span class="ident" id="4380825">List</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380832">for</span>&nbsp;<span class="ident" id="4380836">j</span><span class="op" id="4380837">,</span>&nbsp;<span class="ident" id="4380839">c</span>&nbsp;<span class="op" id="4380841">:=</span>&nbsp;<span class="keyword" id="4380844">range</span>&nbsp;<span class="ident" id="4380850">list</span>&nbsp;<span class="op" id="4380855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380860">if</span>&nbsp;<span class="ident" id="4380863">noteCommentRx</span><span class="op" id="4380876">.</span><span class="ident" id="4380877">MatchString</span><span class="op" id="4380888">(</span><span class="ident" id="4380889">c</span><span class="op" id="4380890">.</span><span class="ident" id="4380891">Text</span><span class="op" id="4380895">)</span>&nbsp;<span class="op" id="4380897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380903">if</span>&nbsp;<span class="ident" id="4380906">i</span>&nbsp;<span class="op" id="4380908">&gt;=</span>&nbsp;<span class="num" id="4380911">0</span>&nbsp;<span class="op" id="4380913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380920">r</span><span class="op" id="4380921">.</span><span class="ident" id="4380922">readNote</span><span class="op" id="4380930">(</span><span class="ident" id="4380931">list</span><span class="op" id="4380935">[</span><span class="ident" id="4380936">i</span><span class="op" id="4380937">:</span><span class="ident" id="4380938">j</span><span class="op" id="4380939">]</span><span class="op" id="4380940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380946">}</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380952">i</span>&nbsp;<span class="op" id="4380954">=</span>&nbsp;<span class="ident" id="4380956">j</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380969">if</span>&nbsp;<span class="ident" id="4380972">i</span>&nbsp;<span class="op" id="4380974">&gt;=</span>&nbsp;<span class="num" id="4380977">0</span>&nbsp;<span class="op" id="4380979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380984">r</span><span class="op" id="4380985">.</span><span class="ident" id="4380986">readNote</span><span class="op" id="4380994">(</span><span class="ident" id="4380995">list</span><span class="op" id="4380999">[</span><span class="ident" id="4381000">i</span><span class="op" id="4381001">:</span><span class="op" id="4381002">]</span><span class="op" id="4381003">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381010">}</span><br>
<span class="lineno"></span><span class="op" id="4381012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4381015">//&nbsp;readFile&nbsp;adds&nbsp;the&nbsp;AST&nbsp;for&nbsp;a&nbsp;source&nbsp;file&nbsp;to&nbsp;the&nbsp;reader.</span><br>
<span class="lineno">455</span><span class="comment" id="4381073">//</span><br>
<span class="lineno"></span><span class="keyword" id="4381076">func</span>&nbsp;<span class="op" id="4381081">(</span><span class="ident" id="4381082">r</span>&nbsp;<span class="op" id="4381084">*</span><span class="ident" id="4381085">reader</span><span class="op" id="4381091">)</span>&nbsp;<span class="ident" id="4381093">readFile</span><span class="op" id="4381101">(</span><span class="ident" id="4381102">src</span>&nbsp;<span class="op" id="4381106">*</span><span class="ident" id="4381107">ast</span><span class="op" id="4381110">.</span><span class="ident" id="4381111">File</span><span class="op" id="4381115">)</span>&nbsp;<span class="op" id="4381117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381120">//&nbsp;add&nbsp;package&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381150">if</span>&nbsp;<span class="ident" id="4381153">src</span><span class="op" id="4381156">.</span><span class="ident" id="4381157">Doc</span>&nbsp;<span class="op" id="4381161">!=</span>&nbsp;<span class="ident" id="4381164">nil</span>&nbsp;<span class="op" id="4381168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381172">r</span><span class="op" id="4381173">.</span><span class="ident" id="4381174">readDoc</span><span class="op" id="4381181">(</span><span class="ident" id="4381182">src</span><span class="op" id="4381185">.</span><span class="ident" id="4381186">Doc</span><span class="op" id="4381189">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381193">src</span><span class="op" id="4381196">.</span><span class="ident" id="4381197">Doc</span>&nbsp;<span class="op" id="4381201">=</span>&nbsp;<span class="ident" id="4381203">nil</span>&nbsp;<span class="comment" id="4381207">//&nbsp;doc&nbsp;consumed&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381246">//&nbsp;add&nbsp;all&nbsp;declarations</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381271">for</span>&nbsp;<span class="ident" id="4381275">_</span><span class="op" id="4381276">,</span>&nbsp;<span class="ident" id="4381278">decl</span>&nbsp;<span class="op" id="4381283">:=</span>&nbsp;<span class="keyword" id="4381286">range</span>&nbsp;<span class="ident" id="4381292">src</span><span class="op" id="4381295">.</span><span class="ident" id="4381296">Decls</span>&nbsp;<span class="op" id="4381302">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381306">switch</span>&nbsp;<span class="ident" id="4381313">d</span>&nbsp;<span class="op" id="4381315">:=</span>&nbsp;<span class="ident" id="4381318">decl</span><span class="op" id="4381322">.</span><span class="op" id="4381323">(</span><span class="keyword" id="4381324">type</span><span class="op" id="4381328">)</span>&nbsp;<span class="op" id="4381330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381334">case</span>&nbsp;<span class="op" id="4381339">*</span><span class="ident" id="4381340">ast</span><span class="op" id="4381343">.</span><span class="ident" id="4381344">GenDecl</span><span class="op" id="4381351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381356">switch</span>&nbsp;<span class="ident" id="4381363">d</span><span class="op" id="4381364">.</span><span class="ident" id="4381365">Tok</span>&nbsp;<span class="op" id="4381369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381374">case</span>&nbsp;<span class="ident" id="4381379">token</span><span class="op" id="4381384">.</span><span class="ident" id="4381385">IMPORT</span><span class="op" id="4381391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381397">//&nbsp;imports&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381437">for</span>&nbsp;<span class="ident" id="4381441">_</span><span class="op" id="4381442">,</span>&nbsp;<span class="ident" id="4381444">spec</span>&nbsp;<span class="op" id="4381449">:=</span>&nbsp;<span class="keyword" id="4381452">range</span>&nbsp;<span class="ident" id="4381458">d</span><span class="op" id="4381459">.</span><span class="ident" id="4381460">Specs</span>&nbsp;<span class="op" id="4381466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381473">if</span>&nbsp;<span class="ident" id="4381476">s</span><span class="op" id="4381477">,</span>&nbsp;<span class="ident" id="4381479">ok</span>&nbsp;<span class="op" id="4381482">:=</span>&nbsp;<span class="ident" id="4381485">spec</span><span class="op" id="4381489">.</span><span class="op" id="4381490">(</span><span class="op" id="4381491">*</span><span class="ident" id="4381492">ast</span><span class="op" id="4381495">.</span><span class="ident" id="4381496">ImportSpec</span><span class="op" id="4381506">)</span><span class="op" id="4381507">;</span>&nbsp;<span class="ident" id="4381509">ok</span>&nbsp;<span class="op" id="4381512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381520">if</span>&nbsp;<span class="ident" id="4381523">import_</span><span class="op" id="4381530">,</span>&nbsp;<span class="ident" id="4381532">err</span>&nbsp;<span class="op" id="4381536">:=</span>&nbsp;<span class="ident" id="4381539">strconv</span><span class="op" id="4381546">.</span><span class="ident" id="4381547">Unquote</span><span class="op" id="4381554">(</span><span class="ident" id="4381555">s</span><span class="op" id="4381556">.</span><span class="ident" id="4381557">Path</span><span class="op" id="4381561">.</span><span class="ident" id="4381562">Value</span><span class="op" id="4381567">)</span><span class="op" id="4381568">;</span>&nbsp;<span class="ident" id="4381570">err</span>&nbsp;<span class="op" id="4381574">==</span>&nbsp;<span class="ident" id="4381577">nil</span>&nbsp;<span class="op" id="4381581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381590">r</span><span class="op" id="4381591">.</span><span class="ident" id="4381592">imports</span><span class="op" id="4381599">[</span><span class="ident" id="4381600">import_</span><span class="op" id="4381607">]</span>&nbsp;<span class="op" id="4381609">=</span>&nbsp;<span class="num" id="4381611">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381619">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4381632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381637">case</span>&nbsp;<span class="ident" id="4381642">token</span><span class="op" id="4381647">.</span><span class="ident" id="4381648">CONST</span><span class="op" id="4381653">,</span>&nbsp;<span class="ident" id="4381655">token</span><span class="op" id="4381660">.</span><span class="ident" id="4381661">VAR</span><span class="op" id="4381664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381670">//&nbsp;constants&nbsp;and&nbsp;variables&nbsp;are&nbsp;always&nbsp;handled&nbsp;as&nbsp;a&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4381731">r</span><span class="op" id="4381732">.</span><span class="ident" id="4381733">readValue</span><span class="op" id="4381742">(</span><span class="ident" id="4381743">d</span><span class="op" id="4381744">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381749">case</span>&nbsp;<span class="ident" id="4381754">token</span><span class="op" id="4381759">.</span><span class="ident" id="4381760">TYPE</span><span class="op" id="4381764">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381770">//&nbsp;types&nbsp;are&nbsp;handled&nbsp;individually</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4381808">if</span>&nbsp;<span class="builtinfunc" id="4381811">len</span><span class="op" id="4381814">(</span><span class="ident" id="4381815">d</span><span class="op" id="4381816">.</span><span class="ident" id="4381817">Specs</span><span class="op" id="4381822">)</span>&nbsp;<span class="op" id="4381824">==</span>&nbsp;<span class="num" id="4381827">1</span>&nbsp;<span class="op" id="4381829">&amp;&amp;</span>&nbsp;<span class="op" id="4381832">!</span><span class="ident" id="4381833">d</span><span class="op" id="4381834">.</span><span class="ident" id="4381835">Lparen</span><span class="op" id="4381841">.</span><span class="ident" id="4381842">IsValid</span><span class="op" id="4381849">(</span><span class="op" id="4381850">)</span>&nbsp;<span class="op" id="4381852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381859">//&nbsp;common&nbsp;case:&nbsp;single&nbsp;declaration&nbsp;w/o&nbsp;parentheses</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381915">//&nbsp;(if&nbsp;a&nbsp;single&nbsp;declaration&nbsp;is&nbsp;parenthesized,</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4381966">//&nbsp;create&nbsp;a&nbsp;new&nbsp;fake&nbsp;declaration&nbsp;below,&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382019">//&nbsp;go/doc&nbsp;type&nbsp;declarations&nbsp;always&nbsp;appear&nbsp;w/o</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382070">//&nbsp;parentheses)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382091">if</span>&nbsp;<span class="ident" id="4382094">s</span><span class="op" id="4382095">,</span>&nbsp;<span class="ident" id="4382097">ok</span>&nbsp;<span class="op" id="4382100">:=</span>&nbsp;<span class="ident" id="4382103">d</span><span class="op" id="4382104">.</span><span class="ident" id="4382105">Specs</span><span class="op" id="4382110">[</span><span class="num" id="4382111">0</span><span class="op" id="4382112">]</span><span class="op" id="4382113">.</span><span class="op" id="4382114">(</span><span class="op" id="4382115">*</span><span class="ident" id="4382116">ast</span><span class="op" id="4382119">.</span><span class="ident" id="4382120">TypeSpec</span><span class="op" id="4382128">)</span><span class="op" id="4382129">;</span>&nbsp;<span class="ident" id="4382131">ok</span>&nbsp;<span class="op" id="4382134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382142">r</span><span class="op" id="4382143">.</span><span class="ident" id="4382144">readType</span><span class="op" id="4382152">(</span><span class="ident" id="4382153">d</span><span class="op" id="4382154">,</span>&nbsp;<span class="ident" id="4382156">s</span><span class="op" id="4382157">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382171">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382187">for</span>&nbsp;<span class="ident" id="4382191">_</span><span class="op" id="4382192">,</span>&nbsp;<span class="ident" id="4382194">spec</span>&nbsp;<span class="op" id="4382199">:=</span>&nbsp;<span class="keyword" id="4382202">range</span>&nbsp;<span class="ident" id="4382208">d</span><span class="op" id="4382209">.</span><span class="ident" id="4382210">Specs</span>&nbsp;<span class="op" id="4382216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382223">if</span>&nbsp;<span class="ident" id="4382226">s</span><span class="op" id="4382227">,</span>&nbsp;<span class="ident" id="4382229">ok</span>&nbsp;<span class="op" id="4382232">:=</span>&nbsp;<span class="ident" id="4382235">spec</span><span class="op" id="4382239">.</span><span class="op" id="4382240">(</span><span class="op" id="4382241">*</span><span class="ident" id="4382242">ast</span><span class="op" id="4382245">.</span><span class="ident" id="4382246">TypeSpec</span><span class="op" id="4382254">)</span><span class="op" id="4382255">;</span>&nbsp;<span class="ident" id="4382257">ok</span>&nbsp;<span class="op" id="4382260">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382268">//&nbsp;use&nbsp;an&nbsp;individual&nbsp;(possibly&nbsp;fake)&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382323">//&nbsp;for&nbsp;each&nbsp;type;&nbsp;this&nbsp;also&nbsp;ensures&nbsp;that&nbsp;each&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382380">//&nbsp;gets&nbsp;to&nbsp;(re-)use&nbsp;the&nbsp;declaration&nbsp;documentation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382436">//&nbsp;if&nbsp;there&#39;s&nbsp;none&nbsp;associated&nbsp;with&nbsp;the&nbsp;spec&nbsp;itself</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382493">fake</span>&nbsp;<span class="op" id="4382498">:=</span>&nbsp;<span class="op" id="4382501">&amp;</span><span class="ident" id="4382502">ast</span><span class="op" id="4382505">.</span><span class="ident" id="4382506">GenDecl</span><span class="op" id="4382513">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382522">Doc</span><span class="op" id="4382525">:</span>&nbsp;<span class="ident" id="4382527">d</span><span class="op" id="4382528">.</span><span class="ident" id="4382529">Doc</span><span class="op" id="4382532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382541">//&nbsp;don&#39;t&nbsp;use&nbsp;the&nbsp;existing&nbsp;TokPos&nbsp;because&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382592">//&nbsp;will&nbsp;lead&nbsp;to&nbsp;the&nbsp;wrong&nbsp;selection&nbsp;range&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382645">//&nbsp;the&nbsp;fake&nbsp;declaration&nbsp;if&nbsp;there&nbsp;are&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382694">//&nbsp;than&nbsp;one&nbsp;type&nbsp;in&nbsp;the&nbsp;group&nbsp;(this&nbsp;affects</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382745">//&nbsp;src/cmd/godoc/godoc.go&#39;s&nbsp;posLink_urlFunc)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382797">TokPos</span><span class="op" id="4382803">:</span>&nbsp;<span class="ident" id="4382805">s</span><span class="op" id="4382806">.</span><span class="ident" id="4382807">Pos</span><span class="op" id="4382810">(</span><span class="op" id="4382811">)</span><span class="op" id="4382812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382821">Tok</span><span class="op" id="4382824">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4382829">token</span><span class="op" id="4382834">.</span><span class="ident" id="4382835">TYPE</span><span class="op" id="4382839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382848">Specs</span><span class="op" id="4382853">:</span>&nbsp;&nbsp;<span class="op" id="4382856">[</span><span class="op" id="4382857">]</span><span class="ident" id="4382858">ast</span><span class="op" id="4382861">.</span><span class="ident" id="4382862">Spec</span><span class="op" id="4382866">{</span><span class="ident" id="4382867">s</span><span class="op" id="4382868">}</span><span class="op" id="4382869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382877">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382885">r</span><span class="op" id="4382886">.</span><span class="ident" id="4382887">readType</span><span class="op" id="4382895">(</span><span class="ident" id="4382896">fake</span><span class="op" id="4382900">,</span>&nbsp;<span class="ident" id="4382902">s</span><span class="op" id="4382903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4382925">case</span>&nbsp;<span class="op" id="4382930">*</span><span class="ident" id="4382931">ast</span><span class="op" id="4382934">.</span><span class="ident" id="4382935">FuncDecl</span><span class="op" id="4382943">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4382948">r</span><span class="op" id="4382949">.</span><span class="ident" id="4382950">readFunc</span><span class="op" id="4382958">(</span><span class="ident" id="4382959">d</span><span class="op" id="4382960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4382967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4382971">//&nbsp;collect&nbsp;MARKER(...):&nbsp;annotations</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383008">r</span><span class="op" id="4383009">.</span><span class="ident" id="4383010">readNotes</span><span class="op" id="4383019">(</span><span class="ident" id="4383020">src</span><span class="op" id="4383023">.</span><span class="ident" id="4383024">Comments</span><span class="op" id="4383032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383035">src</span><span class="op" id="4383038">.</span><span class="ident" id="4383039">Comments</span>&nbsp;<span class="op" id="4383048">=</span>&nbsp;<span class="ident" id="4383050">nil</span>&nbsp;<span class="comment" id="4383054">//&nbsp;consumed&nbsp;unassociated&nbsp;comments&nbsp;-&nbsp;remove&nbsp;from&nbsp;AST</span><br>
<span class="lineno"></span><span class="op" id="4383106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4383109">func</span>&nbsp;<span class="op" id="4383114">(</span><span class="ident" id="4383115">r</span>&nbsp;<span class="op" id="4383117">*</span><span class="ident" id="4383118">reader</span><span class="op" id="4383124">)</span>&nbsp;<span class="ident" id="4383126">readPackage</span><span class="op" id="4383137">(</span><span class="ident" id="4383138">pkg</span>&nbsp;<span class="op" id="4383142">*</span><span class="ident" id="4383143">ast</span><span class="op" id="4383146">.</span><span class="ident" id="4383147">Package</span><span class="op" id="4383154">,</span>&nbsp;<span class="ident" id="4383156">mode</span>&nbsp;<span class="ident" id="4383161">Mode</span><span class="op" id="4383165">)</span>&nbsp;<span class="op" id="4383167">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383170">//&nbsp;initialize&nbsp;reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383192">r</span><span class="op" id="4383193">.</span><span class="ident" id="4383194">filenames</span>&nbsp;<span class="op" id="4383204">=</span>&nbsp;<span class="builtinfunc" id="4383206">make</span><span class="op" id="4383210">(</span><span class="op" id="4383211">[</span><span class="op" id="4383212">]</span><span class="builtintype" id="4383213">string</span><span class="op" id="4383219">,</span>&nbsp;<span class="builtinfunc" id="4383221">len</span><span class="op" id="4383224">(</span><span class="ident" id="4383225">pkg</span><span class="op" id="4383228">.</span><span class="ident" id="4383229">Files</span><span class="op" id="4383234">)</span><span class="op" id="4383235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383238">r</span><span class="op" id="4383239">.</span><span class="ident" id="4383240">imports</span>&nbsp;<span class="op" id="4383248">=</span>&nbsp;<span class="builtinfunc" id="4383250">make</span><span class="op" id="4383254">(</span><span class="keyword" id="4383255">map</span><span class="op" id="4383258">[</span><span class="builtintype" id="4383259">string</span><span class="op" id="4383265">]</span><span class="builtintype" id="4383266">int</span><span class="op" id="4383269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383272">r</span><span class="op" id="4383273">.</span><span class="ident" id="4383274">mode</span>&nbsp;<span class="op" id="4383279">=</span>&nbsp;<span class="ident" id="4383281">mode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383287">r</span><span class="op" id="4383288">.</span><span class="ident" id="4383289">types</span>&nbsp;<span class="op" id="4383295">=</span>&nbsp;<span class="builtinfunc" id="4383297">make</span><span class="op" id="4383301">(</span><span class="keyword" id="4383302">map</span><span class="op" id="4383305">[</span><span class="builtintype" id="4383306">string</span><span class="op" id="4383312">]</span><span class="op" id="4383313">*</span><span class="ident" id="4383314">namedType</span><span class="op" id="4383323">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383326">r</span><span class="op" id="4383327">.</span><span class="ident" id="4383328">funcs</span>&nbsp;<span class="op" id="4383334">=</span>&nbsp;<span class="builtinfunc" id="4383336">make</span><span class="op" id="4383340">(</span><span class="ident" id="4383341">methodSet</span><span class="op" id="4383350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383353">r</span><span class="op" id="4383354">.</span><span class="ident" id="4383355">notes</span>&nbsp;<span class="op" id="4383361">=</span>&nbsp;<span class="builtinfunc" id="4383363">make</span><span class="op" id="4383367">(</span><span class="keyword" id="4383368">map</span><span class="op" id="4383371">[</span><span class="builtintype" id="4383372">string</span><span class="op" id="4383378">]</span><span class="op" id="4383379">[</span><span class="op" id="4383380">]</span><span class="op" id="4383381">*</span><span class="ident" id="4383382">Note</span><span class="op" id="4383386">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383390">//&nbsp;sort&nbsp;package&nbsp;files&nbsp;before&nbsp;reading&nbsp;them&nbsp;so&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383445">//&nbsp;result&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;map&nbsp;iteration&nbsp;order</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383495">i</span>&nbsp;<span class="op" id="4383497">:=</span>&nbsp;<span class="num" id="4383500">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383503">for</span>&nbsp;<span class="ident" id="4383507">filename</span>&nbsp;<span class="op" id="4383516">:=</span>&nbsp;<span class="keyword" id="4383519">range</span>&nbsp;<span class="ident" id="4383525">pkg</span><span class="op" id="4383528">.</span><span class="ident" id="4383529">Files</span>&nbsp;<span class="op" id="4383535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383539">r</span><span class="op" id="4383540">.</span><span class="ident" id="4383541">filenames</span><span class="op" id="4383550">[</span><span class="ident" id="4383551">i</span><span class="op" id="4383552">]</span>&nbsp;<span class="op" id="4383554">=</span>&nbsp;<span class="ident" id="4383556">filename</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383567">i</span><span class="op" id="4383568">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383572">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383575">sort</span><span class="op" id="4383579">.</span><span class="ident" id="4383580">Strings</span><span class="op" id="4383587">(</span><span class="ident" id="4383588">r</span><span class="op" id="4383589">.</span><span class="ident" id="4383590">filenames</span><span class="op" id="4383599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4383603">//&nbsp;process&nbsp;files&nbsp;in&nbsp;sorted&nbsp;order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383637">for</span>&nbsp;<span class="ident" id="4383641">_</span><span class="op" id="4383642">,</span>&nbsp;<span class="ident" id="4383644">filename</span>&nbsp;<span class="op" id="4383653">:=</span>&nbsp;<span class="keyword" id="4383656">range</span>&nbsp;<span class="ident" id="4383662">r</span><span class="op" id="4383663">.</span><span class="ident" id="4383664">filenames</span>&nbsp;<span class="op" id="4383674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383678">f</span>&nbsp;<span class="op" id="4383680">:=</span>&nbsp;<span class="ident" id="4383683">pkg</span><span class="op" id="4383686">.</span><span class="ident" id="4383687">Files</span><span class="op" id="4383692">[</span><span class="ident" id="4383693">filename</span><span class="op" id="4383701">]</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383705">if</span>&nbsp;<span class="ident" id="4383708">mode</span><span class="op" id="4383712">&amp;</span><span class="ident" id="4383713">AllDecls</span>&nbsp;<span class="op" id="4383722">==</span>&nbsp;<span class="num" id="4383725">0</span>&nbsp;<span class="op" id="4383727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383732">r</span><span class="op" id="4383733">.</span><span class="ident" id="4383734">fileExports</span><span class="op" id="4383745">(</span><span class="ident" id="4383746">f</span><span class="op" id="4383747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4383755">r</span><span class="op" id="4383756">.</span><span class="ident" id="4383757">readFile</span><span class="op" id="4383765">(</span><span class="ident" id="4383766">f</span><span class="op" id="4383767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4383770">}</span><br>
<span class="lineno">550</span><span class="op" id="4383772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4383775">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4383855">//&nbsp;Types</span><br>
<span class="lineno"></span><br>
<span class="lineno">555</span><span class="keyword" id="4383865">func</span>&nbsp;<span class="ident" id="4383870">customizeRecv</span><span class="op" id="4383883">(</span><span class="ident" id="4383884">f</span>&nbsp;<span class="op" id="4383886">*</span><span class="ident" id="4383887">Func</span><span class="op" id="4383891">,</span>&nbsp;<span class="ident" id="4383893">recvTypeName</span>&nbsp;<span class="builtintype" id="4383906">string</span><span class="op" id="4383912">,</span>&nbsp;<span class="ident" id="4383914">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="4383928">bool</span><span class="op" id="4383932">,</span>&nbsp;<span class="ident" id="4383934">level</span>&nbsp;<span class="builtintype" id="4383940">int</span><span class="op" id="4383943">)</span>&nbsp;<span class="op" id="4383945">*</span><span class="ident" id="4383946">Func</span>&nbsp;<span class="op" id="4383951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4383954">if</span>&nbsp;<span class="ident" id="4383957">f</span>&nbsp;<span class="op" id="4383959">==</span>&nbsp;<span class="ident" id="4383962">nil</span>&nbsp;<span class="op" id="4383966">||</span>&nbsp;<span class="ident" id="4383969">f</span><span class="op" id="4383970">.</span><span class="ident" id="4383971">Decl</span>&nbsp;<span class="op" id="4383976">==</span>&nbsp;<span class="ident" id="4383979">nil</span>&nbsp;<span class="op" id="4383983">||</span>&nbsp;<span class="ident" id="4383986">f</span><span class="op" id="4383987">.</span><span class="ident" id="4383988">Decl</span><span class="op" id="4383992">.</span><span class="ident" id="4383993">Recv</span>&nbsp;<span class="op" id="4383998">==</span>&nbsp;<span class="ident" id="4384001">nil</span>&nbsp;<span class="op" id="4384005">||</span>&nbsp;<span class="builtinfunc" id="4384008">len</span><span class="op" id="4384011">(</span><span class="ident" id="4384012">f</span><span class="op" id="4384013">.</span><span class="ident" id="4384014">Decl</span><span class="op" id="4384018">.</span><span class="ident" id="4384019">Recv</span><span class="op" id="4384023">.</span><span class="ident" id="4384024">List</span><span class="op" id="4384028">)</span>&nbsp;<span class="op" id="4384030">!=</span>&nbsp;<span class="num" id="4384033">1</span>&nbsp;<span class="op" id="4384035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384039">return</span>&nbsp;<span class="ident" id="4384046">f</span>&nbsp;<span class="comment" id="4384048">//&nbsp;shouldn&#39;t&nbsp;happen,&nbsp;but&nbsp;be&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4384086">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;and&nbsp;set&nbsp;new&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384136">newField</span>&nbsp;<span class="op" id="4384145">:=</span>&nbsp;<span class="op" id="4384148">*</span><span class="ident" id="4384149">f</span><span class="op" id="4384150">.</span><span class="ident" id="4384151">Decl</span><span class="op" id="4384155">.</span><span class="ident" id="4384156">Recv</span><span class="op" id="4384160">.</span><span class="ident" id="4384161">List</span><span class="op" id="4384165">[</span><span class="num" id="4384166">0</span><span class="op" id="4384167">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384170">origPos</span>&nbsp;<span class="op" id="4384178">:=</span>&nbsp;<span class="ident" id="4384181">newField</span><span class="op" id="4384189">.</span><span class="ident" id="4384190">Type</span><span class="op" id="4384194">.</span><span class="ident" id="4384195">Pos</span><span class="op" id="4384198">(</span><span class="op" id="4384199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384202">_</span><span class="op" id="4384203">,</span>&nbsp;<span class="ident" id="4384205">origRecvIsPtr</span>&nbsp;<span class="op" id="4384219">:=</span>&nbsp;<span class="ident" id="4384222">newField</span><span class="op" id="4384230">.</span><span class="ident" id="4384231">Type</span><span class="op" id="4384235">.</span><span class="op" id="4384236">(</span><span class="op" id="4384237">*</span><span class="ident" id="4384238">ast</span><span class="op" id="4384241">.</span><span class="ident" id="4384242">StarExpr</span><span class="op" id="4384250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384253">newIdent</span>&nbsp;<span class="op" id="4384262">:=</span>&nbsp;<span class="op" id="4384265">&amp;</span><span class="ident" id="4384266">ast</span><span class="op" id="4384269">.</span><span class="ident" id="4384270">Ident</span><span class="op" id="4384275">{</span><span class="ident" id="4384276">NamePos</span><span class="op" id="4384283">:</span>&nbsp;<span class="ident" id="4384285">origPos</span><span class="op" id="4384292">,</span>&nbsp;<span class="ident" id="4384294">Name</span><span class="op" id="4384298">:</span>&nbsp;<span class="ident" id="4384300">recvTypeName</span><span class="op" id="4384312">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384315">var</span>&nbsp;<span class="ident" id="4384319">typ</span>&nbsp;<span class="ident" id="4384323">ast</span><span class="op" id="4384326">.</span><span class="ident" id="4384327">Expr</span>&nbsp;<span class="op" id="4384332">=</span>&nbsp;<span class="ident" id="4384334">newIdent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384344">if</span>&nbsp;<span class="op" id="4384347">!</span><span class="ident" id="4384348">embeddedIsPtr</span>&nbsp;<span class="op" id="4384362">&amp;&amp;</span>&nbsp;<span class="ident" id="4384365">origRecvIsPtr</span>&nbsp;<span class="op" id="4384379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384383">newIdent</span><span class="op" id="4384391">.</span><span class="ident" id="4384392">NamePos</span><span class="op" id="4384399">++</span>&nbsp;<span class="comment" id="4384402">//&nbsp;&#39;*&#39;&nbsp;is&nbsp;one&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384428">typ</span>&nbsp;<span class="op" id="4384432">=</span>&nbsp;<span class="op" id="4384434">&amp;</span><span class="ident" id="4384435">ast</span><span class="op" id="4384438">.</span><span class="ident" id="4384439">StarExpr</span><span class="op" id="4384447">{</span><span class="ident" id="4384448">Star</span><span class="op" id="4384452">:</span>&nbsp;<span class="ident" id="4384454">origPos</span><span class="op" id="4384461">,</span>&nbsp;<span class="ident" id="4384463">X</span><span class="op" id="4384464">:</span>&nbsp;<span class="ident" id="4384466">newIdent</span><span class="op" id="4384474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4384477">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384480">newField</span><span class="op" id="4384488">.</span><span class="ident" id="4384489">Type</span>&nbsp;<span class="op" id="4384494">=</span>&nbsp;<span class="ident" id="4384496">typ</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4384502">//&nbsp;copy&nbsp;existing&nbsp;receiver&nbsp;field&nbsp;list&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384567">newFieldList</span>&nbsp;<span class="op" id="4384580">:=</span>&nbsp;<span class="op" id="4384583">*</span><span class="ident" id="4384584">f</span><span class="op" id="4384585">.</span><span class="ident" id="4384586">Decl</span><span class="op" id="4384590">.</span><span class="ident" id="4384591">Recv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384597">newFieldList</span><span class="op" id="4384609">.</span><span class="ident" id="4384610">List</span>&nbsp;<span class="op" id="4384615">=</span>&nbsp;<span class="op" id="4384617">[</span><span class="op" id="4384618">]</span><span class="op" id="4384619">*</span><span class="ident" id="4384620">ast</span><span class="op" id="4384623">.</span><span class="ident" id="4384624">Field</span><span class="op" id="4384629">{</span><span class="op" id="4384630">&amp;</span><span class="ident" id="4384631">newField</span><span class="op" id="4384639">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4384643">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;declaration&nbsp;and&nbsp;set&nbsp;new&nbsp;receiver&nbsp;field&nbsp;list</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384714">newFuncDecl</span>&nbsp;<span class="op" id="4384726">:=</span>&nbsp;<span class="op" id="4384729">*</span><span class="ident" id="4384730">f</span><span class="op" id="4384731">.</span><span class="ident" id="4384732">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384738">newFuncDecl</span><span class="op" id="4384749">.</span><span class="ident" id="4384750">Recv</span>&nbsp;<span class="op" id="4384755">=</span>&nbsp;<span class="op" id="4384757">&amp;</span><span class="ident" id="4384758">newFieldList</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4384773">//&nbsp;copy&nbsp;existing&nbsp;function&nbsp;documentation&nbsp;and&nbsp;set&nbsp;new&nbsp;declaration</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384838">newF</span>&nbsp;<span class="op" id="4384843">:=</span>&nbsp;<span class="op" id="4384846">*</span><span class="ident" id="4384847">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384850">newF</span><span class="op" id="4384854">.</span><span class="ident" id="4384855">Decl</span>&nbsp;<span class="op" id="4384860">=</span>&nbsp;<span class="op" id="4384862">&amp;</span><span class="ident" id="4384863">newFuncDecl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384876">newF</span><span class="op" id="4384880">.</span><span class="ident" id="4384881">Recv</span>&nbsp;<span class="op" id="4384886">=</span>&nbsp;<span class="ident" id="4384888">recvString</span><span class="op" id="4384898">(</span><span class="ident" id="4384899">typ</span><span class="op" id="4384902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4384905">//&nbsp;the&nbsp;Orig&nbsp;field&nbsp;never&nbsp;changes</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4384938">newF</span><span class="op" id="4384942">.</span><span class="ident" id="4384943">Level</span>&nbsp;<span class="op" id="4384949">=</span>&nbsp;<span class="ident" id="4384951">level</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4384959">return</span>&nbsp;<span class="op" id="4384966">&amp;</span><span class="ident" id="4384967">newF</span><br>
<span class="lineno"></span><span class="op" id="4384972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">590</span><span class="comment" id="4384975">//&nbsp;collectEmbeddedMethods&nbsp;collects&nbsp;the&nbsp;embedded&nbsp;methods&nbsp;of&nbsp;typ&nbsp;in&nbsp;mset.</span><br>
<span class="lineno"></span><span class="comment" id="4385047">//</span><br>
<span class="lineno"></span><span class="keyword" id="4385050">func</span>&nbsp;<span class="op" id="4385055">(</span><span class="ident" id="4385056">r</span>&nbsp;<span class="op" id="4385058">*</span><span class="ident" id="4385059">reader</span><span class="op" id="4385065">)</span>&nbsp;<span class="ident" id="4385067">collectEmbeddedMethods</span><span class="op" id="4385089">(</span><span class="ident" id="4385090">mset</span>&nbsp;<span class="ident" id="4385095">methodSet</span><span class="op" id="4385104">,</span>&nbsp;<span class="ident" id="4385106">typ</span>&nbsp;<span class="op" id="4385110">*</span><span class="ident" id="4385111">namedType</span><span class="op" id="4385120">,</span>&nbsp;<span class="ident" id="4385122">recvTypeName</span>&nbsp;<span class="builtintype" id="4385135">string</span><span class="op" id="4385141">,</span>&nbsp;<span class="ident" id="4385143">embeddedIsPtr</span>&nbsp;<span class="builtintype" id="4385157">bool</span><span class="op" id="4385161">,</span>&nbsp;<span class="ident" id="4385163">level</span>&nbsp;<span class="builtintype" id="4385169">int</span><span class="op" id="4385172">,</span>&nbsp;<span class="ident" id="4385174">visited</span>&nbsp;<span class="ident" id="4385182">embeddedSet</span><span class="op" id="4385193">)</span>&nbsp;<span class="op" id="4385195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385198">visited</span><span class="op" id="4385205">[</span><span class="ident" id="4385206">typ</span><span class="op" id="4385209">]</span>&nbsp;<span class="op" id="4385211">=</span>&nbsp;<span class="builtintype" id="4385213">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385219">for</span>&nbsp;<span class="ident" id="4385223">embedded</span><span class="op" id="4385231">,</span>&nbsp;<span class="ident" id="4385233">isPtr</span>&nbsp;<span class="op" id="4385239">:=</span>&nbsp;<span class="keyword" id="4385242">range</span>&nbsp;<span class="ident" id="4385248">typ</span><span class="op" id="4385251">.</span><span class="ident" id="4385252">embedded</span>&nbsp;<span class="op" id="4385261">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385265">//&nbsp;Once&nbsp;an&nbsp;embedded&nbsp;type&nbsp;is&nbsp;embedded&nbsp;as&nbsp;a&nbsp;pointer&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385322">//&nbsp;all&nbsp;embedded&nbsp;types&nbsp;in&nbsp;those&nbsp;types&nbsp;are&nbsp;treated&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385378">//&nbsp;pointer&nbsp;types&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;receiver&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385434">//&nbsp;computation;&nbsp;i.e.,&nbsp;embeddedIsPtr&nbsp;is&nbsp;sticky&nbsp;for&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385491">//&nbsp;embedding&nbsp;hierarchy.</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385517">thisEmbeddedIsPtr</span>&nbsp;<span class="op" id="4385535">:=</span>&nbsp;<span class="ident" id="4385538">embeddedIsPtr</span>&nbsp;<span class="op" id="4385552">||</span>&nbsp;<span class="ident" id="4385555">isPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385563">for</span>&nbsp;<span class="ident" id="4385567">_</span><span class="op" id="4385568">,</span>&nbsp;<span class="ident" id="4385570">m</span>&nbsp;<span class="op" id="4385572">:=</span>&nbsp;<span class="keyword" id="4385575">range</span>&nbsp;<span class="ident" id="4385581">embedded</span><span class="op" id="4385589">.</span><span class="ident" id="4385590">methods</span>&nbsp;<span class="op" id="4385598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4385603">//&nbsp;only&nbsp;top-level&nbsp;methods&nbsp;are&nbsp;embedded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385645">if</span>&nbsp;<span class="ident" id="4385648">m</span><span class="op" id="4385649">.</span><span class="ident" id="4385650">Level</span>&nbsp;<span class="op" id="4385656">==</span>&nbsp;<span class="num" id="4385659">0</span>&nbsp;<span class="op" id="4385661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385667">mset</span><span class="op" id="4385671">.</span><span class="ident" id="4385672">add</span><span class="op" id="4385675">(</span><span class="ident" id="4385676">customizeRecv</span><span class="op" id="4385689">(</span><span class="ident" id="4385690">m</span><span class="op" id="4385691">,</span>&nbsp;<span class="ident" id="4385693">recvTypeName</span><span class="op" id="4385705">,</span>&nbsp;<span class="ident" id="4385707">thisEmbeddedIsPtr</span><span class="op" id="4385724">,</span>&nbsp;<span class="ident" id="4385726">level</span><span class="op" id="4385731">)</span><span class="op" id="4385732">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385741">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4385745">if</span>&nbsp;<span class="op" id="4385748">!</span><span class="ident" id="4385749">visited</span><span class="op" id="4385756">[</span><span class="ident" id="4385757">embedded</span><span class="op" id="4385765">]</span>&nbsp;<span class="op" id="4385767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4385772">r</span><span class="op" id="4385773">.</span><span class="ident" id="4385774">collectEmbeddedMethods</span><span class="op" id="4385796">(</span><span class="ident" id="4385797">mset</span><span class="op" id="4385801">,</span>&nbsp;<span class="ident" id="4385803">embedded</span><span class="op" id="4385811">,</span>&nbsp;<span class="ident" id="4385813">recvTypeName</span><span class="op" id="4385825">,</span>&nbsp;<span class="ident" id="4385827">thisEmbeddedIsPtr</span><span class="op" id="4385844">,</span>&nbsp;<span class="ident" id="4385846">level</span><span class="op" id="4385851">+</span><span class="num" id="4385852">1</span><span class="op" id="4385853">,</span>&nbsp;<span class="ident" id="4385855">visited</span><span class="op" id="4385862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385866">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4385869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4385872">delete</span><span class="op" id="4385878">(</span><span class="ident" id="4385879">visited</span><span class="op" id="4385886">,</span>&nbsp;<span class="ident" id="4385888">typ</span><span class="op" id="4385891">)</span><br>
<span class="lineno"></span><span class="op" id="4385893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4385896">//&nbsp;computeMethodSets&nbsp;determines&nbsp;the&nbsp;actual&nbsp;method&nbsp;sets&nbsp;for&nbsp;each&nbsp;type&nbsp;encountered.</span><br>
<span class="lineno">615</span><span class="comment" id="4385978">//</span><br>
<span class="lineno"></span><span class="keyword" id="4385981">func</span>&nbsp;<span class="op" id="4385986">(</span><span class="ident" id="4385987">r</span>&nbsp;<span class="op" id="4385989">*</span><span class="ident" id="4385990">reader</span><span class="op" id="4385996">)</span>&nbsp;<span class="ident" id="4385998">computeMethodSets</span><span class="op" id="4386015">(</span><span class="op" id="4386016">)</span>&nbsp;<span class="op" id="4386018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386021">for</span>&nbsp;<span class="ident" id="4386025">_</span><span class="op" id="4386026">,</span>&nbsp;<span class="ident" id="4386028">t</span>&nbsp;<span class="op" id="4386030">:=</span>&nbsp;<span class="keyword" id="4386033">range</span>&nbsp;<span class="ident" id="4386039">r</span><span class="op" id="4386040">.</span><span class="ident" id="4386041">types</span>&nbsp;<span class="op" id="4386047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386051">//&nbsp;collect&nbsp;embedded&nbsp;methods&nbsp;for&nbsp;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386087">if</span>&nbsp;<span class="ident" id="4386090">t</span><span class="op" id="4386091">.</span><span class="ident" id="4386092">isStruct</span>&nbsp;<span class="op" id="4386101">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386106">//&nbsp;struct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386119">r</span><span class="op" id="4386120">.</span><span class="ident" id="4386121">collectEmbeddedMethods</span><span class="op" id="4386143">(</span><span class="ident" id="4386144">t</span><span class="op" id="4386145">.</span><span class="ident" id="4386146">methods</span><span class="op" id="4386153">,</span>&nbsp;<span class="ident" id="4386155">t</span><span class="op" id="4386156">,</span>&nbsp;<span class="ident" id="4386158">t</span><span class="op" id="4386159">.</span><span class="ident" id="4386160">name</span><span class="op" id="4386164">,</span>&nbsp;<span class="builtintype" id="4386166">false</span><span class="op" id="4386171">,</span>&nbsp;<span class="num" id="4386173">1</span><span class="op" id="4386174">,</span>&nbsp;<span class="builtinfunc" id="4386176">make</span><span class="op" id="4386180">(</span><span class="ident" id="4386181">embeddedSet</span><span class="op" id="4386192">)</span><span class="op" id="4386193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386197">}</span>&nbsp;<span class="keyword" id="4386199">else</span>&nbsp;<span class="op" id="4386204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386209">//&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386225">//&nbsp;TODO(gri)&nbsp;fix&nbsp;this</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386256">//&nbsp;if&nbsp;error&nbsp;was&nbsp;declared&nbsp;locally,&nbsp;don&#39;t&nbsp;treat&nbsp;it&nbsp;as&nbsp;exported&nbsp;field&nbsp;anymore</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386332">if</span>&nbsp;<span class="ident" id="4386335">r</span><span class="op" id="4386336">.</span><span class="ident" id="4386337">errorDecl</span>&nbsp;<span class="op" id="4386347">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386351">for</span>&nbsp;<span class="ident" id="4386355">_</span><span class="op" id="4386356">,</span>&nbsp;<span class="ident" id="4386358">ityp</span>&nbsp;<span class="op" id="4386363">:=</span>&nbsp;<span class="keyword" id="4386366">range</span>&nbsp;<span class="ident" id="4386372">r</span><span class="op" id="4386373">.</span><span class="ident" id="4386374">fixlist</span>&nbsp;<span class="op" id="4386382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386387">removeErrorField</span><span class="op" id="4386403">(</span><span class="ident" id="4386404">ityp</span><span class="op" id="4386408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4386415">}</span><br>
<span class="lineno"></span><span class="op" id="4386417">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="comment" id="4386420">//&nbsp;cleanupTypes&nbsp;removes&nbsp;the&nbsp;association&nbsp;of&nbsp;functions&nbsp;and&nbsp;methods&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4386490">//&nbsp;types&nbsp;that&nbsp;have&nbsp;no&nbsp;declaration.&nbsp;Instead,&nbsp;these&nbsp;functions&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span><span class="comment" id="4386562">//&nbsp;are&nbsp;shown&nbsp;at&nbsp;the&nbsp;package&nbsp;level.&nbsp;It&nbsp;also&nbsp;removes&nbsp;types&nbsp;with&nbsp;missing</span><br>
<span class="lineno"></span><span class="comment" id="4386632">//&nbsp;declarations&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible.</span><br>
<span class="lineno">640</span><span class="comment" id="4386674">//</span><br>
<span class="lineno"></span><span class="keyword" id="4386677">func</span>&nbsp;<span class="op" id="4386682">(</span><span class="ident" id="4386683">r</span>&nbsp;<span class="op" id="4386685">*</span><span class="ident" id="4386686">reader</span><span class="op" id="4386692">)</span>&nbsp;<span class="ident" id="4386694">cleanupTypes</span><span class="op" id="4386706">(</span><span class="op" id="4386707">)</span>&nbsp;<span class="op" id="4386709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386712">for</span>&nbsp;<span class="ident" id="4386716">_</span><span class="op" id="4386717">,</span>&nbsp;<span class="ident" id="4386719">t</span>&nbsp;<span class="op" id="4386721">:=</span>&nbsp;<span class="keyword" id="4386724">range</span>&nbsp;<span class="ident" id="4386730">r</span><span class="op" id="4386731">.</span><span class="ident" id="4386732">types</span>&nbsp;<span class="op" id="4386738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4386742">visible</span>&nbsp;<span class="op" id="4386750">:=</span>&nbsp;<span class="ident" id="4386753">r</span><span class="op" id="4386754">.</span><span class="ident" id="4386755">isVisible</span><span class="op" id="4386764">(</span><span class="ident" id="4386765">t</span><span class="op" id="4386766">.</span><span class="ident" id="4386767">name</span><span class="op" id="4386771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4386775">if</span>&nbsp;<span class="ident" id="4386778">t</span><span class="op" id="4386779">.</span><span class="ident" id="4386780">decl</span>&nbsp;<span class="op" id="4386785">==</span>&nbsp;<span class="ident" id="4386788">nil</span>&nbsp;<span class="op" id="4386792">&amp;&amp;</span>&nbsp;<span class="op" id="4386795">(</span><span class="ident" id="4386796">predeclaredTypes</span><span class="op" id="4386812">[</span><span class="ident" id="4386813">t</span><span class="op" id="4386814">.</span><span class="ident" id="4386815">name</span><span class="op" id="4386819">]</span>&nbsp;<span class="op" id="4386821">||</span>&nbsp;<span class="ident" id="4386824">t</span><span class="op" id="4386825">.</span><span class="ident" id="4386826">isEmbedded</span>&nbsp;<span class="op" id="4386837">&amp;&amp;</span>&nbsp;<span class="ident" id="4386840">visible</span><span class="op" id="4386847">)</span>&nbsp;<span class="op" id="4386849">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386854">//&nbsp;t.name&nbsp;is&nbsp;a&nbsp;predeclared&nbsp;type&nbsp;(and&nbsp;was&nbsp;not&nbsp;redeclared&nbsp;in&nbsp;this&nbsp;package),</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4386931">//&nbsp;or&nbsp;it&nbsp;was&nbsp;embedded&nbsp;somewhere&nbsp;but&nbsp;its&nbsp;declaration&nbsp;is&nbsp;missing&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387006">//&nbsp;the&nbsp;AST&nbsp;is&nbsp;incomplete):&nbsp;move&nbsp;any&nbsp;associated&nbsp;values,&nbsp;funcs,&nbsp;and&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387083">//&nbsp;back&nbsp;to&nbsp;the&nbsp;top-level&nbsp;so&nbsp;that&nbsp;they&nbsp;are&nbsp;not&nbsp;lost.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387138">//&nbsp;1)&nbsp;move&nbsp;values</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387159">r</span><span class="op" id="4387160">.</span><span class="ident" id="4387161">values</span>&nbsp;<span class="op" id="4387168">=</span>&nbsp;<span class="builtinfunc" id="4387170">append</span><span class="op" id="4387176">(</span><span class="ident" id="4387177">r</span><span class="op" id="4387178">.</span><span class="ident" id="4387179">values</span><span class="op" id="4387185">,</span>&nbsp;<span class="ident" id="4387187">t</span><span class="op" id="4387188">.</span><span class="ident" id="4387189">values</span><span class="op" id="4387195">...</span><span class="op" id="4387198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387203">//&nbsp;2)&nbsp;move&nbsp;factory&nbsp;functions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387235">for</span>&nbsp;<span class="ident" id="4387239">name</span><span class="op" id="4387243">,</span>&nbsp;<span class="ident" id="4387245">f</span>&nbsp;<span class="op" id="4387247">:=</span>&nbsp;<span class="keyword" id="4387250">range</span>&nbsp;<span class="ident" id="4387256">t</span><span class="op" id="4387257">.</span><span class="ident" id="4387258">funcs</span>&nbsp;<span class="op" id="4387264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387270">//&nbsp;in&nbsp;a&nbsp;correct&nbsp;AST,&nbsp;package-level&nbsp;function&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387324">//&nbsp;are&nbsp;all&nbsp;different&nbsp;-&nbsp;no&nbsp;need&nbsp;to&nbsp;check&nbsp;for&nbsp;conflicts</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387382">r</span><span class="op" id="4387383">.</span><span class="ident" id="4387384">funcs</span><span class="op" id="4387389">[</span><span class="ident" id="4387390">name</span><span class="op" id="4387394">]</span>&nbsp;<span class="op" id="4387396">=</span>&nbsp;<span class="ident" id="4387398">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387408">//&nbsp;3)&nbsp;move&nbsp;methods</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387430">for</span>&nbsp;<span class="ident" id="4387434">name</span><span class="op" id="4387438">,</span>&nbsp;<span class="ident" id="4387440">m</span>&nbsp;<span class="op" id="4387442">:=</span>&nbsp;<span class="keyword" id="4387445">range</span>&nbsp;<span class="ident" id="4387451">t</span><span class="op" id="4387452">.</span><span class="ident" id="4387453">methods</span>&nbsp;<span class="op" id="4387461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387467">//&nbsp;don&#39;t&nbsp;overwrite&nbsp;functions&nbsp;with&nbsp;the&nbsp;same&nbsp;name&nbsp;-&nbsp;drop&nbsp;them</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387531">if</span>&nbsp;<span class="ident" id="4387534">_</span><span class="op" id="4387535">,</span>&nbsp;<span class="ident" id="4387537">found</span>&nbsp;<span class="op" id="4387543">:=</span>&nbsp;<span class="ident" id="4387546">r</span><span class="op" id="4387547">.</span><span class="ident" id="4387548">funcs</span><span class="op" id="4387553">[</span><span class="ident" id="4387554">name</span><span class="op" id="4387558">]</span><span class="op" id="4387559">;</span>&nbsp;<span class="op" id="4387561">!</span><span class="ident" id="4387562">found</span>&nbsp;<span class="op" id="4387568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387575">r</span><span class="op" id="4387576">.</span><span class="ident" id="4387577">funcs</span><span class="op" id="4387582">[</span><span class="ident" id="4387583">name</span><span class="op" id="4387587">]</span>&nbsp;<span class="op" id="4387589">=</span>&nbsp;<span class="ident" id="4387591">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387606">}</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4387610">//&nbsp;remove&nbsp;types&nbsp;w/o&nbsp;declaration&nbsp;or&nbsp;which&nbsp;are&nbsp;not&nbsp;visible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4387669">if</span>&nbsp;<span class="ident" id="4387672">t</span><span class="op" id="4387673">.</span><span class="ident" id="4387674">decl</span>&nbsp;<span class="op" id="4387679">==</span>&nbsp;<span class="ident" id="4387682">nil</span>&nbsp;<span class="op" id="4387686">||</span>&nbsp;<span class="op" id="4387689">!</span><span class="ident" id="4387690">visible</span>&nbsp;<span class="op" id="4387698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4387703">delete</span><span class="op" id="4387709">(</span><span class="ident" id="4387710">r</span><span class="op" id="4387711">.</span><span class="ident" id="4387712">types</span><span class="op" id="4387717">,</span>&nbsp;<span class="ident" id="4387719">t</span><span class="op" id="4387720">.</span><span class="ident" id="4387721">name</span><span class="op" id="4387725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4387732">}</span><br>
<span class="lineno">670</span><span class="op" id="4387734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4387737">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno"></span><span class="comment" id="4387817">//&nbsp;Sorting</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="4387829">type</span>&nbsp;<span class="ident" id="4387834">data</span>&nbsp;<span class="keyword" id="4387839">struct</span>&nbsp;<span class="op" id="4387846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387849">n</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4387854">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387859">swap</span>&nbsp;<span class="keyword" id="4387864">func</span><span class="op" id="4387868">(</span><span class="ident" id="4387869">i</span><span class="op" id="4387870">,</span>&nbsp;<span class="ident" id="4387872">j</span>&nbsp;<span class="builtintype" id="4387874">int</span><span class="op" id="4387877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4387880">less</span>&nbsp;<span class="keyword" id="4387885">func</span><span class="op" id="4387889">(</span><span class="ident" id="4387890">i</span><span class="op" id="4387891">,</span>&nbsp;<span class="ident" id="4387893">j</span>&nbsp;<span class="builtintype" id="4387895">int</span><span class="op" id="4387898">)</span>&nbsp;<span class="builtintype" id="4387900">bool</span><br>
<span class="lineno"></span><span class="op" id="4387905">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="4387908">func</span>&nbsp;<span class="op" id="4387913">(</span><span class="ident" id="4387914">d</span>&nbsp;<span class="op" id="4387916">*</span><span class="ident" id="4387917">data</span><span class="op" id="4387921">)</span>&nbsp;<span class="ident" id="4387923">Len</span><span class="op" id="4387926">(</span><span class="op" id="4387927">)</span>&nbsp;<span class="builtintype" id="4387929">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387943">{</span>&nbsp;<span class="keyword" id="4387945">return</span>&nbsp;<span class="ident" id="4387952">d</span><span class="op" id="4387953">.</span><span class="ident" id="4387954">n</span>&nbsp;<span class="op" id="4387956">}</span><br>
<span class="lineno"></span><span class="keyword" id="4387958">func</span>&nbsp;<span class="op" id="4387963">(</span><span class="ident" id="4387964">d</span>&nbsp;<span class="op" id="4387966">*</span><span class="ident" id="4387967">data</span><span class="op" id="4387971">)</span>&nbsp;<span class="ident" id="4387973">Swap</span><span class="op" id="4387977">(</span><span class="ident" id="4387978">i</span><span class="op" id="4387979">,</span>&nbsp;<span class="ident" id="4387981">j</span>&nbsp;<span class="builtintype" id="4387983">int</span><span class="op" id="4387986">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4387993">{</span>&nbsp;<span class="ident" id="4387995">d</span><span class="op" id="4387996">.</span><span class="ident" id="4387997">swap</span><span class="op" id="4388001">(</span><span class="ident" id="4388002">i</span><span class="op" id="4388003">,</span>&nbsp;<span class="ident" id="4388005">j</span><span class="op" id="4388006">)</span>&nbsp;<span class="op" id="4388008">}</span><br>
<span class="lineno"></span><span class="keyword" id="4388010">func</span>&nbsp;<span class="op" id="4388015">(</span><span class="ident" id="4388016">d</span>&nbsp;<span class="op" id="4388018">*</span><span class="ident" id="4388019">data</span><span class="op" id="4388023">)</span>&nbsp;<span class="ident" id="4388025">Less</span><span class="op" id="4388029">(</span><span class="ident" id="4388030">i</span><span class="op" id="4388031">,</span>&nbsp;<span class="ident" id="4388033">j</span>&nbsp;<span class="builtintype" id="4388035">int</span><span class="op" id="4388038">)</span>&nbsp;<span class="builtintype" id="4388040">bool</span>&nbsp;<span class="op" id="4388045">{</span>&nbsp;<span class="keyword" id="4388047">return</span>&nbsp;<span class="ident" id="4388054">d</span><span class="op" id="4388055">.</span><span class="ident" id="4388056">less</span><span class="op" id="4388060">(</span><span class="ident" id="4388061">i</span><span class="op" id="4388062">,</span>&nbsp;<span class="ident" id="4388064">j</span><span class="op" id="4388065">)</span>&nbsp;<span class="op" id="4388067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="comment" id="4388070">//&nbsp;sortBy&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;sorting</span><br>
<span class="lineno"></span><span class="keyword" id="4388113">func</span>&nbsp;<span class="ident" id="4388118">sortBy</span><span class="op" id="4388124">(</span><span class="ident" id="4388125">less</span>&nbsp;<span class="keyword" id="4388130">func</span><span class="op" id="4388134">(</span><span class="ident" id="4388135">i</span><span class="op" id="4388136">,</span>&nbsp;<span class="ident" id="4388138">j</span>&nbsp;<span class="builtintype" id="4388140">int</span><span class="op" id="4388143">)</span>&nbsp;<span class="builtintype" id="4388145">bool</span><span class="op" id="4388149">,</span>&nbsp;<span class="ident" id="4388151">swap</span>&nbsp;<span class="keyword" id="4388156">func</span><span class="op" id="4388160">(</span><span class="ident" id="4388161">i</span><span class="op" id="4388162">,</span>&nbsp;<span class="ident" id="4388164">j</span>&nbsp;<span class="builtintype" id="4388166">int</span><span class="op" id="4388169">)</span><span class="op" id="4388170">,</span>&nbsp;<span class="ident" id="4388172">n</span>&nbsp;<span class="builtintype" id="4388174">int</span><span class="op" id="4388177">)</span>&nbsp;<span class="op" id="4388179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388182">sort</span><span class="op" id="4388186">.</span><span class="ident" id="4388187">Sort</span><span class="op" id="4388191">(</span><span class="op" id="4388192">&amp;</span><span class="ident" id="4388193">data</span><span class="op" id="4388197">{</span><span class="ident" id="4388198">n</span><span class="op" id="4388199">,</span>&nbsp;<span class="ident" id="4388201">swap</span><span class="op" id="4388205">,</span>&nbsp;<span class="ident" id="4388207">less</span><span class="op" id="4388211">}</span><span class="op" id="4388212">)</span><br>
<span class="lineno"></span><span class="op" id="4388214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="4388217">func</span>&nbsp;<span class="ident" id="4388222">sortedKeys</span><span class="op" id="4388232">(</span><span class="ident" id="4388233">m</span>&nbsp;<span class="keyword" id="4388235">map</span><span class="op" id="4388238">[</span><span class="builtintype" id="4388239">string</span><span class="op" id="4388245">]</span><span class="builtintype" id="4388246">int</span><span class="op" id="4388249">)</span>&nbsp;<span class="op" id="4388251">[</span><span class="op" id="4388252">]</span><span class="builtintype" id="4388253">string</span>&nbsp;<span class="op" id="4388260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388263">list</span>&nbsp;<span class="op" id="4388268">:=</span>&nbsp;<span class="builtinfunc" id="4388271">make</span><span class="op" id="4388275">(</span><span class="op" id="4388276">[</span><span class="op" id="4388277">]</span><span class="builtintype" id="4388278">string</span><span class="op" id="4388284">,</span>&nbsp;<span class="builtinfunc" id="4388286">len</span><span class="op" id="4388289">(</span><span class="ident" id="4388290">m</span><span class="op" id="4388291">)</span><span class="op" id="4388292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388295">i</span>&nbsp;<span class="op" id="4388297">:=</span>&nbsp;<span class="num" id="4388300">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388303">for</span>&nbsp;<span class="ident" id="4388307">key</span>&nbsp;<span class="op" id="4388311">:=</span>&nbsp;<span class="keyword" id="4388314">range</span>&nbsp;<span class="ident" id="4388320">m</span>&nbsp;<span class="op" id="4388322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388326">list</span><span class="op" id="4388330">[</span><span class="ident" id="4388331">i</span><span class="op" id="4388332">]</span>&nbsp;<span class="op" id="4388334">=</span>&nbsp;<span class="ident" id="4388336">key</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388342">i</span><span class="op" id="4388343">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388350">sort</span><span class="op" id="4388354">.</span><span class="ident" id="4388355">Strings</span><span class="op" id="4388362">(</span><span class="ident" id="4388363">list</span><span class="op" id="4388367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388370">return</span>&nbsp;<span class="ident" id="4388377">list</span><br>
<span class="lineno"></span><span class="op" id="4388382">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="comment" id="4388385">//&nbsp;sortingName&nbsp;returns&nbsp;the&nbsp;name&nbsp;to&nbsp;use&nbsp;when&nbsp;sorting&nbsp;d&nbsp;into&nbsp;place.</span><br>
<span class="lineno"></span><span class="comment" id="4388451">//</span><br>
<span class="lineno"></span><span class="keyword" id="4388454">func</span>&nbsp;<span class="ident" id="4388459">sortingName</span><span class="op" id="4388470">(</span><span class="ident" id="4388471">d</span>&nbsp;<span class="op" id="4388473">*</span><span class="ident" id="4388474">ast</span><span class="op" id="4388477">.</span><span class="ident" id="4388478">GenDecl</span><span class="op" id="4388485">)</span>&nbsp;<span class="builtintype" id="4388487">string</span>&nbsp;<span class="op" id="4388494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388497">if</span>&nbsp;<span class="builtinfunc" id="4388500">len</span><span class="op" id="4388503">(</span><span class="ident" id="4388504">d</span><span class="op" id="4388505">.</span><span class="ident" id="4388506">Specs</span><span class="op" id="4388511">)</span>&nbsp;<span class="op" id="4388513">==</span>&nbsp;<span class="num" id="4388516">1</span>&nbsp;<span class="op" id="4388518">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388522">if</span>&nbsp;<span class="ident" id="4388525">s</span><span class="op" id="4388526">,</span>&nbsp;<span class="ident" id="4388528">ok</span>&nbsp;<span class="op" id="4388531">:=</span>&nbsp;<span class="ident" id="4388534">d</span><span class="op" id="4388535">.</span><span class="ident" id="4388536">Specs</span><span class="op" id="4388541">[</span><span class="num" id="4388542">0</span><span class="op" id="4388543">]</span><span class="op" id="4388544">.</span><span class="op" id="4388545">(</span><span class="op" id="4388546">*</span><span class="ident" id="4388547">ast</span><span class="op" id="4388550">.</span><span class="ident" id="4388551">ValueSpec</span><span class="op" id="4388560">)</span><span class="op" id="4388561">;</span>&nbsp;<span class="ident" id="4388563">ok</span>&nbsp;<span class="op" id="4388566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388571">return</span>&nbsp;<span class="ident" id="4388578">s</span><span class="op" id="4388579">.</span><span class="ident" id="4388580">Names</span><span class="op" id="4388585">[</span><span class="num" id="4388586">0</span><span class="op" id="4388587">]</span><span class="op" id="4388588">.</span><span class="ident" id="4388589">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388602">return</span>&nbsp;<span class="string" id="4388609">&#34;&#34;</span><br>
<span class="lineno">710</span><span class="op" id="4388612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4388615">func</span>&nbsp;<span class="ident" id="4388620">sortedValues</span><span class="op" id="4388632">(</span><span class="ident" id="4388633">m</span>&nbsp;<span class="op" id="4388635">[</span><span class="op" id="4388636">]</span><span class="op" id="4388637">*</span><span class="ident" id="4388638">Value</span><span class="op" id="4388643">,</span>&nbsp;<span class="ident" id="4388645">tok</span>&nbsp;<span class="ident" id="4388649">token</span><span class="op" id="4388654">.</span><span class="ident" id="4388655">Token</span><span class="op" id="4388660">)</span>&nbsp;<span class="op" id="4388662">[</span><span class="op" id="4388663">]</span><span class="op" id="4388664">*</span><span class="ident" id="4388665">Value</span>&nbsp;<span class="op" id="4388671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388674">list</span>&nbsp;<span class="op" id="4388679">:=</span>&nbsp;<span class="builtinfunc" id="4388682">make</span><span class="op" id="4388686">(</span><span class="op" id="4388687">[</span><span class="op" id="4388688">]</span><span class="op" id="4388689">*</span><span class="ident" id="4388690">Value</span><span class="op" id="4388695">,</span>&nbsp;<span class="builtinfunc" id="4388697">len</span><span class="op" id="4388700">(</span><span class="ident" id="4388701">m</span><span class="op" id="4388702">)</span><span class="op" id="4388703">)</span>&nbsp;<span class="comment" id="4388705">//&nbsp;big&nbsp;enough&nbsp;in&nbsp;any&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388732">i</span>&nbsp;<span class="op" id="4388734">:=</span>&nbsp;<span class="num" id="4388737">0</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388740">for</span>&nbsp;<span class="ident" id="4388744">_</span><span class="op" id="4388745">,</span>&nbsp;<span class="ident" id="4388747">val</span>&nbsp;<span class="op" id="4388751">:=</span>&nbsp;<span class="keyword" id="4388754">range</span>&nbsp;<span class="ident" id="4388760">m</span>&nbsp;<span class="op" id="4388762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388766">if</span>&nbsp;<span class="ident" id="4388769">val</span><span class="op" id="4388772">.</span><span class="ident" id="4388773">Decl</span><span class="op" id="4388777">.</span><span class="ident" id="4388778">Tok</span>&nbsp;<span class="op" id="4388782">==</span>&nbsp;<span class="ident" id="4388785">tok</span>&nbsp;<span class="op" id="4388789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388794">list</span><span class="op" id="4388798">[</span><span class="ident" id="4388799">i</span><span class="op" id="4388800">]</span>&nbsp;<span class="op" id="4388802">=</span>&nbsp;<span class="ident" id="4388804">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388811">i</span><span class="op" id="4388812">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388817">}</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388823">list</span>&nbsp;<span class="op" id="4388828">=</span>&nbsp;<span class="ident" id="4388830">list</span><span class="op" id="4388834">[</span><span class="num" id="4388835">0</span><span class="op" id="4388836">:</span><span class="ident" id="4388837">i</span><span class="op" id="4388838">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4388842">sortBy</span><span class="op" id="4388848">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388852">func</span><span class="op" id="4388856">(</span><span class="ident" id="4388857">i</span><span class="op" id="4388858">,</span>&nbsp;<span class="ident" id="4388860">j</span>&nbsp;<span class="builtintype" id="4388862">int</span><span class="op" id="4388865">)</span>&nbsp;<span class="builtintype" id="4388867">bool</span>&nbsp;<span class="op" id="4388872">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388877">if</span>&nbsp;<span class="ident" id="4388880">ni</span><span class="op" id="4388882">,</span>&nbsp;<span class="ident" id="4388884">nj</span>&nbsp;<span class="op" id="4388887">:=</span>&nbsp;<span class="ident" id="4388890">sortingName</span><span class="op" id="4388901">(</span><span class="ident" id="4388902">list</span><span class="op" id="4388906">[</span><span class="ident" id="4388907">i</span><span class="op" id="4388908">]</span><span class="op" id="4388909">.</span><span class="ident" id="4388910">Decl</span><span class="op" id="4388914">)</span><span class="op" id="4388915">,</span>&nbsp;<span class="ident" id="4388917">sortingName</span><span class="op" id="4388928">(</span><span class="ident" id="4388929">list</span><span class="op" id="4388933">[</span><span class="ident" id="4388934">j</span><span class="op" id="4388935">]</span><span class="op" id="4388936">.</span><span class="ident" id="4388937">Decl</span><span class="op" id="4388941">)</span><span class="op" id="4388942">;</span>&nbsp;<span class="ident" id="4388944">ni</span>&nbsp;<span class="op" id="4388947">!=</span>&nbsp;<span class="ident" id="4388950">nj</span>&nbsp;<span class="op" id="4388953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388959">return</span>&nbsp;<span class="ident" id="4388966">ni</span>&nbsp;<span class="op" id="4388969">&lt;</span>&nbsp;<span class="ident" id="4388971">nj</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4388977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4388982">return</span>&nbsp;<span class="ident" id="4388989">list</span><span class="op" id="4388993">[</span><span class="ident" id="4388994">i</span><span class="op" id="4388995">]</span><span class="op" id="4388996">.</span><span class="ident" id="4388997">order</span>&nbsp;<span class="op" id="4389003">&lt;</span>&nbsp;<span class="ident" id="4389005">list</span><span class="op" id="4389009">[</span><span class="ident" id="4389010">j</span><span class="op" id="4389011">]</span><span class="op" id="4389012">.</span><span class="ident" id="4389013">order</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389021">}</span><span class="op" id="4389022">,</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389026">func</span><span class="op" id="4389030">(</span><span class="ident" id="4389031">i</span><span class="op" id="4389032">,</span>&nbsp;<span class="ident" id="4389034">j</span>&nbsp;<span class="builtintype" id="4389036">int</span><span class="op" id="4389039">)</span>&nbsp;<span class="op" id="4389041">{</span>&nbsp;<span class="ident" id="4389043">list</span><span class="op" id="4389047">[</span><span class="ident" id="4389048">i</span><span class="op" id="4389049">]</span><span class="op" id="4389050">,</span>&nbsp;<span class="ident" id="4389052">list</span><span class="op" id="4389056">[</span><span class="ident" id="4389057">j</span><span class="op" id="4389058">]</span>&nbsp;<span class="op" id="4389060">=</span>&nbsp;<span class="ident" id="4389062">list</span><span class="op" id="4389066">[</span><span class="ident" id="4389067">j</span><span class="op" id="4389068">]</span><span class="op" id="4389069">,</span>&nbsp;<span class="ident" id="4389071">list</span><span class="op" id="4389075">[</span><span class="ident" id="4389076">i</span><span class="op" id="4389077">]</span>&nbsp;<span class="op" id="4389079">}</span><span class="op" id="4389080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4389084">len</span><span class="op" id="4389087">(</span><span class="ident" id="4389088">list</span><span class="op" id="4389092">)</span><span class="op" id="4389093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389096">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389100">return</span>&nbsp;<span class="ident" id="4389107">list</span><br>
<span class="lineno">735</span><span class="op" id="4389112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389115">func</span>&nbsp;<span class="ident" id="4389120">sortedTypes</span><span class="op" id="4389131">(</span><span class="ident" id="4389132">m</span>&nbsp;<span class="keyword" id="4389134">map</span><span class="op" id="4389137">[</span><span class="builtintype" id="4389138">string</span><span class="op" id="4389144">]</span><span class="op" id="4389145">*</span><span class="ident" id="4389146">namedType</span><span class="op" id="4389155">,</span>&nbsp;<span class="ident" id="4389157">allMethods</span>&nbsp;<span class="builtintype" id="4389168">bool</span><span class="op" id="4389172">)</span>&nbsp;<span class="op" id="4389174">[</span><span class="op" id="4389175">]</span><span class="op" id="4389176">*</span><span class="ident" id="4389177">Type</span>&nbsp;<span class="op" id="4389182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389185">list</span>&nbsp;<span class="op" id="4389190">:=</span>&nbsp;<span class="builtinfunc" id="4389193">make</span><span class="op" id="4389197">(</span><span class="op" id="4389198">[</span><span class="op" id="4389199">]</span><span class="op" id="4389200">*</span><span class="ident" id="4389201">Type</span><span class="op" id="4389205">,</span>&nbsp;<span class="builtinfunc" id="4389207">len</span><span class="op" id="4389210">(</span><span class="ident" id="4389211">m</span><span class="op" id="4389212">)</span><span class="op" id="4389213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389216">i</span>&nbsp;<span class="op" id="4389218">:=</span>&nbsp;<span class="num" id="4389221">0</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389224">for</span>&nbsp;<span class="ident" id="4389228">_</span><span class="op" id="4389229">,</span>&nbsp;<span class="ident" id="4389231">t</span>&nbsp;<span class="op" id="4389233">:=</span>&nbsp;<span class="keyword" id="4389236">range</span>&nbsp;<span class="ident" id="4389242">m</span>&nbsp;<span class="op" id="4389244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389248">list</span><span class="op" id="4389252">[</span><span class="ident" id="4389253">i</span><span class="op" id="4389254">]</span>&nbsp;<span class="op" id="4389256">=</span>&nbsp;<span class="op" id="4389258">&amp;</span><span class="ident" id="4389259">Type</span><span class="op" id="4389263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389268">Doc</span><span class="op" id="4389271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389277">t</span><span class="op" id="4389278">.</span><span class="ident" id="4389279">doc</span><span class="op" id="4389282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389287">Name</span><span class="op" id="4389291">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389296">t</span><span class="op" id="4389297">.</span><span class="ident" id="4389298">name</span><span class="op" id="4389302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389307">Decl</span><span class="op" id="4389311">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389316">t</span><span class="op" id="4389317">.</span><span class="ident" id="4389318">decl</span><span class="op" id="4389322">,</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389327">Consts</span><span class="op" id="4389333">:</span>&nbsp;&nbsp;<span class="ident" id="4389336">sortedValues</span><span class="op" id="4389348">(</span><span class="ident" id="4389349">t</span><span class="op" id="4389350">.</span><span class="ident" id="4389351">values</span><span class="op" id="4389357">,</span>&nbsp;<span class="ident" id="4389359">token</span><span class="op" id="4389364">.</span><span class="ident" id="4389365">CONST</span><span class="op" id="4389370">)</span><span class="op" id="4389371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389376">Vars</span><span class="op" id="4389380">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4389385">sortedValues</span><span class="op" id="4389397">(</span><span class="ident" id="4389398">t</span><span class="op" id="4389399">.</span><span class="ident" id="4389400">values</span><span class="op" id="4389406">,</span>&nbsp;<span class="ident" id="4389408">token</span><span class="op" id="4389413">.</span><span class="ident" id="4389414">VAR</span><span class="op" id="4389417">)</span><span class="op" id="4389418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389423">Funcs</span><span class="op" id="4389428">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4389432">sortedFuncs</span><span class="op" id="4389443">(</span><span class="ident" id="4389444">t</span><span class="op" id="4389445">.</span><span class="ident" id="4389446">funcs</span><span class="op" id="4389451">,</span>&nbsp;<span class="builtintype" id="4389453">true</span><span class="op" id="4389457">)</span><span class="op" id="4389458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389463">Methods</span><span class="op" id="4389470">:</span>&nbsp;<span class="ident" id="4389472">sortedFuncs</span><span class="op" id="4389483">(</span><span class="ident" id="4389484">t</span><span class="op" id="4389485">.</span><span class="ident" id="4389486">methods</span><span class="op" id="4389493">,</span>&nbsp;<span class="ident" id="4389495">allMethods</span><span class="op" id="4389505">)</span><span class="op" id="4389506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389510">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389514">i</span><span class="op" id="4389515">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389523">sortBy</span><span class="op" id="4389529">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389533">func</span><span class="op" id="4389537">(</span><span class="ident" id="4389538">i</span><span class="op" id="4389539">,</span>&nbsp;<span class="ident" id="4389541">j</span>&nbsp;<span class="builtintype" id="4389543">int</span><span class="op" id="4389546">)</span>&nbsp;<span class="builtintype" id="4389548">bool</span>&nbsp;<span class="op" id="4389553">{</span>&nbsp;<span class="keyword" id="4389555">return</span>&nbsp;<span class="ident" id="4389562">list</span><span class="op" id="4389566">[</span><span class="ident" id="4389567">i</span><span class="op" id="4389568">]</span><span class="op" id="4389569">.</span><span class="ident" id="4389570">Name</span>&nbsp;<span class="op" id="4389575">&lt;</span>&nbsp;<span class="ident" id="4389577">list</span><span class="op" id="4389581">[</span><span class="ident" id="4389582">j</span><span class="op" id="4389583">]</span><span class="op" id="4389584">.</span><span class="ident" id="4389585">Name</span>&nbsp;<span class="op" id="4389590">}</span><span class="op" id="4389591">,</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389595">func</span><span class="op" id="4389599">(</span><span class="ident" id="4389600">i</span><span class="op" id="4389601">,</span>&nbsp;<span class="ident" id="4389603">j</span>&nbsp;<span class="builtintype" id="4389605">int</span><span class="op" id="4389608">)</span>&nbsp;<span class="op" id="4389610">{</span>&nbsp;<span class="ident" id="4389612">list</span><span class="op" id="4389616">[</span><span class="ident" id="4389617">i</span><span class="op" id="4389618">]</span><span class="op" id="4389619">,</span>&nbsp;<span class="ident" id="4389621">list</span><span class="op" id="4389625">[</span><span class="ident" id="4389626">j</span><span class="op" id="4389627">]</span>&nbsp;<span class="op" id="4389629">=</span>&nbsp;<span class="ident" id="4389631">list</span><span class="op" id="4389635">[</span><span class="ident" id="4389636">j</span><span class="op" id="4389637">]</span><span class="op" id="4389638">,</span>&nbsp;<span class="ident" id="4389640">list</span><span class="op" id="4389644">[</span><span class="ident" id="4389645">i</span><span class="op" id="4389646">]</span>&nbsp;<span class="op" id="4389648">}</span><span class="op" id="4389649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4389653">len</span><span class="op" id="4389656">(</span><span class="ident" id="4389657">list</span><span class="op" id="4389661">)</span><span class="op" id="4389662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389665">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389669">return</span>&nbsp;<span class="ident" id="4389676">list</span><br>
<span class="lineno">760</span><span class="op" id="4389681">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389684">func</span>&nbsp;<span class="ident" id="4389689">removeStar</span><span class="op" id="4389699">(</span><span class="ident" id="4389700">s</span>&nbsp;<span class="builtintype" id="4389702">string</span><span class="op" id="4389708">)</span>&nbsp;<span class="builtintype" id="4389710">string</span>&nbsp;<span class="op" id="4389717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389720">if</span>&nbsp;<span class="builtinfunc" id="4389723">len</span><span class="op" id="4389726">(</span><span class="ident" id="4389727">s</span><span class="op" id="4389728">)</span>&nbsp;<span class="op" id="4389730">&gt;</span>&nbsp;<span class="num" id="4389732">0</span>&nbsp;<span class="op" id="4389734">&amp;&amp;</span>&nbsp;<span class="ident" id="4389737">s</span><span class="op" id="4389738">[</span><span class="num" id="4389739">0</span><span class="op" id="4389740">]</span>&nbsp;<span class="op" id="4389742">==</span>&nbsp;<span class="string" id="4389745">&#39;*&#39;</span>&nbsp;<span class="op" id="4389749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389753">return</span>&nbsp;<span class="ident" id="4389760">s</span><span class="op" id="4389761">[</span><span class="num" id="4389762">1</span><span class="op" id="4389763">:</span><span class="op" id="4389764">]</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4389767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389770">return</span>&nbsp;<span class="ident" id="4389777">s</span><br>
<span class="lineno"></span><span class="op" id="4389779">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4389782">func</span>&nbsp;<span class="ident" id="4389787">sortedFuncs</span><span class="op" id="4389798">(</span><span class="ident" id="4389799">m</span>&nbsp;<span class="ident" id="4389801">methodSet</span><span class="op" id="4389810">,</span>&nbsp;<span class="ident" id="4389812">allMethods</span>&nbsp;<span class="builtintype" id="4389823">bool</span><span class="op" id="4389827">)</span>&nbsp;<span class="op" id="4389829">[</span><span class="op" id="4389830">]</span><span class="op" id="4389831">*</span><span class="ident" id="4389832">Func</span>&nbsp;<span class="op" id="4389837">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389840">list</span>&nbsp;<span class="op" id="4389845">:=</span>&nbsp;<span class="builtinfunc" id="4389848">make</span><span class="op" id="4389852">(</span><span class="op" id="4389853">[</span><span class="op" id="4389854">]</span><span class="op" id="4389855">*</span><span class="ident" id="4389856">Func</span><span class="op" id="4389860">,</span>&nbsp;<span class="builtinfunc" id="4389862">len</span><span class="op" id="4389865">(</span><span class="ident" id="4389866">m</span><span class="op" id="4389867">)</span><span class="op" id="4389868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4389871">i</span>&nbsp;<span class="op" id="4389873">:=</span>&nbsp;<span class="num" id="4389876">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389879">for</span>&nbsp;<span class="ident" id="4389883">_</span><span class="op" id="4389884">,</span>&nbsp;<span class="ident" id="4389886">m</span>&nbsp;<span class="op" id="4389888">:=</span>&nbsp;<span class="keyword" id="4389891">range</span>&nbsp;<span class="ident" id="4389897">m</span>&nbsp;<span class="op" id="4389899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389903">//&nbsp;determine&nbsp;which&nbsp;methods&nbsp;to&nbsp;include</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389943">switch</span>&nbsp;<span class="op" id="4389950">{</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4389954">case</span>&nbsp;<span class="ident" id="4389959">m</span><span class="op" id="4389960">.</span><span class="ident" id="4389961">Decl</span>&nbsp;<span class="op" id="4389966">==</span>&nbsp;<span class="ident" id="4389969">nil</span><span class="op" id="4389972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4389977">//&nbsp;exclude&nbsp;conflict&nbsp;entry</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390005">case</span>&nbsp;<span class="ident" id="4390010">allMethods</span><span class="op" id="4390020">,</span>&nbsp;<span class="ident" id="4390022">m</span><span class="op" id="4390023">.</span><span class="ident" id="4390024">Level</span>&nbsp;<span class="op" id="4390030">==</span>&nbsp;<span class="num" id="4390033">0</span><span class="op" id="4390034">,</span>&nbsp;<span class="op" id="4390036">!</span><span class="ident" id="4390037">ast</span><span class="op" id="4390040">.</span><span class="ident" id="4390041">IsExported</span><span class="op" id="4390051">(</span><span class="ident" id="4390052">removeStar</span><span class="op" id="4390062">(</span><span class="ident" id="4390063">m</span><span class="op" id="4390064">.</span><span class="ident" id="4390065">Orig</span><span class="op" id="4390069">)</span><span class="op" id="4390070">)</span><span class="op" id="4390071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4390076">//&nbsp;forced&nbsp;inclusion,&nbsp;method&nbsp;not&nbsp;embedded,&nbsp;or&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4390131">//&nbsp;embedded&nbsp;but&nbsp;original&nbsp;receiver&nbsp;type&nbsp;not&nbsp;exported</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390186">list</span><span class="op" id="4390190">[</span><span class="ident" id="4390191">i</span><span class="op" id="4390192">]</span>&nbsp;<span class="op" id="4390194">=</span>&nbsp;<span class="ident" id="4390196">m</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390201">i</span><span class="op" id="4390202">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390213">list</span>&nbsp;<span class="op" id="4390218">=</span>&nbsp;<span class="ident" id="4390220">list</span><span class="op" id="4390224">[</span><span class="num" id="4390225">0</span><span class="op" id="4390226">:</span><span class="ident" id="4390227">i</span><span class="op" id="4390228">]</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390231">sortBy</span><span class="op" id="4390237">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390241">func</span><span class="op" id="4390245">(</span><span class="ident" id="4390246">i</span><span class="op" id="4390247">,</span>&nbsp;<span class="ident" id="4390249">j</span>&nbsp;<span class="builtintype" id="4390251">int</span><span class="op" id="4390254">)</span>&nbsp;<span class="builtintype" id="4390256">bool</span>&nbsp;<span class="op" id="4390261">{</span>&nbsp;<span class="keyword" id="4390263">return</span>&nbsp;<span class="ident" id="4390270">list</span><span class="op" id="4390274">[</span><span class="ident" id="4390275">i</span><span class="op" id="4390276">]</span><span class="op" id="4390277">.</span><span class="ident" id="4390278">Name</span>&nbsp;<span class="op" id="4390283">&lt;</span>&nbsp;<span class="ident" id="4390285">list</span><span class="op" id="4390289">[</span><span class="ident" id="4390290">j</span><span class="op" id="4390291">]</span><span class="op" id="4390292">.</span><span class="ident" id="4390293">Name</span>&nbsp;<span class="op" id="4390298">}</span><span class="op" id="4390299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390303">func</span><span class="op" id="4390307">(</span><span class="ident" id="4390308">i</span><span class="op" id="4390309">,</span>&nbsp;<span class="ident" id="4390311">j</span>&nbsp;<span class="builtintype" id="4390313">int</span><span class="op" id="4390316">)</span>&nbsp;<span class="op" id="4390318">{</span>&nbsp;<span class="ident" id="4390320">list</span><span class="op" id="4390324">[</span><span class="ident" id="4390325">i</span><span class="op" id="4390326">]</span><span class="op" id="4390327">,</span>&nbsp;<span class="ident" id="4390329">list</span><span class="op" id="4390333">[</span><span class="ident" id="4390334">j</span><span class="op" id="4390335">]</span>&nbsp;<span class="op" id="4390337">=</span>&nbsp;<span class="ident" id="4390339">list</span><span class="op" id="4390343">[</span><span class="ident" id="4390344">j</span><span class="op" id="4390345">]</span><span class="op" id="4390346">,</span>&nbsp;<span class="ident" id="4390348">list</span><span class="op" id="4390352">[</span><span class="ident" id="4390353">i</span><span class="op" id="4390354">]</span>&nbsp;<span class="op" id="4390356">}</span><span class="op" id="4390357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4390361">len</span><span class="op" id="4390364">(</span><span class="ident" id="4390365">list</span><span class="op" id="4390369">)</span><span class="op" id="4390370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390373">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390376">return</span>&nbsp;<span class="ident" id="4390383">list</span><br>
<span class="lineno"></span><span class="op" id="4390388">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4390391">//&nbsp;noteBodies&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;note&nbsp;body&nbsp;strings&nbsp;given&nbsp;a&nbsp;list&nbsp;of&nbsp;notes.</span><br>
<span class="lineno"></span><span class="comment" id="4390464">//&nbsp;This&nbsp;is&nbsp;only&nbsp;used&nbsp;to&nbsp;populate&nbsp;the&nbsp;deprecated&nbsp;Package.Bugs&nbsp;field.</span><br>
<span class="lineno">795</span><span class="comment" id="4390532">//</span><br>
<span class="lineno"></span><span class="keyword" id="4390535">func</span>&nbsp;<span class="ident" id="4390540">noteBodies</span><span class="op" id="4390550">(</span><span class="ident" id="4390551">notes</span>&nbsp;<span class="op" id="4390557">[</span><span class="op" id="4390558">]</span><span class="op" id="4390559">*</span><span class="ident" id="4390560">Note</span><span class="op" id="4390564">)</span>&nbsp;<span class="op" id="4390566">[</span><span class="op" id="4390567">]</span><span class="builtintype" id="4390568">string</span>&nbsp;<span class="op" id="4390575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390578">var</span>&nbsp;<span class="ident" id="4390582">list</span>&nbsp;<span class="op" id="4390587">[</span><span class="op" id="4390588">]</span><span class="builtintype" id="4390589">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390597">for</span>&nbsp;<span class="ident" id="4390601">_</span><span class="op" id="4390602">,</span>&nbsp;<span class="ident" id="4390604">n</span>&nbsp;<span class="op" id="4390606">:=</span>&nbsp;<span class="keyword" id="4390609">range</span>&nbsp;<span class="ident" id="4390615">notes</span>&nbsp;<span class="op" id="4390621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4390625">list</span>&nbsp;<span class="op" id="4390630">=</span>&nbsp;<span class="builtinfunc" id="4390632">append</span><span class="op" id="4390638">(</span><span class="ident" id="4390639">list</span><span class="op" id="4390643">,</span>&nbsp;<span class="ident" id="4390645">n</span><span class="op" id="4390646">.</span><span class="ident" id="4390647">Body</span><span class="op" id="4390651">)</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4390654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4390657">return</span>&nbsp;<span class="ident" id="4390664">list</span><br>
<span class="lineno"></span><span class="op" id="4390669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4390672">//&nbsp;----------------------------------------------------------------------------</span><br>
<span class="lineno">805</span><span class="comment" id="4390752">//&nbsp;Predeclared&nbsp;identifiers</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4390780">var</span>&nbsp;<span class="ident" id="4390784">predeclaredTypes</span>&nbsp;<span class="op" id="4390801">=</span>&nbsp;<span class="keyword" id="4390803">map</span><span class="op" id="4390806">[</span><span class="builtintype" id="4390807">string</span><span class="op" id="4390813">]</span><span class="builtintype" id="4390814">bool</span><span class="op" id="4390818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390821">&#34;bool&#34;</span><span class="op" id="4390827">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390835">true</span><span class="op" id="4390839">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390842">&#34;byte&#34;</span><span class="op" id="4390848">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390856">true</span><span class="op" id="4390860">,</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390863">&#34;complex64&#34;</span><span class="op" id="4390874">:</span>&nbsp;&nbsp;<span class="builtintype" id="4390877">true</span><span class="op" id="4390881">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390884">&#34;complex128&#34;</span><span class="op" id="4390896">:</span>&nbsp;<span class="builtintype" id="4390898">true</span><span class="op" id="4390902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390905">&#34;error&#34;</span><span class="op" id="4390912">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390919">true</span><span class="op" id="4390923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390926">&#34;float32&#34;</span><span class="op" id="4390935">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390940">true</span><span class="op" id="4390944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390947">&#34;float64&#34;</span><span class="op" id="4390956">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390961">true</span><span class="op" id="4390965">,</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390968">&#34;int&#34;</span><span class="op" id="4390973">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4390982">true</span><span class="op" id="4390986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4390989">&#34;int8&#34;</span><span class="op" id="4390995">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391003">true</span><span class="op" id="4391007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391010">&#34;int16&#34;</span><span class="op" id="4391017">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391024">true</span><span class="op" id="4391028">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391031">&#34;int32&#34;</span><span class="op" id="4391038">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391045">true</span><span class="op" id="4391049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391052">&#34;int64&#34;</span><span class="op" id="4391059">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391066">true</span><span class="op" id="4391070">,</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391073">&#34;rune&#34;</span><span class="op" id="4391079">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391087">true</span><span class="op" id="4391091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391094">&#34;string&#34;</span><span class="op" id="4391102">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391108">true</span><span class="op" id="4391112">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391115">&#34;uint&#34;</span><span class="op" id="4391121">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391129">true</span><span class="op" id="4391133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391136">&#34;uint8&#34;</span><span class="op" id="4391143">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391150">true</span><span class="op" id="4391154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391157">&#34;uint16&#34;</span><span class="op" id="4391165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391171">true</span><span class="op" id="4391175">,</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391178">&#34;uint32&#34;</span><span class="op" id="4391186">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391192">true</span><span class="op" id="4391196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391199">&#34;uint64&#34;</span><span class="op" id="4391207">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391213">true</span><span class="op" id="4391217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391220">&#34;uintptr&#34;</span><span class="op" id="4391229">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391234">true</span><span class="op" id="4391238">,</span><br>
<span class="lineno"></span><span class="op" id="4391240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span><span class="keyword" id="4391243">var</span>&nbsp;<span class="ident" id="4391247">predeclaredFuncs</span>&nbsp;<span class="op" id="4391264">=</span>&nbsp;<span class="keyword" id="4391266">map</span><span class="op" id="4391269">[</span><span class="builtintype" id="4391270">string</span><span class="op" id="4391276">]</span><span class="builtintype" id="4391277">bool</span><span class="op" id="4391281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391284">&#34;append&#34;</span><span class="op" id="4391292">:</span>&nbsp;&nbsp;<span class="builtintype" id="4391295">true</span><span class="op" id="4391299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391302">&#34;cap&#34;</span><span class="op" id="4391307">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391313">true</span><span class="op" id="4391317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391320">&#34;close&#34;</span><span class="op" id="4391327">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391331">true</span><span class="op" id="4391335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391338">&#34;complex&#34;</span><span class="op" id="4391347">:</span>&nbsp;<span class="builtintype" id="4391349">true</span><span class="op" id="4391353">,</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391356">&#34;copy&#34;</span><span class="op" id="4391362">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391367">true</span><span class="op" id="4391371">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391374">&#34;delete&#34;</span><span class="op" id="4391382">:</span>&nbsp;&nbsp;<span class="builtintype" id="4391385">true</span><span class="op" id="4391389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391392">&#34;imag&#34;</span><span class="op" id="4391398">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391403">true</span><span class="op" id="4391407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391410">&#34;len&#34;</span><span class="op" id="4391415">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391421">true</span><span class="op" id="4391425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391428">&#34;make&#34;</span><span class="op" id="4391434">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391439">true</span><span class="op" id="4391443">,</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391446">&#34;new&#34;</span><span class="op" id="4391451">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391457">true</span><span class="op" id="4391461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391464">&#34;panic&#34;</span><span class="op" id="4391471">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391475">true</span><span class="op" id="4391479">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391482">&#34;print&#34;</span><span class="op" id="4391489">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391493">true</span><span class="op" id="4391497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391500">&#34;println&#34;</span><span class="op" id="4391509">:</span>&nbsp;<span class="builtintype" id="4391511">true</span><span class="op" id="4391515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391518">&#34;real&#34;</span><span class="op" id="4391524">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391529">true</span><span class="op" id="4391533">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391536">&#34;recover&#34;</span><span class="op" id="4391545">:</span>&nbsp;<span class="builtintype" id="4391547">true</span><span class="op" id="4391551">,</span><br>
<span class="lineno"></span><span class="op" id="4391553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4391556">var</span>&nbsp;<span class="ident" id="4391560">predeclaredConstants</span>&nbsp;<span class="op" id="4391581">=</span>&nbsp;<span class="keyword" id="4391583">map</span><span class="op" id="4391586">[</span><span class="builtintype" id="4391587">string</span><span class="op" id="4391593">]</span><span class="builtintype" id="4391594">bool</span><span class="op" id="4391598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391601">&#34;false&#34;</span><span class="op" id="4391608">:</span>&nbsp;<span class="builtintype" id="4391610">true</span><span class="op" id="4391614">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391617">&#34;iota&#34;</span><span class="op" id="4391623">:</span>&nbsp;&nbsp;<span class="builtintype" id="4391626">true</span><span class="op" id="4391630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391633">&#34;nil&#34;</span><span class="op" id="4391638">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4391642">true</span><span class="op" id="4391646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4391649">&#34;true&#34;</span><span class="op" id="4391655">:</span>&nbsp;&nbsp;<span class="builtintype" id="4391658">true</span><span class="op" id="4391662">,</span><br>
<span class="lineno"></span><span class="op" id="4391664">}</span>
</div>
</body>
</html>
