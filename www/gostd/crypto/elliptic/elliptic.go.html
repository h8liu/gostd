<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4138905">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4138960">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4139014">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4139065">//&nbsp;Package&nbsp;elliptic&nbsp;implements&nbsp;several&nbsp;standard&nbsp;elliptic&nbsp;curves&nbsp;over&nbsp;prime</span><br>
<span class="lineno"></span><span class="comment" id="4139140">//&nbsp;fields.</span><br>
<span class="lineno"></span><span class="keyword" id="4139151">package</span>&nbsp;<span class="ident" id="4139159">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139169">//&nbsp;This&nbsp;package&nbsp;operates,&nbsp;internally,&nbsp;on&nbsp;Jacobian&nbsp;coordinates.&nbsp;For&nbsp;a&nbsp;given</span><br>
<span class="lineno">10</span><span class="comment" id="4139244">//&nbsp;(x,&nbsp;y)&nbsp;position&nbsp;on&nbsp;the&nbsp;curve,&nbsp;the&nbsp;Jacobian&nbsp;coordinates&nbsp;are&nbsp;(x1,&nbsp;y1,&nbsp;z1)</span><br>
<span class="lineno"></span><span class="comment" id="4139319">//&nbsp;where&nbsp;x&nbsp;=&nbsp;x1/z1²&nbsp;and&nbsp;y&nbsp;=&nbsp;y1/z1³.&nbsp;The&nbsp;greatest&nbsp;speedups&nbsp;come&nbsp;when&nbsp;the&nbsp;whole</span><br>
<span class="lineno"></span><span class="comment" id="4139399">//&nbsp;calculation&nbsp;can&nbsp;be&nbsp;performed&nbsp;within&nbsp;the&nbsp;transform&nbsp;(as&nbsp;in&nbsp;ScalarMult&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4139474">//&nbsp;ScalarBaseMult).&nbsp;But&nbsp;even&nbsp;for&nbsp;Add&nbsp;and&nbsp;Double,&nbsp;it&#39;s&nbsp;faster&nbsp;to&nbsp;apply&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4139548">//&nbsp;reverse&nbsp;the&nbsp;transform&nbsp;than&nbsp;to&nbsp;operate&nbsp;in&nbsp;affine&nbsp;coordinates.</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4139613">import</span>&nbsp;<span class="op" id="4139620">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4139623">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4139629">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4139641">&#34;sync&#34;</span><br>
<span class="lineno">20</span><span class="op" id="4139648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4139651">//&nbsp;A&nbsp;Curve&nbsp;represents&nbsp;a&nbsp;short-form&nbsp;Weierstrass&nbsp;curve&nbsp;with&nbsp;a=-3.</span><br>
<span class="lineno"></span><span class="comment" id="4139715">//&nbsp;See&nbsp;http://www.hyperelliptic.org/EFD/g1p/auto-shortw.html</span><br>
<span class="lineno"></span><span class="keyword" id="4139776">type</span>&nbsp;<span class="ident" id="4139781">Curve</span>&nbsp;<span class="keyword" id="4139787">interface</span>&nbsp;<span class="op" id="4139797">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139800">//&nbsp;Params&nbsp;returns&nbsp;the&nbsp;parameters&nbsp;for&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139849">Params</span><span class="op" id="4139855">(</span><span class="op" id="4139856">)</span>&nbsp;<span class="op" id="4139858">*</span><span class="ident" id="4139859">CurveParams</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139872">//&nbsp;IsOnCurve&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;given&nbsp;(x,y)&nbsp;lies&nbsp;on&nbsp;the&nbsp;curve.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4139937">IsOnCurve</span><span class="op" id="4139946">(</span><span class="ident" id="4139947">x</span><span class="op" id="4139948">,</span>&nbsp;<span class="ident" id="4139950">y</span>&nbsp;<span class="op" id="4139952">*</span><span class="ident" id="4139953">big</span><span class="op" id="4139956">.</span><span class="ident" id="4139957">Int</span><span class="op" id="4139960">)</span>&nbsp;<span class="builtintype" id="4139962">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4139968">//&nbsp;Add&nbsp;returns&nbsp;the&nbsp;sum&nbsp;of&nbsp;(x1,y1)&nbsp;and&nbsp;(x2,y2)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140015">Add</span><span class="op" id="4140018">(</span><span class="ident" id="4140019">x1</span><span class="op" id="4140021">,</span>&nbsp;<span class="ident" id="4140023">y1</span><span class="op" id="4140025">,</span>&nbsp;<span class="ident" id="4140027">x2</span><span class="op" id="4140029">,</span>&nbsp;<span class="ident" id="4140031">y2</span>&nbsp;<span class="op" id="4140034">*</span><span class="ident" id="4140035">big</span><span class="op" id="4140038">.</span><span class="ident" id="4140039">Int</span><span class="op" id="4140042">)</span>&nbsp;<span class="op" id="4140044">(</span><span class="ident" id="4140045">x</span><span class="op" id="4140046">,</span>&nbsp;<span class="ident" id="4140048">y</span>&nbsp;<span class="op" id="4140050">*</span><span class="ident" id="4140051">big</span><span class="op" id="4140054">.</span><span class="ident" id="4140055">Int</span><span class="op" id="4140058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140061">//&nbsp;Double&nbsp;returns&nbsp;2*(x,y)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140088">Double</span><span class="op" id="4140094">(</span><span class="ident" id="4140095">x1</span><span class="op" id="4140097">,</span>&nbsp;<span class="ident" id="4140099">y1</span>&nbsp;<span class="op" id="4140102">*</span><span class="ident" id="4140103">big</span><span class="op" id="4140106">.</span><span class="ident" id="4140107">Int</span><span class="op" id="4140110">)</span>&nbsp;<span class="op" id="4140112">(</span><span class="ident" id="4140113">x</span><span class="op" id="4140114">,</span>&nbsp;<span class="ident" id="4140116">y</span>&nbsp;<span class="op" id="4140118">*</span><span class="ident" id="4140119">big</span><span class="op" id="4140122">.</span><span class="ident" id="4140123">Int</span><span class="op" id="4140126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140129">//&nbsp;ScalarMult&nbsp;returns&nbsp;k*(Bx,By)&nbsp;where&nbsp;k&nbsp;is&nbsp;a&nbsp;number&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140202">ScalarMult</span><span class="op" id="4140212">(</span><span class="ident" id="4140213">x1</span><span class="op" id="4140215">,</span>&nbsp;<span class="ident" id="4140217">y1</span>&nbsp;<span class="op" id="4140220">*</span><span class="ident" id="4140221">big</span><span class="op" id="4140224">.</span><span class="ident" id="4140225">Int</span><span class="op" id="4140228">,</span>&nbsp;<span class="ident" id="4140230">k</span>&nbsp;<span class="op" id="4140232">[</span><span class="op" id="4140233">]</span><span class="builtintype" id="4140234">byte</span><span class="op" id="4140238">)</span>&nbsp;<span class="op" id="4140240">(</span><span class="ident" id="4140241">x</span><span class="op" id="4140242">,</span>&nbsp;<span class="ident" id="4140244">y</span>&nbsp;<span class="op" id="4140246">*</span><span class="ident" id="4140247">big</span><span class="op" id="4140250">.</span><span class="ident" id="4140251">Int</span><span class="op" id="4140254">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140257">//&nbsp;ScalarBaseMult&nbsp;returns&nbsp;k*G,&nbsp;where&nbsp;G&nbsp;is&nbsp;the&nbsp;base&nbsp;point&nbsp;of&nbsp;the&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140328">//&nbsp;and&nbsp;k&nbsp;is&nbsp;an&nbsp;integer&nbsp;in&nbsp;big-endian&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140372">ScalarBaseMult</span><span class="op" id="4140386">(</span><span class="ident" id="4140387">k</span>&nbsp;<span class="op" id="4140389">[</span><span class="op" id="4140390">]</span><span class="builtintype" id="4140391">byte</span><span class="op" id="4140395">)</span>&nbsp;<span class="op" id="4140397">(</span><span class="ident" id="4140398">x</span><span class="op" id="4140399">,</span>&nbsp;<span class="ident" id="4140401">y</span>&nbsp;<span class="op" id="4140403">*</span><span class="ident" id="4140404">big</span><span class="op" id="4140407">.</span><span class="ident" id="4140408">Int</span><span class="op" id="4140411">)</span><br>
<span class="lineno"></span><span class="op" id="4140413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4140416">//&nbsp;CurveParams&nbsp;contains&nbsp;the&nbsp;parameters&nbsp;of&nbsp;an&nbsp;elliptic&nbsp;curve&nbsp;and&nbsp;also&nbsp;provides</span><br>
<span class="lineno"></span><span class="comment" id="4140494">//&nbsp;a&nbsp;generic,&nbsp;non-constant&nbsp;time&nbsp;implementation&nbsp;of&nbsp;Curve.</span><br>
<span class="lineno"></span><span class="keyword" id="4140551">type</span>&nbsp;<span class="ident" id="4140556">CurveParams</span>&nbsp;<span class="keyword" id="4140568">struct</span>&nbsp;<span class="op" id="4140575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140578">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140586">*</span><span class="ident" id="4140587">big</span><span class="op" id="4140590">.</span><span class="ident" id="4140591">Int</span>&nbsp;<span class="comment" id="4140595">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140633">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140641">*</span><span class="ident" id="4140642">big</span><span class="op" id="4140645">.</span><span class="ident" id="4140646">Int</span>&nbsp;<span class="comment" id="4140650">//&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140682">B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4140690">*</span><span class="ident" id="4140691">big</span><span class="op" id="4140694">.</span><span class="ident" id="4140695">Int</span>&nbsp;<span class="comment" id="4140699">//&nbsp;the&nbsp;constant&nbsp;of&nbsp;the&nbsp;curve&nbsp;equation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140738">Gx</span><span class="op" id="4140740">,</span>&nbsp;<span class="ident" id="4140742">Gy</span>&nbsp;&nbsp;<span class="op" id="4140746">*</span><span class="ident" id="4140747">big</span><span class="op" id="4140750">.</span><span class="ident" id="4140751">Int</span>&nbsp;<span class="comment" id="4140755">//&nbsp;(x,y)&nbsp;of&nbsp;the&nbsp;base&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140783">BitSize</span>&nbsp;<span class="builtintype" id="4140791">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4140800">//&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;underlying&nbsp;field</span><br>
<span class="lineno"></span><span class="op" id="4140836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="4140839">func</span>&nbsp;<span class="op" id="4140844">(</span><span class="ident" id="4140845">curve</span>&nbsp;<span class="op" id="4140851">*</span><span class="ident" id="4140852">CurveParams</span><span class="op" id="4140863">)</span>&nbsp;<span class="ident" id="4140865">Params</span><span class="op" id="4140871">(</span><span class="op" id="4140872">)</span>&nbsp;<span class="op" id="4140874">*</span><span class="ident" id="4140875">CurveParams</span>&nbsp;<span class="op" id="4140887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4140890">return</span>&nbsp;<span class="ident" id="4140897">curve</span><br>
<span class="lineno"></span><span class="op" id="4140903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4140906">func</span>&nbsp;<span class="op" id="4140911">(</span><span class="ident" id="4140912">curve</span>&nbsp;<span class="op" id="4140918">*</span><span class="ident" id="4140919">CurveParams</span><span class="op" id="4140930">)</span>&nbsp;<span class="ident" id="4140932">IsOnCurve</span><span class="op" id="4140941">(</span><span class="ident" id="4140942">x</span><span class="op" id="4140943">,</span>&nbsp;<span class="ident" id="4140945">y</span>&nbsp;<span class="op" id="4140947">*</span><span class="ident" id="4140948">big</span><span class="op" id="4140951">.</span><span class="ident" id="4140952">Int</span><span class="op" id="4140955">)</span>&nbsp;<span class="builtintype" id="4140957">bool</span>&nbsp;<span class="op" id="4140962">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4140965">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4140988">y2</span>&nbsp;<span class="op" id="4140991">:=</span>&nbsp;<span class="builtinfunc" id="4140994">new</span><span class="op" id="4140997">(</span><span class="ident" id="4140998">big</span><span class="op" id="4141001">.</span><span class="ident" id="4141002">Int</span><span class="op" id="4141005">)</span><span class="op" id="4141006">.</span><span class="ident" id="4141007">Mul</span><span class="op" id="4141010">(</span><span class="ident" id="4141011">y</span><span class="op" id="4141012">,</span>&nbsp;<span class="ident" id="4141014">y</span><span class="op" id="4141015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141018">y2</span><span class="op" id="4141020">.</span><span class="ident" id="4141021">Mod</span><span class="op" id="4141024">(</span><span class="ident" id="4141025">y2</span><span class="op" id="4141027">,</span>&nbsp;<span class="ident" id="4141029">curve</span><span class="op" id="4141034">.</span><span class="ident" id="4141035">P</span><span class="op" id="4141036">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141040">x3</span>&nbsp;<span class="op" id="4141043">:=</span>&nbsp;<span class="builtinfunc" id="4141046">new</span><span class="op" id="4141049">(</span><span class="ident" id="4141050">big</span><span class="op" id="4141053">.</span><span class="ident" id="4141054">Int</span><span class="op" id="4141057">)</span><span class="op" id="4141058">.</span><span class="ident" id="4141059">Mul</span><span class="op" id="4141062">(</span><span class="ident" id="4141063">x</span><span class="op" id="4141064">,</span>&nbsp;<span class="ident" id="4141066">x</span><span class="op" id="4141067">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141070">x3</span><span class="op" id="4141072">.</span><span class="ident" id="4141073">Mul</span><span class="op" id="4141076">(</span><span class="ident" id="4141077">x3</span><span class="op" id="4141079">,</span>&nbsp;<span class="ident" id="4141081">x</span><span class="op" id="4141082">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141086">threeX</span>&nbsp;<span class="op" id="4141093">:=</span>&nbsp;<span class="builtinfunc" id="4141096">new</span><span class="op" id="4141099">(</span><span class="ident" id="4141100">big</span><span class="op" id="4141103">.</span><span class="ident" id="4141104">Int</span><span class="op" id="4141107">)</span><span class="op" id="4141108">.</span><span class="ident" id="4141109">Lsh</span><span class="op" id="4141112">(</span><span class="ident" id="4141113">x</span><span class="op" id="4141114">,</span>&nbsp;<span class="num" id="4141116">1</span><span class="op" id="4141117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141120">threeX</span><span class="op" id="4141126">.</span><span class="ident" id="4141127">Add</span><span class="op" id="4141130">(</span><span class="ident" id="4141131">threeX</span><span class="op" id="4141137">,</span>&nbsp;<span class="ident" id="4141139">x</span><span class="op" id="4141140">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141144">x3</span><span class="op" id="4141146">.</span><span class="ident" id="4141147">Sub</span><span class="op" id="4141150">(</span><span class="ident" id="4141151">x3</span><span class="op" id="4141153">,</span>&nbsp;<span class="ident" id="4141155">threeX</span><span class="op" id="4141161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141164">x3</span><span class="op" id="4141166">.</span><span class="ident" id="4141167">Add</span><span class="op" id="4141170">(</span><span class="ident" id="4141171">x3</span><span class="op" id="4141173">,</span>&nbsp;<span class="ident" id="4141175">curve</span><span class="op" id="4141180">.</span><span class="ident" id="4141181">B</span><span class="op" id="4141182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141185">x3</span><span class="op" id="4141187">.</span><span class="ident" id="4141188">Mod</span><span class="op" id="4141191">(</span><span class="ident" id="4141192">x3</span><span class="op" id="4141194">,</span>&nbsp;<span class="ident" id="4141196">curve</span><span class="op" id="4141201">.</span><span class="ident" id="4141202">P</span><span class="op" id="4141203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141207">return</span>&nbsp;<span class="ident" id="4141214">x3</span><span class="op" id="4141216">.</span><span class="ident" id="4141217">Cmp</span><span class="op" id="4141220">(</span><span class="ident" id="4141221">y2</span><span class="op" id="4141223">)</span>&nbsp;<span class="op" id="4141225">==</span>&nbsp;<span class="num" id="4141228">0</span><br>
<span class="lineno">70</span><span class="op" id="4141230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141233">//&nbsp;zForAffine&nbsp;returns&nbsp;a&nbsp;Jacobian&nbsp;Z&nbsp;value&nbsp;for&nbsp;the&nbsp;affine&nbsp;point&nbsp;(x,&nbsp;y).&nbsp;If&nbsp;x&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4141312">//&nbsp;y&nbsp;are&nbsp;zero,&nbsp;it&nbsp;assumes&nbsp;that&nbsp;they&nbsp;represent&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;because&nbsp;(0,</span><br>
<span class="lineno"></span><span class="comment" id="4141392">//&nbsp;0)&nbsp;is&nbsp;not&nbsp;on&nbsp;the&nbsp;any&nbsp;of&nbsp;the&nbsp;curves&nbsp;handled&nbsp;here.</span><br>
<span class="lineno">75</span><span class="keyword" id="4141444">func</span>&nbsp;<span class="ident" id="4141449">zForAffine</span><span class="op" id="4141459">(</span><span class="ident" id="4141460">x</span><span class="op" id="4141461">,</span>&nbsp;<span class="ident" id="4141463">y</span>&nbsp;<span class="op" id="4141465">*</span><span class="ident" id="4141466">big</span><span class="op" id="4141469">.</span><span class="ident" id="4141470">Int</span><span class="op" id="4141473">)</span>&nbsp;<span class="op" id="4141475">*</span><span class="ident" id="4141476">big</span><span class="op" id="4141479">.</span><span class="ident" id="4141480">Int</span>&nbsp;<span class="op" id="4141484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141487">z</span>&nbsp;<span class="op" id="4141489">:=</span>&nbsp;<span class="builtinfunc" id="4141492">new</span><span class="op" id="4141495">(</span><span class="ident" id="4141496">big</span><span class="op" id="4141499">.</span><span class="ident" id="4141500">Int</span><span class="op" id="4141503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141506">if</span>&nbsp;<span class="ident" id="4141509">x</span><span class="op" id="4141510">.</span><span class="ident" id="4141511">Sign</span><span class="op" id="4141515">(</span><span class="op" id="4141516">)</span>&nbsp;<span class="op" id="4141518">!=</span>&nbsp;<span class="num" id="4141521">0</span>&nbsp;<span class="op" id="4141523">||</span>&nbsp;<span class="ident" id="4141526">y</span><span class="op" id="4141527">.</span><span class="ident" id="4141528">Sign</span><span class="op" id="4141532">(</span><span class="op" id="4141533">)</span>&nbsp;<span class="op" id="4141535">!=</span>&nbsp;<span class="num" id="4141538">0</span>&nbsp;<span class="op" id="4141540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141544">z</span><span class="op" id="4141545">.</span><span class="ident" id="4141546">SetInt64</span><span class="op" id="4141554">(</span><span class="num" id="4141555">1</span><span class="op" id="4141556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141559">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141562">return</span>&nbsp;<span class="ident" id="4141569">z</span><br>
<span class="lineno"></span><span class="op" id="4141571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4141574">//&nbsp;affineFromJacobian&nbsp;reverses&nbsp;the&nbsp;Jacobian&nbsp;transform.&nbsp;See&nbsp;the&nbsp;comment&nbsp;at&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4141652">//&nbsp;top&nbsp;of&nbsp;the&nbsp;file.&nbsp;If&nbsp;the&nbsp;point&nbsp;is&nbsp;∞&nbsp;it&nbsp;returns&nbsp;0,&nbsp;0.</span><br>
<span class="lineno">85</span><span class="keyword" id="4141709">func</span>&nbsp;<span class="op" id="4141714">(</span><span class="ident" id="4141715">curve</span>&nbsp;<span class="op" id="4141721">*</span><span class="ident" id="4141722">CurveParams</span><span class="op" id="4141733">)</span>&nbsp;<span class="ident" id="4141735">affineFromJacobian</span><span class="op" id="4141753">(</span><span class="ident" id="4141754">x</span><span class="op" id="4141755">,</span>&nbsp;<span class="ident" id="4141757">y</span><span class="op" id="4141758">,</span>&nbsp;<span class="ident" id="4141760">z</span>&nbsp;<span class="op" id="4141762">*</span><span class="ident" id="4141763">big</span><span class="op" id="4141766">.</span><span class="ident" id="4141767">Int</span><span class="op" id="4141770">)</span>&nbsp;<span class="op" id="4141772">(</span><span class="ident" id="4141773">xOut</span><span class="op" id="4141777">,</span>&nbsp;<span class="ident" id="4141779">yOut</span>&nbsp;<span class="op" id="4141784">*</span><span class="ident" id="4141785">big</span><span class="op" id="4141788">.</span><span class="ident" id="4141789">Int</span><span class="op" id="4141792">)</span>&nbsp;<span class="op" id="4141794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141797">if</span>&nbsp;<span class="ident" id="4141800">z</span><span class="op" id="4141801">.</span><span class="ident" id="4141802">Sign</span><span class="op" id="4141806">(</span><span class="op" id="4141807">)</span>&nbsp;<span class="op" id="4141809">==</span>&nbsp;<span class="num" id="4141812">0</span>&nbsp;<span class="op" id="4141814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4141818">return</span>&nbsp;<span class="builtinfunc" id="4141825">new</span><span class="op" id="4141828">(</span><span class="ident" id="4141829">big</span><span class="op" id="4141832">.</span><span class="ident" id="4141833">Int</span><span class="op" id="4141836">)</span><span class="op" id="4141837">,</span>&nbsp;<span class="builtinfunc" id="4141839">new</span><span class="op" id="4141842">(</span><span class="ident" id="4141843">big</span><span class="op" id="4141846">.</span><span class="ident" id="4141847">Int</span><span class="op" id="4141850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4141853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141857">zinv</span>&nbsp;<span class="op" id="4141862">:=</span>&nbsp;<span class="builtinfunc" id="4141865">new</span><span class="op" id="4141868">(</span><span class="ident" id="4141869">big</span><span class="op" id="4141872">.</span><span class="ident" id="4141873">Int</span><span class="op" id="4141876">)</span><span class="op" id="4141877">.</span><span class="ident" id="4141878">ModInverse</span><span class="op" id="4141888">(</span><span class="ident" id="4141889">z</span><span class="op" id="4141890">,</span>&nbsp;<span class="ident" id="4141892">curve</span><span class="op" id="4141897">.</span><span class="ident" id="4141898">P</span><span class="op" id="4141899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141902">zinvsq</span>&nbsp;<span class="op" id="4141909">:=</span>&nbsp;<span class="builtinfunc" id="4141912">new</span><span class="op" id="4141915">(</span><span class="ident" id="4141916">big</span><span class="op" id="4141919">.</span><span class="ident" id="4141920">Int</span><span class="op" id="4141923">)</span><span class="op" id="4141924">.</span><span class="ident" id="4141925">Mul</span><span class="op" id="4141928">(</span><span class="ident" id="4141929">zinv</span><span class="op" id="4141933">,</span>&nbsp;<span class="ident" id="4141935">zinv</span><span class="op" id="4141939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141943">xOut</span>&nbsp;<span class="op" id="4141948">=</span>&nbsp;<span class="builtinfunc" id="4141950">new</span><span class="op" id="4141953">(</span><span class="ident" id="4141954">big</span><span class="op" id="4141957">.</span><span class="ident" id="4141958">Int</span><span class="op" id="4141961">)</span><span class="op" id="4141962">.</span><span class="ident" id="4141963">Mul</span><span class="op" id="4141966">(</span><span class="ident" id="4141967">x</span><span class="op" id="4141968">,</span>&nbsp;<span class="ident" id="4141970">zinvsq</span><span class="op" id="4141976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4141979">xOut</span><span class="op" id="4141983">.</span><span class="ident" id="4141984">Mod</span><span class="op" id="4141987">(</span><span class="ident" id="4141988">xOut</span><span class="op" id="4141992">,</span>&nbsp;<span class="ident" id="4141994">curve</span><span class="op" id="4141999">.</span><span class="ident" id="4142000">P</span><span class="op" id="4142001">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142004">zinvsq</span><span class="op" id="4142010">.</span><span class="ident" id="4142011">Mul</span><span class="op" id="4142014">(</span><span class="ident" id="4142015">zinvsq</span><span class="op" id="4142021">,</span>&nbsp;<span class="ident" id="4142023">zinv</span><span class="op" id="4142027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142030">yOut</span>&nbsp;<span class="op" id="4142035">=</span>&nbsp;<span class="builtinfunc" id="4142037">new</span><span class="op" id="4142040">(</span><span class="ident" id="4142041">big</span><span class="op" id="4142044">.</span><span class="ident" id="4142045">Int</span><span class="op" id="4142048">)</span><span class="op" id="4142049">.</span><span class="ident" id="4142050">Mul</span><span class="op" id="4142053">(</span><span class="ident" id="4142054">y</span><span class="op" id="4142055">,</span>&nbsp;<span class="ident" id="4142057">zinvsq</span><span class="op" id="4142063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142066">yOut</span><span class="op" id="4142070">.</span><span class="ident" id="4142071">Mod</span><span class="op" id="4142074">(</span><span class="ident" id="4142075">yOut</span><span class="op" id="4142079">,</span>&nbsp;<span class="ident" id="4142081">curve</span><span class="op" id="4142086">.</span><span class="ident" id="4142087">P</span><span class="op" id="4142088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142091">return</span><br>
<span class="lineno"></span><span class="op" id="4142098">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4142101">func</span>&nbsp;<span class="op" id="4142106">(</span><span class="ident" id="4142107">curve</span>&nbsp;<span class="op" id="4142113">*</span><span class="ident" id="4142114">CurveParams</span><span class="op" id="4142125">)</span>&nbsp;<span class="ident" id="4142127">Add</span><span class="op" id="4142130">(</span><span class="ident" id="4142131">x1</span><span class="op" id="4142133">,</span>&nbsp;<span class="ident" id="4142135">y1</span><span class="op" id="4142137">,</span>&nbsp;<span class="ident" id="4142139">x2</span><span class="op" id="4142141">,</span>&nbsp;<span class="ident" id="4142143">y2</span>&nbsp;<span class="op" id="4142146">*</span><span class="ident" id="4142147">big</span><span class="op" id="4142150">.</span><span class="ident" id="4142151">Int</span><span class="op" id="4142154">)</span>&nbsp;<span class="op" id="4142156">(</span><span class="op" id="4142157">*</span><span class="ident" id="4142158">big</span><span class="op" id="4142161">.</span><span class="ident" id="4142162">Int</span><span class="op" id="4142165">,</span>&nbsp;<span class="op" id="4142167">*</span><span class="ident" id="4142168">big</span><span class="op" id="4142171">.</span><span class="ident" id="4142172">Int</span><span class="op" id="4142175">)</span>&nbsp;<span class="op" id="4142177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142180">z1</span>&nbsp;<span class="op" id="4142183">:=</span>&nbsp;<span class="ident" id="4142186">zForAffine</span><span class="op" id="4142196">(</span><span class="ident" id="4142197">x1</span><span class="op" id="4142199">,</span>&nbsp;<span class="ident" id="4142201">y1</span><span class="op" id="4142203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142206">z2</span>&nbsp;<span class="op" id="4142209">:=</span>&nbsp;<span class="ident" id="4142212">zForAffine</span><span class="op" id="4142222">(</span><span class="ident" id="4142223">x2</span><span class="op" id="4142225">,</span>&nbsp;<span class="ident" id="4142227">y2</span><span class="op" id="4142229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142232">return</span>&nbsp;<span class="ident" id="4142239">curve</span><span class="op" id="4142244">.</span><span class="ident" id="4142245">affineFromJacobian</span><span class="op" id="4142263">(</span><span class="ident" id="4142264">curve</span><span class="op" id="4142269">.</span><span class="ident" id="4142270">addJacobian</span><span class="op" id="4142281">(</span><span class="ident" id="4142282">x1</span><span class="op" id="4142284">,</span>&nbsp;<span class="ident" id="4142286">y1</span><span class="op" id="4142288">,</span>&nbsp;<span class="ident" id="4142290">z1</span><span class="op" id="4142292">,</span>&nbsp;<span class="ident" id="4142294">x2</span><span class="op" id="4142296">,</span>&nbsp;<span class="ident" id="4142298">y2</span><span class="op" id="4142300">,</span>&nbsp;<span class="ident" id="4142302">z2</span><span class="op" id="4142304">)</span><span class="op" id="4142305">)</span><br>
<span class="lineno">105</span><span class="op" id="4142307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4142310">//&nbsp;addJacobian&nbsp;takes&nbsp;two&nbsp;points&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x1,&nbsp;y1,&nbsp;z1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4142384">//&nbsp;(x2,&nbsp;y2,&nbsp;z2)&nbsp;and&nbsp;returns&nbsp;their&nbsp;sum,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4142446">func</span>&nbsp;<span class="op" id="4142451">(</span><span class="ident" id="4142452">curve</span>&nbsp;<span class="op" id="4142458">*</span><span class="ident" id="4142459">CurveParams</span><span class="op" id="4142470">)</span>&nbsp;<span class="ident" id="4142472">addJacobian</span><span class="op" id="4142483">(</span><span class="ident" id="4142484">x1</span><span class="op" id="4142486">,</span>&nbsp;<span class="ident" id="4142488">y1</span><span class="op" id="4142490">,</span>&nbsp;<span class="ident" id="4142492">z1</span><span class="op" id="4142494">,</span>&nbsp;<span class="ident" id="4142496">x2</span><span class="op" id="4142498">,</span>&nbsp;<span class="ident" id="4142500">y2</span><span class="op" id="4142502">,</span>&nbsp;<span class="ident" id="4142504">z2</span>&nbsp;<span class="op" id="4142507">*</span><span class="ident" id="4142508">big</span><span class="op" id="4142511">.</span><span class="ident" id="4142512">Int</span><span class="op" id="4142515">)</span>&nbsp;<span class="op" id="4142517">(</span><span class="op" id="4142518">*</span><span class="ident" id="4142519">big</span><span class="op" id="4142522">.</span><span class="ident" id="4142523">Int</span><span class="op" id="4142526">,</span>&nbsp;<span class="op" id="4142528">*</span><span class="ident" id="4142529">big</span><span class="op" id="4142532">.</span><span class="ident" id="4142533">Int</span><span class="op" id="4142536">,</span>&nbsp;<span class="op" id="4142538">*</span><span class="ident" id="4142539">big</span><span class="op" id="4142542">.</span><span class="ident" id="4142543">Int</span><span class="op" id="4142546">)</span>&nbsp;<span class="op" id="4142548">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4142551">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-add-2007-bl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142641">x3</span><span class="op" id="4142643">,</span>&nbsp;<span class="ident" id="4142645">y3</span><span class="op" id="4142647">,</span>&nbsp;<span class="ident" id="4142649">z3</span>&nbsp;<span class="op" id="4142652">:=</span>&nbsp;<span class="builtinfunc" id="4142655">new</span><span class="op" id="4142658">(</span><span class="ident" id="4142659">big</span><span class="op" id="4142662">.</span><span class="ident" id="4142663">Int</span><span class="op" id="4142666">)</span><span class="op" id="4142667">,</span>&nbsp;<span class="builtinfunc" id="4142669">new</span><span class="op" id="4142672">(</span><span class="ident" id="4142673">big</span><span class="op" id="4142676">.</span><span class="ident" id="4142677">Int</span><span class="op" id="4142680">)</span><span class="op" id="4142681">,</span>&nbsp;<span class="builtinfunc" id="4142683">new</span><span class="op" id="4142686">(</span><span class="ident" id="4142687">big</span><span class="op" id="4142690">.</span><span class="ident" id="4142691">Int</span><span class="op" id="4142694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142697">if</span>&nbsp;<span class="ident" id="4142700">z1</span><span class="op" id="4142702">.</span><span class="ident" id="4142703">Sign</span><span class="op" id="4142707">(</span><span class="op" id="4142708">)</span>&nbsp;<span class="op" id="4142710">==</span>&nbsp;<span class="num" id="4142713">0</span>&nbsp;<span class="op" id="4142715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142719">x3</span><span class="op" id="4142721">.</span><span class="ident" id="4142722">Set</span><span class="op" id="4142725">(</span><span class="ident" id="4142726">x2</span><span class="op" id="4142728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142732">y3</span><span class="op" id="4142734">.</span><span class="ident" id="4142735">Set</span><span class="op" id="4142738">(</span><span class="ident" id="4142739">y2</span><span class="op" id="4142741">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142745">z3</span><span class="op" id="4142747">.</span><span class="ident" id="4142748">Set</span><span class="op" id="4142751">(</span><span class="ident" id="4142752">z2</span><span class="op" id="4142754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142758">return</span>&nbsp;<span class="ident" id="4142765">x3</span><span class="op" id="4142767">,</span>&nbsp;<span class="ident" id="4142769">y3</span><span class="op" id="4142771">,</span>&nbsp;<span class="ident" id="4142773">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142777">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142780">if</span>&nbsp;<span class="ident" id="4142783">z2</span><span class="op" id="4142785">.</span><span class="ident" id="4142786">Sign</span><span class="op" id="4142790">(</span><span class="op" id="4142791">)</span>&nbsp;<span class="op" id="4142793">==</span>&nbsp;<span class="num" id="4142796">0</span>&nbsp;<span class="op" id="4142798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142802">x3</span><span class="op" id="4142804">.</span><span class="ident" id="4142805">Set</span><span class="op" id="4142808">(</span><span class="ident" id="4142809">x1</span><span class="op" id="4142811">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142815">y3</span><span class="op" id="4142817">.</span><span class="ident" id="4142818">Set</span><span class="op" id="4142821">(</span><span class="ident" id="4142822">y1</span><span class="op" id="4142824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142828">z3</span><span class="op" id="4142830">.</span><span class="ident" id="4142831">Set</span><span class="op" id="4142834">(</span><span class="ident" id="4142835">z1</span><span class="op" id="4142837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4142841">return</span>&nbsp;<span class="ident" id="4142848">x3</span><span class="op" id="4142850">,</span>&nbsp;<span class="ident" id="4142852">y3</span><span class="op" id="4142854">,</span>&nbsp;<span class="ident" id="4142856">z3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4142860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142864">z1z1</span>&nbsp;<span class="op" id="4142869">:=</span>&nbsp;<span class="builtinfunc" id="4142872">new</span><span class="op" id="4142875">(</span><span class="ident" id="4142876">big</span><span class="op" id="4142879">.</span><span class="ident" id="4142880">Int</span><span class="op" id="4142883">)</span><span class="op" id="4142884">.</span><span class="ident" id="4142885">Mul</span><span class="op" id="4142888">(</span><span class="ident" id="4142889">z1</span><span class="op" id="4142891">,</span>&nbsp;<span class="ident" id="4142893">z1</span><span class="op" id="4142895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142898">z1z1</span><span class="op" id="4142902">.</span><span class="ident" id="4142903">Mod</span><span class="op" id="4142906">(</span><span class="ident" id="4142907">z1z1</span><span class="op" id="4142911">,</span>&nbsp;<span class="ident" id="4142913">curve</span><span class="op" id="4142918">.</span><span class="ident" id="4142919">P</span><span class="op" id="4142920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142923">z2z2</span>&nbsp;<span class="op" id="4142928">:=</span>&nbsp;<span class="builtinfunc" id="4142931">new</span><span class="op" id="4142934">(</span><span class="ident" id="4142935">big</span><span class="op" id="4142938">.</span><span class="ident" id="4142939">Int</span><span class="op" id="4142942">)</span><span class="op" id="4142943">.</span><span class="ident" id="4142944">Mul</span><span class="op" id="4142947">(</span><span class="ident" id="4142948">z2</span><span class="op" id="4142950">,</span>&nbsp;<span class="ident" id="4142952">z2</span><span class="op" id="4142954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142957">z2z2</span><span class="op" id="4142961">.</span><span class="ident" id="4142962">Mod</span><span class="op" id="4142965">(</span><span class="ident" id="4142966">z2z2</span><span class="op" id="4142970">,</span>&nbsp;<span class="ident" id="4142972">curve</span><span class="op" id="4142977">.</span><span class="ident" id="4142978">P</span><span class="op" id="4142979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4142983">u1</span>&nbsp;<span class="op" id="4142986">:=</span>&nbsp;<span class="builtinfunc" id="4142989">new</span><span class="op" id="4142992">(</span><span class="ident" id="4142993">big</span><span class="op" id="4142996">.</span><span class="ident" id="4142997">Int</span><span class="op" id="4143000">)</span><span class="op" id="4143001">.</span><span class="ident" id="4143002">Mul</span><span class="op" id="4143005">(</span><span class="ident" id="4143006">x1</span><span class="op" id="4143008">,</span>&nbsp;<span class="ident" id="4143010">z2z2</span><span class="op" id="4143014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143017">u1</span><span class="op" id="4143019">.</span><span class="ident" id="4143020">Mod</span><span class="op" id="4143023">(</span><span class="ident" id="4143024">u1</span><span class="op" id="4143026">,</span>&nbsp;<span class="ident" id="4143028">curve</span><span class="op" id="4143033">.</span><span class="ident" id="4143034">P</span><span class="op" id="4143035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143038">u2</span>&nbsp;<span class="op" id="4143041">:=</span>&nbsp;<span class="builtinfunc" id="4143044">new</span><span class="op" id="4143047">(</span><span class="ident" id="4143048">big</span><span class="op" id="4143051">.</span><span class="ident" id="4143052">Int</span><span class="op" id="4143055">)</span><span class="op" id="4143056">.</span><span class="ident" id="4143057">Mul</span><span class="op" id="4143060">(</span><span class="ident" id="4143061">x2</span><span class="op" id="4143063">,</span>&nbsp;<span class="ident" id="4143065">z1z1</span><span class="op" id="4143069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143072">u2</span><span class="op" id="4143074">.</span><span class="ident" id="4143075">Mod</span><span class="op" id="4143078">(</span><span class="ident" id="4143079">u2</span><span class="op" id="4143081">,</span>&nbsp;<span class="ident" id="4143083">curve</span><span class="op" id="4143088">.</span><span class="ident" id="4143089">P</span><span class="op" id="4143090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143093">h</span>&nbsp;<span class="op" id="4143095">:=</span>&nbsp;<span class="builtinfunc" id="4143098">new</span><span class="op" id="4143101">(</span><span class="ident" id="4143102">big</span><span class="op" id="4143105">.</span><span class="ident" id="4143106">Int</span><span class="op" id="4143109">)</span><span class="op" id="4143110">.</span><span class="ident" id="4143111">Sub</span><span class="op" id="4143114">(</span><span class="ident" id="4143115">u2</span><span class="op" id="4143117">,</span>&nbsp;<span class="ident" id="4143119">u1</span><span class="op" id="4143121">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143124">xEqual</span>&nbsp;<span class="op" id="4143131">:=</span>&nbsp;<span class="ident" id="4143134">h</span><span class="op" id="4143135">.</span><span class="ident" id="4143136">Sign</span><span class="op" id="4143140">(</span><span class="op" id="4143141">)</span>&nbsp;<span class="op" id="4143143">==</span>&nbsp;<span class="num" id="4143146">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143149">if</span>&nbsp;<span class="ident" id="4143152">h</span><span class="op" id="4143153">.</span><span class="ident" id="4143154">Sign</span><span class="op" id="4143158">(</span><span class="op" id="4143159">)</span>&nbsp;<span class="op" id="4143161">==</span>&nbsp;<span class="op" id="4143164">-</span><span class="num" id="4143165">1</span>&nbsp;<span class="op" id="4143167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143171">h</span><span class="op" id="4143172">.</span><span class="ident" id="4143173">Add</span><span class="op" id="4143176">(</span><span class="ident" id="4143177">h</span><span class="op" id="4143178">,</span>&nbsp;<span class="ident" id="4143180">curve</span><span class="op" id="4143185">.</span><span class="ident" id="4143186">P</span><span class="op" id="4143187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143193">i</span>&nbsp;<span class="op" id="4143195">:=</span>&nbsp;<span class="builtinfunc" id="4143198">new</span><span class="op" id="4143201">(</span><span class="ident" id="4143202">big</span><span class="op" id="4143205">.</span><span class="ident" id="4143206">Int</span><span class="op" id="4143209">)</span><span class="op" id="4143210">.</span><span class="ident" id="4143211">Lsh</span><span class="op" id="4143214">(</span><span class="ident" id="4143215">h</span><span class="op" id="4143216">,</span>&nbsp;<span class="num" id="4143218">1</span><span class="op" id="4143219">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143222">i</span><span class="op" id="4143223">.</span><span class="ident" id="4143224">Mul</span><span class="op" id="4143227">(</span><span class="ident" id="4143228">i</span><span class="op" id="4143229">,</span>&nbsp;<span class="ident" id="4143231">i</span><span class="op" id="4143232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143235">j</span>&nbsp;<span class="op" id="4143237">:=</span>&nbsp;<span class="builtinfunc" id="4143240">new</span><span class="op" id="4143243">(</span><span class="ident" id="4143244">big</span><span class="op" id="4143247">.</span><span class="ident" id="4143248">Int</span><span class="op" id="4143251">)</span><span class="op" id="4143252">.</span><span class="ident" id="4143253">Mul</span><span class="op" id="4143256">(</span><span class="ident" id="4143257">h</span><span class="op" id="4143258">,</span>&nbsp;<span class="ident" id="4143260">i</span><span class="op" id="4143261">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143265">s1</span>&nbsp;<span class="op" id="4143268">:=</span>&nbsp;<span class="builtinfunc" id="4143271">new</span><span class="op" id="4143274">(</span><span class="ident" id="4143275">big</span><span class="op" id="4143278">.</span><span class="ident" id="4143279">Int</span><span class="op" id="4143282">)</span><span class="op" id="4143283">.</span><span class="ident" id="4143284">Mul</span><span class="op" id="4143287">(</span><span class="ident" id="4143288">y1</span><span class="op" id="4143290">,</span>&nbsp;<span class="ident" id="4143292">z2</span><span class="op" id="4143294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143297">s1</span><span class="op" id="4143299">.</span><span class="ident" id="4143300">Mul</span><span class="op" id="4143303">(</span><span class="ident" id="4143304">s1</span><span class="op" id="4143306">,</span>&nbsp;<span class="ident" id="4143308">z2z2</span><span class="op" id="4143312">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143315">s1</span><span class="op" id="4143317">.</span><span class="ident" id="4143318">Mod</span><span class="op" id="4143321">(</span><span class="ident" id="4143322">s1</span><span class="op" id="4143324">,</span>&nbsp;<span class="ident" id="4143326">curve</span><span class="op" id="4143331">.</span><span class="ident" id="4143332">P</span><span class="op" id="4143333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143336">s2</span>&nbsp;<span class="op" id="4143339">:=</span>&nbsp;<span class="builtinfunc" id="4143342">new</span><span class="op" id="4143345">(</span><span class="ident" id="4143346">big</span><span class="op" id="4143349">.</span><span class="ident" id="4143350">Int</span><span class="op" id="4143353">)</span><span class="op" id="4143354">.</span><span class="ident" id="4143355">Mul</span><span class="op" id="4143358">(</span><span class="ident" id="4143359">y2</span><span class="op" id="4143361">,</span>&nbsp;<span class="ident" id="4143363">z1</span><span class="op" id="4143365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143368">s2</span><span class="op" id="4143370">.</span><span class="ident" id="4143371">Mul</span><span class="op" id="4143374">(</span><span class="ident" id="4143375">s2</span><span class="op" id="4143377">,</span>&nbsp;<span class="ident" id="4143379">z1z1</span><span class="op" id="4143383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143386">s2</span><span class="op" id="4143388">.</span><span class="ident" id="4143389">Mod</span><span class="op" id="4143392">(</span><span class="ident" id="4143393">s2</span><span class="op" id="4143395">,</span>&nbsp;<span class="ident" id="4143397">curve</span><span class="op" id="4143402">.</span><span class="ident" id="4143403">P</span><span class="op" id="4143404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143407">r</span>&nbsp;<span class="op" id="4143409">:=</span>&nbsp;<span class="builtinfunc" id="4143412">new</span><span class="op" id="4143415">(</span><span class="ident" id="4143416">big</span><span class="op" id="4143419">.</span><span class="ident" id="4143420">Int</span><span class="op" id="4143423">)</span><span class="op" id="4143424">.</span><span class="ident" id="4143425">Sub</span><span class="op" id="4143428">(</span><span class="ident" id="4143429">s2</span><span class="op" id="4143431">,</span>&nbsp;<span class="ident" id="4143433">s1</span><span class="op" id="4143435">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143438">if</span>&nbsp;<span class="ident" id="4143441">r</span><span class="op" id="4143442">.</span><span class="ident" id="4143443">Sign</span><span class="op" id="4143447">(</span><span class="op" id="4143448">)</span>&nbsp;<span class="op" id="4143450">==</span>&nbsp;<span class="op" id="4143453">-</span><span class="num" id="4143454">1</span>&nbsp;<span class="op" id="4143456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143460">r</span><span class="op" id="4143461">.</span><span class="ident" id="4143462">Add</span><span class="op" id="4143465">(</span><span class="ident" id="4143466">r</span><span class="op" id="4143467">,</span>&nbsp;<span class="ident" id="4143469">curve</span><span class="op" id="4143474">.</span><span class="ident" id="4143475">P</span><span class="op" id="4143476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143482">yEqual</span>&nbsp;<span class="op" id="4143489">:=</span>&nbsp;<span class="ident" id="4143492">r</span><span class="op" id="4143493">.</span><span class="ident" id="4143494">Sign</span><span class="op" id="4143498">(</span><span class="op" id="4143499">)</span>&nbsp;<span class="op" id="4143501">==</span>&nbsp;<span class="num" id="4143504">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143507">if</span>&nbsp;<span class="ident" id="4143510">xEqual</span>&nbsp;<span class="op" id="4143517">&amp;&amp;</span>&nbsp;<span class="ident" id="4143520">yEqual</span>&nbsp;<span class="op" id="4143527">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143531">return</span>&nbsp;<span class="ident" id="4143538">curve</span><span class="op" id="4143543">.</span><span class="ident" id="4143544">doubleJacobian</span><span class="op" id="4143558">(</span><span class="ident" id="4143559">x1</span><span class="op" id="4143561">,</span>&nbsp;<span class="ident" id="4143563">y1</span><span class="op" id="4143565">,</span>&nbsp;<span class="ident" id="4143567">z1</span><span class="op" id="4143569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4143572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143575">r</span><span class="op" id="4143576">.</span><span class="ident" id="4143577">Lsh</span><span class="op" id="4143580">(</span><span class="ident" id="4143581">r</span><span class="op" id="4143582">,</span>&nbsp;<span class="num" id="4143584">1</span><span class="op" id="4143585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143588">v</span>&nbsp;<span class="op" id="4143590">:=</span>&nbsp;<span class="builtinfunc" id="4143593">new</span><span class="op" id="4143596">(</span><span class="ident" id="4143597">big</span><span class="op" id="4143600">.</span><span class="ident" id="4143601">Int</span><span class="op" id="4143604">)</span><span class="op" id="4143605">.</span><span class="ident" id="4143606">Mul</span><span class="op" id="4143609">(</span><span class="ident" id="4143610">u1</span><span class="op" id="4143612">,</span>&nbsp;<span class="ident" id="4143614">i</span><span class="op" id="4143615">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143619">x3</span><span class="op" id="4143621">.</span><span class="ident" id="4143622">Set</span><span class="op" id="4143625">(</span><span class="ident" id="4143626">r</span><span class="op" id="4143627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143630">x3</span><span class="op" id="4143632">.</span><span class="ident" id="4143633">Mul</span><span class="op" id="4143636">(</span><span class="ident" id="4143637">x3</span><span class="op" id="4143639">,</span>&nbsp;<span class="ident" id="4143641">x3</span><span class="op" id="4143643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143646">x3</span><span class="op" id="4143648">.</span><span class="ident" id="4143649">Sub</span><span class="op" id="4143652">(</span><span class="ident" id="4143653">x3</span><span class="op" id="4143655">,</span>&nbsp;<span class="ident" id="4143657">j</span><span class="op" id="4143658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143661">x3</span><span class="op" id="4143663">.</span><span class="ident" id="4143664">Sub</span><span class="op" id="4143667">(</span><span class="ident" id="4143668">x3</span><span class="op" id="4143670">,</span>&nbsp;<span class="ident" id="4143672">v</span><span class="op" id="4143673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143676">x3</span><span class="op" id="4143678">.</span><span class="ident" id="4143679">Sub</span><span class="op" id="4143682">(</span><span class="ident" id="4143683">x3</span><span class="op" id="4143685">,</span>&nbsp;<span class="ident" id="4143687">v</span><span class="op" id="4143688">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143691">x3</span><span class="op" id="4143693">.</span><span class="ident" id="4143694">Mod</span><span class="op" id="4143697">(</span><span class="ident" id="4143698">x3</span><span class="op" id="4143700">,</span>&nbsp;<span class="ident" id="4143702">curve</span><span class="op" id="4143707">.</span><span class="ident" id="4143708">P</span><span class="op" id="4143709">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143713">y3</span><span class="op" id="4143715">.</span><span class="ident" id="4143716">Set</span><span class="op" id="4143719">(</span><span class="ident" id="4143720">r</span><span class="op" id="4143721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143724">v</span><span class="op" id="4143725">.</span><span class="ident" id="4143726">Sub</span><span class="op" id="4143729">(</span><span class="ident" id="4143730">v</span><span class="op" id="4143731">,</span>&nbsp;<span class="ident" id="4143733">x3</span><span class="op" id="4143735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143738">y3</span><span class="op" id="4143740">.</span><span class="ident" id="4143741">Mul</span><span class="op" id="4143744">(</span><span class="ident" id="4143745">y3</span><span class="op" id="4143747">,</span>&nbsp;<span class="ident" id="4143749">v</span><span class="op" id="4143750">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143753">s1</span><span class="op" id="4143755">.</span><span class="ident" id="4143756">Mul</span><span class="op" id="4143759">(</span><span class="ident" id="4143760">s1</span><span class="op" id="4143762">,</span>&nbsp;<span class="ident" id="4143764">j</span><span class="op" id="4143765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143768">s1</span><span class="op" id="4143770">.</span><span class="ident" id="4143771">Lsh</span><span class="op" id="4143774">(</span><span class="ident" id="4143775">s1</span><span class="op" id="4143777">,</span>&nbsp;<span class="num" id="4143779">1</span><span class="op" id="4143780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143783">y3</span><span class="op" id="4143785">.</span><span class="ident" id="4143786">Sub</span><span class="op" id="4143789">(</span><span class="ident" id="4143790">y3</span><span class="op" id="4143792">,</span>&nbsp;<span class="ident" id="4143794">s1</span><span class="op" id="4143796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143799">y3</span><span class="op" id="4143801">.</span><span class="ident" id="4143802">Mod</span><span class="op" id="4143805">(</span><span class="ident" id="4143806">y3</span><span class="op" id="4143808">,</span>&nbsp;<span class="ident" id="4143810">curve</span><span class="op" id="4143815">.</span><span class="ident" id="4143816">P</span><span class="op" id="4143817">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143821">z3</span><span class="op" id="4143823">.</span><span class="ident" id="4143824">Add</span><span class="op" id="4143827">(</span><span class="ident" id="4143828">z1</span><span class="op" id="4143830">,</span>&nbsp;<span class="ident" id="4143832">z2</span><span class="op" id="4143834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143837">z3</span><span class="op" id="4143839">.</span><span class="ident" id="4143840">Mul</span><span class="op" id="4143843">(</span><span class="ident" id="4143844">z3</span><span class="op" id="4143846">,</span>&nbsp;<span class="ident" id="4143848">z3</span><span class="op" id="4143850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143853">z3</span><span class="op" id="4143855">.</span><span class="ident" id="4143856">Sub</span><span class="op" id="4143859">(</span><span class="ident" id="4143860">z3</span><span class="op" id="4143862">,</span>&nbsp;<span class="ident" id="4143864">z1z1</span><span class="op" id="4143868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143871">z3</span><span class="op" id="4143873">.</span><span class="ident" id="4143874">Sub</span><span class="op" id="4143877">(</span><span class="ident" id="4143878">z3</span><span class="op" id="4143880">,</span>&nbsp;<span class="ident" id="4143882">z2z2</span><span class="op" id="4143886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143889">z3</span><span class="op" id="4143891">.</span><span class="ident" id="4143892">Mul</span><span class="op" id="4143895">(</span><span class="ident" id="4143896">z3</span><span class="op" id="4143898">,</span>&nbsp;<span class="ident" id="4143900">h</span><span class="op" id="4143901">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4143904">z3</span><span class="op" id="4143906">.</span><span class="ident" id="4143907">Mod</span><span class="op" id="4143910">(</span><span class="ident" id="4143911">z3</span><span class="op" id="4143913">,</span>&nbsp;<span class="ident" id="4143915">curve</span><span class="op" id="4143920">.</span><span class="ident" id="4143921">P</span><span class="op" id="4143922">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4143926">return</span>&nbsp;<span class="ident" id="4143933">x3</span><span class="op" id="4143935">,</span>&nbsp;<span class="ident" id="4143937">y3</span><span class="op" id="4143939">,</span>&nbsp;<span class="ident" id="4143941">z3</span><br>
<span class="lineno"></span><span class="op" id="4143944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4143947">func</span>&nbsp;<span class="op" id="4143952">(</span><span class="ident" id="4143953">curve</span>&nbsp;<span class="op" id="4143959">*</span><span class="ident" id="4143960">CurveParams</span><span class="op" id="4143971">)</span>&nbsp;<span class="ident" id="4143973">Double</span><span class="op" id="4143979">(</span><span class="ident" id="4143980">x1</span><span class="op" id="4143982">,</span>&nbsp;<span class="ident" id="4143984">y1</span>&nbsp;<span class="op" id="4143987">*</span><span class="ident" id="4143988">big</span><span class="op" id="4143991">.</span><span class="ident" id="4143992">Int</span><span class="op" id="4143995">)</span>&nbsp;<span class="op" id="4143997">(</span><span class="op" id="4143998">*</span><span class="ident" id="4143999">big</span><span class="op" id="4144002">.</span><span class="ident" id="4144003">Int</span><span class="op" id="4144006">,</span>&nbsp;<span class="op" id="4144008">*</span><span class="ident" id="4144009">big</span><span class="op" id="4144012">.</span><span class="ident" id="4144013">Int</span><span class="op" id="4144016">)</span>&nbsp;<span class="op" id="4144018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144021">z1</span>&nbsp;<span class="op" id="4144024">:=</span>&nbsp;<span class="ident" id="4144027">zForAffine</span><span class="op" id="4144037">(</span><span class="ident" id="4144038">x1</span><span class="op" id="4144040">,</span>&nbsp;<span class="ident" id="4144042">y1</span><span class="op" id="4144044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144047">return</span>&nbsp;<span class="ident" id="4144054">curve</span><span class="op" id="4144059">.</span><span class="ident" id="4144060">affineFromJacobian</span><span class="op" id="4144078">(</span><span class="ident" id="4144079">curve</span><span class="op" id="4144084">.</span><span class="ident" id="4144085">doubleJacobian</span><span class="op" id="4144099">(</span><span class="ident" id="4144100">x1</span><span class="op" id="4144102">,</span>&nbsp;<span class="ident" id="4144104">y1</span><span class="op" id="4144106">,</span>&nbsp;<span class="ident" id="4144108">z1</span><span class="op" id="4144110">)</span><span class="op" id="4144111">)</span><br>
<span class="lineno"></span><span class="op" id="4144113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4144116">//&nbsp;doubleJacobian&nbsp;takes&nbsp;a&nbsp;point&nbsp;in&nbsp;Jacobian&nbsp;coordinates,&nbsp;(x,&nbsp;y,&nbsp;z),&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4144188">//&nbsp;returns&nbsp;its&nbsp;double,&nbsp;also&nbsp;in&nbsp;Jacobian&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4144234">func</span>&nbsp;<span class="op" id="4144239">(</span><span class="ident" id="4144240">curve</span>&nbsp;<span class="op" id="4144246">*</span><span class="ident" id="4144247">CurveParams</span><span class="op" id="4144258">)</span>&nbsp;<span class="ident" id="4144260">doubleJacobian</span><span class="op" id="4144274">(</span><span class="ident" id="4144275">x</span><span class="op" id="4144276">,</span>&nbsp;<span class="ident" id="4144278">y</span><span class="op" id="4144279">,</span>&nbsp;<span class="ident" id="4144281">z</span>&nbsp;<span class="op" id="4144283">*</span><span class="ident" id="4144284">big</span><span class="op" id="4144287">.</span><span class="ident" id="4144288">Int</span><span class="op" id="4144291">)</span>&nbsp;<span class="op" id="4144293">(</span><span class="op" id="4144294">*</span><span class="ident" id="4144295">big</span><span class="op" id="4144298">.</span><span class="ident" id="4144299">Int</span><span class="op" id="4144302">,</span>&nbsp;<span class="op" id="4144304">*</span><span class="ident" id="4144305">big</span><span class="op" id="4144308">.</span><span class="ident" id="4144309">Int</span><span class="op" id="4144312">,</span>&nbsp;<span class="op" id="4144314">*</span><span class="ident" id="4144315">big</span><span class="op" id="4144318">.</span><span class="ident" id="4144319">Int</span><span class="op" id="4144322">)</span>&nbsp;<span class="op" id="4144324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4144327">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#doubling-dbl-2001-b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144416">delta</span>&nbsp;<span class="op" id="4144422">:=</span>&nbsp;<span class="builtinfunc" id="4144425">new</span><span class="op" id="4144428">(</span><span class="ident" id="4144429">big</span><span class="op" id="4144432">.</span><span class="ident" id="4144433">Int</span><span class="op" id="4144436">)</span><span class="op" id="4144437">.</span><span class="ident" id="4144438">Mul</span><span class="op" id="4144441">(</span><span class="ident" id="4144442">z</span><span class="op" id="4144443">,</span>&nbsp;<span class="ident" id="4144445">z</span><span class="op" id="4144446">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144449">delta</span><span class="op" id="4144454">.</span><span class="ident" id="4144455">Mod</span><span class="op" id="4144458">(</span><span class="ident" id="4144459">delta</span><span class="op" id="4144464">,</span>&nbsp;<span class="ident" id="4144466">curve</span><span class="op" id="4144471">.</span><span class="ident" id="4144472">P</span><span class="op" id="4144473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144476">gamma</span>&nbsp;<span class="op" id="4144482">:=</span>&nbsp;<span class="builtinfunc" id="4144485">new</span><span class="op" id="4144488">(</span><span class="ident" id="4144489">big</span><span class="op" id="4144492">.</span><span class="ident" id="4144493">Int</span><span class="op" id="4144496">)</span><span class="op" id="4144497">.</span><span class="ident" id="4144498">Mul</span><span class="op" id="4144501">(</span><span class="ident" id="4144502">y</span><span class="op" id="4144503">,</span>&nbsp;<span class="ident" id="4144505">y</span><span class="op" id="4144506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144509">gamma</span><span class="op" id="4144514">.</span><span class="ident" id="4144515">Mod</span><span class="op" id="4144518">(</span><span class="ident" id="4144519">gamma</span><span class="op" id="4144524">,</span>&nbsp;<span class="ident" id="4144526">curve</span><span class="op" id="4144531">.</span><span class="ident" id="4144532">P</span><span class="op" id="4144533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144536">alpha</span>&nbsp;<span class="op" id="4144542">:=</span>&nbsp;<span class="builtinfunc" id="4144545">new</span><span class="op" id="4144548">(</span><span class="ident" id="4144549">big</span><span class="op" id="4144552">.</span><span class="ident" id="4144553">Int</span><span class="op" id="4144556">)</span><span class="op" id="4144557">.</span><span class="ident" id="4144558">Sub</span><span class="op" id="4144561">(</span><span class="ident" id="4144562">x</span><span class="op" id="4144563">,</span>&nbsp;<span class="ident" id="4144565">delta</span><span class="op" id="4144570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144573">if</span>&nbsp;<span class="ident" id="4144576">alpha</span><span class="op" id="4144581">.</span><span class="ident" id="4144582">Sign</span><span class="op" id="4144586">(</span><span class="op" id="4144587">)</span>&nbsp;<span class="op" id="4144589">==</span>&nbsp;<span class="op" id="4144592">-</span><span class="num" id="4144593">1</span>&nbsp;<span class="op" id="4144595">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144599">alpha</span><span class="op" id="4144604">.</span><span class="ident" id="4144605">Add</span><span class="op" id="4144608">(</span><span class="ident" id="4144609">alpha</span><span class="op" id="4144614">,</span>&nbsp;<span class="ident" id="4144616">curve</span><span class="op" id="4144621">.</span><span class="ident" id="4144622">P</span><span class="op" id="4144623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144629">alpha2</span>&nbsp;<span class="op" id="4144636">:=</span>&nbsp;<span class="builtinfunc" id="4144639">new</span><span class="op" id="4144642">(</span><span class="ident" id="4144643">big</span><span class="op" id="4144646">.</span><span class="ident" id="4144647">Int</span><span class="op" id="4144650">)</span><span class="op" id="4144651">.</span><span class="ident" id="4144652">Add</span><span class="op" id="4144655">(</span><span class="ident" id="4144656">x</span><span class="op" id="4144657">,</span>&nbsp;<span class="ident" id="4144659">delta</span><span class="op" id="4144664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144667">alpha</span><span class="op" id="4144672">.</span><span class="ident" id="4144673">Mul</span><span class="op" id="4144676">(</span><span class="ident" id="4144677">alpha</span><span class="op" id="4144682">,</span>&nbsp;<span class="ident" id="4144684">alpha2</span><span class="op" id="4144690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144693">alpha2</span><span class="op" id="4144699">.</span><span class="ident" id="4144700">Set</span><span class="op" id="4144703">(</span><span class="ident" id="4144704">alpha</span><span class="op" id="4144709">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144712">alpha</span><span class="op" id="4144717">.</span><span class="ident" id="4144718">Lsh</span><span class="op" id="4144721">(</span><span class="ident" id="4144722">alpha</span><span class="op" id="4144727">,</span>&nbsp;<span class="num" id="4144729">1</span><span class="op" id="4144730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144733">alpha</span><span class="op" id="4144738">.</span><span class="ident" id="4144739">Add</span><span class="op" id="4144742">(</span><span class="ident" id="4144743">alpha</span><span class="op" id="4144748">,</span>&nbsp;<span class="ident" id="4144750">alpha2</span><span class="op" id="4144756">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144760">beta</span>&nbsp;<span class="op" id="4144765">:=</span>&nbsp;<span class="ident" id="4144768">alpha2</span><span class="op" id="4144774">.</span><span class="ident" id="4144775">Mul</span><span class="op" id="4144778">(</span><span class="ident" id="4144779">x</span><span class="op" id="4144780">,</span>&nbsp;<span class="ident" id="4144782">gamma</span><span class="op" id="4144787">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144791">x3</span>&nbsp;<span class="op" id="4144794">:=</span>&nbsp;<span class="builtinfunc" id="4144797">new</span><span class="op" id="4144800">(</span><span class="ident" id="4144801">big</span><span class="op" id="4144804">.</span><span class="ident" id="4144805">Int</span><span class="op" id="4144808">)</span><span class="op" id="4144809">.</span><span class="ident" id="4144810">Mul</span><span class="op" id="4144813">(</span><span class="ident" id="4144814">alpha</span><span class="op" id="4144819">,</span>&nbsp;<span class="ident" id="4144821">alpha</span><span class="op" id="4144826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144829">beta8</span>&nbsp;<span class="op" id="4144835">:=</span>&nbsp;<span class="builtinfunc" id="4144838">new</span><span class="op" id="4144841">(</span><span class="ident" id="4144842">big</span><span class="op" id="4144845">.</span><span class="ident" id="4144846">Int</span><span class="op" id="4144849">)</span><span class="op" id="4144850">.</span><span class="ident" id="4144851">Lsh</span><span class="op" id="4144854">(</span><span class="ident" id="4144855">beta</span><span class="op" id="4144859">,</span>&nbsp;<span class="num" id="4144861">3</span><span class="op" id="4144862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144865">x3</span><span class="op" id="4144867">.</span><span class="ident" id="4144868">Sub</span><span class="op" id="4144871">(</span><span class="ident" id="4144872">x3</span><span class="op" id="4144874">,</span>&nbsp;<span class="ident" id="4144876">beta8</span><span class="op" id="4144881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4144884">for</span>&nbsp;<span class="ident" id="4144888">x3</span><span class="op" id="4144890">.</span><span class="ident" id="4144891">Sign</span><span class="op" id="4144895">(</span><span class="op" id="4144896">)</span>&nbsp;<span class="op" id="4144898">==</span>&nbsp;<span class="op" id="4144901">-</span><span class="num" id="4144902">1</span>&nbsp;<span class="op" id="4144904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144908">x3</span><span class="op" id="4144910">.</span><span class="ident" id="4144911">Add</span><span class="op" id="4144914">(</span><span class="ident" id="4144915">x3</span><span class="op" id="4144917">,</span>&nbsp;<span class="ident" id="4144919">curve</span><span class="op" id="4144924">.</span><span class="ident" id="4144925">P</span><span class="op" id="4144926">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4144929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144932">x3</span><span class="op" id="4144934">.</span><span class="ident" id="4144935">Mod</span><span class="op" id="4144938">(</span><span class="ident" id="4144939">x3</span><span class="op" id="4144941">,</span>&nbsp;<span class="ident" id="4144943">curve</span><span class="op" id="4144948">.</span><span class="ident" id="4144949">P</span><span class="op" id="4144950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144954">z3</span>&nbsp;<span class="op" id="4144957">:=</span>&nbsp;<span class="builtinfunc" id="4144960">new</span><span class="op" id="4144963">(</span><span class="ident" id="4144964">big</span><span class="op" id="4144967">.</span><span class="ident" id="4144968">Int</span><span class="op" id="4144971">)</span><span class="op" id="4144972">.</span><span class="ident" id="4144973">Add</span><span class="op" id="4144976">(</span><span class="ident" id="4144977">y</span><span class="op" id="4144978">,</span>&nbsp;<span class="ident" id="4144980">z</span><span class="op" id="4144981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4144984">z3</span><span class="op" id="4144986">.</span><span class="ident" id="4144987">Mul</span><span class="op" id="4144990">(</span><span class="ident" id="4144991">z3</span><span class="op" id="4144993">,</span>&nbsp;<span class="ident" id="4144995">z3</span><span class="op" id="4144997">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145000">z3</span><span class="op" id="4145002">.</span><span class="ident" id="4145003">Sub</span><span class="op" id="4145006">(</span><span class="ident" id="4145007">z3</span><span class="op" id="4145009">,</span>&nbsp;<span class="ident" id="4145011">gamma</span><span class="op" id="4145016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145019">if</span>&nbsp;<span class="ident" id="4145022">z3</span><span class="op" id="4145024">.</span><span class="ident" id="4145025">Sign</span><span class="op" id="4145029">(</span><span class="op" id="4145030">)</span>&nbsp;<span class="op" id="4145032">==</span>&nbsp;<span class="op" id="4145035">-</span><span class="num" id="4145036">1</span>&nbsp;<span class="op" id="4145038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145042">z3</span><span class="op" id="4145044">.</span><span class="ident" id="4145045">Add</span><span class="op" id="4145048">(</span><span class="ident" id="4145049">z3</span><span class="op" id="4145051">,</span>&nbsp;<span class="ident" id="4145053">curve</span><span class="op" id="4145058">.</span><span class="ident" id="4145059">P</span><span class="op" id="4145060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145066">z3</span><span class="op" id="4145068">.</span><span class="ident" id="4145069">Sub</span><span class="op" id="4145072">(</span><span class="ident" id="4145073">z3</span><span class="op" id="4145075">,</span>&nbsp;<span class="ident" id="4145077">delta</span><span class="op" id="4145082">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145085">if</span>&nbsp;<span class="ident" id="4145088">z3</span><span class="op" id="4145090">.</span><span class="ident" id="4145091">Sign</span><span class="op" id="4145095">(</span><span class="op" id="4145096">)</span>&nbsp;<span class="op" id="4145098">==</span>&nbsp;<span class="op" id="4145101">-</span><span class="num" id="4145102">1</span>&nbsp;<span class="op" id="4145104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145108">z3</span><span class="op" id="4145110">.</span><span class="ident" id="4145111">Add</span><span class="op" id="4145114">(</span><span class="ident" id="4145115">z3</span><span class="op" id="4145117">,</span>&nbsp;<span class="ident" id="4145119">curve</span><span class="op" id="4145124">.</span><span class="ident" id="4145125">P</span><span class="op" id="4145126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145132">z3</span><span class="op" id="4145134">.</span><span class="ident" id="4145135">Mod</span><span class="op" id="4145138">(</span><span class="ident" id="4145139">z3</span><span class="op" id="4145141">,</span>&nbsp;<span class="ident" id="4145143">curve</span><span class="op" id="4145148">.</span><span class="ident" id="4145149">P</span><span class="op" id="4145150">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145154">beta</span><span class="op" id="4145158">.</span><span class="ident" id="4145159">Lsh</span><span class="op" id="4145162">(</span><span class="ident" id="4145163">beta</span><span class="op" id="4145167">,</span>&nbsp;<span class="num" id="4145169">2</span><span class="op" id="4145170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145173">beta</span><span class="op" id="4145177">.</span><span class="ident" id="4145178">Sub</span><span class="op" id="4145181">(</span><span class="ident" id="4145182">beta</span><span class="op" id="4145186">,</span>&nbsp;<span class="ident" id="4145188">x3</span><span class="op" id="4145190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145193">if</span>&nbsp;<span class="ident" id="4145196">beta</span><span class="op" id="4145200">.</span><span class="ident" id="4145201">Sign</span><span class="op" id="4145205">(</span><span class="op" id="4145206">)</span>&nbsp;<span class="op" id="4145208">==</span>&nbsp;<span class="op" id="4145211">-</span><span class="num" id="4145212">1</span>&nbsp;<span class="op" id="4145214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145218">beta</span><span class="op" id="4145222">.</span><span class="ident" id="4145223">Add</span><span class="op" id="4145226">(</span><span class="ident" id="4145227">beta</span><span class="op" id="4145231">,</span>&nbsp;<span class="ident" id="4145233">curve</span><span class="op" id="4145238">.</span><span class="ident" id="4145239">P</span><span class="op" id="4145240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145243">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145246">y3</span>&nbsp;<span class="op" id="4145249">:=</span>&nbsp;<span class="ident" id="4145252">alpha</span><span class="op" id="4145257">.</span><span class="ident" id="4145258">Mul</span><span class="op" id="4145261">(</span><span class="ident" id="4145262">alpha</span><span class="op" id="4145267">,</span>&nbsp;<span class="ident" id="4145269">beta</span><span class="op" id="4145273">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145277">gamma</span><span class="op" id="4145282">.</span><span class="ident" id="4145283">Mul</span><span class="op" id="4145286">(</span><span class="ident" id="4145287">gamma</span><span class="op" id="4145292">,</span>&nbsp;<span class="ident" id="4145294">gamma</span><span class="op" id="4145299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145302">gamma</span><span class="op" id="4145307">.</span><span class="ident" id="4145308">Lsh</span><span class="op" id="4145311">(</span><span class="ident" id="4145312">gamma</span><span class="op" id="4145317">,</span>&nbsp;<span class="num" id="4145319">3</span><span class="op" id="4145320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145323">gamma</span><span class="op" id="4145328">.</span><span class="ident" id="4145329">Mod</span><span class="op" id="4145332">(</span><span class="ident" id="4145333">gamma</span><span class="op" id="4145338">,</span>&nbsp;<span class="ident" id="4145340">curve</span><span class="op" id="4145345">.</span><span class="ident" id="4145346">P</span><span class="op" id="4145347">)</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145351">y3</span><span class="op" id="4145353">.</span><span class="ident" id="4145354">Sub</span><span class="op" id="4145357">(</span><span class="ident" id="4145358">y3</span><span class="op" id="4145360">,</span>&nbsp;<span class="ident" id="4145362">gamma</span><span class="op" id="4145367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145370">if</span>&nbsp;<span class="ident" id="4145373">y3</span><span class="op" id="4145375">.</span><span class="ident" id="4145376">Sign</span><span class="op" id="4145380">(</span><span class="op" id="4145381">)</span>&nbsp;<span class="op" id="4145383">==</span>&nbsp;<span class="op" id="4145386">-</span><span class="num" id="4145387">1</span>&nbsp;<span class="op" id="4145389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145393">y3</span><span class="op" id="4145395">.</span><span class="ident" id="4145396">Add</span><span class="op" id="4145399">(</span><span class="ident" id="4145400">y3</span><span class="op" id="4145402">,</span>&nbsp;<span class="ident" id="4145404">curve</span><span class="op" id="4145409">.</span><span class="ident" id="4145410">P</span><span class="op" id="4145411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145414">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145417">y3</span><span class="op" id="4145419">.</span><span class="ident" id="4145420">Mod</span><span class="op" id="4145423">(</span><span class="ident" id="4145424">y3</span><span class="op" id="4145426">,</span>&nbsp;<span class="ident" id="4145428">curve</span><span class="op" id="4145433">.</span><span class="ident" id="4145434">P</span><span class="op" id="4145435">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145439">return</span>&nbsp;<span class="ident" id="4145446">x3</span><span class="op" id="4145448">,</span>&nbsp;<span class="ident" id="4145450">y3</span><span class="op" id="4145452">,</span>&nbsp;<span class="ident" id="4145454">z3</span><br>
<span class="lineno"></span><span class="op" id="4145457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="4145460">func</span>&nbsp;<span class="op" id="4145465">(</span><span class="ident" id="4145466">curve</span>&nbsp;<span class="op" id="4145472">*</span><span class="ident" id="4145473">CurveParams</span><span class="op" id="4145484">)</span>&nbsp;<span class="ident" id="4145486">ScalarMult</span><span class="op" id="4145496">(</span><span class="ident" id="4145497">Bx</span><span class="op" id="4145499">,</span>&nbsp;<span class="ident" id="4145501">By</span>&nbsp;<span class="op" id="4145504">*</span><span class="ident" id="4145505">big</span><span class="op" id="4145508">.</span><span class="ident" id="4145509">Int</span><span class="op" id="4145512">,</span>&nbsp;<span class="ident" id="4145514">k</span>&nbsp;<span class="op" id="4145516">[</span><span class="op" id="4145517">]</span><span class="builtintype" id="4145518">byte</span><span class="op" id="4145522">)</span>&nbsp;<span class="op" id="4145524">(</span><span class="op" id="4145525">*</span><span class="ident" id="4145526">big</span><span class="op" id="4145529">.</span><span class="ident" id="4145530">Int</span><span class="op" id="4145533">,</span>&nbsp;<span class="op" id="4145535">*</span><span class="ident" id="4145536">big</span><span class="op" id="4145539">.</span><span class="ident" id="4145540">Int</span><span class="op" id="4145543">)</span>&nbsp;<span class="op" id="4145545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145548">Bz</span>&nbsp;<span class="op" id="4145551">:=</span>&nbsp;<span class="builtinfunc" id="4145554">new</span><span class="op" id="4145557">(</span><span class="ident" id="4145558">big</span><span class="op" id="4145561">.</span><span class="ident" id="4145562">Int</span><span class="op" id="4145565">)</span><span class="op" id="4145566">.</span><span class="ident" id="4145567">SetInt64</span><span class="op" id="4145575">(</span><span class="num" id="4145576">1</span><span class="op" id="4145577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145580">x</span><span class="op" id="4145581">,</span>&nbsp;<span class="ident" id="4145583">y</span><span class="op" id="4145584">,</span>&nbsp;<span class="ident" id="4145586">z</span>&nbsp;<span class="op" id="4145588">:=</span>&nbsp;<span class="builtinfunc" id="4145591">new</span><span class="op" id="4145594">(</span><span class="ident" id="4145595">big</span><span class="op" id="4145598">.</span><span class="ident" id="4145599">Int</span><span class="op" id="4145602">)</span><span class="op" id="4145603">,</span>&nbsp;<span class="builtinfunc" id="4145605">new</span><span class="op" id="4145608">(</span><span class="ident" id="4145609">big</span><span class="op" id="4145612">.</span><span class="ident" id="4145613">Int</span><span class="op" id="4145616">)</span><span class="op" id="4145617">,</span>&nbsp;<span class="builtinfunc" id="4145619">new</span><span class="op" id="4145622">(</span><span class="ident" id="4145623">big</span><span class="op" id="4145626">.</span><span class="ident" id="4145627">Int</span><span class="op" id="4145630">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145634">for</span>&nbsp;<span class="ident" id="4145638">_</span><span class="op" id="4145639">,</span>&nbsp;<span class="builtintype" id="4145641">byte</span>&nbsp;<span class="op" id="4145646">:=</span>&nbsp;<span class="keyword" id="4145649">range</span>&nbsp;<span class="ident" id="4145655">k</span>&nbsp;<span class="op" id="4145657">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145661">for</span>&nbsp;<span class="ident" id="4145665">bitNum</span>&nbsp;<span class="op" id="4145672">:=</span>&nbsp;<span class="num" id="4145675">0</span><span class="op" id="4145676">;</span>&nbsp;<span class="ident" id="4145678">bitNum</span>&nbsp;<span class="op" id="4145685">&lt;</span>&nbsp;<span class="num" id="4145687">8</span><span class="op" id="4145688">;</span>&nbsp;<span class="ident" id="4145690">bitNum</span><span class="op" id="4145696">++</span>&nbsp;<span class="op" id="4145699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145704">x</span><span class="op" id="4145705">,</span>&nbsp;<span class="ident" id="4145707">y</span><span class="op" id="4145708">,</span>&nbsp;<span class="ident" id="4145710">z</span>&nbsp;<span class="op" id="4145712">=</span>&nbsp;<span class="ident" id="4145714">curve</span><span class="op" id="4145719">.</span><span class="ident" id="4145720">doubleJacobian</span><span class="op" id="4145734">(</span><span class="ident" id="4145735">x</span><span class="op" id="4145736">,</span>&nbsp;<span class="ident" id="4145738">y</span><span class="op" id="4145739">,</span>&nbsp;<span class="ident" id="4145741">z</span><span class="op" id="4145742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145747">if</span>&nbsp;<span class="builtintype" id="4145750">byte</span><span class="op" id="4145754">&amp;</span><span class="num" id="4145755">0x80</span>&nbsp;<span class="op" id="4145760">==</span>&nbsp;<span class="num" id="4145763">0x80</span>&nbsp;<span class="op" id="4145768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4145774">x</span><span class="op" id="4145775">,</span>&nbsp;<span class="ident" id="4145777">y</span><span class="op" id="4145778">,</span>&nbsp;<span class="ident" id="4145780">z</span>&nbsp;<span class="op" id="4145782">=</span>&nbsp;<span class="ident" id="4145784">curve</span><span class="op" id="4145789">.</span><span class="ident" id="4145790">addJacobian</span><span class="op" id="4145801">(</span><span class="ident" id="4145802">Bx</span><span class="op" id="4145804">,</span>&nbsp;<span class="ident" id="4145806">By</span><span class="op" id="4145808">,</span>&nbsp;<span class="ident" id="4145810">Bz</span><span class="op" id="4145812">,</span>&nbsp;<span class="ident" id="4145814">x</span><span class="op" id="4145815">,</span>&nbsp;<span class="ident" id="4145817">y</span><span class="op" id="4145818">,</span>&nbsp;<span class="ident" id="4145820">z</span><span class="op" id="4145821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145826">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4145831">byte</span>&nbsp;<span class="op" id="4145836">&lt;&lt;=</span>&nbsp;<span class="num" id="4145840">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4145847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145851">return</span>&nbsp;<span class="ident" id="4145858">curve</span><span class="op" id="4145863">.</span><span class="ident" id="4145864">affineFromJacobian</span><span class="op" id="4145882">(</span><span class="ident" id="4145883">x</span><span class="op" id="4145884">,</span>&nbsp;<span class="ident" id="4145886">y</span><span class="op" id="4145887">,</span>&nbsp;<span class="ident" id="4145889">z</span><span class="op" id="4145890">)</span><br>
<span class="lineno">265</span><span class="op" id="4145892">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4145895">func</span>&nbsp;<span class="op" id="4145900">(</span><span class="ident" id="4145901">curve</span>&nbsp;<span class="op" id="4145907">*</span><span class="ident" id="4145908">CurveParams</span><span class="op" id="4145919">)</span>&nbsp;<span class="ident" id="4145921">ScalarBaseMult</span><span class="op" id="4145935">(</span><span class="ident" id="4145936">k</span>&nbsp;<span class="op" id="4145938">[</span><span class="op" id="4145939">]</span><span class="builtintype" id="4145940">byte</span><span class="op" id="4145944">)</span>&nbsp;<span class="op" id="4145946">(</span><span class="op" id="4145947">*</span><span class="ident" id="4145948">big</span><span class="op" id="4145951">.</span><span class="ident" id="4145952">Int</span><span class="op" id="4145955">,</span>&nbsp;<span class="op" id="4145957">*</span><span class="ident" id="4145958">big</span><span class="op" id="4145961">.</span><span class="ident" id="4145962">Int</span><span class="op" id="4145965">)</span>&nbsp;<span class="op" id="4145967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4145970">return</span>&nbsp;<span class="ident" id="4145977">curve</span><span class="op" id="4145982">.</span><span class="ident" id="4145983">ScalarMult</span><span class="op" id="4145993">(</span><span class="ident" id="4145994">curve</span><span class="op" id="4145999">.</span><span class="ident" id="4146000">Gx</span><span class="op" id="4146002">,</span>&nbsp;<span class="ident" id="4146004">curve</span><span class="op" id="4146009">.</span><span class="ident" id="4146010">Gy</span><span class="op" id="4146012">,</span>&nbsp;<span class="ident" id="4146014">k</span><span class="op" id="4146015">)</span><br>
<span class="lineno"></span><span class="op" id="4146017">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="keyword" id="4146020">var</span>&nbsp;<span class="ident" id="4146024">mask</span>&nbsp;<span class="op" id="4146029">=</span>&nbsp;<span class="op" id="4146031">[</span><span class="op" id="4146032">]</span><span class="builtintype" id="4146033">byte</span><span class="op" id="4146037">{</span><span class="num" id="4146038">0xff</span><span class="op" id="4146042">,</span>&nbsp;<span class="num" id="4146044">0x1</span><span class="op" id="4146047">,</span>&nbsp;<span class="num" id="4146049">0x3</span><span class="op" id="4146052">,</span>&nbsp;<span class="num" id="4146054">0x7</span><span class="op" id="4146057">,</span>&nbsp;<span class="num" id="4146059">0xf</span><span class="op" id="4146062">,</span>&nbsp;<span class="num" id="4146064">0x1f</span><span class="op" id="4146068">,</span>&nbsp;<span class="num" id="4146070">0x3f</span><span class="op" id="4146074">,</span>&nbsp;<span class="num" id="4146076">0x7f</span><span class="op" id="4146080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4146083">//&nbsp;GenerateKey&nbsp;returns&nbsp;a&nbsp;public/private&nbsp;key&nbsp;pair.&nbsp;The&nbsp;private&nbsp;key&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4146152">//&nbsp;generated&nbsp;using&nbsp;the&nbsp;given&nbsp;reader,&nbsp;which&nbsp;must&nbsp;return&nbsp;random&nbsp;data.</span><br>
<span class="lineno">275</span><span class="keyword" id="4146220">func</span>&nbsp;<span class="ident" id="4146225">GenerateKey</span><span class="op" id="4146236">(</span><span class="ident" id="4146237">curve</span>&nbsp;<span class="ident" id="4146243">Curve</span><span class="op" id="4146248">,</span>&nbsp;<span class="ident" id="4146250">rand</span>&nbsp;<span class="ident" id="4146255">io</span><span class="op" id="4146257">.</span><span class="ident" id="4146258">Reader</span><span class="op" id="4146264">)</span>&nbsp;<span class="op" id="4146266">(</span><span class="ident" id="4146267">priv</span>&nbsp;<span class="op" id="4146272">[</span><span class="op" id="4146273">]</span><span class="builtintype" id="4146274">byte</span><span class="op" id="4146278">,</span>&nbsp;<span class="ident" id="4146280">x</span><span class="op" id="4146281">,</span>&nbsp;<span class="ident" id="4146283">y</span>&nbsp;<span class="op" id="4146285">*</span><span class="ident" id="4146286">big</span><span class="op" id="4146289">.</span><span class="ident" id="4146290">Int</span><span class="op" id="4146293">,</span>&nbsp;<span class="ident" id="4146295">err</span>&nbsp;<span class="builtintype" id="4146299">error</span><span class="op" id="4146304">)</span>&nbsp;<span class="op" id="4146306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146309">bitSize</span>&nbsp;<span class="op" id="4146317">:=</span>&nbsp;<span class="ident" id="4146320">curve</span><span class="op" id="4146325">.</span><span class="ident" id="4146326">Params</span><span class="op" id="4146332">(</span><span class="op" id="4146333">)</span><span class="op" id="4146334">.</span><span class="ident" id="4146335">BitSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146344">byteLen</span>&nbsp;<span class="op" id="4146352">:=</span>&nbsp;<span class="op" id="4146355">(</span><span class="ident" id="4146356">bitSize</span>&nbsp;<span class="op" id="4146364">+</span>&nbsp;<span class="num" id="4146366">7</span><span class="op" id="4146367">)</span>&nbsp;<span class="op" id="4146369">&gt;&gt;</span>&nbsp;<span class="num" id="4146372">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146375">priv</span>&nbsp;<span class="op" id="4146380">=</span>&nbsp;<span class="builtinfunc" id="4146382">make</span><span class="op" id="4146386">(</span><span class="op" id="4146387">[</span><span class="op" id="4146388">]</span><span class="builtintype" id="4146389">byte</span><span class="op" id="4146393">,</span>&nbsp;<span class="ident" id="4146395">byteLen</span><span class="op" id="4146402">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146406">for</span>&nbsp;<span class="ident" id="4146410">x</span>&nbsp;<span class="op" id="4146412">==</span>&nbsp;<span class="ident" id="4146415">nil</span>&nbsp;<span class="op" id="4146419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146423">_</span><span class="op" id="4146424">,</span>&nbsp;<span class="ident" id="4146426">err</span>&nbsp;<span class="op" id="4146430">=</span>&nbsp;<span class="ident" id="4146432">io</span><span class="op" id="4146434">.</span><span class="ident" id="4146435">ReadFull</span><span class="op" id="4146443">(</span><span class="ident" id="4146444">rand</span><span class="op" id="4146448">,</span>&nbsp;<span class="ident" id="4146450">priv</span><span class="op" id="4146454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146458">if</span>&nbsp;<span class="ident" id="4146461">err</span>&nbsp;<span class="op" id="4146465">!=</span>&nbsp;<span class="ident" id="4146468">nil</span>&nbsp;<span class="op" id="4146472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146477">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146486">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4146490">//&nbsp;We&nbsp;have&nbsp;to&nbsp;mask&nbsp;off&nbsp;any&nbsp;excess&nbsp;bits&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;the&nbsp;size&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4146564">//&nbsp;underlying&nbsp;field&nbsp;is&nbsp;not&nbsp;a&nbsp;whole&nbsp;number&nbsp;of&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146618">priv</span><span class="op" id="4146622">[</span><span class="num" id="4146623">0</span><span class="op" id="4146624">]</span>&nbsp;<span class="op" id="4146626">&amp;=</span>&nbsp;<span class="ident" id="4146629">mask</span><span class="op" id="4146633">[</span><span class="ident" id="4146634">bitSize</span><span class="op" id="4146641">%</span><span class="num" id="4146642">8</span><span class="op" id="4146643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4146647">//&nbsp;This&nbsp;is&nbsp;because,&nbsp;in&nbsp;tests,&nbsp;rand&nbsp;will&nbsp;return&nbsp;all&nbsp;zeros&nbsp;and&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4146719">//&nbsp;want&nbsp;to&nbsp;get&nbsp;the&nbsp;point&nbsp;at&nbsp;infinity&nbsp;and&nbsp;loop&nbsp;forever.</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146776">priv</span><span class="op" id="4146780">[</span><span class="num" id="4146781">1</span><span class="op" id="4146782">]</span>&nbsp;<span class="op" id="4146784">^=</span>&nbsp;<span class="num" id="4146787">0x42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146794">x</span><span class="op" id="4146795">,</span>&nbsp;<span class="ident" id="4146797">y</span>&nbsp;<span class="op" id="4146799">=</span>&nbsp;<span class="ident" id="4146801">curve</span><span class="op" id="4146806">.</span><span class="ident" id="4146807">ScalarBaseMult</span><span class="op" id="4146821">(</span><span class="ident" id="4146822">priv</span><span class="op" id="4146826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4146829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4146832">return</span><br>
<span class="lineno"></span><span class="op" id="4146839">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="4146842">//&nbsp;Marshal&nbsp;converts&nbsp;a&nbsp;point&nbsp;into&nbsp;the&nbsp;form&nbsp;specified&nbsp;in&nbsp;section&nbsp;4.3.6&nbsp;of&nbsp;ANSI&nbsp;X9.62.</span><br>
<span class="lineno"></span><span class="keyword" id="4146926">func</span>&nbsp;<span class="ident" id="4146931">Marshal</span><span class="op" id="4146938">(</span><span class="ident" id="4146939">curve</span>&nbsp;<span class="ident" id="4146945">Curve</span><span class="op" id="4146950">,</span>&nbsp;<span class="ident" id="4146952">x</span><span class="op" id="4146953">,</span>&nbsp;<span class="ident" id="4146955">y</span>&nbsp;<span class="op" id="4146957">*</span><span class="ident" id="4146958">big</span><span class="op" id="4146961">.</span><span class="ident" id="4146962">Int</span><span class="op" id="4146965">)</span>&nbsp;<span class="op" id="4146967">[</span><span class="op" id="4146968">]</span><span class="builtintype" id="4146969">byte</span>&nbsp;<span class="op" id="4146974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4146977">byteLen</span>&nbsp;<span class="op" id="4146985">:=</span>&nbsp;<span class="op" id="4146988">(</span><span class="ident" id="4146989">curve</span><span class="op" id="4146994">.</span><span class="ident" id="4146995">Params</span><span class="op" id="4147001">(</span><span class="op" id="4147002">)</span><span class="op" id="4147003">.</span><span class="ident" id="4147004">BitSize</span>&nbsp;<span class="op" id="4147012">+</span>&nbsp;<span class="num" id="4147014">7</span><span class="op" id="4147015">)</span>&nbsp;<span class="op" id="4147017">&gt;&gt;</span>&nbsp;<span class="num" id="4147020">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147024">ret</span>&nbsp;<span class="op" id="4147028">:=</span>&nbsp;<span class="builtinfunc" id="4147031">make</span><span class="op" id="4147035">(</span><span class="op" id="4147036">[</span><span class="op" id="4147037">]</span><span class="builtintype" id="4147038">byte</span><span class="op" id="4147042">,</span>&nbsp;<span class="num" id="4147044">1</span><span class="op" id="4147045">+</span><span class="num" id="4147046">2</span><span class="op" id="4147047">*</span><span class="ident" id="4147048">byteLen</span><span class="op" id="4147055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147058">ret</span><span class="op" id="4147061">[</span><span class="num" id="4147062">0</span><span class="op" id="4147063">]</span>&nbsp;<span class="op" id="4147065">=</span>&nbsp;<span class="num" id="4147067">4</span>&nbsp;<span class="comment" id="4147069">//&nbsp;uncompressed&nbsp;point</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147093">xBytes</span>&nbsp;<span class="op" id="4147100">:=</span>&nbsp;<span class="ident" id="4147103">x</span><span class="op" id="4147104">.</span><span class="ident" id="4147105">Bytes</span><span class="op" id="4147110">(</span><span class="op" id="4147111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4147114">copy</span><span class="op" id="4147118">(</span><span class="ident" id="4147119">ret</span><span class="op" id="4147122">[</span><span class="num" id="4147123">1</span><span class="op" id="4147124">+</span><span class="ident" id="4147125">byteLen</span><span class="op" id="4147132">-</span><span class="builtinfunc" id="4147133">len</span><span class="op" id="4147136">(</span><span class="ident" id="4147137">xBytes</span><span class="op" id="4147143">)</span><span class="op" id="4147144">:</span><span class="op" id="4147145">]</span><span class="op" id="4147146">,</span>&nbsp;<span class="ident" id="4147148">xBytes</span><span class="op" id="4147154">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147157">yBytes</span>&nbsp;<span class="op" id="4147164">:=</span>&nbsp;<span class="ident" id="4147167">y</span><span class="op" id="4147168">.</span><span class="ident" id="4147169">Bytes</span><span class="op" id="4147174">(</span><span class="op" id="4147175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4147178">copy</span><span class="op" id="4147182">(</span><span class="ident" id="4147183">ret</span><span class="op" id="4147186">[</span><span class="num" id="4147187">1</span><span class="op" id="4147188">+</span><span class="num" id="4147189">2</span><span class="op" id="4147190">*</span><span class="ident" id="4147191">byteLen</span><span class="op" id="4147198">-</span><span class="builtinfunc" id="4147199">len</span><span class="op" id="4147202">(</span><span class="ident" id="4147203">yBytes</span><span class="op" id="4147209">)</span><span class="op" id="4147210">:</span><span class="op" id="4147211">]</span><span class="op" id="4147212">,</span>&nbsp;<span class="ident" id="4147214">yBytes</span><span class="op" id="4147220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147223">return</span>&nbsp;<span class="ident" id="4147230">ret</span><br>
<span class="lineno"></span><span class="op" id="4147234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4147237">//&nbsp;Unmarshal&nbsp;converts&nbsp;a&nbsp;point,&nbsp;serialized&nbsp;by&nbsp;Marshal,&nbsp;into&nbsp;an&nbsp;x,&nbsp;y&nbsp;pair.&nbsp;On&nbsp;error,&nbsp;x&nbsp;=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4147329">func</span>&nbsp;<span class="ident" id="4147334">Unmarshal</span><span class="op" id="4147343">(</span><span class="ident" id="4147344">curve</span>&nbsp;<span class="ident" id="4147350">Curve</span><span class="op" id="4147355">,</span>&nbsp;<span class="ident" id="4147357">data</span>&nbsp;<span class="op" id="4147362">[</span><span class="op" id="4147363">]</span><span class="builtintype" id="4147364">byte</span><span class="op" id="4147368">)</span>&nbsp;<span class="op" id="4147370">(</span><span class="ident" id="4147371">x</span><span class="op" id="4147372">,</span>&nbsp;<span class="ident" id="4147374">y</span>&nbsp;<span class="op" id="4147376">*</span><span class="ident" id="4147377">big</span><span class="op" id="4147380">.</span><span class="ident" id="4147381">Int</span><span class="op" id="4147384">)</span>&nbsp;<span class="op" id="4147386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147389">byteLen</span>&nbsp;<span class="op" id="4147397">:=</span>&nbsp;<span class="op" id="4147400">(</span><span class="ident" id="4147401">curve</span><span class="op" id="4147406">.</span><span class="ident" id="4147407">Params</span><span class="op" id="4147413">(</span><span class="op" id="4147414">)</span><span class="op" id="4147415">.</span><span class="ident" id="4147416">BitSize</span>&nbsp;<span class="op" id="4147424">+</span>&nbsp;<span class="num" id="4147426">7</span><span class="op" id="4147427">)</span>&nbsp;<span class="op" id="4147429">&gt;&gt;</span>&nbsp;<span class="num" id="4147432">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147435">if</span>&nbsp;<span class="builtinfunc" id="4147438">len</span><span class="op" id="4147441">(</span><span class="ident" id="4147442">data</span><span class="op" id="4147446">)</span>&nbsp;<span class="op" id="4147448">!=</span>&nbsp;<span class="num" id="4147451">1</span><span class="op" id="4147452">+</span><span class="num" id="4147453">2</span><span class="op" id="4147454">*</span><span class="ident" id="4147455">byteLen</span>&nbsp;<span class="op" id="4147463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147467">return</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147478">if</span>&nbsp;<span class="ident" id="4147481">data</span><span class="op" id="4147485">[</span><span class="num" id="4147486">0</span><span class="op" id="4147487">]</span>&nbsp;<span class="op" id="4147489">!=</span>&nbsp;<span class="num" id="4147492">4</span>&nbsp;<span class="op" id="4147494">{</span>&nbsp;<span class="comment" id="4147496">//&nbsp;uncompressed&nbsp;form</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147519">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4147527">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147530">x</span>&nbsp;<span class="op" id="4147532">=</span>&nbsp;<span class="builtinfunc" id="4147534">new</span><span class="op" id="4147537">(</span><span class="ident" id="4147538">big</span><span class="op" id="4147541">.</span><span class="ident" id="4147542">Int</span><span class="op" id="4147545">)</span><span class="op" id="4147546">.</span><span class="ident" id="4147547">SetBytes</span><span class="op" id="4147555">(</span><span class="ident" id="4147556">data</span><span class="op" id="4147560">[</span><span class="num" id="4147561">1</span>&nbsp;<span class="op" id="4147563">:</span>&nbsp;<span class="num" id="4147565">1</span><span class="op" id="4147566">+</span><span class="ident" id="4147567">byteLen</span><span class="op" id="4147574">]</span><span class="op" id="4147575">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147578">y</span>&nbsp;<span class="op" id="4147580">=</span>&nbsp;<span class="builtinfunc" id="4147582">new</span><span class="op" id="4147585">(</span><span class="ident" id="4147586">big</span><span class="op" id="4147589">.</span><span class="ident" id="4147590">Int</span><span class="op" id="4147593">)</span><span class="op" id="4147594">.</span><span class="ident" id="4147595">SetBytes</span><span class="op" id="4147603">(</span><span class="ident" id="4147604">data</span><span class="op" id="4147608">[</span><span class="num" id="4147609">1</span><span class="op" id="4147610">+</span><span class="ident" id="4147611">byteLen</span><span class="op" id="4147618">:</span><span class="op" id="4147619">]</span><span class="op" id="4147620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4147623">return</span><br>
<span class="lineno"></span><span class="op" id="4147630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147633">var</span>&nbsp;<span class="ident" id="4147637">initonce</span>&nbsp;<span class="ident" id="4147646">sync</span><span class="op" id="4147650">.</span><span class="ident" id="4147651">Once</span><br>
<span class="lineno">325</span><span class="keyword" id="4147656">var</span>&nbsp;<span class="ident" id="4147660">p384</span>&nbsp;<span class="op" id="4147665">*</span><span class="ident" id="4147666">CurveParams</span><br>
<span class="lineno"></span><span class="keyword" id="4147678">var</span>&nbsp;<span class="ident" id="4147682">p521</span>&nbsp;<span class="op" id="4147687">*</span><span class="ident" id="4147688">CurveParams</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4147701">func</span>&nbsp;<span class="ident" id="4147706">initAll</span><span class="op" id="4147713">(</span><span class="op" id="4147714">)</span>&nbsp;<span class="op" id="4147716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147719">initP224</span><span class="op" id="4147727">(</span><span class="op" id="4147728">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147731">initP256</span><span class="op" id="4147739">(</span><span class="op" id="4147740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147743">initP384</span><span class="op" id="4147751">(</span><span class="op" id="4147752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147755">initP521</span><span class="op" id="4147763">(</span><span class="op" id="4147764">)</span><br>
<span class="lineno"></span><span class="op" id="4147766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="4147769">func</span>&nbsp;<span class="ident" id="4147774">initP384</span><span class="op" id="4147782">(</span><span class="op" id="4147783">)</span>&nbsp;<span class="op" id="4147785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4147788">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147822">p384</span>&nbsp;<span class="op" id="4147827">=</span>&nbsp;<span class="builtinfunc" id="4147829">new</span><span class="op" id="4147832">(</span><span class="ident" id="4147833">CurveParams</span><span class="op" id="4147844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4147847">p384</span><span class="op" id="4147851">.</span><span class="ident" id="4147852">P</span><span class="op" id="4147853">,</span>&nbsp;<span class="ident" id="4147855">_</span>&nbsp;<span class="op" id="4147857">=</span>&nbsp;<span class="builtinfunc" id="4147859">new</span><span class="op" id="4147862">(</span><span class="ident" id="4147863">big</span><span class="op" id="4147866">.</span><span class="ident" id="4147867">Int</span><span class="op" id="4147870">)</span><span class="op" id="4147871">.</span><span class="ident" id="4147872">SetString</span><span class="op" id="4147881">(</span><span class="string" id="4147882">&#34;39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319&#34;</span><span class="op" id="4148000">,</span>&nbsp;<span class="num" id="4148002">10</span><span class="op" id="4148004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148007">p384</span><span class="op" id="4148011">.</span><span class="ident" id="4148012">N</span><span class="op" id="4148013">,</span>&nbsp;<span class="ident" id="4148015">_</span>&nbsp;<span class="op" id="4148017">=</span>&nbsp;<span class="builtinfunc" id="4148019">new</span><span class="op" id="4148022">(</span><span class="ident" id="4148023">big</span><span class="op" id="4148026">.</span><span class="ident" id="4148027">Int</span><span class="op" id="4148030">)</span><span class="op" id="4148031">.</span><span class="ident" id="4148032">SetString</span><span class="op" id="4148041">(</span><span class="string" id="4148042">&#34;39402006196394479212279040100143613805079739270465446667946905279627659399113263569398956308152294913554433653942643&#34;</span><span class="op" id="4148160">,</span>&nbsp;<span class="num" id="4148162">10</span><span class="op" id="4148164">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148167">p384</span><span class="op" id="4148171">.</span><span class="ident" id="4148172">B</span><span class="op" id="4148173">,</span>&nbsp;<span class="ident" id="4148175">_</span>&nbsp;<span class="op" id="4148177">=</span>&nbsp;<span class="builtinfunc" id="4148179">new</span><span class="op" id="4148182">(</span><span class="ident" id="4148183">big</span><span class="op" id="4148186">.</span><span class="ident" id="4148187">Int</span><span class="op" id="4148190">)</span><span class="op" id="4148191">.</span><span class="ident" id="4148192">SetString</span><span class="op" id="4148201">(</span><span class="string" id="4148202">&#34;b3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef&#34;</span><span class="op" id="4148300">,</span>&nbsp;<span class="num" id="4148302">16</span><span class="op" id="4148304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148307">p384</span><span class="op" id="4148311">.</span><span class="ident" id="4148312">Gx</span><span class="op" id="4148314">,</span>&nbsp;<span class="ident" id="4148316">_</span>&nbsp;<span class="op" id="4148318">=</span>&nbsp;<span class="builtinfunc" id="4148320">new</span><span class="op" id="4148323">(</span><span class="ident" id="4148324">big</span><span class="op" id="4148327">.</span><span class="ident" id="4148328">Int</span><span class="op" id="4148331">)</span><span class="op" id="4148332">.</span><span class="ident" id="4148333">SetString</span><span class="op" id="4148342">(</span><span class="string" id="4148343">&#34;aa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7&#34;</span><span class="op" id="4148441">,</span>&nbsp;<span class="num" id="4148443">16</span><span class="op" id="4148445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148448">p384</span><span class="op" id="4148452">.</span><span class="ident" id="4148453">Gy</span><span class="op" id="4148455">,</span>&nbsp;<span class="ident" id="4148457">_</span>&nbsp;<span class="op" id="4148459">=</span>&nbsp;<span class="builtinfunc" id="4148461">new</span><span class="op" id="4148464">(</span><span class="ident" id="4148465">big</span><span class="op" id="4148468">.</span><span class="ident" id="4148469">Int</span><span class="op" id="4148472">)</span><span class="op" id="4148473">.</span><span class="ident" id="4148474">SetString</span><span class="op" id="4148483">(</span><span class="string" id="4148484">&#34;3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f&#34;</span><span class="op" id="4148582">,</span>&nbsp;<span class="num" id="4148584">16</span><span class="op" id="4148586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148589">p384</span><span class="op" id="4148593">.</span><span class="ident" id="4148594">BitSize</span>&nbsp;<span class="op" id="4148602">=</span>&nbsp;<span class="num" id="4148604">384</span><br>
<span class="lineno"></span><span class="op" id="4148608">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="4148611">func</span>&nbsp;<span class="ident" id="4148616">initP521</span><span class="op" id="4148624">(</span><span class="op" id="4148625">)</span>&nbsp;<span class="op" id="4148627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4148630">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148664">p521</span>&nbsp;<span class="op" id="4148669">=</span>&nbsp;<span class="builtinfunc" id="4148671">new</span><span class="op" id="4148674">(</span><span class="ident" id="4148675">CurveParams</span><span class="op" id="4148686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148689">p521</span><span class="op" id="4148693">.</span><span class="ident" id="4148694">P</span><span class="op" id="4148695">,</span>&nbsp;<span class="ident" id="4148697">_</span>&nbsp;<span class="op" id="4148699">=</span>&nbsp;<span class="builtinfunc" id="4148701">new</span><span class="op" id="4148704">(</span><span class="ident" id="4148705">big</span><span class="op" id="4148708">.</span><span class="ident" id="4148709">Int</span><span class="op" id="4148712">)</span><span class="op" id="4148713">.</span><span class="ident" id="4148714">SetString</span><span class="op" id="4148723">(</span><span class="string" id="4148724">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151&#34;</span><span class="op" id="4148883">,</span>&nbsp;<span class="num" id="4148885">10</span><span class="op" id="4148887">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4148890">p521</span><span class="op" id="4148894">.</span><span class="ident" id="4148895">N</span><span class="op" id="4148896">,</span>&nbsp;<span class="ident" id="4148898">_</span>&nbsp;<span class="op" id="4148900">=</span>&nbsp;<span class="builtinfunc" id="4148902">new</span><span class="op" id="4148905">(</span><span class="ident" id="4148906">big</span><span class="op" id="4148909">.</span><span class="ident" id="4148910">Int</span><span class="op" id="4148913">)</span><span class="op" id="4148914">.</span><span class="ident" id="4148915">SetString</span><span class="op" id="4148924">(</span><span class="string" id="4148925">&#34;6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449&#34;</span><span class="op" id="4149084">,</span>&nbsp;<span class="num" id="4149086">10</span><span class="op" id="4149088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149091">p521</span><span class="op" id="4149095">.</span><span class="ident" id="4149096">B</span><span class="op" id="4149097">,</span>&nbsp;<span class="ident" id="4149099">_</span>&nbsp;<span class="op" id="4149101">=</span>&nbsp;<span class="builtinfunc" id="4149103">new</span><span class="op" id="4149106">(</span><span class="ident" id="4149107">big</span><span class="op" id="4149110">.</span><span class="ident" id="4149111">Int</span><span class="op" id="4149114">)</span><span class="op" id="4149115">.</span><span class="ident" id="4149116">SetString</span><span class="op" id="4149125">(</span><span class="string" id="4149126">&#34;051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00&#34;</span><span class="op" id="4149259">,</span>&nbsp;<span class="num" id="4149261">16</span><span class="op" id="4149263">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149266">p521</span><span class="op" id="4149270">.</span><span class="ident" id="4149271">Gx</span><span class="op" id="4149273">,</span>&nbsp;<span class="ident" id="4149275">_</span>&nbsp;<span class="op" id="4149277">=</span>&nbsp;<span class="builtinfunc" id="4149279">new</span><span class="op" id="4149282">(</span><span class="ident" id="4149283">big</span><span class="op" id="4149286">.</span><span class="ident" id="4149287">Int</span><span class="op" id="4149290">)</span><span class="op" id="4149291">.</span><span class="ident" id="4149292">SetString</span><span class="op" id="4149301">(</span><span class="string" id="4149302">&#34;c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66&#34;</span><span class="op" id="4149434">,</span>&nbsp;<span class="num" id="4149436">16</span><span class="op" id="4149438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149441">p521</span><span class="op" id="4149445">.</span><span class="ident" id="4149446">Gy</span><span class="op" id="4149448">,</span>&nbsp;<span class="ident" id="4149450">_</span>&nbsp;<span class="op" id="4149452">=</span>&nbsp;<span class="builtinfunc" id="4149454">new</span><span class="op" id="4149457">(</span><span class="ident" id="4149458">big</span><span class="op" id="4149461">.</span><span class="ident" id="4149462">Int</span><span class="op" id="4149465">)</span><span class="op" id="4149466">.</span><span class="ident" id="4149467">SetString</span><span class="op" id="4149476">(</span><span class="string" id="4149477">&#34;11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650&#34;</span><span class="op" id="4149610">,</span>&nbsp;<span class="num" id="4149612">16</span><span class="op" id="4149614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149617">p521</span><span class="op" id="4149621">.</span><span class="ident" id="4149622">BitSize</span>&nbsp;<span class="op" id="4149630">=</span>&nbsp;<span class="num" id="4149632">521</span><br>
<span class="lineno">355</span><span class="op" id="4149636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4149639">//&nbsp;P256&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-256&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.3)</span><br>
<span class="lineno"></span><span class="keyword" id="4149718">func</span>&nbsp;<span class="ident" id="4149723">P256</span><span class="op" id="4149727">(</span><span class="op" id="4149728">)</span>&nbsp;<span class="ident" id="4149730">Curve</span>&nbsp;<span class="op" id="4149736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149739">initonce</span><span class="op" id="4149747">.</span><span class="ident" id="4149748">Do</span><span class="op" id="4149750">(</span><span class="ident" id="4149751">initAll</span><span class="op" id="4149758">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149761">return</span>&nbsp;<span class="ident" id="4149768">p256</span><br>
<span class="lineno"></span><span class="op" id="4149773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4149776">//&nbsp;P384&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-384&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.4)</span><br>
<span class="lineno"></span><span class="keyword" id="4149855">func</span>&nbsp;<span class="ident" id="4149860">P384</span><span class="op" id="4149864">(</span><span class="op" id="4149865">)</span>&nbsp;<span class="ident" id="4149867">Curve</span>&nbsp;<span class="op" id="4149873">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4149876">initonce</span><span class="op" id="4149884">.</span><span class="ident" id="4149885">Do</span><span class="op" id="4149887">(</span><span class="ident" id="4149888">initAll</span><span class="op" id="4149895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4149898">return</span>&nbsp;<span class="ident" id="4149905">p384</span><br>
<span class="lineno"></span><span class="op" id="4149910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4149913">//&nbsp;P521&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-521&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.5)</span><br>
<span class="lineno">370</span><span class="keyword" id="4149992">func</span>&nbsp;<span class="ident" id="4149997">P521</span><span class="op" id="4150001">(</span><span class="op" id="4150002">)</span>&nbsp;<span class="ident" id="4150004">Curve</span>&nbsp;<span class="op" id="4150010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4150013">initonce</span><span class="op" id="4150021">.</span><span class="ident" id="4150022">Do</span><span class="op" id="4150024">(</span><span class="ident" id="4150025">initAll</span><span class="op" id="4150032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4150035">return</span>&nbsp;<span class="ident" id="4150042">p521</span><br>
<span class="lineno"></span><span class="op" id="4150047">}</span>
</div>
</body>
</html>
