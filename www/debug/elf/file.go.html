<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4912854">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4912910">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4912964">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4913015">//&nbsp;Package&nbsp;elf&nbsp;implements&nbsp;access&nbsp;to&nbsp;ELF&nbsp;object&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="4913069">package</span>&nbsp;<span class="ident" id="4913077">elf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4913082">import</span>&nbsp;<span class="op" id="4913089">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913092">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913101">&#34;debug/dwarf&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913116">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913135">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913145">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913152">&#34;io&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4913158">&#34;os&#34;</span><br>
<span class="lineno"></span><span class="op" id="4913163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4913166">//&nbsp;TODO:&nbsp;error&nbsp;reporting&nbsp;detail</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4913199">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Internal&nbsp;ELF&nbsp;representation<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4913238">//&nbsp;A&nbsp;FileHeader&nbsp;represents&nbsp;an&nbsp;ELF&nbsp;file&nbsp;header.</span><br>
<span class="lineno">25</span><span class="keyword" id="4913285">type</span>&nbsp;<span class="ident" id="4913290">FileHeader</span>&nbsp;<span class="keyword" id="4913301">struct</span>&nbsp;<span class="op" id="4913308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913311">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913322"><a href="/debug/elf/elf.go.html#4851674">Class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913329">Data</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913340"><a href="/debug/elf/elf.go.html#4852177">Data</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913346">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913357"><a href="/debug/elf/elf.go.html#4851280">Version</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913366">OSABI</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913377"><a href="/debug/elf/elf.go.html#4852693">OSABI</a></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913384">ABIVersion</span>&nbsp;<span class="builtintype" id="4913395">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913402">ByteOrder</span>&nbsp;&nbsp;<span class="ident" id="4913413"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4913419">.</span><span class="ident" id="4913420">ByteOrder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913431">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913442"><a href="/debug/elf/elf.go.html#4854262">Type</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913448">Machine</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913459"><a href="/debug/elf/elf.go.html#4855167">Machine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913468">Entry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913479">uint64</span><br>
<span class="lineno">35</span><span class="op" id="4913486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4913489">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4913528">type</span>&nbsp;<span class="ident" id="4913533">File</span>&nbsp;<span class="keyword" id="4913538">struct</span>&nbsp;<span class="op" id="4913545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913548"><a href="/debug/elf/file.go.html#4913290">FileHeader</a></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913560">Sections</span>&nbsp;&nbsp;<span class="op" id="4913570">[</span><span class="op" id="4913571">]</span><span class="op" id="4913572">*</span><span class="ident" id="4913573"><a href="/debug/elf/file.go.html#4914005">Section</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913582">Progs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4913592">[</span><span class="op" id="4913593">]</span><span class="op" id="4913594">*</span><span class="ident" id="4913595"><a href="/debug/elf/file.go.html#4915266">Prog</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913601">closer</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913611"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4913613">.</span><span class="ident" id="4913614">Closer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913622">gnuNeed</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4913632">[</span><span class="op" id="4913633">]</span><span class="ident" id="4913634"><a href="/debug/elf/file.go.html#4932833">verneed</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913643">gnuVersym</span>&nbsp;<span class="op" id="4913653">[</span><span class="op" id="4913654">]</span><span class="builtintype" id="4913655">byte</span><br>
<span class="lineno">45</span><span class="op" id="4913660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4913663">//&nbsp;A&nbsp;SectionHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;section&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4913722">type</span>&nbsp;<span class="ident" id="4913727">SectionHeader</span>&nbsp;<span class="keyword" id="4913741">struct</span>&nbsp;<span class="op" id="4913748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913751">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4913761">string</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913769">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913779"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913792">Flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913802"><a href="/debug/elf/elf.go.html#4863330">SectionFlag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913815">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913825">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913833">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913843">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913851">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4913861">uint64</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913869">Link</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4913879">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913887">Info</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4913897">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913905">Addralign</span>&nbsp;<span class="ident" id="4913915">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4913923">Entsize</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4913933">uint64</span><br>
<span class="lineno"></span><span class="op" id="4913940">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4913943">//&nbsp;A&nbsp;Section&nbsp;represents&nbsp;a&nbsp;single&nbsp;section&nbsp;in&nbsp;an&nbsp;ELF&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4914000">type</span>&nbsp;<span class="ident" id="4914005">Section</span>&nbsp;<span class="keyword" id="4914013">struct</span>&nbsp;<span class="op" id="4914020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914023"><a href="/debug/elf/file.go.html#4913727">SectionHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914039">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914077">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914117">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914152">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914200">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4914250">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914274"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4914276">.</span><span class="ident" id="4914277">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914287">sr</span>&nbsp;<span class="op" id="4914290">*</span><span class="ident" id="4914291"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4914293">.</span><span class="ident" id="4914294">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4914308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="4914311">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4914370">func</span>&nbsp;<span class="op" id="4914375">(</span><span class="ident" id="4914376">s</span>&nbsp;<span class="op" id="4914378">*</span><span class="ident" id="4914379"><a href="/debug/elf/file.go.html#4914005">Section</a></span><span class="op" id="4914386">)</span>&nbsp;<span class="ident" id="4914388">Data</span><span class="op" id="4914392">(</span><span class="op" id="4914393">)</span>&nbsp;<span class="op" id="4914395">(</span><span class="op" id="4914396">[</span><span class="op" id="4914397">]</span><span class="builtintype" id="4914398">byte</span><span class="op" id="4914402">,</span>&nbsp;<span class="builtintype" id="4914404">error</span><span class="op" id="4914409">)</span>&nbsp;<span class="op" id="4914411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914414">dat</span>&nbsp;<span class="op" id="4914418">:=</span>&nbsp;<span class="builtinfunc" id="4914421">make</span><span class="op" id="4914425">(</span><span class="op" id="4914426">[</span><span class="op" id="4914427">]</span><span class="builtintype" id="4914428">byte</span><span class="op" id="4914432">,</span>&nbsp;<span class="ident" id="4914434"><a href="/debug/elf/file.go.html#4914376">s</a></span><span class="op" id="4914435">.</span><span class="ident" id="4914436">sr</span><span class="op" id="4914438">.</span><span class="ident" id="4914439">Size</span><span class="op" id="4914443">(</span><span class="op" id="4914444">)</span><span class="op" id="4914445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914448">n</span><span class="op" id="4914449">,</span>&nbsp;<span class="ident" id="4914451">err</span>&nbsp;<span class="op" id="4914455">:=</span>&nbsp;<span class="ident" id="4914458"><a href="/debug/elf/file.go.html#4914376">s</a></span><span class="op" id="4914459">.</span><span class="ident" id="4914460">sr</span><span class="op" id="4914462">.</span><span class="ident" id="4914463">ReadAt</span><span class="op" id="4914469">(</span><span class="ident" id="4914470"><a href="/debug/elf/file.go.html#4914414">dat</a></span><span class="op" id="4914473">,</span>&nbsp;<span class="num" id="4914475">0</span><span class="op" id="4914476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914479">if</span>&nbsp;<span class="ident" id="4914482"><a href="/debug/elf/file.go.html#4914448">n</a></span>&nbsp;<span class="op" id="4914484">==</span>&nbsp;<span class="builtinfunc" id="4914487">len</span><span class="op" id="4914490">(</span><span class="ident" id="4914491"><a href="/debug/elf/file.go.html#4914414">dat</a></span><span class="op" id="4914494">)</span>&nbsp;<span class="op" id="4914496">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4914500"><a href="/debug/elf/file.go.html#4914451">err</a></span>&nbsp;<span class="op" id="4914504">=</span>&nbsp;<span class="ident" id="4914506">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4914511">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914514">return</span>&nbsp;<span class="ident" id="4914521"><a href="/debug/elf/file.go.html#4914414">dat</a></span><span class="op" id="4914524">[</span><span class="num" id="4914525">0</span><span class="op" id="4914526">:</span><span class="ident" id="4914527"><a href="/debug/elf/file.go.html#4914448">n</a></span><span class="op" id="4914528">]</span><span class="op" id="4914529">,</span>&nbsp;<span class="ident" id="4914531"><a href="/debug/elf/file.go.html#4914451">err</a></span><br>
<span class="lineno"></span><span class="op" id="4914535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4914538">//&nbsp;stringTable&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;string&nbsp;table&nbsp;given&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4914601">//&nbsp;specified&nbsp;link&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4914626">func</span>&nbsp;<span class="op" id="4914631">(</span><span class="ident" id="4914632">f</span>&nbsp;<span class="op" id="4914634">*</span><span class="ident" id="4914635"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4914639">)</span>&nbsp;<span class="ident" id="4914641">stringTable</span><span class="op" id="4914652">(</span><span class="ident" id="4914653">link</span>&nbsp;<span class="builtintype" id="4914658">uint32</span><span class="op" id="4914664">)</span>&nbsp;<span class="op" id="4914666">(</span><span class="op" id="4914667">[</span><span class="op" id="4914668">]</span><span class="builtintype" id="4914669">byte</span><span class="op" id="4914673">,</span>&nbsp;<span class="builtintype" id="4914675">error</span><span class="op" id="4914680">)</span>&nbsp;<span class="op" id="4914682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914685">if</span>&nbsp;<span class="ident" id="4914688"><a href="/debug/elf/file.go.html#4914653">link</a></span>&nbsp;<span class="op" id="4914693">&lt;=</span>&nbsp;<span class="num" id="4914696">0</span>&nbsp;<span class="op" id="4914698">||</span>&nbsp;<span class="ident" id="4914701"><a href="/debug/elf/file.go.html#4914653">link</a></span>&nbsp;<span class="op" id="4914706">&gt;=</span>&nbsp;<span class="builtintype" id="4914709">uint32</span><span class="op" id="4914715">(</span><span class="builtinfunc" id="4914716">len</span><span class="op" id="4914719">(</span><span class="ident" id="4914720"><a href="/debug/elf/file.go.html#4914632">f</a></span><span class="op" id="4914721">.</span><span class="ident" id="4914722">Sections</span><span class="op" id="4914730">)</span><span class="op" id="4914731">)</span>&nbsp;<span class="op" id="4914733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914737">return</span>&nbsp;<span class="ident" id="4914744">nil</span><span class="op" id="4914747">,</span>&nbsp;<span class="ident" id="4914749"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4914755">.</span><span class="ident" id="4914756">New</span><span class="op" id="4914759">(</span><span class="string" id="4914760">&#34;section&nbsp;has&nbsp;invalid&nbsp;string&nbsp;table&nbsp;link&#34;</span><span class="op" id="4914799">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4914802">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4914805">return</span>&nbsp;<span class="ident" id="4914812"><a href="/debug/elf/file.go.html#4914632">f</a></span><span class="op" id="4914813">.</span><span class="ident" id="4914814">Sections</span><span class="op" id="4914822">[</span><span class="ident" id="4914823"><a href="/debug/elf/file.go.html#4914653">link</a></span><span class="op" id="4914827">]</span><span class="op" id="4914828">.</span><span class="ident" id="4914829">Data</span><span class="op" id="4914833">(</span><span class="op" id="4914834">)</span><br>
<span class="lineno"></span><span class="op" id="4914836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4914839">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;section.</span><br>
<span class="lineno">95</span><span class="keyword" id="4914897">func</span>&nbsp;<span class="op" id="4914902">(</span><span class="ident" id="4914903">s</span>&nbsp;<span class="op" id="4914905">*</span><span class="ident" id="4914906"><a href="/debug/elf/file.go.html#4914005">Section</a></span><span class="op" id="4914913">)</span>&nbsp;<span class="ident" id="4914915">Open</span><span class="op" id="4914919">(</span><span class="op" id="4914920">)</span>&nbsp;<span class="ident" id="4914922"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4914924">.</span><span class="ident" id="4914925">ReadSeeker</span>&nbsp;<span class="op" id="4914936">{</span>&nbsp;<span class="keyword" id="4914938">return</span>&nbsp;<span class="ident" id="4914945"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4914947">.</span><span class="ident" id="4914948">NewSectionReader</span><span class="op" id="4914964">(</span><span class="ident" id="4914965"><a href="/debug/elf/file.go.html#4914903">s</a></span><span class="op" id="4914966">.</span><span class="ident" id="4914967">sr</span><span class="op" id="4914969">,</span>&nbsp;<span class="num" id="4914971">0</span><span class="op" id="4914972">,</span>&nbsp;<span class="num" id="4914974">1</span><span class="op" id="4914975">&lt;&lt;</span><span class="num" id="4914977">63</span><span class="op" id="4914979">-</span><span class="num" id="4914980">1</span><span class="op" id="4914981">)</span>&nbsp;<span class="op" id="4914983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4914986">//&nbsp;A&nbsp;ProgHeader&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4915042">type</span>&nbsp;<span class="ident" id="4915047">ProgHeader</span>&nbsp;<span class="keyword" id="4915058">struct</span>&nbsp;<span class="op" id="4915065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915068">Type</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4915075"><a href="/debug/elf/elf.go.html#4864803">ProgType</a></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915085">Flags</span>&nbsp;&nbsp;<span class="ident" id="4915092"><a href="/debug/elf/elf.go.html#4866079">ProgFlag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915102">Off</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4915109">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915117">Vaddr</span>&nbsp;&nbsp;<span class="ident" id="4915124">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915132">Paddr</span>&nbsp;&nbsp;<span class="ident" id="4915139">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915147">Filesz</span>&nbsp;<span class="ident" id="4915154">uint64</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915162">Memsz</span>&nbsp;&nbsp;<span class="ident" id="4915169">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915177">Align</span>&nbsp;&nbsp;<span class="ident" id="4915184">uint64</span><br>
<span class="lineno"></span><span class="op" id="4915191">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915194">//&nbsp;A&nbsp;Prog&nbsp;represents&nbsp;a&nbsp;single&nbsp;ELF&nbsp;program&nbsp;header&nbsp;in&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno">110</span><span class="keyword" id="4915261">type</span>&nbsp;<span class="ident" id="4915266">Prog</span>&nbsp;<span class="keyword" id="4915271">struct</span>&nbsp;<span class="op" id="4915278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915281"><a href="/debug/elf/file.go.html#4915047">ProgHeader</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915294">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915332">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915372">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915407">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915455">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4915505">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915529"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4915531">.</span><span class="ident" id="4915532">ReaderAt</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915542">sr</span>&nbsp;<span class="op" id="4915545">*</span><span class="ident" id="4915546"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4915548">.</span><span class="ident" id="4915549">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="4915563">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915566">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;ELF&nbsp;program&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4915629">func</span>&nbsp;<span class="op" id="4915634">(</span><span class="ident" id="4915635">p</span>&nbsp;<span class="op" id="4915637">*</span><span class="ident" id="4915638"><a href="/debug/elf/file.go.html#4915266">Prog</a></span><span class="op" id="4915642">)</span>&nbsp;<span class="ident" id="4915644">Open</span><span class="op" id="4915648">(</span><span class="op" id="4915649">)</span>&nbsp;<span class="ident" id="4915651"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4915653">.</span><span class="ident" id="4915654">ReadSeeker</span>&nbsp;<span class="op" id="4915665">{</span>&nbsp;<span class="keyword" id="4915667">return</span>&nbsp;<span class="ident" id="4915674"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4915676">.</span><span class="ident" id="4915677">NewSectionReader</span><span class="op" id="4915693">(</span><span class="ident" id="4915694"><a href="/debug/elf/file.go.html#4915635">p</a></span><span class="op" id="4915695">.</span><span class="ident" id="4915696">sr</span><span class="op" id="4915698">,</span>&nbsp;<span class="num" id="4915700">0</span><span class="op" id="4915701">,</span>&nbsp;<span class="num" id="4915703">1</span><span class="op" id="4915704">&lt;&lt;</span><span class="num" id="4915706">63</span><span class="op" id="4915708">-</span><span class="num" id="4915709">1</span><span class="op" id="4915710">)</span>&nbsp;<span class="op" id="4915712">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4915715">//&nbsp;A&nbsp;Symbol&nbsp;represents&nbsp;an&nbsp;entry&nbsp;in&nbsp;an&nbsp;ELF&nbsp;symbol&nbsp;table&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4915779">type</span>&nbsp;<span class="ident" id="4915784">Symbol</span>&nbsp;<span class="keyword" id="4915791">struct</span>&nbsp;<span class="op" id="4915798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915801">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4915813">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915821">Info</span><span class="op" id="4915825">,</span>&nbsp;<span class="ident" id="4915827">Other</span>&nbsp;<span class="builtintype" id="4915833">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915839">Section</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4915851"><a href="/debug/elf/elf.go.html#4859054">SectionIndex</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915865">Value</span><span class="op" id="4915870">,</span>&nbsp;<span class="ident" id="4915872">Size</span>&nbsp;<span class="ident" id="4915877">uint64</span><br>
<span class="lineno"></span><span class="op" id="4915884">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4915887">/*<br>
<span class="lineno">135</span>&nbsp;*&nbsp;ELF&nbsp;reader<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4915909">type</span>&nbsp;<span class="ident" id="4915914">FormatError</span>&nbsp;<span class="keyword" id="4915926">struct</span>&nbsp;<span class="op" id="4915933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915936">off</span>&nbsp;<span class="ident" id="4915940">int64</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915947">msg</span>&nbsp;<span class="builtintype" id="4915951">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4915959">val</span>&nbsp;<span class="keyword" id="4915963">interface</span><span class="op" id="4915972">{</span><span class="op" id="4915973">}</span><br>
<span class="lineno"></span><span class="op" id="4915975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4915978">func</span>&nbsp;<span class="op" id="4915983">(</span><span class="ident" id="4915984">e</span>&nbsp;<span class="op" id="4915986">*</span><span class="ident" id="4915987"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4915998">)</span>&nbsp;<span class="ident" id="4916000">Error</span><span class="op" id="4916005">(</span><span class="op" id="4916006">)</span>&nbsp;<span class="builtintype" id="4916008">string</span>&nbsp;<span class="op" id="4916015">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916018">msg</span>&nbsp;<span class="op" id="4916022">:=</span>&nbsp;<span class="ident" id="4916025"><a href="/debug/elf/file.go.html#4915984">e</a></span><span class="op" id="4916026">.</span><span class="ident" id="4916027">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916032">if</span>&nbsp;<span class="ident" id="4916035"><a href="/debug/elf/file.go.html#4915984">e</a></span><span class="op" id="4916036">.</span><span class="ident" id="4916037">val</span>&nbsp;<span class="op" id="4916041">!=</span>&nbsp;<span class="ident" id="4916044">nil</span>&nbsp;<span class="op" id="4916048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916052"><a href="/debug/elf/file.go.html#4916018">msg</a></span>&nbsp;<span class="op" id="4916056">+=</span>&nbsp;<span class="ident" id="4916059"><a href="/debug/elf/file.go.html#4913145">fmt</a></span><span class="op" id="4916062">.</span><span class="ident" id="4916063">Sprintf</span><span class="op" id="4916070">(</span><span class="string" id="4916071">&#34;&nbsp;&#39;%v&#39;&nbsp;&#34;</span><span class="op" id="4916079">,</span>&nbsp;<span class="ident" id="4916081"><a href="/debug/elf/file.go.html#4915984">e</a></span><span class="op" id="4916082">.</span><span class="ident" id="4916083">val</span><span class="op" id="4916086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916092"><a href="/debug/elf/file.go.html#4916018">msg</a></span>&nbsp;<span class="op" id="4916096">+=</span>&nbsp;<span class="ident" id="4916099"><a href="/debug/elf/file.go.html#4913145">fmt</a></span><span class="op" id="4916102">.</span><span class="ident" id="4916103">Sprintf</span><span class="op" id="4916110">(</span><span class="string" id="4916111">&#34;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="4916134">,</span>&nbsp;<span class="ident" id="4916136"><a href="/debug/elf/file.go.html#4915984">e</a></span><span class="op" id="4916137">.</span><span class="ident" id="4916138">off</span><span class="op" id="4916141">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916144">return</span>&nbsp;<span class="ident" id="4916151"><a href="/debug/elf/file.go.html#4916018">msg</a></span><br>
<span class="lineno"></span><span class="op" id="4916155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4916158">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;an&nbsp;ELF&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="4916243">func</span>&nbsp;<span class="ident" id="4916248">Open</span><span class="op" id="4916252">(</span><span class="ident" id="4916253">name</span>&nbsp;<span class="builtintype" id="4916258">string</span><span class="op" id="4916264">)</span>&nbsp;<span class="op" id="4916266">(</span><span class="op" id="4916267">*</span><span class="ident" id="4916268"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4916272">,</span>&nbsp;<span class="builtintype" id="4916274">error</span><span class="op" id="4916279">)</span>&nbsp;<span class="op" id="4916281">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916284">f</span><span class="op" id="4916285">,</span>&nbsp;<span class="ident" id="4916287">err</span>&nbsp;<span class="op" id="4916291">:=</span>&nbsp;<span class="ident" id="4916294"><a href="/debug/elf/file.go.html#4913158">os</a></span><span class="op" id="4916296">.</span><span class="ident" id="4916297">Open</span><span class="op" id="4916301">(</span><span class="ident" id="4916302"><a href="/debug/elf/file.go.html#4916253">name</a></span><span class="op" id="4916306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916309">if</span>&nbsp;<span class="ident" id="4916312"><a href="/debug/elf/file.go.html#4916287">err</a></span>&nbsp;<span class="op" id="4916316">!=</span>&nbsp;<span class="ident" id="4916319">nil</span>&nbsp;<span class="op" id="4916323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916327">return</span>&nbsp;<span class="ident" id="4916334">nil</span><span class="op" id="4916337">,</span>&nbsp;<span class="ident" id="4916339"><a href="/debug/elf/file.go.html#4916287">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916347">ff</span><span class="op" id="4916349">,</span>&nbsp;<span class="ident" id="4916351"><a href="/debug/elf/file.go.html#4916287">err</a></span>&nbsp;<span class="op" id="4916355">:=</span>&nbsp;<span class="ident" id="4916358"><a href="/debug/elf/file.go.html#4917108">NewFile</a></span><span class="op" id="4916365">(</span><span class="ident" id="4916366"><a href="/debug/elf/file.go.html#4916284">f</a></span><span class="op" id="4916367">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916370">if</span>&nbsp;<span class="ident" id="4916373"><a href="/debug/elf/file.go.html#4916287">err</a></span>&nbsp;<span class="op" id="4916377">!=</span>&nbsp;<span class="ident" id="4916380">nil</span>&nbsp;<span class="op" id="4916384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916388"><a href="/debug/elf/file.go.html#4916284">f</a></span><span class="op" id="4916389">.</span><span class="ident" id="4916390">Close</span><span class="op" id="4916395">(</span><span class="op" id="4916396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916400">return</span>&nbsp;<span class="ident" id="4916407">nil</span><span class="op" id="4916410">,</span>&nbsp;<span class="ident" id="4916412"><a href="/debug/elf/file.go.html#4916287">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916420"><a href="/debug/elf/file.go.html#4916347">ff</a></span><span class="op" id="4916422">.</span><span class="ident" id="4916423">closer</span>&nbsp;<span class="op" id="4916430">=</span>&nbsp;<span class="ident" id="4916432"><a href="/debug/elf/file.go.html#4916284">f</a></span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916435">return</span>&nbsp;<span class="ident" id="4916442"><a href="/debug/elf/file.go.html#4916347">ff</a></span><span class="op" id="4916444">,</span>&nbsp;<span class="ident" id="4916446">nil</span><br>
<span class="lineno"></span><span class="op" id="4916450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4916453">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="4916479">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno">170</span><span class="comment" id="4916546">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="4916570">func</span>&nbsp;<span class="op" id="4916575">(</span><span class="ident" id="4916576">f</span>&nbsp;<span class="op" id="4916578">*</span><span class="ident" id="4916579"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4916583">)</span>&nbsp;<span class="ident" id="4916585">Close</span><span class="op" id="4916590">(</span><span class="op" id="4916591">)</span>&nbsp;<span class="builtintype" id="4916593">error</span>&nbsp;<span class="op" id="4916599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916602">var</span>&nbsp;<span class="ident" id="4916606">err</span>&nbsp;<span class="builtintype" id="4916610">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916617">if</span>&nbsp;<span class="ident" id="4916620"><a href="/debug/elf/file.go.html#4916576">f</a></span><span class="op" id="4916621">.</span><span class="ident" id="4916622">closer</span>&nbsp;<span class="op" id="4916629">!=</span>&nbsp;<span class="ident" id="4916632">nil</span>&nbsp;<span class="op" id="4916636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916640"><a href="/debug/elf/file.go.html#4916606">err</a></span>&nbsp;<span class="op" id="4916644">=</span>&nbsp;<span class="ident" id="4916646"><a href="/debug/elf/file.go.html#4916576">f</a></span><span class="op" id="4916647">.</span><span class="ident" id="4916648">closer</span><span class="op" id="4916654">.</span><span class="ident" id="4916655">Close</span><span class="op" id="4916660">(</span><span class="op" id="4916661">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4916665"><a href="/debug/elf/file.go.html#4916576">f</a></span><span class="op" id="4916666">.</span><span class="ident" id="4916667">closer</span>&nbsp;<span class="op" id="4916674">=</span>&nbsp;<span class="ident" id="4916676">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916684">return</span>&nbsp;<span class="ident" id="4916691"><a href="/debug/elf/file.go.html#4916606">err</a></span><br>
<span class="lineno"></span><span class="op" id="4916695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="4916698">//&nbsp;SectionByType&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;in&nbsp;f&nbsp;with&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4916755">//&nbsp;given&nbsp;type,&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="4916806">func</span>&nbsp;<span class="op" id="4916811">(</span><span class="ident" id="4916812">f</span>&nbsp;<span class="op" id="4916814">*</span><span class="ident" id="4916815"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4916819">)</span>&nbsp;<span class="ident" id="4916821">SectionByType</span><span class="op" id="4916834">(</span><span class="ident" id="4916835">typ</span>&nbsp;<span class="ident" id="4916839"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4916850">)</span>&nbsp;<span class="op" id="4916852">*</span><span class="ident" id="4916853"><a href="/debug/elf/file.go.html#4914005">Section</a></span>&nbsp;<span class="op" id="4916861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916864">for</span>&nbsp;<span class="ident" id="4916868">_</span><span class="op" id="4916869">,</span>&nbsp;<span class="ident" id="4916871">s</span>&nbsp;<span class="op" id="4916873">:=</span>&nbsp;<span class="keyword" id="4916876">range</span>&nbsp;<span class="ident" id="4916882"><a href="/debug/elf/file.go.html#4916812">f</a></span><span class="op" id="4916883">.</span><span class="ident" id="4916884">Sections</span>&nbsp;<span class="op" id="4916893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916897">if</span>&nbsp;<span class="ident" id="4916900"><a href="/debug/elf/file.go.html#4916871">s</a></span><span class="op" id="4916901">.</span><span class="ident" id="4916902">Type</span>&nbsp;<span class="op" id="4916907">==</span>&nbsp;<span class="ident" id="4916910"><a href="/debug/elf/file.go.html#4916835">typ</a></span>&nbsp;<span class="op" id="4916914">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916919">return</span>&nbsp;<span class="ident" id="4916926"><a href="/debug/elf/file.go.html#4916871">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4916933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4916936">return</span>&nbsp;<span class="ident" id="4916943">nil</span><br>
<span class="lineno"></span><span class="op" id="4916947">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4916950">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;an&nbsp;ELF&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="comment" id="4917033">//&nbsp;The&nbsp;ELF&nbsp;binary&nbsp;is&nbsp;expected&nbsp;to&nbsp;start&nbsp;at&nbsp;position&nbsp;0&nbsp;in&nbsp;the&nbsp;ReaderAt.</span><br>
<span class="lineno"></span><span class="keyword" id="4917103">func</span>&nbsp;<span class="ident" id="4917108">NewFile</span><span class="op" id="4917115">(</span><span class="ident" id="4917116">r</span>&nbsp;<span class="ident" id="4917118"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4917120">.</span><span class="ident" id="4917121">ReaderAt</span><span class="op" id="4917129">)</span>&nbsp;<span class="op" id="4917131">(</span><span class="op" id="4917132">*</span><span class="ident" id="4917133"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4917137">,</span>&nbsp;<span class="builtintype" id="4917139">error</span><span class="op" id="4917144">)</span>&nbsp;<span class="op" id="4917146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917149">sr</span>&nbsp;<span class="op" id="4917152">:=</span>&nbsp;<span class="ident" id="4917155"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4917157">.</span><span class="ident" id="4917158">NewSectionReader</span><span class="op" id="4917174">(</span><span class="ident" id="4917175"><a href="/debug/elf/file.go.html#4917116">r</a></span><span class="op" id="4917176">,</span>&nbsp;<span class="num" id="4917178">0</span><span class="op" id="4917179">,</span>&nbsp;<span class="num" id="4917181">1</span><span class="op" id="4917182">&lt;&lt;</span><span class="num" id="4917184">63</span><span class="op" id="4917186">-</span><span class="num" id="4917187">1</span><span class="op" id="4917188">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917191">//&nbsp;Read&nbsp;and&nbsp;decode&nbsp;ELF&nbsp;identifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917226">var</span>&nbsp;<span class="ident" id="4917230">ident</span>&nbsp;<span class="op" id="4917236">[</span><span class="num" id="4917237">16</span><span class="op" id="4917239">]</span><span class="builtintype" id="4917240">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917247">if</span>&nbsp;<span class="ident" id="4917250">_</span><span class="op" id="4917251">,</span>&nbsp;<span class="ident" id="4917253">err</span>&nbsp;<span class="op" id="4917257">:=</span>&nbsp;<span class="ident" id="4917260"><a href="/debug/elf/file.go.html#4917116">r</a></span><span class="op" id="4917261">.</span><span class="ident" id="4917262">ReadAt</span><span class="op" id="4917268">(</span><span class="ident" id="4917269"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917274">[</span><span class="num" id="4917275">0</span><span class="op" id="4917276">:</span><span class="op" id="4917277">]</span><span class="op" id="4917278">,</span>&nbsp;<span class="num" id="4917280">0</span><span class="op" id="4917281">)</span><span class="op" id="4917282">;</span>&nbsp;<span class="ident" id="4917284"><a href="/debug/elf/file.go.html#4917253">err</a></span>&nbsp;<span class="op" id="4917288">!=</span>&nbsp;<span class="ident" id="4917291">nil</span>&nbsp;<span class="op" id="4917295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917299">return</span>&nbsp;<span class="ident" id="4917306">nil</span><span class="op" id="4917309">,</span>&nbsp;<span class="ident" id="4917311"><a href="/debug/elf/file.go.html#4917253">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917316">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917319">if</span>&nbsp;<span class="ident" id="4917322"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917327">[</span><span class="num" id="4917328">0</span><span class="op" id="4917329">]</span>&nbsp;<span class="op" id="4917331">!=</span>&nbsp;<span class="string" id="4917334">&#39;\x7f&#39;</span>&nbsp;<span class="op" id="4917341">||</span>&nbsp;<span class="ident" id="4917344"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917349">[</span><span class="num" id="4917350">1</span><span class="op" id="4917351">]</span>&nbsp;<span class="op" id="4917353">!=</span>&nbsp;<span class="string" id="4917356">&#39;E&#39;</span>&nbsp;<span class="op" id="4917360">||</span>&nbsp;<span class="ident" id="4917363"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917368">[</span><span class="num" id="4917369">2</span><span class="op" id="4917370">]</span>&nbsp;<span class="op" id="4917372">!=</span>&nbsp;<span class="string" id="4917375">&#39;L&#39;</span>&nbsp;<span class="op" id="4917379">||</span>&nbsp;<span class="ident" id="4917382"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917387">[</span><span class="num" id="4917388">3</span><span class="op" id="4917389">]</span>&nbsp;<span class="op" id="4917391">!=</span>&nbsp;<span class="string" id="4917394">&#39;F&#39;</span>&nbsp;<span class="op" id="4917398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917402">return</span>&nbsp;<span class="ident" id="4917409">nil</span><span class="op" id="4917412">,</span>&nbsp;<span class="op" id="4917414">&amp;</span><span class="ident" id="4917415"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4917426">{</span><span class="num" id="4917427">0</span><span class="op" id="4917428">,</span>&nbsp;<span class="string" id="4917430">&#34;bad&nbsp;magic&nbsp;number&#34;</span><span class="op" id="4917448">,</span>&nbsp;<span class="ident" id="4917450"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917455">[</span><span class="num" id="4917456">0</span><span class="op" id="4917457">:</span><span class="num" id="4917458">4</span><span class="op" id="4917459">]</span><span class="op" id="4917460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917467">f</span>&nbsp;<span class="op" id="4917469">:=</span>&nbsp;<span class="builtinfunc" id="4917472">new</span><span class="op" id="4917475">(</span><span class="ident" id="4917476"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4917480">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917483"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917484">.</span><span class="ident" id="4917485">Class</span>&nbsp;<span class="op" id="4917491">=</span>&nbsp;<span class="ident" id="4917493"><a href="/debug/elf/elf.go.html#4851674">Class</a></span><span class="op" id="4917498">(</span><span class="ident" id="4917499"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917504">[</span><span class="ident" id="4917505"><a href="/debug/elf/elf.go.html#4850801">EI_CLASS</a></span><span class="op" id="4917513">]</span><span class="op" id="4917514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917517">switch</span>&nbsp;<span class="ident" id="4917524"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917525">.</span><span class="ident" id="4917526">Class</span>&nbsp;<span class="op" id="4917532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917535">case</span>&nbsp;<span class="ident" id="4917540"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4917550">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917553">case</span>&nbsp;<span class="ident" id="4917558"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4917568">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4917572">//&nbsp;ok</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917579">default</span><span class="op" id="4917586">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917590">return</span>&nbsp;<span class="ident" id="4917597">nil</span><span class="op" id="4917600">,</span>&nbsp;<span class="op" id="4917602">&amp;</span><span class="ident" id="4917603"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4917614">{</span><span class="num" id="4917615">0</span><span class="op" id="4917616">,</span>&nbsp;<span class="string" id="4917618">&#34;unknown&nbsp;ELF&nbsp;class&#34;</span><span class="op" id="4917637">,</span>&nbsp;<span class="ident" id="4917639"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917640">.</span><span class="ident" id="4917641">Class</span><span class="op" id="4917646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917653"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917654">.</span><span class="ident" id="4917655">Data</span>&nbsp;<span class="op" id="4917660">=</span>&nbsp;<span class="ident" id="4917662"><a href="/debug/elf/elf.go.html#4852177">Data</a></span><span class="op" id="4917666">(</span><span class="ident" id="4917667"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917672">[</span><span class="ident" id="4917673"><a href="/debug/elf/elf.go.html#4850845">EI_DATA</a></span><span class="op" id="4917680">]</span><span class="op" id="4917681">)</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917684">switch</span>&nbsp;<span class="ident" id="4917691"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917692">.</span><span class="ident" id="4917693">Data</span>&nbsp;<span class="op" id="4917698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917701">case</span>&nbsp;<span class="ident" id="4917706"><a href="/debug/elf/elf.go.html#4852246">ELFDATA2LSB</a></span><span class="op" id="4917717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917721"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917722">.</span><span class="ident" id="4917723">ByteOrder</span>&nbsp;<span class="op" id="4917733">=</span>&nbsp;<span class="ident" id="4917735"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4917741">.</span><span class="ident" id="4917742">LittleEndian</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917756">case</span>&nbsp;<span class="ident" id="4917761"><a href="/debug/elf/elf.go.html#4852304">ELFDATA2MSB</a></span><span class="op" id="4917772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917776"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917777">.</span><span class="ident" id="4917778">ByteOrder</span>&nbsp;<span class="op" id="4917788">=</span>&nbsp;<span class="ident" id="4917790"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4917796">.</span><span class="ident" id="4917797">BigEndian</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917808">default</span><span class="op" id="4917815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917819">return</span>&nbsp;<span class="ident" id="4917826">nil</span><span class="op" id="4917829">,</span>&nbsp;<span class="op" id="4917831">&amp;</span><span class="ident" id="4917832"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4917843">{</span><span class="num" id="4917844">0</span><span class="op" id="4917845">,</span>&nbsp;<span class="string" id="4917847">&#34;unknown&nbsp;ELF&nbsp;data&nbsp;encoding&#34;</span><span class="op" id="4917874">,</span>&nbsp;<span class="ident" id="4917876"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917877">.</span><span class="ident" id="4917878">Data</span><span class="op" id="4917882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4917885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4917889"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917890">.</span><span class="ident" id="4917891">Version</span>&nbsp;<span class="op" id="4917899">=</span>&nbsp;<span class="ident" id="4917901"><a href="/debug/elf/elf.go.html#4851280">Version</a></span><span class="op" id="4917908">(</span><span class="ident" id="4917909"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4917914">[</span><span class="ident" id="4917915"><a href="/debug/elf/elf.go.html#4850884">EI_VERSION</a></span><span class="op" id="4917925">]</span><span class="op" id="4917926">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917929">if</span>&nbsp;<span class="ident" id="4917932"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4917933">.</span><span class="ident" id="4917934">Version</span>&nbsp;<span class="op" id="4917942">!=</span>&nbsp;<span class="ident" id="4917945"><a href="/debug/elf/elf.go.html#4851327">EV_CURRENT</a></span>&nbsp;<span class="op" id="4917956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4917960">return</span>&nbsp;<span class="ident" id="4917967">nil</span><span class="op" id="4917970">,</span>&nbsp;<span class="op" id="4917972">&amp;</span><span class="ident" id="4917973"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4917984">{</span><span class="num" id="4917985">0</span><span class="op" id="4917986">,</span>&nbsp;<span class="string" id="4917988">&#34;unknown&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4918009">,</span>&nbsp;<span class="ident" id="4918011"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918012">.</span><span class="ident" id="4918013">Version</span><span class="op" id="4918020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4918023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918027"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918028">.</span><span class="ident" id="4918029">OSABI</span>&nbsp;<span class="op" id="4918035">=</span>&nbsp;<span class="ident" id="4918037"><a href="/debug/elf/elf.go.html#4852693">OSABI</a></span><span class="op" id="4918042">(</span><span class="ident" id="4918043"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4918048">[</span><span class="ident" id="4918049"><a href="/debug/elf/elf.go.html#4850930">EI_OSABI</a></span><span class="op" id="4918057">]</span><span class="op" id="4918058">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918061"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918062">.</span><span class="ident" id="4918063">ABIVersion</span>&nbsp;<span class="op" id="4918074">=</span>&nbsp;<span class="ident" id="4918076"><a href="/debug/elf/file.go.html#4917230">ident</a></span><span class="op" id="4918081">[</span><span class="ident" id="4918082"><a href="/debug/elf/elf.go.html#4850994">EI_ABIVERSION</a></span><span class="op" id="4918095">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4918099">//&nbsp;Read&nbsp;ELF&nbsp;file&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918124">var</span>&nbsp;<span class="ident" id="4918128">phoff</span>&nbsp;<span class="ident" id="4918134">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918141">var</span>&nbsp;<span class="ident" id="4918145">phentsize</span><span class="op" id="4918154">,</span>&nbsp;<span class="ident" id="4918156">phnum</span>&nbsp;<span class="builtintype" id="4918162">int</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918167">var</span>&nbsp;<span class="ident" id="4918171">shoff</span>&nbsp;<span class="ident" id="4918177">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918184">var</span>&nbsp;<span class="ident" id="4918188">shentsize</span><span class="op" id="4918197">,</span>&nbsp;<span class="ident" id="4918199">shnum</span><span class="op" id="4918204">,</span>&nbsp;<span class="ident" id="4918206">shstrndx</span>&nbsp;<span class="builtintype" id="4918215">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918220"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span>&nbsp;<span class="op" id="4918229">=</span>&nbsp;<span class="op" id="4918231">-</span><span class="num" id="4918232">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918235">switch</span>&nbsp;<span class="ident" id="4918242"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918243">.</span><span class="ident" id="4918244">Class</span>&nbsp;<span class="op" id="4918250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918253">case</span>&nbsp;<span class="ident" id="4918258"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4918268">:</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918272">hdr</span>&nbsp;<span class="op" id="4918276">:=</span>&nbsp;<span class="builtinfunc" id="4918279">new</span><span class="op" id="4918282">(</span><span class="ident" id="4918283"><a href="/debug/elf/elf.go.html#4905945">Header32</a></span><span class="op" id="4918291">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918295"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4918297">.</span><span class="ident" id="4918298">Seek</span><span class="op" id="4918302">(</span><span class="num" id="4918303">0</span><span class="op" id="4918304">,</span>&nbsp;<span class="ident" id="4918306"><a href="/debug/elf/file.go.html#4913158">os</a></span><span class="op" id="4918308">.</span><span class="ident" id="4918309">SEEK_SET</span><span class="op" id="4918317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918321">if</span>&nbsp;<span class="ident" id="4918324">err</span>&nbsp;<span class="op" id="4918328">:=</span>&nbsp;<span class="ident" id="4918331"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4918337">.</span><span class="ident" id="4918338">Read</span><span class="op" id="4918342">(</span><span class="ident" id="4918343"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4918345">,</span>&nbsp;<span class="ident" id="4918347"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918348">.</span><span class="ident" id="4918349">ByteOrder</span><span class="op" id="4918358">,</span>&nbsp;<span class="ident" id="4918360"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918363">)</span><span class="op" id="4918364">;</span>&nbsp;<span class="ident" id="4918366"><a href="/debug/elf/file.go.html#4918324">err</a></span>&nbsp;<span class="op" id="4918370">!=</span>&nbsp;<span class="ident" id="4918373">nil</span>&nbsp;<span class="op" id="4918377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918382">return</span>&nbsp;<span class="ident" id="4918389">nil</span><span class="op" id="4918392">,</span>&nbsp;<span class="ident" id="4918394"><a href="/debug/elf/file.go.html#4918324">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4918400">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918404"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918405">.</span><span class="ident" id="4918406">Type</span>&nbsp;<span class="op" id="4918411">=</span>&nbsp;<span class="ident" id="4918413"><a href="/debug/elf/elf.go.html#4854262">Type</a></span><span class="op" id="4918417">(</span><span class="ident" id="4918418"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918421">.</span><span class="ident" id="4918422">Type</span><span class="op" id="4918426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918430"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918431">.</span><span class="ident" id="4918432">Machine</span>&nbsp;<span class="op" id="4918440">=</span>&nbsp;<span class="ident" id="4918442"><a href="/debug/elf/elf.go.html#4855167">Machine</a></span><span class="op" id="4918449">(</span><span class="ident" id="4918450"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918453">.</span><span class="ident" id="4918454">Machine</span><span class="op" id="4918461">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918465"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918466">.</span><span class="ident" id="4918467">Entry</span>&nbsp;<span class="op" id="4918473">=</span>&nbsp;<span class="ident" id="4918475">uint64</span><span class="op" id="4918481">(</span><span class="ident" id="4918482"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918485">.</span><span class="ident" id="4918486">Entry</span><span class="op" id="4918491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918495">if</span>&nbsp;<span class="ident" id="4918498">v</span>&nbsp;<span class="op" id="4918500">:=</span>&nbsp;<span class="ident" id="4918503"><a href="/debug/elf/elf.go.html#4851280">Version</a></span><span class="op" id="4918510">(</span><span class="ident" id="4918511"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918514">.</span><span class="ident" id="4918515">Version</span><span class="op" id="4918522">)</span><span class="op" id="4918523">;</span>&nbsp;<span class="ident" id="4918525"><a href="/debug/elf/file.go.html#4918498">v</a></span>&nbsp;<span class="op" id="4918527">!=</span>&nbsp;<span class="ident" id="4918530"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918531">.</span><span class="ident" id="4918532">Version</span>&nbsp;<span class="op" id="4918540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918545">return</span>&nbsp;<span class="ident" id="4918552">nil</span><span class="op" id="4918555">,</span>&nbsp;<span class="op" id="4918557">&amp;</span><span class="ident" id="4918558"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4918569">{</span><span class="num" id="4918570">0</span><span class="op" id="4918571">,</span>&nbsp;<span class="string" id="4918573">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4918597">,</span>&nbsp;<span class="ident" id="4918599"><a href="/debug/elf/file.go.html#4918498">v</a></span><span class="op" id="4918600">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4918604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918608"><a href="/debug/elf/file.go.html#4918128">phoff</a></span>&nbsp;<span class="op" id="4918614">=</span>&nbsp;<span class="ident" id="4918616">int64</span><span class="op" id="4918621">(</span><span class="ident" id="4918622"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918625">.</span><span class="ident" id="4918626">Phoff</span><span class="op" id="4918631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918635"><a href="/debug/elf/file.go.html#4918145">phentsize</a></span>&nbsp;<span class="op" id="4918645">=</span>&nbsp;<span class="builtintype" id="4918647">int</span><span class="op" id="4918650">(</span><span class="ident" id="4918651"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918654">.</span><span class="ident" id="4918655">Phentsize</span><span class="op" id="4918664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918668"><a href="/debug/elf/file.go.html#4918156">phnum</a></span>&nbsp;<span class="op" id="4918674">=</span>&nbsp;<span class="builtintype" id="4918676">int</span><span class="op" id="4918679">(</span><span class="ident" id="4918680"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918683">.</span><span class="ident" id="4918684">Phnum</span><span class="op" id="4918689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918693"><a href="/debug/elf/file.go.html#4918171">shoff</a></span>&nbsp;<span class="op" id="4918699">=</span>&nbsp;<span class="ident" id="4918701">int64</span><span class="op" id="4918706">(</span><span class="ident" id="4918707"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918710">.</span><span class="ident" id="4918711">Shoff</span><span class="op" id="4918716">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918720"><a href="/debug/elf/file.go.html#4918188">shentsize</a></span>&nbsp;<span class="op" id="4918730">=</span>&nbsp;<span class="builtintype" id="4918732">int</span><span class="op" id="4918735">(</span><span class="ident" id="4918736"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918739">.</span><span class="ident" id="4918740">Shentsize</span><span class="op" id="4918749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918753"><a href="/debug/elf/file.go.html#4918199">shnum</a></span>&nbsp;<span class="op" id="4918759">=</span>&nbsp;<span class="builtintype" id="4918761">int</span><span class="op" id="4918764">(</span><span class="ident" id="4918765"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918768">.</span><span class="ident" id="4918769">Shnum</span><span class="op" id="4918774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918778"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span>&nbsp;<span class="op" id="4918787">=</span>&nbsp;<span class="builtintype" id="4918789">int</span><span class="op" id="4918792">(</span><span class="ident" id="4918793"><a href="/debug/elf/file.go.html#4918272">hdr</a></span><span class="op" id="4918796">.</span><span class="ident" id="4918797">Shstrndx</span><span class="op" id="4918805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918808">case</span>&nbsp;<span class="ident" id="4918813"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4918823">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918827">hdr</span>&nbsp;<span class="op" id="4918831">:=</span>&nbsp;<span class="builtinfunc" id="4918834">new</span><span class="op" id="4918837">(</span><span class="ident" id="4918838"><a href="/debug/elf/elf.go.html#4909007">Header64</a></span><span class="op" id="4918846">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918850"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4918852">.</span><span class="ident" id="4918853">Seek</span><span class="op" id="4918857">(</span><span class="num" id="4918858">0</span><span class="op" id="4918859">,</span>&nbsp;<span class="ident" id="4918861"><a href="/debug/elf/file.go.html#4913158">os</a></span><span class="op" id="4918863">.</span><span class="ident" id="4918864">SEEK_SET</span><span class="op" id="4918872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918876">if</span>&nbsp;<span class="ident" id="4918879">err</span>&nbsp;<span class="op" id="4918883">:=</span>&nbsp;<span class="ident" id="4918886"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4918892">.</span><span class="ident" id="4918893">Read</span><span class="op" id="4918897">(</span><span class="ident" id="4918898"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4918900">,</span>&nbsp;<span class="ident" id="4918902"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918903">.</span><span class="ident" id="4918904">ByteOrder</span><span class="op" id="4918913">,</span>&nbsp;<span class="ident" id="4918915"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4918918">)</span><span class="op" id="4918919">;</span>&nbsp;<span class="ident" id="4918921"><a href="/debug/elf/file.go.html#4918879">err</a></span>&nbsp;<span class="op" id="4918925">!=</span>&nbsp;<span class="ident" id="4918928">nil</span>&nbsp;<span class="op" id="4918932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4918937">return</span>&nbsp;<span class="ident" id="4918944">nil</span><span class="op" id="4918947">,</span>&nbsp;<span class="ident" id="4918949"><a href="/debug/elf/file.go.html#4918879">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4918955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918959"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918960">.</span><span class="ident" id="4918961">Type</span>&nbsp;<span class="op" id="4918966">=</span>&nbsp;<span class="ident" id="4918968"><a href="/debug/elf/elf.go.html#4854262">Type</a></span><span class="op" id="4918972">(</span><span class="ident" id="4918973"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4918976">.</span><span class="ident" id="4918977">Type</span><span class="op" id="4918981">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4918985"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4918986">.</span><span class="ident" id="4918987">Machine</span>&nbsp;<span class="op" id="4918995">=</span>&nbsp;<span class="ident" id="4918997"><a href="/debug/elf/elf.go.html#4855167">Machine</a></span><span class="op" id="4919004">(</span><span class="ident" id="4919005"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919008">.</span><span class="ident" id="4919009">Machine</span><span class="op" id="4919016">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919020"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4919021">.</span><span class="ident" id="4919022">Entry</span>&nbsp;<span class="op" id="4919028">=</span>&nbsp;<span class="ident" id="4919030">uint64</span><span class="op" id="4919036">(</span><span class="ident" id="4919037"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919040">.</span><span class="ident" id="4919041">Entry</span><span class="op" id="4919046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919050">if</span>&nbsp;<span class="ident" id="4919053">v</span>&nbsp;<span class="op" id="4919055">:=</span>&nbsp;<span class="ident" id="4919058"><a href="/debug/elf/elf.go.html#4851280">Version</a></span><span class="op" id="4919065">(</span><span class="ident" id="4919066"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919069">.</span><span class="ident" id="4919070">Version</span><span class="op" id="4919077">)</span><span class="op" id="4919078">;</span>&nbsp;<span class="ident" id="4919080"><a href="/debug/elf/file.go.html#4919053">v</a></span>&nbsp;<span class="op" id="4919082">!=</span>&nbsp;<span class="ident" id="4919085"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4919086">.</span><span class="ident" id="4919087">Version</span>&nbsp;<span class="op" id="4919095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919100">return</span>&nbsp;<span class="ident" id="4919107">nil</span><span class="op" id="4919110">,</span>&nbsp;<span class="op" id="4919112">&amp;</span><span class="ident" id="4919113"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4919124">{</span><span class="num" id="4919125">0</span><span class="op" id="4919126">,</span>&nbsp;<span class="string" id="4919128">&#34;mismatched&nbsp;ELF&nbsp;version&#34;</span><span class="op" id="4919152">,</span>&nbsp;<span class="ident" id="4919154"><a href="/debug/elf/file.go.html#4919053">v</a></span><span class="op" id="4919155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4919159">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919163"><a href="/debug/elf/file.go.html#4918128">phoff</a></span>&nbsp;<span class="op" id="4919169">=</span>&nbsp;<span class="ident" id="4919171">int64</span><span class="op" id="4919176">(</span><span class="ident" id="4919177"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919180">.</span><span class="ident" id="4919181">Phoff</span><span class="op" id="4919186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919190"><a href="/debug/elf/file.go.html#4918145">phentsize</a></span>&nbsp;<span class="op" id="4919200">=</span>&nbsp;<span class="builtintype" id="4919202">int</span><span class="op" id="4919205">(</span><span class="ident" id="4919206"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919209">.</span><span class="ident" id="4919210">Phentsize</span><span class="op" id="4919219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919223"><a href="/debug/elf/file.go.html#4918156">phnum</a></span>&nbsp;<span class="op" id="4919229">=</span>&nbsp;<span class="builtintype" id="4919231">int</span><span class="op" id="4919234">(</span><span class="ident" id="4919235"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919238">.</span><span class="ident" id="4919239">Phnum</span><span class="op" id="4919244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919248"><a href="/debug/elf/file.go.html#4918171">shoff</a></span>&nbsp;<span class="op" id="4919254">=</span>&nbsp;<span class="ident" id="4919256">int64</span><span class="op" id="4919261">(</span><span class="ident" id="4919262"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919265">.</span><span class="ident" id="4919266">Shoff</span><span class="op" id="4919271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919275"><a href="/debug/elf/file.go.html#4918188">shentsize</a></span>&nbsp;<span class="op" id="4919285">=</span>&nbsp;<span class="builtintype" id="4919287">int</span><span class="op" id="4919290">(</span><span class="ident" id="4919291"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919294">.</span><span class="ident" id="4919295">Shentsize</span><span class="op" id="4919304">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919308"><a href="/debug/elf/file.go.html#4918199">shnum</a></span>&nbsp;<span class="op" id="4919314">=</span>&nbsp;<span class="builtintype" id="4919316">int</span><span class="op" id="4919319">(</span><span class="ident" id="4919320"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919323">.</span><span class="ident" id="4919324">Shnum</span><span class="op" id="4919329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919333"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span>&nbsp;<span class="op" id="4919342">=</span>&nbsp;<span class="builtintype" id="4919344">int</span><span class="op" id="4919347">(</span><span class="ident" id="4919348"><a href="/debug/elf/file.go.html#4918827">hdr</a></span><span class="op" id="4919351">.</span><span class="ident" id="4919352">Shstrndx</span><span class="op" id="4919360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4919363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919367">if</span>&nbsp;<span class="ident" id="4919370"><a href="/debug/elf/file.go.html#4918199">shnum</a></span>&nbsp;<span class="op" id="4919376">&gt;</span>&nbsp;<span class="num" id="4919378">0</span>&nbsp;<span class="op" id="4919380">&amp;&amp;</span>&nbsp;<span class="ident" id="4919383"><a href="/debug/elf/file.go.html#4918171">shoff</a></span>&nbsp;<span class="op" id="4919389">&gt;</span>&nbsp;<span class="num" id="4919391">0</span>&nbsp;<span class="op" id="4919393">&amp;&amp;</span>&nbsp;<span class="op" id="4919396">(</span><span class="ident" id="4919397"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span>&nbsp;<span class="op" id="4919406">&lt;</span>&nbsp;<span class="num" id="4919408">0</span>&nbsp;<span class="op" id="4919410">||</span>&nbsp;<span class="ident" id="4919413"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span>&nbsp;<span class="op" id="4919422">&gt;=</span>&nbsp;<span class="ident" id="4919425"><a href="/debug/elf/file.go.html#4918199">shnum</a></span><span class="op" id="4919430">)</span>&nbsp;<span class="op" id="4919432">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919436">return</span>&nbsp;<span class="ident" id="4919443">nil</span><span class="op" id="4919446">,</span>&nbsp;<span class="op" id="4919448">&amp;</span><span class="ident" id="4919449"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4919460">{</span><span class="num" id="4919461">0</span><span class="op" id="4919462">,</span>&nbsp;<span class="string" id="4919464">&#34;invalid&nbsp;ELF&nbsp;shstrndx&#34;</span><span class="op" id="4919486">,</span>&nbsp;<span class="ident" id="4919488"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span><span class="op" id="4919496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4919499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4919503">//&nbsp;Read&nbsp;program&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919528"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4919529">.</span><span class="ident" id="4919530">Progs</span>&nbsp;<span class="op" id="4919536">=</span>&nbsp;<span class="builtinfunc" id="4919538">make</span><span class="op" id="4919542">(</span><span class="op" id="4919543">[</span><span class="op" id="4919544">]</span><span class="op" id="4919545">*</span><span class="ident" id="4919546"><a href="/debug/elf/file.go.html#4915266">Prog</a></span><span class="op" id="4919550">,</span>&nbsp;<span class="ident" id="4919552"><a href="/debug/elf/file.go.html#4918156">phnum</a></span><span class="op" id="4919557">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919560">for</span>&nbsp;<span class="ident" id="4919564">i</span>&nbsp;<span class="op" id="4919566">:=</span>&nbsp;<span class="num" id="4919569">0</span><span class="op" id="4919570">;</span>&nbsp;<span class="ident" id="4919572"><a href="/debug/elf/file.go.html#4919564">i</a></span>&nbsp;<span class="op" id="4919574">&lt;</span>&nbsp;<span class="ident" id="4919576"><a href="/debug/elf/file.go.html#4918156">phnum</a></span><span class="op" id="4919581">;</span>&nbsp;<span class="ident" id="4919583"><a href="/debug/elf/file.go.html#4919564">i</a></span><span class="op" id="4919584">++</span>&nbsp;<span class="op" id="4919587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919591">off</span>&nbsp;<span class="op" id="4919595">:=</span>&nbsp;<span class="ident" id="4919598"><a href="/debug/elf/file.go.html#4918128">phoff</a></span>&nbsp;<span class="op" id="4919604">+</span>&nbsp;<span class="ident" id="4919606">int64</span><span class="op" id="4919611">(</span><span class="ident" id="4919612"><a href="/debug/elf/file.go.html#4919564">i</a></span><span class="op" id="4919613">)</span><span class="op" id="4919614">*</span><span class="ident" id="4919615">int64</span><span class="op" id="4919620">(</span><span class="ident" id="4919621"><a href="/debug/elf/file.go.html#4918145">phentsize</a></span><span class="op" id="4919630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919634"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4919636">.</span><span class="ident" id="4919637">Seek</span><span class="op" id="4919641">(</span><span class="ident" id="4919642"><a href="/debug/elf/file.go.html#4919591">off</a></span><span class="op" id="4919645">,</span>&nbsp;<span class="ident" id="4919647"><a href="/debug/elf/file.go.html#4913158">os</a></span><span class="op" id="4919649">.</span><span class="ident" id="4919650">SEEK_SET</span><span class="op" id="4919658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919662">p</span>&nbsp;<span class="op" id="4919664">:=</span>&nbsp;<span class="builtinfunc" id="4919667">new</span><span class="op" id="4919670">(</span><span class="ident" id="4919671"><a href="/debug/elf/file.go.html#4915266">Prog</a></span><span class="op" id="4919675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919679">switch</span>&nbsp;<span class="ident" id="4919686"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4919687">.</span><span class="ident" id="4919688">Class</span>&nbsp;<span class="op" id="4919694">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919698">case</span>&nbsp;<span class="ident" id="4919703"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4919713">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919718">ph</span>&nbsp;<span class="op" id="4919721">:=</span>&nbsp;<span class="builtinfunc" id="4919724">new</span><span class="op" id="4919727">(</span><span class="ident" id="4919728"><a href="/debug/elf/elf.go.html#4907357">Prog32</a></span><span class="op" id="4919734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919739">if</span>&nbsp;<span class="ident" id="4919742">err</span>&nbsp;<span class="op" id="4919746">:=</span>&nbsp;<span class="ident" id="4919749"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4919755">.</span><span class="ident" id="4919756">Read</span><span class="op" id="4919760">(</span><span class="ident" id="4919761"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4919763">,</span>&nbsp;<span class="ident" id="4919765"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4919766">.</span><span class="ident" id="4919767">ByteOrder</span><span class="op" id="4919776">,</span>&nbsp;<span class="ident" id="4919778"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919780">)</span><span class="op" id="4919781">;</span>&nbsp;<span class="ident" id="4919783"><a href="/debug/elf/file.go.html#4919742">err</a></span>&nbsp;<span class="op" id="4919787">!=</span>&nbsp;<span class="ident" id="4919790">nil</span>&nbsp;<span class="op" id="4919794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4919800">return</span>&nbsp;<span class="ident" id="4919807">nil</span><span class="op" id="4919810">,</span>&nbsp;<span class="ident" id="4919812"><a href="/debug/elf/file.go.html#4919742">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4919819">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919824"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4919825">.</span><span class="ident" id="4919826">ProgHeader</span>&nbsp;<span class="op" id="4919837">=</span>&nbsp;<span class="ident" id="4919839"><a href="/debug/elf/file.go.html#4915047">ProgHeader</a></span><span class="op" id="4919849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919855">Type</span><span class="op" id="4919859">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4919863"><a href="/debug/elf/elf.go.html#4864803">ProgType</a></span><span class="op" id="4919871">(</span><span class="ident" id="4919872"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919874">.</span><span class="ident" id="4919875">Type</span><span class="op" id="4919879">)</span><span class="op" id="4919880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919886">Flags</span><span class="op" id="4919891">:</span>&nbsp;&nbsp;<span class="ident" id="4919894"><a href="/debug/elf/elf.go.html#4866079">ProgFlag</a></span><span class="op" id="4919902">(</span><span class="ident" id="4919903"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919905">.</span><span class="ident" id="4919906">Flags</span><span class="op" id="4919911">)</span><span class="op" id="4919912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919918">Off</span><span class="op" id="4919921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4919926">uint64</span><span class="op" id="4919932">(</span><span class="ident" id="4919933"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919935">.</span><span class="ident" id="4919936">Off</span><span class="op" id="4919939">)</span><span class="op" id="4919940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919946">Vaddr</span><span class="op" id="4919951">:</span>&nbsp;&nbsp;<span class="ident" id="4919954">uint64</span><span class="op" id="4919960">(</span><span class="ident" id="4919961"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919963">.</span><span class="ident" id="4919964">Vaddr</span><span class="op" id="4919969">)</span><span class="op" id="4919970">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4919976">Paddr</span><span class="op" id="4919981">:</span>&nbsp;&nbsp;<span class="ident" id="4919984">uint64</span><span class="op" id="4919990">(</span><span class="ident" id="4919991"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4919993">.</span><span class="ident" id="4919994">Paddr</span><span class="op" id="4919999">)</span><span class="op" id="4920000">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920006">Filesz</span><span class="op" id="4920012">:</span>&nbsp;<span class="ident" id="4920014">uint64</span><span class="op" id="4920020">(</span><span class="ident" id="4920021"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4920023">.</span><span class="ident" id="4920024">Filesz</span><span class="op" id="4920030">)</span><span class="op" id="4920031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920037">Memsz</span><span class="op" id="4920042">:</span>&nbsp;&nbsp;<span class="ident" id="4920045">uint64</span><span class="op" id="4920051">(</span><span class="ident" id="4920052"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4920054">.</span><span class="ident" id="4920055">Memsz</span><span class="op" id="4920060">)</span><span class="op" id="4920061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920067">Align</span><span class="op" id="4920072">:</span>&nbsp;&nbsp;<span class="ident" id="4920075">uint64</span><span class="op" id="4920081">(</span><span class="ident" id="4920082"><a href="/debug/elf/file.go.html#4919718">ph</a></span><span class="op" id="4920084">.</span><span class="ident" id="4920085">Align</span><span class="op" id="4920090">)</span><span class="op" id="4920091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920096">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920100">case</span>&nbsp;<span class="ident" id="4920105"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4920115">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920120">ph</span>&nbsp;<span class="op" id="4920123">:=</span>&nbsp;<span class="builtinfunc" id="4920126">new</span><span class="op" id="4920129">(</span><span class="ident" id="4920130"><a href="/debug/elf/elf.go.html#4910419">Prog64</a></span><span class="op" id="4920136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920141">if</span>&nbsp;<span class="ident" id="4920144">err</span>&nbsp;<span class="op" id="4920148">:=</span>&nbsp;<span class="ident" id="4920151"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4920157">.</span><span class="ident" id="4920158">Read</span><span class="op" id="4920162">(</span><span class="ident" id="4920163"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4920165">,</span>&nbsp;<span class="ident" id="4920167"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4920168">.</span><span class="ident" id="4920169">ByteOrder</span><span class="op" id="4920178">,</span>&nbsp;<span class="ident" id="4920180"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920182">)</span><span class="op" id="4920183">;</span>&nbsp;<span class="ident" id="4920185"><a href="/debug/elf/file.go.html#4920144">err</a></span>&nbsp;<span class="op" id="4920189">!=</span>&nbsp;<span class="ident" id="4920192">nil</span>&nbsp;<span class="op" id="4920196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920202">return</span>&nbsp;<span class="ident" id="4920209">nil</span><span class="op" id="4920212">,</span>&nbsp;<span class="ident" id="4920214"><a href="/debug/elf/file.go.html#4920144">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920221">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920226"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920227">.</span><span class="ident" id="4920228">ProgHeader</span>&nbsp;<span class="op" id="4920239">=</span>&nbsp;<span class="ident" id="4920241"><a href="/debug/elf/file.go.html#4915047">ProgHeader</a></span><span class="op" id="4920251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920257">Type</span><span class="op" id="4920261">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4920265"><a href="/debug/elf/elf.go.html#4864803">ProgType</a></span><span class="op" id="4920273">(</span><span class="ident" id="4920274"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920276">.</span><span class="ident" id="4920277">Type</span><span class="op" id="4920281">)</span><span class="op" id="4920282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920288">Flags</span><span class="op" id="4920293">:</span>&nbsp;&nbsp;<span class="ident" id="4920296"><a href="/debug/elf/elf.go.html#4866079">ProgFlag</a></span><span class="op" id="4920304">(</span><span class="ident" id="4920305"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920307">.</span><span class="ident" id="4920308">Flags</span><span class="op" id="4920313">)</span><span class="op" id="4920314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920320">Off</span><span class="op" id="4920323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4920328">uint64</span><span class="op" id="4920334">(</span><span class="ident" id="4920335"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920337">.</span><span class="ident" id="4920338">Off</span><span class="op" id="4920341">)</span><span class="op" id="4920342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920348">Vaddr</span><span class="op" id="4920353">:</span>&nbsp;&nbsp;<span class="ident" id="4920356">uint64</span><span class="op" id="4920362">(</span><span class="ident" id="4920363"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920365">.</span><span class="ident" id="4920366">Vaddr</span><span class="op" id="4920371">)</span><span class="op" id="4920372">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920378">Paddr</span><span class="op" id="4920383">:</span>&nbsp;&nbsp;<span class="ident" id="4920386">uint64</span><span class="op" id="4920392">(</span><span class="ident" id="4920393"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920395">.</span><span class="ident" id="4920396">Paddr</span><span class="op" id="4920401">)</span><span class="op" id="4920402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920408">Filesz</span><span class="op" id="4920414">:</span>&nbsp;<span class="ident" id="4920416">uint64</span><span class="op" id="4920422">(</span><span class="ident" id="4920423"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920425">.</span><span class="ident" id="4920426">Filesz</span><span class="op" id="4920432">)</span><span class="op" id="4920433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920439">Memsz</span><span class="op" id="4920444">:</span>&nbsp;&nbsp;<span class="ident" id="4920447">uint64</span><span class="op" id="4920453">(</span><span class="ident" id="4920454"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920456">.</span><span class="ident" id="4920457">Memsz</span><span class="op" id="4920462">)</span><span class="op" id="4920463">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920469">Align</span><span class="op" id="4920474">:</span>&nbsp;&nbsp;<span class="ident" id="4920477">uint64</span><span class="op" id="4920483">(</span><span class="ident" id="4920484"><a href="/debug/elf/file.go.html#4920120">ph</a></span><span class="op" id="4920486">.</span><span class="ident" id="4920487">Align</span><span class="op" id="4920492">)</span><span class="op" id="4920493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920498">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920506"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920507">.</span><span class="ident" id="4920508">sr</span>&nbsp;<span class="op" id="4920511">=</span>&nbsp;<span class="ident" id="4920513"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4920515">.</span><span class="ident" id="4920516">NewSectionReader</span><span class="op" id="4920532">(</span><span class="ident" id="4920533"><a href="/debug/elf/file.go.html#4917116">r</a></span><span class="op" id="4920534">,</span>&nbsp;<span class="ident" id="4920536">int64</span><span class="op" id="4920541">(</span><span class="ident" id="4920542"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920543">.</span><span class="ident" id="4920544">Off</span><span class="op" id="4920547">)</span><span class="op" id="4920548">,</span>&nbsp;<span class="ident" id="4920550">int64</span><span class="op" id="4920555">(</span><span class="ident" id="4920556"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920557">.</span><span class="ident" id="4920558">Filesz</span><span class="op" id="4920564">)</span><span class="op" id="4920565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920569"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920570">.</span><span class="ident" id="4920571">ReaderAt</span>&nbsp;<span class="op" id="4920580">=</span>&nbsp;<span class="ident" id="4920582"><a href="/debug/elf/file.go.html#4919662">p</a></span><span class="op" id="4920583">.</span><span class="ident" id="4920584">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920589"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4920590">.</span><span class="ident" id="4920591">Progs</span><span class="op" id="4920596">[</span><span class="ident" id="4920597"><a href="/debug/elf/file.go.html#4919564">i</a></span><span class="op" id="4920598">]</span>&nbsp;<span class="op" id="4920600">=</span>&nbsp;<span class="ident" id="4920602"><a href="/debug/elf/file.go.html#4919662">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920605">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4920609">//&nbsp;Read&nbsp;section&nbsp;headers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920634"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4920635">.</span><span class="ident" id="4920636">Sections</span>&nbsp;<span class="op" id="4920645">=</span>&nbsp;<span class="builtinfunc" id="4920647">make</span><span class="op" id="4920651">(</span><span class="op" id="4920652">[</span><span class="op" id="4920653">]</span><span class="op" id="4920654">*</span><span class="ident" id="4920655"><a href="/debug/elf/file.go.html#4914005">Section</a></span><span class="op" id="4920662">,</span>&nbsp;<span class="ident" id="4920664"><a href="/debug/elf/file.go.html#4918199">shnum</a></span><span class="op" id="4920669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920672">names</span>&nbsp;<span class="op" id="4920678">:=</span>&nbsp;<span class="builtinfunc" id="4920681">make</span><span class="op" id="4920685">(</span><span class="op" id="4920686">[</span><span class="op" id="4920687">]</span><span class="builtintype" id="4920688">uint32</span><span class="op" id="4920694">,</span>&nbsp;<span class="ident" id="4920696"><a href="/debug/elf/file.go.html#4918199">shnum</a></span><span class="op" id="4920701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920704">for</span>&nbsp;<span class="ident" id="4920708">i</span>&nbsp;<span class="op" id="4920710">:=</span>&nbsp;<span class="num" id="4920713">0</span><span class="op" id="4920714">;</span>&nbsp;<span class="ident" id="4920716"><a href="/debug/elf/file.go.html#4920708">i</a></span>&nbsp;<span class="op" id="4920718">&lt;</span>&nbsp;<span class="ident" id="4920720"><a href="/debug/elf/file.go.html#4918199">shnum</a></span><span class="op" id="4920725">;</span>&nbsp;<span class="ident" id="4920727"><a href="/debug/elf/file.go.html#4920708">i</a></span><span class="op" id="4920728">++</span>&nbsp;<span class="op" id="4920731">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920735">off</span>&nbsp;<span class="op" id="4920739">:=</span>&nbsp;<span class="ident" id="4920742"><a href="/debug/elf/file.go.html#4918171">shoff</a></span>&nbsp;<span class="op" id="4920748">+</span>&nbsp;<span class="ident" id="4920750">int64</span><span class="op" id="4920755">(</span><span class="ident" id="4920756"><a href="/debug/elf/file.go.html#4920708">i</a></span><span class="op" id="4920757">)</span><span class="op" id="4920758">*</span><span class="ident" id="4920759">int64</span><span class="op" id="4920764">(</span><span class="ident" id="4920765"><a href="/debug/elf/file.go.html#4918188">shentsize</a></span><span class="op" id="4920774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920778"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4920780">.</span><span class="ident" id="4920781">Seek</span><span class="op" id="4920785">(</span><span class="ident" id="4920786"><a href="/debug/elf/file.go.html#4920735">off</a></span><span class="op" id="4920789">,</span>&nbsp;<span class="ident" id="4920791"><a href="/debug/elf/file.go.html#4913158">os</a></span><span class="op" id="4920793">.</span><span class="ident" id="4920794">SEEK_SET</span><span class="op" id="4920802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920806">s</span>&nbsp;<span class="op" id="4920808">:=</span>&nbsp;<span class="builtinfunc" id="4920811">new</span><span class="op" id="4920814">(</span><span class="ident" id="4920815"><a href="/debug/elf/file.go.html#4914005">Section</a></span><span class="op" id="4920822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920826">switch</span>&nbsp;<span class="ident" id="4920833"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4920834">.</span><span class="ident" id="4920835">Class</span>&nbsp;<span class="op" id="4920841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920845">case</span>&nbsp;<span class="ident" id="4920850"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4920860">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920865">sh</span>&nbsp;<span class="op" id="4920868">:=</span>&nbsp;<span class="builtinfunc" id="4920871">new</span><span class="op" id="4920874">(</span><span class="ident" id="4920875"><a href="/debug/elf/elf.go.html#4906817">Section32</a></span><span class="op" id="4920884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920889">if</span>&nbsp;<span class="ident" id="4920892">err</span>&nbsp;<span class="op" id="4920896">:=</span>&nbsp;<span class="ident" id="4920899"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4920905">.</span><span class="ident" id="4920906">Read</span><span class="op" id="4920910">(</span><span class="ident" id="4920911"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4920913">,</span>&nbsp;<span class="ident" id="4920915"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4920916">.</span><span class="ident" id="4920917">ByteOrder</span><span class="op" id="4920926">,</span>&nbsp;<span class="ident" id="4920928"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4920930">)</span><span class="op" id="4920931">;</span>&nbsp;<span class="ident" id="4920933"><a href="/debug/elf/file.go.html#4920892">err</a></span>&nbsp;<span class="op" id="4920937">!=</span>&nbsp;<span class="ident" id="4920940">nil</span>&nbsp;<span class="op" id="4920944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4920950">return</span>&nbsp;<span class="ident" id="4920957">nil</span><span class="op" id="4920960">,</span>&nbsp;<span class="ident" id="4920962"><a href="/debug/elf/file.go.html#4920892">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4920969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920974"><a href="/debug/elf/file.go.html#4920672">names</a></span><span class="op" id="4920979">[</span><span class="ident" id="4920980"><a href="/debug/elf/file.go.html#4920708">i</a></span><span class="op" id="4920981">]</span>&nbsp;<span class="op" id="4920983">=</span>&nbsp;<span class="ident" id="4920985"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4920987">.</span><span class="ident" id="4920988">Name</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4920996"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4920997">.</span><span class="ident" id="4920998">SectionHeader</span>&nbsp;<span class="op" id="4921012">=</span>&nbsp;<span class="ident" id="4921014"><a href="/debug/elf/file.go.html#4913727">SectionHeader</a></span><span class="op" id="4921027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921033">Type</span><span class="op" id="4921037">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921044"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4921055">(</span><span class="ident" id="4921056"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921058">.</span><span class="ident" id="4921059">Type</span><span class="op" id="4921063">)</span><span class="op" id="4921064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921070">Flags</span><span class="op" id="4921075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921081"><a href="/debug/elf/elf.go.html#4863330">SectionFlag</a></span><span class="op" id="4921092">(</span><span class="ident" id="4921093"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921095">.</span><span class="ident" id="4921096">Flags</span><span class="op" id="4921101">)</span><span class="op" id="4921102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921108">Addr</span><span class="op" id="4921112">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921119">uint64</span><span class="op" id="4921125">(</span><span class="ident" id="4921126"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921128">.</span><span class="ident" id="4921129">Addr</span><span class="op" id="4921133">)</span><span class="op" id="4921134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921140">Offset</span><span class="op" id="4921146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921151">uint64</span><span class="op" id="4921157">(</span><span class="ident" id="4921158"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921160">.</span><span class="ident" id="4921161">Off</span><span class="op" id="4921164">)</span><span class="op" id="4921165">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921171">Size</span><span class="op" id="4921175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921182">uint64</span><span class="op" id="4921188">(</span><span class="ident" id="4921189"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921191">.</span><span class="ident" id="4921192">Size</span><span class="op" id="4921196">)</span><span class="op" id="4921197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921203">Link</span><span class="op" id="4921207">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4921214">uint32</span><span class="op" id="4921220">(</span><span class="ident" id="4921221"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921223">.</span><span class="ident" id="4921224">Link</span><span class="op" id="4921228">)</span><span class="op" id="4921229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921235">Info</span><span class="op" id="4921239">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4921246">uint32</span><span class="op" id="4921252">(</span><span class="ident" id="4921253"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921255">.</span><span class="ident" id="4921256">Info</span><span class="op" id="4921260">)</span><span class="op" id="4921261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921267">Addralign</span><span class="op" id="4921276">:</span>&nbsp;<span class="ident" id="4921278">uint64</span><span class="op" id="4921284">(</span><span class="ident" id="4921285"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921287">.</span><span class="ident" id="4921288">Addralign</span><span class="op" id="4921297">)</span><span class="op" id="4921298">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921304">Entsize</span><span class="op" id="4921311">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4921315">uint64</span><span class="op" id="4921321">(</span><span class="ident" id="4921322"><a href="/debug/elf/file.go.html#4920865">sh</a></span><span class="op" id="4921324">.</span><span class="ident" id="4921325">Entsize</span><span class="op" id="4921332">)</span><span class="op" id="4921333">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921342">case</span>&nbsp;<span class="ident" id="4921347"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4921357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921362">sh</span>&nbsp;<span class="op" id="4921365">:=</span>&nbsp;<span class="builtinfunc" id="4921368">new</span><span class="op" id="4921371">(</span><span class="ident" id="4921372"><a href="/debug/elf/elf.go.html#4909879">Section64</a></span><span class="op" id="4921381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921386">if</span>&nbsp;<span class="ident" id="4921389">err</span>&nbsp;<span class="op" id="4921393">:=</span>&nbsp;<span class="ident" id="4921396"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4921402">.</span><span class="ident" id="4921403">Read</span><span class="op" id="4921407">(</span><span class="ident" id="4921408"><a href="/debug/elf/file.go.html#4917149">sr</a></span><span class="op" id="4921410">,</span>&nbsp;<span class="ident" id="4921412"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4921413">.</span><span class="ident" id="4921414">ByteOrder</span><span class="op" id="4921423">,</span>&nbsp;<span class="ident" id="4921425"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921427">)</span><span class="op" id="4921428">;</span>&nbsp;<span class="ident" id="4921430"><a href="/debug/elf/file.go.html#4921389">err</a></span>&nbsp;<span class="op" id="4921434">!=</span>&nbsp;<span class="ident" id="4921437">nil</span>&nbsp;<span class="op" id="4921441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921447">return</span>&nbsp;<span class="ident" id="4921454">nil</span><span class="op" id="4921457">,</span>&nbsp;<span class="ident" id="4921459"><a href="/debug/elf/file.go.html#4921389">err</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921471"><a href="/debug/elf/file.go.html#4920672">names</a></span><span class="op" id="4921476">[</span><span class="ident" id="4921477"><a href="/debug/elf/file.go.html#4920708">i</a></span><span class="op" id="4921478">]</span>&nbsp;<span class="op" id="4921480">=</span>&nbsp;<span class="ident" id="4921482"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921484">.</span><span class="ident" id="4921485">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921493"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921494">.</span><span class="ident" id="4921495">SectionHeader</span>&nbsp;<span class="op" id="4921509">=</span>&nbsp;<span class="ident" id="4921511"><a href="/debug/elf/file.go.html#4913727">SectionHeader</a></span><span class="op" id="4921524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921530">Type</span><span class="op" id="4921534">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921541"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4921552">(</span><span class="ident" id="4921553"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921555">.</span><span class="ident" id="4921556">Type</span><span class="op" id="4921560">)</span><span class="op" id="4921561">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921567">Flags</span><span class="op" id="4921572">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921578"><a href="/debug/elf/elf.go.html#4863330">SectionFlag</a></span><span class="op" id="4921589">(</span><span class="ident" id="4921590"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921592">.</span><span class="ident" id="4921593">Flags</span><span class="op" id="4921598">)</span><span class="op" id="4921599">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921605">Offset</span><span class="op" id="4921611">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921616">uint64</span><span class="op" id="4921622">(</span><span class="ident" id="4921623"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921625">.</span><span class="ident" id="4921626">Off</span><span class="op" id="4921629">)</span><span class="op" id="4921630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921636">Size</span><span class="op" id="4921640">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921647">uint64</span><span class="op" id="4921653">(</span><span class="ident" id="4921654"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921656">.</span><span class="ident" id="4921657">Size</span><span class="op" id="4921661">)</span><span class="op" id="4921662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921668">Addr</span><span class="op" id="4921672">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4921679">uint64</span><span class="op" id="4921685">(</span><span class="ident" id="4921686"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921688">.</span><span class="ident" id="4921689">Addr</span><span class="op" id="4921693">)</span><span class="op" id="4921694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921700">Link</span><span class="op" id="4921704">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4921711">uint32</span><span class="op" id="4921717">(</span><span class="ident" id="4921718"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921720">.</span><span class="ident" id="4921721">Link</span><span class="op" id="4921725">)</span><span class="op" id="4921726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921732">Info</span><span class="op" id="4921736">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4921743">uint32</span><span class="op" id="4921749">(</span><span class="ident" id="4921750"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921752">.</span><span class="ident" id="4921753">Info</span><span class="op" id="4921757">)</span><span class="op" id="4921758">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921764">Addralign</span><span class="op" id="4921773">:</span>&nbsp;<span class="ident" id="4921775">uint64</span><span class="op" id="4921781">(</span><span class="ident" id="4921782"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921784">.</span><span class="ident" id="4921785">Addralign</span><span class="op" id="4921794">)</span><span class="op" id="4921795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921801">Entsize</span><span class="op" id="4921808">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4921812">uint64</span><span class="op" id="4921818">(</span><span class="ident" id="4921819"><a href="/debug/elf/file.go.html#4921362">sh</a></span><span class="op" id="4921821">.</span><span class="ident" id="4921822">Entsize</span><span class="op" id="4921829">)</span><span class="op" id="4921830">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921843"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921844">.</span><span class="ident" id="4921845">sr</span>&nbsp;<span class="op" id="4921848">=</span>&nbsp;<span class="ident" id="4921850"><a href="/debug/elf/file.go.html#4913152">io</a></span><span class="op" id="4921852">.</span><span class="ident" id="4921853">NewSectionReader</span><span class="op" id="4921869">(</span><span class="ident" id="4921870"><a href="/debug/elf/file.go.html#4917116">r</a></span><span class="op" id="4921871">,</span>&nbsp;<span class="ident" id="4921873">int64</span><span class="op" id="4921878">(</span><span class="ident" id="4921879"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921880">.</span><span class="ident" id="4921881">Offset</span><span class="op" id="4921887">)</span><span class="op" id="4921888">,</span>&nbsp;<span class="ident" id="4921890">int64</span><span class="op" id="4921895">(</span><span class="ident" id="4921896"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921897">.</span><span class="ident" id="4921898">Size</span><span class="op" id="4921902">)</span><span class="op" id="4921903">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921907"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921908">.</span><span class="ident" id="4921909">ReaderAt</span>&nbsp;<span class="op" id="4921918">=</span>&nbsp;<span class="ident" id="4921920"><a href="/debug/elf/file.go.html#4920806">s</a></span><span class="op" id="4921921">.</span><span class="ident" id="4921922">sr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4921927"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4921928">.</span><span class="ident" id="4921929">Sections</span><span class="op" id="4921937">[</span><span class="ident" id="4921938"><a href="/debug/elf/file.go.html#4920708">i</a></span><span class="op" id="4921939">]</span>&nbsp;<span class="op" id="4921941">=</span>&nbsp;<span class="ident" id="4921943"><a href="/debug/elf/file.go.html#4920806">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921946">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921950">if</span>&nbsp;<span class="builtinfunc" id="4921953">len</span><span class="op" id="4921956">(</span><span class="ident" id="4921957"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4921958">.</span><span class="ident" id="4921959">Sections</span><span class="op" id="4921967">)</span>&nbsp;<span class="op" id="4921969">==</span>&nbsp;<span class="num" id="4921972">0</span>&nbsp;<span class="op" id="4921974">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4921978">return</span>&nbsp;<span class="ident" id="4921985"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4921986">,</span>&nbsp;<span class="ident" id="4921988">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4921993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4921997">//&nbsp;Load&nbsp;section&nbsp;header&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922035">shstrtab</span><span class="op" id="4922043">,</span>&nbsp;<span class="ident" id="4922045">err</span>&nbsp;<span class="op" id="4922049">:=</span>&nbsp;<span class="ident" id="4922052"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4922053">.</span><span class="ident" id="4922054">Sections</span><span class="op" id="4922062">[</span><span class="ident" id="4922063"><a href="/debug/elf/file.go.html#4918206">shstrndx</a></span><span class="op" id="4922071">]</span><span class="op" id="4922072">.</span><span class="ident" id="4922073">Data</span><span class="op" id="4922077">(</span><span class="op" id="4922078">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922081">if</span>&nbsp;<span class="ident" id="4922084"><a href="/debug/elf/file.go.html#4922045">err</a></span>&nbsp;<span class="op" id="4922088">!=</span>&nbsp;<span class="ident" id="4922091">nil</span>&nbsp;<span class="op" id="4922095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922099">return</span>&nbsp;<span class="ident" id="4922106">nil</span><span class="op" id="4922109">,</span>&nbsp;<span class="ident" id="4922111"><a href="/debug/elf/file.go.html#4922045">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922119">for</span>&nbsp;<span class="ident" id="4922123">i</span><span class="op" id="4922124">,</span>&nbsp;<span class="ident" id="4922126">s</span>&nbsp;<span class="op" id="4922128">:=</span>&nbsp;<span class="keyword" id="4922131">range</span>&nbsp;<span class="ident" id="4922137"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4922138">.</span><span class="ident" id="4922139">Sections</span>&nbsp;<span class="op" id="4922148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922152">var</span>&nbsp;<span class="ident" id="4922156">ok</span>&nbsp;<span class="builtintype" id="4922159">bool</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922166"><a href="/debug/elf/file.go.html#4922126">s</a></span><span class="op" id="4922167">.</span><span class="ident" id="4922168">Name</span><span class="op" id="4922172">,</span>&nbsp;<span class="ident" id="4922174"><a href="/debug/elf/file.go.html#4922156">ok</a></span>&nbsp;<span class="op" id="4922177">=</span>&nbsp;<span class="ident" id="4922179"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4922188">(</span><span class="ident" id="4922189"><a href="/debug/elf/file.go.html#4922035">shstrtab</a></span><span class="op" id="4922197">,</span>&nbsp;<span class="builtintype" id="4922199">int</span><span class="op" id="4922202">(</span><span class="ident" id="4922203"><a href="/debug/elf/file.go.html#4920672">names</a></span><span class="op" id="4922208">[</span><span class="ident" id="4922209"><a href="/debug/elf/file.go.html#4922123">i</a></span><span class="op" id="4922210">]</span><span class="op" id="4922211">)</span><span class="op" id="4922212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922216">if</span>&nbsp;<span class="op" id="4922219">!</span><span class="ident" id="4922220"><a href="/debug/elf/file.go.html#4922156">ok</a></span>&nbsp;<span class="op" id="4922223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922228">return</span>&nbsp;<span class="ident" id="4922235">nil</span><span class="op" id="4922238">,</span>&nbsp;<span class="op" id="4922240">&amp;</span><span class="ident" id="4922241"><a href="/debug/elf/file.go.html#4915914">FormatError</a></span><span class="op" id="4922252">{</span><span class="ident" id="4922253"><a href="/debug/elf/file.go.html#4918171">shoff</a></span>&nbsp;<span class="op" id="4922259">+</span>&nbsp;<span class="ident" id="4922261">int64</span><span class="op" id="4922266">(</span><span class="ident" id="4922267"><a href="/debug/elf/file.go.html#4922123">i</a></span><span class="op" id="4922268">*</span><span class="ident" id="4922269"><a href="/debug/elf/file.go.html#4918188">shentsize</a></span><span class="op" id="4922278">)</span><span class="op" id="4922279">,</span>&nbsp;<span class="string" id="4922281">&#34;bad&nbsp;section&nbsp;name&nbsp;index&#34;</span><span class="op" id="4922305">,</span>&nbsp;<span class="ident" id="4922307"><a href="/debug/elf/file.go.html#4920672">names</a></span><span class="op" id="4922312">[</span><span class="ident" id="4922313"><a href="/debug/elf/file.go.html#4922123">i</a></span><span class="op" id="4922314">]</span><span class="op" id="4922315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922322">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922326">return</span>&nbsp;<span class="ident" id="4922333"><a href="/debug/elf/file.go.html#4917467">f</a></span><span class="op" id="4922334">,</span>&nbsp;<span class="ident" id="4922336">nil</span><br>
<span class="lineno"></span><span class="op" id="4922340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4922343">//&nbsp;getSymbols&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;Symbols&nbsp;from&nbsp;parsing&nbsp;the&nbsp;symbol&nbsp;table</span><br>
<span class="lineno">395</span><span class="comment" id="4922414">//&nbsp;with&nbsp;the&nbsp;given&nbsp;type,&nbsp;along&nbsp;with&nbsp;the&nbsp;associated&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4922478">func</span>&nbsp;<span class="op" id="4922483">(</span><span class="ident" id="4922484">f</span>&nbsp;<span class="op" id="4922486">*</span><span class="ident" id="4922487"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4922491">)</span>&nbsp;<span class="ident" id="4922493">getSymbols</span><span class="op" id="4922503">(</span><span class="ident" id="4922504">typ</span>&nbsp;<span class="ident" id="4922508"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4922519">)</span>&nbsp;<span class="op" id="4922521">(</span><span class="op" id="4922522">[</span><span class="op" id="4922523">]</span><span class="ident" id="4922524"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4922530">,</span>&nbsp;<span class="op" id="4922532">[</span><span class="op" id="4922533">]</span><span class="builtintype" id="4922534">byte</span><span class="op" id="4922538">,</span>&nbsp;<span class="builtintype" id="4922540">error</span><span class="op" id="4922545">)</span>&nbsp;<span class="op" id="4922547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922550">switch</span>&nbsp;<span class="ident" id="4922557"><a href="/debug/elf/file.go.html#4922484">f</a></span><span class="op" id="4922558">.</span><span class="ident" id="4922559">Class</span>&nbsp;<span class="op" id="4922565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922568">case</span>&nbsp;<span class="ident" id="4922573"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4922583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922587">return</span>&nbsp;<span class="ident" id="4922594"><a href="/debug/elf/file.go.html#4922484">f</a></span><span class="op" id="4922595">.</span><span class="ident" id="4922596">getSymbols64</span><span class="op" id="4922608">(</span><span class="ident" id="4922609"><a href="/debug/elf/file.go.html#4922504">typ</a></span><span class="op" id="4922612">)</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922616">case</span>&nbsp;<span class="ident" id="4922621"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4922631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922635">return</span>&nbsp;<span class="ident" id="4922642"><a href="/debug/elf/file.go.html#4922484">f</a></span><span class="op" id="4922643">.</span><span class="ident" id="4922644">getSymbols32</span><span class="op" id="4922656">(</span><span class="ident" id="4922657"><a href="/debug/elf/file.go.html#4922504">typ</a></span><span class="op" id="4922660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4922663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922667">return</span>&nbsp;<span class="ident" id="4922674">nil</span><span class="op" id="4922677">,</span>&nbsp;<span class="ident" id="4922679">nil</span><span class="op" id="4922682">,</span>&nbsp;<span class="ident" id="4922684"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4922690">.</span><span class="ident" id="4922691">New</span><span class="op" id="4922694">(</span><span class="string" id="4922695">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4922712">)</span><br>
<span class="lineno"></span><span class="op" id="4922714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4922717">//&nbsp;ErrNoSymbols&nbsp;is&nbsp;returned&nbsp;by&nbsp;File.Symbols&nbsp;and&nbsp;File.DynamicSymbols</span><br>
<span class="lineno"></span><span class="comment" id="4922785">//&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;section&nbsp;in&nbsp;the&nbsp;File.</span><br>
<span class="lineno">410</span><span class="keyword" id="4922829">var</span>&nbsp;<span class="ident" id="4922833">ErrNoSymbols</span>&nbsp;<span class="op" id="4922846">=</span>&nbsp;<span class="ident" id="4922848"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4922854">.</span><span class="ident" id="4922855">New</span><span class="op" id="4922858">(</span><span class="string" id="4922859">&#34;no&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4922878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4922881">func</span>&nbsp;<span class="op" id="4922886">(</span><span class="ident" id="4922887">f</span>&nbsp;<span class="op" id="4922889">*</span><span class="ident" id="4922890"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4922894">)</span>&nbsp;<span class="ident" id="4922896">getSymbols32</span><span class="op" id="4922908">(</span><span class="ident" id="4922909">typ</span>&nbsp;<span class="ident" id="4922913"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4922924">)</span>&nbsp;<span class="op" id="4922926">(</span><span class="op" id="4922927">[</span><span class="op" id="4922928">]</span><span class="ident" id="4922929"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4922935">,</span>&nbsp;<span class="op" id="4922937">[</span><span class="op" id="4922938">]</span><span class="builtintype" id="4922939">byte</span><span class="op" id="4922943">,</span>&nbsp;<span class="builtintype" id="4922945">error</span><span class="op" id="4922950">)</span>&nbsp;<span class="op" id="4922952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4922955">symtabSection</span>&nbsp;<span class="op" id="4922969">:=</span>&nbsp;<span class="ident" id="4922972"><a href="/debug/elf/file.go.html#4922887">f</a></span><span class="op" id="4922973">.</span><span class="ident" id="4922974">SectionByType</span><span class="op" id="4922987">(</span><span class="ident" id="4922988"><a href="/debug/elf/file.go.html#4922909">typ</a></span><span class="op" id="4922991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4922994">if</span>&nbsp;<span class="ident" id="4922997"><a href="/debug/elf/file.go.html#4922955">symtabSection</a></span>&nbsp;<span class="op" id="4923011">==</span>&nbsp;<span class="ident" id="4923014">nil</span>&nbsp;<span class="op" id="4923018">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923022">return</span>&nbsp;<span class="ident" id="4923029">nil</span><span class="op" id="4923032">,</span>&nbsp;<span class="ident" id="4923034">nil</span><span class="op" id="4923037">,</span>&nbsp;<span class="ident" id="4923039"><a href="/debug/elf/file.go.html#4922833">ErrNoSymbols</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923057">data</span><span class="op" id="4923061">,</span>&nbsp;<span class="ident" id="4923063">err</span>&nbsp;<span class="op" id="4923067">:=</span>&nbsp;<span class="ident" id="4923070"><a href="/debug/elf/file.go.html#4922955">symtabSection</a></span><span class="op" id="4923083">.</span><span class="ident" id="4923084">Data</span><span class="op" id="4923088">(</span><span class="op" id="4923089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923092">if</span>&nbsp;<span class="ident" id="4923095"><a href="/debug/elf/file.go.html#4923063">err</a></span>&nbsp;<span class="op" id="4923099">!=</span>&nbsp;<span class="ident" id="4923102">nil</span>&nbsp;<span class="op" id="4923106">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923110">return</span>&nbsp;<span class="ident" id="4923117">nil</span><span class="op" id="4923120">,</span>&nbsp;<span class="ident" id="4923122">nil</span><span class="op" id="4923125">,</span>&nbsp;<span class="ident" id="4923127"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4923133">.</span><span class="ident" id="4923134">New</span><span class="op" id="4923137">(</span><span class="string" id="4923138">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4923166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923172">symtab</span>&nbsp;<span class="op" id="4923179">:=</span>&nbsp;<span class="ident" id="4923182"><a href="/debug/elf/file.go.html#4913092">bytes</a></span><span class="op" id="4923187">.</span><span class="ident" id="4923188">NewReader</span><span class="op" id="4923197">(</span><span class="ident" id="4923198"><a href="/debug/elf/file.go.html#4923057">data</a></span><span class="op" id="4923202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923205">if</span>&nbsp;<span class="ident" id="4923208"><a href="/debug/elf/file.go.html#4923172">symtab</a></span><span class="op" id="4923214">.</span><span class="ident" id="4923215">Len</span><span class="op" id="4923218">(</span><span class="op" id="4923219">)</span><span class="op" id="4923220">%</span><span class="ident" id="4923221"><a href="/debug/elf/elf.go.html#4908661">Sym32Size</a></span>&nbsp;<span class="op" id="4923231">!=</span>&nbsp;<span class="num" id="4923234">0</span>&nbsp;<span class="op" id="4923236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923240">return</span>&nbsp;<span class="ident" id="4923247">nil</span><span class="op" id="4923250">,</span>&nbsp;<span class="ident" id="4923252">nil</span><span class="op" id="4923255">,</span>&nbsp;<span class="ident" id="4923257"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4923263">.</span><span class="ident" id="4923264">New</span><span class="op" id="4923267">(</span><span class="string" id="4923268">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;SymSize&#34;</span><span class="op" id="4923323">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923330">strdata</span><span class="op" id="4923337">,</span>&nbsp;<span class="ident" id="4923339"><a href="/debug/elf/file.go.html#4923063">err</a></span>&nbsp;<span class="op" id="4923343">:=</span>&nbsp;<span class="ident" id="4923346"><a href="/debug/elf/file.go.html#4922887">f</a></span><span class="op" id="4923347">.</span><span class="ident" id="4923348">stringTable</span><span class="op" id="4923359">(</span><span class="ident" id="4923360"><a href="/debug/elf/file.go.html#4922955">symtabSection</a></span><span class="op" id="4923373">.</span><span class="ident" id="4923374">Link</span><span class="op" id="4923378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923381">if</span>&nbsp;<span class="ident" id="4923384"><a href="/debug/elf/file.go.html#4923063">err</a></span>&nbsp;<span class="op" id="4923388">!=</span>&nbsp;<span class="ident" id="4923391">nil</span>&nbsp;<span class="op" id="4923395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923399">return</span>&nbsp;<span class="ident" id="4923406">nil</span><span class="op" id="4923409">,</span>&nbsp;<span class="ident" id="4923411">nil</span><span class="op" id="4923414">,</span>&nbsp;<span class="ident" id="4923416"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4923422">.</span><span class="ident" id="4923423">New</span><span class="op" id="4923426">(</span><span class="string" id="4923427">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4923461">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4923468">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923502">var</span>&nbsp;<span class="ident" id="4923506">skip</span>&nbsp;<span class="op" id="4923511">[</span><span class="ident" id="4923512"><a href="/debug/elf/elf.go.html#4908661">Sym32Size</a></span><span class="op" id="4923521">]</span><span class="builtintype" id="4923522">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923528"><a href="/debug/elf/file.go.html#4923172">symtab</a></span><span class="op" id="4923534">.</span><span class="ident" id="4923535">Read</span><span class="op" id="4923539">(</span><span class="ident" id="4923540"><a href="/debug/elf/file.go.html#4923506">skip</a></span><span class="op" id="4923544">[</span><span class="op" id="4923545">:</span><span class="op" id="4923546">]</span><span class="op" id="4923547">)</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923551">symbols</span>&nbsp;<span class="op" id="4923559">:=</span>&nbsp;<span class="builtinfunc" id="4923562">make</span><span class="op" id="4923566">(</span><span class="op" id="4923567">[</span><span class="op" id="4923568">]</span><span class="ident" id="4923569"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4923575">,</span>&nbsp;<span class="ident" id="4923577"><a href="/debug/elf/file.go.html#4923172">symtab</a></span><span class="op" id="4923583">.</span><span class="ident" id="4923584">Len</span><span class="op" id="4923587">(</span><span class="op" id="4923588">)</span><span class="op" id="4923589">/</span><span class="ident" id="4923590"><a href="/debug/elf/elf.go.html#4908661">Sym32Size</a></span><span class="op" id="4923599">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923603">i</span>&nbsp;<span class="op" id="4923605">:=</span>&nbsp;<span class="num" id="4923608">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923611">var</span>&nbsp;<span class="ident" id="4923615">sym</span>&nbsp;<span class="ident" id="4923619"><a href="/debug/elf/elf.go.html#4908555">Sym32</a></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923626">for</span>&nbsp;<span class="ident" id="4923630"><a href="/debug/elf/file.go.html#4923172">symtab</a></span><span class="op" id="4923636">.</span><span class="ident" id="4923637">Len</span><span class="op" id="4923640">(</span><span class="op" id="4923641">)</span>&nbsp;<span class="op" id="4923643">&gt;</span>&nbsp;<span class="num" id="4923645">0</span>&nbsp;<span class="op" id="4923647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923651"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4923657">.</span><span class="ident" id="4923658">Read</span><span class="op" id="4923662">(</span><span class="ident" id="4923663"><a href="/debug/elf/file.go.html#4923172">symtab</a></span><span class="op" id="4923669">,</span>&nbsp;<span class="ident" id="4923671"><a href="/debug/elf/file.go.html#4922887">f</a></span><span class="op" id="4923672">.</span><span class="ident" id="4923673">ByteOrder</span><span class="op" id="4923682">,</span>&nbsp;<span class="op" id="4923684">&amp;</span><span class="ident" id="4923685"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923692">str</span><span class="op" id="4923695">,</span>&nbsp;<span class="ident" id="4923697">_</span>&nbsp;<span class="op" id="4923699">:=</span>&nbsp;<span class="ident" id="4923702"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4923711">(</span><span class="ident" id="4923712"><a href="/debug/elf/file.go.html#4923330">strdata</a></span><span class="op" id="4923719">,</span>&nbsp;<span class="builtintype" id="4923721">int</span><span class="op" id="4923724">(</span><span class="ident" id="4923725"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923728">.</span><span class="ident" id="4923729">Name</span><span class="op" id="4923733">)</span><span class="op" id="4923734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923738"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923745">[</span><span class="ident" id="4923746"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923747">]</span><span class="op" id="4923748">.</span><span class="ident" id="4923749">Name</span>&nbsp;<span class="op" id="4923754">=</span>&nbsp;<span class="ident" id="4923756"><a href="/debug/elf/file.go.html#4923692">str</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923762"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923769">[</span><span class="ident" id="4923770"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923771">]</span><span class="op" id="4923772">.</span><span class="ident" id="4923773">Info</span>&nbsp;<span class="op" id="4923778">=</span>&nbsp;<span class="ident" id="4923780"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923783">.</span><span class="ident" id="4923784">Info</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923791"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923798">[</span><span class="ident" id="4923799"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923800">]</span><span class="op" id="4923801">.</span><span class="ident" id="4923802">Other</span>&nbsp;<span class="op" id="4923808">=</span>&nbsp;<span class="ident" id="4923810"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923813">.</span><span class="ident" id="4923814">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923822"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923829">[</span><span class="ident" id="4923830"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923831">]</span><span class="op" id="4923832">.</span><span class="ident" id="4923833">Section</span>&nbsp;<span class="op" id="4923841">=</span>&nbsp;<span class="ident" id="4923843"><a href="/debug/elf/elf.go.html#4859054">SectionIndex</a></span><span class="op" id="4923855">(</span><span class="ident" id="4923856"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923859">.</span><span class="ident" id="4923860">Shndx</span><span class="op" id="4923865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923869"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923876">[</span><span class="ident" id="4923877"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923878">]</span><span class="op" id="4923879">.</span><span class="ident" id="4923880">Value</span>&nbsp;<span class="op" id="4923886">=</span>&nbsp;<span class="ident" id="4923888">uint64</span><span class="op" id="4923894">(</span><span class="ident" id="4923895"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923898">.</span><span class="ident" id="4923899">Value</span><span class="op" id="4923904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923908"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923915">[</span><span class="ident" id="4923916"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923917">]</span><span class="op" id="4923918">.</span><span class="ident" id="4923919">Size</span>&nbsp;<span class="op" id="4923924">=</span>&nbsp;<span class="ident" id="4923926">uint64</span><span class="op" id="4923932">(</span><span class="ident" id="4923933"><a href="/debug/elf/file.go.html#4923615">sym</a></span><span class="op" id="4923936">.</span><span class="ident" id="4923937">Size</span><span class="op" id="4923941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4923945"><a href="/debug/elf/file.go.html#4923603">i</a></span><span class="op" id="4923946">++</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4923950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4923954">return</span>&nbsp;<span class="ident" id="4923961"><a href="/debug/elf/file.go.html#4923551">symbols</a></span><span class="op" id="4923968">,</span>&nbsp;<span class="ident" id="4923970"><a href="/debug/elf/file.go.html#4923330">strdata</a></span><span class="op" id="4923977">,</span>&nbsp;<span class="ident" id="4923979">nil</span><br>
<span class="lineno"></span><span class="op" id="4923983">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">455</span><span class="keyword" id="4923986">func</span>&nbsp;<span class="op" id="4923991">(</span><span class="ident" id="4923992">f</span>&nbsp;<span class="op" id="4923994">*</span><span class="ident" id="4923995"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4923999">)</span>&nbsp;<span class="ident" id="4924001">getSymbols64</span><span class="op" id="4924013">(</span><span class="ident" id="4924014">typ</span>&nbsp;<span class="ident" id="4924018"><a href="/debug/elf/elf.go.html#4860150">SectionType</a></span><span class="op" id="4924029">)</span>&nbsp;<span class="op" id="4924031">(</span><span class="op" id="4924032">[</span><span class="op" id="4924033">]</span><span class="ident" id="4924034"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4924040">,</span>&nbsp;<span class="op" id="4924042">[</span><span class="op" id="4924043">]</span><span class="builtintype" id="4924044">byte</span><span class="op" id="4924048">,</span>&nbsp;<span class="builtintype" id="4924050">error</span><span class="op" id="4924055">)</span>&nbsp;<span class="op" id="4924057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924060">symtabSection</span>&nbsp;<span class="op" id="4924074">:=</span>&nbsp;<span class="ident" id="4924077"><a href="/debug/elf/file.go.html#4923992">f</a></span><span class="op" id="4924078">.</span><span class="ident" id="4924079">SectionByType</span><span class="op" id="4924092">(</span><span class="ident" id="4924093"><a href="/debug/elf/file.go.html#4924014">typ</a></span><span class="op" id="4924096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924099">if</span>&nbsp;<span class="ident" id="4924102"><a href="/debug/elf/file.go.html#4924060">symtabSection</a></span>&nbsp;<span class="op" id="4924116">==</span>&nbsp;<span class="ident" id="4924119">nil</span>&nbsp;<span class="op" id="4924123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924127">return</span>&nbsp;<span class="ident" id="4924134">nil</span><span class="op" id="4924137">,</span>&nbsp;<span class="ident" id="4924139">nil</span><span class="op" id="4924142">,</span>&nbsp;<span class="ident" id="4924144"><a href="/debug/elf/file.go.html#4922833">ErrNoSymbols</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924158">}</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924162">data</span><span class="op" id="4924166">,</span>&nbsp;<span class="ident" id="4924168">err</span>&nbsp;<span class="op" id="4924172">:=</span>&nbsp;<span class="ident" id="4924175"><a href="/debug/elf/file.go.html#4924060">symtabSection</a></span><span class="op" id="4924188">.</span><span class="ident" id="4924189">Data</span><span class="op" id="4924193">(</span><span class="op" id="4924194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924197">if</span>&nbsp;<span class="ident" id="4924200"><a href="/debug/elf/file.go.html#4924168">err</a></span>&nbsp;<span class="op" id="4924204">!=</span>&nbsp;<span class="ident" id="4924207">nil</span>&nbsp;<span class="op" id="4924211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924215">return</span>&nbsp;<span class="ident" id="4924222">nil</span><span class="op" id="4924225">,</span>&nbsp;<span class="ident" id="4924227">nil</span><span class="op" id="4924230">,</span>&nbsp;<span class="ident" id="4924232"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4924238">.</span><span class="ident" id="4924239">New</span><span class="op" id="4924242">(</span><span class="string" id="4924243">&#34;cannot&nbsp;load&nbsp;symbol&nbsp;section&#34;</span><span class="op" id="4924271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924274">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924277">symtab</span>&nbsp;<span class="op" id="4924284">:=</span>&nbsp;<span class="ident" id="4924287"><a href="/debug/elf/file.go.html#4913092">bytes</a></span><span class="op" id="4924292">.</span><span class="ident" id="4924293">NewReader</span><span class="op" id="4924302">(</span><span class="ident" id="4924303"><a href="/debug/elf/file.go.html#4924162">data</a></span><span class="op" id="4924307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924310">if</span>&nbsp;<span class="ident" id="4924313"><a href="/debug/elf/file.go.html#4924277">symtab</a></span><span class="op" id="4924319">.</span><span class="ident" id="4924320">Len</span><span class="op" id="4924323">(</span><span class="op" id="4924324">)</span><span class="op" id="4924325">%</span><span class="ident" id="4924326"><a href="/debug/elf/elf.go.html#4911930">Sym64Size</a></span>&nbsp;<span class="op" id="4924336">!=</span>&nbsp;<span class="num" id="4924339">0</span>&nbsp;<span class="op" id="4924341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924345">return</span>&nbsp;<span class="ident" id="4924352">nil</span><span class="op" id="4924355">,</span>&nbsp;<span class="ident" id="4924357">nil</span><span class="op" id="4924360">,</span>&nbsp;<span class="ident" id="4924362"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4924368">.</span><span class="ident" id="4924369">New</span><span class="op" id="4924372">(</span><span class="string" id="4924373">&#34;length&nbsp;of&nbsp;symbol&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;Sym64Size&#34;</span><span class="op" id="4924430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924433">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924437">strdata</span><span class="op" id="4924444">,</span>&nbsp;<span class="ident" id="4924446"><a href="/debug/elf/file.go.html#4924168">err</a></span>&nbsp;<span class="op" id="4924450">:=</span>&nbsp;<span class="ident" id="4924453"><a href="/debug/elf/file.go.html#4923992">f</a></span><span class="op" id="4924454">.</span><span class="ident" id="4924455">stringTable</span><span class="op" id="4924466">(</span><span class="ident" id="4924467"><a href="/debug/elf/file.go.html#4924060">symtabSection</a></span><span class="op" id="4924480">.</span><span class="ident" id="4924481">Link</span><span class="op" id="4924485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924488">if</span>&nbsp;<span class="ident" id="4924491"><a href="/debug/elf/file.go.html#4924168">err</a></span>&nbsp;<span class="op" id="4924495">!=</span>&nbsp;<span class="ident" id="4924498">nil</span>&nbsp;<span class="op" id="4924502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924506">return</span>&nbsp;<span class="ident" id="4924513">nil</span><span class="op" id="4924516">,</span>&nbsp;<span class="ident" id="4924518">nil</span><span class="op" id="4924521">,</span>&nbsp;<span class="ident" id="4924523"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4924529">.</span><span class="ident" id="4924530">New</span><span class="op" id="4924533">(</span><span class="string" id="4924534">&#34;cannot&nbsp;load&nbsp;string&nbsp;table&nbsp;section&#34;</span><span class="op" id="4924568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4924571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4924575">//&nbsp;The&nbsp;first&nbsp;entry&nbsp;is&nbsp;all&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924609">var</span>&nbsp;<span class="ident" id="4924613">skip</span>&nbsp;<span class="op" id="4924618">[</span><span class="ident" id="4924619"><a href="/debug/elf/elf.go.html#4911930">Sym64Size</a></span><span class="op" id="4924628">]</span><span class="builtintype" id="4924629">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924635"><a href="/debug/elf/file.go.html#4924277">symtab</a></span><span class="op" id="4924641">.</span><span class="ident" id="4924642">Read</span><span class="op" id="4924646">(</span><span class="ident" id="4924647"><a href="/debug/elf/file.go.html#4924613">skip</a></span><span class="op" id="4924651">[</span><span class="op" id="4924652">:</span><span class="op" id="4924653">]</span><span class="op" id="4924654">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924658">symbols</span>&nbsp;<span class="op" id="4924666">:=</span>&nbsp;<span class="builtinfunc" id="4924669">make</span><span class="op" id="4924673">(</span><span class="op" id="4924674">[</span><span class="op" id="4924675">]</span><span class="ident" id="4924676"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4924682">,</span>&nbsp;<span class="ident" id="4924684"><a href="/debug/elf/file.go.html#4924277">symtab</a></span><span class="op" id="4924690">.</span><span class="ident" id="4924691">Len</span><span class="op" id="4924694">(</span><span class="op" id="4924695">)</span><span class="op" id="4924696">/</span><span class="ident" id="4924697"><a href="/debug/elf/elf.go.html#4911930">Sym64Size</a></span><span class="op" id="4924706">)</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924710">i</span>&nbsp;<span class="op" id="4924712">:=</span>&nbsp;<span class="num" id="4924715">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924718">var</span>&nbsp;<span class="ident" id="4924722">sym</span>&nbsp;<span class="ident" id="4924726"><a href="/debug/elf/elf.go.html#4911641">Sym64</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4924733">for</span>&nbsp;<span class="ident" id="4924737"><a href="/debug/elf/file.go.html#4924277">symtab</a></span><span class="op" id="4924743">.</span><span class="ident" id="4924744">Len</span><span class="op" id="4924747">(</span><span class="op" id="4924748">)</span>&nbsp;<span class="op" id="4924750">&gt;</span>&nbsp;<span class="num" id="4924752">0</span>&nbsp;<span class="op" id="4924754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924758"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4924764">.</span><span class="ident" id="4924765">Read</span><span class="op" id="4924769">(</span><span class="ident" id="4924770"><a href="/debug/elf/file.go.html#4924277">symtab</a></span><span class="op" id="4924776">,</span>&nbsp;<span class="ident" id="4924778"><a href="/debug/elf/file.go.html#4923992">f</a></span><span class="op" id="4924779">.</span><span class="ident" id="4924780">ByteOrder</span><span class="op" id="4924789">,</span>&nbsp;<span class="op" id="4924791">&amp;</span><span class="ident" id="4924792"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924795">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924799">str</span><span class="op" id="4924802">,</span>&nbsp;<span class="ident" id="4924804">_</span>&nbsp;<span class="op" id="4924806">:=</span>&nbsp;<span class="ident" id="4924809"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4924818">(</span><span class="ident" id="4924819"><a href="/debug/elf/file.go.html#4924437">strdata</a></span><span class="op" id="4924826">,</span>&nbsp;<span class="builtintype" id="4924828">int</span><span class="op" id="4924831">(</span><span class="ident" id="4924832"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924835">.</span><span class="ident" id="4924836">Name</span><span class="op" id="4924840">)</span><span class="op" id="4924841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924845"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4924852">[</span><span class="ident" id="4924853"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4924854">]</span><span class="op" id="4924855">.</span><span class="ident" id="4924856">Name</span>&nbsp;<span class="op" id="4924861">=</span>&nbsp;<span class="ident" id="4924863"><a href="/debug/elf/file.go.html#4924799">str</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924869"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4924876">[</span><span class="ident" id="4924877"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4924878">]</span><span class="op" id="4924879">.</span><span class="ident" id="4924880">Info</span>&nbsp;<span class="op" id="4924885">=</span>&nbsp;<span class="ident" id="4924887"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924890">.</span><span class="ident" id="4924891">Info</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924898"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4924905">[</span><span class="ident" id="4924906"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4924907">]</span><span class="op" id="4924908">.</span><span class="ident" id="4924909">Other</span>&nbsp;<span class="op" id="4924915">=</span>&nbsp;<span class="ident" id="4924917"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924920">.</span><span class="ident" id="4924921">Other</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924929"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4924936">[</span><span class="ident" id="4924937"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4924938">]</span><span class="op" id="4924939">.</span><span class="ident" id="4924940">Section</span>&nbsp;<span class="op" id="4924948">=</span>&nbsp;<span class="ident" id="4924950"><a href="/debug/elf/elf.go.html#4859054">SectionIndex</a></span><span class="op" id="4924962">(</span><span class="ident" id="4924963"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924966">.</span><span class="ident" id="4924967">Shndx</span><span class="op" id="4924972">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4924976"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4924983">[</span><span class="ident" id="4924984"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4924985">]</span><span class="op" id="4924986">.</span><span class="ident" id="4924987">Value</span>&nbsp;<span class="op" id="4924993">=</span>&nbsp;<span class="ident" id="4924995"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4924998">.</span><span class="ident" id="4924999">Value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925007"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4925014">[</span><span class="ident" id="4925015"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4925016">]</span><span class="op" id="4925017">.</span><span class="ident" id="4925018">Size</span>&nbsp;<span class="op" id="4925023">=</span>&nbsp;<span class="ident" id="4925025"><a href="/debug/elf/file.go.html#4924722">sym</a></span><span class="op" id="4925028">.</span><span class="ident" id="4925029">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4925036"><a href="/debug/elf/file.go.html#4924710">i</a></span><span class="op" id="4925037">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925041">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925045">return</span>&nbsp;<span class="ident" id="4925052"><a href="/debug/elf/file.go.html#4924658">symbols</a></span><span class="op" id="4925059">,</span>&nbsp;<span class="ident" id="4925061"><a href="/debug/elf/file.go.html#4924437">strdata</a></span><span class="op" id="4925068">,</span>&nbsp;<span class="ident" id="4925070">nil</span><br>
<span class="lineno"></span><span class="op" id="4925074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4925077">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;an&nbsp;ELF&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4925134">func</span>&nbsp;<span class="ident" id="4925139">getString</span><span class="op" id="4925148">(</span><span class="ident" id="4925149">section</span>&nbsp;<span class="op" id="4925157">[</span><span class="op" id="4925158">]</span><span class="builtintype" id="4925159">byte</span><span class="op" id="4925163">,</span>&nbsp;<span class="ident" id="4925165">start</span>&nbsp;<span class="builtintype" id="4925171">int</span><span class="op" id="4925174">)</span>&nbsp;<span class="op" id="4925176">(</span><span class="builtintype" id="4925177">string</span><span class="op" id="4925183">,</span>&nbsp;<span class="builtintype" id="4925185">bool</span><span class="op" id="4925189">)</span>&nbsp;<span class="op" id="4925191">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925194">if</span>&nbsp;<span class="ident" id="4925197"><a href="/debug/elf/file.go.html#4925165">start</a></span>&nbsp;<span class="op" id="4925203">&lt;</span>&nbsp;<span class="num" id="4925205">0</span>&nbsp;<span class="op" id="4925207">||</span>&nbsp;<span class="ident" id="4925210"><a href="/debug/elf/file.go.html#4925165">start</a></span>&nbsp;<span class="op" id="4925216">&gt;=</span>&nbsp;<span class="builtinfunc" id="4925219">len</span><span class="op" id="4925222">(</span><span class="ident" id="4925223"><a href="/debug/elf/file.go.html#4925149">section</a></span><span class="op" id="4925230">)</span>&nbsp;<span class="op" id="4925232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925236">return</span>&nbsp;<span class="string" id="4925243">&#34;&#34;</span><span class="op" id="4925245">,</span>&nbsp;<span class="ident" id="4925247">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925258">for</span>&nbsp;<span class="ident" id="4925262">end</span>&nbsp;<span class="op" id="4925266">:=</span>&nbsp;<span class="ident" id="4925269"><a href="/debug/elf/file.go.html#4925165">start</a></span><span class="op" id="4925274">;</span>&nbsp;<span class="ident" id="4925276"><a href="/debug/elf/file.go.html#4925262">end</a></span>&nbsp;<span class="op" id="4925280">&lt;</span>&nbsp;<span class="builtinfunc" id="4925282">len</span><span class="op" id="4925285">(</span><span class="ident" id="4925286"><a href="/debug/elf/file.go.html#4925149">section</a></span><span class="op" id="4925293">)</span><span class="op" id="4925294">;</span>&nbsp;<span class="ident" id="4925296"><a href="/debug/elf/file.go.html#4925262">end</a></span><span class="op" id="4925299">++</span>&nbsp;<span class="op" id="4925302">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925306">if</span>&nbsp;<span class="ident" id="4925309"><a href="/debug/elf/file.go.html#4925149">section</a></span><span class="op" id="4925316">[</span><span class="ident" id="4925317"><a href="/debug/elf/file.go.html#4925262">end</a></span><span class="op" id="4925320">]</span>&nbsp;<span class="op" id="4925322">==</span>&nbsp;<span class="num" id="4925325">0</span>&nbsp;<span class="op" id="4925327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925332">return</span>&nbsp;<span class="builtintype" id="4925339">string</span><span class="op" id="4925345">(</span><span class="ident" id="4925346"><a href="/debug/elf/file.go.html#4925149">section</a></span><span class="op" id="4925353">[</span><span class="ident" id="4925354"><a href="/debug/elf/file.go.html#4925165">start</a></span><span class="op" id="4925359">:</span><span class="ident" id="4925360"><a href="/debug/elf/file.go.html#4925262">end</a></span><span class="op" id="4925363">]</span><span class="op" id="4925364">)</span><span class="op" id="4925365">,</span>&nbsp;<span class="ident" id="4925367">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925380">return</span>&nbsp;<span class="string" id="4925387">&#34;&#34;</span><span class="op" id="4925389">,</span>&nbsp;<span class="ident" id="4925391">false</span><br>
<span class="lineno">510</span><span class="op" id="4925397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4925400">//&nbsp;Section&nbsp;returns&nbsp;a&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4925468">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="4925487">func</span>&nbsp;<span class="op" id="4925492">(</span><span class="ident" id="4925493">f</span>&nbsp;<span class="op" id="4925495">*</span><span class="ident" id="4925496"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4925500">)</span>&nbsp;<span class="ident" id="4925502">Section</span><span class="op" id="4925509">(</span><span class="ident" id="4925510">name</span>&nbsp;<span class="builtintype" id="4925515">string</span><span class="op" id="4925521">)</span>&nbsp;<span class="op" id="4925523">*</span><span class="ident" id="4925524"><a href="/debug/elf/file.go.html#4914005">Section</a></span>&nbsp;<span class="op" id="4925532">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925535">for</span>&nbsp;<span class="ident" id="4925539">_</span><span class="op" id="4925540">,</span>&nbsp;<span class="ident" id="4925542">s</span>&nbsp;<span class="op" id="4925544">:=</span>&nbsp;<span class="keyword" id="4925547">range</span>&nbsp;<span class="ident" id="4925553"><a href="/debug/elf/file.go.html#4925493">f</a></span><span class="op" id="4925554">.</span><span class="ident" id="4925555">Sections</span>&nbsp;<span class="op" id="4925564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925568">if</span>&nbsp;<span class="ident" id="4925571"><a href="/debug/elf/file.go.html#4925542">s</a></span><span class="op" id="4925572">.</span><span class="ident" id="4925573">Name</span>&nbsp;<span class="op" id="4925578">==</span>&nbsp;<span class="ident" id="4925581"><a href="/debug/elf/file.go.html#4925510">name</a></span>&nbsp;<span class="op" id="4925586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925591">return</span>&nbsp;<span class="ident" id="4925598"><a href="/debug/elf/file.go.html#4925542">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925605">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925608">return</span>&nbsp;<span class="ident" id="4925615">nil</span><br>
<span class="lineno"></span><span class="op" id="4925619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4925622">//&nbsp;applyRelocations&nbsp;applies&nbsp;relocations&nbsp;to&nbsp;dst.&nbsp;rels&nbsp;is&nbsp;a&nbsp;relocations&nbsp;section</span><br>
<span class="lineno"></span><span class="comment" id="4925700">//&nbsp;in&nbsp;RELA&nbsp;format.</span><br>
<span class="lineno">525</span><span class="keyword" id="4925719">func</span>&nbsp;<span class="op" id="4925724">(</span><span class="ident" id="4925725">f</span>&nbsp;<span class="op" id="4925727">*</span><span class="ident" id="4925728"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4925732">)</span>&nbsp;<span class="ident" id="4925734">applyRelocations</span><span class="op" id="4925750">(</span><span class="ident" id="4925751">dst</span>&nbsp;<span class="op" id="4925755">[</span><span class="op" id="4925756">]</span><span class="builtintype" id="4925757">byte</span><span class="op" id="4925761">,</span>&nbsp;<span class="ident" id="4925763">rels</span>&nbsp;<span class="op" id="4925768">[</span><span class="op" id="4925769">]</span><span class="builtintype" id="4925770">byte</span><span class="op" id="4925774">)</span>&nbsp;<span class="builtintype" id="4925776">error</span>&nbsp;<span class="op" id="4925782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925785">if</span>&nbsp;<span class="ident" id="4925788"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925789">.</span><span class="ident" id="4925790">Class</span>&nbsp;<span class="op" id="4925796">==</span>&nbsp;<span class="ident" id="4925799"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span>&nbsp;<span class="op" id="4925810">&amp;&amp;</span>&nbsp;<span class="ident" id="4925813"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925814">.</span><span class="ident" id="4925815">Machine</span>&nbsp;<span class="op" id="4925823">==</span>&nbsp;<span class="ident" id="4925826"><a href="/debug/elf/elf.go.html#4857444">EM_X86_64</a></span>&nbsp;<span class="op" id="4925836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925840">return</span>&nbsp;<span class="ident" id="4925847"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925848">.</span><span class="ident" id="4925849">applyRelocationsAMD64</span><span class="op" id="4925870">(</span><span class="ident" id="4925871"><a href="/debug/elf/file.go.html#4925751">dst</a></span><span class="op" id="4925874">,</span>&nbsp;<span class="ident" id="4925876"><a href="/debug/elf/file.go.html#4925763">rels</a></span><span class="op" id="4925880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925886">if</span>&nbsp;<span class="ident" id="4925889"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925890">.</span><span class="ident" id="4925891">Class</span>&nbsp;<span class="op" id="4925897">==</span>&nbsp;<span class="ident" id="4925900"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span>&nbsp;<span class="op" id="4925911">&amp;&amp;</span>&nbsp;<span class="ident" id="4925914"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925915">.</span><span class="ident" id="4925916">Machine</span>&nbsp;<span class="op" id="4925924">==</span>&nbsp;<span class="ident" id="4925927"><a href="/debug/elf/elf.go.html#4855342">EM_386</a></span>&nbsp;<span class="op" id="4925934">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925938">return</span>&nbsp;<span class="ident" id="4925945"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925946">.</span><span class="ident" id="4925947">applyRelocations386</span><span class="op" id="4925966">(</span><span class="ident" id="4925967"><a href="/debug/elf/file.go.html#4925751">dst</a></span><span class="op" id="4925970">,</span>&nbsp;<span class="ident" id="4925972"><a href="/debug/elf/file.go.html#4925763">rels</a></span><span class="op" id="4925976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4925979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4925982">if</span>&nbsp;<span class="ident" id="4925985"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4925986">.</span><span class="ident" id="4925987">Class</span>&nbsp;<span class="op" id="4925993">==</span>&nbsp;<span class="ident" id="4925996"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span>&nbsp;<span class="op" id="4926007">&amp;&amp;</span>&nbsp;<span class="ident" id="4926010"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4926011">.</span><span class="ident" id="4926012">Machine</span>&nbsp;<span class="op" id="4926020">==</span>&nbsp;<span class="ident" id="4926023"><a href="/debug/elf/elf.go.html#4857510">EM_AARCH64</a></span>&nbsp;<span class="op" id="4926034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926038">return</span>&nbsp;<span class="ident" id="4926045"><a href="/debug/elf/file.go.html#4925725">f</a></span><span class="op" id="4926046">.</span><span class="ident" id="4926047">applyRelocationsARM64</span><span class="op" id="4926068">(</span><span class="ident" id="4926069"><a href="/debug/elf/file.go.html#4925751">dst</a></span><span class="op" id="4926072">,</span>&nbsp;<span class="ident" id="4926074"><a href="/debug/elf/file.go.html#4925763">rels</a></span><span class="op" id="4926078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4926081">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926085">return</span>&nbsp;<span class="ident" id="4926092"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4926098">.</span><span class="ident" id="4926099">New</span><span class="op" id="4926102">(</span><span class="string" id="4926103">&#34;not&nbsp;implemented&#34;</span><span class="op" id="4926120">)</span><br>
<span class="lineno"></span><span class="op" id="4926122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4926125">func</span>&nbsp;<span class="op" id="4926130">(</span><span class="ident" id="4926131">f</span>&nbsp;<span class="op" id="4926133">*</span><span class="ident" id="4926134"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4926138">)</span>&nbsp;<span class="ident" id="4926140">applyRelocationsAMD64</span><span class="op" id="4926161">(</span><span class="ident" id="4926162">dst</span>&nbsp;<span class="op" id="4926166">[</span><span class="op" id="4926167">]</span><span class="builtintype" id="4926168">byte</span><span class="op" id="4926172">,</span>&nbsp;<span class="ident" id="4926174">rels</span>&nbsp;<span class="op" id="4926179">[</span><span class="op" id="4926180">]</span><span class="builtintype" id="4926181">byte</span><span class="op" id="4926185">)</span>&nbsp;<span class="builtintype" id="4926187">error</span>&nbsp;<span class="op" id="4926193">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4926196">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926226">if</span>&nbsp;<span class="builtinfunc" id="4926229">len</span><span class="op" id="4926232">(</span><span class="ident" id="4926233"><a href="/debug/elf/file.go.html#4926174">rels</a></span><span class="op" id="4926237">)</span><span class="op" id="4926238">%</span><span class="num" id="4926239">24</span>&nbsp;<span class="op" id="4926242">!=</span>&nbsp;<span class="num" id="4926245">0</span>&nbsp;<span class="op" id="4926247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926251">return</span>&nbsp;<span class="ident" id="4926258"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4926264">.</span><span class="ident" id="4926265">New</span><span class="op" id="4926268">(</span><span class="string" id="4926269">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4926323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4926326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926330">symbols</span><span class="op" id="4926337">,</span>&nbsp;<span class="ident" id="4926339">_</span><span class="op" id="4926340">,</span>&nbsp;<span class="ident" id="4926342">err</span>&nbsp;<span class="op" id="4926346">:=</span>&nbsp;<span class="ident" id="4926349"><a href="/debug/elf/file.go.html#4926131">f</a></span><span class="op" id="4926350">.</span><span class="ident" id="4926351">getSymbols</span><span class="op" id="4926361">(</span><span class="ident" id="4926362"><a href="/debug/elf/elf.go.html#4860318">SHT_SYMTAB</a></span><span class="op" id="4926372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926375">if</span>&nbsp;<span class="ident" id="4926378"><a href="/debug/elf/file.go.html#4926342">err</a></span>&nbsp;<span class="op" id="4926382">!=</span>&nbsp;<span class="ident" id="4926385">nil</span>&nbsp;<span class="op" id="4926389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926393">return</span>&nbsp;<span class="ident" id="4926400"><a href="/debug/elf/file.go.html#4926342">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4926405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926409">b</span>&nbsp;<span class="op" id="4926411">:=</span>&nbsp;<span class="ident" id="4926414"><a href="/debug/elf/file.go.html#4913092">bytes</a></span><span class="op" id="4926419">.</span><span class="ident" id="4926420">NewReader</span><span class="op" id="4926429">(</span><span class="ident" id="4926430"><a href="/debug/elf/file.go.html#4926174">rels</a></span><span class="op" id="4926434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926437">var</span>&nbsp;<span class="ident" id="4926441">rela</span>&nbsp;<span class="ident" id="4926446"><a href="/debug/elf/elf.go.html#4911251">Rela64</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926455">for</span>&nbsp;<span class="ident" id="4926459"><a href="/debug/elf/file.go.html#4926409">b</a></span><span class="op" id="4926460">.</span><span class="ident" id="4926461">Len</span><span class="op" id="4926464">(</span><span class="op" id="4926465">)</span>&nbsp;<span class="op" id="4926467">&gt;</span>&nbsp;<span class="num" id="4926469">0</span>&nbsp;<span class="op" id="4926471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926475"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4926481">.</span><span class="ident" id="4926482">Read</span><span class="op" id="4926486">(</span><span class="ident" id="4926487"><a href="/debug/elf/file.go.html#4926409">b</a></span><span class="op" id="4926488">,</span>&nbsp;<span class="ident" id="4926490"><a href="/debug/elf/file.go.html#4926131">f</a></span><span class="op" id="4926491">.</span><span class="ident" id="4926492">ByteOrder</span><span class="op" id="4926501">,</span>&nbsp;<span class="op" id="4926503">&amp;</span><span class="ident" id="4926504"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4926508">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926512">symNo</span>&nbsp;<span class="op" id="4926518">:=</span>&nbsp;<span class="ident" id="4926521"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4926525">.</span><span class="ident" id="4926526">Info</span>&nbsp;<span class="op" id="4926531">&gt;&gt;</span>&nbsp;<span class="num" id="4926534">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926539">t</span>&nbsp;<span class="op" id="4926541">:=</span>&nbsp;<span class="ident" id="4926544"><a href="/debug/elf/elf.go.html#4874939">R_X86_64</a></span><span class="op" id="4926552">(</span><span class="ident" id="4926553"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4926557">.</span><span class="ident" id="4926558">Info</span>&nbsp;<span class="op" id="4926563">&amp;</span>&nbsp;<span class="num" id="4926565">0xffff</span><span class="op" id="4926571">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926576">if</span>&nbsp;<span class="ident" id="4926579"><a href="/debug/elf/file.go.html#4926512">symNo</a></span>&nbsp;<span class="op" id="4926585">==</span>&nbsp;<span class="num" id="4926588">0</span>&nbsp;<span class="op" id="4926590">||</span>&nbsp;<span class="ident" id="4926593"><a href="/debug/elf/file.go.html#4926512">symNo</a></span>&nbsp;<span class="op" id="4926599">&gt;</span>&nbsp;<span class="ident" id="4926601">uint64</span><span class="op" id="4926607">(</span><span class="builtinfunc" id="4926608">len</span><span class="op" id="4926611">(</span><span class="ident" id="4926612"><a href="/debug/elf/file.go.html#4926330">symbols</a></span><span class="op" id="4926619">)</span><span class="op" id="4926620">)</span>&nbsp;<span class="op" id="4926622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926627">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4926638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4926642">sym</span>&nbsp;<span class="op" id="4926646">:=</span>&nbsp;<span class="op" id="4926649">&amp;</span><span class="ident" id="4926650"><a href="/debug/elf/file.go.html#4926330">symbols</a></span><span class="op" id="4926657">[</span><span class="ident" id="4926658"><a href="/debug/elf/file.go.html#4926512">symNo</a></span><span class="op" id="4926663">-</span><span class="num" id="4926664">1</span><span class="op" id="4926665">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926669">if</span>&nbsp;<span class="ident" id="4926672"><a href="/debug/elf/elf.go.html#4873232">SymType</a></span><span class="op" id="4926679">(</span><span class="ident" id="4926680"><a href="/debug/elf/file.go.html#4926642">sym</a></span><span class="op" id="4926683">.</span><span class="ident" id="4926684">Info</span><span class="op" id="4926688">&amp;</span><span class="num" id="4926689">0xf</span><span class="op" id="4926692">)</span>&nbsp;<span class="op" id="4926694">!=</span>&nbsp;<span class="ident" id="4926697"><a href="/debug/elf/elf.go.html#4873391">STT_SECTION</a></span>&nbsp;<span class="op" id="4926709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4926714">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926769">continue</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4926780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4926785">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4926838">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4926893">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno">570</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926940">switch</span>&nbsp;<span class="ident" id="4926947"><a href="/debug/elf/file.go.html#4926539">t</a></span>&nbsp;<span class="op" id="4926949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926953">case</span>&nbsp;<span class="ident" id="4926958"><a href="/debug/elf/elf.go.html#4875016">R_X86_64_64</a></span><span class="op" id="4926969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4926974">if</span>&nbsp;<span class="ident" id="4926977"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4926981">.</span><span class="ident" id="4926982">Off</span><span class="op" id="4926985">+</span><span class="num" id="4926986">8</span>&nbsp;<span class="op" id="4926988">&gt;=</span>&nbsp;<span class="ident" id="4926991">uint64</span><span class="op" id="4926997">(</span><span class="builtinfunc" id="4926998">len</span><span class="op" id="4927001">(</span><span class="ident" id="4927002"><a href="/debug/elf/file.go.html#4926162">dst</a></span><span class="op" id="4927005">)</span><span class="op" id="4927006">)</span>&nbsp;<span class="op" id="4927008">||</span>&nbsp;<span class="ident" id="4927011"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927015">.</span><span class="ident" id="4927016">Addend</span>&nbsp;<span class="op" id="4927023">&lt;</span>&nbsp;<span class="num" id="4927025">0</span>&nbsp;<span class="op" id="4927027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927033">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927050"><a href="/debug/elf/file.go.html#4926131">f</a></span><span class="op" id="4927051">.</span><span class="ident" id="4927052">ByteOrder</span><span class="op" id="4927061">.</span><span class="ident" id="4927062">PutUint64</span><span class="op" id="4927071">(</span><span class="ident" id="4927072"><a href="/debug/elf/file.go.html#4926162">dst</a></span><span class="op" id="4927075">[</span><span class="ident" id="4927076"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927080">.</span><span class="ident" id="4927081">Off</span><span class="op" id="4927084">:</span><span class="ident" id="4927085"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927089">.</span><span class="ident" id="4927090">Off</span><span class="op" id="4927093">+</span><span class="num" id="4927094">8</span><span class="op" id="4927095">]</span><span class="op" id="4927096">,</span>&nbsp;<span class="ident" id="4927098">uint64</span><span class="op" id="4927104">(</span><span class="ident" id="4927105"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927109">.</span><span class="ident" id="4927110">Addend</span><span class="op" id="4927116">)</span><span class="op" id="4927117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927121">case</span>&nbsp;<span class="ident" id="4927126"><a href="/debug/elf/elf.go.html#4875657">R_X86_64_32</a></span><span class="op" id="4927137">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927142">if</span>&nbsp;<span class="ident" id="4927145"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927149">.</span><span class="ident" id="4927150">Off</span><span class="op" id="4927153">+</span><span class="num" id="4927154">4</span>&nbsp;<span class="op" id="4927156">&gt;=</span>&nbsp;<span class="ident" id="4927159">uint64</span><span class="op" id="4927165">(</span><span class="builtinfunc" id="4927166">len</span><span class="op" id="4927169">(</span><span class="ident" id="4927170"><a href="/debug/elf/file.go.html#4926162">dst</a></span><span class="op" id="4927173">)</span><span class="op" id="4927174">)</span>&nbsp;<span class="op" id="4927176">||</span>&nbsp;<span class="ident" id="4927179"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927183">.</span><span class="ident" id="4927184">Addend</span>&nbsp;<span class="op" id="4927191">&lt;</span>&nbsp;<span class="num" id="4927193">0</span>&nbsp;<span class="op" id="4927195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927201">continue</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927218"><a href="/debug/elf/file.go.html#4926131">f</a></span><span class="op" id="4927219">.</span><span class="ident" id="4927220">ByteOrder</span><span class="op" id="4927229">.</span><span class="ident" id="4927230">PutUint32</span><span class="op" id="4927239">(</span><span class="ident" id="4927240"><a href="/debug/elf/file.go.html#4926162">dst</a></span><span class="op" id="4927243">[</span><span class="ident" id="4927244"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927248">.</span><span class="ident" id="4927249">Off</span><span class="op" id="4927252">:</span><span class="ident" id="4927253"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927257">.</span><span class="ident" id="4927258">Off</span><span class="op" id="4927261">+</span><span class="num" id="4927262">4</span><span class="op" id="4927263">]</span><span class="op" id="4927264">,</span>&nbsp;<span class="builtintype" id="4927266">uint32</span><span class="op" id="4927272">(</span><span class="ident" id="4927273"><a href="/debug/elf/file.go.html#4926441">rela</a></span><span class="op" id="4927277">.</span><span class="ident" id="4927278">Addend</span><span class="op" id="4927284">)</span><span class="op" id="4927285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927296">return</span>&nbsp;<span class="ident" id="4927303">nil</span><br>
<span class="lineno"></span><span class="op" id="4927307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4927310">func</span>&nbsp;<span class="op" id="4927315">(</span><span class="ident" id="4927316">f</span>&nbsp;<span class="op" id="4927318">*</span><span class="ident" id="4927319"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4927323">)</span>&nbsp;<span class="ident" id="4927325">applyRelocations386</span><span class="op" id="4927344">(</span><span class="ident" id="4927345">dst</span>&nbsp;<span class="op" id="4927349">[</span><span class="op" id="4927350">]</span><span class="builtintype" id="4927351">byte</span><span class="op" id="4927355">,</span>&nbsp;<span class="ident" id="4927357">rels</span>&nbsp;<span class="op" id="4927362">[</span><span class="op" id="4927363">]</span><span class="builtintype" id="4927364">byte</span><span class="op" id="4927368">)</span>&nbsp;<span class="builtintype" id="4927370">error</span>&nbsp;<span class="op" id="4927376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4927379">//&nbsp;8&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rel32.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927407">if</span>&nbsp;<span class="builtinfunc" id="4927410">len</span><span class="op" id="4927413">(</span><span class="ident" id="4927414"><a href="/debug/elf/file.go.html#4927357">rels</a></span><span class="op" id="4927418">)</span><span class="op" id="4927419">%</span><span class="num" id="4927420">8</span>&nbsp;<span class="op" id="4927422">!=</span>&nbsp;<span class="num" id="4927425">0</span>&nbsp;<span class="op" id="4927427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927431">return</span>&nbsp;<span class="ident" id="4927438"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4927444">.</span><span class="ident" id="4927445">New</span><span class="op" id="4927448">(</span><span class="string" id="4927449">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&#34;</span><span class="op" id="4927502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927509">symbols</span><span class="op" id="4927516">,</span>&nbsp;<span class="ident" id="4927518">_</span><span class="op" id="4927519">,</span>&nbsp;<span class="ident" id="4927521">err</span>&nbsp;<span class="op" id="4927525">:=</span>&nbsp;<span class="ident" id="4927528"><a href="/debug/elf/file.go.html#4927316">f</a></span><span class="op" id="4927529">.</span><span class="ident" id="4927530">getSymbols</span><span class="op" id="4927540">(</span><span class="ident" id="4927541"><a href="/debug/elf/elf.go.html#4860318">SHT_SYMTAB</a></span><span class="op" id="4927551">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927554">if</span>&nbsp;<span class="ident" id="4927557"><a href="/debug/elf/file.go.html#4927521">err</a></span>&nbsp;<span class="op" id="4927561">!=</span>&nbsp;<span class="ident" id="4927564">nil</span>&nbsp;<span class="op" id="4927568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927572">return</span>&nbsp;<span class="ident" id="4927579"><a href="/debug/elf/file.go.html#4927521">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927584">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927588">b</span>&nbsp;<span class="op" id="4927590">:=</span>&nbsp;<span class="ident" id="4927593"><a href="/debug/elf/file.go.html#4913092">bytes</a></span><span class="op" id="4927598">.</span><span class="ident" id="4927599">NewReader</span><span class="op" id="4927608">(</span><span class="ident" id="4927609"><a href="/debug/elf/file.go.html#4927357">rels</a></span><span class="op" id="4927613">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927616">var</span>&nbsp;<span class="ident" id="4927620">rel</span>&nbsp;<span class="ident" id="4927624"><a href="/debug/elf/elf.go.html#4908015">Rel32</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927632">for</span>&nbsp;<span class="ident" id="4927636"><a href="/debug/elf/file.go.html#4927588">b</a></span><span class="op" id="4927637">.</span><span class="ident" id="4927638">Len</span><span class="op" id="4927641">(</span><span class="op" id="4927642">)</span>&nbsp;<span class="op" id="4927644">&gt;</span>&nbsp;<span class="num" id="4927646">0</span>&nbsp;<span class="op" id="4927648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927652"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4927658">.</span><span class="ident" id="4927659">Read</span><span class="op" id="4927663">(</span><span class="ident" id="4927664"><a href="/debug/elf/file.go.html#4927588">b</a></span><span class="op" id="4927665">,</span>&nbsp;<span class="ident" id="4927667"><a href="/debug/elf/file.go.html#4927316">f</a></span><span class="op" id="4927668">.</span><span class="ident" id="4927669">ByteOrder</span><span class="op" id="4927678">,</span>&nbsp;<span class="op" id="4927680">&amp;</span><span class="ident" id="4927681"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927688">symNo</span>&nbsp;<span class="op" id="4927694">:=</span>&nbsp;<span class="ident" id="4927697"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927700">.</span><span class="ident" id="4927701">Info</span>&nbsp;<span class="op" id="4927706">&gt;&gt;</span>&nbsp;<span class="num" id="4927709">8</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927713">t</span>&nbsp;<span class="op" id="4927715">:=</span>&nbsp;<span class="ident" id="4927718"><a href="/debug/elf/elf.go.html#4894270">R_386</a></span><span class="op" id="4927723">(</span><span class="ident" id="4927724"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927727">.</span><span class="ident" id="4927728">Info</span>&nbsp;<span class="op" id="4927733">&amp;</span>&nbsp;<span class="num" id="4927735">0xff</span><span class="op" id="4927739">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927744">if</span>&nbsp;<span class="ident" id="4927747"><a href="/debug/elf/file.go.html#4927688">symNo</a></span>&nbsp;<span class="op" id="4927753">==</span>&nbsp;<span class="num" id="4927756">0</span>&nbsp;<span class="op" id="4927758">||</span>&nbsp;<span class="ident" id="4927761"><a href="/debug/elf/file.go.html#4927688">symNo</a></span>&nbsp;<span class="op" id="4927767">&gt;</span>&nbsp;<span class="builtintype" id="4927769">uint32</span><span class="op" id="4927775">(</span><span class="builtinfunc" id="4927776">len</span><span class="op" id="4927779">(</span><span class="ident" id="4927780"><a href="/debug/elf/file.go.html#4927509">symbols</a></span><span class="op" id="4927787">)</span><span class="op" id="4927788">)</span>&nbsp;<span class="op" id="4927790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927795">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927806">}</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927810">sym</span>&nbsp;<span class="op" id="4927814">:=</span>&nbsp;<span class="op" id="4927817">&amp;</span><span class="ident" id="4927818"><a href="/debug/elf/file.go.html#4927509">symbols</a></span><span class="op" id="4927825">[</span><span class="ident" id="4927826"><a href="/debug/elf/file.go.html#4927688">symNo</a></span><span class="op" id="4927831">-</span><span class="num" id="4927832">1</span><span class="op" id="4927833">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927838">if</span>&nbsp;<span class="ident" id="4927841"><a href="/debug/elf/file.go.html#4927713">t</a></span>&nbsp;<span class="op" id="4927843">==</span>&nbsp;<span class="ident" id="4927846"><a href="/debug/elf/elf.go.html#4894342">R_386_32</a></span>&nbsp;<span class="op" id="4927855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927860">if</span>&nbsp;<span class="ident" id="4927863"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927866">.</span><span class="ident" id="4927867">Off</span><span class="op" id="4927870">+</span><span class="num" id="4927871">4</span>&nbsp;<span class="op" id="4927873">&gt;=</span>&nbsp;<span class="builtintype" id="4927876">uint32</span><span class="op" id="4927882">(</span><span class="builtinfunc" id="4927883">len</span><span class="op" id="4927886">(</span><span class="ident" id="4927887"><a href="/debug/elf/file.go.html#4927345">dst</a></span><span class="op" id="4927890">)</span><span class="op" id="4927891">)</span>&nbsp;<span class="op" id="4927893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4927899">continue</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4927911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927916">val</span>&nbsp;<span class="op" id="4927920">:=</span>&nbsp;<span class="ident" id="4927923"><a href="/debug/elf/file.go.html#4927316">f</a></span><span class="op" id="4927924">.</span><span class="ident" id="4927925">ByteOrder</span><span class="op" id="4927934">.</span><span class="ident" id="4927935">Uint32</span><span class="op" id="4927941">(</span><span class="ident" id="4927942"><a href="/debug/elf/file.go.html#4927345">dst</a></span><span class="op" id="4927945">[</span><span class="ident" id="4927946"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927949">.</span><span class="ident" id="4927950">Off</span>&nbsp;<span class="op" id="4927954">:</span>&nbsp;<span class="ident" id="4927956"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4927959">.</span><span class="ident" id="4927960">Off</span><span class="op" id="4927963">+</span><span class="num" id="4927964">4</span><span class="op" id="4927965">]</span><span class="op" id="4927966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927971"><a href="/debug/elf/file.go.html#4927916">val</a></span>&nbsp;<span class="op" id="4927975">+=</span>&nbsp;<span class="builtintype" id="4927978">uint32</span><span class="op" id="4927984">(</span><span class="ident" id="4927985"><a href="/debug/elf/file.go.html#4927810">sym</a></span><span class="op" id="4927988">.</span><span class="ident" id="4927989">Value</span><span class="op" id="4927994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4927999"><a href="/debug/elf/file.go.html#4927316">f</a></span><span class="op" id="4928000">.</span><span class="ident" id="4928001">ByteOrder</span><span class="op" id="4928010">.</span><span class="ident" id="4928011">PutUint32</span><span class="op" id="4928020">(</span><span class="ident" id="4928021"><a href="/debug/elf/file.go.html#4927345">dst</a></span><span class="op" id="4928024">[</span><span class="ident" id="4928025"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4928028">.</span><span class="ident" id="4928029">Off</span><span class="op" id="4928032">:</span><span class="ident" id="4928033"><a href="/debug/elf/file.go.html#4927620">rel</a></span><span class="op" id="4928036">.</span><span class="ident" id="4928037">Off</span><span class="op" id="4928040">+</span><span class="num" id="4928041">4</span><span class="op" id="4928042">]</span><span class="op" id="4928043">,</span>&nbsp;<span class="ident" id="4928045"><a href="/debug/elf/file.go.html#4927916">val</a></span><span class="op" id="4928048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928052">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928055">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928059">return</span>&nbsp;<span class="ident" id="4928066">nil</span><br>
<span class="lineno"></span><span class="op" id="4928070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">625</span><span class="keyword" id="4928073">func</span>&nbsp;<span class="op" id="4928078">(</span><span class="ident" id="4928079">f</span>&nbsp;<span class="op" id="4928081">*</span><span class="ident" id="4928082"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4928086">)</span>&nbsp;<span class="ident" id="4928088">applyRelocationsARM64</span><span class="op" id="4928109">(</span><span class="ident" id="4928110">dst</span>&nbsp;<span class="op" id="4928114">[</span><span class="op" id="4928115">]</span><span class="builtintype" id="4928116">byte</span><span class="op" id="4928120">,</span>&nbsp;<span class="ident" id="4928122">rels</span>&nbsp;<span class="op" id="4928127">[</span><span class="op" id="4928128">]</span><span class="builtintype" id="4928129">byte</span><span class="op" id="4928133">)</span>&nbsp;<span class="builtintype" id="4928135">error</span>&nbsp;<span class="op" id="4928141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4928144">//&nbsp;24&nbsp;is&nbsp;the&nbsp;size&nbsp;of&nbsp;Rela64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928174">if</span>&nbsp;<span class="builtinfunc" id="4928177">len</span><span class="op" id="4928180">(</span><span class="ident" id="4928181"><a href="/debug/elf/file.go.html#4928122">rels</a></span><span class="op" id="4928185">)</span><span class="op" id="4928186">%</span><span class="num" id="4928187">24</span>&nbsp;<span class="op" id="4928190">!=</span>&nbsp;<span class="num" id="4928193">0</span>&nbsp;<span class="op" id="4928195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928199">return</span>&nbsp;<span class="ident" id="4928206"><a href="/debug/elf/file.go.html#4913135">errors</a></span><span class="op" id="4928212">.</span><span class="ident" id="4928213">New</span><span class="op" id="4928216">(</span><span class="string" id="4928217">&#34;length&nbsp;of&nbsp;relocation&nbsp;section&nbsp;is&nbsp;not&nbsp;a&nbsp;multiple&nbsp;of&nbsp;24&#34;</span><span class="op" id="4928271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928274">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928278">symbols</span><span class="op" id="4928285">,</span>&nbsp;<span class="ident" id="4928287">_</span><span class="op" id="4928288">,</span>&nbsp;<span class="ident" id="4928290">err</span>&nbsp;<span class="op" id="4928294">:=</span>&nbsp;<span class="ident" id="4928297"><a href="/debug/elf/file.go.html#4928079">f</a></span><span class="op" id="4928298">.</span><span class="ident" id="4928299">getSymbols</span><span class="op" id="4928309">(</span><span class="ident" id="4928310"><a href="/debug/elf/elf.go.html#4860318">SHT_SYMTAB</a></span><span class="op" id="4928320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928323">if</span>&nbsp;<span class="ident" id="4928326"><a href="/debug/elf/file.go.html#4928290">err</a></span>&nbsp;<span class="op" id="4928330">!=</span>&nbsp;<span class="ident" id="4928333">nil</span>&nbsp;<span class="op" id="4928337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928341">return</span>&nbsp;<span class="ident" id="4928348"><a href="/debug/elf/file.go.html#4928290">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928353">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928357">b</span>&nbsp;<span class="op" id="4928359">:=</span>&nbsp;<span class="ident" id="4928362"><a href="/debug/elf/file.go.html#4913092">bytes</a></span><span class="op" id="4928367">.</span><span class="ident" id="4928368">NewReader</span><span class="op" id="4928377">(</span><span class="ident" id="4928378"><a href="/debug/elf/file.go.html#4928122">rels</a></span><span class="op" id="4928382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928385">var</span>&nbsp;<span class="ident" id="4928389">rela</span>&nbsp;<span class="ident" id="4928394"><a href="/debug/elf/elf.go.html#4911251">Rela64</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928403">for</span>&nbsp;<span class="ident" id="4928407"><a href="/debug/elf/file.go.html#4928357">b</a></span><span class="op" id="4928408">.</span><span class="ident" id="4928409">Len</span><span class="op" id="4928412">(</span><span class="op" id="4928413">)</span>&nbsp;<span class="op" id="4928415">&gt;</span>&nbsp;<span class="num" id="4928417">0</span>&nbsp;<span class="op" id="4928419">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928423"><a href="/debug/elf/file.go.html#4913116">binary</a></span><span class="op" id="4928429">.</span><span class="ident" id="4928430">Read</span><span class="op" id="4928434">(</span><span class="ident" id="4928435"><a href="/debug/elf/file.go.html#4928357">b</a></span><span class="op" id="4928436">,</span>&nbsp;<span class="ident" id="4928438"><a href="/debug/elf/file.go.html#4928079">f</a></span><span class="op" id="4928439">.</span><span class="ident" id="4928440">ByteOrder</span><span class="op" id="4928449">,</span>&nbsp;<span class="op" id="4928451">&amp;</span><span class="ident" id="4928452"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4928456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928460">symNo</span>&nbsp;<span class="op" id="4928466">:=</span>&nbsp;<span class="ident" id="4928469"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4928473">.</span><span class="ident" id="4928474">Info</span>&nbsp;<span class="op" id="4928479">&gt;&gt;</span>&nbsp;<span class="num" id="4928482">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928487">t</span>&nbsp;<span class="op" id="4928489">:=</span>&nbsp;<span class="ident" id="4928492"><a href="/debug/elf/elf.go.html#4877554">R_AARCH64</a></span><span class="op" id="4928501">(</span><span class="ident" id="4928502"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4928506">.</span><span class="ident" id="4928507">Info</span>&nbsp;<span class="op" id="4928512">&amp;</span>&nbsp;<span class="num" id="4928514">0xffff</span><span class="op" id="4928520">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928525">if</span>&nbsp;<span class="ident" id="4928528"><a href="/debug/elf/file.go.html#4928460">symNo</a></span>&nbsp;<span class="op" id="4928534">==</span>&nbsp;<span class="num" id="4928537">0</span>&nbsp;<span class="op" id="4928539">||</span>&nbsp;<span class="ident" id="4928542"><a href="/debug/elf/file.go.html#4928460">symNo</a></span>&nbsp;<span class="op" id="4928548">&gt;</span>&nbsp;<span class="ident" id="4928550">uint64</span><span class="op" id="4928556">(</span><span class="builtinfunc" id="4928557">len</span><span class="op" id="4928560">(</span><span class="ident" id="4928561"><a href="/debug/elf/file.go.html#4928278">symbols</a></span><span class="op" id="4928568">)</span><span class="op" id="4928569">)</span>&nbsp;<span class="op" id="4928571">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928576">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4928591">sym</span>&nbsp;<span class="op" id="4928595">:=</span>&nbsp;<span class="op" id="4928598">&amp;</span><span class="ident" id="4928599"><a href="/debug/elf/file.go.html#4928278">symbols</a></span><span class="op" id="4928606">[</span><span class="ident" id="4928607"><a href="/debug/elf/file.go.html#4928460">symNo</a></span><span class="op" id="4928612">-</span><span class="num" id="4928613">1</span><span class="op" id="4928614">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928618">if</span>&nbsp;<span class="ident" id="4928621"><a href="/debug/elf/elf.go.html#4873232">SymType</a></span><span class="op" id="4928628">(</span><span class="ident" id="4928629"><a href="/debug/elf/file.go.html#4928591">sym</a></span><span class="op" id="4928632">.</span><span class="ident" id="4928633">Info</span><span class="op" id="4928637">&amp;</span><span class="num" id="4928638">0xf</span><span class="op" id="4928641">)</span>&nbsp;<span class="op" id="4928643">!=</span>&nbsp;<span class="ident" id="4928646"><a href="/debug/elf/elf.go.html#4873391">STT_SECTION</a></span>&nbsp;<span class="op" id="4928658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4928663">//&nbsp;We&nbsp;don&#39;t&nbsp;handle&nbsp;non-section&nbsp;relocations&nbsp;for&nbsp;now.</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928718">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4928734">//&nbsp;There&nbsp;are&nbsp;relocations,&nbsp;so&nbsp;this&nbsp;must&nbsp;be&nbsp;a&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4928787">//&nbsp;object&nbsp;file,&nbsp;and&nbsp;we&nbsp;only&nbsp;look&nbsp;at&nbsp;section&nbsp;symbols,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4928842">//&nbsp;so&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;symbol&nbsp;value&nbsp;is&nbsp;0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928889">switch</span>&nbsp;<span class="ident" id="4928896"><a href="/debug/elf/file.go.html#4928487">t</a></span>&nbsp;<span class="op" id="4928898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928902">case</span>&nbsp;<span class="ident" id="4928907"><a href="/debug/elf/elf.go.html#4880609">R_AARCH64_ABS64</a></span><span class="op" id="4928922">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928927">if</span>&nbsp;<span class="ident" id="4928930"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4928934">.</span><span class="ident" id="4928935">Off</span><span class="op" id="4928938">+</span><span class="num" id="4928939">8</span>&nbsp;<span class="op" id="4928941">&gt;=</span>&nbsp;<span class="ident" id="4928944">uint64</span><span class="op" id="4928950">(</span><span class="builtinfunc" id="4928951">len</span><span class="op" id="4928954">(</span><span class="ident" id="4928955"><a href="/debug/elf/file.go.html#4928110">dst</a></span><span class="op" id="4928958">)</span><span class="op" id="4928959">)</span>&nbsp;<span class="op" id="4928961">||</span>&nbsp;<span class="ident" id="4928964"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4928968">.</span><span class="ident" id="4928969">Addend</span>&nbsp;<span class="op" id="4928976">&lt;</span>&nbsp;<span class="num" id="4928978">0</span>&nbsp;<span class="op" id="4928980">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4928986">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4928998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929003"><a href="/debug/elf/file.go.html#4928079">f</a></span><span class="op" id="4929004">.</span><span class="ident" id="4929005">ByteOrder</span><span class="op" id="4929014">.</span><span class="ident" id="4929015">PutUint64</span><span class="op" id="4929024">(</span><span class="ident" id="4929025"><a href="/debug/elf/file.go.html#4928110">dst</a></span><span class="op" id="4929028">[</span><span class="ident" id="4929029"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929033">.</span><span class="ident" id="4929034">Off</span><span class="op" id="4929037">:</span><span class="ident" id="4929038"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929042">.</span><span class="ident" id="4929043">Off</span><span class="op" id="4929046">+</span><span class="num" id="4929047">8</span><span class="op" id="4929048">]</span><span class="op" id="4929049">,</span>&nbsp;<span class="ident" id="4929051">uint64</span><span class="op" id="4929057">(</span><span class="ident" id="4929058"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929062">.</span><span class="ident" id="4929063">Addend</span><span class="op" id="4929069">)</span><span class="op" id="4929070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929074">case</span>&nbsp;<span class="ident" id="4929079"><a href="/debug/elf/elf.go.html#4880668">R_AARCH64_ABS32</a></span><span class="op" id="4929094">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929099">if</span>&nbsp;<span class="ident" id="4929102"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929106">.</span><span class="ident" id="4929107">Off</span><span class="op" id="4929110">+</span><span class="num" id="4929111">4</span>&nbsp;<span class="op" id="4929113">&gt;=</span>&nbsp;<span class="ident" id="4929116">uint64</span><span class="op" id="4929122">(</span><span class="builtinfunc" id="4929123">len</span><span class="op" id="4929126">(</span><span class="ident" id="4929127"><a href="/debug/elf/file.go.html#4928110">dst</a></span><span class="op" id="4929130">)</span><span class="op" id="4929131">)</span>&nbsp;<span class="op" id="4929133">||</span>&nbsp;<span class="ident" id="4929136"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929140">.</span><span class="ident" id="4929141">Addend</span>&nbsp;<span class="op" id="4929148">&lt;</span>&nbsp;<span class="num" id="4929150">0</span>&nbsp;<span class="op" id="4929152">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929158">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929175"><a href="/debug/elf/file.go.html#4928079">f</a></span><span class="op" id="4929176">.</span><span class="ident" id="4929177">ByteOrder</span><span class="op" id="4929186">.</span><span class="ident" id="4929187">PutUint32</span><span class="op" id="4929196">(</span><span class="ident" id="4929197"><a href="/debug/elf/file.go.html#4928110">dst</a></span><span class="op" id="4929200">[</span><span class="ident" id="4929201"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929205">.</span><span class="ident" id="4929206">Off</span><span class="op" id="4929209">:</span><span class="ident" id="4929210"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929214">.</span><span class="ident" id="4929215">Off</span><span class="op" id="4929218">+</span><span class="num" id="4929219">4</span><span class="op" id="4929220">]</span><span class="op" id="4929221">,</span>&nbsp;<span class="builtintype" id="4929223">uint32</span><span class="op" id="4929229">(</span><span class="ident" id="4929230"><a href="/debug/elf/file.go.html#4928389">rela</a></span><span class="op" id="4929234">.</span><span class="ident" id="4929235">Addend</span><span class="op" id="4929241">)</span><span class="op" id="4929242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929249">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929253">return</span>&nbsp;<span class="ident" id="4929260">nil</span><br>
<span class="lineno"></span><span class="op" id="4929264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4929267">func</span>&nbsp;<span class="op" id="4929272">(</span><span class="ident" id="4929273">f</span>&nbsp;<span class="op" id="4929275">*</span><span class="ident" id="4929276"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4929280">)</span>&nbsp;<span class="ident" id="4929282">DWARF</span><span class="op" id="4929287">(</span><span class="op" id="4929288">)</span>&nbsp;<span class="op" id="4929290">(</span><span class="op" id="4929291">*</span><span class="ident" id="4929292"><a href="/debug/elf/file.go.html#4913101">dwarf</a></span><span class="op" id="4929297">.</span><span class="ident" id="4929298">Data</span><span class="op" id="4929302">,</span>&nbsp;<span class="builtintype" id="4929304">error</span><span class="op" id="4929309">)</span>&nbsp;<span class="op" id="4929311">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4929314">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4929365">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4929420">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929479">var</span>&nbsp;<span class="ident" id="4929483">names</span>&nbsp;<span class="op" id="4929489">=</span>&nbsp;<span class="op" id="4929491">[</span><span class="op" id="4929492">...</span><span class="op" id="4929495">]</span><span class="builtintype" id="4929496">string</span><span class="op" id="4929502">{</span><span class="string" id="4929503">&#34;abbrev&#34;</span><span class="op" id="4929511">,</span>&nbsp;<span class="string" id="4929513">&#34;info&#34;</span><span class="op" id="4929519">,</span>&nbsp;<span class="string" id="4929521">&#34;str&#34;</span><span class="op" id="4929526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929529">var</span>&nbsp;<span class="ident" id="4929533">dat</span>&nbsp;<span class="op" id="4929537">[</span><span class="builtinfunc" id="4929538">len</span><span class="op" id="4929541">(</span><span class="ident" id="4929542"><a href="/debug/elf/file.go.html#4929483">names</a></span><span class="op" id="4929547">)</span><span class="op" id="4929548">]</span><span class="op" id="4929549">[</span><span class="op" id="4929550">]</span><span class="builtintype" id="4929551">byte</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929557">for</span>&nbsp;<span class="ident" id="4929561">i</span><span class="op" id="4929562">,</span>&nbsp;<span class="ident" id="4929564">name</span>&nbsp;<span class="op" id="4929569">:=</span>&nbsp;<span class="keyword" id="4929572">range</span>&nbsp;<span class="ident" id="4929578"><a href="/debug/elf/file.go.html#4929483">names</a></span>&nbsp;<span class="op" id="4929584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929588"><a href="/debug/elf/file.go.html#4929564">name</a></span>&nbsp;<span class="op" id="4929593">=</span>&nbsp;<span class="string" id="4929595">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="4929605">+</span>&nbsp;<span class="ident" id="4929607"><a href="/debug/elf/file.go.html#4929564">name</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929614">s</span>&nbsp;<span class="op" id="4929616">:=</span>&nbsp;<span class="ident" id="4929619"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4929620">.</span><span class="ident" id="4929621">Section</span><span class="op" id="4929628">(</span><span class="ident" id="4929629"><a href="/debug/elf/file.go.html#4929564">name</a></span><span class="op" id="4929633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929637">if</span>&nbsp;<span class="ident" id="4929640"><a href="/debug/elf/file.go.html#4929614">s</a></span>&nbsp;<span class="op" id="4929642">==</span>&nbsp;<span class="ident" id="4929645">nil</span>&nbsp;<span class="op" id="4929649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929654">continue</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929665">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929669">b</span><span class="op" id="4929670">,</span>&nbsp;<span class="ident" id="4929672">err</span>&nbsp;<span class="op" id="4929676">:=</span>&nbsp;<span class="ident" id="4929679"><a href="/debug/elf/file.go.html#4929614">s</a></span><span class="op" id="4929680">.</span><span class="ident" id="4929681">Data</span><span class="op" id="4929685">(</span><span class="op" id="4929686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929690">if</span>&nbsp;<span class="ident" id="4929693"><a href="/debug/elf/file.go.html#4929672">err</a></span>&nbsp;<span class="op" id="4929697">!=</span>&nbsp;<span class="ident" id="4929700">nil</span>&nbsp;<span class="op" id="4929704">&amp;&amp;</span>&nbsp;<span class="ident" id="4929707">uint64</span><span class="op" id="4929713">(</span><span class="builtinfunc" id="4929714">len</span><span class="op" id="4929717">(</span><span class="ident" id="4929718"><a href="/debug/elf/file.go.html#4929669">b</a></span><span class="op" id="4929719">)</span><span class="op" id="4929720">)</span>&nbsp;<span class="op" id="4929722">&lt;</span>&nbsp;<span class="ident" id="4929724"><a href="/debug/elf/file.go.html#4929614">s</a></span><span class="op" id="4929725">.</span><span class="ident" id="4929726">Size</span>&nbsp;<span class="op" id="4929731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929736">return</span>&nbsp;<span class="ident" id="4929743">nil</span><span class="op" id="4929746">,</span>&nbsp;<span class="ident" id="4929748"><a href="/debug/elf/file.go.html#4929672">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929754">}</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929758"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4929761">[</span><span class="ident" id="4929762"><a href="/debug/elf/file.go.html#4929561">i</a></span><span class="op" id="4929763">]</span>&nbsp;<span class="op" id="4929765">=</span>&nbsp;<span class="ident" id="4929767"><a href="/debug/elf/file.go.html#4929669">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4929770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4929774">//&nbsp;If&nbsp;there&#39;s&nbsp;a&nbsp;relocation&nbsp;table&nbsp;for&nbsp;.debug_info,&nbsp;we&nbsp;have&nbsp;to&nbsp;process&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4929847">//&nbsp;now&nbsp;otherwise&nbsp;the&nbsp;data&nbsp;in&nbsp;.debug_info&nbsp;is&nbsp;invalid&nbsp;for&nbsp;x86-64&nbsp;objects.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4929920">rela</span>&nbsp;<span class="op" id="4929925">:=</span>&nbsp;<span class="ident" id="4929928"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4929929">.</span><span class="ident" id="4929930">Section</span><span class="op" id="4929937">(</span><span class="string" id="4929938">&#34;.rela.debug_info&#34;</span><span class="op" id="4929956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4929959">if</span>&nbsp;<span class="ident" id="4929962"><a href="/debug/elf/file.go.html#4929920">rela</a></span>&nbsp;<span class="op" id="4929967">!=</span>&nbsp;<span class="ident" id="4929970">nil</span>&nbsp;<span class="op" id="4929974">&amp;&amp;</span>&nbsp;<span class="ident" id="4929977"><a href="/debug/elf/file.go.html#4929920">rela</a></span><span class="op" id="4929981">.</span><span class="ident" id="4929982">Type</span>&nbsp;<span class="op" id="4929987">==</span>&nbsp;<span class="ident" id="4929990"><a href="/debug/elf/elf.go.html#4860462">SHT_RELA</a></span>&nbsp;<span class="op" id="4929999">&amp;&amp;</span>&nbsp;<span class="op" id="4930002">(</span><span class="ident" id="4930003"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930004">.</span><span class="ident" id="4930005">Machine</span>&nbsp;<span class="op" id="4930013">==</span>&nbsp;<span class="ident" id="4930016"><a href="/debug/elf/elf.go.html#4857444">EM_X86_64</a></span>&nbsp;<span class="op" id="4930026">||</span>&nbsp;<span class="ident" id="4930029"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930030">.</span><span class="ident" id="4930031">Machine</span>&nbsp;<span class="op" id="4930039">==</span>&nbsp;<span class="ident" id="4930042"><a href="/debug/elf/elf.go.html#4857510">EM_AARCH64</a></span><span class="op" id="4930052">)</span>&nbsp;<span class="op" id="4930054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930058">data</span><span class="op" id="4930062">,</span>&nbsp;<span class="ident" id="4930064">err</span>&nbsp;<span class="op" id="4930068">:=</span>&nbsp;<span class="ident" id="4930071"><a href="/debug/elf/file.go.html#4929920">rela</a></span><span class="op" id="4930075">.</span><span class="ident" id="4930076">Data</span><span class="op" id="4930080">(</span><span class="op" id="4930081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930085">if</span>&nbsp;<span class="ident" id="4930088"><a href="/debug/elf/file.go.html#4930064">err</a></span>&nbsp;<span class="op" id="4930092">!=</span>&nbsp;<span class="ident" id="4930095">nil</span>&nbsp;<span class="op" id="4930099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930104">return</span>&nbsp;<span class="ident" id="4930111">nil</span><span class="op" id="4930114">,</span>&nbsp;<span class="ident" id="4930116"><a href="/debug/elf/file.go.html#4930064">err</a></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930126"><a href="/debug/elf/file.go.html#4930064">err</a></span>&nbsp;<span class="op" id="4930130">=</span>&nbsp;<span class="ident" id="4930132"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930133">.</span><span class="ident" id="4930134">applyRelocations</span><span class="op" id="4930150">(</span><span class="ident" id="4930151"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4930154">[</span><span class="num" id="4930155">1</span><span class="op" id="4930156">]</span><span class="op" id="4930157">,</span>&nbsp;<span class="ident" id="4930159"><a href="/debug/elf/file.go.html#4930058">data</a></span><span class="op" id="4930163">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930167">if</span>&nbsp;<span class="ident" id="4930170"><a href="/debug/elf/file.go.html#4930064">err</a></span>&nbsp;<span class="op" id="4930174">!=</span>&nbsp;<span class="ident" id="4930177">nil</span>&nbsp;<span class="op" id="4930181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930186">return</span>&nbsp;<span class="ident" id="4930193">nil</span><span class="op" id="4930196">,</span>&nbsp;<span class="ident" id="4930198"><a href="/debug/elf/file.go.html#4930064">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930204">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4930211">//&nbsp;When&nbsp;using&nbsp;clang&nbsp;we&nbsp;need&nbsp;to&nbsp;process&nbsp;relocations&nbsp;even&nbsp;for&nbsp;386.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930277">rel</span>&nbsp;<span class="op" id="4930281">:=</span>&nbsp;<span class="ident" id="4930284"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930285">.</span><span class="ident" id="4930286">Section</span><span class="op" id="4930293">(</span><span class="string" id="4930294">&#34;.rel.debug_info&#34;</span><span class="op" id="4930311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930314">if</span>&nbsp;<span class="ident" id="4930317"><a href="/debug/elf/file.go.html#4930277">rel</a></span>&nbsp;<span class="op" id="4930321">!=</span>&nbsp;<span class="ident" id="4930324">nil</span>&nbsp;<span class="op" id="4930328">&amp;&amp;</span>&nbsp;<span class="ident" id="4930331"><a href="/debug/elf/file.go.html#4930277">rel</a></span><span class="op" id="4930334">.</span><span class="ident" id="4930335">Type</span>&nbsp;<span class="op" id="4930340">==</span>&nbsp;<span class="ident" id="4930343"><a href="/debug/elf/elf.go.html#4860821">SHT_REL</a></span>&nbsp;<span class="op" id="4930351">&amp;&amp;</span>&nbsp;<span class="ident" id="4930354"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930355">.</span><span class="ident" id="4930356">Machine</span>&nbsp;<span class="op" id="4930364">==</span>&nbsp;<span class="ident" id="4930367"><a href="/debug/elf/elf.go.html#4855342">EM_386</a></span>&nbsp;<span class="op" id="4930374">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930378">data</span><span class="op" id="4930382">,</span>&nbsp;<span class="ident" id="4930384">err</span>&nbsp;<span class="op" id="4930388">:=</span>&nbsp;<span class="ident" id="4930391"><a href="/debug/elf/file.go.html#4930277">rel</a></span><span class="op" id="4930394">.</span><span class="ident" id="4930395">Data</span><span class="op" id="4930399">(</span><span class="op" id="4930400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930404">if</span>&nbsp;<span class="ident" id="4930407"><a href="/debug/elf/file.go.html#4930384">err</a></span>&nbsp;<span class="op" id="4930411">!=</span>&nbsp;<span class="ident" id="4930414">nil</span>&nbsp;<span class="op" id="4930418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930423">return</span>&nbsp;<span class="ident" id="4930430">nil</span><span class="op" id="4930433">,</span>&nbsp;<span class="ident" id="4930435"><a href="/debug/elf/file.go.html#4930384">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930441">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930445"><a href="/debug/elf/file.go.html#4930384">err</a></span>&nbsp;<span class="op" id="4930449">=</span>&nbsp;<span class="ident" id="4930451"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930452">.</span><span class="ident" id="4930453">applyRelocations</span><span class="op" id="4930469">(</span><span class="ident" id="4930470"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4930473">[</span><span class="num" id="4930474">1</span><span class="op" id="4930475">]</span><span class="op" id="4930476">,</span>&nbsp;<span class="ident" id="4930478"><a href="/debug/elf/file.go.html#4930378">data</a></span><span class="op" id="4930482">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930486">if</span>&nbsp;<span class="ident" id="4930489"><a href="/debug/elf/file.go.html#4930384">err</a></span>&nbsp;<span class="op" id="4930493">!=</span>&nbsp;<span class="ident" id="4930496">nil</span>&nbsp;<span class="op" id="4930500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930505">return</span>&nbsp;<span class="ident" id="4930512">nil</span><span class="op" id="4930515">,</span>&nbsp;<span class="ident" id="4930517"><a href="/debug/elf/file.go.html#4930384">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930530">abbrev</span><span class="op" id="4930536">,</span>&nbsp;<span class="ident" id="4930538">info</span><span class="op" id="4930542">,</span>&nbsp;<span class="ident" id="4930544">str</span>&nbsp;<span class="op" id="4930548">:=</span>&nbsp;<span class="ident" id="4930551"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4930554">[</span><span class="num" id="4930555">0</span><span class="op" id="4930556">]</span><span class="op" id="4930557">,</span>&nbsp;<span class="ident" id="4930559"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4930562">[</span><span class="num" id="4930563">1</span><span class="op" id="4930564">]</span><span class="op" id="4930565">,</span>&nbsp;<span class="ident" id="4930567"><a href="/debug/elf/file.go.html#4929533">dat</a></span><span class="op" id="4930570">[</span><span class="num" id="4930571">2</span><span class="op" id="4930572">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930575">d</span><span class="op" id="4930576">,</span>&nbsp;<span class="ident" id="4930578">err</span>&nbsp;<span class="op" id="4930582">:=</span>&nbsp;<span class="ident" id="4930585"><a href="/debug/elf/file.go.html#4913101">dwarf</a></span><span class="op" id="4930590">.</span><span class="ident" id="4930591">New</span><span class="op" id="4930594">(</span><span class="ident" id="4930595"><a href="/debug/elf/file.go.html#4930530">abbrev</a></span><span class="op" id="4930601">,</span>&nbsp;<span class="ident" id="4930603">nil</span><span class="op" id="4930606">,</span>&nbsp;<span class="ident" id="4930608">nil</span><span class="op" id="4930611">,</span>&nbsp;<span class="ident" id="4930613"><a href="/debug/elf/file.go.html#4930538">info</a></span><span class="op" id="4930617">,</span>&nbsp;<span class="ident" id="4930619">nil</span><span class="op" id="4930622">,</span>&nbsp;<span class="ident" id="4930624">nil</span><span class="op" id="4930627">,</span>&nbsp;<span class="ident" id="4930629">nil</span><span class="op" id="4930632">,</span>&nbsp;<span class="ident" id="4930634"><a href="/debug/elf/file.go.html#4930544">str</a></span><span class="op" id="4930637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930640">if</span>&nbsp;<span class="ident" id="4930643"><a href="/debug/elf/file.go.html#4930578">err</a></span>&nbsp;<span class="op" id="4930647">!=</span>&nbsp;<span class="ident" id="4930650">nil</span>&nbsp;<span class="op" id="4930654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930658">return</span>&nbsp;<span class="ident" id="4930665">nil</span><span class="op" id="4930668">,</span>&nbsp;<span class="ident" id="4930670"><a href="/debug/elf/file.go.html#4930578">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930675">}</span><br>
<span class="lineno">725</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4930679">//&nbsp;Look&nbsp;for&nbsp;DWARF4&nbsp;.debug_types&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930722">for</span>&nbsp;<span class="ident" id="4930726">i</span><span class="op" id="4930727">,</span>&nbsp;<span class="ident" id="4930729">s</span>&nbsp;<span class="op" id="4930731">:=</span>&nbsp;<span class="keyword" id="4930734">range</span>&nbsp;<span class="ident" id="4930740"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930741">.</span><span class="ident" id="4930742">Sections</span>&nbsp;<span class="op" id="4930751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930755">if</span>&nbsp;<span class="ident" id="4930758"><a href="/debug/elf/file.go.html#4930729">s</a></span><span class="op" id="4930759">.</span><span class="ident" id="4930760">Name</span>&nbsp;<span class="op" id="4930765">==</span>&nbsp;<span class="string" id="4930768">&#34;.debug_types&#34;</span>&nbsp;<span class="op" id="4930783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4930788">b</span><span class="op" id="4930789">,</span>&nbsp;<span class="ident" id="4930791">err</span>&nbsp;<span class="op" id="4930795">:=</span>&nbsp;<span class="ident" id="4930798"><a href="/debug/elf/file.go.html#4930729">s</a></span><span class="op" id="4930799">.</span><span class="ident" id="4930800">Data</span><span class="op" id="4930804">(</span><span class="op" id="4930805">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930810">if</span>&nbsp;<span class="ident" id="4930813"><a href="/debug/elf/file.go.html#4930791">err</a></span>&nbsp;<span class="op" id="4930817">!=</span>&nbsp;<span class="ident" id="4930820">nil</span>&nbsp;<span class="op" id="4930824">&amp;&amp;</span>&nbsp;<span class="ident" id="4930827">uint64</span><span class="op" id="4930833">(</span><span class="builtinfunc" id="4930834">len</span><span class="op" id="4930837">(</span><span class="ident" id="4930838"><a href="/debug/elf/file.go.html#4930788">b</a></span><span class="op" id="4930839">)</span><span class="op" id="4930840">)</span>&nbsp;<span class="op" id="4930842">&lt;</span>&nbsp;<span class="ident" id="4930844"><a href="/debug/elf/file.go.html#4930729">s</a></span><span class="op" id="4930845">.</span><span class="ident" id="4930846">Size</span>&nbsp;<span class="op" id="4930851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930857">return</span>&nbsp;<span class="ident" id="4930864">nil</span><span class="op" id="4930867">,</span>&nbsp;<span class="ident" id="4930869"><a href="/debug/elf/file.go.html#4930791">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930882">for</span>&nbsp;<span class="ident" id="4930886">_</span><span class="op" id="4930887">,</span>&nbsp;<span class="ident" id="4930889">r</span>&nbsp;<span class="op" id="4930891">:=</span>&nbsp;<span class="keyword" id="4930894">range</span>&nbsp;<span class="ident" id="4930900"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4930901">.</span><span class="ident" id="4930902">Sections</span>&nbsp;<span class="op" id="4930911">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930917">if</span>&nbsp;<span class="ident" id="4930920"><a href="/debug/elf/file.go.html#4930889">r</a></span><span class="op" id="4930921">.</span><span class="ident" id="4930922">Type</span>&nbsp;<span class="op" id="4930927">!=</span>&nbsp;<span class="ident" id="4930930"><a href="/debug/elf/elf.go.html#4860462">SHT_RELA</a></span>&nbsp;<span class="op" id="4930939">&amp;&amp;</span>&nbsp;<span class="ident" id="4930942"><a href="/debug/elf/file.go.html#4930889">r</a></span><span class="op" id="4930943">.</span><span class="ident" id="4930944">Type</span>&nbsp;<span class="op" id="4930949">!=</span>&nbsp;<span class="ident" id="4930952"><a href="/debug/elf/elf.go.html#4860821">SHT_REL</a></span>&nbsp;<span class="op" id="4930960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930967">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4930980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4930986">if</span>&nbsp;<span class="builtintype" id="4930989">int</span><span class="op" id="4930992">(</span><span class="ident" id="4930993"><a href="/debug/elf/file.go.html#4930889">r</a></span><span class="op" id="4930994">.</span><span class="ident" id="4930995">Info</span><span class="op" id="4930999">)</span>&nbsp;<span class="op" id="4931001">!=</span>&nbsp;<span class="ident" id="4931004"><a href="/debug/elf/file.go.html#4930726">i</a></span>&nbsp;<span class="op" id="4931006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931013">continue</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4931032">rd</span><span class="op" id="4931034">,</span>&nbsp;<span class="ident" id="4931036">err</span>&nbsp;<span class="op" id="4931040">:=</span>&nbsp;<span class="ident" id="4931043"><a href="/debug/elf/file.go.html#4930889">r</a></span><span class="op" id="4931044">.</span><span class="ident" id="4931045">Data</span><span class="op" id="4931049">(</span><span class="op" id="4931050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931056">if</span>&nbsp;<span class="ident" id="4931059"><a href="/debug/elf/file.go.html#4931036">err</a></span>&nbsp;<span class="op" id="4931063">!=</span>&nbsp;<span class="ident" id="4931066">nil</span>&nbsp;<span class="op" id="4931070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931077">return</span>&nbsp;<span class="ident" id="4931084">nil</span><span class="op" id="4931087">,</span>&nbsp;<span class="ident" id="4931089"><a href="/debug/elf/file.go.html#4931036">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931097">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4931103"><a href="/debug/elf/file.go.html#4931036">err</a></span>&nbsp;<span class="op" id="4931107">=</span>&nbsp;<span class="ident" id="4931109"><a href="/debug/elf/file.go.html#4929273">f</a></span><span class="op" id="4931110">.</span><span class="ident" id="4931111">applyRelocations</span><span class="op" id="4931127">(</span><span class="ident" id="4931128"><a href="/debug/elf/file.go.html#4930788">b</a></span><span class="op" id="4931129">,</span>&nbsp;<span class="ident" id="4931131"><a href="/debug/elf/file.go.html#4931032">rd</a></span><span class="op" id="4931133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931139">if</span>&nbsp;<span class="ident" id="4931142"><a href="/debug/elf/file.go.html#4931036">err</a></span>&nbsp;<span class="op" id="4931146">!=</span>&nbsp;<span class="ident" id="4931149">nil</span>&nbsp;<span class="op" id="4931153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931160">return</span>&nbsp;<span class="ident" id="4931167">nil</span><span class="op" id="4931170">,</span>&nbsp;<span class="ident" id="4931172"><a href="/debug/elf/file.go.html#4931036">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931185">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4931191"><a href="/debug/elf/file.go.html#4930791">err</a></span>&nbsp;<span class="op" id="4931195">=</span>&nbsp;<span class="ident" id="4931197"><a href="/debug/elf/file.go.html#4930575">d</a></span><span class="op" id="4931198">.</span><span class="ident" id="4931199">AddTypes</span><span class="op" id="4931207">(</span><span class="ident" id="4931208"><a href="/debug/elf/file.go.html#4913145">fmt</a></span><span class="op" id="4931211">.</span><span class="ident" id="4931212">Sprintf</span><span class="op" id="4931219">(</span><span class="string" id="4931220">&#34;types-%d&#34;</span><span class="op" id="4931230">,</span>&nbsp;<span class="ident" id="4931232"><a href="/debug/elf/file.go.html#4930726">i</a></span><span class="op" id="4931233">)</span><span class="op" id="4931234">,</span>&nbsp;<span class="ident" id="4931236"><a href="/debug/elf/file.go.html#4930788">b</a></span><span class="op" id="4931237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931242">if</span>&nbsp;<span class="ident" id="4931245"><a href="/debug/elf/file.go.html#4930791">err</a></span>&nbsp;<span class="op" id="4931249">!=</span>&nbsp;<span class="ident" id="4931252">nil</span>&nbsp;<span class="op" id="4931256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931262">return</span>&nbsp;<span class="ident" id="4931269">nil</span><span class="op" id="4931272">,</span>&nbsp;<span class="ident" id="4931274"><a href="/debug/elf/file.go.html#4930791">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931281">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4931288">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931292">return</span>&nbsp;<span class="ident" id="4931299"><a href="/debug/elf/file.go.html#4930575">d</a></span><span class="op" id="4931300">,</span>&nbsp;<span class="ident" id="4931302">nil</span><br>
<span class="lineno"></span><span class="op" id="4931306">}</span><br>
<span class="lineno">760</span><br>
<span class="lineno"></span><span class="comment" id="4931309">//&nbsp;Symbols&nbsp;returns&nbsp;the&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order</span><br>
<span class="lineno"></span><span class="comment" id="4931392">//&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4931413">//</span><br>
<span class="lineno"></span><span class="comment" id="4931416">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Go&nbsp;1.0,&nbsp;Symbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno">765</span><span class="comment" id="4931492">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4931566">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4931612">func</span>&nbsp;<span class="op" id="4931617">(</span><span class="ident" id="4931618">f</span>&nbsp;<span class="op" id="4931620">*</span><span class="ident" id="4931621"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4931625">)</span>&nbsp;<span class="ident" id="4931627">Symbols</span><span class="op" id="4931634">(</span><span class="op" id="4931635">)</span>&nbsp;<span class="op" id="4931637">(</span><span class="op" id="4931638">[</span><span class="op" id="4931639">]</span><span class="ident" id="4931640"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4931646">,</span>&nbsp;<span class="builtintype" id="4931648">error</span><span class="op" id="4931653">)</span>&nbsp;<span class="op" id="4931655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4931658">sym</span><span class="op" id="4931661">,</span>&nbsp;<span class="ident" id="4931663">_</span><span class="op" id="4931664">,</span>&nbsp;<span class="ident" id="4931666">err</span>&nbsp;<span class="op" id="4931670">:=</span>&nbsp;<span class="ident" id="4931673"><a href="/debug/elf/file.go.html#4931618">f</a></span><span class="op" id="4931674">.</span><span class="ident" id="4931675">getSymbols</span><span class="op" id="4931685">(</span><span class="ident" id="4931686"><a href="/debug/elf/elf.go.html#4860318">SHT_SYMTAB</a></span><span class="op" id="4931696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4931699">return</span>&nbsp;<span class="ident" id="4931706"><a href="/debug/elf/file.go.html#4931658">sym</a></span><span class="op" id="4931709">,</span>&nbsp;<span class="ident" id="4931711"><a href="/debug/elf/file.go.html#4931666">err</a></span><br>
<span class="lineno">770</span><span class="op" id="4931715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4931718">//&nbsp;DynamicSymbols&nbsp;returns&nbsp;the&nbsp;dynamic&nbsp;symbol&nbsp;table&nbsp;for&nbsp;f.&nbsp;The&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="4931788">//&nbsp;will&nbsp;be&nbsp;listed&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;appear&nbsp;in&nbsp;f.</span><br>
<span class="lineno"></span><span class="comment" id="4931837">//</span><br>
<span class="lineno">775</span><span class="comment" id="4931840">//&nbsp;For&nbsp;compatibility&nbsp;with&nbsp;Symbols,&nbsp;DynamicSymbols&nbsp;omits&nbsp;the&nbsp;null&nbsp;symbol&nbsp;at&nbsp;index&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="4931924">//&nbsp;After&nbsp;retrieving&nbsp;the&nbsp;symbols&nbsp;as&nbsp;symtab,&nbsp;an&nbsp;externally&nbsp;supplied&nbsp;index&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="4931998">//&nbsp;corresponds&nbsp;to&nbsp;symtab[x-1],&nbsp;not&nbsp;symtab[x].</span><br>
<span class="lineno"></span><span class="keyword" id="4932044">func</span>&nbsp;<span class="op" id="4932049">(</span><span class="ident" id="4932050">f</span>&nbsp;<span class="op" id="4932052">*</span><span class="ident" id="4932053"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4932057">)</span>&nbsp;<span class="ident" id="4932059">DynamicSymbols</span><span class="op" id="4932073">(</span><span class="op" id="4932074">)</span>&nbsp;<span class="op" id="4932076">(</span><span class="op" id="4932077">[</span><span class="op" id="4932078">]</span><span class="ident" id="4932079"><a href="/debug/elf/file.go.html#4915784">Symbol</a></span><span class="op" id="4932085">,</span>&nbsp;<span class="builtintype" id="4932087">error</span><span class="op" id="4932092">)</span>&nbsp;<span class="op" id="4932094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932097">sym</span><span class="op" id="4932100">,</span>&nbsp;<span class="ident" id="4932102">_</span><span class="op" id="4932103">,</span>&nbsp;<span class="ident" id="4932105">err</span>&nbsp;<span class="op" id="4932109">:=</span>&nbsp;<span class="ident" id="4932112"><a href="/debug/elf/file.go.html#4932050">f</a></span><span class="op" id="4932113">.</span><span class="ident" id="4932114">getSymbols</span><span class="op" id="4932124">(</span><span class="ident" id="4932125"><a href="/debug/elf/elf.go.html#4860982">SHT_DYNSYM</a></span><span class="op" id="4932135">)</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932138">return</span>&nbsp;<span class="ident" id="4932145"><a href="/debug/elf/file.go.html#4932097">sym</a></span><span class="op" id="4932148">,</span>&nbsp;<span class="ident" id="4932150"><a href="/debug/elf/file.go.html#4932105">err</a></span><br>
<span class="lineno"></span><span class="op" id="4932154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4932157">type</span>&nbsp;<span class="ident" id="4932162">ImportedSymbol</span>&nbsp;<span class="keyword" id="4932177">struct</span>&nbsp;<span class="op" id="4932184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932187">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4932195">string</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932203">Version</span>&nbsp;<span class="builtintype" id="4932211">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932219">Library</span>&nbsp;<span class="builtintype" id="4932227">string</span><br>
<span class="lineno"></span><span class="op" id="4932234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4932237">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno">790</span><span class="comment" id="4932289">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4932344">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="4932398">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="4932434">func</span>&nbsp;<span class="op" id="4932439">(</span><span class="ident" id="4932440">f</span>&nbsp;<span class="op" id="4932442">*</span><span class="ident" id="4932443"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4932447">)</span>&nbsp;<span class="ident" id="4932449">ImportedSymbols</span><span class="op" id="4932464">(</span><span class="op" id="4932465">)</span>&nbsp;<span class="op" id="4932467">(</span><span class="op" id="4932468">[</span><span class="op" id="4932469">]</span><span class="ident" id="4932470"><a href="/debug/elf/file.go.html#4932162">ImportedSymbol</a></span><span class="op" id="4932484">,</span>&nbsp;<span class="builtintype" id="4932486">error</span><span class="op" id="4932491">)</span>&nbsp;<span class="op" id="4932493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932496">sym</span><span class="op" id="4932499">,</span>&nbsp;<span class="ident" id="4932501">str</span><span class="op" id="4932504">,</span>&nbsp;<span class="ident" id="4932506">err</span>&nbsp;<span class="op" id="4932510">:=</span>&nbsp;<span class="ident" id="4932513"><a href="/debug/elf/file.go.html#4932440">f</a></span><span class="op" id="4932514">.</span><span class="ident" id="4932515">getSymbols</span><span class="op" id="4932525">(</span><span class="ident" id="4932526"><a href="/debug/elf/elf.go.html#4860982">SHT_DYNSYM</a></span><span class="op" id="4932536">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932539">if</span>&nbsp;<span class="ident" id="4932542"><a href="/debug/elf/file.go.html#4932506">err</a></span>&nbsp;<span class="op" id="4932546">!=</span>&nbsp;<span class="ident" id="4932549">nil</span>&nbsp;<span class="op" id="4932553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932557">return</span>&nbsp;<span class="ident" id="4932564">nil</span><span class="op" id="4932567">,</span>&nbsp;<span class="ident" id="4932569"><a href="/debug/elf/file.go.html#4932506">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4932574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932577"><a href="/debug/elf/file.go.html#4932440">f</a></span><span class="op" id="4932578">.</span><span class="ident" id="4932579">gnuVersionInit</span><span class="op" id="4932593">(</span><span class="ident" id="4932594"><a href="/debug/elf/file.go.html#4932501">str</a></span><span class="op" id="4932597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932600">var</span>&nbsp;<span class="ident" id="4932604">all</span>&nbsp;<span class="op" id="4932608">[</span><span class="op" id="4932609">]</span><span class="ident" id="4932610"><a href="/debug/elf/file.go.html#4932162">ImportedSymbol</a></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932626">for</span>&nbsp;<span class="ident" id="4932630">i</span><span class="op" id="4932631">,</span>&nbsp;<span class="ident" id="4932633">s</span>&nbsp;<span class="op" id="4932635">:=</span>&nbsp;<span class="keyword" id="4932638">range</span>&nbsp;<span class="ident" id="4932644"><a href="/debug/elf/file.go.html#4932496">sym</a></span>&nbsp;<span class="op" id="4932648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932652">if</span>&nbsp;<span class="ident" id="4932655"><a href="/debug/elf/elf.go.html#4908682">ST_BIND</a></span><span class="op" id="4932662">(</span><span class="ident" id="4932663"><a href="/debug/elf/file.go.html#4932633">s</a></span><span class="op" id="4932664">.</span><span class="ident" id="4932665">Info</span><span class="op" id="4932669">)</span>&nbsp;<span class="op" id="4932671">==</span>&nbsp;<span class="ident" id="4932674"><a href="/debug/elf/elf.go.html#4872499">STB_GLOBAL</a></span>&nbsp;<span class="op" id="4932685">&amp;&amp;</span>&nbsp;<span class="ident" id="4932688"><a href="/debug/elf/file.go.html#4932633">s</a></span><span class="op" id="4932689">.</span><span class="ident" id="4932690">Section</span>&nbsp;<span class="op" id="4932698">==</span>&nbsp;<span class="ident" id="4932701"><a href="/debug/elf/elf.go.html#4859081">SHN_UNDEF</a></span>&nbsp;<span class="op" id="4932711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932716"><a href="/debug/elf/file.go.html#4932604">all</a></span>&nbsp;<span class="op" id="4932720">=</span>&nbsp;<span class="builtinfunc" id="4932722">append</span><span class="op" id="4932728">(</span><span class="ident" id="4932729"><a href="/debug/elf/file.go.html#4932604">all</a></span><span class="op" id="4932732">,</span>&nbsp;<span class="ident" id="4932734"><a href="/debug/elf/file.go.html#4932162">ImportedSymbol</a></span><span class="op" id="4932748">{</span><span class="ident" id="4932749">Name</span><span class="op" id="4932753">:</span>&nbsp;<span class="ident" id="4932755"><a href="/debug/elf/file.go.html#4932633">s</a></span><span class="op" id="4932756">.</span><span class="ident" id="4932757">Name</span><span class="op" id="4932761">}</span><span class="op" id="4932762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932767"><a href="/debug/elf/file.go.html#4932440">f</a></span><span class="op" id="4932768">.</span><span class="ident" id="4932769">gnuVersion</span><span class="op" id="4932779">(</span><span class="ident" id="4932780"><a href="/debug/elf/file.go.html#4932630">i</a></span><span class="op" id="4932781">,</span>&nbsp;<span class="op" id="4932783">&amp;</span><span class="ident" id="4932784"><a href="/debug/elf/file.go.html#4932604">all</a></span><span class="op" id="4932787">[</span><span class="builtinfunc" id="4932788">len</span><span class="op" id="4932791">(</span><span class="ident" id="4932792"><a href="/debug/elf/file.go.html#4932604">all</a></span><span class="op" id="4932795">)</span><span class="op" id="4932796">-</span><span class="num" id="4932797">1</span><span class="op" id="4932798">]</span><span class="op" id="4932799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4932803">}</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4932806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4932809">return</span>&nbsp;<span class="ident" id="4932816"><a href="/debug/elf/file.go.html#4932604">all</a></span><span class="op" id="4932819">,</span>&nbsp;<span class="ident" id="4932821">nil</span><br>
<span class="lineno"></span><span class="op" id="4932825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4932828">type</span>&nbsp;<span class="ident" id="4932833">verneed</span>&nbsp;<span class="keyword" id="4932841">struct</span>&nbsp;<span class="op" id="4932848">{</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932851">File</span>&nbsp;<span class="builtintype" id="4932856">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4932864">Name</span>&nbsp;<span class="builtintype" id="4932869">string</span><br>
<span class="lineno"></span><span class="op" id="4932876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4932879">//&nbsp;gnuVersionInit&nbsp;parses&nbsp;the&nbsp;GNU&nbsp;version&nbsp;tables</span><br>
<span class="lineno">815</span><span class="comment" id="4932927">//&nbsp;for&nbsp;use&nbsp;by&nbsp;calls&nbsp;to&nbsp;gnuVersion.</span><br>
<span class="lineno"></span><span class="keyword" id="4932962">func</span>&nbsp;<span class="op" id="4932967">(</span><span class="ident" id="4932968">f</span>&nbsp;<span class="op" id="4932970">*</span><span class="ident" id="4932971"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4932975">)</span>&nbsp;<span class="ident" id="4932977">gnuVersionInit</span><span class="op" id="4932991">(</span><span class="ident" id="4932992">str</span>&nbsp;<span class="op" id="4932996">[</span><span class="op" id="4932997">]</span><span class="builtintype" id="4932998">byte</span><span class="op" id="4933002">)</span>&nbsp;<span class="op" id="4933004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4933007">//&nbsp;Accumulate&nbsp;verneed&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933043">vn</span>&nbsp;<span class="op" id="4933046">:=</span>&nbsp;<span class="ident" id="4933049"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933050">.</span><span class="ident" id="4933051">SectionByType</span><span class="op" id="4933064">(</span><span class="ident" id="4933065"><a href="/debug/elf/elf.go.html#4861844">SHT_GNU_VERNEED</a></span><span class="op" id="4933080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933083">if</span>&nbsp;<span class="ident" id="4933086"><a href="/debug/elf/file.go.html#4933043">vn</a></span>&nbsp;<span class="op" id="4933089">==</span>&nbsp;<span class="ident" id="4933092">nil</span>&nbsp;<span class="op" id="4933096">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933100">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4933108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933111">d</span><span class="op" id="4933112">,</span>&nbsp;<span class="ident" id="4933114">_</span>&nbsp;<span class="op" id="4933116">:=</span>&nbsp;<span class="ident" id="4933119"><a href="/debug/elf/file.go.html#4933043">vn</a></span><span class="op" id="4933121">.</span><span class="ident" id="4933122">Data</span><span class="op" id="4933126">(</span><span class="op" id="4933127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933131">var</span>&nbsp;<span class="ident" id="4933135">need</span>&nbsp;<span class="op" id="4933140">[</span><span class="op" id="4933141">]</span><span class="ident" id="4933142"><a href="/debug/elf/file.go.html#4932833">verneed</a></span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933151">i</span>&nbsp;<span class="op" id="4933153">:=</span>&nbsp;<span class="num" id="4933156">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933159">for</span>&nbsp;<span class="op" id="4933163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933167">if</span>&nbsp;<span class="ident" id="4933170"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933171">+</span><span class="num" id="4933172">16</span>&nbsp;<span class="op" id="4933175">&gt;</span>&nbsp;<span class="builtinfunc" id="4933177">len</span><span class="op" id="4933180">(</span><span class="ident" id="4933181"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933182">)</span>&nbsp;<span class="op" id="4933184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933189">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4933197">}</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933201">vers</span>&nbsp;<span class="op" id="4933206">:=</span>&nbsp;<span class="ident" id="4933209"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933210">.</span><span class="ident" id="4933211">ByteOrder</span><span class="op" id="4933220">.</span><span class="ident" id="4933221">Uint16</span><span class="op" id="4933227">(</span><span class="ident" id="4933228"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933229">[</span><span class="ident" id="4933230"><a href="/debug/elf/file.go.html#4933151">i</a></span>&nbsp;<span class="op" id="4933232">:</span>&nbsp;<span class="ident" id="4933234"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933235">+</span><span class="num" id="4933236">2</span><span class="op" id="4933237">]</span><span class="op" id="4933238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933242">if</span>&nbsp;<span class="ident" id="4933245"><a href="/debug/elf/file.go.html#4933201">vers</a></span>&nbsp;<span class="op" id="4933250">!=</span>&nbsp;<span class="num" id="4933253">1</span>&nbsp;<span class="op" id="4933255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933260">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4933268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933272">cnt</span>&nbsp;<span class="op" id="4933276">:=</span>&nbsp;<span class="ident" id="4933279"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933280">.</span><span class="ident" id="4933281">ByteOrder</span><span class="op" id="4933290">.</span><span class="ident" id="4933291">Uint16</span><span class="op" id="4933297">(</span><span class="ident" id="4933298"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933299">[</span><span class="ident" id="4933300"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933301">+</span><span class="num" id="4933302">2</span>&nbsp;<span class="op" id="4933304">:</span>&nbsp;<span class="ident" id="4933306"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933307">+</span><span class="num" id="4933308">4</span><span class="op" id="4933309">]</span><span class="op" id="4933310">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933314">fileoff</span>&nbsp;<span class="op" id="4933322">:=</span>&nbsp;<span class="ident" id="4933325"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933326">.</span><span class="ident" id="4933327">ByteOrder</span><span class="op" id="4933336">.</span><span class="ident" id="4933337">Uint32</span><span class="op" id="4933343">(</span><span class="ident" id="4933344"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933345">[</span><span class="ident" id="4933346"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933347">+</span><span class="num" id="4933348">4</span>&nbsp;<span class="op" id="4933350">:</span>&nbsp;<span class="ident" id="4933352"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933353">+</span><span class="num" id="4933354">8</span><span class="op" id="4933355">]</span><span class="op" id="4933356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933360">aux</span>&nbsp;<span class="op" id="4933364">:=</span>&nbsp;<span class="ident" id="4933367"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933368">.</span><span class="ident" id="4933369">ByteOrder</span><span class="op" id="4933378">.</span><span class="ident" id="4933379">Uint32</span><span class="op" id="4933385">(</span><span class="ident" id="4933386"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933387">[</span><span class="ident" id="4933388"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933389">+</span><span class="num" id="4933390">8</span>&nbsp;<span class="op" id="4933392">:</span>&nbsp;<span class="ident" id="4933394"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933395">+</span><span class="num" id="4933396">12</span><span class="op" id="4933398">]</span><span class="op" id="4933399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933403">next</span>&nbsp;<span class="op" id="4933408">:=</span>&nbsp;<span class="ident" id="4933411"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933412">.</span><span class="ident" id="4933413">ByteOrder</span><span class="op" id="4933422">.</span><span class="ident" id="4933423">Uint32</span><span class="op" id="4933429">(</span><span class="ident" id="4933430"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933431">[</span><span class="ident" id="4933432"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933433">+</span><span class="num" id="4933434">12</span>&nbsp;<span class="op" id="4933437">:</span>&nbsp;<span class="ident" id="4933439"><a href="/debug/elf/file.go.html#4933151">i</a></span><span class="op" id="4933440">+</span><span class="num" id="4933441">16</span><span class="op" id="4933443">]</span><span class="op" id="4933444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933448">file</span><span class="op" id="4933452">,</span>&nbsp;<span class="ident" id="4933454">_</span>&nbsp;<span class="op" id="4933456">:=</span>&nbsp;<span class="ident" id="4933459"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4933468">(</span><span class="ident" id="4933469"><a href="/debug/elf/file.go.html#4932992">str</a></span><span class="op" id="4933472">,</span>&nbsp;<span class="builtintype" id="4933474">int</span><span class="op" id="4933477">(</span><span class="ident" id="4933478"><a href="/debug/elf/file.go.html#4933314">fileoff</a></span><span class="op" id="4933485">)</span><span class="op" id="4933486">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933491">var</span>&nbsp;<span class="ident" id="4933495">name</span>&nbsp;<span class="builtintype" id="4933500">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933509">j</span>&nbsp;<span class="op" id="4933511">:=</span>&nbsp;<span class="ident" id="4933514"><a href="/debug/elf/file.go.html#4933151">i</a></span>&nbsp;<span class="op" id="4933516">+</span>&nbsp;<span class="builtintype" id="4933518">int</span><span class="op" id="4933521">(</span><span class="ident" id="4933522"><a href="/debug/elf/file.go.html#4933360">aux</a></span><span class="op" id="4933525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933529">for</span>&nbsp;<span class="ident" id="4933533">c</span>&nbsp;<span class="op" id="4933535">:=</span>&nbsp;<span class="num" id="4933538">0</span><span class="op" id="4933539">;</span>&nbsp;<span class="ident" id="4933541"><a href="/debug/elf/file.go.html#4933533">c</a></span>&nbsp;<span class="op" id="4933543">&lt;</span>&nbsp;<span class="builtintype" id="4933545">int</span><span class="op" id="4933548">(</span><span class="ident" id="4933549"><a href="/debug/elf/file.go.html#4933272">cnt</a></span><span class="op" id="4933552">)</span><span class="op" id="4933553">;</span>&nbsp;<span class="ident" id="4933555"><a href="/debug/elf/file.go.html#4933533">c</a></span><span class="op" id="4933556">++</span>&nbsp;<span class="op" id="4933559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933564">if</span>&nbsp;<span class="ident" id="4933567"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933568">+</span><span class="num" id="4933569">16</span>&nbsp;<span class="op" id="4933572">&gt;</span>&nbsp;<span class="builtinfunc" id="4933574">len</span><span class="op" id="4933577">(</span><span class="ident" id="4933578"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933579">)</span>&nbsp;<span class="op" id="4933581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933587">break</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4933596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4933601">//&nbsp;hash&nbsp;:=&nbsp;f.ByteOrder.Uint32(d[j:j+4])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4933644">//&nbsp;flags&nbsp;:=&nbsp;f.ByteOrder.Uint16(d[j+4:j+6])</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933690">other</span>&nbsp;<span class="op" id="4933696">:=</span>&nbsp;<span class="ident" id="4933699"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933700">.</span><span class="ident" id="4933701">ByteOrder</span><span class="op" id="4933710">.</span><span class="ident" id="4933711">Uint16</span><span class="op" id="4933717">(</span><span class="ident" id="4933718"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933719">[</span><span class="ident" id="4933720"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933721">+</span><span class="num" id="4933722">6</span>&nbsp;<span class="op" id="4933724">:</span>&nbsp;<span class="ident" id="4933726"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933727">+</span><span class="num" id="4933728">8</span><span class="op" id="4933729">]</span><span class="op" id="4933730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933735">nameoff</span>&nbsp;<span class="op" id="4933743">:=</span>&nbsp;<span class="ident" id="4933746"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933747">.</span><span class="ident" id="4933748">ByteOrder</span><span class="op" id="4933757">.</span><span class="ident" id="4933758">Uint32</span><span class="op" id="4933764">(</span><span class="ident" id="4933765"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933766">[</span><span class="ident" id="4933767"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933768">+</span><span class="num" id="4933769">8</span>&nbsp;<span class="op" id="4933771">:</span>&nbsp;<span class="ident" id="4933773"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933774">+</span><span class="num" id="4933775">12</span><span class="op" id="4933777">]</span><span class="op" id="4933778">)</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933783">next</span>&nbsp;<span class="op" id="4933788">:=</span>&nbsp;<span class="ident" id="4933791"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4933792">.</span><span class="ident" id="4933793">ByteOrder</span><span class="op" id="4933802">.</span><span class="ident" id="4933803">Uint32</span><span class="op" id="4933809">(</span><span class="ident" id="4933810"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4933811">[</span><span class="ident" id="4933812"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933813">+</span><span class="num" id="4933814">12</span>&nbsp;<span class="op" id="4933817">:</span>&nbsp;<span class="ident" id="4933819"><a href="/debug/elf/file.go.html#4933509">j</a></span><span class="op" id="4933820">+</span><span class="num" id="4933821">16</span><span class="op" id="4933823">]</span><span class="op" id="4933824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933829"><a href="/debug/elf/file.go.html#4933495">name</a></span><span class="op" id="4933833">,</span>&nbsp;<span class="ident" id="4933835">_</span>&nbsp;<span class="op" id="4933837">=</span>&nbsp;<span class="ident" id="4933839"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4933848">(</span><span class="ident" id="4933849"><a href="/debug/elf/file.go.html#4932992">str</a></span><span class="op" id="4933852">,</span>&nbsp;<span class="builtintype" id="4933854">int</span><span class="op" id="4933857">(</span><span class="ident" id="4933858"><a href="/debug/elf/file.go.html#4933735">nameoff</a></span><span class="op" id="4933865">)</span><span class="op" id="4933866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933871">ndx</span>&nbsp;<span class="op" id="4933875">:=</span>&nbsp;<span class="builtintype" id="4933878">int</span><span class="op" id="4933881">(</span><span class="ident" id="4933882"><a href="/debug/elf/file.go.html#4933690">other</a></span><span class="op" id="4933887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4933892">if</span>&nbsp;<span class="ident" id="4933895"><a href="/debug/elf/file.go.html#4933871">ndx</a></span>&nbsp;<span class="op" id="4933899">&gt;=</span>&nbsp;<span class="builtinfunc" id="4933902">len</span><span class="op" id="4933905">(</span><span class="ident" id="4933906"><a href="/debug/elf/file.go.html#4933135">need</a></span><span class="op" id="4933910">)</span>&nbsp;<span class="op" id="4933912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933918">a</span>&nbsp;<span class="op" id="4933920">:=</span>&nbsp;<span class="builtinfunc" id="4933923">make</span><span class="op" id="4933927">(</span><span class="op" id="4933928">[</span><span class="op" id="4933929">]</span><span class="ident" id="4933930"><a href="/debug/elf/file.go.html#4932833">verneed</a></span><span class="op" id="4933937">,</span>&nbsp;<span class="num" id="4933939">2</span><span class="op" id="4933940">*</span><span class="op" id="4933941">(</span><span class="ident" id="4933942"><a href="/debug/elf/file.go.html#4933871">ndx</a></span><span class="op" id="4933945">+</span><span class="num" id="4933946">1</span><span class="op" id="4933947">)</span><span class="op" id="4933948">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4933954">copy</span><span class="op" id="4933958">(</span><span class="ident" id="4933959"><a href="/debug/elf/file.go.html#4933918">a</a></span><span class="op" id="4933960">,</span>&nbsp;<span class="ident" id="4933962"><a href="/debug/elf/file.go.html#4933135">need</a></span><span class="op" id="4933966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933972"><a href="/debug/elf/file.go.html#4933135">need</a></span>&nbsp;<span class="op" id="4933977">=</span>&nbsp;<span class="ident" id="4933979"><a href="/debug/elf/file.go.html#4933918">a</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4933984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4933990"><a href="/debug/elf/file.go.html#4933135">need</a></span><span class="op" id="4933994">[</span><span class="ident" id="4933995"><a href="/debug/elf/file.go.html#4933871">ndx</a></span><span class="op" id="4933998">]</span>&nbsp;<span class="op" id="4934000">=</span>&nbsp;<span class="ident" id="4934002"><a href="/debug/elf/file.go.html#4932833">verneed</a></span><span class="op" id="4934009">{</span><span class="ident" id="4934010"><a href="/debug/elf/file.go.html#4933448">file</a></span><span class="op" id="4934014">,</span>&nbsp;<span class="ident" id="4934016"><a href="/debug/elf/file.go.html#4933495">name</a></span><span class="op" id="4934020">}</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934025">if</span>&nbsp;<span class="ident" id="4934028"><a href="/debug/elf/file.go.html#4933783">next</a></span>&nbsp;<span class="op" id="4934033">==</span>&nbsp;<span class="num" id="4934036">0</span>&nbsp;<span class="op" id="4934038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934044">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934058"><a href="/debug/elf/file.go.html#4933509">j</a></span>&nbsp;<span class="op" id="4934060">+=</span>&nbsp;<span class="builtintype" id="4934063">int</span><span class="op" id="4934066">(</span><span class="ident" id="4934067"><a href="/debug/elf/file.go.html#4933783">next</a></span><span class="op" id="4934071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934075">}</span><br>
<span class="lineno">865</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934080">if</span>&nbsp;<span class="ident" id="4934083"><a href="/debug/elf/file.go.html#4933403">next</a></span>&nbsp;<span class="op" id="4934088">==</span>&nbsp;<span class="num" id="4934091">0</span>&nbsp;<span class="op" id="4934093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934098">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934110"><a href="/debug/elf/file.go.html#4933151">i</a></span>&nbsp;<span class="op" id="4934112">+=</span>&nbsp;<span class="builtintype" id="4934115">int</span><span class="op" id="4934118">(</span><span class="ident" id="4934119"><a href="/debug/elf/file.go.html#4933403">next</a></span><span class="op" id="4934123">)</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4934130">//&nbsp;Versym&nbsp;parallels&nbsp;symbol&nbsp;table,&nbsp;indexing&nbsp;into&nbsp;verneed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934188">vs</span>&nbsp;<span class="op" id="4934191">:=</span>&nbsp;<span class="ident" id="4934194"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4934195">.</span><span class="ident" id="4934196">SectionByType</span><span class="op" id="4934209">(</span><span class="ident" id="4934210"><a href="/debug/elf/elf.go.html#4861921">SHT_GNU_VERSYM</a></span><span class="op" id="4934224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934227">if</span>&nbsp;<span class="ident" id="4934230"><a href="/debug/elf/file.go.html#4934188">vs</a></span>&nbsp;<span class="op" id="4934233">==</span>&nbsp;<span class="ident" id="4934236">nil</span>&nbsp;<span class="op" id="4934240">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934244">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934255"><a href="/debug/elf/file.go.html#4933111">d</a></span><span class="op" id="4934256">,</span>&nbsp;<span class="ident" id="4934258">_</span>&nbsp;<span class="op" id="4934260">=</span>&nbsp;<span class="ident" id="4934262"><a href="/debug/elf/file.go.html#4934188">vs</a></span><span class="op" id="4934264">.</span><span class="ident" id="4934265">Data</span><span class="op" id="4934269">(</span><span class="op" id="4934270">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934274"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4934275">.</span><span class="ident" id="4934276">gnuNeed</span>&nbsp;<span class="op" id="4934284">=</span>&nbsp;<span class="ident" id="4934286"><a href="/debug/elf/file.go.html#4933135">need</a></span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934292"><a href="/debug/elf/file.go.html#4932968">f</a></span><span class="op" id="4934293">.</span><span class="ident" id="4934294">gnuVersym</span>&nbsp;<span class="op" id="4934304">=</span>&nbsp;<span class="ident" id="4934306"><a href="/debug/elf/file.go.html#4933111">d</a></span><br>
<span class="lineno"></span><span class="op" id="4934308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4934311">//&nbsp;gnuVersion&nbsp;adds&nbsp;Library&nbsp;and&nbsp;Version&nbsp;information&nbsp;to&nbsp;sym,</span><br>
<span class="lineno"></span><span class="comment" id="4934370">//&nbsp;which&nbsp;came&nbsp;from&nbsp;offset&nbsp;i&nbsp;of&nbsp;the&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">885</span><span class="keyword" id="4934419">func</span>&nbsp;<span class="op" id="4934424">(</span><span class="ident" id="4934425">f</span>&nbsp;<span class="op" id="4934427">*</span><span class="ident" id="4934428"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4934432">)</span>&nbsp;<span class="ident" id="4934434">gnuVersion</span><span class="op" id="4934444">(</span><span class="ident" id="4934445">i</span>&nbsp;<span class="builtintype" id="4934447">int</span><span class="op" id="4934450">,</span>&nbsp;<span class="ident" id="4934452">sym</span>&nbsp;<span class="op" id="4934456">*</span><span class="ident" id="4934457"><a href="/debug/elf/file.go.html#4932162">ImportedSymbol</a></span><span class="op" id="4934471">)</span>&nbsp;<span class="op" id="4934473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4934476">//&nbsp;Each&nbsp;entry&nbsp;is&nbsp;two&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934505"><a href="/debug/elf/file.go.html#4934445">i</a></span>&nbsp;<span class="op" id="4934507">=</span>&nbsp;<span class="op" id="4934509">(</span><span class="ident" id="4934510"><a href="/debug/elf/file.go.html#4934445">i</a></span>&nbsp;<span class="op" id="4934512">+</span>&nbsp;<span class="num" id="4934514">1</span><span class="op" id="4934515">)</span>&nbsp;<span class="op" id="4934517">*</span>&nbsp;<span class="num" id="4934519">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934522">if</span>&nbsp;<span class="ident" id="4934525"><a href="/debug/elf/file.go.html#4934445">i</a></span>&nbsp;<span class="op" id="4934527">&gt;=</span>&nbsp;<span class="builtinfunc" id="4934530">len</span><span class="op" id="4934533">(</span><span class="ident" id="4934534"><a href="/debug/elf/file.go.html#4934425">f</a></span><span class="op" id="4934535">.</span><span class="ident" id="4934536">gnuVersym</span><span class="op" id="4934545">)</span>&nbsp;<span class="op" id="4934547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934551">return</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934562">j</span>&nbsp;<span class="op" id="4934564">:=</span>&nbsp;<span class="builtintype" id="4934567">int</span><span class="op" id="4934570">(</span><span class="ident" id="4934571"><a href="/debug/elf/file.go.html#4934425">f</a></span><span class="op" id="4934572">.</span><span class="ident" id="4934573">ByteOrder</span><span class="op" id="4934582">.</span><span class="ident" id="4934583">Uint16</span><span class="op" id="4934589">(</span><span class="ident" id="4934590"><a href="/debug/elf/file.go.html#4934425">f</a></span><span class="op" id="4934591">.</span><span class="ident" id="4934592">gnuVersym</span><span class="op" id="4934601">[</span><span class="ident" id="4934602"><a href="/debug/elf/file.go.html#4934445">i</a></span><span class="op" id="4934603">:</span><span class="op" id="4934604">]</span><span class="op" id="4934605">)</span><span class="op" id="4934606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934609">if</span>&nbsp;<span class="ident" id="4934612"><a href="/debug/elf/file.go.html#4934562">j</a></span>&nbsp;<span class="op" id="4934614">&lt;</span>&nbsp;<span class="num" id="4934616">2</span>&nbsp;<span class="op" id="4934618">||</span>&nbsp;<span class="ident" id="4934621"><a href="/debug/elf/file.go.html#4934562">j</a></span>&nbsp;<span class="op" id="4934623">&gt;=</span>&nbsp;<span class="builtinfunc" id="4934626">len</span><span class="op" id="4934629">(</span><span class="ident" id="4934630"><a href="/debug/elf/file.go.html#4934425">f</a></span><span class="op" id="4934631">.</span><span class="ident" id="4934632">gnuNeed</span><span class="op" id="4934639">)</span>&nbsp;<span class="op" id="4934641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934645">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4934653">}</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934656">n</span>&nbsp;<span class="op" id="4934658">:=</span>&nbsp;<span class="op" id="4934661">&amp;</span><span class="ident" id="4934662"><a href="/debug/elf/file.go.html#4934425">f</a></span><span class="op" id="4934663">.</span><span class="ident" id="4934664">gnuNeed</span><span class="op" id="4934671">[</span><span class="ident" id="4934672"><a href="/debug/elf/file.go.html#4934562">j</a></span><span class="op" id="4934673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934676"><a href="/debug/elf/file.go.html#4934452">sym</a></span><span class="op" id="4934679">.</span><span class="ident" id="4934680">Library</span>&nbsp;<span class="op" id="4934688">=</span>&nbsp;<span class="ident" id="4934690"><a href="/debug/elf/file.go.html#4934656">n</a></span><span class="op" id="4934691">.</span><span class="ident" id="4934692">File</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4934698"><a href="/debug/elf/file.go.html#4934452">sym</a></span><span class="op" id="4934701">.</span><span class="ident" id="4934702">Version</span>&nbsp;<span class="op" id="4934710">=</span>&nbsp;<span class="ident" id="4934712"><a href="/debug/elf/file.go.html#4934656">n</a></span><span class="op" id="4934713">.</span><span class="ident" id="4934714">Name</span><br>
<span class="lineno"></span><span class="op" id="4934719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="4934722">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="4934778">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4934833">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4934881">func</span>&nbsp;<span class="op" id="4934886">(</span><span class="ident" id="4934887">f</span>&nbsp;<span class="op" id="4934889">*</span><span class="ident" id="4934890"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4934894">)</span>&nbsp;<span class="ident" id="4934896">ImportedLibraries</span><span class="op" id="4934913">(</span><span class="op" id="4934914">)</span>&nbsp;<span class="op" id="4934916">(</span><span class="op" id="4934917">[</span><span class="op" id="4934918">]</span><span class="builtintype" id="4934919">string</span><span class="op" id="4934925">,</span>&nbsp;<span class="builtintype" id="4934927">error</span><span class="op" id="4934932">)</span>&nbsp;<span class="op" id="4934934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4934937">return</span>&nbsp;<span class="ident" id="4934944"><a href="/debug/elf/file.go.html#4934887">f</a></span><span class="op" id="4934945">.</span><span class="ident" id="4934946">DynString</span><span class="op" id="4934955">(</span><span class="ident" id="4934956"><a href="/debug/elf/elf.go.html#4866730">DT_NEEDED</a></span><span class="op" id="4934965">)</span><br>
<span class="lineno">905</span><span class="op" id="4934967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4934970">//&nbsp;DynString&nbsp;returns&nbsp;the&nbsp;strings&nbsp;listed&nbsp;for&nbsp;the&nbsp;given&nbsp;tag&nbsp;in&nbsp;the&nbsp;file&#39;s&nbsp;dynamic</span><br>
<span class="lineno"></span><span class="comment" id="4935050">//&nbsp;section.</span><br>
<span class="lineno"></span><span class="comment" id="4935062">//</span><br>
<span class="lineno">910</span><span class="comment" id="4935065">//&nbsp;The&nbsp;tag&nbsp;must&nbsp;be&nbsp;one&nbsp;that&nbsp;takes&nbsp;string&nbsp;values:&nbsp;DT_NEEDED,&nbsp;DT_SONAME,&nbsp;DT_RPATH,&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="4935149">//&nbsp;DT_RUNPATH.</span><br>
<span class="lineno"></span><span class="keyword" id="4935164">func</span>&nbsp;<span class="op" id="4935169">(</span><span class="ident" id="4935170">f</span>&nbsp;<span class="op" id="4935172">*</span><span class="ident" id="4935173"><a href="/debug/elf/file.go.html#4913533">File</a></span><span class="op" id="4935177">)</span>&nbsp;<span class="ident" id="4935179">DynString</span><span class="op" id="4935188">(</span><span class="ident" id="4935189">tag</span>&nbsp;<span class="ident" id="4935193"><a href="/debug/elf/elf.go.html#4866655">DynTag</a></span><span class="op" id="4935199">)</span>&nbsp;<span class="op" id="4935201">(</span><span class="op" id="4935202">[</span><span class="op" id="4935203">]</span><span class="builtintype" id="4935204">string</span><span class="op" id="4935210">,</span>&nbsp;<span class="builtintype" id="4935212">error</span><span class="op" id="4935217">)</span>&nbsp;<span class="op" id="4935219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935222">switch</span>&nbsp;<span class="ident" id="4935229"><a href="/debug/elf/file.go.html#4935189">tag</a></span>&nbsp;<span class="op" id="4935233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935236">case</span>&nbsp;<span class="ident" id="4935241"><a href="/debug/elf/elf.go.html#4866730">DT_NEEDED</a></span><span class="op" id="4935250">,</span>&nbsp;<span class="ident" id="4935252"><a href="/debug/elf/elf.go.html#4867622">DT_SONAME</a></span><span class="op" id="4935261">,</span>&nbsp;<span class="ident" id="4935263"><a href="/debug/elf/elf.go.html#4867700">DT_RPATH</a></span><span class="op" id="4935271">,</span>&nbsp;<span class="ident" id="4935273"><a href="/debug/elf/elf.go.html#4868758">DT_RUNPATH</a></span><span class="op" id="4935283">:</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935286">default</span><span class="op" id="4935293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935297">return</span>&nbsp;<span class="ident" id="4935304">nil</span><span class="op" id="4935307">,</span>&nbsp;<span class="ident" id="4935309"><a href="/debug/elf/file.go.html#4913145">fmt</a></span><span class="op" id="4935312">.</span><span class="ident" id="4935313">Errorf</span><span class="op" id="4935319">(</span><span class="string" id="4935320">&#34;non-string-valued&nbsp;tag&nbsp;%v&#34;</span><span class="op" id="4935346">,</span>&nbsp;<span class="ident" id="4935348"><a href="/debug/elf/file.go.html#4935189">tag</a></span><span class="op" id="4935351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4935354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935357">ds</span>&nbsp;<span class="op" id="4935360">:=</span>&nbsp;<span class="ident" id="4935363"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935364">.</span><span class="ident" id="4935365">SectionByType</span><span class="op" id="4935378">(</span><span class="ident" id="4935379"><a href="/debug/elf/elf.go.html#4860622">SHT_DYNAMIC</a></span><span class="op" id="4935390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935393">if</span>&nbsp;<span class="ident" id="4935396"><a href="/debug/elf/file.go.html#4935357">ds</a></span>&nbsp;<span class="op" id="4935399">==</span>&nbsp;<span class="ident" id="4935402">nil</span>&nbsp;<span class="op" id="4935406">{</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4935410">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935444">return</span>&nbsp;<span class="ident" id="4935451">nil</span><span class="op" id="4935454">,</span>&nbsp;<span class="ident" id="4935456">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4935461">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935464">d</span><span class="op" id="4935465">,</span>&nbsp;<span class="ident" id="4935467">err</span>&nbsp;<span class="op" id="4935471">:=</span>&nbsp;<span class="ident" id="4935474"><a href="/debug/elf/file.go.html#4935357">ds</a></span><span class="op" id="4935476">.</span><span class="ident" id="4935477">Data</span><span class="op" id="4935481">(</span><span class="op" id="4935482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935485">if</span>&nbsp;<span class="ident" id="4935488"><a href="/debug/elf/file.go.html#4935467">err</a></span>&nbsp;<span class="op" id="4935492">!=</span>&nbsp;<span class="ident" id="4935495">nil</span>&nbsp;<span class="op" id="4935499">{</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935503">return</span>&nbsp;<span class="ident" id="4935510">nil</span><span class="op" id="4935513">,</span>&nbsp;<span class="ident" id="4935515"><a href="/debug/elf/file.go.html#4935467">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4935520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935523">str</span><span class="op" id="4935526">,</span>&nbsp;<span class="ident" id="4935528"><a href="/debug/elf/file.go.html#4935467">err</a></span>&nbsp;<span class="op" id="4935532">:=</span>&nbsp;<span class="ident" id="4935535"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935536">.</span><span class="ident" id="4935537">stringTable</span><span class="op" id="4935548">(</span><span class="ident" id="4935549"><a href="/debug/elf/file.go.html#4935357">ds</a></span><span class="op" id="4935551">.</span><span class="ident" id="4935552">Link</span><span class="op" id="4935556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935559">if</span>&nbsp;<span class="ident" id="4935562"><a href="/debug/elf/file.go.html#4935467">err</a></span>&nbsp;<span class="op" id="4935566">!=</span>&nbsp;<span class="ident" id="4935569">nil</span>&nbsp;<span class="op" id="4935573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935577">return</span>&nbsp;<span class="ident" id="4935584">nil</span><span class="op" id="4935587">,</span>&nbsp;<span class="ident" id="4935589"><a href="/debug/elf/file.go.html#4935467">err</a></span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4935594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935597">var</span>&nbsp;<span class="ident" id="4935601">all</span>&nbsp;<span class="op" id="4935605">[</span><span class="op" id="4935606">]</span><span class="builtintype" id="4935607">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935615">for</span>&nbsp;<span class="builtinfunc" id="4935619">len</span><span class="op" id="4935622">(</span><span class="ident" id="4935623"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935624">)</span>&nbsp;<span class="op" id="4935626">&gt;</span>&nbsp;<span class="num" id="4935628">0</span>&nbsp;<span class="op" id="4935630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935634">var</span>&nbsp;<span class="ident" id="4935638">t</span>&nbsp;<span class="ident" id="4935640"><a href="/debug/elf/elf.go.html#4866655">DynTag</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935649">var</span>&nbsp;<span class="ident" id="4935653">v</span>&nbsp;<span class="ident" id="4935655">uint64</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935664">switch</span>&nbsp;<span class="ident" id="4935671"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935672">.</span><span class="ident" id="4935673">Class</span>&nbsp;<span class="op" id="4935679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935683">case</span>&nbsp;<span class="ident" id="4935688"><a href="/debug/elf/elf.go.html#4851740">ELFCLASS32</a></span><span class="op" id="4935698">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935703"><a href="/debug/elf/file.go.html#4935638">t</a></span>&nbsp;<span class="op" id="4935705">=</span>&nbsp;<span class="ident" id="4935707"><a href="/debug/elf/elf.go.html#4866655">DynTag</a></span><span class="op" id="4935713">(</span><span class="ident" id="4935714"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935715">.</span><span class="ident" id="4935716">ByteOrder</span><span class="op" id="4935725">.</span><span class="ident" id="4935726">Uint32</span><span class="op" id="4935732">(</span><span class="ident" id="4935733"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935734">[</span><span class="num" id="4935735">0</span><span class="op" id="4935736">:</span><span class="num" id="4935737">4</span><span class="op" id="4935738">]</span><span class="op" id="4935739">)</span><span class="op" id="4935740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935745"><a href="/debug/elf/file.go.html#4935653">v</a></span>&nbsp;<span class="op" id="4935747">=</span>&nbsp;<span class="ident" id="4935749">uint64</span><span class="op" id="4935755">(</span><span class="ident" id="4935756"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935757">.</span><span class="ident" id="4935758">ByteOrder</span><span class="op" id="4935767">.</span><span class="ident" id="4935768">Uint32</span><span class="op" id="4935774">(</span><span class="ident" id="4935775"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935776">[</span><span class="num" id="4935777">4</span><span class="op" id="4935778">:</span><span class="num" id="4935779">8</span><span class="op" id="4935780">]</span><span class="op" id="4935781">)</span><span class="op" id="4935782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935787"><a href="/debug/elf/file.go.html#4935464">d</a></span>&nbsp;<span class="op" id="4935789">=</span>&nbsp;<span class="ident" id="4935791"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935792">[</span><span class="num" id="4935793">8</span><span class="op" id="4935794">:</span><span class="op" id="4935795">]</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935799">case</span>&nbsp;<span class="ident" id="4935804"><a href="/debug/elf/elf.go.html#4851791">ELFCLASS64</a></span><span class="op" id="4935814">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935819"><a href="/debug/elf/file.go.html#4935638">t</a></span>&nbsp;<span class="op" id="4935821">=</span>&nbsp;<span class="ident" id="4935823"><a href="/debug/elf/elf.go.html#4866655">DynTag</a></span><span class="op" id="4935829">(</span><span class="ident" id="4935830"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935831">.</span><span class="ident" id="4935832">ByteOrder</span><span class="op" id="4935841">.</span><span class="ident" id="4935842">Uint64</span><span class="op" id="4935848">(</span><span class="ident" id="4935849"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935850">[</span><span class="num" id="4935851">0</span><span class="op" id="4935852">:</span><span class="num" id="4935853">8</span><span class="op" id="4935854">]</span><span class="op" id="4935855">)</span><span class="op" id="4935856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935861"><a href="/debug/elf/file.go.html#4935653">v</a></span>&nbsp;<span class="op" id="4935863">=</span>&nbsp;<span class="ident" id="4935865"><a href="/debug/elf/file.go.html#4935170">f</a></span><span class="op" id="4935866">.</span><span class="ident" id="4935867">ByteOrder</span><span class="op" id="4935876">.</span><span class="ident" id="4935877">Uint64</span><span class="op" id="4935883">(</span><span class="ident" id="4935884"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935885">[</span><span class="num" id="4935886">8</span><span class="op" id="4935887">:</span><span class="num" id="4935888">16</span><span class="op" id="4935890">]</span><span class="op" id="4935891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935896"><a href="/debug/elf/file.go.html#4935464">d</a></span>&nbsp;<span class="op" id="4935898">=</span>&nbsp;<span class="ident" id="4935900"><a href="/debug/elf/file.go.html#4935464">d</a></span><span class="op" id="4935901">[</span><span class="num" id="4935902">16</span><span class="op" id="4935904">:</span><span class="op" id="4935905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4935909">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935913">if</span>&nbsp;<span class="ident" id="4935916"><a href="/debug/elf/file.go.html#4935638">t</a></span>&nbsp;<span class="op" id="4935918">==</span>&nbsp;<span class="ident" id="4935921"><a href="/debug/elf/file.go.html#4935189">tag</a></span>&nbsp;<span class="op" id="4935925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935930">s</span><span class="op" id="4935931">,</span>&nbsp;<span class="ident" id="4935933">ok</span>&nbsp;<span class="op" id="4935936">:=</span>&nbsp;<span class="ident" id="4935939"><a href="/debug/elf/file.go.html#4925139">getString</a></span><span class="op" id="4935948">(</span><span class="ident" id="4935949"><a href="/debug/elf/file.go.html#4935523">str</a></span><span class="op" id="4935952">,</span>&nbsp;<span class="builtintype" id="4935954">int</span><span class="op" id="4935957">(</span><span class="ident" id="4935958"><a href="/debug/elf/file.go.html#4935653">v</a></span><span class="op" id="4935959">)</span><span class="op" id="4935960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4935965">if</span>&nbsp;<span class="ident" id="4935968"><a href="/debug/elf/file.go.html#4935933">ok</a></span>&nbsp;<span class="op" id="4935971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4935977"><a href="/debug/elf/file.go.html#4935601">all</a></span>&nbsp;<span class="op" id="4935981">=</span>&nbsp;<span class="builtinfunc" id="4935983">append</span><span class="op" id="4935989">(</span><span class="ident" id="4935990"><a href="/debug/elf/file.go.html#4935601">all</a></span><span class="op" id="4935993">,</span>&nbsp;<span class="ident" id="4935995"><a href="/debug/elf/file.go.html#4935930">s</a></span><span class="op" id="4935996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4936001">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4936005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4936008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4936011">return</span>&nbsp;<span class="ident" id="4936018"><a href="/debug/elf/file.go.html#4935601">all</a></span><span class="op" id="4936021">,</span>&nbsp;<span class="ident" id="4936023">nil</span><br>
<span class="lineno"></span><span class="op" id="4936027">}</span>
</div>
</body>
</html>
