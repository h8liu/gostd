<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>unicode/utf16</h2>
<ul>
<li><a href="/gostd/unicode/utf16/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16.go.html" class="current">utf16.go</a></li>
<li><a href="/gostd/unicode/utf16/utf16_test.go.html">utf16_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4837384">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4837440">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4837494">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4837545">//&nbsp;Package&nbsp;utf16&nbsp;implements&nbsp;encoding&nbsp;and&nbsp;decoding&nbsp;of&nbsp;UTF-16&nbsp;sequences.</span><br>
<span class="lineno"></span><span class="keyword" id="4837616">package</span>&nbsp;<span class="ident" id="4837624">utf16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4837631">//&nbsp;The&nbsp;conditions&nbsp;replacementChar==unicode.ReplacementChar&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4837694">//&nbsp;maxRune==unicode.MaxRune&nbsp;are&nbsp;verified&nbsp;in&nbsp;the&nbsp;tests.</span><br>
<span class="lineno">10</span><span class="comment" id="4837749">//&nbsp;Defining&nbsp;them&nbsp;locally&nbsp;avoids&nbsp;this&nbsp;package&nbsp;depending&nbsp;on&nbsp;package&nbsp;unicode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4837825">const</span>&nbsp;<span class="op" id="4837831">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837834">replacementChar</span>&nbsp;<span class="op" id="4837850">=</span>&nbsp;<span class="string" id="4837852">&#39;\uFFFD&#39;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837865">//&nbsp;Unicode&nbsp;replacement&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4837899">maxRune</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4837915">=</span>&nbsp;<span class="string" id="4837917">&#39;\U0010FFFF&#39;</span>&nbsp;<span class="comment" id="4837930">//&nbsp;Maximum&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point.</span><br>
<span class="lineno">15</span><span class="op" id="4837967">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4837970">const</span>&nbsp;<span class="op" id="4837976">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4837979">//&nbsp;0xd800-0xdc00&nbsp;encodes&nbsp;the&nbsp;high&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838033">//&nbsp;0xdc00-0xe000&nbsp;encodes&nbsp;the&nbsp;low&nbsp;10&nbsp;bits&nbsp;of&nbsp;a&nbsp;pair.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4838086">//&nbsp;the&nbsp;value&nbsp;is&nbsp;those&nbsp;20&nbsp;bits&nbsp;plus&nbsp;0x10000.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838131">surr1</span>&nbsp;<span class="op" id="4838137">=</span>&nbsp;<span class="num" id="4838139">0xd800</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838147">surr2</span>&nbsp;<span class="op" id="4838153">=</span>&nbsp;<span class="num" id="4838155">0xdc00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838163">surr3</span>&nbsp;<span class="op" id="4838169">=</span>&nbsp;<span class="num" id="4838171">0xe000</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4838180">surrSelf</span>&nbsp;<span class="op" id="4838189">=</span>&nbsp;<span class="num" id="4838191">0x10000</span><br>
<span class="lineno"></span><span class="op" id="4838199">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838202">//&nbsp;IsSurrogate&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;specified&nbsp;Unicode&nbsp;code&nbsp;point</span><br>
<span class="lineno"></span><span class="comment" id="4838266">//&nbsp;can&nbsp;appear&nbsp;in&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">30</span><span class="keyword" id="4838301">func</span>&nbsp;<span class="ident" id="4838306">IsSurrogate</span><span class="op" id="4838317">(</span><span class="ident" id="4838318">r</span>&nbsp;<span class="builtintype" id="4838320">rune</span><span class="op" id="4838324">)</span>&nbsp;<span class="builtintype" id="4838326">bool</span>&nbsp;<span class="op" id="4838331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838334">return</span>&nbsp;<span class="ident" id="4838341">surr1</span>&nbsp;<span class="op" id="4838347">&lt;=</span>&nbsp;<span class="ident" id="4838350">r</span>&nbsp;<span class="op" id="4838352">&amp;&amp;</span>&nbsp;<span class="ident" id="4838355">r</span>&nbsp;<span class="op" id="4838357">&lt;</span>&nbsp;<span class="ident" id="4838359">surr3</span><br>
<span class="lineno"></span><span class="op" id="4838365">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838368">//&nbsp;DecodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;decoding&nbsp;of&nbsp;a&nbsp;surrogate&nbsp;pair.</span><br>
<span class="lineno">35</span><span class="comment" id="4838431">//&nbsp;If&nbsp;the&nbsp;pair&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;UTF-16&nbsp;surrogate&nbsp;pair,&nbsp;DecodeRune&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4838503">//&nbsp;the&nbsp;Unicode&nbsp;replacement&nbsp;code&nbsp;point&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4838549">func</span>&nbsp;<span class="ident" id="4838554">DecodeRune</span><span class="op" id="4838564">(</span><span class="ident" id="4838565">r1</span><span class="op" id="4838567">,</span>&nbsp;<span class="ident" id="4838569">r2</span>&nbsp;<span class="builtintype" id="4838572">rune</span><span class="op" id="4838576">)</span>&nbsp;<span class="builtintype" id="4838578">rune</span>&nbsp;<span class="op" id="4838583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838586">if</span>&nbsp;<span class="ident" id="4838589">surr1</span>&nbsp;<span class="op" id="4838595">&lt;=</span>&nbsp;<span class="ident" id="4838598">r1</span>&nbsp;<span class="op" id="4838601">&amp;&amp;</span>&nbsp;<span class="ident" id="4838604">r1</span>&nbsp;<span class="op" id="4838607">&lt;</span>&nbsp;<span class="ident" id="4838609">surr2</span>&nbsp;<span class="op" id="4838615">&amp;&amp;</span>&nbsp;<span class="ident" id="4838618">surr2</span>&nbsp;<span class="op" id="4838624">&lt;=</span>&nbsp;<span class="ident" id="4838627">r2</span>&nbsp;<span class="op" id="4838630">&amp;&amp;</span>&nbsp;<span class="ident" id="4838633">r2</span>&nbsp;<span class="op" id="4838636">&lt;</span>&nbsp;<span class="ident" id="4838638">surr3</span>&nbsp;<span class="op" id="4838644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838648">return</span>&nbsp;<span class="op" id="4838655">(</span><span class="ident" id="4838656">r1</span><span class="op" id="4838658">-</span><span class="ident" id="4838659">surr1</span><span class="op" id="4838664">)</span><span class="op" id="4838665">&lt;&lt;</span><span class="num" id="4838667">10</span>&nbsp;<span class="op" id="4838670">|</span>&nbsp;<span class="op" id="4838672">(</span><span class="ident" id="4838673">r2</span>&nbsp;<span class="op" id="4838676">-</span>&nbsp;<span class="ident" id="4838678">surr2</span><span class="op" id="4838683">)</span>&nbsp;<span class="op" id="4838685">+</span>&nbsp;<span class="num" id="4838687">0x10000</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4838696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838699">return</span>&nbsp;<span class="ident" id="4838706">replacementChar</span><br>
<span class="lineno"></span><span class="op" id="4838722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4838725">//&nbsp;EncodeRune&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;surrogate&nbsp;pair&nbsp;r1,&nbsp;r2&nbsp;for&nbsp;the&nbsp;given&nbsp;rune.</span><br>
<span class="lineno">45</span><span class="comment" id="4838800">//&nbsp;If&nbsp;the&nbsp;rune&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;or&nbsp;does&nbsp;not&nbsp;need&nbsp;encoding,</span><br>
<span class="lineno"></span><span class="comment" id="4838876">//&nbsp;EncodeRune&nbsp;returns&nbsp;U+FFFD,&nbsp;U+FFFD.</span><br>
<span class="lineno"></span><span class="keyword" id="4838914">func</span>&nbsp;<span class="ident" id="4838919">EncodeRune</span><span class="op" id="4838929">(</span><span class="ident" id="4838930">r</span>&nbsp;<span class="builtintype" id="4838932">rune</span><span class="op" id="4838936">)</span>&nbsp;<span class="op" id="4838938">(</span><span class="ident" id="4838939">r1</span><span class="op" id="4838941">,</span>&nbsp;<span class="ident" id="4838943">r2</span>&nbsp;<span class="builtintype" id="4838946">rune</span><span class="op" id="4838950">)</span>&nbsp;<span class="op" id="4838952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4838955">if</span>&nbsp;<span class="ident" id="4838958">r</span>&nbsp;<span class="op" id="4838960">&lt;</span>&nbsp;<span class="ident" id="4838962">surrSelf</span>&nbsp;<span class="op" id="4838971">||</span>&nbsp;<span class="ident" id="4838974">r</span>&nbsp;<span class="op" id="4838976">&gt;</span>&nbsp;<span class="ident" id="4838978">maxRune</span>&nbsp;<span class="op" id="4838986">||</span>&nbsp;<span class="ident" id="4838989">IsSurrogate</span><span class="op" id="4839000">(</span><span class="ident" id="4839001">r</span><span class="op" id="4839002">)</span>&nbsp;<span class="op" id="4839004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839008">return</span>&nbsp;<span class="ident" id="4839015">replacementChar</span><span class="op" id="4839030">,</span>&nbsp;<span class="ident" id="4839032">replacementChar</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839052">r</span>&nbsp;<span class="op" id="4839054">-=</span>&nbsp;<span class="ident" id="4839057">surrSelf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839067">return</span>&nbsp;<span class="ident" id="4839074">surr1</span>&nbsp;<span class="op" id="4839080">+</span>&nbsp;<span class="op" id="4839082">(</span><span class="ident" id="4839083">r</span><span class="op" id="4839084">&gt;&gt;</span><span class="num" id="4839086">10</span><span class="op" id="4839088">)</span><span class="op" id="4839089">&amp;</span><span class="num" id="4839090">0x3ff</span><span class="op" id="4839095">,</span>&nbsp;<span class="ident" id="4839097">surr2</span>&nbsp;<span class="op" id="4839103">+</span>&nbsp;<span class="ident" id="4839105">r</span><span class="op" id="4839106">&amp;</span><span class="num" id="4839107">0x3ff</span><br>
<span class="lineno"></span><span class="op" id="4839113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4839116">//&nbsp;Encode&nbsp;returns&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;of&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4839192">func</span>&nbsp;<span class="ident" id="4839197">Encode</span><span class="op" id="4839203">(</span><span class="ident" id="4839204">s</span>&nbsp;<span class="op" id="4839206">[</span><span class="op" id="4839207">]</span><span class="builtintype" id="4839208">rune</span><span class="op" id="4839212">)</span>&nbsp;<span class="op" id="4839214">[</span><span class="op" id="4839215">]</span><span class="builtintype" id="4839216">uint16</span>&nbsp;<span class="op" id="4839223">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839226">n</span>&nbsp;<span class="op" id="4839228">:=</span>&nbsp;<span class="builtinfunc" id="4839231">len</span><span class="op" id="4839234">(</span><span class="ident" id="4839235">s</span><span class="op" id="4839236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839239">for</span>&nbsp;<span class="ident" id="4839243">_</span><span class="op" id="4839244">,</span>&nbsp;<span class="ident" id="4839246">v</span>&nbsp;<span class="op" id="4839248">:=</span>&nbsp;<span class="keyword" id="4839251">range</span>&nbsp;<span class="ident" id="4839257">s</span>&nbsp;<span class="op" id="4839259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839263">if</span>&nbsp;<span class="ident" id="4839266">v</span>&nbsp;<span class="op" id="4839268">&gt;=</span>&nbsp;<span class="ident" id="4839271">surrSelf</span>&nbsp;<span class="op" id="4839280">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839285">n</span><span class="op" id="4839286">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839298">a</span>&nbsp;<span class="op" id="4839300">:=</span>&nbsp;<span class="builtinfunc" id="4839303">make</span><span class="op" id="4839307">(</span><span class="op" id="4839308">[</span><span class="op" id="4839309">]</span><span class="builtintype" id="4839310">uint16</span><span class="op" id="4839316">,</span>&nbsp;<span class="ident" id="4839318">n</span><span class="op" id="4839319">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839322">n</span>&nbsp;<span class="op" id="4839324">=</span>&nbsp;<span class="num" id="4839326">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839329">for</span>&nbsp;<span class="ident" id="4839333">_</span><span class="op" id="4839334">,</span>&nbsp;<span class="ident" id="4839336">v</span>&nbsp;<span class="op" id="4839338">:=</span>&nbsp;<span class="keyword" id="4839341">range</span>&nbsp;<span class="ident" id="4839347">s</span>&nbsp;<span class="op" id="4839349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839353">switch</span>&nbsp;<span class="op" id="4839360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839364">case</span>&nbsp;<span class="ident" id="4839369">v</span>&nbsp;<span class="op" id="4839371">&lt;</span>&nbsp;<span class="num" id="4839373">0</span><span class="op" id="4839374">,</span>&nbsp;<span class="ident" id="4839376">surr1</span>&nbsp;<span class="op" id="4839382">&lt;=</span>&nbsp;<span class="ident" id="4839385">v</span>&nbsp;<span class="op" id="4839387">&amp;&amp;</span>&nbsp;<span class="ident" id="4839390">v</span>&nbsp;<span class="op" id="4839392">&lt;</span>&nbsp;<span class="ident" id="4839394">surr3</span><span class="op" id="4839399">,</span>&nbsp;<span class="ident" id="4839401">v</span>&nbsp;<span class="op" id="4839403">&gt;</span>&nbsp;<span class="ident" id="4839405">maxRune</span><span class="op" id="4839412">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839417">v</span>&nbsp;<span class="op" id="4839419">=</span>&nbsp;<span class="ident" id="4839421">replacementChar</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839440">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839454">case</span>&nbsp;<span class="ident" id="4839459">v</span>&nbsp;<span class="op" id="4839461">&lt;</span>&nbsp;<span class="ident" id="4839463">surrSelf</span><span class="op" id="4839471">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839476">a</span><span class="op" id="4839477">[</span><span class="ident" id="4839478">n</span><span class="op" id="4839479">]</span>&nbsp;<span class="op" id="4839481">=</span>&nbsp;<span class="builtintype" id="4839483">uint16</span><span class="op" id="4839489">(</span><span class="ident" id="4839490">v</span><span class="op" id="4839491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839496">n</span><span class="op" id="4839497">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839502">default</span><span class="op" id="4839509">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839514">r1</span><span class="op" id="4839516">,</span>&nbsp;<span class="ident" id="4839518">r2</span>&nbsp;<span class="op" id="4839521">:=</span>&nbsp;<span class="ident" id="4839524">EncodeRune</span><span class="op" id="4839534">(</span><span class="ident" id="4839535">v</span><span class="op" id="4839536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839541">a</span><span class="op" id="4839542">[</span><span class="ident" id="4839543">n</span><span class="op" id="4839544">]</span>&nbsp;<span class="op" id="4839546">=</span>&nbsp;<span class="builtintype" id="4839548">uint16</span><span class="op" id="4839554">(</span><span class="ident" id="4839555">r1</span><span class="op" id="4839557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839562">a</span><span class="op" id="4839563">[</span><span class="ident" id="4839564">n</span><span class="op" id="4839565">+</span><span class="num" id="4839566">1</span><span class="op" id="4839567">]</span>&nbsp;<span class="op" id="4839569">=</span>&nbsp;<span class="builtintype" id="4839571">uint16</span><span class="op" id="4839577">(</span><span class="ident" id="4839578">r2</span><span class="op" id="4839580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839585">n</span>&nbsp;<span class="op" id="4839587">+=</span>&nbsp;<span class="num" id="4839590">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839594">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4839597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839600">return</span>&nbsp;<span class="ident" id="4839607">a</span><span class="op" id="4839608">[</span><span class="num" id="4839609">0</span><span class="op" id="4839610">:</span><span class="ident" id="4839611">n</span><span class="op" id="4839612">]</span><br>
<span class="lineno"></span><span class="op" id="4839614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4839617">//&nbsp;Decode&nbsp;returns&nbsp;the&nbsp;Unicode&nbsp;code&nbsp;point&nbsp;sequence&nbsp;represented</span><br>
<span class="lineno">85</span><span class="comment" id="4839679">//&nbsp;by&nbsp;the&nbsp;UTF-16&nbsp;encoding&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="4839708">func</span>&nbsp;<span class="ident" id="4839713">Decode</span><span class="op" id="4839719">(</span><span class="ident" id="4839720">s</span>&nbsp;<span class="op" id="4839722">[</span><span class="op" id="4839723">]</span><span class="builtintype" id="4839724">uint16</span><span class="op" id="4839730">)</span>&nbsp;<span class="op" id="4839732">[</span><span class="op" id="4839733">]</span><span class="builtintype" id="4839734">rune</span>&nbsp;<span class="op" id="4839739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839742">a</span>&nbsp;<span class="op" id="4839744">:=</span>&nbsp;<span class="builtinfunc" id="4839747">make</span><span class="op" id="4839751">(</span><span class="op" id="4839752">[</span><span class="op" id="4839753">]</span><span class="builtintype" id="4839754">rune</span><span class="op" id="4839758">,</span>&nbsp;<span class="builtinfunc" id="4839760">len</span><span class="op" id="4839763">(</span><span class="ident" id="4839764">s</span><span class="op" id="4839765">)</span><span class="op" id="4839766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839769">n</span>&nbsp;<span class="op" id="4839771">:=</span>&nbsp;<span class="num" id="4839774">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839777">for</span>&nbsp;<span class="ident" id="4839781">i</span>&nbsp;<span class="op" id="4839783">:=</span>&nbsp;<span class="num" id="4839786">0</span><span class="op" id="4839787">;</span>&nbsp;<span class="ident" id="4839789">i</span>&nbsp;<span class="op" id="4839791">&lt;</span>&nbsp;<span class="builtinfunc" id="4839793">len</span><span class="op" id="4839796">(</span><span class="ident" id="4839797">s</span><span class="op" id="4839798">)</span><span class="op" id="4839799">;</span>&nbsp;<span class="ident" id="4839801">i</span><span class="op" id="4839802">++</span>&nbsp;<span class="op" id="4839805">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839809">switch</span>&nbsp;<span class="ident" id="4839816">r</span>&nbsp;<span class="op" id="4839818">:=</span>&nbsp;<span class="ident" id="4839821">s</span><span class="op" id="4839822">[</span><span class="ident" id="4839823">i</span><span class="op" id="4839824">]</span><span class="op" id="4839825">;</span>&nbsp;<span class="op" id="4839827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4839831">case</span>&nbsp;<span class="ident" id="4839836">surr1</span>&nbsp;<span class="op" id="4839842">&lt;=</span>&nbsp;<span class="ident" id="4839845">r</span>&nbsp;<span class="op" id="4839847">&amp;&amp;</span>&nbsp;<span class="ident" id="4839850">r</span>&nbsp;<span class="op" id="4839852">&lt;</span>&nbsp;<span class="ident" id="4839854">surr2</span>&nbsp;<span class="op" id="4839860">&amp;&amp;</span>&nbsp;<span class="ident" id="4839863">i</span><span class="op" id="4839864">+</span><span class="num" id="4839865">1</span>&nbsp;<span class="op" id="4839867">&lt;</span>&nbsp;<span class="builtinfunc" id="4839869">len</span><span class="op" id="4839872">(</span><span class="ident" id="4839873">s</span><span class="op" id="4839874">)</span>&nbsp;<span class="op" id="4839876">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839882">surr2</span>&nbsp;<span class="op" id="4839888">&lt;=</span>&nbsp;<span class="ident" id="4839891">s</span><span class="op" id="4839892">[</span><span class="ident" id="4839893">i</span><span class="op" id="4839894">+</span><span class="num" id="4839895">1</span><span class="op" id="4839896">]</span>&nbsp;<span class="op" id="4839898">&amp;&amp;</span>&nbsp;<span class="ident" id="4839901">s</span><span class="op" id="4839902">[</span><span class="ident" id="4839903">i</span><span class="op" id="4839904">+</span><span class="num" id="4839905">1</span><span class="op" id="4839906">]</span>&nbsp;<span class="op" id="4839908">&lt;</span>&nbsp;<span class="ident" id="4839910">surr3</span><span class="op" id="4839915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4839920">//&nbsp;valid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839951">a</span><span class="op" id="4839952">[</span><span class="ident" id="4839953">n</span><span class="op" id="4839954">]</span>&nbsp;<span class="op" id="4839956">=</span>&nbsp;<span class="ident" id="4839958">DecodeRune</span><span class="op" id="4839968">(</span><span class="builtintype" id="4839969">rune</span><span class="op" id="4839973">(</span><span class="ident" id="4839974">r</span><span class="op" id="4839975">)</span><span class="op" id="4839976">,</span>&nbsp;<span class="builtintype" id="4839978">rune</span><span class="op" id="4839982">(</span><span class="ident" id="4839983">s</span><span class="op" id="4839984">[</span><span class="ident" id="4839985">i</span><span class="op" id="4839986">+</span><span class="num" id="4839987">1</span><span class="op" id="4839988">]</span><span class="op" id="4839989">)</span><span class="op" id="4839990">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4839995">i</span><span class="op" id="4839996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840002">n</span><span class="op" id="4840003">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840008">case</span>&nbsp;<span class="ident" id="4840013">surr1</span>&nbsp;<span class="op" id="4840019">&lt;=</span>&nbsp;<span class="ident" id="4840022">r</span>&nbsp;<span class="op" id="4840024">&amp;&amp;</span>&nbsp;<span class="ident" id="4840027">r</span>&nbsp;<span class="op" id="4840029">&lt;</span>&nbsp;<span class="ident" id="4840031">surr3</span><span class="op" id="4840036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840041">//&nbsp;invalid&nbsp;surrogate&nbsp;sequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840074">a</span><span class="op" id="4840075">[</span><span class="ident" id="4840076">n</span><span class="op" id="4840077">]</span>&nbsp;<span class="op" id="4840079">=</span>&nbsp;<span class="ident" id="4840081">replacementChar</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840100">n</span><span class="op" id="4840101">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840106">default</span><span class="op" id="4840113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4840118">//&nbsp;normal&nbsp;rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840136">a</span><span class="op" id="4840137">[</span><span class="ident" id="4840138">n</span><span class="op" id="4840139">]</span>&nbsp;<span class="op" id="4840141">=</span>&nbsp;<span class="builtintype" id="4840143">rune</span><span class="op" id="4840147">(</span><span class="ident" id="4840148">r</span><span class="op" id="4840149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4840154">n</span><span class="op" id="4840155">++</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4840160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4840163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4840166">return</span>&nbsp;<span class="ident" id="4840173">a</span><span class="op" id="4840174">[</span><span class="num" id="4840175">0</span><span class="op" id="4840176">:</span><span class="ident" id="4840177">n</span><span class="op" id="4840178">]</span><br>
<span class="lineno"></span><span class="op" id="4840180">}</span>
</div>
</body>
</html>
