<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3301155">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3301210">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3301264">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3301315">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3301380">//&nbsp;Read&nbsp;system&nbsp;DNS&nbsp;config&nbsp;from&nbsp;/etc/resolv.conf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3301429">package</span>&nbsp;<span class="ident" id="3301437">net</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="3301442">type</span>&nbsp;<span class="ident" id="3301447">dnsConfig</span>&nbsp;<span class="keyword" id="3301457">struct</span>&nbsp;<span class="op" id="3301464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301467">servers</span>&nbsp;&nbsp;<span class="op" id="3301476">[</span><span class="op" id="3301477">]</span><span class="builtintype" id="3301478">string</span>&nbsp;<span class="comment" id="3301485">//&nbsp;servers&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301504">search</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3301513">[</span><span class="op" id="3301514">]</span><span class="builtintype" id="3301515">string</span>&nbsp;<span class="comment" id="3301522">//&nbsp;suffixes&nbsp;to&nbsp;append&nbsp;to&nbsp;local&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301559">ndots</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3301568">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301577">//&nbsp;number&nbsp;of&nbsp;dots&nbsp;in&nbsp;name&nbsp;to&nbsp;trigger&nbsp;absolute&nbsp;lookup</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301631">timeout</span>&nbsp;&nbsp;<span class="builtintype" id="3301640">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301649">//&nbsp;seconds&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;packet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301688">attempts</span>&nbsp;<span class="builtintype" id="3301697">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301706">//&nbsp;lost&nbsp;packets&nbsp;before&nbsp;giving&nbsp;up&nbsp;on&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3301750">rotate</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3301759">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3301768">//&nbsp;round&nbsp;robin&nbsp;among&nbsp;servers</span><br>
<span class="lineno"></span><span class="op" id="3301797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="3301800">//&nbsp;See&nbsp;resolv.conf(5)&nbsp;on&nbsp;a&nbsp;Linux&nbsp;machine.</span><br>
<span class="lineno"></span><span class="comment" id="3301842">//&nbsp;TODO(rsc):&nbsp;Supposed&nbsp;to&nbsp;call&nbsp;uname()&nbsp;and&nbsp;chop&nbsp;the&nbsp;beginning</span><br>
<span class="lineno"></span><span class="comment" id="3301904">//&nbsp;of&nbsp;the&nbsp;host&nbsp;name&nbsp;to&nbsp;get&nbsp;the&nbsp;default&nbsp;search&nbsp;domain.</span><br>
<span class="lineno"></span><span class="keyword" id="3301958">func</span>&nbsp;<span class="ident" id="3301963">dnsReadConfig</span><span class="op" id="3301976">(</span><span class="ident" id="3301977">filename</span>&nbsp;<span class="builtintype" id="3301986">string</span><span class="op" id="3301992">)</span>&nbsp;<span class="op" id="3301994">(</span><span class="op" id="3301995">*</span><span class="ident" id="3301996">dnsConfig</span><span class="op" id="3302005">,</span>&nbsp;<span class="builtintype" id="3302007">error</span><span class="op" id="3302012">)</span>&nbsp;<span class="op" id="3302014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302017">file</span><span class="op" id="3302021">,</span>&nbsp;<span class="ident" id="3302023">err</span>&nbsp;<span class="op" id="3302027">:=</span>&nbsp;<span class="ident" id="3302030">open</span><span class="op" id="3302034">(</span><span class="ident" id="3302035">filename</span><span class="op" id="3302043">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302046">if</span>&nbsp;<span class="ident" id="3302049">err</span>&nbsp;<span class="op" id="3302053">!=</span>&nbsp;<span class="ident" id="3302056">nil</span>&nbsp;<span class="op" id="3302060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302064">return</span>&nbsp;<span class="ident" id="3302071">nil</span><span class="op" id="3302074">,</span>&nbsp;<span class="op" id="3302076">&amp;</span><span class="ident" id="3302077">DNSConfigError</span><span class="op" id="3302091">{</span><span class="ident" id="3302092">err</span><span class="op" id="3302095">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302101">defer</span>&nbsp;<span class="ident" id="3302107">file</span><span class="op" id="3302111">.</span><span class="builtinfunc" id="3302112">close</span><span class="op" id="3302117">(</span><span class="op" id="3302118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302121">conf</span>&nbsp;<span class="op" id="3302126">:=</span>&nbsp;<span class="op" id="3302129">&amp;</span><span class="ident" id="3302130">dnsConfig</span><span class="op" id="3302139">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302143">ndots</span><span class="op" id="3302148">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3302153">1</span><span class="op" id="3302154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302158">timeout</span><span class="op" id="3302165">:</span>&nbsp;&nbsp;<span class="num" id="3302168">5</span><span class="op" id="3302169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302173">attempts</span><span class="op" id="3302181">:</span>&nbsp;<span class="num" id="3302183">2</span><span class="op" id="3302184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302187">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302190">for</span>&nbsp;<span class="ident" id="3302194">line</span><span class="op" id="3302198">,</span>&nbsp;<span class="ident" id="3302200">ok</span>&nbsp;<span class="op" id="3302203">:=</span>&nbsp;<span class="ident" id="3302206">file</span><span class="op" id="3302210">.</span><span class="ident" id="3302211">readLine</span><span class="op" id="3302219">(</span><span class="op" id="3302220">)</span><span class="op" id="3302221">;</span>&nbsp;<span class="ident" id="3302223">ok</span><span class="op" id="3302225">;</span>&nbsp;<span class="ident" id="3302227">line</span><span class="op" id="3302231">,</span>&nbsp;<span class="ident" id="3302233">ok</span>&nbsp;<span class="op" id="3302236">=</span>&nbsp;<span class="ident" id="3302238">file</span><span class="op" id="3302242">.</span><span class="ident" id="3302243">readLine</span><span class="op" id="3302251">(</span><span class="op" id="3302252">)</span>&nbsp;<span class="op" id="3302254">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302258">f</span>&nbsp;<span class="op" id="3302260">:=</span>&nbsp;<span class="ident" id="3302263">getFields</span><span class="op" id="3302272">(</span><span class="ident" id="3302273">line</span><span class="op" id="3302277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302281">if</span>&nbsp;<span class="builtinfunc" id="3302284">len</span><span class="op" id="3302287">(</span><span class="ident" id="3302288">f</span><span class="op" id="3302289">)</span>&nbsp;<span class="op" id="3302291">&lt;</span>&nbsp;<span class="num" id="3302293">1</span>&nbsp;<span class="op" id="3302295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302300">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302315">switch</span>&nbsp;<span class="ident" id="3302322">f</span><span class="op" id="3302323">[</span><span class="num" id="3302324">0</span><span class="op" id="3302325">]</span>&nbsp;<span class="op" id="3302327">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302331">case</span>&nbsp;<span class="string" id="3302336">&#34;nameserver&#34;</span><span class="op" id="3302348">:</span>&nbsp;<span class="comment" id="3302350">//&nbsp;add&nbsp;one&nbsp;name&nbsp;server</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302376">if</span>&nbsp;<span class="builtinfunc" id="3302379">len</span><span class="op" id="3302382">(</span><span class="ident" id="3302383">f</span><span class="op" id="3302384">)</span>&nbsp;<span class="op" id="3302386">&gt;</span>&nbsp;<span class="num" id="3302388">1</span>&nbsp;<span class="op" id="3302390">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3302393">len</span><span class="op" id="3302396">(</span><span class="ident" id="3302397">conf</span><span class="op" id="3302401">.</span><span class="ident" id="3302402">servers</span><span class="op" id="3302409">)</span>&nbsp;<span class="op" id="3302411">&lt;</span>&nbsp;<span class="num" id="3302413">3</span>&nbsp;<span class="op" id="3302415">{</span>&nbsp;<span class="comment" id="3302417">//&nbsp;small,&nbsp;but&nbsp;the&nbsp;standard&nbsp;limit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302454">//&nbsp;One&nbsp;more&nbsp;check:&nbsp;make&nbsp;sure&nbsp;server&nbsp;name&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302502">//&nbsp;just&nbsp;an&nbsp;IP&nbsp;address.&nbsp;&nbsp;Otherwise&nbsp;we&nbsp;need&nbsp;DNS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3302552">//&nbsp;to&nbsp;look&nbsp;it&nbsp;up.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302574">if</span>&nbsp;<span class="ident" id="3302577">parseIPv4</span><span class="op" id="3302586">(</span><span class="ident" id="3302587">f</span><span class="op" id="3302588">[</span><span class="num" id="3302589">1</span><span class="op" id="3302590">]</span><span class="op" id="3302591">)</span>&nbsp;<span class="op" id="3302593">!=</span>&nbsp;<span class="ident" id="3302596">nil</span>&nbsp;<span class="op" id="3302600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302607">conf</span><span class="op" id="3302611">.</span><span class="ident" id="3302612">servers</span>&nbsp;<span class="op" id="3302620">=</span>&nbsp;<span class="builtinfunc" id="3302622">append</span><span class="op" id="3302628">(</span><span class="ident" id="3302629">conf</span><span class="op" id="3302633">.</span><span class="ident" id="3302634">servers</span><span class="op" id="3302641">,</span>&nbsp;<span class="ident" id="3302643">f</span><span class="op" id="3302644">[</span><span class="num" id="3302645">1</span><span class="op" id="3302646">]</span><span class="op" id="3302647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302653">}</span>&nbsp;<span class="keyword" id="3302655">else</span>&nbsp;<span class="keyword" id="3302660">if</span>&nbsp;<span class="ident" id="3302663">ip</span><span class="op" id="3302665">,</span>&nbsp;<span class="ident" id="3302667">_</span>&nbsp;<span class="op" id="3302669">:=</span>&nbsp;<span class="ident" id="3302672">parseIPv6</span><span class="op" id="3302681">(</span><span class="ident" id="3302682">f</span><span class="op" id="3302683">[</span><span class="num" id="3302684">1</span><span class="op" id="3302685">]</span><span class="op" id="3302686">,</span>&nbsp;<span class="ident" id="3302688">true</span><span class="op" id="3302692">)</span><span class="op" id="3302693">;</span>&nbsp;<span class="ident" id="3302695">ip</span>&nbsp;<span class="op" id="3302698">!=</span>&nbsp;<span class="ident" id="3302701">nil</span>&nbsp;<span class="op" id="3302705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302712">conf</span><span class="op" id="3302716">.</span><span class="ident" id="3302717">servers</span>&nbsp;<span class="op" id="3302725">=</span>&nbsp;<span class="builtinfunc" id="3302727">append</span><span class="op" id="3302733">(</span><span class="ident" id="3302734">conf</span><span class="op" id="3302738">.</span><span class="ident" id="3302739">servers</span><span class="op" id="3302746">,</span>&nbsp;<span class="ident" id="3302748">f</span><span class="op" id="3302749">[</span><span class="num" id="3302750">1</span><span class="op" id="3302751">]</span><span class="op" id="3302752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302758">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302768">case</span>&nbsp;<span class="string" id="3302773">&#34;domain&#34;</span><span class="op" id="3302781">:</span>&nbsp;<span class="comment" id="3302783">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;just&nbsp;this&nbsp;domain</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302825">if</span>&nbsp;<span class="builtinfunc" id="3302828">len</span><span class="op" id="3302831">(</span><span class="ident" id="3302832">f</span><span class="op" id="3302833">)</span>&nbsp;<span class="op" id="3302835">&gt;</span>&nbsp;<span class="num" id="3302837">1</span>&nbsp;<span class="op" id="3302839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302845">conf</span><span class="op" id="3302849">.</span><span class="ident" id="3302850">search</span>&nbsp;<span class="op" id="3302857">=</span>&nbsp;<span class="op" id="3302859">[</span><span class="op" id="3302860">]</span><span class="builtintype" id="3302861">string</span><span class="op" id="3302867">{</span><span class="ident" id="3302868">f</span><span class="op" id="3302869">[</span><span class="num" id="3302870">1</span><span class="op" id="3302871">]</span><span class="op" id="3302872">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3302877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302882">case</span>&nbsp;<span class="string" id="3302887">&#34;search&#34;</span><span class="op" id="3302895">:</span>&nbsp;<span class="comment" id="3302897">//&nbsp;set&nbsp;search&nbsp;path&nbsp;to&nbsp;given&nbsp;servers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3302936">conf</span><span class="op" id="3302940">.</span><span class="ident" id="3302941">search</span>&nbsp;<span class="op" id="3302948">=</span>&nbsp;<span class="builtinfunc" id="3302950">make</span><span class="op" id="3302954">(</span><span class="op" id="3302955">[</span><span class="op" id="3302956">]</span><span class="builtintype" id="3302957">string</span><span class="op" id="3302963">,</span>&nbsp;<span class="builtinfunc" id="3302965">len</span><span class="op" id="3302968">(</span><span class="ident" id="3302969">f</span><span class="op" id="3302970">)</span><span class="op" id="3302971">-</span><span class="num" id="3302972">1</span><span class="op" id="3302973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3302978">for</span>&nbsp;<span class="ident" id="3302982">i</span>&nbsp;<span class="op" id="3302984">:=</span>&nbsp;<span class="num" id="3302987">0</span><span class="op" id="3302988">;</span>&nbsp;<span class="ident" id="3302990">i</span>&nbsp;<span class="op" id="3302992">&lt;</span>&nbsp;<span class="builtinfunc" id="3302994">len</span><span class="op" id="3302997">(</span><span class="ident" id="3302998">conf</span><span class="op" id="3303002">.</span><span class="ident" id="3303003">search</span><span class="op" id="3303009">)</span><span class="op" id="3303010">;</span>&nbsp;<span class="ident" id="3303012">i</span><span class="op" id="3303013">++</span>&nbsp;<span class="op" id="3303016">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303022">conf</span><span class="op" id="3303026">.</span><span class="ident" id="3303027">search</span><span class="op" id="3303033">[</span><span class="ident" id="3303034">i</span><span class="op" id="3303035">]</span>&nbsp;<span class="op" id="3303037">=</span>&nbsp;<span class="ident" id="3303039">f</span><span class="op" id="3303040">[</span><span class="ident" id="3303041">i</span><span class="op" id="3303042">+</span><span class="num" id="3303043">1</span><span class="op" id="3303044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303054">case</span>&nbsp;<span class="string" id="3303059">&#34;options&#34;</span><span class="op" id="3303068">:</span>&nbsp;<span class="comment" id="3303070">//&nbsp;magic&nbsp;options</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303090">for</span>&nbsp;<span class="ident" id="3303094">i</span>&nbsp;<span class="op" id="3303096">:=</span>&nbsp;<span class="num" id="3303099">1</span><span class="op" id="3303100">;</span>&nbsp;<span class="ident" id="3303102">i</span>&nbsp;<span class="op" id="3303104">&lt;</span>&nbsp;<span class="builtinfunc" id="3303106">len</span><span class="op" id="3303109">(</span><span class="ident" id="3303110">f</span><span class="op" id="3303111">)</span><span class="op" id="3303112">;</span>&nbsp;<span class="ident" id="3303114">i</span><span class="op" id="3303115">++</span>&nbsp;<span class="op" id="3303118">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303124">s</span>&nbsp;<span class="op" id="3303126">:=</span>&nbsp;<span class="ident" id="3303129">f</span><span class="op" id="3303130">[</span><span class="ident" id="3303131">i</span><span class="op" id="3303132">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303138">switch</span>&nbsp;<span class="op" id="3303145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303151">case</span>&nbsp;<span class="ident" id="3303156">hasPrefix</span><span class="op" id="3303165">(</span><span class="ident" id="3303166">s</span><span class="op" id="3303167">,</span>&nbsp;<span class="string" id="3303169">&#34;ndots:&#34;</span><span class="op" id="3303177">)</span><span class="op" id="3303178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303185">n</span><span class="op" id="3303186">,</span>&nbsp;<span class="ident" id="3303188">_</span><span class="op" id="3303189">,</span>&nbsp;<span class="ident" id="3303191">_</span>&nbsp;<span class="op" id="3303193">:=</span>&nbsp;<span class="ident" id="3303196">dtoi</span><span class="op" id="3303200">(</span><span class="ident" id="3303201">s</span><span class="op" id="3303202">,</span>&nbsp;<span class="num" id="3303204">6</span><span class="op" id="3303205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303212">if</span>&nbsp;<span class="ident" id="3303215">n</span>&nbsp;<span class="op" id="3303217">&lt;</span>&nbsp;<span class="num" id="3303219">1</span>&nbsp;<span class="op" id="3303221">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303229">n</span>&nbsp;<span class="op" id="3303231">=</span>&nbsp;<span class="num" id="3303233">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303240">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303247">conf</span><span class="op" id="3303251">.</span><span class="ident" id="3303252">ndots</span>&nbsp;<span class="op" id="3303258">=</span>&nbsp;<span class="ident" id="3303260">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303266">case</span>&nbsp;<span class="ident" id="3303271">hasPrefix</span><span class="op" id="3303280">(</span><span class="ident" id="3303281">s</span><span class="op" id="3303282">,</span>&nbsp;<span class="string" id="3303284">&#34;timeout:&#34;</span><span class="op" id="3303294">)</span><span class="op" id="3303295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303302">n</span><span class="op" id="3303303">,</span>&nbsp;<span class="ident" id="3303305">_</span><span class="op" id="3303306">,</span>&nbsp;<span class="ident" id="3303308">_</span>&nbsp;<span class="op" id="3303310">:=</span>&nbsp;<span class="ident" id="3303313">dtoi</span><span class="op" id="3303317">(</span><span class="ident" id="3303318">s</span><span class="op" id="3303319">,</span>&nbsp;<span class="num" id="3303321">8</span><span class="op" id="3303322">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303329">if</span>&nbsp;<span class="ident" id="3303332">n</span>&nbsp;<span class="op" id="3303334">&lt;</span>&nbsp;<span class="num" id="3303336">1</span>&nbsp;<span class="op" id="3303338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303346">n</span>&nbsp;<span class="op" id="3303348">=</span>&nbsp;<span class="num" id="3303350">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303364">conf</span><span class="op" id="3303368">.</span><span class="ident" id="3303369">timeout</span>&nbsp;<span class="op" id="3303377">=</span>&nbsp;<span class="ident" id="3303379">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303385">case</span>&nbsp;<span class="ident" id="3303390">hasPrefix</span><span class="op" id="3303399">(</span><span class="ident" id="3303400">s</span><span class="op" id="3303401">,</span>&nbsp;<span class="string" id="3303403">&#34;attempts:&#34;</span><span class="op" id="3303414">)</span><span class="op" id="3303415">:</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303422">n</span><span class="op" id="3303423">,</span>&nbsp;<span class="ident" id="3303425">_</span><span class="op" id="3303426">,</span>&nbsp;<span class="ident" id="3303428">_</span>&nbsp;<span class="op" id="3303430">:=</span>&nbsp;<span class="ident" id="3303433">dtoi</span><span class="op" id="3303437">(</span><span class="ident" id="3303438">s</span><span class="op" id="3303439">,</span>&nbsp;<span class="num" id="3303441">9</span><span class="op" id="3303442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303449">if</span>&nbsp;<span class="ident" id="3303452">n</span>&nbsp;<span class="op" id="3303454">&lt;</span>&nbsp;<span class="num" id="3303456">1</span>&nbsp;<span class="op" id="3303458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303466">n</span>&nbsp;<span class="op" id="3303468">=</span>&nbsp;<span class="num" id="3303470">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303484">conf</span><span class="op" id="3303488">.</span><span class="ident" id="3303489">attempts</span>&nbsp;<span class="op" id="3303498">=</span>&nbsp;<span class="ident" id="3303500">n</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303506">case</span>&nbsp;<span class="ident" id="3303511">s</span>&nbsp;<span class="op" id="3303513">==</span>&nbsp;<span class="string" id="3303516">&#34;rotate&#34;</span><span class="op" id="3303524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3303531">conf</span><span class="op" id="3303535">.</span><span class="ident" id="3303536">rotate</span>&nbsp;<span class="op" id="3303543">=</span>&nbsp;<span class="ident" id="3303545">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303563">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3303566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303569">return</span>&nbsp;<span class="ident" id="3303576">conf</span><span class="op" id="3303580">,</span>&nbsp;<span class="ident" id="3303582">nil</span><br>
<span class="lineno"></span><span class="op" id="3303586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3303589">func</span>&nbsp;<span class="ident" id="3303594">hasPrefix</span><span class="op" id="3303603">(</span><span class="ident" id="3303604">s</span><span class="op" id="3303605">,</span>&nbsp;<span class="ident" id="3303607">prefix</span>&nbsp;<span class="builtintype" id="3303614">string</span><span class="op" id="3303620">)</span>&nbsp;<span class="builtintype" id="3303622">bool</span>&nbsp;<span class="op" id="3303627">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3303630">return</span>&nbsp;<span class="builtinfunc" id="3303637">len</span><span class="op" id="3303640">(</span><span class="ident" id="3303641">s</span><span class="op" id="3303642">)</span>&nbsp;<span class="op" id="3303644">&gt;=</span>&nbsp;<span class="builtinfunc" id="3303647">len</span><span class="op" id="3303650">(</span><span class="ident" id="3303651">prefix</span><span class="op" id="3303657">)</span>&nbsp;<span class="op" id="3303659">&amp;&amp;</span>&nbsp;<span class="ident" id="3303662">s</span><span class="op" id="3303663">[</span><span class="op" id="3303664">:</span><span class="builtinfunc" id="3303665">len</span><span class="op" id="3303668">(</span><span class="ident" id="3303669">prefix</span><span class="op" id="3303675">)</span><span class="op" id="3303676">]</span>&nbsp;<span class="op" id="3303678">==</span>&nbsp;<span class="ident" id="3303681">prefix</span><br>
<span class="lineno"></span><span class="op" id="3303688">}</span>
</div>
</body>
</html>
