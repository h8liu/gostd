<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/dsa</h2>
<ul>
<li><a href="/gostd/crypto/dsa/dsa.go.html">dsa.go</a></li>
<li><a href="/gostd/crypto/dsa/dsa_test.go.html" class="current">dsa_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7860496">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7860551">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7860605">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7860656">package</span>&nbsp;<span class="ident" id="7860664">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7860669">import</span>&nbsp;<span class="op" id="7860676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7860679">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7860694">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7860706">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7860716">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7860719">func</span>&nbsp;<span class="ident" id="7860724">testSignAndVerify</span><span class="op" id="7860741">(</span><span class="ident" id="7860742">t</span>&nbsp;<span class="op" id="7860744">*</span><span class="ident" id="7860745">testing</span><span class="op" id="7860752">.</span><span class="ident" id="7860753">T</span><span class="op" id="7860754">,</span>&nbsp;<span class="ident" id="7860756">i</span>&nbsp;<span class="builtintype" id="7860758">int</span><span class="op" id="7860761">,</span>&nbsp;<span class="ident" id="7860763">priv</span>&nbsp;<span class="op" id="7860768">*</span><span class="ident" id="7860769">PrivateKey</span><span class="op" id="7860779">)</span>&nbsp;<span class="op" id="7860781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7860784">hashed</span>&nbsp;<span class="op" id="7860791">:=</span>&nbsp;<span class="op" id="7860794">[</span><span class="op" id="7860795">]</span><span class="builtintype" id="7860796">byte</span><span class="op" id="7860800">(</span><span class="string" id="7860801">&#34;testing&#34;</span><span class="op" id="7860810">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7860813">r</span><span class="op" id="7860814">,</span>&nbsp;<span class="ident" id="7860816">s</span><span class="op" id="7860817">,</span>&nbsp;<span class="ident" id="7860819">err</span>&nbsp;<span class="op" id="7860823">:=</span>&nbsp;<span class="ident" id="7860826">Sign</span><span class="op" id="7860830">(</span><span class="ident" id="7860831">rand</span><span class="op" id="7860835">.</span><span class="ident" id="7860836">Reader</span><span class="op" id="7860842">,</span>&nbsp;<span class="ident" id="7860844">priv</span><span class="op" id="7860848">,</span>&nbsp;<span class="ident" id="7860850">hashed</span><span class="op" id="7860856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7860859">if</span>&nbsp;<span class="ident" id="7860862">err</span>&nbsp;<span class="op" id="7860866">!=</span>&nbsp;<span class="ident" id="7860869">nil</span>&nbsp;<span class="op" id="7860873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7860877">t</span><span class="op" id="7860878">.</span><span class="ident" id="7860879">Errorf</span><span class="op" id="7860885">(</span><span class="string" id="7860886">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="7860909">,</span>&nbsp;<span class="ident" id="7860911">i</span><span class="op" id="7860912">,</span>&nbsp;<span class="ident" id="7860914">err</span><span class="op" id="7860917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7860921">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7860929">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7860933">if</span>&nbsp;<span class="op" id="7860936">!</span><span class="ident" id="7860937">Verify</span><span class="op" id="7860943">(</span><span class="op" id="7860944">&amp;</span><span class="ident" id="7860945">priv</span><span class="op" id="7860949">.</span><span class="ident" id="7860950">PublicKey</span><span class="op" id="7860959">,</span>&nbsp;<span class="ident" id="7860961">hashed</span><span class="op" id="7860967">,</span>&nbsp;<span class="ident" id="7860969">r</span><span class="op" id="7860970">,</span>&nbsp;<span class="ident" id="7860972">s</span><span class="op" id="7860973">)</span>&nbsp;<span class="op" id="7860975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7860979">t</span><span class="op" id="7860980">.</span><span class="ident" id="7860981">Errorf</span><span class="op" id="7860987">(</span><span class="string" id="7860988">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="7861007">,</span>&nbsp;<span class="ident" id="7861009">i</span><span class="op" id="7861010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861013">}</span><br>
<span class="lineno"></span><span class="op" id="7861015">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="7861018">func</span>&nbsp;<span class="ident" id="7861023">testParameterGeneration</span><span class="op" id="7861046">(</span><span class="ident" id="7861047">t</span>&nbsp;<span class="op" id="7861049">*</span><span class="ident" id="7861050">testing</span><span class="op" id="7861057">.</span><span class="ident" id="7861058">T</span><span class="op" id="7861059">,</span>&nbsp;<span class="ident" id="7861061">sizes</span>&nbsp;<span class="ident" id="7861067">ParameterSizes</span><span class="op" id="7861081">,</span>&nbsp;<span class="ident" id="7861083">L</span><span class="op" id="7861084">,</span>&nbsp;<span class="ident" id="7861086">N</span>&nbsp;<span class="builtintype" id="7861088">int</span><span class="op" id="7861091">)</span>&nbsp;<span class="op" id="7861093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861096">var</span>&nbsp;<span class="ident" id="7861100">priv</span>&nbsp;<span class="ident" id="7861105">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861117">params</span>&nbsp;<span class="op" id="7861124">:=</span>&nbsp;<span class="op" id="7861127">&amp;</span><span class="ident" id="7861128">priv</span><span class="op" id="7861132">.</span><span class="ident" id="7861133">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861146">err</span>&nbsp;<span class="op" id="7861150">:=</span>&nbsp;<span class="ident" id="7861153">GenerateParameters</span><span class="op" id="7861171">(</span><span class="ident" id="7861172">params</span><span class="op" id="7861178">,</span>&nbsp;<span class="ident" id="7861180">rand</span><span class="op" id="7861184">.</span><span class="ident" id="7861185">Reader</span><span class="op" id="7861191">,</span>&nbsp;<span class="ident" id="7861193">sizes</span><span class="op" id="7861198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861201">if</span>&nbsp;<span class="ident" id="7861204">err</span>&nbsp;<span class="op" id="7861208">!=</span>&nbsp;<span class="ident" id="7861211">nil</span>&nbsp;<span class="op" id="7861215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861219">t</span><span class="op" id="7861220">.</span><span class="ident" id="7861221">Errorf</span><span class="op" id="7861227">(</span><span class="string" id="7861228">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="7861236">,</span>&nbsp;<span class="builtintype" id="7861238">int</span><span class="op" id="7861241">(</span><span class="ident" id="7861242">sizes</span><span class="op" id="7861247">)</span><span class="op" id="7861248">,</span>&nbsp;<span class="ident" id="7861250">err</span><span class="op" id="7861253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861257">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861265">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861269">if</span>&nbsp;<span class="ident" id="7861272">params</span><span class="op" id="7861278">.</span><span class="ident" id="7861279">P</span><span class="op" id="7861280">.</span><span class="ident" id="7861281">BitLen</span><span class="op" id="7861287">(</span><span class="op" id="7861288">)</span>&nbsp;<span class="op" id="7861290">!=</span>&nbsp;<span class="ident" id="7861293">L</span>&nbsp;<span class="op" id="7861295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861299">t</span><span class="op" id="7861300">.</span><span class="ident" id="7861301">Errorf</span><span class="op" id="7861307">(</span><span class="string" id="7861308">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7861342">,</span>&nbsp;<span class="builtintype" id="7861344">int</span><span class="op" id="7861347">(</span><span class="ident" id="7861348">sizes</span><span class="op" id="7861353">)</span><span class="op" id="7861354">,</span>&nbsp;<span class="ident" id="7861356">params</span><span class="op" id="7861362">.</span><span class="ident" id="7861363">P</span><span class="op" id="7861364">.</span><span class="ident" id="7861365">BitLen</span><span class="op" id="7861371">(</span><span class="op" id="7861372">)</span><span class="op" id="7861373">,</span>&nbsp;<span class="ident" id="7861375">L</span><span class="op" id="7861376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861383">if</span>&nbsp;<span class="ident" id="7861386">params</span><span class="op" id="7861392">.</span><span class="ident" id="7861393">Q</span><span class="op" id="7861394">.</span><span class="ident" id="7861395">BitLen</span><span class="op" id="7861401">(</span><span class="op" id="7861402">)</span>&nbsp;<span class="op" id="7861404">!=</span>&nbsp;<span class="ident" id="7861407">N</span>&nbsp;<span class="op" id="7861409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861413">t</span><span class="op" id="7861414">.</span><span class="ident" id="7861415">Errorf</span><span class="op" id="7861421">(</span><span class="string" id="7861422">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="7861451">,</span>&nbsp;<span class="builtintype" id="7861453">int</span><span class="op" id="7861456">(</span><span class="ident" id="7861457">sizes</span><span class="op" id="7861462">)</span><span class="op" id="7861463">,</span>&nbsp;<span class="ident" id="7861465">params</span><span class="op" id="7861471">.</span><span class="ident" id="7861472">Q</span><span class="op" id="7861473">.</span><span class="ident" id="7861474">BitLen</span><span class="op" id="7861480">(</span><span class="op" id="7861481">)</span><span class="op" id="7861482">,</span>&nbsp;<span class="ident" id="7861484">L</span><span class="op" id="7861485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861492">one</span>&nbsp;<span class="op" id="7861496">:=</span>&nbsp;<span class="builtinfunc" id="7861499">new</span><span class="op" id="7861502">(</span><span class="ident" id="7861503">big</span><span class="op" id="7861506">.</span><span class="ident" id="7861507">Int</span><span class="op" id="7861510">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861513">one</span><span class="op" id="7861516">.</span><span class="ident" id="7861517">SetInt64</span><span class="op" id="7861525">(</span><span class="num" id="7861526">1</span><span class="op" id="7861527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861530">pm1</span>&nbsp;<span class="op" id="7861534">:=</span>&nbsp;<span class="builtinfunc" id="7861537">new</span><span class="op" id="7861540">(</span><span class="ident" id="7861541">big</span><span class="op" id="7861544">.</span><span class="ident" id="7861545">Int</span><span class="op" id="7861548">)</span><span class="op" id="7861549">.</span><span class="ident" id="7861550">Sub</span><span class="op" id="7861553">(</span><span class="ident" id="7861554">params</span><span class="op" id="7861560">.</span><span class="ident" id="7861561">P</span><span class="op" id="7861562">,</span>&nbsp;<span class="ident" id="7861564">one</span><span class="op" id="7861567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861570">quo</span><span class="op" id="7861573">,</span>&nbsp;<span class="ident" id="7861575">rem</span>&nbsp;<span class="op" id="7861579">:=</span>&nbsp;<span class="builtinfunc" id="7861582">new</span><span class="op" id="7861585">(</span><span class="ident" id="7861586">big</span><span class="op" id="7861589">.</span><span class="ident" id="7861590">Int</span><span class="op" id="7861593">)</span><span class="op" id="7861594">.</span><span class="ident" id="7861595">DivMod</span><span class="op" id="7861601">(</span><span class="ident" id="7861602">pm1</span><span class="op" id="7861605">,</span>&nbsp;<span class="ident" id="7861607">params</span><span class="op" id="7861613">.</span><span class="ident" id="7861614">Q</span><span class="op" id="7861615">,</span>&nbsp;<span class="builtinfunc" id="7861617">new</span><span class="op" id="7861620">(</span><span class="ident" id="7861621">big</span><span class="op" id="7861624">.</span><span class="ident" id="7861625">Int</span><span class="op" id="7861628">)</span><span class="op" id="7861629">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861632">if</span>&nbsp;<span class="ident" id="7861635">rem</span><span class="op" id="7861638">.</span><span class="ident" id="7861639">Sign</span><span class="op" id="7861643">(</span><span class="op" id="7861644">)</span>&nbsp;<span class="op" id="7861646">!=</span>&nbsp;<span class="num" id="7861649">0</span>&nbsp;<span class="op" id="7861651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861655">t</span><span class="op" id="7861656">.</span><span class="ident" id="7861657">Errorf</span><span class="op" id="7861663">(</span><span class="string" id="7861664">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="7861684">,</span>&nbsp;<span class="builtintype" id="7861686">int</span><span class="op" id="7861689">(</span><span class="ident" id="7861690">sizes</span><span class="op" id="7861695">)</span><span class="op" id="7861696">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861702">x</span>&nbsp;<span class="op" id="7861704">:=</span>&nbsp;<span class="builtinfunc" id="7861707">new</span><span class="op" id="7861710">(</span><span class="ident" id="7861711">big</span><span class="op" id="7861714">.</span><span class="ident" id="7861715">Int</span><span class="op" id="7861718">)</span><span class="op" id="7861719">.</span><span class="ident" id="7861720">Exp</span><span class="op" id="7861723">(</span><span class="ident" id="7861724">params</span><span class="op" id="7861730">.</span><span class="ident" id="7861731">G</span><span class="op" id="7861732">,</span>&nbsp;<span class="ident" id="7861734">quo</span><span class="op" id="7861737">,</span>&nbsp;<span class="ident" id="7861739">params</span><span class="op" id="7861745">.</span><span class="ident" id="7861746">P</span><span class="op" id="7861747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861750">if</span>&nbsp;<span class="ident" id="7861753">x</span><span class="op" id="7861754">.</span><span class="ident" id="7861755">Cmp</span><span class="op" id="7861758">(</span><span class="ident" id="7861759">one</span><span class="op" id="7861762">)</span>&nbsp;<span class="op" id="7861764">==</span>&nbsp;<span class="num" id="7861767">0</span>&nbsp;<span class="op" id="7861769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861773">t</span><span class="op" id="7861774">.</span><span class="ident" id="7861775">Errorf</span><span class="op" id="7861781">(</span><span class="string" id="7861782">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="7861805">,</span>&nbsp;<span class="builtintype" id="7861807">int</span><span class="op" id="7861810">(</span><span class="ident" id="7861811">sizes</span><span class="op" id="7861816">)</span><span class="op" id="7861817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861820">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861824">err</span>&nbsp;<span class="op" id="7861828">=</span>&nbsp;<span class="ident" id="7861830">GenerateKey</span><span class="op" id="7861841">(</span><span class="op" id="7861842">&amp;</span><span class="ident" id="7861843">priv</span><span class="op" id="7861847">,</span>&nbsp;<span class="ident" id="7861849">rand</span><span class="op" id="7861853">.</span><span class="ident" id="7861854">Reader</span><span class="op" id="7861860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861863">if</span>&nbsp;<span class="ident" id="7861866">err</span>&nbsp;<span class="op" id="7861870">!=</span>&nbsp;<span class="ident" id="7861873">nil</span>&nbsp;<span class="op" id="7861877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861881">t</span><span class="op" id="7861882">.</span><span class="ident" id="7861883">Errorf</span><span class="op" id="7861889">(</span><span class="string" id="7861890">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7861916">,</span>&nbsp;<span class="ident" id="7861918">err</span><span class="op" id="7861921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7861925">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7861933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7861937">testSignAndVerify</span><span class="op" id="7861954">(</span><span class="ident" id="7861955">t</span><span class="op" id="7861956">,</span>&nbsp;<span class="builtintype" id="7861958">int</span><span class="op" id="7861961">(</span><span class="ident" id="7861962">sizes</span><span class="op" id="7861967">)</span><span class="op" id="7861968">,</span>&nbsp;<span class="op" id="7861970">&amp;</span><span class="ident" id="7861971">priv</span><span class="op" id="7861975">)</span><br>
<span class="lineno"></span><span class="op" id="7861977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="7861980">func</span>&nbsp;<span class="ident" id="7861985">TestParameterGeneration</span><span class="op" id="7862008">(</span><span class="ident" id="7862009">t</span>&nbsp;<span class="op" id="7862011">*</span><span class="ident" id="7862012">testing</span><span class="op" id="7862019">.</span><span class="ident" id="7862020">T</span><span class="op" id="7862021">)</span>&nbsp;<span class="op" id="7862023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7862026">if</span>&nbsp;<span class="ident" id="7862029">testing</span><span class="op" id="7862036">.</span><span class="ident" id="7862037">Short</span><span class="op" id="7862042">(</span><span class="op" id="7862043">)</span>&nbsp;<span class="op" id="7862045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862049">t</span><span class="op" id="7862050">.</span><span class="ident" id="7862051">Skip</span><span class="op" id="7862055">(</span><span class="string" id="7862056">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7862106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7862109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862113">testParameterGeneration</span><span class="op" id="7862136">(</span><span class="ident" id="7862137">t</span><span class="op" id="7862138">,</span>&nbsp;<span class="ident" id="7862140">L1024N160</span><span class="op" id="7862149">,</span>&nbsp;<span class="num" id="7862151">1024</span><span class="op" id="7862155">,</span>&nbsp;<span class="num" id="7862157">160</span><span class="op" id="7862160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862163">testParameterGeneration</span><span class="op" id="7862186">(</span><span class="ident" id="7862187">t</span><span class="op" id="7862188">,</span>&nbsp;<span class="ident" id="7862190">L2048N224</span><span class="op" id="7862199">,</span>&nbsp;<span class="num" id="7862201">2048</span><span class="op" id="7862205">,</span>&nbsp;<span class="num" id="7862207">224</span><span class="op" id="7862210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862213">testParameterGeneration</span><span class="op" id="7862236">(</span><span class="ident" id="7862237">t</span><span class="op" id="7862238">,</span>&nbsp;<span class="ident" id="7862240">L2048N256</span><span class="op" id="7862249">,</span>&nbsp;<span class="num" id="7862251">2048</span><span class="op" id="7862255">,</span>&nbsp;<span class="num" id="7862257">256</span><span class="op" id="7862260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862263">testParameterGeneration</span><span class="op" id="7862286">(</span><span class="ident" id="7862287">t</span><span class="op" id="7862288">,</span>&nbsp;<span class="ident" id="7862290">L3072N256</span><span class="op" id="7862299">,</span>&nbsp;<span class="num" id="7862301">3072</span><span class="op" id="7862305">,</span>&nbsp;<span class="num" id="7862307">256</span><span class="op" id="7862310">)</span><br>
<span class="lineno"></span><span class="op" id="7862312">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="7862315">func</span>&nbsp;<span class="ident" id="7862320">TestSignAndVerify</span><span class="op" id="7862337">(</span><span class="ident" id="7862338">t</span>&nbsp;<span class="op" id="7862340">*</span><span class="ident" id="7862341">testing</span><span class="op" id="7862348">.</span><span class="ident" id="7862349">T</span><span class="op" id="7862350">)</span>&nbsp;<span class="op" id="7862352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7862355">var</span>&nbsp;<span class="ident" id="7862359">priv</span>&nbsp;<span class="ident" id="7862364">PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862376">priv</span><span class="op" id="7862380">.</span><span class="ident" id="7862381">P</span><span class="op" id="7862382">,</span>&nbsp;<span class="ident" id="7862384">_</span>&nbsp;<span class="op" id="7862386">=</span>&nbsp;<span class="builtinfunc" id="7862388">new</span><span class="op" id="7862391">(</span><span class="ident" id="7862392">big</span><span class="op" id="7862395">.</span><span class="ident" id="7862396">Int</span><span class="op" id="7862399">)</span><span class="op" id="7862400">.</span><span class="ident" id="7862401">SetString</span><span class="op" id="7862410">(</span><span class="string" id="7862411">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="7862669">,</span>&nbsp;<span class="num" id="7862671">16</span><span class="op" id="7862673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862676">priv</span><span class="op" id="7862680">.</span><span class="ident" id="7862681">Q</span><span class="op" id="7862682">,</span>&nbsp;<span class="ident" id="7862684">_</span>&nbsp;<span class="op" id="7862686">=</span>&nbsp;<span class="builtinfunc" id="7862688">new</span><span class="op" id="7862691">(</span><span class="ident" id="7862692">big</span><span class="op" id="7862695">.</span><span class="ident" id="7862696">Int</span><span class="op" id="7862699">)</span><span class="op" id="7862700">.</span><span class="ident" id="7862701">SetString</span><span class="op" id="7862710">(</span><span class="string" id="7862711">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="7862753">,</span>&nbsp;<span class="num" id="7862755">16</span><span class="op" id="7862757">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7862760">priv</span><span class="op" id="7862764">.</span><span class="ident" id="7862765">G</span><span class="op" id="7862766">,</span>&nbsp;<span class="ident" id="7862768">_</span>&nbsp;<span class="op" id="7862770">=</span>&nbsp;<span class="builtinfunc" id="7862772">new</span><span class="op" id="7862775">(</span><span class="ident" id="7862776">big</span><span class="op" id="7862779">.</span><span class="ident" id="7862780">Int</span><span class="op" id="7862783">)</span><span class="op" id="7862784">.</span><span class="ident" id="7862785">SetString</span><span class="op" id="7862794">(</span><span class="string" id="7862795">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="7863053">,</span>&nbsp;<span class="num" id="7863055">16</span><span class="op" id="7863057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863060">priv</span><span class="op" id="7863064">.</span><span class="ident" id="7863065">Y</span><span class="op" id="7863066">,</span>&nbsp;<span class="ident" id="7863068">_</span>&nbsp;<span class="op" id="7863070">=</span>&nbsp;<span class="builtinfunc" id="7863072">new</span><span class="op" id="7863075">(</span><span class="ident" id="7863076">big</span><span class="op" id="7863079">.</span><span class="ident" id="7863080">Int</span><span class="op" id="7863083">)</span><span class="op" id="7863084">.</span><span class="ident" id="7863085">SetString</span><span class="op" id="7863094">(</span><span class="string" id="7863095">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="7863353">,</span>&nbsp;<span class="num" id="7863355">16</span><span class="op" id="7863357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863360">priv</span><span class="op" id="7863364">.</span><span class="ident" id="7863365">X</span><span class="op" id="7863366">,</span>&nbsp;<span class="ident" id="7863368">_</span>&nbsp;<span class="op" id="7863370">=</span>&nbsp;<span class="builtinfunc" id="7863372">new</span><span class="op" id="7863375">(</span><span class="ident" id="7863376">big</span><span class="op" id="7863379">.</span><span class="ident" id="7863380">Int</span><span class="op" id="7863383">)</span><span class="op" id="7863384">.</span><span class="ident" id="7863385">SetString</span><span class="op" id="7863394">(</span><span class="string" id="7863395">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="7863437">,</span>&nbsp;<span class="num" id="7863439">16</span><span class="op" id="7863441">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863445">testSignAndVerify</span><span class="op" id="7863462">(</span><span class="ident" id="7863463">t</span><span class="op" id="7863464">,</span>&nbsp;<span class="num" id="7863466">0</span><span class="op" id="7863467">,</span>&nbsp;<span class="op" id="7863469">&amp;</span><span class="ident" id="7863470">priv</span><span class="op" id="7863474">)</span><br>
<span class="lineno">85</span><span class="op" id="7863476">}</span>
</div>
</body>
</html>
