<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>time</h2>
<ul>
<li><a href="/gostd/time/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/time/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/time/format.go.html">format.go</a></li>
<li><a href="/gostd/time/format_test.go.html">format_test.go</a></li>
<li><a href="/gostd/time/internal_test.go.html">internal_test.go</a></li>
<li><a href="/gostd/time/sleep.go.html">sleep.go</a></li>
<li><a href="/gostd/time/sleep_test.go.html">sleep_test.go</a></li>
<li><a href="/gostd/time/sys_unix.go.html">sys_unix.go</a></li>
<li><a href="/gostd/time/tick.go.html">tick.go</a></li>
<li><a href="/gostd/time/tick_test.go.html">tick_test.go</a></li>
<li><a href="/gostd/time/time.go.html">time.go</a></li>
<li><a href="/gostd/time/time_test.go.html">time_test.go</a></li>
<li><a href="/gostd/time/zoneinfo.go.html">zoneinfo.go</a></li>
<li><a href="/gostd/time/zoneinfo_read.go.html">zoneinfo_read.go</a></li>
<li><a href="/gostd/time/zoneinfo_test.go.html">zoneinfo_test.go</a></li>
<li><a href="/gostd/time/zoneinfo_unix.go.html">zoneinfo_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2646953">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2647008">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2647062">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2647113">//&nbsp;Parse&nbsp;&#34;zoneinfo&#34;&nbsp;time&nbsp;zone&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="2647149">//&nbsp;This&nbsp;is&nbsp;a&nbsp;fairly&nbsp;standard&nbsp;file&nbsp;format&nbsp;used&nbsp;on&nbsp;OS&nbsp;X,&nbsp;Linux,&nbsp;BSD,&nbsp;Sun,&nbsp;and&nbsp;others.</span><br>
<span class="lineno"></span><span class="comment" id="2647233">//&nbsp;See&nbsp;tzfile(5),&nbsp;http://en.wikipedia.org/wiki/Zoneinfo,</span><br>
<span class="lineno"></span><span class="comment" id="2647290">//&nbsp;and&nbsp;ftp://munnari.oz.au/pub/oldtz/</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="2647329">package</span>&nbsp;<span class="ident" id="2647337">time</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2647343">import</span>&nbsp;<span class="string" id="2647350">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2647360">//&nbsp;Simple&nbsp;I/O&nbsp;interface&nbsp;to&nbsp;binary&nbsp;blob&nbsp;of&nbsp;data.</span><br>
<span class="lineno">15</span><span class="keyword" id="2647408">type</span>&nbsp;<span class="ident" id="2647413">data</span>&nbsp;<span class="keyword" id="2647418">struct</span>&nbsp;<span class="op" id="2647425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647428">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2647434">[</span><span class="op" id="2647435">]</span><span class="builtintype" id="2647436">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2647442">error</span>&nbsp;<span class="builtintype" id="2647448">bool</span><br>
<span class="lineno"></span><span class="op" id="2647453">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="2647456">func</span>&nbsp;<span class="op" id="2647461">(</span><span class="ident" id="2647462">d</span>&nbsp;<span class="op" id="2647464">*</span><span class="ident" id="2647465">data</span><span class="op" id="2647469">)</span>&nbsp;<span class="ident" id="2647471">read</span><span class="op" id="2647475">(</span><span class="ident" id="2647476">n</span>&nbsp;<span class="builtintype" id="2647478">int</span><span class="op" id="2647481">)</span>&nbsp;<span class="op" id="2647483">[</span><span class="op" id="2647484">]</span><span class="builtintype" id="2647485">byte</span>&nbsp;<span class="op" id="2647490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647493">if</span>&nbsp;<span class="builtinfunc" id="2647496">len</span><span class="op" id="2647499">(</span><span class="ident" id="2647500">d</span><span class="op" id="2647501">.</span><span class="ident" id="2647502">p</span><span class="op" id="2647503">)</span>&nbsp;<span class="op" id="2647505">&lt;</span>&nbsp;<span class="ident" id="2647507">n</span>&nbsp;<span class="op" id="2647509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647513">d</span><span class="op" id="2647514">.</span><span class="ident" id="2647515">p</span>&nbsp;<span class="op" id="2647517">=</span>&nbsp;<span class="ident" id="2647519">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647525">d</span><span class="op" id="2647526">.</span><span class="builtintype" id="2647527">error</span>&nbsp;<span class="op" id="2647533">=</span>&nbsp;<span class="builtintype" id="2647535">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647542">return</span>&nbsp;<span class="ident" id="2647549">nil</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647557">p</span>&nbsp;<span class="op" id="2647559">:=</span>&nbsp;<span class="ident" id="2647562">d</span><span class="op" id="2647563">.</span><span class="ident" id="2647564">p</span><span class="op" id="2647565">[</span><span class="num" id="2647566">0</span><span class="op" id="2647567">:</span><span class="ident" id="2647568">n</span><span class="op" id="2647569">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647572">d</span><span class="op" id="2647573">.</span><span class="ident" id="2647574">p</span>&nbsp;<span class="op" id="2647576">=</span>&nbsp;<span class="ident" id="2647578">d</span><span class="op" id="2647579">.</span><span class="ident" id="2647580">p</span><span class="op" id="2647581">[</span><span class="ident" id="2647582">n</span><span class="op" id="2647583">:</span><span class="op" id="2647584">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647587">return</span>&nbsp;<span class="ident" id="2647594">p</span><br>
<span class="lineno"></span><span class="op" id="2647596">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="2647599">func</span>&nbsp;<span class="op" id="2647604">(</span><span class="ident" id="2647605">d</span>&nbsp;<span class="op" id="2647607">*</span><span class="ident" id="2647608">data</span><span class="op" id="2647612">)</span>&nbsp;<span class="ident" id="2647614">big4</span><span class="op" id="2647618">(</span><span class="op" id="2647619">)</span>&nbsp;<span class="op" id="2647621">(</span><span class="ident" id="2647622">n</span>&nbsp;<span class="builtintype" id="2647624">uint32</span><span class="op" id="2647630">,</span>&nbsp;<span class="ident" id="2647632">ok</span>&nbsp;<span class="builtintype" id="2647635">bool</span><span class="op" id="2647639">)</span>&nbsp;<span class="op" id="2647641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647644">p</span>&nbsp;<span class="op" id="2647646">:=</span>&nbsp;<span class="ident" id="2647649">d</span><span class="op" id="2647650">.</span><span class="ident" id="2647651">read</span><span class="op" id="2647655">(</span><span class="num" id="2647656">4</span><span class="op" id="2647657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647660">if</span>&nbsp;<span class="builtinfunc" id="2647663">len</span><span class="op" id="2647666">(</span><span class="ident" id="2647667">p</span><span class="op" id="2647668">)</span>&nbsp;<span class="op" id="2647670">&lt;</span>&nbsp;<span class="num" id="2647672">4</span>&nbsp;<span class="op" id="2647674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647678">d</span><span class="op" id="2647679">.</span><span class="builtintype" id="2647680">error</span>&nbsp;<span class="op" id="2647686">=</span>&nbsp;<span class="builtintype" id="2647688">true</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647695">return</span>&nbsp;<span class="num" id="2647702">0</span><span class="op" id="2647703">,</span>&nbsp;<span class="builtintype" id="2647705">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647715">return</span>&nbsp;<span class="builtintype" id="2647722">uint32</span><span class="op" id="2647728">(</span><span class="ident" id="2647729">p</span><span class="op" id="2647730">[</span><span class="num" id="2647731">0</span><span class="op" id="2647732">]</span><span class="op" id="2647733">)</span><span class="op" id="2647734">&lt;&lt;</span><span class="num" id="2647736">24</span>&nbsp;<span class="op" id="2647739">|</span>&nbsp;<span class="builtintype" id="2647741">uint32</span><span class="op" id="2647747">(</span><span class="ident" id="2647748">p</span><span class="op" id="2647749">[</span><span class="num" id="2647750">1</span><span class="op" id="2647751">]</span><span class="op" id="2647752">)</span><span class="op" id="2647753">&lt;&lt;</span><span class="num" id="2647755">16</span>&nbsp;<span class="op" id="2647758">|</span>&nbsp;<span class="builtintype" id="2647760">uint32</span><span class="op" id="2647766">(</span><span class="ident" id="2647767">p</span><span class="op" id="2647768">[</span><span class="num" id="2647769">2</span><span class="op" id="2647770">]</span><span class="op" id="2647771">)</span><span class="op" id="2647772">&lt;&lt;</span><span class="num" id="2647774">8</span>&nbsp;<span class="op" id="2647776">|</span>&nbsp;<span class="builtintype" id="2647778">uint32</span><span class="op" id="2647784">(</span><span class="ident" id="2647785">p</span><span class="op" id="2647786">[</span><span class="num" id="2647787">3</span><span class="op" id="2647788">]</span><span class="op" id="2647789">)</span><span class="op" id="2647790">,</span>&nbsp;<span class="builtintype" id="2647792">true</span><br>
<span class="lineno"></span><span class="op" id="2647797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2647800">func</span>&nbsp;<span class="op" id="2647805">(</span><span class="ident" id="2647806">d</span>&nbsp;<span class="op" id="2647808">*</span><span class="ident" id="2647809">data</span><span class="op" id="2647813">)</span>&nbsp;<span class="builtintype" id="2647815">byte</span><span class="op" id="2647819">(</span><span class="op" id="2647820">)</span>&nbsp;<span class="op" id="2647822">(</span><span class="ident" id="2647823">n</span>&nbsp;<span class="builtintype" id="2647825">byte</span><span class="op" id="2647829">,</span>&nbsp;<span class="ident" id="2647831">ok</span>&nbsp;<span class="builtintype" id="2647834">bool</span><span class="op" id="2647838">)</span>&nbsp;<span class="op" id="2647840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647843">p</span>&nbsp;<span class="op" id="2647845">:=</span>&nbsp;<span class="ident" id="2647848">d</span><span class="op" id="2647849">.</span><span class="ident" id="2647850">read</span><span class="op" id="2647854">(</span><span class="num" id="2647855">1</span><span class="op" id="2647856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647859">if</span>&nbsp;<span class="builtinfunc" id="2647862">len</span><span class="op" id="2647865">(</span><span class="ident" id="2647866">p</span><span class="op" id="2647867">)</span>&nbsp;<span class="op" id="2647869">&lt;</span>&nbsp;<span class="num" id="2647871">1</span>&nbsp;<span class="op" id="2647873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2647877">d</span><span class="op" id="2647878">.</span><span class="builtintype" id="2647879">error</span>&nbsp;<span class="op" id="2647885">=</span>&nbsp;<span class="builtintype" id="2647887">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647894">return</span>&nbsp;<span class="num" id="2647901">0</span><span class="op" id="2647902">,</span>&nbsp;<span class="builtintype" id="2647904">false</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2647911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2647914">return</span>&nbsp;<span class="ident" id="2647921">p</span><span class="op" id="2647922">[</span><span class="num" id="2647923">0</span><span class="op" id="2647924">]</span><span class="op" id="2647925">,</span>&nbsp;<span class="builtintype" id="2647927">true</span><br>
<span class="lineno"></span><span class="op" id="2647932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2647935">//&nbsp;Make&nbsp;a&nbsp;string&nbsp;by&nbsp;stopping&nbsp;at&nbsp;the&nbsp;first&nbsp;NUL</span><br>
<span class="lineno">50</span><span class="keyword" id="2647981">func</span>&nbsp;<span class="ident" id="2647986">byteString</span><span class="op" id="2647996">(</span><span class="ident" id="2647997">p</span>&nbsp;<span class="op" id="2647999">[</span><span class="op" id="2648000">]</span><span class="builtintype" id="2648001">byte</span><span class="op" id="2648005">)</span>&nbsp;<span class="builtintype" id="2648007">string</span>&nbsp;<span class="op" id="2648014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648017">for</span>&nbsp;<span class="ident" id="2648021">i</span>&nbsp;<span class="op" id="2648023">:=</span>&nbsp;<span class="num" id="2648026">0</span><span class="op" id="2648027">;</span>&nbsp;<span class="ident" id="2648029">i</span>&nbsp;<span class="op" id="2648031">&lt;</span>&nbsp;<span class="builtinfunc" id="2648033">len</span><span class="op" id="2648036">(</span><span class="ident" id="2648037">p</span><span class="op" id="2648038">)</span><span class="op" id="2648039">;</span>&nbsp;<span class="ident" id="2648041">i</span><span class="op" id="2648042">++</span>&nbsp;<span class="op" id="2648045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648049">if</span>&nbsp;<span class="ident" id="2648052">p</span><span class="op" id="2648053">[</span><span class="ident" id="2648054">i</span><span class="op" id="2648055">]</span>&nbsp;<span class="op" id="2648057">==</span>&nbsp;<span class="num" id="2648060">0</span>&nbsp;<span class="op" id="2648062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648067">return</span>&nbsp;<span class="builtintype" id="2648074">string</span><span class="op" id="2648080">(</span><span class="ident" id="2648081">p</span><span class="op" id="2648082">[</span><span class="num" id="2648083">0</span><span class="op" id="2648084">:</span><span class="ident" id="2648085">i</span><span class="op" id="2648086">]</span><span class="op" id="2648087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648091">}</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648097">return</span>&nbsp;<span class="builtintype" id="2648104">string</span><span class="op" id="2648110">(</span><span class="ident" id="2648111">p</span><span class="op" id="2648112">)</span><br>
<span class="lineno"></span><span class="op" id="2648114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2648117">var</span>&nbsp;<span class="ident" id="2648121">badData</span>&nbsp;<span class="op" id="2648129">=</span>&nbsp;<span class="ident" id="2648131">errors</span><span class="op" id="2648137">.</span><span class="ident" id="2648138">New</span><span class="op" id="2648141">(</span><span class="string" id="2648142">&#34;malformed&nbsp;time&nbsp;zone&nbsp;information&#34;</span><span class="op" id="2648175">)</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="2648178">func</span>&nbsp;<span class="ident" id="2648183">loadZoneData</span><span class="op" id="2648195">(</span><span class="ident" id="2648196">bytes</span>&nbsp;<span class="op" id="2648202">[</span><span class="op" id="2648203">]</span><span class="builtintype" id="2648204">byte</span><span class="op" id="2648208">)</span>&nbsp;<span class="op" id="2648210">(</span><span class="ident" id="2648211">l</span>&nbsp;<span class="op" id="2648213">*</span><span class="ident" id="2648214">Location</span><span class="op" id="2648222">,</span>&nbsp;<span class="ident" id="2648224">err</span>&nbsp;<span class="builtintype" id="2648228">error</span><span class="op" id="2648233">)</span>&nbsp;<span class="op" id="2648235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648238">d</span>&nbsp;<span class="op" id="2648240">:=</span>&nbsp;<span class="ident" id="2648243">data</span><span class="op" id="2648247">{</span><span class="ident" id="2648248">bytes</span><span class="op" id="2648253">,</span>&nbsp;<span class="builtintype" id="2648255">false</span><span class="op" id="2648260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648264">//&nbsp;4-byte&nbsp;magic&nbsp;&#34;TZif&#34;</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648288">if</span>&nbsp;<span class="ident" id="2648291">magic</span>&nbsp;<span class="op" id="2648297">:=</span>&nbsp;<span class="ident" id="2648300">d</span><span class="op" id="2648301">.</span><span class="ident" id="2648302">read</span><span class="op" id="2648306">(</span><span class="num" id="2648307">4</span><span class="op" id="2648308">)</span><span class="op" id="2648309">;</span>&nbsp;<span class="builtintype" id="2648311">string</span><span class="op" id="2648317">(</span><span class="ident" id="2648318">magic</span><span class="op" id="2648323">)</span>&nbsp;<span class="op" id="2648325">!=</span>&nbsp;<span class="string" id="2648328">&#34;TZif&#34;</span>&nbsp;<span class="op" id="2648335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648339">return</span>&nbsp;<span class="ident" id="2648346">nil</span><span class="op" id="2648349">,</span>&nbsp;<span class="ident" id="2648351">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648360">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648364">//&nbsp;1-byte&nbsp;version,&nbsp;then&nbsp;15&nbsp;bytes&nbsp;of&nbsp;padding</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648409">var</span>&nbsp;<span class="ident" id="2648413">p</span>&nbsp;<span class="op" id="2648415">[</span><span class="op" id="2648416">]</span><span class="builtintype" id="2648417">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648423">if</span>&nbsp;<span class="ident" id="2648426">p</span>&nbsp;<span class="op" id="2648428">=</span>&nbsp;<span class="ident" id="2648430">d</span><span class="op" id="2648431">.</span><span class="ident" id="2648432">read</span><span class="op" id="2648436">(</span><span class="num" id="2648437">16</span><span class="op" id="2648439">)</span><span class="op" id="2648440">;</span>&nbsp;<span class="builtinfunc" id="2648442">len</span><span class="op" id="2648445">(</span><span class="ident" id="2648446">p</span><span class="op" id="2648447">)</span>&nbsp;<span class="op" id="2648449">!=</span>&nbsp;<span class="num" id="2648452">16</span>&nbsp;<span class="op" id="2648455">||</span>&nbsp;<span class="ident" id="2648458">p</span><span class="op" id="2648459">[</span><span class="num" id="2648460">0</span><span class="op" id="2648461">]</span>&nbsp;<span class="op" id="2648463">!=</span>&nbsp;<span class="num" id="2648466">0</span>&nbsp;<span class="op" id="2648468">&amp;&amp;</span>&nbsp;<span class="ident" id="2648471">p</span><span class="op" id="2648472">[</span><span class="num" id="2648473">0</span><span class="op" id="2648474">]</span>&nbsp;<span class="op" id="2648476">!=</span>&nbsp;<span class="string" id="2648479">&#39;2&#39;</span>&nbsp;<span class="op" id="2648483">&amp;&amp;</span>&nbsp;<span class="ident" id="2648486">p</span><span class="op" id="2648487">[</span><span class="num" id="2648488">0</span><span class="op" id="2648489">]</span>&nbsp;<span class="op" id="2648491">!=</span>&nbsp;<span class="string" id="2648494">&#39;3&#39;</span>&nbsp;<span class="op" id="2648498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648502">return</span>&nbsp;<span class="ident" id="2648509">nil</span><span class="op" id="2648512">,</span>&nbsp;<span class="ident" id="2648514">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648527">//&nbsp;six&nbsp;big-endian&nbsp;32-bit&nbsp;integers:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648563">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;UTC/local&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648598">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;standard/wall&nbsp;indicators</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648637">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;leap&nbsp;seconds</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648664">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;transition&nbsp;times</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648695">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;local&nbsp;time&nbsp;zones</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648726">//&nbsp;&nbsp;&nbsp;&nbspnumber&nbsp;of&nbsp;characters&nbsp;of&nbsp;time&nbsp;zone&nbsp;abbrev&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648779">const</span>&nbsp;<span class="op" id="2648785">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648789">NUTCLocal</span>&nbsp;<span class="op" id="2648799">=</span>&nbsp;<span class="ident" id="2648801">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648808">NStdWall</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648819">NLeap</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648827">NTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648835">NZone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648843">NChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648850">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648853">var</span>&nbsp;<span class="ident" id="2648857">n</span>&nbsp;<span class="op" id="2648859">[</span><span class="num" id="2648860">6</span><span class="op" id="2648861">]</span><span class="builtintype" id="2648862">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648867">for</span>&nbsp;<span class="ident" id="2648871">i</span>&nbsp;<span class="op" id="2648873">:=</span>&nbsp;<span class="num" id="2648876">0</span><span class="op" id="2648877">;</span>&nbsp;<span class="ident" id="2648879">i</span>&nbsp;<span class="op" id="2648881">&lt;</span>&nbsp;<span class="num" id="2648883">6</span><span class="op" id="2648884">;</span>&nbsp;<span class="ident" id="2648886">i</span><span class="op" id="2648887">++</span>&nbsp;<span class="op" id="2648890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648894">nn</span><span class="op" id="2648896">,</span>&nbsp;<span class="ident" id="2648898">ok</span>&nbsp;<span class="op" id="2648901">:=</span>&nbsp;<span class="ident" id="2648904">d</span><span class="op" id="2648905">.</span><span class="ident" id="2648906">big4</span><span class="op" id="2648910">(</span><span class="op" id="2648911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648915">if</span>&nbsp;<span class="op" id="2648918">!</span><span class="ident" id="2648919">ok</span>&nbsp;<span class="op" id="2648922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2648927">return</span>&nbsp;<span class="ident" id="2648934">nil</span><span class="op" id="2648937">,</span>&nbsp;<span class="ident" id="2648939">badData</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648953">n</span><span class="op" id="2648954">[</span><span class="ident" id="2648955">i</span><span class="op" id="2648956">]</span>&nbsp;<span class="op" id="2648958">=</span>&nbsp;<span class="builtintype" id="2648960">int</span><span class="op" id="2648963">(</span><span class="ident" id="2648964">nn</span><span class="op" id="2648966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2648969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2648973">//&nbsp;Transition&nbsp;times.</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2648995">txtimes</span>&nbsp;<span class="op" id="2649003">:=</span>&nbsp;<span class="ident" id="2649006">data</span><span class="op" id="2649010">{</span><span class="ident" id="2649011">d</span><span class="op" id="2649012">.</span><span class="ident" id="2649013">read</span><span class="op" id="2649017">(</span><span class="ident" id="2649018">n</span><span class="op" id="2649019">[</span><span class="ident" id="2649020">NTime</span><span class="op" id="2649025">]</span>&nbsp;<span class="op" id="2649027">*</span>&nbsp;<span class="num" id="2649029">4</span><span class="op" id="2649030">)</span><span class="op" id="2649031">,</span>&nbsp;<span class="builtintype" id="2649033">false</span><span class="op" id="2649038">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649042">//&nbsp;Time&nbsp;zone&nbsp;indices&nbsp;for&nbsp;transition&nbsp;times.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649086">txzones</span>&nbsp;<span class="op" id="2649094">:=</span>&nbsp;<span class="ident" id="2649097">d</span><span class="op" id="2649098">.</span><span class="ident" id="2649099">read</span><span class="op" id="2649103">(</span><span class="ident" id="2649104">n</span><span class="op" id="2649105">[</span><span class="ident" id="2649106">NTime</span><span class="op" id="2649111">]</span><span class="op" id="2649112">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649116">//&nbsp;Zone&nbsp;info&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649141">zonedata</span>&nbsp;<span class="op" id="2649150">:=</span>&nbsp;<span class="ident" id="2649153">data</span><span class="op" id="2649157">{</span><span class="ident" id="2649158">d</span><span class="op" id="2649159">.</span><span class="ident" id="2649160">read</span><span class="op" id="2649164">(</span><span class="ident" id="2649165">n</span><span class="op" id="2649166">[</span><span class="ident" id="2649167">NZone</span><span class="op" id="2649172">]</span>&nbsp;<span class="op" id="2649174">*</span>&nbsp;<span class="num" id="2649176">6</span><span class="op" id="2649177">)</span><span class="op" id="2649178">,</span>&nbsp;<span class="builtintype" id="2649180">false</span><span class="op" id="2649185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649189">//&nbsp;Time&nbsp;zone&nbsp;abbreviations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649218">abbrev</span>&nbsp;<span class="op" id="2649225">:=</span>&nbsp;<span class="ident" id="2649228">d</span><span class="op" id="2649229">.</span><span class="ident" id="2649230">read</span><span class="op" id="2649234">(</span><span class="ident" id="2649235">n</span><span class="op" id="2649236">[</span><span class="ident" id="2649237">NChar</span><span class="op" id="2649242">]</span><span class="op" id="2649243">)</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649247">//&nbsp;Leap-second&nbsp;time&nbsp;pairs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649274">d</span><span class="op" id="2649275">.</span><span class="ident" id="2649276">read</span><span class="op" id="2649280">(</span><span class="ident" id="2649281">n</span><span class="op" id="2649282">[</span><span class="ident" id="2649283">NLeap</span><span class="op" id="2649288">]</span>&nbsp;<span class="op" id="2649290">*</span>&nbsp;<span class="num" id="2649292">8</span><span class="op" id="2649293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649297">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649351">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;standard&nbsp;time&nbsp;or&nbsp;wall&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649400">isstd</span>&nbsp;<span class="op" id="2649406">:=</span>&nbsp;<span class="ident" id="2649409">d</span><span class="op" id="2649410">.</span><span class="ident" id="2649411">read</span><span class="op" id="2649415">(</span><span class="ident" id="2649416">n</span><span class="op" id="2649417">[</span><span class="ident" id="2649418">NStdWall</span><span class="op" id="2649426">]</span><span class="op" id="2649427">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649431">//&nbsp;Whether&nbsp;tx&nbsp;times&nbsp;associated&nbsp;with&nbsp;local&nbsp;time&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649485">//&nbsp;are&nbsp;specified&nbsp;as&nbsp;UTC&nbsp;or&nbsp;local&nbsp;time.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649525">isutc</span>&nbsp;<span class="op" id="2649531">:=</span>&nbsp;<span class="ident" id="2649534">d</span><span class="op" id="2649535">.</span><span class="ident" id="2649536">read</span><span class="op" id="2649540">(</span><span class="ident" id="2649541">n</span><span class="op" id="2649542">[</span><span class="ident" id="2649543">NUTCLocal</span><span class="op" id="2649552">]</span><span class="op" id="2649553">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649557">if</span>&nbsp;<span class="ident" id="2649560">d</span><span class="op" id="2649561">.</span><span class="builtintype" id="2649562">error</span>&nbsp;<span class="op" id="2649568">{</span>&nbsp;<span class="comment" id="2649570">//&nbsp;ran&nbsp;out&nbsp;of&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649591">return</span>&nbsp;<span class="ident" id="2649598">nil</span><span class="op" id="2649601">,</span>&nbsp;<span class="ident" id="2649603">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2649612">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649616">//&nbsp;If&nbsp;version&nbsp;==&nbsp;2&nbsp;or&nbsp;3,&nbsp;the&nbsp;entire&nbsp;file&nbsp;repeats,&nbsp;this&nbsp;time&nbsp;using</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649683">//&nbsp;8-byte&nbsp;ints&nbsp;for&nbsp;txtimes&nbsp;and&nbsp;leap&nbsp;seconds.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649729">//&nbsp;We&nbsp;won&#39;t&nbsp;need&nbsp;those&nbsp;until&nbsp;2106.</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649766">//&nbsp;Now&nbsp;we&nbsp;can&nbsp;build&nbsp;up&nbsp;a&nbsp;useful&nbsp;data&nbsp;structure.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649815">//&nbsp;First&nbsp;the&nbsp;zone&nbsp;information.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2649847">//&nbsp;&nbsp;&nbsp;&nbsputcoff[4]&nbsp;isdst[1]&nbsp;nameindex[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2649883">zone</span>&nbsp;<span class="op" id="2649888">:=</span>&nbsp;<span class="builtinfunc" id="2649891">make</span><span class="op" id="2649895">(</span><span class="op" id="2649896">[</span><span class="op" id="2649897">]</span><span class="ident" id="2649898">zone</span><span class="op" id="2649902">,</span>&nbsp;<span class="ident" id="2649904">n</span><span class="op" id="2649905">[</span><span class="ident" id="2649906">NZone</span><span class="op" id="2649911">]</span><span class="op" id="2649912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649915">for</span>&nbsp;<span class="ident" id="2649919">i</span>&nbsp;<span class="op" id="2649921">:=</span>&nbsp;<span class="keyword" id="2649924">range</span>&nbsp;<span class="ident" id="2649930">zone</span>&nbsp;<span class="op" id="2649935">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649939">var</span>&nbsp;<span class="ident" id="2649943">ok</span>&nbsp;<span class="builtintype" id="2649946">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649953">var</span>&nbsp;<span class="ident" id="2649957">n</span>&nbsp;<span class="builtintype" id="2649959">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2649968">if</span>&nbsp;<span class="ident" id="2649971">n</span><span class="op" id="2649972">,</span>&nbsp;<span class="ident" id="2649974">ok</span>&nbsp;<span class="op" id="2649977">=</span>&nbsp;<span class="ident" id="2649979">zonedata</span><span class="op" id="2649987">.</span><span class="ident" id="2649988">big4</span><span class="op" id="2649992">(</span><span class="op" id="2649993">)</span><span class="op" id="2649994">;</span>&nbsp;<span class="op" id="2649996">!</span><span class="ident" id="2649997">ok</span>&nbsp;<span class="op" id="2650000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650005">return</span>&nbsp;<span class="ident" id="2650012">nil</span><span class="op" id="2650015">,</span>&nbsp;<span class="ident" id="2650017">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650027">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650031">zone</span><span class="op" id="2650035">[</span><span class="ident" id="2650036">i</span><span class="op" id="2650037">]</span><span class="op" id="2650038">.</span><span class="ident" id="2650039">offset</span>&nbsp;<span class="op" id="2650046">=</span>&nbsp;<span class="builtintype" id="2650048">int</span><span class="op" id="2650051">(</span><span class="builtintype" id="2650052">int32</span><span class="op" id="2650057">(</span><span class="ident" id="2650058">n</span><span class="op" id="2650059">)</span><span class="op" id="2650060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650064">var</span>&nbsp;<span class="ident" id="2650068">b</span>&nbsp;<span class="builtintype" id="2650070">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650077">if</span>&nbsp;<span class="ident" id="2650080">b</span><span class="op" id="2650081">,</span>&nbsp;<span class="ident" id="2650083">ok</span>&nbsp;<span class="op" id="2650086">=</span>&nbsp;<span class="ident" id="2650088">zonedata</span><span class="op" id="2650096">.</span><span class="builtintype" id="2650097">byte</span><span class="op" id="2650101">(</span><span class="op" id="2650102">)</span><span class="op" id="2650103">;</span>&nbsp;<span class="op" id="2650105">!</span><span class="ident" id="2650106">ok</span>&nbsp;<span class="op" id="2650109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650114">return</span>&nbsp;<span class="ident" id="2650121">nil</span><span class="op" id="2650124">,</span>&nbsp;<span class="ident" id="2650126">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650136">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650140">zone</span><span class="op" id="2650144">[</span><span class="ident" id="2650145">i</span><span class="op" id="2650146">]</span><span class="op" id="2650147">.</span><span class="ident" id="2650148">isDST</span>&nbsp;<span class="op" id="2650154">=</span>&nbsp;<span class="ident" id="2650156">b</span>&nbsp;<span class="op" id="2650158">!=</span>&nbsp;<span class="num" id="2650161">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650165">if</span>&nbsp;<span class="ident" id="2650168">b</span><span class="op" id="2650169">,</span>&nbsp;<span class="ident" id="2650171">ok</span>&nbsp;<span class="op" id="2650174">=</span>&nbsp;<span class="ident" id="2650176">zonedata</span><span class="op" id="2650184">.</span><span class="builtintype" id="2650185">byte</span><span class="op" id="2650189">(</span><span class="op" id="2650190">)</span><span class="op" id="2650191">;</span>&nbsp;<span class="op" id="2650193">!</span><span class="ident" id="2650194">ok</span>&nbsp;<span class="op" id="2650197">||</span>&nbsp;<span class="builtintype" id="2650200">int</span><span class="op" id="2650203">(</span><span class="ident" id="2650204">b</span><span class="op" id="2650205">)</span>&nbsp;<span class="op" id="2650207">&gt;=</span>&nbsp;<span class="builtinfunc" id="2650210">len</span><span class="op" id="2650213">(</span><span class="ident" id="2650214">abbrev</span><span class="op" id="2650220">)</span>&nbsp;<span class="op" id="2650222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650227">return</span>&nbsp;<span class="ident" id="2650234">nil</span><span class="op" id="2650237">,</span>&nbsp;<span class="ident" id="2650239">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650253">zone</span><span class="op" id="2650257">[</span><span class="ident" id="2650258">i</span><span class="op" id="2650259">]</span><span class="op" id="2650260">.</span><span class="ident" id="2650261">name</span>&nbsp;<span class="op" id="2650266">=</span>&nbsp;<span class="ident" id="2650268">byteString</span><span class="op" id="2650278">(</span><span class="ident" id="2650279">abbrev</span><span class="op" id="2650285">[</span><span class="ident" id="2650286">b</span><span class="op" id="2650287">:</span><span class="op" id="2650288">]</span><span class="op" id="2650289">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650296">//&nbsp;Now&nbsp;the&nbsp;transition&nbsp;time&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650330">tx</span>&nbsp;<span class="op" id="2650333">:=</span>&nbsp;<span class="builtinfunc" id="2650336">make</span><span class="op" id="2650340">(</span><span class="op" id="2650341">[</span><span class="op" id="2650342">]</span><span class="ident" id="2650343">zoneTrans</span><span class="op" id="2650352">,</span>&nbsp;<span class="ident" id="2650354">n</span><span class="op" id="2650355">[</span><span class="ident" id="2650356">NTime</span><span class="op" id="2650361">]</span><span class="op" id="2650362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650365">for</span>&nbsp;<span class="ident" id="2650369">i</span>&nbsp;<span class="op" id="2650371">:=</span>&nbsp;<span class="keyword" id="2650374">range</span>&nbsp;<span class="ident" id="2650380">tx</span>&nbsp;<span class="op" id="2650383">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650387">var</span>&nbsp;<span class="ident" id="2650391">ok</span>&nbsp;<span class="builtintype" id="2650394">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650401">var</span>&nbsp;<span class="ident" id="2650405">n</span>&nbsp;<span class="builtintype" id="2650407">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650416">if</span>&nbsp;<span class="ident" id="2650419">n</span><span class="op" id="2650420">,</span>&nbsp;<span class="ident" id="2650422">ok</span>&nbsp;<span class="op" id="2650425">=</span>&nbsp;<span class="ident" id="2650427">txtimes</span><span class="op" id="2650434">.</span><span class="ident" id="2650435">big4</span><span class="op" id="2650439">(</span><span class="op" id="2650440">)</span><span class="op" id="2650441">;</span>&nbsp;<span class="op" id="2650443">!</span><span class="ident" id="2650444">ok</span>&nbsp;<span class="op" id="2650447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650452">return</span>&nbsp;<span class="ident" id="2650459">nil</span><span class="op" id="2650462">,</span>&nbsp;<span class="ident" id="2650464">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650474">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650478">tx</span><span class="op" id="2650480">[</span><span class="ident" id="2650481">i</span><span class="op" id="2650482">]</span><span class="op" id="2650483">.</span><span class="ident" id="2650484">when</span>&nbsp;<span class="op" id="2650489">=</span>&nbsp;<span class="ident" id="2650491">int64</span><span class="op" id="2650496">(</span><span class="builtintype" id="2650497">int32</span><span class="op" id="2650502">(</span><span class="ident" id="2650503">n</span><span class="op" id="2650504">)</span><span class="op" id="2650505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650509">if</span>&nbsp;<span class="builtintype" id="2650512">int</span><span class="op" id="2650515">(</span><span class="ident" id="2650516">txzones</span><span class="op" id="2650523">[</span><span class="ident" id="2650524">i</span><span class="op" id="2650525">]</span><span class="op" id="2650526">)</span>&nbsp;<span class="op" id="2650528">&gt;=</span>&nbsp;<span class="builtinfunc" id="2650531">len</span><span class="op" id="2650534">(</span><span class="ident" id="2650535">zone</span><span class="op" id="2650539">)</span>&nbsp;<span class="op" id="2650541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650546">return</span>&nbsp;<span class="ident" id="2650553">nil</span><span class="op" id="2650556">,</span>&nbsp;<span class="ident" id="2650558">badData</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650572">tx</span><span class="op" id="2650574">[</span><span class="ident" id="2650575">i</span><span class="op" id="2650576">]</span><span class="op" id="2650577">.</span><span class="ident" id="2650578">index</span>&nbsp;<span class="op" id="2650584">=</span>&nbsp;<span class="ident" id="2650586">txzones</span><span class="op" id="2650593">[</span><span class="ident" id="2650594">i</span><span class="op" id="2650595">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650599">if</span>&nbsp;<span class="ident" id="2650602">i</span>&nbsp;<span class="op" id="2650604">&lt;</span>&nbsp;<span class="builtinfunc" id="2650606">len</span><span class="op" id="2650609">(</span><span class="ident" id="2650610">isstd</span><span class="op" id="2650615">)</span>&nbsp;<span class="op" id="2650617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650622">tx</span><span class="op" id="2650624">[</span><span class="ident" id="2650625">i</span><span class="op" id="2650626">]</span><span class="op" id="2650627">.</span><span class="ident" id="2650628">isstd</span>&nbsp;<span class="op" id="2650634">=</span>&nbsp;<span class="ident" id="2650636">isstd</span><span class="op" id="2650641">[</span><span class="ident" id="2650642">i</span><span class="op" id="2650643">]</span>&nbsp;<span class="op" id="2650645">!=</span>&nbsp;<span class="num" id="2650648">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650656">if</span>&nbsp;<span class="ident" id="2650659">i</span>&nbsp;<span class="op" id="2650661">&lt;</span>&nbsp;<span class="builtinfunc" id="2650663">len</span><span class="op" id="2650666">(</span><span class="ident" id="2650667">isutc</span><span class="op" id="2650672">)</span>&nbsp;<span class="op" id="2650674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650679">tx</span><span class="op" id="2650681">[</span><span class="ident" id="2650682">i</span><span class="op" id="2650683">]</span><span class="op" id="2650684">.</span><span class="ident" id="2650685">isutc</span>&nbsp;<span class="op" id="2650691">=</span>&nbsp;<span class="ident" id="2650693">isutc</span><span class="op" id="2650698">[</span><span class="ident" id="2650699">i</span><span class="op" id="2650700">]</span>&nbsp;<span class="op" id="2650702">!=</span>&nbsp;<span class="num" id="2650705">0</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2650716">if</span>&nbsp;<span class="builtinfunc" id="2650719">len</span><span class="op" id="2650722">(</span><span class="ident" id="2650723">tx</span><span class="op" id="2650725">)</span>&nbsp;<span class="op" id="2650727">==</span>&nbsp;<span class="num" id="2650730">0</span>&nbsp;<span class="op" id="2650732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650736">//&nbsp;Build&nbsp;fake&nbsp;transition&nbsp;to&nbsp;cover&nbsp;all&nbsp;time.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650782">//&nbsp;This&nbsp;happens&nbsp;in&nbsp;fixed&nbsp;locations&nbsp;like&nbsp;&#34;Etc/GMT0&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650836">tx</span>&nbsp;<span class="op" id="2650839">=</span>&nbsp;<span class="builtinfunc" id="2650841">append</span><span class="op" id="2650847">(</span><span class="ident" id="2650848">tx</span><span class="op" id="2650850">,</span>&nbsp;<span class="ident" id="2650852">zoneTrans</span><span class="op" id="2650861">{</span><span class="ident" id="2650862">when</span><span class="op" id="2650866">:</span>&nbsp;<span class="ident" id="2650868">alpha</span><span class="op" id="2650873">,</span>&nbsp;<span class="ident" id="2650875">index</span><span class="op" id="2650880">:</span>&nbsp;<span class="num" id="2650882">0</span><span class="op" id="2650883">}</span><span class="op" id="2650884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2650887">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650891">//&nbsp;Committed&nbsp;to&nbsp;succeed.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2650917">l</span>&nbsp;<span class="op" id="2650919">=</span>&nbsp;<span class="op" id="2650921">&amp;</span><span class="ident" id="2650922">Location</span><span class="op" id="2650930">{</span><span class="ident" id="2650931">zone</span><span class="op" id="2650935">:</span>&nbsp;<span class="ident" id="2650937">zone</span><span class="op" id="2650941">,</span>&nbsp;<span class="ident" id="2650943">tx</span><span class="op" id="2650945">:</span>&nbsp;<span class="ident" id="2650947">tx</span><span class="op" id="2650949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2650953">//&nbsp;Fill&nbsp;in&nbsp;the&nbsp;cache&nbsp;with&nbsp;information&nbsp;about&nbsp;right&nbsp;now,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2651009">//&nbsp;since&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;most&nbsp;common&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651056">sec</span><span class="op" id="2651059">,</span>&nbsp;<span class="ident" id="2651061">_</span>&nbsp;<span class="op" id="2651063">:=</span>&nbsp;<span class="ident" id="2651066">now</span><span class="op" id="2651069">(</span><span class="op" id="2651070">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651073">for</span>&nbsp;<span class="ident" id="2651077">i</span>&nbsp;<span class="op" id="2651079">:=</span>&nbsp;<span class="keyword" id="2651082">range</span>&nbsp;<span class="ident" id="2651088">tx</span>&nbsp;<span class="op" id="2651091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651095">if</span>&nbsp;<span class="ident" id="2651098">tx</span><span class="op" id="2651100">[</span><span class="ident" id="2651101">i</span><span class="op" id="2651102">]</span><span class="op" id="2651103">.</span><span class="ident" id="2651104">when</span>&nbsp;<span class="op" id="2651109">&lt;=</span>&nbsp;<span class="ident" id="2651112">sec</span>&nbsp;<span class="op" id="2651116">&amp;&amp;</span>&nbsp;<span class="op" id="2651119">(</span><span class="ident" id="2651120">i</span><span class="op" id="2651121">+</span><span class="num" id="2651122">1</span>&nbsp;<span class="op" id="2651124">==</span>&nbsp;<span class="builtinfunc" id="2651127">len</span><span class="op" id="2651130">(</span><span class="ident" id="2651131">tx</span><span class="op" id="2651133">)</span>&nbsp;<span class="op" id="2651135">||</span>&nbsp;<span class="ident" id="2651138">sec</span>&nbsp;<span class="op" id="2651142">&lt;</span>&nbsp;<span class="ident" id="2651144">tx</span><span class="op" id="2651146">[</span><span class="ident" id="2651147">i</span><span class="op" id="2651148">+</span><span class="num" id="2651149">1</span><span class="op" id="2651150">]</span><span class="op" id="2651151">.</span><span class="ident" id="2651152">when</span><span class="op" id="2651156">)</span>&nbsp;<span class="op" id="2651158">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651163">l</span><span class="op" id="2651164">.</span><span class="ident" id="2651165">cacheStart</span>&nbsp;<span class="op" id="2651176">=</span>&nbsp;<span class="ident" id="2651178">tx</span><span class="op" id="2651180">[</span><span class="ident" id="2651181">i</span><span class="op" id="2651182">]</span><span class="op" id="2651183">.</span><span class="ident" id="2651184">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651192">l</span><span class="op" id="2651193">.</span><span class="ident" id="2651194">cacheEnd</span>&nbsp;<span class="op" id="2651203">=</span>&nbsp;<span class="ident" id="2651205">omega</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651214">if</span>&nbsp;<span class="ident" id="2651217">i</span><span class="op" id="2651218">+</span><span class="num" id="2651219">1</span>&nbsp;<span class="op" id="2651221">&lt;</span>&nbsp;<span class="builtinfunc" id="2651223">len</span><span class="op" id="2651226">(</span><span class="ident" id="2651227">tx</span><span class="op" id="2651229">)</span>&nbsp;<span class="op" id="2651231">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651237">l</span><span class="op" id="2651238">.</span><span class="ident" id="2651239">cacheEnd</span>&nbsp;<span class="op" id="2651248">=</span>&nbsp;<span class="ident" id="2651250">tx</span><span class="op" id="2651252">[</span><span class="ident" id="2651253">i</span><span class="op" id="2651254">+</span><span class="num" id="2651255">1</span><span class="op" id="2651256">]</span><span class="op" id="2651257">.</span><span class="ident" id="2651258">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651271">l</span><span class="op" id="2651272">.</span><span class="ident" id="2651273">cacheZone</span>&nbsp;<span class="op" id="2651283">=</span>&nbsp;<span class="op" id="2651285">&amp;</span><span class="ident" id="2651286">l</span><span class="op" id="2651287">.</span><span class="ident" id="2651288">zone</span><span class="op" id="2651292">[</span><span class="ident" id="2651293">tx</span><span class="op" id="2651295">[</span><span class="ident" id="2651296">i</span><span class="op" id="2651297">]</span><span class="op" id="2651298">.</span><span class="ident" id="2651299">index</span><span class="op" id="2651304">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651311">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651315">return</span>&nbsp;<span class="ident" id="2651322">l</span><span class="op" id="2651323">,</span>&nbsp;<span class="ident" id="2651325">nil</span><br>
<span class="lineno"></span><span class="op" id="2651329">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2651332">func</span>&nbsp;<span class="ident" id="2651337">loadZoneFile</span><span class="op" id="2651349">(</span><span class="ident" id="2651350">dir</span><span class="op" id="2651353">,</span>&nbsp;<span class="ident" id="2651355">name</span>&nbsp;<span class="builtintype" id="2651360">string</span><span class="op" id="2651366">)</span>&nbsp;<span class="op" id="2651368">(</span><span class="ident" id="2651369">l</span>&nbsp;<span class="op" id="2651371">*</span><span class="ident" id="2651372">Location</span><span class="op" id="2651380">,</span>&nbsp;<span class="ident" id="2651382">err</span>&nbsp;<span class="builtintype" id="2651386">error</span><span class="op" id="2651391">)</span>&nbsp;<span class="op" id="2651393">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651396">if</span>&nbsp;<span class="builtinfunc" id="2651399">len</span><span class="op" id="2651402">(</span><span class="ident" id="2651403">dir</span><span class="op" id="2651406">)</span>&nbsp;<span class="op" id="2651408">&gt;</span>&nbsp;<span class="num" id="2651410">4</span>&nbsp;<span class="op" id="2651412">&amp;&amp;</span>&nbsp;<span class="ident" id="2651415">dir</span><span class="op" id="2651418">[</span><span class="builtinfunc" id="2651419">len</span><span class="op" id="2651422">(</span><span class="ident" id="2651423">dir</span><span class="op" id="2651426">)</span><span class="op" id="2651427">-</span><span class="num" id="2651428">4</span><span class="op" id="2651429">:</span><span class="op" id="2651430">]</span>&nbsp;<span class="op" id="2651432">==</span>&nbsp;<span class="string" id="2651435">&#34;.zip&#34;</span>&nbsp;<span class="op" id="2651442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651446">return</span>&nbsp;<span class="ident" id="2651453">loadZoneZip</span><span class="op" id="2651464">(</span><span class="ident" id="2651465">dir</span><span class="op" id="2651468">,</span>&nbsp;<span class="ident" id="2651470">name</span><span class="op" id="2651474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651480">if</span>&nbsp;<span class="ident" id="2651483">dir</span>&nbsp;<span class="op" id="2651487">!=</span>&nbsp;<span class="string" id="2651490">&#34;&#34;</span>&nbsp;<span class="op" id="2651493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651497">name</span>&nbsp;<span class="op" id="2651502">=</span>&nbsp;<span class="ident" id="2651504">dir</span>&nbsp;<span class="op" id="2651508">+</span>&nbsp;<span class="string" id="2651510">&#34;/&#34;</span>&nbsp;<span class="op" id="2651514">+</span>&nbsp;<span class="ident" id="2651516">name</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2651525">buf</span><span class="op" id="2651528">,</span>&nbsp;<span class="ident" id="2651530">err</span>&nbsp;<span class="op" id="2651534">:=</span>&nbsp;<span class="ident" id="2651537">readFile</span><span class="op" id="2651545">(</span><span class="ident" id="2651546">name</span><span class="op" id="2651550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651553">if</span>&nbsp;<span class="ident" id="2651556">err</span>&nbsp;<span class="op" id="2651560">!=</span>&nbsp;<span class="ident" id="2651563">nil</span>&nbsp;<span class="op" id="2651567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651571">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2651579">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2651582">return</span>&nbsp;<span class="ident" id="2651589">loadZoneData</span><span class="op" id="2651601">(</span><span class="ident" id="2651602">buf</span><span class="op" id="2651605">)</span><br>
<span class="lineno"></span><span class="op" id="2651607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2651610">//&nbsp;There&nbsp;are&nbsp;500+&nbsp;zoneinfo&nbsp;files.&nbsp;&nbsp;Rather&nbsp;than&nbsp;distribute&nbsp;them&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="2651677">//&nbsp;individually,&nbsp;we&nbsp;ship&nbsp;them&nbsp;in&nbsp;an&nbsp;uncompressed&nbsp;zip&nbsp;file.</span><br>
<span class="lineno">215</span><span class="comment" id="2651736">//&nbsp;Used&nbsp;this&nbsp;way,&nbsp;the&nbsp;zip&nbsp;file&nbsp;format&nbsp;serves&nbsp;as&nbsp;a&nbsp;commonly&nbsp;readable</span><br>
<span class="lineno"></span><span class="comment" id="2651804">//&nbsp;container&nbsp;for&nbsp;the&nbsp;individual&nbsp;small&nbsp;files.&nbsp;&nbsp;We&nbsp;choose&nbsp;zip&nbsp;over&nbsp;tar</span><br>
<span class="lineno"></span><span class="comment" id="2651873">//&nbsp;because&nbsp;zip&nbsp;files&nbsp;have&nbsp;a&nbsp;contiguous&nbsp;table&nbsp;of&nbsp;contents,&nbsp;making</span><br>
<span class="lineno"></span><span class="comment" id="2651938">//&nbsp;individual&nbsp;file&nbsp;lookups&nbsp;faster,&nbsp;and&nbsp;because&nbsp;the&nbsp;per-file&nbsp;overhead</span><br>
<span class="lineno"></span><span class="comment" id="2652007">//&nbsp;in&nbsp;a&nbsp;zip&nbsp;file&nbsp;is&nbsp;considerably&nbsp;less&nbsp;than&nbsp;tar&#39;s&nbsp;512&nbsp;bytes.</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2652068">//&nbsp;get4&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;32-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="2652121">func</span>&nbsp;<span class="ident" id="2652126">get4</span><span class="op" id="2652130">(</span><span class="ident" id="2652131">b</span>&nbsp;<span class="op" id="2652133">[</span><span class="op" id="2652134">]</span><span class="builtintype" id="2652135">byte</span><span class="op" id="2652139">)</span>&nbsp;<span class="builtintype" id="2652141">int</span>&nbsp;<span class="op" id="2652145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652148">if</span>&nbsp;<span class="builtinfunc" id="2652151">len</span><span class="op" id="2652154">(</span><span class="ident" id="2652155">b</span><span class="op" id="2652156">)</span>&nbsp;<span class="op" id="2652158">&lt;</span>&nbsp;<span class="num" id="2652160">4</span>&nbsp;<span class="op" id="2652162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652166">return</span>&nbsp;<span class="num" id="2652173">0</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652179">return</span>&nbsp;<span class="builtintype" id="2652186">int</span><span class="op" id="2652189">(</span><span class="ident" id="2652190">b</span><span class="op" id="2652191">[</span><span class="num" id="2652192">0</span><span class="op" id="2652193">]</span><span class="op" id="2652194">)</span>&nbsp;<span class="op" id="2652196">|</span>&nbsp;<span class="builtintype" id="2652198">int</span><span class="op" id="2652201">(</span><span class="ident" id="2652202">b</span><span class="op" id="2652203">[</span><span class="num" id="2652204">1</span><span class="op" id="2652205">]</span><span class="op" id="2652206">)</span><span class="op" id="2652207">&lt;&lt;</span><span class="num" id="2652209">8</span>&nbsp;<span class="op" id="2652211">|</span>&nbsp;<span class="builtintype" id="2652213">int</span><span class="op" id="2652216">(</span><span class="ident" id="2652217">b</span><span class="op" id="2652218">[</span><span class="num" id="2652219">2</span><span class="op" id="2652220">]</span><span class="op" id="2652221">)</span><span class="op" id="2652222">&lt;&lt;</span><span class="num" id="2652224">16</span>&nbsp;<span class="op" id="2652227">|</span>&nbsp;<span class="builtintype" id="2652229">int</span><span class="op" id="2652232">(</span><span class="ident" id="2652233">b</span><span class="op" id="2652234">[</span><span class="num" id="2652235">3</span><span class="op" id="2652236">]</span><span class="op" id="2652237">)</span><span class="op" id="2652238">&lt;&lt;</span><span class="num" id="2652240">24</span><br>
<span class="lineno"></span><span class="op" id="2652243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2652246">//&nbsp;get2&nbsp;returns&nbsp;the&nbsp;little-endian&nbsp;16-bit&nbsp;value&nbsp;in&nbsp;b.</span><br>
<span class="lineno">230</span><span class="keyword" id="2652299">func</span>&nbsp;<span class="ident" id="2652304">get2</span><span class="op" id="2652308">(</span><span class="ident" id="2652309">b</span>&nbsp;<span class="op" id="2652311">[</span><span class="op" id="2652312">]</span><span class="builtintype" id="2652313">byte</span><span class="op" id="2652317">)</span>&nbsp;<span class="builtintype" id="2652319">int</span>&nbsp;<span class="op" id="2652323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652326">if</span>&nbsp;<span class="builtinfunc" id="2652329">len</span><span class="op" id="2652332">(</span><span class="ident" id="2652333">b</span><span class="op" id="2652334">)</span>&nbsp;<span class="op" id="2652336">&lt;</span>&nbsp;<span class="num" id="2652338">2</span>&nbsp;<span class="op" id="2652340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652344">return</span>&nbsp;<span class="num" id="2652351">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652357">return</span>&nbsp;<span class="builtintype" id="2652364">int</span><span class="op" id="2652367">(</span><span class="ident" id="2652368">b</span><span class="op" id="2652369">[</span><span class="num" id="2652370">0</span><span class="op" id="2652371">]</span><span class="op" id="2652372">)</span>&nbsp;<span class="op" id="2652374">|</span>&nbsp;<span class="builtintype" id="2652376">int</span><span class="op" id="2652379">(</span><span class="ident" id="2652380">b</span><span class="op" id="2652381">[</span><span class="num" id="2652382">1</span><span class="op" id="2652383">]</span><span class="op" id="2652384">)</span><span class="op" id="2652385">&lt;&lt;</span><span class="num" id="2652387">8</span><br>
<span class="lineno">235</span><span class="op" id="2652389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2652392">func</span>&nbsp;<span class="ident" id="2652397">loadZoneZip</span><span class="op" id="2652408">(</span><span class="ident" id="2652409">zipfile</span><span class="op" id="2652416">,</span>&nbsp;<span class="ident" id="2652418">name</span>&nbsp;<span class="builtintype" id="2652423">string</span><span class="op" id="2652429">)</span>&nbsp;<span class="op" id="2652431">(</span><span class="ident" id="2652432">l</span>&nbsp;<span class="op" id="2652434">*</span><span class="ident" id="2652435">Location</span><span class="op" id="2652443">,</span>&nbsp;<span class="ident" id="2652445">err</span>&nbsp;<span class="builtintype" id="2652449">error</span><span class="op" id="2652454">)</span>&nbsp;<span class="op" id="2652456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652459">fd</span><span class="op" id="2652461">,</span>&nbsp;<span class="ident" id="2652463">err</span>&nbsp;<span class="op" id="2652467">:=</span>&nbsp;<span class="ident" id="2652470">open</span><span class="op" id="2652474">(</span><span class="ident" id="2652475">zipfile</span><span class="op" id="2652482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652485">if</span>&nbsp;<span class="ident" id="2652488">err</span>&nbsp;<span class="op" id="2652492">!=</span>&nbsp;<span class="ident" id="2652495">nil</span>&nbsp;<span class="op" id="2652499">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652503">return</span>&nbsp;<span class="ident" id="2652510">nil</span><span class="op" id="2652513">,</span>&nbsp;<span class="ident" id="2652515">errors</span><span class="op" id="2652521">.</span><span class="ident" id="2652522">New</span><span class="op" id="2652525">(</span><span class="string" id="2652526">&#34;open&nbsp;&#34;</span>&nbsp;<span class="op" id="2652534">+</span>&nbsp;<span class="ident" id="2652536">zipfile</span>&nbsp;<span class="op" id="2652544">+</span>&nbsp;<span class="string" id="2652546">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="2652551">+</span>&nbsp;<span class="ident" id="2652553">err</span><span class="op" id="2652556">.</span><span class="ident" id="2652557">Error</span><span class="op" id="2652562">(</span><span class="op" id="2652563">)</span><span class="op" id="2652564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652570">defer</span>&nbsp;<span class="ident" id="2652576">closefd</span><span class="op" id="2652583">(</span><span class="ident" id="2652584">fd</span><span class="op" id="2652586">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652590">const</span>&nbsp;<span class="op" id="2652596">(</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652600">zecheader</span>&nbsp;<span class="op" id="2652610">=</span>&nbsp;<span class="num" id="2652612">0x06054b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652625">zcheader</span>&nbsp;&nbsp;<span class="op" id="2652635">=</span>&nbsp;<span class="num" id="2652637">0x02014b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652650">ztailsize</span>&nbsp;<span class="op" id="2652660">=</span>&nbsp;<span class="num" id="2652662">22</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652668">zheadersize</span>&nbsp;<span class="op" id="2652680">=</span>&nbsp;<span class="num" id="2652682">30</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652687">zheader</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2652699">=</span>&nbsp;<span class="num" id="2652701">0x04034b50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652713">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652717">buf</span>&nbsp;<span class="op" id="2652721">:=</span>&nbsp;<span class="builtinfunc" id="2652724">make</span><span class="op" id="2652728">(</span><span class="op" id="2652729">[</span><span class="op" id="2652730">]</span><span class="builtintype" id="2652731">byte</span><span class="op" id="2652735">,</span>&nbsp;<span class="ident" id="2652737">ztailsize</span><span class="op" id="2652746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652749">if</span>&nbsp;<span class="ident" id="2652752">err</span>&nbsp;<span class="op" id="2652756">:=</span>&nbsp;<span class="ident" id="2652759">preadn</span><span class="op" id="2652765">(</span><span class="ident" id="2652766">fd</span><span class="op" id="2652768">,</span>&nbsp;<span class="ident" id="2652770">buf</span><span class="op" id="2652773">,</span>&nbsp;<span class="op" id="2652775">-</span><span class="ident" id="2652776">ztailsize</span><span class="op" id="2652785">)</span><span class="op" id="2652786">;</span>&nbsp;<span class="ident" id="2652788">err</span>&nbsp;<span class="op" id="2652792">!=</span>&nbsp;<span class="ident" id="2652795">nil</span>&nbsp;<span class="op" id="2652799">||</span>&nbsp;<span class="ident" id="2652802">get4</span><span class="op" id="2652806">(</span><span class="ident" id="2652807">buf</span><span class="op" id="2652810">)</span>&nbsp;<span class="op" id="2652812">!=</span>&nbsp;<span class="ident" id="2652815">zecheader</span>&nbsp;<span class="op" id="2652825">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652829">return</span>&nbsp;<span class="ident" id="2652836">nil</span><span class="op" id="2652839">,</span>&nbsp;<span class="ident" id="2652841">errors</span><span class="op" id="2652847">.</span><span class="ident" id="2652848">New</span><span class="op" id="2652851">(</span><span class="string" id="2652852">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2652872">+</span>&nbsp;<span class="ident" id="2652874">zipfile</span><span class="op" id="2652881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2652884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652887">n</span>&nbsp;<span class="op" id="2652889">:=</span>&nbsp;<span class="ident" id="2652892">get2</span><span class="op" id="2652896">(</span><span class="ident" id="2652897">buf</span><span class="op" id="2652900">[</span><span class="num" id="2652901">10</span><span class="op" id="2652903">:</span><span class="op" id="2652904">]</span><span class="op" id="2652905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652908">size</span>&nbsp;<span class="op" id="2652913">:=</span>&nbsp;<span class="ident" id="2652916">get4</span><span class="op" id="2652920">(</span><span class="ident" id="2652921">buf</span><span class="op" id="2652924">[</span><span class="num" id="2652925">12</span><span class="op" id="2652927">:</span><span class="op" id="2652928">]</span><span class="op" id="2652929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652932">off</span>&nbsp;<span class="op" id="2652936">:=</span>&nbsp;<span class="ident" id="2652939">get4</span><span class="op" id="2652943">(</span><span class="ident" id="2652944">buf</span><span class="op" id="2652947">[</span><span class="num" id="2652948">16</span><span class="op" id="2652950">:</span><span class="op" id="2652951">]</span><span class="op" id="2652952">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2652956">buf</span>&nbsp;<span class="op" id="2652960">=</span>&nbsp;<span class="builtinfunc" id="2652962">make</span><span class="op" id="2652966">(</span><span class="op" id="2652967">[</span><span class="op" id="2652968">]</span><span class="builtintype" id="2652969">byte</span><span class="op" id="2652973">,</span>&nbsp;<span class="ident" id="2652975">size</span><span class="op" id="2652979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2652982">if</span>&nbsp;<span class="ident" id="2652985">err</span>&nbsp;<span class="op" id="2652989">:=</span>&nbsp;<span class="ident" id="2652992">preadn</span><span class="op" id="2652998">(</span><span class="ident" id="2652999">fd</span><span class="op" id="2653001">,</span>&nbsp;<span class="ident" id="2653003">buf</span><span class="op" id="2653006">,</span>&nbsp;<span class="ident" id="2653008">off</span><span class="op" id="2653011">)</span><span class="op" id="2653012">;</span>&nbsp;<span class="ident" id="2653014">err</span>&nbsp;<span class="op" id="2653018">!=</span>&nbsp;<span class="ident" id="2653021">nil</span>&nbsp;<span class="op" id="2653025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653029">return</span>&nbsp;<span class="ident" id="2653036">nil</span><span class="op" id="2653039">,</span>&nbsp;<span class="ident" id="2653041">errors</span><span class="op" id="2653047">.</span><span class="ident" id="2653048">New</span><span class="op" id="2653051">(</span><span class="string" id="2653052">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2653072">+</span>&nbsp;<span class="ident" id="2653074">zipfile</span><span class="op" id="2653081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653084">}</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653088">for</span>&nbsp;<span class="ident" id="2653092">i</span>&nbsp;<span class="op" id="2653094">:=</span>&nbsp;<span class="num" id="2653097">0</span><span class="op" id="2653098">;</span>&nbsp;<span class="ident" id="2653100">i</span>&nbsp;<span class="op" id="2653102">&lt;</span>&nbsp;<span class="ident" id="2653104">n</span><span class="op" id="2653105">;</span>&nbsp;<span class="ident" id="2653107">i</span><span class="op" id="2653108">++</span>&nbsp;<span class="op" id="2653111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653115">//&nbsp;zip&nbsp;entry&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653138">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653154">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspmadevers[1]</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653173">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspmadeos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653190">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653208">//&nbsp;&nbsp;&nbsp;&nbsp7&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653224">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653240">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653256">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653275">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653294">//&nbsp;&nbsp;&nbsp;&nbsp16&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653309">//&nbsp;&nbsp;&nbsp;&nbsp20&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653326">//&nbsp;&nbsp;&nbsp;&nbsp24&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653345">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653364">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653380">//&nbsp;&nbsp;&nbsp;&nbsp32&nbsp;&nbsp;&nbsp;&nbspfclen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653397">//&nbsp;&nbsp;&nbsp;&nbsp34&nbsp;&nbsp;&nbsp;&nbspdisknum[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653416">//&nbsp;&nbsp;&nbsp;&nbsp36&nbsp;&nbsp;&nbsp;&nbspiattr[2]</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653433">//&nbsp;&nbsp;&nbsp;&nbsp38&nbsp;&nbsp;&nbsp;&nbspeattr[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653450">//&nbsp;&nbsp;&nbsp;&nbsp42&nbsp;&nbsp;&nbsp;&nbspoff[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653465">//&nbsp;&nbsp;&nbsp;&nbsp46&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653487">//&nbsp;&nbsp;&nbsp;&nbsp46+namelen+xlen+fclen&nbsp;-&nbsp;next&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653528">//</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653533">if</span>&nbsp;<span class="ident" id="2653536">get4</span><span class="op" id="2653540">(</span><span class="ident" id="2653541">buf</span><span class="op" id="2653544">)</span>&nbsp;<span class="op" id="2653546">!=</span>&nbsp;<span class="ident" id="2653549">zcheader</span>&nbsp;<span class="op" id="2653558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653563">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653575">meth</span>&nbsp;<span class="op" id="2653580">:=</span>&nbsp;<span class="ident" id="2653583">get2</span><span class="op" id="2653587">(</span><span class="ident" id="2653588">buf</span><span class="op" id="2653591">[</span><span class="num" id="2653592">10</span><span class="op" id="2653594">:</span><span class="op" id="2653595">]</span><span class="op" id="2653596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653600">size</span>&nbsp;<span class="op" id="2653605">:=</span>&nbsp;<span class="ident" id="2653608">get4</span><span class="op" id="2653612">(</span><span class="ident" id="2653613">buf</span><span class="op" id="2653616">[</span><span class="num" id="2653617">24</span><span class="op" id="2653619">:</span><span class="op" id="2653620">]</span><span class="op" id="2653621">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653625">namelen</span>&nbsp;<span class="op" id="2653633">:=</span>&nbsp;<span class="ident" id="2653636">get2</span><span class="op" id="2653640">(</span><span class="ident" id="2653641">buf</span><span class="op" id="2653644">[</span><span class="num" id="2653645">28</span><span class="op" id="2653647">:</span><span class="op" id="2653648">]</span><span class="op" id="2653649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653653">xlen</span>&nbsp;<span class="op" id="2653658">:=</span>&nbsp;<span class="ident" id="2653661">get2</span><span class="op" id="2653665">(</span><span class="ident" id="2653666">buf</span><span class="op" id="2653669">[</span><span class="num" id="2653670">30</span><span class="op" id="2653672">:</span><span class="op" id="2653673">]</span><span class="op" id="2653674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653678">fclen</span>&nbsp;<span class="op" id="2653684">:=</span>&nbsp;<span class="ident" id="2653687">get2</span><span class="op" id="2653691">(</span><span class="ident" id="2653692">buf</span><span class="op" id="2653695">[</span><span class="num" id="2653696">32</span><span class="op" id="2653698">:</span><span class="op" id="2653699">]</span><span class="op" id="2653700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653704">off</span>&nbsp;<span class="op" id="2653708">:=</span>&nbsp;<span class="ident" id="2653711">get4</span><span class="op" id="2653715">(</span><span class="ident" id="2653716">buf</span><span class="op" id="2653719">[</span><span class="num" id="2653720">42</span><span class="op" id="2653722">:</span><span class="op" id="2653723">]</span><span class="op" id="2653724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653728">zname</span>&nbsp;<span class="op" id="2653734">:=</span>&nbsp;<span class="ident" id="2653737">buf</span><span class="op" id="2653740">[</span><span class="num" id="2653741">46</span>&nbsp;<span class="op" id="2653744">:</span>&nbsp;<span class="num" id="2653746">46</span><span class="op" id="2653748">+</span><span class="ident" id="2653749">namelen</span><span class="op" id="2653756">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2653760">buf</span>&nbsp;<span class="op" id="2653764">=</span>&nbsp;<span class="ident" id="2653766">buf</span><span class="op" id="2653769">[</span><span class="num" id="2653770">46</span><span class="op" id="2653772">+</span><span class="ident" id="2653773">namelen</span><span class="op" id="2653780">+</span><span class="ident" id="2653781">xlen</span><span class="op" id="2653785">+</span><span class="ident" id="2653786">fclen</span><span class="op" id="2653791">:</span><span class="op" id="2653792">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653796">if</span>&nbsp;<span class="builtintype" id="2653799">string</span><span class="op" id="2653805">(</span><span class="ident" id="2653806">zname</span><span class="op" id="2653811">)</span>&nbsp;<span class="op" id="2653813">!=</span>&nbsp;<span class="ident" id="2653816">name</span>&nbsp;<span class="op" id="2653821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653826">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653841">if</span>&nbsp;<span class="ident" id="2653844">meth</span>&nbsp;<span class="op" id="2653849">!=</span>&nbsp;<span class="num" id="2653852">0</span>&nbsp;<span class="op" id="2653854">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2653859">return</span>&nbsp;<span class="ident" id="2653866">nil</span><span class="op" id="2653869">,</span>&nbsp;<span class="ident" id="2653871">errors</span><span class="op" id="2653877">.</span><span class="ident" id="2653878">New</span><span class="op" id="2653881">(</span><span class="string" id="2653882">&#34;unsupported&nbsp;compression&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="2653913">+</span>&nbsp;<span class="ident" id="2653915">name</span>&nbsp;<span class="op" id="2653920">+</span>&nbsp;<span class="string" id="2653922">&#34;&nbsp;in&nbsp;&#34;</span>&nbsp;<span class="op" id="2653929">+</span>&nbsp;<span class="ident" id="2653931">zipfile</span><span class="op" id="2653938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2653942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653947">//&nbsp;zip&nbsp;per-file&nbsp;header&nbsp;layout:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653980">//&nbsp;&nbsp;&nbsp;&nbsp0&nbsp;&nbsp;&nbsp;&nbspmagic[4]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2653996">//&nbsp;&nbsp;&nbsp;&nbsp4&nbsp;&nbsp;&nbsp;&nbspextvers[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654014">//&nbsp;&nbsp;&nbsp;&nbsp5&nbsp;&nbsp;&nbsp;&nbspextos[1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654030">//&nbsp;&nbsp;&nbsp;&nbsp6&nbsp;&nbsp;&nbsp;&nbspflags[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654046">//&nbsp;&nbsp;&nbsp;&nbsp8&nbsp;&nbsp;&nbsp;&nbspmeth[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654061">//&nbsp;&nbsp;&nbsp;&nbsp10&nbsp;&nbsp;&nbsp;&nbspmodtime[2]</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654080">//&nbsp;&nbsp;&nbsp;&nbsp12&nbsp;&nbsp;&nbsp;&nbspmoddate[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654099">//&nbsp;&nbsp;&nbsp;&nbsp14&nbsp;&nbsp;&nbsp;&nbspcrc[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654114">//&nbsp;&nbsp;&nbsp;&nbsp18&nbsp;&nbsp;&nbsp;&nbspcsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654131">//&nbsp;&nbsp;&nbsp;&nbsp22&nbsp;&nbsp;&nbsp;&nbspuncsize[4]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654150">//&nbsp;&nbsp;&nbsp;&nbsp26&nbsp;&nbsp;&nbsp;&nbspnamelen[2]</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654169">//&nbsp;&nbsp;&nbsp;&nbsp28&nbsp;&nbsp;&nbsp;&nbspxlen[2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654185">//&nbsp;&nbsp;&nbsp;&nbsp30&nbsp;&nbsp;&nbsp;&nbspname[namelen]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654207">//&nbsp;&nbsp;&nbsp;&nbsp30+namelen+xlen&nbsp;-&nbsp;file&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2654240">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654245">buf</span>&nbsp;<span class="op" id="2654249">=</span>&nbsp;<span class="builtinfunc" id="2654251">make</span><span class="op" id="2654255">(</span><span class="op" id="2654256">[</span><span class="op" id="2654257">]</span><span class="builtintype" id="2654258">byte</span><span class="op" id="2654262">,</span>&nbsp;<span class="ident" id="2654264">zheadersize</span><span class="op" id="2654275">+</span><span class="ident" id="2654276">namelen</span><span class="op" id="2654283">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654287">if</span>&nbsp;<span class="ident" id="2654290">err</span>&nbsp;<span class="op" id="2654294">:=</span>&nbsp;<span class="ident" id="2654297">preadn</span><span class="op" id="2654303">(</span><span class="ident" id="2654304">fd</span><span class="op" id="2654306">,</span>&nbsp;<span class="ident" id="2654308">buf</span><span class="op" id="2654311">,</span>&nbsp;<span class="ident" id="2654313">off</span><span class="op" id="2654316">)</span><span class="op" id="2654317">;</span>&nbsp;<span class="ident" id="2654319">err</span>&nbsp;<span class="op" id="2654323">!=</span>&nbsp;<span class="ident" id="2654326">nil</span>&nbsp;<span class="op" id="2654330">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654336">get4</span><span class="op" id="2654340">(</span><span class="ident" id="2654341">buf</span><span class="op" id="2654344">)</span>&nbsp;<span class="op" id="2654346">!=</span>&nbsp;<span class="ident" id="2654349">zheader</span>&nbsp;<span class="op" id="2654357">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654363">get2</span><span class="op" id="2654367">(</span><span class="ident" id="2654368">buf</span><span class="op" id="2654371">[</span><span class="num" id="2654372">8</span><span class="op" id="2654373">:</span><span class="op" id="2654374">]</span><span class="op" id="2654375">)</span>&nbsp;<span class="op" id="2654377">!=</span>&nbsp;<span class="ident" id="2654380">meth</span>&nbsp;<span class="op" id="2654385">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654391">get2</span><span class="op" id="2654395">(</span><span class="ident" id="2654396">buf</span><span class="op" id="2654399">[</span><span class="num" id="2654400">26</span><span class="op" id="2654402">:</span><span class="op" id="2654403">]</span><span class="op" id="2654404">)</span>&nbsp;<span class="op" id="2654406">!=</span>&nbsp;<span class="ident" id="2654409">namelen</span>&nbsp;<span class="op" id="2654417">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="2654423">string</span><span class="op" id="2654429">(</span><span class="ident" id="2654430">buf</span><span class="op" id="2654433">[</span><span class="num" id="2654434">30</span><span class="op" id="2654436">:</span><span class="num" id="2654437">30</span><span class="op" id="2654439">+</span><span class="ident" id="2654440">namelen</span><span class="op" id="2654447">]</span><span class="op" id="2654448">)</span>&nbsp;<span class="op" id="2654450">!=</span>&nbsp;<span class="ident" id="2654453">name</span>&nbsp;<span class="op" id="2654458">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654463">return</span>&nbsp;<span class="ident" id="2654470">nil</span><span class="op" id="2654473">,</span>&nbsp;<span class="ident" id="2654475">errors</span><span class="op" id="2654481">.</span><span class="ident" id="2654482">New</span><span class="op" id="2654485">(</span><span class="string" id="2654486">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2654506">+</span>&nbsp;<span class="ident" id="2654508">zipfile</span><span class="op" id="2654515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654523">xlen</span>&nbsp;<span class="op" id="2654528">=</span>&nbsp;<span class="ident" id="2654530">get2</span><span class="op" id="2654534">(</span><span class="ident" id="2654535">buf</span><span class="op" id="2654538">[</span><span class="num" id="2654539">28</span><span class="op" id="2654541">:</span><span class="op" id="2654542">]</span><span class="op" id="2654543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2654548">buf</span>&nbsp;<span class="op" id="2654552">=</span>&nbsp;<span class="builtinfunc" id="2654554">make</span><span class="op" id="2654558">(</span><span class="op" id="2654559">[</span><span class="op" id="2654560">]</span><span class="builtintype" id="2654561">byte</span><span class="op" id="2654565">,</span>&nbsp;<span class="ident" id="2654567">size</span><span class="op" id="2654571">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654575">if</span>&nbsp;<span class="ident" id="2654578">err</span>&nbsp;<span class="op" id="2654582">:=</span>&nbsp;<span class="ident" id="2654585">preadn</span><span class="op" id="2654591">(</span><span class="ident" id="2654592">fd</span><span class="op" id="2654594">,</span>&nbsp;<span class="ident" id="2654596">buf</span><span class="op" id="2654599">,</span>&nbsp;<span class="ident" id="2654601">off</span><span class="op" id="2654604">+</span><span class="num" id="2654605">30</span><span class="op" id="2654607">+</span><span class="ident" id="2654608">namelen</span><span class="op" id="2654615">+</span><span class="ident" id="2654616">xlen</span><span class="op" id="2654620">)</span><span class="op" id="2654621">;</span>&nbsp;<span class="ident" id="2654623">err</span>&nbsp;<span class="op" id="2654627">!=</span>&nbsp;<span class="ident" id="2654630">nil</span>&nbsp;<span class="op" id="2654634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654639">return</span>&nbsp;<span class="ident" id="2654646">nil</span><span class="op" id="2654649">,</span>&nbsp;<span class="ident" id="2654651">errors</span><span class="op" id="2654657">.</span><span class="ident" id="2654658">New</span><span class="op" id="2654661">(</span><span class="string" id="2654662">&#34;corrupt&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2654682">+</span>&nbsp;<span class="ident" id="2654684">zipfile</span><span class="op" id="2654691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654700">return</span>&nbsp;<span class="ident" id="2654707">loadZoneData</span><span class="op" id="2654719">(</span><span class="ident" id="2654720">buf</span><span class="op" id="2654723">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2654726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2654730">return</span>&nbsp;<span class="ident" id="2654737">nil</span><span class="op" id="2654740">,</span>&nbsp;<span class="ident" id="2654742">errors</span><span class="op" id="2654748">.</span><span class="ident" id="2654749">New</span><span class="op" id="2654752">(</span><span class="string" id="2654753">&#34;cannot&nbsp;find&nbsp;&#34;</span>&nbsp;<span class="op" id="2654768">+</span>&nbsp;<span class="ident" id="2654770">name</span>&nbsp;<span class="op" id="2654775">+</span>&nbsp;<span class="string" id="2654777">&#34;&nbsp;in&nbsp;zip&nbsp;file&nbsp;&#34;</span>&nbsp;<span class="op" id="2654793">+</span>&nbsp;<span class="ident" id="2654795">zipfile</span><span class="op" id="2654802">)</span><br>
<span class="lineno"></span><span class="op" id="2654804">}</span>
</div>
</body>
</html>
