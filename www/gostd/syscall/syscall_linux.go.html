<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2228189">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2228244">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2228298">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2228349">//&nbsp;Linux&nbsp;system&nbsp;calls.</span><br>
<span class="lineno"></span><span class="comment" id="2228372">//&nbsp;This&nbsp;file&nbsp;is&nbsp;compiled&nbsp;as&nbsp;ordinary&nbsp;Go&nbsp;code,</span><br>
<span class="lineno"></span><span class="comment" id="2228418">//&nbsp;but&nbsp;it&nbsp;is&nbsp;also&nbsp;input&nbsp;to&nbsp;mksyscall,</span><br>
<span class="lineno"></span><span class="comment" id="2228456">//&nbsp;which&nbsp;parses&nbsp;the&nbsp;//sys&nbsp;lines&nbsp;and&nbsp;generates&nbsp;system&nbsp;call&nbsp;stubs.</span><br>
<span class="lineno"></span><span class="comment" id="2228521">//&nbsp;Note&nbsp;that&nbsp;sometimes&nbsp;we&nbsp;use&nbsp;a&nbsp;lowercase&nbsp;//sys&nbsp;name&nbsp;and</span><br>
<span class="lineno">10</span><span class="comment" id="2228578">//&nbsp;wrap&nbsp;it&nbsp;in&nbsp;our&nbsp;own&nbsp;nicer&nbsp;implementation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2228623">package</span>&nbsp;<span class="ident" id="2228631">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2228640">import</span>&nbsp;<span class="string" id="2228647">&#34;unsafe&#34;</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2228657">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Wrapped<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="2228676">//sys&nbsp;&nbsp;&nbsp;&nbspopen(path&nbsp;string,&nbsp;mode&nbsp;int,&nbsp;perm&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2228744">func</span>&nbsp;<span class="ident" id="2228749">Open</span><span class="op" id="2228753">(</span><span class="ident" id="2228754">path</span>&nbsp;<span class="builtintype" id="2228759">string</span><span class="op" id="2228765">,</span>&nbsp;<span class="ident" id="2228767">mode</span>&nbsp;<span class="builtintype" id="2228772">int</span><span class="op" id="2228775">,</span>&nbsp;<span class="ident" id="2228777">perm</span>&nbsp;<span class="builtintype" id="2228782">uint32</span><span class="op" id="2228788">)</span>&nbsp;<span class="op" id="2228790">(</span><span class="ident" id="2228791">fd</span>&nbsp;<span class="builtintype" id="2228794">int</span><span class="op" id="2228797">,</span>&nbsp;<span class="ident" id="2228799">err</span>&nbsp;<span class="builtintype" id="2228803">error</span><span class="op" id="2228808">)</span>&nbsp;<span class="op" id="2228810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2228813">return</span>&nbsp;<span class="ident" id="2228820">open</span><span class="op" id="2228824">(</span><span class="ident" id="2228825">path</span><span class="op" id="2228829">,</span>&nbsp;<span class="ident" id="2228831">mode</span><span class="op" id="2228835">|</span><span class="ident" id="2228836">O_LARGEFILE</span><span class="op" id="2228847">,</span>&nbsp;<span class="ident" id="2228849">perm</span><span class="op" id="2228853">)</span><br>
<span class="lineno"></span><span class="op" id="2228855">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="2228858">//sys&nbsp;&nbsp;&nbsp;&nbspopenat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;flags&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2228940">func</span>&nbsp;<span class="ident" id="2228945">Openat</span><span class="op" id="2228951">(</span><span class="ident" id="2228952">dirfd</span>&nbsp;<span class="builtintype" id="2228958">int</span><span class="op" id="2228961">,</span>&nbsp;<span class="ident" id="2228963">path</span>&nbsp;<span class="builtintype" id="2228968">string</span><span class="op" id="2228974">,</span>&nbsp;<span class="ident" id="2228976">flags</span>&nbsp;<span class="builtintype" id="2228982">int</span><span class="op" id="2228985">,</span>&nbsp;<span class="ident" id="2228987">mode</span>&nbsp;<span class="builtintype" id="2228992">uint32</span><span class="op" id="2228998">)</span>&nbsp;<span class="op" id="2229000">(</span><span class="ident" id="2229001">fd</span>&nbsp;<span class="builtintype" id="2229004">int</span><span class="op" id="2229007">,</span>&nbsp;<span class="ident" id="2229009">err</span>&nbsp;<span class="builtintype" id="2229013">error</span><span class="op" id="2229018">)</span>&nbsp;<span class="op" id="2229020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229023">return</span>&nbsp;<span class="ident" id="2229030">openat</span><span class="op" id="2229036">(</span><span class="ident" id="2229037">dirfd</span><span class="op" id="2229042">,</span>&nbsp;<span class="ident" id="2229044">path</span><span class="op" id="2229048">,</span>&nbsp;<span class="ident" id="2229050">flags</span><span class="op" id="2229055">|</span><span class="ident" id="2229056">O_LARGEFILE</span><span class="op" id="2229067">,</span>&nbsp;<span class="ident" id="2229069">mode</span><span class="op" id="2229073">)</span><br>
<span class="lineno">30</span><span class="op" id="2229075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2229078">//sysnb&nbsp;&nbsp;&nbsp;&nbsppipe(p&nbsp;*[2]_C_int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2229118">func</span>&nbsp;<span class="ident" id="2229123">Pipe</span><span class="op" id="2229127">(</span><span class="ident" id="2229128">p</span>&nbsp;<span class="op" id="2229130">[</span><span class="op" id="2229131">]</span><span class="builtintype" id="2229132">int</span><span class="op" id="2229135">)</span>&nbsp;<span class="op" id="2229137">(</span><span class="ident" id="2229138">err</span>&nbsp;<span class="builtintype" id="2229142">error</span><span class="op" id="2229147">)</span>&nbsp;<span class="op" id="2229149">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229152">if</span>&nbsp;<span class="builtinfunc" id="2229155">len</span><span class="op" id="2229158">(</span><span class="ident" id="2229159">p</span><span class="op" id="2229160">)</span>&nbsp;<span class="op" id="2229162">!=</span>&nbsp;<span class="num" id="2229165">2</span>&nbsp;<span class="op" id="2229167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229171">return</span>&nbsp;<span class="ident" id="2229178">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229189">var</span>&nbsp;<span class="ident" id="2229193">pp</span>&nbsp;<span class="op" id="2229196">[</span><span class="num" id="2229197">2</span><span class="op" id="2229198">]</span><span class="ident" id="2229199">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229207">err</span>&nbsp;<span class="op" id="2229211">=</span>&nbsp;<span class="ident" id="2229213">pipe</span><span class="op" id="2229217">(</span><span class="op" id="2229218">&amp;</span><span class="ident" id="2229219">pp</span><span class="op" id="2229221">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229224">p</span><span class="op" id="2229225">[</span><span class="num" id="2229226">0</span><span class="op" id="2229227">]</span>&nbsp;<span class="op" id="2229229">=</span>&nbsp;<span class="builtintype" id="2229231">int</span><span class="op" id="2229234">(</span><span class="ident" id="2229235">pp</span><span class="op" id="2229237">[</span><span class="num" id="2229238">0</span><span class="op" id="2229239">]</span><span class="op" id="2229240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229243">p</span><span class="op" id="2229244">[</span><span class="num" id="2229245">1</span><span class="op" id="2229246">]</span>&nbsp;<span class="op" id="2229248">=</span>&nbsp;<span class="builtintype" id="2229250">int</span><span class="op" id="2229253">(</span><span class="ident" id="2229254">pp</span><span class="op" id="2229256">[</span><span class="num" id="2229257">1</span><span class="op" id="2229258">]</span><span class="op" id="2229259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229262">return</span><br>
<span class="lineno"></span><span class="op" id="2229269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="2229272">//sysnb&nbsp;pipe2(p&nbsp;*[2]_C_int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2229324">func</span>&nbsp;<span class="ident" id="2229329">Pipe2</span><span class="op" id="2229334">(</span><span class="ident" id="2229335">p</span>&nbsp;<span class="op" id="2229337">[</span><span class="op" id="2229338">]</span><span class="builtintype" id="2229339">int</span><span class="op" id="2229342">,</span>&nbsp;<span class="ident" id="2229344">flags</span>&nbsp;<span class="builtintype" id="2229350">int</span><span class="op" id="2229353">)</span>&nbsp;<span class="op" id="2229355">(</span><span class="ident" id="2229356">err</span>&nbsp;<span class="builtintype" id="2229360">error</span><span class="op" id="2229365">)</span>&nbsp;<span class="op" id="2229367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229370">if</span>&nbsp;<span class="builtinfunc" id="2229373">len</span><span class="op" id="2229376">(</span><span class="ident" id="2229377">p</span><span class="op" id="2229378">)</span>&nbsp;<span class="op" id="2229380">!=</span>&nbsp;<span class="num" id="2229383">2</span>&nbsp;<span class="op" id="2229385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229389">return</span>&nbsp;<span class="ident" id="2229396">EINVAL</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229407">var</span>&nbsp;<span class="ident" id="2229411">pp</span>&nbsp;<span class="op" id="2229414">[</span><span class="num" id="2229415">2</span><span class="op" id="2229416">]</span><span class="ident" id="2229417">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229425">err</span>&nbsp;<span class="op" id="2229429">=</span>&nbsp;<span class="ident" id="2229431">pipe2</span><span class="op" id="2229436">(</span><span class="op" id="2229437">&amp;</span><span class="ident" id="2229438">pp</span><span class="op" id="2229440">,</span>&nbsp;<span class="ident" id="2229442">flags</span><span class="op" id="2229447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229450">p</span><span class="op" id="2229451">[</span><span class="num" id="2229452">0</span><span class="op" id="2229453">]</span>&nbsp;<span class="op" id="2229455">=</span>&nbsp;<span class="builtintype" id="2229457">int</span><span class="op" id="2229460">(</span><span class="ident" id="2229461">pp</span><span class="op" id="2229463">[</span><span class="num" id="2229464">0</span><span class="op" id="2229465">]</span><span class="op" id="2229466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229469">p</span><span class="op" id="2229470">[</span><span class="num" id="2229471">1</span><span class="op" id="2229472">]</span>&nbsp;<span class="op" id="2229474">=</span>&nbsp;<span class="builtintype" id="2229476">int</span><span class="op" id="2229479">(</span><span class="ident" id="2229480">pp</span><span class="op" id="2229482">[</span><span class="num" id="2229483">1</span><span class="op" id="2229484">]</span><span class="op" id="2229485">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229488">return</span><br>
<span class="lineno"></span><span class="op" id="2229495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2229498">//sys&nbsp;&nbsp;&nbsp;&nbsputimes(path&nbsp;string,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="2229556">func</span>&nbsp;<span class="ident" id="2229561">Utimes</span><span class="op" id="2229567">(</span><span class="ident" id="2229568">path</span>&nbsp;<span class="builtintype" id="2229573">string</span><span class="op" id="2229579">,</span>&nbsp;<span class="ident" id="2229581">tv</span>&nbsp;<span class="op" id="2229584">[</span><span class="op" id="2229585">]</span><span class="ident" id="2229586">Timeval</span><span class="op" id="2229593">)</span>&nbsp;<span class="op" id="2229595">(</span><span class="ident" id="2229596">err</span>&nbsp;<span class="builtintype" id="2229600">error</span><span class="op" id="2229605">)</span>&nbsp;<span class="op" id="2229607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229610">if</span>&nbsp;<span class="builtinfunc" id="2229613">len</span><span class="op" id="2229616">(</span><span class="ident" id="2229617">tv</span><span class="op" id="2229619">)</span>&nbsp;<span class="op" id="2229621">!=</span>&nbsp;<span class="num" id="2229624">2</span>&nbsp;<span class="op" id="2229626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229630">return</span>&nbsp;<span class="ident" id="2229637">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229648">return</span>&nbsp;<span class="ident" id="2229655">utimes</span><span class="op" id="2229661">(</span><span class="ident" id="2229662">path</span><span class="op" id="2229666">,</span>&nbsp;<span class="op" id="2229668">(</span><span class="op" id="2229669">*</span><span class="op" id="2229670">[</span><span class="num" id="2229671">2</span><span class="op" id="2229672">]</span><span class="ident" id="2229673">Timeval</span><span class="op" id="2229680">)</span><span class="op" id="2229681">(</span><span class="ident" id="2229682">unsafe</span><span class="op" id="2229688">.</span><span class="ident" id="2229689">Pointer</span><span class="op" id="2229696">(</span><span class="op" id="2229697">&amp;</span><span class="ident" id="2229698">tv</span><span class="op" id="2229700">[</span><span class="num" id="2229701">0</span><span class="op" id="2229702">]</span><span class="op" id="2229703">)</span><span class="op" id="2229704">)</span><span class="op" id="2229705">)</span><br>
<span class="lineno">65</span><span class="op" id="2229707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2229710">//sys&nbsp;&nbsp;&nbsp;&nbsputimensat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;times&nbsp;*[2]Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2229783">func</span>&nbsp;<span class="ident" id="2229788">UtimesNano</span><span class="op" id="2229798">(</span><span class="ident" id="2229799">path</span>&nbsp;<span class="builtintype" id="2229804">string</span><span class="op" id="2229810">,</span>&nbsp;<span class="ident" id="2229812">ts</span>&nbsp;<span class="op" id="2229815">[</span><span class="op" id="2229816">]</span><span class="ident" id="2229817">Timespec</span><span class="op" id="2229825">)</span>&nbsp;<span class="op" id="2229827">(</span><span class="ident" id="2229828">err</span>&nbsp;<span class="builtintype" id="2229832">error</span><span class="op" id="2229837">)</span>&nbsp;<span class="op" id="2229839">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229842">if</span>&nbsp;<span class="builtinfunc" id="2229845">len</span><span class="op" id="2229848">(</span><span class="ident" id="2229849">ts</span><span class="op" id="2229851">)</span>&nbsp;<span class="op" id="2229853">!=</span>&nbsp;<span class="num" id="2229856">2</span>&nbsp;<span class="op" id="2229858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229862">return</span>&nbsp;<span class="ident" id="2229869">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229877">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2229880">err</span>&nbsp;<span class="op" id="2229884">=</span>&nbsp;<span class="ident" id="2229886">utimensat</span><span class="op" id="2229895">(</span><span class="ident" id="2229896">_AT_FDCWD</span><span class="op" id="2229905">,</span>&nbsp;<span class="ident" id="2229907">path</span><span class="op" id="2229911">,</span>&nbsp;<span class="op" id="2229913">(</span><span class="op" id="2229914">*</span><span class="op" id="2229915">[</span><span class="num" id="2229916">2</span><span class="op" id="2229917">]</span><span class="ident" id="2229918">Timespec</span><span class="op" id="2229926">)</span><span class="op" id="2229927">(</span><span class="ident" id="2229928">unsafe</span><span class="op" id="2229934">.</span><span class="ident" id="2229935">Pointer</span><span class="op" id="2229942">(</span><span class="op" id="2229943">&amp;</span><span class="ident" id="2229944">ts</span><span class="op" id="2229946">[</span><span class="num" id="2229947">0</span><span class="op" id="2229948">]</span><span class="op" id="2229949">)</span><span class="op" id="2229950">)</span><span class="op" id="2229951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229954">if</span>&nbsp;<span class="ident" id="2229957">err</span>&nbsp;<span class="op" id="2229961">!=</span>&nbsp;<span class="ident" id="2229964">ENOSYS</span>&nbsp;<span class="op" id="2229971">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2229975">return</span>&nbsp;<span class="ident" id="2229982">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2229987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2229990">//&nbsp;If&nbsp;the&nbsp;utimensat&nbsp;syscall&nbsp;isn&#39;t&nbsp;available&nbsp;(utimensat&nbsp;was&nbsp;added&nbsp;to&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230065">//&nbsp;in&nbsp;2.6.22,&nbsp;Released,&nbsp;8&nbsp;July&nbsp;2007)&nbsp;then&nbsp;fall&nbsp;back&nbsp;to&nbsp;utimes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230128">var</span>&nbsp;<span class="ident" id="2230132">tv</span>&nbsp;<span class="op" id="2230135">[</span><span class="num" id="2230136">2</span><span class="op" id="2230137">]</span><span class="ident" id="2230138">Timeval</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230147">for</span>&nbsp;<span class="ident" id="2230151">i</span>&nbsp;<span class="op" id="2230153">:=</span>&nbsp;<span class="num" id="2230156">0</span><span class="op" id="2230157">;</span>&nbsp;<span class="ident" id="2230159">i</span>&nbsp;<span class="op" id="2230161">&lt;</span>&nbsp;<span class="num" id="2230163">2</span><span class="op" id="2230164">;</span>&nbsp;<span class="ident" id="2230166">i</span><span class="op" id="2230167">++</span>&nbsp;<span class="op" id="2230170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230174">tv</span><span class="op" id="2230176">[</span><span class="ident" id="2230177">i</span><span class="op" id="2230178">]</span><span class="op" id="2230179">.</span><span class="ident" id="2230180">Sec</span>&nbsp;<span class="op" id="2230184">=</span>&nbsp;<span class="ident" id="2230186">ts</span><span class="op" id="2230188">[</span><span class="ident" id="2230189">i</span><span class="op" id="2230190">]</span><span class="op" id="2230191">.</span><span class="ident" id="2230192">Sec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230198">tv</span><span class="op" id="2230200">[</span><span class="ident" id="2230201">i</span><span class="op" id="2230202">]</span><span class="op" id="2230203">.</span><span class="ident" id="2230204">Usec</span>&nbsp;<span class="op" id="2230209">=</span>&nbsp;<span class="ident" id="2230211">ts</span><span class="op" id="2230213">[</span><span class="ident" id="2230214">i</span><span class="op" id="2230215">]</span><span class="op" id="2230216">.</span><span class="ident" id="2230217">Nsec</span>&nbsp;<span class="op" id="2230222">/</span>&nbsp;<span class="num" id="2230224">1000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230233">return</span>&nbsp;<span class="ident" id="2230240">utimes</span><span class="op" id="2230246">(</span><span class="ident" id="2230247">path</span><span class="op" id="2230251">,</span>&nbsp;<span class="op" id="2230253">(</span><span class="op" id="2230254">*</span><span class="op" id="2230255">[</span><span class="num" id="2230256">2</span><span class="op" id="2230257">]</span><span class="ident" id="2230258">Timeval</span><span class="op" id="2230265">)</span><span class="op" id="2230266">(</span><span class="ident" id="2230267">unsafe</span><span class="op" id="2230273">.</span><span class="ident" id="2230274">Pointer</span><span class="op" id="2230281">(</span><span class="op" id="2230282">&amp;</span><span class="ident" id="2230283">tv</span><span class="op" id="2230285">[</span><span class="num" id="2230286">0</span><span class="op" id="2230287">]</span><span class="op" id="2230288">)</span><span class="op" id="2230289">)</span><span class="op" id="2230290">)</span><br>
<span class="lineno">85</span><span class="op" id="2230292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2230295">//sys&nbsp;&nbsp;&nbsp;&nbspfutimesat(dirfd&nbsp;int,&nbsp;path&nbsp;*byte,&nbsp;times&nbsp;*[2]Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2230366">func</span>&nbsp;<span class="ident" id="2230371">Futimesat</span><span class="op" id="2230380">(</span><span class="ident" id="2230381">dirfd</span>&nbsp;<span class="builtintype" id="2230387">int</span><span class="op" id="2230390">,</span>&nbsp;<span class="ident" id="2230392">path</span>&nbsp;<span class="builtintype" id="2230397">string</span><span class="op" id="2230403">,</span>&nbsp;<span class="ident" id="2230405">tv</span>&nbsp;<span class="op" id="2230408">[</span><span class="op" id="2230409">]</span><span class="ident" id="2230410">Timeval</span><span class="op" id="2230417">)</span>&nbsp;<span class="op" id="2230419">(</span><span class="ident" id="2230420">err</span>&nbsp;<span class="builtintype" id="2230424">error</span><span class="op" id="2230429">)</span>&nbsp;<span class="op" id="2230431">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230434">if</span>&nbsp;<span class="builtinfunc" id="2230437">len</span><span class="op" id="2230440">(</span><span class="ident" id="2230441">tv</span><span class="op" id="2230443">)</span>&nbsp;<span class="op" id="2230445">!=</span>&nbsp;<span class="num" id="2230448">2</span>&nbsp;<span class="op" id="2230450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230454">return</span>&nbsp;<span class="ident" id="2230461">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230472">pathp</span><span class="op" id="2230477">,</span>&nbsp;<span class="ident" id="2230479">err</span>&nbsp;<span class="op" id="2230483">:=</span>&nbsp;<span class="ident" id="2230486">BytePtrFromString</span><span class="op" id="2230503">(</span><span class="ident" id="2230504">path</span><span class="op" id="2230508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230511">if</span>&nbsp;<span class="ident" id="2230514">err</span>&nbsp;<span class="op" id="2230518">!=</span>&nbsp;<span class="ident" id="2230521">nil</span>&nbsp;<span class="op" id="2230525">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230529">return</span>&nbsp;<span class="ident" id="2230536">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2230541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230544">err</span>&nbsp;<span class="op" id="2230548">=</span>&nbsp;<span class="ident" id="2230550">futimesat</span><span class="op" id="2230559">(</span><span class="ident" id="2230560">dirfd</span><span class="op" id="2230565">,</span>&nbsp;<span class="ident" id="2230567">pathp</span><span class="op" id="2230572">,</span>&nbsp;<span class="op" id="2230574">(</span><span class="op" id="2230575">*</span><span class="op" id="2230576">[</span><span class="num" id="2230577">2</span><span class="op" id="2230578">]</span><span class="ident" id="2230579">Timeval</span><span class="op" id="2230586">)</span><span class="op" id="2230587">(</span><span class="ident" id="2230588">unsafe</span><span class="op" id="2230594">.</span><span class="ident" id="2230595">Pointer</span><span class="op" id="2230602">(</span><span class="op" id="2230603">&amp;</span><span class="ident" id="2230604">tv</span><span class="op" id="2230606">[</span><span class="num" id="2230607">0</span><span class="op" id="2230608">]</span><span class="op" id="2230609">)</span><span class="op" id="2230610">)</span><span class="op" id="2230611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230614">use</span><span class="op" id="2230617">(</span><span class="ident" id="2230618">unsafe</span><span class="op" id="2230624">.</span><span class="ident" id="2230625">Pointer</span><span class="op" id="2230632">(</span><span class="ident" id="2230633">pathp</span><span class="op" id="2230638">)</span><span class="op" id="2230639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230642">return</span>&nbsp;<span class="ident" id="2230649">err</span><br>
<span class="lineno">100</span><span class="op" id="2230653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2230656">func</span>&nbsp;<span class="ident" id="2230661">Futimes</span><span class="op" id="2230668">(</span><span class="ident" id="2230669">fd</span>&nbsp;<span class="builtintype" id="2230672">int</span><span class="op" id="2230675">,</span>&nbsp;<span class="ident" id="2230677">tv</span>&nbsp;<span class="op" id="2230680">[</span><span class="op" id="2230681">]</span><span class="ident" id="2230682">Timeval</span><span class="op" id="2230689">)</span>&nbsp;<span class="op" id="2230691">(</span><span class="ident" id="2230692">err</span>&nbsp;<span class="builtintype" id="2230696">error</span><span class="op" id="2230701">)</span>&nbsp;<span class="op" id="2230703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230706">//&nbsp;Believe&nbsp;it&nbsp;or&nbsp;not,&nbsp;this&nbsp;is&nbsp;the&nbsp;best&nbsp;we&nbsp;can&nbsp;do&nbsp;on&nbsp;Linux</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2230765">//&nbsp;(and&nbsp;is&nbsp;what&nbsp;glibc&nbsp;does).</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230795">return</span>&nbsp;<span class="ident" id="2230802">Utimes</span><span class="op" id="2230808">(</span><span class="string" id="2230809">&#34;/proc/self/fd/&#34;</span><span class="op" id="2230825">+</span><span class="ident" id="2230826">itoa</span><span class="op" id="2230830">(</span><span class="ident" id="2230831">fd</span><span class="op" id="2230833">)</span><span class="op" id="2230834">,</span>&nbsp;<span class="ident" id="2230836">tv</span><span class="op" id="2230838">)</span><br>
<span class="lineno"></span><span class="op" id="2230840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2230843">const</span>&nbsp;<span class="ident" id="2230849">ImplementsGetwd</span>&nbsp;<span class="op" id="2230865">=</span>&nbsp;<span class="builtintype" id="2230867">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="2230873">//sys&nbsp;&nbsp;&nbsp;&nbspGetcwd(buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2230918">func</span>&nbsp;<span class="ident" id="2230923">Getwd</span><span class="op" id="2230928">(</span><span class="op" id="2230929">)</span>&nbsp;<span class="op" id="2230931">(</span><span class="ident" id="2230932">wd</span>&nbsp;<span class="builtintype" id="2230935">string</span><span class="op" id="2230941">,</span>&nbsp;<span class="ident" id="2230943">err</span>&nbsp;<span class="builtintype" id="2230947">error</span><span class="op" id="2230952">)</span>&nbsp;<span class="op" id="2230954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2230957">var</span>&nbsp;<span class="ident" id="2230961">buf</span>&nbsp;<span class="op" id="2230965">[</span><span class="ident" id="2230966">PathMax</span><span class="op" id="2230973">]</span><span class="builtintype" id="2230974">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2230980">n</span><span class="op" id="2230981">,</span>&nbsp;<span class="ident" id="2230983">err</span>&nbsp;<span class="op" id="2230987">:=</span>&nbsp;<span class="ident" id="2230990">Getcwd</span><span class="op" id="2230996">(</span><span class="ident" id="2230997">buf</span><span class="op" id="2231000">[</span><span class="num" id="2231001">0</span><span class="op" id="2231002">:</span><span class="op" id="2231003">]</span><span class="op" id="2231004">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231007">if</span>&nbsp;<span class="ident" id="2231010">err</span>&nbsp;<span class="op" id="2231014">!=</span>&nbsp;<span class="ident" id="2231017">nil</span>&nbsp;<span class="op" id="2231021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231025">return</span>&nbsp;<span class="string" id="2231032">&#34;&#34;</span><span class="op" id="2231034">,</span>&nbsp;<span class="ident" id="2231036">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231044">//&nbsp;Getcwd&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;written&nbsp;to&nbsp;buf,&nbsp;including&nbsp;the&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231118">if</span>&nbsp;<span class="ident" id="2231121">n</span>&nbsp;<span class="op" id="2231123">&lt;</span>&nbsp;<span class="num" id="2231125">1</span>&nbsp;<span class="op" id="2231127">||</span>&nbsp;<span class="ident" id="2231130">n</span>&nbsp;<span class="op" id="2231132">&gt;</span>&nbsp;<span class="builtinfunc" id="2231134">len</span><span class="op" id="2231137">(</span><span class="ident" id="2231138">buf</span><span class="op" id="2231141">)</span>&nbsp;<span class="op" id="2231143">||</span>&nbsp;<span class="ident" id="2231146">buf</span><span class="op" id="2231149">[</span><span class="ident" id="2231150">n</span><span class="op" id="2231151">-</span><span class="num" id="2231152">1</span><span class="op" id="2231153">]</span>&nbsp;<span class="op" id="2231155">!=</span>&nbsp;<span class="num" id="2231158">0</span>&nbsp;<span class="op" id="2231160">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231164">return</span>&nbsp;<span class="string" id="2231171">&#34;&#34;</span><span class="op" id="2231173">,</span>&nbsp;<span class="ident" id="2231175">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231183">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231186">return</span>&nbsp;<span class="builtintype" id="2231193">string</span><span class="op" id="2231199">(</span><span class="ident" id="2231200">buf</span><span class="op" id="2231203">[</span><span class="num" id="2231204">0</span>&nbsp;<span class="op" id="2231206">:</span>&nbsp;<span class="ident" id="2231208">n</span><span class="op" id="2231209">-</span><span class="num" id="2231210">1</span><span class="op" id="2231211">]</span><span class="op" id="2231212">)</span><span class="op" id="2231213">,</span>&nbsp;<span class="ident" id="2231215">nil</span><br>
<span class="lineno"></span><span class="op" id="2231219">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="2231222">func</span>&nbsp;<span class="ident" id="2231227">Getgroups</span><span class="op" id="2231236">(</span><span class="op" id="2231237">)</span>&nbsp;<span class="op" id="2231239">(</span><span class="ident" id="2231240">gids</span>&nbsp;<span class="op" id="2231245">[</span><span class="op" id="2231246">]</span><span class="builtintype" id="2231247">int</span><span class="op" id="2231250">,</span>&nbsp;<span class="ident" id="2231252">err</span>&nbsp;<span class="builtintype" id="2231256">error</span><span class="op" id="2231261">)</span>&nbsp;<span class="op" id="2231263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231266">n</span><span class="op" id="2231267">,</span>&nbsp;<span class="ident" id="2231269">err</span>&nbsp;<span class="op" id="2231273">:=</span>&nbsp;<span class="ident" id="2231276">getgroups</span><span class="op" id="2231285">(</span><span class="num" id="2231286">0</span><span class="op" id="2231287">,</span>&nbsp;<span class="ident" id="2231289">nil</span><span class="op" id="2231292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231295">if</span>&nbsp;<span class="ident" id="2231298">err</span>&nbsp;<span class="op" id="2231302">!=</span>&nbsp;<span class="ident" id="2231305">nil</span>&nbsp;<span class="op" id="2231309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231313">return</span>&nbsp;<span class="ident" id="2231320">nil</span><span class="op" id="2231323">,</span>&nbsp;<span class="ident" id="2231325">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231330">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231333">if</span>&nbsp;<span class="ident" id="2231336">n</span>&nbsp;<span class="op" id="2231338">==</span>&nbsp;<span class="num" id="2231341">0</span>&nbsp;<span class="op" id="2231343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231347">return</span>&nbsp;<span class="ident" id="2231354">nil</span><span class="op" id="2231357">,</span>&nbsp;<span class="ident" id="2231359">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2231368">//&nbsp;Sanity&nbsp;check&nbsp;group&nbsp;count.&nbsp;&nbsp;Max&nbsp;is&nbsp;1&lt;&lt;16&nbsp;on&nbsp;Linux.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231422">if</span>&nbsp;<span class="ident" id="2231425">n</span>&nbsp;<span class="op" id="2231427">&lt;</span>&nbsp;<span class="num" id="2231429">0</span>&nbsp;<span class="op" id="2231431">||</span>&nbsp;<span class="ident" id="2231434">n</span>&nbsp;<span class="op" id="2231436">&gt;</span>&nbsp;<span class="num" id="2231438">1</span><span class="op" id="2231439">&lt;&lt;</span><span class="num" id="2231441">20</span>&nbsp;<span class="op" id="2231444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231448">return</span>&nbsp;<span class="ident" id="2231455">nil</span><span class="op" id="2231458">,</span>&nbsp;<span class="ident" id="2231460">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231468">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231472">a</span>&nbsp;<span class="op" id="2231474">:=</span>&nbsp;<span class="builtinfunc" id="2231477">make</span><span class="op" id="2231481">(</span><span class="op" id="2231482">[</span><span class="op" id="2231483">]</span><span class="ident" id="2231484">_Gid_t</span><span class="op" id="2231490">,</span>&nbsp;<span class="ident" id="2231492">n</span><span class="op" id="2231493">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231496">n</span><span class="op" id="2231497">,</span>&nbsp;<span class="ident" id="2231499">err</span>&nbsp;<span class="op" id="2231503">=</span>&nbsp;<span class="ident" id="2231505">getgroups</span><span class="op" id="2231514">(</span><span class="ident" id="2231515">n</span><span class="op" id="2231516">,</span>&nbsp;<span class="op" id="2231518">&amp;</span><span class="ident" id="2231519">a</span><span class="op" id="2231520">[</span><span class="num" id="2231521">0</span><span class="op" id="2231522">]</span><span class="op" id="2231523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231526">if</span>&nbsp;<span class="ident" id="2231529">err</span>&nbsp;<span class="op" id="2231533">!=</span>&nbsp;<span class="ident" id="2231536">nil</span>&nbsp;<span class="op" id="2231540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231544">return</span>&nbsp;<span class="ident" id="2231551">nil</span><span class="op" id="2231554">,</span>&nbsp;<span class="ident" id="2231556">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231561">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231564">gids</span>&nbsp;<span class="op" id="2231569">=</span>&nbsp;<span class="builtinfunc" id="2231571">make</span><span class="op" id="2231575">(</span><span class="op" id="2231576">[</span><span class="op" id="2231577">]</span><span class="builtintype" id="2231578">int</span><span class="op" id="2231581">,</span>&nbsp;<span class="ident" id="2231583">n</span><span class="op" id="2231584">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231587">for</span>&nbsp;<span class="ident" id="2231591">i</span><span class="op" id="2231592">,</span>&nbsp;<span class="ident" id="2231594">v</span>&nbsp;<span class="op" id="2231596">:=</span>&nbsp;<span class="keyword" id="2231599">range</span>&nbsp;<span class="ident" id="2231605">a</span><span class="op" id="2231606">[</span><span class="num" id="2231607">0</span><span class="op" id="2231608">:</span><span class="ident" id="2231609">n</span><span class="op" id="2231610">]</span>&nbsp;<span class="op" id="2231612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231616">gids</span><span class="op" id="2231620">[</span><span class="ident" id="2231621">i</span><span class="op" id="2231622">]</span>&nbsp;<span class="op" id="2231624">=</span>&nbsp;<span class="builtintype" id="2231626">int</span><span class="op" id="2231629">(</span><span class="ident" id="2231630">v</span><span class="op" id="2231631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231637">return</span><br>
<span class="lineno"></span><span class="op" id="2231644">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="2231647">func</span>&nbsp;<span class="ident" id="2231652">Setgroups</span><span class="op" id="2231661">(</span><span class="ident" id="2231662">gids</span>&nbsp;<span class="op" id="2231667">[</span><span class="op" id="2231668">]</span><span class="builtintype" id="2231669">int</span><span class="op" id="2231672">)</span>&nbsp;<span class="op" id="2231674">(</span><span class="ident" id="2231675">err</span>&nbsp;<span class="builtintype" id="2231679">error</span><span class="op" id="2231684">)</span>&nbsp;<span class="op" id="2231686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231689">if</span>&nbsp;<span class="builtinfunc" id="2231692">len</span><span class="op" id="2231695">(</span><span class="ident" id="2231696">gids</span><span class="op" id="2231700">)</span>&nbsp;<span class="op" id="2231702">==</span>&nbsp;<span class="num" id="2231705">0</span>&nbsp;<span class="op" id="2231707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231711">return</span>&nbsp;<span class="ident" id="2231718">setgroups</span><span class="op" id="2231727">(</span><span class="num" id="2231728">0</span><span class="op" id="2231729">,</span>&nbsp;<span class="ident" id="2231731">nil</span><span class="op" id="2231734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231737">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231741">a</span>&nbsp;<span class="op" id="2231743">:=</span>&nbsp;<span class="builtinfunc" id="2231746">make</span><span class="op" id="2231750">(</span><span class="op" id="2231751">[</span><span class="op" id="2231752">]</span><span class="ident" id="2231753">_Gid_t</span><span class="op" id="2231759">,</span>&nbsp;<span class="builtinfunc" id="2231761">len</span><span class="op" id="2231764">(</span><span class="ident" id="2231765">gids</span><span class="op" id="2231769">)</span><span class="op" id="2231770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231773">for</span>&nbsp;<span class="ident" id="2231777">i</span><span class="op" id="2231778">,</span>&nbsp;<span class="ident" id="2231780">v</span>&nbsp;<span class="op" id="2231782">:=</span>&nbsp;<span class="keyword" id="2231785">range</span>&nbsp;<span class="ident" id="2231791">gids</span>&nbsp;<span class="op" id="2231796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2231800">a</span><span class="op" id="2231801">[</span><span class="ident" id="2231802">i</span><span class="op" id="2231803">]</span>&nbsp;<span class="op" id="2231805">=</span>&nbsp;<span class="ident" id="2231807">_Gid_t</span><span class="op" id="2231813">(</span><span class="ident" id="2231814">v</span><span class="op" id="2231815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2231818">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2231821">return</span>&nbsp;<span class="ident" id="2231828">setgroups</span><span class="op" id="2231837">(</span><span class="builtinfunc" id="2231838">len</span><span class="op" id="2231841">(</span><span class="ident" id="2231842">a</span><span class="op" id="2231843">)</span><span class="op" id="2231844">,</span>&nbsp;<span class="op" id="2231846">&amp;</span><span class="ident" id="2231847">a</span><span class="op" id="2231848">[</span><span class="num" id="2231849">0</span><span class="op" id="2231850">]</span><span class="op" id="2231851">)</span><br>
<span class="lineno"></span><span class="op" id="2231853">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2231856">type</span>&nbsp;<span class="ident" id="2231861">WaitStatus</span>&nbsp;<span class="builtintype" id="2231872">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2231880">//&nbsp;Wait&nbsp;status&nbsp;is&nbsp;7&nbsp;bits&nbsp;at&nbsp;bottom,&nbsp;either&nbsp;0&nbsp;(exited),</span><br>
<span class="lineno"></span><span class="comment" id="2231935">//&nbsp;0x7F&nbsp;(stopped),&nbsp;or&nbsp;a&nbsp;signal&nbsp;number&nbsp;that&nbsp;caused&nbsp;an&nbsp;exit.</span><br>
<span class="lineno"></span><span class="comment" id="2231994">//&nbsp;The&nbsp;0x80&nbsp;bit&nbsp;is&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;core&nbsp;dump.</span><br>
<span class="lineno"></span><span class="comment" id="2232044">//&nbsp;An&nbsp;extra&nbsp;number&nbsp;(exit&nbsp;code,&nbsp;signal&nbsp;causing&nbsp;a&nbsp;stop)</span><br>
<span class="lineno"></span><span class="comment" id="2232098">//&nbsp;is&nbsp;in&nbsp;the&nbsp;high&nbsp;bits.&nbsp;&nbsp;At&nbsp;least&nbsp;that&#39;s&nbsp;the&nbsp;idea.</span><br>
<span class="lineno">170</span><span class="comment" id="2232149">//&nbsp;There&nbsp;are&nbsp;various&nbsp;irregularities.&nbsp;&nbsp;For&nbsp;example,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2232204">//&nbsp;&#34;continued&#34;&nbsp;status&nbsp;is&nbsp;0xFFFF,&nbsp;distinguishing&nbsp;itself</span><br>
<span class="lineno"></span><span class="comment" id="2232259">//&nbsp;from&nbsp;stopped&nbsp;via&nbsp;the&nbsp;core&nbsp;dump&nbsp;bit.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232299">const</span>&nbsp;<span class="op" id="2232305">(</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232308">mask</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232316">=</span>&nbsp;<span class="num" id="2232318">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232324">core</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2232332">=</span>&nbsp;<span class="num" id="2232334">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232340">exited</span>&nbsp;&nbsp;<span class="op" id="2232348">=</span>&nbsp;<span class="num" id="2232350">0x00</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232356">stopped</span>&nbsp;<span class="op" id="2232364">=</span>&nbsp;<span class="num" id="2232366">0x7F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2232372">shift</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2232380">=</span>&nbsp;<span class="num" id="2232382">8</span><br>
<span class="lineno">180</span><span class="op" id="2232384">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232387">func</span>&nbsp;<span class="op" id="2232392">(</span><span class="ident" id="2232393">w</span>&nbsp;<span class="ident" id="2232395">WaitStatus</span><span class="op" id="2232405">)</span>&nbsp;<span class="ident" id="2232407">Exited</span><span class="op" id="2232413">(</span><span class="op" id="2232414">)</span>&nbsp;<span class="builtintype" id="2232416">bool</span>&nbsp;<span class="op" id="2232421">{</span>&nbsp;<span class="keyword" id="2232423">return</span>&nbsp;<span class="ident" id="2232430">w</span><span class="op" id="2232431">&amp;</span><span class="ident" id="2232432">mask</span>&nbsp;<span class="op" id="2232437">==</span>&nbsp;<span class="ident" id="2232440">exited</span>&nbsp;<span class="op" id="2232447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232450">func</span>&nbsp;<span class="op" id="2232455">(</span><span class="ident" id="2232456">w</span>&nbsp;<span class="ident" id="2232458">WaitStatus</span><span class="op" id="2232468">)</span>&nbsp;<span class="ident" id="2232470">Signaled</span><span class="op" id="2232478">(</span><span class="op" id="2232479">)</span>&nbsp;<span class="builtintype" id="2232481">bool</span>&nbsp;<span class="op" id="2232486">{</span>&nbsp;<span class="keyword" id="2232488">return</span>&nbsp;<span class="ident" id="2232495">w</span><span class="op" id="2232496">&amp;</span><span class="ident" id="2232497">mask</span>&nbsp;<span class="op" id="2232502">!=</span>&nbsp;<span class="ident" id="2232505">stopped</span>&nbsp;<span class="op" id="2232513">&amp;&amp;</span>&nbsp;<span class="ident" id="2232516">w</span><span class="op" id="2232517">&amp;</span><span class="ident" id="2232518">mask</span>&nbsp;<span class="op" id="2232523">!=</span>&nbsp;<span class="ident" id="2232526">exited</span>&nbsp;<span class="op" id="2232533">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="2232536">func</span>&nbsp;<span class="op" id="2232541">(</span><span class="ident" id="2232542">w</span>&nbsp;<span class="ident" id="2232544">WaitStatus</span><span class="op" id="2232554">)</span>&nbsp;<span class="ident" id="2232556">Stopped</span><span class="op" id="2232563">(</span><span class="op" id="2232564">)</span>&nbsp;<span class="builtintype" id="2232566">bool</span>&nbsp;<span class="op" id="2232571">{</span>&nbsp;<span class="keyword" id="2232573">return</span>&nbsp;<span class="ident" id="2232580">w</span><span class="op" id="2232581">&amp;</span><span class="num" id="2232582">0xFF</span>&nbsp;<span class="op" id="2232587">==</span>&nbsp;<span class="ident" id="2232590">stopped</span>&nbsp;<span class="op" id="2232598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232601">func</span>&nbsp;<span class="op" id="2232606">(</span><span class="ident" id="2232607">w</span>&nbsp;<span class="ident" id="2232609">WaitStatus</span><span class="op" id="2232619">)</span>&nbsp;<span class="ident" id="2232621">Continued</span><span class="op" id="2232630">(</span><span class="op" id="2232631">)</span>&nbsp;<span class="builtintype" id="2232633">bool</span>&nbsp;<span class="op" id="2232638">{</span>&nbsp;<span class="keyword" id="2232640">return</span>&nbsp;<span class="ident" id="2232647">w</span>&nbsp;<span class="op" id="2232649">==</span>&nbsp;<span class="num" id="2232652">0xFFFF</span>&nbsp;<span class="op" id="2232659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="keyword" id="2232662">func</span>&nbsp;<span class="op" id="2232667">(</span><span class="ident" id="2232668">w</span>&nbsp;<span class="ident" id="2232670">WaitStatus</span><span class="op" id="2232680">)</span>&nbsp;<span class="ident" id="2232682">CoreDump</span><span class="op" id="2232690">(</span><span class="op" id="2232691">)</span>&nbsp;<span class="builtintype" id="2232693">bool</span>&nbsp;<span class="op" id="2232698">{</span>&nbsp;<span class="keyword" id="2232700">return</span>&nbsp;<span class="ident" id="2232707">w</span><span class="op" id="2232708">.</span><span class="ident" id="2232709">Signaled</span><span class="op" id="2232717">(</span><span class="op" id="2232718">)</span>&nbsp;<span class="op" id="2232720">&amp;&amp;</span>&nbsp;<span class="ident" id="2232723">w</span><span class="op" id="2232724">&amp;</span><span class="ident" id="2232725">core</span>&nbsp;<span class="op" id="2232730">!=</span>&nbsp;<span class="num" id="2232733">0</span>&nbsp;<span class="op" id="2232735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232738">func</span>&nbsp;<span class="op" id="2232743">(</span><span class="ident" id="2232744">w</span>&nbsp;<span class="ident" id="2232746">WaitStatus</span><span class="op" id="2232756">)</span>&nbsp;<span class="ident" id="2232758">ExitStatus</span><span class="op" id="2232768">(</span><span class="op" id="2232769">)</span>&nbsp;<span class="builtintype" id="2232771">int</span>&nbsp;<span class="op" id="2232775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232778">if</span>&nbsp;<span class="op" id="2232781">!</span><span class="ident" id="2232782">w</span><span class="op" id="2232783">.</span><span class="ident" id="2232784">Exited</span><span class="op" id="2232790">(</span><span class="op" id="2232791">)</span>&nbsp;<span class="op" id="2232793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232797">return</span>&nbsp;<span class="op" id="2232804">-</span><span class="num" id="2232805">1</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232811">return</span>&nbsp;<span class="builtintype" id="2232818">int</span><span class="op" id="2232821">(</span><span class="ident" id="2232822">w</span><span class="op" id="2232823">&gt;&gt;</span><span class="ident" id="2232825">shift</span><span class="op" id="2232830">)</span>&nbsp;<span class="op" id="2232832">&amp;</span>&nbsp;<span class="num" id="2232834">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2232839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2232842">func</span>&nbsp;<span class="op" id="2232847">(</span><span class="ident" id="2232848">w</span>&nbsp;<span class="ident" id="2232850">WaitStatus</span><span class="op" id="2232860">)</span>&nbsp;<span class="ident" id="2232862">Signal</span><span class="op" id="2232868">(</span><span class="op" id="2232869">)</span>&nbsp;<span class="ident" id="2232871">Signal</span>&nbsp;<span class="op" id="2232878">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232881">if</span>&nbsp;<span class="op" id="2232884">!</span><span class="ident" id="2232885">w</span><span class="op" id="2232886">.</span><span class="ident" id="2232887">Signaled</span><span class="op" id="2232895">(</span><span class="op" id="2232896">)</span>&nbsp;<span class="op" id="2232898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232902">return</span>&nbsp;<span class="op" id="2232909">-</span><span class="num" id="2232910">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2232913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232916">return</span>&nbsp;<span class="ident" id="2232923">Signal</span><span class="op" id="2232929">(</span><span class="ident" id="2232930">w</span>&nbsp;<span class="op" id="2232932">&amp;</span>&nbsp;<span class="ident" id="2232934">mask</span><span class="op" id="2232938">)</span><br>
<span class="lineno"></span><span class="op" id="2232940">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="2232943">func</span>&nbsp;<span class="op" id="2232948">(</span><span class="ident" id="2232949">w</span>&nbsp;<span class="ident" id="2232951">WaitStatus</span><span class="op" id="2232961">)</span>&nbsp;<span class="ident" id="2232963">StopSignal</span><span class="op" id="2232973">(</span><span class="op" id="2232974">)</span>&nbsp;<span class="ident" id="2232976">Signal</span>&nbsp;<span class="op" id="2232983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2232986">if</span>&nbsp;<span class="op" id="2232989">!</span><span class="ident" id="2232990">w</span><span class="op" id="2232991">.</span><span class="ident" id="2232992">Stopped</span><span class="op" id="2232999">(</span><span class="op" id="2233000">)</span>&nbsp;<span class="op" id="2233002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233006">return</span>&nbsp;<span class="op" id="2233013">-</span><span class="num" id="2233014">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233017">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233020">return</span>&nbsp;<span class="ident" id="2233027">Signal</span><span class="op" id="2233033">(</span><span class="ident" id="2233034">w</span><span class="op" id="2233035">&gt;&gt;</span><span class="ident" id="2233037">shift</span><span class="op" id="2233042">)</span>&nbsp;<span class="op" id="2233044">&amp;</span>&nbsp;<span class="num" id="2233046">0xFF</span><br>
<span class="lineno"></span><span class="op" id="2233051">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233054">func</span>&nbsp;<span class="op" id="2233059">(</span><span class="ident" id="2233060">w</span>&nbsp;<span class="ident" id="2233062">WaitStatus</span><span class="op" id="2233072">)</span>&nbsp;<span class="ident" id="2233074">TrapCause</span><span class="op" id="2233083">(</span><span class="op" id="2233084">)</span>&nbsp;<span class="builtintype" id="2233086">int</span>&nbsp;<span class="op" id="2233090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233093">if</span>&nbsp;<span class="ident" id="2233096">w</span><span class="op" id="2233097">.</span><span class="ident" id="2233098">StopSignal</span><span class="op" id="2233108">(</span><span class="op" id="2233109">)</span>&nbsp;<span class="op" id="2233111">!=</span>&nbsp;<span class="ident" id="2233114">SIGTRAP</span>&nbsp;<span class="op" id="2233122">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233126">return</span>&nbsp;<span class="op" id="2233133">-</span><span class="num" id="2233134">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233140">return</span>&nbsp;<span class="builtintype" id="2233147">int</span><span class="op" id="2233150">(</span><span class="ident" id="2233151">w</span><span class="op" id="2233152">&gt;&gt;</span><span class="ident" id="2233154">shift</span><span class="op" id="2233159">)</span>&nbsp;<span class="op" id="2233161">&gt;&gt;</span>&nbsp;<span class="num" id="2233164">8</span><br>
<span class="lineno"></span><span class="op" id="2233166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="2233169">//sys&nbsp;&nbsp;&nbsp;&nbspwait4(pid&nbsp;int,&nbsp;wstatus&nbsp;*_C_int,&nbsp;options&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(wpid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233259">func</span>&nbsp;<span class="ident" id="2233264">Wait4</span><span class="op" id="2233269">(</span><span class="ident" id="2233270">pid</span>&nbsp;<span class="builtintype" id="2233274">int</span><span class="op" id="2233277">,</span>&nbsp;<span class="ident" id="2233279">wstatus</span>&nbsp;<span class="op" id="2233287">*</span><span class="ident" id="2233288">WaitStatus</span><span class="op" id="2233298">,</span>&nbsp;<span class="ident" id="2233300">options</span>&nbsp;<span class="builtintype" id="2233308">int</span><span class="op" id="2233311">,</span>&nbsp;<span class="ident" id="2233313">rusage</span>&nbsp;<span class="op" id="2233320">*</span><span class="ident" id="2233321">Rusage</span><span class="op" id="2233327">)</span>&nbsp;<span class="op" id="2233329">(</span><span class="ident" id="2233330">wpid</span>&nbsp;<span class="builtintype" id="2233335">int</span><span class="op" id="2233338">,</span>&nbsp;<span class="ident" id="2233340">err</span>&nbsp;<span class="builtintype" id="2233344">error</span><span class="op" id="2233349">)</span>&nbsp;<span class="op" id="2233351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233354">var</span>&nbsp;<span class="ident" id="2233358">status</span>&nbsp;<span class="ident" id="2233365">_C_int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233373">wpid</span><span class="op" id="2233377">,</span>&nbsp;<span class="ident" id="2233379">err</span>&nbsp;<span class="op" id="2233383">=</span>&nbsp;<span class="ident" id="2233385">wait4</span><span class="op" id="2233390">(</span><span class="ident" id="2233391">pid</span><span class="op" id="2233394">,</span>&nbsp;<span class="op" id="2233396">&amp;</span><span class="ident" id="2233397">status</span><span class="op" id="2233403">,</span>&nbsp;<span class="ident" id="2233405">options</span><span class="op" id="2233412">,</span>&nbsp;<span class="ident" id="2233414">rusage</span><span class="op" id="2233420">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233423">if</span>&nbsp;<span class="ident" id="2233426">wstatus</span>&nbsp;<span class="op" id="2233434">!=</span>&nbsp;<span class="ident" id="2233437">nil</span>&nbsp;<span class="op" id="2233441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233445">*</span><span class="ident" id="2233446">wstatus</span>&nbsp;<span class="op" id="2233454">=</span>&nbsp;<span class="ident" id="2233456">WaitStatus</span><span class="op" id="2233466">(</span><span class="ident" id="2233467">status</span><span class="op" id="2233473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233479">return</span><br>
<span class="lineno"></span><span class="op" id="2233486">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="2233489">func</span>&nbsp;<span class="ident" id="2233494">Mkfifo</span><span class="op" id="2233500">(</span><span class="ident" id="2233501">path</span>&nbsp;<span class="builtintype" id="2233506">string</span><span class="op" id="2233512">,</span>&nbsp;<span class="ident" id="2233514">mode</span>&nbsp;<span class="builtintype" id="2233519">uint32</span><span class="op" id="2233525">)</span>&nbsp;<span class="op" id="2233527">(</span><span class="ident" id="2233528">err</span>&nbsp;<span class="builtintype" id="2233532">error</span><span class="op" id="2233537">)</span>&nbsp;<span class="op" id="2233539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233542">return</span>&nbsp;<span class="ident" id="2233549">Mknod</span><span class="op" id="2233554">(</span><span class="ident" id="2233555">path</span><span class="op" id="2233559">,</span>&nbsp;<span class="ident" id="2233561">mode</span><span class="op" id="2233565">|</span><span class="ident" id="2233566">S_IFIFO</span><span class="op" id="2233573">,</span>&nbsp;<span class="num" id="2233575">0</span><span class="op" id="2233576">)</span><br>
<span class="lineno"></span><span class="op" id="2233578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="2233581">func</span>&nbsp;<span class="op" id="2233586">(</span><span class="ident" id="2233587">sa</span>&nbsp;<span class="op" id="2233590">*</span><span class="ident" id="2233591">SockaddrInet4</span><span class="op" id="2233604">)</span>&nbsp;<span class="ident" id="2233606">sockaddr</span><span class="op" id="2233614">(</span><span class="op" id="2233615">)</span>&nbsp;<span class="op" id="2233617">(</span><span class="ident" id="2233618">unsafe</span><span class="op" id="2233624">.</span><span class="ident" id="2233625">Pointer</span><span class="op" id="2233632">,</span>&nbsp;<span class="ident" id="2233634">_Socklen</span><span class="op" id="2233642">,</span>&nbsp;<span class="builtintype" id="2233644">error</span><span class="op" id="2233649">)</span>&nbsp;<span class="op" id="2233651">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233654">if</span>&nbsp;<span class="ident" id="2233657">sa</span><span class="op" id="2233659">.</span><span class="ident" id="2233660">Port</span>&nbsp;<span class="op" id="2233665">&lt;</span>&nbsp;<span class="num" id="2233667">0</span>&nbsp;<span class="op" id="2233669">||</span>&nbsp;<span class="ident" id="2233672">sa</span><span class="op" id="2233674">.</span><span class="ident" id="2233675">Port</span>&nbsp;<span class="op" id="2233680">&gt;</span>&nbsp;<span class="num" id="2233682">0xFFFF</span>&nbsp;<span class="op" id="2233689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233693">return</span>&nbsp;<span class="ident" id="2233700">nil</span><span class="op" id="2233703">,</span>&nbsp;<span class="num" id="2233705">0</span><span class="op" id="2233706">,</span>&nbsp;<span class="ident" id="2233708">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233719">sa</span><span class="op" id="2233721">.</span><span class="ident" id="2233722">raw</span><span class="op" id="2233725">.</span><span class="ident" id="2233726">Family</span>&nbsp;<span class="op" id="2233733">=</span>&nbsp;<span class="ident" id="2233735">AF_INET</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233744">p</span>&nbsp;<span class="op" id="2233746">:=</span>&nbsp;<span class="op" id="2233749">(</span><span class="op" id="2233750">*</span><span class="op" id="2233751">[</span><span class="num" id="2233752">2</span><span class="op" id="2233753">]</span><span class="builtintype" id="2233754">byte</span><span class="op" id="2233758">)</span><span class="op" id="2233759">(</span><span class="ident" id="2233760">unsafe</span><span class="op" id="2233766">.</span><span class="ident" id="2233767">Pointer</span><span class="op" id="2233774">(</span><span class="op" id="2233775">&amp;</span><span class="ident" id="2233776">sa</span><span class="op" id="2233778">.</span><span class="ident" id="2233779">raw</span><span class="op" id="2233782">.</span><span class="ident" id="2233783">Port</span><span class="op" id="2233787">)</span><span class="op" id="2233788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233791">p</span><span class="op" id="2233792">[</span><span class="num" id="2233793">0</span><span class="op" id="2233794">]</span>&nbsp;<span class="op" id="2233796">=</span>&nbsp;<span class="builtintype" id="2233798">byte</span><span class="op" id="2233802">(</span><span class="ident" id="2233803">sa</span><span class="op" id="2233805">.</span><span class="ident" id="2233806">Port</span>&nbsp;<span class="op" id="2233811">&gt;&gt;</span>&nbsp;<span class="num" id="2233814">8</span><span class="op" id="2233815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233818">p</span><span class="op" id="2233819">[</span><span class="num" id="2233820">1</span><span class="op" id="2233821">]</span>&nbsp;<span class="op" id="2233823">=</span>&nbsp;<span class="builtintype" id="2233825">byte</span><span class="op" id="2233829">(</span><span class="ident" id="2233830">sa</span><span class="op" id="2233832">.</span><span class="ident" id="2233833">Port</span><span class="op" id="2233837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233840">for</span>&nbsp;<span class="ident" id="2233844">i</span>&nbsp;<span class="op" id="2233846">:=</span>&nbsp;<span class="num" id="2233849">0</span><span class="op" id="2233850">;</span>&nbsp;<span class="ident" id="2233852">i</span>&nbsp;<span class="op" id="2233854">&lt;</span>&nbsp;<span class="builtinfunc" id="2233856">len</span><span class="op" id="2233859">(</span><span class="ident" id="2233860">sa</span><span class="op" id="2233862">.</span><span class="ident" id="2233863">Addr</span><span class="op" id="2233867">)</span><span class="op" id="2233868">;</span>&nbsp;<span class="ident" id="2233870">i</span><span class="op" id="2233871">++</span>&nbsp;<span class="op" id="2233874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2233878">sa</span><span class="op" id="2233880">.</span><span class="ident" id="2233881">raw</span><span class="op" id="2233884">.</span><span class="ident" id="2233885">Addr</span><span class="op" id="2233889">[</span><span class="ident" id="2233890">i</span><span class="op" id="2233891">]</span>&nbsp;<span class="op" id="2233893">=</span>&nbsp;<span class="ident" id="2233895">sa</span><span class="op" id="2233897">.</span><span class="ident" id="2233898">Addr</span><span class="op" id="2233902">[</span><span class="ident" id="2233903">i</span><span class="op" id="2233904">]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2233907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2233910">return</span>&nbsp;<span class="ident" id="2233917">unsafe</span><span class="op" id="2233923">.</span><span class="ident" id="2233924">Pointer</span><span class="op" id="2233931">(</span><span class="op" id="2233932">&amp;</span><span class="ident" id="2233933">sa</span><span class="op" id="2233935">.</span><span class="ident" id="2233936">raw</span><span class="op" id="2233939">)</span><span class="op" id="2233940">,</span>&nbsp;<span class="ident" id="2233942">SizeofSockaddrInet4</span><span class="op" id="2233961">,</span>&nbsp;<span class="ident" id="2233963">nil</span><br>
<span class="lineno"></span><span class="op" id="2233967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2233970">func</span>&nbsp;<span class="op" id="2233975">(</span><span class="ident" id="2233976">sa</span>&nbsp;<span class="op" id="2233979">*</span><span class="ident" id="2233980">SockaddrInet6</span><span class="op" id="2233993">)</span>&nbsp;<span class="ident" id="2233995">sockaddr</span><span class="op" id="2234003">(</span><span class="op" id="2234004">)</span>&nbsp;<span class="op" id="2234006">(</span><span class="ident" id="2234007">unsafe</span><span class="op" id="2234013">.</span><span class="ident" id="2234014">Pointer</span><span class="op" id="2234021">,</span>&nbsp;<span class="ident" id="2234023">_Socklen</span><span class="op" id="2234031">,</span>&nbsp;<span class="builtintype" id="2234033">error</span><span class="op" id="2234038">)</span>&nbsp;<span class="op" id="2234040">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234043">if</span>&nbsp;<span class="ident" id="2234046">sa</span><span class="op" id="2234048">.</span><span class="ident" id="2234049">Port</span>&nbsp;<span class="op" id="2234054">&lt;</span>&nbsp;<span class="num" id="2234056">0</span>&nbsp;<span class="op" id="2234058">||</span>&nbsp;<span class="ident" id="2234061">sa</span><span class="op" id="2234063">.</span><span class="ident" id="2234064">Port</span>&nbsp;<span class="op" id="2234069">&gt;</span>&nbsp;<span class="num" id="2234071">0xFFFF</span>&nbsp;<span class="op" id="2234078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234082">return</span>&nbsp;<span class="ident" id="2234089">nil</span><span class="op" id="2234092">,</span>&nbsp;<span class="num" id="2234094">0</span><span class="op" id="2234095">,</span>&nbsp;<span class="ident" id="2234097">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234108">sa</span><span class="op" id="2234110">.</span><span class="ident" id="2234111">raw</span><span class="op" id="2234114">.</span><span class="ident" id="2234115">Family</span>&nbsp;<span class="op" id="2234122">=</span>&nbsp;<span class="ident" id="2234124">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234134">p</span>&nbsp;<span class="op" id="2234136">:=</span>&nbsp;<span class="op" id="2234139">(</span><span class="op" id="2234140">*</span><span class="op" id="2234141">[</span><span class="num" id="2234142">2</span><span class="op" id="2234143">]</span><span class="builtintype" id="2234144">byte</span><span class="op" id="2234148">)</span><span class="op" id="2234149">(</span><span class="ident" id="2234150">unsafe</span><span class="op" id="2234156">.</span><span class="ident" id="2234157">Pointer</span><span class="op" id="2234164">(</span><span class="op" id="2234165">&amp;</span><span class="ident" id="2234166">sa</span><span class="op" id="2234168">.</span><span class="ident" id="2234169">raw</span><span class="op" id="2234172">.</span><span class="ident" id="2234173">Port</span><span class="op" id="2234177">)</span><span class="op" id="2234178">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234181">p</span><span class="op" id="2234182">[</span><span class="num" id="2234183">0</span><span class="op" id="2234184">]</span>&nbsp;<span class="op" id="2234186">=</span>&nbsp;<span class="builtintype" id="2234188">byte</span><span class="op" id="2234192">(</span><span class="ident" id="2234193">sa</span><span class="op" id="2234195">.</span><span class="ident" id="2234196">Port</span>&nbsp;<span class="op" id="2234201">&gt;&gt;</span>&nbsp;<span class="num" id="2234204">8</span><span class="op" id="2234205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234208">p</span><span class="op" id="2234209">[</span><span class="num" id="2234210">1</span><span class="op" id="2234211">]</span>&nbsp;<span class="op" id="2234213">=</span>&nbsp;<span class="builtintype" id="2234215">byte</span><span class="op" id="2234219">(</span><span class="ident" id="2234220">sa</span><span class="op" id="2234222">.</span><span class="ident" id="2234223">Port</span><span class="op" id="2234227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234230">sa</span><span class="op" id="2234232">.</span><span class="ident" id="2234233">raw</span><span class="op" id="2234236">.</span><span class="ident" id="2234237">Scope_id</span>&nbsp;<span class="op" id="2234246">=</span>&nbsp;<span class="ident" id="2234248">sa</span><span class="op" id="2234250">.</span><span class="ident" id="2234251">ZoneId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234259">for</span>&nbsp;<span class="ident" id="2234263">i</span>&nbsp;<span class="op" id="2234265">:=</span>&nbsp;<span class="num" id="2234268">0</span><span class="op" id="2234269">;</span>&nbsp;<span class="ident" id="2234271">i</span>&nbsp;<span class="op" id="2234273">&lt;</span>&nbsp;<span class="builtinfunc" id="2234275">len</span><span class="op" id="2234278">(</span><span class="ident" id="2234279">sa</span><span class="op" id="2234281">.</span><span class="ident" id="2234282">Addr</span><span class="op" id="2234286">)</span><span class="op" id="2234287">;</span>&nbsp;<span class="ident" id="2234289">i</span><span class="op" id="2234290">++</span>&nbsp;<span class="op" id="2234293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234297">sa</span><span class="op" id="2234299">.</span><span class="ident" id="2234300">raw</span><span class="op" id="2234303">.</span><span class="ident" id="2234304">Addr</span><span class="op" id="2234308">[</span><span class="ident" id="2234309">i</span><span class="op" id="2234310">]</span>&nbsp;<span class="op" id="2234312">=</span>&nbsp;<span class="ident" id="2234314">sa</span><span class="op" id="2234316">.</span><span class="ident" id="2234317">Addr</span><span class="op" id="2234321">[</span><span class="ident" id="2234322">i</span><span class="op" id="2234323">]</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234329">return</span>&nbsp;<span class="ident" id="2234336">unsafe</span><span class="op" id="2234342">.</span><span class="ident" id="2234343">Pointer</span><span class="op" id="2234350">(</span><span class="op" id="2234351">&amp;</span><span class="ident" id="2234352">sa</span><span class="op" id="2234354">.</span><span class="ident" id="2234355">raw</span><span class="op" id="2234358">)</span><span class="op" id="2234359">,</span>&nbsp;<span class="ident" id="2234361">SizeofSockaddrInet6</span><span class="op" id="2234380">,</span>&nbsp;<span class="ident" id="2234382">nil</span><br>
<span class="lineno"></span><span class="op" id="2234386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2234389">func</span>&nbsp;<span class="op" id="2234394">(</span><span class="ident" id="2234395">sa</span>&nbsp;<span class="op" id="2234398">*</span><span class="ident" id="2234399">SockaddrUnix</span><span class="op" id="2234411">)</span>&nbsp;<span class="ident" id="2234413">sockaddr</span><span class="op" id="2234421">(</span><span class="op" id="2234422">)</span>&nbsp;<span class="op" id="2234424">(</span><span class="ident" id="2234425">unsafe</span><span class="op" id="2234431">.</span><span class="ident" id="2234432">Pointer</span><span class="op" id="2234439">,</span>&nbsp;<span class="ident" id="2234441">_Socklen</span><span class="op" id="2234449">,</span>&nbsp;<span class="builtintype" id="2234451">error</span><span class="op" id="2234456">)</span>&nbsp;<span class="op" id="2234458">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234461">name</span>&nbsp;<span class="op" id="2234466">:=</span>&nbsp;<span class="ident" id="2234469">sa</span><span class="op" id="2234471">.</span><span class="ident" id="2234472">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234478">n</span>&nbsp;<span class="op" id="2234480">:=</span>&nbsp;<span class="builtinfunc" id="2234483">len</span><span class="op" id="2234486">(</span><span class="ident" id="2234487">name</span><span class="op" id="2234491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234494">if</span>&nbsp;<span class="ident" id="2234497">n</span>&nbsp;<span class="op" id="2234499">&gt;=</span>&nbsp;<span class="builtinfunc" id="2234502">len</span><span class="op" id="2234505">(</span><span class="ident" id="2234506">sa</span><span class="op" id="2234508">.</span><span class="ident" id="2234509">raw</span><span class="op" id="2234512">.</span><span class="ident" id="2234513">Path</span><span class="op" id="2234517">)</span>&nbsp;<span class="op" id="2234519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234523">return</span>&nbsp;<span class="ident" id="2234530">nil</span><span class="op" id="2234533">,</span>&nbsp;<span class="num" id="2234535">0</span><span class="op" id="2234536">,</span>&nbsp;<span class="ident" id="2234538">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234546">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234549">sa</span><span class="op" id="2234551">.</span><span class="ident" id="2234552">raw</span><span class="op" id="2234555">.</span><span class="ident" id="2234556">Family</span>&nbsp;<span class="op" id="2234563">=</span>&nbsp;<span class="ident" id="2234565">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234574">for</span>&nbsp;<span class="ident" id="2234578">i</span>&nbsp;<span class="op" id="2234580">:=</span>&nbsp;<span class="num" id="2234583">0</span><span class="op" id="2234584">;</span>&nbsp;<span class="ident" id="2234586">i</span>&nbsp;<span class="op" id="2234588">&lt;</span>&nbsp;<span class="ident" id="2234590">n</span><span class="op" id="2234591">;</span>&nbsp;<span class="ident" id="2234593">i</span><span class="op" id="2234594">++</span>&nbsp;<span class="op" id="2234597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234601">sa</span><span class="op" id="2234603">.</span><span class="ident" id="2234604">raw</span><span class="op" id="2234607">.</span><span class="ident" id="2234608">Path</span><span class="op" id="2234612">[</span><span class="ident" id="2234613">i</span><span class="op" id="2234614">]</span>&nbsp;<span class="op" id="2234616">=</span>&nbsp;<span class="builtintype" id="2234618">int8</span><span class="op" id="2234622">(</span><span class="ident" id="2234623">name</span><span class="op" id="2234627">[</span><span class="ident" id="2234628">i</span><span class="op" id="2234629">]</span><span class="op" id="2234630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234633">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234636">//&nbsp;length&nbsp;is&nbsp;family&nbsp;(uint16),&nbsp;name,&nbsp;NUL.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234678">sl</span>&nbsp;<span class="op" id="2234681">:=</span>&nbsp;<span class="ident" id="2234684">_Socklen</span><span class="op" id="2234692">(</span><span class="num" id="2234693">2</span><span class="op" id="2234694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234697">if</span>&nbsp;<span class="ident" id="2234700">n</span>&nbsp;<span class="op" id="2234702">&gt;</span>&nbsp;<span class="num" id="2234704">0</span>&nbsp;<span class="op" id="2234706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234710">sl</span>&nbsp;<span class="op" id="2234713">+=</span>&nbsp;<span class="ident" id="2234716">_Socklen</span><span class="op" id="2234724">(</span><span class="ident" id="2234725">n</span><span class="op" id="2234726">)</span>&nbsp;<span class="op" id="2234728">+</span>&nbsp;<span class="num" id="2234730">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234736">if</span>&nbsp;<span class="ident" id="2234739">sa</span><span class="op" id="2234741">.</span><span class="ident" id="2234742">raw</span><span class="op" id="2234745">.</span><span class="ident" id="2234746">Path</span><span class="op" id="2234750">[</span><span class="num" id="2234751">0</span><span class="op" id="2234752">]</span>&nbsp;<span class="op" id="2234754">==</span>&nbsp;<span class="string" id="2234757">&#39;@&#39;</span>&nbsp;<span class="op" id="2234761">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234765">sa</span><span class="op" id="2234767">.</span><span class="ident" id="2234768">raw</span><span class="op" id="2234771">.</span><span class="ident" id="2234772">Path</span><span class="op" id="2234776">[</span><span class="num" id="2234777">0</span><span class="op" id="2234778">]</span>&nbsp;<span class="op" id="2234780">=</span>&nbsp;<span class="num" id="2234782">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2234786">//&nbsp;Don&#39;t&nbsp;count&nbsp;trailing&nbsp;NUL&nbsp;for&nbsp;abstract&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234838">sl</span><span class="op" id="2234840">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2234844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2234848">return</span>&nbsp;<span class="ident" id="2234855">unsafe</span><span class="op" id="2234861">.</span><span class="ident" id="2234862">Pointer</span><span class="op" id="2234869">(</span><span class="op" id="2234870">&amp;</span><span class="ident" id="2234871">sa</span><span class="op" id="2234873">.</span><span class="ident" id="2234874">raw</span><span class="op" id="2234877">)</span><span class="op" id="2234878">,</span>&nbsp;<span class="ident" id="2234880">sl</span><span class="op" id="2234882">,</span>&nbsp;<span class="ident" id="2234884">nil</span><br>
<span class="lineno"></span><span class="op" id="2234888">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2234891">type</span>&nbsp;<span class="ident" id="2234896">SockaddrLinklayer</span>&nbsp;<span class="keyword" id="2234914">struct</span>&nbsp;<span class="op" id="2234921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234924">Protocol</span>&nbsp;<span class="builtintype" id="2234933">uint16</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234941">Ifindex</span>&nbsp;&nbsp;<span class="builtintype" id="2234950">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234955">Hatype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2234964">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234972">Pkttype</span>&nbsp;&nbsp;<span class="builtintype" id="2234981">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2234988">Halen</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2234997">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235004">Addr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2235013">[</span><span class="num" id="2235014">8</span><span class="op" id="2235015">]</span><span class="builtintype" id="2235016">byte</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235022">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235031">RawSockaddrLinklayer</span><br>
<span class="lineno"></span><span class="op" id="2235052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235055">func</span>&nbsp;<span class="op" id="2235060">(</span><span class="ident" id="2235061">sa</span>&nbsp;<span class="op" id="2235064">*</span><span class="ident" id="2235065">SockaddrLinklayer</span><span class="op" id="2235082">)</span>&nbsp;<span class="ident" id="2235084">sockaddr</span><span class="op" id="2235092">(</span><span class="op" id="2235093">)</span>&nbsp;<span class="op" id="2235095">(</span><span class="ident" id="2235096">unsafe</span><span class="op" id="2235102">.</span><span class="ident" id="2235103">Pointer</span><span class="op" id="2235110">,</span>&nbsp;<span class="ident" id="2235112">_Socklen</span><span class="op" id="2235120">,</span>&nbsp;<span class="builtintype" id="2235122">error</span><span class="op" id="2235127">)</span>&nbsp;<span class="op" id="2235129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235132">if</span>&nbsp;<span class="ident" id="2235135">sa</span><span class="op" id="2235137">.</span><span class="ident" id="2235138">Ifindex</span>&nbsp;<span class="op" id="2235146">&lt;</span>&nbsp;<span class="num" id="2235148">0</span>&nbsp;<span class="op" id="2235150">||</span>&nbsp;<span class="ident" id="2235153">sa</span><span class="op" id="2235155">.</span><span class="ident" id="2235156">Ifindex</span>&nbsp;<span class="op" id="2235164">&gt;</span>&nbsp;<span class="num" id="2235166">0x7fffffff</span>&nbsp;<span class="op" id="2235177">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235181">return</span>&nbsp;<span class="ident" id="2235188">nil</span><span class="op" id="2235191">,</span>&nbsp;<span class="num" id="2235193">0</span><span class="op" id="2235194">,</span>&nbsp;<span class="ident" id="2235196">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235207">sa</span><span class="op" id="2235209">.</span><span class="ident" id="2235210">raw</span><span class="op" id="2235213">.</span><span class="ident" id="2235214">Family</span>&nbsp;<span class="op" id="2235221">=</span>&nbsp;<span class="ident" id="2235223">AF_PACKET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235234">sa</span><span class="op" id="2235236">.</span><span class="ident" id="2235237">raw</span><span class="op" id="2235240">.</span><span class="ident" id="2235241">Protocol</span>&nbsp;<span class="op" id="2235250">=</span>&nbsp;<span class="ident" id="2235252">sa</span><span class="op" id="2235254">.</span><span class="ident" id="2235255">Protocol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235265">sa</span><span class="op" id="2235267">.</span><span class="ident" id="2235268">raw</span><span class="op" id="2235271">.</span><span class="ident" id="2235272">Ifindex</span>&nbsp;<span class="op" id="2235280">=</span>&nbsp;<span class="builtintype" id="2235282">int32</span><span class="op" id="2235287">(</span><span class="ident" id="2235288">sa</span><span class="op" id="2235290">.</span><span class="ident" id="2235291">Ifindex</span><span class="op" id="2235298">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235301">sa</span><span class="op" id="2235303">.</span><span class="ident" id="2235304">raw</span><span class="op" id="2235307">.</span><span class="ident" id="2235308">Hatype</span>&nbsp;<span class="op" id="2235315">=</span>&nbsp;<span class="ident" id="2235317">sa</span><span class="op" id="2235319">.</span><span class="ident" id="2235320">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235328">sa</span><span class="op" id="2235330">.</span><span class="ident" id="2235331">raw</span><span class="op" id="2235334">.</span><span class="ident" id="2235335">Pkttype</span>&nbsp;<span class="op" id="2235343">=</span>&nbsp;<span class="ident" id="2235345">sa</span><span class="op" id="2235347">.</span><span class="ident" id="2235348">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235357">sa</span><span class="op" id="2235359">.</span><span class="ident" id="2235360">raw</span><span class="op" id="2235363">.</span><span class="ident" id="2235364">Halen</span>&nbsp;<span class="op" id="2235370">=</span>&nbsp;<span class="ident" id="2235372">sa</span><span class="op" id="2235374">.</span><span class="ident" id="2235375">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235382">for</span>&nbsp;<span class="ident" id="2235386">i</span>&nbsp;<span class="op" id="2235388">:=</span>&nbsp;<span class="num" id="2235391">0</span><span class="op" id="2235392">;</span>&nbsp;<span class="ident" id="2235394">i</span>&nbsp;<span class="op" id="2235396">&lt;</span>&nbsp;<span class="builtinfunc" id="2235398">len</span><span class="op" id="2235401">(</span><span class="ident" id="2235402">sa</span><span class="op" id="2235404">.</span><span class="ident" id="2235405">Addr</span><span class="op" id="2235409">)</span><span class="op" id="2235410">;</span>&nbsp;<span class="ident" id="2235412">i</span><span class="op" id="2235413">++</span>&nbsp;<span class="op" id="2235416">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235420">sa</span><span class="op" id="2235422">.</span><span class="ident" id="2235423">raw</span><span class="op" id="2235426">.</span><span class="ident" id="2235427">Addr</span><span class="op" id="2235431">[</span><span class="ident" id="2235432">i</span><span class="op" id="2235433">]</span>&nbsp;<span class="op" id="2235435">=</span>&nbsp;<span class="ident" id="2235437">sa</span><span class="op" id="2235439">.</span><span class="ident" id="2235440">Addr</span><span class="op" id="2235444">[</span><span class="ident" id="2235445">i</span><span class="op" id="2235446">]</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2235449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235452">return</span>&nbsp;<span class="ident" id="2235459">unsafe</span><span class="op" id="2235465">.</span><span class="ident" id="2235466">Pointer</span><span class="op" id="2235473">(</span><span class="op" id="2235474">&amp;</span><span class="ident" id="2235475">sa</span><span class="op" id="2235477">.</span><span class="ident" id="2235478">raw</span><span class="op" id="2235481">)</span><span class="op" id="2235482">,</span>&nbsp;<span class="ident" id="2235484">SizeofSockaddrLinklayer</span><span class="op" id="2235507">,</span>&nbsp;<span class="ident" id="2235509">nil</span><br>
<span class="lineno"></span><span class="op" id="2235513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235516">type</span>&nbsp;<span class="ident" id="2235521">SockaddrNetlink</span>&nbsp;<span class="keyword" id="2235537">struct</span>&nbsp;<span class="op" id="2235544">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235547">Family</span>&nbsp;<span class="builtintype" id="2235554">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235562">Pad</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2235569">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235577">Pid</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2235584">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235592">Groups</span>&nbsp;<span class="builtintype" id="2235599">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235607">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2235614">RawSockaddrNetlink</span><br>
<span class="lineno">320</span><span class="op" id="2235633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2235636">func</span>&nbsp;<span class="op" id="2235641">(</span><span class="ident" id="2235642">sa</span>&nbsp;<span class="op" id="2235645">*</span><span class="ident" id="2235646">SockaddrNetlink</span><span class="op" id="2235661">)</span>&nbsp;<span class="ident" id="2235663">sockaddr</span><span class="op" id="2235671">(</span><span class="op" id="2235672">)</span>&nbsp;<span class="op" id="2235674">(</span><span class="ident" id="2235675">unsafe</span><span class="op" id="2235681">.</span><span class="ident" id="2235682">Pointer</span><span class="op" id="2235689">,</span>&nbsp;<span class="ident" id="2235691">_Socklen</span><span class="op" id="2235699">,</span>&nbsp;<span class="builtintype" id="2235701">error</span><span class="op" id="2235706">)</span>&nbsp;<span class="op" id="2235708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235711">sa</span><span class="op" id="2235713">.</span><span class="ident" id="2235714">raw</span><span class="op" id="2235717">.</span><span class="ident" id="2235718">Family</span>&nbsp;<span class="op" id="2235725">=</span>&nbsp;<span class="ident" id="2235727">AF_NETLINK</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235739">sa</span><span class="op" id="2235741">.</span><span class="ident" id="2235742">raw</span><span class="op" id="2235745">.</span><span class="ident" id="2235746">Pad</span>&nbsp;<span class="op" id="2235750">=</span>&nbsp;<span class="ident" id="2235752">sa</span><span class="op" id="2235754">.</span><span class="ident" id="2235755">Pad</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235760">sa</span><span class="op" id="2235762">.</span><span class="ident" id="2235763">raw</span><span class="op" id="2235766">.</span><span class="ident" id="2235767">Pid</span>&nbsp;<span class="op" id="2235771">=</span>&nbsp;<span class="ident" id="2235773">sa</span><span class="op" id="2235775">.</span><span class="ident" id="2235776">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235781">sa</span><span class="op" id="2235783">.</span><span class="ident" id="2235784">raw</span><span class="op" id="2235787">.</span><span class="ident" id="2235788">Groups</span>&nbsp;<span class="op" id="2235795">=</span>&nbsp;<span class="ident" id="2235797">sa</span><span class="op" id="2235799">.</span><span class="ident" id="2235800">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235808">return</span>&nbsp;<span class="ident" id="2235815">unsafe</span><span class="op" id="2235821">.</span><span class="ident" id="2235822">Pointer</span><span class="op" id="2235829">(</span><span class="op" id="2235830">&amp;</span><span class="ident" id="2235831">sa</span><span class="op" id="2235833">.</span><span class="ident" id="2235834">raw</span><span class="op" id="2235837">)</span><span class="op" id="2235838">,</span>&nbsp;<span class="ident" id="2235840">SizeofSockaddrNetlink</span><span class="op" id="2235861">,</span>&nbsp;<span class="ident" id="2235863">nil</span><br>
<span class="lineno"></span><span class="op" id="2235867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span><span class="keyword" id="2235870">func</span>&nbsp;<span class="ident" id="2235875">anyToSockaddr</span><span class="op" id="2235888">(</span><span class="ident" id="2235889">rsa</span>&nbsp;<span class="op" id="2235893">*</span><span class="ident" id="2235894">RawSockaddrAny</span><span class="op" id="2235908">)</span>&nbsp;<span class="op" id="2235910">(</span><span class="ident" id="2235911">Sockaddr</span><span class="op" id="2235919">,</span>&nbsp;<span class="builtintype" id="2235921">error</span><span class="op" id="2235926">)</span>&nbsp;<span class="op" id="2235928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235931">switch</span>&nbsp;<span class="ident" id="2235938">rsa</span><span class="op" id="2235941">.</span><span class="ident" id="2235942">Addr</span><span class="op" id="2235946">.</span><span class="ident" id="2235947">Family</span>&nbsp;<span class="op" id="2235954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2235957">case</span>&nbsp;<span class="ident" id="2235962">AF_NETLINK</span><span class="op" id="2235972">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2235976">pp</span>&nbsp;<span class="op" id="2235979">:=</span>&nbsp;<span class="op" id="2235982">(</span><span class="op" id="2235983">*</span><span class="ident" id="2235984">RawSockaddrNetlink</span><span class="op" id="2236002">)</span><span class="op" id="2236003">(</span><span class="ident" id="2236004">unsafe</span><span class="op" id="2236010">.</span><span class="ident" id="2236011">Pointer</span><span class="op" id="2236018">(</span><span class="ident" id="2236019">rsa</span><span class="op" id="2236022">)</span><span class="op" id="2236023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236027">sa</span>&nbsp;<span class="op" id="2236030">:=</span>&nbsp;<span class="builtinfunc" id="2236033">new</span><span class="op" id="2236036">(</span><span class="ident" id="2236037">SockaddrNetlink</span><span class="op" id="2236052">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236056">sa</span><span class="op" id="2236058">.</span><span class="ident" id="2236059">Family</span>&nbsp;<span class="op" id="2236066">=</span>&nbsp;<span class="ident" id="2236068">pp</span><span class="op" id="2236070">.</span><span class="ident" id="2236071">Family</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236080">sa</span><span class="op" id="2236082">.</span><span class="ident" id="2236083">Pad</span>&nbsp;<span class="op" id="2236087">=</span>&nbsp;<span class="ident" id="2236089">pp</span><span class="op" id="2236091">.</span><span class="ident" id="2236092">Pad</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236098">sa</span><span class="op" id="2236100">.</span><span class="ident" id="2236101">Pid</span>&nbsp;<span class="op" id="2236105">=</span>&nbsp;<span class="ident" id="2236107">pp</span><span class="op" id="2236109">.</span><span class="ident" id="2236110">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236116">sa</span><span class="op" id="2236118">.</span><span class="ident" id="2236119">Groups</span>&nbsp;<span class="op" id="2236126">=</span>&nbsp;<span class="ident" id="2236128">pp</span><span class="op" id="2236130">.</span><span class="ident" id="2236131">Groups</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236140">return</span>&nbsp;<span class="ident" id="2236147">sa</span><span class="op" id="2236149">,</span>&nbsp;<span class="ident" id="2236151">nil</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236157">case</span>&nbsp;<span class="ident" id="2236162">AF_PACKET</span><span class="op" id="2236171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236175">pp</span>&nbsp;<span class="op" id="2236178">:=</span>&nbsp;<span class="op" id="2236181">(</span><span class="op" id="2236182">*</span><span class="ident" id="2236183">RawSockaddrLinklayer</span><span class="op" id="2236203">)</span><span class="op" id="2236204">(</span><span class="ident" id="2236205">unsafe</span><span class="op" id="2236211">.</span><span class="ident" id="2236212">Pointer</span><span class="op" id="2236219">(</span><span class="ident" id="2236220">rsa</span><span class="op" id="2236223">)</span><span class="op" id="2236224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236228">sa</span>&nbsp;<span class="op" id="2236231">:=</span>&nbsp;<span class="builtinfunc" id="2236234">new</span><span class="op" id="2236237">(</span><span class="ident" id="2236238">SockaddrLinklayer</span><span class="op" id="2236255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236259">sa</span><span class="op" id="2236261">.</span><span class="ident" id="2236262">Protocol</span>&nbsp;<span class="op" id="2236271">=</span>&nbsp;<span class="ident" id="2236273">pp</span><span class="op" id="2236275">.</span><span class="ident" id="2236276">Protocol</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236287">sa</span><span class="op" id="2236289">.</span><span class="ident" id="2236290">Ifindex</span>&nbsp;<span class="op" id="2236298">=</span>&nbsp;<span class="builtintype" id="2236300">int</span><span class="op" id="2236303">(</span><span class="ident" id="2236304">pp</span><span class="op" id="2236306">.</span><span class="ident" id="2236307">Ifindex</span><span class="op" id="2236314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236318">sa</span><span class="op" id="2236320">.</span><span class="ident" id="2236321">Hatype</span>&nbsp;<span class="op" id="2236328">=</span>&nbsp;<span class="ident" id="2236330">pp</span><span class="op" id="2236332">.</span><span class="ident" id="2236333">Hatype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236342">sa</span><span class="op" id="2236344">.</span><span class="ident" id="2236345">Pkttype</span>&nbsp;<span class="op" id="2236353">=</span>&nbsp;<span class="ident" id="2236355">pp</span><span class="op" id="2236357">.</span><span class="ident" id="2236358">Pkttype</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236368">sa</span><span class="op" id="2236370">.</span><span class="ident" id="2236371">Halen</span>&nbsp;<span class="op" id="2236377">=</span>&nbsp;<span class="ident" id="2236379">pp</span><span class="op" id="2236381">.</span><span class="ident" id="2236382">Halen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236390">for</span>&nbsp;<span class="ident" id="2236394">i</span>&nbsp;<span class="op" id="2236396">:=</span>&nbsp;<span class="num" id="2236399">0</span><span class="op" id="2236400">;</span>&nbsp;<span class="ident" id="2236402">i</span>&nbsp;<span class="op" id="2236404">&lt;</span>&nbsp;<span class="builtinfunc" id="2236406">len</span><span class="op" id="2236409">(</span><span class="ident" id="2236410">sa</span><span class="op" id="2236412">.</span><span class="ident" id="2236413">Addr</span><span class="op" id="2236417">)</span><span class="op" id="2236418">;</span>&nbsp;<span class="ident" id="2236420">i</span><span class="op" id="2236421">++</span>&nbsp;<span class="op" id="2236424">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236429">sa</span><span class="op" id="2236431">.</span><span class="ident" id="2236432">Addr</span><span class="op" id="2236436">[</span><span class="ident" id="2236437">i</span><span class="op" id="2236438">]</span>&nbsp;<span class="op" id="2236440">=</span>&nbsp;<span class="ident" id="2236442">pp</span><span class="op" id="2236444">.</span><span class="ident" id="2236445">Addr</span><span class="op" id="2236449">[</span><span class="ident" id="2236450">i</span><span class="op" id="2236451">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236459">return</span>&nbsp;<span class="ident" id="2236466">sa</span><span class="op" id="2236468">,</span>&nbsp;<span class="ident" id="2236470">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236476">case</span>&nbsp;<span class="ident" id="2236481">AF_UNIX</span><span class="op" id="2236488">:</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236492">pp</span>&nbsp;<span class="op" id="2236495">:=</span>&nbsp;<span class="op" id="2236498">(</span><span class="op" id="2236499">*</span><span class="ident" id="2236500">RawSockaddrUnix</span><span class="op" id="2236515">)</span><span class="op" id="2236516">(</span><span class="ident" id="2236517">unsafe</span><span class="op" id="2236523">.</span><span class="ident" id="2236524">Pointer</span><span class="op" id="2236531">(</span><span class="ident" id="2236532">rsa</span><span class="op" id="2236535">)</span><span class="op" id="2236536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236540">sa</span>&nbsp;<span class="op" id="2236543">:=</span>&nbsp;<span class="builtinfunc" id="2236546">new</span><span class="op" id="2236549">(</span><span class="ident" id="2236550">SockaddrUnix</span><span class="op" id="2236562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2236566">if</span>&nbsp;<span class="ident" id="2236569">pp</span><span class="op" id="2236571">.</span><span class="ident" id="2236572">Path</span><span class="op" id="2236576">[</span><span class="num" id="2236577">0</span><span class="op" id="2236578">]</span>&nbsp;<span class="op" id="2236580">==</span>&nbsp;<span class="num" id="2236583">0</span>&nbsp;<span class="op" id="2236585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236590">//&nbsp;&#34;Abstract&#34;&nbsp;Unix&nbsp;domain&nbsp;socket.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236627">//&nbsp;Rewrite&nbsp;leading&nbsp;NUL&nbsp;as&nbsp;@&nbsp;for&nbsp;textual&nbsp;display.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236679">//&nbsp;(This&nbsp;is&nbsp;the&nbsp;standard&nbsp;convention.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236720">//&nbsp;Not&nbsp;friendly&nbsp;to&nbsp;overwrite&nbsp;in&nbsp;place,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236762">//&nbsp;but&nbsp;the&nbsp;callers&nbsp;below&nbsp;don&#39;t&nbsp;care.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2236802">pp</span><span class="op" id="2236804">.</span><span class="ident" id="2236805">Path</span><span class="op" id="2236809">[</span><span class="num" id="2236810">0</span><span class="op" id="2236811">]</span>&nbsp;<span class="op" id="2236813">=</span>&nbsp;<span class="string" id="2236815">&#39;@&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2236821">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236826">//&nbsp;Assume&nbsp;path&nbsp;ends&nbsp;at&nbsp;NUL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236856">//&nbsp;This&nbsp;is&nbsp;not&nbsp;technically&nbsp;the&nbsp;Linux&nbsp;semantics&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236909">//&nbsp;abstract&nbsp;Unix&nbsp;domain&nbsp;sockets--they&nbsp;are&nbsp;supposed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2236962">//&nbsp;to&nbsp;be&nbsp;uninterpreted&nbsp;fixed-size&nbsp;binary&nbsp;blobs--but</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2237016">//&nbsp;everyone&nbsp;uses&nbsp;this&nbsp;convention.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237052">n</span>&nbsp;<span class="op" id="2237054">:=</span>&nbsp;<span class="num" id="2237057">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237061">for</span>&nbsp;<span class="ident" id="2237065">n</span>&nbsp;<span class="op" id="2237067">&lt;</span>&nbsp;<span class="builtinfunc" id="2237069">len</span><span class="op" id="2237072">(</span><span class="ident" id="2237073">pp</span><span class="op" id="2237075">.</span><span class="ident" id="2237076">Path</span><span class="op" id="2237080">)</span>&nbsp;<span class="op" id="2237082">&amp;&amp;</span>&nbsp;<span class="ident" id="2237085">pp</span><span class="op" id="2237087">.</span><span class="ident" id="2237088">Path</span><span class="op" id="2237092">[</span><span class="ident" id="2237093">n</span><span class="op" id="2237094">]</span>&nbsp;<span class="op" id="2237096">!=</span>&nbsp;<span class="num" id="2237099">0</span>&nbsp;<span class="op" id="2237101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237106">n</span><span class="op" id="2237107">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237112">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237116">bytes</span>&nbsp;<span class="op" id="2237122">:=</span>&nbsp;<span class="op" id="2237125">(</span><span class="op" id="2237126">*</span><span class="op" id="2237127">[</span><span class="num" id="2237128">10000</span><span class="op" id="2237133">]</span><span class="builtintype" id="2237134">byte</span><span class="op" id="2237138">)</span><span class="op" id="2237139">(</span><span class="ident" id="2237140">unsafe</span><span class="op" id="2237146">.</span><span class="ident" id="2237147">Pointer</span><span class="op" id="2237154">(</span><span class="op" id="2237155">&amp;</span><span class="ident" id="2237156">pp</span><span class="op" id="2237158">.</span><span class="ident" id="2237159">Path</span><span class="op" id="2237163">[</span><span class="num" id="2237164">0</span><span class="op" id="2237165">]</span><span class="op" id="2237166">)</span><span class="op" id="2237167">)</span><span class="op" id="2237168">[</span><span class="num" id="2237169">0</span><span class="op" id="2237170">:</span><span class="ident" id="2237171">n</span><span class="op" id="2237172">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237176">sa</span><span class="op" id="2237178">.</span><span class="ident" id="2237179">Name</span>&nbsp;<span class="op" id="2237184">=</span>&nbsp;<span class="builtintype" id="2237186">string</span><span class="op" id="2237192">(</span><span class="ident" id="2237193">bytes</span><span class="op" id="2237198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237202">return</span>&nbsp;<span class="ident" id="2237209">sa</span><span class="op" id="2237211">,</span>&nbsp;<span class="ident" id="2237213">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237219">case</span>&nbsp;<span class="ident" id="2237224">AF_INET</span><span class="op" id="2237231">:</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237235">pp</span>&nbsp;<span class="op" id="2237238">:=</span>&nbsp;<span class="op" id="2237241">(</span><span class="op" id="2237242">*</span><span class="ident" id="2237243">RawSockaddrInet4</span><span class="op" id="2237259">)</span><span class="op" id="2237260">(</span><span class="ident" id="2237261">unsafe</span><span class="op" id="2237267">.</span><span class="ident" id="2237268">Pointer</span><span class="op" id="2237275">(</span><span class="ident" id="2237276">rsa</span><span class="op" id="2237279">)</span><span class="op" id="2237280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237284">sa</span>&nbsp;<span class="op" id="2237287">:=</span>&nbsp;<span class="builtinfunc" id="2237290">new</span><span class="op" id="2237293">(</span><span class="ident" id="2237294">SockaddrInet4</span><span class="op" id="2237307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237311">p</span>&nbsp;<span class="op" id="2237313">:=</span>&nbsp;<span class="op" id="2237316">(</span><span class="op" id="2237317">*</span><span class="op" id="2237318">[</span><span class="num" id="2237319">2</span><span class="op" id="2237320">]</span><span class="builtintype" id="2237321">byte</span><span class="op" id="2237325">)</span><span class="op" id="2237326">(</span><span class="ident" id="2237327">unsafe</span><span class="op" id="2237333">.</span><span class="ident" id="2237334">Pointer</span><span class="op" id="2237341">(</span><span class="op" id="2237342">&amp;</span><span class="ident" id="2237343">pp</span><span class="op" id="2237345">.</span><span class="ident" id="2237346">Port</span><span class="op" id="2237350">)</span><span class="op" id="2237351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237355">sa</span><span class="op" id="2237357">.</span><span class="ident" id="2237358">Port</span>&nbsp;<span class="op" id="2237363">=</span>&nbsp;<span class="builtintype" id="2237365">int</span><span class="op" id="2237368">(</span><span class="ident" id="2237369">p</span><span class="op" id="2237370">[</span><span class="num" id="2237371">0</span><span class="op" id="2237372">]</span><span class="op" id="2237373">)</span><span class="op" id="2237374">&lt;&lt;</span><span class="num" id="2237376">8</span>&nbsp;<span class="op" id="2237378">+</span>&nbsp;<span class="builtintype" id="2237380">int</span><span class="op" id="2237383">(</span><span class="ident" id="2237384">p</span><span class="op" id="2237385">[</span><span class="num" id="2237386">1</span><span class="op" id="2237387">]</span><span class="op" id="2237388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237392">for</span>&nbsp;<span class="ident" id="2237396">i</span>&nbsp;<span class="op" id="2237398">:=</span>&nbsp;<span class="num" id="2237401">0</span><span class="op" id="2237402">;</span>&nbsp;<span class="ident" id="2237404">i</span>&nbsp;<span class="op" id="2237406">&lt;</span>&nbsp;<span class="builtinfunc" id="2237408">len</span><span class="op" id="2237411">(</span><span class="ident" id="2237412">sa</span><span class="op" id="2237414">.</span><span class="ident" id="2237415">Addr</span><span class="op" id="2237419">)</span><span class="op" id="2237420">;</span>&nbsp;<span class="ident" id="2237422">i</span><span class="op" id="2237423">++</span>&nbsp;<span class="op" id="2237426">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237431">sa</span><span class="op" id="2237433">.</span><span class="ident" id="2237434">Addr</span><span class="op" id="2237438">[</span><span class="ident" id="2237439">i</span><span class="op" id="2237440">]</span>&nbsp;<span class="op" id="2237442">=</span>&nbsp;<span class="ident" id="2237444">pp</span><span class="op" id="2237446">.</span><span class="ident" id="2237447">Addr</span><span class="op" id="2237451">[</span><span class="ident" id="2237452">i</span><span class="op" id="2237453">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237461">return</span>&nbsp;<span class="ident" id="2237468">sa</span><span class="op" id="2237470">,</span>&nbsp;<span class="ident" id="2237472">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237478">case</span>&nbsp;<span class="ident" id="2237483">AF_INET6</span><span class="op" id="2237491">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237495">pp</span>&nbsp;<span class="op" id="2237498">:=</span>&nbsp;<span class="op" id="2237501">(</span><span class="op" id="2237502">*</span><span class="ident" id="2237503">RawSockaddrInet6</span><span class="op" id="2237519">)</span><span class="op" id="2237520">(</span><span class="ident" id="2237521">unsafe</span><span class="op" id="2237527">.</span><span class="ident" id="2237528">Pointer</span><span class="op" id="2237535">(</span><span class="ident" id="2237536">rsa</span><span class="op" id="2237539">)</span><span class="op" id="2237540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237544">sa</span>&nbsp;<span class="op" id="2237547">:=</span>&nbsp;<span class="builtinfunc" id="2237550">new</span><span class="op" id="2237553">(</span><span class="ident" id="2237554">SockaddrInet6</span><span class="op" id="2237567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237571">p</span>&nbsp;<span class="op" id="2237573">:=</span>&nbsp;<span class="op" id="2237576">(</span><span class="op" id="2237577">*</span><span class="op" id="2237578">[</span><span class="num" id="2237579">2</span><span class="op" id="2237580">]</span><span class="builtintype" id="2237581">byte</span><span class="op" id="2237585">)</span><span class="op" id="2237586">(</span><span class="ident" id="2237587">unsafe</span><span class="op" id="2237593">.</span><span class="ident" id="2237594">Pointer</span><span class="op" id="2237601">(</span><span class="op" id="2237602">&amp;</span><span class="ident" id="2237603">pp</span><span class="op" id="2237605">.</span><span class="ident" id="2237606">Port</span><span class="op" id="2237610">)</span><span class="op" id="2237611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237615">sa</span><span class="op" id="2237617">.</span><span class="ident" id="2237618">Port</span>&nbsp;<span class="op" id="2237623">=</span>&nbsp;<span class="builtintype" id="2237625">int</span><span class="op" id="2237628">(</span><span class="ident" id="2237629">p</span><span class="op" id="2237630">[</span><span class="num" id="2237631">0</span><span class="op" id="2237632">]</span><span class="op" id="2237633">)</span><span class="op" id="2237634">&lt;&lt;</span><span class="num" id="2237636">8</span>&nbsp;<span class="op" id="2237638">+</span>&nbsp;<span class="builtintype" id="2237640">int</span><span class="op" id="2237643">(</span><span class="ident" id="2237644">p</span><span class="op" id="2237645">[</span><span class="num" id="2237646">1</span><span class="op" id="2237647">]</span><span class="op" id="2237648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237652">sa</span><span class="op" id="2237654">.</span><span class="ident" id="2237655">ZoneId</span>&nbsp;<span class="op" id="2237662">=</span>&nbsp;<span class="ident" id="2237664">pp</span><span class="op" id="2237666">.</span><span class="ident" id="2237667">Scope_id</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237678">for</span>&nbsp;<span class="ident" id="2237682">i</span>&nbsp;<span class="op" id="2237684">:=</span>&nbsp;<span class="num" id="2237687">0</span><span class="op" id="2237688">;</span>&nbsp;<span class="ident" id="2237690">i</span>&nbsp;<span class="op" id="2237692">&lt;</span>&nbsp;<span class="builtinfunc" id="2237694">len</span><span class="op" id="2237697">(</span><span class="ident" id="2237698">sa</span><span class="op" id="2237700">.</span><span class="ident" id="2237701">Addr</span><span class="op" id="2237705">)</span><span class="op" id="2237706">;</span>&nbsp;<span class="ident" id="2237708">i</span><span class="op" id="2237709">++</span>&nbsp;<span class="op" id="2237712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237717">sa</span><span class="op" id="2237719">.</span><span class="ident" id="2237720">Addr</span><span class="op" id="2237724">[</span><span class="ident" id="2237725">i</span><span class="op" id="2237726">]</span>&nbsp;<span class="op" id="2237728">=</span>&nbsp;<span class="ident" id="2237730">pp</span><span class="op" id="2237732">.</span><span class="ident" id="2237733">Addr</span><span class="op" id="2237737">[</span><span class="ident" id="2237738">i</span><span class="op" id="2237739">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237747">return</span>&nbsp;<span class="ident" id="2237754">sa</span><span class="op" id="2237756">,</span>&nbsp;<span class="ident" id="2237758">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237763">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237766">return</span>&nbsp;<span class="ident" id="2237773">nil</span><span class="op" id="2237776">,</span>&nbsp;<span class="ident" id="2237778">EAFNOSUPPORT</span><br>
<span class="lineno"></span><span class="op" id="2237791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2237794">func</span>&nbsp;<span class="ident" id="2237799">Accept</span><span class="op" id="2237805">(</span><span class="ident" id="2237806">fd</span>&nbsp;<span class="builtintype" id="2237809">int</span><span class="op" id="2237812">)</span>&nbsp;<span class="op" id="2237814">(</span><span class="ident" id="2237815">nfd</span>&nbsp;<span class="builtintype" id="2237819">int</span><span class="op" id="2237822">,</span>&nbsp;<span class="ident" id="2237824">sa</span>&nbsp;<span class="ident" id="2237827">Sockaddr</span><span class="op" id="2237835">,</span>&nbsp;<span class="ident" id="2237837">err</span>&nbsp;<span class="builtintype" id="2237841">error</span><span class="op" id="2237846">)</span>&nbsp;<span class="op" id="2237848">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237851">var</span>&nbsp;<span class="ident" id="2237855">rsa</span>&nbsp;<span class="ident" id="2237859">RawSockaddrAny</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237875">var</span>&nbsp;<span class="builtinfunc" id="2237879">len</span>&nbsp;<span class="ident" id="2237883">_Socklen</span>&nbsp;<span class="op" id="2237892">=</span>&nbsp;<span class="ident" id="2237894">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237913">nfd</span><span class="op" id="2237916">,</span>&nbsp;<span class="ident" id="2237918">err</span>&nbsp;<span class="op" id="2237922">=</span>&nbsp;<span class="ident" id="2237924">accept</span><span class="op" id="2237930">(</span><span class="ident" id="2237931">fd</span><span class="op" id="2237933">,</span>&nbsp;<span class="op" id="2237935">&amp;</span><span class="ident" id="2237936">rsa</span><span class="op" id="2237939">,</span>&nbsp;<span class="op" id="2237941">&amp;</span><span class="builtinfunc" id="2237942">len</span><span class="op" id="2237945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237948">if</span>&nbsp;<span class="ident" id="2237951">err</span>&nbsp;<span class="op" id="2237955">!=</span>&nbsp;<span class="ident" id="2237958">nil</span>&nbsp;<span class="op" id="2237962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2237966">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2237974">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2237977">sa</span><span class="op" id="2237979">,</span>&nbsp;<span class="ident" id="2237981">err</span>&nbsp;<span class="op" id="2237985">=</span>&nbsp;<span class="ident" id="2237987">anyToSockaddr</span><span class="op" id="2238000">(</span><span class="op" id="2238001">&amp;</span><span class="ident" id="2238002">rsa</span><span class="op" id="2238005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238008">if</span>&nbsp;<span class="ident" id="2238011">err</span>&nbsp;<span class="op" id="2238015">!=</span>&nbsp;<span class="ident" id="2238018">nil</span>&nbsp;<span class="op" id="2238022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238026">Close</span><span class="op" id="2238031">(</span><span class="ident" id="2238032">nfd</span><span class="op" id="2238035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238039">nfd</span>&nbsp;<span class="op" id="2238043">=</span>&nbsp;<span class="num" id="2238045">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238048">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238051">return</span><br>
<span class="lineno"></span><span class="op" id="2238058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2238061">func</span>&nbsp;<span class="ident" id="2238066">Accept4</span><span class="op" id="2238073">(</span><span class="ident" id="2238074">fd</span>&nbsp;<span class="builtintype" id="2238077">int</span><span class="op" id="2238080">,</span>&nbsp;<span class="ident" id="2238082">flags</span>&nbsp;<span class="builtintype" id="2238088">int</span><span class="op" id="2238091">)</span>&nbsp;<span class="op" id="2238093">(</span><span class="ident" id="2238094">nfd</span>&nbsp;<span class="builtintype" id="2238098">int</span><span class="op" id="2238101">,</span>&nbsp;<span class="ident" id="2238103">sa</span>&nbsp;<span class="ident" id="2238106">Sockaddr</span><span class="op" id="2238114">,</span>&nbsp;<span class="ident" id="2238116">err</span>&nbsp;<span class="builtintype" id="2238120">error</span><span class="op" id="2238125">)</span>&nbsp;<span class="op" id="2238127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238130">var</span>&nbsp;<span class="ident" id="2238134">rsa</span>&nbsp;<span class="ident" id="2238138">RawSockaddrAny</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238154">var</span>&nbsp;<span class="builtinfunc" id="2238158">len</span>&nbsp;<span class="ident" id="2238162">_Socklen</span>&nbsp;<span class="op" id="2238171">=</span>&nbsp;<span class="ident" id="2238173">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238192">nfd</span><span class="op" id="2238195">,</span>&nbsp;<span class="ident" id="2238197">err</span>&nbsp;<span class="op" id="2238201">=</span>&nbsp;<span class="ident" id="2238203">accept4</span><span class="op" id="2238210">(</span><span class="ident" id="2238211">fd</span><span class="op" id="2238213">,</span>&nbsp;<span class="op" id="2238215">&amp;</span><span class="ident" id="2238216">rsa</span><span class="op" id="2238219">,</span>&nbsp;<span class="op" id="2238221">&amp;</span><span class="builtinfunc" id="2238222">len</span><span class="op" id="2238225">,</span>&nbsp;<span class="ident" id="2238227">flags</span><span class="op" id="2238232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238235">if</span>&nbsp;<span class="ident" id="2238238">err</span>&nbsp;<span class="op" id="2238242">!=</span>&nbsp;<span class="ident" id="2238245">nil</span>&nbsp;<span class="op" id="2238249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238253">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238261">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238264">if</span>&nbsp;<span class="builtinfunc" id="2238267">len</span>&nbsp;<span class="op" id="2238271">&gt;</span>&nbsp;<span class="ident" id="2238273">SizeofSockaddrAny</span>&nbsp;<span class="op" id="2238291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2238295">panic</span><span class="op" id="2238300">(</span><span class="string" id="2238301">&#34;RawSockaddrAny&nbsp;too&nbsp;small&#34;</span><span class="op" id="2238327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238333">sa</span><span class="op" id="2238335">,</span>&nbsp;<span class="ident" id="2238337">err</span>&nbsp;<span class="op" id="2238341">=</span>&nbsp;<span class="ident" id="2238343">anyToSockaddr</span><span class="op" id="2238356">(</span><span class="op" id="2238357">&amp;</span><span class="ident" id="2238358">rsa</span><span class="op" id="2238361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238364">if</span>&nbsp;<span class="ident" id="2238367">err</span>&nbsp;<span class="op" id="2238371">!=</span>&nbsp;<span class="ident" id="2238374">nil</span>&nbsp;<span class="op" id="2238378">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238382">Close</span><span class="op" id="2238387">(</span><span class="ident" id="2238388">nfd</span><span class="op" id="2238391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238395">nfd</span>&nbsp;<span class="op" id="2238399">=</span>&nbsp;<span class="num" id="2238401">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238407">return</span><br>
<span class="lineno"></span><span class="op" id="2238414">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="keyword" id="2238417">func</span>&nbsp;<span class="ident" id="2238422">Getsockname</span><span class="op" id="2238433">(</span><span class="ident" id="2238434">fd</span>&nbsp;<span class="builtintype" id="2238437">int</span><span class="op" id="2238440">)</span>&nbsp;<span class="op" id="2238442">(</span><span class="ident" id="2238443">sa</span>&nbsp;<span class="ident" id="2238446">Sockaddr</span><span class="op" id="2238454">,</span>&nbsp;<span class="ident" id="2238456">err</span>&nbsp;<span class="builtintype" id="2238460">error</span><span class="op" id="2238465">)</span>&nbsp;<span class="op" id="2238467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238470">var</span>&nbsp;<span class="ident" id="2238474">rsa</span>&nbsp;<span class="ident" id="2238478">RawSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238494">var</span>&nbsp;<span class="builtinfunc" id="2238498">len</span>&nbsp;<span class="ident" id="2238502">_Socklen</span>&nbsp;<span class="op" id="2238511">=</span>&nbsp;<span class="ident" id="2238513">SizeofSockaddrAny</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238532">if</span>&nbsp;<span class="ident" id="2238535">err</span>&nbsp;<span class="op" id="2238539">=</span>&nbsp;<span class="ident" id="2238541">getsockname</span><span class="op" id="2238552">(</span><span class="ident" id="2238553">fd</span><span class="op" id="2238555">,</span>&nbsp;<span class="op" id="2238557">&amp;</span><span class="ident" id="2238558">rsa</span><span class="op" id="2238561">,</span>&nbsp;<span class="op" id="2238563">&amp;</span><span class="builtinfunc" id="2238564">len</span><span class="op" id="2238567">)</span><span class="op" id="2238568">;</span>&nbsp;<span class="ident" id="2238570">err</span>&nbsp;<span class="op" id="2238574">!=</span>&nbsp;<span class="ident" id="2238577">nil</span>&nbsp;<span class="op" id="2238581">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238585">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2238593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238596">return</span>&nbsp;<span class="ident" id="2238603">anyToSockaddr</span><span class="op" id="2238616">(</span><span class="op" id="2238617">&amp;</span><span class="ident" id="2238618">rsa</span><span class="op" id="2238621">)</span><br>
<span class="lineno"></span><span class="op" id="2238623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="2238626">func</span>&nbsp;<span class="ident" id="2238631">GetsockoptInet4Addr</span><span class="op" id="2238650">(</span><span class="ident" id="2238651">fd</span><span class="op" id="2238653">,</span>&nbsp;<span class="ident" id="2238655">level</span><span class="op" id="2238660">,</span>&nbsp;<span class="ident" id="2238662">opt</span>&nbsp;<span class="builtintype" id="2238666">int</span><span class="op" id="2238669">)</span>&nbsp;<span class="op" id="2238671">(</span><span class="ident" id="2238672">value</span>&nbsp;<span class="op" id="2238678">[</span><span class="num" id="2238679">4</span><span class="op" id="2238680">]</span><span class="builtintype" id="2238681">byte</span><span class="op" id="2238685">,</span>&nbsp;<span class="ident" id="2238687">err</span>&nbsp;<span class="builtintype" id="2238691">error</span><span class="op" id="2238696">)</span>&nbsp;<span class="op" id="2238698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238701">vallen</span>&nbsp;<span class="op" id="2238708">:=</span>&nbsp;<span class="ident" id="2238711">_Socklen</span><span class="op" id="2238719">(</span><span class="num" id="2238720">4</span><span class="op" id="2238721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238724">err</span>&nbsp;<span class="op" id="2238728">=</span>&nbsp;<span class="ident" id="2238730">getsockopt</span><span class="op" id="2238740">(</span><span class="ident" id="2238741">fd</span><span class="op" id="2238743">,</span>&nbsp;<span class="ident" id="2238745">level</span><span class="op" id="2238750">,</span>&nbsp;<span class="ident" id="2238752">opt</span><span class="op" id="2238755">,</span>&nbsp;<span class="ident" id="2238757">unsafe</span><span class="op" id="2238763">.</span><span class="ident" id="2238764">Pointer</span><span class="op" id="2238771">(</span><span class="op" id="2238772">&amp;</span><span class="ident" id="2238773">value</span><span class="op" id="2238778">[</span><span class="num" id="2238779">0</span><span class="op" id="2238780">]</span><span class="op" id="2238781">)</span><span class="op" id="2238782">,</span>&nbsp;<span class="op" id="2238784">&amp;</span><span class="ident" id="2238785">vallen</span><span class="op" id="2238791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238794">return</span>&nbsp;<span class="ident" id="2238801">value</span><span class="op" id="2238806">,</span>&nbsp;<span class="ident" id="2238808">err</span><br>
<span class="lineno"></span><span class="op" id="2238812">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="keyword" id="2238815">func</span>&nbsp;<span class="ident" id="2238820">GetsockoptIPMreq</span><span class="op" id="2238836">(</span><span class="ident" id="2238837">fd</span><span class="op" id="2238839">,</span>&nbsp;<span class="ident" id="2238841">level</span><span class="op" id="2238846">,</span>&nbsp;<span class="ident" id="2238848">opt</span>&nbsp;<span class="builtintype" id="2238852">int</span><span class="op" id="2238855">)</span>&nbsp;<span class="op" id="2238857">(</span><span class="op" id="2238858">*</span><span class="ident" id="2238859">IPMreq</span><span class="op" id="2238865">,</span>&nbsp;<span class="builtintype" id="2238867">error</span><span class="op" id="2238872">)</span>&nbsp;<span class="op" id="2238874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238877">var</span>&nbsp;<span class="ident" id="2238881">value</span>&nbsp;<span class="ident" id="2238887">IPMreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238895">vallen</span>&nbsp;<span class="op" id="2238902">:=</span>&nbsp;<span class="ident" id="2238905">_Socklen</span><span class="op" id="2238913">(</span><span class="ident" id="2238914">SizeofIPMreq</span><span class="op" id="2238926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2238929">err</span>&nbsp;<span class="op" id="2238933">:=</span>&nbsp;<span class="ident" id="2238936">getsockopt</span><span class="op" id="2238946">(</span><span class="ident" id="2238947">fd</span><span class="op" id="2238949">,</span>&nbsp;<span class="ident" id="2238951">level</span><span class="op" id="2238956">,</span>&nbsp;<span class="ident" id="2238958">opt</span><span class="op" id="2238961">,</span>&nbsp;<span class="ident" id="2238963">unsafe</span><span class="op" id="2238969">.</span><span class="ident" id="2238970">Pointer</span><span class="op" id="2238977">(</span><span class="op" id="2238978">&amp;</span><span class="ident" id="2238979">value</span><span class="op" id="2238984">)</span><span class="op" id="2238985">,</span>&nbsp;<span class="op" id="2238987">&amp;</span><span class="ident" id="2238988">vallen</span><span class="op" id="2238994">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2238997">return</span>&nbsp;<span class="op" id="2239004">&amp;</span><span class="ident" id="2239005">value</span><span class="op" id="2239010">,</span>&nbsp;<span class="ident" id="2239012">err</span><br>
<span class="lineno"></span><span class="op" id="2239016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239019">func</span>&nbsp;<span class="ident" id="2239024">GetsockoptIPMreqn</span><span class="op" id="2239041">(</span><span class="ident" id="2239042">fd</span><span class="op" id="2239044">,</span>&nbsp;<span class="ident" id="2239046">level</span><span class="op" id="2239051">,</span>&nbsp;<span class="ident" id="2239053">opt</span>&nbsp;<span class="builtintype" id="2239057">int</span><span class="op" id="2239060">)</span>&nbsp;<span class="op" id="2239062">(</span><span class="op" id="2239063">*</span><span class="ident" id="2239064">IPMreqn</span><span class="op" id="2239071">,</span>&nbsp;<span class="builtintype" id="2239073">error</span><span class="op" id="2239078">)</span>&nbsp;<span class="op" id="2239080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239083">var</span>&nbsp;<span class="ident" id="2239087">value</span>&nbsp;<span class="ident" id="2239093">IPMreqn</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239102">vallen</span>&nbsp;<span class="op" id="2239109">:=</span>&nbsp;<span class="ident" id="2239112">_Socklen</span><span class="op" id="2239120">(</span><span class="ident" id="2239121">SizeofIPMreqn</span><span class="op" id="2239134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239137">err</span>&nbsp;<span class="op" id="2239141">:=</span>&nbsp;<span class="ident" id="2239144">getsockopt</span><span class="op" id="2239154">(</span><span class="ident" id="2239155">fd</span><span class="op" id="2239157">,</span>&nbsp;<span class="ident" id="2239159">level</span><span class="op" id="2239164">,</span>&nbsp;<span class="ident" id="2239166">opt</span><span class="op" id="2239169">,</span>&nbsp;<span class="ident" id="2239171">unsafe</span><span class="op" id="2239177">.</span><span class="ident" id="2239178">Pointer</span><span class="op" id="2239185">(</span><span class="op" id="2239186">&amp;</span><span class="ident" id="2239187">value</span><span class="op" id="2239192">)</span><span class="op" id="2239193">,</span>&nbsp;<span class="op" id="2239195">&amp;</span><span class="ident" id="2239196">vallen</span><span class="op" id="2239202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239205">return</span>&nbsp;<span class="op" id="2239212">&amp;</span><span class="ident" id="2239213">value</span><span class="op" id="2239218">,</span>&nbsp;<span class="ident" id="2239220">err</span><br>
<span class="lineno"></span><span class="op" id="2239224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="keyword" id="2239227">func</span>&nbsp;<span class="ident" id="2239232">GetsockoptIPv6Mreq</span><span class="op" id="2239250">(</span><span class="ident" id="2239251">fd</span><span class="op" id="2239253">,</span>&nbsp;<span class="ident" id="2239255">level</span><span class="op" id="2239260">,</span>&nbsp;<span class="ident" id="2239262">opt</span>&nbsp;<span class="builtintype" id="2239266">int</span><span class="op" id="2239269">)</span>&nbsp;<span class="op" id="2239271">(</span><span class="op" id="2239272">*</span><span class="ident" id="2239273">IPv6Mreq</span><span class="op" id="2239281">,</span>&nbsp;<span class="builtintype" id="2239283">error</span><span class="op" id="2239288">)</span>&nbsp;<span class="op" id="2239290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239293">var</span>&nbsp;<span class="ident" id="2239297">value</span>&nbsp;<span class="ident" id="2239303">IPv6Mreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239313">vallen</span>&nbsp;<span class="op" id="2239320">:=</span>&nbsp;<span class="ident" id="2239323">_Socklen</span><span class="op" id="2239331">(</span><span class="ident" id="2239332">SizeofIPv6Mreq</span><span class="op" id="2239346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239349">err</span>&nbsp;<span class="op" id="2239353">:=</span>&nbsp;<span class="ident" id="2239356">getsockopt</span><span class="op" id="2239366">(</span><span class="ident" id="2239367">fd</span><span class="op" id="2239369">,</span>&nbsp;<span class="ident" id="2239371">level</span><span class="op" id="2239376">,</span>&nbsp;<span class="ident" id="2239378">opt</span><span class="op" id="2239381">,</span>&nbsp;<span class="ident" id="2239383">unsafe</span><span class="op" id="2239389">.</span><span class="ident" id="2239390">Pointer</span><span class="op" id="2239397">(</span><span class="op" id="2239398">&amp;</span><span class="ident" id="2239399">value</span><span class="op" id="2239404">)</span><span class="op" id="2239405">,</span>&nbsp;<span class="op" id="2239407">&amp;</span><span class="ident" id="2239408">vallen</span><span class="op" id="2239414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239417">return</span>&nbsp;<span class="op" id="2239424">&amp;</span><span class="ident" id="2239425">value</span><span class="op" id="2239430">,</span>&nbsp;<span class="ident" id="2239432">err</span><br>
<span class="lineno">470</span><span class="op" id="2239436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239439">func</span>&nbsp;<span class="ident" id="2239444">GetsockoptIPv6MTUInfo</span><span class="op" id="2239465">(</span><span class="ident" id="2239466">fd</span><span class="op" id="2239468">,</span>&nbsp;<span class="ident" id="2239470">level</span><span class="op" id="2239475">,</span>&nbsp;<span class="ident" id="2239477">opt</span>&nbsp;<span class="builtintype" id="2239481">int</span><span class="op" id="2239484">)</span>&nbsp;<span class="op" id="2239486">(</span><span class="op" id="2239487">*</span><span class="ident" id="2239488">IPv6MTUInfo</span><span class="op" id="2239499">,</span>&nbsp;<span class="builtintype" id="2239501">error</span><span class="op" id="2239506">)</span>&nbsp;<span class="op" id="2239508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239511">var</span>&nbsp;<span class="ident" id="2239515">value</span>&nbsp;<span class="ident" id="2239521">IPv6MTUInfo</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239534">vallen</span>&nbsp;<span class="op" id="2239541">:=</span>&nbsp;<span class="ident" id="2239544">_Socklen</span><span class="op" id="2239552">(</span><span class="ident" id="2239553">SizeofIPv6MTUInfo</span><span class="op" id="2239570">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239573">err</span>&nbsp;<span class="op" id="2239577">:=</span>&nbsp;<span class="ident" id="2239580">getsockopt</span><span class="op" id="2239590">(</span><span class="ident" id="2239591">fd</span><span class="op" id="2239593">,</span>&nbsp;<span class="ident" id="2239595">level</span><span class="op" id="2239600">,</span>&nbsp;<span class="ident" id="2239602">opt</span><span class="op" id="2239605">,</span>&nbsp;<span class="ident" id="2239607">unsafe</span><span class="op" id="2239613">.</span><span class="ident" id="2239614">Pointer</span><span class="op" id="2239621">(</span><span class="op" id="2239622">&amp;</span><span class="ident" id="2239623">value</span><span class="op" id="2239628">)</span><span class="op" id="2239629">,</span>&nbsp;<span class="op" id="2239631">&amp;</span><span class="ident" id="2239632">vallen</span><span class="op" id="2239638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239641">return</span>&nbsp;<span class="op" id="2239648">&amp;</span><span class="ident" id="2239649">value</span><span class="op" id="2239654">,</span>&nbsp;<span class="ident" id="2239656">err</span><br>
<span class="lineno"></span><span class="op" id="2239660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2239663">func</span>&nbsp;<span class="ident" id="2239668">GetsockoptICMPv6Filter</span><span class="op" id="2239690">(</span><span class="ident" id="2239691">fd</span><span class="op" id="2239693">,</span>&nbsp;<span class="ident" id="2239695">level</span><span class="op" id="2239700">,</span>&nbsp;<span class="ident" id="2239702">opt</span>&nbsp;<span class="builtintype" id="2239706">int</span><span class="op" id="2239709">)</span>&nbsp;<span class="op" id="2239711">(</span><span class="op" id="2239712">*</span><span class="ident" id="2239713">ICMPv6Filter</span><span class="op" id="2239725">,</span>&nbsp;<span class="builtintype" id="2239727">error</span><span class="op" id="2239732">)</span>&nbsp;<span class="op" id="2239734">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239737">var</span>&nbsp;<span class="ident" id="2239741">value</span>&nbsp;<span class="ident" id="2239747">ICMPv6Filter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239761">vallen</span>&nbsp;<span class="op" id="2239768">:=</span>&nbsp;<span class="ident" id="2239771">_Socklen</span><span class="op" id="2239779">(</span><span class="ident" id="2239780">SizeofICMPv6Filter</span><span class="op" id="2239798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239801">err</span>&nbsp;<span class="op" id="2239805">:=</span>&nbsp;<span class="ident" id="2239808">getsockopt</span><span class="op" id="2239818">(</span><span class="ident" id="2239819">fd</span><span class="op" id="2239821">,</span>&nbsp;<span class="ident" id="2239823">level</span><span class="op" id="2239828">,</span>&nbsp;<span class="ident" id="2239830">opt</span><span class="op" id="2239833">,</span>&nbsp;<span class="ident" id="2239835">unsafe</span><span class="op" id="2239841">.</span><span class="ident" id="2239842">Pointer</span><span class="op" id="2239849">(</span><span class="op" id="2239850">&amp;</span><span class="ident" id="2239851">value</span><span class="op" id="2239856">)</span><span class="op" id="2239857">,</span>&nbsp;<span class="op" id="2239859">&amp;</span><span class="ident" id="2239860">vallen</span><span class="op" id="2239866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239869">return</span>&nbsp;<span class="op" id="2239876">&amp;</span><span class="ident" id="2239877">value</span><span class="op" id="2239882">,</span>&nbsp;<span class="ident" id="2239884">err</span><br>
<span class="lineno"></span><span class="op" id="2239888">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="2239891">func</span>&nbsp;<span class="ident" id="2239896">GetsockoptUcred</span><span class="op" id="2239911">(</span><span class="ident" id="2239912">fd</span><span class="op" id="2239914">,</span>&nbsp;<span class="ident" id="2239916">level</span><span class="op" id="2239921">,</span>&nbsp;<span class="ident" id="2239923">opt</span>&nbsp;<span class="builtintype" id="2239927">int</span><span class="op" id="2239930">)</span>&nbsp;<span class="op" id="2239932">(</span><span class="op" id="2239933">*</span><span class="ident" id="2239934">Ucred</span><span class="op" id="2239939">,</span>&nbsp;<span class="builtintype" id="2239941">error</span><span class="op" id="2239946">)</span>&nbsp;<span class="op" id="2239948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2239951">var</span>&nbsp;<span class="ident" id="2239955">value</span>&nbsp;<span class="ident" id="2239961">Ucred</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2239968">vallen</span>&nbsp;<span class="op" id="2239975">:=</span>&nbsp;<span class="ident" id="2239978">_Socklen</span><span class="op" id="2239986">(</span><span class="ident" id="2239987">SizeofUcred</span><span class="op" id="2239998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240001">err</span>&nbsp;<span class="op" id="2240005">:=</span>&nbsp;<span class="ident" id="2240008">getsockopt</span><span class="op" id="2240018">(</span><span class="ident" id="2240019">fd</span><span class="op" id="2240021">,</span>&nbsp;<span class="ident" id="2240023">level</span><span class="op" id="2240028">,</span>&nbsp;<span class="ident" id="2240030">opt</span><span class="op" id="2240033">,</span>&nbsp;<span class="ident" id="2240035">unsafe</span><span class="op" id="2240041">.</span><span class="ident" id="2240042">Pointer</span><span class="op" id="2240049">(</span><span class="op" id="2240050">&amp;</span><span class="ident" id="2240051">value</span><span class="op" id="2240056">)</span><span class="op" id="2240057">,</span>&nbsp;<span class="op" id="2240059">&amp;</span><span class="ident" id="2240060">vallen</span><span class="op" id="2240066">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240069">return</span>&nbsp;<span class="op" id="2240076">&amp;</span><span class="ident" id="2240077">value</span><span class="op" id="2240082">,</span>&nbsp;<span class="ident" id="2240084">err</span><br>
<span class="lineno"></span><span class="op" id="2240088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240091">func</span>&nbsp;<span class="ident" id="2240096">SetsockoptIPMreqn</span><span class="op" id="2240113">(</span><span class="ident" id="2240114">fd</span><span class="op" id="2240116">,</span>&nbsp;<span class="ident" id="2240118">level</span><span class="op" id="2240123">,</span>&nbsp;<span class="ident" id="2240125">opt</span>&nbsp;<span class="builtintype" id="2240129">int</span><span class="op" id="2240132">,</span>&nbsp;<span class="ident" id="2240134">mreq</span>&nbsp;<span class="op" id="2240139">*</span><span class="ident" id="2240140">IPMreqn</span><span class="op" id="2240147">)</span>&nbsp;<span class="op" id="2240149">(</span><span class="ident" id="2240150">err</span>&nbsp;<span class="builtintype" id="2240154">error</span><span class="op" id="2240159">)</span>&nbsp;<span class="op" id="2240161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240164">return</span>&nbsp;<span class="ident" id="2240171">setsockopt</span><span class="op" id="2240181">(</span><span class="ident" id="2240182">fd</span><span class="op" id="2240184">,</span>&nbsp;<span class="ident" id="2240186">level</span><span class="op" id="2240191">,</span>&nbsp;<span class="ident" id="2240193">opt</span><span class="op" id="2240196">,</span>&nbsp;<span class="ident" id="2240198">unsafe</span><span class="op" id="2240204">.</span><span class="ident" id="2240205">Pointer</span><span class="op" id="2240212">(</span><span class="ident" id="2240213">mreq</span><span class="op" id="2240217">)</span><span class="op" id="2240218">,</span>&nbsp;<span class="ident" id="2240220">unsafe</span><span class="op" id="2240226">.</span><span class="ident" id="2240227">Sizeof</span><span class="op" id="2240233">(</span><span class="op" id="2240234">*</span><span class="ident" id="2240235">mreq</span><span class="op" id="2240239">)</span><span class="op" id="2240240">)</span><br>
<span class="lineno">495</span><span class="op" id="2240242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2240245">func</span>&nbsp;<span class="ident" id="2240250">Recvmsg</span><span class="op" id="2240257">(</span><span class="ident" id="2240258">fd</span>&nbsp;<span class="builtintype" id="2240261">int</span><span class="op" id="2240264">,</span>&nbsp;<span class="ident" id="2240266">p</span><span class="op" id="2240267">,</span>&nbsp;<span class="ident" id="2240269">oob</span>&nbsp;<span class="op" id="2240273">[</span><span class="op" id="2240274">]</span><span class="builtintype" id="2240275">byte</span><span class="op" id="2240279">,</span>&nbsp;<span class="ident" id="2240281">flags</span>&nbsp;<span class="builtintype" id="2240287">int</span><span class="op" id="2240290">)</span>&nbsp;<span class="op" id="2240292">(</span><span class="ident" id="2240293">n</span><span class="op" id="2240294">,</span>&nbsp;<span class="ident" id="2240296">oobn</span>&nbsp;<span class="builtintype" id="2240301">int</span><span class="op" id="2240304">,</span>&nbsp;<span class="ident" id="2240306">recvflags</span>&nbsp;<span class="builtintype" id="2240316">int</span><span class="op" id="2240319">,</span>&nbsp;<span class="ident" id="2240321">from</span>&nbsp;<span class="ident" id="2240326">Sockaddr</span><span class="op" id="2240334">,</span>&nbsp;<span class="ident" id="2240336">err</span>&nbsp;<span class="builtintype" id="2240340">error</span><span class="op" id="2240345">)</span>&nbsp;<span class="op" id="2240347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240350">var</span>&nbsp;<span class="ident" id="2240354">msg</span>&nbsp;<span class="ident" id="2240358">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240366">var</span>&nbsp;<span class="ident" id="2240370">rsa</span>&nbsp;<span class="ident" id="2240374">RawSockaddrAny</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240390">msg</span><span class="op" id="2240393">.</span><span class="ident" id="2240394">Name</span>&nbsp;<span class="op" id="2240399">=</span>&nbsp;<span class="op" id="2240401">(</span><span class="op" id="2240402">*</span><span class="builtintype" id="2240403">byte</span><span class="op" id="2240407">)</span><span class="op" id="2240408">(</span><span class="ident" id="2240409">unsafe</span><span class="op" id="2240415">.</span><span class="ident" id="2240416">Pointer</span><span class="op" id="2240423">(</span><span class="op" id="2240424">&amp;</span><span class="ident" id="2240425">rsa</span><span class="op" id="2240428">)</span><span class="op" id="2240429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240432">msg</span><span class="op" id="2240435">.</span><span class="ident" id="2240436">Namelen</span>&nbsp;<span class="op" id="2240444">=</span>&nbsp;<span class="builtintype" id="2240446">uint32</span><span class="op" id="2240452">(</span><span class="ident" id="2240453">SizeofSockaddrAny</span><span class="op" id="2240470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240473">var</span>&nbsp;<span class="ident" id="2240477">iov</span>&nbsp;<span class="ident" id="2240481">Iovec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240488">if</span>&nbsp;<span class="builtinfunc" id="2240491">len</span><span class="op" id="2240494">(</span><span class="ident" id="2240495">p</span><span class="op" id="2240496">)</span>&nbsp;<span class="op" id="2240498">&gt;</span>&nbsp;<span class="num" id="2240500">0</span>&nbsp;<span class="op" id="2240502">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240506">iov</span><span class="op" id="2240509">.</span><span class="ident" id="2240510">Base</span>&nbsp;<span class="op" id="2240515">=</span>&nbsp;<span class="op" id="2240517">(</span><span class="op" id="2240518">*</span><span class="builtintype" id="2240519">byte</span><span class="op" id="2240523">)</span><span class="op" id="2240524">(</span><span class="ident" id="2240525">unsafe</span><span class="op" id="2240531">.</span><span class="ident" id="2240532">Pointer</span><span class="op" id="2240539">(</span><span class="op" id="2240540">&amp;</span><span class="ident" id="2240541">p</span><span class="op" id="2240542">[</span><span class="num" id="2240543">0</span><span class="op" id="2240544">]</span><span class="op" id="2240545">)</span><span class="op" id="2240546">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240550">iov</span><span class="op" id="2240553">.</span><span class="ident" id="2240554">SetLen</span><span class="op" id="2240560">(</span><span class="builtinfunc" id="2240561">len</span><span class="op" id="2240564">(</span><span class="ident" id="2240565">p</span><span class="op" id="2240566">)</span><span class="op" id="2240567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240573">var</span>&nbsp;<span class="ident" id="2240577">dummy</span>&nbsp;<span class="builtintype" id="2240583">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240589">if</span>&nbsp;<span class="builtinfunc" id="2240592">len</span><span class="op" id="2240595">(</span><span class="ident" id="2240596">oob</span><span class="op" id="2240599">)</span>&nbsp;<span class="op" id="2240601">&gt;</span>&nbsp;<span class="num" id="2240603">0</span>&nbsp;<span class="op" id="2240605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240609">//&nbsp;receive&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240647">if</span>&nbsp;<span class="builtinfunc" id="2240650">len</span><span class="op" id="2240653">(</span><span class="ident" id="2240654">p</span><span class="op" id="2240655">)</span>&nbsp;<span class="op" id="2240657">==</span>&nbsp;<span class="num" id="2240660">0</span>&nbsp;<span class="op" id="2240662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240667">iov</span><span class="op" id="2240670">.</span><span class="ident" id="2240671">Base</span>&nbsp;<span class="op" id="2240676">=</span>&nbsp;<span class="op" id="2240678">&amp;</span><span class="ident" id="2240679">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240688">iov</span><span class="op" id="2240691">.</span><span class="ident" id="2240692">SetLen</span><span class="op" id="2240698">(</span><span class="num" id="2240699">1</span><span class="op" id="2240700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240708">msg</span><span class="op" id="2240711">.</span><span class="ident" id="2240712">Control</span>&nbsp;<span class="op" id="2240720">=</span>&nbsp;<span class="op" id="2240722">(</span><span class="op" id="2240723">*</span><span class="builtintype" id="2240724">byte</span><span class="op" id="2240728">)</span><span class="op" id="2240729">(</span><span class="ident" id="2240730">unsafe</span><span class="op" id="2240736">.</span><span class="ident" id="2240737">Pointer</span><span class="op" id="2240744">(</span><span class="op" id="2240745">&amp;</span><span class="ident" id="2240746">oob</span><span class="op" id="2240749">[</span><span class="num" id="2240750">0</span><span class="op" id="2240751">]</span><span class="op" id="2240752">)</span><span class="op" id="2240753">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240757">msg</span><span class="op" id="2240760">.</span><span class="ident" id="2240761">SetControllen</span><span class="op" id="2240774">(</span><span class="builtinfunc" id="2240775">len</span><span class="op" id="2240778">(</span><span class="ident" id="2240779">oob</span><span class="op" id="2240782">)</span><span class="op" id="2240783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240786">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240789">msg</span><span class="op" id="2240792">.</span><span class="ident" id="2240793">Iov</span>&nbsp;<span class="op" id="2240797">=</span>&nbsp;<span class="op" id="2240799">&amp;</span><span class="ident" id="2240800">iov</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240805">msg</span><span class="op" id="2240808">.</span><span class="ident" id="2240809">Iovlen</span>&nbsp;<span class="op" id="2240816">=</span>&nbsp;<span class="num" id="2240818">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240821">if</span>&nbsp;<span class="ident" id="2240824">n</span><span class="op" id="2240825">,</span>&nbsp;<span class="ident" id="2240827">err</span>&nbsp;<span class="op" id="2240831">=</span>&nbsp;<span class="ident" id="2240833">recvmsg</span><span class="op" id="2240840">(</span><span class="ident" id="2240841">fd</span><span class="op" id="2240843">,</span>&nbsp;<span class="op" id="2240845">&amp;</span><span class="ident" id="2240846">msg</span><span class="op" id="2240849">,</span>&nbsp;<span class="ident" id="2240851">flags</span><span class="op" id="2240856">)</span><span class="op" id="2240857">;</span>&nbsp;<span class="ident" id="2240859">err</span>&nbsp;<span class="op" id="2240863">!=</span>&nbsp;<span class="ident" id="2240866">nil</span>&nbsp;<span class="op" id="2240870">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2240874">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2240882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240885">oobn</span>&nbsp;<span class="op" id="2240890">=</span>&nbsp;<span class="builtintype" id="2240892">int</span><span class="op" id="2240895">(</span><span class="ident" id="2240896">msg</span><span class="op" id="2240899">.</span><span class="ident" id="2240900">Controllen</span><span class="op" id="2240910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2240913">recvflags</span>&nbsp;<span class="op" id="2240923">=</span>&nbsp;<span class="builtintype" id="2240925">int</span><span class="op" id="2240928">(</span><span class="ident" id="2240929">msg</span><span class="op" id="2240932">.</span><span class="ident" id="2240933">Flags</span><span class="op" id="2240938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2240941">//&nbsp;source&nbsp;address&nbsp;is&nbsp;only&nbsp;specified&nbsp;if&nbsp;the&nbsp;socket&nbsp;is&nbsp;unconnected</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241007">if</span>&nbsp;<span class="ident" id="2241010">rsa</span><span class="op" id="2241013">.</span><span class="ident" id="2241014">Addr</span><span class="op" id="2241018">.</span><span class="ident" id="2241019">Family</span>&nbsp;<span class="op" id="2241026">!=</span>&nbsp;<span class="ident" id="2241029">AF_UNSPEC</span>&nbsp;<span class="op" id="2241039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241043">from</span><span class="op" id="2241047">,</span>&nbsp;<span class="ident" id="2241049">err</span>&nbsp;<span class="op" id="2241053">=</span>&nbsp;<span class="ident" id="2241055">anyToSockaddr</span><span class="op" id="2241068">(</span><span class="op" id="2241069">&amp;</span><span class="ident" id="2241070">rsa</span><span class="op" id="2241073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241079">return</span><br>
<span class="lineno"></span><span class="op" id="2241086">}</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span><span class="keyword" id="2241089">func</span>&nbsp;<span class="ident" id="2241094">Sendmsg</span><span class="op" id="2241101">(</span><span class="ident" id="2241102">fd</span>&nbsp;<span class="builtintype" id="2241105">int</span><span class="op" id="2241108">,</span>&nbsp;<span class="ident" id="2241110">p</span><span class="op" id="2241111">,</span>&nbsp;<span class="ident" id="2241113">oob</span>&nbsp;<span class="op" id="2241117">[</span><span class="op" id="2241118">]</span><span class="builtintype" id="2241119">byte</span><span class="op" id="2241123">,</span>&nbsp;<span class="ident" id="2241125">to</span>&nbsp;<span class="ident" id="2241128">Sockaddr</span><span class="op" id="2241136">,</span>&nbsp;<span class="ident" id="2241138">flags</span>&nbsp;<span class="builtintype" id="2241144">int</span><span class="op" id="2241147">)</span>&nbsp;<span class="op" id="2241149">(</span><span class="ident" id="2241150">err</span>&nbsp;<span class="builtintype" id="2241154">error</span><span class="op" id="2241159">)</span>&nbsp;<span class="op" id="2241161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241164">_</span><span class="op" id="2241165">,</span>&nbsp;<span class="ident" id="2241167">err</span>&nbsp;<span class="op" id="2241171">=</span>&nbsp;<span class="ident" id="2241173">SendmsgN</span><span class="op" id="2241181">(</span><span class="ident" id="2241182">fd</span><span class="op" id="2241184">,</span>&nbsp;<span class="ident" id="2241186">p</span><span class="op" id="2241187">,</span>&nbsp;<span class="ident" id="2241189">oob</span><span class="op" id="2241192">,</span>&nbsp;<span class="ident" id="2241194">to</span><span class="op" id="2241196">,</span>&nbsp;<span class="ident" id="2241198">flags</span><span class="op" id="2241203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241206">return</span><br>
<span class="lineno"></span><span class="op" id="2241213">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="2241216">func</span>&nbsp;<span class="ident" id="2241221">SendmsgN</span><span class="op" id="2241229">(</span><span class="ident" id="2241230">fd</span>&nbsp;<span class="builtintype" id="2241233">int</span><span class="op" id="2241236">,</span>&nbsp;<span class="ident" id="2241238">p</span><span class="op" id="2241239">,</span>&nbsp;<span class="ident" id="2241241">oob</span>&nbsp;<span class="op" id="2241245">[</span><span class="op" id="2241246">]</span><span class="builtintype" id="2241247">byte</span><span class="op" id="2241251">,</span>&nbsp;<span class="ident" id="2241253">to</span>&nbsp;<span class="ident" id="2241256">Sockaddr</span><span class="op" id="2241264">,</span>&nbsp;<span class="ident" id="2241266">flags</span>&nbsp;<span class="builtintype" id="2241272">int</span><span class="op" id="2241275">)</span>&nbsp;<span class="op" id="2241277">(</span><span class="ident" id="2241278">n</span>&nbsp;<span class="builtintype" id="2241280">int</span><span class="op" id="2241283">,</span>&nbsp;<span class="ident" id="2241285">err</span>&nbsp;<span class="builtintype" id="2241289">error</span><span class="op" id="2241294">)</span>&nbsp;<span class="op" id="2241296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241299">var</span>&nbsp;<span class="ident" id="2241303">ptr</span>&nbsp;<span class="ident" id="2241307">unsafe</span><span class="op" id="2241313">.</span><span class="ident" id="2241314">Pointer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241323">var</span>&nbsp;<span class="ident" id="2241327">salen</span>&nbsp;<span class="ident" id="2241333">_Socklen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241343">if</span>&nbsp;<span class="ident" id="2241346">to</span>&nbsp;<span class="op" id="2241349">!=</span>&nbsp;<span class="ident" id="2241352">nil</span>&nbsp;<span class="op" id="2241356">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241360">var</span>&nbsp;<span class="ident" id="2241364">err</span>&nbsp;<span class="builtintype" id="2241368">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241376">ptr</span><span class="op" id="2241379">,</span>&nbsp;<span class="ident" id="2241381">salen</span><span class="op" id="2241386">,</span>&nbsp;<span class="ident" id="2241388">err</span>&nbsp;<span class="op" id="2241392">=</span>&nbsp;<span class="ident" id="2241394">to</span><span class="op" id="2241396">.</span><span class="ident" id="2241397">sockaddr</span><span class="op" id="2241405">(</span><span class="op" id="2241406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241410">if</span>&nbsp;<span class="ident" id="2241413">err</span>&nbsp;<span class="op" id="2241417">!=</span>&nbsp;<span class="ident" id="2241420">nil</span>&nbsp;<span class="op" id="2241424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241429">return</span>&nbsp;<span class="num" id="2241436">0</span><span class="op" id="2241437">,</span>&nbsp;<span class="ident" id="2241439">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241445">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241451">var</span>&nbsp;<span class="ident" id="2241455">msg</span>&nbsp;<span class="ident" id="2241459">Msghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241467">msg</span><span class="op" id="2241470">.</span><span class="ident" id="2241471">Name</span>&nbsp;<span class="op" id="2241476">=</span>&nbsp;<span class="op" id="2241478">(</span><span class="op" id="2241479">*</span><span class="builtintype" id="2241480">byte</span><span class="op" id="2241484">)</span><span class="op" id="2241485">(</span><span class="ident" id="2241486">unsafe</span><span class="op" id="2241492">.</span><span class="ident" id="2241493">Pointer</span><span class="op" id="2241500">(</span><span class="ident" id="2241501">ptr</span><span class="op" id="2241504">)</span><span class="op" id="2241505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241508">msg</span><span class="op" id="2241511">.</span><span class="ident" id="2241512">Namelen</span>&nbsp;<span class="op" id="2241520">=</span>&nbsp;<span class="builtintype" id="2241522">uint32</span><span class="op" id="2241528">(</span><span class="ident" id="2241529">salen</span><span class="op" id="2241534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241537">var</span>&nbsp;<span class="ident" id="2241541">iov</span>&nbsp;<span class="ident" id="2241545">Iovec</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241552">if</span>&nbsp;<span class="builtinfunc" id="2241555">len</span><span class="op" id="2241558">(</span><span class="ident" id="2241559">p</span><span class="op" id="2241560">)</span>&nbsp;<span class="op" id="2241562">&gt;</span>&nbsp;<span class="num" id="2241564">0</span>&nbsp;<span class="op" id="2241566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241570">iov</span><span class="op" id="2241573">.</span><span class="ident" id="2241574">Base</span>&nbsp;<span class="op" id="2241579">=</span>&nbsp;<span class="op" id="2241581">(</span><span class="op" id="2241582">*</span><span class="builtintype" id="2241583">byte</span><span class="op" id="2241587">)</span><span class="op" id="2241588">(</span><span class="ident" id="2241589">unsafe</span><span class="op" id="2241595">.</span><span class="ident" id="2241596">Pointer</span><span class="op" id="2241603">(</span><span class="op" id="2241604">&amp;</span><span class="ident" id="2241605">p</span><span class="op" id="2241606">[</span><span class="num" id="2241607">0</span><span class="op" id="2241608">]</span><span class="op" id="2241609">)</span><span class="op" id="2241610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241614">iov</span><span class="op" id="2241617">.</span><span class="ident" id="2241618">SetLen</span><span class="op" id="2241624">(</span><span class="builtinfunc" id="2241625">len</span><span class="op" id="2241628">(</span><span class="ident" id="2241629">p</span><span class="op" id="2241630">)</span><span class="op" id="2241631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241637">var</span>&nbsp;<span class="ident" id="2241641">dummy</span>&nbsp;<span class="builtintype" id="2241647">byte</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241653">if</span>&nbsp;<span class="builtinfunc" id="2241656">len</span><span class="op" id="2241659">(</span><span class="ident" id="2241660">oob</span><span class="op" id="2241663">)</span>&nbsp;<span class="op" id="2241665">&gt;</span>&nbsp;<span class="num" id="2241667">0</span>&nbsp;<span class="op" id="2241669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2241673">//&nbsp;send&nbsp;at&nbsp;least&nbsp;one&nbsp;normal&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241708">if</span>&nbsp;<span class="builtinfunc" id="2241711">len</span><span class="op" id="2241714">(</span><span class="ident" id="2241715">p</span><span class="op" id="2241716">)</span>&nbsp;<span class="op" id="2241718">==</span>&nbsp;<span class="num" id="2241721">0</span>&nbsp;<span class="op" id="2241723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241728">iov</span><span class="op" id="2241731">.</span><span class="ident" id="2241732">Base</span>&nbsp;<span class="op" id="2241737">=</span>&nbsp;<span class="op" id="2241739">&amp;</span><span class="ident" id="2241740">dummy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241749">iov</span><span class="op" id="2241752">.</span><span class="ident" id="2241753">SetLen</span><span class="op" id="2241759">(</span><span class="num" id="2241760">1</span><span class="op" id="2241761">)</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241769">msg</span><span class="op" id="2241772">.</span><span class="ident" id="2241773">Control</span>&nbsp;<span class="op" id="2241781">=</span>&nbsp;<span class="op" id="2241783">(</span><span class="op" id="2241784">*</span><span class="builtintype" id="2241785">byte</span><span class="op" id="2241789">)</span><span class="op" id="2241790">(</span><span class="ident" id="2241791">unsafe</span><span class="op" id="2241797">.</span><span class="ident" id="2241798">Pointer</span><span class="op" id="2241805">(</span><span class="op" id="2241806">&amp;</span><span class="ident" id="2241807">oob</span><span class="op" id="2241810">[</span><span class="num" id="2241811">0</span><span class="op" id="2241812">]</span><span class="op" id="2241813">)</span><span class="op" id="2241814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241818">msg</span><span class="op" id="2241821">.</span><span class="ident" id="2241822">SetControllen</span><span class="op" id="2241835">(</span><span class="builtinfunc" id="2241836">len</span><span class="op" id="2241839">(</span><span class="ident" id="2241840">oob</span><span class="op" id="2241843">)</span><span class="op" id="2241844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241850">msg</span><span class="op" id="2241853">.</span><span class="ident" id="2241854">Iov</span>&nbsp;<span class="op" id="2241858">=</span>&nbsp;<span class="op" id="2241860">&amp;</span><span class="ident" id="2241861">iov</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241866">msg</span><span class="op" id="2241869">.</span><span class="ident" id="2241870">Iovlen</span>&nbsp;<span class="op" id="2241877">=</span>&nbsp;<span class="num" id="2241879">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241882">if</span>&nbsp;<span class="ident" id="2241885">n</span><span class="op" id="2241886">,</span>&nbsp;<span class="ident" id="2241888">err</span>&nbsp;<span class="op" id="2241892">=</span>&nbsp;<span class="ident" id="2241894">sendmsg</span><span class="op" id="2241901">(</span><span class="ident" id="2241902">fd</span><span class="op" id="2241904">,</span>&nbsp;<span class="op" id="2241906">&amp;</span><span class="ident" id="2241907">msg</span><span class="op" id="2241910">,</span>&nbsp;<span class="ident" id="2241912">flags</span><span class="op" id="2241917">)</span><span class="op" id="2241918">;</span>&nbsp;<span class="ident" id="2241920">err</span>&nbsp;<span class="op" id="2241924">!=</span>&nbsp;<span class="ident" id="2241927">nil</span>&nbsp;<span class="op" id="2241931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241935">return</span>&nbsp;<span class="num" id="2241942">0</span><span class="op" id="2241943">,</span>&nbsp;<span class="ident" id="2241945">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241953">if</span>&nbsp;<span class="builtinfunc" id="2241956">len</span><span class="op" id="2241959">(</span><span class="ident" id="2241960">oob</span><span class="op" id="2241963">)</span>&nbsp;<span class="op" id="2241965">&gt;</span>&nbsp;<span class="num" id="2241967">0</span>&nbsp;<span class="op" id="2241969">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2241972">len</span><span class="op" id="2241975">(</span><span class="ident" id="2241976">p</span><span class="op" id="2241977">)</span>&nbsp;<span class="op" id="2241979">==</span>&nbsp;<span class="num" id="2241982">0</span>&nbsp;<span class="op" id="2241984">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2241988">n</span>&nbsp;<span class="op" id="2241990">=</span>&nbsp;<span class="num" id="2241992">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2241995">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2241998">return</span>&nbsp;<span class="ident" id="2242005">n</span><span class="op" id="2242006">,</span>&nbsp;<span class="ident" id="2242008">nil</span><br>
<span class="lineno"></span><span class="op" id="2242012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">575</span><span class="comment" id="2242015">//&nbsp;BindToDevice&nbsp;binds&nbsp;the&nbsp;socket&nbsp;associated&nbsp;with&nbsp;fd&nbsp;to&nbsp;device.</span><br>
<span class="lineno"></span><span class="keyword" id="2242078">func</span>&nbsp;<span class="ident" id="2242083">BindToDevice</span><span class="op" id="2242095">(</span><span class="ident" id="2242096">fd</span>&nbsp;<span class="builtintype" id="2242099">int</span><span class="op" id="2242102">,</span>&nbsp;<span class="ident" id="2242104">device</span>&nbsp;<span class="builtintype" id="2242111">string</span><span class="op" id="2242117">)</span>&nbsp;<span class="op" id="2242119">(</span><span class="ident" id="2242120">err</span>&nbsp;<span class="builtintype" id="2242124">error</span><span class="op" id="2242129">)</span>&nbsp;<span class="op" id="2242131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242134">return</span>&nbsp;<span class="ident" id="2242141">SetsockoptString</span><span class="op" id="2242157">(</span><span class="ident" id="2242158">fd</span><span class="op" id="2242160">,</span>&nbsp;<span class="ident" id="2242162">SOL_SOCKET</span><span class="op" id="2242172">,</span>&nbsp;<span class="ident" id="2242174">SO_BINDTODEVICE</span><span class="op" id="2242189">,</span>&nbsp;<span class="ident" id="2242191">device</span><span class="op" id="2242197">)</span><br>
<span class="lineno"></span><span class="op" id="2242199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span><span class="comment" id="2242202">//sys&nbsp;&nbsp;&nbsp;&nbspptrace(request&nbsp;int,&nbsp;pid&nbsp;int,&nbsp;addr&nbsp;uintptr,&nbsp;data&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2242278">func</span>&nbsp;<span class="ident" id="2242283">ptracePeek</span><span class="op" id="2242293">(</span><span class="ident" id="2242294">req</span>&nbsp;<span class="builtintype" id="2242298">int</span><span class="op" id="2242301">,</span>&nbsp;<span class="ident" id="2242303">pid</span>&nbsp;<span class="builtintype" id="2242307">int</span><span class="op" id="2242310">,</span>&nbsp;<span class="ident" id="2242312">addr</span>&nbsp;<span class="builtintype" id="2242317">uintptr</span><span class="op" id="2242324">,</span>&nbsp;<span class="ident" id="2242326">out</span>&nbsp;<span class="op" id="2242330">[</span><span class="op" id="2242331">]</span><span class="builtintype" id="2242332">byte</span><span class="op" id="2242336">)</span>&nbsp;<span class="op" id="2242338">(</span><span class="ident" id="2242339">count</span>&nbsp;<span class="builtintype" id="2242345">int</span><span class="op" id="2242348">,</span>&nbsp;<span class="ident" id="2242350">err</span>&nbsp;<span class="builtintype" id="2242354">error</span><span class="op" id="2242359">)</span>&nbsp;<span class="op" id="2242361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242364">//&nbsp;The&nbsp;peek&nbsp;requests&nbsp;are&nbsp;machine-size&nbsp;oriented,&nbsp;so&nbsp;we&nbsp;wrap&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242427">//&nbsp;to&nbsp;retrieve&nbsp;arbitrary-length&nbsp;data.</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242467">//&nbsp;The&nbsp;ptrace&nbsp;syscall&nbsp;differs&nbsp;from&nbsp;glibc&#39;s&nbsp;ptrace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242519">//&nbsp;Peeks&nbsp;returns&nbsp;the&nbsp;word&nbsp;in&nbsp;*data,&nbsp;not&nbsp;as&nbsp;the&nbsp;return&nbsp;value.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242582">var</span>&nbsp;<span class="ident" id="2242586">buf</span>&nbsp;<span class="op" id="2242590">[</span><span class="ident" id="2242591">sizeofPtr</span><span class="op" id="2242600">]</span><span class="builtintype" id="2242601">byte</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242608">//&nbsp;Leading&nbsp;edge.&nbsp;&nbsp;PEEKTEXT/PEEKDATA&nbsp;don&#39;t&nbsp;require&nbsp;aligned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242667">//&nbsp;access&nbsp;(PEEKUSER&nbsp;warns&nbsp;that&nbsp;it&nbsp;might),&nbsp;but&nbsp;if&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242726">//&nbsp;align&nbsp;our&nbsp;reads,&nbsp;we&nbsp;might&nbsp;straddle&nbsp;an&nbsp;unmapped&nbsp;page</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242782">//&nbsp;boundary&nbsp;and&nbsp;not&nbsp;get&nbsp;the&nbsp;bytes&nbsp;leading&nbsp;up&nbsp;to&nbsp;the&nbsp;page</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2242840">//&nbsp;boundary.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242854">n</span>&nbsp;<span class="op" id="2242856">:=</span>&nbsp;<span class="num" id="2242859">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242862">if</span>&nbsp;<span class="ident" id="2242865">addr</span><span class="op" id="2242869">%</span><span class="ident" id="2242870">sizeofPtr</span>&nbsp;<span class="op" id="2242880">!=</span>&nbsp;<span class="num" id="2242883">0</span>&nbsp;<span class="op" id="2242885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2242889">err</span>&nbsp;<span class="op" id="2242893">=</span>&nbsp;<span class="ident" id="2242895">ptrace</span><span class="op" id="2242901">(</span><span class="ident" id="2242902">req</span><span class="op" id="2242905">,</span>&nbsp;<span class="ident" id="2242907">pid</span><span class="op" id="2242910">,</span>&nbsp;<span class="ident" id="2242912">addr</span><span class="op" id="2242916">-</span><span class="ident" id="2242917">addr</span><span class="op" id="2242921">%</span><span class="ident" id="2242922">sizeofPtr</span><span class="op" id="2242931">,</span>&nbsp;<span class="builtintype" id="2242933">uintptr</span><span class="op" id="2242940">(</span><span class="ident" id="2242941">unsafe</span><span class="op" id="2242947">.</span><span class="ident" id="2242948">Pointer</span><span class="op" id="2242955">(</span><span class="op" id="2242956">&amp;</span><span class="ident" id="2242957">buf</span><span class="op" id="2242960">[</span><span class="num" id="2242961">0</span><span class="op" id="2242962">]</span><span class="op" id="2242963">)</span><span class="op" id="2242964">)</span><span class="op" id="2242965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242969">if</span>&nbsp;<span class="ident" id="2242972">err</span>&nbsp;<span class="op" id="2242976">!=</span>&nbsp;<span class="ident" id="2242979">nil</span>&nbsp;<span class="op" id="2242983">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2242988">return</span>&nbsp;<span class="num" id="2242995">0</span><span class="op" id="2242996">,</span>&nbsp;<span class="ident" id="2242998">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243008">n</span>&nbsp;<span class="op" id="2243010">+=</span>&nbsp;<span class="builtinfunc" id="2243013">copy</span><span class="op" id="2243017">(</span><span class="ident" id="2243018">out</span><span class="op" id="2243021">,</span>&nbsp;<span class="ident" id="2243023">buf</span><span class="op" id="2243026">[</span><span class="ident" id="2243027">addr</span><span class="op" id="2243031">%</span><span class="ident" id="2243032">sizeofPtr</span><span class="op" id="2243041">:</span><span class="op" id="2243042">]</span><span class="op" id="2243043">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243047">out</span>&nbsp;<span class="op" id="2243051">=</span>&nbsp;<span class="ident" id="2243053">out</span><span class="op" id="2243056">[</span><span class="ident" id="2243057">n</span><span class="op" id="2243058">:</span><span class="op" id="2243059">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243062">}</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243066">//&nbsp;Remainder.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243081">for</span>&nbsp;<span class="builtinfunc" id="2243085">len</span><span class="op" id="2243088">(</span><span class="ident" id="2243089">out</span><span class="op" id="2243092">)</span>&nbsp;<span class="op" id="2243094">&gt;</span>&nbsp;<span class="num" id="2243096">0</span>&nbsp;<span class="op" id="2243098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243102">//&nbsp;We&nbsp;use&nbsp;an&nbsp;internal&nbsp;buffer&nbsp;to&nbsp;guarantee&nbsp;alignment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243157">//&nbsp;It&#39;s&nbsp;not&nbsp;documented&nbsp;if&nbsp;this&nbsp;is&nbsp;necessary,&nbsp;but&nbsp;we&#39;re&nbsp;paranoid.</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243224">err</span>&nbsp;<span class="op" id="2243228">=</span>&nbsp;<span class="ident" id="2243230">ptrace</span><span class="op" id="2243236">(</span><span class="ident" id="2243237">req</span><span class="op" id="2243240">,</span>&nbsp;<span class="ident" id="2243242">pid</span><span class="op" id="2243245">,</span>&nbsp;<span class="ident" id="2243247">addr</span><span class="op" id="2243251">+</span><span class="builtintype" id="2243252">uintptr</span><span class="op" id="2243259">(</span><span class="ident" id="2243260">n</span><span class="op" id="2243261">)</span><span class="op" id="2243262">,</span>&nbsp;<span class="builtintype" id="2243264">uintptr</span><span class="op" id="2243271">(</span><span class="ident" id="2243272">unsafe</span><span class="op" id="2243278">.</span><span class="ident" id="2243279">Pointer</span><span class="op" id="2243286">(</span><span class="op" id="2243287">&amp;</span><span class="ident" id="2243288">buf</span><span class="op" id="2243291">[</span><span class="num" id="2243292">0</span><span class="op" id="2243293">]</span><span class="op" id="2243294">)</span><span class="op" id="2243295">)</span><span class="op" id="2243296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243300">if</span>&nbsp;<span class="ident" id="2243303">err</span>&nbsp;<span class="op" id="2243307">!=</span>&nbsp;<span class="ident" id="2243310">nil</span>&nbsp;<span class="op" id="2243314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243319">return</span>&nbsp;<span class="ident" id="2243326">n</span><span class="op" id="2243327">,</span>&nbsp;<span class="ident" id="2243329">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243339">copied</span>&nbsp;<span class="op" id="2243346">:=</span>&nbsp;<span class="builtinfunc" id="2243349">copy</span><span class="op" id="2243353">(</span><span class="ident" id="2243354">out</span><span class="op" id="2243357">,</span>&nbsp;<span class="ident" id="2243359">buf</span><span class="op" id="2243362">[</span><span class="num" id="2243363">0</span><span class="op" id="2243364">:</span><span class="op" id="2243365">]</span><span class="op" id="2243366">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243370">n</span>&nbsp;<span class="op" id="2243372">+=</span>&nbsp;<span class="ident" id="2243375">copied</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243384">out</span>&nbsp;<span class="op" id="2243388">=</span>&nbsp;<span class="ident" id="2243390">out</span><span class="op" id="2243393">[</span><span class="ident" id="2243394">copied</span><span class="op" id="2243400">:</span><span class="op" id="2243401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2243404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243408">return</span>&nbsp;<span class="ident" id="2243415">n</span><span class="op" id="2243416">,</span>&nbsp;<span class="ident" id="2243418">nil</span><br>
<span class="lineno">620</span><span class="op" id="2243422">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2243425">func</span>&nbsp;<span class="ident" id="2243430">PtracePeekText</span><span class="op" id="2243444">(</span><span class="ident" id="2243445">pid</span>&nbsp;<span class="builtintype" id="2243449">int</span><span class="op" id="2243452">,</span>&nbsp;<span class="ident" id="2243454">addr</span>&nbsp;<span class="builtintype" id="2243459">uintptr</span><span class="op" id="2243466">,</span>&nbsp;<span class="ident" id="2243468">out</span>&nbsp;<span class="op" id="2243472">[</span><span class="op" id="2243473">]</span><span class="builtintype" id="2243474">byte</span><span class="op" id="2243478">)</span>&nbsp;<span class="op" id="2243480">(</span><span class="ident" id="2243481">count</span>&nbsp;<span class="builtintype" id="2243487">int</span><span class="op" id="2243490">,</span>&nbsp;<span class="ident" id="2243492">err</span>&nbsp;<span class="builtintype" id="2243496">error</span><span class="op" id="2243501">)</span>&nbsp;<span class="op" id="2243503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243506">return</span>&nbsp;<span class="ident" id="2243513">ptracePeek</span><span class="op" id="2243523">(</span><span class="ident" id="2243524">PTRACE_PEEKTEXT</span><span class="op" id="2243539">,</span>&nbsp;<span class="ident" id="2243541">pid</span><span class="op" id="2243544">,</span>&nbsp;<span class="ident" id="2243546">addr</span><span class="op" id="2243550">,</span>&nbsp;<span class="ident" id="2243552">out</span><span class="op" id="2243555">)</span><br>
<span class="lineno"></span><span class="op" id="2243557">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="2243560">func</span>&nbsp;<span class="ident" id="2243565">PtracePeekData</span><span class="op" id="2243579">(</span><span class="ident" id="2243580">pid</span>&nbsp;<span class="builtintype" id="2243584">int</span><span class="op" id="2243587">,</span>&nbsp;<span class="ident" id="2243589">addr</span>&nbsp;<span class="builtintype" id="2243594">uintptr</span><span class="op" id="2243601">,</span>&nbsp;<span class="ident" id="2243603">out</span>&nbsp;<span class="op" id="2243607">[</span><span class="op" id="2243608">]</span><span class="builtintype" id="2243609">byte</span><span class="op" id="2243613">)</span>&nbsp;<span class="op" id="2243615">(</span><span class="ident" id="2243616">count</span>&nbsp;<span class="builtintype" id="2243622">int</span><span class="op" id="2243625">,</span>&nbsp;<span class="ident" id="2243627">err</span>&nbsp;<span class="builtintype" id="2243631">error</span><span class="op" id="2243636">)</span>&nbsp;<span class="op" id="2243638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243641">return</span>&nbsp;<span class="ident" id="2243648">ptracePeek</span><span class="op" id="2243658">(</span><span class="ident" id="2243659">PTRACE_PEEKDATA</span><span class="op" id="2243674">,</span>&nbsp;<span class="ident" id="2243676">pid</span><span class="op" id="2243679">,</span>&nbsp;<span class="ident" id="2243681">addr</span><span class="op" id="2243685">,</span>&nbsp;<span class="ident" id="2243687">out</span><span class="op" id="2243690">)</span><br>
<span class="lineno"></span><span class="op" id="2243692">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">630</span><span class="keyword" id="2243695">func</span>&nbsp;<span class="ident" id="2243700">ptracePoke</span><span class="op" id="2243710">(</span><span class="ident" id="2243711">pokeReq</span>&nbsp;<span class="builtintype" id="2243719">int</span><span class="op" id="2243722">,</span>&nbsp;<span class="ident" id="2243724">peekReq</span>&nbsp;<span class="builtintype" id="2243732">int</span><span class="op" id="2243735">,</span>&nbsp;<span class="ident" id="2243737">pid</span>&nbsp;<span class="builtintype" id="2243741">int</span><span class="op" id="2243744">,</span>&nbsp;<span class="ident" id="2243746">addr</span>&nbsp;<span class="builtintype" id="2243751">uintptr</span><span class="op" id="2243758">,</span>&nbsp;<span class="ident" id="2243760">data</span>&nbsp;<span class="op" id="2243765">[</span><span class="op" id="2243766">]</span><span class="builtintype" id="2243767">byte</span><span class="op" id="2243771">)</span>&nbsp;<span class="op" id="2243773">(</span><span class="ident" id="2243774">count</span>&nbsp;<span class="builtintype" id="2243780">int</span><span class="op" id="2243783">,</span>&nbsp;<span class="ident" id="2243785">err</span>&nbsp;<span class="builtintype" id="2243789">error</span><span class="op" id="2243794">)</span>&nbsp;<span class="op" id="2243796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243799">//&nbsp;As&nbsp;for&nbsp;ptracePeek,&nbsp;we&nbsp;need&nbsp;to&nbsp;align&nbsp;our&nbsp;accesses&nbsp;to&nbsp;deal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243860">//&nbsp;with&nbsp;the&nbsp;possibility&nbsp;of&nbsp;straddling&nbsp;an&nbsp;invalid&nbsp;page.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2243917">//&nbsp;Leading&nbsp;edge.</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243935">n</span>&nbsp;<span class="op" id="2243937">:=</span>&nbsp;<span class="num" id="2243940">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243943">if</span>&nbsp;<span class="ident" id="2243946">addr</span><span class="op" id="2243950">%</span><span class="ident" id="2243951">sizeofPtr</span>&nbsp;<span class="op" id="2243961">!=</span>&nbsp;<span class="num" id="2243964">0</span>&nbsp;<span class="op" id="2243966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2243970">var</span>&nbsp;<span class="ident" id="2243974">buf</span>&nbsp;<span class="op" id="2243978">[</span><span class="ident" id="2243979">sizeofPtr</span><span class="op" id="2243988">]</span><span class="builtintype" id="2243989">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2243996">err</span>&nbsp;<span class="op" id="2244000">=</span>&nbsp;<span class="ident" id="2244002">ptrace</span><span class="op" id="2244008">(</span><span class="ident" id="2244009">peekReq</span><span class="op" id="2244016">,</span>&nbsp;<span class="ident" id="2244018">pid</span><span class="op" id="2244021">,</span>&nbsp;<span class="ident" id="2244023">addr</span><span class="op" id="2244027">-</span><span class="ident" id="2244028">addr</span><span class="op" id="2244032">%</span><span class="ident" id="2244033">sizeofPtr</span><span class="op" id="2244042">,</span>&nbsp;<span class="builtintype" id="2244044">uintptr</span><span class="op" id="2244051">(</span><span class="ident" id="2244052">unsafe</span><span class="op" id="2244058">.</span><span class="ident" id="2244059">Pointer</span><span class="op" id="2244066">(</span><span class="op" id="2244067">&amp;</span><span class="ident" id="2244068">buf</span><span class="op" id="2244071">[</span><span class="num" id="2244072">0</span><span class="op" id="2244073">]</span><span class="op" id="2244074">)</span><span class="op" id="2244075">)</span><span class="op" id="2244076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244080">if</span>&nbsp;<span class="ident" id="2244083">err</span>&nbsp;<span class="op" id="2244087">!=</span>&nbsp;<span class="ident" id="2244090">nil</span>&nbsp;<span class="op" id="2244094">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244099">return</span>&nbsp;<span class="num" id="2244106">0</span><span class="op" id="2244107">,</span>&nbsp;<span class="ident" id="2244109">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244119">n</span>&nbsp;<span class="op" id="2244121">+=</span>&nbsp;<span class="builtinfunc" id="2244124">copy</span><span class="op" id="2244128">(</span><span class="ident" id="2244129">buf</span><span class="op" id="2244132">[</span><span class="ident" id="2244133">addr</span><span class="op" id="2244137">%</span><span class="ident" id="2244138">sizeofPtr</span><span class="op" id="2244147">:</span><span class="op" id="2244148">]</span><span class="op" id="2244149">,</span>&nbsp;<span class="ident" id="2244151">data</span><span class="op" id="2244155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244159">word</span>&nbsp;<span class="op" id="2244164">:=</span>&nbsp;<span class="op" id="2244167">*</span><span class="op" id="2244168">(</span><span class="op" id="2244169">(</span><span class="op" id="2244170">*</span><span class="builtintype" id="2244171">uintptr</span><span class="op" id="2244178">)</span><span class="op" id="2244179">(</span><span class="ident" id="2244180">unsafe</span><span class="op" id="2244186">.</span><span class="ident" id="2244187">Pointer</span><span class="op" id="2244194">(</span><span class="op" id="2244195">&amp;</span><span class="ident" id="2244196">buf</span><span class="op" id="2244199">[</span><span class="num" id="2244200">0</span><span class="op" id="2244201">]</span><span class="op" id="2244202">)</span><span class="op" id="2244203">)</span><span class="op" id="2244204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244208">err</span>&nbsp;<span class="op" id="2244212">=</span>&nbsp;<span class="ident" id="2244214">ptrace</span><span class="op" id="2244220">(</span><span class="ident" id="2244221">pokeReq</span><span class="op" id="2244228">,</span>&nbsp;<span class="ident" id="2244230">pid</span><span class="op" id="2244233">,</span>&nbsp;<span class="ident" id="2244235">addr</span><span class="op" id="2244239">-</span><span class="ident" id="2244240">addr</span><span class="op" id="2244244">%</span><span class="ident" id="2244245">sizeofPtr</span><span class="op" id="2244254">,</span>&nbsp;<span class="ident" id="2244256">word</span><span class="op" id="2244260">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244264">if</span>&nbsp;<span class="ident" id="2244267">err</span>&nbsp;<span class="op" id="2244271">!=</span>&nbsp;<span class="ident" id="2244274">nil</span>&nbsp;<span class="op" id="2244278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244283">return</span>&nbsp;<span class="num" id="2244290">0</span><span class="op" id="2244291">,</span>&nbsp;<span class="ident" id="2244293">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244303">data</span>&nbsp;<span class="op" id="2244308">=</span>&nbsp;<span class="ident" id="2244310">data</span><span class="op" id="2244314">[</span><span class="ident" id="2244315">n</span><span class="op" id="2244316">:</span><span class="op" id="2244317">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244320">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2244324">//&nbsp;Interior.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244338">for</span>&nbsp;<span class="builtinfunc" id="2244342">len</span><span class="op" id="2244345">(</span><span class="ident" id="2244346">data</span><span class="op" id="2244350">)</span>&nbsp;<span class="op" id="2244352">&gt;</span>&nbsp;<span class="ident" id="2244354">sizeofPtr</span>&nbsp;<span class="op" id="2244364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244368">word</span>&nbsp;<span class="op" id="2244373">:=</span>&nbsp;<span class="op" id="2244376">*</span><span class="op" id="2244377">(</span><span class="op" id="2244378">(</span><span class="op" id="2244379">*</span><span class="builtintype" id="2244380">uintptr</span><span class="op" id="2244387">)</span><span class="op" id="2244388">(</span><span class="ident" id="2244389">unsafe</span><span class="op" id="2244395">.</span><span class="ident" id="2244396">Pointer</span><span class="op" id="2244403">(</span><span class="op" id="2244404">&amp;</span><span class="ident" id="2244405">data</span><span class="op" id="2244409">[</span><span class="num" id="2244410">0</span><span class="op" id="2244411">]</span><span class="op" id="2244412">)</span><span class="op" id="2244413">)</span><span class="op" id="2244414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244418">err</span>&nbsp;<span class="op" id="2244422">=</span>&nbsp;<span class="ident" id="2244424">ptrace</span><span class="op" id="2244430">(</span><span class="ident" id="2244431">pokeReq</span><span class="op" id="2244438">,</span>&nbsp;<span class="ident" id="2244440">pid</span><span class="op" id="2244443">,</span>&nbsp;<span class="ident" id="2244445">addr</span><span class="op" id="2244449">+</span><span class="builtintype" id="2244450">uintptr</span><span class="op" id="2244457">(</span><span class="ident" id="2244458">n</span><span class="op" id="2244459">)</span><span class="op" id="2244460">,</span>&nbsp;<span class="ident" id="2244462">word</span><span class="op" id="2244466">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244470">if</span>&nbsp;<span class="ident" id="2244473">err</span>&nbsp;<span class="op" id="2244477">!=</span>&nbsp;<span class="ident" id="2244480">nil</span>&nbsp;<span class="op" id="2244484">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244489">return</span>&nbsp;<span class="ident" id="2244496">n</span><span class="op" id="2244497">,</span>&nbsp;<span class="ident" id="2244499">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244505">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244509">n</span>&nbsp;<span class="op" id="2244511">+=</span>&nbsp;<span class="ident" id="2244514">sizeofPtr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244526">data</span>&nbsp;<span class="op" id="2244531">=</span>&nbsp;<span class="ident" id="2244533">data</span><span class="op" id="2244537">[</span><span class="ident" id="2244538">sizeofPtr</span><span class="op" id="2244547">:</span><span class="op" id="2244548">]</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244551">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2244555">//&nbsp;Trailing&nbsp;edge.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244574">if</span>&nbsp;<span class="builtinfunc" id="2244577">len</span><span class="op" id="2244580">(</span><span class="ident" id="2244581">data</span><span class="op" id="2244585">)</span>&nbsp;<span class="op" id="2244587">&gt;</span>&nbsp;<span class="num" id="2244589">0</span>&nbsp;<span class="op" id="2244591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244595">var</span>&nbsp;<span class="ident" id="2244599">buf</span>&nbsp;<span class="op" id="2244603">[</span><span class="ident" id="2244604">sizeofPtr</span><span class="op" id="2244613">]</span><span class="builtintype" id="2244614">byte</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244621">err</span>&nbsp;<span class="op" id="2244625">=</span>&nbsp;<span class="ident" id="2244627">ptrace</span><span class="op" id="2244633">(</span><span class="ident" id="2244634">peekReq</span><span class="op" id="2244641">,</span>&nbsp;<span class="ident" id="2244643">pid</span><span class="op" id="2244646">,</span>&nbsp;<span class="ident" id="2244648">addr</span><span class="op" id="2244652">+</span><span class="builtintype" id="2244653">uintptr</span><span class="op" id="2244660">(</span><span class="ident" id="2244661">n</span><span class="op" id="2244662">)</span><span class="op" id="2244663">,</span>&nbsp;<span class="builtintype" id="2244665">uintptr</span><span class="op" id="2244672">(</span><span class="ident" id="2244673">unsafe</span><span class="op" id="2244679">.</span><span class="ident" id="2244680">Pointer</span><span class="op" id="2244687">(</span><span class="op" id="2244688">&amp;</span><span class="ident" id="2244689">buf</span><span class="op" id="2244692">[</span><span class="num" id="2244693">0</span><span class="op" id="2244694">]</span><span class="op" id="2244695">)</span><span class="op" id="2244696">)</span><span class="op" id="2244697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244701">if</span>&nbsp;<span class="ident" id="2244704">err</span>&nbsp;<span class="op" id="2244708">!=</span>&nbsp;<span class="ident" id="2244711">nil</span>&nbsp;<span class="op" id="2244715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244720">return</span>&nbsp;<span class="ident" id="2244727">n</span><span class="op" id="2244728">,</span>&nbsp;<span class="ident" id="2244730">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="2244740">copy</span><span class="op" id="2244744">(</span><span class="ident" id="2244745">buf</span><span class="op" id="2244748">[</span><span class="num" id="2244749">0</span><span class="op" id="2244750">:</span><span class="op" id="2244751">]</span><span class="op" id="2244752">,</span>&nbsp;<span class="ident" id="2244754">data</span><span class="op" id="2244758">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244762">word</span>&nbsp;<span class="op" id="2244767">:=</span>&nbsp;<span class="op" id="2244770">*</span><span class="op" id="2244771">(</span><span class="op" id="2244772">(</span><span class="op" id="2244773">*</span><span class="builtintype" id="2244774">uintptr</span><span class="op" id="2244781">)</span><span class="op" id="2244782">(</span><span class="ident" id="2244783">unsafe</span><span class="op" id="2244789">.</span><span class="ident" id="2244790">Pointer</span><span class="op" id="2244797">(</span><span class="op" id="2244798">&amp;</span><span class="ident" id="2244799">buf</span><span class="op" id="2244802">[</span><span class="num" id="2244803">0</span><span class="op" id="2244804">]</span><span class="op" id="2244805">)</span><span class="op" id="2244806">)</span><span class="op" id="2244807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244811">err</span>&nbsp;<span class="op" id="2244815">=</span>&nbsp;<span class="ident" id="2244817">ptrace</span><span class="op" id="2244823">(</span><span class="ident" id="2244824">pokeReq</span><span class="op" id="2244831">,</span>&nbsp;<span class="ident" id="2244833">pid</span><span class="op" id="2244836">,</span>&nbsp;<span class="ident" id="2244838">addr</span><span class="op" id="2244842">+</span><span class="builtintype" id="2244843">uintptr</span><span class="op" id="2244850">(</span><span class="ident" id="2244851">n</span><span class="op" id="2244852">)</span><span class="op" id="2244853">,</span>&nbsp;<span class="ident" id="2244855">word</span><span class="op" id="2244859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244863">if</span>&nbsp;<span class="ident" id="2244866">err</span>&nbsp;<span class="op" id="2244870">!=</span>&nbsp;<span class="ident" id="2244873">nil</span>&nbsp;<span class="op" id="2244877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244882">return</span>&nbsp;<span class="ident" id="2244889">n</span><span class="op" id="2244890">,</span>&nbsp;<span class="ident" id="2244892">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244898">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2244902">n</span>&nbsp;<span class="op" id="2244904">+=</span>&nbsp;<span class="builtinfunc" id="2244907">len</span><span class="op" id="2244910">(</span><span class="ident" id="2244911">data</span><span class="op" id="2244915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2244918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2244922">return</span>&nbsp;<span class="ident" id="2244929">n</span><span class="op" id="2244930">,</span>&nbsp;<span class="ident" id="2244932">nil</span><br>
<span class="lineno"></span><span class="op" id="2244936">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="2244939">func</span>&nbsp;<span class="ident" id="2244944">PtracePokeText</span><span class="op" id="2244958">(</span><span class="ident" id="2244959">pid</span>&nbsp;<span class="builtintype" id="2244963">int</span><span class="op" id="2244966">,</span>&nbsp;<span class="ident" id="2244968">addr</span>&nbsp;<span class="builtintype" id="2244973">uintptr</span><span class="op" id="2244980">,</span>&nbsp;<span class="ident" id="2244982">data</span>&nbsp;<span class="op" id="2244987">[</span><span class="op" id="2244988">]</span><span class="builtintype" id="2244989">byte</span><span class="op" id="2244993">)</span>&nbsp;<span class="op" id="2244995">(</span><span class="ident" id="2244996">count</span>&nbsp;<span class="builtintype" id="2245002">int</span><span class="op" id="2245005">,</span>&nbsp;<span class="ident" id="2245007">err</span>&nbsp;<span class="builtintype" id="2245011">error</span><span class="op" id="2245016">)</span>&nbsp;<span class="op" id="2245018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245021">return</span>&nbsp;<span class="ident" id="2245028">ptracePoke</span><span class="op" id="2245038">(</span><span class="ident" id="2245039">PTRACE_POKETEXT</span><span class="op" id="2245054">,</span>&nbsp;<span class="ident" id="2245056">PTRACE_PEEKTEXT</span><span class="op" id="2245071">,</span>&nbsp;<span class="ident" id="2245073">pid</span><span class="op" id="2245076">,</span>&nbsp;<span class="ident" id="2245078">addr</span><span class="op" id="2245082">,</span>&nbsp;<span class="ident" id="2245084">data</span><span class="op" id="2245088">)</span><br>
<span class="lineno"></span><span class="op" id="2245090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">685</span><span class="keyword" id="2245093">func</span>&nbsp;<span class="ident" id="2245098">PtracePokeData</span><span class="op" id="2245112">(</span><span class="ident" id="2245113">pid</span>&nbsp;<span class="builtintype" id="2245117">int</span><span class="op" id="2245120">,</span>&nbsp;<span class="ident" id="2245122">addr</span>&nbsp;<span class="builtintype" id="2245127">uintptr</span><span class="op" id="2245134">,</span>&nbsp;<span class="ident" id="2245136">data</span>&nbsp;<span class="op" id="2245141">[</span><span class="op" id="2245142">]</span><span class="builtintype" id="2245143">byte</span><span class="op" id="2245147">)</span>&nbsp;<span class="op" id="2245149">(</span><span class="ident" id="2245150">count</span>&nbsp;<span class="builtintype" id="2245156">int</span><span class="op" id="2245159">,</span>&nbsp;<span class="ident" id="2245161">err</span>&nbsp;<span class="builtintype" id="2245165">error</span><span class="op" id="2245170">)</span>&nbsp;<span class="op" id="2245172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245175">return</span>&nbsp;<span class="ident" id="2245182">ptracePoke</span><span class="op" id="2245192">(</span><span class="ident" id="2245193">PTRACE_POKEDATA</span><span class="op" id="2245208">,</span>&nbsp;<span class="ident" id="2245210">PTRACE_PEEKDATA</span><span class="op" id="2245225">,</span>&nbsp;<span class="ident" id="2245227">pid</span><span class="op" id="2245230">,</span>&nbsp;<span class="ident" id="2245232">addr</span><span class="op" id="2245236">,</span>&nbsp;<span class="ident" id="2245238">data</span><span class="op" id="2245242">)</span><br>
<span class="lineno"></span><span class="op" id="2245244">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2245247">func</span>&nbsp;<span class="ident" id="2245252">PtraceGetRegs</span><span class="op" id="2245265">(</span><span class="ident" id="2245266">pid</span>&nbsp;<span class="builtintype" id="2245270">int</span><span class="op" id="2245273">,</span>&nbsp;<span class="ident" id="2245275">regsout</span>&nbsp;<span class="op" id="2245283">*</span><span class="ident" id="2245284">PtraceRegs</span><span class="op" id="2245294">)</span>&nbsp;<span class="op" id="2245296">(</span><span class="ident" id="2245297">err</span>&nbsp;<span class="builtintype" id="2245301">error</span><span class="op" id="2245306">)</span>&nbsp;<span class="op" id="2245308">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245311">return</span>&nbsp;<span class="ident" id="2245318">ptrace</span><span class="op" id="2245324">(</span><span class="ident" id="2245325">PTRACE_GETREGS</span><span class="op" id="2245339">,</span>&nbsp;<span class="ident" id="2245341">pid</span><span class="op" id="2245344">,</span>&nbsp;<span class="num" id="2245346">0</span><span class="op" id="2245347">,</span>&nbsp;<span class="builtintype" id="2245349">uintptr</span><span class="op" id="2245356">(</span><span class="ident" id="2245357">unsafe</span><span class="op" id="2245363">.</span><span class="ident" id="2245364">Pointer</span><span class="op" id="2245371">(</span><span class="ident" id="2245372">regsout</span><span class="op" id="2245379">)</span><span class="op" id="2245380">)</span><span class="op" id="2245381">)</span><br>
<span class="lineno"></span><span class="op" id="2245383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2245386">func</span>&nbsp;<span class="ident" id="2245391">PtraceSetRegs</span><span class="op" id="2245404">(</span><span class="ident" id="2245405">pid</span>&nbsp;<span class="builtintype" id="2245409">int</span><span class="op" id="2245412">,</span>&nbsp;<span class="ident" id="2245414">regs</span>&nbsp;<span class="op" id="2245419">*</span><span class="ident" id="2245420">PtraceRegs</span><span class="op" id="2245430">)</span>&nbsp;<span class="op" id="2245432">(</span><span class="ident" id="2245433">err</span>&nbsp;<span class="builtintype" id="2245437">error</span><span class="op" id="2245442">)</span>&nbsp;<span class="op" id="2245444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245447">return</span>&nbsp;<span class="ident" id="2245454">ptrace</span><span class="op" id="2245460">(</span><span class="ident" id="2245461">PTRACE_SETREGS</span><span class="op" id="2245475">,</span>&nbsp;<span class="ident" id="2245477">pid</span><span class="op" id="2245480">,</span>&nbsp;<span class="num" id="2245482">0</span><span class="op" id="2245483">,</span>&nbsp;<span class="builtintype" id="2245485">uintptr</span><span class="op" id="2245492">(</span><span class="ident" id="2245493">unsafe</span><span class="op" id="2245499">.</span><span class="ident" id="2245500">Pointer</span><span class="op" id="2245507">(</span><span class="ident" id="2245508">regs</span><span class="op" id="2245512">)</span><span class="op" id="2245513">)</span><span class="op" id="2245514">)</span><br>
<span class="lineno">695</span><span class="op" id="2245516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2245519">func</span>&nbsp;<span class="ident" id="2245524">PtraceSetOptions</span><span class="op" id="2245540">(</span><span class="ident" id="2245541">pid</span>&nbsp;<span class="builtintype" id="2245545">int</span><span class="op" id="2245548">,</span>&nbsp;<span class="ident" id="2245550">options</span>&nbsp;<span class="builtintype" id="2245558">int</span><span class="op" id="2245561">)</span>&nbsp;<span class="op" id="2245563">(</span><span class="ident" id="2245564">err</span>&nbsp;<span class="builtintype" id="2245568">error</span><span class="op" id="2245573">)</span>&nbsp;<span class="op" id="2245575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245578">return</span>&nbsp;<span class="ident" id="2245585">ptrace</span><span class="op" id="2245591">(</span><span class="ident" id="2245592">PTRACE_SETOPTIONS</span><span class="op" id="2245609">,</span>&nbsp;<span class="ident" id="2245611">pid</span><span class="op" id="2245614">,</span>&nbsp;<span class="num" id="2245616">0</span><span class="op" id="2245617">,</span>&nbsp;<span class="builtintype" id="2245619">uintptr</span><span class="op" id="2245626">(</span><span class="ident" id="2245627">options</span><span class="op" id="2245634">)</span><span class="op" id="2245635">)</span><br>
<span class="lineno"></span><span class="op" id="2245637">}</span><br>
<span class="lineno">700</span><br>
<span class="lineno"></span><span class="keyword" id="2245640">func</span>&nbsp;<span class="ident" id="2245645">PtraceGetEventMsg</span><span class="op" id="2245662">(</span><span class="ident" id="2245663">pid</span>&nbsp;<span class="builtintype" id="2245667">int</span><span class="op" id="2245670">)</span>&nbsp;<span class="op" id="2245672">(</span><span class="ident" id="2245673">msg</span>&nbsp;<span class="builtintype" id="2245677">uint</span><span class="op" id="2245681">,</span>&nbsp;<span class="ident" id="2245683">err</span>&nbsp;<span class="builtintype" id="2245687">error</span><span class="op" id="2245692">)</span>&nbsp;<span class="op" id="2245694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245697">var</span>&nbsp;<span class="ident" id="2245701">data</span>&nbsp;<span class="ident" id="2245706">_C_long</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245715">err</span>&nbsp;<span class="op" id="2245719">=</span>&nbsp;<span class="ident" id="2245721">ptrace</span><span class="op" id="2245727">(</span><span class="ident" id="2245728">PTRACE_GETEVENTMSG</span><span class="op" id="2245746">,</span>&nbsp;<span class="ident" id="2245748">pid</span><span class="op" id="2245751">,</span>&nbsp;<span class="num" id="2245753">0</span><span class="op" id="2245754">,</span>&nbsp;<span class="builtintype" id="2245756">uintptr</span><span class="op" id="2245763">(</span><span class="ident" id="2245764">unsafe</span><span class="op" id="2245770">.</span><span class="ident" id="2245771">Pointer</span><span class="op" id="2245778">(</span><span class="op" id="2245779">&amp;</span><span class="ident" id="2245780">data</span><span class="op" id="2245784">)</span><span class="op" id="2245785">)</span><span class="op" id="2245786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2245789">msg</span>&nbsp;<span class="op" id="2245793">=</span>&nbsp;<span class="builtintype" id="2245795">uint</span><span class="op" id="2245799">(</span><span class="ident" id="2245800">data</span><span class="op" id="2245804">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245807">return</span><br>
<span class="lineno"></span><span class="op" id="2245814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2245817">func</span>&nbsp;<span class="ident" id="2245822">PtraceCont</span><span class="op" id="2245832">(</span><span class="ident" id="2245833">pid</span>&nbsp;<span class="builtintype" id="2245837">int</span><span class="op" id="2245840">,</span>&nbsp;<span class="ident" id="2245842">signal</span>&nbsp;<span class="builtintype" id="2245849">int</span><span class="op" id="2245852">)</span>&nbsp;<span class="op" id="2245854">(</span><span class="ident" id="2245855">err</span>&nbsp;<span class="builtintype" id="2245859">error</span><span class="op" id="2245864">)</span>&nbsp;<span class="op" id="2245866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245869">return</span>&nbsp;<span class="ident" id="2245876">ptrace</span><span class="op" id="2245882">(</span><span class="ident" id="2245883">PTRACE_CONT</span><span class="op" id="2245894">,</span>&nbsp;<span class="ident" id="2245896">pid</span><span class="op" id="2245899">,</span>&nbsp;<span class="num" id="2245901">0</span><span class="op" id="2245902">,</span>&nbsp;<span class="builtintype" id="2245904">uintptr</span><span class="op" id="2245911">(</span><span class="ident" id="2245912">signal</span><span class="op" id="2245918">)</span><span class="op" id="2245919">)</span><br>
<span class="lineno">710</span><span class="op" id="2245921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2245924">func</span>&nbsp;<span class="ident" id="2245929">PtraceSyscall</span><span class="op" id="2245942">(</span><span class="ident" id="2245943">pid</span>&nbsp;<span class="builtintype" id="2245947">int</span><span class="op" id="2245950">,</span>&nbsp;<span class="ident" id="2245952">signal</span>&nbsp;<span class="builtintype" id="2245959">int</span><span class="op" id="2245962">)</span>&nbsp;<span class="op" id="2245964">(</span><span class="ident" id="2245965">err</span>&nbsp;<span class="builtintype" id="2245969">error</span><span class="op" id="2245974">)</span>&nbsp;<span class="op" id="2245976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2245979">return</span>&nbsp;<span class="ident" id="2245986">ptrace</span><span class="op" id="2245992">(</span><span class="ident" id="2245993">PTRACE_SYSCALL</span><span class="op" id="2246007">,</span>&nbsp;<span class="ident" id="2246009">pid</span><span class="op" id="2246012">,</span>&nbsp;<span class="num" id="2246014">0</span><span class="op" id="2246015">,</span>&nbsp;<span class="builtintype" id="2246017">uintptr</span><span class="op" id="2246024">(</span><span class="ident" id="2246025">signal</span><span class="op" id="2246031">)</span><span class="op" id="2246032">)</span><br>
<span class="lineno"></span><span class="op" id="2246034">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="2246037">func</span>&nbsp;<span class="ident" id="2246042">PtraceSingleStep</span><span class="op" id="2246058">(</span><span class="ident" id="2246059">pid</span>&nbsp;<span class="builtintype" id="2246063">int</span><span class="op" id="2246066">)</span>&nbsp;<span class="op" id="2246068">(</span><span class="ident" id="2246069">err</span>&nbsp;<span class="builtintype" id="2246073">error</span><span class="op" id="2246078">)</span>&nbsp;<span class="op" id="2246080">{</span>&nbsp;<span class="keyword" id="2246082">return</span>&nbsp;<span class="ident" id="2246089">ptrace</span><span class="op" id="2246095">(</span><span class="ident" id="2246096">PTRACE_SINGLESTEP</span><span class="op" id="2246113">,</span>&nbsp;<span class="ident" id="2246115">pid</span><span class="op" id="2246118">,</span>&nbsp;<span class="num" id="2246120">0</span><span class="op" id="2246121">,</span>&nbsp;<span class="num" id="2246123">0</span><span class="op" id="2246124">)</span>&nbsp;<span class="op" id="2246126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246129">func</span>&nbsp;<span class="ident" id="2246134">PtraceAttach</span><span class="op" id="2246146">(</span><span class="ident" id="2246147">pid</span>&nbsp;<span class="builtintype" id="2246151">int</span><span class="op" id="2246154">)</span>&nbsp;<span class="op" id="2246156">(</span><span class="ident" id="2246157">err</span>&nbsp;<span class="builtintype" id="2246161">error</span><span class="op" id="2246166">)</span>&nbsp;<span class="op" id="2246168">{</span>&nbsp;<span class="keyword" id="2246170">return</span>&nbsp;<span class="ident" id="2246177">ptrace</span><span class="op" id="2246183">(</span><span class="ident" id="2246184">PTRACE_ATTACH</span><span class="op" id="2246197">,</span>&nbsp;<span class="ident" id="2246199">pid</span><span class="op" id="2246202">,</span>&nbsp;<span class="num" id="2246204">0</span><span class="op" id="2246205">,</span>&nbsp;<span class="num" id="2246207">0</span><span class="op" id="2246208">)</span>&nbsp;<span class="op" id="2246210">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span><span class="keyword" id="2246213">func</span>&nbsp;<span class="ident" id="2246218">PtraceDetach</span><span class="op" id="2246230">(</span><span class="ident" id="2246231">pid</span>&nbsp;<span class="builtintype" id="2246235">int</span><span class="op" id="2246238">)</span>&nbsp;<span class="op" id="2246240">(</span><span class="ident" id="2246241">err</span>&nbsp;<span class="builtintype" id="2246245">error</span><span class="op" id="2246250">)</span>&nbsp;<span class="op" id="2246252">{</span>&nbsp;<span class="keyword" id="2246254">return</span>&nbsp;<span class="ident" id="2246261">ptrace</span><span class="op" id="2246267">(</span><span class="ident" id="2246268">PTRACE_DETACH</span><span class="op" id="2246281">,</span>&nbsp;<span class="ident" id="2246283">pid</span><span class="op" id="2246286">,</span>&nbsp;<span class="num" id="2246288">0</span><span class="op" id="2246289">,</span>&nbsp;<span class="num" id="2246291">0</span><span class="op" id="2246292">)</span>&nbsp;<span class="op" id="2246294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2246297">//sys&nbsp;&nbsp;&nbsp;&nbspreboot(magic1&nbsp;uint,&nbsp;magic2&nbsp;uint,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246370">func</span>&nbsp;<span class="ident" id="2246375">Reboot</span><span class="op" id="2246381">(</span><span class="ident" id="2246382">cmd</span>&nbsp;<span class="builtintype" id="2246386">int</span><span class="op" id="2246389">)</span>&nbsp;<span class="op" id="2246391">(</span><span class="ident" id="2246392">err</span>&nbsp;<span class="builtintype" id="2246396">error</span><span class="op" id="2246401">)</span>&nbsp;<span class="op" id="2246403">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246406">return</span>&nbsp;<span class="ident" id="2246413">reboot</span><span class="op" id="2246419">(</span><span class="ident" id="2246420">LINUX_REBOOT_MAGIC1</span><span class="op" id="2246439">,</span>&nbsp;<span class="ident" id="2246441">LINUX_REBOOT_MAGIC2</span><span class="op" id="2246460">,</span>&nbsp;<span class="ident" id="2246462">cmd</span><span class="op" id="2246465">,</span>&nbsp;<span class="string" id="2246467">&#34;&#34;</span><span class="op" id="2246469">)</span><br>
<span class="lineno"></span><span class="op" id="2246471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246474">func</span>&nbsp;<span class="ident" id="2246479">clen</span><span class="op" id="2246483">(</span><span class="ident" id="2246484">n</span>&nbsp;<span class="op" id="2246486">[</span><span class="op" id="2246487">]</span><span class="builtintype" id="2246488">byte</span><span class="op" id="2246492">)</span>&nbsp;<span class="builtintype" id="2246494">int</span>&nbsp;<span class="op" id="2246498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246501">for</span>&nbsp;<span class="ident" id="2246505">i</span>&nbsp;<span class="op" id="2246507">:=</span>&nbsp;<span class="num" id="2246510">0</span><span class="op" id="2246511">;</span>&nbsp;<span class="ident" id="2246513">i</span>&nbsp;<span class="op" id="2246515">&lt;</span>&nbsp;<span class="builtinfunc" id="2246517">len</span><span class="op" id="2246520">(</span><span class="ident" id="2246521">n</span><span class="op" id="2246522">)</span><span class="op" id="2246523">;</span>&nbsp;<span class="ident" id="2246525">i</span><span class="op" id="2246526">++</span>&nbsp;<span class="op" id="2246529">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246533">if</span>&nbsp;<span class="ident" id="2246536">n</span><span class="op" id="2246537">[</span><span class="ident" id="2246538">i</span><span class="op" id="2246539">]</span>&nbsp;<span class="op" id="2246541">==</span>&nbsp;<span class="num" id="2246544">0</span>&nbsp;<span class="op" id="2246546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246551">return</span>&nbsp;<span class="ident" id="2246558">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246565">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246568">return</span>&nbsp;<span class="builtinfunc" id="2246575">len</span><span class="op" id="2246578">(</span><span class="ident" id="2246579">n</span><span class="op" id="2246580">)</span><br>
<span class="lineno">735</span><span class="op" id="2246582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2246585">func</span>&nbsp;<span class="ident" id="2246590">ReadDirent</span><span class="op" id="2246600">(</span><span class="ident" id="2246601">fd</span>&nbsp;<span class="builtintype" id="2246604">int</span><span class="op" id="2246607">,</span>&nbsp;<span class="ident" id="2246609">buf</span>&nbsp;<span class="op" id="2246613">[</span><span class="op" id="2246614">]</span><span class="builtintype" id="2246615">byte</span><span class="op" id="2246619">)</span>&nbsp;<span class="op" id="2246621">(</span><span class="ident" id="2246622">n</span>&nbsp;<span class="builtintype" id="2246624">int</span><span class="op" id="2246627">,</span>&nbsp;<span class="ident" id="2246629">err</span>&nbsp;<span class="builtintype" id="2246633">error</span><span class="op" id="2246638">)</span>&nbsp;<span class="op" id="2246640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246643">return</span>&nbsp;<span class="ident" id="2246650">Getdents</span><span class="op" id="2246658">(</span><span class="ident" id="2246659">fd</span><span class="op" id="2246661">,</span>&nbsp;<span class="ident" id="2246663">buf</span><span class="op" id="2246666">)</span><br>
<span class="lineno"></span><span class="op" id="2246668">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="2246671">func</span>&nbsp;<span class="ident" id="2246676">ParseDirent</span><span class="op" id="2246687">(</span><span class="ident" id="2246688">buf</span>&nbsp;<span class="op" id="2246692">[</span><span class="op" id="2246693">]</span><span class="builtintype" id="2246694">byte</span><span class="op" id="2246698">,</span>&nbsp;<span class="ident" id="2246700">max</span>&nbsp;<span class="builtintype" id="2246704">int</span><span class="op" id="2246707">,</span>&nbsp;<span class="ident" id="2246709">names</span>&nbsp;<span class="op" id="2246715">[</span><span class="op" id="2246716">]</span><span class="builtintype" id="2246717">string</span><span class="op" id="2246723">)</span>&nbsp;<span class="op" id="2246725">(</span><span class="ident" id="2246726">consumed</span>&nbsp;<span class="builtintype" id="2246735">int</span><span class="op" id="2246738">,</span>&nbsp;<span class="ident" id="2246740">count</span>&nbsp;<span class="builtintype" id="2246746">int</span><span class="op" id="2246749">,</span>&nbsp;<span class="ident" id="2246751">newnames</span>&nbsp;<span class="op" id="2246760">[</span><span class="op" id="2246761">]</span><span class="builtintype" id="2246762">string</span><span class="op" id="2246768">)</span>&nbsp;<span class="op" id="2246770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246773">origlen</span>&nbsp;<span class="op" id="2246781">:=</span>&nbsp;<span class="builtinfunc" id="2246784">len</span><span class="op" id="2246787">(</span><span class="ident" id="2246788">buf</span><span class="op" id="2246791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246794">count</span>&nbsp;<span class="op" id="2246800">=</span>&nbsp;<span class="num" id="2246802">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246805">for</span>&nbsp;<span class="ident" id="2246809">max</span>&nbsp;<span class="op" id="2246813">!=</span>&nbsp;<span class="num" id="2246816">0</span>&nbsp;<span class="op" id="2246818">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="2246821">len</span><span class="op" id="2246824">(</span><span class="ident" id="2246825">buf</span><span class="op" id="2246828">)</span>&nbsp;<span class="op" id="2246830">&gt;</span>&nbsp;<span class="num" id="2246832">0</span>&nbsp;<span class="op" id="2246834">{</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246838">dirent</span>&nbsp;<span class="op" id="2246845">:=</span>&nbsp;<span class="op" id="2246848">(</span><span class="op" id="2246849">*</span><span class="ident" id="2246850">Dirent</span><span class="op" id="2246856">)</span><span class="op" id="2246857">(</span><span class="ident" id="2246858">unsafe</span><span class="op" id="2246864">.</span><span class="ident" id="2246865">Pointer</span><span class="op" id="2246872">(</span><span class="op" id="2246873">&amp;</span><span class="ident" id="2246874">buf</span><span class="op" id="2246877">[</span><span class="num" id="2246878">0</span><span class="op" id="2246879">]</span><span class="op" id="2246880">)</span><span class="op" id="2246881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246885">buf</span>&nbsp;<span class="op" id="2246889">=</span>&nbsp;<span class="ident" id="2246891">buf</span><span class="op" id="2246894">[</span><span class="ident" id="2246895">dirent</span><span class="op" id="2246901">.</span><span class="ident" id="2246902">Reclen</span><span class="op" id="2246908">:</span><span class="op" id="2246909">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246913">if</span>&nbsp;<span class="ident" id="2246916">dirent</span><span class="op" id="2246922">.</span><span class="ident" id="2246923">Ino</span>&nbsp;<span class="op" id="2246927">==</span>&nbsp;<span class="num" id="2246930">0</span>&nbsp;<span class="op" id="2246932">{</span>&nbsp;<span class="comment" id="2246934">//&nbsp;File&nbsp;absent&nbsp;in&nbsp;directory.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2246966">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2246977">}</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2246981">bytes</span>&nbsp;<span class="op" id="2246987">:=</span>&nbsp;<span class="op" id="2246990">(</span><span class="op" id="2246991">*</span><span class="op" id="2246992">[</span><span class="num" id="2246993">10000</span><span class="op" id="2246998">]</span><span class="builtintype" id="2246999">byte</span><span class="op" id="2247003">)</span><span class="op" id="2247004">(</span><span class="ident" id="2247005">unsafe</span><span class="op" id="2247011">.</span><span class="ident" id="2247012">Pointer</span><span class="op" id="2247019">(</span><span class="op" id="2247020">&amp;</span><span class="ident" id="2247021">dirent</span><span class="op" id="2247027">.</span><span class="ident" id="2247028">Name</span><span class="op" id="2247032">[</span><span class="num" id="2247033">0</span><span class="op" id="2247034">]</span><span class="op" id="2247035">)</span><span class="op" id="2247036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247040">var</span>&nbsp;<span class="ident" id="2247044">name</span>&nbsp;<span class="op" id="2247049">=</span>&nbsp;<span class="builtintype" id="2247051">string</span><span class="op" id="2247057">(</span><span class="ident" id="2247058">bytes</span><span class="op" id="2247063">[</span><span class="num" id="2247064">0</span><span class="op" id="2247065">:</span><span class="ident" id="2247066">clen</span><span class="op" id="2247070">(</span><span class="ident" id="2247071">bytes</span><span class="op" id="2247076">[</span><span class="op" id="2247077">:</span><span class="op" id="2247078">]</span><span class="op" id="2247079">)</span><span class="op" id="2247080">]</span><span class="op" id="2247081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247085">if</span>&nbsp;<span class="ident" id="2247088">name</span>&nbsp;<span class="op" id="2247093">==</span>&nbsp;<span class="string" id="2247096">&#34;.&#34;</span>&nbsp;<span class="op" id="2247100">||</span>&nbsp;<span class="ident" id="2247103">name</span>&nbsp;<span class="op" id="2247108">==</span>&nbsp;<span class="string" id="2247111">&#34;..&#34;</span>&nbsp;<span class="op" id="2247116">{</span>&nbsp;<span class="comment" id="2247118">//&nbsp;Useless&nbsp;names</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247138">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247149">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247153">max</span><span class="op" id="2247156">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247161">count</span><span class="op" id="2247166">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247171">names</span>&nbsp;<span class="op" id="2247177">=</span>&nbsp;<span class="builtinfunc" id="2247179">append</span><span class="op" id="2247185">(</span><span class="ident" id="2247186">names</span><span class="op" id="2247191">,</span>&nbsp;<span class="ident" id="2247193">name</span><span class="op" id="2247197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247203">return</span>&nbsp;<span class="ident" id="2247210">origlen</span>&nbsp;<span class="op" id="2247218">-</span>&nbsp;<span class="builtinfunc" id="2247220">len</span><span class="op" id="2247223">(</span><span class="ident" id="2247224">buf</span><span class="op" id="2247227">)</span><span class="op" id="2247228">,</span>&nbsp;<span class="ident" id="2247230">count</span><span class="op" id="2247235">,</span>&nbsp;<span class="ident" id="2247237">names</span><br>
<span class="lineno">760</span><span class="op" id="2247243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247246">//sys&nbsp;&nbsp;&nbsp;&nbspmount(source&nbsp;string,&nbsp;target&nbsp;string,&nbsp;fstype&nbsp;string,&nbsp;flags&nbsp;uintptr,&nbsp;data&nbsp;*byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2247343">func</span>&nbsp;<span class="ident" id="2247348">Mount</span><span class="op" id="2247353">(</span><span class="ident" id="2247354">source</span>&nbsp;<span class="builtintype" id="2247361">string</span><span class="op" id="2247367">,</span>&nbsp;<span class="ident" id="2247369">target</span>&nbsp;<span class="builtintype" id="2247376">string</span><span class="op" id="2247382">,</span>&nbsp;<span class="ident" id="2247384">fstype</span>&nbsp;<span class="builtintype" id="2247391">string</span><span class="op" id="2247397">,</span>&nbsp;<span class="ident" id="2247399">flags</span>&nbsp;<span class="builtintype" id="2247405">uintptr</span><span class="op" id="2247412">,</span>&nbsp;<span class="ident" id="2247414">data</span>&nbsp;<span class="builtintype" id="2247419">string</span><span class="op" id="2247425">)</span>&nbsp;<span class="op" id="2247427">(</span><span class="ident" id="2247428">err</span>&nbsp;<span class="builtintype" id="2247432">error</span><span class="op" id="2247437">)</span>&nbsp;<span class="op" id="2247439">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247442">//&nbsp;Certain&nbsp;file&nbsp;systems&nbsp;get&nbsp;rather&nbsp;angry&nbsp;and&nbsp;EINVAL&nbsp;if&nbsp;you&nbsp;give</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2247507">//&nbsp;them&nbsp;an&nbsp;empty&nbsp;string&nbsp;of&nbsp;data,&nbsp;rather&nbsp;than&nbsp;NULL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247559">if</span>&nbsp;<span class="ident" id="2247562">data</span>&nbsp;<span class="op" id="2247567">==</span>&nbsp;<span class="string" id="2247570">&#34;&#34;</span>&nbsp;<span class="op" id="2247573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247577">return</span>&nbsp;<span class="ident" id="2247584">mount</span><span class="op" id="2247589">(</span><span class="ident" id="2247590">source</span><span class="op" id="2247596">,</span>&nbsp;<span class="ident" id="2247598">target</span><span class="op" id="2247604">,</span>&nbsp;<span class="ident" id="2247606">fstype</span><span class="op" id="2247612">,</span>&nbsp;<span class="ident" id="2247614">flags</span><span class="op" id="2247619">,</span>&nbsp;<span class="ident" id="2247621">nil</span><span class="op" id="2247624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247627">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247630">datap</span><span class="op" id="2247635">,</span>&nbsp;<span class="ident" id="2247637">err</span>&nbsp;<span class="op" id="2247641">:=</span>&nbsp;<span class="ident" id="2247644">BytePtrFromString</span><span class="op" id="2247661">(</span><span class="ident" id="2247662">data</span><span class="op" id="2247666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247669">if</span>&nbsp;<span class="ident" id="2247672">err</span>&nbsp;<span class="op" id="2247676">!=</span>&nbsp;<span class="ident" id="2247679">nil</span>&nbsp;<span class="op" id="2247683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247687">return</span>&nbsp;<span class="ident" id="2247694">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2247699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247702">err</span>&nbsp;<span class="op" id="2247706">=</span>&nbsp;<span class="ident" id="2247708">mount</span><span class="op" id="2247713">(</span><span class="ident" id="2247714">source</span><span class="op" id="2247720">,</span>&nbsp;<span class="ident" id="2247722">target</span><span class="op" id="2247728">,</span>&nbsp;<span class="ident" id="2247730">fstype</span><span class="op" id="2247736">,</span>&nbsp;<span class="ident" id="2247738">flags</span><span class="op" id="2247743">,</span>&nbsp;<span class="ident" id="2247745">datap</span><span class="op" id="2247750">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2247753">use</span><span class="op" id="2247756">(</span><span class="ident" id="2247757">unsafe</span><span class="op" id="2247763">.</span><span class="ident" id="2247764">Pointer</span><span class="op" id="2247771">(</span><span class="ident" id="2247772">datap</span><span class="op" id="2247777">)</span><span class="op" id="2247778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2247781">return</span>&nbsp;<span class="ident" id="2247788">err</span><br>
<span class="lineno"></span><span class="op" id="2247792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247795">//&nbsp;Sendto</span><br>
<span class="lineno">780</span><span class="comment" id="2247805">//&nbsp;Recvfrom</span><br>
<span class="lineno"></span><span class="comment" id="2247817">//&nbsp;Socketpair</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2247832">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Direct&nbsp;access<br>
<span class="lineno">785</span>&nbsp;*/</span><br>
<span class="lineno"></span><span class="comment" id="2247856">//sys&nbsp;&nbsp;&nbsp;&nbspAccess(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2247907">//sys&nbsp;&nbsp;&nbsp;&nbspAcct(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2247943">//sys&nbsp;&nbsp;&nbsp;&nbspAdjtimex(buf&nbsp;*Timex)&nbsp;(state&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2247993">//sys&nbsp;&nbsp;&nbsp;&nbspChdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">790</span><span class="comment" id="2248030">//sys&nbsp;&nbsp;&nbsp;&nbspChmod(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248080">//sys&nbsp;&nbsp;&nbsp;&nbspChroot(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248118">//sys&nbsp;&nbsp;&nbsp;&nbspClose(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248150">//sys&nbsp;&nbsp;&nbsp;&nbspCreat(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248208">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup(oldfd&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">795</span><span class="comment" id="2248251">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup2(oldfd&nbsp;int,&nbsp;newfd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248298">//sysnb&nbsp;&nbsp;&nbsp;&nbspDup3(oldfd&nbsp;int,&nbsp;newfd&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248356">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate(size&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248406">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCreate1(flag&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248457">//sysnb&nbsp;&nbsp;&nbsp;&nbspEpollCtl(epfd&nbsp;int,&nbsp;op&nbsp;int,&nbsp;fd&nbsp;int,&nbsp;event&nbsp;*EpollEvent)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">800</span><span class="comment" id="2248531">//sys&nbsp;&nbsp;&nbsp;&nbspEpollWait(epfd&nbsp;int,&nbsp;events&nbsp;[]EpollEvent,&nbsp;msec&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248607">//sys&nbsp;&nbsp;&nbsp;&nbspExit(code&nbsp;int)&nbsp;=&nbsp;SYS_EXIT_GROUP</span><br>
<span class="lineno"></span><span class="comment" id="2248645">//sys&nbsp;&nbsp;&nbsp;&nbspFaccessat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248721">//sys&nbsp;&nbsp;&nbsp;&nbspFallocate(fd&nbsp;int,&nbsp;mode&nbsp;uint32,&nbsp;off&nbsp;int64,&nbsp;len&nbsp;int64)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248792">//sys&nbsp;&nbsp;&nbsp;&nbspFchdir(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">805</span><span class="comment" id="2248825">//sys&nbsp;&nbsp;&nbsp;&nbspFchmod(fd&nbsp;int,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248871">//sys&nbsp;&nbsp;&nbsp;&nbspFchmodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2248946">//sys&nbsp;&nbsp;&nbsp;&nbspFchownat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;uid&nbsp;int,&nbsp;gid&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249026">//sys&nbsp;&nbsp;&nbsp;&nbspfcntl(fd&nbsp;int,&nbsp;cmd&nbsp;int,&nbsp;arg&nbsp;int)&nbsp;(val&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249085">//sys&nbsp;&nbsp;&nbsp;&nbspFdatasync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">810</span><span class="comment" id="2249121">//sys&nbsp;&nbsp;&nbsp;&nbspFlock(fd&nbsp;int,&nbsp;how&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249162">//sys&nbsp;&nbsp;&nbsp;&nbspFsync(fd&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249194">//sys&nbsp;&nbsp;&nbsp;&nbspGetdents(fd&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_GETDENTS64</span><br>
<span class="lineno"></span><span class="comment" id="2249265">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgid(pid&nbsp;int)&nbsp;(pgid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249312">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpgrp()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno">815</span><span class="comment" id="2249340">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetpid()&nbsp;(pid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2249367">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetppid()&nbsp;(ppid&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2249396">//sys&nbsp;&nbsp;&nbsp;&nbspGetpriority(which&nbsp;int,&nbsp;who&nbsp;int)&nbsp;(prio&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249456">//sysnb&nbsp;&nbsp;&nbsp;&nbspGetrusage(who&nbsp;int,&nbsp;rusage&nbsp;*Rusage)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249511">//sysnb&nbsp;&nbsp;&nbsp;&nbspGettid()&nbsp;(tid&nbsp;int)</span><br>
<span class="lineno">820</span><span class="comment" id="2249538">//sys&nbsp;&nbsp;&nbsp;&nbspGetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249612">//sys&nbsp;&nbsp;&nbsp;&nbspInotifyAddWatch(fd&nbsp;int,&nbsp;pathname&nbsp;string,&nbsp;mask&nbsp;uint32)&nbsp;(watchdesc&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249699">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit()&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249741">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyInit1(flags&nbsp;int)&nbsp;(fd&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249793">//sysnb&nbsp;&nbsp;&nbsp;&nbspInotifyRmWatch(fd&nbsp;int,&nbsp;watchdesc&nbsp;uint32)&nbsp;(success&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">825</span><span class="comment" id="2249867">//sysnb&nbsp;&nbsp;&nbsp;&nbspKill(pid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2249913">//sys&nbsp;&nbsp;&nbsp;&nbspKlogctl(typ&nbsp;int,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_SYSLOG</span><br>
<span class="lineno"></span><span class="comment" id="2249980">//sys&nbsp;&nbsp;&nbsp;&nbspLink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250035">//sys&nbsp;&nbsp;&nbsp;&nbspListxattr(path&nbsp;string,&nbsp;dest&nbsp;[]byte)&nbsp;(sz&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250097">//sys&nbsp;&nbsp;&nbsp;&nbspMkdir(path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">830</span><span class="comment" id="2250147">//sys&nbsp;&nbsp;&nbsp;&nbspMkdirat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250210">//sys&nbsp;&nbsp;&nbsp;&nbspMknod(path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250269">//sys&nbsp;&nbsp;&nbsp;&nbspMknodat(dirfd&nbsp;int,&nbsp;path&nbsp;string,&nbsp;mode&nbsp;uint32,&nbsp;dev&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250341">//sys&nbsp;&nbsp;&nbsp;&nbspNanosleep(time&nbsp;*Timespec,&nbsp;leftover&nbsp;*Timespec)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250405">//sys&nbsp;&nbsp;&nbsp;&nbspPause()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">835</span><span class="comment" id="2250431">//sys&nbsp;&nbsp;&nbsp;&nbspPivotRoot(newroot&nbsp;string,&nbsp;putold&nbsp;string)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PIVOT_ROOT</span><br>
<span class="lineno"></span><span class="comment" id="2250507">//sysnb&nbsp;prlimit(pid&nbsp;int,&nbsp;resource&nbsp;int,&nbsp;old&nbsp;*Rlimit,&nbsp;newlimit&nbsp;*Rlimit)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_PRLIMIT64</span><br>
<span class="lineno"></span><span class="comment" id="2250605">//sys&nbsp;&nbsp;&nbsp;&nbspread(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250653">//sys&nbsp;&nbsp;&nbsp;&nbspReadlink(path&nbsp;string,&nbsp;buf&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250712">//sys&nbsp;&nbsp;&nbsp;&nbspRemovexattr(path&nbsp;string,&nbsp;attr&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">840</span><span class="comment" id="2250768">//sys&nbsp;&nbsp;&nbsp;&nbspRename(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250825">//sys&nbsp;&nbsp;&nbsp;&nbspRenameat(olddirfd&nbsp;int,&nbsp;oldpath&nbsp;string,&nbsp;newdirfd&nbsp;int,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250912">//sys&nbsp;&nbsp;&nbsp;&nbspRmdir(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250949">//sys&nbsp;&nbsp;&nbsp;&nbspSetdomainname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2250991">//sys&nbsp;&nbsp;&nbsp;&nbspSethostname(p&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">845</span><span class="comment" id="2251031">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetpgid(pid&nbsp;int,&nbsp;pgid&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251078">//sysnb&nbsp;&nbsp;&nbsp;&nbspSetsid()&nbsp;(pid&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251116">//sysnb&nbsp;&nbsp;&nbsp;&nbspSettimeofday(tv&nbsp;*Timeval)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2251163">//&nbsp;issue&nbsp;1435.</span><br>
<span class="lineno">850</span><span class="comment" id="2251178">//&nbsp;On&nbsp;linux&nbsp;Setuid&nbsp;and&nbsp;Setgid&nbsp;only&nbsp;affects&nbsp;the&nbsp;current&nbsp;thread,&nbsp;not&nbsp;the&nbsp;process.</span><br>
<span class="lineno"></span><span class="comment" id="2251258">//&nbsp;This&nbsp;does&nbsp;not&nbsp;match&nbsp;what&nbsp;most&nbsp;callers&nbsp;expect&nbsp;so&nbsp;we&nbsp;must&nbsp;return&nbsp;an&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="2251333">//&nbsp;here&nbsp;rather&nbsp;than&nbsp;letting&nbsp;the&nbsp;caller&nbsp;think&nbsp;that&nbsp;the&nbsp;call&nbsp;succeeded.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2251404">func</span>&nbsp;<span class="ident" id="2251409">Setuid</span><span class="op" id="2251415">(</span><span class="ident" id="2251416">uid</span>&nbsp;<span class="builtintype" id="2251420">int</span><span class="op" id="2251423">)</span>&nbsp;<span class="op" id="2251425">(</span><span class="ident" id="2251426">err</span>&nbsp;<span class="builtintype" id="2251430">error</span><span class="op" id="2251435">)</span>&nbsp;<span class="op" id="2251437">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251440">return</span>&nbsp;<span class="ident" id="2251447">EOPNOTSUPP</span><br>
<span class="lineno"></span><span class="op" id="2251458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2251461">func</span>&nbsp;<span class="ident" id="2251466">Setgid</span><span class="op" id="2251472">(</span><span class="ident" id="2251473">uid</span>&nbsp;<span class="builtintype" id="2251477">int</span><span class="op" id="2251480">)</span>&nbsp;<span class="op" id="2251482">(</span><span class="ident" id="2251483">err</span>&nbsp;<span class="builtintype" id="2251487">error</span><span class="op" id="2251492">)</span>&nbsp;<span class="op" id="2251494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2251497">return</span>&nbsp;<span class="ident" id="2251504">EOPNOTSUPP</span><br>
<span class="lineno">860</span><span class="op" id="2251515">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2251518">//sys&nbsp;&nbsp;&nbsp;&nbspSetpriority(which&nbsp;int,&nbsp;who&nbsp;int,&nbsp;prio&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251578">//sys&nbsp;&nbsp;&nbsp;&nbspSetxattr(path&nbsp;string,&nbsp;attr&nbsp;string,&nbsp;data&nbsp;[]byte,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251655">//sys&nbsp;&nbsp;&nbsp;&nbspSymlink(oldpath&nbsp;string,&nbsp;newpath&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">865</span><span class="comment" id="2251713">//sys&nbsp;&nbsp;&nbsp;&nbspSync()</span><br>
<span class="lineno"></span><span class="comment" id="2251726">//sysnb&nbsp;&nbsp;&nbsp;&nbspSysinfo(info&nbsp;*Sysinfo_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251771">//sys&nbsp;&nbsp;&nbsp;&nbspTee(rfd&nbsp;int,&nbsp;wfd&nbsp;int,&nbsp;len&nbsp;int,&nbsp;flags&nbsp;int)&nbsp;(n&nbsp;int64,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251840">//sysnb&nbsp;&nbsp;&nbsp;&nbspTgkill(tgid&nbsp;int,&nbsp;tid&nbsp;int,&nbsp;sig&nbsp;Signal)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2251898">//sysnb&nbsp;&nbsp;&nbsp;&nbspTimes(tms&nbsp;*Tms)&nbsp;(ticks&nbsp;uintptr,&nbsp;err&nbsp;error)</span><br>
<span class="lineno">870</span><span class="comment" id="2251949">//sysnb&nbsp;&nbsp;&nbsp;&nbspUmask(mask&nbsp;int)&nbsp;(oldmask&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="2251987">//sysnb&nbsp;&nbsp;&nbsp;&nbspUname(buf&nbsp;*Utsname)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252027">//sys&nbsp;&nbsp;&nbsp;&nbspUnlink(path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252065">//sys&nbsp;&nbsp;&nbsp;&nbspUnlinkat(dirfd&nbsp;int,&nbsp;path&nbsp;string)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252116">//sys&nbsp;&nbsp;&nbsp;&nbspUnmount(target&nbsp;string,&nbsp;flags&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_UMOUNT2</span><br>
<span class="lineno">875</span><span class="comment" id="2252182">//sys&nbsp;&nbsp;&nbsp;&nbspUnshare(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252219">//sys&nbsp;&nbsp;&nbsp;&nbspUstat(dev&nbsp;int,&nbsp;ubuf&nbsp;*Ustat_t)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252267">//sys&nbsp;&nbsp;&nbsp;&nbspUtime(path&nbsp;string,&nbsp;buf&nbsp;*Utimbuf)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252318">//sys&nbsp;&nbsp;&nbsp;&nbspwrite(fd&nbsp;int,&nbsp;p&nbsp;[]byte)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2252367">//sys&nbsp;&nbsp;&nbsp;&nbspexitThread(code&nbsp;int)&nbsp;(err&nbsp;error)&nbsp;=&nbsp;SYS_EXIT</span><br>
<span class="lineno">880</span><span class="comment" id="2252417">//sys&nbsp;&nbsp;&nbsp;&nbspreadlen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_READ</span><br>
<span class="lineno"></span><span class="comment" id="2252486">//sys&nbsp;&nbsp;&nbsp;&nbspwritelen(fd&nbsp;int,&nbsp;p&nbsp;*byte,&nbsp;np&nbsp;int)&nbsp;(n&nbsp;int,&nbsp;err&nbsp;error)&nbsp;=&nbsp;SYS_WRITE</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2252558">//&nbsp;mmap&nbsp;varies&nbsp;by&nbsp;architecture;&nbsp;see&nbsp;syscall_linux_*.go.</span><br>
<span class="lineno"></span><span class="comment" id="2252614">//sys&nbsp;&nbsp;&nbsp;&nbspmunmap(addr&nbsp;uintptr,&nbsp;length&nbsp;uintptr)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">885</span><br>
<span class="lineno"></span><span class="keyword" id="2252670">var</span>&nbsp;<span class="ident" id="2252674">mapper</span>&nbsp;<span class="op" id="2252681">=</span>&nbsp;<span class="op" id="2252683">&amp;</span><span class="ident" id="2252684">mmapper</span><span class="op" id="2252691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252694">active</span><span class="op" id="2252700">:</span>&nbsp;<span class="builtinfunc" id="2252702">make</span><span class="op" id="2252706">(</span><span class="keyword" id="2252707">map</span><span class="op" id="2252710">[</span><span class="op" id="2252711">*</span><span class="builtintype" id="2252712">byte</span><span class="op" id="2252716">]</span><span class="op" id="2252717">[</span><span class="op" id="2252718">]</span><span class="builtintype" id="2252719">byte</span><span class="op" id="2252723">)</span><span class="op" id="2252724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252727">mmap</span><span class="op" id="2252731">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2252735">mmap</span><span class="op" id="2252739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2252742">munmap</span><span class="op" id="2252748">:</span>&nbsp;<span class="ident" id="2252750">munmap</span><span class="op" id="2252756">,</span><br>
<span class="lineno">890</span><span class="op" id="2252758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2252761">func</span>&nbsp;<span class="ident" id="2252766">Mmap</span><span class="op" id="2252770">(</span><span class="ident" id="2252771">fd</span>&nbsp;<span class="builtintype" id="2252774">int</span><span class="op" id="2252777">,</span>&nbsp;<span class="ident" id="2252779">offset</span>&nbsp;<span class="ident" id="2252786">int64</span><span class="op" id="2252791">,</span>&nbsp;<span class="ident" id="2252793">length</span>&nbsp;<span class="builtintype" id="2252800">int</span><span class="op" id="2252803">,</span>&nbsp;<span class="ident" id="2252805">prot</span>&nbsp;<span class="builtintype" id="2252810">int</span><span class="op" id="2252813">,</span>&nbsp;<span class="ident" id="2252815">flags</span>&nbsp;<span class="builtintype" id="2252821">int</span><span class="op" id="2252824">)</span>&nbsp;<span class="op" id="2252826">(</span><span class="ident" id="2252827">data</span>&nbsp;<span class="op" id="2252832">[</span><span class="op" id="2252833">]</span><span class="builtintype" id="2252834">byte</span><span class="op" id="2252838">,</span>&nbsp;<span class="ident" id="2252840">err</span>&nbsp;<span class="builtintype" id="2252844">error</span><span class="op" id="2252849">)</span>&nbsp;<span class="op" id="2252851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252854">return</span>&nbsp;<span class="ident" id="2252861">mapper</span><span class="op" id="2252867">.</span><span class="ident" id="2252868">Mmap</span><span class="op" id="2252872">(</span><span class="ident" id="2252873">fd</span><span class="op" id="2252875">,</span>&nbsp;<span class="ident" id="2252877">offset</span><span class="op" id="2252883">,</span>&nbsp;<span class="ident" id="2252885">length</span><span class="op" id="2252891">,</span>&nbsp;<span class="ident" id="2252893">prot</span><span class="op" id="2252897">,</span>&nbsp;<span class="ident" id="2252899">flags</span><span class="op" id="2252904">)</span><br>
<span class="lineno"></span><span class="op" id="2252906">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span><span class="keyword" id="2252909">func</span>&nbsp;<span class="ident" id="2252914">Munmap</span><span class="op" id="2252920">(</span><span class="ident" id="2252921">b</span>&nbsp;<span class="op" id="2252923">[</span><span class="op" id="2252924">]</span><span class="builtintype" id="2252925">byte</span><span class="op" id="2252929">)</span>&nbsp;<span class="op" id="2252931">(</span><span class="ident" id="2252932">err</span>&nbsp;<span class="builtintype" id="2252936">error</span><span class="op" id="2252941">)</span>&nbsp;<span class="op" id="2252943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2252946">return</span>&nbsp;<span class="ident" id="2252953">mapper</span><span class="op" id="2252959">.</span><span class="ident" id="2252960">Munmap</span><span class="op" id="2252966">(</span><span class="ident" id="2252967">b</span><span class="op" id="2252968">)</span><br>
<span class="lineno"></span><span class="op" id="2252970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">900</span><span class="comment" id="2252973">//sys&nbsp;&nbsp;&nbsp;&nbspMadvise(b&nbsp;[]byte,&nbsp;advice&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2253021">//sys&nbsp;&nbsp;&nbsp;&nbspMprotect(b&nbsp;[]byte,&nbsp;prot&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2253068">//sys&nbsp;&nbsp;&nbsp;&nbspMlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2253102">//sys&nbsp;&nbsp;&nbsp;&nbspMunlock(b&nbsp;[]byte)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="2253138">//sys&nbsp;&nbsp;&nbsp;&nbspMlockall(flags&nbsp;int)&nbsp;(err&nbsp;error)</span><br>
<span class="lineno">905</span><span class="comment" id="2253176">//sys&nbsp;&nbsp;&nbsp;&nbspMunlockall()&nbsp;(err&nbsp;error)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2253208">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Unimplemented<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno">910</span><span class="comment" id="2253232">//&nbsp;AddKey</span><br>
<span class="lineno"></span><span class="comment" id="2253242">//&nbsp;AfsSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2253256">//&nbsp;Alarm</span><br>
<span class="lineno"></span><span class="comment" id="2253265">//&nbsp;ArchPrctl</span><br>
<span class="lineno"></span><span class="comment" id="2253278">//&nbsp;Brk</span><br>
<span class="lineno">915</span><span class="comment" id="2253285">//&nbsp;Capget</span><br>
<span class="lineno"></span><span class="comment" id="2253295">//&nbsp;Capset</span><br>
<span class="lineno"></span><span class="comment" id="2253305">//&nbsp;ClockGetres</span><br>
<span class="lineno"></span><span class="comment" id="2253320">//&nbsp;ClockGettime</span><br>
<span class="lineno"></span><span class="comment" id="2253336">//&nbsp;ClockNanosleep</span><br>
<span class="lineno">920</span><span class="comment" id="2253354">//&nbsp;ClockSettime</span><br>
<span class="lineno"></span><span class="comment" id="2253370">//&nbsp;Clone</span><br>
<span class="lineno"></span><span class="comment" id="2253379">//&nbsp;CreateModule</span><br>
<span class="lineno"></span><span class="comment" id="2253395">//&nbsp;DeleteModule</span><br>
<span class="lineno"></span><span class="comment" id="2253411">//&nbsp;EpollCtlOld</span><br>
<span class="lineno">925</span><span class="comment" id="2253426">//&nbsp;EpollPwait</span><br>
<span class="lineno"></span><span class="comment" id="2253440">//&nbsp;EpollWaitOld</span><br>
<span class="lineno"></span><span class="comment" id="2253456">//&nbsp;Eventfd</span><br>
<span class="lineno"></span><span class="comment" id="2253467">//&nbsp;Execve</span><br>
<span class="lineno"></span><span class="comment" id="2253477">//&nbsp;Fadvise64</span><br>
<span class="lineno">930</span><span class="comment" id="2253490">//&nbsp;Fgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2253503">//&nbsp;Flistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2253517">//&nbsp;Fork</span><br>
<span class="lineno"></span><span class="comment" id="2253525">//&nbsp;Fremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2253541">//&nbsp;Fsetxattr</span><br>
<span class="lineno">935</span><span class="comment" id="2253554">//&nbsp;Futex</span><br>
<span class="lineno"></span><span class="comment" id="2253563">//&nbsp;GetKernelSyms</span><br>
<span class="lineno"></span><span class="comment" id="2253580">//&nbsp;GetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2253596">//&nbsp;GetRobustList</span><br>
<span class="lineno"></span><span class="comment" id="2253613">//&nbsp;GetThreadArea</span><br>
<span class="lineno">940</span><span class="comment" id="2253630">//&nbsp;Getitimer</span><br>
<span class="lineno"></span><span class="comment" id="2253643">//&nbsp;Getpmsg</span><br>
<span class="lineno"></span><span class="comment" id="2253654">//&nbsp;IoCancel</span><br>
<span class="lineno"></span><span class="comment" id="2253666">//&nbsp;IoDestroy</span><br>
<span class="lineno"></span><span class="comment" id="2253679">//&nbsp;IoGetevents</span><br>
<span class="lineno">945</span><span class="comment" id="2253694">//&nbsp;IoSetup</span><br>
<span class="lineno"></span><span class="comment" id="2253705">//&nbsp;IoSubmit</span><br>
<span class="lineno"></span><span class="comment" id="2253717">//&nbsp;Ioctl</span><br>
<span class="lineno"></span><span class="comment" id="2253726">//&nbsp;IoprioGet</span><br>
<span class="lineno"></span><span class="comment" id="2253739">//&nbsp;IoprioSet</span><br>
<span class="lineno">950</span><span class="comment" id="2253752">//&nbsp;KexecLoad</span><br>
<span class="lineno"></span><span class="comment" id="2253765">//&nbsp;Keyctl</span><br>
<span class="lineno"></span><span class="comment" id="2253775">//&nbsp;Lgetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2253788">//&nbsp;Llistxattr</span><br>
<span class="lineno"></span><span class="comment" id="2253802">//&nbsp;LookupDcookie</span><br>
<span class="lineno">955</span><span class="comment" id="2253819">//&nbsp;Lremovexattr</span><br>
<span class="lineno"></span><span class="comment" id="2253835">//&nbsp;Lsetxattr</span><br>
<span class="lineno"></span><span class="comment" id="2253848">//&nbsp;Mbind</span><br>
<span class="lineno"></span><span class="comment" id="2253857">//&nbsp;MigratePages</span><br>
<span class="lineno"></span><span class="comment" id="2253873">//&nbsp;Mincore</span><br>
<span class="lineno">960</span><span class="comment" id="2253884">//&nbsp;ModifyLdt</span><br>
<span class="lineno"></span><span class="comment" id="2253897">//&nbsp;Mount</span><br>
<span class="lineno"></span><span class="comment" id="2253906">//&nbsp;MovePages</span><br>
<span class="lineno"></span><span class="comment" id="2253919">//&nbsp;Mprotect</span><br>
<span class="lineno"></span><span class="comment" id="2253931">//&nbsp;MqGetsetattr</span><br>
<span class="lineno">965</span><span class="comment" id="2253947">//&nbsp;MqNotify</span><br>
<span class="lineno"></span><span class="comment" id="2253959">//&nbsp;MqOpen</span><br>
<span class="lineno"></span><span class="comment" id="2253969">//&nbsp;MqTimedreceive</span><br>
<span class="lineno"></span><span class="comment" id="2253987">//&nbsp;MqTimedsend</span><br>
<span class="lineno"></span><span class="comment" id="2254002">//&nbsp;MqUnlink</span><br>
<span class="lineno">970</span><span class="comment" id="2254014">//&nbsp;Mremap</span><br>
<span class="lineno"></span><span class="comment" id="2254024">//&nbsp;Msgctl</span><br>
<span class="lineno"></span><span class="comment" id="2254034">//&nbsp;Msgget</span><br>
<span class="lineno"></span><span class="comment" id="2254044">//&nbsp;Msgrcv</span><br>
<span class="lineno"></span><span class="comment" id="2254054">//&nbsp;Msgsnd</span><br>
<span class="lineno">975</span><span class="comment" id="2254064">//&nbsp;Msync</span><br>
<span class="lineno"></span><span class="comment" id="2254073">//&nbsp;Newfstatat</span><br>
<span class="lineno"></span><span class="comment" id="2254087">//&nbsp;Nfsservctl</span><br>
<span class="lineno"></span><span class="comment" id="2254101">//&nbsp;Personality</span><br>
<span class="lineno"></span><span class="comment" id="2254116">//&nbsp;Poll</span><br>
<span class="lineno">980</span><span class="comment" id="2254124">//&nbsp;Ppoll</span><br>
<span class="lineno"></span><span class="comment" id="2254133">//&nbsp;Prctl</span><br>
<span class="lineno"></span><span class="comment" id="2254142">//&nbsp;Pselect6</span><br>
<span class="lineno"></span><span class="comment" id="2254154">//&nbsp;Ptrace</span><br>
<span class="lineno"></span><span class="comment" id="2254164">//&nbsp;Putpmsg</span><br>
<span class="lineno">985</span><span class="comment" id="2254175">//&nbsp;QueryModule</span><br>
<span class="lineno"></span><span class="comment" id="2254190">//&nbsp;Quotactl</span><br>
<span class="lineno"></span><span class="comment" id="2254202">//&nbsp;Readahead</span><br>
<span class="lineno"></span><span class="comment" id="2254215">//&nbsp;Readv</span><br>
<span class="lineno"></span><span class="comment" id="2254224">//&nbsp;RemapFilePages</span><br>
<span class="lineno">990</span><span class="comment" id="2254242">//&nbsp;RequestKey</span><br>
<span class="lineno"></span><span class="comment" id="2254256">//&nbsp;RestartSyscall</span><br>
<span class="lineno"></span><span class="comment" id="2254274">//&nbsp;RtSigaction</span><br>
<span class="lineno"></span><span class="comment" id="2254289">//&nbsp;RtSigpending</span><br>
<span class="lineno"></span><span class="comment" id="2254305">//&nbsp;RtSigprocmask</span><br>
<span class="lineno">995</span><span class="comment" id="2254322">//&nbsp;RtSigqueueinfo</span><br>
<span class="lineno"></span><span class="comment" id="2254340">//&nbsp;RtSigreturn</span><br>
<span class="lineno"></span><span class="comment" id="2254355">//&nbsp;RtSigsuspend</span><br>
<span class="lineno"></span><span class="comment" id="2254371">//&nbsp;RtSigtimedwait</span><br>
<span class="lineno"></span><span class="comment" id="2254389">//&nbsp;SchedGetPriorityMax</span><br>
<span class="lineno">1000</span><span class="comment" id="2254412">//&nbsp;SchedGetPriorityMin</span><br>
<span class="lineno"></span><span class="comment" id="2254435">//&nbsp;SchedGetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2254455">//&nbsp;SchedGetparam</span><br>
<span class="lineno"></span><span class="comment" id="2254472">//&nbsp;SchedGetscheduler</span><br>
<span class="lineno"></span><span class="comment" id="2254493">//&nbsp;SchedRrGetInterval</span><br>
<span class="lineno">1005</span><span class="comment" id="2254515">//&nbsp;SchedSetaffinity</span><br>
<span class="lineno"></span><span class="comment" id="2254535">//&nbsp;SchedSetparam</span><br>
<span class="lineno"></span><span class="comment" id="2254552">//&nbsp;SchedYield</span><br>
<span class="lineno"></span><span class="comment" id="2254566">//&nbsp;Security</span><br>
<span class="lineno"></span><span class="comment" id="2254578">//&nbsp;Semctl</span><br>
<span class="lineno">1010</span><span class="comment" id="2254588">//&nbsp;Semget</span><br>
<span class="lineno"></span><span class="comment" id="2254598">//&nbsp;Semop</span><br>
<span class="lineno"></span><span class="comment" id="2254607">//&nbsp;Semtimedop</span><br>
<span class="lineno"></span><span class="comment" id="2254621">//&nbsp;SetMempolicy</span><br>
<span class="lineno"></span><span class="comment" id="2254637">//&nbsp;SetRobustList</span><br>
<span class="lineno">1015</span><span class="comment" id="2254654">//&nbsp;SetThreadArea</span><br>
<span class="lineno"></span><span class="comment" id="2254671">//&nbsp;SetTidAddress</span><br>
<span class="lineno"></span><span class="comment" id="2254688">//&nbsp;Shmat</span><br>
<span class="lineno"></span><span class="comment" id="2254697">//&nbsp;Shmctl</span><br>
<span class="lineno"></span><span class="comment" id="2254707">//&nbsp;Shmdt</span><br>
<span class="lineno">1020</span><span class="comment" id="2254716">//&nbsp;Shmget</span><br>
<span class="lineno"></span><span class="comment" id="2254726">//&nbsp;Sigaltstack</span><br>
<span class="lineno"></span><span class="comment" id="2254741">//&nbsp;Signalfd</span><br>
<span class="lineno"></span><span class="comment" id="2254753">//&nbsp;Swapoff</span><br>
<span class="lineno"></span><span class="comment" id="2254764">//&nbsp;Swapon</span><br>
<span class="lineno">1025</span><span class="comment" id="2254774">//&nbsp;Sysfs</span><br>
<span class="lineno"></span><span class="comment" id="2254783">//&nbsp;TimerCreate</span><br>
<span class="lineno"></span><span class="comment" id="2254798">//&nbsp;TimerDelete</span><br>
<span class="lineno"></span><span class="comment" id="2254813">//&nbsp;TimerGetoverrun</span><br>
<span class="lineno"></span><span class="comment" id="2254832">//&nbsp;TimerGettime</span><br>
<span class="lineno">1030</span><span class="comment" id="2254848">//&nbsp;TimerSettime</span><br>
<span class="lineno"></span><span class="comment" id="2254864">//&nbsp;Timerfd</span><br>
<span class="lineno"></span><span class="comment" id="2254875">//&nbsp;Tkill&nbsp;(obsolete)</span><br>
<span class="lineno"></span><span class="comment" id="2254895">//&nbsp;Tuxcall</span><br>
<span class="lineno"></span><span class="comment" id="2254906">//&nbsp;Umount2</span><br>
<span class="lineno">1035</span><span class="comment" id="2254917">//&nbsp;Uselib</span><br>
<span class="lineno"></span><span class="comment" id="2254927">//&nbsp;Utimensat</span><br>
<span class="lineno"></span><span class="comment" id="2254940">//&nbsp;Vfork</span><br>
<span class="lineno"></span><span class="comment" id="2254949">//&nbsp;Vhangup</span><br>
<span class="lineno"></span><span class="comment" id="2254960">//&nbsp;Vmsplice</span><br>
<span class="lineno">1040</span><span class="comment" id="2254972">//&nbsp;Vserver</span><br>
<span class="lineno"></span><span class="comment" id="2254983">//&nbsp;Waitid</span><br>
<span class="lineno"></span><span class="comment" id="2254993">//&nbsp;_Sysctl</span>
</div>
</body>
</html>
