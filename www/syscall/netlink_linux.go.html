<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="2112214">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2112270">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2112324">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2112375">//&nbsp;Netlink&nbsp;sockets&nbsp;and&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2112408">package</span>&nbsp;<span class="ident" id="2112416">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2112425">import</span>&nbsp;<span class="string" id="2112432">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2112442">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;message&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2112508">func</span>&nbsp;<span class="ident" id="2112513">nlmAlignOf</span><span class="op" id="2112523">(</span><span class="ident" id="2112524">msglen</span>&nbsp;<span class="builtintype" id="2112531">int</span><span class="op" id="2112534">)</span>&nbsp;<span class="builtintype" id="2112536">int</span>&nbsp;<span class="op" id="2112540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112543">return</span>&nbsp;<span class="op" id="2112550">(</span><span class="ident" id="2112551"><a href="/syscall/netlink_linux.go.html#2112524">msglen</a></span>&nbsp;<span class="op" id="2112558">+</span>&nbsp;<span class="ident" id="2112560"><a href="/syscall/zerrors_linux_amd64.go.html#2189417">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="2112574">-</span>&nbsp;<span class="num" id="2112576">1</span><span class="op" id="2112577">)</span>&nbsp;<span class="op" id="2112579">&amp;</span>&nbsp;<span class="op" id="2112581">^</span><span class="op" id="2112582">(</span><span class="ident" id="2112583"><a href="/syscall/zerrors_linux_amd64.go.html#2189417">NLMSG_ALIGNTO</a></span>&nbsp;<span class="op" id="2112597">-</span>&nbsp;<span class="num" id="2112599">1</span><span class="op" id="2112600">)</span><br>
<span class="lineno"></span><span class="op" id="2112602">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2112605">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute&nbsp;up&nbsp;to&nbsp;align&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2112669">//&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2112682">func</span>&nbsp;<span class="ident" id="2112687">rtaAlignOf</span><span class="op" id="2112697">(</span><span class="ident" id="2112698">attrlen</span>&nbsp;<span class="builtintype" id="2112706">int</span><span class="op" id="2112709">)</span>&nbsp;<span class="builtintype" id="2112711">int</span>&nbsp;<span class="op" id="2112715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2112718">return</span>&nbsp;<span class="op" id="2112725">(</span><span class="ident" id="2112726"><a href="/syscall/netlink_linux.go.html#2112698">attrlen</a></span>&nbsp;<span class="op" id="2112734">+</span>&nbsp;<span class="ident" id="2112736"><a href="/syscall/zerrors_linux_amd64.go.html#2197500">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="2112748">-</span>&nbsp;<span class="num" id="2112750">1</span><span class="op" id="2112751">)</span>&nbsp;<span class="op" id="2112753">&amp;</span>&nbsp;<span class="op" id="2112755">^</span><span class="op" id="2112756">(</span><span class="ident" id="2112757"><a href="/syscall/zerrors_linux_amd64.go.html#2197500">RTA_ALIGNTO</a></span>&nbsp;<span class="op" id="2112769">-</span>&nbsp;<span class="num" id="2112771">1</span><span class="op" id="2112772">)</span><br>
<span class="lineno">20</span><span class="op" id="2112774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2112777">//&nbsp;NetlinkRouteRequest&nbsp;represents&nbsp;a&nbsp;request&nbsp;message&nbsp;to&nbsp;receive&nbsp;routing</span><br>
<span class="lineno"></span><span class="comment" id="2112848">//&nbsp;and&nbsp;link&nbsp;states&nbsp;from&nbsp;the&nbsp;kernel.</span><br>
<span class="lineno"></span><span class="keyword" id="2112884">type</span>&nbsp;<span class="ident" id="2112889">NetlinkRouteRequest</span>&nbsp;<span class="keyword" id="2112909">struct</span>&nbsp;<span class="op" id="2112916">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112919">Header</span>&nbsp;<span class="ident" id="2112926"><a href="/syscall/ztypes_linux_amd64.go.html#2287272">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2112936">Data</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2112943"><a href="/syscall/ztypes_linux_amd64.go.html#2287423">RtGenmsg</a></span><br>
<span class="lineno"></span><span class="op" id="2112952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2112955">func</span>&nbsp;<span class="op" id="2112960">(</span><span class="ident" id="2112961">rr</span>&nbsp;<span class="op" id="2112964">*</span><span class="ident" id="2112965"><a href="/syscall/netlink_linux.go.html#2112889">NetlinkRouteRequest</a></span><span class="op" id="2112984">)</span>&nbsp;<span class="ident" id="2112986">toWireFormat</span><span class="op" id="2112998">(</span><span class="op" id="2112999">)</span>&nbsp;<span class="op" id="2113001">[</span><span class="op" id="2113002">]</span><span class="builtintype" id="2113003">byte</span>&nbsp;<span class="op" id="2113008">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113011">b</span>&nbsp;<span class="op" id="2113013">:=</span>&nbsp;<span class="builtinfunc" id="2113016">make</span><span class="op" id="2113020">(</span><span class="op" id="2113021">[</span><span class="op" id="2113022">]</span><span class="builtintype" id="2113023">byte</span><span class="op" id="2113027">,</span>&nbsp;<span class="ident" id="2113029"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113031">.</span><span class="ident" id="2113032">Header</span><span class="op" id="2113038">.</span><span class="ident" id="2113039">Len</span><span class="op" id="2113042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113045">*</span><span class="op" id="2113046">(</span><span class="op" id="2113047">*</span><span class="builtintype" id="2113048">uint32</span><span class="op" id="2113054">)</span><span class="op" id="2113055">(</span><span class="ident" id="2113056"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2113062">.</span><span class="ident" id="2113063">Pointer</span><span class="op" id="2113070">(</span><span class="op" id="2113071">&amp;</span><span class="ident" id="2113072"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113073">[</span><span class="num" id="2113074">0</span><span class="op" id="2113075">:</span><span class="num" id="2113076">4</span><span class="op" id="2113077">]</span><span class="op" id="2113078">[</span><span class="num" id="2113079">0</span><span class="op" id="2113080">]</span><span class="op" id="2113081">)</span><span class="op" id="2113082">)</span>&nbsp;<span class="op" id="2113084">=</span>&nbsp;<span class="ident" id="2113086"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113088">.</span><span class="ident" id="2113089">Header</span><span class="op" id="2113095">.</span><span class="ident" id="2113096">Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113101">*</span><span class="op" id="2113102">(</span><span class="op" id="2113103">*</span><span class="builtintype" id="2113104">uint16</span><span class="op" id="2113110">)</span><span class="op" id="2113111">(</span><span class="ident" id="2113112"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2113118">.</span><span class="ident" id="2113119">Pointer</span><span class="op" id="2113126">(</span><span class="op" id="2113127">&amp;</span><span class="ident" id="2113128"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113129">[</span><span class="num" id="2113130">4</span><span class="op" id="2113131">:</span><span class="num" id="2113132">6</span><span class="op" id="2113133">]</span><span class="op" id="2113134">[</span><span class="num" id="2113135">0</span><span class="op" id="2113136">]</span><span class="op" id="2113137">)</span><span class="op" id="2113138">)</span>&nbsp;<span class="op" id="2113140">=</span>&nbsp;<span class="ident" id="2113142"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113144">.</span><span class="ident" id="2113145">Header</span><span class="op" id="2113151">.</span><span class="ident" id="2113152">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113158">*</span><span class="op" id="2113159">(</span><span class="op" id="2113160">*</span><span class="builtintype" id="2113161">uint16</span><span class="op" id="2113167">)</span><span class="op" id="2113168">(</span><span class="ident" id="2113169"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2113175">.</span><span class="ident" id="2113176">Pointer</span><span class="op" id="2113183">(</span><span class="op" id="2113184">&amp;</span><span class="ident" id="2113185"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113186">[</span><span class="num" id="2113187">6</span><span class="op" id="2113188">:</span><span class="num" id="2113189">8</span><span class="op" id="2113190">]</span><span class="op" id="2113191">[</span><span class="num" id="2113192">0</span><span class="op" id="2113193">]</span><span class="op" id="2113194">)</span><span class="op" id="2113195">)</span>&nbsp;<span class="op" id="2113197">=</span>&nbsp;<span class="ident" id="2113199"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113201">.</span><span class="ident" id="2113202">Header</span><span class="op" id="2113208">.</span><span class="ident" id="2113209">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113216">*</span><span class="op" id="2113217">(</span><span class="op" id="2113218">*</span><span class="builtintype" id="2113219">uint32</span><span class="op" id="2113225">)</span><span class="op" id="2113226">(</span><span class="ident" id="2113227"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2113233">.</span><span class="ident" id="2113234">Pointer</span><span class="op" id="2113241">(</span><span class="op" id="2113242">&amp;</span><span class="ident" id="2113243"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113244">[</span><span class="num" id="2113245">8</span><span class="op" id="2113246">:</span><span class="num" id="2113247">12</span><span class="op" id="2113249">]</span><span class="op" id="2113250">[</span><span class="num" id="2113251">0</span><span class="op" id="2113252">]</span><span class="op" id="2113253">)</span><span class="op" id="2113254">)</span>&nbsp;<span class="op" id="2113256">=</span>&nbsp;<span class="ident" id="2113258"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113260">.</span><span class="ident" id="2113261">Header</span><span class="op" id="2113267">.</span><span class="ident" id="2113268">Seq</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113273">*</span><span class="op" id="2113274">(</span><span class="op" id="2113275">*</span><span class="builtintype" id="2113276">uint32</span><span class="op" id="2113282">)</span><span class="op" id="2113283">(</span><span class="ident" id="2113284"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2113290">.</span><span class="ident" id="2113291">Pointer</span><span class="op" id="2113298">(</span><span class="op" id="2113299">&amp;</span><span class="ident" id="2113300"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113301">[</span><span class="num" id="2113302">12</span><span class="op" id="2113304">:</span><span class="num" id="2113305">16</span><span class="op" id="2113307">]</span><span class="op" id="2113308">[</span><span class="num" id="2113309">0</span><span class="op" id="2113310">]</span><span class="op" id="2113311">)</span><span class="op" id="2113312">)</span>&nbsp;<span class="op" id="2113314">=</span>&nbsp;<span class="ident" id="2113316"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113318">.</span><span class="ident" id="2113319">Header</span><span class="op" id="2113325">.</span><span class="ident" id="2113326">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113331"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><span class="op" id="2113332">[</span><span class="num" id="2113333">16</span><span class="op" id="2113335">]</span>&nbsp;<span class="op" id="2113337">=</span>&nbsp;<span class="builtintype" id="2113339">byte</span><span class="op" id="2113343">(</span><span class="ident" id="2113344"><a href="/syscall/netlink_linux.go.html#2112961">rr</a></span><span class="op" id="2113346">.</span><span class="ident" id="2113347">Data</span><span class="op" id="2113351">.</span><span class="ident" id="2113352">Family</span><span class="op" id="2113358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113361">return</span>&nbsp;<span class="ident" id="2113368"><a href="/syscall/netlink_linux.go.html#2113011">b</a></span><br>
<span class="lineno"></span><span class="op" id="2113370">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2113373">func</span>&nbsp;<span class="ident" id="2113378">newNetlinkRouteRequest</span><span class="op" id="2113400">(</span><span class="ident" id="2113401">proto</span><span class="op" id="2113406">,</span>&nbsp;<span class="ident" id="2113408">seq</span><span class="op" id="2113411">,</span>&nbsp;<span class="ident" id="2113413">family</span>&nbsp;<span class="builtintype" id="2113420">int</span><span class="op" id="2113423">)</span>&nbsp;<span class="op" id="2113425">[</span><span class="op" id="2113426">]</span><span class="builtintype" id="2113427">byte</span>&nbsp;<span class="op" id="2113432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113435">rr</span>&nbsp;<span class="op" id="2113438">:=</span>&nbsp;<span class="op" id="2113441">&amp;</span><span class="ident" id="2113442"><a href="/syscall/netlink_linux.go.html#2112889">NetlinkRouteRequest</a></span><span class="op" id="2113461">{</span><span class="op" id="2113462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113465"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113467">.</span><span class="ident" id="2113468">Header</span><span class="op" id="2113474">.</span><span class="ident" id="2113475">Len</span>&nbsp;<span class="op" id="2113479">=</span>&nbsp;<span class="builtintype" id="2113481">uint32</span><span class="op" id="2113487">(</span><span class="ident" id="2113488"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2113501">+</span>&nbsp;<span class="ident" id="2113503"><a href="/syscall/ztypes_linux_amd64.go.html#2287075">SizeofRtGenmsg</a></span><span class="op" id="2113517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113520"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113522">.</span><span class="ident" id="2113523">Header</span><span class="op" id="2113529">.</span><span class="ident" id="2113530">Type</span>&nbsp;<span class="op" id="2113535">=</span>&nbsp;<span class="builtintype" id="2113537">uint16</span><span class="op" id="2113543">(</span><span class="ident" id="2113544"><a href="/syscall/netlink_linux.go.html#2113401">proto</a></span><span class="op" id="2113549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113552"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113554">.</span><span class="ident" id="2113555">Header</span><span class="op" id="2113561">.</span><span class="ident" id="2113562">Flags</span>&nbsp;<span class="op" id="2113568">=</span>&nbsp;<span class="ident" id="2113570"><a href="/syscall/zerrors_linux_amd64.go.html#2189865">NLM_F_DUMP</a></span>&nbsp;<span class="op" id="2113581">|</span>&nbsp;<span class="ident" id="2113583"><a href="/syscall/zerrors_linux_amd64.go.html#2190113">NLM_F_REQUEST</a></span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113598"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113600">.</span><span class="ident" id="2113601">Header</span><span class="op" id="2113607">.</span><span class="ident" id="2113608">Seq</span>&nbsp;<span class="op" id="2113612">=</span>&nbsp;<span class="builtintype" id="2113614">uint32</span><span class="op" id="2113620">(</span><span class="ident" id="2113621"><a href="/syscall/netlink_linux.go.html#2113408">seq</a></span><span class="op" id="2113624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113627"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113629">.</span><span class="ident" id="2113630">Data</span><span class="op" id="2113634">.</span><span class="ident" id="2113635">Family</span>&nbsp;<span class="op" id="2113642">=</span>&nbsp;<span class="builtintype" id="2113644">uint8</span><span class="op" id="2113649">(</span><span class="ident" id="2113650"><a href="/syscall/netlink_linux.go.html#2113413">family</a></span><span class="op" id="2113656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113659">return</span>&nbsp;<span class="ident" id="2113666"><a href="/syscall/netlink_linux.go.html#2113435">rr</a></span><span class="op" id="2113668">.</span><span class="ident" id="2113669">toWireFormat</span><span class="op" id="2113681">(</span><span class="op" id="2113682">)</span><br>
<span class="lineno"></span><span class="op" id="2113684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="2113687">//&nbsp;NetlinkRIB&nbsp;returns&nbsp;routing&nbsp;information&nbsp;base,&nbsp;as&nbsp;known&nbsp;as&nbsp;RIB,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2113758">//&nbsp;consists&nbsp;of&nbsp;network&nbsp;facility&nbsp;information,&nbsp;states&nbsp;and&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="keyword" id="2113826">func</span>&nbsp;<span class="ident" id="2113831">NetlinkRIB</span><span class="op" id="2113841">(</span><span class="ident" id="2113842">proto</span><span class="op" id="2113847">,</span>&nbsp;<span class="ident" id="2113849">family</span>&nbsp;<span class="builtintype" id="2113856">int</span><span class="op" id="2113859">)</span>&nbsp;<span class="op" id="2113861">(</span><span class="op" id="2113862">[</span><span class="op" id="2113863">]</span><span class="builtintype" id="2113864">byte</span><span class="op" id="2113868">,</span>&nbsp;<span class="builtintype" id="2113870">error</span><span class="op" id="2113875">)</span>&nbsp;<span class="op" id="2113877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113880">s</span><span class="op" id="2113881">,</span>&nbsp;<span class="ident" id="2113883">err</span>&nbsp;<span class="op" id="2113887">:=</span>&nbsp;<span class="ident" id="2113890"><a href="/syscall/syscall_unix.go.html#2163230">Socket</a></span><span class="op" id="2113896">(</span><span class="ident" id="2113897"><a href="/syscall/zerrors_linux_amd64.go.html#2165017">AF_NETLINK</a></span><span class="op" id="2113907">,</span>&nbsp;<span class="ident" id="2113909"><a href="/syscall/zerrors_linux_amd64.go.html#2205238">SOCK_RAW</a></span><span class="op" id="2113917">,</span>&nbsp;<span class="ident" id="2113919"><a href="/syscall/zerrors_linux_amd64.go.html#2189010">NETLINK_ROUTE</a></span><span class="op" id="2113932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113935">if</span>&nbsp;<span class="ident" id="2113938"><a href="/syscall/netlink_linux.go.html#2113883">err</a></span>&nbsp;<span class="op" id="2113942">!=</span>&nbsp;<span class="ident" id="2113945">nil</span>&nbsp;<span class="op" id="2113949">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113953">return</span>&nbsp;<span class="ident" id="2113960">nil</span><span class="op" id="2113963">,</span>&nbsp;<span class="ident" id="2113965"><a href="/syscall/netlink_linux.go.html#2113883">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2113970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2113973">defer</span>&nbsp;<span class="ident" id="2113979"><a href="/syscall/zsyscall_linux_amd64.go.html#2230053">Close</a></span><span class="op" id="2113984">(</span><span class="ident" id="2113985"><a href="/syscall/netlink_linux.go.html#2113880">s</a></span><span class="op" id="2113986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2113989">lsa</span>&nbsp;<span class="op" id="2113993">:=</span>&nbsp;<span class="op" id="2113996">&amp;</span><span class="ident" id="2113997"><a href="/syscall/syscall_linux.go.html#2132690">SockaddrNetlink</a></span><span class="op" id="2114012">{</span><span class="ident" id="2114013">Family</span><span class="op" id="2114019">:</span>&nbsp;<span class="ident" id="2114021"><a href="/syscall/zerrors_linux_amd64.go.html#2165017">AF_NETLINK</a></span><span class="op" id="2114031">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114034">if</span>&nbsp;<span class="ident" id="2114037">err</span>&nbsp;<span class="op" id="2114041">:=</span>&nbsp;<span class="ident" id="2114044"><a href="/syscall/syscall_unix.go.html#2160776">Bind</a></span><span class="op" id="2114048">(</span><span class="ident" id="2114049"><a href="/syscall/netlink_linux.go.html#2113880">s</a></span><span class="op" id="2114050">,</span>&nbsp;<span class="ident" id="2114052"><a href="/syscall/netlink_linux.go.html#2113989">lsa</a></span><span class="op" id="2114055">)</span><span class="op" id="2114056">;</span>&nbsp;<span class="ident" id="2114058"><a href="/syscall/netlink_linux.go.html#2114037">err</a></span>&nbsp;<span class="op" id="2114062">!=</span>&nbsp;<span class="ident" id="2114065">nil</span>&nbsp;<span class="op" id="2114069">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114073">return</span>&nbsp;<span class="ident" id="2114080">nil</span><span class="op" id="2114083">,</span>&nbsp;<span class="ident" id="2114085"><a href="/syscall/netlink_linux.go.html#2114037">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114093">wb</span>&nbsp;<span class="op" id="2114096">:=</span>&nbsp;<span class="ident" id="2114099"><a href="/syscall/netlink_linux.go.html#2113378">newNetlinkRouteRequest</a></span><span class="op" id="2114121">(</span><span class="ident" id="2114122"><a href="/syscall/netlink_linux.go.html#2113842">proto</a></span><span class="op" id="2114127">,</span>&nbsp;<span class="num" id="2114129">1</span><span class="op" id="2114130">,</span>&nbsp;<span class="ident" id="2114132"><a href="/syscall/netlink_linux.go.html#2113849">family</a></span><span class="op" id="2114138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114141">if</span>&nbsp;<span class="ident" id="2114144">err</span>&nbsp;<span class="op" id="2114148">:=</span>&nbsp;<span class="ident" id="2114151"><a href="/syscall/syscall_unix.go.html#2161747">Sendto</a></span><span class="op" id="2114157">(</span><span class="ident" id="2114158"><a href="/syscall/netlink_linux.go.html#2113880">s</a></span><span class="op" id="2114159">,</span>&nbsp;<span class="ident" id="2114161"><a href="/syscall/netlink_linux.go.html#2114093">wb</a></span><span class="op" id="2114163">,</span>&nbsp;<span class="num" id="2114165">0</span><span class="op" id="2114166">,</span>&nbsp;<span class="ident" id="2114168"><a href="/syscall/netlink_linux.go.html#2113989">lsa</a></span><span class="op" id="2114171">)</span><span class="op" id="2114172">;</span>&nbsp;<span class="ident" id="2114174"><a href="/syscall/netlink_linux.go.html#2114144">err</a></span>&nbsp;<span class="op" id="2114178">!=</span>&nbsp;<span class="ident" id="2114181">nil</span>&nbsp;<span class="op" id="2114185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114189">return</span>&nbsp;<span class="ident" id="2114196">nil</span><span class="op" id="2114199">,</span>&nbsp;<span class="ident" id="2114201"><a href="/syscall/netlink_linux.go.html#2114144">err</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114209">var</span>&nbsp;<span class="ident" id="2114213">tab</span>&nbsp;<span class="op" id="2114217">[</span><span class="op" id="2114218">]</span><span class="builtintype" id="2114219">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114225">rbNew</span>&nbsp;<span class="op" id="2114231">:=</span>&nbsp;<span class="builtinfunc" id="2114234">make</span><span class="op" id="2114238">(</span><span class="op" id="2114239">[</span><span class="op" id="2114240">]</span><span class="builtintype" id="2114241">byte</span><span class="op" id="2114245">,</span>&nbsp;<span class="ident" id="2114247"><a href="/syscall/syscall_linux_amd64.go.html#2155490">Getpagesize</a></span><span class="op" id="2114258">(</span><span class="op" id="2114259">)</span><span class="op" id="2114260">)</span><br>
<span class="lineno"></span><span class="ident" id="2114262">done</span><span class="op" id="2114266">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114269">for</span>&nbsp;<span class="op" id="2114273">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114277">rb</span>&nbsp;<span class="op" id="2114280">:=</span>&nbsp;<span class="ident" id="2114283"><a href="/syscall/netlink_linux.go.html#2114225">rbNew</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114291">nr</span><span class="op" id="2114293">,</span>&nbsp;<span class="ident" id="2114295">_</span><span class="op" id="2114296">,</span>&nbsp;<span class="ident" id="2114298">err</span>&nbsp;<span class="op" id="2114302">:=</span>&nbsp;<span class="ident" id="2114305"><a href="/syscall/syscall_unix.go.html#2161449">Recvfrom</a></span><span class="op" id="2114313">(</span><span class="ident" id="2114314"><a href="/syscall/netlink_linux.go.html#2113880">s</a></span><span class="op" id="2114315">,</span>&nbsp;<span class="ident" id="2114317"><a href="/syscall/netlink_linux.go.html#2114277">rb</a></span><span class="op" id="2114319">,</span>&nbsp;<span class="num" id="2114321">0</span><span class="op" id="2114322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114326">if</span>&nbsp;<span class="ident" id="2114329"><a href="/syscall/netlink_linux.go.html#2114298">err</a></span>&nbsp;<span class="op" id="2114333">!=</span>&nbsp;<span class="ident" id="2114336">nil</span>&nbsp;<span class="op" id="2114340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114345">return</span>&nbsp;<span class="ident" id="2114352">nil</span><span class="op" id="2114355">,</span>&nbsp;<span class="ident" id="2114357"><a href="/syscall/netlink_linux.go.html#2114298">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114363">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114367">if</span>&nbsp;<span class="ident" id="2114370"><a href="/syscall/netlink_linux.go.html#2114291">nr</a></span>&nbsp;<span class="op" id="2114373">&lt;</span>&nbsp;<span class="ident" id="2114375"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2114388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114393">return</span>&nbsp;<span class="ident" id="2114400">nil</span><span class="op" id="2114403">,</span>&nbsp;<span class="ident" id="2114405"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114418"><a href="/syscall/netlink_linux.go.html#2114277">rb</a></span>&nbsp;<span class="op" id="2114421">=</span>&nbsp;<span class="ident" id="2114423"><a href="/syscall/netlink_linux.go.html#2114277">rb</a></span><span class="op" id="2114425">[</span><span class="op" id="2114426">:</span><span class="ident" id="2114427"><a href="/syscall/netlink_linux.go.html#2114291">nr</a></span><span class="op" id="2114429">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114433"><a href="/syscall/netlink_linux.go.html#2114213">tab</a></span>&nbsp;<span class="op" id="2114437">=</span>&nbsp;<span class="builtinfunc" id="2114439">append</span><span class="op" id="2114445">(</span><span class="ident" id="2114446"><a href="/syscall/netlink_linux.go.html#2114213">tab</a></span><span class="op" id="2114449">,</span>&nbsp;<span class="ident" id="2114451"><a href="/syscall/netlink_linux.go.html#2114277">rb</a></span><span class="op" id="2114453">...</span><span class="op" id="2114456">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114460">msgs</span><span class="op" id="2114464">,</span>&nbsp;<span class="ident" id="2114466"><a href="/syscall/netlink_linux.go.html#2114298">err</a></span>&nbsp;<span class="op" id="2114470">:=</span>&nbsp;<span class="ident" id="2114473"><a href="/syscall/netlink_linux.go.html#2115211">ParseNetlinkMessage</a></span><span class="op" id="2114492">(</span><span class="ident" id="2114493"><a href="/syscall/netlink_linux.go.html#2114277">rb</a></span><span class="op" id="2114495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114499">if</span>&nbsp;<span class="ident" id="2114502"><a href="/syscall/netlink_linux.go.html#2114298">err</a></span>&nbsp;<span class="op" id="2114506">!=</span>&nbsp;<span class="ident" id="2114509">nil</span>&nbsp;<span class="op" id="2114513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114518">return</span>&nbsp;<span class="ident" id="2114525">nil</span><span class="op" id="2114528">,</span>&nbsp;<span class="ident" id="2114530"><a href="/syscall/netlink_linux.go.html#2114298">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114540">for</span>&nbsp;<span class="ident" id="2114544">_</span><span class="op" id="2114545">,</span>&nbsp;<span class="ident" id="2114547">m</span>&nbsp;<span class="op" id="2114549">:=</span>&nbsp;<span class="keyword" id="2114552">range</span>&nbsp;<span class="ident" id="2114558"><a href="/syscall/netlink_linux.go.html#2114460">msgs</a></span>&nbsp;<span class="op" id="2114563">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2114568">lsa</span><span class="op" id="2114571">,</span>&nbsp;<span class="ident" id="2114573">err</span>&nbsp;<span class="op" id="2114577">:=</span>&nbsp;<span class="ident" id="2114580"><a href="/syscall/syscall_linux.go.html#2135591">Getsockname</a></span><span class="op" id="2114591">(</span><span class="ident" id="2114592"><a href="/syscall/netlink_linux.go.html#2113880">s</a></span><span class="op" id="2114593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114598">if</span>&nbsp;<span class="ident" id="2114601"><a href="/syscall/netlink_linux.go.html#2114573">err</a></span>&nbsp;<span class="op" id="2114605">!=</span>&nbsp;<span class="ident" id="2114608">nil</span>&nbsp;<span class="op" id="2114612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114618">return</span>&nbsp;<span class="ident" id="2114625">nil</span><span class="op" id="2114628">,</span>&nbsp;<span class="ident" id="2114630"><a href="/syscall/netlink_linux.go.html#2114573">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114642">switch</span>&nbsp;<span class="ident" id="2114649">v</span>&nbsp;<span class="op" id="2114651">:=</span>&nbsp;<span class="ident" id="2114654"><a href="/syscall/netlink_linux.go.html#2114568">lsa</a></span><span class="op" id="2114657">.</span><span class="op" id="2114658">(</span><span class="keyword" id="2114659">type</span><span class="op" id="2114663">)</span>&nbsp;<span class="op" id="2114665">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114670">case</span>&nbsp;<span class="op" id="2114675">*</span><span class="ident" id="2114676"><a href="/syscall/syscall_linux.go.html#2132690">SockaddrNetlink</a></span><span class="op" id="2114691">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114697">if</span>&nbsp;<span class="ident" id="2114700"><a href="/syscall/netlink_linux.go.html#2114547">m</a></span><span class="op" id="2114701">.</span><span class="ident" id="2114702">Header</span><span class="op" id="2114708">.</span><span class="ident" id="2114709">Seq</span>&nbsp;<span class="op" id="2114713">!=</span>&nbsp;<span class="num" id="2114716">1</span>&nbsp;<span class="op" id="2114718">||</span>&nbsp;<span class="ident" id="2114721"><a href="/syscall/netlink_linux.go.html#2114547">m</a></span><span class="op" id="2114722">.</span><span class="ident" id="2114723">Header</span><span class="op" id="2114729">.</span><span class="ident" id="2114730">Pid</span>&nbsp;<span class="op" id="2114734">!=</span>&nbsp;<span class="ident" id="2114737"><a href="/syscall/netlink_linux.go.html#2114649">v</a></span><span class="op" id="2114738">.</span><span class="ident" id="2114739">Pid</span>&nbsp;<span class="op" id="2114743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114750">return</span>&nbsp;<span class="ident" id="2114757">nil</span><span class="op" id="2114760">,</span>&nbsp;<span class="ident" id="2114762"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114778">default</span><span class="op" id="2114785">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114791">return</span>&nbsp;<span class="ident" id="2114798">nil</span><span class="op" id="2114801">,</span>&nbsp;<span class="ident" id="2114803"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114818">if</span>&nbsp;<span class="ident" id="2114821"><a href="/syscall/netlink_linux.go.html#2114547">m</a></span><span class="op" id="2114822">.</span><span class="ident" id="2114823">Header</span><span class="op" id="2114829">.</span><span class="ident" id="2114830">Type</span>&nbsp;<span class="op" id="2114835">==</span>&nbsp;<span class="ident" id="2114838"><a href="/syscall/zerrors_linux_amd64.go.html#2189457">NLMSG_DONE</a></span>&nbsp;<span class="op" id="2114849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114855">break</span>&nbsp;<span class="ident" id="2114861">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114869">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114874">if</span>&nbsp;<span class="ident" id="2114877"><a href="/syscall/netlink_linux.go.html#2114547">m</a></span><span class="op" id="2114878">.</span><span class="ident" id="2114879">Header</span><span class="op" id="2114885">.</span><span class="ident" id="2114886">Type</span>&nbsp;<span class="op" id="2114891">==</span>&nbsp;<span class="ident" id="2114894"><a href="/syscall/zerrors_linux_amd64.go.html#2189497">NLMSG_ERROR</a></span>&nbsp;<span class="op" id="2114906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114912">return</span>&nbsp;<span class="ident" id="2114919">nil</span><span class="op" id="2114922">,</span>&nbsp;<span class="ident" id="2114924"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2114941">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2114944">return</span>&nbsp;<span class="ident" id="2114951"><a href="/syscall/netlink_linux.go.html#2114213">tab</a></span><span class="op" id="2114954">,</span>&nbsp;<span class="ident" id="2114956">nil</span><br>
<span class="lineno"></span><span class="op" id="2114960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2114963">//&nbsp;NetlinkMessage&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="2115011">type</span>&nbsp;<span class="ident" id="2115016">NetlinkMessage</span>&nbsp;<span class="keyword" id="2115031">struct</span>&nbsp;<span class="op" id="2115038">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115041">Header</span>&nbsp;<span class="ident" id="2115048"><a href="/syscall/ztypes_linux_amd64.go.html#2287272">NlMsghdr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115058">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2115065">[</span><span class="op" id="2115066">]</span><span class="builtintype" id="2115067">byte</span><br>
<span class="lineno"></span><span class="op" id="2115072">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2115075">//&nbsp;ParseNetlinkMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink&nbsp;messages&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="2115143">//&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the&nbsp;NetlinkMessage&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2115206">func</span>&nbsp;<span class="ident" id="2115211">ParseNetlinkMessage</span><span class="op" id="2115230">(</span><span class="ident" id="2115231">b</span>&nbsp;<span class="op" id="2115233">[</span><span class="op" id="2115234">]</span><span class="builtintype" id="2115235">byte</span><span class="op" id="2115239">)</span>&nbsp;<span class="op" id="2115241">(</span><span class="op" id="2115242">[</span><span class="op" id="2115243">]</span><span class="ident" id="2115244"><a href="/syscall/netlink_linux.go.html#2115016">NetlinkMessage</a></span><span class="op" id="2115258">,</span>&nbsp;<span class="builtintype" id="2115260">error</span><span class="op" id="2115265">)</span>&nbsp;<span class="op" id="2115267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115270">var</span>&nbsp;<span class="ident" id="2115274">msgs</span>&nbsp;<span class="op" id="2115279">[</span><span class="op" id="2115280">]</span><span class="ident" id="2115281"><a href="/syscall/netlink_linux.go.html#2115016">NetlinkMessage</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115297">for</span>&nbsp;<span class="builtinfunc" id="2115301">len</span><span class="op" id="2115304">(</span><span class="ident" id="2115305"><a href="/syscall/netlink_linux.go.html#2115231">b</a></span><span class="op" id="2115306">)</span>&nbsp;<span class="op" id="2115308">&gt;=</span>&nbsp;<span class="ident" id="2115311"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2115324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115328">h</span><span class="op" id="2115329">,</span>&nbsp;<span class="ident" id="2115331">dbuf</span><span class="op" id="2115335">,</span>&nbsp;<span class="ident" id="2115337">dlen</span><span class="op" id="2115341">,</span>&nbsp;<span class="ident" id="2115343">err</span>&nbsp;<span class="op" id="2115347">:=</span>&nbsp;<span class="ident" id="2115350"><a href="/syscall/netlink_linux.go.html#2115563">netlinkMessageHeaderAndData</a></span><span class="op" id="2115377">(</span><span class="ident" id="2115378"><a href="/syscall/netlink_linux.go.html#2115231">b</a></span><span class="op" id="2115379">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115383">if</span>&nbsp;<span class="ident" id="2115386"><a href="/syscall/netlink_linux.go.html#2115343">err</a></span>&nbsp;<span class="op" id="2115390">!=</span>&nbsp;<span class="ident" id="2115393">nil</span>&nbsp;<span class="op" id="2115397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115402">return</span>&nbsp;<span class="ident" id="2115409">nil</span><span class="op" id="2115412">,</span>&nbsp;<span class="ident" id="2115414"><a href="/syscall/netlink_linux.go.html#2115343">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2115420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115424">m</span>&nbsp;<span class="op" id="2115426">:=</span>&nbsp;<span class="ident" id="2115429"><a href="/syscall/netlink_linux.go.html#2115016">NetlinkMessage</a></span><span class="op" id="2115443">{</span><span class="ident" id="2115444">Header</span><span class="op" id="2115450">:</span>&nbsp;<span class="op" id="2115452">*</span><span class="ident" id="2115453"><a href="/syscall/netlink_linux.go.html#2115328">h</a></span><span class="op" id="2115454">,</span>&nbsp;<span class="ident" id="2115456">Data</span><span class="op" id="2115460">:</span>&nbsp;<span class="ident" id="2115462"><a href="/syscall/netlink_linux.go.html#2115331">dbuf</a></span><span class="op" id="2115466">[</span><span class="op" id="2115467">:</span><span class="builtintype" id="2115468">int</span><span class="op" id="2115471">(</span><span class="ident" id="2115472"><a href="/syscall/netlink_linux.go.html#2115328">h</a></span><span class="op" id="2115473">.</span><span class="ident" id="2115474">Len</span><span class="op" id="2115477">)</span><span class="op" id="2115478">-</span><span class="ident" id="2115479"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span><span class="op" id="2115491">]</span><span class="op" id="2115492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115496"><a href="/syscall/netlink_linux.go.html#2115274">msgs</a></span>&nbsp;<span class="op" id="2115501">=</span>&nbsp;<span class="builtinfunc" id="2115503">append</span><span class="op" id="2115509">(</span><span class="ident" id="2115510"><a href="/syscall/netlink_linux.go.html#2115274">msgs</a></span><span class="op" id="2115514">,</span>&nbsp;<span class="ident" id="2115516"><a href="/syscall/netlink_linux.go.html#2115424">m</a></span><span class="op" id="2115517">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115521"><a href="/syscall/netlink_linux.go.html#2115231">b</a></span>&nbsp;<span class="op" id="2115523">=</span>&nbsp;<span class="ident" id="2115525"><a href="/syscall/netlink_linux.go.html#2115231">b</a></span><span class="op" id="2115526">[</span><span class="ident" id="2115527"><a href="/syscall/netlink_linux.go.html#2115337">dlen</a></span><span class="op" id="2115531">:</span><span class="op" id="2115532">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2115535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115538">return</span>&nbsp;<span class="ident" id="2115545"><a href="/syscall/netlink_linux.go.html#2115274">msgs</a></span><span class="op" id="2115549">,</span>&nbsp;<span class="ident" id="2115551">nil</span><br>
<span class="lineno"></span><span class="op" id="2115555">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="2115558">func</span>&nbsp;<span class="ident" id="2115563">netlinkMessageHeaderAndData</span><span class="op" id="2115590">(</span><span class="ident" id="2115591">b</span>&nbsp;<span class="op" id="2115593">[</span><span class="op" id="2115594">]</span><span class="builtintype" id="2115595">byte</span><span class="op" id="2115599">)</span>&nbsp;<span class="op" id="2115601">(</span><span class="op" id="2115602">*</span><span class="ident" id="2115603"><a href="/syscall/ztypes_linux_amd64.go.html#2287272">NlMsghdr</a></span><span class="op" id="2115611">,</span>&nbsp;<span class="op" id="2115613">[</span><span class="op" id="2115614">]</span><span class="builtintype" id="2115615">byte</span><span class="op" id="2115619">,</span>&nbsp;<span class="builtintype" id="2115621">int</span><span class="op" id="2115624">,</span>&nbsp;<span class="builtintype" id="2115626">error</span><span class="op" id="2115631">)</span>&nbsp;<span class="op" id="2115633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115636">h</span>&nbsp;<span class="op" id="2115638">:=</span>&nbsp;<span class="op" id="2115641">(</span><span class="op" id="2115642">*</span><span class="ident" id="2115643"><a href="/syscall/ztypes_linux_amd64.go.html#2287272">NlMsghdr</a></span><span class="op" id="2115651">)</span><span class="op" id="2115652">(</span><span class="ident" id="2115653"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2115659">.</span><span class="ident" id="2115660">Pointer</span><span class="op" id="2115667">(</span><span class="op" id="2115668">&amp;</span><span class="ident" id="2115669"><a href="/syscall/netlink_linux.go.html#2115591">b</a></span><span class="op" id="2115670">[</span><span class="num" id="2115671">0</span><span class="op" id="2115672">]</span><span class="op" id="2115673">)</span><span class="op" id="2115674">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115677">if</span>&nbsp;<span class="builtintype" id="2115680">int</span><span class="op" id="2115683">(</span><span class="ident" id="2115684"><a href="/syscall/netlink_linux.go.html#2115636">h</a></span><span class="op" id="2115685">.</span><span class="ident" id="2115686">Len</span><span class="op" id="2115689">)</span>&nbsp;<span class="op" id="2115691">&lt;</span>&nbsp;<span class="ident" id="2115693"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span>&nbsp;<span class="op" id="2115706">||</span>&nbsp;<span class="builtintype" id="2115709">int</span><span class="op" id="2115712">(</span><span class="ident" id="2115713"><a href="/syscall/netlink_linux.go.html#2115636">h</a></span><span class="op" id="2115714">.</span><span class="ident" id="2115715">Len</span><span class="op" id="2115718">)</span>&nbsp;<span class="op" id="2115720">&gt;</span>&nbsp;<span class="builtinfunc" id="2115722">len</span><span class="op" id="2115725">(</span><span class="ident" id="2115726"><a href="/syscall/netlink_linux.go.html#2115591">b</a></span><span class="op" id="2115727">)</span>&nbsp;<span class="op" id="2115729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115733">return</span>&nbsp;<span class="ident" id="2115740">nil</span><span class="op" id="2115743">,</span>&nbsp;<span class="ident" id="2115745">nil</span><span class="op" id="2115748">,</span>&nbsp;<span class="num" id="2115750">0</span><span class="op" id="2115751">,</span>&nbsp;<span class="ident" id="2115753"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2115761">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2115764">return</span>&nbsp;<span class="ident" id="2115771"><a href="/syscall/netlink_linux.go.html#2115636">h</a></span><span class="op" id="2115772">,</span>&nbsp;<span class="ident" id="2115774"><a href="/syscall/netlink_linux.go.html#2115591">b</a></span><span class="op" id="2115775">[</span><span class="ident" id="2115776"><a href="/syscall/zerrors_linux_amd64.go.html#2189537">NLMSG_HDRLEN</a></span><span class="op" id="2115788">:</span><span class="op" id="2115789">]</span><span class="op" id="2115790">,</span>&nbsp;<span class="ident" id="2115792"><a href="/syscall/netlink_linux.go.html#2112513">nlmAlignOf</a></span><span class="op" id="2115802">(</span><span class="builtintype" id="2115803">int</span><span class="op" id="2115806">(</span><span class="ident" id="2115807"><a href="/syscall/netlink_linux.go.html#2115636">h</a></span><span class="op" id="2115808">.</span><span class="ident" id="2115809">Len</span><span class="op" id="2115812">)</span><span class="op" id="2115813">)</span><span class="op" id="2115814">,</span>&nbsp;<span class="ident" id="2115816">nil</span><br>
<span class="lineno"></span><span class="op" id="2115820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2115823">//&nbsp;NetlinkRouteAttr&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2115881">type</span>&nbsp;<span class="ident" id="2115886">NetlinkRouteAttr</span>&nbsp;<span class="keyword" id="2115903">struct</span>&nbsp;<span class="op" id="2115910">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115913">Attr</span>&nbsp;&nbsp;<span class="ident" id="2115919"><a href="/syscall/ztypes_linux_amd64.go.html#2287513">RtAttr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2115927">Value</span>&nbsp;<span class="op" id="2115933">[</span><span class="op" id="2115934">]</span><span class="builtintype" id="2115935">byte</span><br>
<span class="lineno"></span><span class="op" id="2115940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2115943">//&nbsp;ParseNetlinkRouteAttr&nbsp;parses&nbsp;m&#39;s&nbsp;payload&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink</span><br>
<span class="lineno">145</span><span class="comment" id="2116010">//&nbsp;route&nbsp;attributes&nbsp;and&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2116067">//&nbsp;NetlinkRouteAttr&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2116099">func</span>&nbsp;<span class="ident" id="2116104">ParseNetlinkRouteAttr</span><span class="op" id="2116125">(</span><span class="ident" id="2116126">m</span>&nbsp;<span class="op" id="2116128">*</span><span class="ident" id="2116129"><a href="/syscall/netlink_linux.go.html#2115016">NetlinkMessage</a></span><span class="op" id="2116143">)</span>&nbsp;<span class="op" id="2116145">(</span><span class="op" id="2116146">[</span><span class="op" id="2116147">]</span><span class="ident" id="2116148"><a href="/syscall/netlink_linux.go.html#2115886">NetlinkRouteAttr</a></span><span class="op" id="2116164">,</span>&nbsp;<span class="builtintype" id="2116166">error</span><span class="op" id="2116171">)</span>&nbsp;<span class="op" id="2116173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116176">var</span>&nbsp;<span class="ident" id="2116180">b</span>&nbsp;<span class="op" id="2116182">[</span><span class="op" id="2116183">]</span><span class="builtintype" id="2116184">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116190">switch</span>&nbsp;<span class="ident" id="2116197"><a href="/syscall/netlink_linux.go.html#2116126">m</a></span><span class="op" id="2116198">.</span><span class="ident" id="2116199">Header</span><span class="op" id="2116205">.</span><span class="ident" id="2116206">Type</span>&nbsp;<span class="op" id="2116211">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116214">case</span>&nbsp;<span class="ident" id="2116219"><a href="/syscall/zerrors_linux_amd64.go.html#2200514">RTM_NEWLINK</a></span><span class="op" id="2116230">,</span>&nbsp;<span class="ident" id="2116232"><a href="/syscall/zerrors_linux_amd64.go.html#2199321">RTM_DELLINK</a></span><span class="op" id="2116243">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116247"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span>&nbsp;<span class="op" id="2116249">=</span>&nbsp;<span class="ident" id="2116251"><a href="/syscall/netlink_linux.go.html#2116126">m</a></span><span class="op" id="2116252">.</span><span class="ident" id="2116253">Data</span><span class="op" id="2116257">[</span><span class="ident" id="2116258"><a href="/syscall/ztypes_linux_amd64.go.html#2287156">SizeofIfInfomsg</a></span><span class="op" id="2116273">:</span><span class="op" id="2116274">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116277">case</span>&nbsp;<span class="ident" id="2116282"><a href="/syscall/zerrors_linux_amd64.go.html#2200432">RTM_NEWADDR</a></span><span class="op" id="2116293">,</span>&nbsp;<span class="ident" id="2116295"><a href="/syscall/zerrors_linux_amd64.go.html#2199239">RTM_DELADDR</a></span><span class="op" id="2116306">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116310"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span>&nbsp;<span class="op" id="2116312">=</span>&nbsp;<span class="ident" id="2116314"><a href="/syscall/netlink_linux.go.html#2116126">m</a></span><span class="op" id="2116315">.</span><span class="ident" id="2116316">Data</span><span class="op" id="2116320">[</span><span class="ident" id="2116321"><a href="/syscall/ztypes_linux_amd64.go.html#2287184">SizeofIfAddrmsg</a></span><span class="op" id="2116336">:</span><span class="op" id="2116337">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116340">case</span>&nbsp;<span class="ident" id="2116345"><a href="/syscall/zerrors_linux_amd64.go.html#2200760">RTM_NEWROUTE</a></span><span class="op" id="2116357">,</span>&nbsp;<span class="ident" id="2116359"><a href="/syscall/zerrors_linux_amd64.go.html#2199444">RTM_DELROUTE</a></span><span class="op" id="2116371">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116375"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span>&nbsp;<span class="op" id="2116377">=</span>&nbsp;<span class="ident" id="2116379"><a href="/syscall/netlink_linux.go.html#2116126">m</a></span><span class="op" id="2116380">.</span><span class="ident" id="2116381">Data</span><span class="op" id="2116385">[</span><span class="ident" id="2116386"><a href="/syscall/ztypes_linux_amd64.go.html#2287211">SizeofRtMsg</a></span><span class="op" id="2116397">:</span><span class="op" id="2116398">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116401">default</span><span class="op" id="2116408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116412">return</span>&nbsp;<span class="ident" id="2116419">nil</span><span class="op" id="2116422">,</span>&nbsp;<span class="ident" id="2116424"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116435">var</span>&nbsp;<span class="ident" id="2116439">attrs</span>&nbsp;<span class="op" id="2116445">[</span><span class="op" id="2116446">]</span><span class="ident" id="2116447"><a href="/syscall/netlink_linux.go.html#2115886">NetlinkRouteAttr</a></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116465">for</span>&nbsp;<span class="builtinfunc" id="2116469">len</span><span class="op" id="2116472">(</span><span class="ident" id="2116473"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span><span class="op" id="2116474">)</span>&nbsp;<span class="op" id="2116476">&gt;=</span>&nbsp;<span class="ident" id="2116479"><a href="/syscall/ztypes_linux_amd64.go.html#2287129">SizeofRtAttr</a></span>&nbsp;<span class="op" id="2116492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116496">a</span><span class="op" id="2116497">,</span>&nbsp;<span class="ident" id="2116499">vbuf</span><span class="op" id="2116503">,</span>&nbsp;<span class="ident" id="2116505">alen</span><span class="op" id="2116509">,</span>&nbsp;<span class="ident" id="2116511">err</span>&nbsp;<span class="op" id="2116515">:=</span>&nbsp;<span class="ident" id="2116518"><a href="/syscall/netlink_linux.go.html#2116734">netlinkRouteAttrAndValue</a></span><span class="op" id="2116542">(</span><span class="ident" id="2116543"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span><span class="op" id="2116544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116548">if</span>&nbsp;<span class="ident" id="2116551"><a href="/syscall/netlink_linux.go.html#2116511">err</a></span>&nbsp;<span class="op" id="2116555">!=</span>&nbsp;<span class="ident" id="2116558">nil</span>&nbsp;<span class="op" id="2116562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116567">return</span>&nbsp;<span class="ident" id="2116574">nil</span><span class="op" id="2116577">,</span>&nbsp;<span class="ident" id="2116579"><a href="/syscall/netlink_linux.go.html#2116511">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116585">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116589">ra</span>&nbsp;<span class="op" id="2116592">:=</span>&nbsp;<span class="ident" id="2116595"><a href="/syscall/netlink_linux.go.html#2115886">NetlinkRouteAttr</a></span><span class="op" id="2116611">{</span><span class="ident" id="2116612">Attr</span><span class="op" id="2116616">:</span>&nbsp;<span class="op" id="2116618">*</span><span class="ident" id="2116619"><a href="/syscall/netlink_linux.go.html#2116496">a</a></span><span class="op" id="2116620">,</span>&nbsp;<span class="ident" id="2116622">Value</span><span class="op" id="2116627">:</span>&nbsp;<span class="ident" id="2116629"><a href="/syscall/netlink_linux.go.html#2116499">vbuf</a></span><span class="op" id="2116633">[</span><span class="op" id="2116634">:</span><span class="builtintype" id="2116635">int</span><span class="op" id="2116638">(</span><span class="ident" id="2116639"><a href="/syscall/netlink_linux.go.html#2116496">a</a></span><span class="op" id="2116640">.</span><span class="ident" id="2116641">Len</span><span class="op" id="2116644">)</span><span class="op" id="2116645">-</span><span class="ident" id="2116646"><a href="/syscall/ztypes_linux_amd64.go.html#2287129">SizeofRtAttr</a></span><span class="op" id="2116658">]</span><span class="op" id="2116659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116663"><a href="/syscall/netlink_linux.go.html#2116439">attrs</a></span>&nbsp;<span class="op" id="2116669">=</span>&nbsp;<span class="builtinfunc" id="2116671">append</span><span class="op" id="2116677">(</span><span class="ident" id="2116678"><a href="/syscall/netlink_linux.go.html#2116439">attrs</a></span><span class="op" id="2116683">,</span>&nbsp;<span class="ident" id="2116685"><a href="/syscall/netlink_linux.go.html#2116589">ra</a></span><span class="op" id="2116687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116691"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span>&nbsp;<span class="op" id="2116693">=</span>&nbsp;<span class="ident" id="2116695"><a href="/syscall/netlink_linux.go.html#2116180">b</a></span><span class="op" id="2116696">[</span><span class="ident" id="2116697"><a href="/syscall/netlink_linux.go.html#2116505">alen</a></span><span class="op" id="2116701">:</span><span class="op" id="2116702">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116708">return</span>&nbsp;<span class="ident" id="2116715"><a href="/syscall/netlink_linux.go.html#2116439">attrs</a></span><span class="op" id="2116720">,</span>&nbsp;<span class="ident" id="2116722">nil</span><br>
<span class="lineno">170</span><span class="op" id="2116726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2116729">func</span>&nbsp;<span class="ident" id="2116734">netlinkRouteAttrAndValue</span><span class="op" id="2116758">(</span><span class="ident" id="2116759">b</span>&nbsp;<span class="op" id="2116761">[</span><span class="op" id="2116762">]</span><span class="builtintype" id="2116763">byte</span><span class="op" id="2116767">)</span>&nbsp;<span class="op" id="2116769">(</span><span class="op" id="2116770">*</span><span class="ident" id="2116771"><a href="/syscall/ztypes_linux_amd64.go.html#2287513">RtAttr</a></span><span class="op" id="2116777">,</span>&nbsp;<span class="op" id="2116779">[</span><span class="op" id="2116780">]</span><span class="builtintype" id="2116781">byte</span><span class="op" id="2116785">,</span>&nbsp;<span class="builtintype" id="2116787">int</span><span class="op" id="2116790">,</span>&nbsp;<span class="builtintype" id="2116792">error</span><span class="op" id="2116797">)</span>&nbsp;<span class="op" id="2116799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2116802">a</span>&nbsp;<span class="op" id="2116804">:=</span>&nbsp;<span class="op" id="2116807">(</span><span class="op" id="2116808">*</span><span class="ident" id="2116809"><a href="/syscall/ztypes_linux_amd64.go.html#2287513">RtAttr</a></span><span class="op" id="2116815">)</span><span class="op" id="2116816">(</span><span class="ident" id="2116817"><a href="/syscall/netlink_linux.go.html#2112432">unsafe</a></span><span class="op" id="2116823">.</span><span class="ident" id="2116824">Pointer</span><span class="op" id="2116831">(</span><span class="op" id="2116832">&amp;</span><span class="ident" id="2116833"><a href="/syscall/netlink_linux.go.html#2116759">b</a></span><span class="op" id="2116834">[</span><span class="num" id="2116835">0</span><span class="op" id="2116836">]</span><span class="op" id="2116837">)</span><span class="op" id="2116838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116841">if</span>&nbsp;<span class="builtintype" id="2116844">int</span><span class="op" id="2116847">(</span><span class="ident" id="2116848"><a href="/syscall/netlink_linux.go.html#2116802">a</a></span><span class="op" id="2116849">.</span><span class="ident" id="2116850">Len</span><span class="op" id="2116853">)</span>&nbsp;<span class="op" id="2116855">&lt;</span>&nbsp;<span class="ident" id="2116857"><a href="/syscall/ztypes_linux_amd64.go.html#2287129">SizeofRtAttr</a></span>&nbsp;<span class="op" id="2116870">||</span>&nbsp;<span class="builtintype" id="2116873">int</span><span class="op" id="2116876">(</span><span class="ident" id="2116877"><a href="/syscall/netlink_linux.go.html#2116802">a</a></span><span class="op" id="2116878">.</span><span class="ident" id="2116879">Len</span><span class="op" id="2116882">)</span>&nbsp;<span class="op" id="2116884">&gt;</span>&nbsp;<span class="builtinfunc" id="2116886">len</span><span class="op" id="2116889">(</span><span class="ident" id="2116890"><a href="/syscall/netlink_linux.go.html#2116759">b</a></span><span class="op" id="2116891">)</span>&nbsp;<span class="op" id="2116893">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116897">return</span>&nbsp;<span class="ident" id="2116904">nil</span><span class="op" id="2116907">,</span>&nbsp;<span class="ident" id="2116909">nil</span><span class="op" id="2116912">,</span>&nbsp;<span class="num" id="2116914">0</span><span class="op" id="2116915">,</span>&nbsp;<span class="ident" id="2116917"><a href="/syscall/zerrors_linux_amd64.go.html#2214659">EINVAL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2116925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2116928">return</span>&nbsp;<span class="ident" id="2116935"><a href="/syscall/netlink_linux.go.html#2116802">a</a></span><span class="op" id="2116936">,</span>&nbsp;<span class="ident" id="2116938"><a href="/syscall/netlink_linux.go.html#2116759">b</a></span><span class="op" id="2116939">[</span><span class="ident" id="2116940"><a href="/syscall/ztypes_linux_amd64.go.html#2287129">SizeofRtAttr</a></span><span class="op" id="2116952">:</span><span class="op" id="2116953">]</span><span class="op" id="2116954">,</span>&nbsp;<span class="ident" id="2116956"><a href="/syscall/netlink_linux.go.html#2112687">rtaAlignOf</a></span><span class="op" id="2116966">(</span><span class="builtintype" id="2116967">int</span><span class="op" id="2116970">(</span><span class="ident" id="2116971"><a href="/syscall/netlink_linux.go.html#2116802">a</a></span><span class="op" id="2116972">.</span><span class="ident" id="2116973">Len</span><span class="op" id="2116976">)</span><span class="op" id="2116977">)</span><span class="op" id="2116978">,</span>&nbsp;<span class="ident" id="2116980">nil</span><br>
<span class="lineno"></span><span class="op" id="2116984">}</span>
</div>
</body>
</html>
