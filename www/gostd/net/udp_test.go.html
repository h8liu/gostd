<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html" class="current">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6806924">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6806980">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6807034">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6807085">package</span>&nbsp;<span class="ident" id="6807093">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6807098">import</span>&nbsp;<span class="op" id="6807105">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6807108">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6807119">&#34;runtime&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6807130">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6807141">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6807152">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6807159">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="6807162">func</span>&nbsp;<span class="ident" id="6807167">TestResolveUDPAddr</span><span class="op" id="6807185">(</span><span class="ident" id="6807186">t</span>&nbsp;<span class="op" id="6807188">*</span><span class="ident" id="6807189">testing</span><span class="op" id="6807196">.</span><span class="ident" id="6807197">T</span><span class="op" id="6807198">)</span>&nbsp;<span class="op" id="6807200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807203">for</span>&nbsp;<span class="ident" id="6807207">_</span><span class="op" id="6807208">,</span>&nbsp;<span class="ident" id="6807210">tt</span>&nbsp;<span class="op" id="6807213">:=</span>&nbsp;<span class="keyword" id="6807216">range</span>&nbsp;<span class="ident" id="6807222">resolveTCPAddrTests</span>&nbsp;<span class="op" id="6807242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807246">net</span>&nbsp;<span class="op" id="6807250">:=</span>&nbsp;<span class="ident" id="6807253">strings</span><span class="op" id="6807260">.</span><span class="ident" id="6807261">Replace</span><span class="op" id="6807268">(</span><span class="ident" id="6807269">tt</span><span class="op" id="6807271">.</span><span class="ident" id="6807272">net</span><span class="op" id="6807275">,</span>&nbsp;<span class="string" id="6807277">&#34;tcp&#34;</span><span class="op" id="6807282">,</span>&nbsp;<span class="string" id="6807284">&#34;udp&#34;</span><span class="op" id="6807289">,</span>&nbsp;<span class="op" id="6807291">-</span><span class="num" id="6807292">1</span><span class="op" id="6807293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807297">addr</span><span class="op" id="6807301">,</span>&nbsp;<span class="ident" id="6807303">err</span>&nbsp;<span class="op" id="6807307">:=</span>&nbsp;<span class="ident" id="6807310">ResolveUDPAddr</span><span class="op" id="6807324">(</span><span class="ident" id="6807325">net</span><span class="op" id="6807328">,</span>&nbsp;<span class="ident" id="6807330">tt</span><span class="op" id="6807332">.</span><span class="ident" id="6807333">litAddrOrName</span><span class="op" id="6807346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807350">if</span>&nbsp;<span class="ident" id="6807353">err</span>&nbsp;<span class="op" id="6807357">!=</span>&nbsp;<span class="ident" id="6807360">tt</span><span class="op" id="6807362">.</span><span class="ident" id="6807363">err</span>&nbsp;<span class="op" id="6807367">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807372">t</span><span class="op" id="6807373">.</span><span class="ident" id="6807374">Fatalf</span><span class="op" id="6807380">(</span><span class="string" id="6807381">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6807416">,</span>&nbsp;<span class="ident" id="6807418">net</span><span class="op" id="6807421">,</span>&nbsp;<span class="ident" id="6807423">tt</span><span class="op" id="6807425">.</span><span class="ident" id="6807426">litAddrOrName</span><span class="op" id="6807439">,</span>&nbsp;<span class="ident" id="6807441">err</span><span class="op" id="6807444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807452">if</span>&nbsp;<span class="op" id="6807455">!</span><span class="ident" id="6807456">reflect</span><span class="op" id="6807463">.</span><span class="ident" id="6807464">DeepEqual</span><span class="op" id="6807473">(</span><span class="ident" id="6807474">addr</span><span class="op" id="6807478">,</span>&nbsp;<span class="op" id="6807480">(</span><span class="op" id="6807481">*</span><span class="ident" id="6807482">UDPAddr</span><span class="op" id="6807489">)</span><span class="op" id="6807490">(</span><span class="ident" id="6807491">tt</span><span class="op" id="6807493">.</span><span class="ident" id="6807494">addr</span><span class="op" id="6807498">)</span><span class="op" id="6807499">)</span>&nbsp;<span class="op" id="6807501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807506">t</span><span class="op" id="6807507">.</span><span class="ident" id="6807508">Fatalf</span><span class="op" id="6807514">(</span><span class="string" id="6807515">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6807555">,</span>&nbsp;<span class="ident" id="6807557">net</span><span class="op" id="6807560">,</span>&nbsp;<span class="ident" id="6807562">tt</span><span class="op" id="6807564">.</span><span class="ident" id="6807565">litAddrOrName</span><span class="op" id="6807578">,</span>&nbsp;<span class="ident" id="6807580">addr</span><span class="op" id="6807584">,</span>&nbsp;<span class="ident" id="6807586">tt</span><span class="op" id="6807588">.</span><span class="ident" id="6807589">addr</span><span class="op" id="6807593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807597">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807601">if</span>&nbsp;<span class="ident" id="6807604">err</span>&nbsp;<span class="op" id="6807608">==</span>&nbsp;<span class="builtintype" id="6807611">nil</span>&nbsp;<span class="op" id="6807615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807620">str</span>&nbsp;<span class="op" id="6807624">:=</span>&nbsp;<span class="ident" id="6807627">addr</span><span class="op" id="6807631">.</span><span class="ident" id="6807632">String</span><span class="op" id="6807638">(</span><span class="op" id="6807639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807644">addr1</span><span class="op" id="6807649">,</span>&nbsp;<span class="ident" id="6807651">err</span>&nbsp;<span class="op" id="6807655">:=</span>&nbsp;<span class="ident" id="6807658">ResolveUDPAddr</span><span class="op" id="6807672">(</span><span class="ident" id="6807673">net</span><span class="op" id="6807676">,</span>&nbsp;<span class="ident" id="6807678">str</span><span class="op" id="6807681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807686">if</span>&nbsp;<span class="ident" id="6807689">err</span>&nbsp;<span class="op" id="6807693">!=</span>&nbsp;<span class="builtintype" id="6807696">nil</span>&nbsp;<span class="op" id="6807700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807706">t</span><span class="op" id="6807707">.</span><span class="ident" id="6807708">Fatalf</span><span class="op" id="6807714">(</span><span class="string" id="6807715">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]:&nbsp;%v&#34;</span><span class="op" id="6807753">,</span>&nbsp;<span class="ident" id="6807755">net</span><span class="op" id="6807758">,</span>&nbsp;<span class="ident" id="6807760">str</span><span class="op" id="6807763">,</span>&nbsp;<span class="ident" id="6807765">tt</span><span class="op" id="6807767">.</span><span class="ident" id="6807768">litAddrOrName</span><span class="op" id="6807781">,</span>&nbsp;<span class="ident" id="6807783">err</span><span class="op" id="6807786">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807796">if</span>&nbsp;<span class="op" id="6807799">!</span><span class="ident" id="6807800">reflect</span><span class="op" id="6807807">.</span><span class="ident" id="6807808">DeepEqual</span><span class="op" id="6807817">(</span><span class="ident" id="6807818">addr1</span><span class="op" id="6807823">,</span>&nbsp;<span class="ident" id="6807825">addr</span><span class="op" id="6807829">)</span>&nbsp;<span class="op" id="6807831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6807837">t</span><span class="op" id="6807838">.</span><span class="ident" id="6807839">Fatalf</span><span class="op" id="6807845">(</span><span class="string" id="6807846">&#34;ResolveUDPAddr(%q,&nbsp;%q)&nbsp;[from&nbsp;%q]&nbsp;=&nbsp;%#v,&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6807896">,</span>&nbsp;<span class="ident" id="6807898">net</span><span class="op" id="6807901">,</span>&nbsp;<span class="ident" id="6807903">str</span><span class="op" id="6807906">,</span>&nbsp;<span class="ident" id="6807908">tt</span><span class="op" id="6807910">.</span><span class="ident" id="6807911">litAddrOrName</span><span class="op" id="6807924">,</span>&nbsp;<span class="ident" id="6807926">addr1</span><span class="op" id="6807931">,</span>&nbsp;<span class="ident" id="6807933">addr</span><span class="op" id="6807937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807946">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6807949">}</span><br>
<span class="lineno"></span><span class="op" id="6807951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6807954">func</span>&nbsp;<span class="ident" id="6807959">TestReadFromUDP</span><span class="op" id="6807974">(</span><span class="ident" id="6807975">t</span>&nbsp;<span class="op" id="6807977">*</span><span class="ident" id="6807978">testing</span><span class="op" id="6807985">.</span><span class="ident" id="6807986">T</span><span class="op" id="6807987">)</span>&nbsp;<span class="op" id="6807989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6807992">switch</span>&nbsp;<span class="ident" id="6807999">runtime</span><span class="op" id="6808006">.</span><span class="ident" id="6808007">GOOS</span>&nbsp;<span class="op" id="6808012">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808015">case</span>&nbsp;<span class="string" id="6808020">&#34;nacl&#34;</span><span class="op" id="6808026">,</span>&nbsp;<span class="string" id="6808028">&#34;plan9&#34;</span><span class="op" id="6808035">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808039">t</span><span class="op" id="6808040">.</span><span class="ident" id="6808041">Skipf</span><span class="op" id="6808046">(</span><span class="string" id="6808047">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q,&nbsp;see&nbsp;issue&nbsp;8916&#34;</span><span class="op" id="6808084">,</span>&nbsp;<span class="ident" id="6808086">runtime</span><span class="op" id="6808093">.</span><span class="ident" id="6808094">GOOS</span><span class="op" id="6808098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808105">ra</span><span class="op" id="6808107">,</span>&nbsp;<span class="ident" id="6808109">err</span>&nbsp;<span class="op" id="6808113">:=</span>&nbsp;<span class="ident" id="6808116">ResolveUDPAddr</span><span class="op" id="6808130">(</span><span class="string" id="6808131">&#34;udp&#34;</span><span class="op" id="6808136">,</span>&nbsp;<span class="string" id="6808138">&#34;127.0.0.1:7&#34;</span><span class="op" id="6808151">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808154">if</span>&nbsp;<span class="ident" id="6808157">err</span>&nbsp;<span class="op" id="6808161">!=</span>&nbsp;<span class="builtintype" id="6808164">nil</span>&nbsp;<span class="op" id="6808168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808172">t</span><span class="op" id="6808173">.</span><span class="ident" id="6808174">Fatal</span><span class="op" id="6808179">(</span><span class="ident" id="6808180">err</span><span class="op" id="6808183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808190">la</span><span class="op" id="6808192">,</span>&nbsp;<span class="ident" id="6808194">err</span>&nbsp;<span class="op" id="6808198">:=</span>&nbsp;<span class="ident" id="6808201">ResolveUDPAddr</span><span class="op" id="6808215">(</span><span class="string" id="6808216">&#34;udp&#34;</span><span class="op" id="6808221">,</span>&nbsp;<span class="string" id="6808223">&#34;127.0.0.1:0&#34;</span><span class="op" id="6808236">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808239">if</span>&nbsp;<span class="ident" id="6808242">err</span>&nbsp;<span class="op" id="6808246">!=</span>&nbsp;<span class="builtintype" id="6808249">nil</span>&nbsp;<span class="op" id="6808253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808257">t</span><span class="op" id="6808258">.</span><span class="ident" id="6808259">Fatal</span><span class="op" id="6808264">(</span><span class="ident" id="6808265">err</span><span class="op" id="6808268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808275">c</span><span class="op" id="6808276">,</span>&nbsp;<span class="ident" id="6808278">err</span>&nbsp;<span class="op" id="6808282">:=</span>&nbsp;<span class="ident" id="6808285">ListenUDP</span><span class="op" id="6808294">(</span><span class="string" id="6808295">&#34;udp&#34;</span><span class="op" id="6808300">,</span>&nbsp;<span class="ident" id="6808302">la</span><span class="op" id="6808304">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808307">if</span>&nbsp;<span class="ident" id="6808310">err</span>&nbsp;<span class="op" id="6808314">!=</span>&nbsp;<span class="builtintype" id="6808317">nil</span>&nbsp;<span class="op" id="6808321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808325">t</span><span class="op" id="6808326">.</span><span class="ident" id="6808327">Fatal</span><span class="op" id="6808332">(</span><span class="ident" id="6808333">err</span><span class="op" id="6808336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808342">defer</span>&nbsp;<span class="ident" id="6808348">c</span><span class="op" id="6808349">.</span><span class="ident" id="6808350">Close</span><span class="op" id="6808355">(</span><span class="op" id="6808356">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808360">_</span><span class="op" id="6808361">,</span>&nbsp;<span class="ident" id="6808363">err</span>&nbsp;<span class="op" id="6808367">=</span>&nbsp;<span class="ident" id="6808369">c</span><span class="op" id="6808370">.</span><span class="ident" id="6808371">WriteToUDP</span><span class="op" id="6808381">(</span><span class="op" id="6808382">[</span><span class="op" id="6808383">]</span><span class="builtintype" id="6808384">byte</span><span class="op" id="6808388">(</span><span class="string" id="6808389">&#34;a&#34;</span><span class="op" id="6808392">)</span><span class="op" id="6808393">,</span>&nbsp;<span class="ident" id="6808395">ra</span><span class="op" id="6808397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808400">if</span>&nbsp;<span class="ident" id="6808403">err</span>&nbsp;<span class="op" id="6808407">!=</span>&nbsp;<span class="builtintype" id="6808410">nil</span>&nbsp;<span class="op" id="6808414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808418">t</span><span class="op" id="6808419">.</span><span class="ident" id="6808420">Fatal</span><span class="op" id="6808425">(</span><span class="ident" id="6808426">err</span><span class="op" id="6808429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808436">err</span>&nbsp;<span class="op" id="6808440">=</span>&nbsp;<span class="ident" id="6808442">c</span><span class="op" id="6808443">.</span><span class="ident" id="6808444">SetDeadline</span><span class="op" id="6808455">(</span><span class="ident" id="6808456">time</span><span class="op" id="6808460">.</span><span class="ident" id="6808461">Now</span><span class="op" id="6808464">(</span><span class="op" id="6808465">)</span><span class="op" id="6808466">.</span><span class="ident" id="6808467">Add</span><span class="op" id="6808470">(</span><span class="num" id="6808471">100</span>&nbsp;<span class="op" id="6808475">*</span>&nbsp;<span class="ident" id="6808477">time</span><span class="op" id="6808481">.</span><span class="ident" id="6808482">Millisecond</span><span class="op" id="6808493">)</span><span class="op" id="6808494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808497">if</span>&nbsp;<span class="ident" id="6808500">err</span>&nbsp;<span class="op" id="6808504">!=</span>&nbsp;<span class="builtintype" id="6808507">nil</span>&nbsp;<span class="op" id="6808511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808515">t</span><span class="op" id="6808516">.</span><span class="ident" id="6808517">Fatal</span><span class="op" id="6808522">(</span><span class="ident" id="6808523">err</span><span class="op" id="6808526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808532">b</span>&nbsp;<span class="op" id="6808534">:=</span>&nbsp;<span class="builtinfunc" id="6808537">make</span><span class="op" id="6808541">(</span><span class="op" id="6808542">[</span><span class="op" id="6808543">]</span><span class="builtintype" id="6808544">byte</span><span class="op" id="6808548">,</span>&nbsp;<span class="num" id="6808550">1</span><span class="op" id="6808551">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808554">_</span><span class="op" id="6808555">,</span>&nbsp;<span class="ident" id="6808557">_</span><span class="op" id="6808558">,</span>&nbsp;<span class="ident" id="6808560">err</span>&nbsp;<span class="op" id="6808564">=</span>&nbsp;<span class="ident" id="6808566">c</span><span class="op" id="6808567">.</span><span class="ident" id="6808568">ReadFromUDP</span><span class="op" id="6808579">(</span><span class="ident" id="6808580">b</span><span class="op" id="6808581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808584">if</span>&nbsp;<span class="ident" id="6808587">err</span>&nbsp;<span class="op" id="6808591">==</span>&nbsp;<span class="builtintype" id="6808594">nil</span>&nbsp;<span class="op" id="6808598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808602">t</span><span class="op" id="6808603">.</span><span class="ident" id="6808604">Fatal</span><span class="op" id="6808609">(</span><span class="string" id="6808610">&#34;ReadFromUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6808635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808638">}</span>&nbsp;<span class="keyword" id="6808640">else</span>&nbsp;<span class="keyword" id="6808645">if</span>&nbsp;<span class="op" id="6808648">!</span><span class="ident" id="6808649">isTimeout</span><span class="op" id="6808658">(</span><span class="ident" id="6808659">err</span><span class="op" id="6808662">)</span>&nbsp;<span class="op" id="6808664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808668">t</span><span class="op" id="6808669">.</span><span class="ident" id="6808670">Fatal</span><span class="op" id="6808675">(</span><span class="ident" id="6808676">err</span><span class="op" id="6808679">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808682">}</span><br>
<span class="lineno"></span><span class="op" id="6808684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6808687">func</span>&nbsp;<span class="ident" id="6808692">TestWriteToUDP</span><span class="op" id="6808706">(</span><span class="ident" id="6808707">t</span>&nbsp;<span class="op" id="6808709">*</span><span class="ident" id="6808710">testing</span><span class="op" id="6808717">.</span><span class="ident" id="6808718">T</span><span class="op" id="6808719">)</span>&nbsp;<span class="op" id="6808721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808724">switch</span>&nbsp;<span class="ident" id="6808731">runtime</span><span class="op" id="6808738">.</span><span class="ident" id="6808739">GOOS</span>&nbsp;<span class="op" id="6808744">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808747">case</span>&nbsp;<span class="string" id="6808752">&#34;plan9&#34;</span><span class="op" id="6808759">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808763">t</span><span class="op" id="6808764">.</span><span class="ident" id="6808765">Skipf</span><span class="op" id="6808770">(</span><span class="string" id="6808771">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6808792">,</span>&nbsp;<span class="ident" id="6808794">runtime</span><span class="op" id="6808801">.</span><span class="ident" id="6808802">GOOS</span><span class="op" id="6808806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808813">l</span><span class="op" id="6808814">,</span>&nbsp;<span class="ident" id="6808816">err</span>&nbsp;<span class="op" id="6808820">:=</span>&nbsp;<span class="ident" id="6808823">ListenPacket</span><span class="op" id="6808835">(</span><span class="string" id="6808836">&#34;udp&#34;</span><span class="op" id="6808841">,</span>&nbsp;<span class="string" id="6808843">&#34;127.0.0.1:0&#34;</span><span class="op" id="6808856">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808859">if</span>&nbsp;<span class="ident" id="6808862">err</span>&nbsp;<span class="op" id="6808866">!=</span>&nbsp;<span class="builtintype" id="6808869">nil</span>&nbsp;<span class="op" id="6808873">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808877">t</span><span class="op" id="6808878">.</span><span class="ident" id="6808879">Fatalf</span><span class="op" id="6808885">(</span><span class="string" id="6808886">&#34;Listen&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6808905">,</span>&nbsp;<span class="ident" id="6808907">err</span><span class="op" id="6808910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6808913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6808916">defer</span>&nbsp;<span class="ident" id="6808922">l</span><span class="op" id="6808923">.</span><span class="ident" id="6808924">Close</span><span class="op" id="6808929">(</span><span class="op" id="6808930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808934">testWriteToConn</span><span class="op" id="6808949">(</span><span class="ident" id="6808950">t</span><span class="op" id="6808951">,</span>&nbsp;<span class="ident" id="6808953">l</span><span class="op" id="6808954">.</span><span class="ident" id="6808955">LocalAddr</span><span class="op" id="6808964">(</span><span class="op" id="6808965">)</span><span class="op" id="6808966">.</span><span class="ident" id="6808967">String</span><span class="op" id="6808973">(</span><span class="op" id="6808974">)</span><span class="op" id="6808975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6808978">testWriteToPacketConn</span><span class="op" id="6808999">(</span><span class="ident" id="6809000">t</span><span class="op" id="6809001">,</span>&nbsp;<span class="ident" id="6809003">l</span><span class="op" id="6809004">.</span><span class="ident" id="6809005">LocalAddr</span><span class="op" id="6809014">(</span><span class="op" id="6809015">)</span><span class="op" id="6809016">.</span><span class="ident" id="6809017">String</span><span class="op" id="6809023">(</span><span class="op" id="6809024">)</span><span class="op" id="6809025">)</span><br>
<span class="lineno"></span><span class="op" id="6809027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6809030">func</span>&nbsp;<span class="ident" id="6809035">testWriteToConn</span><span class="op" id="6809050">(</span><span class="ident" id="6809051">t</span>&nbsp;<span class="op" id="6809053">*</span><span class="ident" id="6809054">testing</span><span class="op" id="6809061">.</span><span class="ident" id="6809062">T</span><span class="op" id="6809063">,</span>&nbsp;<span class="ident" id="6809065">raddr</span>&nbsp;<span class="builtintype" id="6809071">string</span><span class="op" id="6809077">)</span>&nbsp;<span class="op" id="6809079">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809082">c</span><span class="op" id="6809083">,</span>&nbsp;<span class="ident" id="6809085">err</span>&nbsp;<span class="op" id="6809089">:=</span>&nbsp;<span class="ident" id="6809092">Dial</span><span class="op" id="6809096">(</span><span class="string" id="6809097">&#34;udp&#34;</span><span class="op" id="6809102">,</span>&nbsp;<span class="ident" id="6809104">raddr</span><span class="op" id="6809109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809112">if</span>&nbsp;<span class="ident" id="6809115">err</span>&nbsp;<span class="op" id="6809119">!=</span>&nbsp;<span class="builtintype" id="6809122">nil</span>&nbsp;<span class="op" id="6809126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809130">t</span><span class="op" id="6809131">.</span><span class="ident" id="6809132">Fatalf</span><span class="op" id="6809138">(</span><span class="string" id="6809139">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6809156">,</span>&nbsp;<span class="ident" id="6809158">err</span><span class="op" id="6809161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809167">defer</span>&nbsp;<span class="ident" id="6809173">c</span><span class="op" id="6809174">.</span><span class="ident" id="6809175">Close</span><span class="op" id="6809180">(</span><span class="op" id="6809181">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809185">ra</span><span class="op" id="6809187">,</span>&nbsp;<span class="ident" id="6809189">err</span>&nbsp;<span class="op" id="6809193">:=</span>&nbsp;<span class="ident" id="6809196">ResolveUDPAddr</span><span class="op" id="6809210">(</span><span class="string" id="6809211">&#34;udp&#34;</span><span class="op" id="6809216">,</span>&nbsp;<span class="ident" id="6809218">raddr</span><span class="op" id="6809223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809226">if</span>&nbsp;<span class="ident" id="6809229">err</span>&nbsp;<span class="op" id="6809233">!=</span>&nbsp;<span class="builtintype" id="6809236">nil</span>&nbsp;<span class="op" id="6809240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809244">t</span><span class="op" id="6809245">.</span><span class="ident" id="6809246">Fatalf</span><span class="op" id="6809252">(</span><span class="string" id="6809253">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6809280">,</span>&nbsp;<span class="ident" id="6809282">err</span><span class="op" id="6809285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809288">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809292">_</span><span class="op" id="6809293">,</span>&nbsp;<span class="ident" id="6809295">err</span>&nbsp;<span class="op" id="6809299">=</span>&nbsp;<span class="ident" id="6809301">c</span><span class="op" id="6809302">.</span><span class="op" id="6809303">(</span><span class="op" id="6809304">*</span><span class="ident" id="6809305">UDPConn</span><span class="op" id="6809312">)</span><span class="op" id="6809313">.</span><span class="ident" id="6809314">WriteToUDP</span><span class="op" id="6809324">(</span><span class="op" id="6809325">[</span><span class="op" id="6809326">]</span><span class="builtintype" id="6809327">byte</span><span class="op" id="6809331">(</span><span class="string" id="6809332">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6809365">)</span><span class="op" id="6809366">,</span>&nbsp;<span class="ident" id="6809368">ra</span><span class="op" id="6809370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809373">if</span>&nbsp;<span class="ident" id="6809376">err</span>&nbsp;<span class="op" id="6809380">==</span>&nbsp;<span class="builtintype" id="6809383">nil</span>&nbsp;<span class="op" id="6809387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809391">t</span><span class="op" id="6809392">.</span><span class="ident" id="6809393">Fatal</span><span class="op" id="6809398">(</span><span class="string" id="6809399">&#34;WriteToUDP&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6809423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809426">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809429">if</span>&nbsp;<span class="ident" id="6809432">err</span>&nbsp;<span class="op" id="6809436">!=</span>&nbsp;<span class="builtintype" id="6809439">nil</span>&nbsp;<span class="op" id="6809443">&amp;&amp;</span>&nbsp;<span class="ident" id="6809446">err</span><span class="op" id="6809449">.</span><span class="op" id="6809450">(</span><span class="op" id="6809451">*</span><span class="ident" id="6809452">OpError</span><span class="op" id="6809459">)</span><span class="op" id="6809460">.</span><span class="ident" id="6809461">Err</span>&nbsp;<span class="op" id="6809465">!=</span>&nbsp;<span class="ident" id="6809468">ErrWriteToConnected</span>&nbsp;<span class="op" id="6809488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809492">t</span><span class="op" id="6809493">.</span><span class="ident" id="6809494">Fatalf</span><span class="op" id="6809500">(</span><span class="string" id="6809501">&#34;WriteToUDP&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6809552">,</span>&nbsp;<span class="ident" id="6809554">err</span><span class="op" id="6809557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809564">_</span><span class="op" id="6809565">,</span>&nbsp;<span class="ident" id="6809567">err</span>&nbsp;<span class="op" id="6809571">=</span>&nbsp;<span class="ident" id="6809573">c</span><span class="op" id="6809574">.</span><span class="op" id="6809575">(</span><span class="op" id="6809576">*</span><span class="ident" id="6809577">UDPConn</span><span class="op" id="6809584">)</span><span class="op" id="6809585">.</span><span class="ident" id="6809586">WriteTo</span><span class="op" id="6809593">(</span><span class="op" id="6809594">[</span><span class="op" id="6809595">]</span><span class="builtintype" id="6809596">byte</span><span class="op" id="6809600">(</span><span class="string" id="6809601">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6809634">)</span><span class="op" id="6809635">,</span>&nbsp;<span class="ident" id="6809637">ra</span><span class="op" id="6809639">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809642">if</span>&nbsp;<span class="ident" id="6809645">err</span>&nbsp;<span class="op" id="6809649">==</span>&nbsp;<span class="builtintype" id="6809652">nil</span>&nbsp;<span class="op" id="6809656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809660">t</span><span class="op" id="6809661">.</span><span class="ident" id="6809662">Fatal</span><span class="op" id="6809667">(</span><span class="string" id="6809668">&#34;WriteTo&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6809689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809695">if</span>&nbsp;<span class="ident" id="6809698">err</span>&nbsp;<span class="op" id="6809702">!=</span>&nbsp;<span class="builtintype" id="6809705">nil</span>&nbsp;<span class="op" id="6809709">&amp;&amp;</span>&nbsp;<span class="ident" id="6809712">err</span><span class="op" id="6809715">.</span><span class="op" id="6809716">(</span><span class="op" id="6809717">*</span><span class="ident" id="6809718">OpError</span><span class="op" id="6809725">)</span><span class="op" id="6809726">.</span><span class="ident" id="6809727">Err</span>&nbsp;<span class="op" id="6809731">!=</span>&nbsp;<span class="ident" id="6809734">ErrWriteToConnected</span>&nbsp;<span class="op" id="6809754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809758">t</span><span class="op" id="6809759">.</span><span class="ident" id="6809760">Fatalf</span><span class="op" id="6809766">(</span><span class="string" id="6809767">&#34;WriteTo&nbsp;should&nbsp;fail&nbsp;as&nbsp;ErrWriteToConnected:&nbsp;%v&#34;</span><span class="op" id="6809815">,</span>&nbsp;<span class="ident" id="6809817">err</span><span class="op" id="6809820">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809823">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809827">_</span><span class="op" id="6809828">,</span>&nbsp;<span class="ident" id="6809830">err</span>&nbsp;<span class="op" id="6809834">=</span>&nbsp;<span class="ident" id="6809836">c</span><span class="op" id="6809837">.</span><span class="ident" id="6809838">Write</span><span class="op" id="6809843">(</span><span class="op" id="6809844">[</span><span class="op" id="6809845">]</span><span class="builtintype" id="6809846">byte</span><span class="op" id="6809850">(</span><span class="string" id="6809851">&#34;Connection-oriented&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6809884">)</span><span class="op" id="6809885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6809888">if</span>&nbsp;<span class="ident" id="6809891">err</span>&nbsp;<span class="op" id="6809895">!=</span>&nbsp;<span class="builtintype" id="6809898">nil</span>&nbsp;<span class="op" id="6809902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6809906">t</span><span class="op" id="6809907">.</span><span class="ident" id="6809908">Fatalf</span><span class="op" id="6809914">(</span><span class="string" id="6809915">&#34;Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6809933">,</span>&nbsp;<span class="ident" id="6809935">err</span><span class="op" id="6809938">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6809941">}</span><br>
<span class="lineno"></span><span class="op" id="6809943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6809946">func</span>&nbsp;<span class="ident" id="6809951">testWriteToPacketConn</span><span class="op" id="6809972">(</span><span class="ident" id="6809973">t</span>&nbsp;<span class="op" id="6809975">*</span><span class="ident" id="6809976">testing</span><span class="op" id="6809983">.</span><span class="ident" id="6809984">T</span><span class="op" id="6809985">,</span>&nbsp;<span class="ident" id="6809987">raddr</span>&nbsp;<span class="builtintype" id="6809993">string</span><span class="op" id="6809999">)</span>&nbsp;<span class="op" id="6810001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810004">c</span><span class="op" id="6810005">,</span>&nbsp;<span class="ident" id="6810007">err</span>&nbsp;<span class="op" id="6810011">:=</span>&nbsp;<span class="ident" id="6810014">ListenPacket</span><span class="op" id="6810026">(</span><span class="string" id="6810027">&#34;udp&#34;</span><span class="op" id="6810032">,</span>&nbsp;<span class="string" id="6810034">&#34;127.0.0.1:0&#34;</span><span class="op" id="6810047">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810050">if</span>&nbsp;<span class="ident" id="6810053">err</span>&nbsp;<span class="op" id="6810057">!=</span>&nbsp;<span class="builtintype" id="6810060">nil</span>&nbsp;<span class="op" id="6810064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810068">t</span><span class="op" id="6810069">.</span><span class="ident" id="6810070">Fatalf</span><span class="op" id="6810076">(</span><span class="string" id="6810077">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6810102">,</span>&nbsp;<span class="ident" id="6810104">err</span><span class="op" id="6810107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810113">defer</span>&nbsp;<span class="ident" id="6810119">c</span><span class="op" id="6810120">.</span><span class="ident" id="6810121">Close</span><span class="op" id="6810126">(</span><span class="op" id="6810127">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810131">ra</span><span class="op" id="6810133">,</span>&nbsp;<span class="ident" id="6810135">err</span>&nbsp;<span class="op" id="6810139">:=</span>&nbsp;<span class="ident" id="6810142">ResolveUDPAddr</span><span class="op" id="6810156">(</span><span class="string" id="6810157">&#34;udp&#34;</span><span class="op" id="6810162">,</span>&nbsp;<span class="ident" id="6810164">raddr</span><span class="op" id="6810169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810172">if</span>&nbsp;<span class="ident" id="6810175">err</span>&nbsp;<span class="op" id="6810179">!=</span>&nbsp;<span class="builtintype" id="6810182">nil</span>&nbsp;<span class="op" id="6810186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810190">t</span><span class="op" id="6810191">.</span><span class="ident" id="6810192">Fatalf</span><span class="op" id="6810198">(</span><span class="string" id="6810199">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6810226">,</span>&nbsp;<span class="ident" id="6810228">err</span><span class="op" id="6810231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810234">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810238">_</span><span class="op" id="6810239">,</span>&nbsp;<span class="ident" id="6810241">err</span>&nbsp;<span class="op" id="6810245">=</span>&nbsp;<span class="ident" id="6810247">c</span><span class="op" id="6810248">.</span><span class="op" id="6810249">(</span><span class="op" id="6810250">*</span><span class="ident" id="6810251">UDPConn</span><span class="op" id="6810258">)</span><span class="op" id="6810259">.</span><span class="ident" id="6810260">WriteToUDP</span><span class="op" id="6810270">(</span><span class="op" id="6810271">[</span><span class="op" id="6810272">]</span><span class="builtintype" id="6810273">byte</span><span class="op" id="6810277">(</span><span class="string" id="6810278">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6810307">)</span><span class="op" id="6810308">,</span>&nbsp;<span class="ident" id="6810310">ra</span><span class="op" id="6810312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810315">if</span>&nbsp;<span class="ident" id="6810318">err</span>&nbsp;<span class="op" id="6810322">!=</span>&nbsp;<span class="builtintype" id="6810325">nil</span>&nbsp;<span class="op" id="6810329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810333">t</span><span class="op" id="6810334">.</span><span class="ident" id="6810335">Fatalf</span><span class="op" id="6810341">(</span><span class="string" id="6810342">&#34;WriteToUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6810365">,</span>&nbsp;<span class="ident" id="6810367">err</span><span class="op" id="6810370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810373">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810377">_</span><span class="op" id="6810378">,</span>&nbsp;<span class="ident" id="6810380">err</span>&nbsp;<span class="op" id="6810384">=</span>&nbsp;<span class="ident" id="6810386">c</span><span class="op" id="6810387">.</span><span class="ident" id="6810388">WriteTo</span><span class="op" id="6810395">(</span><span class="op" id="6810396">[</span><span class="op" id="6810397">]</span><span class="builtintype" id="6810398">byte</span><span class="op" id="6810402">(</span><span class="string" id="6810403">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6810432">)</span><span class="op" id="6810433">,</span>&nbsp;<span class="ident" id="6810435">ra</span><span class="op" id="6810437">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810440">if</span>&nbsp;<span class="ident" id="6810443">err</span>&nbsp;<span class="op" id="6810447">!=</span>&nbsp;<span class="builtintype" id="6810450">nil</span>&nbsp;<span class="op" id="6810454">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810458">t</span><span class="op" id="6810459">.</span><span class="ident" id="6810460">Fatalf</span><span class="op" id="6810466">(</span><span class="string" id="6810467">&#34;WriteTo&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6810487">,</span>&nbsp;<span class="ident" id="6810489">err</span><span class="op" id="6810492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810499">_</span><span class="op" id="6810500">,</span>&nbsp;<span class="ident" id="6810502">err</span>&nbsp;<span class="op" id="6810506">=</span>&nbsp;<span class="ident" id="6810508">c</span><span class="op" id="6810509">.</span><span class="op" id="6810510">(</span><span class="op" id="6810511">*</span><span class="ident" id="6810512">UDPConn</span><span class="op" id="6810519">)</span><span class="op" id="6810520">.</span><span class="ident" id="6810521">Write</span><span class="op" id="6810526">(</span><span class="op" id="6810527">[</span><span class="op" id="6810528">]</span><span class="builtintype" id="6810529">byte</span><span class="op" id="6810533">(</span><span class="string" id="6810534">&#34;Connection-less&nbsp;mode&nbsp;socket&#34;</span><span class="op" id="6810563">)</span><span class="op" id="6810564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810567">if</span>&nbsp;<span class="ident" id="6810570">err</span>&nbsp;<span class="op" id="6810574">==</span>&nbsp;<span class="builtintype" id="6810577">nil</span>&nbsp;<span class="op" id="6810581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810585">t</span><span class="op" id="6810586">.</span><span class="ident" id="6810587">Fatal</span><span class="op" id="6810592">(</span><span class="string" id="6810593">&#34;Write&nbsp;should&nbsp;fail&#34;</span><span class="op" id="6810612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810615">}</span><br>
<span class="lineno"></span><span class="op" id="6810617">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="6810620">var</span>&nbsp;<span class="ident" id="6810624">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6810646">=</span>&nbsp;<span class="op" id="6810648">[</span><span class="op" id="6810649">]</span><span class="keyword" id="6810650">struct</span>&nbsp;<span class="op" id="6810657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810660">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6810666">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810674">laddr</span>&nbsp;<span class="op" id="6810680">*</span><span class="ident" id="6810681">UDPAddr</span><br>
<span class="lineno"></span><span class="op" id="6810689">}</span><span class="op" id="6810690">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810693">{</span><span class="string" id="6810694">&#34;udp4&#34;</span><span class="op" id="6810700">,</span>&nbsp;<span class="op" id="6810702">&amp;</span><span class="ident" id="6810703">UDPAddr</span><span class="op" id="6810710">{</span><span class="ident" id="6810711">IP</span><span class="op" id="6810713">:</span>&nbsp;<span class="ident" id="6810715">IPv4</span><span class="op" id="6810719">(</span><span class="num" id="6810720">127</span><span class="op" id="6810723">,</span>&nbsp;<span class="num" id="6810725">0</span><span class="op" id="6810726">,</span>&nbsp;<span class="num" id="6810728">0</span><span class="op" id="6810729">,</span>&nbsp;<span class="num" id="6810731">1</span><span class="op" id="6810732">)</span><span class="op" id="6810733">}</span><span class="op" id="6810734">}</span><span class="op" id="6810735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810738">{</span><span class="string" id="6810739">&#34;udp4&#34;</span><span class="op" id="6810745">,</span>&nbsp;<span class="op" id="6810747">&amp;</span><span class="ident" id="6810748">UDPAddr</span><span class="op" id="6810755">{</span><span class="op" id="6810756">}</span><span class="op" id="6810757">}</span><span class="op" id="6810758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810761">{</span><span class="string" id="6810762">&#34;udp4&#34;</span><span class="op" id="6810768">,</span>&nbsp;<span class="builtintype" id="6810770">nil</span><span class="op" id="6810773">}</span><span class="op" id="6810774">,</span><br>
<span class="lineno"></span><span class="op" id="6810776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="6810779">func</span>&nbsp;<span class="ident" id="6810784">TestUDPConnLocalName</span><span class="op" id="6810804">(</span><span class="ident" id="6810805">t</span>&nbsp;<span class="op" id="6810807">*</span><span class="ident" id="6810808">testing</span><span class="op" id="6810815">.</span><span class="ident" id="6810816">T</span><span class="op" id="6810817">)</span>&nbsp;<span class="op" id="6810819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810822">if</span>&nbsp;<span class="ident" id="6810825">testing</span><span class="op" id="6810832">.</span><span class="ident" id="6810833">Short</span><span class="op" id="6810838">(</span><span class="op" id="6810839">)</span>&nbsp;<span class="op" id="6810841">||</span>&nbsp;<span class="op" id="6810844">!</span><span class="op" id="6810845">*</span><span class="ident" id="6810846">testExternal</span>&nbsp;<span class="op" id="6810859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810863">t</span><span class="op" id="6810864">.</span><span class="ident" id="6810865">Skip</span><span class="op" id="6810869">(</span><span class="string" id="6810870">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6810911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6810914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6810918">for</span>&nbsp;<span class="ident" id="6810922">_</span><span class="op" id="6810923">,</span>&nbsp;<span class="ident" id="6810925">tt</span>&nbsp;<span class="op" id="6810928">:=</span>&nbsp;<span class="keyword" id="6810931">range</span>&nbsp;<span class="ident" id="6810937">udpConnLocalNameTests</span>&nbsp;<span class="op" id="6810959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6810963">c</span><span class="op" id="6810964">,</span>&nbsp;<span class="ident" id="6810966">err</span>&nbsp;<span class="op" id="6810970">:=</span>&nbsp;<span class="ident" id="6810973">ListenUDP</span><span class="op" id="6810982">(</span><span class="ident" id="6810983">tt</span><span class="op" id="6810985">.</span><span class="ident" id="6810986">net</span><span class="op" id="6810989">,</span>&nbsp;<span class="ident" id="6810991">tt</span><span class="op" id="6810993">.</span><span class="ident" id="6810994">laddr</span><span class="op" id="6810999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811003">if</span>&nbsp;<span class="ident" id="6811006">err</span>&nbsp;<span class="op" id="6811010">!=</span>&nbsp;<span class="builtintype" id="6811013">nil</span>&nbsp;<span class="op" id="6811017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811022">t</span><span class="op" id="6811023">.</span><span class="ident" id="6811024">Fatalf</span><span class="op" id="6811030">(</span><span class="string" id="6811031">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6811053">,</span>&nbsp;<span class="ident" id="6811055">err</span><span class="op" id="6811058">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811062">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811066">defer</span>&nbsp;<span class="ident" id="6811072">c</span><span class="op" id="6811073">.</span><span class="ident" id="6811074">Close</span><span class="op" id="6811079">(</span><span class="op" id="6811080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811084">la</span>&nbsp;<span class="op" id="6811087">:=</span>&nbsp;<span class="ident" id="6811090">c</span><span class="op" id="6811091">.</span><span class="ident" id="6811092">LocalAddr</span><span class="op" id="6811101">(</span><span class="op" id="6811102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811106">if</span>&nbsp;<span class="ident" id="6811109">a</span><span class="op" id="6811110">,</span>&nbsp;<span class="ident" id="6811112">ok</span>&nbsp;<span class="op" id="6811115">:=</span>&nbsp;<span class="ident" id="6811118">la</span><span class="op" id="6811120">.</span><span class="op" id="6811121">(</span><span class="op" id="6811122">*</span><span class="ident" id="6811123">UDPAddr</span><span class="op" id="6811130">)</span><span class="op" id="6811131">;</span>&nbsp;<span class="op" id="6811133">!</span><span class="ident" id="6811134">ok</span>&nbsp;<span class="op" id="6811137">||</span>&nbsp;<span class="ident" id="6811140">a</span><span class="op" id="6811141">.</span><span class="ident" id="6811142">Port</span>&nbsp;<span class="op" id="6811147">==</span>&nbsp;<span class="num" id="6811150">0</span>&nbsp;<span class="op" id="6811152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811157">t</span><span class="op" id="6811158">.</span><span class="ident" id="6811159">Fatalf</span><span class="op" id="6811165">(</span><span class="string" id="6811166">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6811227">,</span>&nbsp;<span class="ident" id="6811229">la</span><span class="op" id="6811231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811235">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811238">}</span><br>
<span class="lineno"></span><span class="op" id="6811240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6811243">func</span>&nbsp;<span class="ident" id="6811248">TestUDPConnLocalAndRemoteNames</span><span class="op" id="6811278">(</span><span class="ident" id="6811279">t</span>&nbsp;<span class="op" id="6811281">*</span><span class="ident" id="6811282">testing</span><span class="op" id="6811289">.</span><span class="ident" id="6811290">T</span><span class="op" id="6811291">)</span>&nbsp;<span class="op" id="6811293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811296">for</span>&nbsp;<span class="ident" id="6811300">_</span><span class="op" id="6811301">,</span>&nbsp;<span class="ident" id="6811303">laddr</span>&nbsp;<span class="op" id="6811309">:=</span>&nbsp;<span class="keyword" id="6811312">range</span>&nbsp;<span class="op" id="6811318">[</span><span class="op" id="6811319">]</span><span class="builtintype" id="6811320">string</span><span class="op" id="6811326">{</span><span class="string" id="6811327">&#34;&#34;</span><span class="op" id="6811329">,</span>&nbsp;<span class="string" id="6811331">&#34;127.0.0.1:0&#34;</span><span class="op" id="6811344">}</span>&nbsp;<span class="op" id="6811346">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811350">c1</span><span class="op" id="6811352">,</span>&nbsp;<span class="ident" id="6811354">err</span>&nbsp;<span class="op" id="6811358">:=</span>&nbsp;<span class="ident" id="6811361">ListenPacket</span><span class="op" id="6811373">(</span><span class="string" id="6811374">&#34;udp&#34;</span><span class="op" id="6811379">,</span>&nbsp;<span class="string" id="6811381">&#34;127.0.0.1:0&#34;</span><span class="op" id="6811394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811398">if</span>&nbsp;<span class="ident" id="6811401">err</span>&nbsp;<span class="op" id="6811405">!=</span>&nbsp;<span class="builtintype" id="6811408">nil</span>&nbsp;<span class="op" id="6811412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811417">t</span><span class="op" id="6811418">.</span><span class="ident" id="6811419">Fatalf</span><span class="op" id="6811425">(</span><span class="string" id="6811426">&#34;ListenUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6811448">,</span>&nbsp;<span class="ident" id="6811450">err</span><span class="op" id="6811453">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811461">defer</span>&nbsp;<span class="ident" id="6811467">c1</span><span class="op" id="6811469">.</span><span class="ident" id="6811470">Close</span><span class="op" id="6811475">(</span><span class="op" id="6811476">)</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811481">var</span>&nbsp;<span class="ident" id="6811485">la</span>&nbsp;<span class="op" id="6811488">*</span><span class="ident" id="6811489">UDPAddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811499">if</span>&nbsp;<span class="ident" id="6811502">laddr</span>&nbsp;<span class="op" id="6811508">!=</span>&nbsp;<span class="string" id="6811511">&#34;&#34;</span>&nbsp;<span class="op" id="6811514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811519">var</span>&nbsp;<span class="ident" id="6811523">err</span>&nbsp;<span class="builtintype" id="6811527">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811536">if</span>&nbsp;<span class="ident" id="6811539">la</span><span class="op" id="6811541">,</span>&nbsp;<span class="ident" id="6811543">err</span>&nbsp;<span class="op" id="6811547">=</span>&nbsp;<span class="ident" id="6811549">ResolveUDPAddr</span><span class="op" id="6811563">(</span><span class="string" id="6811564">&#34;udp&#34;</span><span class="op" id="6811569">,</span>&nbsp;<span class="ident" id="6811571">laddr</span><span class="op" id="6811576">)</span><span class="op" id="6811577">;</span>&nbsp;<span class="ident" id="6811579">err</span>&nbsp;<span class="op" id="6811583">!=</span>&nbsp;<span class="builtintype" id="6811586">nil</span>&nbsp;<span class="op" id="6811590">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811596">t</span><span class="op" id="6811597">.</span><span class="ident" id="6811598">Fatalf</span><span class="op" id="6811604">(</span><span class="string" id="6811605">&#34;ResolveUDPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6811632">,</span>&nbsp;<span class="ident" id="6811634">err</span><span class="op" id="6811637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811642">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811650">c2</span><span class="op" id="6811652">,</span>&nbsp;<span class="ident" id="6811654">err</span>&nbsp;<span class="op" id="6811658">:=</span>&nbsp;<span class="ident" id="6811661">DialUDP</span><span class="op" id="6811668">(</span><span class="string" id="6811669">&#34;udp&#34;</span><span class="op" id="6811674">,</span>&nbsp;<span class="ident" id="6811676">la</span><span class="op" id="6811678">,</span>&nbsp;<span class="ident" id="6811680">c1</span><span class="op" id="6811682">.</span><span class="ident" id="6811683">LocalAddr</span><span class="op" id="6811692">(</span><span class="op" id="6811693">)</span><span class="op" id="6811694">.</span><span class="op" id="6811695">(</span><span class="op" id="6811696">*</span><span class="ident" id="6811697">UDPAddr</span><span class="op" id="6811704">)</span><span class="op" id="6811705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811709">if</span>&nbsp;<span class="ident" id="6811712">err</span>&nbsp;<span class="op" id="6811716">!=</span>&nbsp;<span class="builtintype" id="6811719">nil</span>&nbsp;<span class="op" id="6811723">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811728">t</span><span class="op" id="6811729">.</span><span class="ident" id="6811730">Fatalf</span><span class="op" id="6811736">(</span><span class="string" id="6811737">&#34;DialUDP&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6811757">,</span>&nbsp;<span class="ident" id="6811759">err</span><span class="op" id="6811762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811770">defer</span>&nbsp;<span class="ident" id="6811776">c2</span><span class="op" id="6811778">.</span><span class="ident" id="6811779">Close</span><span class="op" id="6811784">(</span><span class="op" id="6811785">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811790">var</span>&nbsp;<span class="ident" id="6811794">connAddrs</span>&nbsp;<span class="op" id="6811804">=</span>&nbsp;<span class="op" id="6811806">[</span><span class="num" id="6811807">4</span><span class="op" id="6811808">]</span><span class="keyword" id="6811809">struct</span>&nbsp;<span class="op" id="6811816">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811821">got</span>&nbsp;<span class="ident" id="6811825">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6811833">ok</span>&nbsp;&nbsp;<span class="builtintype" id="6811837">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811844">}</span><span class="op" id="6811845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811850">{</span><span class="ident" id="6811851">c1</span><span class="op" id="6811853">.</span><span class="ident" id="6811854">LocalAddr</span><span class="op" id="6811863">(</span><span class="op" id="6811864">)</span><span class="op" id="6811865">,</span>&nbsp;<span class="builtintype" id="6811867">true</span><span class="op" id="6811871">}</span><span class="op" id="6811872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811877">{</span><span class="ident" id="6811878">c1</span><span class="op" id="6811880">.</span><span class="op" id="6811881">(</span><span class="op" id="6811882">*</span><span class="ident" id="6811883">UDPConn</span><span class="op" id="6811890">)</span><span class="op" id="6811891">.</span><span class="ident" id="6811892">RemoteAddr</span><span class="op" id="6811902">(</span><span class="op" id="6811903">)</span><span class="op" id="6811904">,</span>&nbsp;<span class="builtintype" id="6811906">false</span><span class="op" id="6811911">}</span><span class="op" id="6811912">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811917">{</span><span class="ident" id="6811918">c2</span><span class="op" id="6811920">.</span><span class="ident" id="6811921">LocalAddr</span><span class="op" id="6811930">(</span><span class="op" id="6811931">)</span><span class="op" id="6811932">,</span>&nbsp;<span class="builtintype" id="6811934">true</span><span class="op" id="6811938">}</span><span class="op" id="6811939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811944">{</span><span class="ident" id="6811945">c2</span><span class="op" id="6811947">.</span><span class="ident" id="6811948">RemoteAddr</span><span class="op" id="6811958">(</span><span class="op" id="6811959">)</span><span class="op" id="6811960">,</span>&nbsp;<span class="builtintype" id="6811962">true</span><span class="op" id="6811966">}</span><span class="op" id="6811967">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6811971">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6811975">for</span>&nbsp;<span class="ident" id="6811979">_</span><span class="op" id="6811980">,</span>&nbsp;<span class="ident" id="6811982">ca</span>&nbsp;<span class="op" id="6811985">:=</span>&nbsp;<span class="keyword" id="6811988">range</span>&nbsp;<span class="ident" id="6811994">connAddrs</span>&nbsp;<span class="op" id="6812004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812009">if</span>&nbsp;<span class="ident" id="6812012">a</span><span class="op" id="6812013">,</span>&nbsp;<span class="ident" id="6812015">ok</span>&nbsp;<span class="op" id="6812018">:=</span>&nbsp;<span class="ident" id="6812021">ca</span><span class="op" id="6812023">.</span><span class="ident" id="6812024">got</span><span class="op" id="6812027">.</span><span class="op" id="6812028">(</span><span class="op" id="6812029">*</span><span class="ident" id="6812030">UDPAddr</span><span class="op" id="6812037">)</span><span class="op" id="6812038">;</span>&nbsp;<span class="ident" id="6812040">ok</span>&nbsp;<span class="op" id="6812043">!=</span>&nbsp;<span class="ident" id="6812046">ca</span><span class="op" id="6812048">.</span><span class="ident" id="6812049">ok</span>&nbsp;<span class="op" id="6812052">||</span>&nbsp;<span class="ident" id="6812055">ok</span>&nbsp;<span class="op" id="6812058">&amp;&amp;</span>&nbsp;<span class="ident" id="6812061">a</span><span class="op" id="6812062">.</span><span class="ident" id="6812063">Port</span>&nbsp;<span class="op" id="6812068">==</span>&nbsp;<span class="num" id="6812071">0</span>&nbsp;<span class="op" id="6812073">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812079">t</span><span class="op" id="6812080">.</span><span class="ident" id="6812081">Fatalf</span><span class="op" id="6812087">(</span><span class="string" id="6812088">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="6812149">,</span>&nbsp;<span class="ident" id="6812151">ca</span><span class="op" id="6812153">.</span><span class="ident" id="6812154">got</span><span class="op" id="6812157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812169">}</span><br>
<span class="lineno"></span><span class="op" id="6812171">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="6812174">func</span>&nbsp;<span class="ident" id="6812179">TestIPv6LinkLocalUnicastUDP</span><span class="op" id="6812206">(</span><span class="ident" id="6812207">t</span>&nbsp;<span class="op" id="6812209">*</span><span class="ident" id="6812210">testing</span><span class="op" id="6812217">.</span><span class="ident" id="6812218">T</span><span class="op" id="6812219">)</span>&nbsp;<span class="op" id="6812221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812224">if</span>&nbsp;<span class="ident" id="6812227">testing</span><span class="op" id="6812234">.</span><span class="ident" id="6812235">Short</span><span class="op" id="6812240">(</span><span class="op" id="6812241">)</span>&nbsp;<span class="op" id="6812243">||</span>&nbsp;<span class="op" id="6812246">!</span><span class="op" id="6812247">*</span><span class="ident" id="6812248">testExternal</span>&nbsp;<span class="op" id="6812261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812265">t</span><span class="op" id="6812266">.</span><span class="ident" id="6812267">Skip</span><span class="op" id="6812271">(</span><span class="string" id="6812272">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="6812313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812316">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812319">if</span>&nbsp;<span class="op" id="6812322">!</span><span class="ident" id="6812323">supportsIPv6</span>&nbsp;<span class="op" id="6812336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812340">t</span><span class="op" id="6812341">.</span><span class="ident" id="6812342">Skip</span><span class="op" id="6812346">(</span><span class="string" id="6812347">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="6812370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812376">ifi</span>&nbsp;<span class="op" id="6812380">:=</span>&nbsp;<span class="ident" id="6812383">loopbackInterface</span><span class="op" id="6812400">(</span><span class="op" id="6812401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812404">if</span>&nbsp;<span class="ident" id="6812407">ifi</span>&nbsp;<span class="op" id="6812411">==</span>&nbsp;<span class="builtintype" id="6812414">nil</span>&nbsp;<span class="op" id="6812418">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812422">t</span><span class="op" id="6812423">.</span><span class="ident" id="6812424">Skip</span><span class="op" id="6812428">(</span><span class="string" id="6812429">&#34;loopback&nbsp;interface&nbsp;not&nbsp;found&#34;</span><span class="op" id="6812459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812465">laddr</span>&nbsp;<span class="op" id="6812471">:=</span>&nbsp;<span class="ident" id="6812474">ipv6LinkLocalUnicastAddr</span><span class="op" id="6812498">(</span><span class="ident" id="6812499">ifi</span><span class="op" id="6812502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812505">if</span>&nbsp;<span class="ident" id="6812508">laddr</span>&nbsp;<span class="op" id="6812514">==</span>&nbsp;<span class="string" id="6812517">&#34;&#34;</span>&nbsp;<span class="op" id="6812520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812524">t</span><span class="op" id="6812525">.</span><span class="ident" id="6812526">Skip</span><span class="op" id="6812530">(</span><span class="string" id="6812531">&#34;ipv6&nbsp;unicast&nbsp;address&nbsp;on&nbsp;loopback&nbsp;not&nbsp;found&#34;</span><span class="op" id="6812575">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812582">type</span>&nbsp;<span class="ident" id="6812587">test</span>&nbsp;<span class="keyword" id="6812592">struct</span>&nbsp;<span class="op" id="6812599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812603">net</span><span class="op" id="6812606">,</span>&nbsp;<span class="ident" id="6812608">addr</span>&nbsp;&nbsp;<span class="builtintype" id="6812614">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812623">nameLookup</span>&nbsp;<span class="builtintype" id="6812634">bool</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812643">var</span>&nbsp;<span class="ident" id="6812647">tests</span>&nbsp;<span class="op" id="6812653">=</span>&nbsp;<span class="op" id="6812655">[</span><span class="op" id="6812656">]</span><span class="ident" id="6812657">test</span><span class="op" id="6812661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812665">{</span><span class="string" id="6812666">&#34;udp&#34;</span><span class="op" id="6812671">,</span>&nbsp;<span class="string" id="6812673">&#34;[&#34;</span>&nbsp;<span class="op" id="6812677">+</span>&nbsp;<span class="ident" id="6812679">laddr</span>&nbsp;<span class="op" id="6812685">+</span>&nbsp;<span class="string" id="6812687">&#34;%&#34;</span>&nbsp;<span class="op" id="6812691">+</span>&nbsp;<span class="ident" id="6812693">ifi</span><span class="op" id="6812696">.</span><span class="ident" id="6812697">Name</span>&nbsp;<span class="op" id="6812702">+</span>&nbsp;<span class="string" id="6812704">&#34;]:0&#34;</span><span class="op" id="6812709">,</span>&nbsp;<span class="builtintype" id="6812711">false</span><span class="op" id="6812716">}</span><span class="op" id="6812717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812721">{</span><span class="string" id="6812722">&#34;udp6&#34;</span><span class="op" id="6812728">,</span>&nbsp;<span class="string" id="6812730">&#34;[&#34;</span>&nbsp;<span class="op" id="6812734">+</span>&nbsp;<span class="ident" id="6812736">laddr</span>&nbsp;<span class="op" id="6812742">+</span>&nbsp;<span class="string" id="6812744">&#34;%&#34;</span>&nbsp;<span class="op" id="6812748">+</span>&nbsp;<span class="ident" id="6812750">ifi</span><span class="op" id="6812753">.</span><span class="ident" id="6812754">Name</span>&nbsp;<span class="op" id="6812759">+</span>&nbsp;<span class="string" id="6812761">&#34;]:0&#34;</span><span class="op" id="6812766">,</span>&nbsp;<span class="builtintype" id="6812768">false</span><span class="op" id="6812773">}</span><span class="op" id="6812774">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812777">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6812780">//&nbsp;The&nbsp;first&nbsp;udp&nbsp;test&nbsp;fails&nbsp;on&nbsp;DragonFly&nbsp;-&nbsp;see&nbsp;issue&nbsp;7473.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812840">if</span>&nbsp;<span class="ident" id="6812843">runtime</span><span class="op" id="6812850">.</span><span class="ident" id="6812851">GOOS</span>&nbsp;<span class="op" id="6812856">==</span>&nbsp;<span class="string" id="6812859">&#34;dragonfly&#34;</span>&nbsp;<span class="op" id="6812871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812875">tests</span>&nbsp;<span class="op" id="6812881">=</span>&nbsp;<span class="ident" id="6812883">tests</span><span class="op" id="6812888">[</span><span class="num" id="6812889">1</span><span class="op" id="6812890">:</span><span class="op" id="6812891">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6812894">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812897">switch</span>&nbsp;<span class="ident" id="6812904">runtime</span><span class="op" id="6812911">.</span><span class="ident" id="6812912">GOOS</span>&nbsp;<span class="op" id="6812917">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6812920">case</span>&nbsp;<span class="string" id="6812925">&#34;darwin&#34;</span><span class="op" id="6812933">,</span>&nbsp;<span class="string" id="6812935">&#34;dragonfly&#34;</span><span class="op" id="6812946">,</span>&nbsp;<span class="string" id="6812948">&#34;freebsd&#34;</span><span class="op" id="6812957">,</span>&nbsp;<span class="string" id="6812959">&#34;openbsd&#34;</span><span class="op" id="6812968">,</span>&nbsp;<span class="string" id="6812970">&#34;netbsd&#34;</span><span class="op" id="6812978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6812982">tests</span>&nbsp;<span class="op" id="6812988">=</span>&nbsp;<span class="builtinfunc" id="6812990">append</span><span class="op" id="6812996">(</span><span class="ident" id="6812997">tests</span><span class="op" id="6813002">,</span>&nbsp;<span class="op" id="6813004">[</span><span class="op" id="6813005">]</span><span class="ident" id="6813006">test</span><span class="op" id="6813010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813015">{</span><span class="string" id="6813016">&#34;udp&#34;</span><span class="op" id="6813021">,</span>&nbsp;<span class="string" id="6813023">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6813037">+</span>&nbsp;<span class="ident" id="6813039">ifi</span><span class="op" id="6813042">.</span><span class="ident" id="6813043">Name</span>&nbsp;<span class="op" id="6813048">+</span>&nbsp;<span class="string" id="6813050">&#34;]:0&#34;</span><span class="op" id="6813055">,</span>&nbsp;<span class="builtintype" id="6813057">true</span><span class="op" id="6813061">}</span><span class="op" id="6813062">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813067">{</span><span class="string" id="6813068">&#34;udp6&#34;</span><span class="op" id="6813074">,</span>&nbsp;<span class="string" id="6813076">&#34;[localhost%&#34;</span>&nbsp;<span class="op" id="6813090">+</span>&nbsp;<span class="ident" id="6813092">ifi</span><span class="op" id="6813095">.</span><span class="ident" id="6813096">Name</span>&nbsp;<span class="op" id="6813101">+</span>&nbsp;<span class="string" id="6813103">&#34;]:0&#34;</span><span class="op" id="6813108">,</span>&nbsp;<span class="builtintype" id="6813110">true</span><span class="op" id="6813114">}</span><span class="op" id="6813115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813119">}</span><span class="op" id="6813120">...</span><span class="op" id="6813123">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813126">case</span>&nbsp;<span class="string" id="6813131">&#34;linux&#34;</span><span class="op" id="6813138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813142">tests</span>&nbsp;<span class="op" id="6813148">=</span>&nbsp;<span class="builtinfunc" id="6813150">append</span><span class="op" id="6813156">(</span><span class="ident" id="6813157">tests</span><span class="op" id="6813162">,</span>&nbsp;<span class="op" id="6813164">[</span><span class="op" id="6813165">]</span><span class="ident" id="6813166">test</span><span class="op" id="6813170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813175">{</span><span class="string" id="6813176">&#34;udp&#34;</span><span class="op" id="6813181">,</span>&nbsp;<span class="string" id="6813183">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6813201">+</span>&nbsp;<span class="ident" id="6813203">ifi</span><span class="op" id="6813206">.</span><span class="ident" id="6813207">Name</span>&nbsp;<span class="op" id="6813212">+</span>&nbsp;<span class="string" id="6813214">&#34;]:0&#34;</span><span class="op" id="6813219">,</span>&nbsp;<span class="builtintype" id="6813221">true</span><span class="op" id="6813225">}</span><span class="op" id="6813226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813231">{</span><span class="string" id="6813232">&#34;udp6&#34;</span><span class="op" id="6813238">,</span>&nbsp;<span class="string" id="6813240">&#34;[ip6-localhost%&#34;</span>&nbsp;<span class="op" id="6813258">+</span>&nbsp;<span class="ident" id="6813260">ifi</span><span class="op" id="6813263">.</span><span class="ident" id="6813264">Name</span>&nbsp;<span class="op" id="6813269">+</span>&nbsp;<span class="string" id="6813271">&#34;]:0&#34;</span><span class="op" id="6813276">,</span>&nbsp;<span class="builtintype" id="6813278">true</span><span class="op" id="6813282">}</span><span class="op" id="6813283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813287">}</span><span class="op" id="6813288">...</span><span class="op" id="6813291">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813294">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813297">for</span>&nbsp;<span class="ident" id="6813301">_</span><span class="op" id="6813302">,</span>&nbsp;<span class="ident" id="6813304">tt</span>&nbsp;<span class="op" id="6813307">:=</span>&nbsp;<span class="keyword" id="6813310">range</span>&nbsp;<span class="ident" id="6813316">tests</span>&nbsp;<span class="op" id="6813322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813326">c1</span><span class="op" id="6813328">,</span>&nbsp;<span class="ident" id="6813330">err</span>&nbsp;<span class="op" id="6813334">:=</span>&nbsp;<span class="ident" id="6813337">ListenPacket</span><span class="op" id="6813349">(</span><span class="ident" id="6813350">tt</span><span class="op" id="6813352">.</span><span class="ident" id="6813353">net</span><span class="op" id="6813356">,</span>&nbsp;<span class="ident" id="6813358">tt</span><span class="op" id="6813360">.</span><span class="ident" id="6813361">addr</span><span class="op" id="6813365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813369">if</span>&nbsp;<span class="ident" id="6813372">err</span>&nbsp;<span class="op" id="6813376">!=</span>&nbsp;<span class="builtintype" id="6813379">nil</span>&nbsp;<span class="op" id="6813383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6813388">//&nbsp;It&nbsp;might&nbsp;return&nbsp;&#34;LookupHost&nbsp;returned&nbsp;no</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6813434">//&nbsp;suitable&nbsp;address&#34;&nbsp;error&nbsp;on&nbsp;some&nbsp;platforms.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813483">t</span><span class="op" id="6813484">.</span><span class="ident" id="6813485">Logf</span><span class="op" id="6813489">(</span><span class="string" id="6813490">&#34;ListenPacket&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6813515">,</span>&nbsp;<span class="ident" id="6813517">err</span><span class="op" id="6813520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813540">defer</span>&nbsp;<span class="ident" id="6813546">c1</span><span class="op" id="6813548">.</span><span class="ident" id="6813549">Close</span><span class="op" id="6813554">(</span><span class="op" id="6813555">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813559">if</span>&nbsp;<span class="ident" id="6813562">la</span><span class="op" id="6813564">,</span>&nbsp;<span class="ident" id="6813566">ok</span>&nbsp;<span class="op" id="6813569">:=</span>&nbsp;<span class="ident" id="6813572">c1</span><span class="op" id="6813574">.</span><span class="ident" id="6813575">LocalAddr</span><span class="op" id="6813584">(</span><span class="op" id="6813585">)</span><span class="op" id="6813586">.</span><span class="op" id="6813587">(</span><span class="op" id="6813588">*</span><span class="ident" id="6813589">UDPAddr</span><span class="op" id="6813596">)</span><span class="op" id="6813597">;</span>&nbsp;<span class="op" id="6813599">!</span><span class="ident" id="6813600">ok</span>&nbsp;<span class="op" id="6813603">||</span>&nbsp;<span class="op" id="6813606">!</span><span class="ident" id="6813607">tt</span><span class="op" id="6813609">.</span><span class="ident" id="6813610">nameLookup</span>&nbsp;<span class="op" id="6813621">&amp;&amp;</span>&nbsp;<span class="ident" id="6813624">la</span><span class="op" id="6813626">.</span><span class="ident" id="6813627">Zone</span>&nbsp;<span class="op" id="6813632">==</span>&nbsp;<span class="string" id="6813635">&#34;&#34;</span>&nbsp;<span class="op" id="6813638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813643">t</span><span class="op" id="6813644">.</span><span class="ident" id="6813645">Fatalf</span><span class="op" id="6813651">(</span><span class="string" id="6813652">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6813708">,</span>&nbsp;<span class="ident" id="6813710">la</span><span class="op" id="6813712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813721">c2</span><span class="op" id="6813723">,</span>&nbsp;<span class="ident" id="6813725">err</span>&nbsp;<span class="op" id="6813729">:=</span>&nbsp;<span class="ident" id="6813732">Dial</span><span class="op" id="6813736">(</span><span class="ident" id="6813737">tt</span><span class="op" id="6813739">.</span><span class="ident" id="6813740">net</span><span class="op" id="6813743">,</span>&nbsp;<span class="ident" id="6813745">c1</span><span class="op" id="6813747">.</span><span class="ident" id="6813748">LocalAddr</span><span class="op" id="6813757">(</span><span class="op" id="6813758">)</span><span class="op" id="6813759">.</span><span class="ident" id="6813760">String</span><span class="op" id="6813766">(</span><span class="op" id="6813767">)</span><span class="op" id="6813768">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813772">if</span>&nbsp;<span class="ident" id="6813775">err</span>&nbsp;<span class="op" id="6813779">!=</span>&nbsp;<span class="builtintype" id="6813782">nil</span>&nbsp;<span class="op" id="6813786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813791">t</span><span class="op" id="6813792">.</span><span class="ident" id="6813793">Fatalf</span><span class="op" id="6813799">(</span><span class="string" id="6813800">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6813817">,</span>&nbsp;<span class="ident" id="6813819">err</span><span class="op" id="6813822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6813826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813830">defer</span>&nbsp;<span class="ident" id="6813836">c2</span><span class="op" id="6813838">.</span><span class="ident" id="6813839">Close</span><span class="op" id="6813844">(</span><span class="op" id="6813845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6813849">if</span>&nbsp;<span class="ident" id="6813852">la</span><span class="op" id="6813854">,</span>&nbsp;<span class="ident" id="6813856">ok</span>&nbsp;<span class="op" id="6813859">:=</span>&nbsp;<span class="ident" id="6813862">c2</span><span class="op" id="6813864">.</span><span class="ident" id="6813865">LocalAddr</span><span class="op" id="6813874">(</span><span class="op" id="6813875">)</span><span class="op" id="6813876">.</span><span class="op" id="6813877">(</span><span class="op" id="6813878">*</span><span class="ident" id="6813879">UDPAddr</span><span class="op" id="6813886">)</span><span class="op" id="6813887">;</span>&nbsp;<span class="op" id="6813889">!</span><span class="ident" id="6813890">ok</span>&nbsp;<span class="op" id="6813893">||</span>&nbsp;<span class="op" id="6813896">!</span><span class="ident" id="6813897">tt</span><span class="op" id="6813899">.</span><span class="ident" id="6813900">nameLookup</span>&nbsp;<span class="op" id="6813911">&amp;&amp;</span>&nbsp;<span class="ident" id="6813914">la</span><span class="op" id="6813916">.</span><span class="ident" id="6813917">Zone</span>&nbsp;<span class="op" id="6813922">==</span>&nbsp;<span class="string" id="6813925">&#34;&#34;</span>&nbsp;<span class="op" id="6813928">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6813933">t</span><span class="op" id="6813934">.</span><span class="ident" id="6813935">Fatalf</span><span class="op" id="6813941">(</span><span class="string" id="6813942">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6813998">,</span>&nbsp;<span class="ident" id="6814000">la</span><span class="op" id="6814002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814006">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6814010">if</span>&nbsp;<span class="ident" id="6814013">ra</span><span class="op" id="6814015">,</span>&nbsp;<span class="ident" id="6814017">ok</span>&nbsp;<span class="op" id="6814020">:=</span>&nbsp;<span class="ident" id="6814023">c2</span><span class="op" id="6814025">.</span><span class="ident" id="6814026">RemoteAddr</span><span class="op" id="6814036">(</span><span class="op" id="6814037">)</span><span class="op" id="6814038">.</span><span class="op" id="6814039">(</span><span class="op" id="6814040">*</span><span class="ident" id="6814041">UDPAddr</span><span class="op" id="6814048">)</span><span class="op" id="6814049">;</span>&nbsp;<span class="op" id="6814051">!</span><span class="ident" id="6814052">ok</span>&nbsp;<span class="op" id="6814055">||</span>&nbsp;<span class="op" id="6814058">!</span><span class="ident" id="6814059">tt</span><span class="op" id="6814061">.</span><span class="ident" id="6814062">nameLookup</span>&nbsp;<span class="op" id="6814073">&amp;&amp;</span>&nbsp;<span class="ident" id="6814076">ra</span><span class="op" id="6814078">.</span><span class="ident" id="6814079">Zone</span>&nbsp;<span class="op" id="6814084">==</span>&nbsp;<span class="string" id="6814087">&#34;&#34;</span>&nbsp;<span class="op" id="6814090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6814095">t</span><span class="op" id="6814096">.</span><span class="ident" id="6814097">Fatalf</span><span class="op" id="6814103">(</span><span class="string" id="6814104">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6814160">,</span>&nbsp;<span class="ident" id="6814162">ra</span><span class="op" id="6814164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814168">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6814173">if</span>&nbsp;<span class="ident" id="6814176">_</span><span class="op" id="6814177">,</span>&nbsp;<span class="ident" id="6814179">err</span>&nbsp;<span class="op" id="6814183">:=</span>&nbsp;<span class="ident" id="6814186">c2</span><span class="op" id="6814188">.</span><span class="ident" id="6814189">Write</span><span class="op" id="6814194">(</span><span class="op" id="6814195">[</span><span class="op" id="6814196">]</span><span class="builtintype" id="6814197">byte</span><span class="op" id="6814201">(</span><span class="string" id="6814202">&#34;UDP&nbsp;OVER&nbsp;IPV6&nbsp;LINKLOCAL&nbsp;TEST&#34;</span><span class="op" id="6814232">)</span><span class="op" id="6814233">)</span><span class="op" id="6814234">;</span>&nbsp;<span class="ident" id="6814236">err</span>&nbsp;<span class="op" id="6814240">!=</span>&nbsp;<span class="builtintype" id="6814243">nil</span>&nbsp;<span class="op" id="6814247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6814252">t</span><span class="op" id="6814253">.</span><span class="ident" id="6814254">Fatalf</span><span class="op" id="6814260">(</span><span class="string" id="6814261">&#34;Conn.Write&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6814284">,</span>&nbsp;<span class="ident" id="6814286">err</span><span class="op" id="6814289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6814297">b</span>&nbsp;<span class="op" id="6814299">:=</span>&nbsp;<span class="builtinfunc" id="6814302">make</span><span class="op" id="6814306">(</span><span class="op" id="6814307">[</span><span class="op" id="6814308">]</span><span class="builtintype" id="6814309">byte</span><span class="op" id="6814313">,</span>&nbsp;<span class="num" id="6814315">32</span><span class="op" id="6814317">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6814321">if</span>&nbsp;<span class="ident" id="6814324">_</span><span class="op" id="6814325">,</span>&nbsp;<span class="ident" id="6814327">from</span><span class="op" id="6814331">,</span>&nbsp;<span class="ident" id="6814333">err</span>&nbsp;<span class="op" id="6814337">:=</span>&nbsp;<span class="ident" id="6814340">c1</span><span class="op" id="6814342">.</span><span class="ident" id="6814343">ReadFrom</span><span class="op" id="6814351">(</span><span class="ident" id="6814352">b</span><span class="op" id="6814353">)</span><span class="op" id="6814354">;</span>&nbsp;<span class="ident" id="6814356">err</span>&nbsp;<span class="op" id="6814360">!=</span>&nbsp;<span class="builtintype" id="6814363">nil</span>&nbsp;<span class="op" id="6814367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6814372">t</span><span class="op" id="6814373">.</span><span class="ident" id="6814374">Fatalf</span><span class="op" id="6814380">(</span><span class="string" id="6814381">&#34;PacketConn.ReadFrom&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6814413">,</span>&nbsp;<span class="ident" id="6814415">err</span><span class="op" id="6814418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814422">}</span>&nbsp;<span class="keyword" id="6814424">else</span>&nbsp;<span class="op" id="6814429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6814434">if</span>&nbsp;<span class="ident" id="6814437">ra</span><span class="op" id="6814439">,</span>&nbsp;<span class="ident" id="6814441">ok</span>&nbsp;<span class="op" id="6814444">:=</span>&nbsp;<span class="ident" id="6814447">from</span><span class="op" id="6814451">.</span><span class="op" id="6814452">(</span><span class="op" id="6814453">*</span><span class="ident" id="6814454">UDPAddr</span><span class="op" id="6814461">)</span><span class="op" id="6814462">;</span>&nbsp;<span class="op" id="6814464">!</span><span class="ident" id="6814465">ok</span>&nbsp;<span class="op" id="6814468">||</span>&nbsp;<span class="op" id="6814471">!</span><span class="ident" id="6814472">tt</span><span class="op" id="6814474">.</span><span class="ident" id="6814475">nameLookup</span>&nbsp;<span class="op" id="6814486">&amp;&amp;</span>&nbsp;<span class="ident" id="6814489">ra</span><span class="op" id="6814491">.</span><span class="ident" id="6814492">Zone</span>&nbsp;<span class="op" id="6814497">==</span>&nbsp;<span class="string" id="6814500">&#34;&#34;</span>&nbsp;<span class="op" id="6814503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6814509">t</span><span class="op" id="6814510">.</span><span class="ident" id="6814511">Fatalf</span><span class="op" id="6814517">(</span><span class="string" id="6814518">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;zone&nbsp;identifier&#34;</span><span class="op" id="6814574">,</span>&nbsp;<span class="ident" id="6814576">ra</span><span class="op" id="6814578">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814587">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6814590">}</span><br>
<span class="lineno"></span><span class="op" id="6814592">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
