<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4530444">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4530499">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4530553">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4530604">//&nbsp;Package&nbsp;parse&nbsp;builds&nbsp;parse&nbsp;trees&nbsp;for&nbsp;templates&nbsp;as&nbsp;defined&nbsp;by&nbsp;text/template</span><br>
<span class="lineno"></span><span class="comment" id="4530682">//&nbsp;and&nbsp;html/template.&nbsp;Clients&nbsp;should&nbsp;use&nbsp;those&nbsp;packages&nbsp;to&nbsp;construct&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="4530761">//&nbsp;rather&nbsp;than&nbsp;this&nbsp;one,&nbsp;which&nbsp;provides&nbsp;shared&nbsp;internal&nbsp;data&nbsp;structures&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="4530837">//&nbsp;intended&nbsp;for&nbsp;general&nbsp;use.</span><br>
<span class="lineno"></span><span class="keyword" id="4530866">package</span>&nbsp;<span class="ident" id="4530874">parse</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4530881">import</span>&nbsp;<span class="op" id="4530888">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4530891">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4530900">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4530907">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4530918">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4530929">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4530939">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4530942">//&nbsp;Tree&nbsp;is&nbsp;the&nbsp;representation&nbsp;of&nbsp;a&nbsp;single&nbsp;parsed&nbsp;template.</span><br>
<span class="lineno">20</span><span class="keyword" id="4531001">type</span>&nbsp;<span class="ident" id="4531006">Tree</span>&nbsp;<span class="keyword" id="4531011">struct</span>&nbsp;<span class="op" id="4531018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531021">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4531031">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4531041">//&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;represented&nbsp;by&nbsp;the&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531091">ParseName</span>&nbsp;<span class="builtintype" id="4531101">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4531111">//&nbsp;name&nbsp;of&nbsp;the&nbsp;top-level&nbsp;template&nbsp;during&nbsp;parsing,&nbsp;for&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531182">Root</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531192">*</span><span class="ident" id="4531193"><a href="/text/template/parse/node.go.html#4512500">ListNode</a></span>&nbsp;<span class="comment" id="4531202">//&nbsp;top-level&nbsp;root&nbsp;of&nbsp;the&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531234">text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4531244">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4531254">//&nbsp;text&nbsp;parsed&nbsp;to&nbsp;create&nbsp;the&nbsp;template&nbsp;(or&nbsp;its&nbsp;parent)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4531309">//&nbsp;Parsing&nbsp;only;&nbsp;cleared&nbsp;after&nbsp;parse.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531348">funcs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531358">[</span><span class="op" id="4531359">]</span><span class="keyword" id="4531360">map</span><span class="op" id="4531363">[</span><span class="builtintype" id="4531364">string</span><span class="op" id="4531370">]</span><span class="keyword" id="4531371">interface</span><span class="op" id="4531380">{</span><span class="op" id="4531381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531384">lex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531394">*</span><span class="ident" id="4531395"><a href="/text/template/parse/lex.go.html#4498825">lexer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531402">token</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531412">[</span><span class="num" id="4531413">3</span><span class="op" id="4531414">]</span><span class="ident" id="4531415"><a href="/text/template/parse/lex.go.html#4496338">item</a></span>&nbsp;<span class="comment" id="4531420">//&nbsp;three-token&nbsp;lookahead&nbsp;for&nbsp;parser.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531458">peekCount</span>&nbsp;<span class="builtintype" id="4531468">int</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531473">vars</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4531483">[</span><span class="op" id="4531484">]</span><span class="builtintype" id="4531485">string</span>&nbsp;<span class="comment" id="4531492">//&nbsp;variables&nbsp;defined&nbsp;at&nbsp;the&nbsp;moment.</span><br>
<span class="lineno"></span><span class="op" id="4531528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4531531">//&nbsp;Copy&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;Tree.&nbsp;Any&nbsp;parsing&nbsp;state&nbsp;is&nbsp;discarded.</span><br>
<span class="lineno"></span><span class="keyword" id="4531599">func</span>&nbsp;<span class="op" id="4531604">(</span><span class="ident" id="4531605">t</span>&nbsp;<span class="op" id="4531607">*</span><span class="ident" id="4531608"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4531612">)</span>&nbsp;<span class="ident" id="4531614">Copy</span><span class="op" id="4531618">(</span><span class="op" id="4531619">)</span>&nbsp;<span class="op" id="4531621">*</span><span class="ident" id="4531622"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span>&nbsp;<span class="op" id="4531627">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4531630">if</span>&nbsp;<span class="ident" id="4531633"><a href="/text/template/parse/parse.go.html#4531605">t</a></span>&nbsp;<span class="op" id="4531635">==</span>&nbsp;<span class="ident" id="4531638">nil</span>&nbsp;<span class="op" id="4531642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4531646">return</span>&nbsp;<span class="ident" id="4531653">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4531658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4531661">return</span>&nbsp;<span class="op" id="4531668">&amp;</span><span class="ident" id="4531669"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4531673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531677">Name</span><span class="op" id="4531681">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531688"><a href="/text/template/parse/parse.go.html#4531605">t</a></span><span class="op" id="4531689">.</span><span class="ident" id="4531690">Name</span><span class="op" id="4531694">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531698">ParseName</span><span class="op" id="4531707">:</span>&nbsp;<span class="ident" id="4531709"><a href="/text/template/parse/parse.go.html#4531605">t</a></span><span class="op" id="4531710">.</span><span class="ident" id="4531711">ParseName</span><span class="op" id="4531720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531724">Root</span><span class="op" id="4531728">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531735"><a href="/text/template/parse/parse.go.html#4531605">t</a></span><span class="op" id="4531736">.</span><span class="ident" id="4531737">Root</span><span class="op" id="4531741">.</span><span class="ident" id="4531742">CopyList</span><span class="op" id="4531750">(</span><span class="op" id="4531751">)</span><span class="op" id="4531752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4531756">text</span><span class="op" id="4531760">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4531767"><a href="/text/template/parse/parse.go.html#4531605">t</a></span><span class="op" id="4531768">.</span><span class="ident" id="4531769">text</span><span class="op" id="4531773">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4531776">}</span><br>
<span class="lineno"></span><span class="op" id="4531778">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="4531781">//&nbsp;Parse&nbsp;returns&nbsp;a&nbsp;map&nbsp;from&nbsp;template&nbsp;name&nbsp;to&nbsp;parse.Tree,&nbsp;created&nbsp;by&nbsp;parsing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4531861">//&nbsp;templates&nbsp;described&nbsp;in&nbsp;the&nbsp;argument&nbsp;string.&nbsp;The&nbsp;top-level&nbsp;template&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4531939">//&nbsp;given&nbsp;the&nbsp;specified&nbsp;name.&nbsp;If&nbsp;an&nbsp;error&nbsp;is&nbsp;encountered,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4532017">//&nbsp;empty&nbsp;map&nbsp;is&nbsp;returned&nbsp;with&nbsp;the&nbsp;error.</span><br>
<span class="lineno">50</span><span class="keyword" id="4532058">func</span>&nbsp;<span class="ident" id="4532063">Parse</span><span class="op" id="4532068">(</span><span class="ident" id="4532069">name</span><span class="op" id="4532073">,</span>&nbsp;<span class="ident" id="4532075">text</span><span class="op" id="4532079">,</span>&nbsp;<span class="ident" id="4532081">leftDelim</span><span class="op" id="4532090">,</span>&nbsp;<span class="ident" id="4532092">rightDelim</span>&nbsp;<span class="builtintype" id="4532103">string</span><span class="op" id="4532109">,</span>&nbsp;<span class="ident" id="4532111">funcs</span>&nbsp;<span class="op" id="4532117">...</span><span class="keyword" id="4532120">map</span><span class="op" id="4532123">[</span><span class="builtintype" id="4532124">string</span><span class="op" id="4532130">]</span><span class="keyword" id="4532131">interface</span><span class="op" id="4532140">{</span><span class="op" id="4532141">}</span><span class="op" id="4532142">)</span>&nbsp;<span class="op" id="4532144">(</span><span class="ident" id="4532145">treeSet</span>&nbsp;<span class="keyword" id="4532153">map</span><span class="op" id="4532156">[</span><span class="builtintype" id="4532157">string</span><span class="op" id="4532163">]</span><span class="op" id="4532164">*</span><span class="ident" id="4532165"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532169">,</span>&nbsp;<span class="ident" id="4532171">err</span>&nbsp;<span class="builtintype" id="4532175">error</span><span class="op" id="4532180">)</span>&nbsp;<span class="op" id="4532182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532185"><a href="/text/template/parse/parse.go.html#4532145">treeSet</a></span>&nbsp;<span class="op" id="4532193">=</span>&nbsp;<span class="builtinfunc" id="4532195">make</span><span class="op" id="4532199">(</span><span class="keyword" id="4532200">map</span><span class="op" id="4532203">[</span><span class="builtintype" id="4532204">string</span><span class="op" id="4532210">]</span><span class="op" id="4532211">*</span><span class="ident" id="4532212"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532219">t</span>&nbsp;<span class="op" id="4532221">:=</span>&nbsp;<span class="ident" id="4532224"><a href="/text/template/parse/parse.go.html#4533652">New</a></span><span class="op" id="4532227">(</span><span class="ident" id="4532228"><a href="/text/template/parse/parse.go.html#4532069">name</a></span><span class="op" id="4532232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532235"><a href="/text/template/parse/parse.go.html#4532219">t</a></span><span class="op" id="4532236">.</span><span class="ident" id="4532237">text</span>&nbsp;<span class="op" id="4532242">=</span>&nbsp;<span class="ident" id="4532244"><a href="/text/template/parse/parse.go.html#4532075">text</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532250">_</span><span class="op" id="4532251">,</span>&nbsp;<span class="ident" id="4532253"><a href="/text/template/parse/parse.go.html#4532171">err</a></span>&nbsp;<span class="op" id="4532257">=</span>&nbsp;<span class="ident" id="4532259"><a href="/text/template/parse/parse.go.html#4532219">t</a></span><span class="op" id="4532260">.</span><span class="ident" id="4532261">Parse</span><span class="op" id="4532266">(</span><span class="ident" id="4532267"><a href="/text/template/parse/parse.go.html#4532075">text</a></span><span class="op" id="4532271">,</span>&nbsp;<span class="ident" id="4532273"><a href="/text/template/parse/parse.go.html#4532081">leftDelim</a></span><span class="op" id="4532282">,</span>&nbsp;<span class="ident" id="4532284"><a href="/text/template/parse/parse.go.html#4532092">rightDelim</a></span><span class="op" id="4532294">,</span>&nbsp;<span class="ident" id="4532296"><a href="/text/template/parse/parse.go.html#4532145">treeSet</a></span><span class="op" id="4532303">,</span>&nbsp;<span class="ident" id="4532305"><a href="/text/template/parse/parse.go.html#4532111">funcs</a></span><span class="op" id="4532310">...</span><span class="op" id="4532313">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4532316">return</span><br>
<span class="lineno"></span><span class="op" id="4532323">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4532326">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="4532358">func</span>&nbsp;<span class="op" id="4532363">(</span><span class="ident" id="4532364">t</span>&nbsp;<span class="op" id="4532366">*</span><span class="ident" id="4532367"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532371">)</span>&nbsp;<span class="ident" id="4532373">next</span><span class="op" id="4532377">(</span><span class="op" id="4532378">)</span>&nbsp;<span class="ident" id="4532380"><a href="/text/template/parse/lex.go.html#4496338">item</a></span>&nbsp;<span class="op" id="4532385">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4532388">if</span>&nbsp;<span class="ident" id="4532391"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532392">.</span><span class="ident" id="4532393">peekCount</span>&nbsp;<span class="op" id="4532403">&gt;</span>&nbsp;<span class="num" id="4532405">0</span>&nbsp;<span class="op" id="4532407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532411"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532412">.</span><span class="ident" id="4532413">peekCount</span><span class="op" id="4532422">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4532426">}</span>&nbsp;<span class="keyword" id="4532428">else</span>&nbsp;<span class="op" id="4532433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532437"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532438">.</span><span class="ident" id="4532439">token</span><span class="op" id="4532444">[</span><span class="num" id="4532445">0</span><span class="op" id="4532446">]</span>&nbsp;<span class="op" id="4532448">=</span>&nbsp;<span class="ident" id="4532450"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532451">.</span><span class="ident" id="4532452">lex</span><span class="op" id="4532455">.</span><span class="ident" id="4532456">nextItem</span><span class="op" id="4532464">(</span><span class="op" id="4532465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4532468">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4532471">return</span>&nbsp;<span class="ident" id="4532478"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532479">.</span><span class="ident" id="4532480">token</span><span class="op" id="4532485">[</span><span class="ident" id="4532486"><a href="/text/template/parse/parse.go.html#4532364">t</a></span><span class="op" id="4532487">.</span><span class="ident" id="4532488">peekCount</span><span class="op" id="4532497">]</span><br>
<span class="lineno"></span><span class="op" id="4532499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4532502">//&nbsp;backup&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;one&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="4532549">func</span>&nbsp;<span class="op" id="4532554">(</span><span class="ident" id="4532555">t</span>&nbsp;<span class="op" id="4532557">*</span><span class="ident" id="4532558"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532562">)</span>&nbsp;<span class="ident" id="4532564">backup</span><span class="op" id="4532570">(</span><span class="op" id="4532571">)</span>&nbsp;<span class="op" id="4532573">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532576"><a href="/text/template/parse/parse.go.html#4532555">t</a></span><span class="op" id="4532577">.</span><span class="ident" id="4532578">peekCount</span><span class="op" id="4532587">++</span><br>
<span class="lineno"></span><span class="op" id="4532590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4532593">//&nbsp;backup2&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;two&nbsp;tokens.</span><br>
<span class="lineno"></span><span class="comment" id="4532642">//&nbsp;The&nbsp;zeroth&nbsp;token&nbsp;is&nbsp;already&nbsp;there.</span><br>
<span class="lineno">75</span><span class="keyword" id="4532680">func</span>&nbsp;<span class="op" id="4532685">(</span><span class="ident" id="4532686">t</span>&nbsp;<span class="op" id="4532688">*</span><span class="ident" id="4532689"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532693">)</span>&nbsp;<span class="ident" id="4532695">backup2</span><span class="op" id="4532702">(</span><span class="ident" id="4532703">t1</span>&nbsp;<span class="ident" id="4532706"><a href="/text/template/parse/lex.go.html#4496338">item</a></span><span class="op" id="4532710">)</span>&nbsp;<span class="op" id="4532712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532715"><a href="/text/template/parse/parse.go.html#4532686">t</a></span><span class="op" id="4532716">.</span><span class="ident" id="4532717">token</span><span class="op" id="4532722">[</span><span class="num" id="4532723">1</span><span class="op" id="4532724">]</span>&nbsp;<span class="op" id="4532726">=</span>&nbsp;<span class="ident" id="4532728"><a href="/text/template/parse/parse.go.html#4532703">t1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532732"><a href="/text/template/parse/parse.go.html#4532686">t</a></span><span class="op" id="4532733">.</span><span class="ident" id="4532734">peekCount</span>&nbsp;<span class="op" id="4532744">=</span>&nbsp;<span class="num" id="4532746">2</span><br>
<span class="lineno"></span><span class="op" id="4532748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="4532751">//&nbsp;backup3&nbsp;backs&nbsp;the&nbsp;input&nbsp;stream&nbsp;up&nbsp;three&nbsp;tokens</span><br>
<span class="lineno"></span><span class="comment" id="4532801">//&nbsp;The&nbsp;zeroth&nbsp;token&nbsp;is&nbsp;already&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="4532839">func</span>&nbsp;<span class="op" id="4532844">(</span><span class="ident" id="4532845">t</span>&nbsp;<span class="op" id="4532847">*</span><span class="ident" id="4532848"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4532852">)</span>&nbsp;<span class="ident" id="4532854">backup3</span><span class="op" id="4532861">(</span><span class="ident" id="4532862">t2</span><span class="op" id="4532864">,</span>&nbsp;<span class="ident" id="4532866">t1</span>&nbsp;<span class="ident" id="4532869"><a href="/text/template/parse/lex.go.html#4496338">item</a></span><span class="op" id="4532873">)</span>&nbsp;<span class="op" id="4532875">{</span>&nbsp;<span class="comment" id="4532877">//&nbsp;Reverse&nbsp;order:&nbsp;we&#39;re&nbsp;pushing&nbsp;back.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532916"><a href="/text/template/parse/parse.go.html#4532845">t</a></span><span class="op" id="4532917">.</span><span class="ident" id="4532918">token</span><span class="op" id="4532923">[</span><span class="num" id="4532924">1</span><span class="op" id="4532925">]</span>&nbsp;<span class="op" id="4532927">=</span>&nbsp;<span class="ident" id="4532929"><a href="/text/template/parse/parse.go.html#4532866">t1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532933"><a href="/text/template/parse/parse.go.html#4532845">t</a></span><span class="op" id="4532934">.</span><span class="ident" id="4532935">token</span><span class="op" id="4532940">[</span><span class="num" id="4532941">2</span><span class="op" id="4532942">]</span>&nbsp;<span class="op" id="4532944">=</span>&nbsp;<span class="ident" id="4532946"><a href="/text/template/parse/parse.go.html#4532862">t2</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4532950"><a href="/text/template/parse/parse.go.html#4532845">t</a></span><span class="op" id="4532951">.</span><span class="ident" id="4532952">peekCount</span>&nbsp;<span class="op" id="4532962">=</span>&nbsp;<span class="num" id="4532964">3</span><br>
<span class="lineno"></span><span class="op" id="4532966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4532969">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="4533022">func</span>&nbsp;<span class="op" id="4533027">(</span><span class="ident" id="4533028">t</span>&nbsp;<span class="op" id="4533030">*</span><span class="ident" id="4533031"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4533035">)</span>&nbsp;<span class="ident" id="4533037">peek</span><span class="op" id="4533041">(</span><span class="op" id="4533042">)</span>&nbsp;<span class="ident" id="4533044"><a href="/text/template/parse/lex.go.html#4496338">item</a></span>&nbsp;<span class="op" id="4533049">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533052">if</span>&nbsp;<span class="ident" id="4533055"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533056">.</span><span class="ident" id="4533057">peekCount</span>&nbsp;<span class="op" id="4533067">&gt;</span>&nbsp;<span class="num" id="4533069">0</span>&nbsp;<span class="op" id="4533071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533075">return</span>&nbsp;<span class="ident" id="4533082"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533083">.</span><span class="ident" id="4533084">token</span><span class="op" id="4533089">[</span><span class="ident" id="4533090"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533091">.</span><span class="ident" id="4533092">peekCount</span><span class="op" id="4533101">-</span><span class="num" id="4533102">1</span><span class="op" id="4533103">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533109"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533110">.</span><span class="ident" id="4533111">peekCount</span>&nbsp;<span class="op" id="4533121">=</span>&nbsp;<span class="num" id="4533123">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533126"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533127">.</span><span class="ident" id="4533128">token</span><span class="op" id="4533133">[</span><span class="num" id="4533134">0</span><span class="op" id="4533135">]</span>&nbsp;<span class="op" id="4533137">=</span>&nbsp;<span class="ident" id="4533139"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533140">.</span><span class="ident" id="4533141">lex</span><span class="op" id="4533144">.</span><span class="ident" id="4533145">nextItem</span><span class="op" id="4533153">(</span><span class="op" id="4533154">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533157">return</span>&nbsp;<span class="ident" id="4533164"><a href="/text/template/parse/parse.go.html#4533028">t</a></span><span class="op" id="4533165">.</span><span class="ident" id="4533166">token</span><span class="op" id="4533171">[</span><span class="num" id="4533172">0</span><span class="op" id="4533173">]</span><br>
<span class="lineno"></span><span class="op" id="4533175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4533178">//&nbsp;nextNonSpace&nbsp;returns&nbsp;the&nbsp;next&nbsp;non-space&nbsp;token.</span><br>
<span class="lineno"></span><span class="keyword" id="4533228">func</span>&nbsp;<span class="op" id="4533233">(</span><span class="ident" id="4533234">t</span>&nbsp;<span class="op" id="4533236">*</span><span class="ident" id="4533237"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4533241">)</span>&nbsp;<span class="ident" id="4533243">nextNonSpace</span><span class="op" id="4533255">(</span><span class="op" id="4533256">)</span>&nbsp;<span class="op" id="4533258">(</span><span class="ident" id="4533259">token</span>&nbsp;<span class="ident" id="4533265"><a href="/text/template/parse/lex.go.html#4496338">item</a></span><span class="op" id="4533269">)</span>&nbsp;<span class="op" id="4533271">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533274">for</span>&nbsp;<span class="op" id="4533278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533282"><a href="/text/template/parse/parse.go.html#4533259">token</a></span>&nbsp;<span class="op" id="4533288">=</span>&nbsp;<span class="ident" id="4533290"><a href="/text/template/parse/parse.go.html#4533234">t</a></span><span class="op" id="4533291">.</span><span class="ident" id="4533292">next</span><span class="op" id="4533296">(</span><span class="op" id="4533297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533301">if</span>&nbsp;<span class="ident" id="4533304"><a href="/text/template/parse/parse.go.html#4533259">token</a></span><span class="op" id="4533309">.</span><span class="ident" id="4533310">typ</span>&nbsp;<span class="op" id="4533314">!=</span>&nbsp;<span class="ident" id="4533317"><a href="/text/template/parse/lex.go.html#4497759">itemSpace</a></span>&nbsp;<span class="op" id="4533327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533332">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533340">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533346">return</span>&nbsp;<span class="ident" id="4533353"><a href="/text/template/parse/parse.go.html#4533259">token</a></span><br>
<span class="lineno"></span><span class="op" id="4533359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4533362">//&nbsp;peekNonSpace&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;non-space&nbsp;token.</span><br>
<span class="lineno">110</span><span class="keyword" id="4533433">func</span>&nbsp;<span class="op" id="4533438">(</span><span class="ident" id="4533439">t</span>&nbsp;<span class="op" id="4533441">*</span><span class="ident" id="4533442"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4533446">)</span>&nbsp;<span class="ident" id="4533448">peekNonSpace</span><span class="op" id="4533460">(</span><span class="op" id="4533461">)</span>&nbsp;<span class="op" id="4533463">(</span><span class="ident" id="4533464">token</span>&nbsp;<span class="ident" id="4533470"><a href="/text/template/parse/lex.go.html#4496338">item</a></span><span class="op" id="4533474">)</span>&nbsp;<span class="op" id="4533476">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533479">for</span>&nbsp;<span class="op" id="4533483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533487"><a href="/text/template/parse/parse.go.html#4533464">token</a></span>&nbsp;<span class="op" id="4533493">=</span>&nbsp;<span class="ident" id="4533495"><a href="/text/template/parse/parse.go.html#4533439">t</a></span><span class="op" id="4533496">.</span><span class="ident" id="4533497">next</span><span class="op" id="4533501">(</span><span class="op" id="4533502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533506">if</span>&nbsp;<span class="ident" id="4533509"><a href="/text/template/parse/parse.go.html#4533464">token</a></span><span class="op" id="4533514">.</span><span class="ident" id="4533515">typ</span>&nbsp;<span class="op" id="4533519">!=</span>&nbsp;<span class="ident" id="4533522"><a href="/text/template/parse/lex.go.html#4497759">itemSpace</a></span>&nbsp;<span class="op" id="4533532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533537">break</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533551"><a href="/text/template/parse/parse.go.html#4533439">t</a></span><span class="op" id="4533552">.</span><span class="ident" id="4533553">backup</span><span class="op" id="4533559">(</span><span class="op" id="4533560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533563">return</span>&nbsp;<span class="ident" id="4533570"><a href="/text/template/parse/parse.go.html#4533464">token</a></span><br>
<span class="lineno"></span><span class="op" id="4533576">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="comment" id="4533579">//&nbsp;Parsing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4533592">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;parse&nbsp;tree&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4533647">func</span>&nbsp;<span class="ident" id="4533652">New</span><span class="op" id="4533655">(</span><span class="ident" id="4533656">name</span>&nbsp;<span class="builtintype" id="4533661">string</span><span class="op" id="4533667">,</span>&nbsp;<span class="ident" id="4533669">funcs</span>&nbsp;<span class="op" id="4533675">...</span><span class="keyword" id="4533678">map</span><span class="op" id="4533681">[</span><span class="builtintype" id="4533682">string</span><span class="op" id="4533688">]</span><span class="keyword" id="4533689">interface</span><span class="op" id="4533698">{</span><span class="op" id="4533699">}</span><span class="op" id="4533700">)</span>&nbsp;<span class="op" id="4533702">*</span><span class="ident" id="4533703"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span>&nbsp;<span class="op" id="4533708">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4533711">return</span>&nbsp;<span class="op" id="4533718">&amp;</span><span class="ident" id="4533719"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4533723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533727">Name</span><span class="op" id="4533731">:</span>&nbsp;&nbsp;<span class="ident" id="4533734"><a href="/text/template/parse/parse.go.html#4533656">name</a></span><span class="op" id="4533738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4533742">funcs</span><span class="op" id="4533747">:</span>&nbsp;<span class="ident" id="4533749"><a href="/text/template/parse/parse.go.html#4533669">funcs</a></span><span class="op" id="4533754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4533757">}</span><br>
<span class="lineno"></span><span class="op" id="4533759">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="comment" id="4533762">//&nbsp;ErrorContext&nbsp;returns&nbsp;a&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;location&nbsp;of&nbsp;the&nbsp;node&nbsp;in&nbsp;the&nbsp;input&nbsp;text.</span><br>
<span class="lineno"></span><span class="comment" id="4533858">//&nbsp;The&nbsp;receiver&nbsp;is&nbsp;only&nbsp;used&nbsp;when&nbsp;the&nbsp;node&nbsp;does&nbsp;not&nbsp;have&nbsp;a&nbsp;pointer&nbsp;to&nbsp;the&nbsp;tree&nbsp;inside,</span><br>
<span class="lineno"></span><span class="comment" id="4533945">//&nbsp;which&nbsp;can&nbsp;occur&nbsp;in&nbsp;old&nbsp;code.</span><br>
<span class="lineno"></span><span class="keyword" id="4533977">func</span>&nbsp;<span class="op" id="4533982">(</span><span class="ident" id="4533983">t</span>&nbsp;<span class="op" id="4533985">*</span><span class="ident" id="4533986"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4533990">)</span>&nbsp;<span class="ident" id="4533992">ErrorContext</span><span class="op" id="4534004">(</span><span class="ident" id="4534005">n</span>&nbsp;<span class="ident" id="4534007"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><span class="op" id="4534011">)</span>&nbsp;<span class="op" id="4534013">(</span><span class="ident" id="4534014">location</span><span class="op" id="4534022">,</span>&nbsp;<span class="ident" id="4534024">context</span>&nbsp;<span class="builtintype" id="4534032">string</span><span class="op" id="4534038">)</span>&nbsp;<span class="op" id="4534040">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534043">pos</span>&nbsp;<span class="op" id="4534047">:=</span>&nbsp;<span class="builtintype" id="4534050">int</span><span class="op" id="4534053">(</span><span class="ident" id="4534054"><a href="/text/template/parse/parse.go.html#4534005">n</a></span><span class="op" id="4534055">.</span><span class="ident" id="4534056">Position</span><span class="op" id="4534064">(</span><span class="op" id="4534065">)</span><span class="op" id="4534066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534069">tree</span>&nbsp;<span class="op" id="4534074">:=</span>&nbsp;<span class="ident" id="4534077"><a href="/text/template/parse/parse.go.html#4534005">n</a></span><span class="op" id="4534078">.</span><span class="ident" id="4534079">tree</span><span class="op" id="4534083">(</span><span class="op" id="4534084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534087">if</span>&nbsp;<span class="ident" id="4534090"><a href="/text/template/parse/parse.go.html#4534069">tree</a></span>&nbsp;<span class="op" id="4534095">==</span>&nbsp;<span class="ident" id="4534098">nil</span>&nbsp;<span class="op" id="4534102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534106"><a href="/text/template/parse/parse.go.html#4534069">tree</a></span>&nbsp;<span class="op" id="4534111">=</span>&nbsp;<span class="ident" id="4534113"><a href="/text/template/parse/parse.go.html#4533983">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534116">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534119">text</span>&nbsp;<span class="op" id="4534124">:=</span>&nbsp;<span class="ident" id="4534127"><a href="/text/template/parse/parse.go.html#4534069">tree</a></span><span class="op" id="4534131">.</span><span class="ident" id="4534132">text</span><span class="op" id="4534136">[</span><span class="op" id="4534137">:</span><span class="ident" id="4534138"><a href="/text/template/parse/parse.go.html#4534043">pos</a></span><span class="op" id="4534141">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534144">byteNum</span>&nbsp;<span class="op" id="4534152">:=</span>&nbsp;<span class="ident" id="4534155"><a href="/text/template/parse/parse.go.html#4530929">strings</a></span><span class="op" id="4534162">.</span><span class="ident" id="4534163">LastIndex</span><span class="op" id="4534172">(</span><span class="ident" id="4534173"><a href="/text/template/parse/parse.go.html#4534119">text</a></span><span class="op" id="4534177">,</span>&nbsp;<span class="string" id="4534179">&#34;\n&#34;</span><span class="op" id="4534183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534186">if</span>&nbsp;<span class="ident" id="4534189"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span>&nbsp;<span class="op" id="4534197">==</span>&nbsp;<span class="op" id="4534200">-</span><span class="num" id="4534201">1</span>&nbsp;<span class="op" id="4534203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534207"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span>&nbsp;<span class="op" id="4534215">=</span>&nbsp;<span class="ident" id="4534217"><a href="/text/template/parse/parse.go.html#4534043">pos</a></span>&nbsp;<span class="comment" id="4534221">//&nbsp;On&nbsp;first&nbsp;line.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534240">}</span>&nbsp;<span class="keyword" id="4534242">else</span>&nbsp;<span class="op" id="4534247">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534251"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span><span class="op" id="4534258">++</span>&nbsp;<span class="comment" id="4534261">//&nbsp;After&nbsp;the&nbsp;newline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534285"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span>&nbsp;<span class="op" id="4534293">=</span>&nbsp;<span class="ident" id="4534295"><a href="/text/template/parse/parse.go.html#4534043">pos</a></span>&nbsp;<span class="op" id="4534299">-</span>&nbsp;<span class="ident" id="4534301"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534313">lineNum</span>&nbsp;<span class="op" id="4534321">:=</span>&nbsp;<span class="num" id="4534324">1</span>&nbsp;<span class="op" id="4534326">+</span>&nbsp;<span class="ident" id="4534328"><a href="/text/template/parse/parse.go.html#4530929">strings</a></span><span class="op" id="4534335">.</span><span class="ident" id="4534336">Count</span><span class="op" id="4534341">(</span><span class="ident" id="4534342"><a href="/text/template/parse/parse.go.html#4534119">text</a></span><span class="op" id="4534346">,</span>&nbsp;<span class="string" id="4534348">&#34;\n&#34;</span><span class="op" id="4534352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534355"><a href="/text/template/parse/parse.go.html#4534024">context</a></span>&nbsp;<span class="op" id="4534363">=</span>&nbsp;<span class="ident" id="4534365"><a href="/text/template/parse/parse.go.html#4534005">n</a></span><span class="op" id="4534366">.</span><span class="ident" id="4534367">String</span><span class="op" id="4534373">(</span><span class="op" id="4534374">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534377">if</span>&nbsp;<span class="builtinfunc" id="4534380">len</span><span class="op" id="4534383">(</span><span class="ident" id="4534384"><a href="/text/template/parse/parse.go.html#4534024">context</a></span><span class="op" id="4534391">)</span>&nbsp;<span class="op" id="4534393">&gt;</span>&nbsp;<span class="num" id="4534395">20</span>&nbsp;<span class="op" id="4534398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534402"><a href="/text/template/parse/parse.go.html#4534024">context</a></span>&nbsp;<span class="op" id="4534410">=</span>&nbsp;<span class="ident" id="4534412"><a href="/text/template/parse/parse.go.html#4530900">fmt</a></span><span class="op" id="4534415">.</span><span class="ident" id="4534416">Sprintf</span><span class="op" id="4534423">(</span><span class="string" id="4534424">&#34;%.20s...&#34;</span><span class="op" id="4534434">,</span>&nbsp;<span class="ident" id="4534436"><a href="/text/template/parse/parse.go.html#4534024">context</a></span><span class="op" id="4534443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534449">return</span>&nbsp;<span class="ident" id="4534456"><a href="/text/template/parse/parse.go.html#4530900">fmt</a></span><span class="op" id="4534459">.</span><span class="ident" id="4534460">Sprintf</span><span class="op" id="4534467">(</span><span class="string" id="4534468">&#34;%s:%d:%d&#34;</span><span class="op" id="4534478">,</span>&nbsp;<span class="ident" id="4534480"><a href="/text/template/parse/parse.go.html#4534069">tree</a></span><span class="op" id="4534484">.</span><span class="ident" id="4534485">ParseName</span><span class="op" id="4534494">,</span>&nbsp;<span class="ident" id="4534496"><a href="/text/template/parse/parse.go.html#4534313">lineNum</a></span><span class="op" id="4534503">,</span>&nbsp;<span class="ident" id="4534505"><a href="/text/template/parse/parse.go.html#4534144">byteNum</a></span><span class="op" id="4534512">)</span><span class="op" id="4534513">,</span>&nbsp;<span class="ident" id="4534515"><a href="/text/template/parse/parse.go.html#4534024">context</a></span><br>
<span class="lineno"></span><span class="op" id="4534523">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4534526">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4534581">func</span>&nbsp;<span class="op" id="4534586">(</span><span class="ident" id="4534587">t</span>&nbsp;<span class="op" id="4534589">*</span><span class="ident" id="4534590"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4534594">)</span>&nbsp;<span class="ident" id="4534596">errorf</span><span class="op" id="4534602">(</span><span class="ident" id="4534603">format</span>&nbsp;<span class="builtintype" id="4534610">string</span><span class="op" id="4534616">,</span>&nbsp;<span class="ident" id="4534618">args</span>&nbsp;<span class="op" id="4534623">...</span><span class="keyword" id="4534626">interface</span><span class="op" id="4534635">{</span><span class="op" id="4534636">}</span><span class="op" id="4534637">)</span>&nbsp;<span class="op" id="4534639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534642"><a href="/text/template/parse/parse.go.html#4534587">t</a></span><span class="op" id="4534643">.</span><span class="ident" id="4534644">Root</span>&nbsp;<span class="op" id="4534649">=</span>&nbsp;<span class="ident" id="4534651">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534656"><a href="/text/template/parse/parse.go.html#4534603">format</a></span>&nbsp;<span class="op" id="4534663">=</span>&nbsp;<span class="ident" id="4534665"><a href="/text/template/parse/parse.go.html#4530900">fmt</a></span><span class="op" id="4534668">.</span><span class="ident" id="4534669">Sprintf</span><span class="op" id="4534676">(</span><span class="string" id="4534677">&#34;template:&nbsp;%s:%d:&nbsp;%s&#34;</span><span class="op" id="4534698">,</span>&nbsp;<span class="ident" id="4534700"><a href="/text/template/parse/parse.go.html#4534587">t</a></span><span class="op" id="4534701">.</span><span class="ident" id="4534702">ParseName</span><span class="op" id="4534711">,</span>&nbsp;<span class="ident" id="4534713"><a href="/text/template/parse/parse.go.html#4534587">t</a></span><span class="op" id="4534714">.</span><span class="ident" id="4534715">lex</span><span class="op" id="4534718">.</span><span class="ident" id="4534719">lineNumber</span><span class="op" id="4534729">(</span><span class="op" id="4534730">)</span><span class="op" id="4534731">,</span>&nbsp;<span class="ident" id="4534733"><a href="/text/template/parse/parse.go.html#4534603">format</a></span><span class="op" id="4534739">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4534742">panic</span><span class="op" id="4534747">(</span><span class="ident" id="4534748"><a href="/text/template/parse/parse.go.html#4530900">fmt</a></span><span class="op" id="4534751">.</span><span class="ident" id="4534752">Errorf</span><span class="op" id="4534758">(</span><span class="ident" id="4534759"><a href="/text/template/parse/parse.go.html#4534603">format</a></span><span class="op" id="4534765">,</span>&nbsp;<span class="ident" id="4534767"><a href="/text/template/parse/parse.go.html#4534618">args</a></span><span class="op" id="4534771">...</span><span class="op" id="4534774">)</span><span class="op" id="4534775">)</span><br>
<span class="lineno"></span><span class="op" id="4534777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4534780">//&nbsp;error&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4534812">func</span>&nbsp;<span class="op" id="4534817">(</span><span class="ident" id="4534818">t</span>&nbsp;<span class="op" id="4534820">*</span><span class="ident" id="4534821"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4534825">)</span>&nbsp;<span class="builtintype" id="4534827">error</span><span class="op" id="4534832">(</span><span class="ident" id="4534833">err</span>&nbsp;<span class="builtintype" id="4534837">error</span><span class="op" id="4534842">)</span>&nbsp;<span class="op" id="4534844">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534847"><a href="/text/template/parse/parse.go.html#4534818">t</a></span><span class="op" id="4534848">.</span><span class="ident" id="4534849">errorf</span><span class="op" id="4534855">(</span><span class="string" id="4534856">&#34;%s&#34;</span><span class="op" id="4534860">,</span>&nbsp;<span class="ident" id="4534862"><a href="/text/template/parse/parse.go.html#4534833">err</a></span><span class="op" id="4534865">)</span><br>
<span class="lineno"></span><span class="op" id="4534867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4534870">//&nbsp;expect&nbsp;consumes&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;guarantees&nbsp;it&nbsp;has&nbsp;the&nbsp;required&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4534945">func</span>&nbsp;<span class="op" id="4534950">(</span><span class="ident" id="4534951">t</span>&nbsp;<span class="op" id="4534953">*</span><span class="ident" id="4534954"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4534958">)</span>&nbsp;<span class="ident" id="4534960">expect</span><span class="op" id="4534966">(</span><span class="ident" id="4534967">expected</span>&nbsp;<span class="ident" id="4534976"><a href="/text/template/parse/lex.go.html#4496858">itemType</a></span><span class="op" id="4534984">,</span>&nbsp;<span class="ident" id="4534986">context</span>&nbsp;<span class="builtintype" id="4534994">string</span><span class="op" id="4535000">)</span>&nbsp;<span class="ident" id="4535002"><a href="/text/template/parse/lex.go.html#4496338">item</a></span>&nbsp;<span class="op" id="4535007">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535010">token</span>&nbsp;<span class="op" id="4535016">:=</span>&nbsp;<span class="ident" id="4535019"><a href="/text/template/parse/parse.go.html#4534951">t</a></span><span class="op" id="4535020">.</span><span class="ident" id="4535021">nextNonSpace</span><span class="op" id="4535033">(</span><span class="op" id="4535034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535037">if</span>&nbsp;<span class="ident" id="4535040"><a href="/text/template/parse/parse.go.html#4535010">token</a></span><span class="op" id="4535045">.</span><span class="ident" id="4535046">typ</span>&nbsp;<span class="op" id="4535050">!=</span>&nbsp;<span class="ident" id="4535053"><a href="/text/template/parse/parse.go.html#4534967">expected</a></span>&nbsp;<span class="op" id="4535062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535066"><a href="/text/template/parse/parse.go.html#4534951">t</a></span><span class="op" id="4535067">.</span><span class="ident" id="4535068">unexpected</span><span class="op" id="4535078">(</span><span class="ident" id="4535079"><a href="/text/template/parse/parse.go.html#4535010">token</a></span><span class="op" id="4535084">,</span>&nbsp;<span class="ident" id="4535086"><a href="/text/template/parse/parse.go.html#4534986">context</a></span><span class="op" id="4535093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535099">return</span>&nbsp;<span class="ident" id="4535106"><a href="/text/template/parse/parse.go.html#4535010">token</a></span><br>
<span class="lineno">175</span><span class="op" id="4535112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4535115">//&nbsp;expectOneOf&nbsp;consumes&nbsp;the&nbsp;next&nbsp;token&nbsp;and&nbsp;guarantees&nbsp;it&nbsp;has&nbsp;one&nbsp;of&nbsp;the&nbsp;required&nbsp;types.</span><br>
<span class="lineno"></span><span class="keyword" id="4535203">func</span>&nbsp;<span class="op" id="4535208">(</span><span class="ident" id="4535209">t</span>&nbsp;<span class="op" id="4535211">*</span><span class="ident" id="4535212"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4535216">)</span>&nbsp;<span class="ident" id="4535218">expectOneOf</span><span class="op" id="4535229">(</span><span class="ident" id="4535230">expected1</span><span class="op" id="4535239">,</span>&nbsp;<span class="ident" id="4535241">expected2</span>&nbsp;<span class="ident" id="4535251"><a href="/text/template/parse/lex.go.html#4496858">itemType</a></span><span class="op" id="4535259">,</span>&nbsp;<span class="ident" id="4535261">context</span>&nbsp;<span class="builtintype" id="4535269">string</span><span class="op" id="4535275">)</span>&nbsp;<span class="ident" id="4535277"><a href="/text/template/parse/lex.go.html#4496338">item</a></span>&nbsp;<span class="op" id="4535282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535285">token</span>&nbsp;<span class="op" id="4535291">:=</span>&nbsp;<span class="ident" id="4535294"><a href="/text/template/parse/parse.go.html#4535209">t</a></span><span class="op" id="4535295">.</span><span class="ident" id="4535296">nextNonSpace</span><span class="op" id="4535308">(</span><span class="op" id="4535309">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535312">if</span>&nbsp;<span class="ident" id="4535315"><a href="/text/template/parse/parse.go.html#4535285">token</a></span><span class="op" id="4535320">.</span><span class="ident" id="4535321">typ</span>&nbsp;<span class="op" id="4535325">!=</span>&nbsp;<span class="ident" id="4535328"><a href="/text/template/parse/parse.go.html#4535230">expected1</a></span>&nbsp;<span class="op" id="4535338">&amp;&amp;</span>&nbsp;<span class="ident" id="4535341"><a href="/text/template/parse/parse.go.html#4535285">token</a></span><span class="op" id="4535346">.</span><span class="ident" id="4535347">typ</span>&nbsp;<span class="op" id="4535351">!=</span>&nbsp;<span class="ident" id="4535354"><a href="/text/template/parse/parse.go.html#4535241">expected2</a></span>&nbsp;<span class="op" id="4535364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535368"><a href="/text/template/parse/parse.go.html#4535209">t</a></span><span class="op" id="4535369">.</span><span class="ident" id="4535370">unexpected</span><span class="op" id="4535380">(</span><span class="ident" id="4535381"><a href="/text/template/parse/parse.go.html#4535285">token</a></span><span class="op" id="4535386">,</span>&nbsp;<span class="ident" id="4535388"><a href="/text/template/parse/parse.go.html#4535261">context</a></span><span class="op" id="4535395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535401">return</span>&nbsp;<span class="ident" id="4535408"><a href="/text/template/parse/parse.go.html#4535285">token</a></span><br>
<span class="lineno"></span><span class="op" id="4535414">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="comment" id="4535417">//&nbsp;unexpected&nbsp;complains&nbsp;about&nbsp;the&nbsp;token&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4535484">func</span>&nbsp;<span class="op" id="4535489">(</span><span class="ident" id="4535490">t</span>&nbsp;<span class="op" id="4535492">*</span><span class="ident" id="4535493"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4535497">)</span>&nbsp;<span class="ident" id="4535499">unexpected</span><span class="op" id="4535509">(</span><span class="ident" id="4535510">token</span>&nbsp;<span class="ident" id="4535516"><a href="/text/template/parse/lex.go.html#4496338">item</a></span><span class="op" id="4535520">,</span>&nbsp;<span class="ident" id="4535522">context</span>&nbsp;<span class="builtintype" id="4535530">string</span><span class="op" id="4535536">)</span>&nbsp;<span class="op" id="4535538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535541"><a href="/text/template/parse/parse.go.html#4535490">t</a></span><span class="op" id="4535542">.</span><span class="ident" id="4535543">errorf</span><span class="op" id="4535549">(</span><span class="string" id="4535550">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;%s&#34;</span><span class="op" id="4535571">,</span>&nbsp;<span class="ident" id="4535573"><a href="/text/template/parse/parse.go.html#4535510">token</a></span><span class="op" id="4535578">,</span>&nbsp;<span class="ident" id="4535580"><a href="/text/template/parse/parse.go.html#4535522">context</a></span><span class="op" id="4535587">)</span><br>
<span class="lineno"></span><span class="op" id="4535589">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4535592">//&nbsp;recover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno"></span><span class="keyword" id="4535678">func</span>&nbsp;<span class="op" id="4535683">(</span><span class="ident" id="4535684">t</span>&nbsp;<span class="op" id="4535686">*</span><span class="ident" id="4535687"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4535691">)</span>&nbsp;<span class="builtinfunc" id="4535693">recover</span><span class="op" id="4535700">(</span><span class="ident" id="4535701">errp</span>&nbsp;<span class="op" id="4535706">*</span><span class="builtintype" id="4535707">error</span><span class="op" id="4535712">)</span>&nbsp;<span class="op" id="4535714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535717">e</span>&nbsp;<span class="op" id="4535719">:=</span>&nbsp;<span class="builtinfunc" id="4535722">recover</span><span class="op" id="4535729">(</span><span class="op" id="4535730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535733">if</span>&nbsp;<span class="ident" id="4535736"><a href="/text/template/parse/parse.go.html#4535717">e</a></span>&nbsp;<span class="op" id="4535738">!=</span>&nbsp;<span class="ident" id="4535741">nil</span>&nbsp;<span class="op" id="4535745">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535749">if</span>&nbsp;<span class="ident" id="4535752">_</span><span class="op" id="4535753">,</span>&nbsp;<span class="ident" id="4535755">ok</span>&nbsp;<span class="op" id="4535758">:=</span>&nbsp;<span class="ident" id="4535761"><a href="/text/template/parse/parse.go.html#4535717">e</a></span><span class="op" id="4535762">.</span><span class="op" id="4535763">(</span><span class="ident" id="4535764"><a href="/text/template/parse/parse.go.html#4530907">runtime</a></span><span class="op" id="4535771">.</span><span class="ident" id="4535772">Error</span><span class="op" id="4535777">)</span><span class="op" id="4535778">;</span>&nbsp;<span class="ident" id="4535780"><a href="/text/template/parse/parse.go.html#4535755">ok</a></span>&nbsp;<span class="op" id="4535783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4535788">panic</span><span class="op" id="4535793">(</span><span class="ident" id="4535794"><a href="/text/template/parse/parse.go.html#4535717">e</a></span><span class="op" id="4535795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535803">if</span>&nbsp;<span class="ident" id="4535806"><a href="/text/template/parse/parse.go.html#4535684">t</a></span>&nbsp;<span class="op" id="4535808">!=</span>&nbsp;<span class="ident" id="4535811">nil</span>&nbsp;<span class="op" id="4535815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535820"><a href="/text/template/parse/parse.go.html#4535684">t</a></span><span class="op" id="4535821">.</span><span class="ident" id="4535822">stopParse</span><span class="op" id="4535831">(</span><span class="op" id="4535832">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535840">*</span><span class="ident" id="4535841"><a href="/text/template/parse/parse.go.html#4535701">errp</a></span>&nbsp;<span class="op" id="4535846">=</span>&nbsp;<span class="ident" id="4535848"><a href="/text/template/parse/parse.go.html#4535717">e</a></span><span class="op" id="4535849">.</span><span class="op" id="4535850">(</span><span class="builtintype" id="4535851">error</span><span class="op" id="4535856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535862">return</span><br>
<span class="lineno"></span><span class="op" id="4535869">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4535872">//&nbsp;startParse&nbsp;initializes&nbsp;the&nbsp;parser,&nbsp;using&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="4535927">func</span>&nbsp;<span class="op" id="4535932">(</span><span class="ident" id="4535933">t</span>&nbsp;<span class="op" id="4535935">*</span><span class="ident" id="4535936"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4535940">)</span>&nbsp;<span class="ident" id="4535942">startParse</span><span class="op" id="4535952">(</span><span class="ident" id="4535953">funcs</span>&nbsp;<span class="op" id="4535959">[</span><span class="op" id="4535960">]</span><span class="keyword" id="4535961">map</span><span class="op" id="4535964">[</span><span class="builtintype" id="4535965">string</span><span class="op" id="4535971">]</span><span class="keyword" id="4535972">interface</span><span class="op" id="4535981">{</span><span class="op" id="4535982">}</span><span class="op" id="4535983">,</span>&nbsp;<span class="ident" id="4535985">lex</span>&nbsp;<span class="op" id="4535989">*</span><span class="ident" id="4535990"><a href="/text/template/parse/lex.go.html#4498825">lexer</a></span><span class="op" id="4535995">)</span>&nbsp;<span class="op" id="4535997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536000"><a href="/text/template/parse/parse.go.html#4535933">t</a></span><span class="op" id="4536001">.</span><span class="ident" id="4536002">Root</span>&nbsp;<span class="op" id="4536007">=</span>&nbsp;<span class="ident" id="4536009">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536014"><a href="/text/template/parse/parse.go.html#4535933">t</a></span><span class="op" id="4536015">.</span><span class="ident" id="4536016">lex</span>&nbsp;<span class="op" id="4536020">=</span>&nbsp;<span class="ident" id="4536022"><a href="/text/template/parse/parse.go.html#4535985">lex</a></span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536027"><a href="/text/template/parse/parse.go.html#4535933">t</a></span><span class="op" id="4536028">.</span><span class="ident" id="4536029">vars</span>&nbsp;<span class="op" id="4536034">=</span>&nbsp;<span class="op" id="4536036">[</span><span class="op" id="4536037">]</span><span class="builtintype" id="4536038">string</span><span class="op" id="4536044">{</span><span class="string" id="4536045">&#34;$&#34;</span><span class="op" id="4536048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536051"><a href="/text/template/parse/parse.go.html#4535933">t</a></span><span class="op" id="4536052">.</span><span class="ident" id="4536053">funcs</span>&nbsp;<span class="op" id="4536059">=</span>&nbsp;<span class="ident" id="4536061"><a href="/text/template/parse/parse.go.html#4535953">funcs</a></span><br>
<span class="lineno"></span><span class="op" id="4536067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4536070">//&nbsp;stopParse&nbsp;terminates&nbsp;parsing.</span><br>
<span class="lineno">215</span><span class="keyword" id="4536103">func</span>&nbsp;<span class="op" id="4536108">(</span><span class="ident" id="4536109">t</span>&nbsp;<span class="op" id="4536111">*</span><span class="ident" id="4536112"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536116">)</span>&nbsp;<span class="ident" id="4536118">stopParse</span><span class="op" id="4536127">(</span><span class="op" id="4536128">)</span>&nbsp;<span class="op" id="4536130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536133"><a href="/text/template/parse/parse.go.html#4536109">t</a></span><span class="op" id="4536134">.</span><span class="ident" id="4536135">lex</span>&nbsp;<span class="op" id="4536139">=</span>&nbsp;<span class="ident" id="4536141">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536146"><a href="/text/template/parse/parse.go.html#4536109">t</a></span><span class="op" id="4536147">.</span><span class="ident" id="4536148">vars</span>&nbsp;<span class="op" id="4536153">=</span>&nbsp;<span class="ident" id="4536155">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536160"><a href="/text/template/parse/parse.go.html#4536109">t</a></span><span class="op" id="4536161">.</span><span class="ident" id="4536162">funcs</span>&nbsp;<span class="op" id="4536168">=</span>&nbsp;<span class="ident" id="4536170">nil</span><br>
<span class="lineno"></span><span class="op" id="4536174">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4536177">//&nbsp;Parse&nbsp;parses&nbsp;the&nbsp;template&nbsp;definition&nbsp;string&nbsp;to&nbsp;construct&nbsp;a&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4536257">//&nbsp;the&nbsp;template&nbsp;for&nbsp;execution.&nbsp;If&nbsp;either&nbsp;action&nbsp;delimiter&nbsp;string&nbsp;is&nbsp;empty,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4536336">//&nbsp;default&nbsp;(&#34;{{&#34;&nbsp;or&nbsp;&#34;}}&#34;)&nbsp;is&nbsp;used.&nbsp;Embedded&nbsp;template&nbsp;definitions&nbsp;are&nbsp;added&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4536414">//&nbsp;the&nbsp;treeSet&nbsp;map.</span><br>
<span class="lineno">225</span><span class="keyword" id="4536434">func</span>&nbsp;<span class="op" id="4536439">(</span><span class="ident" id="4536440">t</span>&nbsp;<span class="op" id="4536442">*</span><span class="ident" id="4536443"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536447">)</span>&nbsp;<span class="ident" id="4536449">Parse</span><span class="op" id="4536454">(</span><span class="ident" id="4536455">text</span><span class="op" id="4536459">,</span>&nbsp;<span class="ident" id="4536461">leftDelim</span><span class="op" id="4536470">,</span>&nbsp;<span class="ident" id="4536472">rightDelim</span>&nbsp;<span class="builtintype" id="4536483">string</span><span class="op" id="4536489">,</span>&nbsp;<span class="ident" id="4536491">treeSet</span>&nbsp;<span class="keyword" id="4536499">map</span><span class="op" id="4536502">[</span><span class="builtintype" id="4536503">string</span><span class="op" id="4536509">]</span><span class="op" id="4536510">*</span><span class="ident" id="4536511"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536515">,</span>&nbsp;<span class="ident" id="4536517">funcs</span>&nbsp;<span class="op" id="4536523">...</span><span class="keyword" id="4536526">map</span><span class="op" id="4536529">[</span><span class="builtintype" id="4536530">string</span><span class="op" id="4536536">]</span><span class="keyword" id="4536537">interface</span><span class="op" id="4536546">{</span><span class="op" id="4536547">}</span><span class="op" id="4536548">)</span>&nbsp;<span class="op" id="4536550">(</span><span class="ident" id="4536551">tree</span>&nbsp;<span class="op" id="4536556">*</span><span class="ident" id="4536557"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536561">,</span>&nbsp;<span class="ident" id="4536563">err</span>&nbsp;<span class="builtintype" id="4536567">error</span><span class="op" id="4536572">)</span>&nbsp;<span class="op" id="4536574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536577">defer</span>&nbsp;<span class="ident" id="4536583"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536584">.</span><span class="builtinfunc" id="4536585">recover</span><span class="op" id="4536592">(</span><span class="op" id="4536593">&amp;</span><span class="ident" id="4536594"><a href="/text/template/parse/parse.go.html#4536563">err</a></span><span class="op" id="4536597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536600"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536601">.</span><span class="ident" id="4536602">ParseName</span>&nbsp;<span class="op" id="4536612">=</span>&nbsp;<span class="ident" id="4536614"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536615">.</span><span class="ident" id="4536616">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536622"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536623">.</span><span class="ident" id="4536624">startParse</span><span class="op" id="4536634">(</span><span class="ident" id="4536635"><a href="/text/template/parse/parse.go.html#4536517">funcs</a></span><span class="op" id="4536640">,</span>&nbsp;<span class="ident" id="4536642"><a href="/text/template/parse/lex.go.html#4501333">lex</a></span><span class="op" id="4536645">(</span><span class="ident" id="4536646"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536647">.</span><span class="ident" id="4536648">Name</span><span class="op" id="4536652">,</span>&nbsp;<span class="ident" id="4536654"><a href="/text/template/parse/parse.go.html#4536455">text</a></span><span class="op" id="4536658">,</span>&nbsp;<span class="ident" id="4536660"><a href="/text/template/parse/parse.go.html#4536461">leftDelim</a></span><span class="op" id="4536669">,</span>&nbsp;<span class="ident" id="4536671"><a href="/text/template/parse/parse.go.html#4536472">rightDelim</a></span><span class="op" id="4536681">)</span><span class="op" id="4536682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536685"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536686">.</span><span class="ident" id="4536687">text</span>&nbsp;<span class="op" id="4536692">=</span>&nbsp;<span class="ident" id="4536694"><a href="/text/template/parse/parse.go.html#4536455">text</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536700"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536701">.</span><span class="ident" id="4536702">parse</span><span class="op" id="4536707">(</span><span class="ident" id="4536708"><a href="/text/template/parse/parse.go.html#4536491">treeSet</a></span><span class="op" id="4536715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536718"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536719">.</span><span class="ident" id="4536720">add</span><span class="op" id="4536723">(</span><span class="ident" id="4536724"><a href="/text/template/parse/parse.go.html#4536491">treeSet</a></span><span class="op" id="4536731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536734"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536735">.</span><span class="ident" id="4536736">stopParse</span><span class="op" id="4536745">(</span><span class="op" id="4536746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536749">return</span>&nbsp;<span class="ident" id="4536756"><a href="/text/template/parse/parse.go.html#4536440">t</a></span><span class="op" id="4536757">,</span>&nbsp;<span class="ident" id="4536759">nil</span><br>
<span class="lineno"></span><span class="op" id="4536763">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="4536766">//&nbsp;add&nbsp;adds&nbsp;tree&nbsp;to&nbsp;the&nbsp;treeSet.</span><br>
<span class="lineno"></span><span class="keyword" id="4536799">func</span>&nbsp;<span class="op" id="4536804">(</span><span class="ident" id="4536805">t</span>&nbsp;<span class="op" id="4536807">*</span><span class="ident" id="4536808"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536812">)</span>&nbsp;<span class="ident" id="4536814">add</span><span class="op" id="4536817">(</span><span class="ident" id="4536818">treeSet</span>&nbsp;<span class="keyword" id="4536826">map</span><span class="op" id="4536829">[</span><span class="builtintype" id="4536830">string</span><span class="op" id="4536836">]</span><span class="op" id="4536837">*</span><span class="ident" id="4536838"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4536842">)</span>&nbsp;<span class="op" id="4536844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536847">tree</span>&nbsp;<span class="op" id="4536852">:=</span>&nbsp;<span class="ident" id="4536855"><a href="/text/template/parse/parse.go.html#4536818">treeSet</a></span><span class="op" id="4536862">[</span><span class="ident" id="4536863"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><span class="op" id="4536864">.</span><span class="ident" id="4536865">Name</span><span class="op" id="4536869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536872">if</span>&nbsp;<span class="ident" id="4536875"><a href="/text/template/parse/parse.go.html#4536847">tree</a></span>&nbsp;<span class="op" id="4536880">==</span>&nbsp;<span class="ident" id="4536883">nil</span>&nbsp;<span class="op" id="4536887">||</span>&nbsp;<span class="ident" id="4536890"><a href="/text/template/parse/parse.go.html#4537136">IsEmptyTree</a></span><span class="op" id="4536901">(</span><span class="ident" id="4536902"><a href="/text/template/parse/parse.go.html#4536847">tree</a></span><span class="op" id="4536906">.</span><span class="ident" id="4536907">Root</span><span class="op" id="4536911">)</span>&nbsp;<span class="op" id="4536913">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536917"><a href="/text/template/parse/parse.go.html#4536818">treeSet</a></span><span class="op" id="4536924">[</span><span class="ident" id="4536925"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><span class="op" id="4536926">.</span><span class="ident" id="4536927">Name</span><span class="op" id="4536931">]</span>&nbsp;<span class="op" id="4536933">=</span>&nbsp;<span class="ident" id="4536935"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536939">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536950">if</span>&nbsp;<span class="op" id="4536953">!</span><span class="ident" id="4536954"><a href="/text/template/parse/parse.go.html#4537136">IsEmptyTree</a></span><span class="op" id="4536965">(</span><span class="ident" id="4536966"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><span class="op" id="4536967">.</span><span class="ident" id="4536968">Root</span><span class="op" id="4536972">)</span>&nbsp;<span class="op" id="4536974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536978"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><span class="op" id="4536979">.</span><span class="ident" id="4536980">errorf</span><span class="op" id="4536986">(</span><span class="string" id="4536987">&#34;template:&nbsp;multiple&nbsp;definition&nbsp;of&nbsp;template&nbsp;%q&#34;</span><span class="op" id="4537033">,</span>&nbsp;<span class="ident" id="4537035"><a href="/text/template/parse/parse.go.html#4536805">t</a></span><span class="op" id="4537036">.</span><span class="ident" id="4537037">Name</span><span class="op" id="4537041">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537044">}</span><br>
<span class="lineno"></span><span class="op" id="4537046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537049">//&nbsp;IsEmptyTree&nbsp;reports&nbsp;whether&nbsp;this&nbsp;tree&nbsp;(node)&nbsp;is&nbsp;empty&nbsp;of&nbsp;everything&nbsp;but&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4537131">func</span>&nbsp;<span class="ident" id="4537136">IsEmptyTree</span><span class="op" id="4537147">(</span><span class="ident" id="4537148">n</span>&nbsp;<span class="ident" id="4537150"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><span class="op" id="4537154">)</span>&nbsp;<span class="builtintype" id="4537156">bool</span>&nbsp;<span class="op" id="4537161">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537164">switch</span>&nbsp;<span class="ident" id="4537171">n</span>&nbsp;<span class="op" id="4537173">:=</span>&nbsp;<span class="ident" id="4537176"><a href="/text/template/parse/parse.go.html#4537148">n</a></span><span class="op" id="4537177">.</span><span class="op" id="4537178">(</span><span class="keyword" id="4537179">type</span><span class="op" id="4537183">)</span>&nbsp;<span class="op" id="4537185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537188">case</span>&nbsp;<span class="ident" id="4537193">nil</span><span class="op" id="4537196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537200">return</span>&nbsp;<span class="builtintype" id="4537207">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537213">case</span>&nbsp;<span class="op" id="4537218">*</span><span class="ident" id="4537219"><a href="/text/template/parse/node.go.html#4515149">ActionNode</a></span><span class="op" id="4537229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537232">case</span>&nbsp;<span class="op" id="4537237">*</span><span class="ident" id="4537238"><a href="/text/template/parse/node.go.html#4528314">IfNode</a></span><span class="op" id="4537244">:</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537247">case</span>&nbsp;<span class="op" id="4537252">*</span><span class="ident" id="4537253"><a href="/text/template/parse/node.go.html#4512500">ListNode</a></span><span class="op" id="4537261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537265">for</span>&nbsp;<span class="ident" id="4537269">_</span><span class="op" id="4537270">,</span>&nbsp;<span class="ident" id="4537272">node</span>&nbsp;<span class="op" id="4537277">:=</span>&nbsp;<span class="keyword" id="4537280">range</span>&nbsp;<span class="ident" id="4537286"><a href="/text/template/parse/parse.go.html#4537171">n</a></span><span class="op" id="4537287">.</span><span class="ident" id="4537288">Nodes</span>&nbsp;<span class="op" id="4537294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537299">if</span>&nbsp;<span class="op" id="4537302">!</span><span class="ident" id="4537303"><a href="/text/template/parse/parse.go.html#4537136">IsEmptyTree</a></span><span class="op" id="4537314">(</span><span class="ident" id="4537315"><a href="/text/template/parse/parse.go.html#4537272">node</a></span><span class="op" id="4537319">)</span>&nbsp;<span class="op" id="4537321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537327">return</span>&nbsp;<span class="builtintype" id="4537334">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537343">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537351">return</span>&nbsp;<span class="builtintype" id="4537358">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537364">case</span>&nbsp;<span class="op" id="4537369">*</span><span class="ident" id="4537370"><a href="/text/template/parse/node.go.html#4528754">RangeNode</a></span><span class="op" id="4537379">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537382">case</span>&nbsp;<span class="op" id="4537387">*</span><span class="ident" id="4537388"><a href="/text/template/parse/node.go.html#4529656">TemplateNode</a></span><span class="op" id="4537400">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537403">case</span>&nbsp;<span class="op" id="4537408">*</span><span class="ident" id="4537409"><a href="/text/template/parse/node.go.html#4513218">TextNode</a></span><span class="op" id="4537417">:</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537421">return</span>&nbsp;<span class="builtinfunc" id="4537428">len</span><span class="op" id="4537431">(</span><span class="ident" id="4537432"><a href="/text/template/parse/parse.go.html#4530891">bytes</a></span><span class="op" id="4537437">.</span><span class="ident" id="4537438">TrimSpace</span><span class="op" id="4537447">(</span><span class="ident" id="4537448"><a href="/text/template/parse/parse.go.html#4537171">n</a></span><span class="op" id="4537449">.</span><span class="ident" id="4537450">Text</span><span class="op" id="4537454">)</span><span class="op" id="4537455">)</span>&nbsp;<span class="op" id="4537457">==</span>&nbsp;<span class="num" id="4537460">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537463">case</span>&nbsp;<span class="op" id="4537468">*</span><span class="ident" id="4537469"><a href="/text/template/parse/node.go.html#4529213">WithNode</a></span><span class="op" id="4537477">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537480">default</span><span class="op" id="4537487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4537491">panic</span><span class="op" id="4537496">(</span><span class="string" id="4537497">&#34;unknown&nbsp;node:&nbsp;&#34;</span>&nbsp;<span class="op" id="4537514">+</span>&nbsp;<span class="ident" id="4537516"><a href="/text/template/parse/parse.go.html#4537171">n</a></span><span class="op" id="4537517">.</span><span class="ident" id="4537518">String</span><span class="op" id="4537524">(</span><span class="op" id="4537525">)</span><span class="op" id="4537526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537529">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537532">return</span>&nbsp;<span class="builtintype" id="4537539">false</span><br>
<span class="lineno"></span><span class="op" id="4537545">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537548">//&nbsp;parse&nbsp;is&nbsp;the&nbsp;top-level&nbsp;parser&nbsp;for&nbsp;a&nbsp;template,&nbsp;essentially&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span><span class="comment" id="4537618">//&nbsp;as&nbsp;itemList&nbsp;except&nbsp;it&nbsp;also&nbsp;parses&nbsp;{{define}}&nbsp;actions.</span><br>
<span class="lineno">275</span><span class="comment" id="4537675">//&nbsp;It&nbsp;runs&nbsp;to&nbsp;EOF.</span><br>
<span class="lineno"></span><span class="keyword" id="4537694">func</span>&nbsp;<span class="op" id="4537699">(</span><span class="ident" id="4537700">t</span>&nbsp;<span class="op" id="4537702">*</span><span class="ident" id="4537703"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4537707">)</span>&nbsp;<span class="ident" id="4537709">parse</span><span class="op" id="4537714">(</span><span class="ident" id="4537715">treeSet</span>&nbsp;<span class="keyword" id="4537723">map</span><span class="op" id="4537726">[</span><span class="builtintype" id="4537727">string</span><span class="op" id="4537733">]</span><span class="op" id="4537734">*</span><span class="ident" id="4537735"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4537739">)</span>&nbsp;<span class="op" id="4537741">(</span><span class="ident" id="4537742">next</span>&nbsp;<span class="ident" id="4537747"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><span class="op" id="4537751">)</span>&nbsp;<span class="op" id="4537753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537756"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537757">.</span><span class="ident" id="4537758">Root</span>&nbsp;<span class="op" id="4537763">=</span>&nbsp;<span class="ident" id="4537765"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537766">.</span><span class="ident" id="4537767">newList</span><span class="op" id="4537774">(</span><span class="ident" id="4537775"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537776">.</span><span class="ident" id="4537777">peek</span><span class="op" id="4537781">(</span><span class="op" id="4537782">)</span><span class="op" id="4537783">.</span><span class="ident" id="4537784">pos</span><span class="op" id="4537787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537790">for</span>&nbsp;<span class="ident" id="4537794"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537795">.</span><span class="ident" id="4537796">peek</span><span class="op" id="4537800">(</span><span class="op" id="4537801">)</span><span class="op" id="4537802">.</span><span class="ident" id="4537803">typ</span>&nbsp;<span class="op" id="4537807">!=</span>&nbsp;<span class="ident" id="4537810"><a href="/text/template/parse/lex.go.html#4497327">itemEOF</a></span>&nbsp;<span class="op" id="4537818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537822">if</span>&nbsp;<span class="ident" id="4537825"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537826">.</span><span class="ident" id="4537827">peek</span><span class="op" id="4537831">(</span><span class="op" id="4537832">)</span><span class="op" id="4537833">.</span><span class="ident" id="4537834">typ</span>&nbsp;<span class="op" id="4537838">==</span>&nbsp;<span class="ident" id="4537841"><a href="/text/template/parse/lex.go.html#4497462">itemLeftDelim</a></span>&nbsp;<span class="op" id="4537855">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537860">delim</span>&nbsp;<span class="op" id="4537866">:=</span>&nbsp;<span class="ident" id="4537869"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537870">.</span><span class="ident" id="4537871">next</span><span class="op" id="4537875">(</span><span class="op" id="4537876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537881">if</span>&nbsp;<span class="ident" id="4537884"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4537885">.</span><span class="ident" id="4537886">nextNonSpace</span><span class="op" id="4537898">(</span><span class="op" id="4537899">)</span><span class="op" id="4537900">.</span><span class="ident" id="4537901">typ</span>&nbsp;<span class="op" id="4537905">==</span>&nbsp;<span class="ident" id="4537908"><a href="/text/template/parse/lex.go.html#4498106">itemDefine</a></span>&nbsp;<span class="op" id="4537919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537925">newT</span>&nbsp;<span class="op" id="4537930">:=</span>&nbsp;<span class="ident" id="4537933"><a href="/text/template/parse/parse.go.html#4533652">New</a></span><span class="op" id="4537936">(</span><span class="string" id="4537937">&#34;definition&#34;</span><span class="op" id="4537949">)</span>&nbsp;<span class="comment" id="4537951">//&nbsp;name&nbsp;will&nbsp;be&nbsp;updated&nbsp;once&nbsp;we&nbsp;know&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537996"><a href="/text/template/parse/parse.go.html#4537925">newT</a></span><span class="op" id="4538000">.</span><span class="ident" id="4538001">text</span>&nbsp;<span class="op" id="4538006">=</span>&nbsp;<span class="ident" id="4538008"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538009">.</span><span class="ident" id="4538010">text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538019"><a href="/text/template/parse/parse.go.html#4537925">newT</a></span><span class="op" id="4538023">.</span><span class="ident" id="4538024">ParseName</span>&nbsp;<span class="op" id="4538034">=</span>&nbsp;<span class="ident" id="4538036"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538037">.</span><span class="ident" id="4538038">ParseName</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538052"><a href="/text/template/parse/parse.go.html#4537925">newT</a></span><span class="op" id="4538056">.</span><span class="ident" id="4538057">startParse</span><span class="op" id="4538067">(</span><span class="ident" id="4538068"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538069">.</span><span class="ident" id="4538070">funcs</span><span class="op" id="4538075">,</span>&nbsp;<span class="ident" id="4538077"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538078">.</span><span class="ident" id="4538079">lex</span><span class="op" id="4538082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538088"><a href="/text/template/parse/parse.go.html#4537925">newT</a></span><span class="op" id="4538092">.</span><span class="ident" id="4538093">parseDefinition</span><span class="op" id="4538108">(</span><span class="ident" id="4538109"><a href="/text/template/parse/parse.go.html#4537715">treeSet</a></span><span class="op" id="4538116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538122">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538139"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538140">.</span><span class="ident" id="4538141">backup2</span><span class="op" id="4538148">(</span><span class="ident" id="4538149"><a href="/text/template/parse/parse.go.html#4537860">delim</a></span><span class="op" id="4538154">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538162">n</span>&nbsp;<span class="op" id="4538164">:=</span>&nbsp;<span class="ident" id="4538167"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538168">.</span><span class="ident" id="4538169">textOrAction</span><span class="op" id="4538181">(</span><span class="op" id="4538182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538186">if</span>&nbsp;<span class="ident" id="4538189"><a href="/text/template/parse/parse.go.html#4538162">n</a></span><span class="op" id="4538190">.</span><span class="ident" id="4538191">Type</span><span class="op" id="4538195">(</span><span class="op" id="4538196">)</span>&nbsp;<span class="op" id="4538198">==</span>&nbsp;<span class="ident" id="4538201"><a href="/text/template/parse/node.go.html#4511695">nodeEnd</a></span>&nbsp;<span class="op" id="4538209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538214"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538215">.</span><span class="ident" id="4538216">errorf</span><span class="op" id="4538222">(</span><span class="string" id="4538223">&#34;unexpected&nbsp;%s&#34;</span><span class="op" id="4538238">,</span>&nbsp;<span class="ident" id="4538240"><a href="/text/template/parse/parse.go.html#4538162">n</a></span><span class="op" id="4538241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538245">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538249"><a href="/text/template/parse/parse.go.html#4537700">t</a></span><span class="op" id="4538250">.</span><span class="ident" id="4538251">Root</span><span class="op" id="4538255">.</span><span class="builtinfunc" id="4538256">append</span><span class="op" id="4538262">(</span><span class="ident" id="4538263"><a href="/text/template/parse/parse.go.html#4538162">n</a></span><span class="op" id="4538264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538270">return</span>&nbsp;<span class="ident" id="4538277">nil</span><br>
<span class="lineno"></span><span class="op" id="4538281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="4538284">//&nbsp;parseDefinition&nbsp;parses&nbsp;a&nbsp;{{define}}&nbsp;...&nbsp;&nbsp;{{end}}&nbsp;template&nbsp;definition&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4538360">//&nbsp;installs&nbsp;the&nbsp;definition&nbsp;in&nbsp;the&nbsp;treeSet&nbsp;map.&nbsp;&nbsp;The&nbsp;&#34;define&#34;&nbsp;keyword&nbsp;has&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="4538441">//&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="4538458">func</span>&nbsp;<span class="op" id="4538463">(</span><span class="ident" id="4538464">t</span>&nbsp;<span class="op" id="4538466">*</span><span class="ident" id="4538467"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4538471">)</span>&nbsp;<span class="ident" id="4538473">parseDefinition</span><span class="op" id="4538488">(</span><span class="ident" id="4538489">treeSet</span>&nbsp;<span class="keyword" id="4538497">map</span><span class="op" id="4538500">[</span><span class="builtintype" id="4538501">string</span><span class="op" id="4538507">]</span><span class="op" id="4538508">*</span><span class="ident" id="4538509"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4538513">)</span>&nbsp;<span class="op" id="4538515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538518">const</span>&nbsp;<span class="ident" id="4538524">context</span>&nbsp;<span class="op" id="4538532">=</span>&nbsp;<span class="string" id="4538534">&#34;define&nbsp;clause&#34;</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538551">name</span>&nbsp;<span class="op" id="4538556">:=</span>&nbsp;<span class="ident" id="4538559"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538560">.</span><span class="ident" id="4538561">expectOneOf</span><span class="op" id="4538572">(</span><span class="ident" id="4538573"><a href="/text/template/parse/lex.go.html#4497813">itemString</a></span><span class="op" id="4538583">,</span>&nbsp;<span class="ident" id="4538585"><a href="/text/template/parse/lex.go.html#4497625">itemRawString</a></span><span class="op" id="4538598">,</span>&nbsp;<span class="ident" id="4538600"><a href="/text/template/parse/parse.go.html#4538524">context</a></span><span class="op" id="4538607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538610">var</span>&nbsp;<span class="ident" id="4538614">err</span>&nbsp;<span class="builtintype" id="4538618">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538625"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538626">.</span><span class="ident" id="4538627">Name</span><span class="op" id="4538631">,</span>&nbsp;<span class="ident" id="4538633"><a href="/text/template/parse/parse.go.html#4538614">err</a></span>&nbsp;<span class="op" id="4538637">=</span>&nbsp;<span class="ident" id="4538639"><a href="/text/template/parse/parse.go.html#4530918">strconv</a></span><span class="op" id="4538646">.</span><span class="ident" id="4538647">Unquote</span><span class="op" id="4538654">(</span><span class="ident" id="4538655"><a href="/text/template/parse/parse.go.html#4538551">name</a></span><span class="op" id="4538659">.</span><span class="ident" id="4538660">val</span><span class="op" id="4538663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538666">if</span>&nbsp;<span class="ident" id="4538669"><a href="/text/template/parse/parse.go.html#4538614">err</a></span>&nbsp;<span class="op" id="4538673">!=</span>&nbsp;<span class="ident" id="4538676">nil</span>&nbsp;<span class="op" id="4538680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538684"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538685">.</span><span class="builtintype" id="4538686">error</span><span class="op" id="4538691">(</span><span class="ident" id="4538692"><a href="/text/template/parse/parse.go.html#4538614">err</a></span><span class="op" id="4538695">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538701"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538702">.</span><span class="ident" id="4538703">expect</span><span class="op" id="4538709">(</span><span class="ident" id="4538710"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span><span class="op" id="4538724">,</span>&nbsp;<span class="ident" id="4538726"><a href="/text/template/parse/parse.go.html#4538524">context</a></span><span class="op" id="4538733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538736">var</span>&nbsp;<span class="ident" id="4538740">end</span>&nbsp;<span class="ident" id="4538744"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538750"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538751">.</span><span class="ident" id="4538752">Root</span><span class="op" id="4538756">,</span>&nbsp;<span class="ident" id="4538758"><a href="/text/template/parse/parse.go.html#4538740">end</a></span>&nbsp;<span class="op" id="4538762">=</span>&nbsp;<span class="ident" id="4538764"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538765">.</span><span class="ident" id="4538766">itemList</span><span class="op" id="4538774">(</span><span class="op" id="4538775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538778">if</span>&nbsp;<span class="ident" id="4538781"><a href="/text/template/parse/parse.go.html#4538740">end</a></span><span class="op" id="4538784">.</span><span class="ident" id="4538785">Type</span><span class="op" id="4538789">(</span><span class="op" id="4538790">)</span>&nbsp;<span class="op" id="4538792">!=</span>&nbsp;<span class="ident" id="4538795"><a href="/text/template/parse/node.go.html#4511695">nodeEnd</a></span>&nbsp;<span class="op" id="4538803">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538807"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538808">.</span><span class="ident" id="4538809">errorf</span><span class="op" id="4538815">(</span><span class="string" id="4538816">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;%s&#34;</span><span class="op" id="4538837">,</span>&nbsp;<span class="ident" id="4538839"><a href="/text/template/parse/parse.go.html#4538740">end</a></span><span class="op" id="4538842">,</span>&nbsp;<span class="ident" id="4538844"><a href="/text/template/parse/parse.go.html#4538524">context</a></span><span class="op" id="4538851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538857"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538858">.</span><span class="ident" id="4538859">add</span><span class="op" id="4538862">(</span><span class="ident" id="4538863"><a href="/text/template/parse/parse.go.html#4538489">treeSet</a></span><span class="op" id="4538870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538873"><a href="/text/template/parse/parse.go.html#4538464">t</a></span><span class="op" id="4538874">.</span><span class="ident" id="4538875">stopParse</span><span class="op" id="4538884">(</span><span class="op" id="4538885">)</span><br>
<span class="lineno"></span><span class="op" id="4538887">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="4538890">//&nbsp;itemList:</span><br>
<span class="lineno"></span><span class="comment" id="4538903">//&nbsp;&nbsp;&nbsp;&nbsptextOrAction*</span><br>
<span class="lineno"></span><span class="comment" id="4538920">//&nbsp;Terminates&nbsp;at&nbsp;{{end}}&nbsp;or&nbsp;{{else}},&nbsp;returned&nbsp;separately.</span><br>
<span class="lineno"></span><span class="keyword" id="4538979">func</span>&nbsp;<span class="op" id="4538984">(</span><span class="ident" id="4538985">t</span>&nbsp;<span class="op" id="4538987">*</span><span class="ident" id="4538988"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4538992">)</span>&nbsp;<span class="ident" id="4538994">itemList</span><span class="op" id="4539002">(</span><span class="op" id="4539003">)</span>&nbsp;<span class="op" id="4539005">(</span><span class="ident" id="4539006">list</span>&nbsp;<span class="op" id="4539011">*</span><span class="ident" id="4539012"><a href="/text/template/parse/node.go.html#4512500">ListNode</a></span><span class="op" id="4539020">,</span>&nbsp;<span class="ident" id="4539022">next</span>&nbsp;<span class="ident" id="4539027"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><span class="op" id="4539031">)</span>&nbsp;<span class="op" id="4539033">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539036"><a href="/text/template/parse/parse.go.html#4539006">list</a></span>&nbsp;<span class="op" id="4539041">=</span>&nbsp;<span class="ident" id="4539043"><a href="/text/template/parse/parse.go.html#4538985">t</a></span><span class="op" id="4539044">.</span><span class="ident" id="4539045">newList</span><span class="op" id="4539052">(</span><span class="ident" id="4539053"><a href="/text/template/parse/parse.go.html#4538985">t</a></span><span class="op" id="4539054">.</span><span class="ident" id="4539055">peekNonSpace</span><span class="op" id="4539067">(</span><span class="op" id="4539068">)</span><span class="op" id="4539069">.</span><span class="ident" id="4539070">pos</span><span class="op" id="4539073">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539076">for</span>&nbsp;<span class="ident" id="4539080"><a href="/text/template/parse/parse.go.html#4538985">t</a></span><span class="op" id="4539081">.</span><span class="ident" id="4539082">peekNonSpace</span><span class="op" id="4539094">(</span><span class="op" id="4539095">)</span><span class="op" id="4539096">.</span><span class="ident" id="4539097">typ</span>&nbsp;<span class="op" id="4539101">!=</span>&nbsp;<span class="ident" id="4539104"><a href="/text/template/parse/lex.go.html#4497327">itemEOF</a></span>&nbsp;<span class="op" id="4539112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539116">n</span>&nbsp;<span class="op" id="4539118">:=</span>&nbsp;<span class="ident" id="4539121"><a href="/text/template/parse/parse.go.html#4538985">t</a></span><span class="op" id="4539122">.</span><span class="ident" id="4539123">textOrAction</span><span class="op" id="4539135">(</span><span class="op" id="4539136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539140">switch</span>&nbsp;<span class="ident" id="4539147"><a href="/text/template/parse/parse.go.html#4539116">n</a></span><span class="op" id="4539148">.</span><span class="ident" id="4539149">Type</span><span class="op" id="4539153">(</span><span class="op" id="4539154">)</span>&nbsp;<span class="op" id="4539156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539160">case</span>&nbsp;<span class="ident" id="4539165"><a href="/text/template/parse/node.go.html#4511695">nodeEnd</a></span><span class="op" id="4539172">,</span>&nbsp;<span class="ident" id="4539174"><a href="/text/template/parse/node.go.html#4511625">nodeElse</a></span><span class="op" id="4539182">:</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539187">return</span>&nbsp;<span class="ident" id="4539194"><a href="/text/template/parse/parse.go.html#4539006">list</a></span><span class="op" id="4539198">,</span>&nbsp;<span class="ident" id="4539200"><a href="/text/template/parse/parse.go.html#4539116">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539208"><a href="/text/template/parse/parse.go.html#4539006">list</a></span><span class="op" id="4539212">.</span><span class="builtinfunc" id="4539213">append</span><span class="op" id="4539219">(</span><span class="ident" id="4539220"><a href="/text/template/parse/parse.go.html#4539116">n</a></span><span class="op" id="4539221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539227"><a href="/text/template/parse/parse.go.html#4538985">t</a></span><span class="op" id="4539228">.</span><span class="ident" id="4539229">errorf</span><span class="op" id="4539235">(</span><span class="string" id="4539236">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="4539252">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539255">return</span><br>
<span class="lineno"></span><span class="op" id="4539262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4539265">//&nbsp;textOrAction:</span><br>
<span class="lineno"></span><span class="comment" id="4539282">//&nbsp;&nbsp;&nbsp;&nbsptext&nbsp;|&nbsp;action</span><br>
<span class="lineno">340</span><span class="keyword" id="4539299">func</span>&nbsp;<span class="op" id="4539304">(</span><span class="ident" id="4539305">t</span>&nbsp;<span class="op" id="4539307">*</span><span class="ident" id="4539308"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4539312">)</span>&nbsp;<span class="ident" id="4539314">textOrAction</span><span class="op" id="4539326">(</span><span class="op" id="4539327">)</span>&nbsp;<span class="ident" id="4539329"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4539334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539337">switch</span>&nbsp;<span class="ident" id="4539344">token</span>&nbsp;<span class="op" id="4539350">:=</span>&nbsp;<span class="ident" id="4539353"><a href="/text/template/parse/parse.go.html#4539305">t</a></span><span class="op" id="4539354">.</span><span class="ident" id="4539355">nextNonSpace</span><span class="op" id="4539367">(</span><span class="op" id="4539368">)</span><span class="op" id="4539369">;</span>&nbsp;<span class="ident" id="4539371"><a href="/text/template/parse/parse.go.html#4539344">token</a></span><span class="op" id="4539376">.</span><span class="ident" id="4539377">typ</span>&nbsp;<span class="op" id="4539381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539384">case</span>&nbsp;<span class="ident" id="4539389"><a href="/text/template/parse/lex.go.html#4497864">itemText</a></span><span class="op" id="4539397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539401">return</span>&nbsp;<span class="ident" id="4539408"><a href="/text/template/parse/parse.go.html#4539305">t</a></span><span class="op" id="4539409">.</span><span class="ident" id="4539410">newText</span><span class="op" id="4539417">(</span><span class="ident" id="4539418"><a href="/text/template/parse/parse.go.html#4539344">token</a></span><span class="op" id="4539423">.</span><span class="ident" id="4539424">pos</span><span class="op" id="4539427">,</span>&nbsp;<span class="ident" id="4539429"><a href="/text/template/parse/parse.go.html#4539344">token</a></span><span class="op" id="4539434">.</span><span class="ident" id="4539435">val</span><span class="op" id="4539438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539441">case</span>&nbsp;<span class="ident" id="4539446"><a href="/text/template/parse/lex.go.html#4497462">itemLeftDelim</a></span><span class="op" id="4539459">:</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539463">return</span>&nbsp;<span class="ident" id="4539470"><a href="/text/template/parse/parse.go.html#4539305">t</a></span><span class="op" id="4539471">.</span><span class="ident" id="4539472">action</span><span class="op" id="4539478">(</span><span class="op" id="4539479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539482">default</span><span class="op" id="4539489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539493"><a href="/text/template/parse/parse.go.html#4539305">t</a></span><span class="op" id="4539494">.</span><span class="ident" id="4539495">unexpected</span><span class="op" id="4539505">(</span><span class="ident" id="4539506"><a href="/text/template/parse/parse.go.html#4539344">token</a></span><span class="op" id="4539511">,</span>&nbsp;<span class="string" id="4539513">&#34;input&#34;</span><span class="op" id="4539520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539523">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539526">return</span>&nbsp;<span class="ident" id="4539533">nil</span><br>
<span class="lineno">350</span><span class="op" id="4539537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4539540">//&nbsp;Action:</span><br>
<span class="lineno"></span><span class="comment" id="4539551">//&nbsp;&nbsp;&nbsp;&nbspcontrol</span><br>
<span class="lineno"></span><span class="comment" id="4539562">//&nbsp;&nbsp;&nbsp;&nbspcommand&nbsp;(&#34;|&#34;&nbsp;command)*</span><br>
<span class="lineno">355</span><span class="comment" id="4539588">//&nbsp;Left&nbsp;delim&nbsp;is&nbsp;past.&nbsp;Now&nbsp;get&nbsp;actions.</span><br>
<span class="lineno"></span><span class="comment" id="4539628">//&nbsp;First&nbsp;word&nbsp;could&nbsp;be&nbsp;a&nbsp;keyword&nbsp;such&nbsp;as&nbsp;range.</span><br>
<span class="lineno"></span><span class="keyword" id="4539676">func</span>&nbsp;<span class="op" id="4539681">(</span><span class="ident" id="4539682">t</span>&nbsp;<span class="op" id="4539684">*</span><span class="ident" id="4539685"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4539689">)</span>&nbsp;<span class="ident" id="4539691">action</span><span class="op" id="4539697">(</span><span class="op" id="4539698">)</span>&nbsp;<span class="op" id="4539700">(</span><span class="ident" id="4539701">n</span>&nbsp;<span class="ident" id="4539703"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><span class="op" id="4539707">)</span>&nbsp;<span class="op" id="4539709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539712">switch</span>&nbsp;<span class="ident" id="4539719">token</span>&nbsp;<span class="op" id="4539725">:=</span>&nbsp;<span class="ident" id="4539728"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539729">.</span><span class="ident" id="4539730">nextNonSpace</span><span class="op" id="4539742">(</span><span class="op" id="4539743">)</span><span class="op" id="4539744">;</span>&nbsp;<span class="ident" id="4539746"><a href="/text/template/parse/parse.go.html#4539719">token</a></span><span class="op" id="4539751">.</span><span class="ident" id="4539752">typ</span>&nbsp;<span class="op" id="4539756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539759">case</span>&nbsp;<span class="ident" id="4539764"><a href="/text/template/parse/lex.go.html#4498138">itemElse</a></span><span class="op" id="4539772">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539776">return</span>&nbsp;<span class="ident" id="4539783"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539784">.</span><span class="ident" id="4539785">elseControl</span><span class="op" id="4539796">(</span><span class="op" id="4539797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539800">case</span>&nbsp;<span class="ident" id="4539805"><a href="/text/template/parse/lex.go.html#4498168">itemEnd</a></span><span class="op" id="4539812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539816">return</span>&nbsp;<span class="ident" id="4539823"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539824">.</span><span class="ident" id="4539825">endControl</span><span class="op" id="4539835">(</span><span class="op" id="4539836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539839">case</span>&nbsp;<span class="ident" id="4539844"><a href="/text/template/parse/lex.go.html#4498197">itemIf</a></span><span class="op" id="4539850">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539854">return</span>&nbsp;<span class="ident" id="4539861"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539862">.</span><span class="ident" id="4539863">ifControl</span><span class="op" id="4539872">(</span><span class="op" id="4539873">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539876">case</span>&nbsp;<span class="ident" id="4539881"><a href="/text/template/parse/lex.go.html#4498298">itemRange</a></span><span class="op" id="4539890">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539894">return</span>&nbsp;<span class="ident" id="4539901"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539902">.</span><span class="ident" id="4539903">rangeControl</span><span class="op" id="4539915">(</span><span class="op" id="4539916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539919">case</span>&nbsp;<span class="ident" id="4539924"><a href="/text/template/parse/lex.go.html#4498329">itemTemplate</a></span><span class="op" id="4539936">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539940">return</span>&nbsp;<span class="ident" id="4539947"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539948">.</span><span class="ident" id="4539949">templateControl</span><span class="op" id="4539964">(</span><span class="op" id="4539965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539968">case</span>&nbsp;<span class="ident" id="4539973"><a href="/text/template/parse/lex.go.html#4498363">itemWith</a></span><span class="op" id="4539981">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539985">return</span>&nbsp;<span class="ident" id="4539992"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4539993">.</span><span class="ident" id="4539994">withControl</span><span class="op" id="4540005">(</span><span class="op" id="4540006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4540009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540012"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4540013">.</span><span class="ident" id="4540014">backup</span><span class="op" id="4540020">(</span><span class="op" id="4540021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540024">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables;&nbsp;they&nbsp;persist&nbsp;until&nbsp;&#34;end&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540076">return</span>&nbsp;<span class="ident" id="4540083"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4540084">.</span><span class="ident" id="4540085">newAction</span><span class="op" id="4540094">(</span><span class="ident" id="4540095"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4540096">.</span><span class="ident" id="4540097">peek</span><span class="op" id="4540101">(</span><span class="op" id="4540102">)</span><span class="op" id="4540103">.</span><span class="ident" id="4540104">pos</span><span class="op" id="4540107">,</span>&nbsp;<span class="ident" id="4540109"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4540110">.</span><span class="ident" id="4540111">lex</span><span class="op" id="4540114">.</span><span class="ident" id="4540115">lineNumber</span><span class="op" id="4540125">(</span><span class="op" id="4540126">)</span><span class="op" id="4540127">,</span>&nbsp;<span class="ident" id="4540129"><a href="/text/template/parse/parse.go.html#4539682">t</a></span><span class="op" id="4540130">.</span><span class="ident" id="4540131">pipeline</span><span class="op" id="4540139">(</span><span class="string" id="4540140">&#34;command&#34;</span><span class="op" id="4540149">)</span><span class="op" id="4540150">)</span><br>
<span class="lineno">375</span><span class="op" id="4540152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4540155">//&nbsp;Pipeline:</span><br>
<span class="lineno"></span><span class="comment" id="4540168">//&nbsp;&nbsp;&nbsp;&nbspdeclarations?&nbsp;command&nbsp;(&#39;|&#39;&nbsp;command)*</span><br>
<span class="lineno"></span><span class="keyword" id="4540208">func</span>&nbsp;<span class="op" id="4540213">(</span><span class="ident" id="4540214">t</span>&nbsp;<span class="op" id="4540216">*</span><span class="ident" id="4540217"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4540221">)</span>&nbsp;<span class="ident" id="4540223">pipeline</span><span class="op" id="4540231">(</span><span class="ident" id="4540232">context</span>&nbsp;<span class="builtintype" id="4540240">string</span><span class="op" id="4540246">)</span>&nbsp;<span class="op" id="4540248">(</span><span class="ident" id="4540249">pipe</span>&nbsp;<span class="op" id="4540254">*</span><span class="ident" id="4540255"><a href="/text/template/parse/node.go.html#4513767">PipeNode</a></span><span class="op" id="4540263">)</span>&nbsp;<span class="op" id="4540265">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540268">var</span>&nbsp;<span class="ident" id="4540272">decl</span>&nbsp;<span class="op" id="4540277">[</span><span class="op" id="4540278">]</span><span class="op" id="4540279">*</span><span class="ident" id="4540280"><a href="/text/template/parse/node.go.html#4517726">VariableNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540294">pos</span>&nbsp;<span class="op" id="4540298">:=</span>&nbsp;<span class="ident" id="4540301"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540302">.</span><span class="ident" id="4540303">peekNonSpace</span><span class="op" id="4540315">(</span><span class="op" id="4540316">)</span><span class="op" id="4540317">.</span><span class="ident" id="4540318">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540323">//&nbsp;Are&nbsp;there&nbsp;declarations?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540351">for</span>&nbsp;<span class="op" id="4540355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540359">if</span>&nbsp;<span class="ident" id="4540362">v</span>&nbsp;<span class="op" id="4540364">:=</span>&nbsp;<span class="ident" id="4540367"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540368">.</span><span class="ident" id="4540369">peekNonSpace</span><span class="op" id="4540381">(</span><span class="op" id="4540382">)</span><span class="op" id="4540383">;</span>&nbsp;<span class="ident" id="4540385"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4540386">.</span><span class="ident" id="4540387">typ</span>&nbsp;<span class="op" id="4540391">==</span>&nbsp;<span class="ident" id="4540394"><a href="/text/template/parse/lex.go.html#4497894">itemVariable</a></span>&nbsp;<span class="op" id="4540407">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540412"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540413">.</span><span class="ident" id="4540414">next</span><span class="op" id="4540418">(</span><span class="op" id="4540419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540424">//&nbsp;Since&nbsp;space&nbsp;is&nbsp;a&nbsp;token,&nbsp;we&nbsp;need&nbsp;3-token&nbsp;look-ahead&nbsp;here&nbsp;in&nbsp;the&nbsp;worst&nbsp;case:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540505">//&nbsp;in&nbsp;&#34;$x&nbsp;foo&#34;&nbsp;we&nbsp;need&nbsp;to&nbsp;read&nbsp;&#34;foo&#34;&nbsp;(as&nbsp;opposed&nbsp;to&nbsp;&#34;:=&#34;)&nbsp;to&nbsp;know&nbsp;that&nbsp;$x&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540588">//&nbsp;argument&nbsp;variable&nbsp;rather&nbsp;than&nbsp;a&nbsp;declaration.&nbsp;So&nbsp;remember&nbsp;the&nbsp;token</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540661">//&nbsp;adjacent&nbsp;to&nbsp;the&nbsp;variable&nbsp;so&nbsp;we&nbsp;can&nbsp;push&nbsp;it&nbsp;back&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540729">tokenAfterVariable</span>&nbsp;<span class="op" id="4540748">:=</span>&nbsp;<span class="ident" id="4540751"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540752">.</span><span class="ident" id="4540753">peek</span><span class="op" id="4540757">(</span><span class="op" id="4540758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540763">if</span>&nbsp;<span class="ident" id="4540766">next</span>&nbsp;<span class="op" id="4540771">:=</span>&nbsp;<span class="ident" id="4540774"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540775">.</span><span class="ident" id="4540776">peekNonSpace</span><span class="op" id="4540788">(</span><span class="op" id="4540789">)</span><span class="op" id="4540790">;</span>&nbsp;<span class="ident" id="4540792"><a href="/text/template/parse/parse.go.html#4540766">next</a></span><span class="op" id="4540796">.</span><span class="ident" id="4540797">typ</span>&nbsp;<span class="op" id="4540801">==</span>&nbsp;<span class="ident" id="4540804"><a href="/text/template/parse/lex.go.html#4497244">itemColonEquals</a></span>&nbsp;<span class="op" id="4540820">||</span>&nbsp;<span class="op" id="4540823">(</span><span class="ident" id="4540824"><a href="/text/template/parse/parse.go.html#4540766">next</a></span><span class="op" id="4540828">.</span><span class="ident" id="4540829">typ</span>&nbsp;<span class="op" id="4540833">==</span>&nbsp;<span class="ident" id="4540836"><a href="/text/template/parse/lex.go.html#4497011">itemChar</a></span>&nbsp;<span class="op" id="4540845">&amp;&amp;</span>&nbsp;<span class="ident" id="4540848"><a href="/text/template/parse/parse.go.html#4540766">next</a></span><span class="op" id="4540852">.</span><span class="ident" id="4540853">val</span>&nbsp;<span class="op" id="4540857">==</span>&nbsp;<span class="string" id="4540860">&#34;,&#34;</span><span class="op" id="4540863">)</span>&nbsp;<span class="op" id="4540865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540871"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540872">.</span><span class="ident" id="4540873">nextNonSpace</span><span class="op" id="4540885">(</span><span class="op" id="4540886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540892">variable</span>&nbsp;<span class="op" id="4540901">:=</span>&nbsp;<span class="ident" id="4540904"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540905">.</span><span class="ident" id="4540906">newVariable</span><span class="op" id="4540917">(</span><span class="ident" id="4540918"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4540919">.</span><span class="ident" id="4540920">pos</span><span class="op" id="4540923">,</span>&nbsp;<span class="ident" id="4540925"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4540926">.</span><span class="ident" id="4540927">val</span><span class="op" id="4540930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540936"><a href="/text/template/parse/parse.go.html#4540272">decl</a></span>&nbsp;<span class="op" id="4540941">=</span>&nbsp;<span class="builtinfunc" id="4540943">append</span><span class="op" id="4540949">(</span><span class="ident" id="4540950"><a href="/text/template/parse/parse.go.html#4540272">decl</a></span><span class="op" id="4540954">,</span>&nbsp;<span class="ident" id="4540956"><a href="/text/template/parse/parse.go.html#4540892">variable</a></span><span class="op" id="4540964">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540970"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540971">.</span><span class="ident" id="4540972">vars</span>&nbsp;<span class="op" id="4540977">=</span>&nbsp;<span class="builtinfunc" id="4540979">append</span><span class="op" id="4540985">(</span><span class="ident" id="4540986"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4540987">.</span><span class="ident" id="4540988">vars</span><span class="op" id="4540992">,</span>&nbsp;<span class="ident" id="4540994"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4540995">.</span><span class="ident" id="4540996">val</span><span class="op" id="4540999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541005">if</span>&nbsp;<span class="ident" id="4541008"><a href="/text/template/parse/parse.go.html#4540766">next</a></span><span class="op" id="4541012">.</span><span class="ident" id="4541013">typ</span>&nbsp;<span class="op" id="4541017">==</span>&nbsp;<span class="ident" id="4541020"><a href="/text/template/parse/lex.go.html#4497011">itemChar</a></span>&nbsp;<span class="op" id="4541029">&amp;&amp;</span>&nbsp;<span class="ident" id="4541032"><a href="/text/template/parse/parse.go.html#4540766">next</a></span><span class="op" id="4541036">.</span><span class="ident" id="4541037">val</span>&nbsp;<span class="op" id="4541041">==</span>&nbsp;<span class="string" id="4541044">&#34;,&#34;</span>&nbsp;<span class="op" id="4541048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541055">if</span>&nbsp;<span class="ident" id="4541058"><a href="/text/template/parse/parse.go.html#4540232">context</a></span>&nbsp;<span class="op" id="4541066">==</span>&nbsp;<span class="string" id="4541069">&#34;range&#34;</span>&nbsp;<span class="op" id="4541077">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="4541080">len</span><span class="op" id="4541083">(</span><span class="ident" id="4541084"><a href="/text/template/parse/parse.go.html#4540272">decl</a></span><span class="op" id="4541088">)</span>&nbsp;<span class="op" id="4541090">&lt;</span>&nbsp;<span class="num" id="4541092">2</span>&nbsp;<span class="op" id="4541094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541102">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541116">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541123"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541124">.</span><span class="ident" id="4541125">errorf</span><span class="op" id="4541131">(</span><span class="string" id="4541132">&#34;too&nbsp;many&nbsp;declarations&nbsp;in&nbsp;%s&#34;</span><span class="op" id="4541161">,</span>&nbsp;<span class="ident" id="4541163"><a href="/text/template/parse/parse.go.html#4540232">context</a></span><span class="op" id="4541170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541181">}</span>&nbsp;<span class="keyword" id="4541183">else</span>&nbsp;<span class="keyword" id="4541188">if</span>&nbsp;<span class="ident" id="4541191"><a href="/text/template/parse/parse.go.html#4540729">tokenAfterVariable</a></span><span class="op" id="4541209">.</span><span class="ident" id="4541210">typ</span>&nbsp;<span class="op" id="4541214">==</span>&nbsp;<span class="ident" id="4541217"><a href="/text/template/parse/lex.go.html#4497759">itemSpace</a></span>&nbsp;<span class="op" id="4541227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541233"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541234">.</span><span class="ident" id="4541235">backup3</span><span class="op" id="4541242">(</span><span class="ident" id="4541243"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4541244">,</span>&nbsp;<span class="ident" id="4541246"><a href="/text/template/parse/parse.go.html#4540729">tokenAfterVariable</a></span><span class="op" id="4541264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541269">}</span>&nbsp;<span class="keyword" id="4541271">else</span>&nbsp;<span class="op" id="4541276">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541282"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541283">.</span><span class="ident" id="4541284">backup2</span><span class="op" id="4541291">(</span><span class="ident" id="4541292"><a href="/text/template/parse/parse.go.html#4540362">v</a></span><span class="op" id="4541293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541306">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541313">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541316"><a href="/text/template/parse/parse.go.html#4540249">pipe</a></span>&nbsp;<span class="op" id="4541321">=</span>&nbsp;<span class="ident" id="4541323"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541324">.</span><span class="ident" id="4541325">newPipeline</span><span class="op" id="4541336">(</span><span class="ident" id="4541337"><a href="/text/template/parse/parse.go.html#4540294">pos</a></span><span class="op" id="4541340">,</span>&nbsp;<span class="ident" id="4541342"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541343">.</span><span class="ident" id="4541344">lex</span><span class="op" id="4541347">.</span><span class="ident" id="4541348">lineNumber</span><span class="op" id="4541358">(</span><span class="op" id="4541359">)</span><span class="op" id="4541360">,</span>&nbsp;<span class="ident" id="4541362"><a href="/text/template/parse/parse.go.html#4540272">decl</a></span><span class="op" id="4541366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541369">for</span>&nbsp;<span class="op" id="4541373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541377">switch</span>&nbsp;<span class="ident" id="4541384">token</span>&nbsp;<span class="op" id="4541390">:=</span>&nbsp;<span class="ident" id="4541393"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541394">.</span><span class="ident" id="4541395">nextNonSpace</span><span class="op" id="4541407">(</span><span class="op" id="4541408">)</span><span class="op" id="4541409">;</span>&nbsp;<span class="ident" id="4541411"><a href="/text/template/parse/parse.go.html#4541384">token</a></span><span class="op" id="4541416">.</span><span class="ident" id="4541417">typ</span>&nbsp;<span class="op" id="4541421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541425">case</span>&nbsp;<span class="ident" id="4541430"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span><span class="op" id="4541444">,</span>&nbsp;<span class="ident" id="4541446"><a href="/text/template/parse/lex.go.html#4497722">itemRightParen</a></span><span class="op" id="4541460">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541465">if</span>&nbsp;<span class="builtinfunc" id="4541468">len</span><span class="op" id="4541471">(</span><span class="ident" id="4541472"><a href="/text/template/parse/parse.go.html#4540249">pipe</a></span><span class="op" id="4541476">.</span><span class="ident" id="4541477">Cmds</span><span class="op" id="4541481">)</span>&nbsp;<span class="op" id="4541483">==</span>&nbsp;<span class="num" id="4541486">0</span>&nbsp;<span class="op" id="4541488">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541494"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541495">.</span><span class="ident" id="4541496">errorf</span><span class="op" id="4541502">(</span><span class="string" id="4541503">&#34;missing&nbsp;value&nbsp;for&nbsp;%s&#34;</span><span class="op" id="4541525">,</span>&nbsp;<span class="ident" id="4541527"><a href="/text/template/parse/parse.go.html#4540232">context</a></span><span class="op" id="4541534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541539">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541544">if</span>&nbsp;<span class="ident" id="4541547"><a href="/text/template/parse/parse.go.html#4541384">token</a></span><span class="op" id="4541552">.</span><span class="ident" id="4541553">typ</span>&nbsp;<span class="op" id="4541557">==</span>&nbsp;<span class="ident" id="4541560"><a href="/text/template/parse/lex.go.html#4497722">itemRightParen</a></span>&nbsp;<span class="op" id="4541575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541581"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541582">.</span><span class="ident" id="4541583">backup</span><span class="op" id="4541589">(</span><span class="op" id="4541590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541595">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541600">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541609">case</span>&nbsp;<span class="ident" id="4541614"><a href="/text/template/parse/lex.go.html#4496957">itemBool</a></span><span class="op" id="4541622">,</span>&nbsp;<span class="ident" id="4541624"><a href="/text/template/parse/lex.go.html#4497099">itemCharConstant</a></span><span class="op" id="4541640">,</span>&nbsp;<span class="ident" id="4541642"><a href="/text/template/parse/lex.go.html#4497155">itemComplex</a></span><span class="op" id="4541653">,</span>&nbsp;<span class="ident" id="4541655"><a href="/text/template/parse/lex.go.html#4498065">itemDot</a></span><span class="op" id="4541662">,</span>&nbsp;<span class="ident" id="4541664"><a href="/text/template/parse/lex.go.html#4497336">itemField</a></span><span class="op" id="4541673">,</span>&nbsp;<span class="ident" id="4541675"><a href="/text/template/parse/lex.go.html#4497397">itemIdentifier</a></span><span class="op" id="4541689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541694"><a href="/text/template/parse/lex.go.html#4497540">itemNumber</a></span><span class="op" id="4541704">,</span>&nbsp;<span class="ident" id="4541706"><a href="/text/template/parse/lex.go.html#4498225">itemNil</a></span><span class="op" id="4541713">,</span>&nbsp;<span class="ident" id="4541715"><a href="/text/template/parse/lex.go.html#4497625">itemRawString</a></span><span class="op" id="4541728">,</span>&nbsp;<span class="ident" id="4541730"><a href="/text/template/parse/lex.go.html#4497813">itemString</a></span><span class="op" id="4541740">,</span>&nbsp;<span class="ident" id="4541742"><a href="/text/template/parse/lex.go.html#4497894">itemVariable</a></span><span class="op" id="4541754">,</span>&nbsp;<span class="ident" id="4541756"><a href="/text/template/parse/lex.go.html#4497503">itemLeftParen</a></span><span class="op" id="4541769">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541774"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541775">.</span><span class="ident" id="4541776">backup</span><span class="op" id="4541782">(</span><span class="op" id="4541783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541788"><a href="/text/template/parse/parse.go.html#4540249">pipe</a></span><span class="op" id="4541792">.</span><span class="builtinfunc" id="4541793">append</span><span class="op" id="4541799">(</span><span class="ident" id="4541800"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541801">.</span><span class="ident" id="4541802">command</span><span class="op" id="4541809">(</span><span class="op" id="4541810">)</span><span class="op" id="4541811">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541815">default</span><span class="op" id="4541822">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541827"><a href="/text/template/parse/parse.go.html#4540214">t</a></span><span class="op" id="4541828">.</span><span class="ident" id="4541829">unexpected</span><span class="op" id="4541839">(</span><span class="ident" id="4541840"><a href="/text/template/parse/parse.go.html#4541384">token</a></span><span class="op" id="4541845">,</span>&nbsp;<span class="ident" id="4541847"><a href="/text/template/parse/parse.go.html#4540232">context</a></span><span class="op" id="4541854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541861">}</span><br>
<span class="lineno"></span><span class="op" id="4541863">}</span><br>
<span class="lineno">430</span><br>
<span class="lineno"></span><span class="keyword" id="4541866">func</span>&nbsp;<span class="op" id="4541871">(</span><span class="ident" id="4541872">t</span>&nbsp;<span class="op" id="4541874">*</span><span class="ident" id="4541875"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4541879">)</span>&nbsp;<span class="ident" id="4541881">parseControl</span><span class="op" id="4541893">(</span><span class="ident" id="4541894">allowElseIf</span>&nbsp;<span class="builtintype" id="4541906">bool</span><span class="op" id="4541910">,</span>&nbsp;<span class="ident" id="4541912">context</span>&nbsp;<span class="builtintype" id="4541920">string</span><span class="op" id="4541926">)</span>&nbsp;<span class="op" id="4541928">(</span><span class="ident" id="4541929">pos</span>&nbsp;<span class="ident" id="4541933"><a href="/text/template/parse/node.go.html#4511021">Pos</a></span><span class="op" id="4541936">,</span>&nbsp;<span class="ident" id="4541938">line</span>&nbsp;<span class="builtintype" id="4541943">int</span><span class="op" id="4541946">,</span>&nbsp;<span class="ident" id="4541948">pipe</span>&nbsp;<span class="op" id="4541953">*</span><span class="ident" id="4541954"><a href="/text/template/parse/node.go.html#4513767">PipeNode</a></span><span class="op" id="4541962">,</span>&nbsp;<span class="ident" id="4541964">list</span><span class="op" id="4541968">,</span>&nbsp;<span class="ident" id="4541970">elseList</span>&nbsp;<span class="op" id="4541979">*</span><span class="ident" id="4541980"><a href="/text/template/parse/node.go.html#4512500">ListNode</a></span><span class="op" id="4541988">)</span>&nbsp;<span class="op" id="4541990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541993">defer</span>&nbsp;<span class="ident" id="4541999"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542000">.</span><span class="ident" id="4542001">popVars</span><span class="op" id="4542008">(</span><span class="builtinfunc" id="4542009">len</span><span class="op" id="4542012">(</span><span class="ident" id="4542013"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542014">.</span><span class="ident" id="4542015">vars</span><span class="op" id="4542019">)</span><span class="op" id="4542020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542023"><a href="/text/template/parse/parse.go.html#4541938">line</a></span>&nbsp;<span class="op" id="4542028">=</span>&nbsp;<span class="ident" id="4542030"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542031">.</span><span class="ident" id="4542032">lex</span><span class="op" id="4542035">.</span><span class="ident" id="4542036">lineNumber</span><span class="op" id="4542046">(</span><span class="op" id="4542047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542050"><a href="/text/template/parse/parse.go.html#4541948">pipe</a></span>&nbsp;<span class="op" id="4542055">=</span>&nbsp;<span class="ident" id="4542057"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542058">.</span><span class="ident" id="4542059">pipeline</span><span class="op" id="4542067">(</span><span class="ident" id="4542068"><a href="/text/template/parse/parse.go.html#4541912">context</a></span><span class="op" id="4542075">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542078">var</span>&nbsp;<span class="ident" id="4542082">next</span>&nbsp;<span class="ident" id="4542087"><a href="/text/template/parse/node.go.html#4510399">Node</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542093"><a href="/text/template/parse/parse.go.html#4541964">list</a></span><span class="op" id="4542097">,</span>&nbsp;<span class="ident" id="4542099"><a href="/text/template/parse/parse.go.html#4542082">next</a></span>&nbsp;<span class="op" id="4542104">=</span>&nbsp;<span class="ident" id="4542106"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542107">.</span><span class="ident" id="4542108">itemList</span><span class="op" id="4542116">(</span><span class="op" id="4542117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542120">switch</span>&nbsp;<span class="ident" id="4542127"><a href="/text/template/parse/parse.go.html#4542082">next</a></span><span class="op" id="4542131">.</span><span class="ident" id="4542132">Type</span><span class="op" id="4542136">(</span><span class="op" id="4542137">)</span>&nbsp;<span class="op" id="4542139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542142">case</span>&nbsp;<span class="ident" id="4542147"><a href="/text/template/parse/node.go.html#4511695">nodeEnd</a></span><span class="op" id="4542154">:</span>&nbsp;<span class="comment" id="4542156">//done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542164">case</span>&nbsp;<span class="ident" id="4542169"><a href="/text/template/parse/node.go.html#4511625">nodeElse</a></span><span class="op" id="4542177">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542181">if</span>&nbsp;<span class="ident" id="4542184"><a href="/text/template/parse/parse.go.html#4541894">allowElseIf</a></span>&nbsp;<span class="op" id="4542196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542201">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;&#34;else&nbsp;if&#34;.&nbsp;If&nbsp;the&nbsp;&#34;else&#34;&nbsp;is&nbsp;followed&nbsp;immediately&nbsp;by&nbsp;an&nbsp;&#34;if&#34;,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542285">//&nbsp;the&nbsp;elseControl&nbsp;will&nbsp;have&nbsp;left&nbsp;the&nbsp;&#34;if&#34;&nbsp;token&nbsp;pending.&nbsp;Treat</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542352">//&nbsp;&nbsp;&nbsp;&nbsp{{if&nbsp;a}}_{{else&nbsp;if&nbsp;b}}_{{end}}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542389">//&nbsp;as</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542398">//&nbsp;&nbsp;&nbsp;&nbsp{{if&nbsp;a}}_{{else}}{{if&nbsp;b}}_{{end}}{{end}}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542446">//&nbsp;To&nbsp;do&nbsp;this,&nbsp;parse&nbsp;the&nbsp;if&nbsp;as&nbsp;usual&nbsp;and&nbsp;stop&nbsp;at&nbsp;it&nbsp;{{end}};&nbsp;the&nbsp;subsequent{{end}}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542532">//&nbsp;is&nbsp;assumed.&nbsp;This&nbsp;technique&nbsp;works&nbsp;even&nbsp;for&nbsp;long&nbsp;if-else-if&nbsp;chains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542604">//&nbsp;TODO:&nbsp;Should&nbsp;we&nbsp;allow&nbsp;else-if&nbsp;in&nbsp;with&nbsp;and&nbsp;range?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542659">if</span>&nbsp;<span class="ident" id="4542662"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542663">.</span><span class="ident" id="4542664">peek</span><span class="op" id="4542668">(</span><span class="op" id="4542669">)</span><span class="op" id="4542670">.</span><span class="ident" id="4542671">typ</span>&nbsp;<span class="op" id="4542675">==</span>&nbsp;<span class="ident" id="4542678"><a href="/text/template/parse/lex.go.html#4498197">itemIf</a></span>&nbsp;<span class="op" id="4542685">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542691"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542692">.</span><span class="ident" id="4542693">next</span><span class="op" id="4542697">(</span><span class="op" id="4542698">)</span>&nbsp;<span class="comment" id="4542700">//&nbsp;Consume&nbsp;the&nbsp;&#34;if&#34;&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542731"><a href="/text/template/parse/parse.go.html#4541970">elseList</a></span>&nbsp;<span class="op" id="4542740">=</span>&nbsp;<span class="ident" id="4542742"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542743">.</span><span class="ident" id="4542744">newList</span><span class="op" id="4542751">(</span><span class="ident" id="4542752"><a href="/text/template/parse/parse.go.html#4542082">next</a></span><span class="op" id="4542756">.</span><span class="ident" id="4542757">Position</span><span class="op" id="4542765">(</span><span class="op" id="4542766">)</span><span class="op" id="4542767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542773"><a href="/text/template/parse/parse.go.html#4541970">elseList</a></span><span class="op" id="4542781">.</span><span class="builtinfunc" id="4542782">append</span><span class="op" id="4542788">(</span><span class="ident" id="4542789"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542790">.</span><span class="ident" id="4542791">ifControl</span><span class="op" id="4542800">(</span><span class="op" id="4542801">)</span><span class="op" id="4542802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542808">//&nbsp;Do&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;item&nbsp;-&nbsp;only&nbsp;one&nbsp;{{end}}&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542873">break</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4542882">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4542886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542890"><a href="/text/template/parse/parse.go.html#4541970">elseList</a></span><span class="op" id="4542898">,</span>&nbsp;<span class="ident" id="4542900"><a href="/text/template/parse/parse.go.html#4542082">next</a></span>&nbsp;<span class="op" id="4542905">=</span>&nbsp;<span class="ident" id="4542907"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542908">.</span><span class="ident" id="4542909">itemList</span><span class="op" id="4542917">(</span><span class="op" id="4542918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4542922">if</span>&nbsp;<span class="ident" id="4542925"><a href="/text/template/parse/parse.go.html#4542082">next</a></span><span class="op" id="4542929">.</span><span class="ident" id="4542930">Type</span><span class="op" id="4542934">(</span><span class="op" id="4542935">)</span>&nbsp;<span class="op" id="4542937">!=</span>&nbsp;<span class="ident" id="4542940"><a href="/text/template/parse/node.go.html#4511695">nodeEnd</a></span>&nbsp;<span class="op" id="4542948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542953"><a href="/text/template/parse/parse.go.html#4541872">t</a></span><span class="op" id="4542954">.</span><span class="ident" id="4542955">errorf</span><span class="op" id="4542961">(</span><span class="string" id="4542962">&#34;expected&nbsp;end;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4542986">,</span>&nbsp;<span class="ident" id="4542988"><a href="/text/template/parse/parse.go.html#4542082">next</a></span><span class="op" id="4542992">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4542996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4542999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543002">return</span>&nbsp;<span class="ident" id="4543009"><a href="/text/template/parse/parse.go.html#4541948">pipe</a></span><span class="op" id="4543013">.</span><span class="ident" id="4543014">Position</span><span class="op" id="4543022">(</span><span class="op" id="4543023">)</span><span class="op" id="4543024">,</span>&nbsp;<span class="ident" id="4543026"><a href="/text/template/parse/parse.go.html#4541938">line</a></span><span class="op" id="4543030">,</span>&nbsp;<span class="ident" id="4543032"><a href="/text/template/parse/parse.go.html#4541948">pipe</a></span><span class="op" id="4543036">,</span>&nbsp;<span class="ident" id="4543038"><a href="/text/template/parse/parse.go.html#4541964">list</a></span><span class="op" id="4543042">,</span>&nbsp;<span class="ident" id="4543044"><a href="/text/template/parse/parse.go.html#4541970">elseList</a></span><br>
<span class="lineno"></span><span class="op" id="4543053">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">465</span><span class="comment" id="4543056">//&nbsp;If:</span><br>
<span class="lineno"></span><span class="comment" id="4543063">//&nbsp;&nbsp;&nbsp;&nbsp{{if&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543099">//&nbsp;&nbsp;&nbsp;&nbsp{{if&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543153">//&nbsp;If&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="4543176">func</span>&nbsp;<span class="op" id="4543181">(</span><span class="ident" id="4543182">t</span>&nbsp;<span class="op" id="4543184">*</span><span class="ident" id="4543185"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4543189">)</span>&nbsp;<span class="ident" id="4543191">ifControl</span><span class="op" id="4543200">(</span><span class="op" id="4543201">)</span>&nbsp;<span class="ident" id="4543203"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4543208">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543211">return</span>&nbsp;<span class="ident" id="4543218"><a href="/text/template/parse/parse.go.html#4543182">t</a></span><span class="op" id="4543219">.</span><span class="ident" id="4543220">newIf</span><span class="op" id="4543225">(</span><span class="ident" id="4543226"><a href="/text/template/parse/parse.go.html#4543182">t</a></span><span class="op" id="4543227">.</span><span class="ident" id="4543228">parseControl</span><span class="op" id="4543240">(</span><span class="builtintype" id="4543241">true</span><span class="op" id="4543245">,</span>&nbsp;<span class="string" id="4543247">&#34;if&#34;</span><span class="op" id="4543251">)</span><span class="op" id="4543252">)</span><br>
<span class="lineno"></span><span class="op" id="4543254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4543257">//&nbsp;Range:</span><br>
<span class="lineno"></span><span class="comment" id="4543267">//&nbsp;&nbsp;&nbsp;&nbsp{{range&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno">475</span><span class="comment" id="4543306">//&nbsp;&nbsp;&nbsp;&nbsp{{range&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543363">//&nbsp;Range&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="4543389">func</span>&nbsp;<span class="op" id="4543394">(</span><span class="ident" id="4543395">t</span>&nbsp;<span class="op" id="4543397">*</span><span class="ident" id="4543398"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4543402">)</span>&nbsp;<span class="ident" id="4543404">rangeControl</span><span class="op" id="4543416">(</span><span class="op" id="4543417">)</span>&nbsp;<span class="ident" id="4543419"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4543424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543427">return</span>&nbsp;<span class="ident" id="4543434"><a href="/text/template/parse/parse.go.html#4543395">t</a></span><span class="op" id="4543435">.</span><span class="ident" id="4543436">newRange</span><span class="op" id="4543444">(</span><span class="ident" id="4543445"><a href="/text/template/parse/parse.go.html#4543395">t</a></span><span class="op" id="4543446">.</span><span class="ident" id="4543447">parseControl</span><span class="op" id="4543459">(</span><span class="builtintype" id="4543460">false</span><span class="op" id="4543465">,</span>&nbsp;<span class="string" id="4543467">&#34;range&#34;</span><span class="op" id="4543474">)</span><span class="op" id="4543475">)</span><br>
<span class="lineno"></span><span class="op" id="4543477">}</span><br>
<span class="lineno">480</span><br>
<span class="lineno"></span><span class="comment" id="4543480">//&nbsp;With:</span><br>
<span class="lineno"></span><span class="comment" id="4543489">//&nbsp;&nbsp;&nbsp;&nbsp{{with&nbsp;pipeline}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543527">//&nbsp;&nbsp;&nbsp;&nbsp{{with&nbsp;pipeline}}&nbsp;itemList&nbsp;{{else}}&nbsp;itemList&nbsp;{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543583">//&nbsp;If&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno">485</span><span class="keyword" id="4543606">func</span>&nbsp;<span class="op" id="4543611">(</span><span class="ident" id="4543612">t</span>&nbsp;<span class="op" id="4543614">*</span><span class="ident" id="4543615"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4543619">)</span>&nbsp;<span class="ident" id="4543621">withControl</span><span class="op" id="4543632">(</span><span class="op" id="4543633">)</span>&nbsp;<span class="ident" id="4543635"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4543640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543643">return</span>&nbsp;<span class="ident" id="4543650"><a href="/text/template/parse/parse.go.html#4543612">t</a></span><span class="op" id="4543651">.</span><span class="ident" id="4543652">newWith</span><span class="op" id="4543659">(</span><span class="ident" id="4543660"><a href="/text/template/parse/parse.go.html#4543612">t</a></span><span class="op" id="4543661">.</span><span class="ident" id="4543662">parseControl</span><span class="op" id="4543674">(</span><span class="builtintype" id="4543675">false</span><span class="op" id="4543680">,</span>&nbsp;<span class="string" id="4543682">&#34;with&#34;</span><span class="op" id="4543688">)</span><span class="op" id="4543689">)</span><br>
<span class="lineno"></span><span class="op" id="4543691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4543694">//&nbsp;End:</span><br>
<span class="lineno">490</span><span class="comment" id="4543702">//&nbsp;&nbsp;&nbsp;&nbsp{{end}}</span><br>
<span class="lineno"></span><span class="comment" id="4543713">//&nbsp;End&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="4543737">func</span>&nbsp;<span class="op" id="4543742">(</span><span class="ident" id="4543743">t</span>&nbsp;<span class="op" id="4543745">*</span><span class="ident" id="4543746"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4543750">)</span>&nbsp;<span class="ident" id="4543752">endControl</span><span class="op" id="4543762">(</span><span class="op" id="4543763">)</span>&nbsp;<span class="ident" id="4543765"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4543770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543773">return</span>&nbsp;<span class="ident" id="4543780"><a href="/text/template/parse/parse.go.html#4543743">t</a></span><span class="op" id="4543781">.</span><span class="ident" id="4543782">newEnd</span><span class="op" id="4543788">(</span><span class="ident" id="4543789"><a href="/text/template/parse/parse.go.html#4543743">t</a></span><span class="op" id="4543790">.</span><span class="ident" id="4543791">expect</span><span class="op" id="4543797">(</span><span class="ident" id="4543798"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span><span class="op" id="4543812">,</span>&nbsp;<span class="string" id="4543814">&#34;end&#34;</span><span class="op" id="4543819">)</span><span class="op" id="4543820">.</span><span class="ident" id="4543821">pos</span><span class="op" id="4543824">)</span><br>
<span class="lineno"></span><span class="op" id="4543826">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="comment" id="4543829">//&nbsp;Else:</span><br>
<span class="lineno"></span><span class="comment" id="4543838">//&nbsp;&nbsp;&nbsp;&nbsp{{else}}</span><br>
<span class="lineno"></span><span class="comment" id="4543850">//&nbsp;Else&nbsp;keyword&nbsp;is&nbsp;past.</span><br>
<span class="lineno"></span><span class="keyword" id="4543875">func</span>&nbsp;<span class="op" id="4543880">(</span><span class="ident" id="4543881">t</span>&nbsp;<span class="op" id="4543883">*</span><span class="ident" id="4543884"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4543888">)</span>&nbsp;<span class="ident" id="4543890">elseControl</span><span class="op" id="4543901">(</span><span class="op" id="4543902">)</span>&nbsp;<span class="ident" id="4543904"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4543909">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543912">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;&#34;else&nbsp;if&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543944">peek</span>&nbsp;<span class="op" id="4543949">:=</span>&nbsp;<span class="ident" id="4543952"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4543953">.</span><span class="ident" id="4543954">peekNonSpace</span><span class="op" id="4543966">(</span><span class="op" id="4543967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4543970">if</span>&nbsp;<span class="ident" id="4543973"><a href="/text/template/parse/parse.go.html#4543944">peek</a></span><span class="op" id="4543977">.</span><span class="ident" id="4543978">typ</span>&nbsp;<span class="op" id="4543982">==</span>&nbsp;<span class="ident" id="4543985"><a href="/text/template/parse/lex.go.html#4498197">itemIf</a></span>&nbsp;<span class="op" id="4543992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543996">//&nbsp;We&nbsp;see&nbsp;&#34;{{else&nbsp;if&nbsp;...&nbsp;&#34;&nbsp;but&nbsp;in&nbsp;effect&nbsp;rewrite&nbsp;it&nbsp;to&nbsp;{{else}}{{if&nbsp;...&nbsp;&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544073">return</span>&nbsp;<span class="ident" id="4544080"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4544081">.</span><span class="ident" id="4544082">newElse</span><span class="op" id="4544089">(</span><span class="ident" id="4544090"><a href="/text/template/parse/parse.go.html#4543944">peek</a></span><span class="op" id="4544094">.</span><span class="ident" id="4544095">pos</span><span class="op" id="4544098">,</span>&nbsp;<span class="ident" id="4544100"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4544101">.</span><span class="ident" id="4544102">lex</span><span class="op" id="4544105">.</span><span class="ident" id="4544106">lineNumber</span><span class="op" id="4544116">(</span><span class="op" id="4544117">)</span><span class="op" id="4544118">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4544121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544124">return</span>&nbsp;<span class="ident" id="4544131"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4544132">.</span><span class="ident" id="4544133">newElse</span><span class="op" id="4544140">(</span><span class="ident" id="4544141"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4544142">.</span><span class="ident" id="4544143">expect</span><span class="op" id="4544149">(</span><span class="ident" id="4544150"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span><span class="op" id="4544164">,</span>&nbsp;<span class="string" id="4544166">&#34;else&#34;</span><span class="op" id="4544172">)</span><span class="op" id="4544173">.</span><span class="ident" id="4544174">pos</span><span class="op" id="4544177">,</span>&nbsp;<span class="ident" id="4544179"><a href="/text/template/parse/parse.go.html#4543881">t</a></span><span class="op" id="4544180">.</span><span class="ident" id="4544181">lex</span><span class="op" id="4544184">.</span><span class="ident" id="4544185">lineNumber</span><span class="op" id="4544195">(</span><span class="op" id="4544196">)</span><span class="op" id="4544197">)</span><br>
<span class="lineno"></span><span class="op" id="4544199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4544202">//&nbsp;Template:</span><br>
<span class="lineno">510</span><span class="comment" id="4544215">//&nbsp;&nbsp;&nbsp;&nbsp{{template&nbsp;stringValue&nbsp;pipeline}}</span><br>
<span class="lineno"></span><span class="comment" id="4544252">//&nbsp;Template&nbsp;keyword&nbsp;is&nbsp;past.&nbsp;&nbsp;The&nbsp;name&nbsp;must&nbsp;be&nbsp;something&nbsp;that&nbsp;can&nbsp;evaluate</span><br>
<span class="lineno"></span><span class="comment" id="4544327">//&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4544343">func</span>&nbsp;<span class="op" id="4544348">(</span><span class="ident" id="4544349">t</span>&nbsp;<span class="op" id="4544351">*</span><span class="ident" id="4544352"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4544356">)</span>&nbsp;<span class="ident" id="4544358">templateControl</span><span class="op" id="4544373">(</span><span class="op" id="4544374">)</span>&nbsp;<span class="ident" id="4544376"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4544381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544384">var</span>&nbsp;<span class="ident" id="4544388">name</span>&nbsp;<span class="builtintype" id="4544393">string</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544401">token</span>&nbsp;<span class="op" id="4544407">:=</span>&nbsp;<span class="ident" id="4544410"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544411">.</span><span class="ident" id="4544412">nextNonSpace</span><span class="op" id="4544424">(</span><span class="op" id="4544425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544428">switch</span>&nbsp;<span class="ident" id="4544435"><a href="/text/template/parse/parse.go.html#4544401">token</a></span><span class="op" id="4544440">.</span><span class="ident" id="4544441">typ</span>&nbsp;<span class="op" id="4544445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544448">case</span>&nbsp;<span class="ident" id="4544453"><a href="/text/template/parse/lex.go.html#4497813">itemString</a></span><span class="op" id="4544463">,</span>&nbsp;<span class="ident" id="4544465"><a href="/text/template/parse/lex.go.html#4497625">itemRawString</a></span><span class="op" id="4544478">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544482">s</span><span class="op" id="4544483">,</span>&nbsp;<span class="ident" id="4544485">err</span>&nbsp;<span class="op" id="4544489">:=</span>&nbsp;<span class="ident" id="4544492"><a href="/text/template/parse/parse.go.html#4530918">strconv</a></span><span class="op" id="4544499">.</span><span class="ident" id="4544500">Unquote</span><span class="op" id="4544507">(</span><span class="ident" id="4544508"><a href="/text/template/parse/parse.go.html#4544401">token</a></span><span class="op" id="4544513">.</span><span class="ident" id="4544514">val</span><span class="op" id="4544517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544521">if</span>&nbsp;<span class="ident" id="4544524"><a href="/text/template/parse/parse.go.html#4544485">err</a></span>&nbsp;<span class="op" id="4544528">!=</span>&nbsp;<span class="ident" id="4544531">nil</span>&nbsp;<span class="op" id="4544535">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544540"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544541">.</span><span class="builtintype" id="4544542">error</span><span class="op" id="4544547">(</span><span class="ident" id="4544548"><a href="/text/template/parse/parse.go.html#4544485">err</a></span><span class="op" id="4544551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4544555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544559"><a href="/text/template/parse/parse.go.html#4544388">name</a></span>&nbsp;<span class="op" id="4544564">=</span>&nbsp;<span class="ident" id="4544566"><a href="/text/template/parse/parse.go.html#4544482">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544569">default</span><span class="op" id="4544576">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544580"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544581">.</span><span class="ident" id="4544582">unexpected</span><span class="op" id="4544592">(</span><span class="ident" id="4544593"><a href="/text/template/parse/parse.go.html#4544401">token</a></span><span class="op" id="4544598">,</span>&nbsp;<span class="string" id="4544600">&#34;template&nbsp;invocation&#34;</span><span class="op" id="4544621">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4544624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544627">var</span>&nbsp;<span class="ident" id="4544631">pipe</span>&nbsp;<span class="op" id="4544636">*</span><span class="ident" id="4544637"><a href="/text/template/parse/node.go.html#4513767">PipeNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544647">if</span>&nbsp;<span class="ident" id="4544650"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544651">.</span><span class="ident" id="4544652">nextNonSpace</span><span class="op" id="4544664">(</span><span class="op" id="4544665">)</span><span class="op" id="4544666">.</span><span class="ident" id="4544667">typ</span>&nbsp;<span class="op" id="4544671">!=</span>&nbsp;<span class="ident" id="4544674"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span>&nbsp;<span class="op" id="4544689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544693"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544694">.</span><span class="ident" id="4544695">backup</span><span class="op" id="4544701">(</span><span class="op" id="4544702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544706">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables;&nbsp;they&nbsp;persist&nbsp;until&nbsp;&#34;end&#34;.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544759"><a href="/text/template/parse/parse.go.html#4544631">pipe</a></span>&nbsp;<span class="op" id="4544764">=</span>&nbsp;<span class="ident" id="4544766"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544767">.</span><span class="ident" id="4544768">pipeline</span><span class="op" id="4544776">(</span><span class="string" id="4544777">&#34;template&#34;</span><span class="op" id="4544787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4544790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4544793">return</span>&nbsp;<span class="ident" id="4544800"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544801">.</span><span class="ident" id="4544802">newTemplate</span><span class="op" id="4544813">(</span><span class="ident" id="4544814"><a href="/text/template/parse/parse.go.html#4544401">token</a></span><span class="op" id="4544819">.</span><span class="ident" id="4544820">pos</span><span class="op" id="4544823">,</span>&nbsp;<span class="ident" id="4544825"><a href="/text/template/parse/parse.go.html#4544349">t</a></span><span class="op" id="4544826">.</span><span class="ident" id="4544827">lex</span><span class="op" id="4544830">.</span><span class="ident" id="4544831">lineNumber</span><span class="op" id="4544841">(</span><span class="op" id="4544842">)</span><span class="op" id="4544843">,</span>&nbsp;<span class="ident" id="4544845"><a href="/text/template/parse/parse.go.html#4544388">name</a></span><span class="op" id="4544849">,</span>&nbsp;<span class="ident" id="4544851"><a href="/text/template/parse/parse.go.html#4544631">pipe</a></span><span class="op" id="4544855">)</span><br>
<span class="lineno"></span><span class="op" id="4544857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="4544860">//&nbsp;command:</span><br>
<span class="lineno"></span><span class="comment" id="4544872">//&nbsp;&nbsp;&nbsp;&nbspoperand&nbsp;(space&nbsp;operand)*</span><br>
<span class="lineno"></span><span class="comment" id="4544900">//&nbsp;space-separated&nbsp;arguments&nbsp;up&nbsp;to&nbsp;a&nbsp;pipeline&nbsp;character&nbsp;or&nbsp;right&nbsp;delimiter.</span><br>
<span class="lineno"></span><span class="comment" id="4544976">//&nbsp;we&nbsp;consume&nbsp;the&nbsp;pipe&nbsp;character&nbsp;but&nbsp;leave&nbsp;the&nbsp;right&nbsp;delim&nbsp;to&nbsp;terminate&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4545060">func</span>&nbsp;<span class="op" id="4545065">(</span><span class="ident" id="4545066">t</span>&nbsp;<span class="op" id="4545068">*</span><span class="ident" id="4545069"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4545073">)</span>&nbsp;<span class="ident" id="4545075">command</span><span class="op" id="4545082">(</span><span class="op" id="4545083">)</span>&nbsp;<span class="op" id="4545085">*</span><span class="ident" id="4545086"><a href="/text/template/parse/node.go.html#4515798">CommandNode</a></span>&nbsp;<span class="op" id="4545098">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545101">cmd</span>&nbsp;<span class="op" id="4545105">:=</span>&nbsp;<span class="ident" id="4545108"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545109">.</span><span class="ident" id="4545110">newCommand</span><span class="op" id="4545120">(</span><span class="ident" id="4545121"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545122">.</span><span class="ident" id="4545123">peekNonSpace</span><span class="op" id="4545135">(</span><span class="op" id="4545136">)</span><span class="op" id="4545137">.</span><span class="ident" id="4545138">pos</span><span class="op" id="4545141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545144">for</span>&nbsp;<span class="op" id="4545148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545152"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545153">.</span><span class="ident" id="4545154">peekNonSpace</span><span class="op" id="4545166">(</span><span class="op" id="4545167">)</span>&nbsp;<span class="comment" id="4545169">//&nbsp;skip&nbsp;leading&nbsp;spaces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545195">operand</span>&nbsp;<span class="op" id="4545203">:=</span>&nbsp;<span class="ident" id="4545206"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545207">.</span><span class="ident" id="4545208">operand</span><span class="op" id="4545215">(</span><span class="op" id="4545216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545220">if</span>&nbsp;<span class="ident" id="4545223"><a href="/text/template/parse/parse.go.html#4545195">operand</a></span>&nbsp;<span class="op" id="4545231">!=</span>&nbsp;<span class="ident" id="4545234">nil</span>&nbsp;<span class="op" id="4545238">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545243"><a href="/text/template/parse/parse.go.html#4545101">cmd</a></span><span class="op" id="4545246">.</span><span class="builtinfunc" id="4545247">append</span><span class="op" id="4545253">(</span><span class="ident" id="4545254"><a href="/text/template/parse/parse.go.html#4545195">operand</a></span><span class="op" id="4545261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545269">switch</span>&nbsp;<span class="ident" id="4545276">token</span>&nbsp;<span class="op" id="4545282">:=</span>&nbsp;<span class="ident" id="4545285"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545286">.</span><span class="ident" id="4545287">next</span><span class="op" id="4545291">(</span><span class="op" id="4545292">)</span><span class="op" id="4545293">;</span>&nbsp;<span class="ident" id="4545295"><a href="/text/template/parse/parse.go.html#4545276">token</a></span><span class="op" id="4545300">.</span><span class="ident" id="4545301">typ</span>&nbsp;<span class="op" id="4545305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545309">case</span>&nbsp;<span class="ident" id="4545314"><a href="/text/template/parse/lex.go.html#4497759">itemSpace</a></span><span class="op" id="4545323">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545328">continue</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545339">case</span>&nbsp;<span class="ident" id="4545344"><a href="/text/template/parse/lex.go.html#4496881">itemError</a></span><span class="op" id="4545353">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545358"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545359">.</span><span class="ident" id="4545360">errorf</span><span class="op" id="4545366">(</span><span class="string" id="4545367">&#34;%s&#34;</span><span class="op" id="4545371">,</span>&nbsp;<span class="ident" id="4545373"><a href="/text/template/parse/parse.go.html#4545276">token</a></span><span class="op" id="4545378">.</span><span class="ident" id="4545379">val</span><span class="op" id="4545382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545386">case</span>&nbsp;<span class="ident" id="4545391"><a href="/text/template/parse/lex.go.html#4497680">itemRightDelim</a></span><span class="op" id="4545405">,</span>&nbsp;<span class="ident" id="4545407"><a href="/text/template/parse/lex.go.html#4497722">itemRightParen</a></span><span class="op" id="4545421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545426"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545427">.</span><span class="ident" id="4545428">backup</span><span class="op" id="4545434">(</span><span class="op" id="4545435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545439">case</span>&nbsp;<span class="ident" id="4545444"><a href="/text/template/parse/lex.go.html#4497594">itemPipe</a></span><span class="op" id="4545452">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545456">default</span><span class="op" id="4545463">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545468"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545469">.</span><span class="ident" id="4545470">errorf</span><span class="op" id="4545476">(</span><span class="string" id="4545477">&#34;unexpected&nbsp;%s&nbsp;in&nbsp;operand;&nbsp;missing&nbsp;space?&#34;</span><span class="op" id="4545519">,</span>&nbsp;<span class="ident" id="4545521"><a href="/text/template/parse/parse.go.html#4545276">token</a></span><span class="op" id="4545526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545534">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545541">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545544">if</span>&nbsp;<span class="builtinfunc" id="4545547">len</span><span class="op" id="4545550">(</span><span class="ident" id="4545551"><a href="/text/template/parse/parse.go.html#4545101">cmd</a></span><span class="op" id="4545554">.</span><span class="ident" id="4545555">Args</span><span class="op" id="4545559">)</span>&nbsp;<span class="op" id="4545561">==</span>&nbsp;<span class="num" id="4545564">0</span>&nbsp;<span class="op" id="4545566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545570"><a href="/text/template/parse/parse.go.html#4545066">t</a></span><span class="op" id="4545571">.</span><span class="ident" id="4545572">errorf</span><span class="op" id="4545578">(</span><span class="string" id="4545579">&#34;empty&nbsp;command&#34;</span><span class="op" id="4545594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545600">return</span>&nbsp;<span class="ident" id="4545607"><a href="/text/template/parse/parse.go.html#4545101">cmd</a></span><br>
<span class="lineno"></span><span class="op" id="4545611">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="comment" id="4545614">//&nbsp;operand:</span><br>
<span class="lineno"></span><span class="comment" id="4545626">//&nbsp;&nbsp;&nbsp;&nbspterm&nbsp;.Field*</span><br>
<span class="lineno"></span><span class="comment" id="4545642">//&nbsp;An&nbsp;operand&nbsp;is&nbsp;a&nbsp;space-separated&nbsp;component&nbsp;of&nbsp;a&nbsp;command,</span><br>
<span class="lineno"></span><span class="comment" id="4545701">//&nbsp;a&nbsp;term&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno">570</span><span class="comment" id="4545748">//&nbsp;A&nbsp;nil&nbsp;return&nbsp;means&nbsp;the&nbsp;next&nbsp;item&nbsp;is&nbsp;not&nbsp;an&nbsp;operand.</span><br>
<span class="lineno"></span><span class="keyword" id="4545803">func</span>&nbsp;<span class="op" id="4545808">(</span><span class="ident" id="4545809">t</span>&nbsp;<span class="op" id="4545811">*</span><span class="ident" id="4545812"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4545816">)</span>&nbsp;<span class="ident" id="4545818">operand</span><span class="op" id="4545825">(</span><span class="op" id="4545826">)</span>&nbsp;<span class="ident" id="4545828"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4545833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545836">node</span>&nbsp;<span class="op" id="4545841">:=</span>&nbsp;<span class="ident" id="4545844"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4545845">.</span><span class="ident" id="4545846">term</span><span class="op" id="4545850">(</span><span class="op" id="4545851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545854">if</span>&nbsp;<span class="ident" id="4545857"><a href="/text/template/parse/parse.go.html#4545836">node</a></span>&nbsp;<span class="op" id="4545862">==</span>&nbsp;<span class="ident" id="4545865">nil</span>&nbsp;<span class="op" id="4545869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545873">return</span>&nbsp;<span class="ident" id="4545880">nil</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545888">if</span>&nbsp;<span class="ident" id="4545891"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4545892">.</span><span class="ident" id="4545893">peek</span><span class="op" id="4545897">(</span><span class="op" id="4545898">)</span><span class="op" id="4545899">.</span><span class="ident" id="4545900">typ</span>&nbsp;<span class="op" id="4545904">==</span>&nbsp;<span class="ident" id="4545907"><a href="/text/template/parse/lex.go.html#4497336">itemField</a></span>&nbsp;<span class="op" id="4545917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545921">chain</span>&nbsp;<span class="op" id="4545927">:=</span>&nbsp;<span class="ident" id="4545930"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4545931">.</span><span class="ident" id="4545932">newChain</span><span class="op" id="4545940">(</span><span class="ident" id="4545941"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4545942">.</span><span class="ident" id="4545943">peek</span><span class="op" id="4545947">(</span><span class="op" id="4545948">)</span><span class="op" id="4545949">.</span><span class="ident" id="4545950">pos</span><span class="op" id="4545953">,</span>&nbsp;<span class="ident" id="4545955"><a href="/text/template/parse/parse.go.html#4545836">node</a></span><span class="op" id="4545959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545963">for</span>&nbsp;<span class="ident" id="4545967"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4545968">.</span><span class="ident" id="4545969">peek</span><span class="op" id="4545973">(</span><span class="op" id="4545974">)</span><span class="op" id="4545975">.</span><span class="ident" id="4545976">typ</span>&nbsp;<span class="op" id="4545980">==</span>&nbsp;<span class="ident" id="4545983"><a href="/text/template/parse/lex.go.html#4497336">itemField</a></span>&nbsp;<span class="op" id="4545993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545998"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><span class="op" id="4546003">.</span><span class="ident" id="4546004">Add</span><span class="op" id="4546007">(</span><span class="ident" id="4546008"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4546009">.</span><span class="ident" id="4546010">next</span><span class="op" id="4546014">(</span><span class="op" id="4546015">)</span><span class="op" id="4546016">.</span><span class="ident" id="4546017">val</span><span class="op" id="4546020">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546028">//&nbsp;Compatibility&nbsp;with&nbsp;original&nbsp;API:&nbsp;If&nbsp;the&nbsp;term&nbsp;is&nbsp;of&nbsp;type&nbsp;NodeField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546099">//&nbsp;or&nbsp;NodeVariable,&nbsp;just&nbsp;put&nbsp;more&nbsp;fields&nbsp;on&nbsp;the&nbsp;original.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546159">//&nbsp;Otherwise,&nbsp;keep&nbsp;the&nbsp;Chain&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546196">//&nbsp;TODO:&nbsp;Switch&nbsp;to&nbsp;Chains&nbsp;always&nbsp;when&nbsp;we&nbsp;can.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546244">switch</span>&nbsp;<span class="ident" id="4546251"><a href="/text/template/parse/parse.go.html#4545836">node</a></span><span class="op" id="4546255">.</span><span class="ident" id="4546256">Type</span><span class="op" id="4546260">(</span><span class="op" id="4546261">)</span>&nbsp;<span class="op" id="4546263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546267">case</span>&nbsp;<span class="ident" id="4546272"><a href="/text/template/parse/node.go.html#4511764">NodeField</a></span><span class="op" id="4546281">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546286"><a href="/text/template/parse/parse.go.html#4545836">node</a></span>&nbsp;<span class="op" id="4546291">=</span>&nbsp;<span class="ident" id="4546293"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4546294">.</span><span class="ident" id="4546295">newField</span><span class="op" id="4546303">(</span><span class="ident" id="4546304"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><span class="op" id="4546309">.</span><span class="ident" id="4546310">Position</span><span class="op" id="4546318">(</span><span class="op" id="4546319">)</span><span class="op" id="4546320">,</span>&nbsp;<span class="ident" id="4546322"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><span class="op" id="4546327">.</span><span class="ident" id="4546328">String</span><span class="op" id="4546334">(</span><span class="op" id="4546335">)</span><span class="op" id="4546336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546340">case</span>&nbsp;<span class="ident" id="4546345"><a href="/text/template/parse/node.go.html#4512344">NodeVariable</a></span><span class="op" id="4546357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546362"><a href="/text/template/parse/parse.go.html#4545836">node</a></span>&nbsp;<span class="op" id="4546367">=</span>&nbsp;<span class="ident" id="4546369"><a href="/text/template/parse/parse.go.html#4545809">t</a></span><span class="op" id="4546370">.</span><span class="ident" id="4546371">newVariable</span><span class="op" id="4546382">(</span><span class="ident" id="4546383"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><span class="op" id="4546388">.</span><span class="ident" id="4546389">Position</span><span class="op" id="4546397">(</span><span class="op" id="4546398">)</span><span class="op" id="4546399">,</span>&nbsp;<span class="ident" id="4546401"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><span class="op" id="4546406">.</span><span class="ident" id="4546407">String</span><span class="op" id="4546413">(</span><span class="op" id="4546414">)</span><span class="op" id="4546415">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546419">default</span><span class="op" id="4546426">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546431"><a href="/text/template/parse/parse.go.html#4545836">node</a></span>&nbsp;<span class="op" id="4546436">=</span>&nbsp;<span class="ident" id="4546438"><a href="/text/template/parse/parse.go.html#4545921">chain</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546446">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546452">return</span>&nbsp;<span class="ident" id="4546459"><a href="/text/template/parse/parse.go.html#4545836">node</a></span><br>
<span class="lineno">595</span><span class="op" id="4546464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4546467">//&nbsp;term:</span><br>
<span class="lineno"></span><span class="comment" id="4546476">//&nbsp;&nbsp;&nbsp;&nbspliteral&nbsp;(number,&nbsp;string,&nbsp;nil,&nbsp;boolean)</span><br>
<span class="lineno"></span><span class="comment" id="4546518">//&nbsp;&nbsp;&nbsp;&nbspfunction&nbsp;(identifier)</span><br>
<span class="lineno">600</span><span class="comment" id="4546543">//&nbsp;&nbsp;&nbsp;&nbsp.</span><br>
<span class="lineno"></span><span class="comment" id="4546548">//&nbsp;&nbsp;&nbsp;&nbsp.Field</span><br>
<span class="lineno"></span><span class="comment" id="4546558">//&nbsp;&nbsp;&nbsp;&nbsp$</span><br>
<span class="lineno"></span><span class="comment" id="4546563">//&nbsp;&nbsp;&nbsp;&nbsp&#39;(&#39;&nbsp;pipeline&nbsp;&#39;)&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4546583">//&nbsp;A&nbsp;term&nbsp;is&nbsp;a&nbsp;simple&nbsp;&#34;expression&#34;.</span><br>
<span class="lineno">605</span><span class="comment" id="4546619">//&nbsp;A&nbsp;nil&nbsp;return&nbsp;means&nbsp;the&nbsp;next&nbsp;item&nbsp;is&nbsp;not&nbsp;a&nbsp;term.</span><br>
<span class="lineno"></span><span class="keyword" id="4546670">func</span>&nbsp;<span class="op" id="4546675">(</span><span class="ident" id="4546676">t</span>&nbsp;<span class="op" id="4546678">*</span><span class="ident" id="4546679"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4546683">)</span>&nbsp;<span class="ident" id="4546685">term</span><span class="op" id="4546689">(</span><span class="op" id="4546690">)</span>&nbsp;<span class="ident" id="4546692"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4546697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546700">switch</span>&nbsp;<span class="ident" id="4546707">token</span>&nbsp;<span class="op" id="4546713">:=</span>&nbsp;<span class="ident" id="4546716"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546717">.</span><span class="ident" id="4546718">nextNonSpace</span><span class="op" id="4546730">(</span><span class="op" id="4546731">)</span><span class="op" id="4546732">;</span>&nbsp;<span class="ident" id="4546734"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546739">.</span><span class="ident" id="4546740">typ</span>&nbsp;<span class="op" id="4546744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546747">case</span>&nbsp;<span class="ident" id="4546752"><a href="/text/template/parse/lex.go.html#4496881">itemError</a></span><span class="op" id="4546761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546765"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546766">.</span><span class="ident" id="4546767">errorf</span><span class="op" id="4546773">(</span><span class="string" id="4546774">&#34;%s&#34;</span><span class="op" id="4546778">,</span>&nbsp;<span class="ident" id="4546780"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546785">.</span><span class="ident" id="4546786">val</span><span class="op" id="4546789">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546792">case</span>&nbsp;<span class="ident" id="4546797"><a href="/text/template/parse/lex.go.html#4497397">itemIdentifier</a></span><span class="op" id="4546811">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546815">if</span>&nbsp;<span class="op" id="4546818">!</span><span class="ident" id="4546819"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546820">.</span><span class="ident" id="4546821">hasFunction</span><span class="op" id="4546832">(</span><span class="ident" id="4546833"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546838">.</span><span class="ident" id="4546839">val</span><span class="op" id="4546842">)</span>&nbsp;<span class="op" id="4546844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546849"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546850">.</span><span class="ident" id="4546851">errorf</span><span class="op" id="4546857">(</span><span class="string" id="4546858">&#34;function&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="4546883">,</span>&nbsp;<span class="ident" id="4546885"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546890">.</span><span class="ident" id="4546891">val</span><span class="op" id="4546894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546902">return</span>&nbsp;<span class="ident" id="4546909"><a href="/text/template/parse/node.go.html#4516778">NewIdentifier</a></span><span class="op" id="4546922">(</span><span class="ident" id="4546923"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546928">.</span><span class="ident" id="4546929">val</span><span class="op" id="4546932">)</span><span class="op" id="4546933">.</span><span class="ident" id="4546934">SetTree</span><span class="op" id="4546941">(</span><span class="ident" id="4546942"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546943">)</span><span class="op" id="4546944">.</span><span class="ident" id="4546945">SetPos</span><span class="op" id="4546951">(</span><span class="ident" id="4546952"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4546957">.</span><span class="ident" id="4546958">pos</span><span class="op" id="4546961">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546964">case</span>&nbsp;<span class="ident" id="4546969"><a href="/text/template/parse/lex.go.html#4498065">itemDot</a></span><span class="op" id="4546976">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546980">return</span>&nbsp;<span class="ident" id="4546987"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4546988">.</span><span class="ident" id="4546989">newDot</span><span class="op" id="4546995">(</span><span class="ident" id="4546996"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547001">.</span><span class="ident" id="4547002">pos</span><span class="op" id="4547005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547008">case</span>&nbsp;<span class="ident" id="4547013"><a href="/text/template/parse/lex.go.html#4498225">itemNil</a></span><span class="op" id="4547020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547024">return</span>&nbsp;<span class="ident" id="4547031"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547032">.</span><span class="ident" id="4547033">newNil</span><span class="op" id="4547039">(</span><span class="ident" id="4547040"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547045">.</span><span class="ident" id="4547046">pos</span><span class="op" id="4547049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547052">case</span>&nbsp;<span class="ident" id="4547057"><a href="/text/template/parse/lex.go.html#4497894">itemVariable</a></span><span class="op" id="4547069">:</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547073">return</span>&nbsp;<span class="ident" id="4547080"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547081">.</span><span class="ident" id="4547082">useVar</span><span class="op" id="4547088">(</span><span class="ident" id="4547089"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547094">.</span><span class="ident" id="4547095">pos</span><span class="op" id="4547098">,</span>&nbsp;<span class="ident" id="4547100"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547105">.</span><span class="ident" id="4547106">val</span><span class="op" id="4547109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547112">case</span>&nbsp;<span class="ident" id="4547117"><a href="/text/template/parse/lex.go.html#4497336">itemField</a></span><span class="op" id="4547126">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547130">return</span>&nbsp;<span class="ident" id="4547137"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547138">.</span><span class="ident" id="4547139">newField</span><span class="op" id="4547147">(</span><span class="ident" id="4547148"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547153">.</span><span class="ident" id="4547154">pos</span><span class="op" id="4547157">,</span>&nbsp;<span class="ident" id="4547159"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547164">.</span><span class="ident" id="4547165">val</span><span class="op" id="4547168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547171">case</span>&nbsp;<span class="ident" id="4547176"><a href="/text/template/parse/lex.go.html#4496957">itemBool</a></span><span class="op" id="4547184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547188">return</span>&nbsp;<span class="ident" id="4547195"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547196">.</span><span class="ident" id="4547197">newBool</span><span class="op" id="4547204">(</span><span class="ident" id="4547205"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547210">.</span><span class="ident" id="4547211">pos</span><span class="op" id="4547214">,</span>&nbsp;<span class="ident" id="4547216"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547221">.</span><span class="ident" id="4547222">val</span>&nbsp;<span class="op" id="4547226">==</span>&nbsp;<span class="string" id="4547229">&#34;true&#34;</span><span class="op" id="4547235">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547238">case</span>&nbsp;<span class="ident" id="4547243"><a href="/text/template/parse/lex.go.html#4497099">itemCharConstant</a></span><span class="op" id="4547259">,</span>&nbsp;<span class="ident" id="4547261"><a href="/text/template/parse/lex.go.html#4497155">itemComplex</a></span><span class="op" id="4547272">,</span>&nbsp;<span class="ident" id="4547274"><a href="/text/template/parse/lex.go.html#4497540">itemNumber</a></span><span class="op" id="4547284">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547288">number</span><span class="op" id="4547294">,</span>&nbsp;<span class="ident" id="4547296">err</span>&nbsp;<span class="op" id="4547300">:=</span>&nbsp;<span class="ident" id="4547303"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547304">.</span><span class="ident" id="4547305">newNumber</span><span class="op" id="4547314">(</span><span class="ident" id="4547315"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547320">.</span><span class="ident" id="4547321">pos</span><span class="op" id="4547324">,</span>&nbsp;<span class="ident" id="4547326"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547331">.</span><span class="ident" id="4547332">val</span><span class="op" id="4547335">,</span>&nbsp;<span class="ident" id="4547337"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547342">.</span><span class="ident" id="4547343">typ</span><span class="op" id="4547346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547350">if</span>&nbsp;<span class="ident" id="4547353"><a href="/text/template/parse/parse.go.html#4547296">err</a></span>&nbsp;<span class="op" id="4547357">!=</span>&nbsp;<span class="ident" id="4547360">nil</span>&nbsp;<span class="op" id="4547364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547369"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547370">.</span><span class="builtintype" id="4547371">error</span><span class="op" id="4547376">(</span><span class="ident" id="4547377"><a href="/text/template/parse/parse.go.html#4547296">err</a></span><span class="op" id="4547380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547384">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547388">return</span>&nbsp;<span class="ident" id="4547395"><a href="/text/template/parse/parse.go.html#4547288">number</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547403">case</span>&nbsp;<span class="ident" id="4547408"><a href="/text/template/parse/lex.go.html#4497503">itemLeftParen</a></span><span class="op" id="4547421">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547425">pipe</span>&nbsp;<span class="op" id="4547430">:=</span>&nbsp;<span class="ident" id="4547433"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547434">.</span><span class="ident" id="4547435">pipeline</span><span class="op" id="4547443">(</span><span class="string" id="4547444">&#34;parenthesized&nbsp;pipeline&#34;</span><span class="op" id="4547468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547472">if</span>&nbsp;<span class="ident" id="4547475">token</span>&nbsp;<span class="op" id="4547481">:=</span>&nbsp;<span class="ident" id="4547484"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547485">.</span><span class="ident" id="4547486">next</span><span class="op" id="4547490">(</span><span class="op" id="4547491">)</span><span class="op" id="4547492">;</span>&nbsp;<span class="ident" id="4547494"><a href="/text/template/parse/parse.go.html#4547475">token</a></span><span class="op" id="4547499">.</span><span class="ident" id="4547500">typ</span>&nbsp;<span class="op" id="4547504">!=</span>&nbsp;<span class="ident" id="4547507"><a href="/text/template/parse/lex.go.html#4497722">itemRightParen</a></span>&nbsp;<span class="op" id="4547522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547527"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547528">.</span><span class="ident" id="4547529">errorf</span><span class="op" id="4547535">(</span><span class="string" id="4547536">&#34;unclosed&nbsp;right&nbsp;paren:&nbsp;unexpected&nbsp;%s&#34;</span><span class="op" id="4547573">,</span>&nbsp;<span class="ident" id="4547575"><a href="/text/template/parse/parse.go.html#4547475">token</a></span><span class="op" id="4547580">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547588">return</span>&nbsp;<span class="ident" id="4547595"><a href="/text/template/parse/parse.go.html#4547425">pipe</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547601">case</span>&nbsp;<span class="ident" id="4547606"><a href="/text/template/parse/lex.go.html#4497813">itemString</a></span><span class="op" id="4547616">,</span>&nbsp;<span class="ident" id="4547618"><a href="/text/template/parse/lex.go.html#4497625">itemRawString</a></span><span class="op" id="4547631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547635">s</span><span class="op" id="4547636">,</span>&nbsp;<span class="ident" id="4547638">err</span>&nbsp;<span class="op" id="4547642">:=</span>&nbsp;<span class="ident" id="4547645"><a href="/text/template/parse/parse.go.html#4530918">strconv</a></span><span class="op" id="4547652">.</span><span class="ident" id="4547653">Unquote</span><span class="op" id="4547660">(</span><span class="ident" id="4547661"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547666">.</span><span class="ident" id="4547667">val</span><span class="op" id="4547670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547674">if</span>&nbsp;<span class="ident" id="4547677"><a href="/text/template/parse/parse.go.html#4547638">err</a></span>&nbsp;<span class="op" id="4547681">!=</span>&nbsp;<span class="ident" id="4547684">nil</span>&nbsp;<span class="op" id="4547688">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547693"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547694">.</span><span class="builtintype" id="4547695">error</span><span class="op" id="4547700">(</span><span class="ident" id="4547701"><a href="/text/template/parse/parse.go.html#4547638">err</a></span><span class="op" id="4547704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547712">return</span>&nbsp;<span class="ident" id="4547719"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547720">.</span><span class="ident" id="4547721">newString</span><span class="op" id="4547730">(</span><span class="ident" id="4547731"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547736">.</span><span class="ident" id="4547737">pos</span><span class="op" id="4547740">,</span>&nbsp;<span class="ident" id="4547742"><a href="/text/template/parse/parse.go.html#4546707">token</a></span><span class="op" id="4547747">.</span><span class="ident" id="4547748">val</span><span class="op" id="4547751">,</span>&nbsp;<span class="ident" id="4547753"><a href="/text/template/parse/parse.go.html#4547635">s</a></span><span class="op" id="4547754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547760"><a href="/text/template/parse/parse.go.html#4546676">t</a></span><span class="op" id="4547761">.</span><span class="ident" id="4547762">backup</span><span class="op" id="4547768">(</span><span class="op" id="4547769">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547772">return</span>&nbsp;<span class="ident" id="4547779">nil</span><br>
<span class="lineno"></span><span class="op" id="4547783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4547786">//&nbsp;hasFunction&nbsp;reports&nbsp;if&nbsp;a&nbsp;function&nbsp;name&nbsp;exists&nbsp;in&nbsp;the&nbsp;Tree&#39;s&nbsp;maps.</span><br>
<span class="lineno"></span><span class="keyword" id="4547855">func</span>&nbsp;<span class="op" id="4547860">(</span><span class="ident" id="4547861">t</span>&nbsp;<span class="op" id="4547863">*</span><span class="ident" id="4547864"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4547868">)</span>&nbsp;<span class="ident" id="4547870">hasFunction</span><span class="op" id="4547881">(</span><span class="ident" id="4547882">name</span>&nbsp;<span class="builtintype" id="4547887">string</span><span class="op" id="4547893">)</span>&nbsp;<span class="builtintype" id="4547895">bool</span>&nbsp;<span class="op" id="4547900">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547903">for</span>&nbsp;<span class="ident" id="4547907">_</span><span class="op" id="4547908">,</span>&nbsp;<span class="ident" id="4547910">funcMap</span>&nbsp;<span class="op" id="4547918">:=</span>&nbsp;<span class="keyword" id="4547921">range</span>&nbsp;<span class="ident" id="4547927"><a href="/text/template/parse/parse.go.html#4547861">t</a></span><span class="op" id="4547928">.</span><span class="ident" id="4547929">funcs</span>&nbsp;<span class="op" id="4547935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547939">if</span>&nbsp;<span class="ident" id="4547942"><a href="/text/template/parse/parse.go.html#4547910">funcMap</a></span>&nbsp;<span class="op" id="4547950">==</span>&nbsp;<span class="ident" id="4547953">nil</span>&nbsp;<span class="op" id="4547957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547962">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547973">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547977">if</span>&nbsp;<span class="ident" id="4547980"><a href="/text/template/parse/parse.go.html#4547910">funcMap</a></span><span class="op" id="4547987">[</span><span class="ident" id="4547988"><a href="/text/template/parse/parse.go.html#4547882">name</a></span><span class="op" id="4547992">]</span>&nbsp;<span class="op" id="4547994">!=</span>&nbsp;<span class="ident" id="4547997">nil</span>&nbsp;<span class="op" id="4548001">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548006">return</span>&nbsp;<span class="builtintype" id="4548013">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4548020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4548023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548026">return</span>&nbsp;<span class="builtintype" id="4548033">false</span><br>
<span class="lineno"></span><span class="op" id="4548039">}</span><br>
<span class="lineno">660</span><br>
<span class="lineno"></span><span class="comment" id="4548042">//&nbsp;popVars&nbsp;trims&nbsp;the&nbsp;variable&nbsp;list&nbsp;to&nbsp;the&nbsp;specified&nbsp;length</span><br>
<span class="lineno"></span><span class="keyword" id="4548101">func</span>&nbsp;<span class="op" id="4548106">(</span><span class="ident" id="4548107">t</span>&nbsp;<span class="op" id="4548109">*</span><span class="ident" id="4548110"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4548114">)</span>&nbsp;<span class="ident" id="4548116">popVars</span><span class="op" id="4548123">(</span><span class="ident" id="4548124">n</span>&nbsp;<span class="builtintype" id="4548126">int</span><span class="op" id="4548129">)</span>&nbsp;<span class="op" id="4548131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548134"><a href="/text/template/parse/parse.go.html#4548107">t</a></span><span class="op" id="4548135">.</span><span class="ident" id="4548136">vars</span>&nbsp;<span class="op" id="4548141">=</span>&nbsp;<span class="ident" id="4548143"><a href="/text/template/parse/parse.go.html#4548107">t</a></span><span class="op" id="4548144">.</span><span class="ident" id="4548145">vars</span><span class="op" id="4548149">[</span><span class="op" id="4548150">:</span><span class="ident" id="4548151"><a href="/text/template/parse/parse.go.html#4548124">n</a></span><span class="op" id="4548152">]</span><br>
<span class="lineno"></span><span class="op" id="4548154">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="comment" id="4548157">//&nbsp;useVar&nbsp;returns&nbsp;a&nbsp;node&nbsp;for&nbsp;a&nbsp;variable&nbsp;reference.&nbsp;It&nbsp;errors&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4548225">//&nbsp;variable&nbsp;is&nbsp;not&nbsp;defined.</span><br>
<span class="lineno"></span><span class="keyword" id="4548253">func</span>&nbsp;<span class="op" id="4548258">(</span><span class="ident" id="4548259">t</span>&nbsp;<span class="op" id="4548261">*</span><span class="ident" id="4548262"><a href="/text/template/parse/parse.go.html#4531006">Tree</a></span><span class="op" id="4548266">)</span>&nbsp;<span class="ident" id="4548268">useVar</span><span class="op" id="4548274">(</span><span class="ident" id="4548275">pos</span>&nbsp;<span class="ident" id="4548279"><a href="/text/template/parse/node.go.html#4511021">Pos</a></span><span class="op" id="4548282">,</span>&nbsp;<span class="ident" id="4548284">name</span>&nbsp;<span class="builtintype" id="4548289">string</span><span class="op" id="4548295">)</span>&nbsp;<span class="ident" id="4548297"><a href="/text/template/parse/node.go.html#4510399">Node</a></span>&nbsp;<span class="op" id="4548302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548305">v</span>&nbsp;<span class="op" id="4548307">:=</span>&nbsp;<span class="ident" id="4548310"><a href="/text/template/parse/parse.go.html#4548259">t</a></span><span class="op" id="4548311">.</span><span class="ident" id="4548312">newVariable</span><span class="op" id="4548323">(</span><span class="ident" id="4548324"><a href="/text/template/parse/parse.go.html#4548275">pos</a></span><span class="op" id="4548327">,</span>&nbsp;<span class="ident" id="4548329"><a href="/text/template/parse/parse.go.html#4548284">name</a></span><span class="op" id="4548333">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548336">for</span>&nbsp;<span class="ident" id="4548340">_</span><span class="op" id="4548341">,</span>&nbsp;<span class="ident" id="4548343">varName</span>&nbsp;<span class="op" id="4548351">:=</span>&nbsp;<span class="keyword" id="4548354">range</span>&nbsp;<span class="ident" id="4548360"><a href="/text/template/parse/parse.go.html#4548259">t</a></span><span class="op" id="4548361">.</span><span class="ident" id="4548362">vars</span>&nbsp;<span class="op" id="4548367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548371">if</span>&nbsp;<span class="ident" id="4548374"><a href="/text/template/parse/parse.go.html#4548343">varName</a></span>&nbsp;<span class="op" id="4548382">==</span>&nbsp;<span class="ident" id="4548385"><a href="/text/template/parse/parse.go.html#4548305">v</a></span><span class="op" id="4548386">.</span><span class="ident" id="4548387">Ident</span><span class="op" id="4548392">[</span><span class="num" id="4548393">0</span><span class="op" id="4548394">]</span>&nbsp;<span class="op" id="4548396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548401">return</span>&nbsp;<span class="ident" id="4548408"><a href="/text/template/parse/parse.go.html#4548305">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4548412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4548415">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548418"><a href="/text/template/parse/parse.go.html#4548259">t</a></span><span class="op" id="4548419">.</span><span class="ident" id="4548420">errorf</span><span class="op" id="4548426">(</span><span class="string" id="4548427">&#34;undefined&nbsp;variable&nbsp;%q&#34;</span><span class="op" id="4548450">,</span>&nbsp;<span class="ident" id="4548452"><a href="/text/template/parse/parse.go.html#4548305">v</a></span><span class="op" id="4548453">.</span><span class="ident" id="4548454">Ident</span><span class="op" id="4548459">[</span><span class="num" id="4548460">0</span><span class="op" id="4548461">]</span><span class="op" id="4548462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548465">return</span>&nbsp;<span class="ident" id="4548472">nil</span><br>
<span class="lineno"></span><span class="op" id="4548476">}</span>
</div>
</body>
</html>
