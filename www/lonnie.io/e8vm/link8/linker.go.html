<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5848166">package</span>&nbsp;<span class="ident" id="5848174">link8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848181">//&nbsp;Linker&nbsp;provides&nbsp;the&nbsp;framework&nbsp;to&nbsp;link&nbsp;packages&nbsp;together.</span><br>
<span class="lineno"></span><span class="keyword" id="5848241">type</span>&nbsp;<span class="ident" id="5848246">Linker</span>&nbsp;<span class="keyword" id="5848253">struct</span>&nbsp;<span class="op" id="5848260">{</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848263">pkgs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5848272">[</span><span class="op" id="5848273">]</span><span class="op" id="5848274">*</span><span class="ident" id="5848275">Package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848284">pkgIndex</span>&nbsp;<span class="keyword" id="5848293">map</span><span class="op" id="5848296">[</span><span class="builtintype" id="5848297">string</span><span class="op" id="5848303">]</span><span class="builtintype" id="5848304">int</span><br>
<span class="lineno"></span><span class="op" id="5848308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848311">//&nbsp;NewLinker&nbsp;creates&nbsp;a&nbsp;new&nbsp;linker&nbsp;with&nbsp;no&nbsp;packages.</span><br>
<span class="lineno">10</span><span class="keyword" id="5848363">func</span>&nbsp;<span class="ident" id="5848368">NewLinker</span><span class="op" id="5848377">(</span><span class="op" id="5848378">)</span>&nbsp;<span class="op" id="5848380">*</span><span class="ident" id="5848381">Linker</span>&nbsp;<span class="op" id="5848388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848391">ret</span>&nbsp;<span class="op" id="5848395">:=</span>&nbsp;<span class="builtinfunc" id="5848398">new</span><span class="op" id="5848401">(</span><span class="ident" id="5848402">Linker</span><span class="op" id="5848408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848411">ret</span><span class="op" id="5848414">.</span><span class="ident" id="5848415">pkgIndex</span>&nbsp;<span class="op" id="5848424">=</span>&nbsp;<span class="builtinfunc" id="5848426">make</span><span class="op" id="5848430">(</span><span class="keyword" id="5848431">map</span><span class="op" id="5848434">[</span><span class="builtintype" id="5848435">string</span><span class="op" id="5848441">]</span><span class="builtintype" id="5848442">int</span><span class="op" id="5848445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848448">return</span>&nbsp;<span class="ident" id="5848455">ret</span><br>
<span class="lineno"></span><span class="op" id="5848459">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="5848462">//&nbsp;AddPkg&nbsp;adds&nbsp;a&nbsp;package&nbsp;into&nbsp;the&nbsp;linker.</span><br>
<span class="lineno"></span><span class="comment" id="5848504">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;package&nbsp;and&nbsp;if&nbsp;the&nbsp;package</span><br>
<span class="lineno"></span><span class="comment" id="5848562">//&nbsp;is&nbsp;new.</span><br>
<span class="lineno"></span><span class="keyword" id="5848573">func</span>&nbsp;<span class="op" id="5848578">(</span><span class="ident" id="5848579">lnk</span>&nbsp;<span class="op" id="5848583">*</span><span class="ident" id="5848584">Linker</span><span class="op" id="5848590">)</span>&nbsp;<span class="ident" id="5848592">AddPkg</span><span class="op" id="5848598">(</span><span class="ident" id="5848599">p</span>&nbsp;<span class="op" id="5848601">*</span><span class="ident" id="5848602">Package</span><span class="op" id="5848609">)</span>&nbsp;<span class="op" id="5848611">(</span><span class="ident" id="5848612">index</span>&nbsp;<span class="builtintype" id="5848618">int</span><span class="op" id="5848621">,</span>&nbsp;<span class="ident" id="5848623">isNew</span>&nbsp;<span class="builtintype" id="5848629">bool</span><span class="op" id="5848633">)</span>&nbsp;<span class="op" id="5848635">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848638">path</span>&nbsp;<span class="op" id="5848643">:=</span>&nbsp;<span class="ident" id="5848646">p</span><span class="op" id="5848647">.</span><span class="ident" id="5848648">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848654">index</span><span class="op" id="5848659">,</span>&nbsp;<span class="ident" id="5848661">found</span>&nbsp;<span class="op" id="5848667">:=</span>&nbsp;<span class="ident" id="5848670">lnk</span><span class="op" id="5848673">.</span><span class="ident" id="5848674">pkgIndex</span><span class="op" id="5848682">[</span><span class="ident" id="5848683">path</span><span class="op" id="5848687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848690">if</span>&nbsp;<span class="ident" id="5848693">found</span>&nbsp;<span class="op" id="5848699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848703">return</span>&nbsp;<span class="ident" id="5848710">index</span><span class="op" id="5848715">,</span>&nbsp;<span class="ident" id="5848717">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5848724">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848728">index</span>&nbsp;<span class="op" id="5848734">=</span>&nbsp;<span class="builtinfunc" id="5848736">len</span><span class="op" id="5848739">(</span><span class="ident" id="5848740">lnk</span><span class="op" id="5848743">.</span><span class="ident" id="5848744">pkgs</span><span class="op" id="5848748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848751">lnk</span><span class="op" id="5848754">.</span><span class="ident" id="5848755">pkgs</span>&nbsp;<span class="op" id="5848760">=</span>&nbsp;<span class="builtinfunc" id="5848762">append</span><span class="op" id="5848768">(</span><span class="ident" id="5848769">lnk</span><span class="op" id="5848772">.</span><span class="ident" id="5848773">pkgs</span><span class="op" id="5848777">,</span>&nbsp;<span class="ident" id="5848779">p</span><span class="op" id="5848780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848783">lnk</span><span class="op" id="5848786">.</span><span class="ident" id="5848787">pkgIndex</span><span class="op" id="5848795">[</span><span class="ident" id="5848796">path</span><span class="op" id="5848800">]</span>&nbsp;<span class="op" id="5848802">=</span>&nbsp;<span class="ident" id="5848804">index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5848811">return</span>&nbsp;<span class="ident" id="5848818">index</span><span class="op" id="5848823">,</span>&nbsp;<span class="ident" id="5848825">true</span><br>
<span class="lineno">30</span><span class="op" id="5848830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5848833">//&nbsp;AddPkgs&nbsp;adds&nbsp;the&nbsp;package&nbsp;and&nbsp;recursively&nbsp;adds&nbsp;the&nbsp;packages</span><br>
<span class="lineno"></span><span class="comment" id="5848895">//&nbsp;it&nbsp;requires.&nbsp;It&nbsp;returns&nbsp;the&nbsp;package&nbsp;index.</span><br>
<span class="lineno"></span><span class="keyword" id="5848941">func</span>&nbsp;<span class="op" id="5848946">(</span><span class="ident" id="5848947">lnk</span>&nbsp;<span class="op" id="5848951">*</span><span class="ident" id="5848952">Linker</span><span class="op" id="5848958">)</span>&nbsp;<span class="ident" id="5848960">AddPkgs</span><span class="op" id="5848967">(</span><span class="ident" id="5848968">p</span>&nbsp;<span class="op" id="5848970">*</span><span class="ident" id="5848971">Package</span><span class="op" id="5848978">)</span>&nbsp;<span class="builtintype" id="5848980">int</span>&nbsp;<span class="op" id="5848984">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5848987">index</span><span class="op" id="5848992">,</span>&nbsp;<span class="ident" id="5848994">isNew</span>&nbsp;<span class="op" id="5849000">:=</span>&nbsp;<span class="ident" id="5849003">lnk</span><span class="op" id="5849006">.</span><span class="ident" id="5849007">AddPkg</span><span class="op" id="5849013">(</span><span class="ident" id="5849014">p</span><span class="op" id="5849015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849018">if</span>&nbsp;<span class="ident" id="5849021">isNew</span>&nbsp;<span class="op" id="5849027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849031">for</span>&nbsp;<span class="ident" id="5849035">_</span><span class="op" id="5849036">,</span>&nbsp;<span class="ident" id="5849038">req</span>&nbsp;<span class="op" id="5849042">:=</span>&nbsp;<span class="keyword" id="5849045">range</span>&nbsp;<span class="ident" id="5849051">p</span><span class="op" id="5849052">.</span><span class="ident" id="5849053">requires</span>&nbsp;<span class="op" id="5849062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849067">lnk</span><span class="op" id="5849070">.</span><span class="ident" id="5849071">AddPkgs</span><span class="op" id="5849078">(</span><span class="ident" id="5849079">req</span><span class="op" id="5849082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849086">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849093">return</span>&nbsp;<span class="ident" id="5849100">index</span><br>
<span class="lineno"></span><span class="op" id="5849106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5849109">//&nbsp;PkgIndex&nbsp;returns&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;particular&nbsp;package.</span><br>
<span class="lineno"></span><span class="keyword" id="5849166">func</span>&nbsp;<span class="op" id="5849171">(</span><span class="ident" id="5849172">lnk</span>&nbsp;<span class="op" id="5849176">*</span><span class="ident" id="5849177">Linker</span><span class="op" id="5849183">)</span>&nbsp;<span class="ident" id="5849185">PkgIndex</span><span class="op" id="5849193">(</span><span class="ident" id="5849194">path</span>&nbsp;<span class="builtintype" id="5849199">string</span><span class="op" id="5849205">)</span>&nbsp;<span class="builtintype" id="5849207">int</span>&nbsp;<span class="op" id="5849211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5849214">ret</span><span class="op" id="5849217">,</span>&nbsp;<span class="ident" id="5849219">found</span>&nbsp;<span class="op" id="5849225">:=</span>&nbsp;<span class="ident" id="5849228">lnk</span><span class="op" id="5849231">.</span><span class="ident" id="5849232">pkgIndex</span><span class="op" id="5849240">[</span><span class="ident" id="5849241">path</span><span class="op" id="5849245">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849248">if</span>&nbsp;<span class="op" id="5849251">!</span><span class="ident" id="5849252">found</span>&nbsp;<span class="op" id="5849258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5849262">panic</span><span class="op" id="5849267">(</span><span class="string" id="5849268">&#34;not&nbsp;found&#34;</span><span class="op" id="5849279">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5849282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849285">return</span>&nbsp;<span class="ident" id="5849292">ret</span><br>
<span class="lineno"></span><span class="op" id="5849296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5849299">//&nbsp;Pkg&nbsp;returns&nbsp;the&nbsp;package&nbsp;of&nbsp;index&nbsp;i.</span><br>
<span class="lineno">55</span><span class="keyword" id="5849338">func</span>&nbsp;<span class="op" id="5849343">(</span><span class="ident" id="5849344">lnk</span>&nbsp;<span class="op" id="5849348">*</span><span class="ident" id="5849349">Linker</span><span class="op" id="5849355">)</span>&nbsp;<span class="ident" id="5849357">Pkg</span><span class="op" id="5849360">(</span><span class="ident" id="5849361">i</span>&nbsp;<span class="builtintype" id="5849363">int</span><span class="op" id="5849366">)</span>&nbsp;<span class="op" id="5849368">*</span><span class="ident" id="5849369">Package</span>&nbsp;<span class="op" id="5849377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849380">return</span>&nbsp;<span class="ident" id="5849387">lnk</span><span class="op" id="5849390">.</span><span class="ident" id="5849391">pkgs</span><span class="op" id="5849395">[</span><span class="ident" id="5849396">i</span><span class="op" id="5849397">]</span><br>
<span class="lineno"></span><span class="op" id="5849399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5849402">//&nbsp;Npkg&nbsp;retunrs&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;packages.</span><br>
<span class="lineno">60</span><span class="keyword" id="5849448">func</span>&nbsp;<span class="op" id="5849453">(</span><span class="ident" id="5849454">lnk</span>&nbsp;<span class="op" id="5849458">*</span><span class="ident" id="5849459">Linker</span><span class="op" id="5849465">)</span>&nbsp;<span class="ident" id="5849467">Npkg</span><span class="op" id="5849471">(</span><span class="op" id="5849472">)</span>&nbsp;<span class="builtintype" id="5849474">int</span>&nbsp;<span class="op" id="5849478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5849481">return</span>&nbsp;<span class="builtinfunc" id="5849488">len</span><span class="op" id="5849491">(</span><span class="ident" id="5849492">lnk</span><span class="op" id="5849495">.</span><span class="ident" id="5849496">pkgs</span><span class="op" id="5849500">)</span><br>
<span class="lineno"></span><span class="op" id="5849502">}</span>
</div>
</body>
</html>
