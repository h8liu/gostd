<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html" class="current">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3609443">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3609499">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3609553">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3609604">package</span>&nbsp;<span class="ident" id="3609612">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3609620">import</span>&nbsp;<span class="op" id="3609627">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3609630">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3609638">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3609649">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3609660">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3609675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3609678">//&nbsp;An&nbsp;Error&nbsp;describes&nbsp;a&nbsp;failure&nbsp;to&nbsp;parse&nbsp;a&nbsp;regular&nbsp;expression</span><br>
<span class="lineno">15</span><span class="comment" id="3609740">//&nbsp;and&nbsp;gives&nbsp;the&nbsp;offending&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="3609779">type</span>&nbsp;<span class="ident" id="3609784">Error</span>&nbsp;<span class="keyword" id="3609790">struct</span>&nbsp;<span class="op" id="3609797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609800">Code</span>&nbsp;<span class="ident" id="3609805"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3609816">Expr</span>&nbsp;<span class="builtintype" id="3609821">string</span><br>
<span class="lineno"></span><span class="op" id="3609828">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3609831">func</span>&nbsp;<span class="op" id="3609836">(</span><span class="ident" id="3609837">e</span>&nbsp;<span class="op" id="3609839">*</span><span class="ident" id="3609840"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3609845">)</span>&nbsp;<span class="ident" id="3609847">Error</span><span class="op" id="3609852">(</span><span class="op" id="3609853">)</span>&nbsp;<span class="builtintype" id="3609855">string</span>&nbsp;<span class="op" id="3609862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3609865">return</span>&nbsp;<span class="string" id="3609872">&#34;error&nbsp;parsing&nbsp;regexp:&nbsp;&#34;</span>&nbsp;<span class="op" id="3609897">+</span>&nbsp;<span class="ident" id="3609899"><a href="/gostd/regexp/syntax/parse.go.html#3609837">e</a></span><span class="op" id="3609900">.</span><span class="ident" id="3609901"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3609905">.</span><span class="ident" id="3609906"><a href="/gostd/regexp/syntax/parse.go.html#3611016">String</a></span><span class="op" id="3609912">(</span><span class="op" id="3609913">)</span>&nbsp;<span class="op" id="3609915">+</span>&nbsp;<span class="string" id="3609917">&#34;:&nbsp;`&#34;</span>&nbsp;<span class="op" id="3609923">+</span>&nbsp;<span class="ident" id="3609925"><a href="/gostd/regexp/syntax/parse.go.html#3609837">e</a></span><span class="op" id="3609926">.</span><span class="ident" id="3609927"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span>&nbsp;<span class="op" id="3609932">+</span>&nbsp;<span class="string" id="3609934">&#34;`&#34;</span><br>
<span class="lineno"></span><span class="op" id="3609938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3609941">//&nbsp;An&nbsp;ErrorCode&nbsp;describes&nbsp;a&nbsp;failure&nbsp;to&nbsp;parse&nbsp;a&nbsp;regular&nbsp;expression.</span><br>
<span class="lineno"></span><span class="keyword" id="3610008">type</span>&nbsp;<span class="ident" id="3610013">ErrorCode</span>&nbsp;<span class="builtintype" id="3610023">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3610031">const</span>&nbsp;<span class="op" id="3610037">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3610040">//&nbsp;Unexpected&nbsp;error</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610061">ErrInternalError</span>&nbsp;<span class="ident" id="3610078"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610088">=</span>&nbsp;<span class="string" id="3610090">&#34;regexp/syntax:&nbsp;internal&nbsp;error&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3610124">//&nbsp;Parse&nbsp;errors</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610141">ErrInvalidCharClass</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610166"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610176">=</span>&nbsp;<span class="string" id="3610178">&#34;invalid&nbsp;character&nbsp;class&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610205">ErrInvalidCharRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610230"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610240">=</span>&nbsp;<span class="string" id="3610242">&#34;invalid&nbsp;character&nbsp;class&nbsp;range&#34;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610275">ErrInvalidEscape</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610300"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610310">=</span>&nbsp;<span class="string" id="3610312">&#34;invalid&nbsp;escape&nbsp;sequence&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610339">ErrInvalidNamedCapture</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3610364"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610374">=</span>&nbsp;<span class="string" id="3610376">&#34;invalid&nbsp;named&nbsp;capture&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610401">ErrInvalidPerlOp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610426"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610436">=</span>&nbsp;<span class="string" id="3610438">&#34;invalid&nbsp;or&nbsp;unsupported&nbsp;Perl&nbsp;syntax&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610476">ErrInvalidRepeatOp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610501"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610511">=</span>&nbsp;<span class="string" id="3610513">&#34;invalid&nbsp;nested&nbsp;repetition&nbsp;operator&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610551">ErrInvalidRepeatSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610576"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610586">=</span>&nbsp;<span class="string" id="3610588">&#34;invalid&nbsp;repeat&nbsp;count&#34;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610612">ErrInvalidUTF8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610637"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610647">=</span>&nbsp;<span class="string" id="3610649">&#34;invalid&nbsp;UTF-8&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610666">ErrMissingBracket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610691"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610701">=</span>&nbsp;<span class="string" id="3610703">&#34;missing&nbsp;closing&nbsp;]&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610724">ErrMissingParen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610749"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610759">=</span>&nbsp;<span class="string" id="3610761">&#34;missing&nbsp;closing&nbsp;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610782">ErrMissingRepeatArgument</span>&nbsp;<span class="ident" id="3610807"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610817">=</span>&nbsp;<span class="string" id="3610819">&#34;missing&nbsp;argument&nbsp;to&nbsp;repetition&nbsp;operator&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610862">ErrTrailingBackslash</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610887"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610897">=</span>&nbsp;<span class="string" id="3610899">&#34;trailing&nbsp;backslash&nbsp;at&nbsp;end&nbsp;of&nbsp;expression&#34;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610942">ErrUnexpectedParen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3610967"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span>&nbsp;<span class="op" id="3610977">=</span>&nbsp;<span class="string" id="3610979">&#34;unexpected&nbsp;)&#34;</span><br>
<span class="lineno"></span><span class="op" id="3610994">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3610997">func</span>&nbsp;<span class="op" id="3611002">(</span><span class="ident" id="3611003">e</span>&nbsp;<span class="ident" id="3611005"><a href="/gostd/regexp/syntax/parse.go.html#3610013">ErrorCode</a></span><span class="op" id="3611014">)</span>&nbsp;<span class="ident" id="3611016">String</span><span class="op" id="3611022">(</span><span class="op" id="3611023">)</span>&nbsp;<span class="builtintype" id="3611025">string</span>&nbsp;<span class="op" id="3611032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3611035">return</span>&nbsp;<span class="builtintype" id="3611042">string</span><span class="op" id="3611048">(</span><span class="ident" id="3611049"><a href="/gostd/regexp/syntax/parse.go.html#3611003">e</a></span><span class="op" id="3611050">)</span><br>
<span class="lineno">50</span><span class="op" id="3611052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3611055">//&nbsp;Flags&nbsp;control&nbsp;the&nbsp;behavior&nbsp;of&nbsp;the&nbsp;parser&nbsp;and&nbsp;record&nbsp;information&nbsp;about&nbsp;regexp&nbsp;context.</span><br>
<span class="lineno"></span><span class="keyword" id="3611144">type</span>&nbsp;<span class="ident" id="3611149">Flags</span>&nbsp;<span class="builtintype" id="3611155">uint16</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="3611163">const</span>&nbsp;<span class="op" id="3611169">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611172">FoldCase</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611186"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span>&nbsp;<span class="op" id="3611192">=</span>&nbsp;<span class="num" id="3611194">1</span>&nbsp;<span class="op" id="3611196">&lt;&lt;</span>&nbsp;<span class="ident" id="3611199">iota</span>&nbsp;<span class="comment" id="3611204">//&nbsp;case-insensitive&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611231">Literal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611263">//&nbsp;treat&nbsp;pattern&nbsp;as&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611299">ClassNL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611331">//&nbsp;allow&nbsp;character&nbsp;classes&nbsp;like&nbsp;[^a-z]&nbsp;and&nbsp;[[:space:]]&nbsp;to&nbsp;match&nbsp;newline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611404">DotNL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611436">//&nbsp;allow&nbsp;.&nbsp;to&nbsp;match&nbsp;newline</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611465">OneLine</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611497">//&nbsp;treat&nbsp;^&nbsp;and&nbsp;$&nbsp;as&nbsp;only&nbsp;matching&nbsp;at&nbsp;beginning&nbsp;and&nbsp;end&nbsp;of&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611561">NonGreedy</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611593">//&nbsp;make&nbsp;repetition&nbsp;operators&nbsp;default&nbsp;to&nbsp;non-greedy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611645">PerlX</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611677">//&nbsp;allow&nbsp;Perl&nbsp;extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611703">UnicodeGroups</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611735">//&nbsp;allow&nbsp;\p{Han},&nbsp;\P{Han}&nbsp;for&nbsp;Unicode&nbsp;group&nbsp;and&nbsp;negation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611793">WasDollar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611825">//&nbsp;regexp&nbsp;OpEndText&nbsp;was&nbsp;$,&nbsp;not&nbsp;\z</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611860">Simple</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3611892">//&nbsp;regexp&nbsp;contains&nbsp;no&nbsp;counted&nbsp;repetition</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611935">MatchNL</span>&nbsp;<span class="op" id="3611943">=</span>&nbsp;<span class="ident" id="3611945"><a href="/gostd/regexp/syntax/parse.go.html#3611299">ClassNL</a></span>&nbsp;<span class="op" id="3611953">|</span>&nbsp;<span class="ident" id="3611955"><a href="/gostd/regexp/syntax/parse.go.html#3611404">DotNL</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3611963">Perl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3611975">=</span>&nbsp;<span class="ident" id="3611977"><a href="/gostd/regexp/syntax/parse.go.html#3611299">ClassNL</a></span>&nbsp;<span class="op" id="3611985">|</span>&nbsp;<span class="ident" id="3611987"><a href="/gostd/regexp/syntax/parse.go.html#3611465">OneLine</a></span>&nbsp;<span class="op" id="3611995">|</span>&nbsp;<span class="ident" id="3611997"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3612003">|</span>&nbsp;<span class="ident" id="3612005"><a href="/gostd/regexp/syntax/parse.go.html#3611703">UnicodeGroups</a></span>&nbsp;<span class="comment" id="3612019">//&nbsp;as&nbsp;close&nbsp;to&nbsp;Perl&nbsp;as&nbsp;possible</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612052">POSIX</span>&nbsp;<span class="ident" id="3612058"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span>&nbsp;<span class="op" id="3612064">=</span>&nbsp;<span class="num" id="3612066">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612108">//&nbsp;POSIX&nbsp;syntax</span><br>
<span class="lineno"></span><span class="op" id="3612124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3612127">//&nbsp;Pseudo-ops&nbsp;for&nbsp;parsing&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3612160">const</span>&nbsp;<span class="op" id="3612166">(</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612169">opLeftParen</span>&nbsp;<span class="op" id="3612181">=</span>&nbsp;<span class="ident" id="3612183"><a href="/gostd/regexp/syntax/regexp.go.html#3668904">opPseudo</a></span>&nbsp;<span class="op" id="3612192">+</span>&nbsp;<span class="ident" id="3612194">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612200">opVerticalBar</span><br>
<span class="lineno"></span><span class="op" id="3612214">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3612217">type</span>&nbsp;<span class="ident" id="3612222">parser</span>&nbsp;<span class="keyword" id="3612229">struct</span>&nbsp;<span class="op" id="3612236">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612239">flags</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612251"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612261">//&nbsp;parse&nbsp;mode&nbsp;flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612282">stack</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612294">[</span><span class="op" id="3612295">]</span><span class="op" id="3612296">*</span><span class="ident" id="3612297"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="comment" id="3612304">//&nbsp;stack&nbsp;of&nbsp;parsed&nbsp;expressions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612336">free</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612348">*</span><span class="ident" id="3612349"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612357">numCap</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3612369">int</span>&nbsp;<span class="comment" id="3612373">//&nbsp;number&nbsp;of&nbsp;capturing&nbsp;groups&nbsp;seen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612409">wholeRegexp</span>&nbsp;<span class="builtintype" id="3612421">string</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612429">tmpClass</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612441">[</span><span class="op" id="3612442">]</span><span class="builtintype" id="3612443">rune</span>&nbsp;<span class="comment" id="3612448">//&nbsp;temporary&nbsp;char&nbsp;class&nbsp;work&nbsp;space</span><br>
<span class="lineno"></span><span class="op" id="3612483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3612486">func</span>&nbsp;<span class="op" id="3612491">(</span><span class="ident" id="3612492">p</span>&nbsp;<span class="op" id="3612494">*</span><span class="ident" id="3612495"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3612501">)</span>&nbsp;<span class="ident" id="3612503">newRegexp</span><span class="op" id="3612512">(</span><span class="ident" id="3612513">op</span>&nbsp;<span class="ident" id="3612516"><a href="/gostd/regexp/syntax/regexp.go.html#3667347">Op</a></span><span class="op" id="3612518">)</span>&nbsp;<span class="op" id="3612520">*</span><span class="ident" id="3612521"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3612528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612531">re</span>&nbsp;<span class="op" id="3612534">:=</span>&nbsp;<span class="ident" id="3612537"><a href="/gostd/regexp/syntax/parse.go.html#3612492">p</a></span><span class="op" id="3612538">.</span><span class="ident" id="3612539"><a href="/gostd/regexp/syntax/parse.go.html#3612336">free</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612545">if</span>&nbsp;<span class="ident" id="3612548"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span>&nbsp;<span class="op" id="3612551">!=</span>&nbsp;<span class="builtintype" id="3612554">nil</span>&nbsp;<span class="op" id="3612558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612562"><a href="/gostd/regexp/syntax/parse.go.html#3612492">p</a></span><span class="op" id="3612563">.</span><span class="ident" id="3612564"><a href="/gostd/regexp/syntax/parse.go.html#3612336">free</a></span>&nbsp;<span class="op" id="3612569">=</span>&nbsp;<span class="ident" id="3612571"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span><span class="op" id="3612573">.</span><span class="ident" id="3612574"><a href="/gostd/regexp/syntax/regexp.go.html#3666976">Sub0</a></span><span class="op" id="3612578">[</span><span class="num" id="3612579">0</span><span class="op" id="3612580">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612584">*</span><span class="ident" id="3612585"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span>&nbsp;<span class="op" id="3612588">=</span>&nbsp;<span class="ident" id="3612590"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3612596">{</span><span class="op" id="3612597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612600">}</span>&nbsp;<span class="keyword" id="3612602">else</span>&nbsp;<span class="op" id="3612607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612611"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span>&nbsp;<span class="op" id="3612614">=</span>&nbsp;<span class="builtinfunc" id="3612616">new</span><span class="op" id="3612619">(</span><span class="ident" id="3612620"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3612626">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3612629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612632"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span><span class="op" id="3612634">.</span><span class="ident" id="3612635"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3612638">=</span>&nbsp;<span class="ident" id="3612640"><a href="/gostd/regexp/syntax/parse.go.html#3612513">op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612644">return</span>&nbsp;<span class="ident" id="3612651"><a href="/gostd/regexp/syntax/parse.go.html#3612531">re</a></span><br>
<span class="lineno"></span><span class="op" id="3612654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="3612657">func</span>&nbsp;<span class="op" id="3612662">(</span><span class="ident" id="3612663">p</span>&nbsp;<span class="op" id="3612665">*</span><span class="ident" id="3612666"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3612672">)</span>&nbsp;<span class="ident" id="3612674">reuse</span><span class="op" id="3612679">(</span><span class="ident" id="3612680">re</span>&nbsp;<span class="op" id="3612683">*</span><span class="ident" id="3612684"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3612690">)</span>&nbsp;<span class="op" id="3612692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612695"><a href="/gostd/regexp/syntax/parse.go.html#3612680">re</a></span><span class="op" id="3612697">.</span><span class="ident" id="3612698"><a href="/gostd/regexp/syntax/regexp.go.html#3666976">Sub0</a></span><span class="op" id="3612702">[</span><span class="num" id="3612703">0</span><span class="op" id="3612704">]</span>&nbsp;<span class="op" id="3612706">=</span>&nbsp;<span class="ident" id="3612708"><a href="/gostd/regexp/syntax/parse.go.html#3612663">p</a></span><span class="op" id="3612709">.</span><span class="ident" id="3612710"><a href="/gostd/regexp/syntax/parse.go.html#3612336">free</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3612716"><a href="/gostd/regexp/syntax/parse.go.html#3612663">p</a></span><span class="op" id="3612717">.</span><span class="ident" id="3612718"><a href="/gostd/regexp/syntax/parse.go.html#3612336">free</a></span>&nbsp;<span class="op" id="3612723">=</span>&nbsp;<span class="ident" id="3612725"><a href="/gostd/regexp/syntax/parse.go.html#3612680">re</a></span><br>
<span class="lineno"></span><span class="op" id="3612728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3612731">//&nbsp;Parse&nbsp;stack&nbsp;manipulation.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3612761">//&nbsp;push&nbsp;pushes&nbsp;the&nbsp;regexp&nbsp;re&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack&nbsp;and&nbsp;returns&nbsp;the&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="keyword" id="3612835">func</span>&nbsp;<span class="op" id="3612840">(</span><span class="ident" id="3612841">p</span>&nbsp;<span class="op" id="3612843">*</span><span class="ident" id="3612844"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3612850">)</span>&nbsp;<span class="ident" id="3612852">push</span><span class="op" id="3612856">(</span><span class="ident" id="3612857">re</span>&nbsp;<span class="op" id="3612860">*</span><span class="ident" id="3612861"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3612867">)</span>&nbsp;<span class="op" id="3612869">*</span><span class="ident" id="3612870"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3612877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612880">if</span>&nbsp;<span class="ident" id="3612883"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3612885">.</span><span class="ident" id="3612886"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3612889">==</span>&nbsp;<span class="ident" id="3612892"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span>&nbsp;<span class="op" id="3612904">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3612907">len</span><span class="op" id="3612910">(</span><span class="ident" id="3612911"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3612913">.</span><span class="ident" id="3612914"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3612918">)</span>&nbsp;<span class="op" id="3612920">==</span>&nbsp;<span class="num" id="3612923">2</span>&nbsp;<span class="op" id="3612925">&amp;&amp;</span>&nbsp;<span class="ident" id="3612928"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3612930">.</span><span class="ident" id="3612931"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3612935">[</span><span class="num" id="3612936">0</span><span class="op" id="3612937">]</span>&nbsp;<span class="op" id="3612939">==</span>&nbsp;<span class="ident" id="3612942"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3612944">.</span><span class="ident" id="3612945"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3612949">[</span><span class="num" id="3612950">1</span><span class="op" id="3612951">]</span>&nbsp;<span class="op" id="3612953">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3612957">//&nbsp;Single&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3612975">if</span>&nbsp;<span class="ident" id="3612978"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3612979">.</span><span class="ident" id="3612980"><a href="/gostd/regexp/syntax/parse.go.html#3614369">maybeConcat</a></span><span class="op" id="3612991">(</span><span class="ident" id="3612992"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3612994">.</span><span class="ident" id="3612995"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3612999">[</span><span class="num" id="3613000">0</span><span class="op" id="3613001">]</span><span class="op" id="3613002">,</span>&nbsp;<span class="ident" id="3613004"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613005">.</span><span class="ident" id="3613006"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3613011">&amp;^</span><span class="ident" id="3613013"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><span class="op" id="3613021">)</span>&nbsp;<span class="op" id="3613023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613028">return</span>&nbsp;<span class="builtintype" id="3613035">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613045"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613047">.</span><span class="ident" id="3613048"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3613051">=</span>&nbsp;<span class="ident" id="3613053"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613065"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613067">.</span><span class="ident" id="3613068"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3613073">=</span>&nbsp;<span class="ident" id="3613075"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613077">.</span><span class="ident" id="3613078"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613082">[</span><span class="op" id="3613083">:</span><span class="num" id="3613084">1</span><span class="op" id="3613085">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613089"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613091">.</span><span class="ident" id="3613092"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3613098">=</span>&nbsp;<span class="ident" id="3613100"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613101">.</span><span class="ident" id="3613102"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span>&nbsp;<span class="op" id="3613108">&amp;^</span>&nbsp;<span class="ident" id="3613111"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613121">}</span>&nbsp;<span class="keyword" id="3613123">else</span>&nbsp;<span class="keyword" id="3613128">if</span>&nbsp;<span class="ident" id="3613131"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613133">.</span><span class="ident" id="3613134"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3613137">==</span>&nbsp;<span class="ident" id="3613140"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span>&nbsp;<span class="op" id="3613152">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3613155">len</span><span class="op" id="3613158">(</span><span class="ident" id="3613159"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613161">.</span><span class="ident" id="3613162"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613166">)</span>&nbsp;<span class="op" id="3613168">==</span>&nbsp;<span class="num" id="3613171">4</span>&nbsp;<span class="op" id="3613173">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613178"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613180">.</span><span class="ident" id="3613181"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613185">[</span><span class="num" id="3613186">0</span><span class="op" id="3613187">]</span>&nbsp;<span class="op" id="3613189">==</span>&nbsp;<span class="ident" id="3613192"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613194">.</span><span class="ident" id="3613195"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613199">[</span><span class="num" id="3613200">1</span><span class="op" id="3613201">]</span>&nbsp;<span class="op" id="3613203">&amp;&amp;</span>&nbsp;<span class="ident" id="3613206"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613208">.</span><span class="ident" id="3613209"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613213">[</span><span class="num" id="3613214">2</span><span class="op" id="3613215">]</span>&nbsp;<span class="op" id="3613217">==</span>&nbsp;<span class="ident" id="3613220"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613222">.</span><span class="ident" id="3613223"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613227">[</span><span class="num" id="3613228">3</span><span class="op" id="3613229">]</span>&nbsp;<span class="op" id="3613231">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613236"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3613243">.</span><span class="ident" id="3613244"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3613254">(</span><span class="ident" id="3613255"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613257">.</span><span class="ident" id="3613258"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613262">[</span><span class="num" id="3613263">0</span><span class="op" id="3613264">]</span><span class="op" id="3613265">)</span>&nbsp;<span class="op" id="3613267">==</span>&nbsp;<span class="ident" id="3613270"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613272">.</span><span class="ident" id="3613273"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613277">[</span><span class="num" id="3613278">2</span><span class="op" id="3613279">]</span>&nbsp;<span class="op" id="3613281">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613286"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3613293">.</span><span class="ident" id="3613294"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3613304">(</span><span class="ident" id="3613305"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613307">.</span><span class="ident" id="3613308"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613312">[</span><span class="num" id="3613313">2</span><span class="op" id="3613314">]</span><span class="op" id="3613315">)</span>&nbsp;<span class="op" id="3613317">==</span>&nbsp;<span class="ident" id="3613320"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613322">.</span><span class="ident" id="3613323"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613327">[</span><span class="num" id="3613328">0</span><span class="op" id="3613329">]</span>&nbsp;<span class="op" id="3613331">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613336"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613338">.</span><span class="ident" id="3613339"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3613342">==</span>&nbsp;<span class="ident" id="3613345"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span>&nbsp;<span class="op" id="3613357">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3613360">len</span><span class="op" id="3613363">(</span><span class="ident" id="3613364"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613366">.</span><span class="ident" id="3613367"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613371">)</span>&nbsp;<span class="op" id="3613373">==</span>&nbsp;<span class="num" id="3613376">2</span>&nbsp;<span class="op" id="3613378">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613384"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613386">.</span><span class="ident" id="3613387"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613391">[</span><span class="num" id="3613392">0</span><span class="op" id="3613393">]</span><span class="op" id="3613394">+</span><span class="num" id="3613395">1</span>&nbsp;<span class="op" id="3613397">==</span>&nbsp;<span class="ident" id="3613400"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613402">.</span><span class="ident" id="3613403"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613407">[</span><span class="num" id="3613408">1</span><span class="op" id="3613409">]</span>&nbsp;<span class="op" id="3613411">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613417"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3613424">.</span><span class="ident" id="3613425"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3613435">(</span><span class="ident" id="3613436"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613438">.</span><span class="ident" id="3613439"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613443">[</span><span class="num" id="3613444">0</span><span class="op" id="3613445">]</span><span class="op" id="3613446">)</span>&nbsp;<span class="op" id="3613448">==</span>&nbsp;<span class="ident" id="3613451"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613453">.</span><span class="ident" id="3613454"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613458">[</span><span class="num" id="3613459">1</span><span class="op" id="3613460">]</span>&nbsp;<span class="op" id="3613462">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613468"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3613475">.</span><span class="ident" id="3613476"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3613486">(</span><span class="ident" id="3613487"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613489">.</span><span class="ident" id="3613490"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613494">[</span><span class="num" id="3613495">1</span><span class="op" id="3613496">]</span><span class="op" id="3613497">)</span>&nbsp;<span class="op" id="3613499">==</span>&nbsp;<span class="ident" id="3613502"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613504">.</span><span class="ident" id="3613505"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613509">[</span><span class="num" id="3613510">0</span><span class="op" id="3613511">]</span>&nbsp;<span class="op" id="3613513">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3613517">//&nbsp;Case-insensitive&nbsp;rune&nbsp;like&nbsp;[Aa]&nbsp;or&nbsp;[Δδ].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613565">if</span>&nbsp;<span class="ident" id="3613568"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613569">.</span><span class="ident" id="3613570"><a href="/gostd/regexp/syntax/parse.go.html#3614369">maybeConcat</a></span><span class="op" id="3613581">(</span><span class="ident" id="3613582"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613584">.</span><span class="ident" id="3613585"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613589">[</span><span class="num" id="3613590">0</span><span class="op" id="3613591">]</span><span class="op" id="3613592">,</span>&nbsp;<span class="ident" id="3613594"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613595">.</span><span class="ident" id="3613596"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3613601">|</span><span class="ident" id="3613602"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><span class="op" id="3613610">)</span>&nbsp;<span class="op" id="3613612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613617">return</span>&nbsp;<span class="builtintype" id="3613624">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3613635">//&nbsp;Rewrite&nbsp;as&nbsp;(case-insensitive)&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613679"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613681">.</span><span class="ident" id="3613682"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3613685">=</span>&nbsp;<span class="ident" id="3613687"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613699"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613701">.</span><span class="ident" id="3613702"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3613707">=</span>&nbsp;<span class="ident" id="3613709"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613711">.</span><span class="ident" id="3613712"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3613716">[</span><span class="op" id="3613717">:</span><span class="num" id="3613718">1</span><span class="op" id="3613719">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613723"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613725">.</span><span class="ident" id="3613726"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3613732">=</span>&nbsp;<span class="ident" id="3613734"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613735">.</span><span class="ident" id="3613736"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span>&nbsp;<span class="op" id="3613742">|</span>&nbsp;<span class="ident" id="3613744"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613754">}</span>&nbsp;<span class="keyword" id="3613756">else</span>&nbsp;<span class="op" id="3613761">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3613765">//&nbsp;Incremental&nbsp;concatenation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613797"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613798">.</span><span class="ident" id="3613799"><a href="/gostd/regexp/syntax/parse.go.html#3614369">maybeConcat</a></span><span class="op" id="3613810">(</span><span class="op" id="3613811">-</span><span class="num" id="3613812">1</span><span class="op" id="3613813">,</span>&nbsp;<span class="num" id="3613815">0</span><span class="op" id="3613816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3613819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3613823"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613824">.</span><span class="ident" id="3613825"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3613831">=</span>&nbsp;<span class="builtinfunc" id="3613833">append</span><span class="op" id="3613839">(</span><span class="ident" id="3613840"><a href="/gostd/regexp/syntax/parse.go.html#3612841">p</a></span><span class="op" id="3613841">.</span><span class="ident" id="3613842"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3613847">,</span>&nbsp;<span class="ident" id="3613849"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><span class="op" id="3613851">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3613854">return</span>&nbsp;<span class="ident" id="3613861"><a href="/gostd/regexp/syntax/parse.go.html#3612857">re</a></span><br>
<span class="lineno"></span><span class="op" id="3613864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3613867">//&nbsp;maybeConcat&nbsp;implements&nbsp;incremental&nbsp;concatenation</span><br>
<span class="lineno"></span><span class="comment" id="3613919">//&nbsp;of&nbsp;literal&nbsp;runes&nbsp;into&nbsp;string&nbsp;nodes.&nbsp;&nbsp;The&nbsp;parser&nbsp;calls&nbsp;this</span><br>
<span class="lineno">145</span><span class="comment" id="3613981">//&nbsp;before&nbsp;each&nbsp;push,&nbsp;so&nbsp;only&nbsp;the&nbsp;top&nbsp;fragment&nbsp;of&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="3614040">//&nbsp;might&nbsp;need&nbsp;processing.&nbsp;&nbsp;Since&nbsp;this&nbsp;is&nbsp;called&nbsp;before&nbsp;a&nbsp;push,</span><br>
<span class="lineno"></span><span class="comment" id="3614103">//&nbsp;the&nbsp;topmost&nbsp;literal&nbsp;is&nbsp;no&nbsp;longer&nbsp;subject&nbsp;to&nbsp;operators&nbsp;like&nbsp;*</span><br>
<span class="lineno"></span><span class="comment" id="3614167">//&nbsp;(Otherwise&nbsp;ab*&nbsp;would&nbsp;turn&nbsp;into&nbsp;(ab)*.)</span><br>
<span class="lineno"></span><span class="comment" id="3614209">//&nbsp;If&nbsp;r&nbsp;&gt;=&nbsp;0&nbsp;and&nbsp;there&#39;s&nbsp;a&nbsp;node&nbsp;left&nbsp;over,&nbsp;maybeConcat&nbsp;uses&nbsp;it</span><br>
<span class="lineno">150</span><span class="comment" id="3614272">//&nbsp;to&nbsp;push&nbsp;r&nbsp;with&nbsp;the&nbsp;given&nbsp;flags.</span><br>
<span class="lineno"></span><span class="comment" id="3614307">//&nbsp;maybeConcat&nbsp;reports&nbsp;whether&nbsp;r&nbsp;was&nbsp;pushed.</span><br>
<span class="lineno"></span><span class="keyword" id="3614352">func</span>&nbsp;<span class="op" id="3614357">(</span><span class="ident" id="3614358">p</span>&nbsp;<span class="op" id="3614360">*</span><span class="ident" id="3614361"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3614367">)</span>&nbsp;<span class="ident" id="3614369">maybeConcat</span><span class="op" id="3614380">(</span><span class="ident" id="3614381">r</span>&nbsp;<span class="builtintype" id="3614383">rune</span><span class="op" id="3614387">,</span>&nbsp;<span class="ident" id="3614389">flags</span>&nbsp;<span class="ident" id="3614395"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3614400">)</span>&nbsp;<span class="builtintype" id="3614402">bool</span>&nbsp;<span class="op" id="3614407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614410">n</span>&nbsp;<span class="op" id="3614412">:=</span>&nbsp;<span class="builtinfunc" id="3614415">len</span><span class="op" id="3614418">(</span><span class="ident" id="3614419"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614420">.</span><span class="ident" id="3614421"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3614426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614429">if</span>&nbsp;<span class="ident" id="3614432"><a href="/gostd/regexp/syntax/parse.go.html#3614410">n</a></span>&nbsp;<span class="op" id="3614434">&lt;</span>&nbsp;<span class="num" id="3614436">2</span>&nbsp;<span class="op" id="3614438">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614442">return</span>&nbsp;<span class="builtintype" id="3614449">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3614456">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614460">re1</span>&nbsp;<span class="op" id="3614464">:=</span>&nbsp;<span class="ident" id="3614467"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614468">.</span><span class="ident" id="3614469"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3614474">[</span><span class="ident" id="3614475"><a href="/gostd/regexp/syntax/parse.go.html#3614410">n</a></span><span class="op" id="3614476">-</span><span class="num" id="3614477">1</span><span class="op" id="3614478">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614481">re2</span>&nbsp;<span class="op" id="3614485">:=</span>&nbsp;<span class="ident" id="3614488"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614489">.</span><span class="ident" id="3614490"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3614495">[</span><span class="ident" id="3614496"><a href="/gostd/regexp/syntax/parse.go.html#3614410">n</a></span><span class="op" id="3614497">-</span><span class="num" id="3614498">2</span><span class="op" id="3614499">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614502">if</span>&nbsp;<span class="ident" id="3614505"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614508">.</span><span class="ident" id="3614509"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3614512">!=</span>&nbsp;<span class="ident" id="3614515"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3614525">||</span>&nbsp;<span class="ident" id="3614528"><a href="/gostd/regexp/syntax/parse.go.html#3614481">re2</a></span><span class="op" id="3614531">.</span><span class="ident" id="3614532"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3614535">!=</span>&nbsp;<span class="ident" id="3614538"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3614548">||</span>&nbsp;<span class="ident" id="3614551"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614554">.</span><span class="ident" id="3614555"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3614560">&amp;</span><span class="ident" id="3614561"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3614570">!=</span>&nbsp;<span class="ident" id="3614573"><a href="/gostd/regexp/syntax/parse.go.html#3614481">re2</a></span><span class="op" id="3614576">.</span><span class="ident" id="3614577"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3614582">&amp;</span><span class="ident" id="3614583"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3614592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614596">return</span>&nbsp;<span class="builtintype" id="3614603">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3614610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3614614">//&nbsp;Push&nbsp;re1&nbsp;into&nbsp;re2.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614637"><a href="/gostd/regexp/syntax/parse.go.html#3614481">re2</a></span><span class="op" id="3614640">.</span><span class="ident" id="3614641"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3614646">=</span>&nbsp;<span class="builtinfunc" id="3614648">append</span><span class="op" id="3614654">(</span><span class="ident" id="3614655"><a href="/gostd/regexp/syntax/parse.go.html#3614481">re2</a></span><span class="op" id="3614658">.</span><span class="ident" id="3614659"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3614663">,</span>&nbsp;<span class="ident" id="3614665"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614668">.</span><span class="ident" id="3614669"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3614673">...</span><span class="op" id="3614676">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3614680">//&nbsp;Reuse&nbsp;re1&nbsp;if&nbsp;possible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614707">if</span>&nbsp;<span class="ident" id="3614710"><a href="/gostd/regexp/syntax/parse.go.html#3614381">r</a></span>&nbsp;<span class="op" id="3614712">&gt;=</span>&nbsp;<span class="num" id="3614715">0</span>&nbsp;<span class="op" id="3614717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614721"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614724">.</span><span class="ident" id="3614725"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3614730">=</span>&nbsp;<span class="ident" id="3614732"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614735">.</span><span class="ident" id="3614736"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3614741">[</span><span class="op" id="3614742">:</span><span class="num" id="3614743">1</span><span class="op" id="3614744">]</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614748"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614751">.</span><span class="ident" id="3614752"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3614756">[</span><span class="num" id="3614757">0</span><span class="op" id="3614758">]</span>&nbsp;<span class="op" id="3614760">=</span>&nbsp;<span class="ident" id="3614762"><a href="/gostd/regexp/syntax/parse.go.html#3614381">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614766"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614769">.</span><span class="ident" id="3614770"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3614776">=</span>&nbsp;<span class="ident" id="3614778"><a href="/gostd/regexp/syntax/parse.go.html#3614389">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614786">return</span>&nbsp;<span class="builtintype" id="3614793">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3614799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614803"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614804">.</span><span class="ident" id="3614805"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3614811">=</span>&nbsp;<span class="ident" id="3614813"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614814">.</span><span class="ident" id="3614815"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3614820">[</span><span class="op" id="3614821">:</span><span class="ident" id="3614822"><a href="/gostd/regexp/syntax/parse.go.html#3614410">n</a></span><span class="op" id="3614823">-</span><span class="num" id="3614824">1</span><span class="op" id="3614825">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3614828"><a href="/gostd/regexp/syntax/parse.go.html#3614358">p</a></span><span class="op" id="3614829">.</span><span class="ident" id="3614830"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3614835">(</span><span class="ident" id="3614836"><a href="/gostd/regexp/syntax/parse.go.html#3614460">re1</a></span><span class="op" id="3614839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3614842">return</span>&nbsp;<span class="builtintype" id="3614849">false</span>&nbsp;<span class="comment" id="3614855">//&nbsp;did&nbsp;not&nbsp;push&nbsp;r</span><br>
<span class="lineno"></span><span class="op" id="3614873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="comment" id="3614876">//&nbsp;newLiteral&nbsp;returns&nbsp;a&nbsp;new&nbsp;OpLiteral&nbsp;Regexp&nbsp;with&nbsp;the&nbsp;given&nbsp;flags</span><br>
<span class="lineno"></span><span class="keyword" id="3614942">func</span>&nbsp;<span class="op" id="3614947">(</span><span class="ident" id="3614948">p</span>&nbsp;<span class="op" id="3614950">*</span><span class="ident" id="3614951"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3614957">)</span>&nbsp;<span class="ident" id="3614959">newLiteral</span><span class="op" id="3614969">(</span><span class="ident" id="3614970">r</span>&nbsp;<span class="builtintype" id="3614972">rune</span><span class="op" id="3614976">,</span>&nbsp;<span class="ident" id="3614978">flags</span>&nbsp;<span class="ident" id="3614984"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3614989">)</span>&nbsp;<span class="op" id="3614991">*</span><span class="ident" id="3614992"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3614999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615002">re</span>&nbsp;<span class="op" id="3615005">:=</span>&nbsp;<span class="ident" id="3615008"><a href="/gostd/regexp/syntax/parse.go.html#3614948">p</a></span><span class="op" id="3615009">.</span><span class="ident" id="3615010"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3615019">(</span><span class="ident" id="3615020"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><span class="op" id="3615029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615032"><a href="/gostd/regexp/syntax/parse.go.html#3615002">re</a></span><span class="op" id="3615034">.</span><span class="ident" id="3615035"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3615041">=</span>&nbsp;<span class="ident" id="3615043"><a href="/gostd/regexp/syntax/parse.go.html#3614978">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615050">if</span>&nbsp;<span class="ident" id="3615053"><a href="/gostd/regexp/syntax/parse.go.html#3614978">flags</a></span><span class="op" id="3615058">&amp;</span><span class="ident" id="3615059"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3615068">!=</span>&nbsp;<span class="num" id="3615071">0</span>&nbsp;<span class="op" id="3615073">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615077"><a href="/gostd/regexp/syntax/parse.go.html#3614970">r</a></span>&nbsp;<span class="op" id="3615079">=</span>&nbsp;<span class="ident" id="3615081"><a href="/gostd/regexp/syntax/parse.go.html#3615221">minFoldRune</a></span><span class="op" id="3615092">(</span><span class="ident" id="3615093"><a href="/gostd/regexp/syntax/parse.go.html#3614970">r</a></span><span class="op" id="3615094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3615097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615100"><a href="/gostd/regexp/syntax/parse.go.html#3615002">re</a></span><span class="op" id="3615102">.</span><span class="ident" id="3615103"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3615108">[</span><span class="num" id="3615109">0</span><span class="op" id="3615110">]</span>&nbsp;<span class="op" id="3615112">=</span>&nbsp;<span class="ident" id="3615114"><a href="/gostd/regexp/syntax/parse.go.html#3614970">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615117"><a href="/gostd/regexp/syntax/parse.go.html#3615002">re</a></span><span class="op" id="3615119">.</span><span class="ident" id="3615120"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3615125">=</span>&nbsp;<span class="ident" id="3615127"><a href="/gostd/regexp/syntax/parse.go.html#3615002">re</a></span><span class="op" id="3615129">.</span><span class="ident" id="3615130"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3615135">[</span><span class="op" id="3615136">:</span><span class="num" id="3615137">1</span><span class="op" id="3615138">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615141">return</span>&nbsp;<span class="ident" id="3615148"><a href="/gostd/regexp/syntax/parse.go.html#3615002">re</a></span><br>
<span class="lineno">190</span><span class="op" id="3615151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615154">//&nbsp;minFoldRune&nbsp;returns&nbsp;the&nbsp;minimum&nbsp;rune&nbsp;fold-equivalent&nbsp;to&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3615216">func</span>&nbsp;<span class="ident" id="3615221">minFoldRune</span><span class="op" id="3615232">(</span><span class="ident" id="3615233">r</span>&nbsp;<span class="builtintype" id="3615235">rune</span><span class="op" id="3615239">)</span>&nbsp;<span class="builtintype" id="3615241">rune</span>&nbsp;<span class="op" id="3615246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615249">if</span>&nbsp;<span class="ident" id="3615252"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615254">&lt;</span>&nbsp;<span class="ident" id="3615256"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span>&nbsp;<span class="op" id="3615264">||</span>&nbsp;<span class="ident" id="3615267"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615269">&gt;</span>&nbsp;<span class="ident" id="3615271"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span>&nbsp;<span class="op" id="3615279">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615283">return</span>&nbsp;<span class="ident" id="3615290"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3615293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615296">min</span>&nbsp;<span class="op" id="3615300">:=</span>&nbsp;<span class="ident" id="3615303"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615306">r0</span>&nbsp;<span class="op" id="3615309">:=</span>&nbsp;<span class="ident" id="3615312"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615315">for</span>&nbsp;<span class="ident" id="3615319"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615321">=</span>&nbsp;<span class="ident" id="3615323"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3615330">.</span><span class="ident" id="3615331"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3615341">(</span><span class="ident" id="3615342"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><span class="op" id="3615343">)</span><span class="op" id="3615344">;</span>&nbsp;<span class="ident" id="3615346"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615348">!=</span>&nbsp;<span class="ident" id="3615351"><a href="/gostd/regexp/syntax/parse.go.html#3615306">r0</a></span><span class="op" id="3615353">;</span>&nbsp;<span class="ident" id="3615355"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615357">=</span>&nbsp;<span class="ident" id="3615359"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3615366">.</span><span class="ident" id="3615367"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3615377">(</span><span class="ident" id="3615378"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><span class="op" id="3615379">)</span>&nbsp;<span class="op" id="3615381">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615385">if</span>&nbsp;<span class="ident" id="3615388"><a href="/gostd/regexp/syntax/parse.go.html#3615296">min</a></span>&nbsp;<span class="op" id="3615392">&gt;</span>&nbsp;<span class="ident" id="3615394"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span>&nbsp;<span class="op" id="3615396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615401"><a href="/gostd/regexp/syntax/parse.go.html#3615296">min</a></span>&nbsp;<span class="op" id="3615405">=</span>&nbsp;<span class="ident" id="3615407"><a href="/gostd/regexp/syntax/parse.go.html#3615233">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3615411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3615414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615417">return</span>&nbsp;<span class="ident" id="3615424"><a href="/gostd/regexp/syntax/parse.go.html#3615296">min</a></span><br>
<span class="lineno">205</span><span class="op" id="3615428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615431">//&nbsp;literal&nbsp;pushes&nbsp;a&nbsp;literal&nbsp;regexp&nbsp;for&nbsp;the&nbsp;rune&nbsp;r&nbsp;on&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="3615494">//&nbsp;and&nbsp;returns&nbsp;that&nbsp;regexp.</span><br>
<span class="lineno"></span><span class="keyword" id="3615522">func</span>&nbsp;<span class="op" id="3615527">(</span><span class="ident" id="3615528">p</span>&nbsp;<span class="op" id="3615530">*</span><span class="ident" id="3615531"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3615537">)</span>&nbsp;<span class="ident" id="3615539">literal</span><span class="op" id="3615546">(</span><span class="ident" id="3615547">r</span>&nbsp;<span class="builtintype" id="3615549">rune</span><span class="op" id="3615553">)</span>&nbsp;<span class="op" id="3615555">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615558"><a href="/gostd/regexp/syntax/parse.go.html#3615528">p</a></span><span class="op" id="3615559">.</span><span class="ident" id="3615560"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3615564">(</span><span class="ident" id="3615565"><a href="/gostd/regexp/syntax/parse.go.html#3615528">p</a></span><span class="op" id="3615566">.</span><span class="ident" id="3615567"><a href="/gostd/regexp/syntax/parse.go.html#3614959">newLiteral</a></span><span class="op" id="3615577">(</span><span class="ident" id="3615578"><a href="/gostd/regexp/syntax/parse.go.html#3615547">r</a></span><span class="op" id="3615579">,</span>&nbsp;<span class="ident" id="3615581"><a href="/gostd/regexp/syntax/parse.go.html#3615528">p</a></span><span class="op" id="3615582">.</span><span class="ident" id="3615583"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3615588">)</span><span class="op" id="3615589">)</span><br>
<span class="lineno"></span><span class="op" id="3615591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3615594">//&nbsp;op&nbsp;pushes&nbsp;a&nbsp;regexp&nbsp;with&nbsp;the&nbsp;given&nbsp;op&nbsp;onto&nbsp;the&nbsp;stack</span><br>
<span class="lineno"></span><span class="comment" id="3615649">//&nbsp;and&nbsp;returns&nbsp;that&nbsp;regexp.</span><br>
<span class="lineno">215</span><span class="keyword" id="3615677">func</span>&nbsp;<span class="op" id="3615682">(</span><span class="ident" id="3615683">p</span>&nbsp;<span class="op" id="3615685">*</span><span class="ident" id="3615686"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3615692">)</span>&nbsp;<span class="ident" id="3615694">op</span><span class="op" id="3615696">(</span><span class="ident" id="3615697">op</span>&nbsp;<span class="ident" id="3615700"><a href="/gostd/regexp/syntax/regexp.go.html#3667347">Op</a></span><span class="op" id="3615702">)</span>&nbsp;<span class="op" id="3615704">*</span><span class="ident" id="3615705"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3615712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615715">re</span>&nbsp;<span class="op" id="3615718">:=</span>&nbsp;<span class="ident" id="3615721"><a href="/gostd/regexp/syntax/parse.go.html#3615683">p</a></span><span class="op" id="3615722">.</span><span class="ident" id="3615723"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3615732">(</span><span class="ident" id="3615733"><a href="/gostd/regexp/syntax/parse.go.html#3615697">op</a></span><span class="op" id="3615735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3615738"><a href="/gostd/regexp/syntax/parse.go.html#3615715">re</a></span><span class="op" id="3615740">.</span><span class="ident" id="3615741"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3615747">=</span>&nbsp;<span class="ident" id="3615749"><a href="/gostd/regexp/syntax/parse.go.html#3615683">p</a></span><span class="op" id="3615750">.</span><span class="ident" id="3615751"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3615758">return</span>&nbsp;<span class="ident" id="3615765"><a href="/gostd/regexp/syntax/parse.go.html#3615683">p</a></span><span class="op" id="3615766">.</span><span class="ident" id="3615767"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3615771">(</span><span class="ident" id="3615772"><a href="/gostd/regexp/syntax/parse.go.html#3615715">re</a></span><span class="op" id="3615774">)</span><br>
<span class="lineno"></span><span class="op" id="3615776">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="3615779">//&nbsp;repeat&nbsp;replaces&nbsp;the&nbsp;top&nbsp;stack&nbsp;element&nbsp;with&nbsp;itself&nbsp;repeated&nbsp;according&nbsp;to&nbsp;op,&nbsp;min,&nbsp;max.</span><br>
<span class="lineno"></span><span class="comment" id="3615868">//&nbsp;before&nbsp;is&nbsp;the&nbsp;regexp&nbsp;suffix&nbsp;starting&nbsp;at&nbsp;the&nbsp;repetition&nbsp;operator.</span><br>
<span class="lineno"></span><span class="comment" id="3615936">//&nbsp;after&nbsp;is&nbsp;the&nbsp;regexp&nbsp;suffix&nbsp;following&nbsp;after&nbsp;the&nbsp;repetition&nbsp;operator.</span><br>
<span class="lineno"></span><span class="comment" id="3616007">//&nbsp;repeat&nbsp;returns&nbsp;an&nbsp;updated&nbsp;&#39;after&#39;&nbsp;and&nbsp;an&nbsp;error,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">225</span><span class="keyword" id="3616066">func</span>&nbsp;<span class="op" id="3616071">(</span><span class="ident" id="3616072">p</span>&nbsp;<span class="op" id="3616074">*</span><span class="ident" id="3616075"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3616081">)</span>&nbsp;<span class="ident" id="3616083">repeat</span><span class="op" id="3616089">(</span><span class="ident" id="3616090">op</span>&nbsp;<span class="ident" id="3616093"><a href="/gostd/regexp/syntax/regexp.go.html#3667347">Op</a></span><span class="op" id="3616095">,</span>&nbsp;<span class="ident" id="3616097">min</span><span class="op" id="3616100">,</span>&nbsp;<span class="ident" id="3616102">max</span>&nbsp;<span class="builtintype" id="3616106">int</span><span class="op" id="3616109">,</span>&nbsp;<span class="ident" id="3616111">before</span><span class="op" id="3616117">,</span>&nbsp;<span class="ident" id="3616119">after</span><span class="op" id="3616124">,</span>&nbsp;<span class="ident" id="3616126">lastRepeat</span>&nbsp;<span class="builtintype" id="3616137">string</span><span class="op" id="3616143">)</span>&nbsp;<span class="op" id="3616145">(</span><span class="builtintype" id="3616146">string</span><span class="op" id="3616152">,</span>&nbsp;<span class="builtintype" id="3616154">error</span><span class="op" id="3616159">)</span>&nbsp;<span class="op" id="3616161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616164">flags</span>&nbsp;<span class="op" id="3616170">:=</span>&nbsp;<span class="ident" id="3616173"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616174">.</span><span class="ident" id="3616175"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616182">if</span>&nbsp;<span class="ident" id="3616185"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616186">.</span><span class="ident" id="3616187"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3616192">&amp;</span><span class="ident" id="3616193"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3616199">!=</span>&nbsp;<span class="num" id="3616202">0</span>&nbsp;<span class="op" id="3616204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616208">if</span>&nbsp;<span class="builtinfunc" id="3616211">len</span><span class="op" id="3616214">(</span><span class="ident" id="3616215"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616220">)</span>&nbsp;<span class="op" id="3616222">&gt;</span>&nbsp;<span class="num" id="3616224">0</span>&nbsp;<span class="op" id="3616226">&amp;&amp;</span>&nbsp;<span class="ident" id="3616229"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616234">[</span><span class="num" id="3616235">0</span><span class="op" id="3616236">]</span>&nbsp;<span class="op" id="3616238">==</span>&nbsp;<span class="string" id="3616241">&#39;?&#39;</span>&nbsp;<span class="op" id="3616245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616250"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span>&nbsp;<span class="op" id="3616256">=</span>&nbsp;<span class="ident" id="3616258"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616263">[</span><span class="num" id="3616264">1</span><span class="op" id="3616265">:</span><span class="op" id="3616266">]</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616271"><a href="/gostd/regexp/syntax/parse.go.html#3616164">flags</a></span>&nbsp;<span class="op" id="3616277">^=</span>&nbsp;<span class="ident" id="3616280"><a href="/gostd/regexp/syntax/parse.go.html#3611561">NonGreedy</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616296">if</span>&nbsp;<span class="ident" id="3616299"><a href="/gostd/regexp/syntax/parse.go.html#3616126">lastRepeat</a></span>&nbsp;<span class="op" id="3616310">!=</span>&nbsp;<span class="string" id="3616313">&#34;&#34;</span>&nbsp;<span class="op" id="3616316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616321">//&nbsp;In&nbsp;Perl&nbsp;it&nbsp;is&nbsp;not&nbsp;allowed&nbsp;to&nbsp;stack&nbsp;repetition&nbsp;operators:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616384">//&nbsp;a**&nbsp;is&nbsp;a&nbsp;syntax&nbsp;error,&nbsp;not&nbsp;a&nbsp;doubled&nbsp;star,&nbsp;and&nbsp;a++&nbsp;means</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3616447">//&nbsp;something&nbsp;else&nbsp;entirely,&nbsp;which&nbsp;we&nbsp;don&#39;t&nbsp;support!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616502">return</span>&nbsp;<span class="string" id="3616509">&#34;&#34;</span><span class="op" id="3616511">,</span>&nbsp;<span class="op" id="3616513">&amp;</span><span class="ident" id="3616514"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3616519">{</span><span class="ident" id="3616520"><a href="/gostd/regexp/syntax/parse.go.html#3610476">ErrInvalidRepeatOp</a></span><span class="op" id="3616538">,</span>&nbsp;<span class="ident" id="3616540"><a href="/gostd/regexp/syntax/parse.go.html#3616126">lastRepeat</a></span><span class="op" id="3616550">[</span><span class="op" id="3616551">:</span><span class="builtinfunc" id="3616552">len</span><span class="op" id="3616555">(</span><span class="ident" id="3616556"><a href="/gostd/regexp/syntax/parse.go.html#3616126">lastRepeat</a></span><span class="op" id="3616566">)</span><span class="op" id="3616567">-</span><span class="builtinfunc" id="3616568">len</span><span class="op" id="3616571">(</span><span class="ident" id="3616572"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616577">)</span><span class="op" id="3616578">]</span><span class="op" id="3616579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616589">n</span>&nbsp;<span class="op" id="3616591">:=</span>&nbsp;<span class="builtinfunc" id="3616594">len</span><span class="op" id="3616597">(</span><span class="ident" id="3616598"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616599">.</span><span class="ident" id="3616600"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3616605">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616608">if</span>&nbsp;<span class="ident" id="3616611"><a href="/gostd/regexp/syntax/parse.go.html#3616589">n</a></span>&nbsp;<span class="op" id="3616613">==</span>&nbsp;<span class="num" id="3616616">0</span>&nbsp;<span class="op" id="3616618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616622">return</span>&nbsp;<span class="string" id="3616629">&#34;&#34;</span><span class="op" id="3616631">,</span>&nbsp;<span class="op" id="3616633">&amp;</span><span class="ident" id="3616634"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3616639">{</span><span class="ident" id="3616640"><a href="/gostd/regexp/syntax/parse.go.html#3610782">ErrMissingRepeatArgument</a></span><span class="op" id="3616664">,</span>&nbsp;<span class="ident" id="3616666"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3616672">[</span><span class="op" id="3616673">:</span><span class="builtinfunc" id="3616674">len</span><span class="op" id="3616677">(</span><span class="ident" id="3616678"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3616684">)</span><span class="op" id="3616685">-</span><span class="builtinfunc" id="3616686">len</span><span class="op" id="3616689">(</span><span class="ident" id="3616690"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616695">)</span><span class="op" id="3616696">]</span><span class="op" id="3616697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616703">sub</span>&nbsp;<span class="op" id="3616707">:=</span>&nbsp;<span class="ident" id="3616710"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616711">.</span><span class="ident" id="3616712"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3616717">[</span><span class="ident" id="3616718"><a href="/gostd/regexp/syntax/parse.go.html#3616589">n</a></span><span class="op" id="3616719">-</span><span class="num" id="3616720">1</span><span class="op" id="3616721">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616724">if</span>&nbsp;<span class="ident" id="3616727"><a href="/gostd/regexp/syntax/parse.go.html#3616703">sub</a></span><span class="op" id="3616730">.</span><span class="ident" id="3616731"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3616734">&gt;=</span>&nbsp;<span class="ident" id="3616737"><a href="/gostd/regexp/syntax/regexp.go.html#3668904">opPseudo</a></span>&nbsp;<span class="op" id="3616746">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616750">return</span>&nbsp;<span class="string" id="3616757">&#34;&#34;</span><span class="op" id="3616759">,</span>&nbsp;<span class="op" id="3616761">&amp;</span><span class="ident" id="3616762"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3616767">{</span><span class="ident" id="3616768"><a href="/gostd/regexp/syntax/parse.go.html#3610782">ErrMissingRepeatArgument</a></span><span class="op" id="3616792">,</span>&nbsp;<span class="ident" id="3616794"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3616800">[</span><span class="op" id="3616801">:</span><span class="builtinfunc" id="3616802">len</span><span class="op" id="3616805">(</span><span class="ident" id="3616806"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3616812">)</span><span class="op" id="3616813">-</span><span class="builtinfunc" id="3616814">len</span><span class="op" id="3616817">(</span><span class="ident" id="3616818"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3616823">)</span><span class="op" id="3616824">]</span><span class="op" id="3616825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3616828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616832">re</span>&nbsp;<span class="op" id="3616835">:=</span>&nbsp;<span class="ident" id="3616838"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616839">.</span><span class="ident" id="3616840"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3616849">(</span><span class="ident" id="3616850"><a href="/gostd/regexp/syntax/parse.go.html#3616090">op</a></span><span class="op" id="3616852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616855"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616857">.</span><span class="ident" id="3616858"><a href="/gostd/regexp/syntax/regexp.go.html#3667135">Min</a></span>&nbsp;<span class="op" id="3616862">=</span>&nbsp;<span class="ident" id="3616864"><a href="/gostd/regexp/syntax/parse.go.html#3616097">min</a></span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616869"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616871">.</span><span class="ident" id="3616872"><a href="/gostd/regexp/syntax/regexp.go.html#3667140">Max</a></span>&nbsp;<span class="op" id="3616876">=</span>&nbsp;<span class="ident" id="3616878"><a href="/gostd/regexp/syntax/parse.go.html#3616102">max</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616883"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616885">.</span><span class="ident" id="3616886"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3616892">=</span>&nbsp;<span class="ident" id="3616894"><a href="/gostd/regexp/syntax/parse.go.html#3616164">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616901"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616903">.</span><span class="ident" id="3616904"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3616908">=</span>&nbsp;<span class="ident" id="3616910"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616912">.</span><span class="ident" id="3616913"><a href="/gostd/regexp/syntax/regexp.go.html#3666976">Sub0</a></span><span class="op" id="3616917">[</span><span class="op" id="3616918">:</span><span class="num" id="3616919">1</span><span class="op" id="3616920">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616923"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3616925">.</span><span class="ident" id="3616926"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3616929">[</span><span class="num" id="3616930">0</span><span class="op" id="3616931">]</span>&nbsp;<span class="op" id="3616933">=</span>&nbsp;<span class="ident" id="3616935"><a href="/gostd/regexp/syntax/parse.go.html#3616703">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3616940"><a href="/gostd/regexp/syntax/parse.go.html#3616072">p</a></span><span class="op" id="3616941">.</span><span class="ident" id="3616942"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3616947">[</span><span class="ident" id="3616948"><a href="/gostd/regexp/syntax/parse.go.html#3616589">n</a></span><span class="op" id="3616949">-</span><span class="num" id="3616950">1</span><span class="op" id="3616951">]</span>&nbsp;<span class="op" id="3616953">=</span>&nbsp;<span class="ident" id="3616955"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3616960">if</span>&nbsp;<span class="ident" id="3616963"><a href="/gostd/regexp/syntax/parse.go.html#3616090">op</a></span>&nbsp;<span class="op" id="3616966">==</span>&nbsp;<span class="ident" id="3616969"><a href="/gostd/regexp/syntax/regexp.go.html#3668662">OpRepeat</a></span>&nbsp;<span class="op" id="3616978">&amp;&amp;</span>&nbsp;<span class="op" id="3616981">(</span><span class="ident" id="3616982"><a href="/gostd/regexp/syntax/parse.go.html#3616097">min</a></span>&nbsp;<span class="op" id="3616986">&gt;=</span>&nbsp;<span class="num" id="3616989">2</span>&nbsp;<span class="op" id="3616991">||</span>&nbsp;<span class="ident" id="3616994"><a href="/gostd/regexp/syntax/parse.go.html#3616102">max</a></span>&nbsp;<span class="op" id="3616998">&gt;=</span>&nbsp;<span class="num" id="3617001">2</span><span class="op" id="3617002">)</span>&nbsp;<span class="op" id="3617004">&amp;&amp;</span>&nbsp;<span class="op" id="3617007">!</span><span class="ident" id="3617008"><a href="/gostd/regexp/syntax/parse.go.html#3617711">repeatIsValid</a></span><span class="op" id="3617021">(</span><span class="ident" id="3617022"><a href="/gostd/regexp/syntax/parse.go.html#3616832">re</a></span><span class="op" id="3617024">,</span>&nbsp;<span class="num" id="3617026">1000</span><span class="op" id="3617030">)</span>&nbsp;<span class="op" id="3617032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617036">return</span>&nbsp;<span class="string" id="3617043">&#34;&#34;</span><span class="op" id="3617045">,</span>&nbsp;<span class="op" id="3617047">&amp;</span><span class="ident" id="3617048"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3617053">{</span><span class="ident" id="3617054"><a href="/gostd/regexp/syntax/parse.go.html#3610551">ErrInvalidRepeatSize</a></span><span class="op" id="3617074">,</span>&nbsp;<span class="ident" id="3617076"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3617082">[</span><span class="op" id="3617083">:</span><span class="builtinfunc" id="3617084">len</span><span class="op" id="3617087">(</span><span class="ident" id="3617088"><a href="/gostd/regexp/syntax/parse.go.html#3616111">before</a></span><span class="op" id="3617094">)</span><span class="op" id="3617095">-</span><span class="builtinfunc" id="3617096">len</span><span class="op" id="3617099">(</span><span class="ident" id="3617100"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3617105">)</span><span class="op" id="3617106">]</span><span class="op" id="3617107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617114">return</span>&nbsp;<span class="ident" id="3617121"><a href="/gostd/regexp/syntax/parse.go.html#3616119">after</a></span><span class="op" id="3617126">,</span>&nbsp;<span class="builtintype" id="3617128">nil</span><br>
<span class="lineno"></span><span class="op" id="3617132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3617135">//&nbsp;repeatIsValid&nbsp;reports&nbsp;whether&nbsp;the&nbsp;repetition&nbsp;re&nbsp;is&nbsp;valid.</span><br>
<span class="lineno"></span><span class="comment" id="3617196">//&nbsp;Valid&nbsp;means&nbsp;that&nbsp;the&nbsp;combination&nbsp;of&nbsp;the&nbsp;top-level&nbsp;repetition</span><br>
<span class="lineno">265</span><span class="comment" id="3617260">//&nbsp;and&nbsp;any&nbsp;inner&nbsp;repetitions&nbsp;does&nbsp;not&nbsp;exceed&nbsp;n&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3617321">//&nbsp;innermost&nbsp;thing.</span><br>
<span class="lineno"></span><span class="comment" id="3617341">//&nbsp;This&nbsp;function&nbsp;rewalks&nbsp;the&nbsp;regexp&nbsp;tree&nbsp;and&nbsp;is&nbsp;called&nbsp;for&nbsp;every&nbsp;repetition,</span><br>
<span class="lineno"></span><span class="comment" id="3617418">//&nbsp;so&nbsp;we&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;inducing&nbsp;quadratic&nbsp;behavior&nbsp;in&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="comment" id="3617490">//&nbsp;We&nbsp;avoid&nbsp;this&nbsp;by&nbsp;only&nbsp;calling&nbsp;repeatIsValid&nbsp;when&nbsp;min&nbsp;or&nbsp;max&nbsp;&gt;=&nbsp;2.</span><br>
<span class="lineno">270</span><span class="comment" id="3617559">//&nbsp;In&nbsp;that&nbsp;case&nbsp;the&nbsp;depth&nbsp;of&nbsp;any&nbsp;&gt;=&nbsp;2&nbsp;nesting&nbsp;can&nbsp;only&nbsp;get&nbsp;to&nbsp;9&nbsp;without</span><br>
<span class="lineno"></span><span class="comment" id="3617631">//&nbsp;triggering&nbsp;a&nbsp;parse&nbsp;error,&nbsp;so&nbsp;each&nbsp;subtree&nbsp;can&nbsp;only&nbsp;be&nbsp;rewalked&nbsp;9&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="3617706">func</span>&nbsp;<span class="ident" id="3617711">repeatIsValid</span><span class="op" id="3617724">(</span><span class="ident" id="3617725">re</span>&nbsp;<span class="op" id="3617728">*</span><span class="ident" id="3617729"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3617735">,</span>&nbsp;<span class="ident" id="3617737">n</span>&nbsp;<span class="builtintype" id="3617739">int</span><span class="op" id="3617742">)</span>&nbsp;<span class="builtintype" id="3617744">bool</span>&nbsp;<span class="op" id="3617749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617752">if</span>&nbsp;<span class="ident" id="3617755"><a href="/gostd/regexp/syntax/parse.go.html#3617725">re</a></span><span class="op" id="3617757">.</span><span class="ident" id="3617758"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3617761">==</span>&nbsp;<span class="ident" id="3617764"><a href="/gostd/regexp/syntax/regexp.go.html#3668662">OpRepeat</a></span>&nbsp;<span class="op" id="3617773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617777">m</span>&nbsp;<span class="op" id="3617779">:=</span>&nbsp;<span class="ident" id="3617782"><a href="/gostd/regexp/syntax/parse.go.html#3617725">re</a></span><span class="op" id="3617784">.</span><span class="ident" id="3617785"><a href="/gostd/regexp/syntax/regexp.go.html#3667140">Max</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617791">if</span>&nbsp;<span class="ident" id="3617794"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span>&nbsp;<span class="op" id="3617796">==</span>&nbsp;<span class="num" id="3617799">0</span>&nbsp;<span class="op" id="3617801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617806">return</span>&nbsp;<span class="builtintype" id="3617813">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617824">if</span>&nbsp;<span class="ident" id="3617827"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span>&nbsp;<span class="op" id="3617829">&lt;</span>&nbsp;<span class="num" id="3617831">0</span>&nbsp;<span class="op" id="3617833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617838"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span>&nbsp;<span class="op" id="3617840">=</span>&nbsp;<span class="ident" id="3617842"><a href="/gostd/regexp/syntax/parse.go.html#3617725">re</a></span><span class="op" id="3617844">.</span><span class="ident" id="3617845"><a href="/gostd/regexp/syntax/regexp.go.html#3667135">Min</a></span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617851">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617855">if</span>&nbsp;<span class="ident" id="3617858"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span>&nbsp;<span class="op" id="3617860">&gt;</span>&nbsp;<span class="ident" id="3617862"><a href="/gostd/regexp/syntax/parse.go.html#3617737">n</a></span>&nbsp;<span class="op" id="3617864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617869">return</span>&nbsp;<span class="builtintype" id="3617876">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617888">if</span>&nbsp;<span class="ident" id="3617891"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span>&nbsp;<span class="op" id="3617893">&gt;</span>&nbsp;<span class="num" id="3617895">0</span>&nbsp;<span class="op" id="3617897">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3617902"><a href="/gostd/regexp/syntax/parse.go.html#3617737">n</a></span>&nbsp;<span class="op" id="3617904">/=</span>&nbsp;<span class="ident" id="3617907"><a href="/gostd/regexp/syntax/parse.go.html#3617777">m</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617917">for</span>&nbsp;<span class="ident" id="3617921">_</span><span class="op" id="3617922">,</span>&nbsp;<span class="ident" id="3617924">sub</span>&nbsp;<span class="op" id="3617928">:=</span>&nbsp;<span class="keyword" id="3617931">range</span>&nbsp;<span class="ident" id="3617937"><a href="/gostd/regexp/syntax/parse.go.html#3617725">re</a></span><span class="op" id="3617939">.</span><span class="ident" id="3617940"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3617944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617948">if</span>&nbsp;<span class="op" id="3617951">!</span><span class="ident" id="3617952"><a href="/gostd/regexp/syntax/parse.go.html#3617711">repeatIsValid</a></span><span class="op" id="3617965">(</span><span class="ident" id="3617966"><a href="/gostd/regexp/syntax/parse.go.html#3617924">sub</a></span><span class="op" id="3617969">,</span>&nbsp;<span class="ident" id="3617971"><a href="/gostd/regexp/syntax/parse.go.html#3617737">n</a></span><span class="op" id="3617972">)</span>&nbsp;<span class="op" id="3617974">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3617979">return</span>&nbsp;<span class="builtintype" id="3617986">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3617997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618000">return</span>&nbsp;<span class="builtintype" id="3618007">true</span><br>
<span class="lineno"></span><span class="op" id="3618012">}</span><br>
<span class="lineno">295</span><br>
<span class="lineno"></span><span class="comment" id="3618015">//&nbsp;concat&nbsp;replaces&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;(above&nbsp;the&nbsp;topmost&nbsp;&#39;|&#39;&nbsp;or&nbsp;&#39;(&#39;)&nbsp;with&nbsp;its&nbsp;concatenation.</span><br>
<span class="lineno"></span><span class="keyword" id="3618110">func</span>&nbsp;<span class="op" id="3618115">(</span><span class="ident" id="3618116">p</span>&nbsp;<span class="op" id="3618118">*</span><span class="ident" id="3618119"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3618125">)</span>&nbsp;<span class="ident" id="3618127">concat</span><span class="op" id="3618133">(</span><span class="op" id="3618134">)</span>&nbsp;<span class="op" id="3618136">*</span><span class="ident" id="3618137"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3618144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618147"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618148">.</span><span class="ident" id="3618149"><a href="/gostd/regexp/syntax/parse.go.html#3614369">maybeConcat</a></span><span class="op" id="3618160">(</span><span class="op" id="3618161">-</span><span class="num" id="3618162">1</span><span class="op" id="3618163">,</span>&nbsp;<span class="num" id="3618165">0</span><span class="op" id="3618166">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618170">//&nbsp;Scan&nbsp;down&nbsp;to&nbsp;find&nbsp;pseudo-operator&nbsp;|&nbsp;or&nbsp;(.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618216">i</span>&nbsp;<span class="op" id="3618218">:=</span>&nbsp;<span class="builtinfunc" id="3618221">len</span><span class="op" id="3618224">(</span><span class="ident" id="3618225"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618226">.</span><span class="ident" id="3618227"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618235">for</span>&nbsp;<span class="ident" id="3618239"><a href="/gostd/regexp/syntax/parse.go.html#3618216">i</a></span>&nbsp;<span class="op" id="3618241">&gt;</span>&nbsp;<span class="num" id="3618243">0</span>&nbsp;<span class="op" id="3618245">&amp;&amp;</span>&nbsp;<span class="ident" id="3618248"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618249">.</span><span class="ident" id="3618250"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618255">[</span><span class="ident" id="3618256"><a href="/gostd/regexp/syntax/parse.go.html#3618216">i</a></span><span class="op" id="3618257">-</span><span class="num" id="3618258">1</span><span class="op" id="3618259">]</span><span class="op" id="3618260">.</span><span class="ident" id="3618261"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3618264">&lt;</span>&nbsp;<span class="ident" id="3618266"><a href="/gostd/regexp/syntax/regexp.go.html#3668904">opPseudo</a></span>&nbsp;<span class="op" id="3618275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618279"><a href="/gostd/regexp/syntax/parse.go.html#3618216">i</a></span><span class="op" id="3618280">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618284">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618287">subs</span>&nbsp;<span class="op" id="3618292">:=</span>&nbsp;<span class="ident" id="3618295"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618296">.</span><span class="ident" id="3618297"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618302">[</span><span class="ident" id="3618303"><a href="/gostd/regexp/syntax/parse.go.html#3618216">i</a></span><span class="op" id="3618304">:</span><span class="op" id="3618305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618308"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618309">.</span><span class="ident" id="3618310"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3618316">=</span>&nbsp;<span class="ident" id="3618318"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618319">.</span><span class="ident" id="3618320"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618325">[</span><span class="op" id="3618326">:</span><span class="ident" id="3618327"><a href="/gostd/regexp/syntax/parse.go.html#3618216">i</a></span><span class="op" id="3618328">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618332">//&nbsp;Empty&nbsp;concatenation&nbsp;is&nbsp;special&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618373">if</span>&nbsp;<span class="builtinfunc" id="3618376">len</span><span class="op" id="3618379">(</span><span class="ident" id="3618380"><a href="/gostd/regexp/syntax/parse.go.html#3618287">subs</a></span><span class="op" id="3618384">)</span>&nbsp;<span class="op" id="3618386">==</span>&nbsp;<span class="num" id="3618389">0</span>&nbsp;<span class="op" id="3618391">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618395">return</span>&nbsp;<span class="ident" id="3618402"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618403">.</span><span class="ident" id="3618404"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3618408">(</span><span class="ident" id="3618409"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618410">.</span><span class="ident" id="3618411"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3618420">(</span><span class="ident" id="3618421"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span><span class="op" id="3618433">)</span><span class="op" id="3618434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618441">return</span>&nbsp;<span class="ident" id="3618448"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618449">.</span><span class="ident" id="3618450"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3618454">(</span><span class="ident" id="3618455"><a href="/gostd/regexp/syntax/parse.go.html#3618116">p</a></span><span class="op" id="3618456">.</span><span class="ident" id="3618457"><a href="/gostd/regexp/syntax/parse.go.html#3619993">collapse</a></span><span class="op" id="3618465">(</span><span class="ident" id="3618466"><a href="/gostd/regexp/syntax/parse.go.html#3618287">subs</a></span><span class="op" id="3618470">,</span>&nbsp;<span class="ident" id="3618472"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span><span class="op" id="3618480">)</span><span class="op" id="3618481">)</span><br>
<span class="lineno"></span><span class="op" id="3618483">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="3618486">//&nbsp;alternate&nbsp;replaces&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;(above&nbsp;the&nbsp;topmost&nbsp;&#39;(&#39;)&nbsp;with&nbsp;its&nbsp;alternation.</span><br>
<span class="lineno"></span><span class="keyword" id="3618575">func</span>&nbsp;<span class="op" id="3618580">(</span><span class="ident" id="3618581">p</span>&nbsp;<span class="op" id="3618583">*</span><span class="ident" id="3618584"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3618590">)</span>&nbsp;<span class="ident" id="3618592">alternate</span><span class="op" id="3618601">(</span><span class="op" id="3618602">)</span>&nbsp;<span class="op" id="3618604">*</span><span class="ident" id="3618605"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3618612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618615">//&nbsp;Scan&nbsp;down&nbsp;to&nbsp;find&nbsp;pseudo-operator&nbsp;(.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618656">//&nbsp;There&nbsp;are&nbsp;no&nbsp;|&nbsp;above&nbsp;(.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618684">i</span>&nbsp;<span class="op" id="3618686">:=</span>&nbsp;<span class="builtinfunc" id="3618689">len</span><span class="op" id="3618692">(</span><span class="ident" id="3618693"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3618694">.</span><span class="ident" id="3618695"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618703">for</span>&nbsp;<span class="ident" id="3618707"><a href="/gostd/regexp/syntax/parse.go.html#3618684">i</a></span>&nbsp;<span class="op" id="3618709">&gt;</span>&nbsp;<span class="num" id="3618711">0</span>&nbsp;<span class="op" id="3618713">&amp;&amp;</span>&nbsp;<span class="ident" id="3618716"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3618717">.</span><span class="ident" id="3618718"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618723">[</span><span class="ident" id="3618724"><a href="/gostd/regexp/syntax/parse.go.html#3618684">i</a></span><span class="op" id="3618725">-</span><span class="num" id="3618726">1</span><span class="op" id="3618727">]</span><span class="op" id="3618728">.</span><span class="ident" id="3618729"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3618732">&lt;</span>&nbsp;<span class="ident" id="3618734"><a href="/gostd/regexp/syntax/regexp.go.html#3668904">opPseudo</a></span>&nbsp;<span class="op" id="3618743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618747"><a href="/gostd/regexp/syntax/parse.go.html#3618684">i</a></span><span class="op" id="3618748">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618755">subs</span>&nbsp;<span class="op" id="3618760">:=</span>&nbsp;<span class="ident" id="3618763"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3618764">.</span><span class="ident" id="3618765"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618770">[</span><span class="ident" id="3618771"><a href="/gostd/regexp/syntax/parse.go.html#3618684">i</a></span><span class="op" id="3618772">:</span><span class="op" id="3618773">]</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618776"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3618777">.</span><span class="ident" id="3618778"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3618784">=</span>&nbsp;<span class="ident" id="3618786"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3618787">.</span><span class="ident" id="3618788"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3618793">[</span><span class="op" id="3618794">:</span><span class="ident" id="3618795"><a href="/gostd/regexp/syntax/parse.go.html#3618684">i</a></span><span class="op" id="3618796">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618800">//&nbsp;Make&nbsp;sure&nbsp;top&nbsp;class&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618834">//&nbsp;All&nbsp;the&nbsp;others&nbsp;already&nbsp;are&nbsp;(see&nbsp;swapVerticalBar).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3618888">if</span>&nbsp;<span class="builtinfunc" id="3618891">len</span><span class="op" id="3618894">(</span><span class="ident" id="3618895"><a href="/gostd/regexp/syntax/parse.go.html#3618755">subs</a></span><span class="op" id="3618899">)</span>&nbsp;<span class="op" id="3618901">&gt;</span>&nbsp;<span class="num" id="3618903">0</span>&nbsp;<span class="op" id="3618905">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3618909"><a href="/gostd/regexp/syntax/parse.go.html#3619203">cleanAlt</a></span><span class="op" id="3618917">(</span><span class="ident" id="3618918"><a href="/gostd/regexp/syntax/parse.go.html#3618755">subs</a></span><span class="op" id="3618922">[</span><span class="builtinfunc" id="3618923">len</span><span class="op" id="3618926">(</span><span class="ident" id="3618927"><a href="/gostd/regexp/syntax/parse.go.html#3618755">subs</a></span><span class="op" id="3618931">)</span><span class="op" id="3618932">-</span><span class="num" id="3618933">1</span><span class="op" id="3618934">]</span><span class="op" id="3618935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3618938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618942">//&nbsp;Empty&nbsp;alternate&nbsp;is&nbsp;special&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3618978">//&nbsp;(shouldn&#39;t&nbsp;happen&nbsp;but&nbsp;easy&nbsp;to&nbsp;handle).</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619021">if</span>&nbsp;<span class="builtinfunc" id="3619024">len</span><span class="op" id="3619027">(</span><span class="ident" id="3619028"><a href="/gostd/regexp/syntax/parse.go.html#3618755">subs</a></span><span class="op" id="3619032">)</span>&nbsp;<span class="op" id="3619034">==</span>&nbsp;<span class="num" id="3619037">0</span>&nbsp;<span class="op" id="3619039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619043">return</span>&nbsp;<span class="ident" id="3619050"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3619051">.</span><span class="ident" id="3619052"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3619056">(</span><span class="ident" id="3619057"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3619058">.</span><span class="ident" id="3619059"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3619068">(</span><span class="ident" id="3619069"><a href="/gostd/regexp/syntax/regexp.go.html#3667562">OpNoMatch</a></span><span class="op" id="3619078">)</span><span class="op" id="3619079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619086">return</span>&nbsp;<span class="ident" id="3619093"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3619094">.</span><span class="ident" id="3619095"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3619099">(</span><span class="ident" id="3619100"><a href="/gostd/regexp/syntax/parse.go.html#3618581">p</a></span><span class="op" id="3619101">.</span><span class="ident" id="3619102"><a href="/gostd/regexp/syntax/parse.go.html#3619993">collapse</a></span><span class="op" id="3619110">(</span><span class="ident" id="3619111"><a href="/gostd/regexp/syntax/parse.go.html#3618755">subs</a></span><span class="op" id="3619115">,</span>&nbsp;<span class="ident" id="3619117"><a href="/gostd/regexp/syntax/regexp.go.html#3668833">OpAlternate</a></span><span class="op" id="3619128">)</span><span class="op" id="3619129">)</span><br>
<span class="lineno">340</span><span class="op" id="3619131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3619134">//&nbsp;cleanAlt&nbsp;cleans&nbsp;re&nbsp;for&nbsp;eventual&nbsp;inclusion&nbsp;in&nbsp;an&nbsp;alternation.</span><br>
<span class="lineno"></span><span class="keyword" id="3619198">func</span>&nbsp;<span class="ident" id="3619203">cleanAlt</span><span class="op" id="3619211">(</span><span class="ident" id="3619212">re</span>&nbsp;<span class="op" id="3619215">*</span><span class="ident" id="3619216"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3619222">)</span>&nbsp;<span class="op" id="3619224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619227">switch</span>&nbsp;<span class="ident" id="3619234"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619236">.</span><span class="ident" id="3619237"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3619240">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619243">case</span>&nbsp;<span class="ident" id="3619248"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><span class="op" id="3619259">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619263"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619265">.</span><span class="ident" id="3619266"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3619271">=</span>&nbsp;<span class="ident" id="3619273"><a href="/gostd/regexp/syntax/parse.go.html#3649602">cleanClass</a></span><span class="op" id="3619283">(</span><span class="op" id="3619284">&amp;</span><span class="ident" id="3619285"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619287">.</span><span class="ident" id="3619288"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619296">if</span>&nbsp;<span class="builtinfunc" id="3619299">len</span><span class="op" id="3619302">(</span><span class="ident" id="3619303"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619305">.</span><span class="ident" id="3619306"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619310">)</span>&nbsp;<span class="op" id="3619312">==</span>&nbsp;<span class="num" id="3619315">2</span>&nbsp;<span class="op" id="3619317">&amp;&amp;</span>&nbsp;<span class="ident" id="3619320"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619322">.</span><span class="ident" id="3619323"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619327">[</span><span class="num" id="3619328">0</span><span class="op" id="3619329">]</span>&nbsp;<span class="op" id="3619331">==</span>&nbsp;<span class="num" id="3619334">0</span>&nbsp;<span class="op" id="3619336">&amp;&amp;</span>&nbsp;<span class="ident" id="3619339"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619341">.</span><span class="ident" id="3619342"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619346">[</span><span class="num" id="3619347">1</span><span class="op" id="3619348">]</span>&nbsp;<span class="op" id="3619350">==</span>&nbsp;<span class="ident" id="3619353"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3619360">.</span><span class="ident" id="3619361"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3619369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619374"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619376">.</span><span class="ident" id="3619377"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3619382">=</span>&nbsp;<span class="builtintype" id="3619384">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619391"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619393">.</span><span class="ident" id="3619394"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3619397">=</span>&nbsp;<span class="ident" id="3619399"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619412">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619425">if</span>&nbsp;<span class="builtinfunc" id="3619428">len</span><span class="op" id="3619431">(</span><span class="ident" id="3619432"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619434">.</span><span class="ident" id="3619435"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619439">)</span>&nbsp;<span class="op" id="3619441">==</span>&nbsp;<span class="num" id="3619444">4</span>&nbsp;<span class="op" id="3619446">&amp;&amp;</span>&nbsp;<span class="ident" id="3619449"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619451">.</span><span class="ident" id="3619452"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619456">[</span><span class="num" id="3619457">0</span><span class="op" id="3619458">]</span>&nbsp;<span class="op" id="3619460">==</span>&nbsp;<span class="num" id="3619463">0</span>&nbsp;<span class="op" id="3619465">&amp;&amp;</span>&nbsp;<span class="ident" id="3619468"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619470">.</span><span class="ident" id="3619471"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619475">[</span><span class="num" id="3619476">1</span><span class="op" id="3619477">]</span>&nbsp;<span class="op" id="3619479">==</span>&nbsp;<span class="string" id="3619482">&#39;\n&#39;</span><span class="op" id="3619486">-</span><span class="num" id="3619487">1</span>&nbsp;<span class="op" id="3619489">&amp;&amp;</span>&nbsp;<span class="ident" id="3619492"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619494">.</span><span class="ident" id="3619495"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619499">[</span><span class="num" id="3619500">2</span><span class="op" id="3619501">]</span>&nbsp;<span class="op" id="3619503">==</span>&nbsp;<span class="string" id="3619506">&#39;\n&#39;</span><span class="op" id="3619510">+</span><span class="num" id="3619511">1</span>&nbsp;<span class="op" id="3619513">&amp;&amp;</span>&nbsp;<span class="ident" id="3619516"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619518">.</span><span class="ident" id="3619519"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619523">[</span><span class="num" id="3619524">3</span><span class="op" id="3619525">]</span>&nbsp;<span class="op" id="3619527">==</span>&nbsp;<span class="ident" id="3619530"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3619537">.</span><span class="ident" id="3619538"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3619546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619551"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619553">.</span><span class="ident" id="3619554"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3619559">=</span>&nbsp;<span class="builtintype" id="3619561">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619568"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619570">.</span><span class="ident" id="3619571"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3619574">=</span>&nbsp;<span class="ident" id="3619576"><a href="/gostd/regexp/syntax/regexp.go.html#3667810">OpAnyCharNotNL</a></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619594">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3619607">if</span>&nbsp;<span class="builtinfunc" id="3619610">cap</span><span class="op" id="3619613">(</span><span class="ident" id="3619614"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619616">.</span><span class="ident" id="3619617"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619621">)</span><span class="op" id="3619622">-</span><span class="builtinfunc" id="3619623">len</span><span class="op" id="3619626">(</span><span class="ident" id="3619627"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619629">.</span><span class="ident" id="3619630"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619634">)</span>&nbsp;<span class="op" id="3619636">&gt;</span>&nbsp;<span class="num" id="3619638">100</span>&nbsp;<span class="op" id="3619642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3619647">//&nbsp;re.Rune&nbsp;will&nbsp;not&nbsp;grow&nbsp;any&nbsp;more.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3619685">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;or&nbsp;inline&nbsp;to&nbsp;reclaim&nbsp;storage.</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3619733"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619735">.</span><span class="ident" id="3619736"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3619741">=</span>&nbsp;<span class="builtinfunc" id="3619743">append</span><span class="op" id="3619749">(</span><span class="ident" id="3619750"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619752">.</span><span class="ident" id="3619753"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3619758">[</span><span class="op" id="3619759">:</span><span class="num" id="3619760">0</span><span class="op" id="3619761">]</span><span class="op" id="3619762">,</span>&nbsp;<span class="ident" id="3619764"><a href="/gostd/regexp/syntax/parse.go.html#3619212">re</a></span><span class="op" id="3619766">.</span><span class="ident" id="3619767"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3619771">...</span><span class="op" id="3619774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3619781">}</span><br>
<span class="lineno"></span><span class="op" id="3619783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="3619786">//&nbsp;collapse&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;applying&nbsp;op&nbsp;to&nbsp;sub.</span><br>
<span class="lineno"></span><span class="comment" id="3619840">//&nbsp;If&nbsp;sub&nbsp;contains&nbsp;op&nbsp;nodes,&nbsp;they&nbsp;all&nbsp;get&nbsp;hoisted&nbsp;up</span><br>
<span class="lineno"></span><span class="comment" id="3619893">//&nbsp;so&nbsp;that&nbsp;there&nbsp;is&nbsp;never&nbsp;a&nbsp;concat&nbsp;of&nbsp;a&nbsp;concat&nbsp;or&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="3619946">//&nbsp;alternate&nbsp;of&nbsp;an&nbsp;alternate.</span><br>
<span class="lineno"></span><span class="keyword" id="3619976">func</span>&nbsp;<span class="op" id="3619981">(</span><span class="ident" id="3619982">p</span>&nbsp;<span class="op" id="3619984">*</span><span class="ident" id="3619985"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3619991">)</span>&nbsp;<span class="ident" id="3619993">collapse</span><span class="op" id="3620001">(</span><span class="ident" id="3620002">subs</span>&nbsp;<span class="op" id="3620007">[</span><span class="op" id="3620008">]</span><span class="op" id="3620009">*</span><span class="ident" id="3620010"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3620016">,</span>&nbsp;<span class="ident" id="3620018">op</span>&nbsp;<span class="ident" id="3620021"><a href="/gostd/regexp/syntax/regexp.go.html#3667347">Op</a></span><span class="op" id="3620023">)</span>&nbsp;<span class="op" id="3620025">*</span><span class="ident" id="3620026"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3620033">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620036">if</span>&nbsp;<span class="builtinfunc" id="3620039">len</span><span class="op" id="3620042">(</span><span class="ident" id="3620043"><a href="/gostd/regexp/syntax/parse.go.html#3620002">subs</a></span><span class="op" id="3620047">)</span>&nbsp;<span class="op" id="3620049">==</span>&nbsp;<span class="num" id="3620052">1</span>&nbsp;<span class="op" id="3620054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620058">return</span>&nbsp;<span class="ident" id="3620065"><a href="/gostd/regexp/syntax/parse.go.html#3620002">subs</a></span><span class="op" id="3620069">[</span><span class="num" id="3620070">0</span><span class="op" id="3620071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620077">re</span>&nbsp;<span class="op" id="3620080">:=</span>&nbsp;<span class="ident" id="3620083"><a href="/gostd/regexp/syntax/parse.go.html#3619982">p</a></span><span class="op" id="3620084">.</span><span class="ident" id="3620085"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3620094">(</span><span class="ident" id="3620095"><a href="/gostd/regexp/syntax/parse.go.html#3620018">op</a></span><span class="op" id="3620097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620100"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620102">.</span><span class="ident" id="3620103"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3620107">=</span>&nbsp;<span class="ident" id="3620109"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620111">.</span><span class="ident" id="3620112"><a href="/gostd/regexp/syntax/regexp.go.html#3666976">Sub0</a></span><span class="op" id="3620116">[</span><span class="op" id="3620117">:</span><span class="num" id="3620118">0</span><span class="op" id="3620119">]</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620122">for</span>&nbsp;<span class="ident" id="3620126">_</span><span class="op" id="3620127">,</span>&nbsp;<span class="ident" id="3620129">sub</span>&nbsp;<span class="op" id="3620133">:=</span>&nbsp;<span class="keyword" id="3620136">range</span>&nbsp;<span class="ident" id="3620142"><a href="/gostd/regexp/syntax/parse.go.html#3620002">subs</a></span>&nbsp;<span class="op" id="3620147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620151">if</span>&nbsp;<span class="ident" id="3620154"><a href="/gostd/regexp/syntax/parse.go.html#3620129">sub</a></span><span class="op" id="3620157">.</span><span class="ident" id="3620158"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3620161">==</span>&nbsp;<span class="ident" id="3620164"><a href="/gostd/regexp/syntax/parse.go.html#3620018">op</a></span>&nbsp;<span class="op" id="3620167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620172"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620174">.</span><span class="ident" id="3620175"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3620179">=</span>&nbsp;<span class="builtinfunc" id="3620181">append</span><span class="op" id="3620187">(</span><span class="ident" id="3620188"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620190">.</span><span class="ident" id="3620191"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620194">,</span>&nbsp;<span class="ident" id="3620196"><a href="/gostd/regexp/syntax/parse.go.html#3620129">sub</a></span><span class="op" id="3620199">.</span><span class="ident" id="3620200"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620203">...</span><span class="op" id="3620206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620211"><a href="/gostd/regexp/syntax/parse.go.html#3619982">p</a></span><span class="op" id="3620212">.</span><span class="ident" id="3620213"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3620218">(</span><span class="ident" id="3620219"><a href="/gostd/regexp/syntax/parse.go.html#3620129">sub</a></span><span class="op" id="3620222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620226">}</span>&nbsp;<span class="keyword" id="3620228">else</span>&nbsp;<span class="op" id="3620233">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620238"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620240">.</span><span class="ident" id="3620241"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3620245">=</span>&nbsp;<span class="builtinfunc" id="3620247">append</span><span class="op" id="3620253">(</span><span class="ident" id="3620254"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620256">.</span><span class="ident" id="3620257"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620260">,</span>&nbsp;<span class="ident" id="3620262"><a href="/gostd/regexp/syntax/parse.go.html#3620129">sub</a></span><span class="op" id="3620265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620275">if</span>&nbsp;<span class="ident" id="3620278"><a href="/gostd/regexp/syntax/parse.go.html#3620018">op</a></span>&nbsp;<span class="op" id="3620281">==</span>&nbsp;<span class="ident" id="3620284"><a href="/gostd/regexp/syntax/regexp.go.html#3668833">OpAlternate</a></span>&nbsp;<span class="op" id="3620296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620300"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620302">.</span><span class="ident" id="3620303"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3620307">=</span>&nbsp;<span class="ident" id="3620309"><a href="/gostd/regexp/syntax/parse.go.html#3619982">p</a></span><span class="op" id="3620310">.</span><span class="ident" id="3620311"><a href="/gostd/regexp/syntax/parse.go.html#3620831">factor</a></span><span class="op" id="3620317">(</span><span class="ident" id="3620318"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620320">.</span><span class="ident" id="3620321"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620324">,</span>&nbsp;<span class="ident" id="3620326"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620328">.</span><span class="ident" id="3620329"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3620334">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620338">if</span>&nbsp;<span class="builtinfunc" id="3620341">len</span><span class="op" id="3620344">(</span><span class="ident" id="3620345"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620347">.</span><span class="ident" id="3620348"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620351">)</span>&nbsp;<span class="op" id="3620353">==</span>&nbsp;<span class="num" id="3620356">1</span>&nbsp;<span class="op" id="3620358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620363">old</span>&nbsp;<span class="op" id="3620367">:=</span>&nbsp;<span class="ident" id="3620370"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620376"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span>&nbsp;<span class="op" id="3620379">=</span>&nbsp;<span class="ident" id="3620381"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><span class="op" id="3620383">.</span><span class="ident" id="3620384"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3620387">[</span><span class="num" id="3620388">0</span><span class="op" id="3620389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3620394"><a href="/gostd/regexp/syntax/parse.go.html#3619982">p</a></span><span class="op" id="3620395">.</span><span class="ident" id="3620396"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3620401">(</span><span class="ident" id="3620402"><a href="/gostd/regexp/syntax/parse.go.html#3620363">old</a></span><span class="op" id="3620405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620409">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620415">return</span>&nbsp;<span class="ident" id="3620422"><a href="/gostd/regexp/syntax/parse.go.html#3620077">re</a></span><br>
<span class="lineno"></span><span class="op" id="3620425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3620428">//&nbsp;factor&nbsp;factors&nbsp;common&nbsp;prefixes&nbsp;from&nbsp;the&nbsp;alternation&nbsp;list&nbsp;sub.</span><br>
<span class="lineno">395</span><span class="comment" id="3620493">//&nbsp;It&nbsp;returns&nbsp;a&nbsp;replacement&nbsp;list&nbsp;that&nbsp;reuses&nbsp;the&nbsp;same&nbsp;storage&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3620559">//&nbsp;frees&nbsp;(passes&nbsp;to&nbsp;p.reuse)&nbsp;any&nbsp;removed&nbsp;*Regexps.</span><br>
<span class="lineno"></span><span class="comment" id="3620610">//</span><br>
<span class="lineno"></span><span class="comment" id="3620613">//&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span><span class="comment" id="3620629">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ABC|ABD|AEF|BCX|BCY</span><br>
<span class="lineno">400</span><span class="comment" id="3620656">//&nbsp;simplifies&nbsp;by&nbsp;literal&nbsp;prefix&nbsp;extraction&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3620702">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(B(C|D)|EF)|BC(X|Y)</span><br>
<span class="lineno"></span><span class="comment" id="3620730">//&nbsp;which&nbsp;simplifies&nbsp;by&nbsp;character&nbsp;class&nbsp;introduction&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3620785">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A(B[CD]|EF)|BC[XY]</span><br>
<span class="lineno"></span><span class="comment" id="3620811">//</span><br>
<span class="lineno">405</span><span class="keyword" id="3620814">func</span>&nbsp;<span class="op" id="3620819">(</span><span class="ident" id="3620820">p</span>&nbsp;<span class="op" id="3620822">*</span><span class="ident" id="3620823"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3620829">)</span>&nbsp;<span class="ident" id="3620831">factor</span><span class="op" id="3620837">(</span><span class="ident" id="3620838">sub</span>&nbsp;<span class="op" id="3620842">[</span><span class="op" id="3620843">]</span><span class="op" id="3620844">*</span><span class="ident" id="3620845"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3620851">,</span>&nbsp;<span class="ident" id="3620853">flags</span>&nbsp;<span class="ident" id="3620859"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3620864">)</span>&nbsp;<span class="op" id="3620866">[</span><span class="op" id="3620867">]</span><span class="op" id="3620868">*</span><span class="ident" id="3620869"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3620876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620879">if</span>&nbsp;<span class="builtinfunc" id="3620882">len</span><span class="op" id="3620885">(</span><span class="ident" id="3620886"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3620889">)</span>&nbsp;<span class="op" id="3620891">&lt;</span>&nbsp;<span class="num" id="3620893">2</span>&nbsp;<span class="op" id="3620895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620899">return</span>&nbsp;<span class="ident" id="3620906"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3620911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3620915">//&nbsp;Round&nbsp;1:&nbsp;Factor&nbsp;out&nbsp;common&nbsp;literal&nbsp;prefixes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620964">var</span>&nbsp;<span class="ident" id="3620968">str</span>&nbsp;<span class="op" id="3620972">[</span><span class="op" id="3620973">]</span><span class="builtintype" id="3620974">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3620980">var</span>&nbsp;<span class="ident" id="3620984">strflags</span>&nbsp;<span class="ident" id="3620993"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621000">start</span>&nbsp;<span class="op" id="3621006">:=</span>&nbsp;<span class="num" id="3621009">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621012">out</span>&nbsp;<span class="op" id="3621016">:=</span>&nbsp;<span class="ident" id="3621019"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3621022">[</span><span class="op" id="3621023">:</span><span class="num" id="3621024">0</span><span class="op" id="3621025">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621028">for</span>&nbsp;<span class="ident" id="3621032">i</span>&nbsp;<span class="op" id="3621034">:=</span>&nbsp;<span class="num" id="3621037">0</span><span class="op" id="3621038">;</span>&nbsp;<span class="ident" id="3621040"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span>&nbsp;<span class="op" id="3621042">&lt;=</span>&nbsp;<span class="builtinfunc" id="3621045">len</span><span class="op" id="3621048">(</span><span class="ident" id="3621049"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3621052">)</span><span class="op" id="3621053">;</span>&nbsp;<span class="ident" id="3621055"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span><span class="op" id="3621056">++</span>&nbsp;<span class="op" id="3621059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621063">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621127">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621194">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621228">//</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621233">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;all&nbsp;begin</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621297">//&nbsp;with&nbsp;str&nbsp;as&nbsp;modified&nbsp;by&nbsp;strflags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621336">var</span>&nbsp;<span class="ident" id="3621340">istr</span>&nbsp;<span class="op" id="3621345">[</span><span class="op" id="3621346">]</span><span class="builtintype" id="3621347">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621354">var</span>&nbsp;<span class="ident" id="3621358">iflags</span>&nbsp;<span class="ident" id="3621365"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621373">if</span>&nbsp;<span class="ident" id="3621376"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span>&nbsp;<span class="op" id="3621378">&lt;</span>&nbsp;<span class="builtinfunc" id="3621380">len</span><span class="op" id="3621383">(</span><span class="ident" id="3621384"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3621387">)</span>&nbsp;<span class="op" id="3621389">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621394"><a href="/gostd/regexp/syntax/parse.go.html#3621340">istr</a></span><span class="op" id="3621398">,</span>&nbsp;<span class="ident" id="3621400"><a href="/gostd/regexp/syntax/parse.go.html#3621358">iflags</a></span>&nbsp;<span class="op" id="3621407">=</span>&nbsp;<span class="ident" id="3621409"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3621410">.</span><span class="ident" id="3621411"><a href="/gostd/regexp/syntax/parse.go.html#3625768">leadingString</a></span><span class="op" id="3621424">(</span><span class="ident" id="3621425"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3621428">[</span><span class="ident" id="3621429"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span><span class="op" id="3621430">]</span><span class="op" id="3621431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621436">if</span>&nbsp;<span class="ident" id="3621439"><a href="/gostd/regexp/syntax/parse.go.html#3621358">iflags</a></span>&nbsp;<span class="op" id="3621446">==</span>&nbsp;<span class="ident" id="3621449"><a href="/gostd/regexp/syntax/parse.go.html#3620984">strflags</a></span>&nbsp;<span class="op" id="3621458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621464">same</span>&nbsp;<span class="op" id="3621469">:=</span>&nbsp;<span class="num" id="3621472">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621478">for</span>&nbsp;<span class="ident" id="3621482"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span>&nbsp;<span class="op" id="3621487">&lt;</span>&nbsp;<span class="builtinfunc" id="3621489">len</span><span class="op" id="3621492">(</span><span class="ident" id="3621493"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span><span class="op" id="3621496">)</span>&nbsp;<span class="op" id="3621498">&amp;&amp;</span>&nbsp;<span class="ident" id="3621501"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span>&nbsp;<span class="op" id="3621506">&lt;</span>&nbsp;<span class="builtinfunc" id="3621508">len</span><span class="op" id="3621511">(</span><span class="ident" id="3621512"><a href="/gostd/regexp/syntax/parse.go.html#3621340">istr</a></span><span class="op" id="3621516">)</span>&nbsp;<span class="op" id="3621518">&amp;&amp;</span>&nbsp;<span class="ident" id="3621521"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span><span class="op" id="3621524">[</span><span class="ident" id="3621525"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span><span class="op" id="3621529">]</span>&nbsp;<span class="op" id="3621531">==</span>&nbsp;<span class="ident" id="3621534"><a href="/gostd/regexp/syntax/parse.go.html#3621340">istr</a></span><span class="op" id="3621538">[</span><span class="ident" id="3621539"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span><span class="op" id="3621543">]</span>&nbsp;<span class="op" id="3621545">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621552"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span><span class="op" id="3621556">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621569">if</span>&nbsp;<span class="ident" id="3621572"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span>&nbsp;<span class="op" id="3621577">&gt;</span>&nbsp;<span class="num" id="3621579">0</span>&nbsp;<span class="op" id="3621581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621588">//&nbsp;Matches&nbsp;at&nbsp;least&nbsp;one&nbsp;rune&nbsp;in&nbsp;current&nbsp;range.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621640">//&nbsp;Keep&nbsp;going&nbsp;around.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3621667"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span>&nbsp;<span class="op" id="3621671">=</span>&nbsp;<span class="ident" id="3621673"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span><span class="op" id="3621676">[</span><span class="op" id="3621677">:</span><span class="ident" id="3621678"><a href="/gostd/regexp/syntax/parse.go.html#3621464">same</a></span><span class="op" id="3621682">]</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621689">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3621711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621716">//&nbsp;Found&nbsp;end&nbsp;of&nbsp;a&nbsp;run&nbsp;with&nbsp;common&nbsp;leading&nbsp;literal&nbsp;string:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621776">//&nbsp;sub[start:i]&nbsp;all&nbsp;begin&nbsp;with&nbsp;str[0:len(str)],&nbsp;but&nbsp;sub[i]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621837">//&nbsp;does&nbsp;not&nbsp;even&nbsp;begin&nbsp;with&nbsp;str[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621875">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621880">//&nbsp;Factor&nbsp;out&nbsp;common&nbsp;string&nbsp;and&nbsp;append&nbsp;factored&nbsp;expression&nbsp;to&nbsp;out.</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3621949">if</span>&nbsp;<span class="ident" id="3621952"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span>&nbsp;<span class="op" id="3621954">==</span>&nbsp;<span class="ident" id="3621957"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3621963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3621968">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622006">}</span>&nbsp;<span class="keyword" id="3622008">else</span>&nbsp;<span class="keyword" id="3622013">if</span>&nbsp;<span class="ident" id="3622016"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span>&nbsp;<span class="op" id="3622018">==</span>&nbsp;<span class="ident" id="3622021"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3622026">+</span><span class="num" id="3622027">1</span>&nbsp;<span class="op" id="3622029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622034">//&nbsp;Just&nbsp;one:&nbsp;don&#39;t&nbsp;bother&nbsp;factoring.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622074"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3622078">=</span>&nbsp;<span class="builtinfunc" id="3622080">append</span><span class="op" id="3622086">(</span><span class="ident" id="3622087"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3622090">,</span>&nbsp;<span class="ident" id="3622092"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622095">[</span><span class="ident" id="3622096"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3622101">]</span><span class="op" id="3622102">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622106">}</span>&nbsp;<span class="keyword" id="3622108">else</span>&nbsp;<span class="op" id="3622113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622118">//&nbsp;Construct&nbsp;factored&nbsp;form:&nbsp;prefix(suffix1|suffix2|...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622177">prefix</span>&nbsp;<span class="op" id="3622184">:=</span>&nbsp;<span class="ident" id="3622187"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3622188">.</span><span class="ident" id="3622189"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3622198">(</span><span class="ident" id="3622199"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><span class="op" id="3622208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622213"><a href="/gostd/regexp/syntax/parse.go.html#3622177">prefix</a></span><span class="op" id="3622219">.</span><span class="ident" id="3622220"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3622226">=</span>&nbsp;<span class="ident" id="3622228"><a href="/gostd/regexp/syntax/parse.go.html#3620984">strflags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622240"><a href="/gostd/regexp/syntax/parse.go.html#3622177">prefix</a></span><span class="op" id="3622246">.</span><span class="ident" id="3622247"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3622252">=</span>&nbsp;<span class="builtinfunc" id="3622254">append</span><span class="op" id="3622260">(</span><span class="ident" id="3622261"><a href="/gostd/regexp/syntax/parse.go.html#3622177">prefix</a></span><span class="op" id="3622267">.</span><span class="ident" id="3622268"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3622272">[</span><span class="op" id="3622273">:</span><span class="num" id="3622274">0</span><span class="op" id="3622275">]</span><span class="op" id="3622276">,</span>&nbsp;<span class="ident" id="3622278"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span><span class="op" id="3622281">...</span><span class="op" id="3622284">)</span><br>
<span class="lineno">455</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622290">for</span>&nbsp;<span class="ident" id="3622294">j</span>&nbsp;<span class="op" id="3622296">:=</span>&nbsp;<span class="ident" id="3622299"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3622304">;</span>&nbsp;<span class="ident" id="3622306"><a href="/gostd/regexp/syntax/parse.go.html#3622294">j</a></span>&nbsp;<span class="op" id="3622308">&lt;</span>&nbsp;<span class="ident" id="3622310"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span><span class="op" id="3622311">;</span>&nbsp;<span class="ident" id="3622313"><a href="/gostd/regexp/syntax/parse.go.html#3622294">j</a></span><span class="op" id="3622314">++</span>&nbsp;<span class="op" id="3622317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622323"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622326">[</span><span class="ident" id="3622327"><a href="/gostd/regexp/syntax/parse.go.html#3622294">j</a></span><span class="op" id="3622328">]</span>&nbsp;<span class="op" id="3622330">=</span>&nbsp;<span class="ident" id="3622332"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3622333">.</span><span class="ident" id="3622334"><a href="/gostd/regexp/syntax/parse.go.html#3626098">removeLeadingString</a></span><span class="op" id="3622353">(</span><span class="ident" id="3622354"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622357">[</span><span class="ident" id="3622358"><a href="/gostd/regexp/syntax/parse.go.html#3622294">j</a></span><span class="op" id="3622359">]</span><span class="op" id="3622360">,</span>&nbsp;<span class="builtinfunc" id="3622362">len</span><span class="op" id="3622365">(</span><span class="ident" id="3622366"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span><span class="op" id="3622369">)</span><span class="op" id="3622370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622380">suffix</span>&nbsp;<span class="op" id="3622387">:=</span>&nbsp;<span class="ident" id="3622390"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3622391">.</span><span class="ident" id="3622392"><a href="/gostd/regexp/syntax/parse.go.html#3619993">collapse</a></span><span class="op" id="3622400">(</span><span class="ident" id="3622401"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622404">[</span><span class="ident" id="3622405"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3622410">:</span><span class="ident" id="3622411"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span><span class="op" id="3622412">]</span><span class="op" id="3622413">,</span>&nbsp;<span class="ident" id="3622415"><a href="/gostd/regexp/syntax/regexp.go.html#3668833">OpAlternate</a></span><span class="op" id="3622426">)</span>&nbsp;<span class="comment" id="3622428">//&nbsp;recurse</span><br>
<span class="lineno">460</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622443">re</span>&nbsp;<span class="op" id="3622446">:=</span>&nbsp;<span class="ident" id="3622449"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3622450">.</span><span class="ident" id="3622451"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3622460">(</span><span class="ident" id="3622461"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span><span class="op" id="3622469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622474"><a href="/gostd/regexp/syntax/parse.go.html#3622443">re</a></span><span class="op" id="3622476">.</span><span class="ident" id="3622477"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3622481">=</span>&nbsp;<span class="builtinfunc" id="3622483">append</span><span class="op" id="3622489">(</span><span class="ident" id="3622490"><a href="/gostd/regexp/syntax/parse.go.html#3622443">re</a></span><span class="op" id="3622492">.</span><span class="ident" id="3622493"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3622496">[</span><span class="op" id="3622497">:</span><span class="num" id="3622498">0</span><span class="op" id="3622499">]</span><span class="op" id="3622500">,</span>&nbsp;<span class="ident" id="3622502"><a href="/gostd/regexp/syntax/parse.go.html#3622177">prefix</a></span><span class="op" id="3622508">,</span>&nbsp;<span class="ident" id="3622510"><a href="/gostd/regexp/syntax/parse.go.html#3622380">suffix</a></span><span class="op" id="3622516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622521"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3622525">=</span>&nbsp;<span class="builtinfunc" id="3622527">append</span><span class="op" id="3622533">(</span><span class="ident" id="3622534"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3622537">,</span>&nbsp;<span class="ident" id="3622539"><a href="/gostd/regexp/syntax/parse.go.html#3622443">re</a></span><span class="op" id="3622541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622545">}</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622550">//&nbsp;Prepare&nbsp;for&nbsp;next&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622583"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3622589">=</span>&nbsp;<span class="ident" id="3622591"><a href="/gostd/regexp/syntax/parse.go.html#3621032">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622595"><a href="/gostd/regexp/syntax/parse.go.html#3620968">str</a></span>&nbsp;<span class="op" id="3622599">=</span>&nbsp;<span class="ident" id="3622601"><a href="/gostd/regexp/syntax/parse.go.html#3621340">istr</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622608"><a href="/gostd/regexp/syntax/parse.go.html#3620984">strflags</a></span>&nbsp;<span class="op" id="3622617">=</span>&nbsp;<span class="ident" id="3622619"><a href="/gostd/regexp/syntax/parse.go.html#3621358">iflags</a></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3622627">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622630"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span>&nbsp;<span class="op" id="3622634">=</span>&nbsp;<span class="ident" id="3622636"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622642">//&nbsp;Round&nbsp;2:&nbsp;Factor&nbsp;out&nbsp;common&nbsp;complex&nbsp;prefixes,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622691">//&nbsp;just&nbsp;the&nbsp;first&nbsp;piece&nbsp;of&nbsp;each&nbsp;concatenation,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622739">//&nbsp;whatever&nbsp;it&nbsp;is.&nbsp;&nbsp;This&nbsp;is&nbsp;good&nbsp;enough&nbsp;a&nbsp;lot&nbsp;of&nbsp;the&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622799"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3622805">=</span>&nbsp;<span class="num" id="3622807">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3622810"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3622814">=</span>&nbsp;<span class="ident" id="3622816"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622819">[</span><span class="op" id="3622820">:</span><span class="num" id="3622821">0</span><span class="op" id="3622822">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622825">var</span>&nbsp;<span class="ident" id="3622829">first</span>&nbsp;<span class="op" id="3622835">*</span><span class="ident" id="3622836"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3622844">for</span>&nbsp;<span class="ident" id="3622848">i</span>&nbsp;<span class="op" id="3622850">:=</span>&nbsp;<span class="num" id="3622853">0</span><span class="op" id="3622854">;</span>&nbsp;<span class="ident" id="3622856"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span>&nbsp;<span class="op" id="3622858">&lt;=</span>&nbsp;<span class="builtinfunc" id="3622861">len</span><span class="op" id="3622864">(</span><span class="ident" id="3622865"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3622868">)</span><span class="op" id="3622869">;</span>&nbsp;<span class="ident" id="3622871"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span><span class="op" id="3622872">++</span>&nbsp;<span class="op" id="3622875">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622879">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3622943">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623010">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623044">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623049">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;all&nbsp;begin&nbsp;with&nbsp;ifirst.</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623126">var</span>&nbsp;<span class="ident" id="3623130">ifirst</span>&nbsp;<span class="op" id="3623137">*</span><span class="ident" id="3623138"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623147">if</span>&nbsp;<span class="ident" id="3623150"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span>&nbsp;<span class="op" id="3623152">&lt;</span>&nbsp;<span class="builtinfunc" id="3623154">len</span><span class="op" id="3623157">(</span><span class="ident" id="3623158"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623161">)</span>&nbsp;<span class="op" id="3623163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623168"><a href="/gostd/regexp/syntax/parse.go.html#3623130">ifirst</a></span>&nbsp;<span class="op" id="3623175">=</span>&nbsp;<span class="ident" id="3623177"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3623178">.</span><span class="ident" id="3623179"><a href="/gostd/regexp/syntax/parse.go.html#3626954">leadingRegexp</a></span><span class="op" id="3623192">(</span><span class="ident" id="3623193"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623196">[</span><span class="ident" id="3623197"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span><span class="op" id="3623198">]</span><span class="op" id="3623199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623204">if</span>&nbsp;<span class="ident" id="3623207"><a href="/gostd/regexp/syntax/parse.go.html#3622829">first</a></span>&nbsp;<span class="op" id="3623213">!=</span>&nbsp;<span class="builtintype" id="3623216">nil</span>&nbsp;<span class="op" id="3623220">&amp;&amp;</span>&nbsp;<span class="ident" id="3623223"><a href="/gostd/regexp/syntax/parse.go.html#3622829">first</a></span><span class="op" id="3623228">.</span><span class="ident" id="3623229"><a href="/gostd/regexp/syntax/regexp.go.html#3669025">Equal</a></span><span class="op" id="3623234">(</span><span class="ident" id="3623235"><a href="/gostd/regexp/syntax/parse.go.html#3623130">ifirst</a></span><span class="op" id="3623241">)</span>&nbsp;<span class="op" id="3623243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623249">continue</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3623261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3623265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623270">//&nbsp;Found&nbsp;end&nbsp;of&nbsp;a&nbsp;run&nbsp;with&nbsp;common&nbsp;leading&nbsp;regexp:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623322">//&nbsp;sub[start:i]&nbsp;all&nbsp;begin&nbsp;with&nbsp;first&nbsp;but&nbsp;sub[i]&nbsp;does&nbsp;not.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623382">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623387">//&nbsp;Factor&nbsp;out&nbsp;common&nbsp;regexp&nbsp;and&nbsp;append&nbsp;factored&nbsp;expression&nbsp;to&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623456">if</span>&nbsp;<span class="ident" id="3623459"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span>&nbsp;<span class="op" id="3623461">==</span>&nbsp;<span class="ident" id="3623464"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3623470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623475">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3623513">}</span>&nbsp;<span class="keyword" id="3623515">else</span>&nbsp;<span class="keyword" id="3623520">if</span>&nbsp;<span class="ident" id="3623523"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span>&nbsp;<span class="op" id="3623525">==</span>&nbsp;<span class="ident" id="3623528"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3623533">+</span><span class="num" id="3623534">1</span>&nbsp;<span class="op" id="3623536">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623541">//&nbsp;Just&nbsp;one:&nbsp;don&#39;t&nbsp;bother&nbsp;factoring.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623581"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3623585">=</span>&nbsp;<span class="builtinfunc" id="3623587">append</span><span class="op" id="3623593">(</span><span class="ident" id="3623594"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3623597">,</span>&nbsp;<span class="ident" id="3623599"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623602">[</span><span class="ident" id="3623603"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3623608">]</span><span class="op" id="3623609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3623613">}</span>&nbsp;<span class="keyword" id="3623615">else</span>&nbsp;<span class="op" id="3623620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3623625">//&nbsp;Construct&nbsp;factored&nbsp;form:&nbsp;prefix(suffix1|suffix2|...)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623684">prefix</span>&nbsp;<span class="op" id="3623691">:=</span>&nbsp;<span class="ident" id="3623694"><a href="/gostd/regexp/syntax/parse.go.html#3622829">first</a></span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3623703">for</span>&nbsp;<span class="ident" id="3623707">j</span>&nbsp;<span class="op" id="3623709">:=</span>&nbsp;<span class="ident" id="3623712"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3623717">;</span>&nbsp;<span class="ident" id="3623719"><a href="/gostd/regexp/syntax/parse.go.html#3623707">j</a></span>&nbsp;<span class="op" id="3623721">&lt;</span>&nbsp;<span class="ident" id="3623723"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span><span class="op" id="3623724">;</span>&nbsp;<span class="ident" id="3623726"><a href="/gostd/regexp/syntax/parse.go.html#3623707">j</a></span><span class="op" id="3623727">++</span>&nbsp;<span class="op" id="3623730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623736">reuse</span>&nbsp;<span class="op" id="3623742">:=</span>&nbsp;<span class="ident" id="3623745"><a href="/gostd/regexp/syntax/parse.go.html#3623707">j</a></span>&nbsp;<span class="op" id="3623747">!=</span>&nbsp;<span class="ident" id="3623750"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="comment" id="3623756">//&nbsp;prefix&nbsp;came&nbsp;from&nbsp;sub[start]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623791"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623794">[</span><span class="ident" id="3623795"><a href="/gostd/regexp/syntax/parse.go.html#3623707">j</a></span><span class="op" id="3623796">]</span>&nbsp;<span class="op" id="3623798">=</span>&nbsp;<span class="ident" id="3623800"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3623801">.</span><span class="ident" id="3623802"><a href="/gostd/regexp/syntax/parse.go.html#3627370">removeLeadingRegexp</a></span><span class="op" id="3623821">(</span><span class="ident" id="3623822"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623825">[</span><span class="ident" id="3623826"><a href="/gostd/regexp/syntax/parse.go.html#3623707">j</a></span><span class="op" id="3623827">]</span><span class="op" id="3623828">,</span>&nbsp;<span class="ident" id="3623830"><a href="/gostd/regexp/syntax/parse.go.html#3623736">reuse</a></span><span class="op" id="3623835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3623840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623845">suffix</span>&nbsp;<span class="op" id="3623852">:=</span>&nbsp;<span class="ident" id="3623855"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3623856">.</span><span class="ident" id="3623857"><a href="/gostd/regexp/syntax/parse.go.html#3619993">collapse</a></span><span class="op" id="3623865">(</span><span class="ident" id="3623866"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3623869">[</span><span class="ident" id="3623870"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3623875">:</span><span class="ident" id="3623876"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span><span class="op" id="3623877">]</span><span class="op" id="3623878">,</span>&nbsp;<span class="ident" id="3623880"><a href="/gostd/regexp/syntax/regexp.go.html#3668833">OpAlternate</a></span><span class="op" id="3623891">)</span>&nbsp;<span class="comment" id="3623893">//&nbsp;recurse</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623908">re</span>&nbsp;<span class="op" id="3623911">:=</span>&nbsp;<span class="ident" id="3623914"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3623915">.</span><span class="ident" id="3623916"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3623925">(</span><span class="ident" id="3623926"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span><span class="op" id="3623934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623939"><a href="/gostd/regexp/syntax/parse.go.html#3623908">re</a></span><span class="op" id="3623941">.</span><span class="ident" id="3623942"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3623946">=</span>&nbsp;<span class="builtinfunc" id="3623948">append</span><span class="op" id="3623954">(</span><span class="ident" id="3623955"><a href="/gostd/regexp/syntax/parse.go.html#3623908">re</a></span><span class="op" id="3623957">.</span><span class="ident" id="3623958"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3623961">[</span><span class="op" id="3623962">:</span><span class="num" id="3623963">0</span><span class="op" id="3623964">]</span><span class="op" id="3623965">,</span>&nbsp;<span class="ident" id="3623967"><a href="/gostd/regexp/syntax/parse.go.html#3623684">prefix</a></span><span class="op" id="3623973">,</span>&nbsp;<span class="ident" id="3623975"><a href="/gostd/regexp/syntax/parse.go.html#3623845">suffix</a></span><span class="op" id="3623981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3623986"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3623990">=</span>&nbsp;<span class="builtinfunc" id="3623992">append</span><span class="op" id="3623998">(</span><span class="ident" id="3623999"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3624002">,</span>&nbsp;<span class="ident" id="3624004"><a href="/gostd/regexp/syntax/parse.go.html#3623908">re</a></span><span class="op" id="3624006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624010">}</span><br>
<span class="lineno">515</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624015">//&nbsp;Prepare&nbsp;for&nbsp;next&nbsp;iteration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624048"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3624054">=</span>&nbsp;<span class="ident" id="3624056"><a href="/gostd/regexp/syntax/parse.go.html#3622848">i</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624060"><a href="/gostd/regexp/syntax/parse.go.html#3622829">first</a></span>&nbsp;<span class="op" id="3624066">=</span>&nbsp;<span class="ident" id="3624068"><a href="/gostd/regexp/syntax/parse.go.html#3623130">ifirst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624076">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624079"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span>&nbsp;<span class="op" id="3624083">=</span>&nbsp;<span class="ident" id="3624085"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624091">//&nbsp;Round&nbsp;3:&nbsp;Collapse&nbsp;runs&nbsp;of&nbsp;single&nbsp;literals&nbsp;into&nbsp;character&nbsp;classes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624161"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3624167">=</span>&nbsp;<span class="num" id="3624169">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624172"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3624176">=</span>&nbsp;<span class="ident" id="3624178"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624181">[</span><span class="op" id="3624182">:</span><span class="num" id="3624183">0</span><span class="op" id="3624184">]</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624187">for</span>&nbsp;<span class="ident" id="3624191">i</span>&nbsp;<span class="op" id="3624193">:=</span>&nbsp;<span class="num" id="3624196">0</span><span class="op" id="3624197">;</span>&nbsp;<span class="ident" id="3624199"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3624201">&lt;=</span>&nbsp;<span class="builtinfunc" id="3624204">len</span><span class="op" id="3624207">(</span><span class="ident" id="3624208"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624211">)</span><span class="op" id="3624212">;</span>&nbsp;<span class="ident" id="3624214"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span><span class="op" id="3624215">++</span>&nbsp;<span class="op" id="3624218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624222">//&nbsp;Invariant:&nbsp;the&nbsp;Regexps&nbsp;that&nbsp;were&nbsp;in&nbsp;sub[0:start]&nbsp;have&nbsp;been</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624286">//&nbsp;used&nbsp;or&nbsp;marked&nbsp;for&nbsp;reuse,&nbsp;and&nbsp;the&nbsp;slice&nbsp;space&nbsp;has&nbsp;been&nbsp;reused</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624353">//&nbsp;for&nbsp;out&nbsp;(len(out)&nbsp;&lt;=&nbsp;start).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624387">//</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624392">//&nbsp;Invariant:&nbsp;sub[start:i]&nbsp;consists&nbsp;of&nbsp;regexps&nbsp;that&nbsp;are&nbsp;either</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624457">//&nbsp;literal&nbsp;runes&nbsp;or&nbsp;character&nbsp;classes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624498">if</span>&nbsp;<span class="ident" id="3624501"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3624503">&lt;</span>&nbsp;<span class="builtinfunc" id="3624505">len</span><span class="op" id="3624508">(</span><span class="ident" id="3624509"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624512">)</span>&nbsp;<span class="op" id="3624514">&amp;&amp;</span>&nbsp;<span class="ident" id="3624517"><a href="/gostd/regexp/syntax/parse.go.html#3636826">isCharClass</a></span><span class="op" id="3624528">(</span><span class="ident" id="3624529"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624532">[</span><span class="ident" id="3624533"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span><span class="op" id="3624534">]</span><span class="op" id="3624535">)</span>&nbsp;<span class="op" id="3624537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624542">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624553">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624558">//&nbsp;sub[i]&nbsp;is&nbsp;not&nbsp;a&nbsp;char&nbsp;or&nbsp;char&nbsp;class;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624599">//&nbsp;emit&nbsp;char&nbsp;class&nbsp;for&nbsp;sub[start:i]...</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624640">if</span>&nbsp;<span class="ident" id="3624643"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3624645">==</span>&nbsp;<span class="ident" id="3624648"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3624654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624659">//&nbsp;Nothing&nbsp;to&nbsp;do&nbsp;-&nbsp;run&nbsp;of&nbsp;length&nbsp;0.</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624697">}</span>&nbsp;<span class="keyword" id="3624699">else</span>&nbsp;<span class="keyword" id="3624704">if</span>&nbsp;<span class="ident" id="3624707"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3624709">==</span>&nbsp;<span class="ident" id="3624712"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3624717">+</span><span class="num" id="3624718">1</span>&nbsp;<span class="op" id="3624720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624725"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3624729">=</span>&nbsp;<span class="builtinfunc" id="3624731">append</span><span class="op" id="3624737">(</span><span class="ident" id="3624738"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3624741">,</span>&nbsp;<span class="ident" id="3624743"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624746">[</span><span class="ident" id="3624747"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3624752">]</span><span class="op" id="3624753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3624757">}</span>&nbsp;<span class="keyword" id="3624759">else</span>&nbsp;<span class="op" id="3624764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624769">//&nbsp;Make&nbsp;new&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3624796">//&nbsp;Start&nbsp;with&nbsp;most&nbsp;complex&nbsp;regexp&nbsp;in&nbsp;sub[start].</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3624848">max</span>&nbsp;<span class="op" id="3624852">:=</span>&nbsp;<span class="ident" id="3624855"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624864">for</span>&nbsp;<span class="ident" id="3624868">j</span>&nbsp;<span class="op" id="3624870">:=</span>&nbsp;<span class="ident" id="3624873"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3624879">+</span>&nbsp;<span class="num" id="3624881">1</span><span class="op" id="3624882">;</span>&nbsp;<span class="ident" id="3624884"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span>&nbsp;<span class="op" id="3624886">&lt;</span>&nbsp;<span class="ident" id="3624888"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span><span class="op" id="3624889">;</span>&nbsp;<span class="ident" id="3624891"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span><span class="op" id="3624892">++</span>&nbsp;<span class="op" id="3624895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3624901">if</span>&nbsp;<span class="ident" id="3624904"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624907">[</span><span class="ident" id="3624908"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span><span class="op" id="3624911">]</span><span class="op" id="3624912">.</span><span class="ident" id="3624913"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3624916">&lt;</span>&nbsp;<span class="ident" id="3624918"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624921">[</span><span class="ident" id="3624922"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span><span class="op" id="3624923">]</span><span class="op" id="3624924">.</span><span class="ident" id="3624925"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3624928">||</span>&nbsp;<span class="ident" id="3624931"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624934">[</span><span class="ident" id="3624935"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span><span class="op" id="3624938">]</span><span class="op" id="3624939">.</span><span class="ident" id="3624940"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3624943">==</span>&nbsp;<span class="ident" id="3624946"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624949">[</span><span class="ident" id="3624950"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span><span class="op" id="3624951">]</span><span class="op" id="3624952">.</span><span class="ident" id="3624953"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3624956">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3624959">len</span><span class="op" id="3624962">(</span><span class="ident" id="3624963"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624966">[</span><span class="ident" id="3624967"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span><span class="op" id="3624970">]</span><span class="op" id="3624971">.</span><span class="ident" id="3624972"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3624976">)</span>&nbsp;<span class="op" id="3624978">&lt;</span>&nbsp;<span class="builtinfunc" id="3624980">len</span><span class="op" id="3624983">(</span><span class="ident" id="3624984"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3624987">[</span><span class="ident" id="3624988"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span><span class="op" id="3624989">]</span><span class="op" id="3624990">.</span><span class="ident" id="3624991"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3624995">)</span>&nbsp;<span class="op" id="3624997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625004"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span>&nbsp;<span class="op" id="3625008">=</span>&nbsp;<span class="ident" id="3625010"><a href="/gostd/regexp/syntax/parse.go.html#3624868">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625016">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625026"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625029">[</span><span class="ident" id="3625030"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3625035">]</span><span class="op" id="3625036">,</span>&nbsp;<span class="ident" id="3625038"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625041">[</span><span class="ident" id="3625042"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span><span class="op" id="3625045">]</span>&nbsp;<span class="op" id="3625047">=</span>&nbsp;<span class="ident" id="3625049"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625052">[</span><span class="ident" id="3625053"><a href="/gostd/regexp/syntax/parse.go.html#3624848">max</a></span><span class="op" id="3625056">]</span><span class="op" id="3625057">,</span>&nbsp;<span class="ident" id="3625059"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625062">[</span><span class="ident" id="3625063"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3625068">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625074">for</span>&nbsp;<span class="ident" id="3625078">j</span>&nbsp;<span class="op" id="3625080">:=</span>&nbsp;<span class="ident" id="3625083"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3625089">+</span>&nbsp;<span class="num" id="3625091">1</span><span class="op" id="3625092">;</span>&nbsp;<span class="ident" id="3625094"><a href="/gostd/regexp/syntax/parse.go.html#3625078">j</a></span>&nbsp;<span class="op" id="3625096">&lt;</span>&nbsp;<span class="ident" id="3625098"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span><span class="op" id="3625099">;</span>&nbsp;<span class="ident" id="3625101"><a href="/gostd/regexp/syntax/parse.go.html#3625078">j</a></span><span class="op" id="3625102">++</span>&nbsp;<span class="op" id="3625105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625111"><a href="/gostd/regexp/syntax/parse.go.html#3637878">mergeCharClass</a></span><span class="op" id="3625125">(</span><span class="ident" id="3625126"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625129">[</span><span class="ident" id="3625130"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3625135">]</span><span class="op" id="3625136">,</span>&nbsp;<span class="ident" id="3625138"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625141">[</span><span class="ident" id="3625142"><a href="/gostd/regexp/syntax/parse.go.html#3625078">j</a></span><span class="op" id="3625143">]</span><span class="op" id="3625144">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625150"><a href="/gostd/regexp/syntax/parse.go.html#3620820">p</a></span><span class="op" id="3625151">.</span><span class="ident" id="3625152"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3625157">(</span><span class="ident" id="3625158"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625161">[</span><span class="ident" id="3625162"><a href="/gostd/regexp/syntax/parse.go.html#3625078">j</a></span><span class="op" id="3625163">]</span><span class="op" id="3625164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625174"><a href="/gostd/regexp/syntax/parse.go.html#3619203">cleanAlt</a></span><span class="op" id="3625182">(</span><span class="ident" id="3625183"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625186">[</span><span class="ident" id="3625187"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3625192">]</span><span class="op" id="3625193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625198"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3625202">=</span>&nbsp;<span class="builtinfunc" id="3625204">append</span><span class="op" id="3625210">(</span><span class="ident" id="3625211"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3625214">,</span>&nbsp;<span class="ident" id="3625216"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625219">[</span><span class="ident" id="3625220"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span><span class="op" id="3625225">]</span><span class="op" id="3625226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625230">}</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3625235">//&nbsp;...&nbsp;and&nbsp;then&nbsp;emit&nbsp;sub[i].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625266">if</span>&nbsp;<span class="ident" id="3625269"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3625271">&lt;</span>&nbsp;<span class="builtinfunc" id="3625273">len</span><span class="op" id="3625276">(</span><span class="ident" id="3625277"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625280">)</span>&nbsp;<span class="op" id="3625282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625287"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3625291">=</span>&nbsp;<span class="builtinfunc" id="3625293">append</span><span class="op" id="3625299">(</span><span class="ident" id="3625300"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3625303">,</span>&nbsp;<span class="ident" id="3625305"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625308">[</span><span class="ident" id="3625309"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span><span class="op" id="3625310">]</span><span class="op" id="3625311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625315">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625319"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3625325">=</span>&nbsp;<span class="ident" id="3625327"><a href="/gostd/regexp/syntax/parse.go.html#3624191">i</a></span>&nbsp;<span class="op" id="3625329">+</span>&nbsp;<span class="num" id="3625331">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625337"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span>&nbsp;<span class="op" id="3625341">=</span>&nbsp;<span class="ident" id="3625343"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3625349">//&nbsp;Round&nbsp;4:&nbsp;Collapse&nbsp;runs&nbsp;of&nbsp;empty&nbsp;matches&nbsp;into&nbsp;a&nbsp;single&nbsp;empty&nbsp;match.</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625420"><a href="/gostd/regexp/syntax/parse.go.html#3621000">start</a></span>&nbsp;<span class="op" id="3625426">=</span>&nbsp;<span class="num" id="3625428">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625431"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3625435">=</span>&nbsp;<span class="ident" id="3625437"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625440">[</span><span class="op" id="3625441">:</span><span class="num" id="3625442">0</span><span class="op" id="3625443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625446">for</span>&nbsp;<span class="ident" id="3625450">i</span>&nbsp;<span class="op" id="3625452">:=</span>&nbsp;<span class="keyword" id="3625455">range</span>&nbsp;<span class="ident" id="3625461"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span>&nbsp;<span class="op" id="3625465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625469">if</span>&nbsp;<span class="ident" id="3625472"><a href="/gostd/regexp/syntax/parse.go.html#3625450">i</a></span><span class="op" id="3625473">+</span><span class="num" id="3625474">1</span>&nbsp;<span class="op" id="3625476">&lt;</span>&nbsp;<span class="builtinfunc" id="3625478">len</span><span class="op" id="3625481">(</span><span class="ident" id="3625482"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625485">)</span>&nbsp;<span class="op" id="3625487">&amp;&amp;</span>&nbsp;<span class="ident" id="3625490"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625493">[</span><span class="ident" id="3625494"><a href="/gostd/regexp/syntax/parse.go.html#3625450">i</a></span><span class="op" id="3625495">]</span><span class="op" id="3625496">.</span><span class="ident" id="3625497"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3625500">==</span>&nbsp;<span class="ident" id="3625503"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span>&nbsp;<span class="op" id="3625516">&amp;&amp;</span>&nbsp;<span class="ident" id="3625519"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625522">[</span><span class="ident" id="3625523"><a href="/gostd/regexp/syntax/parse.go.html#3625450">i</a></span><span class="op" id="3625524">+</span><span class="num" id="3625525">1</span><span class="op" id="3625526">]</span><span class="op" id="3625527">.</span><span class="ident" id="3625528"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3625531">==</span>&nbsp;<span class="ident" id="3625534"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span>&nbsp;<span class="op" id="3625547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625552">continue</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625563">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625567"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span>&nbsp;<span class="op" id="3625571">=</span>&nbsp;<span class="builtinfunc" id="3625573">append</span><span class="op" id="3625579">(</span><span class="ident" id="3625580"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><span class="op" id="3625583">,</span>&nbsp;<span class="ident" id="3625585"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><span class="op" id="3625588">[</span><span class="ident" id="3625589"><a href="/gostd/regexp/syntax/parse.go.html#3625450">i</a></span><span class="op" id="3625590">]</span><span class="op" id="3625591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625597"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span>&nbsp;<span class="op" id="3625601">=</span>&nbsp;<span class="ident" id="3625603"><a href="/gostd/regexp/syntax/parse.go.html#3621012">out</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625609">return</span>&nbsp;<span class="ident" id="3625616"><a href="/gostd/regexp/syntax/parse.go.html#3620838">sub</a></span><br>
<span class="lineno"></span><span class="op" id="3625620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3625623">//&nbsp;leadingString&nbsp;returns&nbsp;the&nbsp;leading&nbsp;literal&nbsp;string&nbsp;that&nbsp;re&nbsp;begins&nbsp;with.</span><br>
<span class="lineno"></span><span class="comment" id="3625696">//&nbsp;The&nbsp;string&nbsp;refers&nbsp;to&nbsp;storage&nbsp;in&nbsp;re&nbsp;or&nbsp;its&nbsp;children.</span><br>
<span class="lineno">585</span><span class="keyword" id="3625751">func</span>&nbsp;<span class="op" id="3625756">(</span><span class="ident" id="3625757">p</span>&nbsp;<span class="op" id="3625759">*</span><span class="ident" id="3625760"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3625766">)</span>&nbsp;<span class="ident" id="3625768">leadingString</span><span class="op" id="3625781">(</span><span class="ident" id="3625782">re</span>&nbsp;<span class="op" id="3625785">*</span><span class="ident" id="3625786"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3625792">)</span>&nbsp;<span class="op" id="3625794">(</span><span class="op" id="3625795">[</span><span class="op" id="3625796">]</span><span class="builtintype" id="3625797">rune</span><span class="op" id="3625801">,</span>&nbsp;<span class="ident" id="3625803"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3625808">)</span>&nbsp;<span class="op" id="3625810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625813">if</span>&nbsp;<span class="ident" id="3625816"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625818">.</span><span class="ident" id="3625819"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3625822">==</span>&nbsp;<span class="ident" id="3625825"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span>&nbsp;<span class="op" id="3625834">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3625837">len</span><span class="op" id="3625840">(</span><span class="ident" id="3625841"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625843">.</span><span class="ident" id="3625844"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3625847">)</span>&nbsp;<span class="op" id="3625849">&gt;</span>&nbsp;<span class="num" id="3625851">0</span>&nbsp;<span class="op" id="3625853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3625857"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span>&nbsp;<span class="op" id="3625860">=</span>&nbsp;<span class="ident" id="3625862"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625864">.</span><span class="ident" id="3625865"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3625868">[</span><span class="num" id="3625869">0</span><span class="op" id="3625870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625876">if</span>&nbsp;<span class="ident" id="3625879"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625881">.</span><span class="ident" id="3625882"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3625885">!=</span>&nbsp;<span class="ident" id="3625888"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3625898">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625902">return</span>&nbsp;<span class="builtintype" id="3625909">nil</span><span class="op" id="3625912">,</span>&nbsp;<span class="num" id="3625914">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3625917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3625920">return</span>&nbsp;<span class="ident" id="3625927"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625929">.</span><span class="ident" id="3625930"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3625934">,</span>&nbsp;<span class="ident" id="3625936"><a href="/gostd/regexp/syntax/parse.go.html#3625782">re</a></span><span class="op" id="3625938">.</span><span class="ident" id="3625939"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3625945">&amp;</span>&nbsp;<span class="ident" id="3625947"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><br>
<span class="lineno"></span><span class="op" id="3625956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">595</span><span class="comment" id="3625959">//&nbsp;removeLeadingString&nbsp;removes&nbsp;the&nbsp;first&nbsp;n&nbsp;leading&nbsp;runes</span><br>
<span class="lineno"></span><span class="comment" id="3626016">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;re.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;replacement&nbsp;for&nbsp;re.</span><br>
<span class="lineno"></span><span class="keyword" id="3626081">func</span>&nbsp;<span class="op" id="3626086">(</span><span class="ident" id="3626087">p</span>&nbsp;<span class="op" id="3626089">*</span><span class="ident" id="3626090"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3626096">)</span>&nbsp;<span class="ident" id="3626098">removeLeadingString</span><span class="op" id="3626117">(</span><span class="ident" id="3626118">re</span>&nbsp;<span class="op" id="3626121">*</span><span class="ident" id="3626122"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3626128">,</span>&nbsp;<span class="ident" id="3626130">n</span>&nbsp;<span class="builtintype" id="3626132">int</span><span class="op" id="3626135">)</span>&nbsp;<span class="op" id="3626137">*</span><span class="ident" id="3626138"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3626145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626148">if</span>&nbsp;<span class="ident" id="3626151"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626153">.</span><span class="ident" id="3626154"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3626157">==</span>&nbsp;<span class="ident" id="3626160"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span>&nbsp;<span class="op" id="3626169">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3626172">len</span><span class="op" id="3626175">(</span><span class="ident" id="3626176"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626178">.</span><span class="ident" id="3626179"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626182">)</span>&nbsp;<span class="op" id="3626184">&gt;</span>&nbsp;<span class="num" id="3626186">0</span>&nbsp;<span class="op" id="3626188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626192">//&nbsp;Removing&nbsp;a&nbsp;leading&nbsp;string&nbsp;in&nbsp;a&nbsp;concatenation</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626242">//&nbsp;might&nbsp;simplify&nbsp;the&nbsp;concatenation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626281">sub</span>&nbsp;<span class="op" id="3626285">:=</span>&nbsp;<span class="ident" id="3626288"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626290">.</span><span class="ident" id="3626291"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626294">[</span><span class="num" id="3626295">0</span><span class="op" id="3626296">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626300"><a href="/gostd/regexp/syntax/parse.go.html#3626281">sub</a></span>&nbsp;<span class="op" id="3626304">=</span>&nbsp;<span class="ident" id="3626306"><a href="/gostd/regexp/syntax/parse.go.html#3626087">p</a></span><span class="op" id="3626307">.</span><span class="ident" id="3626308"><a href="/gostd/regexp/syntax/parse.go.html#3626098">removeLeadingString</a></span><span class="op" id="3626327">(</span><span class="ident" id="3626328"><a href="/gostd/regexp/syntax/parse.go.html#3626281">sub</a></span><span class="op" id="3626331">,</span>&nbsp;<span class="ident" id="3626333"><a href="/gostd/regexp/syntax/parse.go.html#3626130">n</a></span><span class="op" id="3626334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626338"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626340">.</span><span class="ident" id="3626341"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626344">[</span><span class="num" id="3626345">0</span><span class="op" id="3626346">]</span>&nbsp;<span class="op" id="3626348">=</span>&nbsp;<span class="ident" id="3626350"><a href="/gostd/regexp/syntax/parse.go.html#3626281">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626356">if</span>&nbsp;<span class="ident" id="3626359"><a href="/gostd/regexp/syntax/parse.go.html#3626281">sub</a></span><span class="op" id="3626362">.</span><span class="ident" id="3626363"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3626366">==</span>&nbsp;<span class="ident" id="3626369"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span>&nbsp;<span class="op" id="3626382">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626387"><a href="/gostd/regexp/syntax/parse.go.html#3626087">p</a></span><span class="op" id="3626388">.</span><span class="ident" id="3626389"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3626394">(</span><span class="ident" id="3626395"><a href="/gostd/regexp/syntax/parse.go.html#3626281">sub</a></span><span class="op" id="3626398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626403">switch</span>&nbsp;<span class="builtinfunc" id="3626410">len</span><span class="op" id="3626413">(</span><span class="ident" id="3626414"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626416">.</span><span class="ident" id="3626417"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626420">)</span>&nbsp;<span class="op" id="3626422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626427">case</span>&nbsp;<span class="num" id="3626432">0</span><span class="op" id="3626433">,</span>&nbsp;<span class="num" id="3626435">1</span><span class="op" id="3626436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3626442">//&nbsp;Impossible&nbsp;but&nbsp;handle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626472"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626474">.</span><span class="ident" id="3626475"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3626478">=</span>&nbsp;<span class="ident" id="3626480"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626497"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626499">.</span><span class="ident" id="3626500"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3626504">=</span>&nbsp;<span class="builtintype" id="3626506">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626513">case</span>&nbsp;<span class="num" id="3626518">2</span><span class="op" id="3626519">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626525">old</span>&nbsp;<span class="op" id="3626529">:=</span>&nbsp;<span class="ident" id="3626532"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626539"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span>&nbsp;<span class="op" id="3626542">=</span>&nbsp;<span class="ident" id="3626544"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626546">.</span><span class="ident" id="3626547"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626550">[</span><span class="num" id="3626551">1</span><span class="op" id="3626552">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626558"><a href="/gostd/regexp/syntax/parse.go.html#3626087">p</a></span><span class="op" id="3626559">.</span><span class="ident" id="3626560"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3626565">(</span><span class="ident" id="3626566"><a href="/gostd/regexp/syntax/parse.go.html#3626525">old</a></span><span class="op" id="3626569">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626574">default</span><span class="op" id="3626581">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3626587">copy</span><span class="op" id="3626591">(</span><span class="ident" id="3626592"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626594">.</span><span class="ident" id="3626595"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626598">,</span>&nbsp;<span class="ident" id="3626600"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626602">.</span><span class="ident" id="3626603"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626606">[</span><span class="num" id="3626607">1</span><span class="op" id="3626608">:</span><span class="op" id="3626609">]</span><span class="op" id="3626610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626616"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626618">.</span><span class="ident" id="3626619"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3626623">=</span>&nbsp;<span class="ident" id="3626625"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626627">.</span><span class="ident" id="3626628"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626631">[</span><span class="op" id="3626632">:</span><span class="builtinfunc" id="3626633">len</span><span class="op" id="3626636">(</span><span class="ident" id="3626637"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626639">.</span><span class="ident" id="3626640"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3626643">)</span><span class="op" id="3626644">-</span><span class="num" id="3626645">1</span><span class="op" id="3626646">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626655">}</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626659">return</span>&nbsp;<span class="ident" id="3626666"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626674">if</span>&nbsp;<span class="ident" id="3626677"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626679">.</span><span class="ident" id="3626680"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3626683">==</span>&nbsp;<span class="ident" id="3626686"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3626696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626700"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626702">.</span><span class="ident" id="3626703"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3626708">=</span>&nbsp;<span class="ident" id="3626710"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626712">.</span><span class="ident" id="3626713"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3626717">[</span><span class="op" id="3626718">:</span><span class="builtinfunc" id="3626719">copy</span><span class="op" id="3626723">(</span><span class="ident" id="3626724"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626726">.</span><span class="ident" id="3626727"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3626731">,</span>&nbsp;<span class="ident" id="3626733"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626735">.</span><span class="ident" id="3626736"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3626740">[</span><span class="ident" id="3626741"><a href="/gostd/regexp/syntax/parse.go.html#3626130">n</a></span><span class="op" id="3626742">:</span><span class="op" id="3626743">]</span><span class="op" id="3626744">)</span><span class="op" id="3626745">]</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626749">if</span>&nbsp;<span class="builtinfunc" id="3626752">len</span><span class="op" id="3626755">(</span><span class="ident" id="3626756"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626758">.</span><span class="ident" id="3626759"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3626763">)</span>&nbsp;<span class="op" id="3626765">==</span>&nbsp;<span class="num" id="3626768">0</span>&nbsp;<span class="op" id="3626770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3626775"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><span class="op" id="3626777">.</span><span class="ident" id="3626778"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3626781">=</span>&nbsp;<span class="ident" id="3626783"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3626801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626804">return</span>&nbsp;<span class="ident" id="3626811"><a href="/gostd/regexp/syntax/parse.go.html#3626118">re</a></span><br>
<span class="lineno">630</span><span class="op" id="3626814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3626817">//&nbsp;leadingRegexp&nbsp;returns&nbsp;the&nbsp;leading&nbsp;regexp&nbsp;that&nbsp;re&nbsp;begins&nbsp;with.</span><br>
<span class="lineno"></span><span class="comment" id="3626882">//&nbsp;The&nbsp;regexp&nbsp;refers&nbsp;to&nbsp;storage&nbsp;in&nbsp;re&nbsp;or&nbsp;its&nbsp;children.</span><br>
<span class="lineno"></span><span class="keyword" id="3626937">func</span>&nbsp;<span class="op" id="3626942">(</span><span class="ident" id="3626943">p</span>&nbsp;<span class="op" id="3626945">*</span><span class="ident" id="3626946"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3626952">)</span>&nbsp;<span class="ident" id="3626954">leadingRegexp</span><span class="op" id="3626967">(</span><span class="ident" id="3626968">re</span>&nbsp;<span class="op" id="3626971">*</span><span class="ident" id="3626972"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3626978">)</span>&nbsp;<span class="op" id="3626980">*</span><span class="ident" id="3626981"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3626988">{</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3626991">if</span>&nbsp;<span class="ident" id="3626994"><a href="/gostd/regexp/syntax/parse.go.html#3626968">re</a></span><span class="op" id="3626996">.</span><span class="ident" id="3626997"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3627000">==</span>&nbsp;<span class="ident" id="3627003"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span>&nbsp;<span class="op" id="3627016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627020">return</span>&nbsp;<span class="builtintype" id="3627027">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627032">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627035">if</span>&nbsp;<span class="ident" id="3627038"><a href="/gostd/regexp/syntax/parse.go.html#3626968">re</a></span><span class="op" id="3627040">.</span><span class="ident" id="3627041"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3627044">==</span>&nbsp;<span class="ident" id="3627047"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span>&nbsp;<span class="op" id="3627056">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3627059">len</span><span class="op" id="3627062">(</span><span class="ident" id="3627063"><a href="/gostd/regexp/syntax/parse.go.html#3626968">re</a></span><span class="op" id="3627065">.</span><span class="ident" id="3627066"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627069">)</span>&nbsp;<span class="op" id="3627071">&gt;</span>&nbsp;<span class="num" id="3627073">0</span>&nbsp;<span class="op" id="3627075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627079">sub</span>&nbsp;<span class="op" id="3627083">:=</span>&nbsp;<span class="ident" id="3627086"><a href="/gostd/regexp/syntax/parse.go.html#3626968">re</a></span><span class="op" id="3627088">.</span><span class="ident" id="3627089"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627092">[</span><span class="num" id="3627093">0</span><span class="op" id="3627094">]</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627098">if</span>&nbsp;<span class="ident" id="3627101"><a href="/gostd/regexp/syntax/parse.go.html#3627079">sub</a></span><span class="op" id="3627104">.</span><span class="ident" id="3627105"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3627108">==</span>&nbsp;<span class="ident" id="3627111"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span>&nbsp;<span class="op" id="3627124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627129">return</span>&nbsp;<span class="builtintype" id="3627136">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627146">return</span>&nbsp;<span class="ident" id="3627153"><a href="/gostd/regexp/syntax/parse.go.html#3627079">sub</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627158">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627161">return</span>&nbsp;<span class="ident" id="3627168"><a href="/gostd/regexp/syntax/parse.go.html#3626968">re</a></span><br>
<span class="lineno"></span><span class="op" id="3627171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3627174">//&nbsp;removeLeadingRegexp&nbsp;removes&nbsp;the&nbsp;leading&nbsp;regexp&nbsp;in&nbsp;re.</span><br>
<span class="lineno"></span><span class="comment" id="3627231">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;replacement&nbsp;for&nbsp;re.</span><br>
<span class="lineno">650</span><span class="comment" id="3627269">//&nbsp;If&nbsp;reuse&nbsp;is&nbsp;true,&nbsp;it&nbsp;passes&nbsp;the&nbsp;removed&nbsp;regexp&nbsp;(if&nbsp;no&nbsp;longer&nbsp;needed)&nbsp;to&nbsp;p.reuse.</span><br>
<span class="lineno"></span><span class="keyword" id="3627353">func</span>&nbsp;<span class="op" id="3627358">(</span><span class="ident" id="3627359">p</span>&nbsp;<span class="op" id="3627361">*</span><span class="ident" id="3627362"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3627368">)</span>&nbsp;<span class="ident" id="3627370">removeLeadingRegexp</span><span class="op" id="3627389">(</span><span class="ident" id="3627390">re</span>&nbsp;<span class="op" id="3627393">*</span><span class="ident" id="3627394"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3627400">,</span>&nbsp;<span class="ident" id="3627402">reuse</span>&nbsp;<span class="builtintype" id="3627408">bool</span><span class="op" id="3627412">)</span>&nbsp;<span class="op" id="3627414">*</span><span class="ident" id="3627415"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3627422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627425">if</span>&nbsp;<span class="ident" id="3627428"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627430">.</span><span class="ident" id="3627431"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3627434">==</span>&nbsp;<span class="ident" id="3627437"><a href="/gostd/regexp/syntax/regexp.go.html#3668768">OpConcat</a></span>&nbsp;<span class="op" id="3627446">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3627449">len</span><span class="op" id="3627452">(</span><span class="ident" id="3627453"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627455">.</span><span class="ident" id="3627456"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627459">)</span>&nbsp;<span class="op" id="3627461">&gt;</span>&nbsp;<span class="num" id="3627463">0</span>&nbsp;<span class="op" id="3627465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627469">if</span>&nbsp;<span class="ident" id="3627472"><a href="/gostd/regexp/syntax/parse.go.html#3627402">reuse</a></span>&nbsp;<span class="op" id="3627478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627483"><a href="/gostd/regexp/syntax/parse.go.html#3627359">p</a></span><span class="op" id="3627484">.</span><span class="ident" id="3627485"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3627490">(</span><span class="ident" id="3627491"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627493">.</span><span class="ident" id="3627494"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627497">[</span><span class="num" id="3627498">0</span><span class="op" id="3627499">]</span><span class="op" id="3627500">)</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627508"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627510">.</span><span class="ident" id="3627511"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3627515">=</span>&nbsp;<span class="ident" id="3627517"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627519">.</span><span class="ident" id="3627520"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627523">[</span><span class="op" id="3627524">:</span><span class="builtinfunc" id="3627525">copy</span><span class="op" id="3627529">(</span><span class="ident" id="3627530"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627532">.</span><span class="ident" id="3627533"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627536">,</span>&nbsp;<span class="ident" id="3627538"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627540">.</span><span class="ident" id="3627541"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627544">[</span><span class="num" id="3627545">1</span><span class="op" id="3627546">:</span><span class="op" id="3627547">]</span><span class="op" id="3627548">)</span><span class="op" id="3627549">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627553">switch</span>&nbsp;<span class="builtinfunc" id="3627560">len</span><span class="op" id="3627563">(</span><span class="ident" id="3627564"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627566">.</span><span class="ident" id="3627567"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627570">)</span>&nbsp;<span class="op" id="3627572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627576">case</span>&nbsp;<span class="num" id="3627581">0</span><span class="op" id="3627582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627587"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627589">.</span><span class="ident" id="3627590"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3627593">=</span>&nbsp;<span class="ident" id="3627595"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627611"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627613">.</span><span class="ident" id="3627614"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3627618">=</span>&nbsp;<span class="builtintype" id="3627620">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627626">case</span>&nbsp;<span class="num" id="3627631">1</span><span class="op" id="3627632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627637">old</span>&nbsp;<span class="op" id="3627641">:=</span>&nbsp;<span class="ident" id="3627644"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627650"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span>&nbsp;<span class="op" id="3627653">=</span>&nbsp;<span class="ident" id="3627655"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627657">.</span><span class="ident" id="3627658"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3627661">[</span><span class="num" id="3627662">0</span><span class="op" id="3627663">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627668"><a href="/gostd/regexp/syntax/parse.go.html#3627359">p</a></span><span class="op" id="3627669">.</span><span class="ident" id="3627670"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3627675">(</span><span class="ident" id="3627676"><a href="/gostd/regexp/syntax/parse.go.html#3627637">old</a></span><span class="op" id="3627679">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627687">return</span>&nbsp;<span class="ident" id="3627694"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627701">if</span>&nbsp;<span class="ident" id="3627704"><a href="/gostd/regexp/syntax/parse.go.html#3627402">reuse</a></span>&nbsp;<span class="op" id="3627710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627714"><a href="/gostd/regexp/syntax/parse.go.html#3627359">p</a></span><span class="op" id="3627715">.</span><span class="ident" id="3627716"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3627721">(</span><span class="ident" id="3627722"><a href="/gostd/regexp/syntax/parse.go.html#3627390">re</a></span><span class="op" id="3627724">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3627727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627730">return</span>&nbsp;<span class="ident" id="3627737"><a href="/gostd/regexp/syntax/parse.go.html#3627359">p</a></span><span class="op" id="3627738">.</span><span class="ident" id="3627739"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3627748">(</span><span class="ident" id="3627749"><a href="/gostd/regexp/syntax/regexp.go.html#3667616">OpEmptyMatch</a></span><span class="op" id="3627761">)</span><br>
<span class="lineno"></span><span class="op" id="3627763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3627766">func</span>&nbsp;<span class="ident" id="3627771">literalRegexp</span><span class="op" id="3627784">(</span><span class="ident" id="3627785">s</span>&nbsp;<span class="builtintype" id="3627787">string</span><span class="op" id="3627793">,</span>&nbsp;<span class="ident" id="3627795">flags</span>&nbsp;<span class="ident" id="3627801"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3627806">)</span>&nbsp;<span class="op" id="3627808">*</span><span class="ident" id="3627809"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span>&nbsp;<span class="op" id="3627816">{</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627819">re</span>&nbsp;<span class="op" id="3627822">:=</span>&nbsp;<span class="op" id="3627825">&amp;</span><span class="ident" id="3627826"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3627832">{</span><span class="ident" id="3627833"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span><span class="op" id="3627835">:</span>&nbsp;<span class="ident" id="3627837"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><span class="op" id="3627846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627849"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3627851">.</span><span class="ident" id="3627852"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3627858">=</span>&nbsp;<span class="ident" id="3627860"><a href="/gostd/regexp/syntax/parse.go.html#3627795">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3627867"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3627869">.</span><span class="ident" id="3627870"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3627875">=</span>&nbsp;<span class="ident" id="3627877"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3627879">.</span><span class="ident" id="3627880"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3627885">[</span><span class="op" id="3627886">:</span><span class="num" id="3627887">0</span><span class="op" id="3627888">]</span>&nbsp;<span class="comment" id="3627890">//&nbsp;use&nbsp;local&nbsp;storage&nbsp;for&nbsp;small&nbsp;strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627930">for</span>&nbsp;<span class="ident" id="3627934">_</span><span class="op" id="3627935">,</span>&nbsp;<span class="ident" id="3627937">c</span>&nbsp;<span class="op" id="3627939">:=</span>&nbsp;<span class="keyword" id="3627942">range</span>&nbsp;<span class="ident" id="3627948"><a href="/gostd/regexp/syntax/parse.go.html#3627785">s</a></span>&nbsp;<span class="op" id="3627950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3627954">if</span>&nbsp;<span class="builtinfunc" id="3627957">len</span><span class="op" id="3627960">(</span><span class="ident" id="3627961"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3627963">.</span><span class="ident" id="3627964"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3627968">)</span>&nbsp;<span class="op" id="3627970">&gt;=</span>&nbsp;<span class="builtinfunc" id="3627973">cap</span><span class="op" id="3627976">(</span><span class="ident" id="3627977"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3627979">.</span><span class="ident" id="3627980"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3627984">)</span>&nbsp;<span class="op" id="3627986">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3627991">//&nbsp;string&nbsp;is&nbsp;too&nbsp;long&nbsp;to&nbsp;fit&nbsp;in&nbsp;Rune0.&nbsp;&nbsp;let&nbsp;Go&nbsp;handle&nbsp;it</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628051"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3628053">.</span><span class="ident" id="3628054"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3628059">=</span>&nbsp;<span class="op" id="3628061">[</span><span class="op" id="3628062">]</span><span class="builtintype" id="3628063">rune</span><span class="op" id="3628067">(</span><span class="ident" id="3628068"><a href="/gostd/regexp/syntax/parse.go.html#3627785">s</a></span><span class="op" id="3628069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628074">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628086"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3628088">.</span><span class="ident" id="3628089"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3628094">=</span>&nbsp;<span class="builtinfunc" id="3628096">append</span><span class="op" id="3628102">(</span><span class="ident" id="3628103"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><span class="op" id="3628105">.</span><span class="ident" id="3628106"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3628110">,</span>&nbsp;<span class="ident" id="3628112"><a href="/gostd/regexp/syntax/parse.go.html#3627937">c</a></span><span class="op" id="3628113">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628119">return</span>&nbsp;<span class="ident" id="3628126"><a href="/gostd/regexp/syntax/parse.go.html#3627819">re</a></span><br>
<span class="lineno"></span><span class="op" id="3628129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3628132">//&nbsp;Parsing.</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="3628145">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;regular&nbsp;expression&nbsp;string&nbsp;s,&nbsp;controlled&nbsp;by&nbsp;the&nbsp;specified</span><br>
<span class="lineno"></span><span class="comment" id="3628220">//&nbsp;Flags,&nbsp;and&nbsp;returns&nbsp;a&nbsp;regular&nbsp;expression&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;syntax&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="3628289">//&nbsp;described&nbsp;in&nbsp;the&nbsp;top-level&nbsp;comment.</span><br>
<span class="lineno"></span><span class="keyword" id="3628328">func</span>&nbsp;<span class="ident" id="3628333">Parse</span><span class="op" id="3628338">(</span><span class="ident" id="3628339">s</span>&nbsp;<span class="builtintype" id="3628341">string</span><span class="op" id="3628347">,</span>&nbsp;<span class="ident" id="3628349">flags</span>&nbsp;<span class="ident" id="3628355"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3628360">)</span>&nbsp;<span class="op" id="3628362">(</span><span class="op" id="3628363">*</span><span class="ident" id="3628364"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3628370">,</span>&nbsp;<span class="builtintype" id="3628372">error</span><span class="op" id="3628377">)</span>&nbsp;<span class="op" id="3628379">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628382">if</span>&nbsp;<span class="ident" id="3628385"><a href="/gostd/regexp/syntax/parse.go.html#3628349">flags</a></span><span class="op" id="3628390">&amp;</span><span class="ident" id="3628391"><a href="/gostd/regexp/syntax/parse.go.html#3611231">Literal</a></span>&nbsp;<span class="op" id="3628399">!=</span>&nbsp;<span class="num" id="3628402">0</span>&nbsp;<span class="op" id="3628404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628408">//&nbsp;Trivial&nbsp;parser&nbsp;for&nbsp;literal&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628448">if</span>&nbsp;<span class="ident" id="3628451">err</span>&nbsp;<span class="op" id="3628455">:=</span>&nbsp;<span class="ident" id="3628458"><a href="/gostd/regexp/syntax/parse.go.html#3655517">checkUTF8</a></span><span class="op" id="3628467">(</span><span class="ident" id="3628468"><a href="/gostd/regexp/syntax/parse.go.html#3628339">s</a></span><span class="op" id="3628469">)</span><span class="op" id="3628470">;</span>&nbsp;<span class="ident" id="3628472"><a href="/gostd/regexp/syntax/parse.go.html#3628451">err</a></span>&nbsp;<span class="op" id="3628476">!=</span>&nbsp;<span class="builtintype" id="3628479">nil</span>&nbsp;<span class="op" id="3628483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628488">return</span>&nbsp;<span class="builtintype" id="3628495">nil</span><span class="op" id="3628498">,</span>&nbsp;<span class="ident" id="3628500"><a href="/gostd/regexp/syntax/parse.go.html#3628451">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628506">}</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628510">return</span>&nbsp;<span class="ident" id="3628517"><a href="/gostd/regexp/syntax/parse.go.html#3627771">literalRegexp</a></span><span class="op" id="3628530">(</span><span class="ident" id="3628531"><a href="/gostd/regexp/syntax/parse.go.html#3628339">s</a></span><span class="op" id="3628532">,</span>&nbsp;<span class="ident" id="3628534"><a href="/gostd/regexp/syntax/parse.go.html#3628349">flags</a></span><span class="op" id="3628539">)</span><span class="op" id="3628540">,</span>&nbsp;<span class="builtintype" id="3628542">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628551">//&nbsp;Otherwise,&nbsp;must&nbsp;do&nbsp;real&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628585">var</span>&nbsp;<span class="op" id="3628589">(</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628593">p</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628604"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628613">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3628624">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628632">c</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3628643">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628650">op</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628661"><a href="/gostd/regexp/syntax/regexp.go.html#3667347">Op</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628666">lastRepeat</span>&nbsp;<span class="builtintype" id="3628677">string</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628688"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3628689">.</span><span class="ident" id="3628690"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span>&nbsp;<span class="op" id="3628696">=</span>&nbsp;<span class="ident" id="3628698"><a href="/gostd/regexp/syntax/parse.go.html#3628349">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628705"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3628706">.</span><span class="ident" id="3628707"><a href="/gostd/regexp/syntax/parse.go.html#3612409">wholeRegexp</a></span>&nbsp;<span class="op" id="3628719">=</span>&nbsp;<span class="ident" id="3628721"><a href="/gostd/regexp/syntax/parse.go.html#3628339">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628724">t</span>&nbsp;<span class="op" id="3628726">:=</span>&nbsp;<span class="ident" id="3628729"><a href="/gostd/regexp/syntax/parse.go.html#3628339">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628732">for</span>&nbsp;<span class="ident" id="3628736"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3628738">!=</span>&nbsp;<span class="string" id="3628741">&#34;&#34;</span>&nbsp;<span class="op" id="3628744">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628748">repeat</span>&nbsp;<span class="op" id="3628755">:=</span>&nbsp;<span class="string" id="3628758">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628762">BigSwitch</span><span class="op" id="3628771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628775">switch</span>&nbsp;<span class="ident" id="3628782"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3628783">[</span><span class="num" id="3628784">0</span><span class="op" id="3628785">]</span>&nbsp;<span class="op" id="3628787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628791">default</span><span class="op" id="3628798">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628803">if</span>&nbsp;<span class="ident" id="3628806"><a href="/gostd/regexp/syntax/parse.go.html#3628632">c</a></span><span class="op" id="3628807">,</span>&nbsp;<span class="ident" id="3628809"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3628810">,</span>&nbsp;<span class="ident" id="3628812"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3628816">=</span>&nbsp;<span class="ident" id="3628818"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3628826">(</span><span class="ident" id="3628827"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3628828">)</span><span class="op" id="3628829">;</span>&nbsp;<span class="ident" id="3628831"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3628835">!=</span>&nbsp;<span class="builtintype" id="3628838">nil</span>&nbsp;<span class="op" id="3628842">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628848">return</span>&nbsp;<span class="builtintype" id="3628855">nil</span><span class="op" id="3628858">,</span>&nbsp;<span class="ident" id="3628860"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3628867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3628872"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3628873">.</span><span class="ident" id="3628874"><a href="/gostd/regexp/syntax/parse.go.html#3615539">literal</a></span><span class="op" id="3628881">(</span><span class="ident" id="3628882"><a href="/gostd/regexp/syntax/parse.go.html#3628632">c</a></span><span class="op" id="3628883">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628888">case</span>&nbsp;<span class="string" id="3628893">&#39;(&#39;</span><span class="op" id="3628896">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3628901">if</span>&nbsp;<span class="ident" id="3628904"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3628905">.</span><span class="ident" id="3628906"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3628911">&amp;</span><span class="ident" id="3628912"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3628918">!=</span>&nbsp;<span class="num" id="3628921">0</span>&nbsp;<span class="op" id="3628923">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3628926">len</span><span class="op" id="3628929">(</span><span class="ident" id="3628930"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3628931">)</span>&nbsp;<span class="op" id="3628933">&gt;=</span>&nbsp;<span class="num" id="3628936">2</span>&nbsp;<span class="op" id="3628938">&amp;&amp;</span>&nbsp;<span class="ident" id="3628941"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3628942">[</span><span class="num" id="3628943">1</span><span class="op" id="3628944">]</span>&nbsp;<span class="op" id="3628946">==</span>&nbsp;<span class="string" id="3628949">&#39;?&#39;</span>&nbsp;<span class="op" id="3628953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3628959">//&nbsp;Flag&nbsp;changes&nbsp;and&nbsp;non-capturing&nbsp;groups.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629005">if</span>&nbsp;<span class="ident" id="3629008"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629009">,</span>&nbsp;<span class="ident" id="3629011"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629015">=</span>&nbsp;<span class="ident" id="3629017"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629018">.</span><span class="ident" id="3629019"><a href="/gostd/regexp/syntax/parse.go.html#3633332">parsePerlFlags</a></span><span class="op" id="3629033">(</span><span class="ident" id="3629034"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629035">)</span><span class="op" id="3629036">;</span>&nbsp;<span class="ident" id="3629038"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629042">!=</span>&nbsp;<span class="builtintype" id="3629045">nil</span>&nbsp;<span class="op" id="3629049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629056">return</span>&nbsp;<span class="builtintype" id="3629063">nil</span><span class="op" id="3629066">,</span>&nbsp;<span class="ident" id="3629068"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629076">}</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629082">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629096"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629097">.</span><span class="ident" id="3629098"><a href="/gostd/regexp/syntax/parse.go.html#3612357">numCap</a></span><span class="op" id="3629104">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629110"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629111">.</span><span class="ident" id="3629112"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629114">(</span><span class="ident" id="3629115"><a href="/gostd/regexp/syntax/parse.go.html#3612169">opLeftParen</a></span><span class="op" id="3629126">)</span><span class="op" id="3629127">.</span><span class="ident" id="3629128"><a href="/gostd/regexp/syntax/regexp.go.html#3667181">Cap</a></span>&nbsp;<span class="op" id="3629132">=</span>&nbsp;<span class="ident" id="3629134"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629135">.</span><span class="ident" id="3629136"><a href="/gostd/regexp/syntax/parse.go.html#3612357">numCap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629146"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629148">=</span>&nbsp;<span class="ident" id="3629150"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629151">[</span><span class="num" id="3629152">1</span><span class="op" id="3629153">:</span><span class="op" id="3629154">]</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629158">case</span>&nbsp;<span class="string" id="3629163">&#39;|&#39;</span><span class="op" id="3629166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629171">if</span>&nbsp;<span class="ident" id="3629174"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629178">=</span>&nbsp;<span class="ident" id="3629180"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629181">.</span><span class="ident" id="3629182"><a href="/gostd/regexp/syntax/parse.go.html#3637428">parseVerticalBar</a></span><span class="op" id="3629198">(</span><span class="op" id="3629199">)</span><span class="op" id="3629200">;</span>&nbsp;<span class="ident" id="3629202"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629206">!=</span>&nbsp;<span class="builtintype" id="3629209">nil</span>&nbsp;<span class="op" id="3629213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629219">return</span>&nbsp;<span class="builtintype" id="3629226">nil</span><span class="op" id="3629229">,</span>&nbsp;<span class="ident" id="3629231"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629243"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629245">=</span>&nbsp;<span class="ident" id="3629247"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629248">[</span><span class="num" id="3629249">1</span><span class="op" id="3629250">:</span><span class="op" id="3629251">]</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629255">case</span>&nbsp;<span class="string" id="3629260">&#39;)&#39;</span><span class="op" id="3629263">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629268">if</span>&nbsp;<span class="ident" id="3629271"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629275">=</span>&nbsp;<span class="ident" id="3629277"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629278">.</span><span class="ident" id="3629279"><a href="/gostd/regexp/syntax/parse.go.html#3639566">parseRightParen</a></span><span class="op" id="3629294">(</span><span class="op" id="3629295">)</span><span class="op" id="3629296">;</span>&nbsp;<span class="ident" id="3629298"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629302">!=</span>&nbsp;<span class="builtintype" id="3629305">nil</span>&nbsp;<span class="op" id="3629309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629315">return</span>&nbsp;<span class="builtintype" id="3629322">nil</span><span class="op" id="3629325">,</span>&nbsp;<span class="ident" id="3629327"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629339"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629341">=</span>&nbsp;<span class="ident" id="3629343"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629344">[</span><span class="num" id="3629345">1</span><span class="op" id="3629346">:</span><span class="op" id="3629347">]</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629351">case</span>&nbsp;<span class="string" id="3629356">&#39;^&#39;</span><span class="op" id="3629359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629364">if</span>&nbsp;<span class="ident" id="3629367"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629368">.</span><span class="ident" id="3629369"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3629374">&amp;</span><span class="ident" id="3629375"><a href="/gostd/regexp/syntax/parse.go.html#3611465">OneLine</a></span>&nbsp;<span class="op" id="3629383">!=</span>&nbsp;<span class="num" id="3629386">0</span>&nbsp;<span class="op" id="3629388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629394"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629395">.</span><span class="ident" id="3629396"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629398">(</span><span class="ident" id="3629399"><a href="/gostd/regexp/syntax/regexp.go.html#3668087">OpBeginText</a></span><span class="op" id="3629410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629415">}</span>&nbsp;<span class="keyword" id="3629417">else</span>&nbsp;<span class="op" id="3629422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629428"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629429">.</span><span class="ident" id="3629430"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629432">(</span><span class="ident" id="3629433"><a href="/gostd/regexp/syntax/regexp.go.html#3667939">OpBeginLine</a></span><span class="op" id="3629444">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629454"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629456">=</span>&nbsp;<span class="ident" id="3629458"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629459">[</span><span class="num" id="3629460">1</span><span class="op" id="3629461">:</span><span class="op" id="3629462">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629466">case</span>&nbsp;<span class="string" id="3629471">&#39;$&#39;</span><span class="op" id="3629474">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629479">if</span>&nbsp;<span class="ident" id="3629482"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629483">.</span><span class="ident" id="3629484"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3629489">&amp;</span><span class="ident" id="3629490"><a href="/gostd/regexp/syntax/parse.go.html#3611465">OneLine</a></span>&nbsp;<span class="op" id="3629498">!=</span>&nbsp;<span class="num" id="3629501">0</span>&nbsp;<span class="op" id="3629503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629509"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629510">.</span><span class="ident" id="3629511"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629513">(</span><span class="ident" id="3629514"><a href="/gostd/regexp/syntax/regexp.go.html#3668164">OpEndText</a></span><span class="op" id="3629523">)</span><span class="op" id="3629524">.</span><span class="ident" id="3629525"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3629531">|=</span>&nbsp;<span class="ident" id="3629534"><a href="/gostd/regexp/syntax/parse.go.html#3611793">WasDollar</a></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629547">}</span>&nbsp;<span class="keyword" id="3629549">else</span>&nbsp;<span class="op" id="3629554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629560"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629561">.</span><span class="ident" id="3629562"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629564">(</span><span class="ident" id="3629565"><a href="/gostd/regexp/syntax/regexp.go.html#3668016">OpEndLine</a></span><span class="op" id="3629574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629584"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629586">=</span>&nbsp;<span class="ident" id="3629588"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629589">[</span><span class="num" id="3629590">1</span><span class="op" id="3629591">:</span><span class="op" id="3629592">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629596">case</span>&nbsp;<span class="string" id="3629601">&#39;.&#39;</span><span class="op" id="3629604">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629609">if</span>&nbsp;<span class="ident" id="3629612"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629613">.</span><span class="ident" id="3629614"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3629619">&amp;</span><span class="ident" id="3629620"><a href="/gostd/regexp/syntax/parse.go.html#3611404">DotNL</a></span>&nbsp;<span class="op" id="3629626">!=</span>&nbsp;<span class="num" id="3629629">0</span>&nbsp;<span class="op" id="3629631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629637"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629638">.</span><span class="ident" id="3629639"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629641">(</span><span class="ident" id="3629642"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><span class="op" id="3629651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629656">}</span>&nbsp;<span class="keyword" id="3629658">else</span>&nbsp;<span class="op" id="3629663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629669"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629670">.</span><span class="ident" id="3629671"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3629673">(</span><span class="ident" id="3629674"><a href="/gostd/regexp/syntax/regexp.go.html#3667810">OpAnyCharNotNL</a></span><span class="op" id="3629688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629693">}</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629698"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3629700">=</span>&nbsp;<span class="ident" id="3629702"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629703">[</span><span class="num" id="3629704">1</span><span class="op" id="3629705">:</span><span class="op" id="3629706">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629710">case</span>&nbsp;<span class="string" id="3629715">&#39;[&#39;</span><span class="op" id="3629718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629723">if</span>&nbsp;<span class="ident" id="3629726"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629727">,</span>&nbsp;<span class="ident" id="3629729"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629733">=</span>&nbsp;<span class="ident" id="3629735"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629736">.</span><span class="ident" id="3629737"><a href="/gostd/regexp/syntax/parse.go.html#3647236">parseClass</a></span><span class="op" id="3629747">(</span><span class="ident" id="3629748"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629749">)</span><span class="op" id="3629750">;</span>&nbsp;<span class="ident" id="3629752"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629756">!=</span>&nbsp;<span class="builtintype" id="3629759">nil</span>&nbsp;<span class="op" id="3629763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629769">return</span>&nbsp;<span class="builtintype" id="3629776">nil</span><span class="op" id="3629779">,</span>&nbsp;<span class="ident" id="3629781"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629788">}</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629792">case</span>&nbsp;<span class="string" id="3629797">&#39;*&#39;</span><span class="op" id="3629800">,</span>&nbsp;<span class="string" id="3629802">&#39;+&#39;</span><span class="op" id="3629805">,</span>&nbsp;<span class="string" id="3629807">&#39;?&#39;</span><span class="op" id="3629810">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629815">before</span>&nbsp;<span class="op" id="3629822">:=</span>&nbsp;<span class="ident" id="3629825"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629830">switch</span>&nbsp;<span class="ident" id="3629837"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629838">[</span><span class="num" id="3629839">0</span><span class="op" id="3629840">]</span>&nbsp;<span class="op" id="3629842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629847">case</span>&nbsp;<span class="string" id="3629852">&#39;*&#39;</span><span class="op" id="3629855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629861"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span>&nbsp;<span class="op" id="3629864">=</span>&nbsp;<span class="ident" id="3629866"><a href="/gostd/regexp/syntax/regexp.go.html#3668457">OpStar</a></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629876">case</span>&nbsp;<span class="string" id="3629881">&#39;+&#39;</span><span class="op" id="3629884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629890"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span>&nbsp;<span class="op" id="3629893">=</span>&nbsp;<span class="ident" id="3629895"><a href="/gostd/regexp/syntax/regexp.go.html#3668526">OpPlus</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629905">case</span>&nbsp;<span class="string" id="3629910">&#39;?&#39;</span><span class="op" id="3629913">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629919"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span>&nbsp;<span class="op" id="3629922">=</span>&nbsp;<span class="ident" id="3629924"><a href="/gostd/regexp/syntax/regexp.go.html#3668594">OpQuest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3629935">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3629940">after</span>&nbsp;<span class="op" id="3629946">:=</span>&nbsp;<span class="ident" id="3629949"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3629950">[</span><span class="num" id="3629951">1</span><span class="op" id="3629952">:</span><span class="op" id="3629953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3629958">if</span>&nbsp;<span class="ident" id="3629961"><a href="/gostd/regexp/syntax/parse.go.html#3629940">after</a></span><span class="op" id="3629966">,</span>&nbsp;<span class="ident" id="3629968"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3629972">=</span>&nbsp;<span class="ident" id="3629974"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3629975">.</span><span class="ident" id="3629976"><a href="/gostd/regexp/syntax/parse.go.html#3616083">repeat</a></span><span class="op" id="3629982">(</span><span class="ident" id="3629983"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span><span class="op" id="3629985">,</span>&nbsp;<span class="num" id="3629987">0</span><span class="op" id="3629988">,</span>&nbsp;<span class="num" id="3629990">0</span><span class="op" id="3629991">,</span>&nbsp;<span class="ident" id="3629993"><a href="/gostd/regexp/syntax/parse.go.html#3629815">before</a></span><span class="op" id="3629999">,</span>&nbsp;<span class="ident" id="3630001"><a href="/gostd/regexp/syntax/parse.go.html#3629940">after</a></span><span class="op" id="3630006">,</span>&nbsp;<span class="ident" id="3630008"><a href="/gostd/regexp/syntax/parse.go.html#3628666">lastRepeat</a></span><span class="op" id="3630018">)</span><span class="op" id="3630019">;</span>&nbsp;<span class="ident" id="3630021"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3630025">!=</span>&nbsp;<span class="builtintype" id="3630028">nil</span>&nbsp;<span class="op" id="3630032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630038">return</span>&nbsp;<span class="builtintype" id="3630045">nil</span><span class="op" id="3630048">,</span>&nbsp;<span class="ident" id="3630050"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3630057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630062"><a href="/gostd/regexp/syntax/parse.go.html#3628748">repeat</a></span>&nbsp;<span class="op" id="3630069">=</span>&nbsp;<span class="ident" id="3630071"><a href="/gostd/regexp/syntax/parse.go.html#3629815">before</a></span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630081"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630083">=</span>&nbsp;<span class="ident" id="3630085"><a href="/gostd/regexp/syntax/parse.go.html#3629940">after</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630093">case</span>&nbsp;<span class="string" id="3630098">&#39;{&#39;</span><span class="op" id="3630101">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630106"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span>&nbsp;<span class="op" id="3630109">=</span>&nbsp;<span class="ident" id="3630111"><a href="/gostd/regexp/syntax/regexp.go.html#3668662">OpRepeat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630123">before</span>&nbsp;<span class="op" id="3630130">:=</span>&nbsp;<span class="ident" id="3630133"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630138">min</span><span class="op" id="3630141">,</span>&nbsp;<span class="ident" id="3630143">max</span><span class="op" id="3630146">,</span>&nbsp;<span class="ident" id="3630148">after</span><span class="op" id="3630153">,</span>&nbsp;<span class="ident" id="3630155">ok</span>&nbsp;<span class="op" id="3630158">:=</span>&nbsp;<span class="ident" id="3630161"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630162">.</span><span class="ident" id="3630163"><a href="/gostd/regexp/syntax/parse.go.html#3632562">parseRepeat</a></span><span class="op" id="3630174">(</span><span class="ident" id="3630175"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630176">)</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630181">if</span>&nbsp;<span class="op" id="3630184">!</span><span class="ident" id="3630185"><a href="/gostd/regexp/syntax/parse.go.html#3630155">ok</a></span>&nbsp;<span class="op" id="3630188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3630194">//&nbsp;If&nbsp;the&nbsp;repeat&nbsp;cannot&nbsp;be&nbsp;parsed,&nbsp;{&nbsp;is&nbsp;a&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630249"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630250">.</span><span class="ident" id="3630251"><a href="/gostd/regexp/syntax/parse.go.html#3615539">literal</a></span><span class="op" id="3630258">(</span><span class="string" id="3630259">&#39;{&#39;</span><span class="op" id="3630262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630268"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630270">=</span>&nbsp;<span class="ident" id="3630272"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630273">[</span><span class="num" id="3630274">1</span><span class="op" id="3630275">:</span><span class="op" id="3630276">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630282">break</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3630291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630296">if</span>&nbsp;<span class="ident" id="3630299"><a href="/gostd/regexp/syntax/parse.go.html#3630138">min</a></span>&nbsp;<span class="op" id="3630303">&lt;</span>&nbsp;<span class="num" id="3630305">0</span>&nbsp;<span class="op" id="3630307">||</span>&nbsp;<span class="ident" id="3630310"><a href="/gostd/regexp/syntax/parse.go.html#3630138">min</a></span>&nbsp;<span class="op" id="3630314">&gt;</span>&nbsp;<span class="num" id="3630316">1000</span>&nbsp;<span class="op" id="3630321">||</span>&nbsp;<span class="ident" id="3630324"><a href="/gostd/regexp/syntax/parse.go.html#3630143">max</a></span>&nbsp;<span class="op" id="3630328">&gt;</span>&nbsp;<span class="num" id="3630330">1000</span>&nbsp;<span class="op" id="3630335">||</span>&nbsp;<span class="ident" id="3630338"><a href="/gostd/regexp/syntax/parse.go.html#3630143">max</a></span>&nbsp;<span class="op" id="3630342">&gt;=</span>&nbsp;<span class="num" id="3630345">0</span>&nbsp;<span class="op" id="3630347">&amp;&amp;</span>&nbsp;<span class="ident" id="3630350"><a href="/gostd/regexp/syntax/parse.go.html#3630138">min</a></span>&nbsp;<span class="op" id="3630354">&gt;</span>&nbsp;<span class="ident" id="3630356"><a href="/gostd/regexp/syntax/parse.go.html#3630143">max</a></span>&nbsp;<span class="op" id="3630360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3630366">//&nbsp;Numbers&nbsp;were&nbsp;too&nbsp;big,&nbsp;or&nbsp;max&nbsp;is&nbsp;present&nbsp;and&nbsp;min&nbsp;&gt;&nbsp;max.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630428">return</span>&nbsp;<span class="builtintype" id="3630435">nil</span><span class="op" id="3630438">,</span>&nbsp;<span class="op" id="3630440">&amp;</span><span class="ident" id="3630441"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3630446">{</span><span class="ident" id="3630447"><a href="/gostd/regexp/syntax/parse.go.html#3610551">ErrInvalidRepeatSize</a></span><span class="op" id="3630467">,</span>&nbsp;<span class="ident" id="3630469"><a href="/gostd/regexp/syntax/parse.go.html#3630123">before</a></span><span class="op" id="3630475">[</span><span class="op" id="3630476">:</span><span class="builtinfunc" id="3630477">len</span><span class="op" id="3630480">(</span><span class="ident" id="3630481"><a href="/gostd/regexp/syntax/parse.go.html#3630123">before</a></span><span class="op" id="3630487">)</span><span class="op" id="3630488">-</span><span class="builtinfunc" id="3630489">len</span><span class="op" id="3630492">(</span><span class="ident" id="3630493"><a href="/gostd/regexp/syntax/parse.go.html#3630148">after</a></span><span class="op" id="3630498">)</span><span class="op" id="3630499">]</span><span class="op" id="3630500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3630505">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630510">if</span>&nbsp;<span class="ident" id="3630513"><a href="/gostd/regexp/syntax/parse.go.html#3630148">after</a></span><span class="op" id="3630518">,</span>&nbsp;<span class="ident" id="3630520"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3630524">=</span>&nbsp;<span class="ident" id="3630526"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630527">.</span><span class="ident" id="3630528"><a href="/gostd/regexp/syntax/parse.go.html#3616083">repeat</a></span><span class="op" id="3630534">(</span><span class="ident" id="3630535"><a href="/gostd/regexp/syntax/parse.go.html#3628650">op</a></span><span class="op" id="3630537">,</span>&nbsp;<span class="ident" id="3630539"><a href="/gostd/regexp/syntax/parse.go.html#3630138">min</a></span><span class="op" id="3630542">,</span>&nbsp;<span class="ident" id="3630544"><a href="/gostd/regexp/syntax/parse.go.html#3630143">max</a></span><span class="op" id="3630547">,</span>&nbsp;<span class="ident" id="3630549"><a href="/gostd/regexp/syntax/parse.go.html#3630123">before</a></span><span class="op" id="3630555">,</span>&nbsp;<span class="ident" id="3630557"><a href="/gostd/regexp/syntax/parse.go.html#3630148">after</a></span><span class="op" id="3630562">,</span>&nbsp;<span class="ident" id="3630564"><a href="/gostd/regexp/syntax/parse.go.html#3628666">lastRepeat</a></span><span class="op" id="3630574">)</span><span class="op" id="3630575">;</span>&nbsp;<span class="ident" id="3630577"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3630581">!=</span>&nbsp;<span class="builtintype" id="3630584">nil</span>&nbsp;<span class="op" id="3630588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630594">return</span>&nbsp;<span class="builtintype" id="3630601">nil</span><span class="op" id="3630604">,</span>&nbsp;<span class="ident" id="3630606"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3630613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630618"><a href="/gostd/regexp/syntax/parse.go.html#3628748">repeat</a></span>&nbsp;<span class="op" id="3630625">=</span>&nbsp;<span class="ident" id="3630627"><a href="/gostd/regexp/syntax/parse.go.html#3630123">before</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630637"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630639">=</span>&nbsp;<span class="ident" id="3630641"><a href="/gostd/regexp/syntax/parse.go.html#3630148">after</a></span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630649">case</span>&nbsp;<span class="string" id="3630654">&#39;\\&#39;</span><span class="op" id="3630658">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630663">if</span>&nbsp;<span class="ident" id="3630666"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630667">.</span><span class="ident" id="3630668"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3630673">&amp;</span><span class="ident" id="3630674"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3630680">!=</span>&nbsp;<span class="num" id="3630683">0</span>&nbsp;<span class="op" id="3630685">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3630688">len</span><span class="op" id="3630691">(</span><span class="ident" id="3630692"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630693">)</span>&nbsp;<span class="op" id="3630695">&gt;=</span>&nbsp;<span class="num" id="3630698">2</span>&nbsp;<span class="op" id="3630700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630706">switch</span>&nbsp;<span class="ident" id="3630713"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630714">[</span><span class="num" id="3630715">1</span><span class="op" id="3630716">]</span>&nbsp;<span class="op" id="3630718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630724">case</span>&nbsp;<span class="string" id="3630729">&#39;A&#39;</span><span class="op" id="3630732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630739"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630740">.</span><span class="ident" id="3630741"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3630743">(</span><span class="ident" id="3630744"><a href="/gostd/regexp/syntax/regexp.go.html#3668087">OpBeginText</a></span><span class="op" id="3630755">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630762"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630764">=</span>&nbsp;<span class="ident" id="3630766"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630767">[</span><span class="num" id="3630768">2</span><span class="op" id="3630769">:</span><span class="op" id="3630770">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630777">break</span>&nbsp;<span class="ident" id="3630783"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630797">case</span>&nbsp;<span class="string" id="3630802">&#39;b&#39;</span><span class="op" id="3630805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630812"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630813">.</span><span class="ident" id="3630814"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3630816">(</span><span class="ident" id="3630817"><a href="/gostd/regexp/syntax/regexp.go.html#3668235">OpWordBoundary</a></span><span class="op" id="3630831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630838"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630840">=</span>&nbsp;<span class="ident" id="3630842"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630843">[</span><span class="num" id="3630844">2</span><span class="op" id="3630845">:</span><span class="op" id="3630846">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630853">break</span>&nbsp;<span class="ident" id="3630859"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630873">case</span>&nbsp;<span class="string" id="3630878">&#39;B&#39;</span><span class="op" id="3630881">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630888"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3630889">.</span><span class="ident" id="3630890"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3630892">(</span><span class="ident" id="3630893"><a href="/gostd/regexp/syntax/regexp.go.html#3668297">OpNoWordBoundary</a></span><span class="op" id="3630909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3630916"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3630918">=</span>&nbsp;<span class="ident" id="3630920"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3630921">[</span><span class="num" id="3630922">2</span><span class="op" id="3630923">:</span><span class="op" id="3630924">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630931">break</span>&nbsp;<span class="ident" id="3630937"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630951">case</span>&nbsp;<span class="string" id="3630956">&#39;C&#39;</span><span class="op" id="3630959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3630966">//&nbsp;any&nbsp;byte;&nbsp;not&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3630998">return</span>&nbsp;<span class="builtintype" id="3631005">nil</span><span class="op" id="3631008">,</span>&nbsp;<span class="op" id="3631010">&amp;</span><span class="ident" id="3631011"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3631016">{</span><span class="ident" id="3631017"><a href="/gostd/regexp/syntax/parse.go.html#3610275">ErrInvalidEscape</a></span><span class="op" id="3631033">,</span>&nbsp;<span class="ident" id="3631035"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631036">[</span><span class="op" id="3631037">:</span><span class="num" id="3631038">2</span><span class="op" id="3631039">]</span><span class="op" id="3631040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631046">case</span>&nbsp;<span class="string" id="3631051">&#39;Q&#39;</span><span class="op" id="3631054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3631061">//&nbsp;\Q&nbsp;...&nbsp;\E:&nbsp;the&nbsp;...&nbsp;is&nbsp;always&nbsp;literals</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631107">var</span>&nbsp;<span class="ident" id="3631111">lit</span>&nbsp;<span class="builtintype" id="3631115">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631127">if</span>&nbsp;<span class="ident" id="3631130">i</span>&nbsp;<span class="op" id="3631132">:=</span>&nbsp;<span class="ident" id="3631135"><a href="/gostd/regexp/syntax/parse.go.html#3609638">strings</a></span><span class="op" id="3631142">.</span><span class="ident" id="3631143"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="3631148">(</span><span class="ident" id="3631149"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631150">,</span>&nbsp;<span class="string" id="3631152">`\E`</span><span class="op" id="3631156">)</span><span class="op" id="3631157">;</span>&nbsp;<span class="ident" id="3631159"><a href="/gostd/regexp/syntax/parse.go.html#3631130">i</a></span>&nbsp;<span class="op" id="3631161">&lt;</span>&nbsp;<span class="num" id="3631163">0</span>&nbsp;<span class="op" id="3631165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631173"><a href="/gostd/regexp/syntax/parse.go.html#3631111">lit</a></span>&nbsp;<span class="op" id="3631177">=</span>&nbsp;<span class="ident" id="3631179"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631180">[</span><span class="num" id="3631181">2</span><span class="op" id="3631182">:</span><span class="op" id="3631183">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631191"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3631193">=</span>&nbsp;<span class="string" id="3631195">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631203">}</span>&nbsp;<span class="keyword" id="3631205">else</span>&nbsp;<span class="op" id="3631210">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631218"><a href="/gostd/regexp/syntax/parse.go.html#3631111">lit</a></span>&nbsp;<span class="op" id="3631222">=</span>&nbsp;<span class="ident" id="3631224"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631225">[</span><span class="num" id="3631226">2</span><span class="op" id="3631227">:</span><span class="ident" id="3631228"><a href="/gostd/regexp/syntax/parse.go.html#3631130">i</a></span><span class="op" id="3631229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631237"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3631239">=</span>&nbsp;<span class="ident" id="3631241"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631242">[</span><span class="ident" id="3631243"><a href="/gostd/regexp/syntax/parse.go.html#3631130">i</a></span><span class="op" id="3631244">+</span><span class="num" id="3631245">2</span><span class="op" id="3631246">:</span><span class="op" id="3631247">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631261"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631262">.</span><span class="ident" id="3631263"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3631267">(</span><span class="ident" id="3631268"><a href="/gostd/regexp/syntax/parse.go.html#3627771">literalRegexp</a></span><span class="op" id="3631281">(</span><span class="ident" id="3631282"><a href="/gostd/regexp/syntax/parse.go.html#3631111">lit</a></span><span class="op" id="3631285">,</span>&nbsp;<span class="ident" id="3631287"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631288">.</span><span class="ident" id="3631289"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3631294">)</span><span class="op" id="3631295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631302">break</span>&nbsp;<span class="ident" id="3631308"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631322">case</span>&nbsp;<span class="string" id="3631327">&#39;z&#39;</span><span class="op" id="3631330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631337"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631338">.</span><span class="ident" id="3631339"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3631341">(</span><span class="ident" id="3631342"><a href="/gostd/regexp/syntax/regexp.go.html#3668164">OpEndText</a></span><span class="op" id="3631351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631358"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3631360">=</span>&nbsp;<span class="ident" id="3631362"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631363">[</span><span class="num" id="3631364">2</span><span class="op" id="3631365">:</span><span class="op" id="3631366">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631373">break</span>&nbsp;<span class="ident" id="3631379"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631393">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631398">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631404">re</span>&nbsp;<span class="op" id="3631407">:=</span>&nbsp;<span class="ident" id="3631410"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631411">.</span><span class="ident" id="3631412"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3631421">(</span><span class="ident" id="3631422"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><span class="op" id="3631433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631438"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631440">.</span><span class="ident" id="3631441"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3631447">=</span>&nbsp;<span class="ident" id="3631449"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631450">.</span><span class="ident" id="3631451"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3631461">//&nbsp;Look&nbsp;for&nbsp;Unicode&nbsp;character&nbsp;group&nbsp;like&nbsp;\p{Han}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631513">if</span>&nbsp;<span class="builtinfunc" id="3631516">len</span><span class="op" id="3631519">(</span><span class="ident" id="3631520"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631521">)</span>&nbsp;<span class="op" id="3631523">&gt;=</span>&nbsp;<span class="num" id="3631526">2</span>&nbsp;<span class="op" id="3631528">&amp;&amp;</span>&nbsp;<span class="op" id="3631531">(</span><span class="ident" id="3631532"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631533">[</span><span class="num" id="3631534">1</span><span class="op" id="3631535">]</span>&nbsp;<span class="op" id="3631537">==</span>&nbsp;<span class="string" id="3631540">&#39;p&#39;</span>&nbsp;<span class="op" id="3631544">||</span>&nbsp;<span class="ident" id="3631547"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631548">[</span><span class="num" id="3631549">1</span><span class="op" id="3631550">]</span>&nbsp;<span class="op" id="3631552">==</span>&nbsp;<span class="string" id="3631555">&#39;P&#39;</span><span class="op" id="3631558">)</span>&nbsp;<span class="op" id="3631560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631566">r</span><span class="op" id="3631567">,</span>&nbsp;<span class="ident" id="3631569">rest</span><span class="op" id="3631573">,</span>&nbsp;<span class="ident" id="3631575">err</span>&nbsp;<span class="op" id="3631579">:=</span>&nbsp;<span class="ident" id="3631582"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631583">.</span><span class="ident" id="3631584"><a href="/gostd/regexp/syntax/parse.go.html#3645575">parseUnicodeClass</a></span><span class="op" id="3631601">(</span><span class="ident" id="3631602"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631603">,</span>&nbsp;<span class="ident" id="3631605"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631607">.</span><span class="ident" id="3631608"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3631613">[</span><span class="op" id="3631614">:</span><span class="num" id="3631615">0</span><span class="op" id="3631616">]</span><span class="op" id="3631617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631623">if</span>&nbsp;<span class="ident" id="3631626"><a href="/gostd/regexp/syntax/parse.go.html#3631575">err</a></span>&nbsp;<span class="op" id="3631630">!=</span>&nbsp;<span class="builtintype" id="3631633">nil</span>&nbsp;<span class="op" id="3631637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631644">return</span>&nbsp;<span class="builtintype" id="3631651">nil</span><span class="op" id="3631654">,</span>&nbsp;<span class="ident" id="3631656"><a href="/gostd/regexp/syntax/parse.go.html#3631575">err</a></span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631670">if</span>&nbsp;<span class="ident" id="3631673"><a href="/gostd/regexp/syntax/parse.go.html#3631566">r</a></span>&nbsp;<span class="op" id="3631675">!=</span>&nbsp;<span class="builtintype" id="3631678">nil</span>&nbsp;<span class="op" id="3631682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631689"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631691">.</span><span class="ident" id="3631692"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3631697">=</span>&nbsp;<span class="ident" id="3631699"><a href="/gostd/regexp/syntax/parse.go.html#3631566">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631706"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3631708">=</span>&nbsp;<span class="ident" id="3631710"><a href="/gostd/regexp/syntax/parse.go.html#3631569">rest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631720"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631721">.</span><span class="ident" id="3631722"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3631726">(</span><span class="ident" id="3631727"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631729">)</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631736">break</span>&nbsp;<span class="ident" id="3631742"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3631767">//&nbsp;Perl&nbsp;character&nbsp;class&nbsp;escape.</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631802">if</span>&nbsp;<span class="ident" id="3631805">r</span><span class="op" id="3631806">,</span>&nbsp;<span class="ident" id="3631808">rest</span>&nbsp;<span class="op" id="3631813">:=</span>&nbsp;<span class="ident" id="3631816"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631817">.</span><span class="ident" id="3631818"><a href="/gostd/regexp/syntax/parse.go.html#3643432">parsePerlClassEscape</a></span><span class="op" id="3631838">(</span><span class="ident" id="3631839"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3631840">,</span>&nbsp;<span class="ident" id="3631842"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631844">.</span><span class="ident" id="3631845"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3631850">[</span><span class="op" id="3631851">:</span><span class="num" id="3631852">0</span><span class="op" id="3631853">]</span><span class="op" id="3631854">)</span><span class="op" id="3631855">;</span>&nbsp;<span class="ident" id="3631857"><a href="/gostd/regexp/syntax/parse.go.html#3631805">r</a></span>&nbsp;<span class="op" id="3631859">!=</span>&nbsp;<span class="builtintype" id="3631862">nil</span>&nbsp;<span class="op" id="3631866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631872"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631874">.</span><span class="ident" id="3631875"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3631880">=</span>&nbsp;<span class="ident" id="3631882"><a href="/gostd/regexp/syntax/parse.go.html#3631805">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631888"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span>&nbsp;<span class="op" id="3631890">=</span>&nbsp;<span class="ident" id="3631892"><a href="/gostd/regexp/syntax/parse.go.html#3631808">rest</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631901"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631902">.</span><span class="ident" id="3631903"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3631907">(</span><span class="ident" id="3631908"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631916">break</span>&nbsp;<span class="ident" id="3631922"><a href="/gostd/regexp/syntax/parse.go.html#3628762">BigSwitch</a></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3631935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3631940"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3631941">.</span><span class="ident" id="3631942"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3631947">(</span><span class="ident" id="3631948"><a href="/gostd/regexp/syntax/parse.go.html#3631404">re</a></span><span class="op" id="3631950">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3631956">//&nbsp;Ordinary&nbsp;single-character&nbsp;escape.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3631996">if</span>&nbsp;<span class="ident" id="3631999"><a href="/gostd/regexp/syntax/parse.go.html#3628632">c</a></span><span class="op" id="3632000">,</span>&nbsp;<span class="ident" id="3632002"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3632003">,</span>&nbsp;<span class="ident" id="3632005"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3632009">=</span>&nbsp;<span class="ident" id="3632011"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632012">.</span><span class="ident" id="3632013"><a href="/gostd/regexp/syntax/parse.go.html#3640268">parseEscape</a></span><span class="op" id="3632024">(</span><span class="ident" id="3632025"><a href="/gostd/regexp/syntax/parse.go.html#3628724">t</a></span><span class="op" id="3632026">)</span><span class="op" id="3632027">;</span>&nbsp;<span class="ident" id="3632029"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span>&nbsp;<span class="op" id="3632033">!=</span>&nbsp;<span class="builtintype" id="3632036">nil</span>&nbsp;<span class="op" id="3632040">{</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632046">return</span>&nbsp;<span class="builtintype" id="3632053">nil</span><span class="op" id="3632056">,</span>&nbsp;<span class="ident" id="3632058"><a href="/gostd/regexp/syntax/parse.go.html#3628613">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632070"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632071">.</span><span class="ident" id="3632072"><a href="/gostd/regexp/syntax/parse.go.html#3615539">literal</a></span><span class="op" id="3632079">(</span><span class="ident" id="3632080"><a href="/gostd/regexp/syntax/parse.go.html#3628632">c</a></span><span class="op" id="3632081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632089"><a href="/gostd/regexp/syntax/parse.go.html#3628666">lastRepeat</a></span>&nbsp;<span class="op" id="3632100">=</span>&nbsp;<span class="ident" id="3632102"><a href="/gostd/regexp/syntax/parse.go.html#3628748">repeat</a></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632114"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632115">.</span><span class="ident" id="3632116"><a href="/gostd/regexp/syntax/parse.go.html#3618127">concat</a></span><span class="op" id="3632122">(</span><span class="op" id="3632123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632126">if</span>&nbsp;<span class="ident" id="3632129"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632130">.</span><span class="ident" id="3632131"><a href="/gostd/regexp/syntax/parse.go.html#3638730">swapVerticalBar</a></span><span class="op" id="3632146">(</span><span class="op" id="3632147">)</span>&nbsp;<span class="op" id="3632149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3632153">//&nbsp;pop&nbsp;vertical&nbsp;bar</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632175"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632176">.</span><span class="ident" id="3632177"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3632183">=</span>&nbsp;<span class="ident" id="3632185"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632186">.</span><span class="ident" id="3632187"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3632192">[</span><span class="op" id="3632193">:</span><span class="builtinfunc" id="3632194">len</span><span class="op" id="3632197">(</span><span class="ident" id="3632198"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632199">.</span><span class="ident" id="3632200"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3632205">)</span><span class="op" id="3632206">-</span><span class="num" id="3632207">1</span><span class="op" id="3632208">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632214"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632215">.</span><span class="ident" id="3632216"><a href="/gostd/regexp/syntax/parse.go.html#3618592">alternate</a></span><span class="op" id="3632225">(</span><span class="op" id="3632226">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632230">n</span>&nbsp;<span class="op" id="3632232">:=</span>&nbsp;<span class="builtinfunc" id="3632235">len</span><span class="op" id="3632238">(</span><span class="ident" id="3632239"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632240">.</span><span class="ident" id="3632241"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3632246">)</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632249">if</span>&nbsp;<span class="ident" id="3632252"><a href="/gostd/regexp/syntax/parse.go.html#3632230">n</a></span>&nbsp;<span class="op" id="3632254">!=</span>&nbsp;<span class="num" id="3632257">1</span>&nbsp;<span class="op" id="3632259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632263">return</span>&nbsp;<span class="builtintype" id="3632270">nil</span><span class="op" id="3632273">,</span>&nbsp;<span class="op" id="3632275">&amp;</span><span class="ident" id="3632276"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3632281">{</span><span class="ident" id="3632282"><a href="/gostd/regexp/syntax/parse.go.html#3610724">ErrMissingParen</a></span><span class="op" id="3632297">,</span>&nbsp;<span class="ident" id="3632299"><a href="/gostd/regexp/syntax/parse.go.html#3628339">s</a></span><span class="op" id="3632300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632303">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632306">return</span>&nbsp;<span class="ident" id="3632313"><a href="/gostd/regexp/syntax/parse.go.html#3628593">p</a></span><span class="op" id="3632314">.</span><span class="ident" id="3632315"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3632320">[</span><span class="num" id="3632321">0</span><span class="op" id="3632322">]</span><span class="op" id="3632323">,</span>&nbsp;<span class="builtintype" id="3632325">nil</span><br>
<span class="lineno"></span><span class="op" id="3632329">}</span><br>
<span class="lineno">890</span><br>
<span class="lineno"></span><span class="comment" id="3632332">//&nbsp;parseRepeat&nbsp;parses&nbsp;{min}&nbsp;(max=min)&nbsp;or&nbsp;{min,}&nbsp;(max=-1)&nbsp;or&nbsp;{min,max}.</span><br>
<span class="lineno"></span><span class="comment" id="3632403">//&nbsp;If&nbsp;s&nbsp;is&nbsp;not&nbsp;of&nbsp;that&nbsp;form,&nbsp;it&nbsp;returns&nbsp;ok&nbsp;==&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="3632456">//&nbsp;If&nbsp;s&nbsp;has&nbsp;the&nbsp;right&nbsp;form&nbsp;but&nbsp;the&nbsp;values&nbsp;are&nbsp;too&nbsp;big,&nbsp;it&nbsp;returns&nbsp;min&nbsp;==&nbsp;-1,&nbsp;ok&nbsp;==&nbsp;true.</span><br>
<span class="lineno"></span><span class="keyword" id="3632545">func</span>&nbsp;<span class="op" id="3632550">(</span><span class="ident" id="3632551">p</span>&nbsp;<span class="op" id="3632553">*</span><span class="ident" id="3632554"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3632560">)</span>&nbsp;<span class="ident" id="3632562">parseRepeat</span><span class="op" id="3632573">(</span><span class="ident" id="3632574">s</span>&nbsp;<span class="builtintype" id="3632576">string</span><span class="op" id="3632582">)</span>&nbsp;<span class="op" id="3632584">(</span><span class="ident" id="3632585">min</span><span class="op" id="3632588">,</span>&nbsp;<span class="ident" id="3632590">max</span>&nbsp;<span class="builtintype" id="3632594">int</span><span class="op" id="3632597">,</span>&nbsp;<span class="ident" id="3632599">rest</span>&nbsp;<span class="builtintype" id="3632604">string</span><span class="op" id="3632610">,</span>&nbsp;<span class="ident" id="3632612">ok</span>&nbsp;<span class="builtintype" id="3632615">bool</span><span class="op" id="3632619">)</span>&nbsp;<span class="op" id="3632621">{</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632624">if</span>&nbsp;<span class="ident" id="3632627"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3632629">==</span>&nbsp;<span class="string" id="3632632">&#34;&#34;</span>&nbsp;<span class="op" id="3632635">||</span>&nbsp;<span class="ident" id="3632638"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632639">[</span><span class="num" id="3632640">0</span><span class="op" id="3632641">]</span>&nbsp;<span class="op" id="3632643">!=</span>&nbsp;<span class="string" id="3632646">&#39;{&#39;</span>&nbsp;<span class="op" id="3632650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632654">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632662">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632665"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3632667">=</span>&nbsp;<span class="ident" id="3632669"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632670">[</span><span class="num" id="3632671">1</span><span class="op" id="3632672">:</span><span class="op" id="3632673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632676">var</span>&nbsp;<span class="ident" id="3632680">ok1</span>&nbsp;<span class="builtintype" id="3632684">bool</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632690">if</span>&nbsp;<span class="ident" id="3632693"><a href="/gostd/regexp/syntax/parse.go.html#3632585">min</a></span><span class="op" id="3632696">,</span>&nbsp;<span class="ident" id="3632698"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632699">,</span>&nbsp;<span class="ident" id="3632701"><a href="/gostd/regexp/syntax/parse.go.html#3632680">ok1</a></span>&nbsp;<span class="op" id="3632705">=</span>&nbsp;<span class="ident" id="3632707"><a href="/gostd/regexp/syntax/parse.go.html#3632551">p</a></span><span class="op" id="3632708">.</span><span class="ident" id="3632709"><a href="/gostd/regexp/syntax/parse.go.html#3636230">parseInt</a></span><span class="op" id="3632717">(</span><span class="ident" id="3632718"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632719">)</span><span class="op" id="3632720">;</span>&nbsp;<span class="op" id="3632722">!</span><span class="ident" id="3632723"><a href="/gostd/regexp/syntax/parse.go.html#3632680">ok1</a></span>&nbsp;<span class="op" id="3632727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632731">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632742">if</span>&nbsp;<span class="ident" id="3632745"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3632747">==</span>&nbsp;<span class="string" id="3632750">&#34;&#34;</span>&nbsp;<span class="op" id="3632753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632757">return</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632768">if</span>&nbsp;<span class="ident" id="3632771"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632772">[</span><span class="num" id="3632773">0</span><span class="op" id="3632774">]</span>&nbsp;<span class="op" id="3632776">!=</span>&nbsp;<span class="string" id="3632779">&#39;,&#39;</span>&nbsp;<span class="op" id="3632783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632787"><a href="/gostd/regexp/syntax/parse.go.html#3632590">max</a></span>&nbsp;<span class="op" id="3632791">=</span>&nbsp;<span class="ident" id="3632793"><a href="/gostd/regexp/syntax/parse.go.html#3632585">min</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632798">}</span>&nbsp;<span class="keyword" id="3632800">else</span>&nbsp;<span class="op" id="3632805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632809"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3632811">=</span>&nbsp;<span class="ident" id="3632813"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632814">[</span><span class="num" id="3632815">1</span><span class="op" id="3632816">:</span><span class="op" id="3632817">]</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632821">if</span>&nbsp;<span class="ident" id="3632824"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3632826">==</span>&nbsp;<span class="string" id="3632829">&#34;&#34;</span>&nbsp;<span class="op" id="3632832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632850">if</span>&nbsp;<span class="ident" id="3632853"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632854">[</span><span class="num" id="3632855">0</span><span class="op" id="3632856">]</span>&nbsp;<span class="op" id="3632858">==</span>&nbsp;<span class="string" id="3632861">&#39;}&#39;</span>&nbsp;<span class="op" id="3632865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3632870"><a href="/gostd/regexp/syntax/parse.go.html#3632590">max</a></span>&nbsp;<span class="op" id="3632874">=</span>&nbsp;<span class="op" id="3632876">-</span><span class="num" id="3632877">1</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632881">}</span>&nbsp;<span class="keyword" id="3632883">else</span>&nbsp;<span class="keyword" id="3632888">if</span>&nbsp;<span class="ident" id="3632891"><a href="/gostd/regexp/syntax/parse.go.html#3632590">max</a></span><span class="op" id="3632894">,</span>&nbsp;<span class="ident" id="3632896"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632897">,</span>&nbsp;<span class="ident" id="3632899"><a href="/gostd/regexp/syntax/parse.go.html#3632680">ok1</a></span>&nbsp;<span class="op" id="3632903">=</span>&nbsp;<span class="ident" id="3632905"><a href="/gostd/regexp/syntax/parse.go.html#3632551">p</a></span><span class="op" id="3632906">.</span><span class="ident" id="3632907"><a href="/gostd/regexp/syntax/parse.go.html#3636230">parseInt</a></span><span class="op" id="3632915">(</span><span class="ident" id="3632916"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3632917">)</span><span class="op" id="3632918">;</span>&nbsp;<span class="op" id="3632920">!</span><span class="ident" id="3632921"><a href="/gostd/regexp/syntax/parse.go.html#3632680">ok1</a></span>&nbsp;<span class="op" id="3632925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3632930">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3632939">}</span>&nbsp;<span class="keyword" id="3632941">else</span>&nbsp;<span class="keyword" id="3632946">if</span>&nbsp;<span class="ident" id="3632949"><a href="/gostd/regexp/syntax/parse.go.html#3632590">max</a></span>&nbsp;<span class="op" id="3632953">&lt;</span>&nbsp;<span class="num" id="3632955">0</span>&nbsp;<span class="op" id="3632957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3632962">//&nbsp;parseInt&nbsp;found&nbsp;too&nbsp;big&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633000"><a href="/gostd/regexp/syntax/parse.go.html#3632585">min</a></span>&nbsp;<span class="op" id="3633004">=</span>&nbsp;<span class="op" id="3633006">-</span><span class="num" id="3633007">1</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3633011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3633014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633017">if</span>&nbsp;<span class="ident" id="3633020"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span>&nbsp;<span class="op" id="3633022">==</span>&nbsp;<span class="string" id="3633025">&#34;&#34;</span>&nbsp;<span class="op" id="3633028">||</span>&nbsp;<span class="ident" id="3633031"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3633032">[</span><span class="num" id="3633033">0</span><span class="op" id="3633034">]</span>&nbsp;<span class="op" id="3633036">!=</span>&nbsp;<span class="string" id="3633039">&#39;}&#39;</span>&nbsp;<span class="op" id="3633043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633047">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3633055">}</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633058"><a href="/gostd/regexp/syntax/parse.go.html#3632599">rest</a></span>&nbsp;<span class="op" id="3633063">=</span>&nbsp;<span class="ident" id="3633065"><a href="/gostd/regexp/syntax/parse.go.html#3632574">s</a></span><span class="op" id="3633066">[</span><span class="num" id="3633067">1</span><span class="op" id="3633068">:</span><span class="op" id="3633069">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633072"><a href="/gostd/regexp/syntax/parse.go.html#3632612">ok</a></span>&nbsp;<span class="op" id="3633075">=</span>&nbsp;<span class="builtintype" id="3633077">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3633083">return</span><br>
<span class="lineno"></span><span class="op" id="3633090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">930</span><span class="comment" id="3633093">//&nbsp;parsePerlFlags&nbsp;parses&nbsp;a&nbsp;Perl&nbsp;flag&nbsp;setting&nbsp;or&nbsp;non-capturing&nbsp;group&nbsp;or&nbsp;both,</span><br>
<span class="lineno"></span><span class="comment" id="3633170">//&nbsp;like&nbsp;(?i)&nbsp;or&nbsp;(?:&nbsp;or&nbsp;(?i:.&nbsp;&nbsp;It&nbsp;removes&nbsp;the&nbsp;prefix&nbsp;from&nbsp;s&nbsp;and&nbsp;updates&nbsp;the&nbsp;parse&nbsp;state.</span><br>
<span class="lineno"></span><span class="comment" id="3633258">//&nbsp;The&nbsp;caller&nbsp;must&nbsp;have&nbsp;ensured&nbsp;that&nbsp;s&nbsp;begins&nbsp;with&nbsp;&#34;(?&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3633315">func</span>&nbsp;<span class="op" id="3633320">(</span><span class="ident" id="3633321">p</span>&nbsp;<span class="op" id="3633323">*</span><span class="ident" id="3633324"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3633330">)</span>&nbsp;<span class="ident" id="3633332">parsePerlFlags</span><span class="op" id="3633346">(</span><span class="ident" id="3633347">s</span>&nbsp;<span class="builtintype" id="3633349">string</span><span class="op" id="3633355">)</span>&nbsp;<span class="op" id="3633357">(</span><span class="ident" id="3633358">rest</span>&nbsp;<span class="builtintype" id="3633363">string</span><span class="op" id="3633369">,</span>&nbsp;<span class="ident" id="3633371">err</span>&nbsp;<span class="builtintype" id="3633375">error</span><span class="op" id="3633380">)</span>&nbsp;<span class="op" id="3633382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3633385">t</span>&nbsp;<span class="op" id="3633387">:=</span>&nbsp;<span class="ident" id="3633390"><a href="/gostd/regexp/syntax/parse.go.html#3633347">s</a></span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633394">//&nbsp;Check&nbsp;for&nbsp;named&nbsp;captures,&nbsp;first&nbsp;introduced&nbsp;in&nbsp;Python&#39;s&nbsp;regexp&nbsp;library.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633469">//&nbsp;As&nbsp;usual,&nbsp;there&nbsp;are&nbsp;three&nbsp;slightly&nbsp;different&nbsp;syntaxes:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633528">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633532">//&nbsp;&nbsp;&nbsp;(?P&lt;name&gt;expr)&nbsp;&nbsp;&nbsp;the&nbsp;original,&nbsp;introduced&nbsp;by&nbsp;Python</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633590">//&nbsp;&nbsp;&nbsp;(?&lt;name&gt;expr)&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;.NET&nbsp;alteration,&nbsp;adopted&nbsp;by&nbsp;Perl&nbsp;5.10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633655">//&nbsp;&nbsp;&nbsp;(?&#39;name&#39;expr)&nbsp;&nbsp;&nbsp;&nbsp;another&nbsp;.NET&nbsp;alteration,&nbsp;adopted&nbsp;by&nbsp;Perl&nbsp;5.10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633724">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633728">//&nbsp;Perl&nbsp;5.10&nbsp;gave&nbsp;in&nbsp;and&nbsp;implemented&nbsp;the&nbsp;Python&nbsp;version&nbsp;too,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633790">//&nbsp;but&nbsp;they&nbsp;claim&nbsp;that&nbsp;the&nbsp;last&nbsp;two&nbsp;are&nbsp;the&nbsp;preferred&nbsp;forms.</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633852">//&nbsp;PCRE&nbsp;and&nbsp;languages&nbsp;based&nbsp;on&nbsp;it&nbsp;(specifically,&nbsp;PHP&nbsp;and&nbsp;Ruby)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633916">//&nbsp;support&nbsp;all&nbsp;three&nbsp;as&nbsp;well.&nbsp;&nbsp;EcmaScript&nbsp;4&nbsp;uses&nbsp;only&nbsp;the&nbsp;Python&nbsp;form.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633988">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3633992">//&nbsp;In&nbsp;both&nbsp;the&nbsp;open&nbsp;source&nbsp;world&nbsp;(via&nbsp;Code&nbsp;Search)&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634052">//&nbsp;Google&nbsp;source&nbsp;tree,&nbsp;(?P&lt;expr&gt;name)&nbsp;is&nbsp;the&nbsp;dominant&nbsp;form,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634113">//&nbsp;so&nbsp;that&#39;s&nbsp;the&nbsp;one&nbsp;we&nbsp;implement.&nbsp;&nbsp;One&nbsp;is&nbsp;enough.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634165">if</span>&nbsp;<span class="builtinfunc" id="3634168">len</span><span class="op" id="3634171">(</span><span class="ident" id="3634172"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634173">)</span>&nbsp;<span class="op" id="3634175">&gt;</span>&nbsp;<span class="num" id="3634177">4</span>&nbsp;<span class="op" id="3634179">&amp;&amp;</span>&nbsp;<span class="ident" id="3634182"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634183">[</span><span class="num" id="3634184">2</span><span class="op" id="3634185">]</span>&nbsp;<span class="op" id="3634187">==</span>&nbsp;<span class="string" id="3634190">&#39;P&#39;</span>&nbsp;<span class="op" id="3634194">&amp;&amp;</span>&nbsp;<span class="ident" id="3634197"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634198">[</span><span class="num" id="3634199">3</span><span class="op" id="3634200">]</span>&nbsp;<span class="op" id="3634202">==</span>&nbsp;<span class="string" id="3634205">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="3634209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634213">//&nbsp;Pull&nbsp;out&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634233">end</span>&nbsp;<span class="op" id="3634237">:=</span>&nbsp;<span class="ident" id="3634240"><a href="/gostd/regexp/syntax/parse.go.html#3609638">strings</a></span><span class="op" id="3634247">.</span><span class="ident" id="3634248"><a href="/gostd/strings/strings.go.html#2970424">IndexRune</a></span><span class="op" id="3634257">(</span><span class="ident" id="3634258"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634259">,</span>&nbsp;<span class="string" id="3634261">&#39;&gt;&#39;</span><span class="op" id="3634264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634268">if</span>&nbsp;<span class="ident" id="3634271"><a href="/gostd/regexp/syntax/parse.go.html#3634233">end</a></span>&nbsp;<span class="op" id="3634275">&lt;</span>&nbsp;<span class="num" id="3634277">0</span>&nbsp;<span class="op" id="3634279">{</span><br>
<span class="lineno">955</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634284">if</span>&nbsp;<span class="ident" id="3634287"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634291">=</span>&nbsp;<span class="ident" id="3634293"><a href="/gostd/regexp/syntax/parse.go.html#3655517">checkUTF8</a></span><span class="op" id="3634302">(</span><span class="ident" id="3634303"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634304">)</span><span class="op" id="3634305">;</span>&nbsp;<span class="ident" id="3634307"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634311">!=</span>&nbsp;<span class="builtintype" id="3634314">nil</span>&nbsp;<span class="op" id="3634318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634324">return</span>&nbsp;<span class="string" id="3634331">&#34;&#34;</span><span class="op" id="3634333">,</span>&nbsp;<span class="ident" id="3634335"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634347">return</span>&nbsp;<span class="string" id="3634354">&#34;&#34;</span><span class="op" id="3634356">,</span>&nbsp;<span class="op" id="3634358">&amp;</span><span class="ident" id="3634359"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3634364">{</span><span class="ident" id="3634365"><a href="/gostd/regexp/syntax/parse.go.html#3610339">ErrInvalidNamedCapture</a></span><span class="op" id="3634387">,</span>&nbsp;<span class="ident" id="3634389"><a href="/gostd/regexp/syntax/parse.go.html#3633347">s</a></span><span class="op" id="3634390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634394">}</span><br>
<span class="lineno">960</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634399">capture</span>&nbsp;<span class="op" id="3634407">:=</span>&nbsp;<span class="ident" id="3634410"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634411">[</span><span class="op" id="3634412">:</span><span class="ident" id="3634413"><a href="/gostd/regexp/syntax/parse.go.html#3634233">end</a></span><span class="op" id="3634416">+</span><span class="num" id="3634417">1</span><span class="op" id="3634418">]</span>&nbsp;<span class="comment" id="3634420">//&nbsp;&#34;(?P&lt;name&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634437">name</span>&nbsp;<span class="op" id="3634442">:=</span>&nbsp;<span class="ident" id="3634445"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634446">[</span><span class="num" id="3634447">4</span><span class="op" id="3634448">:</span><span class="ident" id="3634449"><a href="/gostd/regexp/syntax/parse.go.html#3634233">end</a></span><span class="op" id="3634452">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634458">//&nbsp;&#34;name&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634470">if</span>&nbsp;<span class="ident" id="3634473"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634477">=</span>&nbsp;<span class="ident" id="3634479"><a href="/gostd/regexp/syntax/parse.go.html#3655517">checkUTF8</a></span><span class="op" id="3634488">(</span><span class="ident" id="3634489"><a href="/gostd/regexp/syntax/parse.go.html#3634437">name</a></span><span class="op" id="3634493">)</span><span class="op" id="3634494">;</span>&nbsp;<span class="ident" id="3634496"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634500">!=</span>&nbsp;<span class="builtintype" id="3634503">nil</span>&nbsp;<span class="op" id="3634507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634512">return</span>&nbsp;<span class="string" id="3634519">&#34;&#34;</span><span class="op" id="3634521">,</span>&nbsp;<span class="ident" id="3634523"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634533">if</span>&nbsp;<span class="op" id="3634536">!</span><span class="ident" id="3634537"><a href="/gostd/regexp/syntax/parse.go.html#3636005">isValidCaptureName</a></span><span class="op" id="3634555">(</span><span class="ident" id="3634556"><a href="/gostd/regexp/syntax/parse.go.html#3634437">name</a></span><span class="op" id="3634560">)</span>&nbsp;<span class="op" id="3634562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634567">return</span>&nbsp;<span class="string" id="3634574">&#34;&#34;</span><span class="op" id="3634576">,</span>&nbsp;<span class="op" id="3634578">&amp;</span><span class="ident" id="3634579"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3634584">{</span><span class="ident" id="3634585"><a href="/gostd/regexp/syntax/parse.go.html#3610339">ErrInvalidNamedCapture</a></span><span class="op" id="3634607">,</span>&nbsp;<span class="ident" id="3634609"><a href="/gostd/regexp/syntax/parse.go.html#3634399">capture</a></span><span class="op" id="3634616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634625">//&nbsp;Like&nbsp;ordinary&nbsp;capture,&nbsp;but&nbsp;named.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634664"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3634665">.</span><span class="ident" id="3634666"><a href="/gostd/regexp/syntax/parse.go.html#3612357">numCap</a></span><span class="op" id="3634672">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634677">re</span>&nbsp;<span class="op" id="3634680">:=</span>&nbsp;<span class="ident" id="3634683"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3634684">.</span><span class="ident" id="3634685"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3634687">(</span><span class="ident" id="3634688"><a href="/gostd/regexp/syntax/parse.go.html#3612169">opLeftParen</a></span><span class="op" id="3634699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634703"><a href="/gostd/regexp/syntax/parse.go.html#3634677">re</a></span><span class="op" id="3634705">.</span><span class="ident" id="3634706"><a href="/gostd/regexp/syntax/regexp.go.html#3667181">Cap</a></span>&nbsp;<span class="op" id="3634710">=</span>&nbsp;<span class="ident" id="3634712"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3634713">.</span><span class="ident" id="3634714"><a href="/gostd/regexp/syntax/parse.go.html#3612357">numCap</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634723"><a href="/gostd/regexp/syntax/parse.go.html#3634677">re</a></span><span class="op" id="3634725">.</span><span class="ident" id="3634726"><a href="/gostd/regexp/syntax/regexp.go.html#3667236">Name</a></span>&nbsp;<span class="op" id="3634731">=</span>&nbsp;<span class="ident" id="3634733"><a href="/gostd/regexp/syntax/parse.go.html#3634437">name</a></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634740">return</span>&nbsp;<span class="ident" id="3634747"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634748">[</span><span class="ident" id="3634749"><a href="/gostd/regexp/syntax/parse.go.html#3634233">end</a></span><span class="op" id="3634752">+</span><span class="num" id="3634753">1</span><span class="op" id="3634754">:</span><span class="op" id="3634755">]</span><span class="op" id="3634756">,</span>&nbsp;<span class="builtintype" id="3634758">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3634767">//&nbsp;Non-capturing&nbsp;group.&nbsp;&nbsp;Might&nbsp;also&nbsp;twiddle&nbsp;Perl&nbsp;flags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634824">var</span>&nbsp;<span class="ident" id="3634828">c</span>&nbsp;<span class="builtintype" id="3634830">rune</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634836"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span>&nbsp;<span class="op" id="3634838">=</span>&nbsp;<span class="ident" id="3634840"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634841">[</span><span class="num" id="3634842">2</span><span class="op" id="3634843">:</span><span class="op" id="3634844">]</span>&nbsp;<span class="comment" id="3634846">//&nbsp;skip&nbsp;(?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634858">flags</span>&nbsp;<span class="op" id="3634864">:=</span>&nbsp;<span class="ident" id="3634867"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3634868">.</span><span class="ident" id="3634869"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634876">sign</span>&nbsp;<span class="op" id="3634881">:=</span>&nbsp;<span class="op" id="3634884">+</span><span class="num" id="3634885">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3634888">sawFlag</span>&nbsp;<span class="op" id="3634896">:=</span>&nbsp;<span class="builtintype" id="3634899">false</span><br>
<span class="lineno"></span><span class="ident" id="3634905">Loop</span><span class="op" id="3634909">:</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634912">for</span>&nbsp;<span class="ident" id="3634916"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span>&nbsp;<span class="op" id="3634918">!=</span>&nbsp;<span class="string" id="3634921">&#34;&#34;</span>&nbsp;<span class="op" id="3634924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634928">if</span>&nbsp;<span class="ident" id="3634931"><a href="/gostd/regexp/syntax/parse.go.html#3634828">c</a></span><span class="op" id="3634932">,</span>&nbsp;<span class="ident" id="3634934"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634935">,</span>&nbsp;<span class="ident" id="3634937"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634941">=</span>&nbsp;<span class="ident" id="3634943"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3634951">(</span><span class="ident" id="3634952"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3634953">)</span><span class="op" id="3634954">;</span>&nbsp;<span class="ident" id="3634956"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span>&nbsp;<span class="op" id="3634960">!=</span>&nbsp;<span class="builtintype" id="3634963">nil</span>&nbsp;<span class="op" id="3634967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634972">return</span>&nbsp;<span class="string" id="3634979">&#34;&#34;</span><span class="op" id="3634981">,</span>&nbsp;<span class="ident" id="3634983"><a href="/gostd/regexp/syntax/parse.go.html#3633371">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3634989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3634993">switch</span>&nbsp;<span class="ident" id="3635000"><a href="/gostd/regexp/syntax/parse.go.html#3634828">c</a></span>&nbsp;<span class="op" id="3635002">{</span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635006">default</span><span class="op" id="3635013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635018">break</span>&nbsp;<span class="ident" id="3635024"><a href="/gostd/regexp/syntax/parse.go.html#3634905">Loop</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635032">//&nbsp;Flags.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635044">case</span>&nbsp;<span class="string" id="3635049">&#39;i&#39;</span><span class="op" id="3635052">:</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635057"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635063">|=</span>&nbsp;<span class="ident" id="3635066"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635078"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635086">=</span>&nbsp;<span class="builtintype" id="3635088">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635095">case</span>&nbsp;<span class="string" id="3635100">&#39;m&#39;</span><span class="op" id="3635103">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635108"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635114">&amp;^=</span>&nbsp;<span class="ident" id="3635118"><a href="/gostd/regexp/syntax/parse.go.html#3611465">OneLine</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635129"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635137">=</span>&nbsp;<span class="builtintype" id="3635139">true</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635146">case</span>&nbsp;<span class="string" id="3635151">&#39;s&#39;</span><span class="op" id="3635154">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635159"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635165">|=</span>&nbsp;<span class="ident" id="3635168"><a href="/gostd/regexp/syntax/parse.go.html#3611404">DotNL</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635177"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635185">=</span>&nbsp;<span class="builtintype" id="3635187">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635194">case</span>&nbsp;<span class="string" id="3635199">&#39;U&#39;</span><span class="op" id="3635202">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635207"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635213">|=</span>&nbsp;<span class="ident" id="3635216"><a href="/gostd/regexp/syntax/parse.go.html#3611561">NonGreedy</a></span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635229"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635237">=</span>&nbsp;<span class="builtintype" id="3635239">true</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635247">//&nbsp;Switch&nbsp;to&nbsp;negation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635272">case</span>&nbsp;<span class="string" id="3635277">&#39;-&#39;</span><span class="op" id="3635280">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635285">if</span>&nbsp;<span class="ident" id="3635288"><a href="/gostd/regexp/syntax/parse.go.html#3634876">sign</a></span>&nbsp;<span class="op" id="3635293">&lt;</span>&nbsp;<span class="num" id="3635295">0</span>&nbsp;<span class="op" id="3635297">{</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635303">break</span>&nbsp;<span class="ident" id="3635309"><a href="/gostd/regexp/syntax/parse.go.html#3634905">Loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635317">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635322"><a href="/gostd/regexp/syntax/parse.go.html#3634876">sign</a></span>&nbsp;<span class="op" id="3635327">=</span>&nbsp;<span class="op" id="3635329">-</span><span class="num" id="3635330">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635335">//&nbsp;Invert&nbsp;flags&nbsp;so&nbsp;that&nbsp;|&nbsp;above&nbsp;turn&nbsp;into&nbsp;&amp;^&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635399">//&nbsp;We&#39;ll&nbsp;invert&nbsp;flags&nbsp;again&nbsp;before&nbsp;using&nbsp;it&nbsp;below.</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635453"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635459">=</span>&nbsp;<span class="op" id="3635461">^</span><span class="ident" id="3635462"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635471"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635479">=</span>&nbsp;<span class="builtintype" id="3635481">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635490">//&nbsp;End&nbsp;of&nbsp;flags,&nbsp;starting&nbsp;group&nbsp;or&nbsp;not.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635532">case</span>&nbsp;<span class="string" id="3635537">&#39;:&#39;</span><span class="op" id="3635540">,</span>&nbsp;<span class="string" id="3635542">&#39;)&#39;</span><span class="op" id="3635545">:</span><br>
<span class="lineno">1020</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635550">if</span>&nbsp;<span class="ident" id="3635553"><a href="/gostd/regexp/syntax/parse.go.html#3634876">sign</a></span>&nbsp;<span class="op" id="3635558">&lt;</span>&nbsp;<span class="num" id="3635560">0</span>&nbsp;<span class="op" id="3635562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635568">if</span>&nbsp;<span class="op" id="3635571">!</span><span class="ident" id="3635572"><a href="/gostd/regexp/syntax/parse.go.html#3634888">sawFlag</a></span>&nbsp;<span class="op" id="3635580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635587">break</span>&nbsp;<span class="ident" id="3635593"><a href="/gostd/regexp/syntax/parse.go.html#3634905">Loop</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635608"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span>&nbsp;<span class="op" id="3635614">=</span>&nbsp;<span class="op" id="3635616">^</span><span class="ident" id="3635617"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635631">if</span>&nbsp;<span class="ident" id="3635634"><a href="/gostd/regexp/syntax/parse.go.html#3634828">c</a></span>&nbsp;<span class="op" id="3635636">==</span>&nbsp;<span class="string" id="3635639">&#39;:&#39;</span>&nbsp;<span class="op" id="3635643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3635649">//&nbsp;Open&nbsp;new&nbsp;group</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635671"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3635672">.</span><span class="ident" id="3635673"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3635675">(</span><span class="ident" id="3635676"><a href="/gostd/regexp/syntax/parse.go.html#3612169">opLeftParen</a></span><span class="op" id="3635687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635692">}</span><br>
<span class="lineno">1030</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3635697"><a href="/gostd/regexp/syntax/parse.go.html#3633321">p</a></span><span class="op" id="3635698">.</span><span class="ident" id="3635699"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span>&nbsp;<span class="op" id="3635705">=</span>&nbsp;<span class="ident" id="3635707"><a href="/gostd/regexp/syntax/parse.go.html#3634858">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635716">return</span>&nbsp;<span class="ident" id="3635723"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3635724">,</span>&nbsp;<span class="builtintype" id="3635726">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3635735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3635739">return</span>&nbsp;<span class="string" id="3635746">&#34;&#34;</span><span class="op" id="3635748">,</span>&nbsp;<span class="op" id="3635750">&amp;</span><span class="ident" id="3635751"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3635756">{</span><span class="ident" id="3635757"><a href="/gostd/regexp/syntax/parse.go.html#3610401">ErrInvalidPerlOp</a></span><span class="op" id="3635773">,</span>&nbsp;<span class="ident" id="3635775"><a href="/gostd/regexp/syntax/parse.go.html#3633347">s</a></span><span class="op" id="3635776">[</span><span class="op" id="3635777">:</span><span class="builtinfunc" id="3635778">len</span><span class="op" id="3635781">(</span><span class="ident" id="3635782"><a href="/gostd/regexp/syntax/parse.go.html#3633347">s</a></span><span class="op" id="3635783">)</span><span class="op" id="3635784">-</span><span class="builtinfunc" id="3635785">len</span><span class="op" id="3635788">(</span><span class="ident" id="3635789"><a href="/gostd/regexp/syntax/parse.go.html#3633385">t</a></span><span class="op" id="3635790">)</span><span class="op" id="3635791">]</span><span class="op" id="3635792">}</span><br>
<span class="lineno"></span><span class="op" id="3635794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3635797">//&nbsp;isValidCaptureName&nbsp;reports&nbsp;whether&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3635840">//&nbsp;is&nbsp;a&nbsp;valid&nbsp;capture&nbsp;name:&nbsp;[A-Za-z0-9_]+.</span><br>
<span class="lineno">1040</span><span class="comment" id="3635883">//&nbsp;PCRE&nbsp;limits&nbsp;names&nbsp;to&nbsp;32&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="3635917">//&nbsp;Python&nbsp;rejects&nbsp;names&nbsp;starting&nbsp;with&nbsp;digits.</span><br>
<span class="lineno"></span><span class="comment" id="3635963">//&nbsp;We&nbsp;don&#39;t&nbsp;enforce&nbsp;either&nbsp;of&nbsp;those.</span><br>
<span class="lineno"></span><span class="keyword" id="3636000">func</span>&nbsp;<span class="ident" id="3636005">isValidCaptureName</span><span class="op" id="3636023">(</span><span class="ident" id="3636024">name</span>&nbsp;<span class="builtintype" id="3636029">string</span><span class="op" id="3636035">)</span>&nbsp;<span class="builtintype" id="3636037">bool</span>&nbsp;<span class="op" id="3636042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636045">if</span>&nbsp;<span class="ident" id="3636048"><a href="/gostd/regexp/syntax/parse.go.html#3636024">name</a></span>&nbsp;<span class="op" id="3636053">==</span>&nbsp;<span class="string" id="3636056">&#34;&#34;</span>&nbsp;<span class="op" id="3636059">{</span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636063">return</span>&nbsp;<span class="builtintype" id="3636070">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636080">for</span>&nbsp;<span class="ident" id="3636084">_</span><span class="op" id="3636085">,</span>&nbsp;<span class="ident" id="3636087">c</span>&nbsp;<span class="op" id="3636089">:=</span>&nbsp;<span class="keyword" id="3636092">range</span>&nbsp;<span class="ident" id="3636098"><a href="/gostd/regexp/syntax/parse.go.html#3636024">name</a></span>&nbsp;<span class="op" id="3636103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636107">if</span>&nbsp;<span class="ident" id="3636110"><a href="/gostd/regexp/syntax/parse.go.html#3636087">c</a></span>&nbsp;<span class="op" id="3636112">!=</span>&nbsp;<span class="string" id="3636115">&#39;_&#39;</span>&nbsp;<span class="op" id="3636119">&amp;&amp;</span>&nbsp;<span class="op" id="3636122">!</span><span class="ident" id="3636123"><a href="/gostd/regexp/syntax/parse.go.html#3655955">isalnum</a></span><span class="op" id="3636130">(</span><span class="ident" id="3636131"><a href="/gostd/regexp/syntax/parse.go.html#3636087">c</a></span><span class="op" id="3636132">)</span>&nbsp;<span class="op" id="3636134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636139">return</span>&nbsp;<span class="builtintype" id="3636146">false</span><br>
<span class="lineno">1050</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636160">return</span>&nbsp;<span class="builtintype" id="3636167">true</span><br>
<span class="lineno"></span><span class="op" id="3636172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1055</span><span class="comment" id="3636175">//&nbsp;parseInt&nbsp;parses&nbsp;a&nbsp;decimal&nbsp;integer.</span><br>
<span class="lineno"></span><span class="keyword" id="3636213">func</span>&nbsp;<span class="op" id="3636218">(</span><span class="ident" id="3636219">p</span>&nbsp;<span class="op" id="3636221">*</span><span class="ident" id="3636222"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3636228">)</span>&nbsp;<span class="ident" id="3636230">parseInt</span><span class="op" id="3636238">(</span><span class="ident" id="3636239">s</span>&nbsp;<span class="builtintype" id="3636241">string</span><span class="op" id="3636247">)</span>&nbsp;<span class="op" id="3636249">(</span><span class="ident" id="3636250">n</span>&nbsp;<span class="builtintype" id="3636252">int</span><span class="op" id="3636255">,</span>&nbsp;<span class="ident" id="3636257">rest</span>&nbsp;<span class="builtintype" id="3636262">string</span><span class="op" id="3636268">,</span>&nbsp;<span class="ident" id="3636270">ok</span>&nbsp;<span class="builtintype" id="3636273">bool</span><span class="op" id="3636277">)</span>&nbsp;<span class="op" id="3636279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636282">if</span>&nbsp;<span class="ident" id="3636285"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span>&nbsp;<span class="op" id="3636287">==</span>&nbsp;<span class="string" id="3636290">&#34;&#34;</span>&nbsp;<span class="op" id="3636293">||</span>&nbsp;<span class="ident" id="3636296"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636297">[</span><span class="num" id="3636298">0</span><span class="op" id="3636299">]</span>&nbsp;<span class="op" id="3636301">&lt;</span>&nbsp;<span class="string" id="3636303">&#39;0&#39;</span>&nbsp;<span class="op" id="3636307">||</span>&nbsp;<span class="string" id="3636310">&#39;9&#39;</span>&nbsp;<span class="op" id="3636314">&lt;</span>&nbsp;<span class="ident" id="3636316"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636317">[</span><span class="num" id="3636318">0</span><span class="op" id="3636319">]</span>&nbsp;<span class="op" id="3636321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636325">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636333">}</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3636336">//&nbsp;Disallow&nbsp;leading&nbsp;zeros.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636364">if</span>&nbsp;<span class="builtinfunc" id="3636367">len</span><span class="op" id="3636370">(</span><span class="ident" id="3636371"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636372">)</span>&nbsp;<span class="op" id="3636374">&gt;=</span>&nbsp;<span class="num" id="3636377">2</span>&nbsp;<span class="op" id="3636379">&amp;&amp;</span>&nbsp;<span class="ident" id="3636382"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636383">[</span><span class="num" id="3636384">0</span><span class="op" id="3636385">]</span>&nbsp;<span class="op" id="3636387">==</span>&nbsp;<span class="string" id="3636390">&#39;0&#39;</span>&nbsp;<span class="op" id="3636394">&amp;&amp;</span>&nbsp;<span class="string" id="3636397">&#39;0&#39;</span>&nbsp;<span class="op" id="3636401">&lt;=</span>&nbsp;<span class="ident" id="3636404"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636405">[</span><span class="num" id="3636406">1</span><span class="op" id="3636407">]</span>&nbsp;<span class="op" id="3636409">&amp;&amp;</span>&nbsp;<span class="ident" id="3636412"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636413">[</span><span class="num" id="3636414">1</span><span class="op" id="3636415">]</span>&nbsp;<span class="op" id="3636417">&lt;=</span>&nbsp;<span class="string" id="3636420">&#39;9&#39;</span>&nbsp;<span class="op" id="3636424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636428">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636439">t</span>&nbsp;<span class="op" id="3636441">:=</span>&nbsp;<span class="ident" id="3636444"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636447">for</span>&nbsp;<span class="ident" id="3636451"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span>&nbsp;<span class="op" id="3636453">!=</span>&nbsp;<span class="string" id="3636456">&#34;&#34;</span>&nbsp;<span class="op" id="3636459">&amp;&amp;</span>&nbsp;<span class="string" id="3636462">&#39;0&#39;</span>&nbsp;<span class="op" id="3636466">&lt;=</span>&nbsp;<span class="ident" id="3636469"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636470">[</span><span class="num" id="3636471">0</span><span class="op" id="3636472">]</span>&nbsp;<span class="op" id="3636474">&amp;&amp;</span>&nbsp;<span class="ident" id="3636477"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636478">[</span><span class="num" id="3636479">0</span><span class="op" id="3636480">]</span>&nbsp;<span class="op" id="3636482">&lt;=</span>&nbsp;<span class="string" id="3636485">&#39;9&#39;</span>&nbsp;<span class="op" id="3636489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636493"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span>&nbsp;<span class="op" id="3636495">=</span>&nbsp;<span class="ident" id="3636497"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636498">[</span><span class="num" id="3636499">1</span><span class="op" id="3636500">:</span><span class="op" id="3636501">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636507"><a href="/gostd/regexp/syntax/parse.go.html#3636257">rest</a></span>&nbsp;<span class="op" id="3636512">=</span>&nbsp;<span class="ident" id="3636514"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636517"><a href="/gostd/regexp/syntax/parse.go.html#3636270">ok</a></span>&nbsp;<span class="op" id="3636520">=</span>&nbsp;<span class="builtintype" id="3636522">true</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3636528">//&nbsp;Have&nbsp;digits,&nbsp;compute&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636560"><a href="/gostd/regexp/syntax/parse.go.html#3636439">t</a></span>&nbsp;<span class="op" id="3636562">=</span>&nbsp;<span class="ident" id="3636564"><a href="/gostd/regexp/syntax/parse.go.html#3636439">t</a></span><span class="op" id="3636565">[</span><span class="op" id="3636566">:</span><span class="builtinfunc" id="3636567">len</span><span class="op" id="3636570">(</span><span class="ident" id="3636571"><a href="/gostd/regexp/syntax/parse.go.html#3636439">t</a></span><span class="op" id="3636572">)</span><span class="op" id="3636573">-</span><span class="builtinfunc" id="3636574">len</span><span class="op" id="3636577">(</span><span class="ident" id="3636578"><a href="/gostd/regexp/syntax/parse.go.html#3636239">s</a></span><span class="op" id="3636579">)</span><span class="op" id="3636580">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636583">for</span>&nbsp;<span class="ident" id="3636587">i</span>&nbsp;<span class="op" id="3636589">:=</span>&nbsp;<span class="num" id="3636592">0</span><span class="op" id="3636593">;</span>&nbsp;<span class="ident" id="3636595"><a href="/gostd/regexp/syntax/parse.go.html#3636587">i</a></span>&nbsp;<span class="op" id="3636597">&lt;</span>&nbsp;<span class="builtinfunc" id="3636599">len</span><span class="op" id="3636602">(</span><span class="ident" id="3636603"><a href="/gostd/regexp/syntax/parse.go.html#3636439">t</a></span><span class="op" id="3636604">)</span><span class="op" id="3636605">;</span>&nbsp;<span class="ident" id="3636607"><a href="/gostd/regexp/syntax/parse.go.html#3636587">i</a></span><span class="op" id="3636608">++</span>&nbsp;<span class="op" id="3636611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3636615">//&nbsp;Avoid&nbsp;overflow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636636">if</span>&nbsp;<span class="ident" id="3636639"><a href="/gostd/regexp/syntax/parse.go.html#3636250">n</a></span>&nbsp;<span class="op" id="3636641">&gt;=</span>&nbsp;<span class="num" id="3636644">1e8</span>&nbsp;<span class="op" id="3636648">{</span><br>
<span class="lineno">1075</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636653"><a href="/gostd/regexp/syntax/parse.go.html#3636250">n</a></span>&nbsp;<span class="op" id="3636655">=</span>&nbsp;<span class="op" id="3636657">-</span><span class="num" id="3636658">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636663">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636675"><a href="/gostd/regexp/syntax/parse.go.html#3636250">n</a></span>&nbsp;<span class="op" id="3636677">=</span>&nbsp;<span class="ident" id="3636679"><a href="/gostd/regexp/syntax/parse.go.html#3636250">n</a></span><span class="op" id="3636680">*</span><span class="num" id="3636681">10</span>&nbsp;<span class="op" id="3636684">+</span>&nbsp;<span class="builtintype" id="3636686">int</span><span class="op" id="3636689">(</span><span class="ident" id="3636690"><a href="/gostd/regexp/syntax/parse.go.html#3636439">t</a></span><span class="op" id="3636691">[</span><span class="ident" id="3636692"><a href="/gostd/regexp/syntax/parse.go.html#3636587">i</a></span><span class="op" id="3636693">]</span><span class="op" id="3636694">)</span>&nbsp;<span class="op" id="3636696">-</span>&nbsp;<span class="string" id="3636698">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3636703">}</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636706">return</span><br>
<span class="lineno"></span><span class="op" id="3636713">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3636716">//&nbsp;can&nbsp;this&nbsp;be&nbsp;represented&nbsp;as&nbsp;a&nbsp;character&nbsp;class?</span><br>
<span class="lineno"></span><span class="comment" id="3636765">//&nbsp;single-rune&nbsp;literal&nbsp;string,&nbsp;char&nbsp;class,&nbsp;.,&nbsp;and&nbsp;.|\n.</span><br>
<span class="lineno">1085</span><span class="keyword" id="3636821">func</span>&nbsp;<span class="ident" id="3636826">isCharClass</span><span class="op" id="3636837">(</span><span class="ident" id="3636838">re</span>&nbsp;<span class="op" id="3636841">*</span><span class="ident" id="3636842"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3636848">)</span>&nbsp;<span class="builtintype" id="3636850">bool</span>&nbsp;<span class="op" id="3636855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3636858">return</span>&nbsp;<span class="ident" id="3636865"><a href="/gostd/regexp/syntax/parse.go.html#3636838">re</a></span><span class="op" id="3636867">.</span><span class="ident" id="3636868"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3636871">==</span>&nbsp;<span class="ident" id="3636874"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3636884">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3636887">len</span><span class="op" id="3636890">(</span><span class="ident" id="3636891"><a href="/gostd/regexp/syntax/parse.go.html#3636838">re</a></span><span class="op" id="3636893">.</span><span class="ident" id="3636894"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3636898">)</span>&nbsp;<span class="op" id="3636900">==</span>&nbsp;<span class="num" id="3636903">1</span>&nbsp;<span class="op" id="3636905">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636910"><a href="/gostd/regexp/syntax/parse.go.html#3636838">re</a></span><span class="op" id="3636912">.</span><span class="ident" id="3636913"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3636916">==</span>&nbsp;<span class="ident" id="3636919"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span>&nbsp;<span class="op" id="3636931">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636936"><a href="/gostd/regexp/syntax/parse.go.html#3636838">re</a></span><span class="op" id="3636938">.</span><span class="ident" id="3636939"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3636942">==</span>&nbsp;<span class="ident" id="3636945"><a href="/gostd/regexp/syntax/regexp.go.html#3667810">OpAnyCharNotNL</a></span>&nbsp;<span class="op" id="3636960">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3636965"><a href="/gostd/regexp/syntax/parse.go.html#3636838">re</a></span><span class="op" id="3636967">.</span><span class="ident" id="3636968"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3636971">==</span>&nbsp;<span class="ident" id="3636974"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><br>
<span class="lineno">1090</span><span class="op" id="3636984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3636987">//&nbsp;does&nbsp;re&nbsp;match&nbsp;r?</span><br>
<span class="lineno"></span><span class="keyword" id="3637007">func</span>&nbsp;<span class="ident" id="3637012">matchRune</span><span class="op" id="3637021">(</span><span class="ident" id="3637022">re</span>&nbsp;<span class="op" id="3637025">*</span><span class="ident" id="3637026"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3637032">,</span>&nbsp;<span class="ident" id="3637034">r</span>&nbsp;<span class="builtintype" id="3637036">rune</span><span class="op" id="3637040">)</span>&nbsp;<span class="builtintype" id="3637042">bool</span>&nbsp;<span class="op" id="3637047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637050">switch</span>&nbsp;<span class="ident" id="3637057"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637059">.</span><span class="ident" id="3637060"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3637063">{</span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637066">case</span>&nbsp;<span class="ident" id="3637071"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><span class="op" id="3637080">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637084">return</span>&nbsp;<span class="builtinfunc" id="3637091">len</span><span class="op" id="3637094">(</span><span class="ident" id="3637095"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637097">.</span><span class="ident" id="3637098"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3637102">)</span>&nbsp;<span class="op" id="3637104">==</span>&nbsp;<span class="num" id="3637107">1</span>&nbsp;<span class="op" id="3637109">&amp;&amp;</span>&nbsp;<span class="ident" id="3637112"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637114">.</span><span class="ident" id="3637115"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3637119">[</span><span class="num" id="3637120">0</span><span class="op" id="3637121">]</span>&nbsp;<span class="op" id="3637123">==</span>&nbsp;<span class="ident" id="3637126"><a href="/gostd/regexp/syntax/parse.go.html#3637034">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637129">case</span>&nbsp;<span class="ident" id="3637134"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><span class="op" id="3637145">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637149">for</span>&nbsp;<span class="ident" id="3637153">i</span>&nbsp;<span class="op" id="3637155">:=</span>&nbsp;<span class="num" id="3637158">0</span><span class="op" id="3637159">;</span>&nbsp;<span class="ident" id="3637161"><a href="/gostd/regexp/syntax/parse.go.html#3637153">i</a></span>&nbsp;<span class="op" id="3637163">&lt;</span>&nbsp;<span class="builtinfunc" id="3637165">len</span><span class="op" id="3637168">(</span><span class="ident" id="3637169"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637171">.</span><span class="ident" id="3637172"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3637176">)</span><span class="op" id="3637177">;</span>&nbsp;<span class="ident" id="3637179"><a href="/gostd/regexp/syntax/parse.go.html#3637153">i</a></span>&nbsp;<span class="op" id="3637181">+=</span>&nbsp;<span class="num" id="3637184">2</span>&nbsp;<span class="op" id="3637186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637191">if</span>&nbsp;<span class="ident" id="3637194"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637196">.</span><span class="ident" id="3637197"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3637201">[</span><span class="ident" id="3637202"><a href="/gostd/regexp/syntax/parse.go.html#3637153">i</a></span><span class="op" id="3637203">]</span>&nbsp;<span class="op" id="3637205">&lt;=</span>&nbsp;<span class="ident" id="3637208"><a href="/gostd/regexp/syntax/parse.go.html#3637034">r</a></span>&nbsp;<span class="op" id="3637210">&amp;&amp;</span>&nbsp;<span class="ident" id="3637213"><a href="/gostd/regexp/syntax/parse.go.html#3637034">r</a></span>&nbsp;<span class="op" id="3637215">&lt;=</span>&nbsp;<span class="ident" id="3637218"><a href="/gostd/regexp/syntax/parse.go.html#3637022">re</a></span><span class="op" id="3637220">.</span><span class="ident" id="3637221"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3637225">[</span><span class="ident" id="3637226"><a href="/gostd/regexp/syntax/parse.go.html#3637153">i</a></span><span class="op" id="3637227">+</span><span class="num" id="3637228">1</span><span class="op" id="3637229">]</span>&nbsp;<span class="op" id="3637231">{</span><br>
<span class="lineno">1100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637237">return</span>&nbsp;<span class="builtintype" id="3637244">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3637252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3637256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637260">return</span>&nbsp;<span class="builtintype" id="3637267">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637274">case</span>&nbsp;<span class="ident" id="3637279"><a href="/gostd/regexp/syntax/regexp.go.html#3667810">OpAnyCharNotNL</a></span><span class="op" id="3637293">:</span><br>
<span class="lineno">1105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637297">return</span>&nbsp;<span class="ident" id="3637304"><a href="/gostd/regexp/syntax/parse.go.html#3637034">r</a></span>&nbsp;<span class="op" id="3637306">!=</span>&nbsp;<span class="string" id="3637309">&#39;\n&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637315">case</span>&nbsp;<span class="ident" id="3637320"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><span class="op" id="3637329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637333">return</span>&nbsp;<span class="builtintype" id="3637340">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3637346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637349">return</span>&nbsp;<span class="builtintype" id="3637356">false</span><br>
<span class="lineno">1110</span><span class="op" id="3637362">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3637365">//&nbsp;parseVerticalBar&nbsp;handles&nbsp;a&nbsp;|&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="3637411">func</span>&nbsp;<span class="op" id="3637416">(</span><span class="ident" id="3637417">p</span>&nbsp;<span class="op" id="3637419">*</span><span class="ident" id="3637420"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3637426">)</span>&nbsp;<span class="ident" id="3637428">parseVerticalBar</span><span class="op" id="3637444">(</span><span class="op" id="3637445">)</span>&nbsp;<span class="builtintype" id="3637447">error</span>&nbsp;<span class="op" id="3637453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3637456"><a href="/gostd/regexp/syntax/parse.go.html#3637417">p</a></span><span class="op" id="3637457">.</span><span class="ident" id="3637458"><a href="/gostd/regexp/syntax/parse.go.html#3618127">concat</a></span><span class="op" id="3637464">(</span><span class="op" id="3637465">)</span><br>
<span class="lineno">1115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3637469">//&nbsp;The&nbsp;concatenation&nbsp;we&nbsp;just&nbsp;parsed&nbsp;is&nbsp;on&nbsp;top&nbsp;of&nbsp;the&nbsp;stack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3637530">//&nbsp;If&nbsp;it&nbsp;sits&nbsp;above&nbsp;an&nbsp;opVerticalBar,&nbsp;swap&nbsp;it&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3637583">//&nbsp;(things&nbsp;below&nbsp;an&nbsp;opVerticalBar&nbsp;become&nbsp;an&nbsp;alternation).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3637642">//&nbsp;Otherwise,&nbsp;push&nbsp;a&nbsp;new&nbsp;vertical&nbsp;bar.</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637682">if</span>&nbsp;<span class="op" id="3637685">!</span><span class="ident" id="3637686"><a href="/gostd/regexp/syntax/parse.go.html#3637417">p</a></span><span class="op" id="3637687">.</span><span class="ident" id="3637688"><a href="/gostd/regexp/syntax/parse.go.html#3638730">swapVerticalBar</a></span><span class="op" id="3637703">(</span><span class="op" id="3637704">)</span>&nbsp;<span class="op" id="3637706">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3637710"><a href="/gostd/regexp/syntax/parse.go.html#3637417">p</a></span><span class="op" id="3637711">.</span><span class="ident" id="3637712"><a href="/gostd/regexp/syntax/parse.go.html#3615694">op</a></span><span class="op" id="3637714">(</span><span class="ident" id="3637715"><a href="/gostd/regexp/syntax/parse.go.html#3612200">opVerticalBar</a></span><span class="op" id="3637728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3637731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637735">return</span>&nbsp;<span class="builtintype" id="3637742">nil</span><br>
<span class="lineno">1125</span><span class="op" id="3637746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3637749">//&nbsp;mergeCharClass&nbsp;makes&nbsp;dst&nbsp;=&nbsp;dst|src.</span><br>
<span class="lineno"></span><span class="comment" id="3637788">//&nbsp;The&nbsp;caller&nbsp;must&nbsp;ensure&nbsp;that&nbsp;dst.Op&nbsp;&gt;=&nbsp;src.Op,</span><br>
<span class="lineno"></span><span class="comment" id="3637837">//&nbsp;to&nbsp;reduce&nbsp;the&nbsp;amount&nbsp;of&nbsp;copying.</span><br>
<span class="lineno">1130</span><span class="keyword" id="3637873">func</span>&nbsp;<span class="ident" id="3637878">mergeCharClass</span><span class="op" id="3637892">(</span><span class="ident" id="3637893">dst</span><span class="op" id="3637896">,</span>&nbsp;<span class="ident" id="3637898">src</span>&nbsp;<span class="op" id="3637902">*</span><span class="ident" id="3637903"><a href="/gostd/regexp/syntax/regexp.go.html#3666871">Regexp</a></span><span class="op" id="3637909">)</span>&nbsp;<span class="op" id="3637911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637914">switch</span>&nbsp;<span class="ident" id="3637921"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3637924">.</span><span class="ident" id="3637925"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3637928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637931">case</span>&nbsp;<span class="ident" id="3637936"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><span class="op" id="3637945">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3637949">//&nbsp;src&nbsp;doesn&#39;t&nbsp;add&nbsp;anything.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3637979">case</span>&nbsp;<span class="ident" id="3637984"><a href="/gostd/regexp/syntax/regexp.go.html#3667810">OpAnyCharNotNL</a></span><span class="op" id="3637998">:</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3638002">//&nbsp;src&nbsp;might&nbsp;add&nbsp;\n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638024">if</span>&nbsp;<span class="ident" id="3638027"><a href="/gostd/regexp/syntax/parse.go.html#3637012">matchRune</a></span><span class="op" id="3638036">(</span><span class="ident" id="3638037"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638040">,</span>&nbsp;<span class="string" id="3638042">&#39;\n&#39;</span><span class="op" id="3638046">)</span>&nbsp;<span class="op" id="3638048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638053"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638056">.</span><span class="ident" id="3638057"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3638060">=</span>&nbsp;<span class="ident" id="3638062"><a href="/gostd/regexp/syntax/regexp.go.html#3667882">OpAnyChar</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3638074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638077">case</span>&nbsp;<span class="ident" id="3638082"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><span class="op" id="3638093">:</span><br>
<span class="lineno">1140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3638097">//&nbsp;src&nbsp;is&nbsp;simpler,&nbsp;so&nbsp;either&nbsp;literal&nbsp;or&nbsp;char&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638150">if</span>&nbsp;<span class="ident" id="3638153"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638156">.</span><span class="ident" id="3638157"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3638160">==</span>&nbsp;<span class="ident" id="3638163"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span>&nbsp;<span class="op" id="3638173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638178"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638181">.</span><span class="ident" id="3638182"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3638187">=</span>&nbsp;<span class="ident" id="3638189"><a href="/gostd/regexp/syntax/parse.go.html#3650147">appendLiteral</a></span><span class="op" id="3638202">(</span><span class="ident" id="3638203"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638206">.</span><span class="ident" id="3638207"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638211">,</span>&nbsp;<span class="ident" id="3638213"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638216">.</span><span class="ident" id="3638217"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638221">[</span><span class="num" id="3638222">0</span><span class="op" id="3638223">]</span><span class="op" id="3638224">,</span>&nbsp;<span class="ident" id="3638226"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638229">.</span><span class="ident" id="3638230"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3638235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3638239">}</span>&nbsp;<span class="keyword" id="3638241">else</span>&nbsp;<span class="op" id="3638246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638251"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638254">.</span><span class="ident" id="3638255"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3638260">=</span>&nbsp;<span class="ident" id="3638262"><a href="/gostd/regexp/syntax/parse.go.html#3652060">appendClass</a></span><span class="op" id="3638273">(</span><span class="ident" id="3638274"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638277">.</span><span class="ident" id="3638278"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638282">,</span>&nbsp;<span class="ident" id="3638284"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638287">.</span><span class="ident" id="3638288"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638292">)</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3638296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638299">case</span>&nbsp;<span class="ident" id="3638304"><a href="/gostd/regexp/syntax/regexp.go.html#3667672">OpLiteral</a></span><span class="op" id="3638313">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3638317">//&nbsp;both&nbsp;literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638335">if</span>&nbsp;<span class="ident" id="3638338"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638341">.</span><span class="ident" id="3638342"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638346">[</span><span class="num" id="3638347">0</span><span class="op" id="3638348">]</span>&nbsp;<span class="op" id="3638350">==</span>&nbsp;<span class="ident" id="3638353"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638356">.</span><span class="ident" id="3638357"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638361">[</span><span class="num" id="3638362">0</span><span class="op" id="3638363">]</span>&nbsp;<span class="op" id="3638365">&amp;&amp;</span>&nbsp;<span class="ident" id="3638368"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638371">.</span><span class="ident" id="3638372"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3638378">==</span>&nbsp;<span class="ident" id="3638381"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638384">.</span><span class="ident" id="3638385"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3638391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638396">break</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3638404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638408"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638411">.</span><span class="ident" id="3638412"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3638415">=</span>&nbsp;<span class="ident" id="3638417"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638431"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638434">.</span><span class="ident" id="3638435"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3638440">=</span>&nbsp;<span class="ident" id="3638442"><a href="/gostd/regexp/syntax/parse.go.html#3650147">appendLiteral</a></span><span class="op" id="3638455">(</span><span class="ident" id="3638456"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638459">.</span><span class="ident" id="3638460"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638464">[</span><span class="op" id="3638465">:</span><span class="num" id="3638466">0</span><span class="op" id="3638467">]</span><span class="op" id="3638468">,</span>&nbsp;<span class="ident" id="3638470"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638473">.</span><span class="ident" id="3638474"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638478">[</span><span class="num" id="3638479">0</span><span class="op" id="3638480">]</span><span class="op" id="3638481">,</span>&nbsp;<span class="ident" id="3638483"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638486">.</span><span class="ident" id="3638487"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3638492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638496"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638499">.</span><span class="ident" id="3638500"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3638505">=</span>&nbsp;<span class="ident" id="3638507"><a href="/gostd/regexp/syntax/parse.go.html#3650147">appendLiteral</a></span><span class="op" id="3638520">(</span><span class="ident" id="3638521"><a href="/gostd/regexp/syntax/parse.go.html#3637893">dst</a></span><span class="op" id="3638524">.</span><span class="ident" id="3638525"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638529">,</span>&nbsp;<span class="ident" id="3638531"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638534">.</span><span class="ident" id="3638535"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3638539">[</span><span class="num" id="3638540">0</span><span class="op" id="3638541">]</span><span class="op" id="3638542">,</span>&nbsp;<span class="ident" id="3638544"><a href="/gostd/regexp/syntax/parse.go.html#3637898">src</a></span><span class="op" id="3638547">.</span><span class="ident" id="3638548"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><span class="op" id="3638553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3638556">}</span><br>
<span class="lineno">1155</span><span class="op" id="3638558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3638561">//&nbsp;If&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;stack&nbsp;is&nbsp;an&nbsp;element&nbsp;followed&nbsp;by&nbsp;an&nbsp;opVerticalBar</span><br>
<span class="lineno"></span><span class="comment" id="3638631">//&nbsp;swapVerticalBar&nbsp;swaps&nbsp;the&nbsp;two&nbsp;and&nbsp;returns&nbsp;true.</span><br>
<span class="lineno"></span><span class="comment" id="3638682">//&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;false.</span><br>
<span class="lineno">1160</span><span class="keyword" id="3638713">func</span>&nbsp;<span class="op" id="3638718">(</span><span class="ident" id="3638719">p</span>&nbsp;<span class="op" id="3638721">*</span><span class="ident" id="3638722"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3638728">)</span>&nbsp;<span class="ident" id="3638730">swapVerticalBar</span><span class="op" id="3638745">(</span><span class="op" id="3638746">)</span>&nbsp;<span class="builtintype" id="3638748">bool</span>&nbsp;<span class="op" id="3638753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3638756">//&nbsp;If&nbsp;above&nbsp;and&nbsp;below&nbsp;vertical&nbsp;bar&nbsp;are&nbsp;literal&nbsp;or&nbsp;char&nbsp;class,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3638819">//&nbsp;can&nbsp;merge&nbsp;into&nbsp;a&nbsp;single&nbsp;char&nbsp;class.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638859">n</span>&nbsp;<span class="op" id="3638861">:=</span>&nbsp;<span class="builtinfunc" id="3638864">len</span><span class="op" id="3638867">(</span><span class="ident" id="3638868"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3638869">.</span><span class="ident" id="3638870"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3638875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3638878">if</span>&nbsp;<span class="ident" id="3638881"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span>&nbsp;<span class="op" id="3638883">&gt;=</span>&nbsp;<span class="num" id="3638886">3</span>&nbsp;<span class="op" id="3638888">&amp;&amp;</span>&nbsp;<span class="ident" id="3638891"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3638892">.</span><span class="ident" id="3638893"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3638898">[</span><span class="ident" id="3638899"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3638900">-</span><span class="num" id="3638901">2</span><span class="op" id="3638902">]</span><span class="op" id="3638903">.</span><span class="ident" id="3638904"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3638907">==</span>&nbsp;<span class="ident" id="3638910"><a href="/gostd/regexp/syntax/parse.go.html#3612200">opVerticalBar</a></span>&nbsp;<span class="op" id="3638924">&amp;&amp;</span>&nbsp;<span class="ident" id="3638927"><a href="/gostd/regexp/syntax/parse.go.html#3636826">isCharClass</a></span><span class="op" id="3638938">(</span><span class="ident" id="3638939"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3638940">.</span><span class="ident" id="3638941"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3638946">[</span><span class="ident" id="3638947"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3638948">-</span><span class="num" id="3638949">1</span><span class="op" id="3638950">]</span><span class="op" id="3638951">)</span>&nbsp;<span class="op" id="3638953">&amp;&amp;</span>&nbsp;<span class="ident" id="3638956"><a href="/gostd/regexp/syntax/parse.go.html#3636826">isCharClass</a></span><span class="op" id="3638967">(</span><span class="ident" id="3638968"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3638969">.</span><span class="ident" id="3638970"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3638975">[</span><span class="ident" id="3638976"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3638977">-</span><span class="num" id="3638978">3</span><span class="op" id="3638979">]</span><span class="op" id="3638980">)</span>&nbsp;<span class="op" id="3638982">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3638986">re1</span>&nbsp;<span class="op" id="3638990">:=</span>&nbsp;<span class="ident" id="3638993"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3638994">.</span><span class="ident" id="3638995"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639000">[</span><span class="ident" id="3639001"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639002">-</span><span class="num" id="3639003">1</span><span class="op" id="3639004">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639008">re3</span>&nbsp;<span class="op" id="3639012">:=</span>&nbsp;<span class="ident" id="3639015"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639016">.</span><span class="ident" id="3639017"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639022">[</span><span class="ident" id="3639023"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639024">-</span><span class="num" id="3639025">3</span><span class="op" id="3639026">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3639030">//&nbsp;Make&nbsp;re3&nbsp;the&nbsp;more&nbsp;complex&nbsp;of&nbsp;the&nbsp;two.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639073">if</span>&nbsp;<span class="ident" id="3639076"><a href="/gostd/regexp/syntax/parse.go.html#3638986">re1</a></span><span class="op" id="3639079">.</span><span class="ident" id="3639080"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3639083">&gt;</span>&nbsp;<span class="ident" id="3639085"><a href="/gostd/regexp/syntax/parse.go.html#3639008">re3</a></span><span class="op" id="3639088">.</span><span class="ident" id="3639089"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3639092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639097"><a href="/gostd/regexp/syntax/parse.go.html#3638986">re1</a></span><span class="op" id="3639100">,</span>&nbsp;<span class="ident" id="3639102"><a href="/gostd/regexp/syntax/parse.go.html#3639008">re3</a></span>&nbsp;<span class="op" id="3639106">=</span>&nbsp;<span class="ident" id="3639108"><a href="/gostd/regexp/syntax/parse.go.html#3639008">re3</a></span><span class="op" id="3639111">,</span>&nbsp;<span class="ident" id="3639113"><a href="/gostd/regexp/syntax/parse.go.html#3638986">re1</a></span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639120"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639121">.</span><span class="ident" id="3639122"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639127">[</span><span class="ident" id="3639128"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639129">-</span><span class="num" id="3639130">3</span><span class="op" id="3639131">]</span>&nbsp;<span class="op" id="3639133">=</span>&nbsp;<span class="ident" id="3639135"><a href="/gostd/regexp/syntax/parse.go.html#3639008">re3</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639141">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639145"><a href="/gostd/regexp/syntax/parse.go.html#3637878">mergeCharClass</a></span><span class="op" id="3639159">(</span><span class="ident" id="3639160"><a href="/gostd/regexp/syntax/parse.go.html#3639008">re3</a></span><span class="op" id="3639163">,</span>&nbsp;<span class="ident" id="3639165"><a href="/gostd/regexp/syntax/parse.go.html#3638986">re1</a></span><span class="op" id="3639168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639172"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639173">.</span><span class="ident" id="3639174"><a href="/gostd/regexp/syntax/parse.go.html#3612674">reuse</a></span><span class="op" id="3639179">(</span><span class="ident" id="3639180"><a href="/gostd/regexp/syntax/parse.go.html#3638986">re1</a></span><span class="op" id="3639183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639187"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639188">.</span><span class="ident" id="3639189"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3639195">=</span>&nbsp;<span class="ident" id="3639197"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639198">.</span><span class="ident" id="3639199"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639204">[</span><span class="op" id="3639205">:</span><span class="ident" id="3639206"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639207">-</span><span class="num" id="3639208">1</span><span class="op" id="3639209">]</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639213">return</span>&nbsp;<span class="builtintype" id="3639220">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639230">if</span>&nbsp;<span class="ident" id="3639233"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span>&nbsp;<span class="op" id="3639235">&gt;=</span>&nbsp;<span class="num" id="3639238">2</span>&nbsp;<span class="op" id="3639240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639244">re1</span>&nbsp;<span class="op" id="3639248">:=</span>&nbsp;<span class="ident" id="3639251"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639252">.</span><span class="ident" id="3639253"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639258">[</span><span class="ident" id="3639259"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639260">-</span><span class="num" id="3639261">1</span><span class="op" id="3639262">]</span><br>
<span class="lineno">1180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639266">re2</span>&nbsp;<span class="op" id="3639270">:=</span>&nbsp;<span class="ident" id="3639273"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639274">.</span><span class="ident" id="3639275"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639280">[</span><span class="ident" id="3639281"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639282">-</span><span class="num" id="3639283">2</span><span class="op" id="3639284">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639288">if</span>&nbsp;<span class="ident" id="3639291"><a href="/gostd/regexp/syntax/parse.go.html#3639266">re2</a></span><span class="op" id="3639294">.</span><span class="ident" id="3639295"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3639298">==</span>&nbsp;<span class="ident" id="3639301"><a href="/gostd/regexp/syntax/parse.go.html#3612200">opVerticalBar</a></span>&nbsp;<span class="op" id="3639315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639320">if</span>&nbsp;<span class="ident" id="3639323"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span>&nbsp;<span class="op" id="3639325">&gt;=</span>&nbsp;<span class="num" id="3639328">3</span>&nbsp;<span class="op" id="3639330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3639336">//&nbsp;Now&nbsp;out&nbsp;of&nbsp;reach.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3639361">//&nbsp;Clean&nbsp;opportunistically.</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639393"><a href="/gostd/regexp/syntax/parse.go.html#3619203">cleanAlt</a></span><span class="op" id="3639401">(</span><span class="ident" id="3639402"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639403">.</span><span class="ident" id="3639404"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639409">[</span><span class="ident" id="3639410"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639411">-</span><span class="num" id="3639412">3</span><span class="op" id="3639413">]</span><span class="op" id="3639414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639424"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639425">.</span><span class="ident" id="3639426"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639431">[</span><span class="ident" id="3639432"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639433">-</span><span class="num" id="3639434">2</span><span class="op" id="3639435">]</span>&nbsp;<span class="op" id="3639437">=</span>&nbsp;<span class="ident" id="3639439"><a href="/gostd/regexp/syntax/parse.go.html#3639244">re1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639446"><a href="/gostd/regexp/syntax/parse.go.html#3638719">p</a></span><span class="op" id="3639447">.</span><span class="ident" id="3639448"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639453">[</span><span class="ident" id="3639454"><a href="/gostd/regexp/syntax/parse.go.html#3638859">n</a></span><span class="op" id="3639455">-</span><span class="num" id="3639456">1</span><span class="op" id="3639457">]</span>&nbsp;<span class="op" id="3639459">=</span>&nbsp;<span class="ident" id="3639461"><a href="/gostd/regexp/syntax/parse.go.html#3639266">re2</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639468">return</span>&nbsp;<span class="builtintype" id="3639475">true</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639488">return</span>&nbsp;<span class="builtintype" id="3639495">false</span><br>
<span class="lineno"></span><span class="op" id="3639501">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1195</span><span class="comment" id="3639504">//&nbsp;parseRightParen&nbsp;handles&nbsp;a&nbsp;)&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="3639549">func</span>&nbsp;<span class="op" id="3639554">(</span><span class="ident" id="3639555">p</span>&nbsp;<span class="op" id="3639557">*</span><span class="ident" id="3639558"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3639564">)</span>&nbsp;<span class="ident" id="3639566">parseRightParen</span><span class="op" id="3639581">(</span><span class="op" id="3639582">)</span>&nbsp;<span class="builtintype" id="3639584">error</span>&nbsp;<span class="op" id="3639590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639593"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639594">.</span><span class="ident" id="3639595"><a href="/gostd/regexp/syntax/parse.go.html#3618127">concat</a></span><span class="op" id="3639601">(</span><span class="op" id="3639602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639605">if</span>&nbsp;<span class="ident" id="3639608"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639609">.</span><span class="ident" id="3639610"><a href="/gostd/regexp/syntax/parse.go.html#3638730">swapVerticalBar</a></span><span class="op" id="3639625">(</span><span class="op" id="3639626">)</span>&nbsp;<span class="op" id="3639628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3639632">//&nbsp;pop&nbsp;vertical&nbsp;bar</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639654"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639655">.</span><span class="ident" id="3639656"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3639662">=</span>&nbsp;<span class="ident" id="3639664"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639665">.</span><span class="ident" id="3639666"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639671">[</span><span class="op" id="3639672">:</span><span class="builtinfunc" id="3639673">len</span><span class="op" id="3639676">(</span><span class="ident" id="3639677"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639678">.</span><span class="ident" id="3639679"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639684">)</span><span class="op" id="3639685">-</span><span class="num" id="3639686">1</span><span class="op" id="3639687">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639693"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639694">.</span><span class="ident" id="3639695"><a href="/gostd/regexp/syntax/parse.go.html#3618592">alternate</a></span><span class="op" id="3639704">(</span><span class="op" id="3639705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639709">n</span>&nbsp;<span class="op" id="3639711">:=</span>&nbsp;<span class="builtinfunc" id="3639714">len</span><span class="op" id="3639717">(</span><span class="ident" id="3639718"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639719">.</span><span class="ident" id="3639720"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639725">)</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639728">if</span>&nbsp;<span class="ident" id="3639731"><a href="/gostd/regexp/syntax/parse.go.html#3639709">n</a></span>&nbsp;<span class="op" id="3639733">&lt;</span>&nbsp;<span class="num" id="3639735">2</span>&nbsp;<span class="op" id="3639737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639741">return</span>&nbsp;<span class="op" id="3639748">&amp;</span><span class="ident" id="3639749"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3639754">{</span><span class="ident" id="3639755"><a href="/gostd/regexp/syntax/parse.go.html#3610942">ErrUnexpectedParen</a></span><span class="op" id="3639773">,</span>&nbsp;<span class="ident" id="3639775"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639776">.</span><span class="ident" id="3639777"><a href="/gostd/regexp/syntax/parse.go.html#3612409">wholeRegexp</a></span><span class="op" id="3639788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639794">re1</span>&nbsp;<span class="op" id="3639798">:=</span>&nbsp;<span class="ident" id="3639801"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639802">.</span><span class="ident" id="3639803"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639808">[</span><span class="ident" id="3639809"><a href="/gostd/regexp/syntax/parse.go.html#3639709">n</a></span><span class="op" id="3639810">-</span><span class="num" id="3639811">1</span><span class="op" id="3639812">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639815">re2</span>&nbsp;<span class="op" id="3639819">:=</span>&nbsp;<span class="ident" id="3639822"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639823">.</span><span class="ident" id="3639824"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639829">[</span><span class="ident" id="3639830"><a href="/gostd/regexp/syntax/parse.go.html#3639709">n</a></span><span class="op" id="3639831">-</span><span class="num" id="3639832">2</span><span class="op" id="3639833">]</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639836"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639837">.</span><span class="ident" id="3639838"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span>&nbsp;<span class="op" id="3639844">=</span>&nbsp;<span class="ident" id="3639846"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639847">.</span><span class="ident" id="3639848"><a href="/gostd/regexp/syntax/parse.go.html#3612282">stack</a></span><span class="op" id="3639853">[</span><span class="op" id="3639854">:</span><span class="ident" id="3639855"><a href="/gostd/regexp/syntax/parse.go.html#3639709">n</a></span><span class="op" id="3639856">-</span><span class="num" id="3639857">2</span><span class="op" id="3639858">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639861">if</span>&nbsp;<span class="ident" id="3639864"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3639867">.</span><span class="ident" id="3639868"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3639871">!=</span>&nbsp;<span class="ident" id="3639874"><a href="/gostd/regexp/syntax/parse.go.html#3612169">opLeftParen</a></span>&nbsp;<span class="op" id="3639886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3639890">return</span>&nbsp;<span class="op" id="3639897">&amp;</span><span class="ident" id="3639898"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3639903">{</span><span class="ident" id="3639904"><a href="/gostd/regexp/syntax/parse.go.html#3610942">ErrUnexpectedParen</a></span><span class="op" id="3639922">,</span>&nbsp;<span class="ident" id="3639924"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639925">.</span><span class="ident" id="3639926"><a href="/gostd/regexp/syntax/parse.go.html#3612409">wholeRegexp</a></span><span class="op" id="3639937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3639940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3639943">//&nbsp;Restore&nbsp;flags&nbsp;at&nbsp;time&nbsp;of&nbsp;paren.</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3639979"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3639980">.</span><span class="ident" id="3639981"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span>&nbsp;<span class="op" id="3639987">=</span>&nbsp;<span class="ident" id="3639989"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3639992">.</span><span class="ident" id="3639993"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640000">if</span>&nbsp;<span class="ident" id="3640003"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640006">.</span><span class="ident" id="3640007"><a href="/gostd/regexp/syntax/regexp.go.html#3667181">Cap</a></span>&nbsp;<span class="op" id="3640011">==</span>&nbsp;<span class="num" id="3640014">0</span>&nbsp;<span class="op" id="3640016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640020">//&nbsp;Just&nbsp;for&nbsp;grouping.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640044"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3640045">.</span><span class="ident" id="3640046"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3640050">(</span><span class="ident" id="3640051"><a href="/gostd/regexp/syntax/parse.go.html#3639794">re1</a></span><span class="op" id="3640054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640057">}</span>&nbsp;<span class="keyword" id="3640059">else</span>&nbsp;<span class="op" id="3640064">{</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640068"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640071">.</span><span class="ident" id="3640072"><a href="/gostd/regexp/syntax/regexp.go.html#3666888">Op</a></span>&nbsp;<span class="op" id="3640075">=</span>&nbsp;<span class="ident" id="3640077"><a href="/gostd/regexp/syntax/regexp.go.html#3668363">OpCapture</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640089"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640092">.</span><span class="ident" id="3640093"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span>&nbsp;<span class="op" id="3640097">=</span>&nbsp;<span class="ident" id="3640099"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640102">.</span><span class="ident" id="3640103"><a href="/gostd/regexp/syntax/regexp.go.html#3666976">Sub0</a></span><span class="op" id="3640107">[</span><span class="op" id="3640108">:</span><span class="num" id="3640109">1</span><span class="op" id="3640110">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640114"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640117">.</span><span class="ident" id="3640118"><a href="/gostd/regexp/syntax/regexp.go.html#3666929">Sub</a></span><span class="op" id="3640121">[</span><span class="num" id="3640122">0</span><span class="op" id="3640123">]</span>&nbsp;<span class="op" id="3640125">=</span>&nbsp;<span class="ident" id="3640127"><a href="/gostd/regexp/syntax/parse.go.html#3639794">re1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640133"><a href="/gostd/regexp/syntax/parse.go.html#3639555">p</a></span><span class="op" id="3640134">.</span><span class="ident" id="3640135"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3640139">(</span><span class="ident" id="3640140"><a href="/gostd/regexp/syntax/parse.go.html#3639815">re2</a></span><span class="op" id="3640143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640146">}</span><br>
<span class="lineno">1225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640149">return</span>&nbsp;<span class="builtintype" id="3640156">nil</span><br>
<span class="lineno"></span><span class="op" id="3640160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3640163">//&nbsp;parseEscape&nbsp;parses&nbsp;an&nbsp;escape&nbsp;sequence&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="3640226">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;rune.</span><br>
<span class="lineno">1230</span><span class="keyword" id="3640251">func</span>&nbsp;<span class="op" id="3640256">(</span><span class="ident" id="3640257">p</span>&nbsp;<span class="op" id="3640259">*</span><span class="ident" id="3640260"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3640266">)</span>&nbsp;<span class="ident" id="3640268">parseEscape</span><span class="op" id="3640279">(</span><span class="ident" id="3640280">s</span>&nbsp;<span class="builtintype" id="3640282">string</span><span class="op" id="3640288">)</span>&nbsp;<span class="op" id="3640290">(</span><span class="ident" id="3640291">r</span>&nbsp;<span class="builtintype" id="3640293">rune</span><span class="op" id="3640297">,</span>&nbsp;<span class="ident" id="3640299">rest</span>&nbsp;<span class="builtintype" id="3640304">string</span><span class="op" id="3640310">,</span>&nbsp;<span class="ident" id="3640312">err</span>&nbsp;<span class="builtintype" id="3640316">error</span><span class="op" id="3640321">)</span>&nbsp;<span class="op" id="3640323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640326">t</span>&nbsp;<span class="op" id="3640328">:=</span>&nbsp;<span class="ident" id="3640331"><a href="/gostd/regexp/syntax/parse.go.html#3640280">s</a></span><span class="op" id="3640332">[</span><span class="num" id="3640333">1</span><span class="op" id="3640334">:</span><span class="op" id="3640335">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640338">if</span>&nbsp;<span class="ident" id="3640341"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3640343">==</span>&nbsp;<span class="string" id="3640346">&#34;&#34;</span>&nbsp;<span class="op" id="3640349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640353">return</span>&nbsp;<span class="num" id="3640360">0</span><span class="op" id="3640361">,</span>&nbsp;<span class="string" id="3640363">&#34;&#34;</span><span class="op" id="3640365">,</span>&nbsp;<span class="op" id="3640367">&amp;</span><span class="ident" id="3640368"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3640373">{</span><span class="ident" id="3640374"><a href="/gostd/regexp/syntax/parse.go.html#3610862">ErrTrailingBackslash</a></span><span class="op" id="3640394">,</span>&nbsp;<span class="string" id="3640396">&#34;&#34;</span><span class="op" id="3640398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640401">}</span><br>
<span class="lineno">1235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3640404">c</span><span class="op" id="3640405">,</span>&nbsp;<span class="ident" id="3640407"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3640408">,</span>&nbsp;<span class="ident" id="3640410"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3640414">:=</span>&nbsp;<span class="ident" id="3640417"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3640425">(</span><span class="ident" id="3640426"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3640427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640430">if</span>&nbsp;<span class="ident" id="3640433"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3640437">!=</span>&nbsp;<span class="builtintype" id="3640440">nil</span>&nbsp;<span class="op" id="3640444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640448">return</span>&nbsp;<span class="num" id="3640455">0</span><span class="op" id="3640456">,</span>&nbsp;<span class="string" id="3640458">&#34;&#34;</span><span class="op" id="3640460">,</span>&nbsp;<span class="ident" id="3640462"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1240</span><span class="ident" id="3640470">Switch</span><span class="op" id="3640476">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640479">switch</span>&nbsp;<span class="ident" id="3640486"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span>&nbsp;<span class="op" id="3640488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640491">default</span><span class="op" id="3640498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640502">if</span>&nbsp;<span class="ident" id="3640505"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span>&nbsp;<span class="op" id="3640507">&lt;</span>&nbsp;<span class="ident" id="3640509"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3640513">.</span><span class="ident" id="3640514"><a href="/gostd/unicode/utf8/utf8.go.html#1805451">RuneSelf</a></span>&nbsp;<span class="op" id="3640523">&amp;&amp;</span>&nbsp;<span class="op" id="3640526">!</span><span class="ident" id="3640527"><a href="/gostd/regexp/syntax/parse.go.html#3655955">isalnum</a></span><span class="op" id="3640534">(</span><span class="ident" id="3640535"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3640536">)</span>&nbsp;<span class="op" id="3640538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640543">//&nbsp;Escaped&nbsp;non-word&nbsp;characters&nbsp;are&nbsp;always&nbsp;themselves.</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640600">//&nbsp;PCRE&nbsp;is&nbsp;not&nbsp;quite&nbsp;so&nbsp;rigorous:&nbsp;it&nbsp;accepts&nbsp;things&nbsp;like</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640660">//&nbsp;\q,&nbsp;but&nbsp;we&nbsp;don&#39;t.&nbsp;&nbsp;We&nbsp;once&nbsp;rejected&nbsp;\_,&nbsp;but&nbsp;too&nbsp;many</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640719">//&nbsp;programs&nbsp;and&nbsp;people&nbsp;insist&nbsp;on&nbsp;using&nbsp;it,&nbsp;so&nbsp;allow&nbsp;\_.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640778">return</span>&nbsp;<span class="ident" id="3640785"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3640786">,</span>&nbsp;<span class="ident" id="3640788"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3640789">,</span>&nbsp;<span class="builtintype" id="3640791">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640797">}</span><br>
<span class="lineno">1250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640801">//&nbsp;Octal&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640820">case</span>&nbsp;<span class="string" id="3640825">&#39;1&#39;</span><span class="op" id="3640828">,</span>&nbsp;<span class="string" id="3640830">&#39;2&#39;</span><span class="op" id="3640833">,</span>&nbsp;<span class="string" id="3640835">&#39;3&#39;</span><span class="op" id="3640838">,</span>&nbsp;<span class="string" id="3640840">&#39;4&#39;</span><span class="op" id="3640843">,</span>&nbsp;<span class="string" id="3640845">&#39;5&#39;</span><span class="op" id="3640848">,</span>&nbsp;<span class="string" id="3640850">&#39;6&#39;</span><span class="op" id="3640853">,</span>&nbsp;<span class="string" id="3640855">&#39;7&#39;</span><span class="op" id="3640858">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3640862">//&nbsp;Single&nbsp;non-zero&nbsp;digit&nbsp;is&nbsp;a&nbsp;backreference;&nbsp;not&nbsp;supported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640923">if</span>&nbsp;<span class="ident" id="3640926"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3640928">==</span>&nbsp;<span class="string" id="3640931">&#34;&#34;</span>&nbsp;<span class="op" id="3640934">||</span>&nbsp;<span class="ident" id="3640937"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3640938">[</span><span class="num" id="3640939">0</span><span class="op" id="3640940">]</span>&nbsp;<span class="op" id="3640942">&lt;</span>&nbsp;<span class="string" id="3640944">&#39;0&#39;</span>&nbsp;<span class="op" id="3640948">||</span>&nbsp;<span class="ident" id="3640951"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3640952">[</span><span class="num" id="3640953">0</span><span class="op" id="3640954">]</span>&nbsp;<span class="op" id="3640956">&gt;</span>&nbsp;<span class="string" id="3640958">&#39;7&#39;</span>&nbsp;<span class="op" id="3640962">{</span><br>
<span class="lineno">1255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640967">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3640975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640979">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3640992">case</span>&nbsp;<span class="string" id="3640997">&#39;0&#39;</span><span class="op" id="3641000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641004">//&nbsp;Consume&nbsp;up&nbsp;to&nbsp;three&nbsp;octal&nbsp;digits;&nbsp;already&nbsp;have&nbsp;one.</span><br>
<span class="lineno">1260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641061"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span>&nbsp;<span class="op" id="3641063">=</span>&nbsp;<span class="ident" id="3641065"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span>&nbsp;<span class="op" id="3641067">-</span>&nbsp;<span class="string" id="3641069">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641075">for</span>&nbsp;<span class="ident" id="3641079">i</span>&nbsp;<span class="op" id="3641081">:=</span>&nbsp;<span class="num" id="3641084">1</span><span class="op" id="3641085">;</span>&nbsp;<span class="ident" id="3641087"><a href="/gostd/regexp/syntax/parse.go.html#3641079">i</a></span>&nbsp;<span class="op" id="3641089">&lt;</span>&nbsp;<span class="num" id="3641091">3</span><span class="op" id="3641092">;</span>&nbsp;<span class="ident" id="3641094"><a href="/gostd/regexp/syntax/parse.go.html#3641079">i</a></span><span class="op" id="3641095">++</span>&nbsp;<span class="op" id="3641098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641103">if</span>&nbsp;<span class="ident" id="3641106"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3641108">==</span>&nbsp;<span class="string" id="3641111">&#34;&#34;</span>&nbsp;<span class="op" id="3641114">||</span>&nbsp;<span class="ident" id="3641117"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641118">[</span><span class="num" id="3641119">0</span><span class="op" id="3641120">]</span>&nbsp;<span class="op" id="3641122">&lt;</span>&nbsp;<span class="string" id="3641124">&#39;0&#39;</span>&nbsp;<span class="op" id="3641128">||</span>&nbsp;<span class="ident" id="3641131"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641132">[</span><span class="num" id="3641133">0</span><span class="op" id="3641134">]</span>&nbsp;<span class="op" id="3641136">&gt;</span>&nbsp;<span class="string" id="3641138">&#39;7&#39;</span>&nbsp;<span class="op" id="3641142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641148">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641157">}</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641162"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span>&nbsp;<span class="op" id="3641164">=</span>&nbsp;<span class="ident" id="3641166"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span><span class="op" id="3641167">*</span><span class="num" id="3641168">8</span>&nbsp;<span class="op" id="3641170">+</span>&nbsp;<span class="builtintype" id="3641172">rune</span><span class="op" id="3641176">(</span><span class="ident" id="3641177"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641178">[</span><span class="num" id="3641179">0</span><span class="op" id="3641180">]</span><span class="op" id="3641181">)</span>&nbsp;<span class="op" id="3641183">-</span>&nbsp;<span class="string" id="3641185">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641192"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3641194">=</span>&nbsp;<span class="ident" id="3641196"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641197">[</span><span class="num" id="3641198">1</span><span class="op" id="3641199">:</span><span class="op" id="3641200">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641208">return</span>&nbsp;<span class="ident" id="3641215"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span><span class="op" id="3641216">,</span>&nbsp;<span class="ident" id="3641218"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641219">,</span>&nbsp;<span class="builtintype" id="3641221">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641227">//&nbsp;Hexadecimal&nbsp;escapes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641252">case</span>&nbsp;<span class="string" id="3641257">&#39;x&#39;</span><span class="op" id="3641260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641264">if</span>&nbsp;<span class="ident" id="3641267"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3641269">==</span>&nbsp;<span class="string" id="3641272">&#34;&#34;</span>&nbsp;<span class="op" id="3641275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641280">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641288">}</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641292">if</span>&nbsp;<span class="ident" id="3641295"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3641296">,</span>&nbsp;<span class="ident" id="3641298"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641299">,</span>&nbsp;<span class="ident" id="3641301"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3641305">=</span>&nbsp;<span class="ident" id="3641307"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3641315">(</span><span class="ident" id="3641316"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641317">)</span><span class="op" id="3641318">;</span>&nbsp;<span class="ident" id="3641320"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3641324">!=</span>&nbsp;<span class="builtintype" id="3641327">nil</span>&nbsp;<span class="op" id="3641331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641336">return</span>&nbsp;<span class="num" id="3641343">0</span><span class="op" id="3641344">,</span>&nbsp;<span class="string" id="3641346">&#34;&#34;</span><span class="op" id="3641348">,</span>&nbsp;<span class="ident" id="3641350"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641360">if</span>&nbsp;<span class="ident" id="3641363"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span>&nbsp;<span class="op" id="3641365">==</span>&nbsp;<span class="string" id="3641368">&#39;{&#39;</span>&nbsp;<span class="op" id="3641372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641377">//&nbsp;Any&nbsp;number&nbsp;of&nbsp;digits&nbsp;in&nbsp;braces.</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641415">//&nbsp;Perl&nbsp;accepts&nbsp;any&nbsp;text&nbsp;at&nbsp;all;&nbsp;it&nbsp;ignores&nbsp;all&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641471">//&nbsp;after&nbsp;the&nbsp;first&nbsp;non-hex&nbsp;digit.&nbsp;&nbsp;We&nbsp;require&nbsp;only&nbsp;hex&nbsp;digits,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641537">//&nbsp;and&nbsp;at&nbsp;least&nbsp;one.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641561">nhex</span>&nbsp;<span class="op" id="3641566">:=</span>&nbsp;<span class="num" id="3641569">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641574"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span>&nbsp;<span class="op" id="3641576">=</span>&nbsp;<span class="num" id="3641578">0</span><br>
<span class="lineno">1285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641583">for</span>&nbsp;<span class="op" id="3641587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641593">if</span>&nbsp;<span class="ident" id="3641596"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span>&nbsp;<span class="op" id="3641598">==</span>&nbsp;<span class="string" id="3641601">&#34;&#34;</span>&nbsp;<span class="op" id="3641604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641611">break</span>&nbsp;<span class="ident" id="3641617"><a href="/gostd/regexp/syntax/parse.go.html#3640470">Switch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641634">if</span>&nbsp;<span class="ident" id="3641637"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3641638">,</span>&nbsp;<span class="ident" id="3641640"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641641">,</span>&nbsp;<span class="ident" id="3641643"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3641647">=</span>&nbsp;<span class="ident" id="3641649"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3641657">(</span><span class="ident" id="3641658"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641659">)</span><span class="op" id="3641660">;</span>&nbsp;<span class="ident" id="3641662"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3641666">!=</span>&nbsp;<span class="builtintype" id="3641669">nil</span>&nbsp;<span class="op" id="3641673">{</span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641680">return</span>&nbsp;<span class="num" id="3641687">0</span><span class="op" id="3641688">,</span>&nbsp;<span class="string" id="3641690">&#34;&#34;</span><span class="op" id="3641692">,</span>&nbsp;<span class="ident" id="3641694"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641708">if</span>&nbsp;<span class="ident" id="3641711"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span>&nbsp;<span class="op" id="3641713">==</span>&nbsp;<span class="string" id="3641716">&#39;}&#39;</span>&nbsp;<span class="op" id="3641720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641727">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641737">}</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641743">v</span>&nbsp;<span class="op" id="3641745">:=</span>&nbsp;<span class="ident" id="3641748"><a href="/gostd/regexp/syntax/parse.go.html#3656063">unhex</a></span><span class="op" id="3641753">(</span><span class="ident" id="3641754"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3641755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641761">if</span>&nbsp;<span class="ident" id="3641764"><a href="/gostd/regexp/syntax/parse.go.html#3641743">v</a></span>&nbsp;<span class="op" id="3641766">&lt;</span>&nbsp;<span class="num" id="3641768">0</span>&nbsp;<span class="op" id="3641770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641777">break</span>&nbsp;<span class="ident" id="3641783"><a href="/gostd/regexp/syntax/parse.go.html#3640470">Switch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641800"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span>&nbsp;<span class="op" id="3641802">=</span>&nbsp;<span class="ident" id="3641804"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span><span class="op" id="3641805">*</span><span class="num" id="3641806">16</span>&nbsp;<span class="op" id="3641809">+</span>&nbsp;<span class="ident" id="3641811"><a href="/gostd/regexp/syntax/parse.go.html#3641743">v</a></span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641817">if</span>&nbsp;<span class="ident" id="3641820"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span>&nbsp;<span class="op" id="3641822">&gt;</span>&nbsp;<span class="ident" id="3641824"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3641831">.</span><span class="ident" id="3641832"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3641840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641847">break</span>&nbsp;<span class="ident" id="3641853"><a href="/gostd/regexp/syntax/parse.go.html#3640470">Switch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641864">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641870"><a href="/gostd/regexp/syntax/parse.go.html#3641561">nhex</a></span><span class="op" id="3641874">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641880">}</span><br>
<span class="lineno">1305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641885">if</span>&nbsp;<span class="ident" id="3641888"><a href="/gostd/regexp/syntax/parse.go.html#3641561">nhex</a></span>&nbsp;<span class="op" id="3641893">==</span>&nbsp;<span class="num" id="3641896">0</span>&nbsp;<span class="op" id="3641898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641904">break</span>&nbsp;<span class="ident" id="3641910"><a href="/gostd/regexp/syntax/parse.go.html#3640470">Switch</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641925">return</span>&nbsp;<span class="ident" id="3641932"><a href="/gostd/regexp/syntax/parse.go.html#3640291">r</a></span><span class="op" id="3641933">,</span>&nbsp;<span class="ident" id="3641935"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3641936">,</span>&nbsp;<span class="builtintype" id="3641938">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3641944">}</span><br>
<span class="lineno">1310</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3641949">//&nbsp;Easy&nbsp;case:&nbsp;two&nbsp;hex&nbsp;digits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3641981">x</span>&nbsp;<span class="op" id="3641983">:=</span>&nbsp;<span class="ident" id="3641986"><a href="/gostd/regexp/syntax/parse.go.html#3656063">unhex</a></span><span class="op" id="3641991">(</span><span class="ident" id="3641992"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3641993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3641997">if</span>&nbsp;<span class="ident" id="3642000"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3642001">,</span>&nbsp;<span class="ident" id="3642003"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642004">,</span>&nbsp;<span class="ident" id="3642006"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3642010">=</span>&nbsp;<span class="ident" id="3642012"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3642020">(</span><span class="ident" id="3642021"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642022">)</span><span class="op" id="3642023">;</span>&nbsp;<span class="ident" id="3642025"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span>&nbsp;<span class="op" id="3642029">!=</span>&nbsp;<span class="builtintype" id="3642032">nil</span>&nbsp;<span class="op" id="3642036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642041">return</span>&nbsp;<span class="num" id="3642048">0</span><span class="op" id="3642049">,</span>&nbsp;<span class="string" id="3642051">&#34;&#34;</span><span class="op" id="3642053">,</span>&nbsp;<span class="ident" id="3642055"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3642061">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3642065">y</span>&nbsp;<span class="op" id="3642067">:=</span>&nbsp;<span class="ident" id="3642070"><a href="/gostd/regexp/syntax/parse.go.html#3656063">unhex</a></span><span class="op" id="3642075">(</span><span class="ident" id="3642076"><a href="/gostd/regexp/syntax/parse.go.html#3640404">c</a></span><span class="op" id="3642077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642081">if</span>&nbsp;<span class="ident" id="3642084"><a href="/gostd/regexp/syntax/parse.go.html#3641981">x</a></span>&nbsp;<span class="op" id="3642086">&lt;</span>&nbsp;<span class="num" id="3642088">0</span>&nbsp;<span class="op" id="3642090">||</span>&nbsp;<span class="ident" id="3642093"><a href="/gostd/regexp/syntax/parse.go.html#3642065">y</a></span>&nbsp;<span class="op" id="3642095">&lt;</span>&nbsp;<span class="num" id="3642097">0</span>&nbsp;<span class="op" id="3642099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642104">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3642112">}</span><br>
<span class="lineno">1320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642116">return</span>&nbsp;<span class="ident" id="3642123"><a href="/gostd/regexp/syntax/parse.go.html#3641981">x</a></span><span class="op" id="3642124">*</span><span class="num" id="3642125">16</span>&nbsp;<span class="op" id="3642128">+</span>&nbsp;<span class="ident" id="3642130"><a href="/gostd/regexp/syntax/parse.go.html#3642065">y</a></span><span class="op" id="3642131">,</span>&nbsp;<span class="ident" id="3642133"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642134">,</span>&nbsp;<span class="builtintype" id="3642136">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642142">//&nbsp;C&nbsp;escapes.&nbsp;&nbsp;There&nbsp;is&nbsp;no&nbsp;case&nbsp;&#39;b&#39;,&nbsp;to&nbsp;avoid&nbsp;misparsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642200">//&nbsp;the&nbsp;Perl&nbsp;word-boundary&nbsp;\b&nbsp;as&nbsp;the&nbsp;C&nbsp;backspace&nbsp;\b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642252">//&nbsp;when&nbsp;in&nbsp;POSIX&nbsp;mode.&nbsp;&nbsp;In&nbsp;Perl,&nbsp;/\b/&nbsp;means&nbsp;word-boundary</span><br>
<span class="lineno">1325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642311">//&nbsp;but&nbsp;/[\b]/&nbsp;means&nbsp;backspace.&nbsp;&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;that.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642367">//&nbsp;If&nbsp;you&nbsp;want&nbsp;a&nbsp;backspace,&nbsp;embed&nbsp;a&nbsp;literal&nbsp;backspace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642422">//&nbsp;character&nbsp;or&nbsp;use&nbsp;\x08.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642449">case</span>&nbsp;<span class="string" id="3642454">&#39;a&#39;</span><span class="op" id="3642457">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642461">return</span>&nbsp;<span class="string" id="3642468">&#39;\a&#39;</span><span class="op" id="3642472">,</span>&nbsp;<span class="ident" id="3642474"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642475">,</span>&nbsp;<span class="ident" id="3642477"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno">1330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642482">case</span>&nbsp;<span class="string" id="3642487">&#39;f&#39;</span><span class="op" id="3642490">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642494">return</span>&nbsp;<span class="string" id="3642501">&#39;\f&#39;</span><span class="op" id="3642505">,</span>&nbsp;<span class="ident" id="3642507"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642508">,</span>&nbsp;<span class="ident" id="3642510"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642515">case</span>&nbsp;<span class="string" id="3642520">&#39;n&#39;</span><span class="op" id="3642523">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642527">return</span>&nbsp;<span class="string" id="3642534">&#39;\n&#39;</span><span class="op" id="3642538">,</span>&nbsp;<span class="ident" id="3642540"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642541">,</span>&nbsp;<span class="ident" id="3642543"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642548">case</span>&nbsp;<span class="string" id="3642553">&#39;r&#39;</span><span class="op" id="3642556">:</span><br>
<span class="lineno">1335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642560">return</span>&nbsp;<span class="string" id="3642567">&#39;\r&#39;</span><span class="op" id="3642571">,</span>&nbsp;<span class="ident" id="3642573"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642574">,</span>&nbsp;<span class="ident" id="3642576"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642581">case</span>&nbsp;<span class="string" id="3642586">&#39;t&#39;</span><span class="op" id="3642589">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642593">return</span>&nbsp;<span class="string" id="3642600">&#39;\t&#39;</span><span class="op" id="3642604">,</span>&nbsp;<span class="ident" id="3642606"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642607">,</span>&nbsp;<span class="ident" id="3642609"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642614">case</span>&nbsp;<span class="string" id="3642619">&#39;v&#39;</span><span class="op" id="3642622">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642626">return</span>&nbsp;<span class="string" id="3642633">&#39;\v&#39;</span><span class="op" id="3642637">,</span>&nbsp;<span class="ident" id="3642639"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642640">,</span>&nbsp;<span class="ident" id="3642642"><a href="/gostd/regexp/syntax/parse.go.html#3640312">err</a></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3642647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642650">return</span>&nbsp;<span class="num" id="3642657">0</span><span class="op" id="3642658">,</span>&nbsp;<span class="string" id="3642660">&#34;&#34;</span><span class="op" id="3642662">,</span>&nbsp;<span class="op" id="3642664">&amp;</span><span class="ident" id="3642665"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3642670">{</span><span class="ident" id="3642671"><a href="/gostd/regexp/syntax/parse.go.html#3610275">ErrInvalidEscape</a></span><span class="op" id="3642687">,</span>&nbsp;<span class="ident" id="3642689"><a href="/gostd/regexp/syntax/parse.go.html#3640280">s</a></span><span class="op" id="3642690">[</span><span class="op" id="3642691">:</span><span class="builtinfunc" id="3642692">len</span><span class="op" id="3642695">(</span><span class="ident" id="3642696"><a href="/gostd/regexp/syntax/parse.go.html#3640280">s</a></span><span class="op" id="3642697">)</span><span class="op" id="3642698">-</span><span class="builtinfunc" id="3642699">len</span><span class="op" id="3642702">(</span><span class="ident" id="3642703"><a href="/gostd/regexp/syntax/parse.go.html#3640326">t</a></span><span class="op" id="3642704">)</span><span class="op" id="3642705">]</span><span class="op" id="3642706">}</span><br>
<span class="lineno"></span><span class="op" id="3642708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3642711">//&nbsp;parseClassChar&nbsp;parses&nbsp;a&nbsp;character&nbsp;class&nbsp;character&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno">1345</span><span class="comment" id="3642786">//&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3642805">func</span>&nbsp;<span class="op" id="3642810">(</span><span class="ident" id="3642811">p</span>&nbsp;<span class="op" id="3642813">*</span><span class="ident" id="3642814"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3642820">)</span>&nbsp;<span class="ident" id="3642822">parseClassChar</span><span class="op" id="3642836">(</span><span class="ident" id="3642837">s</span><span class="op" id="3642838">,</span>&nbsp;<span class="ident" id="3642840">wholeClass</span>&nbsp;<span class="builtintype" id="3642851">string</span><span class="op" id="3642857">)</span>&nbsp;<span class="op" id="3642859">(</span><span class="ident" id="3642860">r</span>&nbsp;<span class="builtintype" id="3642862">rune</span><span class="op" id="3642866">,</span>&nbsp;<span class="ident" id="3642868">rest</span>&nbsp;<span class="builtintype" id="3642873">string</span><span class="op" id="3642879">,</span>&nbsp;<span class="ident" id="3642881">err</span>&nbsp;<span class="builtintype" id="3642885">error</span><span class="op" id="3642890">)</span>&nbsp;<span class="op" id="3642892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642895">if</span>&nbsp;<span class="ident" id="3642898"><a href="/gostd/regexp/syntax/parse.go.html#3642837">s</a></span>&nbsp;<span class="op" id="3642900">==</span>&nbsp;<span class="string" id="3642903">&#34;&#34;</span>&nbsp;<span class="op" id="3642906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3642910">return</span>&nbsp;<span class="num" id="3642917">0</span><span class="op" id="3642918">,</span>&nbsp;<span class="string" id="3642920">&#34;&#34;</span><span class="op" id="3642922">,</span>&nbsp;<span class="op" id="3642924">&amp;</span><span class="ident" id="3642925"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3642930">{</span><span class="ident" id="3642931"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3642935">:</span>&nbsp;<span class="ident" id="3642937"><a href="/gostd/regexp/syntax/parse.go.html#3610666">ErrMissingBracket</a></span><span class="op" id="3642954">,</span>&nbsp;<span class="ident" id="3642956"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span><span class="op" id="3642960">:</span>&nbsp;<span class="ident" id="3642962"><a href="/gostd/regexp/syntax/parse.go.html#3642840">wholeClass</a></span><span class="op" id="3642972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3642975">}</span><br>
<span class="lineno">1350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3642979">//&nbsp;Allow&nbsp;regular&nbsp;escape&nbsp;sequences&nbsp;even&nbsp;though</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3643026">//&nbsp;many&nbsp;need&nbsp;not&nbsp;be&nbsp;escaped&nbsp;in&nbsp;this&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643072">if</span>&nbsp;<span class="ident" id="3643075"><a href="/gostd/regexp/syntax/parse.go.html#3642837">s</a></span><span class="op" id="3643076">[</span><span class="num" id="3643077">0</span><span class="op" id="3643078">]</span>&nbsp;<span class="op" id="3643080">==</span>&nbsp;<span class="string" id="3643083">&#39;\\&#39;</span>&nbsp;<span class="op" id="3643088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643092">return</span>&nbsp;<span class="ident" id="3643099"><a href="/gostd/regexp/syntax/parse.go.html#3642811">p</a></span><span class="op" id="3643100">.</span><span class="ident" id="3643101"><a href="/gostd/regexp/syntax/parse.go.html#3640268">parseEscape</a></span><span class="op" id="3643112">(</span><span class="ident" id="3643113"><a href="/gostd/regexp/syntax/parse.go.html#3642837">s</a></span><span class="op" id="3643114">)</span><br>
<span class="lineno">1355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3643117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643121">return</span>&nbsp;<span class="ident" id="3643128"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3643136">(</span><span class="ident" id="3643137"><a href="/gostd/regexp/syntax/parse.go.html#3642837">s</a></span><span class="op" id="3643138">)</span><br>
<span class="lineno"></span><span class="op" id="3643140">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span><span class="keyword" id="3643143">type</span>&nbsp;<span class="ident" id="3643148">charGroup</span>&nbsp;<span class="keyword" id="3643158">struct</span>&nbsp;<span class="op" id="3643165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3643168">sign</span>&nbsp;&nbsp;<span class="builtintype" id="3643174">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3643179">class</span>&nbsp;<span class="op" id="3643185">[</span><span class="op" id="3643186">]</span><span class="builtintype" id="3643187">rune</span><br>
<span class="lineno"></span><span class="op" id="3643192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1365</span><span class="comment" id="3643195">//&nbsp;parsePerlClassEscape&nbsp;parses&nbsp;a&nbsp;leading&nbsp;Perl&nbsp;character&nbsp;class&nbsp;escape&nbsp;like&nbsp;\d</span><br>
<span class="lineno"></span><span class="comment" id="3643272">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="3643351">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3643415">func</span>&nbsp;<span class="op" id="3643420">(</span><span class="ident" id="3643421">p</span>&nbsp;<span class="op" id="3643423">*</span><span class="ident" id="3643424"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3643430">)</span>&nbsp;<span class="ident" id="3643432">parsePerlClassEscape</span><span class="op" id="3643452">(</span><span class="ident" id="3643453">s</span>&nbsp;<span class="builtintype" id="3643455">string</span><span class="op" id="3643461">,</span>&nbsp;<span class="ident" id="3643463">r</span>&nbsp;<span class="op" id="3643465">[</span><span class="op" id="3643466">]</span><span class="builtintype" id="3643467">rune</span><span class="op" id="3643471">)</span>&nbsp;<span class="op" id="3643473">(</span><span class="ident" id="3643474">out</span>&nbsp;<span class="op" id="3643478">[</span><span class="op" id="3643479">]</span><span class="builtintype" id="3643480">rune</span><span class="op" id="3643484">,</span>&nbsp;<span class="ident" id="3643486">rest</span>&nbsp;<span class="builtintype" id="3643491">string</span><span class="op" id="3643497">)</span>&nbsp;<span class="op" id="3643499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643502">if</span>&nbsp;<span class="ident" id="3643505"><a href="/gostd/regexp/syntax/parse.go.html#3643421">p</a></span><span class="op" id="3643506">.</span><span class="ident" id="3643507"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3643512">&amp;</span><span class="ident" id="3643513"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3643519">==</span>&nbsp;<span class="num" id="3643522">0</span>&nbsp;<span class="op" id="3643524">||</span>&nbsp;<span class="builtinfunc" id="3643527">len</span><span class="op" id="3643530">(</span><span class="ident" id="3643531"><a href="/gostd/regexp/syntax/parse.go.html#3643453">s</a></span><span class="op" id="3643532">)</span>&nbsp;<span class="op" id="3643534">&lt;</span>&nbsp;<span class="num" id="3643536">2</span>&nbsp;<span class="op" id="3643538">||</span>&nbsp;<span class="ident" id="3643541"><a href="/gostd/regexp/syntax/parse.go.html#3643453">s</a></span><span class="op" id="3643542">[</span><span class="num" id="3643543">0</span><span class="op" id="3643544">]</span>&nbsp;<span class="op" id="3643546">!=</span>&nbsp;<span class="string" id="3643549">&#39;\\&#39;</span>&nbsp;<span class="op" id="3643554">{</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643558">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3643566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3643569">g</span>&nbsp;<span class="op" id="3643571">:=</span>&nbsp;<span class="ident" id="3643574"><a href="/gostd/regexp/syntax/perl_groups.go.html#3656715">perlGroup</a></span><span class="op" id="3643583">[</span><span class="ident" id="3643584"><a href="/gostd/regexp/syntax/parse.go.html#3643453">s</a></span><span class="op" id="3643585">[</span><span class="num" id="3643586">0</span><span class="op" id="3643587">:</span><span class="num" id="3643588">2</span><span class="op" id="3643589">]</span><span class="op" id="3643590">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643593">if</span>&nbsp;<span class="ident" id="3643596"><a href="/gostd/regexp/syntax/parse.go.html#3643569">g</a></span><span class="op" id="3643597">.</span><span class="ident" id="3643598"><a href="/gostd/regexp/syntax/parse.go.html#3643168">sign</a></span>&nbsp;<span class="op" id="3643603">==</span>&nbsp;<span class="num" id="3643606">0</span>&nbsp;<span class="op" id="3643608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643612">return</span><br>
<span class="lineno">1375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3643620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643623">return</span>&nbsp;<span class="ident" id="3643630"><a href="/gostd/regexp/syntax/parse.go.html#3643421">p</a></span><span class="op" id="3643631">.</span><span class="ident" id="3643632"><a href="/gostd/regexp/syntax/parse.go.html#3644281">appendGroup</a></span><span class="op" id="3643643">(</span><span class="ident" id="3643644"><a href="/gostd/regexp/syntax/parse.go.html#3643463">r</a></span><span class="op" id="3643645">,</span>&nbsp;<span class="ident" id="3643647"><a href="/gostd/regexp/syntax/parse.go.html#3643569">g</a></span><span class="op" id="3643648">)</span><span class="op" id="3643649">,</span>&nbsp;<span class="ident" id="3643651"><a href="/gostd/regexp/syntax/parse.go.html#3643453">s</a></span><span class="op" id="3643652">[</span><span class="num" id="3643653">2</span><span class="op" id="3643654">:</span><span class="op" id="3643655">]</span><br>
<span class="lineno"></span><span class="op" id="3643657">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3643660">//&nbsp;parseNamedClass&nbsp;parses&nbsp;a&nbsp;leading&nbsp;POSIX&nbsp;named&nbsp;character&nbsp;class&nbsp;like&nbsp;[:alnum:]</span><br>
<span class="lineno">1380</span><span class="comment" id="3643739">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="3643818">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3643882">func</span>&nbsp;<span class="op" id="3643887">(</span><span class="ident" id="3643888">p</span>&nbsp;<span class="op" id="3643890">*</span><span class="ident" id="3643891"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3643897">)</span>&nbsp;<span class="ident" id="3643899">parseNamedClass</span><span class="op" id="3643914">(</span><span class="ident" id="3643915">s</span>&nbsp;<span class="builtintype" id="3643917">string</span><span class="op" id="3643923">,</span>&nbsp;<span class="ident" id="3643925">r</span>&nbsp;<span class="op" id="3643927">[</span><span class="op" id="3643928">]</span><span class="builtintype" id="3643929">rune</span><span class="op" id="3643933">)</span>&nbsp;<span class="op" id="3643935">(</span><span class="ident" id="3643936">out</span>&nbsp;<span class="op" id="3643940">[</span><span class="op" id="3643941">]</span><span class="builtintype" id="3643942">rune</span><span class="op" id="3643946">,</span>&nbsp;<span class="ident" id="3643948">rest</span>&nbsp;<span class="builtintype" id="3643953">string</span><span class="op" id="3643959">,</span>&nbsp;<span class="ident" id="3643961">err</span>&nbsp;<span class="builtintype" id="3643965">error</span><span class="op" id="3643970">)</span>&nbsp;<span class="op" id="3643972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3643975">if</span>&nbsp;<span class="builtinfunc" id="3643978">len</span><span class="op" id="3643981">(</span><span class="ident" id="3643982"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3643983">)</span>&nbsp;<span class="op" id="3643985">&lt;</span>&nbsp;<span class="num" id="3643987">2</span>&nbsp;<span class="op" id="3643989">||</span>&nbsp;<span class="ident" id="3643992"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3643993">[</span><span class="num" id="3643994">0</span><span class="op" id="3643995">]</span>&nbsp;<span class="op" id="3643997">!=</span>&nbsp;<span class="string" id="3644000">&#39;[&#39;</span>&nbsp;<span class="op" id="3644004">||</span>&nbsp;<span class="ident" id="3644007"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3644008">[</span><span class="num" id="3644009">1</span><span class="op" id="3644010">]</span>&nbsp;<span class="op" id="3644012">!=</span>&nbsp;<span class="string" id="3644015">&#39;:&#39;</span>&nbsp;<span class="op" id="3644019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644023">return</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644035">i</span>&nbsp;<span class="op" id="3644037">:=</span>&nbsp;<span class="ident" id="3644040"><a href="/gostd/regexp/syntax/parse.go.html#3609638">strings</a></span><span class="op" id="3644047">.</span><span class="ident" id="3644048"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="3644053">(</span><span class="ident" id="3644054"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3644055">[</span><span class="num" id="3644056">2</span><span class="op" id="3644057">:</span><span class="op" id="3644058">]</span><span class="op" id="3644059">,</span>&nbsp;<span class="string" id="3644061">&#34;:]&#34;</span><span class="op" id="3644065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644068">if</span>&nbsp;<span class="ident" id="3644071"><a href="/gostd/regexp/syntax/parse.go.html#3644035">i</a></span>&nbsp;<span class="op" id="3644073">&lt;</span>&nbsp;<span class="num" id="3644075">0</span>&nbsp;<span class="op" id="3644077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644081">return</span><br>
<span class="lineno">1390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644092"><a href="/gostd/regexp/syntax/parse.go.html#3644035">i</a></span>&nbsp;<span class="op" id="3644094">+=</span>&nbsp;<span class="num" id="3644097">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644100">name</span><span class="op" id="3644104">,</span>&nbsp;<span class="ident" id="3644106"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span>&nbsp;<span class="op" id="3644108">:=</span>&nbsp;<span class="ident" id="3644111"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3644112">[</span><span class="num" id="3644113">0</span><span class="op" id="3644114">:</span><span class="ident" id="3644115"><a href="/gostd/regexp/syntax/parse.go.html#3644035">i</a></span><span class="op" id="3644116">+</span><span class="num" id="3644117">2</span><span class="op" id="3644118">]</span><span class="op" id="3644119">,</span>&nbsp;<span class="ident" id="3644121"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3644122">[</span><span class="ident" id="3644123"><a href="/gostd/regexp/syntax/parse.go.html#3644035">i</a></span><span class="op" id="3644124">+</span><span class="num" id="3644125">2</span><span class="op" id="3644126">:</span><span class="op" id="3644127">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644130">g</span>&nbsp;<span class="op" id="3644132">:=</span>&nbsp;<span class="ident" id="3644135"><a href="/gostd/regexp/syntax/perl_groups.go.html#3657787">posixGroup</a></span><span class="op" id="3644145">[</span><span class="ident" id="3644146"><a href="/gostd/regexp/syntax/parse.go.html#3644100">name</a></span><span class="op" id="3644150">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644153">if</span>&nbsp;<span class="ident" id="3644156"><a href="/gostd/regexp/syntax/parse.go.html#3644130">g</a></span><span class="op" id="3644157">.</span><span class="ident" id="3644158"><a href="/gostd/regexp/syntax/parse.go.html#3643168">sign</a></span>&nbsp;<span class="op" id="3644163">==</span>&nbsp;<span class="num" id="3644166">0</span>&nbsp;<span class="op" id="3644168">{</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644172">return</span>&nbsp;<span class="builtintype" id="3644179">nil</span><span class="op" id="3644182">,</span>&nbsp;<span class="string" id="3644184">&#34;&#34;</span><span class="op" id="3644186">,</span>&nbsp;<span class="op" id="3644188">&amp;</span><span class="ident" id="3644189"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3644194">{</span><span class="ident" id="3644195"><a href="/gostd/regexp/syntax/parse.go.html#3610205">ErrInvalidCharRange</a></span><span class="op" id="3644214">,</span>&nbsp;<span class="ident" id="3644216"><a href="/gostd/regexp/syntax/parse.go.html#3644100">name</a></span><span class="op" id="3644220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644223">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644226">return</span>&nbsp;<span class="ident" id="3644233"><a href="/gostd/regexp/syntax/parse.go.html#3643888">p</a></span><span class="op" id="3644234">.</span><span class="ident" id="3644235"><a href="/gostd/regexp/syntax/parse.go.html#3644281">appendGroup</a></span><span class="op" id="3644246">(</span><span class="ident" id="3644247"><a href="/gostd/regexp/syntax/parse.go.html#3643925">r</a></span><span class="op" id="3644248">,</span>&nbsp;<span class="ident" id="3644250"><a href="/gostd/regexp/syntax/parse.go.html#3644130">g</a></span><span class="op" id="3644251">)</span><span class="op" id="3644252">,</span>&nbsp;<span class="ident" id="3644254"><a href="/gostd/regexp/syntax/parse.go.html#3643915">s</a></span><span class="op" id="3644255">,</span>&nbsp;<span class="builtintype" id="3644257">nil</span><br>
<span class="lineno"></span><span class="op" id="3644261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1400</span><span class="keyword" id="3644264">func</span>&nbsp;<span class="op" id="3644269">(</span><span class="ident" id="3644270">p</span>&nbsp;<span class="op" id="3644272">*</span><span class="ident" id="3644273"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3644279">)</span>&nbsp;<span class="ident" id="3644281">appendGroup</span><span class="op" id="3644292">(</span><span class="ident" id="3644293">r</span>&nbsp;<span class="op" id="3644295">[</span><span class="op" id="3644296">]</span><span class="builtintype" id="3644297">rune</span><span class="op" id="3644301">,</span>&nbsp;<span class="ident" id="3644303">g</span>&nbsp;<span class="ident" id="3644305"><a href="/gostd/regexp/syntax/parse.go.html#3643148">charGroup</a></span><span class="op" id="3644314">)</span>&nbsp;<span class="op" id="3644316">[</span><span class="op" id="3644317">]</span><span class="builtintype" id="3644318">rune</span>&nbsp;<span class="op" id="3644323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644326">if</span>&nbsp;<span class="ident" id="3644329"><a href="/gostd/regexp/syntax/parse.go.html#3644270">p</a></span><span class="op" id="3644330">.</span><span class="ident" id="3644331"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3644336">&amp;</span><span class="ident" id="3644337"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3644346">==</span>&nbsp;<span class="num" id="3644349">0</span>&nbsp;<span class="op" id="3644351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644355">if</span>&nbsp;<span class="ident" id="3644358"><a href="/gostd/regexp/syntax/parse.go.html#3644303">g</a></span><span class="op" id="3644359">.</span><span class="ident" id="3644360"><a href="/gostd/regexp/syntax/parse.go.html#3643168">sign</a></span>&nbsp;<span class="op" id="3644365">&lt;</span>&nbsp;<span class="num" id="3644367">0</span>&nbsp;<span class="op" id="3644369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644374"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span>&nbsp;<span class="op" id="3644376">=</span>&nbsp;<span class="ident" id="3644378"><a href="/gostd/regexp/syntax/parse.go.html#3652554">appendNegatedClass</a></span><span class="op" id="3644396">(</span><span class="ident" id="3644397"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span><span class="op" id="3644398">,</span>&nbsp;<span class="ident" id="3644400"><a href="/gostd/regexp/syntax/parse.go.html#3644303">g</a></span><span class="op" id="3644401">.</span><span class="ident" id="3644402"><a href="/gostd/regexp/syntax/parse.go.html#3643179">class</a></span><span class="op" id="3644407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644411">}</span>&nbsp;<span class="keyword" id="3644413">else</span>&nbsp;<span class="op" id="3644418">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644423"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span>&nbsp;<span class="op" id="3644425">=</span>&nbsp;<span class="ident" id="3644427"><a href="/gostd/regexp/syntax/parse.go.html#3652060">appendClass</a></span><span class="op" id="3644438">(</span><span class="ident" id="3644439"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span><span class="op" id="3644440">,</span>&nbsp;<span class="ident" id="3644442"><a href="/gostd/regexp/syntax/parse.go.html#3644303">g</a></span><span class="op" id="3644443">.</span><span class="ident" id="3644444"><a href="/gostd/regexp/syntax/parse.go.html#3643179">class</a></span><span class="op" id="3644449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644456">}</span>&nbsp;<span class="keyword" id="3644458">else</span>&nbsp;<span class="op" id="3644463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644467">tmp</span>&nbsp;<span class="op" id="3644471">:=</span>&nbsp;<span class="ident" id="3644474"><a href="/gostd/regexp/syntax/parse.go.html#3644270">p</a></span><span class="op" id="3644475">.</span><span class="ident" id="3644476"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span><span class="op" id="3644484">[</span><span class="op" id="3644485">:</span><span class="num" id="3644486">0</span><span class="op" id="3644487">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644491"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span>&nbsp;<span class="op" id="3644495">=</span>&nbsp;<span class="ident" id="3644497"><a href="/gostd/regexp/syntax/parse.go.html#3652287">appendFoldedClass</a></span><span class="op" id="3644514">(</span><span class="ident" id="3644515"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span><span class="op" id="3644518">,</span>&nbsp;<span class="ident" id="3644520"><a href="/gostd/regexp/syntax/parse.go.html#3644303">g</a></span><span class="op" id="3644521">.</span><span class="ident" id="3644522"><a href="/gostd/regexp/syntax/parse.go.html#3643179">class</a></span><span class="op" id="3644527">)</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644531"><a href="/gostd/regexp/syntax/parse.go.html#3644270">p</a></span><span class="op" id="3644532">.</span><span class="ident" id="3644533"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span>&nbsp;<span class="op" id="3644542">=</span>&nbsp;<span class="ident" id="3644544"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644550"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span>&nbsp;<span class="op" id="3644554">=</span>&nbsp;<span class="ident" id="3644556"><a href="/gostd/regexp/syntax/parse.go.html#3649602">cleanClass</a></span><span class="op" id="3644566">(</span><span class="op" id="3644567">&amp;</span><span class="ident" id="3644568"><a href="/gostd/regexp/syntax/parse.go.html#3644270">p</a></span><span class="op" id="3644569">.</span><span class="ident" id="3644570"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span><span class="op" id="3644578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644582">if</span>&nbsp;<span class="ident" id="3644585"><a href="/gostd/regexp/syntax/parse.go.html#3644303">g</a></span><span class="op" id="3644586">.</span><span class="ident" id="3644587"><a href="/gostd/regexp/syntax/parse.go.html#3643168">sign</a></span>&nbsp;<span class="op" id="3644592">&lt;</span>&nbsp;<span class="num" id="3644594">0</span>&nbsp;<span class="op" id="3644596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644601"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span>&nbsp;<span class="op" id="3644603">=</span>&nbsp;<span class="ident" id="3644605"><a href="/gostd/regexp/syntax/parse.go.html#3652554">appendNegatedClass</a></span><span class="op" id="3644623">(</span><span class="ident" id="3644624"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span><span class="op" id="3644625">,</span>&nbsp;<span class="ident" id="3644627"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span><span class="op" id="3644630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644634">}</span>&nbsp;<span class="keyword" id="3644636">else</span>&nbsp;<span class="op" id="3644641">{</span><br>
<span class="lineno">1415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644646"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span>&nbsp;<span class="op" id="3644648">=</span>&nbsp;<span class="ident" id="3644650"><a href="/gostd/regexp/syntax/parse.go.html#3652060">appendClass</a></span><span class="op" id="3644661">(</span><span class="ident" id="3644662"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span><span class="op" id="3644663">,</span>&nbsp;<span class="ident" id="3644665"><a href="/gostd/regexp/syntax/parse.go.html#3644467">tmp</a></span><span class="op" id="3644668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3644675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3644678">return</span>&nbsp;<span class="ident" id="3644685"><a href="/gostd/regexp/syntax/parse.go.html#3644293">r</a></span><br>
<span class="lineno"></span><span class="op" id="3644687">}</span><br>
<span class="lineno">1420</span><br>
<span class="lineno"></span><span class="keyword" id="3644690">var</span>&nbsp;<span class="ident" id="3644694">anyTable</span>&nbsp;<span class="op" id="3644703">=</span>&nbsp;<span class="op" id="3644705">&amp;</span><span class="ident" id="3644706"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3644713">.</span><span class="ident" id="3644714"><a href="/gostd/unicode/letter.go.html#1822132">RangeTable</a></span><span class="op" id="3644724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644727"><a href="/gostd/unicode/letter.go.html#1822153">R16</a></span><span class="op" id="3644730">:</span>&nbsp;<span class="op" id="3644732">[</span><span class="op" id="3644733">]</span><span class="ident" id="3644734"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3644741">.</span><span class="ident" id="3644742"><a href="/gostd/unicode/letter.go.html#1822409">Range16</a></span><span class="op" id="3644749">{</span><span class="op" id="3644750">{</span><span class="ident" id="3644751"><a href="/gostd/unicode/letter.go.html#1822427">Lo</a></span><span class="op" id="3644753">:</span>&nbsp;<span class="num" id="3644755">0</span><span class="op" id="3644756">,</span>&nbsp;<span class="ident" id="3644758"><a href="/gostd/unicode/letter.go.html#1822442">Hi</a></span><span class="op" id="3644760">:</span>&nbsp;<span class="num" id="3644762">1</span><span class="op" id="3644763">&lt;&lt;</span><span class="num" id="3644765">16</span>&nbsp;<span class="op" id="3644768">-</span>&nbsp;<span class="num" id="3644770">1</span><span class="op" id="3644771">,</span>&nbsp;<span class="ident" id="3644773"><a href="/gostd/unicode/letter.go.html#1822457">Stride</a></span><span class="op" id="3644779">:</span>&nbsp;<span class="num" id="3644781">1</span><span class="op" id="3644782">}</span><span class="op" id="3644783">}</span><span class="op" id="3644784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3644787"><a href="/gostd/unicode/letter.go.html#1822176">R32</a></span><span class="op" id="3644790">:</span>&nbsp;<span class="op" id="3644792">[</span><span class="op" id="3644793">]</span><span class="ident" id="3644794"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3644801">.</span><span class="ident" id="3644802"><a href="/gostd/unicode/letter.go.html#1822714">Range32</a></span><span class="op" id="3644809">{</span><span class="op" id="3644810">{</span><span class="ident" id="3644811"><a href="/gostd/unicode/letter.go.html#1822732">Lo</a></span><span class="op" id="3644813">:</span>&nbsp;<span class="num" id="3644815">1</span>&nbsp;<span class="op" id="3644817">&lt;&lt;</span>&nbsp;<span class="num" id="3644820">16</span><span class="op" id="3644822">,</span>&nbsp;<span class="ident" id="3644824"><a href="/gostd/unicode/letter.go.html#1822747">Hi</a></span><span class="op" id="3644826">:</span>&nbsp;<span class="ident" id="3644828"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3644835">.</span><span class="ident" id="3644836"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3644843">,</span>&nbsp;<span class="ident" id="3644845"><a href="/gostd/unicode/letter.go.html#1822762">Stride</a></span><span class="op" id="3644851">:</span>&nbsp;<span class="num" id="3644853">1</span><span class="op" id="3644854">}</span><span class="op" id="3644855">}</span><span class="op" id="3644856">,</span><br>
<span class="lineno"></span><span class="op" id="3644858">}</span><br>
<span class="lineno">1425</span><br>
<span class="lineno"></span><span class="comment" id="3644861">//&nbsp;unicodeTable&nbsp;returns&nbsp;the&nbsp;unicode.RangeTable&nbsp;identified&nbsp;by&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="3644927">//&nbsp;and&nbsp;the&nbsp;table&nbsp;of&nbsp;additional&nbsp;fold-equivalent&nbsp;code&nbsp;points.</span><br>
<span class="lineno"></span><span class="keyword" id="3644987">func</span>&nbsp;<span class="ident" id="3644992">unicodeTable</span><span class="op" id="3645004">(</span><span class="ident" id="3645005">name</span>&nbsp;<span class="builtintype" id="3645010">string</span><span class="op" id="3645016">)</span>&nbsp;<span class="op" id="3645018">(</span><span class="op" id="3645019">*</span><span class="ident" id="3645020"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645027">.</span><span class="ident" id="3645028"><a href="/gostd/unicode/letter.go.html#1822132">RangeTable</a></span><span class="op" id="3645038">,</span>&nbsp;<span class="op" id="3645040">*</span><span class="ident" id="3645041"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645048">.</span><span class="ident" id="3645049"><a href="/gostd/unicode/letter.go.html#1822132">RangeTable</a></span><span class="op" id="3645059">)</span>&nbsp;<span class="op" id="3645061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3645064">//&nbsp;Special&nbsp;case:&nbsp;&#34;Any&#34;&nbsp;means&nbsp;any.</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645099">if</span>&nbsp;<span class="ident" id="3645102"><a href="/gostd/regexp/syntax/parse.go.html#3645005">name</a></span>&nbsp;<span class="op" id="3645107">==</span>&nbsp;<span class="string" id="3645110">&#34;Any&#34;</span>&nbsp;<span class="op" id="3645116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645120">return</span>&nbsp;<span class="ident" id="3645127"><a href="/gostd/regexp/syntax/parse.go.html#3644694">anyTable</a></span><span class="op" id="3645135">,</span>&nbsp;<span class="ident" id="3645137"><a href="/gostd/regexp/syntax/parse.go.html#3644694">anyTable</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645150">if</span>&nbsp;<span class="ident" id="3645153">t</span>&nbsp;<span class="op" id="3645155">:=</span>&nbsp;<span class="ident" id="3645158"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645165">.</span><span class="ident" id="3645166"><a href="/gostd/unicode/tables.go.html#1831334">Categories</a></span><span class="op" id="3645176">[</span><span class="ident" id="3645177"><a href="/gostd/regexp/syntax/parse.go.html#3645005">name</a></span><span class="op" id="3645181">]</span><span class="op" id="3645182">;</span>&nbsp;<span class="ident" id="3645184"><a href="/gostd/regexp/syntax/parse.go.html#3645153">t</a></span>&nbsp;<span class="op" id="3645186">!=</span>&nbsp;<span class="builtintype" id="3645189">nil</span>&nbsp;<span class="op" id="3645193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645197">return</span>&nbsp;<span class="ident" id="3645204"><a href="/gostd/regexp/syntax/parse.go.html#3645153">t</a></span><span class="op" id="3645205">,</span>&nbsp;<span class="ident" id="3645207"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645214">.</span><span class="ident" id="3645215"><a href="/gostd/unicode/tables.go.html#2000416">FoldCategory</a></span><span class="op" id="3645227">[</span><span class="ident" id="3645228"><a href="/gostd/regexp/syntax/parse.go.html#3645005">name</a></span><span class="op" id="3645232">]</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645238">if</span>&nbsp;<span class="ident" id="3645241">t</span>&nbsp;<span class="op" id="3645243">:=</span>&nbsp;<span class="ident" id="3645246"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645253">.</span><span class="ident" id="3645254"><a href="/gostd/unicode/tables.go.html#1904707">Scripts</a></span><span class="op" id="3645261">[</span><span class="ident" id="3645262"><a href="/gostd/regexp/syntax/parse.go.html#3645005">name</a></span><span class="op" id="3645266">]</span><span class="op" id="3645267">;</span>&nbsp;<span class="ident" id="3645269"><a href="/gostd/regexp/syntax/parse.go.html#3645241">t</a></span>&nbsp;<span class="op" id="3645271">!=</span>&nbsp;<span class="builtintype" id="3645274">nil</span>&nbsp;<span class="op" id="3645278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645282">return</span>&nbsp;<span class="ident" id="3645289"><a href="/gostd/regexp/syntax/parse.go.html#3645241">t</a></span><span class="op" id="3645290">,</span>&nbsp;<span class="ident" id="3645292"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3645299">.</span><span class="ident" id="3645300"><a href="/gostd/unicode/tables.go.html#2006510">FoldScript</a></span><span class="op" id="3645310">[</span><span class="ident" id="3645311"><a href="/gostd/regexp/syntax/parse.go.html#3645005">name</a></span><span class="op" id="3645315">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645321">return</span>&nbsp;<span class="builtintype" id="3645328">nil</span><span class="op" id="3645331">,</span>&nbsp;<span class="builtintype" id="3645333">nil</span><br>
<span class="lineno">1440</span><span class="op" id="3645337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3645340">//&nbsp;parseUnicodeClass&nbsp;parses&nbsp;a&nbsp;leading&nbsp;Unicode&nbsp;character&nbsp;class&nbsp;like&nbsp;\p{Han}</span><br>
<span class="lineno"></span><span class="comment" id="3645415">//&nbsp;from&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s.&nbsp;&nbsp;If&nbsp;one&nbsp;is&nbsp;present,&nbsp;it&nbsp;appends&nbsp;the&nbsp;characters&nbsp;to&nbsp;r</span><br>
<span class="lineno"></span><span class="comment" id="3645494">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;slice&nbsp;r&nbsp;and&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the&nbsp;string.</span><br>
<span class="lineno">1445</span><span class="keyword" id="3645558">func</span>&nbsp;<span class="op" id="3645563">(</span><span class="ident" id="3645564">p</span>&nbsp;<span class="op" id="3645566">*</span><span class="ident" id="3645567"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3645573">)</span>&nbsp;<span class="ident" id="3645575">parseUnicodeClass</span><span class="op" id="3645592">(</span><span class="ident" id="3645593">s</span>&nbsp;<span class="builtintype" id="3645595">string</span><span class="op" id="3645601">,</span>&nbsp;<span class="ident" id="3645603">r</span>&nbsp;<span class="op" id="3645605">[</span><span class="op" id="3645606">]</span><span class="builtintype" id="3645607">rune</span><span class="op" id="3645611">)</span>&nbsp;<span class="op" id="3645613">(</span><span class="ident" id="3645614">out</span>&nbsp;<span class="op" id="3645618">[</span><span class="op" id="3645619">]</span><span class="builtintype" id="3645620">rune</span><span class="op" id="3645624">,</span>&nbsp;<span class="ident" id="3645626">rest</span>&nbsp;<span class="builtintype" id="3645631">string</span><span class="op" id="3645637">,</span>&nbsp;<span class="ident" id="3645639">err</span>&nbsp;<span class="builtintype" id="3645643">error</span><span class="op" id="3645648">)</span>&nbsp;<span class="op" id="3645650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645653">if</span>&nbsp;<span class="ident" id="3645656"><a href="/gostd/regexp/syntax/parse.go.html#3645564">p</a></span><span class="op" id="3645657">.</span><span class="ident" id="3645658"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3645663">&amp;</span><span class="ident" id="3645664"><a href="/gostd/regexp/syntax/parse.go.html#3611703">UnicodeGroups</a></span>&nbsp;<span class="op" id="3645678">==</span>&nbsp;<span class="num" id="3645681">0</span>&nbsp;<span class="op" id="3645683">||</span>&nbsp;<span class="builtinfunc" id="3645686">len</span><span class="op" id="3645689">(</span><span class="ident" id="3645690"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645691">)</span>&nbsp;<span class="op" id="3645693">&lt;</span>&nbsp;<span class="num" id="3645695">2</span>&nbsp;<span class="op" id="3645697">||</span>&nbsp;<span class="ident" id="3645700"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645701">[</span><span class="num" id="3645702">0</span><span class="op" id="3645703">]</span>&nbsp;<span class="op" id="3645705">!=</span>&nbsp;<span class="string" id="3645708">&#39;\\&#39;</span>&nbsp;<span class="op" id="3645713">||</span>&nbsp;<span class="ident" id="3645716"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645717">[</span><span class="num" id="3645718">1</span><span class="op" id="3645719">]</span>&nbsp;<span class="op" id="3645721">!=</span>&nbsp;<span class="string" id="3645724">&#39;p&#39;</span>&nbsp;<span class="op" id="3645728">&amp;&amp;</span>&nbsp;<span class="ident" id="3645731"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645732">[</span><span class="num" id="3645733">1</span><span class="op" id="3645734">]</span>&nbsp;<span class="op" id="3645736">!=</span>&nbsp;<span class="string" id="3645739">&#39;P&#39;</span>&nbsp;<span class="op" id="3645743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645747">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3645759">//&nbsp;Committed&nbsp;to&nbsp;parse&nbsp;or&nbsp;return&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3645799">sign</span>&nbsp;<span class="op" id="3645804">:=</span>&nbsp;<span class="op" id="3645807">+</span><span class="num" id="3645808">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645811">if</span>&nbsp;<span class="ident" id="3645814"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645815">[</span><span class="num" id="3645816">1</span><span class="op" id="3645817">]</span>&nbsp;<span class="op" id="3645819">==</span>&nbsp;<span class="string" id="3645822">&#39;P&#39;</span>&nbsp;<span class="op" id="3645826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3645830"><a href="/gostd/regexp/syntax/parse.go.html#3645799">sign</a></span>&nbsp;<span class="op" id="3645835">=</span>&nbsp;<span class="op" id="3645837">-</span><span class="num" id="3645838">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645841">}</span><br>
<span class="lineno">1455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3645844">t</span>&nbsp;<span class="op" id="3645846">:=</span>&nbsp;<span class="ident" id="3645849"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645850">[</span><span class="num" id="3645851">2</span><span class="op" id="3645852">:</span><span class="op" id="3645853">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3645856">c</span><span class="op" id="3645857">,</span>&nbsp;<span class="ident" id="3645859"><a href="/gostd/regexp/syntax/parse.go.html#3645844">t</a></span><span class="op" id="3645860">,</span>&nbsp;<span class="ident" id="3645862"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3645866">:=</span>&nbsp;<span class="ident" id="3645869"><a href="/gostd/regexp/syntax/parse.go.html#3655736">nextRune</a></span><span class="op" id="3645877">(</span><span class="ident" id="3645878"><a href="/gostd/regexp/syntax/parse.go.html#3645844">t</a></span><span class="op" id="3645879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645882">if</span>&nbsp;<span class="ident" id="3645885"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3645889">!=</span>&nbsp;<span class="builtintype" id="3645892">nil</span>&nbsp;<span class="op" id="3645896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645900">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3645908">}</span><br>
<span class="lineno">1460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645911">var</span>&nbsp;<span class="ident" id="3645915">seq</span><span class="op" id="3645918">,</span>&nbsp;<span class="ident" id="3645920">name</span>&nbsp;<span class="builtintype" id="3645925">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3645933">if</span>&nbsp;<span class="ident" id="3645936"><a href="/gostd/regexp/syntax/parse.go.html#3645856">c</a></span>&nbsp;<span class="op" id="3645938">!=</span>&nbsp;<span class="string" id="3645941">&#39;{&#39;</span>&nbsp;<span class="op" id="3645945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3645949">//&nbsp;Single-letter&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3645974"><a href="/gostd/regexp/syntax/parse.go.html#3645915">seq</a></span>&nbsp;<span class="op" id="3645978">=</span>&nbsp;<span class="ident" id="3645980"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645981">[</span><span class="op" id="3645982">:</span><span class="builtinfunc" id="3645983">len</span><span class="op" id="3645986">(</span><span class="ident" id="3645987"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3645988">)</span><span class="op" id="3645989">-</span><span class="builtinfunc" id="3645990">len</span><span class="op" id="3645993">(</span><span class="ident" id="3645994"><a href="/gostd/regexp/syntax/parse.go.html#3645844">t</a></span><span class="op" id="3645995">)</span><span class="op" id="3645996">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646000"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span>&nbsp;<span class="op" id="3646005">=</span>&nbsp;<span class="ident" id="3646007"><a href="/gostd/regexp/syntax/parse.go.html#3645915">seq</a></span><span class="op" id="3646010">[</span><span class="num" id="3646011">2</span><span class="op" id="3646012">:</span><span class="op" id="3646013">]</span><br>
<span class="lineno">1465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646016">}</span>&nbsp;<span class="keyword" id="3646018">else</span>&nbsp;<span class="op" id="3646023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646027">//&nbsp;Name&nbsp;is&nbsp;in&nbsp;braces.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646051">end</span>&nbsp;<span class="op" id="3646055">:=</span>&nbsp;<span class="ident" id="3646058"><a href="/gostd/regexp/syntax/parse.go.html#3609638">strings</a></span><span class="op" id="3646065">.</span><span class="ident" id="3646066"><a href="/gostd/strings/strings.go.html#2970424">IndexRune</a></span><span class="op" id="3646075">(</span><span class="ident" id="3646076"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646077">,</span>&nbsp;<span class="string" id="3646079">&#39;}&#39;</span><span class="op" id="3646082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646086">if</span>&nbsp;<span class="ident" id="3646089"><a href="/gostd/regexp/syntax/parse.go.html#3646051">end</a></span>&nbsp;<span class="op" id="3646093">&lt;</span>&nbsp;<span class="num" id="3646095">0</span>&nbsp;<span class="op" id="3646097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646102">if</span>&nbsp;<span class="ident" id="3646105"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3646109">=</span>&nbsp;<span class="ident" id="3646111"><a href="/gostd/regexp/syntax/parse.go.html#3655517">checkUTF8</a></span><span class="op" id="3646120">(</span><span class="ident" id="3646121"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646122">)</span><span class="op" id="3646123">;</span>&nbsp;<span class="ident" id="3646125"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3646129">!=</span>&nbsp;<span class="builtintype" id="3646132">nil</span>&nbsp;<span class="op" id="3646136">{</span><br>
<span class="lineno">1470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646157">return</span>&nbsp;<span class="builtintype" id="3646164">nil</span><span class="op" id="3646167">,</span>&nbsp;<span class="string" id="3646169">&#34;&#34;</span><span class="op" id="3646171">,</span>&nbsp;<span class="op" id="3646173">&amp;</span><span class="ident" id="3646174"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3646179">{</span><span class="ident" id="3646180"><a href="/gostd/regexp/syntax/parse.go.html#3610205">ErrInvalidCharRange</a></span><span class="op" id="3646199">,</span>&nbsp;<span class="ident" id="3646201"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646210"><a href="/gostd/regexp/syntax/parse.go.html#3645915">seq</a></span><span class="op" id="3646213">,</span>&nbsp;<span class="ident" id="3646215"><a href="/gostd/regexp/syntax/parse.go.html#3645844">t</a></span>&nbsp;<span class="op" id="3646217">=</span>&nbsp;<span class="ident" id="3646219"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646220">[</span><span class="op" id="3646221">:</span><span class="ident" id="3646222"><a href="/gostd/regexp/syntax/parse.go.html#3646051">end</a></span><span class="op" id="3646225">+</span><span class="num" id="3646226">1</span><span class="op" id="3646227">]</span><span class="op" id="3646228">,</span>&nbsp;<span class="ident" id="3646230"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646231">[</span><span class="ident" id="3646232"><a href="/gostd/regexp/syntax/parse.go.html#3646051">end</a></span><span class="op" id="3646235">+</span><span class="num" id="3646236">1</span><span class="op" id="3646237">:</span><span class="op" id="3646238">]</span><br>
<span class="lineno">1475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646242"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span>&nbsp;<span class="op" id="3646247">=</span>&nbsp;<span class="ident" id="3646249"><a href="/gostd/regexp/syntax/parse.go.html#3645593">s</a></span><span class="op" id="3646250">[</span><span class="num" id="3646251">3</span><span class="op" id="3646252">:</span><span class="ident" id="3646253"><a href="/gostd/regexp/syntax/parse.go.html#3646051">end</a></span><span class="op" id="3646256">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646260">if</span>&nbsp;<span class="ident" id="3646263"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3646267">=</span>&nbsp;<span class="ident" id="3646269"><a href="/gostd/regexp/syntax/parse.go.html#3655517">checkUTF8</a></span><span class="op" id="3646278">(</span><span class="ident" id="3646279"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span><span class="op" id="3646283">)</span><span class="op" id="3646284">;</span>&nbsp;<span class="ident" id="3646286"><a href="/gostd/regexp/syntax/parse.go.html#3645639">err</a></span>&nbsp;<span class="op" id="3646290">!=</span>&nbsp;<span class="builtintype" id="3646293">nil</span>&nbsp;<span class="op" id="3646297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646302">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646314">}</span><br>
<span class="lineno">1480</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646318">//&nbsp;Group&nbsp;can&nbsp;have&nbsp;leading&nbsp;negation&nbsp;too.&nbsp;&nbsp;\p{^Han}&nbsp;==&nbsp;\P{Han},&nbsp;\P{^Han}&nbsp;==&nbsp;\p{Han}.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646402">if</span>&nbsp;<span class="ident" id="3646405"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span>&nbsp;<span class="op" id="3646410">!=</span>&nbsp;<span class="string" id="3646413">&#34;&#34;</span>&nbsp;<span class="op" id="3646416">&amp;&amp;</span>&nbsp;<span class="ident" id="3646419"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span><span class="op" id="3646423">[</span><span class="num" id="3646424">0</span><span class="op" id="3646425">]</span>&nbsp;<span class="op" id="3646427">==</span>&nbsp;<span class="string" id="3646430">&#39;^&#39;</span>&nbsp;<span class="op" id="3646434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646438"><a href="/gostd/regexp/syntax/parse.go.html#3645799">sign</a></span>&nbsp;<span class="op" id="3646443">=</span>&nbsp;<span class="op" id="3646445">-</span><span class="ident" id="3646446"><a href="/gostd/regexp/syntax/parse.go.html#3645799">sign</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646453"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span>&nbsp;<span class="op" id="3646458">=</span>&nbsp;<span class="ident" id="3646460"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span><span class="op" id="3646464">[</span><span class="num" id="3646465">1</span><span class="op" id="3646466">:</span><span class="op" id="3646467">]</span><br>
<span class="lineno">1485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646474">tab</span><span class="op" id="3646477">,</span>&nbsp;<span class="ident" id="3646479">fold</span>&nbsp;<span class="op" id="3646484">:=</span>&nbsp;<span class="ident" id="3646487"><a href="/gostd/regexp/syntax/parse.go.html#3644992">unicodeTable</a></span><span class="op" id="3646499">(</span><span class="ident" id="3646500"><a href="/gostd/regexp/syntax/parse.go.html#3645920">name</a></span><span class="op" id="3646504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646507">if</span>&nbsp;<span class="ident" id="3646510"><a href="/gostd/regexp/syntax/parse.go.html#3646474">tab</a></span>&nbsp;<span class="op" id="3646514">==</span>&nbsp;<span class="builtintype" id="3646517">nil</span>&nbsp;<span class="op" id="3646521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646525">return</span>&nbsp;<span class="builtintype" id="3646532">nil</span><span class="op" id="3646535">,</span>&nbsp;<span class="string" id="3646537">&#34;&#34;</span><span class="op" id="3646539">,</span>&nbsp;<span class="op" id="3646541">&amp;</span><span class="ident" id="3646542"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3646547">{</span><span class="ident" id="3646548"><a href="/gostd/regexp/syntax/parse.go.html#3610205">ErrInvalidCharRange</a></span><span class="op" id="3646567">,</span>&nbsp;<span class="ident" id="3646569"><a href="/gostd/regexp/syntax/parse.go.html#3645915">seq</a></span><span class="op" id="3646572">}</span><br>
<span class="lineno">1490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646579">if</span>&nbsp;<span class="ident" id="3646582"><a href="/gostd/regexp/syntax/parse.go.html#3645564">p</a></span><span class="op" id="3646583">.</span><span class="ident" id="3646584"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3646589">&amp;</span><span class="ident" id="3646590"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3646599">==</span>&nbsp;<span class="num" id="3646602">0</span>&nbsp;<span class="op" id="3646604">||</span>&nbsp;<span class="ident" id="3646607"><a href="/gostd/regexp/syntax/parse.go.html#3646479">fold</a></span>&nbsp;<span class="op" id="3646612">==</span>&nbsp;<span class="builtintype" id="3646615">nil</span>&nbsp;<span class="op" id="3646619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3646623">if</span>&nbsp;<span class="ident" id="3646626"><a href="/gostd/regexp/syntax/parse.go.html#3645799">sign</a></span>&nbsp;<span class="op" id="3646631">&gt;</span>&nbsp;<span class="num" id="3646633">0</span>&nbsp;<span class="op" id="3646635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646640"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span>&nbsp;<span class="op" id="3646642">=</span>&nbsp;<span class="ident" id="3646644"><a href="/gostd/regexp/syntax/parse.go.html#3652928">appendTable</a></span><span class="op" id="3646655">(</span><span class="ident" id="3646656"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span><span class="op" id="3646657">,</span>&nbsp;<span class="ident" id="3646659"><a href="/gostd/regexp/syntax/parse.go.html#3646474">tab</a></span><span class="op" id="3646662">)</span><br>
<span class="lineno">1495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646666">}</span>&nbsp;<span class="keyword" id="3646668">else</span>&nbsp;<span class="op" id="3646673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646678"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span>&nbsp;<span class="op" id="3646680">=</span>&nbsp;<span class="ident" id="3646682"><a href="/gostd/regexp/syntax/parse.go.html#3653544">appendNegatedTable</a></span><span class="op" id="3646700">(</span><span class="ident" id="3646701"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span><span class="op" id="3646702">,</span>&nbsp;<span class="ident" id="3646704"><a href="/gostd/regexp/syntax/parse.go.html#3646474">tab</a></span><span class="op" id="3646707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3646714">}</span>&nbsp;<span class="keyword" id="3646716">else</span>&nbsp;<span class="op" id="3646721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646725">//&nbsp;Merge&nbsp;and&nbsp;clean&nbsp;tab&nbsp;and&nbsp;fold&nbsp;in&nbsp;a&nbsp;temporary&nbsp;buffer.</span><br>
<span class="lineno">1500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646782">//&nbsp;This&nbsp;is&nbsp;necessary&nbsp;for&nbsp;the&nbsp;negative&nbsp;case&nbsp;and&nbsp;just&nbsp;tidy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3646841">//&nbsp;for&nbsp;the&nbsp;positive&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646869">tmp</span>&nbsp;<span class="op" id="3646873">:=</span>&nbsp;<span class="ident" id="3646876"><a href="/gostd/regexp/syntax/parse.go.html#3645564">p</a></span><span class="op" id="3646877">.</span><span class="ident" id="3646878"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span><span class="op" id="3646886">[</span><span class="op" id="3646887">:</span><span class="num" id="3646888">0</span><span class="op" id="3646889">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646893"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span>&nbsp;<span class="op" id="3646897">=</span>&nbsp;<span class="ident" id="3646899"><a href="/gostd/regexp/syntax/parse.go.html#3652928">appendTable</a></span><span class="op" id="3646910">(</span><span class="ident" id="3646911"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span><span class="op" id="3646914">,</span>&nbsp;<span class="ident" id="3646916"><a href="/gostd/regexp/syntax/parse.go.html#3646474">tab</a></span><span class="op" id="3646919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646923"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span>&nbsp;<span class="op" id="3646927">=</span>&nbsp;<span class="ident" id="3646929"><a href="/gostd/regexp/syntax/parse.go.html#3652928">appendTable</a></span><span class="op" id="3646940">(</span><span class="ident" id="3646941"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span><span class="op" id="3646944">,</span>&nbsp;<span class="ident" id="3646946"><a href="/gostd/regexp/syntax/parse.go.html#3646479">fold</a></span><span class="op" id="3646950">)</span><br>
<span class="lineno">1505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646954"><a href="/gostd/regexp/syntax/parse.go.html#3645564">p</a></span><span class="op" id="3646955">.</span><span class="ident" id="3646956"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span>&nbsp;<span class="op" id="3646965">=</span>&nbsp;<span class="ident" id="3646967"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3646973"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span>&nbsp;<span class="op" id="3646977">=</span>&nbsp;<span class="ident" id="3646979"><a href="/gostd/regexp/syntax/parse.go.html#3649602">cleanClass</a></span><span class="op" id="3646989">(</span><span class="op" id="3646990">&amp;</span><span class="ident" id="3646991"><a href="/gostd/regexp/syntax/parse.go.html#3645564">p</a></span><span class="op" id="3646992">.</span><span class="ident" id="3646993"><a href="/gostd/regexp/syntax/parse.go.html#3612429">tmpClass</a></span><span class="op" id="3647001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647005">if</span>&nbsp;<span class="ident" id="3647008"><a href="/gostd/regexp/syntax/parse.go.html#3645799">sign</a></span>&nbsp;<span class="op" id="3647013">&gt;</span>&nbsp;<span class="num" id="3647015">0</span>&nbsp;<span class="op" id="3647017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647022"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span>&nbsp;<span class="op" id="3647024">=</span>&nbsp;<span class="ident" id="3647026"><a href="/gostd/regexp/syntax/parse.go.html#3652060">appendClass</a></span><span class="op" id="3647037">(</span><span class="ident" id="3647038"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span><span class="op" id="3647039">,</span>&nbsp;<span class="ident" id="3647041"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span><span class="op" id="3647044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647048">}</span>&nbsp;<span class="keyword" id="3647050">else</span>&nbsp;<span class="op" id="3647055">{</span><br>
<span class="lineno">1510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647060"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span>&nbsp;<span class="op" id="3647062">=</span>&nbsp;<span class="ident" id="3647064"><a href="/gostd/regexp/syntax/parse.go.html#3652554">appendNegatedClass</a></span><span class="op" id="3647082">(</span><span class="ident" id="3647083"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span><span class="op" id="3647084">,</span>&nbsp;<span class="ident" id="3647086"><a href="/gostd/regexp/syntax/parse.go.html#3646869">tmp</a></span><span class="op" id="3647089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647099">return</span>&nbsp;<span class="ident" id="3647106"><a href="/gostd/regexp/syntax/parse.go.html#3645603">r</a></span><span class="op" id="3647107">,</span>&nbsp;<span class="ident" id="3647109"><a href="/gostd/regexp/syntax/parse.go.html#3645844">t</a></span><span class="op" id="3647110">,</span>&nbsp;<span class="builtintype" id="3647112">nil</span><br>
<span class="lineno"></span><span class="op" id="3647116">}</span><br>
<span class="lineno">1515</span><br>
<span class="lineno"></span><span class="comment" id="3647119">//&nbsp;parseClass&nbsp;parses&nbsp;a&nbsp;character&nbsp;class&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="3647180">//&nbsp;and&nbsp;pushes&nbsp;it&nbsp;onto&nbsp;the&nbsp;parse&nbsp;stack.</span><br>
<span class="lineno"></span><span class="keyword" id="3647219">func</span>&nbsp;<span class="op" id="3647224">(</span><span class="ident" id="3647225">p</span>&nbsp;<span class="op" id="3647227">*</span><span class="ident" id="3647228"><a href="/gostd/regexp/syntax/parse.go.html#3612222">parser</a></span><span class="op" id="3647234">)</span>&nbsp;<span class="ident" id="3647236">parseClass</span><span class="op" id="3647246">(</span><span class="ident" id="3647247">s</span>&nbsp;<span class="builtintype" id="3647249">string</span><span class="op" id="3647255">)</span>&nbsp;<span class="op" id="3647257">(</span><span class="ident" id="3647258">rest</span>&nbsp;<span class="builtintype" id="3647263">string</span><span class="op" id="3647269">,</span>&nbsp;<span class="ident" id="3647271">err</span>&nbsp;<span class="builtintype" id="3647275">error</span><span class="op" id="3647280">)</span>&nbsp;<span class="op" id="3647282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647285">t</span>&nbsp;<span class="op" id="3647287">:=</span>&nbsp;<span class="ident" id="3647290"><a href="/gostd/regexp/syntax/parse.go.html#3647247">s</a></span><span class="op" id="3647291">[</span><span class="num" id="3647292">1</span><span class="op" id="3647293">:</span><span class="op" id="3647294">]</span>&nbsp;<span class="comment" id="3647296">//&nbsp;chop&nbsp;[</span><br>
<span class="lineno">1520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647307">re</span>&nbsp;<span class="op" id="3647310">:=</span>&nbsp;<span class="ident" id="3647313"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3647314">.</span><span class="ident" id="3647315"><a href="/gostd/regexp/syntax/parse.go.html#3612503">newRegexp</a></span><span class="op" id="3647324">(</span><span class="ident" id="3647325"><a href="/gostd/regexp/syntax/regexp.go.html#3667730">OpCharClass</a></span><span class="op" id="3647336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647339"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647341">.</span><span class="ident" id="3647342"><a href="/gostd/regexp/syntax/regexp.go.html#3666913">Flags</a></span>&nbsp;<span class="op" id="3647348">=</span>&nbsp;<span class="ident" id="3647350"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3647351">.</span><span class="ident" id="3647352"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647359"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647361">.</span><span class="ident" id="3647362"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3647367">=</span>&nbsp;<span class="ident" id="3647369"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647371">.</span><span class="ident" id="3647372"><a href="/gostd/regexp/syntax/regexp.go.html#3667088">Rune0</a></span><span class="op" id="3647377">[</span><span class="op" id="3647378">:</span><span class="num" id="3647379">0</span><span class="op" id="3647380">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647384">sign</span>&nbsp;<span class="op" id="3647389">:=</span>&nbsp;<span class="op" id="3647392">+</span><span class="num" id="3647393">1</span><br>
<span class="lineno">1525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647396">if</span>&nbsp;<span class="ident" id="3647399"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3647401">!=</span>&nbsp;<span class="string" id="3647404">&#34;&#34;</span>&nbsp;<span class="op" id="3647407">&amp;&amp;</span>&nbsp;<span class="ident" id="3647410"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647411">[</span><span class="num" id="3647412">0</span><span class="op" id="3647413">]</span>&nbsp;<span class="op" id="3647415">==</span>&nbsp;<span class="string" id="3647418">&#39;^&#39;</span>&nbsp;<span class="op" id="3647422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647426"><a href="/gostd/regexp/syntax/parse.go.html#3647384">sign</a></span>&nbsp;<span class="op" id="3647431">=</span>&nbsp;<span class="op" id="3647433">-</span><span class="num" id="3647434">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647438"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3647440">=</span>&nbsp;<span class="ident" id="3647442"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647443">[</span><span class="num" id="3647444">1</span><span class="op" id="3647445">:</span><span class="op" id="3647446">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647451">//&nbsp;If&nbsp;character&nbsp;class&nbsp;does&nbsp;not&nbsp;match&nbsp;\n,&nbsp;add&nbsp;it&nbsp;here,</span><br>
<span class="lineno">1530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647507">//&nbsp;so&nbsp;that&nbsp;negation&nbsp;later&nbsp;will&nbsp;do&nbsp;the&nbsp;right&nbsp;thing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647560">if</span>&nbsp;<span class="ident" id="3647563"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3647564">.</span><span class="ident" id="3647565"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3647570">&amp;</span><span class="ident" id="3647571"><a href="/gostd/regexp/syntax/parse.go.html#3611299">ClassNL</a></span>&nbsp;<span class="op" id="3647579">==</span>&nbsp;<span class="num" id="3647582">0</span>&nbsp;<span class="op" id="3647584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647589"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647591">.</span><span class="ident" id="3647592"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3647597">=</span>&nbsp;<span class="builtinfunc" id="3647599">append</span><span class="op" id="3647605">(</span><span class="ident" id="3647606"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647608">.</span><span class="ident" id="3647609"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3647613">,</span>&nbsp;<span class="string" id="3647615">&#39;\n&#39;</span><span class="op" id="3647619">,</span>&nbsp;<span class="string" id="3647621">&#39;\n&#39;</span><span class="op" id="3647625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647629">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3647632">}</span><br>
<span class="lineno">1535</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647636">class</span>&nbsp;<span class="op" id="3647642">:=</span>&nbsp;<span class="ident" id="3647645"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3647647">.</span><span class="ident" id="3647648"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647654">first</span>&nbsp;<span class="op" id="3647660">:=</span>&nbsp;<span class="builtintype" id="3647663">true</span>&nbsp;<span class="comment" id="3647668">//&nbsp;]&nbsp;and&nbsp;-&nbsp;are&nbsp;okay&nbsp;as&nbsp;first&nbsp;char&nbsp;in&nbsp;class</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647712">for</span>&nbsp;<span class="ident" id="3647716"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3647718">==</span>&nbsp;<span class="string" id="3647721">&#34;&#34;</span>&nbsp;<span class="op" id="3647724">||</span>&nbsp;<span class="ident" id="3647727"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647728">[</span><span class="num" id="3647729">0</span><span class="op" id="3647730">]</span>&nbsp;<span class="op" id="3647732">!=</span>&nbsp;<span class="string" id="3647735">&#39;]&#39;</span>&nbsp;<span class="op" id="3647739">||</span>&nbsp;<span class="ident" id="3647742"><a href="/gostd/regexp/syntax/parse.go.html#3647654">first</a></span>&nbsp;<span class="op" id="3647748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647752">//&nbsp;POSIX:&nbsp;-&nbsp;is&nbsp;only&nbsp;okay&nbsp;unescaped&nbsp;as&nbsp;first&nbsp;or&nbsp;last&nbsp;in&nbsp;class.</span><br>
<span class="lineno">1540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3647816">//&nbsp;Perl:&nbsp;-&nbsp;is&nbsp;okay&nbsp;anywhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647847">if</span>&nbsp;<span class="ident" id="3647850"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3647852">!=</span>&nbsp;<span class="string" id="3647855">&#34;&#34;</span>&nbsp;<span class="op" id="3647858">&amp;&amp;</span>&nbsp;<span class="ident" id="3647861"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647862">[</span><span class="num" id="3647863">0</span><span class="op" id="3647864">]</span>&nbsp;<span class="op" id="3647866">==</span>&nbsp;<span class="string" id="3647869">&#39;-&#39;</span>&nbsp;<span class="op" id="3647873">&amp;&amp;</span>&nbsp;<span class="ident" id="3647876"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3647877">.</span><span class="ident" id="3647878"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3647883">&amp;</span><span class="ident" id="3647884"><a href="/gostd/regexp/syntax/parse.go.html#3611645">PerlX</a></span>&nbsp;<span class="op" id="3647890">==</span>&nbsp;<span class="num" id="3647893">0</span>&nbsp;<span class="op" id="3647895">&amp;&amp;</span>&nbsp;<span class="op" id="3647898">!</span><span class="ident" id="3647899"><a href="/gostd/regexp/syntax/parse.go.html#3647654">first</a></span>&nbsp;<span class="op" id="3647905">&amp;&amp;</span>&nbsp;<span class="op" id="3647908">(</span><span class="builtinfunc" id="3647909">len</span><span class="op" id="3647912">(</span><span class="ident" id="3647913"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647914">)</span>&nbsp;<span class="op" id="3647916">==</span>&nbsp;<span class="num" id="3647919">1</span>&nbsp;<span class="op" id="3647921">||</span>&nbsp;<span class="ident" id="3647924"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647925">[</span><span class="num" id="3647926">1</span><span class="op" id="3647927">]</span>&nbsp;<span class="op" id="3647929">!=</span>&nbsp;<span class="string" id="3647932">&#39;]&#39;</span><span class="op" id="3647935">)</span>&nbsp;<span class="op" id="3647937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3647942">_</span><span class="op" id="3647943">,</span>&nbsp;<span class="ident" id="3647945">size</span>&nbsp;<span class="op" id="3647950">:=</span>&nbsp;<span class="ident" id="3647953"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3647957">.</span><span class="ident" id="3647958"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="3647976">(</span><span class="ident" id="3647977"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3647978">[</span><span class="num" id="3647979">1</span><span class="op" id="3647980">:</span><span class="op" id="3647981">]</span><span class="op" id="3647982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3647987">return</span>&nbsp;<span class="string" id="3647994">&#34;&#34;</span><span class="op" id="3647996">,</span>&nbsp;<span class="op" id="3647998">&amp;</span><span class="ident" id="3647999"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3648004">{</span><span class="ident" id="3648005"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3648009">:</span>&nbsp;<span class="ident" id="3648011"><a href="/gostd/regexp/syntax/parse.go.html#3610205">ErrInvalidCharRange</a></span><span class="op" id="3648030">,</span>&nbsp;<span class="ident" id="3648032"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span><span class="op" id="3648036">:</span>&nbsp;<span class="ident" id="3648038"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648039">[</span><span class="op" id="3648040">:</span><span class="num" id="3648041">1</span><span class="op" id="3648042">+</span><span class="ident" id="3648043"><a href="/gostd/regexp/syntax/parse.go.html#3647945">size</a></span><span class="op" id="3648047">]</span><span class="op" id="3648048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648052">}</span><br>
<span class="lineno">1545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648056"><a href="/gostd/regexp/syntax/parse.go.html#3647654">first</a></span>&nbsp;<span class="op" id="3648062">=</span>&nbsp;<span class="builtintype" id="3648064">false</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3648073">//&nbsp;Look&nbsp;for&nbsp;POSIX&nbsp;[:alnum:]&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648108">if</span>&nbsp;<span class="builtinfunc" id="3648111">len</span><span class="op" id="3648114">(</span><span class="ident" id="3648115"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648116">)</span>&nbsp;<span class="op" id="3648118">&gt;</span>&nbsp;<span class="num" id="3648120">2</span>&nbsp;<span class="op" id="3648122">&amp;&amp;</span>&nbsp;<span class="ident" id="3648125"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648126">[</span><span class="num" id="3648127">0</span><span class="op" id="3648128">]</span>&nbsp;<span class="op" id="3648130">==</span>&nbsp;<span class="string" id="3648133">&#39;[&#39;</span>&nbsp;<span class="op" id="3648137">&amp;&amp;</span>&nbsp;<span class="ident" id="3648140"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648141">[</span><span class="num" id="3648142">1</span><span class="op" id="3648143">]</span>&nbsp;<span class="op" id="3648145">==</span>&nbsp;<span class="string" id="3648148">&#39;:&#39;</span>&nbsp;<span class="op" id="3648152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648157">nclass</span><span class="op" id="3648163">,</span>&nbsp;<span class="ident" id="3648165">nt</span><span class="op" id="3648167">,</span>&nbsp;<span class="ident" id="3648169">err</span>&nbsp;<span class="op" id="3648173">:=</span>&nbsp;<span class="ident" id="3648176"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3648177">.</span><span class="ident" id="3648178"><a href="/gostd/regexp/syntax/parse.go.html#3643899">parseNamedClass</a></span><span class="op" id="3648193">(</span><span class="ident" id="3648194"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648195">,</span>&nbsp;<span class="ident" id="3648197"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648202">)</span><br>
<span class="lineno">1550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648207">if</span>&nbsp;<span class="ident" id="3648210"><a href="/gostd/regexp/syntax/parse.go.html#3648169">err</a></span>&nbsp;<span class="op" id="3648214">!=</span>&nbsp;<span class="builtintype" id="3648217">nil</span>&nbsp;<span class="op" id="3648221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648227">return</span>&nbsp;<span class="string" id="3648234">&#34;&#34;</span><span class="op" id="3648236">,</span>&nbsp;<span class="ident" id="3648238"><a href="/gostd/regexp/syntax/parse.go.html#3648169">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648250">if</span>&nbsp;<span class="ident" id="3648253"><a href="/gostd/regexp/syntax/parse.go.html#3648157">nclass</a></span>&nbsp;<span class="op" id="3648260">!=</span>&nbsp;<span class="builtintype" id="3648263">nil</span>&nbsp;<span class="op" id="3648267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648273"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648278">,</span>&nbsp;<span class="ident" id="3648280"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3648282">=</span>&nbsp;<span class="ident" id="3648284"><a href="/gostd/regexp/syntax/parse.go.html#3648157">nclass</a></span><span class="op" id="3648290">,</span>&nbsp;<span class="ident" id="3648292"><a href="/gostd/regexp/syntax/parse.go.html#3648165">nt</a></span><br>
<span class="lineno">1555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648299">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3648320">//&nbsp;Look&nbsp;for&nbsp;Unicode&nbsp;character&nbsp;group&nbsp;like&nbsp;\p{Han}.</span><br>
<span class="lineno">1560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648372">nclass</span><span class="op" id="3648378">,</span>&nbsp;<span class="ident" id="3648380">nt</span><span class="op" id="3648382">,</span>&nbsp;<span class="ident" id="3648384">err</span>&nbsp;<span class="op" id="3648388">:=</span>&nbsp;<span class="ident" id="3648391"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3648392">.</span><span class="ident" id="3648393"><a href="/gostd/regexp/syntax/parse.go.html#3645575">parseUnicodeClass</a></span><span class="op" id="3648410">(</span><span class="ident" id="3648411"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648412">,</span>&nbsp;<span class="ident" id="3648414"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648423">if</span>&nbsp;<span class="ident" id="3648426"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span>&nbsp;<span class="op" id="3648430">!=</span>&nbsp;<span class="builtintype" id="3648433">nil</span>&nbsp;<span class="op" id="3648437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648442">return</span>&nbsp;<span class="string" id="3648449">&#34;&#34;</span><span class="op" id="3648451">,</span>&nbsp;<span class="ident" id="3648453"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648463">if</span>&nbsp;<span class="ident" id="3648466"><a href="/gostd/regexp/syntax/parse.go.html#3648372">nclass</a></span>&nbsp;<span class="op" id="3648473">!=</span>&nbsp;<span class="builtintype" id="3648476">nil</span>&nbsp;<span class="op" id="3648480">{</span><br>
<span class="lineno">1565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648485"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648490">,</span>&nbsp;<span class="ident" id="3648492"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3648494">=</span>&nbsp;<span class="ident" id="3648496"><a href="/gostd/regexp/syntax/parse.go.html#3648372">nclass</a></span><span class="op" id="3648502">,</span>&nbsp;<span class="ident" id="3648504"><a href="/gostd/regexp/syntax/parse.go.html#3648380">nt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648510">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3648526">//&nbsp;Look&nbsp;for&nbsp;Perl&nbsp;character&nbsp;class&nbsp;symbols&nbsp;(extension).</span><br>
<span class="lineno">1570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648582">if</span>&nbsp;<span class="ident" id="3648585">nclass</span><span class="op" id="3648591">,</span>&nbsp;<span class="ident" id="3648593">nt</span>&nbsp;<span class="op" id="3648596">:=</span>&nbsp;<span class="ident" id="3648599"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3648600">.</span><span class="ident" id="3648601"><a href="/gostd/regexp/syntax/parse.go.html#3643432">parsePerlClassEscape</a></span><span class="op" id="3648621">(</span><span class="ident" id="3648622"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648623">,</span>&nbsp;<span class="ident" id="3648625"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648630">)</span><span class="op" id="3648631">;</span>&nbsp;<span class="ident" id="3648633"><a href="/gostd/regexp/syntax/parse.go.html#3648585">nclass</a></span>&nbsp;<span class="op" id="3648640">!=</span>&nbsp;<span class="builtintype" id="3648643">nil</span>&nbsp;<span class="op" id="3648647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648652"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3648657">,</span>&nbsp;<span class="ident" id="3648659"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3648661">=</span>&nbsp;<span class="ident" id="3648663"><a href="/gostd/regexp/syntax/parse.go.html#3648585">nclass</a></span><span class="op" id="3648669">,</span>&nbsp;<span class="ident" id="3648671"><a href="/gostd/regexp/syntax/parse.go.html#3648593">nt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648677">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3648693">//&nbsp;Single&nbsp;character&nbsp;or&nbsp;simple&nbsp;range.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648732">rng</span>&nbsp;<span class="op" id="3648736">:=</span>&nbsp;<span class="ident" id="3648739"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648743">var</span>&nbsp;<span class="ident" id="3648747">lo</span><span class="op" id="3648749">,</span>&nbsp;<span class="ident" id="3648751">hi</span>&nbsp;<span class="builtintype" id="3648754">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648761">if</span>&nbsp;<span class="ident" id="3648764"><a href="/gostd/regexp/syntax/parse.go.html#3648747">lo</a></span><span class="op" id="3648766">,</span>&nbsp;<span class="ident" id="3648768"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648769">,</span>&nbsp;<span class="ident" id="3648771"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span>&nbsp;<span class="op" id="3648775">=</span>&nbsp;<span class="ident" id="3648777"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3648778">.</span><span class="ident" id="3648779"><a href="/gostd/regexp/syntax/parse.go.html#3642822">parseClassChar</a></span><span class="op" id="3648793">(</span><span class="ident" id="3648794"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648795">,</span>&nbsp;<span class="ident" id="3648797"><a href="/gostd/regexp/syntax/parse.go.html#3647247">s</a></span><span class="op" id="3648798">)</span><span class="op" id="3648799">;</span>&nbsp;<span class="ident" id="3648801"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span>&nbsp;<span class="op" id="3648805">!=</span>&nbsp;<span class="builtintype" id="3648808">nil</span>&nbsp;<span class="op" id="3648812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648817">return</span>&nbsp;<span class="string" id="3648824">&#34;&#34;</span><span class="op" id="3648826">,</span>&nbsp;<span class="ident" id="3648828"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span><br>
<span class="lineno">1580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3648834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648838"><a href="/gostd/regexp/syntax/parse.go.html#3648751">hi</a></span>&nbsp;<span class="op" id="3648841">=</span>&nbsp;<span class="ident" id="3648843"><a href="/gostd/regexp/syntax/parse.go.html#3648747">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3648848">//&nbsp;[a-]&nbsp;means&nbsp;(a|-)&nbsp;so&nbsp;check&nbsp;for&nbsp;final&nbsp;].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648892">if</span>&nbsp;<span class="builtinfunc" id="3648895">len</span><span class="op" id="3648898">(</span><span class="ident" id="3648899"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648900">)</span>&nbsp;<span class="op" id="3648902">&gt;=</span>&nbsp;<span class="num" id="3648905">2</span>&nbsp;<span class="op" id="3648907">&amp;&amp;</span>&nbsp;<span class="ident" id="3648910"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648911">[</span><span class="num" id="3648912">0</span><span class="op" id="3648913">]</span>&nbsp;<span class="op" id="3648915">==</span>&nbsp;<span class="string" id="3648918">&#39;-&#39;</span>&nbsp;<span class="op" id="3648922">&amp;&amp;</span>&nbsp;<span class="ident" id="3648925"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648926">[</span><span class="num" id="3648927">1</span><span class="op" id="3648928">]</span>&nbsp;<span class="op" id="3648930">!=</span>&nbsp;<span class="string" id="3648933">&#39;]&#39;</span>&nbsp;<span class="op" id="3648937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3648942"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3648944">=</span>&nbsp;<span class="ident" id="3648946"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648947">[</span><span class="num" id="3648948">1</span><span class="op" id="3648949">:</span><span class="op" id="3648950">]</span><br>
<span class="lineno">1585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3648955">if</span>&nbsp;<span class="ident" id="3648958"><a href="/gostd/regexp/syntax/parse.go.html#3648751">hi</a></span><span class="op" id="3648960">,</span>&nbsp;<span class="ident" id="3648962"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648963">,</span>&nbsp;<span class="ident" id="3648965"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span>&nbsp;<span class="op" id="3648969">=</span>&nbsp;<span class="ident" id="3648971"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3648972">.</span><span class="ident" id="3648973"><a href="/gostd/regexp/syntax/parse.go.html#3642822">parseClassChar</a></span><span class="op" id="3648987">(</span><span class="ident" id="3648988"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3648989">,</span>&nbsp;<span class="ident" id="3648991"><a href="/gostd/regexp/syntax/parse.go.html#3647247">s</a></span><span class="op" id="3648992">)</span><span class="op" id="3648993">;</span>&nbsp;<span class="ident" id="3648995"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span>&nbsp;<span class="op" id="3648999">!=</span>&nbsp;<span class="builtintype" id="3649002">nil</span>&nbsp;<span class="op" id="3649006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649012">return</span>&nbsp;<span class="string" id="3649019">&#34;&#34;</span><span class="op" id="3649021">,</span>&nbsp;<span class="ident" id="3649023"><a href="/gostd/regexp/syntax/parse.go.html#3648384">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649035">if</span>&nbsp;<span class="ident" id="3649038"><a href="/gostd/regexp/syntax/parse.go.html#3648751">hi</a></span>&nbsp;<span class="op" id="3649041">&lt;</span>&nbsp;<span class="ident" id="3649043"><a href="/gostd/regexp/syntax/parse.go.html#3648747">lo</a></span>&nbsp;<span class="op" id="3649046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649052"><a href="/gostd/regexp/syntax/parse.go.html#3648732">rng</a></span>&nbsp;<span class="op" id="3649056">=</span>&nbsp;<span class="ident" id="3649058"><a href="/gostd/regexp/syntax/parse.go.html#3648732">rng</a></span><span class="op" id="3649061">[</span><span class="op" id="3649062">:</span><span class="builtinfunc" id="3649063">len</span><span class="op" id="3649066">(</span><span class="ident" id="3649067"><a href="/gostd/regexp/syntax/parse.go.html#3648732">rng</a></span><span class="op" id="3649070">)</span><span class="op" id="3649071">-</span><span class="builtinfunc" id="3649072">len</span><span class="op" id="3649075">(</span><span class="ident" id="3649076"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3649077">)</span><span class="op" id="3649078">]</span><br>
<span class="lineno">1590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649084">return</span>&nbsp;<span class="string" id="3649091">&#34;&#34;</span><span class="op" id="3649093">,</span>&nbsp;<span class="op" id="3649095">&amp;</span><span class="ident" id="3649096"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3649101">{</span><span class="ident" id="3649102"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3649106">:</span>&nbsp;<span class="ident" id="3649108"><a href="/gostd/regexp/syntax/parse.go.html#3610205">ErrInvalidCharRange</a></span><span class="op" id="3649127">,</span>&nbsp;<span class="ident" id="3649129"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span><span class="op" id="3649133">:</span>&nbsp;<span class="ident" id="3649135"><a href="/gostd/regexp/syntax/parse.go.html#3648732">rng</a></span><span class="op" id="3649138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649151">if</span>&nbsp;<span class="ident" id="3649154"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3649155">.</span><span class="ident" id="3649156"><a href="/gostd/regexp/syntax/parse.go.html#3612239">flags</a></span><span class="op" id="3649161">&amp;</span><span class="ident" id="3649162"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3649171">==</span>&nbsp;<span class="num" id="3649174">0</span>&nbsp;<span class="op" id="3649176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649181"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span>&nbsp;<span class="op" id="3649187">=</span>&nbsp;<span class="ident" id="3649189"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3649200">(</span><span class="ident" id="3649201"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3649206">,</span>&nbsp;<span class="ident" id="3649208"><a href="/gostd/regexp/syntax/parse.go.html#3648747">lo</a></span><span class="op" id="3649210">,</span>&nbsp;<span class="ident" id="3649212"><a href="/gostd/regexp/syntax/parse.go.html#3648751">hi</a></span><span class="op" id="3649214">)</span><br>
<span class="lineno">1595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649218">}</span>&nbsp;<span class="keyword" id="3649220">else</span>&nbsp;<span class="op" id="3649225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649230"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span>&nbsp;<span class="op" id="3649236">=</span>&nbsp;<span class="ident" id="3649238"><a href="/gostd/regexp/syntax/parse.go.html#3651182">appendFoldedRange</a></span><span class="op" id="3649255">(</span><span class="ident" id="3649256"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3649261">,</span>&nbsp;<span class="ident" id="3649263"><a href="/gostd/regexp/syntax/parse.go.html#3648747">lo</a></span><span class="op" id="3649265">,</span>&nbsp;<span class="ident" id="3649267"><a href="/gostd/regexp/syntax/parse.go.html#3648751">hi</a></span><span class="op" id="3649269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649279"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span>&nbsp;<span class="op" id="3649281">=</span>&nbsp;<span class="ident" id="3649283"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3649284">[</span><span class="num" id="3649285">1</span><span class="op" id="3649286">:</span><span class="op" id="3649287">]</span>&nbsp;<span class="comment" id="3649289">//&nbsp;chop&nbsp;]</span><br>
<span class="lineno">1600</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3649301">//&nbsp;Use&nbsp;&amp;re.Rune&nbsp;instead&nbsp;of&nbsp;&amp;class&nbsp;to&nbsp;avoid&nbsp;allocation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649357"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3649359">.</span><span class="ident" id="3649360"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3649365">=</span>&nbsp;<span class="ident" id="3649367"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649374"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span>&nbsp;<span class="op" id="3649380">=</span>&nbsp;<span class="ident" id="3649382"><a href="/gostd/regexp/syntax/parse.go.html#3649602">cleanClass</a></span><span class="op" id="3649392">(</span><span class="op" id="3649393">&amp;</span><span class="ident" id="3649394"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3649396">.</span><span class="ident" id="3649397"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span><span class="op" id="3649401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649404">if</span>&nbsp;<span class="ident" id="3649407"><a href="/gostd/regexp/syntax/parse.go.html#3647384">sign</a></span>&nbsp;<span class="op" id="3649412">&lt;</span>&nbsp;<span class="num" id="3649414">0</span>&nbsp;<span class="op" id="3649416">{</span><br>
<span class="lineno">1605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649420"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span>&nbsp;<span class="op" id="3649426">=</span>&nbsp;<span class="ident" id="3649428"><a href="/gostd/regexp/syntax/parse.go.html#3654523">negateClass</a></span><span class="op" id="3649439">(</span><span class="ident" id="3649440"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><span class="op" id="3649445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649451"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3649453">.</span><span class="ident" id="3649454"><a href="/gostd/regexp/syntax/regexp.go.html#3667022">Rune</a></span>&nbsp;<span class="op" id="3649459">=</span>&nbsp;<span class="ident" id="3649461"><a href="/gostd/regexp/syntax/parse.go.html#3647636">class</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649468"><a href="/gostd/regexp/syntax/parse.go.html#3647225">p</a></span><span class="op" id="3649469">.</span><span class="ident" id="3649470"><a href="/gostd/regexp/syntax/parse.go.html#3612852">push</a></span><span class="op" id="3649474">(</span><span class="ident" id="3649475"><a href="/gostd/regexp/syntax/parse.go.html#3647307">re</a></span><span class="op" id="3649477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649480">return</span>&nbsp;<span class="ident" id="3649487"><a href="/gostd/regexp/syntax/parse.go.html#3647285">t</a></span><span class="op" id="3649488">,</span>&nbsp;<span class="builtintype" id="3649490">nil</span><br>
<span class="lineno">1610</span><span class="op" id="3649494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3649497">//&nbsp;cleanClass&nbsp;sorts&nbsp;the&nbsp;ranges&nbsp;(pairs&nbsp;of&nbsp;elements&nbsp;of&nbsp;r),</span><br>
<span class="lineno"></span><span class="comment" id="3649554">//&nbsp;merges&nbsp;them,&nbsp;and&nbsp;eliminates&nbsp;duplicates.</span><br>
<span class="lineno"></span><span class="keyword" id="3649597">func</span>&nbsp;<span class="ident" id="3649602">cleanClass</span><span class="op" id="3649612">(</span><span class="ident" id="3649613">rp</span>&nbsp;<span class="op" id="3649616">*</span><span class="op" id="3649617">[</span><span class="op" id="3649618">]</span><span class="builtintype" id="3649619">rune</span><span class="op" id="3649623">)</span>&nbsp;<span class="op" id="3649625">[</span><span class="op" id="3649626">]</span><span class="builtintype" id="3649627">rune</span>&nbsp;<span class="op" id="3649632">{</span><br>
<span class="lineno">1615</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3649636">//&nbsp;Sort&nbsp;by&nbsp;lo&nbsp;increasing,&nbsp;hi&nbsp;decreasing&nbsp;to&nbsp;break&nbsp;ties.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649692"><a href="/gostd/regexp/syntax/parse.go.html#3609630">sort</a></span><span class="op" id="3649696">.</span><span class="ident" id="3649697"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3649701">(</span><span class="ident" id="3649702"><a href="/gostd/regexp/syntax/parse.go.html#3655180">ranges</a></span><span class="op" id="3649708">{</span><span class="ident" id="3649709"><a href="/gostd/regexp/syntax/parse.go.html#3649613">rp</a></span><span class="op" id="3649711">}</span><span class="op" id="3649712">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649716">r</span>&nbsp;<span class="op" id="3649718">:=</span>&nbsp;<span class="op" id="3649721">*</span><span class="ident" id="3649722"><a href="/gostd/regexp/syntax/parse.go.html#3649613">rp</a></span><br>
<span class="lineno">1620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649726">if</span>&nbsp;<span class="builtinfunc" id="3649729">len</span><span class="op" id="3649732">(</span><span class="ident" id="3649733"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649734">)</span>&nbsp;<span class="op" id="3649736">&lt;</span>&nbsp;<span class="num" id="3649738">2</span>&nbsp;<span class="op" id="3649740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649744">return</span>&nbsp;<span class="ident" id="3649751"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3649758">//&nbsp;Merge&nbsp;abutting,&nbsp;overlapping.</span><br>
<span class="lineno">1625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649791">w</span>&nbsp;<span class="op" id="3649793">:=</span>&nbsp;<span class="num" id="3649796">2</span>&nbsp;<span class="comment" id="3649798">//&nbsp;write&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649814">for</span>&nbsp;<span class="ident" id="3649818">i</span>&nbsp;<span class="op" id="3649820">:=</span>&nbsp;<span class="num" id="3649823">2</span><span class="op" id="3649824">;</span>&nbsp;<span class="ident" id="3649826"><a href="/gostd/regexp/syntax/parse.go.html#3649818">i</a></span>&nbsp;<span class="op" id="3649828">&lt;</span>&nbsp;<span class="builtinfunc" id="3649830">len</span><span class="op" id="3649833">(</span><span class="ident" id="3649834"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649835">)</span><span class="op" id="3649836">;</span>&nbsp;<span class="ident" id="3649838"><a href="/gostd/regexp/syntax/parse.go.html#3649818">i</a></span>&nbsp;<span class="op" id="3649840">+=</span>&nbsp;<span class="num" id="3649843">2</span>&nbsp;<span class="op" id="3649845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649849">lo</span><span class="op" id="3649851">,</span>&nbsp;<span class="ident" id="3649853">hi</span>&nbsp;<span class="op" id="3649856">:=</span>&nbsp;<span class="ident" id="3649859"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649860">[</span><span class="ident" id="3649861"><a href="/gostd/regexp/syntax/parse.go.html#3649818">i</a></span><span class="op" id="3649862">]</span><span class="op" id="3649863">,</span>&nbsp;<span class="ident" id="3649865"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649866">[</span><span class="ident" id="3649867"><a href="/gostd/regexp/syntax/parse.go.html#3649818">i</a></span><span class="op" id="3649868">+</span><span class="num" id="3649869">1</span><span class="op" id="3649870">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649874">if</span>&nbsp;<span class="ident" id="3649877"><a href="/gostd/regexp/syntax/parse.go.html#3649849">lo</a></span>&nbsp;<span class="op" id="3649880">&lt;=</span>&nbsp;<span class="ident" id="3649883"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649884">[</span><span class="ident" id="3649885"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3649886">-</span><span class="num" id="3649887">1</span><span class="op" id="3649888">]</span><span class="op" id="3649889">+</span><span class="num" id="3649890">1</span>&nbsp;<span class="op" id="3649892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3649897">//&nbsp;merge&nbsp;with&nbsp;previous&nbsp;range</span><br>
<span class="lineno">1630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649929">if</span>&nbsp;<span class="ident" id="3649932"><a href="/gostd/regexp/syntax/parse.go.html#3649853">hi</a></span>&nbsp;<span class="op" id="3649935">&gt;</span>&nbsp;<span class="ident" id="3649937"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649938">[</span><span class="ident" id="3649939"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3649940">-</span><span class="num" id="3649941">1</span><span class="op" id="3649942">]</span>&nbsp;<span class="op" id="3649944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3649950"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3649951">[</span><span class="ident" id="3649952"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3649953">-</span><span class="num" id="3649954">1</span><span class="op" id="3649955">]</span>&nbsp;<span class="op" id="3649957">=</span>&nbsp;<span class="ident" id="3649959"><a href="/gostd/regexp/syntax/parse.go.html#3649853">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3649970">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3649981">}</span><br>
<span class="lineno">1635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3649985">//&nbsp;new&nbsp;disjoint&nbsp;range</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650009"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3650010">[</span><span class="ident" id="3650011"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3650012">]</span>&nbsp;<span class="op" id="3650014">=</span>&nbsp;<span class="ident" id="3650016"><a href="/gostd/regexp/syntax/parse.go.html#3649849">lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650021"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3650022">[</span><span class="ident" id="3650023"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3650024">+</span><span class="num" id="3650025">1</span><span class="op" id="3650026">]</span>&nbsp;<span class="op" id="3650028">=</span>&nbsp;<span class="ident" id="3650030"><a href="/gostd/regexp/syntax/parse.go.html#3649853">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650035"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span>&nbsp;<span class="op" id="3650037">+=</span>&nbsp;<span class="num" id="3650040">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650043">}</span><br>
<span class="lineno">1640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650047">return</span>&nbsp;<span class="ident" id="3650054"><a href="/gostd/regexp/syntax/parse.go.html#3649716">r</a></span><span class="op" id="3650055">[</span><span class="op" id="3650056">:</span><span class="ident" id="3650057"><a href="/gostd/regexp/syntax/parse.go.html#3649791">w</a></span><span class="op" id="3650058">]</span><br>
<span class="lineno"></span><span class="op" id="3650060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650063">//&nbsp;appendLiteral&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;literal&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno">1645</span><span class="keyword" id="3650142">func</span>&nbsp;<span class="ident" id="3650147">appendLiteral</span><span class="op" id="3650160">(</span><span class="ident" id="3650161">r</span>&nbsp;<span class="op" id="3650163">[</span><span class="op" id="3650164">]</span><span class="builtintype" id="3650165">rune</span><span class="op" id="3650169">,</span>&nbsp;<span class="ident" id="3650171">x</span>&nbsp;<span class="builtintype" id="3650173">rune</span><span class="op" id="3650177">,</span>&nbsp;<span class="ident" id="3650179">flags</span>&nbsp;<span class="ident" id="3650185"><a href="/gostd/regexp/syntax/parse.go.html#3611149">Flags</a></span><span class="op" id="3650190">)</span>&nbsp;<span class="op" id="3650192">[</span><span class="op" id="3650193">]</span><span class="builtintype" id="3650194">rune</span>&nbsp;<span class="op" id="3650199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650202">if</span>&nbsp;<span class="ident" id="3650205"><a href="/gostd/regexp/syntax/parse.go.html#3650179">flags</a></span><span class="op" id="3650210">&amp;</span><span class="ident" id="3650211"><a href="/gostd/regexp/syntax/parse.go.html#3611172">FoldCase</a></span>&nbsp;<span class="op" id="3650220">!=</span>&nbsp;<span class="num" id="3650223">0</span>&nbsp;<span class="op" id="3650225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650229">return</span>&nbsp;<span class="ident" id="3650236"><a href="/gostd/regexp/syntax/parse.go.html#3651182">appendFoldedRange</a></span><span class="op" id="3650253">(</span><span class="ident" id="3650254"><a href="/gostd/regexp/syntax/parse.go.html#3650161">r</a></span><span class="op" id="3650255">,</span>&nbsp;<span class="ident" id="3650257"><a href="/gostd/regexp/syntax/parse.go.html#3650171">x</a></span><span class="op" id="3650258">,</span>&nbsp;<span class="ident" id="3650260"><a href="/gostd/regexp/syntax/parse.go.html#3650171">x</a></span><span class="op" id="3650261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650267">return</span>&nbsp;<span class="ident" id="3650274"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3650285">(</span><span class="ident" id="3650286"><a href="/gostd/regexp/syntax/parse.go.html#3650161">r</a></span><span class="op" id="3650287">,</span>&nbsp;<span class="ident" id="3650289"><a href="/gostd/regexp/syntax/parse.go.html#3650171">x</a></span><span class="op" id="3650290">,</span>&nbsp;<span class="ident" id="3650292"><a href="/gostd/regexp/syntax/parse.go.html#3650171">x</a></span><span class="op" id="3650293">)</span><br>
<span class="lineno">1650</span><span class="op" id="3650295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3650298">//&nbsp;appendRange&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;range&nbsp;lo-hi&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3650377">func</span>&nbsp;<span class="ident" id="3650382">appendRange</span><span class="op" id="3650393">(</span><span class="ident" id="3650394">r</span>&nbsp;<span class="op" id="3650396">[</span><span class="op" id="3650397">]</span><span class="builtintype" id="3650398">rune</span><span class="op" id="3650402">,</span>&nbsp;<span class="ident" id="3650404">lo</span><span class="op" id="3650406">,</span>&nbsp;<span class="ident" id="3650408">hi</span>&nbsp;<span class="builtintype" id="3650411">rune</span><span class="op" id="3650415">)</span>&nbsp;<span class="op" id="3650417">[</span><span class="op" id="3650418">]</span><span class="builtintype" id="3650419">rune</span>&nbsp;<span class="op" id="3650424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650427">//&nbsp;Expand&nbsp;last&nbsp;range&nbsp;or&nbsp;next&nbsp;to&nbsp;last&nbsp;range&nbsp;if&nbsp;it&nbsp;overlaps&nbsp;or&nbsp;abuts.</span><br>
<span class="lineno">1655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650496">//&nbsp;Checking&nbsp;two&nbsp;ranges&nbsp;helps&nbsp;when&nbsp;appending&nbsp;case-folded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650553">//&nbsp;alphabets,&nbsp;so&nbsp;that&nbsp;one&nbsp;range&nbsp;can&nbsp;be&nbsp;expanding&nbsp;A-Z&nbsp;and&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650615">//&nbsp;other&nbsp;expanding&nbsp;a-z.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650640">n</span>&nbsp;<span class="op" id="3650642">:=</span>&nbsp;<span class="builtinfunc" id="3650645">len</span><span class="op" id="3650648">(</span><span class="ident" id="3650649"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650653">for</span>&nbsp;<span class="ident" id="3650657">i</span>&nbsp;<span class="op" id="3650659">:=</span>&nbsp;<span class="num" id="3650662">2</span><span class="op" id="3650663">;</span>&nbsp;<span class="ident" id="3650665"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span>&nbsp;<span class="op" id="3650667">&lt;=</span>&nbsp;<span class="num" id="3650670">4</span><span class="op" id="3650671">;</span>&nbsp;<span class="ident" id="3650673"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span>&nbsp;<span class="op" id="3650675">+=</span>&nbsp;<span class="num" id="3650678">2</span>&nbsp;<span class="op" id="3650680">{</span>&nbsp;<span class="comment" id="3650682">//&nbsp;twice,&nbsp;using&nbsp;i=2,&nbsp;i=4</span><br>
<span class="lineno">1660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650709">if</span>&nbsp;<span class="ident" id="3650712"><a href="/gostd/regexp/syntax/parse.go.html#3650640">n</a></span>&nbsp;<span class="op" id="3650714">&gt;=</span>&nbsp;<span class="ident" id="3650717"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span>&nbsp;<span class="op" id="3650719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650724">rlo</span><span class="op" id="3650727">,</span>&nbsp;<span class="ident" id="3650729">rhi</span>&nbsp;<span class="op" id="3650733">:=</span>&nbsp;<span class="ident" id="3650736"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650737">[</span><span class="ident" id="3650738"><a href="/gostd/regexp/syntax/parse.go.html#3650640">n</a></span><span class="op" id="3650739">-</span><span class="ident" id="3650740"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span><span class="op" id="3650741">]</span><span class="op" id="3650742">,</span>&nbsp;<span class="ident" id="3650744"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650745">[</span><span class="ident" id="3650746"><a href="/gostd/regexp/syntax/parse.go.html#3650640">n</a></span><span class="op" id="3650747">-</span><span class="ident" id="3650748"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span><span class="op" id="3650749">+</span><span class="num" id="3650750">1</span><span class="op" id="3650751">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650756">if</span>&nbsp;<span class="ident" id="3650759"><a href="/gostd/regexp/syntax/parse.go.html#3650404">lo</a></span>&nbsp;<span class="op" id="3650762">&lt;=</span>&nbsp;<span class="ident" id="3650765"><a href="/gostd/regexp/syntax/parse.go.html#3650729">rhi</a></span><span class="op" id="3650768">+</span><span class="num" id="3650769">1</span>&nbsp;<span class="op" id="3650771">&amp;&amp;</span>&nbsp;<span class="ident" id="3650774"><a href="/gostd/regexp/syntax/parse.go.html#3650724">rlo</a></span>&nbsp;<span class="op" id="3650778">&lt;=</span>&nbsp;<span class="ident" id="3650781"><a href="/gostd/regexp/syntax/parse.go.html#3650408">hi</a></span><span class="op" id="3650783">+</span><span class="num" id="3650784">1</span>&nbsp;<span class="op" id="3650786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650792">if</span>&nbsp;<span class="ident" id="3650795"><a href="/gostd/regexp/syntax/parse.go.html#3650404">lo</a></span>&nbsp;<span class="op" id="3650798">&lt;</span>&nbsp;<span class="ident" id="3650800"><a href="/gostd/regexp/syntax/parse.go.html#3650724">rlo</a></span>&nbsp;<span class="op" id="3650804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650811"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650812">[</span><span class="ident" id="3650813"><a href="/gostd/regexp/syntax/parse.go.html#3650640">n</a></span><span class="op" id="3650814">-</span><span class="ident" id="3650815"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span><span class="op" id="3650816">]</span>&nbsp;<span class="op" id="3650818">=</span>&nbsp;<span class="ident" id="3650820"><a href="/gostd/regexp/syntax/parse.go.html#3650404">lo</a></span><br>
<span class="lineno">1665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650833">if</span>&nbsp;<span class="ident" id="3650836"><a href="/gostd/regexp/syntax/parse.go.html#3650408">hi</a></span>&nbsp;<span class="op" id="3650839">&gt;</span>&nbsp;<span class="ident" id="3650841"><a href="/gostd/regexp/syntax/parse.go.html#3650729">rhi</a></span>&nbsp;<span class="op" id="3650845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3650852"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650853">[</span><span class="ident" id="3650854"><a href="/gostd/regexp/syntax/parse.go.html#3650640">n</a></span><span class="op" id="3650855">-</span><span class="ident" id="3650856"><a href="/gostd/regexp/syntax/parse.go.html#3650657">i</a></span><span class="op" id="3650857">+</span><span class="num" id="3650858">1</span><span class="op" id="3650859">]</span>&nbsp;<span class="op" id="3650861">=</span>&nbsp;<span class="ident" id="3650863"><a href="/gostd/regexp/syntax/parse.go.html#3650408">hi</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650870">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650876">return</span>&nbsp;<span class="ident" id="3650883"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><br>
<span class="lineno">1670</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3650895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3650899">return</span>&nbsp;<span class="builtinfunc" id="3650906">append</span><span class="op" id="3650912">(</span><span class="ident" id="3650913"><a href="/gostd/regexp/syntax/parse.go.html#3650394">r</a></span><span class="op" id="3650914">,</span>&nbsp;<span class="ident" id="3650916"><a href="/gostd/regexp/syntax/parse.go.html#3650404">lo</a></span><span class="op" id="3650918">,</span>&nbsp;<span class="ident" id="3650920"><a href="/gostd/regexp/syntax/parse.go.html#3650408">hi</a></span><span class="op" id="3650922">)</span><br>
<span class="lineno">1675</span><span class="op" id="3650924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3650927">const</span>&nbsp;<span class="op" id="3650933">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650936">//&nbsp;minimum&nbsp;and&nbsp;maximum&nbsp;runes&nbsp;involved&nbsp;in&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3650987">//&nbsp;checked&nbsp;during&nbsp;test.</span><br>
<span class="lineno">1680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651012">minFold</span>&nbsp;<span class="op" id="3651020">=</span>&nbsp;<span class="num" id="3651022">0x0041</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651030">maxFold</span>&nbsp;<span class="op" id="3651038">=</span>&nbsp;<span class="num" id="3651040">0x118df</span><br>
<span class="lineno"></span><span class="op" id="3651048">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3651051">//&nbsp;appendFoldedRange&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;range&nbsp;lo-hi</span><br>
<span class="lineno">1685</span><span class="comment" id="3651120">//&nbsp;and&nbsp;its&nbsp;case&nbsp;folding-equivalent&nbsp;runes&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3651177">func</span>&nbsp;<span class="ident" id="3651182">appendFoldedRange</span><span class="op" id="3651199">(</span><span class="ident" id="3651200">r</span>&nbsp;<span class="op" id="3651202">[</span><span class="op" id="3651203">]</span><span class="builtintype" id="3651204">rune</span><span class="op" id="3651208">,</span>&nbsp;<span class="ident" id="3651210">lo</span><span class="op" id="3651212">,</span>&nbsp;<span class="ident" id="3651214">hi</span>&nbsp;<span class="builtintype" id="3651217">rune</span><span class="op" id="3651221">)</span>&nbsp;<span class="op" id="3651223">[</span><span class="op" id="3651224">]</span><span class="builtintype" id="3651225">rune</span>&nbsp;<span class="op" id="3651230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651233">//&nbsp;Optimizations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651252">if</span>&nbsp;<span class="ident" id="3651255"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span>&nbsp;<span class="op" id="3651258">&lt;=</span>&nbsp;<span class="ident" id="3651261"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span>&nbsp;<span class="op" id="3651269">&amp;&amp;</span>&nbsp;<span class="ident" id="3651272"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span>&nbsp;<span class="op" id="3651275">&gt;=</span>&nbsp;<span class="ident" id="3651278"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span>&nbsp;<span class="op" id="3651286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651290">//&nbsp;Range&nbsp;is&nbsp;full:&nbsp;folding&nbsp;can&#39;t&nbsp;add&nbsp;more.</span><br>
<span class="lineno">1690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651334">return</span>&nbsp;<span class="ident" id="3651341"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651352">(</span><span class="ident" id="3651353"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651354">,</span>&nbsp;<span class="ident" id="3651356"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span><span class="op" id="3651358">,</span>&nbsp;<span class="ident" id="3651360"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span><span class="op" id="3651362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651368">if</span>&nbsp;<span class="ident" id="3651371"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span>&nbsp;<span class="op" id="3651374">&lt;</span>&nbsp;<span class="ident" id="3651376"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span>&nbsp;<span class="op" id="3651384">||</span>&nbsp;<span class="ident" id="3651387"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span>&nbsp;<span class="op" id="3651390">&gt;</span>&nbsp;<span class="ident" id="3651392"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span>&nbsp;<span class="op" id="3651400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651404">//&nbsp;Range&nbsp;is&nbsp;outside&nbsp;folding&nbsp;possibilities.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651449">return</span>&nbsp;<span class="ident" id="3651456"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651467">(</span><span class="ident" id="3651468"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651469">,</span>&nbsp;<span class="ident" id="3651471"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span><span class="op" id="3651473">,</span>&nbsp;<span class="ident" id="3651475"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span><span class="op" id="3651477">)</span><br>
<span class="lineno">1695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651483">if</span>&nbsp;<span class="ident" id="3651486"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span>&nbsp;<span class="op" id="3651489">&lt;</span>&nbsp;<span class="ident" id="3651491"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span>&nbsp;<span class="op" id="3651499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651503">//&nbsp;[lo,&nbsp;minFold-1]&nbsp;needs&nbsp;no&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651542"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span>&nbsp;<span class="op" id="3651544">=</span>&nbsp;<span class="ident" id="3651546"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651557">(</span><span class="ident" id="3651558"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651559">,</span>&nbsp;<span class="ident" id="3651561"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span><span class="op" id="3651563">,</span>&nbsp;<span class="ident" id="3651565"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span><span class="op" id="3651572">-</span><span class="num" id="3651573">1</span><span class="op" id="3651574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651578"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span>&nbsp;<span class="op" id="3651581">=</span>&nbsp;<span class="ident" id="3651583"><a href="/gostd/regexp/syntax/parse.go.html#3651012">minFold</a></span><br>
<span class="lineno">1700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651595">if</span>&nbsp;<span class="ident" id="3651598"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span>&nbsp;<span class="op" id="3651601">&gt;</span>&nbsp;<span class="ident" id="3651603"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span>&nbsp;<span class="op" id="3651611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651615">//&nbsp;[maxFold+1,&nbsp;hi]&nbsp;needs&nbsp;no&nbsp;folding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651654"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span>&nbsp;<span class="op" id="3651656">=</span>&nbsp;<span class="ident" id="3651658"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651669">(</span><span class="ident" id="3651670"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651671">,</span>&nbsp;<span class="ident" id="3651673"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span><span class="op" id="3651680">+</span><span class="num" id="3651681">1</span><span class="op" id="3651682">,</span>&nbsp;<span class="ident" id="3651684"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span><span class="op" id="3651686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651690"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span>&nbsp;<span class="op" id="3651693">=</span>&nbsp;<span class="ident" id="3651695"><a href="/gostd/regexp/syntax/parse.go.html#3651030">maxFold</a></span><br>
<span class="lineno">1705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3651708">//&nbsp;Brute&nbsp;force.&nbsp;&nbsp;Depend&nbsp;on&nbsp;appendRange&nbsp;to&nbsp;coalesce&nbsp;ranges&nbsp;on&nbsp;the&nbsp;fly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651779">for</span>&nbsp;<span class="ident" id="3651783">c</span>&nbsp;<span class="op" id="3651785">:=</span>&nbsp;<span class="ident" id="3651788"><a href="/gostd/regexp/syntax/parse.go.html#3651210">lo</a></span><span class="op" id="3651790">;</span>&nbsp;<span class="ident" id="3651792"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span>&nbsp;<span class="op" id="3651794">&lt;=</span>&nbsp;<span class="ident" id="3651797"><a href="/gostd/regexp/syntax/parse.go.html#3651214">hi</a></span><span class="op" id="3651799">;</span>&nbsp;<span class="ident" id="3651801"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span><span class="op" id="3651802">++</span>&nbsp;<span class="op" id="3651805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651809"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span>&nbsp;<span class="op" id="3651811">=</span>&nbsp;<span class="ident" id="3651813"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651824">(</span><span class="ident" id="3651825"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651826">,</span>&nbsp;<span class="ident" id="3651828"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span><span class="op" id="3651829">,</span>&nbsp;<span class="ident" id="3651831"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span><span class="op" id="3651832">)</span><br>
<span class="lineno">1710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651836">f</span>&nbsp;<span class="op" id="3651838">:=</span>&nbsp;<span class="ident" id="3651841"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3651848">.</span><span class="ident" id="3651849"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3651859">(</span><span class="ident" id="3651860"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span><span class="op" id="3651861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651865">for</span>&nbsp;<span class="ident" id="3651869"><a href="/gostd/regexp/syntax/parse.go.html#3651836">f</a></span>&nbsp;<span class="op" id="3651871">!=</span>&nbsp;<span class="ident" id="3651874"><a href="/gostd/regexp/syntax/parse.go.html#3651783">c</a></span>&nbsp;<span class="op" id="3651876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651881"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span>&nbsp;<span class="op" id="3651883">=</span>&nbsp;<span class="ident" id="3651885"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3651896">(</span><span class="ident" id="3651897"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><span class="op" id="3651898">,</span>&nbsp;<span class="ident" id="3651900"><a href="/gostd/regexp/syntax/parse.go.html#3651836">f</a></span><span class="op" id="3651901">,</span>&nbsp;<span class="ident" id="3651903"><a href="/gostd/regexp/syntax/parse.go.html#3651836">f</a></span><span class="op" id="3651904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3651909"><a href="/gostd/regexp/syntax/parse.go.html#3651836">f</a></span>&nbsp;<span class="op" id="3651911">=</span>&nbsp;<span class="ident" id="3651913"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3651920">.</span><span class="ident" id="3651921"><a href="/gostd/unicode/letter.go.html#1830259">SimpleFold</a></span><span class="op" id="3651931">(</span><span class="ident" id="3651932"><a href="/gostd/regexp/syntax/parse.go.html#3651836">f</a></span><span class="op" id="3651933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651937">}</span><br>
<span class="lineno">1715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3651940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3651943">return</span>&nbsp;<span class="ident" id="3651950"><a href="/gostd/regexp/syntax/parse.go.html#3651200">r</a></span><br>
<span class="lineno"></span><span class="op" id="3651952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3651955">//&nbsp;appendClass&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno">1720</span><span class="comment" id="3652030">//&nbsp;It&nbsp;assume&nbsp;x&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="3652055">func</span>&nbsp;<span class="ident" id="3652060">appendClass</span><span class="op" id="3652071">(</span><span class="ident" id="3652072">r</span>&nbsp;<span class="op" id="3652074">[</span><span class="op" id="3652075">]</span><span class="builtintype" id="3652076">rune</span><span class="op" id="3652080">,</span>&nbsp;<span class="ident" id="3652082">x</span>&nbsp;<span class="op" id="3652084">[</span><span class="op" id="3652085">]</span><span class="builtintype" id="3652086">rune</span><span class="op" id="3652090">)</span>&nbsp;<span class="op" id="3652092">[</span><span class="op" id="3652093">]</span><span class="builtintype" id="3652094">rune</span>&nbsp;<span class="op" id="3652099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652102">for</span>&nbsp;<span class="ident" id="3652106">i</span>&nbsp;<span class="op" id="3652108">:=</span>&nbsp;<span class="num" id="3652111">0</span><span class="op" id="3652112">;</span>&nbsp;<span class="ident" id="3652114"><a href="/gostd/regexp/syntax/parse.go.html#3652106">i</a></span>&nbsp;<span class="op" id="3652116">&lt;</span>&nbsp;<span class="builtinfunc" id="3652118">len</span><span class="op" id="3652121">(</span><span class="ident" id="3652122"><a href="/gostd/regexp/syntax/parse.go.html#3652082">x</a></span><span class="op" id="3652123">)</span><span class="op" id="3652124">;</span>&nbsp;<span class="ident" id="3652126"><a href="/gostd/regexp/syntax/parse.go.html#3652106">i</a></span>&nbsp;<span class="op" id="3652128">+=</span>&nbsp;<span class="num" id="3652131">2</span>&nbsp;<span class="op" id="3652133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652137"><a href="/gostd/regexp/syntax/parse.go.html#3652072">r</a></span>&nbsp;<span class="op" id="3652139">=</span>&nbsp;<span class="ident" id="3652141"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3652152">(</span><span class="ident" id="3652153"><a href="/gostd/regexp/syntax/parse.go.html#3652072">r</a></span><span class="op" id="3652154">,</span>&nbsp;<span class="ident" id="3652156"><a href="/gostd/regexp/syntax/parse.go.html#3652082">x</a></span><span class="op" id="3652157">[</span><span class="ident" id="3652158"><a href="/gostd/regexp/syntax/parse.go.html#3652106">i</a></span><span class="op" id="3652159">]</span><span class="op" id="3652160">,</span>&nbsp;<span class="ident" id="3652162"><a href="/gostd/regexp/syntax/parse.go.html#3652082">x</a></span><span class="op" id="3652163">[</span><span class="ident" id="3652164"><a href="/gostd/regexp/syntax/parse.go.html#3652106">i</a></span><span class="op" id="3652165">+</span><span class="num" id="3652166">1</span><span class="op" id="3652167">]</span><span class="op" id="3652168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652171">}</span><br>
<span class="lineno">1725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652174">return</span>&nbsp;<span class="ident" id="3652181"><a href="/gostd/regexp/syntax/parse.go.html#3652072">r</a></span><br>
<span class="lineno"></span><span class="op" id="3652183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3652186">//&nbsp;appendFolded&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;case&nbsp;folding&nbsp;of&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3652282">func</span>&nbsp;<span class="ident" id="3652287">appendFoldedClass</span><span class="op" id="3652304">(</span><span class="ident" id="3652305">r</span>&nbsp;<span class="op" id="3652307">[</span><span class="op" id="3652308">]</span><span class="builtintype" id="3652309">rune</span><span class="op" id="3652313">,</span>&nbsp;<span class="ident" id="3652315">x</span>&nbsp;<span class="op" id="3652317">[</span><span class="op" id="3652318">]</span><span class="builtintype" id="3652319">rune</span><span class="op" id="3652323">)</span>&nbsp;<span class="op" id="3652325">[</span><span class="op" id="3652326">]</span><span class="builtintype" id="3652327">rune</span>&nbsp;<span class="op" id="3652332">{</span><br>
<span class="lineno">1730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652335">for</span>&nbsp;<span class="ident" id="3652339">i</span>&nbsp;<span class="op" id="3652341">:=</span>&nbsp;<span class="num" id="3652344">0</span><span class="op" id="3652345">;</span>&nbsp;<span class="ident" id="3652347"><a href="/gostd/regexp/syntax/parse.go.html#3652339">i</a></span>&nbsp;<span class="op" id="3652349">&lt;</span>&nbsp;<span class="builtinfunc" id="3652351">len</span><span class="op" id="3652354">(</span><span class="ident" id="3652355"><a href="/gostd/regexp/syntax/parse.go.html#3652315">x</a></span><span class="op" id="3652356">)</span><span class="op" id="3652357">;</span>&nbsp;<span class="ident" id="3652359"><a href="/gostd/regexp/syntax/parse.go.html#3652339">i</a></span>&nbsp;<span class="op" id="3652361">+=</span>&nbsp;<span class="num" id="3652364">2</span>&nbsp;<span class="op" id="3652366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652370"><a href="/gostd/regexp/syntax/parse.go.html#3652305">r</a></span>&nbsp;<span class="op" id="3652372">=</span>&nbsp;<span class="ident" id="3652374"><a href="/gostd/regexp/syntax/parse.go.html#3651182">appendFoldedRange</a></span><span class="op" id="3652391">(</span><span class="ident" id="3652392"><a href="/gostd/regexp/syntax/parse.go.html#3652305">r</a></span><span class="op" id="3652393">,</span>&nbsp;<span class="ident" id="3652395"><a href="/gostd/regexp/syntax/parse.go.html#3652315">x</a></span><span class="op" id="3652396">[</span><span class="ident" id="3652397"><a href="/gostd/regexp/syntax/parse.go.html#3652339">i</a></span><span class="op" id="3652398">]</span><span class="op" id="3652399">,</span>&nbsp;<span class="ident" id="3652401"><a href="/gostd/regexp/syntax/parse.go.html#3652315">x</a></span><span class="op" id="3652402">[</span><span class="ident" id="3652403"><a href="/gostd/regexp/syntax/parse.go.html#3652339">i</a></span><span class="op" id="3652404">+</span><span class="num" id="3652405">1</span><span class="op" id="3652406">]</span><span class="op" id="3652407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652413">return</span>&nbsp;<span class="ident" id="3652420"><a href="/gostd/regexp/syntax/parse.go.html#3652305">r</a></span><br>
<span class="lineno"></span><span class="op" id="3652422">}</span><br>
<span class="lineno">1735</span><br>
<span class="lineno"></span><span class="comment" id="3652425">//&nbsp;appendNegatedClass&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;negation&nbsp;of&nbsp;the&nbsp;class&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="3652523">//&nbsp;It&nbsp;assumes&nbsp;x&nbsp;is&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="3652549">func</span>&nbsp;<span class="ident" id="3652554">appendNegatedClass</span><span class="op" id="3652572">(</span><span class="ident" id="3652573">r</span>&nbsp;<span class="op" id="3652575">[</span><span class="op" id="3652576">]</span><span class="builtintype" id="3652577">rune</span><span class="op" id="3652581">,</span>&nbsp;<span class="ident" id="3652583">x</span>&nbsp;<span class="op" id="3652585">[</span><span class="op" id="3652586">]</span><span class="builtintype" id="3652587">rune</span><span class="op" id="3652591">)</span>&nbsp;<span class="op" id="3652593">[</span><span class="op" id="3652594">]</span><span class="builtintype" id="3652595">rune</span>&nbsp;<span class="op" id="3652600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652603">nextLo</span>&nbsp;<span class="op" id="3652610">:=</span>&nbsp;<span class="string" id="3652613">&#39;\u0000&#39;</span><br>
<span class="lineno">1740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652623">for</span>&nbsp;<span class="ident" id="3652627">i</span>&nbsp;<span class="op" id="3652629">:=</span>&nbsp;<span class="num" id="3652632">0</span><span class="op" id="3652633">;</span>&nbsp;<span class="ident" id="3652635"><a href="/gostd/regexp/syntax/parse.go.html#3652627">i</a></span>&nbsp;<span class="op" id="3652637">&lt;</span>&nbsp;<span class="builtinfunc" id="3652639">len</span><span class="op" id="3652642">(</span><span class="ident" id="3652643"><a href="/gostd/regexp/syntax/parse.go.html#3652583">x</a></span><span class="op" id="3652644">)</span><span class="op" id="3652645">;</span>&nbsp;<span class="ident" id="3652647"><a href="/gostd/regexp/syntax/parse.go.html#3652627">i</a></span>&nbsp;<span class="op" id="3652649">+=</span>&nbsp;<span class="num" id="3652652">2</span>&nbsp;<span class="op" id="3652654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652658">lo</span><span class="op" id="3652660">,</span>&nbsp;<span class="ident" id="3652662">hi</span>&nbsp;<span class="op" id="3652665">:=</span>&nbsp;<span class="ident" id="3652668"><a href="/gostd/regexp/syntax/parse.go.html#3652583">x</a></span><span class="op" id="3652669">[</span><span class="ident" id="3652670"><a href="/gostd/regexp/syntax/parse.go.html#3652627">i</a></span><span class="op" id="3652671">]</span><span class="op" id="3652672">,</span>&nbsp;<span class="ident" id="3652674"><a href="/gostd/regexp/syntax/parse.go.html#3652583">x</a></span><span class="op" id="3652675">[</span><span class="ident" id="3652676"><a href="/gostd/regexp/syntax/parse.go.html#3652627">i</a></span><span class="op" id="3652677">+</span><span class="num" id="3652678">1</span><span class="op" id="3652679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652683">if</span>&nbsp;<span class="ident" id="3652686"><a href="/gostd/regexp/syntax/parse.go.html#3652603">nextLo</a></span>&nbsp;<span class="op" id="3652693">&lt;=</span>&nbsp;<span class="ident" id="3652696"><a href="/gostd/regexp/syntax/parse.go.html#3652658">lo</a></span><span class="op" id="3652698">-</span><span class="num" id="3652699">1</span>&nbsp;<span class="op" id="3652701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652706"><a href="/gostd/regexp/syntax/parse.go.html#3652573">r</a></span>&nbsp;<span class="op" id="3652708">=</span>&nbsp;<span class="ident" id="3652710"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3652721">(</span><span class="ident" id="3652722"><a href="/gostd/regexp/syntax/parse.go.html#3652573">r</a></span><span class="op" id="3652723">,</span>&nbsp;<span class="ident" id="3652725"><a href="/gostd/regexp/syntax/parse.go.html#3652603">nextLo</a></span><span class="op" id="3652731">,</span>&nbsp;<span class="ident" id="3652733"><a href="/gostd/regexp/syntax/parse.go.html#3652658">lo</a></span><span class="op" id="3652735">-</span><span class="num" id="3652736">1</span><span class="op" id="3652737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652741">}</span><br>
<span class="lineno">1745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652745"><a href="/gostd/regexp/syntax/parse.go.html#3652603">nextLo</a></span>&nbsp;<span class="op" id="3652752">=</span>&nbsp;<span class="ident" id="3652754"><a href="/gostd/regexp/syntax/parse.go.html#3652662">hi</a></span>&nbsp;<span class="op" id="3652757">+</span>&nbsp;<span class="num" id="3652759">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652765">if</span>&nbsp;<span class="ident" id="3652768"><a href="/gostd/regexp/syntax/parse.go.html#3652603">nextLo</a></span>&nbsp;<span class="op" id="3652775">&lt;=</span>&nbsp;<span class="ident" id="3652778"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3652785">.</span><span class="ident" id="3652786"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3652794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3652798"><a href="/gostd/regexp/syntax/parse.go.html#3652573">r</a></span>&nbsp;<span class="op" id="3652800">=</span>&nbsp;<span class="ident" id="3652802"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3652813">(</span><span class="ident" id="3652814"><a href="/gostd/regexp/syntax/parse.go.html#3652573">r</a></span><span class="op" id="3652815">,</span>&nbsp;<span class="ident" id="3652817"><a href="/gostd/regexp/syntax/parse.go.html#3652603">nextLo</a></span><span class="op" id="3652823">,</span>&nbsp;<span class="ident" id="3652825"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3652832">.</span><span class="ident" id="3652833"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3652840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3652843">}</span><br>
<span class="lineno">1750</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652846">return</span>&nbsp;<span class="ident" id="3652853"><a href="/gostd/regexp/syntax/parse.go.html#3652573">r</a></span><br>
<span class="lineno"></span><span class="op" id="3652855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3652858">//&nbsp;appendTable&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3652923">func</span>&nbsp;<span class="ident" id="3652928">appendTable</span><span class="op" id="3652939">(</span><span class="ident" id="3652940">r</span>&nbsp;<span class="op" id="3652942">[</span><span class="op" id="3652943">]</span><span class="builtintype" id="3652944">rune</span><span class="op" id="3652948">,</span>&nbsp;<span class="ident" id="3652950">x</span>&nbsp;<span class="op" id="3652952">*</span><span class="ident" id="3652953"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3652960">.</span><span class="ident" id="3652961"><a href="/gostd/unicode/letter.go.html#1822132">RangeTable</a></span><span class="op" id="3652971">)</span>&nbsp;<span class="op" id="3652973">[</span><span class="op" id="3652974">]</span><span class="builtintype" id="3652975">rune</span>&nbsp;<span class="op" id="3652980">{</span><br>
<span class="lineno">1755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3652983">for</span>&nbsp;<span class="ident" id="3652987">_</span><span class="op" id="3652988">,</span>&nbsp;<span class="ident" id="3652990">xr</span>&nbsp;<span class="op" id="3652993">:=</span>&nbsp;<span class="keyword" id="3652996">range</span>&nbsp;<span class="ident" id="3653002"><a href="/gostd/regexp/syntax/parse.go.html#3652950">x</a></span><span class="op" id="3653003">.</span><span class="ident" id="3653004"><a href="/gostd/unicode/letter.go.html#1822153">R16</a></span>&nbsp;<span class="op" id="3653008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653012">lo</span><span class="op" id="3653014">,</span>&nbsp;<span class="ident" id="3653016">hi</span><span class="op" id="3653018">,</span>&nbsp;<span class="ident" id="3653020">stride</span>&nbsp;<span class="op" id="3653027">:=</span>&nbsp;<span class="builtintype" id="3653030">rune</span><span class="op" id="3653034">(</span><span class="ident" id="3653035"><a href="/gostd/regexp/syntax/parse.go.html#3652990">xr</a></span><span class="op" id="3653037">.</span><span class="ident" id="3653038"><a href="/gostd/unicode/letter.go.html#1822427">Lo</a></span><span class="op" id="3653040">)</span><span class="op" id="3653041">,</span>&nbsp;<span class="builtintype" id="3653043">rune</span><span class="op" id="3653047">(</span><span class="ident" id="3653048"><a href="/gostd/regexp/syntax/parse.go.html#3652990">xr</a></span><span class="op" id="3653050">.</span><span class="ident" id="3653051"><a href="/gostd/unicode/letter.go.html#1822442">Hi</a></span><span class="op" id="3653053">)</span><span class="op" id="3653054">,</span>&nbsp;<span class="builtintype" id="3653056">rune</span><span class="op" id="3653060">(</span><span class="ident" id="3653061"><a href="/gostd/regexp/syntax/parse.go.html#3652990">xr</a></span><span class="op" id="3653063">.</span><span class="ident" id="3653064"><a href="/gostd/unicode/letter.go.html#1822457">Stride</a></span><span class="op" id="3653070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653074">if</span>&nbsp;<span class="ident" id="3653077"><a href="/gostd/regexp/syntax/parse.go.html#3653020">stride</a></span>&nbsp;<span class="op" id="3653084">==</span>&nbsp;<span class="num" id="3653087">1</span>&nbsp;<span class="op" id="3653089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653094"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span>&nbsp;<span class="op" id="3653096">=</span>&nbsp;<span class="ident" id="3653098"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653109">(</span><span class="ident" id="3653110"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span><span class="op" id="3653111">,</span>&nbsp;<span class="ident" id="3653113"><a href="/gostd/regexp/syntax/parse.go.html#3653012">lo</a></span><span class="op" id="3653115">,</span>&nbsp;<span class="ident" id="3653117"><a href="/gostd/regexp/syntax/parse.go.html#3653016">hi</a></span><span class="op" id="3653119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653124">continue</span><br>
<span class="lineno">1760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653139">for</span>&nbsp;<span class="ident" id="3653143">c</span>&nbsp;<span class="op" id="3653145">:=</span>&nbsp;<span class="ident" id="3653148"><a href="/gostd/regexp/syntax/parse.go.html#3653012">lo</a></span><span class="op" id="3653150">;</span>&nbsp;<span class="ident" id="3653152"><a href="/gostd/regexp/syntax/parse.go.html#3653143">c</a></span>&nbsp;<span class="op" id="3653154">&lt;=</span>&nbsp;<span class="ident" id="3653157"><a href="/gostd/regexp/syntax/parse.go.html#3653016">hi</a></span><span class="op" id="3653159">;</span>&nbsp;<span class="ident" id="3653161"><a href="/gostd/regexp/syntax/parse.go.html#3653143">c</a></span>&nbsp;<span class="op" id="3653163">+=</span>&nbsp;<span class="ident" id="3653166"><a href="/gostd/regexp/syntax/parse.go.html#3653020">stride</a></span>&nbsp;<span class="op" id="3653173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653178"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span>&nbsp;<span class="op" id="3653180">=</span>&nbsp;<span class="ident" id="3653182"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653193">(</span><span class="ident" id="3653194"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span><span class="op" id="3653195">,</span>&nbsp;<span class="ident" id="3653197"><a href="/gostd/regexp/syntax/parse.go.html#3653143">c</a></span><span class="op" id="3653198">,</span>&nbsp;<span class="ident" id="3653200"><a href="/gostd/regexp/syntax/parse.go.html#3653143">c</a></span><span class="op" id="3653201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653205">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653208">}</span><br>
<span class="lineno">1765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653211">for</span>&nbsp;<span class="ident" id="3653215">_</span><span class="op" id="3653216">,</span>&nbsp;<span class="ident" id="3653218">xr</span>&nbsp;<span class="op" id="3653221">:=</span>&nbsp;<span class="keyword" id="3653224">range</span>&nbsp;<span class="ident" id="3653230"><a href="/gostd/regexp/syntax/parse.go.html#3652950">x</a></span><span class="op" id="3653231">.</span><span class="ident" id="3653232"><a href="/gostd/unicode/letter.go.html#1822176">R32</a></span>&nbsp;<span class="op" id="3653236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653240">lo</span><span class="op" id="3653242">,</span>&nbsp;<span class="ident" id="3653244">hi</span><span class="op" id="3653246">,</span>&nbsp;<span class="ident" id="3653248">stride</span>&nbsp;<span class="op" id="3653255">:=</span>&nbsp;<span class="builtintype" id="3653258">rune</span><span class="op" id="3653262">(</span><span class="ident" id="3653263"><a href="/gostd/regexp/syntax/parse.go.html#3653218">xr</a></span><span class="op" id="3653265">.</span><span class="ident" id="3653266"><a href="/gostd/unicode/letter.go.html#1822732">Lo</a></span><span class="op" id="3653268">)</span><span class="op" id="3653269">,</span>&nbsp;<span class="builtintype" id="3653271">rune</span><span class="op" id="3653275">(</span><span class="ident" id="3653276"><a href="/gostd/regexp/syntax/parse.go.html#3653218">xr</a></span><span class="op" id="3653278">.</span><span class="ident" id="3653279"><a href="/gostd/unicode/letter.go.html#1822747">Hi</a></span><span class="op" id="3653281">)</span><span class="op" id="3653282">,</span>&nbsp;<span class="builtintype" id="3653284">rune</span><span class="op" id="3653288">(</span><span class="ident" id="3653289"><a href="/gostd/regexp/syntax/parse.go.html#3653218">xr</a></span><span class="op" id="3653291">.</span><span class="ident" id="3653292"><a href="/gostd/unicode/letter.go.html#1822762">Stride</a></span><span class="op" id="3653298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653302">if</span>&nbsp;<span class="ident" id="3653305"><a href="/gostd/regexp/syntax/parse.go.html#3653248">stride</a></span>&nbsp;<span class="op" id="3653312">==</span>&nbsp;<span class="num" id="3653315">1</span>&nbsp;<span class="op" id="3653317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653322"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span>&nbsp;<span class="op" id="3653324">=</span>&nbsp;<span class="ident" id="3653326"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653337">(</span><span class="ident" id="3653338"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span><span class="op" id="3653339">,</span>&nbsp;<span class="ident" id="3653341"><a href="/gostd/regexp/syntax/parse.go.html#3653240">lo</a></span><span class="op" id="3653343">,</span>&nbsp;<span class="ident" id="3653345"><a href="/gostd/regexp/syntax/parse.go.html#3653244">hi</a></span><span class="op" id="3653347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653352">continue</span><br>
<span class="lineno">1770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653367">for</span>&nbsp;<span class="ident" id="3653371">c</span>&nbsp;<span class="op" id="3653373">:=</span>&nbsp;<span class="ident" id="3653376"><a href="/gostd/regexp/syntax/parse.go.html#3653240">lo</a></span><span class="op" id="3653378">;</span>&nbsp;<span class="ident" id="3653380"><a href="/gostd/regexp/syntax/parse.go.html#3653371">c</a></span>&nbsp;<span class="op" id="3653382">&lt;=</span>&nbsp;<span class="ident" id="3653385"><a href="/gostd/regexp/syntax/parse.go.html#3653244">hi</a></span><span class="op" id="3653387">;</span>&nbsp;<span class="ident" id="3653389"><a href="/gostd/regexp/syntax/parse.go.html#3653371">c</a></span>&nbsp;<span class="op" id="3653391">+=</span>&nbsp;<span class="ident" id="3653394"><a href="/gostd/regexp/syntax/parse.go.html#3653248">stride</a></span>&nbsp;<span class="op" id="3653401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653406"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span>&nbsp;<span class="op" id="3653408">=</span>&nbsp;<span class="ident" id="3653410"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653421">(</span><span class="ident" id="3653422"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span><span class="op" id="3653423">,</span>&nbsp;<span class="ident" id="3653425"><a href="/gostd/regexp/syntax/parse.go.html#3653371">c</a></span><span class="op" id="3653426">,</span>&nbsp;<span class="ident" id="3653428"><a href="/gostd/regexp/syntax/parse.go.html#3653371">c</a></span><span class="op" id="3653429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653436">}</span><br>
<span class="lineno">1775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653439">return</span>&nbsp;<span class="ident" id="3653446"><a href="/gostd/regexp/syntax/parse.go.html#3652940">r</a></span><br>
<span class="lineno"></span><span class="op" id="3653448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3653451">//&nbsp;appendNegatedTable&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;appending&nbsp;the&nbsp;negation&nbsp;of&nbsp;x&nbsp;to&nbsp;the&nbsp;class&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="3653539">func</span>&nbsp;<span class="ident" id="3653544">appendNegatedTable</span><span class="op" id="3653562">(</span><span class="ident" id="3653563">r</span>&nbsp;<span class="op" id="3653565">[</span><span class="op" id="3653566">]</span><span class="builtintype" id="3653567">rune</span><span class="op" id="3653571">,</span>&nbsp;<span class="ident" id="3653573">x</span>&nbsp;<span class="op" id="3653575">*</span><span class="ident" id="3653576"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3653583">.</span><span class="ident" id="3653584"><a href="/gostd/unicode/letter.go.html#1822132">RangeTable</a></span><span class="op" id="3653594">)</span>&nbsp;<span class="op" id="3653596">[</span><span class="op" id="3653597">]</span><span class="builtintype" id="3653598">rune</span>&nbsp;<span class="op" id="3653603">{</span><br>
<span class="lineno">1780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653606">nextLo</span>&nbsp;<span class="op" id="3653613">:=</span>&nbsp;<span class="string" id="3653616">&#39;\u0000&#39;</span>&nbsp;<span class="comment" id="3653625">//&nbsp;lo&nbsp;end&nbsp;of&nbsp;next&nbsp;class&nbsp;to&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653657">for</span>&nbsp;<span class="ident" id="3653661">_</span><span class="op" id="3653662">,</span>&nbsp;<span class="ident" id="3653664">xr</span>&nbsp;<span class="op" id="3653667">:=</span>&nbsp;<span class="keyword" id="3653670">range</span>&nbsp;<span class="ident" id="3653676"><a href="/gostd/regexp/syntax/parse.go.html#3653573">x</a></span><span class="op" id="3653677">.</span><span class="ident" id="3653678"><a href="/gostd/unicode/letter.go.html#1822153">R16</a></span>&nbsp;<span class="op" id="3653682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653686">lo</span><span class="op" id="3653688">,</span>&nbsp;<span class="ident" id="3653690">hi</span><span class="op" id="3653692">,</span>&nbsp;<span class="ident" id="3653694">stride</span>&nbsp;<span class="op" id="3653701">:=</span>&nbsp;<span class="builtintype" id="3653704">rune</span><span class="op" id="3653708">(</span><span class="ident" id="3653709"><a href="/gostd/regexp/syntax/parse.go.html#3653664">xr</a></span><span class="op" id="3653711">.</span><span class="ident" id="3653712"><a href="/gostd/unicode/letter.go.html#1822427">Lo</a></span><span class="op" id="3653714">)</span><span class="op" id="3653715">,</span>&nbsp;<span class="builtintype" id="3653717">rune</span><span class="op" id="3653721">(</span><span class="ident" id="3653722"><a href="/gostd/regexp/syntax/parse.go.html#3653664">xr</a></span><span class="op" id="3653724">.</span><span class="ident" id="3653725"><a href="/gostd/unicode/letter.go.html#1822442">Hi</a></span><span class="op" id="3653727">)</span><span class="op" id="3653728">,</span>&nbsp;<span class="builtintype" id="3653730">rune</span><span class="op" id="3653734">(</span><span class="ident" id="3653735"><a href="/gostd/regexp/syntax/parse.go.html#3653664">xr</a></span><span class="op" id="3653737">.</span><span class="ident" id="3653738"><a href="/gostd/unicode/letter.go.html#1822457">Stride</a></span><span class="op" id="3653744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653748">if</span>&nbsp;<span class="ident" id="3653751"><a href="/gostd/regexp/syntax/parse.go.html#3653694">stride</a></span>&nbsp;<span class="op" id="3653758">==</span>&nbsp;<span class="num" id="3653761">1</span>&nbsp;<span class="op" id="3653763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653768">if</span>&nbsp;<span class="ident" id="3653771"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3653778">&lt;=</span>&nbsp;<span class="ident" id="3653781"><a href="/gostd/regexp/syntax/parse.go.html#3653686">lo</a></span><span class="op" id="3653783">-</span><span class="num" id="3653784">1</span>&nbsp;<span class="op" id="3653786">{</span><br>
<span class="lineno">1785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653792"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span>&nbsp;<span class="op" id="3653794">=</span>&nbsp;<span class="ident" id="3653796"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653807">(</span><span class="ident" id="3653808"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><span class="op" id="3653809">,</span>&nbsp;<span class="ident" id="3653811"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span><span class="op" id="3653817">,</span>&nbsp;<span class="ident" id="3653819"><a href="/gostd/regexp/syntax/parse.go.html#3653686">lo</a></span><span class="op" id="3653821">-</span><span class="num" id="3653822">1</span><span class="op" id="3653823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653833"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3653840">=</span>&nbsp;<span class="ident" id="3653842"><a href="/gostd/regexp/syntax/parse.go.html#3653690">hi</a></span>&nbsp;<span class="op" id="3653845">+</span>&nbsp;<span class="num" id="3653847">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653852">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653863">}</span><br>
<span class="lineno">1790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653867">for</span>&nbsp;<span class="ident" id="3653871">c</span>&nbsp;<span class="op" id="3653873">:=</span>&nbsp;<span class="ident" id="3653876"><a href="/gostd/regexp/syntax/parse.go.html#3653686">lo</a></span><span class="op" id="3653878">;</span>&nbsp;<span class="ident" id="3653880"><a href="/gostd/regexp/syntax/parse.go.html#3653871">c</a></span>&nbsp;<span class="op" id="3653882">&lt;=</span>&nbsp;<span class="ident" id="3653885"><a href="/gostd/regexp/syntax/parse.go.html#3653690">hi</a></span><span class="op" id="3653887">;</span>&nbsp;<span class="ident" id="3653889"><a href="/gostd/regexp/syntax/parse.go.html#3653871">c</a></span>&nbsp;<span class="op" id="3653891">+=</span>&nbsp;<span class="ident" id="3653894"><a href="/gostd/regexp/syntax/parse.go.html#3653694">stride</a></span>&nbsp;<span class="op" id="3653901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653906">if</span>&nbsp;<span class="ident" id="3653909"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3653916">&lt;=</span>&nbsp;<span class="ident" id="3653919"><a href="/gostd/regexp/syntax/parse.go.html#3653871">c</a></span><span class="op" id="3653920">-</span><span class="num" id="3653921">1</span>&nbsp;<span class="op" id="3653923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653929"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span>&nbsp;<span class="op" id="3653931">=</span>&nbsp;<span class="ident" id="3653933"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3653944">(</span><span class="ident" id="3653945"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><span class="op" id="3653946">,</span>&nbsp;<span class="ident" id="3653948"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span><span class="op" id="3653954">,</span>&nbsp;<span class="ident" id="3653956"><a href="/gostd/regexp/syntax/parse.go.html#3653871">c</a></span><span class="op" id="3653957">-</span><span class="num" id="3653958">1</span><span class="op" id="3653959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3653969"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3653976">=</span>&nbsp;<span class="ident" id="3653978"><a href="/gostd/regexp/syntax/parse.go.html#3653871">c</a></span>&nbsp;<span class="op" id="3653980">+</span>&nbsp;<span class="num" id="3653982">1</span><br>
<span class="lineno">1795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653986">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3653989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3653992">for</span>&nbsp;<span class="ident" id="3653996">_</span><span class="op" id="3653997">,</span>&nbsp;<span class="ident" id="3653999">xr</span>&nbsp;<span class="op" id="3654002">:=</span>&nbsp;<span class="keyword" id="3654005">range</span>&nbsp;<span class="ident" id="3654011"><a href="/gostd/regexp/syntax/parse.go.html#3653573">x</a></span><span class="op" id="3654012">.</span><span class="ident" id="3654013"><a href="/gostd/unicode/letter.go.html#1822176">R32</a></span>&nbsp;<span class="op" id="3654017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654021">lo</span><span class="op" id="3654023">,</span>&nbsp;<span class="ident" id="3654025">hi</span><span class="op" id="3654027">,</span>&nbsp;<span class="ident" id="3654029">stride</span>&nbsp;<span class="op" id="3654036">:=</span>&nbsp;<span class="builtintype" id="3654039">rune</span><span class="op" id="3654043">(</span><span class="ident" id="3654044"><a href="/gostd/regexp/syntax/parse.go.html#3653999">xr</a></span><span class="op" id="3654046">.</span><span class="ident" id="3654047"><a href="/gostd/unicode/letter.go.html#1822732">Lo</a></span><span class="op" id="3654049">)</span><span class="op" id="3654050">,</span>&nbsp;<span class="builtintype" id="3654052">rune</span><span class="op" id="3654056">(</span><span class="ident" id="3654057"><a href="/gostd/regexp/syntax/parse.go.html#3653999">xr</a></span><span class="op" id="3654059">.</span><span class="ident" id="3654060"><a href="/gostd/unicode/letter.go.html#1822747">Hi</a></span><span class="op" id="3654062">)</span><span class="op" id="3654063">,</span>&nbsp;<span class="builtintype" id="3654065">rune</span><span class="op" id="3654069">(</span><span class="ident" id="3654070"><a href="/gostd/regexp/syntax/parse.go.html#3653999">xr</a></span><span class="op" id="3654072">.</span><span class="ident" id="3654073"><a href="/gostd/unicode/letter.go.html#1822762">Stride</a></span><span class="op" id="3654079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654083">if</span>&nbsp;<span class="ident" id="3654086"><a href="/gostd/regexp/syntax/parse.go.html#3654029">stride</a></span>&nbsp;<span class="op" id="3654093">==</span>&nbsp;<span class="num" id="3654096">1</span>&nbsp;<span class="op" id="3654098">{</span><br>
<span class="lineno">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654103">if</span>&nbsp;<span class="ident" id="3654106"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3654113">&lt;=</span>&nbsp;<span class="ident" id="3654116"><a href="/gostd/regexp/syntax/parse.go.html#3654021">lo</a></span><span class="op" id="3654118">-</span><span class="num" id="3654119">1</span>&nbsp;<span class="op" id="3654121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654127"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span>&nbsp;<span class="op" id="3654129">=</span>&nbsp;<span class="ident" id="3654131"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3654142">(</span><span class="ident" id="3654143"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><span class="op" id="3654144">,</span>&nbsp;<span class="ident" id="3654146"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span><span class="op" id="3654152">,</span>&nbsp;<span class="ident" id="3654154"><a href="/gostd/regexp/syntax/parse.go.html#3654021">lo</a></span><span class="op" id="3654156">-</span><span class="num" id="3654157">1</span><span class="op" id="3654158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654168"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3654175">=</span>&nbsp;<span class="ident" id="3654177"><a href="/gostd/regexp/syntax/parse.go.html#3654025">hi</a></span>&nbsp;<span class="op" id="3654180">+</span>&nbsp;<span class="num" id="3654182">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654187">continue</span><br>
<span class="lineno">1805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654202">for</span>&nbsp;<span class="ident" id="3654206">c</span>&nbsp;<span class="op" id="3654208">:=</span>&nbsp;<span class="ident" id="3654211"><a href="/gostd/regexp/syntax/parse.go.html#3654021">lo</a></span><span class="op" id="3654213">;</span>&nbsp;<span class="ident" id="3654215"><a href="/gostd/regexp/syntax/parse.go.html#3654206">c</a></span>&nbsp;<span class="op" id="3654217">&lt;=</span>&nbsp;<span class="ident" id="3654220"><a href="/gostd/regexp/syntax/parse.go.html#3654025">hi</a></span><span class="op" id="3654222">;</span>&nbsp;<span class="ident" id="3654224"><a href="/gostd/regexp/syntax/parse.go.html#3654206">c</a></span>&nbsp;<span class="op" id="3654226">+=</span>&nbsp;<span class="ident" id="3654229"><a href="/gostd/regexp/syntax/parse.go.html#3654029">stride</a></span>&nbsp;<span class="op" id="3654236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654241">if</span>&nbsp;<span class="ident" id="3654244"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3654251">&lt;=</span>&nbsp;<span class="ident" id="3654254"><a href="/gostd/regexp/syntax/parse.go.html#3654206">c</a></span><span class="op" id="3654255">-</span><span class="num" id="3654256">1</span>&nbsp;<span class="op" id="3654258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654264"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span>&nbsp;<span class="op" id="3654266">=</span>&nbsp;<span class="ident" id="3654268"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3654279">(</span><span class="ident" id="3654280"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><span class="op" id="3654281">,</span>&nbsp;<span class="ident" id="3654283"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span><span class="op" id="3654289">,</span>&nbsp;<span class="ident" id="3654291"><a href="/gostd/regexp/syntax/parse.go.html#3654206">c</a></span><span class="op" id="3654292">-</span><span class="num" id="3654293">1</span><span class="op" id="3654294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654299">}</span><br>
<span class="lineno">1810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654304"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3654311">=</span>&nbsp;<span class="ident" id="3654313"><a href="/gostd/regexp/syntax/parse.go.html#3654206">c</a></span>&nbsp;<span class="op" id="3654315">+</span>&nbsp;<span class="num" id="3654317">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654327">if</span>&nbsp;<span class="ident" id="3654330"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span>&nbsp;<span class="op" id="3654337">&lt;=</span>&nbsp;<span class="ident" id="3654340"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3654347">.</span><span class="ident" id="3654348"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3654356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654360"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span>&nbsp;<span class="op" id="3654362">=</span>&nbsp;<span class="ident" id="3654364"><a href="/gostd/regexp/syntax/parse.go.html#3650382">appendRange</a></span><span class="op" id="3654375">(</span><span class="ident" id="3654376"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><span class="op" id="3654377">,</span>&nbsp;<span class="ident" id="3654379"><a href="/gostd/regexp/syntax/parse.go.html#3653606">nextLo</a></span><span class="op" id="3654385">,</span>&nbsp;<span class="ident" id="3654387"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3654394">.</span><span class="ident" id="3654395"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3654402">)</span><br>
<span class="lineno">1815</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654408">return</span>&nbsp;<span class="ident" id="3654415"><a href="/gostd/regexp/syntax/parse.go.html#3653563">r</a></span><br>
<span class="lineno"></span><span class="op" id="3654417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3654420">//&nbsp;negateClass&nbsp;overwrites&nbsp;r&nbsp;and&nbsp;returns&nbsp;r&#39;s&nbsp;negation.</span><br>
<span class="lineno">1820</span><span class="comment" id="3654474">//&nbsp;It&nbsp;assumes&nbsp;the&nbsp;class&nbsp;r&nbsp;is&nbsp;already&nbsp;clean.</span><br>
<span class="lineno"></span><span class="keyword" id="3654518">func</span>&nbsp;<span class="ident" id="3654523">negateClass</span><span class="op" id="3654534">(</span><span class="ident" id="3654535">r</span>&nbsp;<span class="op" id="3654537">[</span><span class="op" id="3654538">]</span><span class="builtintype" id="3654539">rune</span><span class="op" id="3654543">)</span>&nbsp;<span class="op" id="3654545">[</span><span class="op" id="3654546">]</span><span class="builtintype" id="3654547">rune</span>&nbsp;<span class="op" id="3654552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654555">nextLo</span>&nbsp;<span class="op" id="3654562">:=</span>&nbsp;<span class="string" id="3654565">&#39;\u0000&#39;</span>&nbsp;<span class="comment" id="3654574">//&nbsp;lo&nbsp;end&nbsp;of&nbsp;next&nbsp;class&nbsp;to&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654606">w</span>&nbsp;<span class="op" id="3654608">:=</span>&nbsp;<span class="num" id="3654611">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3654625">//&nbsp;write&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654641">for</span>&nbsp;<span class="ident" id="3654645">i</span>&nbsp;<span class="op" id="3654647">:=</span>&nbsp;<span class="num" id="3654650">0</span><span class="op" id="3654651">;</span>&nbsp;<span class="ident" id="3654653"><a href="/gostd/regexp/syntax/parse.go.html#3654645">i</a></span>&nbsp;<span class="op" id="3654655">&lt;</span>&nbsp;<span class="builtinfunc" id="3654657">len</span><span class="op" id="3654660">(</span><span class="ident" id="3654661"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654662">)</span><span class="op" id="3654663">;</span>&nbsp;<span class="ident" id="3654665"><a href="/gostd/regexp/syntax/parse.go.html#3654645">i</a></span>&nbsp;<span class="op" id="3654667">+=</span>&nbsp;<span class="num" id="3654670">2</span>&nbsp;<span class="op" id="3654672">{</span><br>
<span class="lineno">1825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654676">lo</span><span class="op" id="3654678">,</span>&nbsp;<span class="ident" id="3654680">hi</span>&nbsp;<span class="op" id="3654683">:=</span>&nbsp;<span class="ident" id="3654686"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654687">[</span><span class="ident" id="3654688"><a href="/gostd/regexp/syntax/parse.go.html#3654645">i</a></span><span class="op" id="3654689">]</span><span class="op" id="3654690">,</span>&nbsp;<span class="ident" id="3654692"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654693">[</span><span class="ident" id="3654694"><a href="/gostd/regexp/syntax/parse.go.html#3654645">i</a></span><span class="op" id="3654695">+</span><span class="num" id="3654696">1</span><span class="op" id="3654697">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654701">if</span>&nbsp;<span class="ident" id="3654704"><a href="/gostd/regexp/syntax/parse.go.html#3654555">nextLo</a></span>&nbsp;<span class="op" id="3654711">&lt;=</span>&nbsp;<span class="ident" id="3654714"><a href="/gostd/regexp/syntax/parse.go.html#3654676">lo</a></span><span class="op" id="3654716">-</span><span class="num" id="3654717">1</span>&nbsp;<span class="op" id="3654719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654724"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654725">[</span><span class="ident" id="3654726"><a href="/gostd/regexp/syntax/parse.go.html#3654606">w</a></span><span class="op" id="3654727">]</span>&nbsp;<span class="op" id="3654729">=</span>&nbsp;<span class="ident" id="3654731"><a href="/gostd/regexp/syntax/parse.go.html#3654555">nextLo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654741"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654742">[</span><span class="ident" id="3654743"><a href="/gostd/regexp/syntax/parse.go.html#3654606">w</a></span><span class="op" id="3654744">+</span><span class="num" id="3654745">1</span><span class="op" id="3654746">]</span>&nbsp;<span class="op" id="3654748">=</span>&nbsp;<span class="ident" id="3654750"><a href="/gostd/regexp/syntax/parse.go.html#3654676">lo</a></span>&nbsp;<span class="op" id="3654753">-</span>&nbsp;<span class="num" id="3654755">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654760"><a href="/gostd/regexp/syntax/parse.go.html#3654606">w</a></span>&nbsp;<span class="op" id="3654762">+=</span>&nbsp;<span class="num" id="3654765">2</span><br>
<span class="lineno">1830</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654773"><a href="/gostd/regexp/syntax/parse.go.html#3654555">nextLo</a></span>&nbsp;<span class="op" id="3654780">=</span>&nbsp;<span class="ident" id="3654782"><a href="/gostd/regexp/syntax/parse.go.html#3654680">hi</a></span>&nbsp;<span class="op" id="3654785">+</span>&nbsp;<span class="num" id="3654787">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654793"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span>&nbsp;<span class="op" id="3654795">=</span>&nbsp;<span class="ident" id="3654797"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654798">[</span><span class="op" id="3654799">:</span><span class="ident" id="3654800"><a href="/gostd/regexp/syntax/parse.go.html#3654606">w</a></span><span class="op" id="3654801">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654804">if</span>&nbsp;<span class="ident" id="3654807"><a href="/gostd/regexp/syntax/parse.go.html#3654555">nextLo</a></span>&nbsp;<span class="op" id="3654814">&lt;=</span>&nbsp;<span class="ident" id="3654817"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3654824">.</span><span class="ident" id="3654825"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span>&nbsp;<span class="op" id="3654833">{</span><br>
<span class="lineno">1835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3654837">//&nbsp;It&#39;s&nbsp;possible&nbsp;for&nbsp;the&nbsp;negation&nbsp;to&nbsp;have&nbsp;one&nbsp;more</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3654890">//&nbsp;range&nbsp;-&nbsp;this&nbsp;one&nbsp;-&nbsp;than&nbsp;the&nbsp;original&nbsp;class,&nbsp;so&nbsp;use&nbsp;append.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3654954"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span>&nbsp;<span class="op" id="3654956">=</span>&nbsp;<span class="builtinfunc" id="3654958">append</span><span class="op" id="3654964">(</span><span class="ident" id="3654965"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><span class="op" id="3654966">,</span>&nbsp;<span class="ident" id="3654968"><a href="/gostd/regexp/syntax/parse.go.html#3654555">nextLo</a></span><span class="op" id="3654974">,</span>&nbsp;<span class="ident" id="3654976"><a href="/gostd/regexp/syntax/parse.go.html#3609649">unicode</a></span><span class="op" id="3654983">.</span><span class="ident" id="3654984"><a href="/gostd/unicode/letter.go.html#1821536">MaxRune</a></span><span class="op" id="3654991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3654994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3654997">return</span>&nbsp;<span class="ident" id="3655004"><a href="/gostd/regexp/syntax/parse.go.html#3654535">r</a></span><br>
<span class="lineno">1840</span><span class="op" id="3655006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3655009">//&nbsp;ranges&nbsp;implements&nbsp;sort.Interface&nbsp;on&nbsp;a&nbsp;[]rune.</span><br>
<span class="lineno"></span><span class="comment" id="3655058">//&nbsp;The&nbsp;choice&nbsp;of&nbsp;receiver&nbsp;type&nbsp;definition&nbsp;is&nbsp;strange</span><br>
<span class="lineno"></span><span class="comment" id="3655111">//&nbsp;but&nbsp;avoids&nbsp;an&nbsp;allocation&nbsp;since&nbsp;we&nbsp;already&nbsp;have</span><br>
<span class="lineno">1845</span><span class="comment" id="3655161">//&nbsp;a&nbsp;*[]rune.</span><br>
<span class="lineno"></span><span class="keyword" id="3655175">type</span>&nbsp;<span class="ident" id="3655180">ranges</span>&nbsp;<span class="keyword" id="3655187">struct</span>&nbsp;<span class="op" id="3655194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655197">p</span>&nbsp;<span class="op" id="3655199">*</span><span class="op" id="3655200">[</span><span class="op" id="3655201">]</span><span class="builtintype" id="3655202">rune</span><br>
<span class="lineno"></span><span class="op" id="3655207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1850</span><span class="keyword" id="3655210">func</span>&nbsp;<span class="op" id="3655215">(</span><span class="ident" id="3655216">ra</span>&nbsp;<span class="ident" id="3655219"><a href="/gostd/regexp/syntax/parse.go.html#3655180">ranges</a></span><span class="op" id="3655225">)</span>&nbsp;<span class="ident" id="3655227">Less</span><span class="op" id="3655231">(</span><span class="ident" id="3655232">i</span><span class="op" id="3655233">,</span>&nbsp;<span class="ident" id="3655235">j</span>&nbsp;<span class="builtintype" id="3655237">int</span><span class="op" id="3655240">)</span>&nbsp;<span class="builtintype" id="3655242">bool</span>&nbsp;<span class="op" id="3655247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655250">p</span>&nbsp;<span class="op" id="3655252">:=</span>&nbsp;<span class="op" id="3655255">*</span><span class="ident" id="3655256"><a href="/gostd/regexp/syntax/parse.go.html#3655216">ra</a></span><span class="op" id="3655258">.</span><span class="ident" id="3655259"><a href="/gostd/regexp/syntax/parse.go.html#3655197">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655262"><a href="/gostd/regexp/syntax/parse.go.html#3655232">i</a></span>&nbsp;<span class="op" id="3655264">*=</span>&nbsp;<span class="num" id="3655267">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655270"><a href="/gostd/regexp/syntax/parse.go.html#3655235">j</a></span>&nbsp;<span class="op" id="3655272">*=</span>&nbsp;<span class="num" id="3655275">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655278">return</span>&nbsp;<span class="ident" id="3655285"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655286">[</span><span class="ident" id="3655287"><a href="/gostd/regexp/syntax/parse.go.html#3655232">i</a></span><span class="op" id="3655288">]</span>&nbsp;<span class="op" id="3655290">&lt;</span>&nbsp;<span class="ident" id="3655292"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655293">[</span><span class="ident" id="3655294"><a href="/gostd/regexp/syntax/parse.go.html#3655235">j</a></span><span class="op" id="3655295">]</span>&nbsp;<span class="op" id="3655297">||</span>&nbsp;<span class="ident" id="3655300"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655301">[</span><span class="ident" id="3655302"><a href="/gostd/regexp/syntax/parse.go.html#3655232">i</a></span><span class="op" id="3655303">]</span>&nbsp;<span class="op" id="3655305">==</span>&nbsp;<span class="ident" id="3655308"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655309">[</span><span class="ident" id="3655310"><a href="/gostd/regexp/syntax/parse.go.html#3655235">j</a></span><span class="op" id="3655311">]</span>&nbsp;<span class="op" id="3655313">&amp;&amp;</span>&nbsp;<span class="ident" id="3655316"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655317">[</span><span class="ident" id="3655318"><a href="/gostd/regexp/syntax/parse.go.html#3655232">i</a></span><span class="op" id="3655319">+</span><span class="num" id="3655320">1</span><span class="op" id="3655321">]</span>&nbsp;<span class="op" id="3655323">&gt;</span>&nbsp;<span class="ident" id="3655325"><a href="/gostd/regexp/syntax/parse.go.html#3655250">p</a></span><span class="op" id="3655326">[</span><span class="ident" id="3655327"><a href="/gostd/regexp/syntax/parse.go.html#3655235">j</a></span><span class="op" id="3655328">+</span><span class="num" id="3655329">1</span><span class="op" id="3655330">]</span><br>
<span class="lineno">1855</span><span class="op" id="3655332">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655335">func</span>&nbsp;<span class="op" id="3655340">(</span><span class="ident" id="3655341">ra</span>&nbsp;<span class="ident" id="3655344"><a href="/gostd/regexp/syntax/parse.go.html#3655180">ranges</a></span><span class="op" id="3655350">)</span>&nbsp;<span class="ident" id="3655352">Len</span><span class="op" id="3655355">(</span><span class="op" id="3655356">)</span>&nbsp;<span class="builtintype" id="3655358">int</span>&nbsp;<span class="op" id="3655362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655365">return</span>&nbsp;<span class="builtinfunc" id="3655372">len</span><span class="op" id="3655375">(</span><span class="op" id="3655376">*</span><span class="ident" id="3655377"><a href="/gostd/regexp/syntax/parse.go.html#3655341">ra</a></span><span class="op" id="3655379">.</span><span class="ident" id="3655380"><a href="/gostd/regexp/syntax/parse.go.html#3655197">p</a></span><span class="op" id="3655381">)</span>&nbsp;<span class="op" id="3655383">/</span>&nbsp;<span class="num" id="3655385">2</span><br>
<span class="lineno"></span><span class="op" id="3655387">}</span><br>
<span class="lineno">1860</span><br>
<span class="lineno"></span><span class="keyword" id="3655390">func</span>&nbsp;<span class="op" id="3655395">(</span><span class="ident" id="3655396">ra</span>&nbsp;<span class="ident" id="3655399"><a href="/gostd/regexp/syntax/parse.go.html#3655180">ranges</a></span><span class="op" id="3655405">)</span>&nbsp;<span class="ident" id="3655407">Swap</span><span class="op" id="3655411">(</span><span class="ident" id="3655412">i</span><span class="op" id="3655413">,</span>&nbsp;<span class="ident" id="3655415">j</span>&nbsp;<span class="builtintype" id="3655417">int</span><span class="op" id="3655420">)</span>&nbsp;<span class="op" id="3655422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655425">p</span>&nbsp;<span class="op" id="3655427">:=</span>&nbsp;<span class="op" id="3655430">*</span><span class="ident" id="3655431"><a href="/gostd/regexp/syntax/parse.go.html#3655396">ra</a></span><span class="op" id="3655433">.</span><span class="ident" id="3655434"><a href="/gostd/regexp/syntax/parse.go.html#3655197">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655437"><a href="/gostd/regexp/syntax/parse.go.html#3655412">i</a></span>&nbsp;<span class="op" id="3655439">*=</span>&nbsp;<span class="num" id="3655442">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655445"><a href="/gostd/regexp/syntax/parse.go.html#3655415">j</a></span>&nbsp;<span class="op" id="3655447">*=</span>&nbsp;<span class="num" id="3655450">2</span><br>
<span class="lineno">1865</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655453"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655454">[</span><span class="ident" id="3655455"><a href="/gostd/regexp/syntax/parse.go.html#3655412">i</a></span><span class="op" id="3655456">]</span><span class="op" id="3655457">,</span>&nbsp;<span class="ident" id="3655459"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655460">[</span><span class="ident" id="3655461"><a href="/gostd/regexp/syntax/parse.go.html#3655412">i</a></span><span class="op" id="3655462">+</span><span class="num" id="3655463">1</span><span class="op" id="3655464">]</span><span class="op" id="3655465">,</span>&nbsp;<span class="ident" id="3655467"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655468">[</span><span class="ident" id="3655469"><a href="/gostd/regexp/syntax/parse.go.html#3655415">j</a></span><span class="op" id="3655470">]</span><span class="op" id="3655471">,</span>&nbsp;<span class="ident" id="3655473"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655474">[</span><span class="ident" id="3655475"><a href="/gostd/regexp/syntax/parse.go.html#3655415">j</a></span><span class="op" id="3655476">+</span><span class="num" id="3655477">1</span><span class="op" id="3655478">]</span>&nbsp;<span class="op" id="3655480">=</span>&nbsp;<span class="ident" id="3655482"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655483">[</span><span class="ident" id="3655484"><a href="/gostd/regexp/syntax/parse.go.html#3655415">j</a></span><span class="op" id="3655485">]</span><span class="op" id="3655486">,</span>&nbsp;<span class="ident" id="3655488"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655489">[</span><span class="ident" id="3655490"><a href="/gostd/regexp/syntax/parse.go.html#3655415">j</a></span><span class="op" id="3655491">+</span><span class="num" id="3655492">1</span><span class="op" id="3655493">]</span><span class="op" id="3655494">,</span>&nbsp;<span class="ident" id="3655496"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655497">[</span><span class="ident" id="3655498"><a href="/gostd/regexp/syntax/parse.go.html#3655412">i</a></span><span class="op" id="3655499">]</span><span class="op" id="3655500">,</span>&nbsp;<span class="ident" id="3655502"><a href="/gostd/regexp/syntax/parse.go.html#3655425">p</a></span><span class="op" id="3655503">[</span><span class="ident" id="3655504"><a href="/gostd/regexp/syntax/parse.go.html#3655412">i</a></span><span class="op" id="3655505">+</span><span class="num" id="3655506">1</span><span class="op" id="3655507">]</span><br>
<span class="lineno"></span><span class="op" id="3655509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655512">func</span>&nbsp;<span class="ident" id="3655517">checkUTF8</span><span class="op" id="3655526">(</span><span class="ident" id="3655527">s</span>&nbsp;<span class="builtintype" id="3655529">string</span><span class="op" id="3655535">)</span>&nbsp;<span class="builtintype" id="3655537">error</span>&nbsp;<span class="op" id="3655543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655546">for</span>&nbsp;<span class="ident" id="3655550"><a href="/gostd/regexp/syntax/parse.go.html#3655527">s</a></span>&nbsp;<span class="op" id="3655552">!=</span>&nbsp;<span class="string" id="3655555">&#34;&#34;</span>&nbsp;<span class="op" id="3655558">{</span><br>
<span class="lineno">1870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3655562">rune</span><span class="op" id="3655566">,</span>&nbsp;<span class="ident" id="3655568">size</span>&nbsp;<span class="op" id="3655573">:=</span>&nbsp;<span class="ident" id="3655576"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3655580">.</span><span class="ident" id="3655581"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="3655599">(</span><span class="ident" id="3655600"><a href="/gostd/regexp/syntax/parse.go.html#3655527">s</a></span><span class="op" id="3655601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655605">if</span>&nbsp;<span class="builtintype" id="3655608"><a href="/gostd/regexp/syntax/parse.go.html#3655562">rune</a></span>&nbsp;<span class="op" id="3655613">==</span>&nbsp;<span class="ident" id="3655616"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3655620">.</span><span class="ident" id="3655621"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="3655631">&amp;&amp;</span>&nbsp;<span class="ident" id="3655634"><a href="/gostd/regexp/syntax/parse.go.html#3655568">size</a></span>&nbsp;<span class="op" id="3655639">==</span>&nbsp;<span class="num" id="3655642">1</span>&nbsp;<span class="op" id="3655644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655649">return</span>&nbsp;<span class="op" id="3655656">&amp;</span><span class="ident" id="3655657"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3655662">{</span><span class="ident" id="3655663"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3655667">:</span>&nbsp;<span class="ident" id="3655669"><a href="/gostd/regexp/syntax/parse.go.html#3610612">ErrInvalidUTF8</a></span><span class="op" id="3655683">,</span>&nbsp;<span class="ident" id="3655685"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span><span class="op" id="3655689">:</span>&nbsp;<span class="ident" id="3655691"><a href="/gostd/regexp/syntax/parse.go.html#3655527">s</a></span><span class="op" id="3655692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655700"><a href="/gostd/regexp/syntax/parse.go.html#3655527">s</a></span>&nbsp;<span class="op" id="3655702">=</span>&nbsp;<span class="ident" id="3655704"><a href="/gostd/regexp/syntax/parse.go.html#3655527">s</a></span><span class="op" id="3655705">[</span><span class="ident" id="3655706"><a href="/gostd/regexp/syntax/parse.go.html#3655568">size</a></span><span class="op" id="3655710">:</span><span class="op" id="3655711">]</span><br>
<span class="lineno">1875</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655717">return</span>&nbsp;<span class="builtintype" id="3655724">nil</span><br>
<span class="lineno"></span><span class="op" id="3655728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655731">func</span>&nbsp;<span class="ident" id="3655736">nextRune</span><span class="op" id="3655744">(</span><span class="ident" id="3655745">s</span>&nbsp;<span class="builtintype" id="3655747">string</span><span class="op" id="3655753">)</span>&nbsp;<span class="op" id="3655755">(</span><span class="ident" id="3655756">c</span>&nbsp;<span class="builtintype" id="3655758">rune</span><span class="op" id="3655762">,</span>&nbsp;<span class="ident" id="3655764">t</span>&nbsp;<span class="builtintype" id="3655766">string</span><span class="op" id="3655772">,</span>&nbsp;<span class="ident" id="3655774">err</span>&nbsp;<span class="builtintype" id="3655778">error</span><span class="op" id="3655783">)</span>&nbsp;<span class="op" id="3655785">{</span><br>
<span class="lineno">1880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3655788"><a href="/gostd/regexp/syntax/parse.go.html#3655756">c</a></span><span class="op" id="3655789">,</span>&nbsp;<span class="ident" id="3655791">size</span>&nbsp;<span class="op" id="3655796">:=</span>&nbsp;<span class="ident" id="3655799"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3655803">.</span><span class="ident" id="3655804"><a href="/gostd/unicode/utf8/utf8.go.html#1810428">DecodeRuneInString</a></span><span class="op" id="3655822">(</span><span class="ident" id="3655823"><a href="/gostd/regexp/syntax/parse.go.html#3655745">s</a></span><span class="op" id="3655824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655827">if</span>&nbsp;<span class="ident" id="3655830"><a href="/gostd/regexp/syntax/parse.go.html#3655756">c</a></span>&nbsp;<span class="op" id="3655832">==</span>&nbsp;<span class="ident" id="3655835"><a href="/gostd/regexp/syntax/parse.go.html#3609660">utf8</a></span><span class="op" id="3655839">.</span><span class="ident" id="3655840"><a href="/gostd/unicode/utf8/utf8.go.html#1805370">RuneError</a></span>&nbsp;<span class="op" id="3655850">&amp;&amp;</span>&nbsp;<span class="ident" id="3655853"><a href="/gostd/regexp/syntax/parse.go.html#3655791">size</a></span>&nbsp;<span class="op" id="3655858">==</span>&nbsp;<span class="num" id="3655861">1</span>&nbsp;<span class="op" id="3655863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655867">return</span>&nbsp;<span class="num" id="3655874">0</span><span class="op" id="3655875">,</span>&nbsp;<span class="string" id="3655877">&#34;&#34;</span><span class="op" id="3655879">,</span>&nbsp;<span class="op" id="3655881">&amp;</span><span class="ident" id="3655882"><a href="/gostd/regexp/syntax/parse.go.html#3609784">Error</a></span><span class="op" id="3655887">{</span><span class="ident" id="3655888"><a href="/gostd/regexp/syntax/parse.go.html#3609800">Code</a></span><span class="op" id="3655892">:</span>&nbsp;<span class="ident" id="3655894"><a href="/gostd/regexp/syntax/parse.go.html#3610612">ErrInvalidUTF8</a></span><span class="op" id="3655908">,</span>&nbsp;<span class="ident" id="3655910"><a href="/gostd/regexp/syntax/parse.go.html#3609816">Expr</a></span><span class="op" id="3655914">:</span>&nbsp;<span class="ident" id="3655916"><a href="/gostd/regexp/syntax/parse.go.html#3655745">s</a></span><span class="op" id="3655917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3655920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655923">return</span>&nbsp;<span class="ident" id="3655930"><a href="/gostd/regexp/syntax/parse.go.html#3655756">c</a></span><span class="op" id="3655931">,</span>&nbsp;<span class="ident" id="3655933"><a href="/gostd/regexp/syntax/parse.go.html#3655745">s</a></span><span class="op" id="3655934">[</span><span class="ident" id="3655935"><a href="/gostd/regexp/syntax/parse.go.html#3655791">size</a></span><span class="op" id="3655939">:</span><span class="op" id="3655940">]</span><span class="op" id="3655941">,</span>&nbsp;<span class="builtintype" id="3655943">nil</span><br>
<span class="lineno">1885</span><span class="op" id="3655947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3655950">func</span>&nbsp;<span class="ident" id="3655955">isalnum</span><span class="op" id="3655962">(</span><span class="ident" id="3655963">c</span>&nbsp;<span class="builtintype" id="3655965">rune</span><span class="op" id="3655969">)</span>&nbsp;<span class="builtintype" id="3655971">bool</span>&nbsp;<span class="op" id="3655976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3655979">return</span>&nbsp;<span class="string" id="3655986">&#39;0&#39;</span>&nbsp;<span class="op" id="3655990">&lt;=</span>&nbsp;<span class="ident" id="3655993"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3655995">&amp;&amp;</span>&nbsp;<span class="ident" id="3655998"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3656000">&lt;=</span>&nbsp;<span class="string" id="3656003">&#39;9&#39;</span>&nbsp;<span class="op" id="3656007">||</span>&nbsp;<span class="string" id="3656010">&#39;A&#39;</span>&nbsp;<span class="op" id="3656014">&lt;=</span>&nbsp;<span class="ident" id="3656017"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3656019">&amp;&amp;</span>&nbsp;<span class="ident" id="3656022"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3656024">&lt;=</span>&nbsp;<span class="string" id="3656027">&#39;Z&#39;</span>&nbsp;<span class="op" id="3656031">||</span>&nbsp;<span class="string" id="3656034">&#39;a&#39;</span>&nbsp;<span class="op" id="3656038">&lt;=</span>&nbsp;<span class="ident" id="3656041"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3656043">&amp;&amp;</span>&nbsp;<span class="ident" id="3656046"><a href="/gostd/regexp/syntax/parse.go.html#3655963">c</a></span>&nbsp;<span class="op" id="3656048">&lt;=</span>&nbsp;<span class="string" id="3656051">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="3656055">}</span><br>
<span class="lineno">1890</span><br>
<span class="lineno"></span><span class="keyword" id="3656058">func</span>&nbsp;<span class="ident" id="3656063">unhex</span><span class="op" id="3656068">(</span><span class="ident" id="3656069">c</span>&nbsp;<span class="builtintype" id="3656071">rune</span><span class="op" id="3656075">)</span>&nbsp;<span class="builtintype" id="3656077">rune</span>&nbsp;<span class="op" id="3656082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656085">if</span>&nbsp;<span class="string" id="3656088">&#39;0&#39;</span>&nbsp;<span class="op" id="3656092">&lt;=</span>&nbsp;<span class="ident" id="3656095"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656097">&amp;&amp;</span>&nbsp;<span class="ident" id="3656100"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656102">&lt;=</span>&nbsp;<span class="string" id="3656105">&#39;9&#39;</span>&nbsp;<span class="op" id="3656109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656113">return</span>&nbsp;<span class="ident" id="3656120"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656122">-</span>&nbsp;<span class="string" id="3656124">&#39;0&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656129">}</span><br>
<span class="lineno">1895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656132">if</span>&nbsp;<span class="string" id="3656135">&#39;a&#39;</span>&nbsp;<span class="op" id="3656139">&lt;=</span>&nbsp;<span class="ident" id="3656142"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656144">&amp;&amp;</span>&nbsp;<span class="ident" id="3656147"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656149">&lt;=</span>&nbsp;<span class="string" id="3656152">&#39;f&#39;</span>&nbsp;<span class="op" id="3656156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656160">return</span>&nbsp;<span class="ident" id="3656167"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656169">-</span>&nbsp;<span class="string" id="3656171">&#39;a&#39;</span>&nbsp;<span class="op" id="3656175">+</span>&nbsp;<span class="num" id="3656177">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656184">if</span>&nbsp;<span class="string" id="3656187">&#39;A&#39;</span>&nbsp;<span class="op" id="3656191">&lt;=</span>&nbsp;<span class="ident" id="3656194"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656196">&amp;&amp;</span>&nbsp;<span class="ident" id="3656199"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656201">&lt;=</span>&nbsp;<span class="string" id="3656204">&#39;F&#39;</span>&nbsp;<span class="op" id="3656208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656212">return</span>&nbsp;<span class="ident" id="3656219"><a href="/gostd/regexp/syntax/parse.go.html#3656069">c</a></span>&nbsp;<span class="op" id="3656221">-</span>&nbsp;<span class="string" id="3656223">&#39;A&#39;</span>&nbsp;<span class="op" id="3656227">+</span>&nbsp;<span class="num" id="3656229">10</span><br>
<span class="lineno">1900</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3656233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3656236">return</span>&nbsp;<span class="op" id="3656243">-</span><span class="num" id="3656244">1</span><br>
<span class="lineno"></span><span class="op" id="3656246">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
