<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5153644">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5153699">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5153753">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5153804">//&nbsp;Extract&nbsp;example&nbsp;functions&nbsp;from&nbsp;file&nbsp;ASTs.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153850">package</span>&nbsp;<span class="ident" id="5153858">doc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5153863">import</span>&nbsp;<span class="op" id="5153870">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153873">&#34;go/ast&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153883">&#34;go/token&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153895">&#34;path&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153903">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153913">&#34;sort&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153921">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153932">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153943">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5153954">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5153969">)</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5153972">//&nbsp;An&nbsp;Example&nbsp;represents&nbsp;an&nbsp;example&nbsp;function&nbsp;found&nbsp;in&nbsp;a&nbsp;source&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5154042">type</span>&nbsp;<span class="ident" id="5154047">Example</span>&nbsp;<span class="keyword" id="5154055">struct</span>&nbsp;<span class="op" id="5154062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154065">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5154077">string</span>&nbsp;<span class="comment" id="5154084">//&nbsp;name&nbsp;of&nbsp;the&nbsp;item&nbsp;being&nbsp;exemplified</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154123">Doc</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5154135">string</span>&nbsp;<span class="comment" id="5154142">//&nbsp;example&nbsp;function&nbsp;doc&nbsp;string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154174">Code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5154186">ast</span><span class="op" id="5154189">.</span><span class="ident" id="5154190">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154196">Play</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154208">*</span><span class="ident" id="5154209">ast</span><span class="op" id="5154212">.</span><span class="ident" id="5154213">File</span>&nbsp;<span class="comment" id="5154218">//&nbsp;a&nbsp;whole&nbsp;program&nbsp;version&nbsp;of&nbsp;the&nbsp;example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154261">Comments</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5154273">[</span><span class="op" id="5154274">]</span><span class="op" id="5154275">*</span><span class="ident" id="5154276">ast</span><span class="op" id="5154279">.</span><span class="ident" id="5154280">CommentGroup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154294">Output</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5154306">string</span>&nbsp;<span class="comment" id="5154313">//&nbsp;expected&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154333">EmptyOutput</span>&nbsp;<span class="builtintype" id="5154345">bool</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5154352">//&nbsp;expect&nbsp;empty&nbsp;output</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154376">Order</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5154388">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5154395">//&nbsp;original&nbsp;source&nbsp;code&nbsp;order</span><br>
<span class="lineno"></span><span class="op" id="5154425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5154428">//&nbsp;Examples&nbsp;returns&nbsp;the&nbsp;examples&nbsp;found&nbsp;in&nbsp;the&nbsp;files,&nbsp;sorted&nbsp;by&nbsp;Name&nbsp;field.</span><br>
<span class="lineno"></span><span class="comment" id="5154503">//&nbsp;The&nbsp;Order&nbsp;fields&nbsp;record&nbsp;the&nbsp;order&nbsp;in&nbsp;which&nbsp;the&nbsp;examples&nbsp;were&nbsp;encountered.</span><br>
<span class="lineno">35</span><span class="comment" id="5154580">//</span><br>
<span class="lineno"></span><span class="comment" id="5154583">//&nbsp;Playable&nbsp;Examples&nbsp;must&nbsp;be&nbsp;in&nbsp;a&nbsp;package&nbsp;whose&nbsp;name&nbsp;ends&nbsp;in&nbsp;&#34;_test&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="5154653">//&nbsp;An&nbsp;Example&nbsp;is&nbsp;&#34;playable&#34;&nbsp;(the&nbsp;Play&nbsp;field&nbsp;is&nbsp;non-nil)&nbsp;in&nbsp;either&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="5154728">//&nbsp;circumstances:</span><br>
<span class="lineno"></span><span class="comment" id="5154746">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;example&nbsp;function&nbsp;is&nbsp;self-contained:&nbsp;the&nbsp;function&nbsp;references&nbsp;only</span><br>
<span class="lineno">40</span><span class="comment" id="5154822">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;identifiers&nbsp;from&nbsp;other&nbsp;packages&nbsp;(or&nbsp;predeclared&nbsp;identifiers,&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="5154898">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;int&#34;)&nbsp;and&nbsp;the&nbsp;test&nbsp;file&nbsp;does&nbsp;not&nbsp;include&nbsp;a&nbsp;dot&nbsp;import.</span><br>
<span class="lineno"></span><span class="comment" id="5154961">//&nbsp;&nbsp;&nbsp;-&nbsp;The&nbsp;entire&nbsp;test&nbsp;file&nbsp;is&nbsp;the&nbsp;example:&nbsp;the&nbsp;file&nbsp;contains&nbsp;exactly&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5155035">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;example&nbsp;function,&nbsp;zero&nbsp;test&nbsp;or&nbsp;benchmark&nbsp;functions,&nbsp;and&nbsp;at&nbsp;least&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="5155111">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;top-level&nbsp;function,&nbsp;type,&nbsp;variable,&nbsp;or&nbsp;constant&nbsp;declaration&nbsp;other</span><br>
<span class="lineno">45</span><span class="comment" id="5155184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&nbsp;the&nbsp;example&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="5155218">func</span>&nbsp;<span class="ident" id="5155223">Examples</span><span class="op" id="5155231">(</span><span class="ident" id="5155232">files</span>&nbsp;<span class="op" id="5155238">...</span><span class="op" id="5155241">*</span><span class="ident" id="5155242">ast</span><span class="op" id="5155245">.</span><span class="ident" id="5155246">File</span><span class="op" id="5155250">)</span>&nbsp;<span class="op" id="5155252">[</span><span class="op" id="5155253">]</span><span class="op" id="5155254">*</span><span class="ident" id="5155255">Example</span>&nbsp;<span class="op" id="5155263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155266">var</span>&nbsp;<span class="ident" id="5155270">list</span>&nbsp;<span class="op" id="5155275">[</span><span class="op" id="5155276">]</span><span class="op" id="5155277">*</span><span class="ident" id="5155278">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155287">for</span>&nbsp;<span class="ident" id="5155291">_</span><span class="op" id="5155292">,</span>&nbsp;<span class="ident" id="5155294">file</span>&nbsp;<span class="op" id="5155299">:=</span>&nbsp;<span class="keyword" id="5155302">range</span>&nbsp;<span class="ident" id="5155308">files</span>&nbsp;<span class="op" id="5155314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155318">hasTests</span>&nbsp;<span class="op" id="5155327">:=</span>&nbsp;<span class="builtintype" id="5155330">false</span>&nbsp;<span class="comment" id="5155336">//&nbsp;file&nbsp;contains&nbsp;tests&nbsp;or&nbsp;benchmarks</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155375">numDecl</span>&nbsp;<span class="op" id="5155383">:=</span>&nbsp;<span class="num" id="5155386">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5155393">//&nbsp;number&nbsp;of&nbsp;non-import&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155444">var</span>&nbsp;<span class="ident" id="5155448">flist</span>&nbsp;<span class="op" id="5155454">[</span><span class="op" id="5155455">]</span><span class="op" id="5155456">*</span><span class="ident" id="5155457">Example</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155467">for</span>&nbsp;<span class="ident" id="5155471">_</span><span class="op" id="5155472">,</span>&nbsp;<span class="ident" id="5155474">decl</span>&nbsp;<span class="op" id="5155479">:=</span>&nbsp;<span class="keyword" id="5155482">range</span>&nbsp;<span class="ident" id="5155488">file</span><span class="op" id="5155492">.</span><span class="ident" id="5155493">Decls</span>&nbsp;<span class="op" id="5155499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155504">if</span>&nbsp;<span class="ident" id="5155507">g</span><span class="op" id="5155508">,</span>&nbsp;<span class="ident" id="5155510">ok</span>&nbsp;<span class="op" id="5155513">:=</span>&nbsp;<span class="ident" id="5155516">decl</span><span class="op" id="5155520">.</span><span class="op" id="5155521">(</span><span class="op" id="5155522">*</span><span class="ident" id="5155523">ast</span><span class="op" id="5155526">.</span><span class="ident" id="5155527">GenDecl</span><span class="op" id="5155534">)</span><span class="op" id="5155535">;</span>&nbsp;<span class="ident" id="5155537">ok</span>&nbsp;<span class="op" id="5155540">&amp;&amp;</span>&nbsp;<span class="ident" id="5155543">g</span><span class="op" id="5155544">.</span><span class="ident" id="5155545">Tok</span>&nbsp;<span class="op" id="5155549">!=</span>&nbsp;<span class="ident" id="5155552">token</span><span class="op" id="5155557">.</span><span class="ident" id="5155558">IMPORT</span>&nbsp;<span class="op" id="5155565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155571">numDecl</span><span class="op" id="5155578">++</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155585">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155602">f</span><span class="op" id="5155603">,</span>&nbsp;<span class="ident" id="5155605">ok</span>&nbsp;<span class="op" id="5155608">:=</span>&nbsp;<span class="ident" id="5155611">decl</span><span class="op" id="5155615">.</span><span class="op" id="5155616">(</span><span class="op" id="5155617">*</span><span class="ident" id="5155618">ast</span><span class="op" id="5155621">.</span><span class="ident" id="5155622">FuncDecl</span><span class="op" id="5155630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155635">if</span>&nbsp;<span class="op" id="5155638">!</span><span class="ident" id="5155639">ok</span>&nbsp;<span class="op" id="5155642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155648">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155665">numDecl</span><span class="op" id="5155672">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155678">name</span>&nbsp;<span class="op" id="5155683">:=</span>&nbsp;<span class="ident" id="5155686">f</span><span class="op" id="5155687">.</span><span class="ident" id="5155688">Name</span><span class="op" id="5155692">.</span><span class="ident" id="5155693">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155701">if</span>&nbsp;<span class="ident" id="5155704">isTest</span><span class="op" id="5155710">(</span><span class="ident" id="5155711">name</span><span class="op" id="5155715">,</span>&nbsp;<span class="string" id="5155717">&#34;Test&#34;</span><span class="op" id="5155723">)</span>&nbsp;<span class="op" id="5155725">||</span>&nbsp;<span class="ident" id="5155728">isTest</span><span class="op" id="5155734">(</span><span class="ident" id="5155735">name</span><span class="op" id="5155739">,</span>&nbsp;<span class="string" id="5155741">&#34;Benchmark&#34;</span><span class="op" id="5155752">)</span>&nbsp;<span class="op" id="5155754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155760">hasTests</span>&nbsp;<span class="op" id="5155769">=</span>&nbsp;<span class="builtintype" id="5155771">true</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155780">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155797">if</span>&nbsp;<span class="op" id="5155800">!</span><span class="ident" id="5155801">isTest</span><span class="op" id="5155807">(</span><span class="ident" id="5155808">name</span><span class="op" id="5155812">,</span>&nbsp;<span class="string" id="5155814">&#34;Example&#34;</span><span class="op" id="5155823">)</span>&nbsp;<span class="op" id="5155825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155831">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155843">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155848">var</span>&nbsp;<span class="ident" id="5155852">doc</span>&nbsp;<span class="builtintype" id="5155856">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155866">if</span>&nbsp;<span class="ident" id="5155869">f</span><span class="op" id="5155870">.</span><span class="ident" id="5155871">Doc</span>&nbsp;<span class="op" id="5155875">!=</span>&nbsp;<span class="ident" id="5155878">nil</span>&nbsp;<span class="op" id="5155882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155888">doc</span>&nbsp;<span class="op" id="5155892">=</span>&nbsp;<span class="ident" id="5155894">f</span><span class="op" id="5155895">.</span><span class="ident" id="5155896">Doc</span><span class="op" id="5155899">.</span><span class="ident" id="5155900">Text</span><span class="op" id="5155904">(</span><span class="op" id="5155905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155915">output</span><span class="op" id="5155921">,</span>&nbsp;<span class="ident" id="5155923">hasOutput</span>&nbsp;<span class="op" id="5155933">:=</span>&nbsp;<span class="ident" id="5155936">exampleOutput</span><span class="op" id="5155949">(</span><span class="ident" id="5155950">f</span><span class="op" id="5155951">.</span><span class="ident" id="5155952">Body</span><span class="op" id="5155956">,</span>&nbsp;<span class="ident" id="5155958">file</span><span class="op" id="5155962">.</span><span class="ident" id="5155963">Comments</span><span class="op" id="5155971">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155976">flist</span>&nbsp;<span class="op" id="5155982">=</span>&nbsp;<span class="builtinfunc" id="5155984">append</span><span class="op" id="5155990">(</span><span class="ident" id="5155991">flist</span><span class="op" id="5155996">,</span>&nbsp;<span class="op" id="5155998">&amp;</span><span class="ident" id="5155999">Example</span><span class="op" id="5156006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156012">Name</span><span class="op" id="5156016">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156025">name</span><span class="op" id="5156029">[</span><span class="builtinfunc" id="5156030">len</span><span class="op" id="5156033">(</span><span class="string" id="5156034">&#34;Example&#34;</span><span class="op" id="5156043">)</span><span class="op" id="5156044">:</span><span class="op" id="5156045">]</span><span class="op" id="5156046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156052">Doc</span><span class="op" id="5156055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156065">doc</span><span class="op" id="5156068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156074">Code</span><span class="op" id="5156078">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156087">f</span><span class="op" id="5156088">.</span><span class="ident" id="5156089">Body</span><span class="op" id="5156093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156099">Play</span><span class="op" id="5156103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156112">playExample</span><span class="op" id="5156123">(</span><span class="ident" id="5156124">file</span><span class="op" id="5156128">,</span>&nbsp;<span class="ident" id="5156130">f</span><span class="op" id="5156131">.</span><span class="ident" id="5156132">Body</span><span class="op" id="5156136">)</span><span class="op" id="5156137">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156143">Comments</span><span class="op" id="5156151">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156156">file</span><span class="op" id="5156160">.</span><span class="ident" id="5156161">Comments</span><span class="op" id="5156169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156175">Output</span><span class="op" id="5156181">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5156188">output</span><span class="op" id="5156194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156200">EmptyOutput</span><span class="op" id="5156211">:</span>&nbsp;<span class="ident" id="5156213">output</span>&nbsp;<span class="op" id="5156220">==</span>&nbsp;<span class="string" id="5156223">&#34;&#34;</span>&nbsp;<span class="op" id="5156226">&amp;&amp;</span>&nbsp;<span class="ident" id="5156229">hasOutput</span><span class="op" id="5156238">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156244">Order</span><span class="op" id="5156249">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5156257">len</span><span class="op" id="5156260">(</span><span class="ident" id="5156261">flist</span><span class="op" id="5156266">)</span><span class="op" id="5156267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156272">}</span><span class="op" id="5156273">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156281">if</span>&nbsp;<span class="op" id="5156284">!</span><span class="ident" id="5156285">hasTests</span>&nbsp;<span class="op" id="5156294">&amp;&amp;</span>&nbsp;<span class="ident" id="5156297">numDecl</span>&nbsp;<span class="op" id="5156305">&gt;</span>&nbsp;<span class="num" id="5156307">1</span>&nbsp;<span class="op" id="5156309">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5156312">len</span><span class="op" id="5156315">(</span><span class="ident" id="5156316">flist</span><span class="op" id="5156321">)</span>&nbsp;<span class="op" id="5156323">==</span>&nbsp;<span class="num" id="5156326">1</span>&nbsp;<span class="op" id="5156328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156333">//&nbsp;If&nbsp;this&nbsp;file&nbsp;only&nbsp;has&nbsp;one&nbsp;example&nbsp;function,&nbsp;some</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156388">//&nbsp;other&nbsp;top-level&nbsp;declarations,&nbsp;and&nbsp;no&nbsp;tests&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156440">//&nbsp;benchmarks,&nbsp;use&nbsp;the&nbsp;whole&nbsp;file&nbsp;as&nbsp;the&nbsp;example.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156493">flist</span><span class="op" id="5156498">[</span><span class="num" id="5156499">0</span><span class="op" id="5156500">]</span><span class="op" id="5156501">.</span><span class="ident" id="5156502">Code</span>&nbsp;<span class="op" id="5156507">=</span>&nbsp;<span class="ident" id="5156509">file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156517">flist</span><span class="op" id="5156522">[</span><span class="num" id="5156523">0</span><span class="op" id="5156524">]</span><span class="op" id="5156525">.</span><span class="ident" id="5156526">Play</span>&nbsp;<span class="op" id="5156531">=</span>&nbsp;<span class="ident" id="5156533">playExampleFile</span><span class="op" id="5156548">(</span><span class="ident" id="5156549">file</span><span class="op" id="5156553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156557">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156561">list</span>&nbsp;<span class="op" id="5156566">=</span>&nbsp;<span class="builtinfunc" id="5156568">append</span><span class="op" id="5156574">(</span><span class="ident" id="5156575">list</span><span class="op" id="5156579">,</span>&nbsp;<span class="ident" id="5156581">flist</span><span class="op" id="5156586">...</span><span class="op" id="5156589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156592">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156595">sort</span><span class="op" id="5156599">.</span><span class="ident" id="5156600">Sort</span><span class="op" id="5156604">(</span><span class="ident" id="5156605">exampleByName</span><span class="op" id="5156618">(</span><span class="ident" id="5156619">list</span><span class="op" id="5156623">)</span><span class="op" id="5156624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156627">return</span>&nbsp;<span class="ident" id="5156634">list</span><br>
<span class="lineno"></span><span class="op" id="5156639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5156642">var</span>&nbsp;<span class="ident" id="5156646">outputPrefix</span>&nbsp;<span class="op" id="5156659">=</span>&nbsp;<span class="ident" id="5156661">regexp</span><span class="op" id="5156667">.</span><span class="ident" id="5156668">MustCompile</span><span class="op" id="5156679">(</span><span class="string" id="5156680">`(?i)^[[:space:]]*output:`</span><span class="op" id="5156706">)</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5156709">//&nbsp;Extracts&nbsp;the&nbsp;expected&nbsp;output&nbsp;and&nbsp;whether&nbsp;there&nbsp;was&nbsp;a&nbsp;valid&nbsp;output&nbsp;comment</span><br>
<span class="lineno"></span><span class="keyword" id="5156786">func</span>&nbsp;<span class="ident" id="5156791">exampleOutput</span><span class="op" id="5156804">(</span><span class="ident" id="5156805">b</span>&nbsp;<span class="op" id="5156807">*</span><span class="ident" id="5156808">ast</span><span class="op" id="5156811">.</span><span class="ident" id="5156812">BlockStmt</span><span class="op" id="5156821">,</span>&nbsp;<span class="ident" id="5156823">comments</span>&nbsp;<span class="op" id="5156832">[</span><span class="op" id="5156833">]</span><span class="op" id="5156834">*</span><span class="ident" id="5156835">ast</span><span class="op" id="5156838">.</span><span class="ident" id="5156839">CommentGroup</span><span class="op" id="5156851">)</span>&nbsp;<span class="op" id="5156853">(</span><span class="ident" id="5156854">output</span>&nbsp;<span class="builtintype" id="5156861">string</span><span class="op" id="5156867">,</span>&nbsp;<span class="ident" id="5156869">ok</span>&nbsp;<span class="builtintype" id="5156872">bool</span><span class="op" id="5156876">)</span>&nbsp;<span class="op" id="5156878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156881">if</span>&nbsp;<span class="ident" id="5156884">_</span><span class="op" id="5156885">,</span>&nbsp;<span class="ident" id="5156887">last</span>&nbsp;<span class="op" id="5156892">:=</span>&nbsp;<span class="ident" id="5156895">lastComment</span><span class="op" id="5156906">(</span><span class="ident" id="5156907">b</span><span class="op" id="5156908">,</span>&nbsp;<span class="ident" id="5156910">comments</span><span class="op" id="5156918">)</span><span class="op" id="5156919">;</span>&nbsp;<span class="ident" id="5156921">last</span>&nbsp;<span class="op" id="5156926">!=</span>&nbsp;<span class="ident" id="5156929">nil</span>&nbsp;<span class="op" id="5156933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5156937">//&nbsp;test&nbsp;that&nbsp;it&nbsp;begins&nbsp;with&nbsp;the&nbsp;correct&nbsp;prefix</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156986">text</span>&nbsp;<span class="op" id="5156991">:=</span>&nbsp;<span class="ident" id="5156994">last</span><span class="op" id="5156998">.</span><span class="ident" id="5156999">Text</span><span class="op" id="5157003">(</span><span class="op" id="5157004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157008">if</span>&nbsp;<span class="ident" id="5157011">loc</span>&nbsp;<span class="op" id="5157015">:=</span>&nbsp;<span class="ident" id="5157018">outputPrefix</span><span class="op" id="5157030">.</span><span class="ident" id="5157031">FindStringIndex</span><span class="op" id="5157046">(</span><span class="ident" id="5157047">text</span><span class="op" id="5157051">)</span><span class="op" id="5157052">;</span>&nbsp;<span class="ident" id="5157054">loc</span>&nbsp;<span class="op" id="5157058">!=</span>&nbsp;<span class="ident" id="5157061">nil</span>&nbsp;<span class="op" id="5157065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157070">text</span>&nbsp;<span class="op" id="5157075">=</span>&nbsp;<span class="ident" id="5157077">text</span><span class="op" id="5157081">[</span><span class="ident" id="5157082">loc</span><span class="op" id="5157085">[</span><span class="num" id="5157086">1</span><span class="op" id="5157087">]</span><span class="op" id="5157088">:</span><span class="op" id="5157089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5157094">//&nbsp;Strip&nbsp;zero&nbsp;or&nbsp;more&nbsp;spaces&nbsp;followed&nbsp;by&nbsp;\n&nbsp;or&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157160">text</span>&nbsp;<span class="op" id="5157165">=</span>&nbsp;<span class="ident" id="5157167">strings</span><span class="op" id="5157174">.</span><span class="ident" id="5157175">TrimLeft</span><span class="op" id="5157183">(</span><span class="ident" id="5157184">text</span><span class="op" id="5157188">,</span>&nbsp;<span class="string" id="5157190">&#34;&nbsp;&#34;</span><span class="op" id="5157193">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157198">if</span>&nbsp;<span class="builtinfunc" id="5157201">len</span><span class="op" id="5157204">(</span><span class="ident" id="5157205">text</span><span class="op" id="5157209">)</span>&nbsp;<span class="op" id="5157211">&gt;</span>&nbsp;<span class="num" id="5157213">0</span>&nbsp;<span class="op" id="5157215">&amp;&amp;</span>&nbsp;<span class="ident" id="5157218">text</span><span class="op" id="5157222">[</span><span class="num" id="5157223">0</span><span class="op" id="5157224">]</span>&nbsp;<span class="op" id="5157226">==</span>&nbsp;<span class="string" id="5157229">&#39;\n&#39;</span>&nbsp;<span class="op" id="5157234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157240">text</span>&nbsp;<span class="op" id="5157245">=</span>&nbsp;<span class="ident" id="5157247">text</span><span class="op" id="5157251">[</span><span class="num" id="5157252">1</span><span class="op" id="5157253">:</span><span class="op" id="5157254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157264">return</span>&nbsp;<span class="ident" id="5157271">text</span><span class="op" id="5157275">,</span>&nbsp;<span class="builtintype" id="5157277">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157284">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157290">return</span>&nbsp;<span class="string" id="5157297">&#34;&#34;</span><span class="op" id="5157299">,</span>&nbsp;<span class="builtintype" id="5157301">false</span>&nbsp;<span class="comment" id="5157307">//&nbsp;no&nbsp;suitable&nbsp;comment&nbsp;found</span><br>
<span class="lineno"></span><span class="op" id="5157336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5157339">//&nbsp;isTest&nbsp;tells&nbsp;whether&nbsp;name&nbsp;looks&nbsp;like&nbsp;a&nbsp;test,&nbsp;example,&nbsp;or&nbsp;benchmark.</span><br>
<span class="lineno">120</span><span class="comment" id="5157410">//&nbsp;It&nbsp;is&nbsp;a&nbsp;Test&nbsp;(say)&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;character&nbsp;after&nbsp;Test&nbsp;that&nbsp;is&nbsp;not&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5157481">//&nbsp;lower-case&nbsp;letter.&nbsp;(We&nbsp;don&#39;t&nbsp;want&nbsp;Testiness.)</span><br>
<span class="lineno"></span><span class="keyword" id="5157530">func</span>&nbsp;<span class="ident" id="5157535">isTest</span><span class="op" id="5157541">(</span><span class="ident" id="5157542">name</span><span class="op" id="5157546">,</span>&nbsp;<span class="ident" id="5157548">prefix</span>&nbsp;<span class="builtintype" id="5157555">string</span><span class="op" id="5157561">)</span>&nbsp;<span class="builtintype" id="5157563">bool</span>&nbsp;<span class="op" id="5157568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157571">if</span>&nbsp;<span class="op" id="5157574">!</span><span class="ident" id="5157575">strings</span><span class="op" id="5157582">.</span><span class="ident" id="5157583">HasPrefix</span><span class="op" id="5157592">(</span><span class="ident" id="5157593">name</span><span class="op" id="5157597">,</span>&nbsp;<span class="ident" id="5157599">prefix</span><span class="op" id="5157605">)</span>&nbsp;<span class="op" id="5157607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157611">return</span>&nbsp;<span class="builtintype" id="5157618">false</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157625">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157628">if</span>&nbsp;<span class="builtinfunc" id="5157631">len</span><span class="op" id="5157634">(</span><span class="ident" id="5157635">name</span><span class="op" id="5157639">)</span>&nbsp;<span class="op" id="5157641">==</span>&nbsp;<span class="builtinfunc" id="5157644">len</span><span class="op" id="5157647">(</span><span class="ident" id="5157648">prefix</span><span class="op" id="5157654">)</span>&nbsp;<span class="op" id="5157656">{</span>&nbsp;<span class="comment" id="5157658">//&nbsp;&#34;Test&#34;&nbsp;is&nbsp;ok</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157676">return</span>&nbsp;<span class="builtintype" id="5157683">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5157692">rune</span><span class="op" id="5157696">,</span>&nbsp;<span class="ident" id="5157698">_</span>&nbsp;<span class="op" id="5157700">:=</span>&nbsp;<span class="ident" id="5157703">utf8</span><span class="op" id="5157707">.</span><span class="ident" id="5157708">DecodeRuneInString</span><span class="op" id="5157726">(</span><span class="ident" id="5157727">name</span><span class="op" id="5157731">[</span><span class="builtinfunc" id="5157732">len</span><span class="op" id="5157735">(</span><span class="ident" id="5157736">prefix</span><span class="op" id="5157742">)</span><span class="op" id="5157743">:</span><span class="op" id="5157744">]</span><span class="op" id="5157745">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157748">return</span>&nbsp;<span class="op" id="5157755">!</span><span class="ident" id="5157756">unicode</span><span class="op" id="5157763">.</span><span class="ident" id="5157764">IsLower</span><span class="op" id="5157771">(</span><span class="builtintype" id="5157772">rune</span><span class="op" id="5157776">)</span><br>
<span class="lineno"></span><span class="op" id="5157778">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5157781">type</span>&nbsp;<span class="ident" id="5157786">exampleByName</span>&nbsp;<span class="op" id="5157800">[</span><span class="op" id="5157801">]</span><span class="op" id="5157802">*</span><span class="ident" id="5157803">Example</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="5157812">func</span>&nbsp;<span class="op" id="5157817">(</span><span class="ident" id="5157818">s</span>&nbsp;<span class="ident" id="5157820">exampleByName</span><span class="op" id="5157833">)</span>&nbsp;<span class="ident" id="5157835">Len</span><span class="op" id="5157838">(</span><span class="op" id="5157839">)</span>&nbsp;<span class="builtintype" id="5157841">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157855">{</span>&nbsp;<span class="keyword" id="5157857">return</span>&nbsp;<span class="builtinfunc" id="5157864">len</span><span class="op" id="5157867">(</span><span class="ident" id="5157868">s</span><span class="op" id="5157869">)</span>&nbsp;<span class="op" id="5157871">}</span><br>
<span class="lineno"></span><span class="keyword" id="5157873">func</span>&nbsp;<span class="op" id="5157878">(</span><span class="ident" id="5157879">s</span>&nbsp;<span class="ident" id="5157881">exampleByName</span><span class="op" id="5157894">)</span>&nbsp;<span class="ident" id="5157896">Swap</span><span class="op" id="5157900">(</span><span class="ident" id="5157901">i</span><span class="op" id="5157902">,</span>&nbsp;<span class="ident" id="5157904">j</span>&nbsp;<span class="builtintype" id="5157906">int</span><span class="op" id="5157909">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157916">{</span>&nbsp;<span class="ident" id="5157918">s</span><span class="op" id="5157919">[</span><span class="ident" id="5157920">i</span><span class="op" id="5157921">]</span><span class="op" id="5157922">,</span>&nbsp;<span class="ident" id="5157924">s</span><span class="op" id="5157925">[</span><span class="ident" id="5157926">j</span><span class="op" id="5157927">]</span>&nbsp;<span class="op" id="5157929">=</span>&nbsp;<span class="ident" id="5157931">s</span><span class="op" id="5157932">[</span><span class="ident" id="5157933">j</span><span class="op" id="5157934">]</span><span class="op" id="5157935">,</span>&nbsp;<span class="ident" id="5157937">s</span><span class="op" id="5157938">[</span><span class="ident" id="5157939">i</span><span class="op" id="5157940">]</span>&nbsp;<span class="op" id="5157942">}</span><br>
<span class="lineno"></span><span class="keyword" id="5157944">func</span>&nbsp;<span class="op" id="5157949">(</span><span class="ident" id="5157950">s</span>&nbsp;<span class="ident" id="5157952">exampleByName</span><span class="op" id="5157965">)</span>&nbsp;<span class="ident" id="5157967">Less</span><span class="op" id="5157971">(</span><span class="ident" id="5157972">i</span><span class="op" id="5157973">,</span>&nbsp;<span class="ident" id="5157975">j</span>&nbsp;<span class="builtintype" id="5157977">int</span><span class="op" id="5157980">)</span>&nbsp;<span class="builtintype" id="5157982">bool</span>&nbsp;<span class="op" id="5157987">{</span>&nbsp;<span class="keyword" id="5157989">return</span>&nbsp;<span class="ident" id="5157996">s</span><span class="op" id="5157997">[</span><span class="ident" id="5157998">i</span><span class="op" id="5157999">]</span><span class="op" id="5158000">.</span><span class="ident" id="5158001">Name</span>&nbsp;<span class="op" id="5158006">&lt;</span>&nbsp;<span class="ident" id="5158008">s</span><span class="op" id="5158009">[</span><span class="ident" id="5158010">j</span><span class="op" id="5158011">]</span><span class="op" id="5158012">.</span><span class="ident" id="5158013">Name</span>&nbsp;<span class="op" id="5158018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5158021">//&nbsp;playExample&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File&nbsp;based&nbsp;on&nbsp;the&nbsp;provided</span><br>
<span class="lineno">140</span><span class="comment" id="5158086">//&nbsp;file&nbsp;with&nbsp;the&nbsp;provided&nbsp;function&nbsp;body&nbsp;as&nbsp;the&nbsp;body&nbsp;of&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5158147">func</span>&nbsp;<span class="ident" id="5158152">playExample</span><span class="op" id="5158163">(</span><span class="ident" id="5158164">file</span>&nbsp;<span class="op" id="5158169">*</span><span class="ident" id="5158170">ast</span><span class="op" id="5158173">.</span><span class="ident" id="5158174">File</span><span class="op" id="5158178">,</span>&nbsp;<span class="ident" id="5158180">body</span>&nbsp;<span class="op" id="5158185">*</span><span class="ident" id="5158186">ast</span><span class="op" id="5158189">.</span><span class="ident" id="5158190">BlockStmt</span><span class="op" id="5158199">)</span>&nbsp;<span class="op" id="5158201">*</span><span class="ident" id="5158202">ast</span><span class="op" id="5158205">.</span><span class="ident" id="5158206">File</span>&nbsp;<span class="op" id="5158211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158214">if</span>&nbsp;<span class="op" id="5158217">!</span><span class="ident" id="5158218">strings</span><span class="op" id="5158225">.</span><span class="ident" id="5158226">HasSuffix</span><span class="op" id="5158235">(</span><span class="ident" id="5158236">file</span><span class="op" id="5158240">.</span><span class="ident" id="5158241">Name</span><span class="op" id="5158245">.</span><span class="ident" id="5158246">Name</span><span class="op" id="5158250">,</span>&nbsp;<span class="string" id="5158252">&#34;_test&#34;</span><span class="op" id="5158259">)</span>&nbsp;<span class="op" id="5158261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158265">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158317">//&nbsp;greater&nbsp;package&nbsp;(yet).</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158345">return</span>&nbsp;<span class="ident" id="5158352">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158361">//&nbsp;Find&nbsp;top-level&nbsp;declarations&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158406">topDecls</span>&nbsp;<span class="op" id="5158415">:=</span>&nbsp;<span class="builtinfunc" id="5158418">make</span><span class="op" id="5158422">(</span><span class="keyword" id="5158423">map</span><span class="op" id="5158426">[</span><span class="op" id="5158427">*</span><span class="ident" id="5158428">ast</span><span class="op" id="5158431">.</span><span class="ident" id="5158432">Object</span><span class="op" id="5158438">]</span><span class="builtintype" id="5158439">bool</span><span class="op" id="5158443">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158446">for</span>&nbsp;<span class="ident" id="5158450">_</span><span class="op" id="5158451">,</span>&nbsp;<span class="ident" id="5158453">decl</span>&nbsp;<span class="op" id="5158458">:=</span>&nbsp;<span class="keyword" id="5158461">range</span>&nbsp;<span class="ident" id="5158467">file</span><span class="op" id="5158471">.</span><span class="ident" id="5158472">Decls</span>&nbsp;<span class="op" id="5158478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158482">switch</span>&nbsp;<span class="ident" id="5158489">d</span>&nbsp;<span class="op" id="5158491">:=</span>&nbsp;<span class="ident" id="5158494">decl</span><span class="op" id="5158498">.</span><span class="op" id="5158499">(</span><span class="keyword" id="5158500">type</span><span class="op" id="5158504">)</span>&nbsp;<span class="op" id="5158506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158510">case</span>&nbsp;<span class="op" id="5158515">*</span><span class="ident" id="5158516">ast</span><span class="op" id="5158519">.</span><span class="ident" id="5158520">FuncDecl</span><span class="op" id="5158528">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158533">topDecls</span><span class="op" id="5158541">[</span><span class="ident" id="5158542">d</span><span class="op" id="5158543">.</span><span class="ident" id="5158544">Name</span><span class="op" id="5158548">.</span><span class="ident" id="5158549">Obj</span><span class="op" id="5158552">]</span>&nbsp;<span class="op" id="5158554">=</span>&nbsp;<span class="builtintype" id="5158556">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158563">case</span>&nbsp;<span class="op" id="5158568">*</span><span class="ident" id="5158569">ast</span><span class="op" id="5158572">.</span><span class="ident" id="5158573">GenDecl</span><span class="op" id="5158580">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158585">for</span>&nbsp;<span class="ident" id="5158589">_</span><span class="op" id="5158590">,</span>&nbsp;<span class="ident" id="5158592">spec</span>&nbsp;<span class="op" id="5158597">:=</span>&nbsp;<span class="keyword" id="5158600">range</span>&nbsp;<span class="ident" id="5158606">d</span><span class="op" id="5158607">.</span><span class="ident" id="5158608">Specs</span>&nbsp;<span class="op" id="5158614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158620">switch</span>&nbsp;<span class="ident" id="5158627">s</span>&nbsp;<span class="op" id="5158629">:=</span>&nbsp;<span class="ident" id="5158632">spec</span><span class="op" id="5158636">.</span><span class="op" id="5158637">(</span><span class="keyword" id="5158638">type</span><span class="op" id="5158642">)</span>&nbsp;<span class="op" id="5158644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158650">case</span>&nbsp;<span class="op" id="5158655">*</span><span class="ident" id="5158656">ast</span><span class="op" id="5158659">.</span><span class="ident" id="5158660">TypeSpec</span><span class="op" id="5158668">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158675">topDecls</span><span class="op" id="5158683">[</span><span class="ident" id="5158684">s</span><span class="op" id="5158685">.</span><span class="ident" id="5158686">Name</span><span class="op" id="5158690">.</span><span class="ident" id="5158691">Obj</span><span class="op" id="5158694">]</span>&nbsp;<span class="op" id="5158696">=</span>&nbsp;<span class="builtintype" id="5158698">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158707">case</span>&nbsp;<span class="op" id="5158712">*</span><span class="ident" id="5158713">ast</span><span class="op" id="5158716">.</span><span class="ident" id="5158717">ValueSpec</span><span class="op" id="5158726">:</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158733">for</span>&nbsp;<span class="ident" id="5158737">_</span><span class="op" id="5158738">,</span>&nbsp;<span class="ident" id="5158740">id</span>&nbsp;<span class="op" id="5158743">:=</span>&nbsp;<span class="keyword" id="5158746">range</span>&nbsp;<span class="ident" id="5158752">s</span><span class="op" id="5158753">.</span><span class="ident" id="5158754">Names</span>&nbsp;<span class="op" id="5158760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158768">topDecls</span><span class="op" id="5158776">[</span><span class="ident" id="5158777">id</span><span class="op" id="5158779">.</span><span class="ident" id="5158780">Obj</span><span class="op" id="5158783">]</span>&nbsp;<span class="op" id="5158785">=</span>&nbsp;<span class="builtintype" id="5158787">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158797">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158803">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158808">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158819">//&nbsp;Find&nbsp;unresolved&nbsp;identifiers&nbsp;and&nbsp;uses&nbsp;of&nbsp;top-level&nbsp;declarations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158887">unresolved</span>&nbsp;<span class="op" id="5158898">:=</span>&nbsp;<span class="builtinfunc" id="5158901">make</span><span class="op" id="5158905">(</span><span class="keyword" id="5158906">map</span><span class="op" id="5158909">[</span><span class="builtintype" id="5158910">string</span><span class="op" id="5158916">]</span><span class="builtintype" id="5158917">bool</span><span class="op" id="5158921">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158924">usesTopDecl</span>&nbsp;<span class="op" id="5158936">:=</span>&nbsp;<span class="builtintype" id="5158939">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158946">var</span>&nbsp;<span class="ident" id="5158950">inspectFunc</span>&nbsp;<span class="keyword" id="5158962">func</span><span class="op" id="5158966">(</span><span class="ident" id="5158967">ast</span><span class="op" id="5158970">.</span><span class="ident" id="5158971">Node</span><span class="op" id="5158975">)</span>&nbsp;<span class="builtintype" id="5158977">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158983">inspectFunc</span>&nbsp;<span class="op" id="5158995">=</span>&nbsp;<span class="keyword" id="5158997">func</span><span class="op" id="5159001">(</span><span class="ident" id="5159002">n</span>&nbsp;<span class="ident" id="5159004">ast</span><span class="op" id="5159007">.</span><span class="ident" id="5159008">Node</span><span class="op" id="5159012">)</span>&nbsp;<span class="builtintype" id="5159014">bool</span>&nbsp;<span class="op" id="5159019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159023">//&nbsp;For&nbsp;selector&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;left&nbsp;hand&nbsp;side.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159087">//&nbsp;(For&nbsp;an&nbsp;expression&nbsp;like&nbsp;fmt.Println,&nbsp;only&nbsp;add&nbsp;&#34;fmt&#34;&nbsp;to&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159151">//&nbsp;set&nbsp;of&nbsp;unresolved&nbsp;names,&nbsp;not&nbsp;&#34;Println&#34;.)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159197">if</span>&nbsp;<span class="ident" id="5159200">e</span><span class="op" id="5159201">,</span>&nbsp;<span class="ident" id="5159203">ok</span>&nbsp;<span class="op" id="5159206">:=</span>&nbsp;<span class="ident" id="5159209">n</span><span class="op" id="5159210">.</span><span class="op" id="5159211">(</span><span class="op" id="5159212">*</span><span class="ident" id="5159213">ast</span><span class="op" id="5159216">.</span><span class="ident" id="5159217">SelectorExpr</span><span class="op" id="5159229">)</span><span class="op" id="5159230">;</span>&nbsp;<span class="ident" id="5159232">ok</span>&nbsp;<span class="op" id="5159235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159240">ast</span><span class="op" id="5159243">.</span><span class="ident" id="5159244">Inspect</span><span class="op" id="5159251">(</span><span class="ident" id="5159252">e</span><span class="op" id="5159253">.</span><span class="ident" id="5159254">X</span><span class="op" id="5159255">,</span>&nbsp;<span class="ident" id="5159257">inspectFunc</span><span class="op" id="5159268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159273">return</span>&nbsp;<span class="builtintype" id="5159280">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159288">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159292">//&nbsp;For&nbsp;key&nbsp;value&nbsp;expressions,&nbsp;only&nbsp;inspect&nbsp;the&nbsp;value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159347">//&nbsp;as&nbsp;the&nbsp;key&nbsp;should&nbsp;be&nbsp;resolved&nbsp;by&nbsp;the&nbsp;type&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159401">//&nbsp;composite&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159425">if</span>&nbsp;<span class="ident" id="5159428">e</span><span class="op" id="5159429">,</span>&nbsp;<span class="ident" id="5159431">ok</span>&nbsp;<span class="op" id="5159434">:=</span>&nbsp;<span class="ident" id="5159437">n</span><span class="op" id="5159438">.</span><span class="op" id="5159439">(</span><span class="op" id="5159440">*</span><span class="ident" id="5159441">ast</span><span class="op" id="5159444">.</span><span class="ident" id="5159445">KeyValueExpr</span><span class="op" id="5159457">)</span><span class="op" id="5159458">;</span>&nbsp;<span class="ident" id="5159460">ok</span>&nbsp;<span class="op" id="5159463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159468">ast</span><span class="op" id="5159471">.</span><span class="ident" id="5159472">Inspect</span><span class="op" id="5159479">(</span><span class="ident" id="5159480">e</span><span class="op" id="5159481">.</span><span class="ident" id="5159482">Value</span><span class="op" id="5159487">,</span>&nbsp;<span class="ident" id="5159489">inspectFunc</span><span class="op" id="5159500">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159505">return</span>&nbsp;<span class="builtintype" id="5159512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159524">if</span>&nbsp;<span class="ident" id="5159527">id</span><span class="op" id="5159529">,</span>&nbsp;<span class="ident" id="5159531">ok</span>&nbsp;<span class="op" id="5159534">:=</span>&nbsp;<span class="ident" id="5159537">n</span><span class="op" id="5159538">.</span><span class="op" id="5159539">(</span><span class="op" id="5159540">*</span><span class="ident" id="5159541">ast</span><span class="op" id="5159544">.</span><span class="ident" id="5159545">Ident</span><span class="op" id="5159550">)</span><span class="op" id="5159551">;</span>&nbsp;<span class="ident" id="5159553">ok</span>&nbsp;<span class="op" id="5159556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159561">if</span>&nbsp;<span class="ident" id="5159564">id</span><span class="op" id="5159566">.</span><span class="ident" id="5159567">Obj</span>&nbsp;<span class="op" id="5159571">==</span>&nbsp;<span class="ident" id="5159574">nil</span>&nbsp;<span class="op" id="5159578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159584">unresolved</span><span class="op" id="5159594">[</span><span class="ident" id="5159595">id</span><span class="op" id="5159597">.</span><span class="ident" id="5159598">Name</span><span class="op" id="5159602">]</span>&nbsp;<span class="op" id="5159604">=</span>&nbsp;<span class="builtintype" id="5159606">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159614">}</span>&nbsp;<span class="keyword" id="5159616">else</span>&nbsp;<span class="keyword" id="5159621">if</span>&nbsp;<span class="ident" id="5159624">topDecls</span><span class="op" id="5159632">[</span><span class="ident" id="5159633">id</span><span class="op" id="5159635">.</span><span class="ident" id="5159636">Obj</span><span class="op" id="5159639">]</span>&nbsp;<span class="op" id="5159641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159647">usesTopDecl</span>&nbsp;<span class="op" id="5159659">=</span>&nbsp;<span class="builtintype" id="5159661">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159677">return</span>&nbsp;<span class="builtintype" id="5159684">true</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159693">ast</span><span class="op" id="5159696">.</span><span class="ident" id="5159697">Inspect</span><span class="op" id="5159704">(</span><span class="ident" id="5159705">body</span><span class="op" id="5159709">,</span>&nbsp;<span class="ident" id="5159711">inspectFunc</span><span class="op" id="5159722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159725">if</span>&nbsp;<span class="ident" id="5159728">usesTopDecl</span>&nbsp;<span class="op" id="5159740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159744">//&nbsp;We&nbsp;don&#39;t&nbsp;support&nbsp;examples&nbsp;that&nbsp;are&nbsp;not&nbsp;self-contained&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159810">return</span>&nbsp;<span class="ident" id="5159817">nil</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5159826">//&nbsp;Remove&nbsp;predeclared&nbsp;identifiers&nbsp;from&nbsp;unresolved&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159883">for</span>&nbsp;<span class="ident" id="5159887">n</span>&nbsp;<span class="op" id="5159889">:=</span>&nbsp;<span class="keyword" id="5159892">range</span>&nbsp;<span class="ident" id="5159898">unresolved</span>&nbsp;<span class="op" id="5159909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159913">if</span>&nbsp;<span class="ident" id="5159916">predeclaredTypes</span><span class="op" id="5159932">[</span><span class="ident" id="5159933">n</span><span class="op" id="5159934">]</span>&nbsp;<span class="op" id="5159936">||</span>&nbsp;<span class="ident" id="5159939">predeclaredConstants</span><span class="op" id="5159959">[</span><span class="ident" id="5159960">n</span><span class="op" id="5159961">]</span>&nbsp;<span class="op" id="5159963">||</span>&nbsp;<span class="ident" id="5159966">predeclaredFuncs</span><span class="op" id="5159982">[</span><span class="ident" id="5159983">n</span><span class="op" id="5159984">]</span>&nbsp;<span class="op" id="5159986">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5159991">delete</span><span class="op" id="5159997">(</span><span class="ident" id="5159998">unresolved</span><span class="op" id="5160008">,</span>&nbsp;<span class="ident" id="5160010">n</span><span class="op" id="5160011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160022">//&nbsp;Use&nbsp;unresolved&nbsp;identifiers&nbsp;to&nbsp;determine&nbsp;the&nbsp;imports&nbsp;used&nbsp;by&nbsp;this</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160091">//&nbsp;example.&nbsp;The&nbsp;heuristic&nbsp;assumes&nbsp;package&nbsp;names&nbsp;match&nbsp;base&nbsp;import</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160158">//&nbsp;paths&nbsp;for&nbsp;imports&nbsp;w/o&nbsp;renames&nbsp;(should&nbsp;be&nbsp;good&nbsp;enough&nbsp;most&nbsp;of&nbsp;the&nbsp;time).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160234">namedImports</span>&nbsp;<span class="op" id="5160247">:=</span>&nbsp;<span class="builtinfunc" id="5160250">make</span><span class="op" id="5160254">(</span><span class="keyword" id="5160255">map</span><span class="op" id="5160258">[</span><span class="builtintype" id="5160259">string</span><span class="op" id="5160265">]</span><span class="builtintype" id="5160266">string</span><span class="op" id="5160272">)</span>&nbsp;<span class="comment" id="5160274">//&nbsp;[name]path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160289">var</span>&nbsp;<span class="ident" id="5160293">blankImports</span>&nbsp;<span class="op" id="5160306">[</span><span class="op" id="5160307">]</span><span class="ident" id="5160308">ast</span><span class="op" id="5160311">.</span><span class="ident" id="5160312">Spec</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5160329">//&nbsp;_&nbsp;imports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160343">for</span>&nbsp;<span class="ident" id="5160347">_</span><span class="op" id="5160348">,</span>&nbsp;<span class="ident" id="5160350">s</span>&nbsp;<span class="op" id="5160352">:=</span>&nbsp;<span class="keyword" id="5160355">range</span>&nbsp;<span class="ident" id="5160361">file</span><span class="op" id="5160365">.</span><span class="ident" id="5160366">Imports</span>&nbsp;<span class="op" id="5160374">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160378">p</span><span class="op" id="5160379">,</span>&nbsp;<span class="ident" id="5160381">err</span>&nbsp;<span class="op" id="5160385">:=</span>&nbsp;<span class="ident" id="5160388">strconv</span><span class="op" id="5160395">.</span><span class="ident" id="5160396">Unquote</span><span class="op" id="5160403">(</span><span class="ident" id="5160404">s</span><span class="op" id="5160405">.</span><span class="ident" id="5160406">Path</span><span class="op" id="5160410">.</span><span class="ident" id="5160411">Value</span><span class="op" id="5160416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160420">if</span>&nbsp;<span class="ident" id="5160423">err</span>&nbsp;<span class="op" id="5160427">!=</span>&nbsp;<span class="ident" id="5160430">nil</span>&nbsp;<span class="op" id="5160434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160439">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160454">n</span>&nbsp;<span class="op" id="5160456">:=</span>&nbsp;<span class="ident" id="5160459">path</span><span class="op" id="5160463">.</span><span class="ident" id="5160464">Base</span><span class="op" id="5160468">(</span><span class="ident" id="5160469">p</span><span class="op" id="5160470">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160474">if</span>&nbsp;<span class="ident" id="5160477">s</span><span class="op" id="5160478">.</span><span class="ident" id="5160479">Name</span>&nbsp;<span class="op" id="5160484">!=</span>&nbsp;<span class="ident" id="5160487">nil</span>&nbsp;<span class="op" id="5160491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160496">n</span>&nbsp;<span class="op" id="5160498">=</span>&nbsp;<span class="ident" id="5160500">s</span><span class="op" id="5160501">.</span><span class="ident" id="5160502">Name</span><span class="op" id="5160506">.</span><span class="ident" id="5160507">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160515">switch</span>&nbsp;<span class="ident" id="5160522">n</span>&nbsp;<span class="op" id="5160524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160529">case</span>&nbsp;<span class="string" id="5160534">&#34;_&#34;</span><span class="op" id="5160537">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160543">blankImports</span>&nbsp;<span class="op" id="5160556">=</span>&nbsp;<span class="builtinfunc" id="5160558">append</span><span class="op" id="5160564">(</span><span class="ident" id="5160565">blankImports</span><span class="op" id="5160577">,</span>&nbsp;<span class="ident" id="5160579">s</span><span class="op" id="5160580">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160586">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160598">case</span>&nbsp;<span class="string" id="5160603">&#34;.&#34;</span><span class="op" id="5160606">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160612">//&nbsp;We&nbsp;can&#39;t&nbsp;resolve&nbsp;dot&nbsp;imports&nbsp;(yet).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160655">return</span>&nbsp;<span class="ident" id="5160662">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160669">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160677">if</span>&nbsp;<span class="ident" id="5160680">unresolved</span><span class="op" id="5160690">[</span><span class="ident" id="5160691">n</span><span class="op" id="5160692">]</span>&nbsp;<span class="op" id="5160694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160699">namedImports</span><span class="op" id="5160711">[</span><span class="ident" id="5160712">n</span><span class="op" id="5160713">]</span>&nbsp;<span class="op" id="5160715">=</span>&nbsp;<span class="ident" id="5160717">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5160722">delete</span><span class="op" id="5160728">(</span><span class="ident" id="5160729">unresolved</span><span class="op" id="5160739">,</span>&nbsp;<span class="ident" id="5160741">n</span><span class="op" id="5160742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160746">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160749">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160753">//&nbsp;If&nbsp;there&nbsp;are&nbsp;other&nbsp;unresolved&nbsp;identifiers,&nbsp;give&nbsp;up&nbsp;because&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160821">//&nbsp;synthesized&nbsp;file&nbsp;is&nbsp;not&nbsp;going&nbsp;to&nbsp;build.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160865">if</span>&nbsp;<span class="builtinfunc" id="5160868">len</span><span class="op" id="5160871">(</span><span class="ident" id="5160872">unresolved</span><span class="op" id="5160882">)</span>&nbsp;<span class="op" id="5160884">&gt;</span>&nbsp;<span class="num" id="5160886">0</span>&nbsp;<span class="op" id="5160888">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160892">return</span>&nbsp;<span class="ident" id="5160899">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160908">//&nbsp;Include&nbsp;documentation&nbsp;belonging&nbsp;to&nbsp;blank&nbsp;imports.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160962">var</span>&nbsp;<span class="ident" id="5160966">comments</span>&nbsp;<span class="op" id="5160975">[</span><span class="op" id="5160976">]</span><span class="op" id="5160977">*</span><span class="ident" id="5160978">ast</span><span class="op" id="5160981">.</span><span class="ident" id="5160982">CommentGroup</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160996">for</span>&nbsp;<span class="ident" id="5161000">_</span><span class="op" id="5161001">,</span>&nbsp;<span class="ident" id="5161003">s</span>&nbsp;<span class="op" id="5161005">:=</span>&nbsp;<span class="keyword" id="5161008">range</span>&nbsp;<span class="ident" id="5161014">blankImports</span>&nbsp;<span class="op" id="5161027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161031">if</span>&nbsp;<span class="ident" id="5161034">c</span>&nbsp;<span class="op" id="5161036">:=</span>&nbsp;<span class="ident" id="5161039">s</span><span class="op" id="5161040">.</span><span class="op" id="5161041">(</span><span class="op" id="5161042">*</span><span class="ident" id="5161043">ast</span><span class="op" id="5161046">.</span><span class="ident" id="5161047">ImportSpec</span><span class="op" id="5161057">)</span><span class="op" id="5161058">.</span><span class="ident" id="5161059">Doc</span><span class="op" id="5161062">;</span>&nbsp;<span class="ident" id="5161064">c</span>&nbsp;<span class="op" id="5161066">!=</span>&nbsp;<span class="ident" id="5161069">nil</span>&nbsp;<span class="op" id="5161073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161078">comments</span>&nbsp;<span class="op" id="5161087">=</span>&nbsp;<span class="builtinfunc" id="5161089">append</span><span class="op" id="5161095">(</span><span class="ident" id="5161096">comments</span><span class="op" id="5161104">,</span>&nbsp;<span class="ident" id="5161106">c</span><span class="op" id="5161107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161114">}</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161118">//&nbsp;Include&nbsp;comments&nbsp;that&nbsp;are&nbsp;inside&nbsp;the&nbsp;function&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161174">for</span>&nbsp;<span class="ident" id="5161178">_</span><span class="op" id="5161179">,</span>&nbsp;<span class="ident" id="5161181">c</span>&nbsp;<span class="op" id="5161183">:=</span>&nbsp;<span class="keyword" id="5161186">range</span>&nbsp;<span class="ident" id="5161192">file</span><span class="op" id="5161196">.</span><span class="ident" id="5161197">Comments</span>&nbsp;<span class="op" id="5161206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161210">if</span>&nbsp;<span class="ident" id="5161213">body</span><span class="op" id="5161217">.</span><span class="ident" id="5161218">Pos</span><span class="op" id="5161221">(</span><span class="op" id="5161222">)</span>&nbsp;<span class="op" id="5161224">&lt;=</span>&nbsp;<span class="ident" id="5161227">c</span><span class="op" id="5161228">.</span><span class="ident" id="5161229">Pos</span><span class="op" id="5161232">(</span><span class="op" id="5161233">)</span>&nbsp;<span class="op" id="5161235">&amp;&amp;</span>&nbsp;<span class="ident" id="5161238">c</span><span class="op" id="5161239">.</span><span class="ident" id="5161240">End</span><span class="op" id="5161243">(</span><span class="op" id="5161244">)</span>&nbsp;<span class="op" id="5161246">&lt;=</span>&nbsp;<span class="ident" id="5161249">body</span><span class="op" id="5161253">.</span><span class="ident" id="5161254">End</span><span class="op" id="5161257">(</span><span class="op" id="5161258">)</span>&nbsp;<span class="op" id="5161260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161265">comments</span>&nbsp;<span class="op" id="5161274">=</span>&nbsp;<span class="builtinfunc" id="5161276">append</span><span class="op" id="5161282">(</span><span class="ident" id="5161283">comments</span><span class="op" id="5161291">,</span>&nbsp;<span class="ident" id="5161293">c</span><span class="op" id="5161294">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161298">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161305">//&nbsp;Strip&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;and&nbsp;adjust&nbsp;body&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161363">body</span><span class="op" id="5161367">,</span>&nbsp;<span class="ident" id="5161369">comments</span>&nbsp;<span class="op" id="5161378">=</span>&nbsp;<span class="ident" id="5161380">stripOutputComment</span><span class="op" id="5161398">(</span><span class="ident" id="5161399">body</span><span class="op" id="5161403">,</span>&nbsp;<span class="ident" id="5161405">comments</span><span class="op" id="5161413">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161417">//&nbsp;Synthesize&nbsp;import&nbsp;declaration.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161452">importDecl</span>&nbsp;<span class="op" id="5161463">:=</span>&nbsp;<span class="op" id="5161466">&amp;</span><span class="ident" id="5161467">ast</span><span class="op" id="5161470">.</span><span class="ident" id="5161471">GenDecl</span><span class="op" id="5161478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161482">Tok</span><span class="op" id="5161485">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5161490">token</span><span class="op" id="5161495">.</span><span class="ident" id="5161496">IMPORT</span><span class="op" id="5161502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161506">Lparen</span><span class="op" id="5161512">:</span>&nbsp;<span class="num" id="5161514">1</span><span class="op" id="5161515">,</span>&nbsp;<span class="comment" id="5161517">//&nbsp;Need&nbsp;non-zero&nbsp;Lparen&nbsp;and&nbsp;Rparen&nbsp;so&nbsp;that&nbsp;printer</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161570">Rparen</span><span class="op" id="5161576">:</span>&nbsp;<span class="num" id="5161578">1</span><span class="op" id="5161579">,</span>&nbsp;<span class="comment" id="5161581">//&nbsp;treats&nbsp;this&nbsp;as&nbsp;a&nbsp;factored&nbsp;import.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161622">for</span>&nbsp;<span class="ident" id="5161626">n</span><span class="op" id="5161627">,</span>&nbsp;<span class="ident" id="5161629">p</span>&nbsp;<span class="op" id="5161631">:=</span>&nbsp;<span class="keyword" id="5161634">range</span>&nbsp;<span class="ident" id="5161640">namedImports</span>&nbsp;<span class="op" id="5161653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161657">s</span>&nbsp;<span class="op" id="5161659">:=</span>&nbsp;<span class="op" id="5161662">&amp;</span><span class="ident" id="5161663">ast</span><span class="op" id="5161666">.</span><span class="ident" id="5161667">ImportSpec</span><span class="op" id="5161677">{</span><span class="ident" id="5161678">Path</span><span class="op" id="5161682">:</span>&nbsp;<span class="op" id="5161684">&amp;</span><span class="ident" id="5161685">ast</span><span class="op" id="5161688">.</span><span class="ident" id="5161689">BasicLit</span><span class="op" id="5161697">{</span><span class="ident" id="5161698">Value</span><span class="op" id="5161703">:</span>&nbsp;<span class="ident" id="5161705">strconv</span><span class="op" id="5161712">.</span><span class="ident" id="5161713">Quote</span><span class="op" id="5161718">(</span><span class="ident" id="5161719">p</span><span class="op" id="5161720">)</span><span class="op" id="5161721">}</span><span class="op" id="5161722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5161726">if</span>&nbsp;<span class="ident" id="5161729">path</span><span class="op" id="5161733">.</span><span class="ident" id="5161734">Base</span><span class="op" id="5161738">(</span><span class="ident" id="5161739">p</span><span class="op" id="5161740">)</span>&nbsp;<span class="op" id="5161742">!=</span>&nbsp;<span class="ident" id="5161745">n</span>&nbsp;<span class="op" id="5161747">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161752">s</span><span class="op" id="5161753">.</span><span class="ident" id="5161754">Name</span>&nbsp;<span class="op" id="5161759">=</span>&nbsp;<span class="ident" id="5161761">ast</span><span class="op" id="5161764">.</span><span class="ident" id="5161765">NewIdent</span><span class="op" id="5161773">(</span><span class="ident" id="5161774">n</span><span class="op" id="5161775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161783">importDecl</span><span class="op" id="5161793">.</span><span class="ident" id="5161794">Specs</span>&nbsp;<span class="op" id="5161800">=</span>&nbsp;<span class="builtinfunc" id="5161802">append</span><span class="op" id="5161808">(</span><span class="ident" id="5161809">importDecl</span><span class="op" id="5161819">.</span><span class="ident" id="5161820">Specs</span><span class="op" id="5161825">,</span>&nbsp;<span class="ident" id="5161827">s</span><span class="op" id="5161828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5161831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161834">importDecl</span><span class="op" id="5161844">.</span><span class="ident" id="5161845">Specs</span>&nbsp;<span class="op" id="5161851">=</span>&nbsp;<span class="builtinfunc" id="5161853">append</span><span class="op" id="5161859">(</span><span class="ident" id="5161860">importDecl</span><span class="op" id="5161870">.</span><span class="ident" id="5161871">Specs</span><span class="op" id="5161876">,</span>&nbsp;<span class="ident" id="5161878">blankImports</span><span class="op" id="5161890">...</span><span class="op" id="5161893">)</span><br>
<span class="lineno">275</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161897">//&nbsp;Synthesize&nbsp;main&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161927">funcDecl</span>&nbsp;<span class="op" id="5161936">:=</span>&nbsp;<span class="op" id="5161939">&amp;</span><span class="ident" id="5161940">ast</span><span class="op" id="5161943">.</span><span class="ident" id="5161944">FuncDecl</span><span class="op" id="5161952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161956">Name</span><span class="op" id="5161960">:</span>&nbsp;<span class="ident" id="5161962">ast</span><span class="op" id="5161965">.</span><span class="ident" id="5161966">NewIdent</span><span class="op" id="5161974">(</span><span class="string" id="5161975">&#34;main&#34;</span><span class="op" id="5161981">)</span><span class="op" id="5161982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161986">Type</span><span class="op" id="5161990">:</span>&nbsp;<span class="op" id="5161992">&amp;</span><span class="ident" id="5161993">ast</span><span class="op" id="5161996">.</span><span class="ident" id="5161997">FuncType</span><span class="op" id="5162005">{</span><span class="ident" id="5162006">Params</span><span class="op" id="5162012">:</span>&nbsp;<span class="op" id="5162014">&amp;</span><span class="ident" id="5162015">ast</span><span class="op" id="5162018">.</span><span class="ident" id="5162019">FieldList</span><span class="op" id="5162028">{</span><span class="op" id="5162029">}</span><span class="op" id="5162030">}</span><span class="op" id="5162031">,</span>&nbsp;<span class="comment" id="5162033">//&nbsp;FuncType.Params&nbsp;must&nbsp;be&nbsp;non-nil</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162070">Body</span><span class="op" id="5162074">:</span>&nbsp;<span class="ident" id="5162076">body</span><span class="op" id="5162080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162087">//&nbsp;Synthesize&nbsp;file.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162108">return</span>&nbsp;<span class="op" id="5162115">&amp;</span><span class="ident" id="5162116">ast</span><span class="op" id="5162119">.</span><span class="ident" id="5162120">File</span><span class="op" id="5162124">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162128">Name</span><span class="op" id="5162132">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162138">ast</span><span class="op" id="5162141">.</span><span class="ident" id="5162142">NewIdent</span><span class="op" id="5162150">(</span><span class="string" id="5162151">&#34;main&#34;</span><span class="op" id="5162157">)</span><span class="op" id="5162158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162162">Decls</span><span class="op" id="5162167">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5162172">[</span><span class="op" id="5162173">]</span><span class="ident" id="5162174">ast</span><span class="op" id="5162177">.</span><span class="ident" id="5162178">Decl</span><span class="op" id="5162182">{</span><span class="ident" id="5162183">importDecl</span><span class="op" id="5162193">,</span>&nbsp;<span class="ident" id="5162195">funcDecl</span><span class="op" id="5162203">}</span><span class="op" id="5162204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162208">Comments</span><span class="op" id="5162216">:</span>&nbsp;<span class="ident" id="5162218">comments</span><span class="op" id="5162226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162229">}</span><br>
<span class="lineno"></span><span class="op" id="5162231">}</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span><span class="comment" id="5162234">//&nbsp;playExampleFile&nbsp;takes&nbsp;a&nbsp;whole&nbsp;file&nbsp;example&nbsp;and&nbsp;synthesizes&nbsp;a&nbsp;new&nbsp;*ast.File</span><br>
<span class="lineno"></span><span class="comment" id="5162312">//&nbsp;such&nbsp;that&nbsp;the&nbsp;example&nbsp;is&nbsp;function&nbsp;main&nbsp;in&nbsp;package&nbsp;main.</span><br>
<span class="lineno"></span><span class="keyword" id="5162371">func</span>&nbsp;<span class="ident" id="5162376">playExampleFile</span><span class="op" id="5162391">(</span><span class="ident" id="5162392">file</span>&nbsp;<span class="op" id="5162397">*</span><span class="ident" id="5162398">ast</span><span class="op" id="5162401">.</span><span class="ident" id="5162402">File</span><span class="op" id="5162406">)</span>&nbsp;<span class="op" id="5162408">*</span><span class="ident" id="5162409">ast</span><span class="op" id="5162412">.</span><span class="ident" id="5162413">File</span>&nbsp;<span class="op" id="5162418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162421">//&nbsp;Strip&nbsp;copyright&nbsp;comment&nbsp;if&nbsp;present.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162461">comments</span>&nbsp;<span class="op" id="5162470">:=</span>&nbsp;<span class="ident" id="5162473">file</span><span class="op" id="5162477">.</span><span class="ident" id="5162478">Comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162488">if</span>&nbsp;<span class="builtinfunc" id="5162491">len</span><span class="op" id="5162494">(</span><span class="ident" id="5162495">comments</span><span class="op" id="5162503">)</span>&nbsp;<span class="op" id="5162505">&gt;</span>&nbsp;<span class="num" id="5162507">0</span>&nbsp;<span class="op" id="5162509">&amp;&amp;</span>&nbsp;<span class="ident" id="5162512">strings</span><span class="op" id="5162519">.</span><span class="ident" id="5162520">HasPrefix</span><span class="op" id="5162529">(</span><span class="ident" id="5162530">comments</span><span class="op" id="5162538">[</span><span class="num" id="5162539">0</span><span class="op" id="5162540">]</span><span class="op" id="5162541">.</span><span class="ident" id="5162542">Text</span><span class="op" id="5162546">(</span><span class="op" id="5162547">)</span><span class="op" id="5162548">,</span>&nbsp;<span class="string" id="5162550">&#34;Copyright&#34;</span><span class="op" id="5162561">)</span>&nbsp;<span class="op" id="5162563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162567">comments</span>&nbsp;<span class="op" id="5162576">=</span>&nbsp;<span class="ident" id="5162578">comments</span><span class="op" id="5162586">[</span><span class="num" id="5162587">1</span><span class="op" id="5162588">:</span><span class="op" id="5162589">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162596">//&nbsp;Copy&nbsp;declaration&nbsp;slice,&nbsp;rewriting&nbsp;the&nbsp;ExampleX&nbsp;function&nbsp;to&nbsp;main.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162665">var</span>&nbsp;<span class="ident" id="5162669">decls</span>&nbsp;<span class="op" id="5162675">[</span><span class="op" id="5162676">]</span><span class="ident" id="5162677">ast</span><span class="op" id="5162680">.</span><span class="ident" id="5162681">Decl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162687">for</span>&nbsp;<span class="ident" id="5162691">_</span><span class="op" id="5162692">,</span>&nbsp;<span class="ident" id="5162694">d</span>&nbsp;<span class="op" id="5162696">:=</span>&nbsp;<span class="keyword" id="5162699">range</span>&nbsp;<span class="ident" id="5162705">file</span><span class="op" id="5162709">.</span><span class="ident" id="5162710">Decls</span>&nbsp;<span class="op" id="5162716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162720">if</span>&nbsp;<span class="ident" id="5162723">f</span><span class="op" id="5162724">,</span>&nbsp;<span class="ident" id="5162726">ok</span>&nbsp;<span class="op" id="5162729">:=</span>&nbsp;<span class="ident" id="5162732">d</span><span class="op" id="5162733">.</span><span class="op" id="5162734">(</span><span class="op" id="5162735">*</span><span class="ident" id="5162736">ast</span><span class="op" id="5162739">.</span><span class="ident" id="5162740">FuncDecl</span><span class="op" id="5162748">)</span><span class="op" id="5162749">;</span>&nbsp;<span class="ident" id="5162751">ok</span>&nbsp;<span class="op" id="5162754">&amp;&amp;</span>&nbsp;<span class="ident" id="5162757">isTest</span><span class="op" id="5162763">(</span><span class="ident" id="5162764">f</span><span class="op" id="5162765">.</span><span class="ident" id="5162766">Name</span><span class="op" id="5162770">.</span><span class="ident" id="5162771">Name</span><span class="op" id="5162775">,</span>&nbsp;<span class="string" id="5162777">&#34;Example&#34;</span><span class="op" id="5162786">)</span>&nbsp;<span class="op" id="5162788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162793">//&nbsp;Copy&nbsp;the&nbsp;FuncDecl,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162847">newF</span>&nbsp;<span class="op" id="5162852">:=</span>&nbsp;<span class="op" id="5162855">*</span><span class="ident" id="5162856">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162861">newF</span><span class="op" id="5162865">.</span><span class="ident" id="5162866">Name</span>&nbsp;<span class="op" id="5162871">=</span>&nbsp;<span class="ident" id="5162873">ast</span><span class="op" id="5162876">.</span><span class="ident" id="5162877">NewIdent</span><span class="op" id="5162885">(</span><span class="string" id="5162886">&#34;main&#34;</span><span class="op" id="5162892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162897">newF</span><span class="op" id="5162901">.</span><span class="ident" id="5162902">Body</span><span class="op" id="5162906">,</span>&nbsp;<span class="ident" id="5162908">comments</span>&nbsp;<span class="op" id="5162917">=</span>&nbsp;<span class="ident" id="5162919">stripOutputComment</span><span class="op" id="5162937">(</span><span class="ident" id="5162938">f</span><span class="op" id="5162939">.</span><span class="ident" id="5162940">Body</span><span class="op" id="5162944">,</span>&nbsp;<span class="ident" id="5162946">comments</span><span class="op" id="5162954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162959">d</span>&nbsp;<span class="op" id="5162961">=</span>&nbsp;<span class="op" id="5162963">&amp;</span><span class="ident" id="5162964">newF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162971">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162975">decls</span>&nbsp;<span class="op" id="5162981">=</span>&nbsp;<span class="builtinfunc" id="5162983">append</span><span class="op" id="5162989">(</span><span class="ident" id="5162990">decls</span><span class="op" id="5162995">,</span>&nbsp;<span class="ident" id="5162997">d</span><span class="op" id="5162998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5163001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163005">//&nbsp;Copy&nbsp;the&nbsp;File,&nbsp;as&nbsp;it&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163053">f</span>&nbsp;<span class="op" id="5163055">:=</span>&nbsp;<span class="op" id="5163058">*</span><span class="ident" id="5163059">file</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163065">f</span><span class="op" id="5163066">.</span><span class="ident" id="5163067">Name</span>&nbsp;<span class="op" id="5163072">=</span>&nbsp;<span class="ident" id="5163074">ast</span><span class="op" id="5163077">.</span><span class="ident" id="5163078">NewIdent</span><span class="op" id="5163086">(</span><span class="string" id="5163087">&#34;main&#34;</span><span class="op" id="5163093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163096">f</span><span class="op" id="5163097">.</span><span class="ident" id="5163098">Decls</span>&nbsp;<span class="op" id="5163104">=</span>&nbsp;<span class="ident" id="5163106">decls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163113">f</span><span class="op" id="5163114">.</span><span class="ident" id="5163115">Comments</span>&nbsp;<span class="op" id="5163124">=</span>&nbsp;<span class="ident" id="5163126">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163136">return</span>&nbsp;<span class="op" id="5163143">&amp;</span><span class="ident" id="5163144">f</span><br>
<span class="lineno"></span><span class="op" id="5163146">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="comment" id="5163149">//&nbsp;stripOutputComment&nbsp;finds&nbsp;and&nbsp;removes&nbsp;an&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;from&nbsp;body</span><br>
<span class="lineno"></span><span class="comment" id="5163220">//&nbsp;and&nbsp;comments,&nbsp;and&nbsp;adjusts&nbsp;the&nbsp;body&nbsp;block&#39;s&nbsp;end&nbsp;position.</span><br>
<span class="lineno"></span><span class="keyword" id="5163280">func</span>&nbsp;<span class="ident" id="5163285">stripOutputComment</span><span class="op" id="5163303">(</span><span class="ident" id="5163304">body</span>&nbsp;<span class="op" id="5163309">*</span><span class="ident" id="5163310">ast</span><span class="op" id="5163313">.</span><span class="ident" id="5163314">BlockStmt</span><span class="op" id="5163323">,</span>&nbsp;<span class="ident" id="5163325">comments</span>&nbsp;<span class="op" id="5163334">[</span><span class="op" id="5163335">]</span><span class="op" id="5163336">*</span><span class="ident" id="5163337">ast</span><span class="op" id="5163340">.</span><span class="ident" id="5163341">CommentGroup</span><span class="op" id="5163353">)</span>&nbsp;<span class="op" id="5163355">(</span><span class="op" id="5163356">*</span><span class="ident" id="5163357">ast</span><span class="op" id="5163360">.</span><span class="ident" id="5163361">BlockStmt</span><span class="op" id="5163370">,</span>&nbsp;<span class="op" id="5163372">[</span><span class="op" id="5163373">]</span><span class="op" id="5163374">*</span><span class="ident" id="5163375">ast</span><span class="op" id="5163378">.</span><span class="ident" id="5163379">CommentGroup</span><span class="op" id="5163391">)</span>&nbsp;<span class="op" id="5163393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163396">//&nbsp;Do&nbsp;nothing&nbsp;if&nbsp;no&nbsp;&#34;Output:&#34;&nbsp;comment&nbsp;found.</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163442">i</span><span class="op" id="5163443">,</span>&nbsp;<span class="ident" id="5163445">last</span>&nbsp;<span class="op" id="5163450">:=</span>&nbsp;<span class="ident" id="5163453">lastComment</span><span class="op" id="5163464">(</span><span class="ident" id="5163465">body</span><span class="op" id="5163469">,</span>&nbsp;<span class="ident" id="5163471">comments</span><span class="op" id="5163479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163482">if</span>&nbsp;<span class="ident" id="5163485">last</span>&nbsp;<span class="op" id="5163490">==</span>&nbsp;<span class="ident" id="5163493">nil</span>&nbsp;<span class="op" id="5163497">||</span>&nbsp;<span class="op" id="5163500">!</span><span class="ident" id="5163501">outputPrefix</span><span class="op" id="5163513">.</span><span class="ident" id="5163514">MatchString</span><span class="op" id="5163525">(</span><span class="ident" id="5163526">last</span><span class="op" id="5163530">.</span><span class="ident" id="5163531">Text</span><span class="op" id="5163535">(</span><span class="op" id="5163536">)</span><span class="op" id="5163537">)</span>&nbsp;<span class="op" id="5163539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163543">return</span>&nbsp;<span class="ident" id="5163550">body</span><span class="op" id="5163554">,</span>&nbsp;<span class="ident" id="5163556">comments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5163566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163570">//&nbsp;Copy&nbsp;body&nbsp;and&nbsp;comments,&nbsp;as&nbsp;the&nbsp;originals&nbsp;may&nbsp;be&nbsp;used&nbsp;elsewhere.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163638">newBody</span>&nbsp;<span class="op" id="5163646">:=</span>&nbsp;<span class="op" id="5163649">&amp;</span><span class="ident" id="5163650">ast</span><span class="op" id="5163653">.</span><span class="ident" id="5163654">BlockStmt</span><span class="op" id="5163663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163667">Lbrace</span><span class="op" id="5163673">:</span>&nbsp;<span class="ident" id="5163675">body</span><span class="op" id="5163679">.</span><span class="ident" id="5163680">Lbrace</span><span class="op" id="5163686">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163690">List</span><span class="op" id="5163694">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5163698">body</span><span class="op" id="5163702">.</span><span class="ident" id="5163703">List</span><span class="op" id="5163707">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163711">Rbrace</span><span class="op" id="5163717">:</span>&nbsp;<span class="ident" id="5163719">last</span><span class="op" id="5163723">.</span><span class="ident" id="5163724">Pos</span><span class="op" id="5163727">(</span><span class="op" id="5163728">)</span><span class="op" id="5163729">,</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5163732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163735">newComments</span>&nbsp;<span class="op" id="5163747">:=</span>&nbsp;<span class="builtinfunc" id="5163750">make</span><span class="op" id="5163754">(</span><span class="op" id="5163755">[</span><span class="op" id="5163756">]</span><span class="op" id="5163757">*</span><span class="ident" id="5163758">ast</span><span class="op" id="5163761">.</span><span class="ident" id="5163762">CommentGroup</span><span class="op" id="5163774">,</span>&nbsp;<span class="builtinfunc" id="5163776">len</span><span class="op" id="5163779">(</span><span class="ident" id="5163780">comments</span><span class="op" id="5163788">)</span><span class="op" id="5163789">-</span><span class="num" id="5163790">1</span><span class="op" id="5163791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5163794">copy</span><span class="op" id="5163798">(</span><span class="ident" id="5163799">newComments</span><span class="op" id="5163810">,</span>&nbsp;<span class="ident" id="5163812">comments</span><span class="op" id="5163820">[</span><span class="op" id="5163821">:</span><span class="ident" id="5163822">i</span><span class="op" id="5163823">]</span><span class="op" id="5163824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5163827">copy</span><span class="op" id="5163831">(</span><span class="ident" id="5163832">newComments</span><span class="op" id="5163843">[</span><span class="ident" id="5163844">i</span><span class="op" id="5163845">:</span><span class="op" id="5163846">]</span><span class="op" id="5163847">,</span>&nbsp;<span class="ident" id="5163849">comments</span><span class="op" id="5163857">[</span><span class="ident" id="5163858">i</span><span class="op" id="5163859">+</span><span class="num" id="5163860">1</span><span class="op" id="5163861">:</span><span class="op" id="5163862">]</span><span class="op" id="5163863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163866">return</span>&nbsp;<span class="ident" id="5163873">newBody</span><span class="op" id="5163880">,</span>&nbsp;<span class="ident" id="5163882">newComments</span><br>
<span class="lineno">340</span><span class="op" id="5163894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5163897">//&nbsp;lastComment&nbsp;returns&nbsp;the&nbsp;last&nbsp;comment&nbsp;inside&nbsp;the&nbsp;provided&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="5163964">func</span>&nbsp;<span class="ident" id="5163969">lastComment</span><span class="op" id="5163980">(</span><span class="ident" id="5163981">b</span>&nbsp;<span class="op" id="5163983">*</span><span class="ident" id="5163984">ast</span><span class="op" id="5163987">.</span><span class="ident" id="5163988">BlockStmt</span><span class="op" id="5163997">,</span>&nbsp;<span class="ident" id="5163999">c</span>&nbsp;<span class="op" id="5164001">[</span><span class="op" id="5164002">]</span><span class="op" id="5164003">*</span><span class="ident" id="5164004">ast</span><span class="op" id="5164007">.</span><span class="ident" id="5164008">CommentGroup</span><span class="op" id="5164020">)</span>&nbsp;<span class="op" id="5164022">(</span><span class="ident" id="5164023">i</span>&nbsp;<span class="builtintype" id="5164025">int</span><span class="op" id="5164028">,</span>&nbsp;<span class="ident" id="5164030">last</span>&nbsp;<span class="op" id="5164035">*</span><span class="ident" id="5164036">ast</span><span class="op" id="5164039">.</span><span class="ident" id="5164040">CommentGroup</span><span class="op" id="5164052">)</span>&nbsp;<span class="op" id="5164054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164057">pos</span><span class="op" id="5164060">,</span>&nbsp;<span class="ident" id="5164062">end</span>&nbsp;<span class="op" id="5164066">:=</span>&nbsp;<span class="ident" id="5164069">b</span><span class="op" id="5164070">.</span><span class="ident" id="5164071">Pos</span><span class="op" id="5164074">(</span><span class="op" id="5164075">)</span><span class="op" id="5164076">,</span>&nbsp;<span class="ident" id="5164078">b</span><span class="op" id="5164079">.</span><span class="ident" id="5164080">End</span><span class="op" id="5164083">(</span><span class="op" id="5164084">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164087">for</span>&nbsp;<span class="ident" id="5164091">j</span><span class="op" id="5164092">,</span>&nbsp;<span class="ident" id="5164094">cg</span>&nbsp;<span class="op" id="5164097">:=</span>&nbsp;<span class="keyword" id="5164100">range</span>&nbsp;<span class="ident" id="5164106">c</span>&nbsp;<span class="op" id="5164108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164112">if</span>&nbsp;<span class="ident" id="5164115">cg</span><span class="op" id="5164117">.</span><span class="ident" id="5164118">Pos</span><span class="op" id="5164121">(</span><span class="op" id="5164122">)</span>&nbsp;<span class="op" id="5164124">&lt;</span>&nbsp;<span class="ident" id="5164126">pos</span>&nbsp;<span class="op" id="5164130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164135">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164150">if</span>&nbsp;<span class="ident" id="5164153">cg</span><span class="op" id="5164155">.</span><span class="ident" id="5164156">End</span><span class="op" id="5164159">(</span><span class="op" id="5164160">)</span>&nbsp;<span class="op" id="5164162">&gt;</span>&nbsp;<span class="ident" id="5164164">end</span>&nbsp;<span class="op" id="5164168">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164173">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164185">i</span><span class="op" id="5164186">,</span>&nbsp;<span class="ident" id="5164188">last</span>&nbsp;<span class="op" id="5164193">=</span>&nbsp;<span class="ident" id="5164195">j</span><span class="op" id="5164196">,</span>&nbsp;<span class="ident" id="5164198">cg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164205">return</span><br>
<span class="lineno">355</span><span class="op" id="5164212">}</span>
</div>
</body>
</html>
