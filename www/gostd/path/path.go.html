<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path</h2>
<ul>
<li><a href="/gostd/path/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/path/match.go.html">match.go</a></li>
<li><a href="/gostd/path/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/path.go.html">path.go</a></li>
<li><a href="/gostd/path/path_test.go.html">path_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3689219">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3689274">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3689328">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3689379">//&nbsp;Package&nbsp;path&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;slash-separated</span><br>
<span class="lineno"></span><span class="comment" id="3689456">//&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="3689466">package</span>&nbsp;<span class="ident" id="3689474">path</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3689480">import</span>&nbsp;<span class="op" id="3689487">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3689490">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3689500">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3689503">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="3689553">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno">15</span><span class="comment" id="3689611">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="3689677">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3689734">type</span>&nbsp;<span class="ident" id="3689739">lazybuf</span>&nbsp;<span class="keyword" id="3689747">struct</span>&nbsp;<span class="op" id="3689754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689757">s</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3689761">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689769">buf</span>&nbsp;<span class="op" id="3689773">[</span><span class="op" id="3689774">]</span><span class="builtintype" id="3689775">byte</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689781">w</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3689785">int</span><br>
<span class="lineno"></span><span class="op" id="3689789">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3689792">func</span>&nbsp;<span class="op" id="3689797">(</span><span class="ident" id="3689798">b</span>&nbsp;<span class="op" id="3689800">*</span><span class="ident" id="3689801">lazybuf</span><span class="op" id="3689808">)</span>&nbsp;<span class="ident" id="3689810">index</span><span class="op" id="3689815">(</span><span class="ident" id="3689816">i</span>&nbsp;<span class="builtintype" id="3689818">int</span><span class="op" id="3689821">)</span>&nbsp;<span class="builtintype" id="3689823">byte</span>&nbsp;<span class="op" id="3689828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689831">if</span>&nbsp;<span class="ident" id="3689834">b</span><span class="op" id="3689835">.</span><span class="ident" id="3689836">buf</span>&nbsp;<span class="op" id="3689840">!=</span>&nbsp;<span class="ident" id="3689843">nil</span>&nbsp;<span class="op" id="3689847">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689851">return</span>&nbsp;<span class="ident" id="3689858">b</span><span class="op" id="3689859">.</span><span class="ident" id="3689860">buf</span><span class="op" id="3689863">[</span><span class="ident" id="3689864">i</span><span class="op" id="3689865">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3689868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689871">return</span>&nbsp;<span class="ident" id="3689878">b</span><span class="op" id="3689879">.</span><span class="ident" id="3689880">s</span><span class="op" id="3689881">[</span><span class="ident" id="3689882">i</span><span class="op" id="3689883">]</span><br>
<span class="lineno"></span><span class="op" id="3689885">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3689888">func</span>&nbsp;<span class="op" id="3689893">(</span><span class="ident" id="3689894">b</span>&nbsp;<span class="op" id="3689896">*</span><span class="ident" id="3689897">lazybuf</span><span class="op" id="3689904">)</span>&nbsp;<span class="builtinfunc" id="3689906">append</span><span class="op" id="3689912">(</span><span class="ident" id="3689913">c</span>&nbsp;<span class="builtintype" id="3689915">byte</span><span class="op" id="3689919">)</span>&nbsp;<span class="op" id="3689921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689924">if</span>&nbsp;<span class="ident" id="3689927">b</span><span class="op" id="3689928">.</span><span class="ident" id="3689929">buf</span>&nbsp;<span class="op" id="3689933">==</span>&nbsp;<span class="ident" id="3689936">nil</span>&nbsp;<span class="op" id="3689940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689944">if</span>&nbsp;<span class="ident" id="3689947">b</span><span class="op" id="3689948">.</span><span class="ident" id="3689949">w</span>&nbsp;<span class="op" id="3689951">&lt;</span>&nbsp;<span class="builtinfunc" id="3689953">len</span><span class="op" id="3689956">(</span><span class="ident" id="3689957">b</span><span class="op" id="3689958">.</span><span class="ident" id="3689959">s</span><span class="op" id="3689960">)</span>&nbsp;<span class="op" id="3689962">&amp;&amp;</span>&nbsp;<span class="ident" id="3689965">b</span><span class="op" id="3689966">.</span><span class="ident" id="3689967">s</span><span class="op" id="3689968">[</span><span class="ident" id="3689969">b</span><span class="op" id="3689970">.</span><span class="ident" id="3689971">w</span><span class="op" id="3689972">]</span>&nbsp;<span class="op" id="3689974">==</span>&nbsp;<span class="ident" id="3689977">c</span>&nbsp;<span class="op" id="3689979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3689984">b</span><span class="op" id="3689985">.</span><span class="ident" id="3689986">w</span><span class="op" id="3689987">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3689993">return</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690006">b</span><span class="op" id="3690007">.</span><span class="ident" id="3690008">buf</span>&nbsp;<span class="op" id="3690012">=</span>&nbsp;<span class="builtinfunc" id="3690014">make</span><span class="op" id="3690018">(</span><span class="op" id="3690019">[</span><span class="op" id="3690020">]</span><span class="builtintype" id="3690021">byte</span><span class="op" id="3690025">,</span>&nbsp;<span class="builtinfunc" id="3690027">len</span><span class="op" id="3690030">(</span><span class="ident" id="3690031">b</span><span class="op" id="3690032">.</span><span class="ident" id="3690033">s</span><span class="op" id="3690034">)</span><span class="op" id="3690035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3690039">copy</span><span class="op" id="3690043">(</span><span class="ident" id="3690044">b</span><span class="op" id="3690045">.</span><span class="ident" id="3690046">buf</span><span class="op" id="3690049">,</span>&nbsp;<span class="ident" id="3690051">b</span><span class="op" id="3690052">.</span><span class="ident" id="3690053">s</span><span class="op" id="3690054">[</span><span class="op" id="3690055">:</span><span class="ident" id="3690056">b</span><span class="op" id="3690057">.</span><span class="ident" id="3690058">w</span><span class="op" id="3690059">]</span><span class="op" id="3690060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690066">b</span><span class="op" id="3690067">.</span><span class="ident" id="3690068">buf</span><span class="op" id="3690071">[</span><span class="ident" id="3690072">b</span><span class="op" id="3690073">.</span><span class="ident" id="3690074">w</span><span class="op" id="3690075">]</span>&nbsp;<span class="op" id="3690077">=</span>&nbsp;<span class="ident" id="3690079">c</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3690082">b</span><span class="op" id="3690083">.</span><span class="ident" id="3690084">w</span><span class="op" id="3690085">++</span><br>
<span class="lineno"></span><span class="op" id="3690088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3690091">func</span>&nbsp;<span class="op" id="3690096">(</span><span class="ident" id="3690097">b</span>&nbsp;<span class="op" id="3690099">*</span><span class="ident" id="3690100">lazybuf</span><span class="op" id="3690107">)</span>&nbsp;<span class="builtintype" id="3690109">string</span><span class="op" id="3690115">(</span><span class="op" id="3690116">)</span>&nbsp;<span class="builtintype" id="3690118">string</span>&nbsp;<span class="op" id="3690125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690128">if</span>&nbsp;<span class="ident" id="3690131">b</span><span class="op" id="3690132">.</span><span class="ident" id="3690133">buf</span>&nbsp;<span class="op" id="3690137">==</span>&nbsp;<span class="ident" id="3690140">nil</span>&nbsp;<span class="op" id="3690144">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690148">return</span>&nbsp;<span class="ident" id="3690155">b</span><span class="op" id="3690156">.</span><span class="ident" id="3690157">s</span><span class="op" id="3690158">[</span><span class="op" id="3690159">:</span><span class="ident" id="3690160">b</span><span class="op" id="3690161">.</span><span class="ident" id="3690162">w</span><span class="op" id="3690163">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3690166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3690169">return</span>&nbsp;<span class="builtintype" id="3690176">string</span><span class="op" id="3690182">(</span><span class="ident" id="3690183">b</span><span class="op" id="3690184">.</span><span class="ident" id="3690185">buf</span><span class="op" id="3690188">[</span><span class="op" id="3690189">:</span><span class="ident" id="3690190">b</span><span class="op" id="3690191">.</span><span class="ident" id="3690192">w</span><span class="op" id="3690193">]</span><span class="op" id="3690194">)</span><br>
<span class="lineno"></span><span class="op" id="3690196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3690199">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="3690258">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="3690323">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="3690379">//</span><br>
<span class="lineno"></span><span class="comment" id="3690382">//&nbsp;&nbsp;&nbsp;&nbsp1.&nbsp;Replace&nbsp;multiple&nbsp;slashes&nbsp;with&nbsp;a&nbsp;single&nbsp;slash.</span><br>
<span class="lineno">55</span><span class="comment" id="3690434">//&nbsp;&nbsp;&nbsp;&nbsp2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="3690500">//&nbsp;&nbsp;&nbsp;&nbsp3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="3690571">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="3690625">//&nbsp;&nbsp;&nbsp;&nbsp4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="3690679">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path.</span><br>
<span class="lineno">60</span><span class="comment" id="3690743">//</span><br>
<span class="lineno"></span><span class="comment" id="3690746">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3690811">//</span><br>
<span class="lineno"></span><span class="comment" id="3690814">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="3690873">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">65</span><span class="comment" id="3690900">//</span><br>
<span class="lineno"></span><span class="comment" id="3690903">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="3690959">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="3690987">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="3691039">func</span>&nbsp;<span class="ident" id="3691044">Clean</span><span class="op" id="3691049">(</span><span class="ident" id="3691050">path</span>&nbsp;<span class="builtintype" id="3691055">string</span><span class="op" id="3691061">)</span>&nbsp;<span class="builtintype" id="3691063">string</span>&nbsp;<span class="op" id="3691070">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691073">if</span>&nbsp;<span class="ident" id="3691076">path</span>&nbsp;<span class="op" id="3691081">==</span>&nbsp;<span class="string" id="3691084">&#34;&#34;</span>&nbsp;<span class="op" id="3691087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691091">return</span>&nbsp;<span class="string" id="3691098">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691107">rooted</span>&nbsp;<span class="op" id="3691114">:=</span>&nbsp;<span class="ident" id="3691117">path</span><span class="op" id="3691121">[</span><span class="num" id="3691122">0</span><span class="op" id="3691123">]</span>&nbsp;<span class="op" id="3691125">==</span>&nbsp;<span class="string" id="3691128">&#39;/&#39;</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691133">n</span>&nbsp;<span class="op" id="3691135">:=</span>&nbsp;<span class="builtinfunc" id="3691138">len</span><span class="op" id="3691141">(</span><span class="ident" id="3691142">path</span><span class="op" id="3691146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691150">//&nbsp;Invariants:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691166">//&nbsp;&nbsp;&nbsp;&nbspreading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691225">//&nbsp;&nbsp;&nbsp;&nbspwriting&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691279">//&nbsp;&nbsp;&nbsp;&nbspdotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691341">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspit&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691406">out</span>&nbsp;<span class="op" id="3691410">:=</span>&nbsp;<span class="ident" id="3691413">lazybuf</span><span class="op" id="3691420">{</span><span class="ident" id="3691421">s</span><span class="op" id="3691422">:</span>&nbsp;<span class="ident" id="3691424">path</span><span class="op" id="3691428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691431">r</span><span class="op" id="3691432">,</span>&nbsp;<span class="ident" id="3691434">dotdot</span>&nbsp;<span class="op" id="3691441">:=</span>&nbsp;<span class="num" id="3691444">0</span><span class="op" id="3691445">,</span>&nbsp;<span class="num" id="3691447">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691450">if</span>&nbsp;<span class="ident" id="3691453">rooted</span>&nbsp;<span class="op" id="3691460">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691464">out</span><span class="op" id="3691467">.</span><span class="builtinfunc" id="3691468">append</span><span class="op" id="3691474">(</span><span class="string" id="3691475">&#39;/&#39;</span><span class="op" id="3691478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691482">r</span><span class="op" id="3691483">,</span>&nbsp;<span class="ident" id="3691485">dotdot</span>&nbsp;<span class="op" id="3691492">=</span>&nbsp;<span class="num" id="3691494">1</span><span class="op" id="3691495">,</span>&nbsp;<span class="num" id="3691497">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691504">for</span>&nbsp;<span class="ident" id="3691508">r</span>&nbsp;<span class="op" id="3691510">&lt;</span>&nbsp;<span class="ident" id="3691512">n</span>&nbsp;<span class="op" id="3691514">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691518">switch</span>&nbsp;<span class="op" id="3691525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691529">case</span>&nbsp;<span class="ident" id="3691534">path</span><span class="op" id="3691538">[</span><span class="ident" id="3691539">r</span><span class="op" id="3691540">]</span>&nbsp;<span class="op" id="3691542">==</span>&nbsp;<span class="string" id="3691545">&#39;/&#39;</span><span class="op" id="3691548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691553">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691578">r</span><span class="op" id="3691579">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691584">case</span>&nbsp;<span class="ident" id="3691589">path</span><span class="op" id="3691593">[</span><span class="ident" id="3691594">r</span><span class="op" id="3691595">]</span>&nbsp;<span class="op" id="3691597">==</span>&nbsp;<span class="string" id="3691600">&#39;.&#39;</span>&nbsp;<span class="op" id="3691604">&amp;&amp;</span>&nbsp;<span class="op" id="3691607">(</span><span class="ident" id="3691608">r</span><span class="op" id="3691609">+</span><span class="num" id="3691610">1</span>&nbsp;<span class="op" id="3691612">==</span>&nbsp;<span class="ident" id="3691615">n</span>&nbsp;<span class="op" id="3691617">||</span>&nbsp;<span class="ident" id="3691620">path</span><span class="op" id="3691624">[</span><span class="ident" id="3691625">r</span><span class="op" id="3691626">+</span><span class="num" id="3691627">1</span><span class="op" id="3691628">]</span>&nbsp;<span class="op" id="3691630">==</span>&nbsp;<span class="string" id="3691633">&#39;/&#39;</span><span class="op" id="3691636">)</span><span class="op" id="3691637">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691642">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691658">r</span><span class="op" id="3691659">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691664">case</span>&nbsp;<span class="ident" id="3691669">path</span><span class="op" id="3691673">[</span><span class="ident" id="3691674">r</span><span class="op" id="3691675">]</span>&nbsp;<span class="op" id="3691677">==</span>&nbsp;<span class="string" id="3691680">&#39;.&#39;</span>&nbsp;<span class="op" id="3691684">&amp;&amp;</span>&nbsp;<span class="ident" id="3691687">path</span><span class="op" id="3691691">[</span><span class="ident" id="3691692">r</span><span class="op" id="3691693">+</span><span class="num" id="3691694">1</span><span class="op" id="3691695">]</span>&nbsp;<span class="op" id="3691697">==</span>&nbsp;<span class="string" id="3691700">&#39;.&#39;</span>&nbsp;<span class="op" id="3691704">&amp;&amp;</span>&nbsp;<span class="op" id="3691707">(</span><span class="ident" id="3691708">r</span><span class="op" id="3691709">+</span><span class="num" id="3691710">2</span>&nbsp;<span class="op" id="3691712">==</span>&nbsp;<span class="ident" id="3691715">n</span>&nbsp;<span class="op" id="3691717">||</span>&nbsp;<span class="ident" id="3691720">path</span><span class="op" id="3691724">[</span><span class="ident" id="3691725">r</span><span class="op" id="3691726">+</span><span class="num" id="3691727">2</span><span class="op" id="3691728">]</span>&nbsp;<span class="op" id="3691730">==</span>&nbsp;<span class="string" id="3691733">&#39;/&#39;</span><span class="op" id="3691736">)</span><span class="op" id="3691737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691742">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;/</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691777">r</span>&nbsp;<span class="op" id="3691779">+=</span>&nbsp;<span class="num" id="3691782">2</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691787">switch</span>&nbsp;<span class="op" id="3691794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691799">case</span>&nbsp;<span class="ident" id="3691804">out</span><span class="op" id="3691807">.</span><span class="ident" id="3691808">w</span>&nbsp;<span class="op" id="3691810">&gt;</span>&nbsp;<span class="ident" id="3691812">dotdot</span><span class="op" id="3691818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691824">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691845">out</span><span class="op" id="3691848">.</span><span class="ident" id="3691849">w</span><span class="op" id="3691850">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691857">for</span>&nbsp;<span class="ident" id="3691861">out</span><span class="op" id="3691864">.</span><span class="ident" id="3691865">w</span>&nbsp;<span class="op" id="3691867">&gt;</span>&nbsp;<span class="ident" id="3691869">dotdot</span>&nbsp;<span class="op" id="3691876">&amp;&amp;</span>&nbsp;<span class="ident" id="3691879">out</span><span class="op" id="3691882">.</span><span class="ident" id="3691883">index</span><span class="op" id="3691888">(</span><span class="ident" id="3691889">out</span><span class="op" id="3691892">.</span><span class="ident" id="3691893">w</span><span class="op" id="3691894">)</span>&nbsp;<span class="op" id="3691896">!=</span>&nbsp;<span class="string" id="3691899">&#39;/&#39;</span>&nbsp;<span class="op" id="3691903">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3691910">out</span><span class="op" id="3691913">.</span><span class="ident" id="3691914">w</span><span class="op" id="3691915">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3691922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3691927">case</span>&nbsp;<span class="op" id="3691932">!</span><span class="ident" id="3691933">rooted</span><span class="op" id="3691939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3691945">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692008">if</span>&nbsp;<span class="ident" id="3692011">out</span><span class="op" id="3692014">.</span><span class="ident" id="3692015">w</span>&nbsp;<span class="op" id="3692017">&gt;</span>&nbsp;<span class="num" id="3692019">0</span>&nbsp;<span class="op" id="3692021">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692028">out</span><span class="op" id="3692031">.</span><span class="builtinfunc" id="3692032">append</span><span class="op" id="3692038">(</span><span class="string" id="3692039">&#39;/&#39;</span><span class="op" id="3692042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692054">out</span><span class="op" id="3692057">.</span><span class="builtinfunc" id="3692058">append</span><span class="op" id="3692064">(</span><span class="string" id="3692065">&#39;.&#39;</span><span class="op" id="3692068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692074">out</span><span class="op" id="3692077">.</span><span class="builtinfunc" id="3692078">append</span><span class="op" id="3692084">(</span><span class="string" id="3692085">&#39;.&#39;</span><span class="op" id="3692088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692094">dotdot</span>&nbsp;<span class="op" id="3692101">=</span>&nbsp;<span class="ident" id="3692103">out</span><span class="op" id="3692106">.</span><span class="ident" id="3692107">w</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692116">default</span><span class="op" id="3692123">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692128">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692153">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692179">if</span>&nbsp;<span class="ident" id="3692182">rooted</span>&nbsp;<span class="op" id="3692189">&amp;&amp;</span>&nbsp;<span class="ident" id="3692192">out</span><span class="op" id="3692195">.</span><span class="ident" id="3692196">w</span>&nbsp;<span class="op" id="3692198">!=</span>&nbsp;<span class="num" id="3692201">1</span>&nbsp;<span class="op" id="3692203">||</span>&nbsp;<span class="op" id="3692206">!</span><span class="ident" id="3692207">rooted</span>&nbsp;<span class="op" id="3692214">&amp;&amp;</span>&nbsp;<span class="ident" id="3692217">out</span><span class="op" id="3692220">.</span><span class="ident" id="3692221">w</span>&nbsp;<span class="op" id="3692223">!=</span>&nbsp;<span class="num" id="3692226">0</span>&nbsp;<span class="op" id="3692228">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692234">out</span><span class="op" id="3692237">.</span><span class="builtinfunc" id="3692238">append</span><span class="op" id="3692244">(</span><span class="string" id="3692245">&#39;/&#39;</span><span class="op" id="3692248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692258">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692277">for</span>&nbsp;<span class="op" id="3692281">;</span>&nbsp;<span class="ident" id="3692283">r</span>&nbsp;<span class="op" id="3692285">&lt;</span>&nbsp;<span class="ident" id="3692287">n</span>&nbsp;<span class="op" id="3692289">&amp;&amp;</span>&nbsp;<span class="ident" id="3692292">path</span><span class="op" id="3692296">[</span><span class="ident" id="3692297">r</span><span class="op" id="3692298">]</span>&nbsp;<span class="op" id="3692300">!=</span>&nbsp;<span class="string" id="3692303">&#39;/&#39;</span><span class="op" id="3692306">;</span>&nbsp;<span class="ident" id="3692308">r</span><span class="op" id="3692309">++</span>&nbsp;<span class="op" id="3692312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692318">out</span><span class="op" id="3692321">.</span><span class="builtinfunc" id="3692322">append</span><span class="op" id="3692328">(</span><span class="ident" id="3692329">path</span><span class="op" id="3692333">[</span><span class="ident" id="3692334">r</span><span class="op" id="3692335">]</span><span class="op" id="3692336">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3692352">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692383">if</span>&nbsp;<span class="ident" id="3692386">out</span><span class="op" id="3692389">.</span><span class="ident" id="3692390">w</span>&nbsp;<span class="op" id="3692392">==</span>&nbsp;<span class="num" id="3692395">0</span>&nbsp;<span class="op" id="3692397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692401">return</span>&nbsp;<span class="string" id="3692408">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3692413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692417">return</span>&nbsp;<span class="ident" id="3692424">out</span><span class="op" id="3692427">.</span><span class="builtintype" id="3692428">string</span><span class="op" id="3692434">(</span><span class="op" id="3692435">)</span><br>
<span class="lineno">135</span><span class="op" id="3692437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3692440">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;slash.</span><br>
<span class="lineno"></span><span class="comment" id="3692500">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="3692559">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;slash&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir&nbsp;and</span><br>
<span class="lineno">140</span><span class="comment" id="3692620">//&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3692641">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="3692704">func</span>&nbsp;<span class="ident" id="3692709">Split</span><span class="op" id="3692714">(</span><span class="ident" id="3692715">path</span>&nbsp;<span class="builtintype" id="3692720">string</span><span class="op" id="3692726">)</span>&nbsp;<span class="op" id="3692728">(</span><span class="ident" id="3692729">dir</span><span class="op" id="3692732">,</span>&nbsp;<span class="ident" id="3692734">file</span>&nbsp;<span class="builtintype" id="3692739">string</span><span class="op" id="3692745">)</span>&nbsp;<span class="op" id="3692747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3692750">i</span>&nbsp;<span class="op" id="3692752">:=</span>&nbsp;<span class="ident" id="3692755">strings</span><span class="op" id="3692762">.</span><span class="ident" id="3692763">LastIndex</span><span class="op" id="3692772">(</span><span class="ident" id="3692773">path</span><span class="op" id="3692777">,</span>&nbsp;<span class="string" id="3692779">&#34;/&#34;</span><span class="op" id="3692782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3692785">return</span>&nbsp;<span class="ident" id="3692792">path</span><span class="op" id="3692796">[</span><span class="op" id="3692797">:</span><span class="ident" id="3692798">i</span><span class="op" id="3692799">+</span><span class="num" id="3692800">1</span><span class="op" id="3692801">]</span><span class="op" id="3692802">,</span>&nbsp;<span class="ident" id="3692804">path</span><span class="op" id="3692808">[</span><span class="ident" id="3692809">i</span><span class="op" id="3692810">+</span><span class="num" id="3692811">1</span><span class="op" id="3692812">:</span><span class="op" id="3692813">]</span><br>
<span class="lineno">145</span><span class="op" id="3692815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3692818">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3692889">//&nbsp;separating&nbsp;slash&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned;&nbsp;in&nbsp;particular,</span><br>
<span class="lineno"></span><span class="comment" id="3692961">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">150</span><span class="keyword" id="3692995">func</span>&nbsp;<span class="ident" id="3693000">Join</span><span class="op" id="3693004">(</span><span class="ident" id="3693005">elem</span>&nbsp;<span class="op" id="3693010">...</span><span class="builtintype" id="3693013">string</span><span class="op" id="3693019">)</span>&nbsp;<span class="builtintype" id="3693021">string</span>&nbsp;<span class="op" id="3693028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693031">for</span>&nbsp;<span class="ident" id="3693035">i</span><span class="op" id="3693036">,</span>&nbsp;<span class="ident" id="3693038">e</span>&nbsp;<span class="op" id="3693040">:=</span>&nbsp;<span class="keyword" id="3693043">range</span>&nbsp;<span class="ident" id="3693049">elem</span>&nbsp;<span class="op" id="3693054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693058">if</span>&nbsp;<span class="ident" id="3693061">e</span>&nbsp;<span class="op" id="3693063">!=</span>&nbsp;<span class="string" id="3693066">&#34;&#34;</span>&nbsp;<span class="op" id="3693069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693074">return</span>&nbsp;<span class="ident" id="3693081">Clean</span><span class="op" id="3693086">(</span><span class="ident" id="3693087">strings</span><span class="op" id="3693094">.</span><span class="ident" id="3693095">Join</span><span class="op" id="3693099">(</span><span class="ident" id="3693100">elem</span><span class="op" id="3693104">[</span><span class="ident" id="3693105">i</span><span class="op" id="3693106">:</span><span class="op" id="3693107">]</span><span class="op" id="3693108">,</span>&nbsp;<span class="string" id="3693110">&#34;/&#34;</span><span class="op" id="3693113">)</span><span class="op" id="3693114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693118">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693124">return</span>&nbsp;<span class="string" id="3693131">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="3693134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3693137">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno">160</span><span class="comment" id="3693190">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno"></span><span class="comment" id="3693248">//&nbsp;in&nbsp;the&nbsp;final&nbsp;slash-separated&nbsp;element&nbsp;of&nbsp;path;</span><br>
<span class="lineno"></span><span class="comment" id="3693297">//&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3693332">func</span>&nbsp;<span class="ident" id="3693337">Ext</span><span class="op" id="3693340">(</span><span class="ident" id="3693341">path</span>&nbsp;<span class="builtintype" id="3693346">string</span><span class="op" id="3693352">)</span>&nbsp;<span class="builtintype" id="3693354">string</span>&nbsp;<span class="op" id="3693361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693364">for</span>&nbsp;<span class="ident" id="3693368">i</span>&nbsp;<span class="op" id="3693370">:=</span>&nbsp;<span class="builtinfunc" id="3693373">len</span><span class="op" id="3693376">(</span><span class="ident" id="3693377">path</span><span class="op" id="3693381">)</span>&nbsp;<span class="op" id="3693383">-</span>&nbsp;<span class="num" id="3693385">1</span><span class="op" id="3693386">;</span>&nbsp;<span class="ident" id="3693388">i</span>&nbsp;<span class="op" id="3693390">&gt;=</span>&nbsp;<span class="num" id="3693393">0</span>&nbsp;<span class="op" id="3693395">&amp;&amp;</span>&nbsp;<span class="ident" id="3693398">path</span><span class="op" id="3693402">[</span><span class="ident" id="3693403">i</span><span class="op" id="3693404">]</span>&nbsp;<span class="op" id="3693406">!=</span>&nbsp;<span class="string" id="3693409">&#39;/&#39;</span><span class="op" id="3693412">;</span>&nbsp;<span class="ident" id="3693414">i</span><span class="op" id="3693415">--</span>&nbsp;<span class="op" id="3693418">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693422">if</span>&nbsp;<span class="ident" id="3693425">path</span><span class="op" id="3693429">[</span><span class="ident" id="3693430">i</span><span class="op" id="3693431">]</span>&nbsp;<span class="op" id="3693433">==</span>&nbsp;<span class="string" id="3693436">&#39;.&#39;</span>&nbsp;<span class="op" id="3693440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693445">return</span>&nbsp;<span class="ident" id="3693452">path</span><span class="op" id="3693456">[</span><span class="ident" id="3693457">i</span><span class="op" id="3693458">:</span><span class="op" id="3693459">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693469">return</span>&nbsp;<span class="string" id="3693476">&#34;&#34;</span><br>
<span class="lineno">170</span><span class="op" id="3693479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3693482">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="3693524">//&nbsp;Trailing&nbsp;slashes&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno"></span><span class="comment" id="3693592">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno">175</span><span class="comment" id="3693635">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes,&nbsp;Base&nbsp;returns&nbsp;&#34;/&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3693698">func</span>&nbsp;<span class="ident" id="3693703">Base</span><span class="op" id="3693707">(</span><span class="ident" id="3693708">path</span>&nbsp;<span class="builtintype" id="3693713">string</span><span class="op" id="3693719">)</span>&nbsp;<span class="builtintype" id="3693721">string</span>&nbsp;<span class="op" id="3693728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693731">if</span>&nbsp;<span class="ident" id="3693734">path</span>&nbsp;<span class="op" id="3693739">==</span>&nbsp;<span class="string" id="3693742">&#34;&#34;</span>&nbsp;<span class="op" id="3693745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693749">return</span>&nbsp;<span class="string" id="3693756">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693761">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3693764">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693792">for</span>&nbsp;<span class="builtinfunc" id="3693796">len</span><span class="op" id="3693799">(</span><span class="ident" id="3693800">path</span><span class="op" id="3693804">)</span>&nbsp;<span class="op" id="3693806">&gt;</span>&nbsp;<span class="num" id="3693808">0</span>&nbsp;<span class="op" id="3693810">&amp;&amp;</span>&nbsp;<span class="ident" id="3693813">path</span><span class="op" id="3693817">[</span><span class="builtinfunc" id="3693818">len</span><span class="op" id="3693821">(</span><span class="ident" id="3693822">path</span><span class="op" id="3693826">)</span><span class="op" id="3693827">-</span><span class="num" id="3693828">1</span><span class="op" id="3693829">]</span>&nbsp;<span class="op" id="3693831">==</span>&nbsp;<span class="string" id="3693834">&#39;/&#39;</span>&nbsp;<span class="op" id="3693838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693842">path</span>&nbsp;<span class="op" id="3693847">=</span>&nbsp;<span class="ident" id="3693849">path</span><span class="op" id="3693853">[</span><span class="num" id="3693854">0</span>&nbsp;<span class="op" id="3693856">:</span>&nbsp;<span class="builtinfunc" id="3693858">len</span><span class="op" id="3693861">(</span><span class="ident" id="3693862">path</span><span class="op" id="3693866">)</span><span class="op" id="3693867">-</span><span class="num" id="3693868">1</span><span class="op" id="3693869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3693875">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3693901">if</span>&nbsp;<span class="ident" id="3693904">i</span>&nbsp;<span class="op" id="3693906">:=</span>&nbsp;<span class="ident" id="3693909">strings</span><span class="op" id="3693916">.</span><span class="ident" id="3693917">LastIndex</span><span class="op" id="3693926">(</span><span class="ident" id="3693927">path</span><span class="op" id="3693931">,</span>&nbsp;<span class="string" id="3693933">&#34;/&#34;</span><span class="op" id="3693936">)</span><span class="op" id="3693937">;</span>&nbsp;<span class="ident" id="3693939">i</span>&nbsp;<span class="op" id="3693941">&gt;=</span>&nbsp;<span class="num" id="3693944">0</span>&nbsp;<span class="op" id="3693946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3693950">path</span>&nbsp;<span class="op" id="3693955">=</span>&nbsp;<span class="ident" id="3693957">path</span><span class="op" id="3693961">[</span><span class="ident" id="3693962">i</span><span class="op" id="3693963">+</span><span class="num" id="3693964">1</span><span class="op" id="3693965">:</span><span class="op" id="3693966">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3693969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3693972">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694011">if</span>&nbsp;<span class="ident" id="3694014">path</span>&nbsp;<span class="op" id="3694019">==</span>&nbsp;<span class="string" id="3694022">&#34;&#34;</span>&nbsp;<span class="op" id="3694025">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694029">return</span>&nbsp;<span class="string" id="3694036">&#34;/&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3694041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694044">return</span>&nbsp;<span class="ident" id="3694051">path</span><br>
<span class="lineno"></span><span class="op" id="3694056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3694059">//&nbsp;IsAbs&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;path&nbsp;is&nbsp;absolute.</span><br>
<span class="lineno"></span><span class="keyword" id="3694106">func</span>&nbsp;<span class="ident" id="3694111">IsAbs</span><span class="op" id="3694116">(</span><span class="ident" id="3694117">path</span>&nbsp;<span class="builtintype" id="3694122">string</span><span class="op" id="3694128">)</span>&nbsp;<span class="builtintype" id="3694130">bool</span>&nbsp;<span class="op" id="3694135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694138">return</span>&nbsp;<span class="builtinfunc" id="3694145">len</span><span class="op" id="3694148">(</span><span class="ident" id="3694149">path</span><span class="op" id="3694153">)</span>&nbsp;<span class="op" id="3694155">&gt;</span>&nbsp;<span class="num" id="3694157">0</span>&nbsp;<span class="op" id="3694159">&amp;&amp;</span>&nbsp;<span class="ident" id="3694162">path</span><span class="op" id="3694166">[</span><span class="num" id="3694167">0</span><span class="op" id="3694168">]</span>&nbsp;<span class="op" id="3694170">==</span>&nbsp;<span class="string" id="3694173">&#39;/&#39;</span><br>
<span class="lineno"></span><span class="op" id="3694177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3694180">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="3694261">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element&nbsp;using&nbsp;Split,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="3694343">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno"></span><span class="comment" id="3694367">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3694409">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;slashes&nbsp;followed&nbsp;by&nbsp;non-slash&nbsp;bytes,&nbsp;Dir</span><br>
<span class="lineno">205</span><span class="comment" id="3694486">//&nbsp;returns&nbsp;a&nbsp;single&nbsp;slash.&nbsp;In&nbsp;any&nbsp;other&nbsp;case,&nbsp;the&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3694568">//&nbsp;slash.</span><br>
<span class="lineno"></span><span class="keyword" id="3694578">func</span>&nbsp;<span class="ident" id="3694583">Dir</span><span class="op" id="3694586">(</span><span class="ident" id="3694587">path</span>&nbsp;<span class="builtintype" id="3694592">string</span><span class="op" id="3694598">)</span>&nbsp;<span class="builtintype" id="3694600">string</span>&nbsp;<span class="op" id="3694607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3694610">dir</span><span class="op" id="3694613">,</span>&nbsp;<span class="ident" id="3694615">_</span>&nbsp;<span class="op" id="3694617">:=</span>&nbsp;<span class="ident" id="3694620">Split</span><span class="op" id="3694625">(</span><span class="ident" id="3694626">path</span><span class="op" id="3694630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3694633">return</span>&nbsp;<span class="ident" id="3694640">Clean</span><span class="op" id="3694645">(</span><span class="ident" id="3694646">dir</span><span class="op" id="3694649">)</span><br>
<span class="lineno">210</span><span class="op" id="3694651">}</span>
</div>
</body>
</html>
