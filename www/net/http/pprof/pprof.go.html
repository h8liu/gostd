<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4375107">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4375163">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4375217">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4375268">//&nbsp;Package&nbsp;pprof&nbsp;serves&nbsp;via&nbsp;its&nbsp;HTTP&nbsp;server&nbsp;runtime&nbsp;profiling&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="4375335">//&nbsp;in&nbsp;the&nbsp;format&nbsp;expected&nbsp;by&nbsp;the&nbsp;pprof&nbsp;visualization&nbsp;tool.</span><br>
<span class="lineno"></span><span class="comment" id="4375394">//&nbsp;For&nbsp;more&nbsp;information&nbsp;about&nbsp;pprof,&nbsp;see</span><br>
<span class="lineno"></span><span class="comment" id="4375435">//&nbsp;http://code.google.com/p/google-perftools/.</span><br>
<span class="lineno"></span><span class="comment" id="4375482">//</span><br>
<span class="lineno">10</span><span class="comment" id="4375485">//&nbsp;The&nbsp;package&nbsp;is&nbsp;typically&nbsp;only&nbsp;imported&nbsp;for&nbsp;the&nbsp;side&nbsp;effect&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4375550">//&nbsp;registering&nbsp;its&nbsp;HTTP&nbsp;handlers.</span><br>
<span class="lineno"></span><span class="comment" id="4375584">//&nbsp;The&nbsp;handled&nbsp;paths&nbsp;all&nbsp;begin&nbsp;with&nbsp;/debug/pprof/.</span><br>
<span class="lineno"></span><span class="comment" id="4375635">//</span><br>
<span class="lineno"></span><span class="comment" id="4375638">//&nbsp;To&nbsp;use&nbsp;pprof,&nbsp;link&nbsp;this&nbsp;package&nbsp;into&nbsp;your&nbsp;program:</span><br>
<span class="lineno">15</span><span class="comment" id="4375692">//&nbsp;&nbsp;&nbsp;&nbspimport&nbsp;_&nbsp;&#34;net/http/pprof&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4375721">//</span><br>
<span class="lineno"></span><span class="comment" id="4375724">//&nbsp;If&nbsp;your&nbsp;application&nbsp;is&nbsp;not&nbsp;already&nbsp;running&nbsp;an&nbsp;http&nbsp;server,&nbsp;you</span><br>
<span class="lineno"></span><span class="comment" id="4375790">//&nbsp;need&nbsp;to&nbsp;start&nbsp;one.&nbsp;&nbsp;Add&nbsp;&#34;net/http&#34;&nbsp;and&nbsp;&#34;log&#34;&nbsp;to&nbsp;your&nbsp;imports&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4375858">//&nbsp;the&nbsp;following&nbsp;code&nbsp;to&nbsp;your&nbsp;main&nbsp;function:</span><br>
<span class="lineno">20</span><span class="comment" id="4375903">//</span><br>
<span class="lineno"></span><span class="comment" id="4375906">//&nbsp;&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;func()&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4375922">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsplog.Println(http.ListenAndServe(&#34;localhost:6060&#34;,&nbsp;nil))</span><br>
<span class="lineno"></span><span class="comment" id="4375983">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp}()</span><br>
<span class="lineno"></span><span class="comment" id="4375991">//</span><br>
<span class="lineno">25</span><span class="comment" id="4375994">//&nbsp;Then&nbsp;use&nbsp;the&nbsp;pprof&nbsp;tool&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;heap&nbsp;profile:</span><br>
<span class="lineno"></span><span class="comment" id="4376050">//</span><br>
<span class="lineno"></span><span class="comment" id="4376053">//&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;tool&nbsp;pprof&nbsp;http://localhost:6060/debug/pprof/heap</span><br>
<span class="lineno"></span><span class="comment" id="4376109">//</span><br>
<span class="lineno"></span><span class="comment" id="4376112">//&nbsp;Or&nbsp;to&nbsp;look&nbsp;at&nbsp;a&nbsp;30-second&nbsp;CPU&nbsp;profile:</span><br>
<span class="lineno">30</span><span class="comment" id="4376154">//</span><br>
<span class="lineno"></span><span class="comment" id="4376157">//&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;tool&nbsp;pprof&nbsp;http://localhost:6060/debug/pprof/profile</span><br>
<span class="lineno"></span><span class="comment" id="4376216">//</span><br>
<span class="lineno"></span><span class="comment" id="4376219">//&nbsp;Or&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;goroutine&nbsp;blocking&nbsp;profile:</span><br>
<span class="lineno"></span><span class="comment" id="4376268">//</span><br>
<span class="lineno">35</span><span class="comment" id="4376271">//&nbsp;&nbsp;&nbsp;&nbspgo&nbsp;tool&nbsp;pprof&nbsp;http://localhost:6060/debug/pprof/block</span><br>
<span class="lineno"></span><span class="comment" id="4376328">//</span><br>
<span class="lineno"></span><span class="comment" id="4376331">//&nbsp;To&nbsp;view&nbsp;all&nbsp;available&nbsp;profiles,&nbsp;open&nbsp;http://localhost:6060/debug/pprof/</span><br>
<span class="lineno"></span><span class="comment" id="4376406">//&nbsp;in&nbsp;your&nbsp;browser.</span><br>
<span class="lineno"></span><span class="comment" id="4376426">//</span><br>
<span class="lineno">40</span><span class="comment" id="4376429">//&nbsp;For&nbsp;a&nbsp;study&nbsp;of&nbsp;the&nbsp;facility&nbsp;in&nbsp;action,&nbsp;visit</span><br>
<span class="lineno"></span><span class="comment" id="4376477">//</span><br>
<span class="lineno"></span><span class="comment" id="4376480">//&nbsp;&nbsp;&nbsp;&nbsphttp://blog.golang.org/2011/06/profiling-go-programs.html</span><br>
<span class="lineno"></span><span class="comment" id="4376541">//</span><br>
<span class="lineno"></span><span class="keyword" id="4376544">package</span>&nbsp;<span class="ident" id="4376552">pprof</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="4376559">import</span>&nbsp;<span class="op" id="4376566">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376569">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376578">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376587">&#34;fmt&#34;</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376594">&#34;html/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376611">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376617">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376624">&#34;net/http&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376636">&#34;os&#34;</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376642">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376653">&#34;runtime/pprof&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376670">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376681">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4376692">&#34;time&#34;</span><br>
<span class="lineno">60</span><span class="op" id="4376699">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4376702">func</span>&nbsp;<span class="ident" id="4376707">init</span><span class="op" id="4376711">(</span><span class="op" id="4376712">)</span>&nbsp;<span class="op" id="4376714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376717"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376721">.</span><span class="ident" id="4376722">Handle</span><span class="op" id="4376728">(</span><span class="string" id="4376729">&#34;/debug/pprof/&#34;</span><span class="op" id="4376744">,</span>&nbsp;<span class="ident" id="4376746"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376750">.</span><span class="ident" id="4376751">HandlerFunc</span><span class="op" id="4376762">(</span><span class="ident" id="4376763"><a href="/net/http/pprof/pprof.go.html#4380297">Index</a></span><span class="op" id="4376768">)</span><span class="op" id="4376769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376772"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376776">.</span><span class="ident" id="4376777">Handle</span><span class="op" id="4376783">(</span><span class="string" id="4376784">&#34;/debug/pprof/cmdline&#34;</span><span class="op" id="4376806">,</span>&nbsp;<span class="ident" id="4376808"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376812">.</span><span class="ident" id="4376813">HandlerFunc</span><span class="op" id="4376824">(</span><span class="ident" id="4376825"><a href="/net/http/pprof/pprof.go.html#4377140">Cmdline</a></span><span class="op" id="4376832">)</span><span class="op" id="4376833">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376836"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376840">.</span><span class="ident" id="4376841">Handle</span><span class="op" id="4376847">(</span><span class="string" id="4376848">&#34;/debug/pprof/profile&#34;</span><span class="op" id="4376870">,</span>&nbsp;<span class="ident" id="4376872"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376876">.</span><span class="ident" id="4376877">HandlerFunc</span><span class="op" id="4376888">(</span><span class="ident" id="4376889"><a href="/net/http/pprof/pprof.go.html#4377432">Profile</a></span><span class="op" id="4376896">)</span><span class="op" id="4376897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4376900"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376904">.</span><span class="ident" id="4376905">Handle</span><span class="op" id="4376911">(</span><span class="string" id="4376912">&#34;/debug/pprof/symbol&#34;</span><span class="op" id="4376933">,</span>&nbsp;<span class="ident" id="4376935"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4376939">.</span><span class="ident" id="4376940">HandlerFunc</span><span class="op" id="4376951">(</span><span class="ident" id="4376952"><a href="/net/http/pprof/pprof.go.html#4378361">Symbol</a></span><span class="op" id="4376958">)</span><span class="op" id="4376959">)</span><br>
<span class="lineno"></span><span class="op" id="4376961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4376964">//&nbsp;Cmdline&nbsp;responds&nbsp;with&nbsp;the&nbsp;running&nbsp;program&#39;s</span><br>
<span class="lineno">70</span><span class="comment" id="4377011">//&nbsp;command&nbsp;line,&nbsp;with&nbsp;arguments&nbsp;separated&nbsp;by&nbsp;NUL&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="comment" id="4377067">//&nbsp;The&nbsp;package&nbsp;initialization&nbsp;registers&nbsp;it&nbsp;as&nbsp;/debug/pprof/cmdline.</span><br>
<span class="lineno"></span><span class="keyword" id="4377135">func</span>&nbsp;<span class="ident" id="4377140">Cmdline</span><span class="op" id="4377147">(</span><span class="ident" id="4377148">w</span>&nbsp;<span class="ident" id="4377150"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4377154">.</span><span class="ident" id="4377155">ResponseWriter</span><span class="op" id="4377169">,</span>&nbsp;<span class="ident" id="4377171">r</span>&nbsp;<span class="op" id="4377173">*</span><span class="ident" id="4377174"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4377178">.</span><span class="ident" id="4377179">Request</span><span class="op" id="4377186">)</span>&nbsp;<span class="op" id="4377188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377191"><a href="/net/http/pprof/pprof.go.html#4377148">w</a></span><span class="op" id="4377192">.</span><span class="ident" id="4377193">Header</span><span class="op" id="4377199">(</span><span class="op" id="4377200">)</span><span class="op" id="4377201">.</span><span class="ident" id="4377202">Set</span><span class="op" id="4377205">(</span><span class="string" id="4377206">&#34;Content-Type&#34;</span><span class="op" id="4377220">,</span>&nbsp;<span class="string" id="4377222">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="4377249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377252"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4377255">.</span><span class="ident" id="4377256">Fprintf</span><span class="op" id="4377263">(</span><span class="ident" id="4377264"><a href="/net/http/pprof/pprof.go.html#4377148">w</a></span><span class="op" id="4377265">,</span>&nbsp;<span class="ident" id="4377267"><a href="/net/http/pprof/pprof.go.html#4376681">strings</a></span><span class="op" id="4377274">.</span><span class="ident" id="4377275">Join</span><span class="op" id="4377279">(</span><span class="ident" id="4377280"><a href="/net/http/pprof/pprof.go.html#4376636">os</a></span><span class="op" id="4377282">.</span><span class="ident" id="4377283">Args</span><span class="op" id="4377287">,</span>&nbsp;<span class="string" id="4377289">&#34;\x00&#34;</span><span class="op" id="4377295">)</span><span class="op" id="4377296">)</span><br>
<span class="lineno">75</span><span class="op" id="4377298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4377301">//&nbsp;Profile&nbsp;responds&nbsp;with&nbsp;the&nbsp;pprof-formatted&nbsp;cpu&nbsp;profile.</span><br>
<span class="lineno"></span><span class="comment" id="4377359">//&nbsp;The&nbsp;package&nbsp;initialization&nbsp;registers&nbsp;it&nbsp;as&nbsp;/debug/pprof/profile.</span><br>
<span class="lineno"></span><span class="keyword" id="4377427">func</span>&nbsp;<span class="ident" id="4377432">Profile</span><span class="op" id="4377439">(</span><span class="ident" id="4377440">w</span>&nbsp;<span class="ident" id="4377442"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4377446">.</span><span class="ident" id="4377447">ResponseWriter</span><span class="op" id="4377461">,</span>&nbsp;<span class="ident" id="4377463">r</span>&nbsp;<span class="op" id="4377465">*</span><span class="ident" id="4377466"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4377470">.</span><span class="ident" id="4377471">Request</span><span class="op" id="4377478">)</span>&nbsp;<span class="op" id="4377480">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377483">sec</span><span class="op" id="4377486">,</span>&nbsp;<span class="ident" id="4377488">_</span>&nbsp;<span class="op" id="4377490">:=</span>&nbsp;<span class="ident" id="4377493"><a href="/net/http/pprof/pprof.go.html#4376670">strconv</a></span><span class="op" id="4377500">.</span><span class="ident" id="4377501">ParseInt</span><span class="op" id="4377509">(</span><span class="ident" id="4377510"><a href="/net/http/pprof/pprof.go.html#4377463">r</a></span><span class="op" id="4377511">.</span><span class="ident" id="4377512">FormValue</span><span class="op" id="4377521">(</span><span class="string" id="4377522">&#34;seconds&#34;</span><span class="op" id="4377531">)</span><span class="op" id="4377532">,</span>&nbsp;<span class="num" id="4377534">10</span><span class="op" id="4377536">,</span>&nbsp;<span class="num" id="4377538">64</span><span class="op" id="4377540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377543">if</span>&nbsp;<span class="ident" id="4377546"><a href="/net/http/pprof/pprof.go.html#4377483">sec</a></span>&nbsp;<span class="op" id="4377550">==</span>&nbsp;<span class="num" id="4377553">0</span>&nbsp;<span class="op" id="4377555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377559"><a href="/net/http/pprof/pprof.go.html#4377483">sec</a></span>&nbsp;<span class="op" id="4377563">=</span>&nbsp;<span class="num" id="4377565">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4377569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377573">//&nbsp;Set&nbsp;Content&nbsp;Type&nbsp;assuming&nbsp;StartCPUProfile&nbsp;will&nbsp;work,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377630">//&nbsp;because&nbsp;if&nbsp;it&nbsp;does&nbsp;it&nbsp;starts&nbsp;writing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377672"><a href="/net/http/pprof/pprof.go.html#4377440">w</a></span><span class="op" id="4377673">.</span><span class="ident" id="4377674">Header</span><span class="op" id="4377680">(</span><span class="op" id="4377681">)</span><span class="op" id="4377682">.</span><span class="ident" id="4377683">Set</span><span class="op" id="4377686">(</span><span class="string" id="4377687">&#34;Content-Type&#34;</span><span class="op" id="4377701">,</span>&nbsp;<span class="string" id="4377703">&#34;application/octet-stream&#34;</span><span class="op" id="4377729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4377732">if</span>&nbsp;<span class="ident" id="4377735">err</span>&nbsp;<span class="op" id="4377739">:=</span>&nbsp;<span class="ident" id="4377742"><a href="/net/http/pprof/pprof.go.html#4376653">pprof</a></span><span class="op" id="4377747">.</span><span class="ident" id="4377748">StartCPUProfile</span><span class="op" id="4377763">(</span><span class="ident" id="4377764"><a href="/net/http/pprof/pprof.go.html#4377440">w</a></span><span class="op" id="4377765">)</span><span class="op" id="4377766">;</span>&nbsp;<span class="ident" id="4377768"><a href="/net/http/pprof/pprof.go.html#4377735">err</a></span>&nbsp;<span class="op" id="4377772">!=</span>&nbsp;<span class="ident" id="4377775">nil</span>&nbsp;<span class="op" id="4377779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377783">//&nbsp;StartCPUProfile&nbsp;failed,&nbsp;so&nbsp;no&nbsp;writes&nbsp;yet.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377830">//&nbsp;Can&nbsp;change&nbsp;header&nbsp;back&nbsp;to&nbsp;text&nbsp;content</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4377874">//&nbsp;and&nbsp;send&nbsp;error&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377900"><a href="/net/http/pprof/pprof.go.html#4377440">w</a></span><span class="op" id="4377901">.</span><span class="ident" id="4377902">Header</span><span class="op" id="4377908">(</span><span class="op" id="4377909">)</span><span class="op" id="4377910">.</span><span class="ident" id="4377911">Set</span><span class="op" id="4377914">(</span><span class="string" id="4377915">&#34;Content-Type&#34;</span><span class="op" id="4377929">,</span>&nbsp;<span class="string" id="4377931">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="4377958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4377962"><a href="/net/http/pprof/pprof.go.html#4377440">w</a></span><span class="op" id="4377963">.</span><span class="ident" id="4377964">WriteHeader</span><span class="op" id="4377975">(</span><span class="ident" id="4377976"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4377980">.</span><span class="ident" id="4377981">StatusInternalServerError</span><span class="op" id="4378006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378010"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4378013">.</span><span class="ident" id="4378014">Fprintf</span><span class="op" id="4378021">(</span><span class="ident" id="4378022"><a href="/net/http/pprof/pprof.go.html#4377440">w</a></span><span class="op" id="4378023">,</span>&nbsp;<span class="string" id="4378025">&#34;Could&nbsp;not&nbsp;enable&nbsp;CPU&nbsp;profiling:&nbsp;%s\n&#34;</span><span class="op" id="4378063">,</span>&nbsp;<span class="ident" id="4378065"><a href="/net/http/pprof/pprof.go.html#4377735">err</a></span><span class="op" id="4378068">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378072">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378083"><a href="/net/http/pprof/pprof.go.html#4376692">time</a></span><span class="op" id="4378087">.</span><span class="ident" id="4378088">Sleep</span><span class="op" id="4378093">(</span><span class="ident" id="4378094"><a href="/net/http/pprof/pprof.go.html#4376692">time</a></span><span class="op" id="4378098">.</span><span class="ident" id="4378099">Duration</span><span class="op" id="4378107">(</span><span class="ident" id="4378108"><a href="/net/http/pprof/pprof.go.html#4377483">sec</a></span><span class="op" id="4378111">)</span>&nbsp;<span class="op" id="4378113">*</span>&nbsp;<span class="ident" id="4378115"><a href="/net/http/pprof/pprof.go.html#4376692">time</a></span><span class="op" id="4378119">.</span><span class="ident" id="4378120">Second</span><span class="op" id="4378126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378129"><a href="/net/http/pprof/pprof.go.html#4376653">pprof</a></span><span class="op" id="4378134">.</span><span class="ident" id="4378135">StopCPUProfile</span><span class="op" id="4378149">(</span><span class="op" id="4378150">)</span><br>
<span class="lineno"></span><span class="op" id="4378152">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="4378155">//&nbsp;Symbol&nbsp;looks&nbsp;up&nbsp;the&nbsp;program&nbsp;counters&nbsp;listed&nbsp;in&nbsp;the&nbsp;request,</span><br>
<span class="lineno"></span><span class="comment" id="4378218">//&nbsp;responding&nbsp;with&nbsp;a&nbsp;table&nbsp;mapping&nbsp;program&nbsp;counters&nbsp;to&nbsp;function&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4378289">//&nbsp;The&nbsp;package&nbsp;initialization&nbsp;registers&nbsp;it&nbsp;as&nbsp;/debug/pprof/symbol.</span><br>
<span class="lineno"></span><span class="keyword" id="4378356">func</span>&nbsp;<span class="ident" id="4378361">Symbol</span><span class="op" id="4378367">(</span><span class="ident" id="4378368">w</span>&nbsp;<span class="ident" id="4378370"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4378374">.</span><span class="ident" id="4378375">ResponseWriter</span><span class="op" id="4378389">,</span>&nbsp;<span class="ident" id="4378391">r</span>&nbsp;<span class="op" id="4378393">*</span><span class="ident" id="4378394"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4378398">.</span><span class="ident" id="4378399">Request</span><span class="op" id="4378406">)</span>&nbsp;<span class="op" id="4378408">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378411"><a href="/net/http/pprof/pprof.go.html#4378368">w</a></span><span class="op" id="4378412">.</span><span class="ident" id="4378413">Header</span><span class="op" id="4378419">(</span><span class="op" id="4378420">)</span><span class="op" id="4378421">.</span><span class="ident" id="4378422">Set</span><span class="op" id="4378425">(</span><span class="string" id="4378426">&#34;Content-Type&#34;</span><span class="op" id="4378440">,</span>&nbsp;<span class="string" id="4378442">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="4378469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378473">//&nbsp;We&nbsp;have&nbsp;to&nbsp;read&nbsp;the&nbsp;whole&nbsp;POST&nbsp;body&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378520">//&nbsp;writing&nbsp;any&nbsp;output.&nbsp;&nbsp;Buffer&nbsp;the&nbsp;output&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378569">var</span>&nbsp;<span class="ident" id="4378573">buf</span>&nbsp;<span class="ident" id="4378577"><a href="/net/http/pprof/pprof.go.html#4376578">bytes</a></span><span class="op" id="4378582">.</span><span class="ident" id="4378583">Buffer</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378592">//&nbsp;We&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;many&nbsp;symbols&nbsp;we&nbsp;have,&nbsp;but&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378643">//&nbsp;do&nbsp;have&nbsp;symbol&nbsp;information.&nbsp;&nbsp;Pprof&nbsp;only&nbsp;cares&nbsp;whether</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4378701">//&nbsp;this&nbsp;number&nbsp;is&nbsp;0&nbsp;(no&nbsp;symbols&nbsp;available)&nbsp;or&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378753"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4378756">.</span><span class="ident" id="4378757">Fprintf</span><span class="op" id="4378764">(</span><span class="op" id="4378765">&amp;</span><span class="ident" id="4378766"><a href="/net/http/pprof/pprof.go.html#4378573">buf</a></span><span class="op" id="4378769">,</span>&nbsp;<span class="string" id="4378771">&#34;num_symbols:&nbsp;1\n&#34;</span><span class="op" id="4378789">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378793">var</span>&nbsp;<span class="ident" id="4378797">b</span>&nbsp;<span class="op" id="4378799">*</span><span class="ident" id="4378800"><a href="/net/http/pprof/pprof.go.html#4376569">bufio</a></span><span class="op" id="4378805">.</span><span class="ident" id="4378806">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378814">if</span>&nbsp;<span class="ident" id="4378817"><a href="/net/http/pprof/pprof.go.html#4378391">r</a></span><span class="op" id="4378818">.</span><span class="ident" id="4378819">Method</span>&nbsp;<span class="op" id="4378826">==</span>&nbsp;<span class="string" id="4378829">&#34;POST&#34;</span>&nbsp;<span class="op" id="4378836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378840"><a href="/net/http/pprof/pprof.go.html#4378797">b</a></span>&nbsp;<span class="op" id="4378842">=</span>&nbsp;<span class="ident" id="4378844"><a href="/net/http/pprof/pprof.go.html#4376569">bufio</a></span><span class="op" id="4378849">.</span><span class="ident" id="4378850">NewReader</span><span class="op" id="4378859">(</span><span class="ident" id="4378860"><a href="/net/http/pprof/pprof.go.html#4378391">r</a></span><span class="op" id="4378861">.</span><span class="ident" id="4378862">Body</span><span class="op" id="4378866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378869">}</span>&nbsp;<span class="keyword" id="4378871">else</span>&nbsp;<span class="op" id="4378876">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378880"><a href="/net/http/pprof/pprof.go.html#4378797">b</a></span>&nbsp;<span class="op" id="4378882">=</span>&nbsp;<span class="ident" id="4378884"><a href="/net/http/pprof/pprof.go.html#4376569">bufio</a></span><span class="op" id="4378889">.</span><span class="ident" id="4378890">NewReader</span><span class="op" id="4378899">(</span><span class="ident" id="4378900"><a href="/net/http/pprof/pprof.go.html#4376681">strings</a></span><span class="op" id="4378907">.</span><span class="ident" id="4378908">NewReader</span><span class="op" id="4378917">(</span><span class="ident" id="4378918"><a href="/net/http/pprof/pprof.go.html#4378391">r</a></span><span class="op" id="4378919">.</span><span class="ident" id="4378920">URL</span><span class="op" id="4378923">.</span><span class="ident" id="4378924">RawQuery</span><span class="op" id="4378932">)</span><span class="op" id="4378933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4378936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378940">for</span>&nbsp;<span class="op" id="4378944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378948">word</span><span class="op" id="4378952">,</span>&nbsp;<span class="ident" id="4378954">err</span>&nbsp;<span class="op" id="4378958">:=</span>&nbsp;<span class="ident" id="4378961"><a href="/net/http/pprof/pprof.go.html#4378797">b</a></span><span class="op" id="4378962">.</span><span class="ident" id="4378963">ReadSlice</span><span class="op" id="4378972">(</span><span class="string" id="4378973">&#39;+&#39;</span><span class="op" id="4378976">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4378980">if</span>&nbsp;<span class="ident" id="4378983"><a href="/net/http/pprof/pprof.go.html#4378954">err</a></span>&nbsp;<span class="op" id="4378987">==</span>&nbsp;<span class="ident" id="4378990">nil</span>&nbsp;<span class="op" id="4378994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4378999"><a href="/net/http/pprof/pprof.go.html#4378948">word</a></span>&nbsp;<span class="op" id="4379004">=</span>&nbsp;<span class="ident" id="4379006"><a href="/net/http/pprof/pprof.go.html#4378948">word</a></span><span class="op" id="4379010">[</span><span class="num" id="4379011">0</span>&nbsp;<span class="op" id="4379013">:</span>&nbsp;<span class="builtinfunc" id="4379015">len</span><span class="op" id="4379018">(</span><span class="ident" id="4379019"><a href="/net/http/pprof/pprof.go.html#4378948">word</a></span><span class="op" id="4379023">)</span><span class="op" id="4379024">-</span><span class="num" id="4379025">1</span><span class="op" id="4379026">]</span>&nbsp;<span class="comment" id="4379028">//&nbsp;trim&nbsp;+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379044">pc</span><span class="op" id="4379046">,</span>&nbsp;<span class="ident" id="4379048">_</span>&nbsp;<span class="op" id="4379050">:=</span>&nbsp;<span class="ident" id="4379053"><a href="/net/http/pprof/pprof.go.html#4376670">strconv</a></span><span class="op" id="4379060">.</span><span class="ident" id="4379061">ParseUint</span><span class="op" id="4379070">(</span><span class="builtintype" id="4379071">string</span><span class="op" id="4379077">(</span><span class="ident" id="4379078"><a href="/net/http/pprof/pprof.go.html#4378948">word</a></span><span class="op" id="4379082">)</span><span class="op" id="4379083">,</span>&nbsp;<span class="num" id="4379085">0</span><span class="op" id="4379086">,</span>&nbsp;<span class="num" id="4379088">64</span><span class="op" id="4379090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379094">if</span>&nbsp;<span class="ident" id="4379097"><a href="/net/http/pprof/pprof.go.html#4379044">pc</a></span>&nbsp;<span class="op" id="4379100">!=</span>&nbsp;<span class="num" id="4379103">0</span>&nbsp;<span class="op" id="4379105">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379110">f</span>&nbsp;<span class="op" id="4379112">:=</span>&nbsp;<span class="ident" id="4379115"><a href="/net/http/pprof/pprof.go.html#4376642">runtime</a></span><span class="op" id="4379122">.</span><span class="ident" id="4379123">FuncForPC</span><span class="op" id="4379132">(</span><span class="builtintype" id="4379133">uintptr</span><span class="op" id="4379140">(</span><span class="ident" id="4379141"><a href="/net/http/pprof/pprof.go.html#4379044">pc</a></span><span class="op" id="4379143">)</span><span class="op" id="4379144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379149">if</span>&nbsp;<span class="ident" id="4379152"><a href="/net/http/pprof/pprof.go.html#4379110">f</a></span>&nbsp;<span class="op" id="4379154">!=</span>&nbsp;<span class="ident" id="4379157">nil</span>&nbsp;<span class="op" id="4379161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379167"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4379170">.</span><span class="ident" id="4379171">Fprintf</span><span class="op" id="4379178">(</span><span class="op" id="4379179">&amp;</span><span class="ident" id="4379180"><a href="/net/http/pprof/pprof.go.html#4378573">buf</a></span><span class="op" id="4379183">,</span>&nbsp;<span class="string" id="4379185">&#34;%#x&nbsp;%s\n&#34;</span><span class="op" id="4379195">,</span>&nbsp;<span class="ident" id="4379197"><a href="/net/http/pprof/pprof.go.html#4379044">pc</a></span><span class="op" id="4379199">,</span>&nbsp;<span class="ident" id="4379201"><a href="/net/http/pprof/pprof.go.html#4379110">f</a></span><span class="op" id="4379202">.</span><span class="ident" id="4379203">Name</span><span class="op" id="4379207">(</span><span class="op" id="4379208">)</span><span class="op" id="4379209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379218">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379223">//&nbsp;Wait&nbsp;until&nbsp;here&nbsp;to&nbsp;check&nbsp;for&nbsp;err;&nbsp;the&nbsp;last</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4379271">//&nbsp;symbol&nbsp;will&nbsp;have&nbsp;an&nbsp;err&nbsp;because&nbsp;it&nbsp;doesn&#39;t&nbsp;end&nbsp;in&nbsp;+.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379329">if</span>&nbsp;<span class="ident" id="4379332"><a href="/net/http/pprof/pprof.go.html#4378954">err</a></span>&nbsp;<span class="op" id="4379336">!=</span>&nbsp;<span class="ident" id="4379339">nil</span>&nbsp;<span class="op" id="4379343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379348">if</span>&nbsp;<span class="ident" id="4379351"><a href="/net/http/pprof/pprof.go.html#4378954">err</a></span>&nbsp;<span class="op" id="4379355">!=</span>&nbsp;<span class="ident" id="4379358"><a href="/net/http/pprof/pprof.go.html#4376611">io</a></span><span class="op" id="4379360">.</span><span class="ident" id="4379361">EOF</span>&nbsp;<span class="op" id="4379365">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379371"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4379374">.</span><span class="ident" id="4379375">Fprintf</span><span class="op" id="4379382">(</span><span class="op" id="4379383">&amp;</span><span class="ident" id="4379384"><a href="/net/http/pprof/pprof.go.html#4378573">buf</a></span><span class="op" id="4379387">,</span>&nbsp;<span class="string" id="4379389">&#34;reading&nbsp;request:&nbsp;%v\n&#34;</span><span class="op" id="4379412">,</span>&nbsp;<span class="ident" id="4379414"><a href="/net/http/pprof/pprof.go.html#4378954">err</a></span><span class="op" id="4379417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379427">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379438">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379442"><a href="/net/http/pprof/pprof.go.html#4378368">w</a></span><span class="op" id="4379443">.</span><span class="ident" id="4379444">Write</span><span class="op" id="4379449">(</span><span class="ident" id="4379450"><a href="/net/http/pprof/pprof.go.html#4378573">buf</a></span><span class="op" id="4379453">.</span><span class="ident" id="4379454">Bytes</span><span class="op" id="4379459">(</span><span class="op" id="4379460">)</span><span class="op" id="4379461">)</span><br>
<span class="lineno"></span><span class="op" id="4379463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4379466">//&nbsp;Handler&nbsp;returns&nbsp;an&nbsp;HTTP&nbsp;handler&nbsp;that&nbsp;serves&nbsp;the&nbsp;named&nbsp;profile.</span><br>
<span class="lineno">150</span><span class="keyword" id="4379532">func</span>&nbsp;<span class="ident" id="4379537">Handler</span><span class="op" id="4379544">(</span><span class="ident" id="4379545">name</span>&nbsp;<span class="builtintype" id="4379550">string</span><span class="op" id="4379556">)</span>&nbsp;<span class="ident" id="4379558"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4379562">.</span><span class="ident" id="4379563">Handler</span>&nbsp;<span class="op" id="4379571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379574">return</span>&nbsp;<span class="ident" id="4379581"><a href="/net/http/pprof/pprof.go.html#4379603">handler</a></span><span class="op" id="4379588">(</span><span class="ident" id="4379589"><a href="/net/http/pprof/pprof.go.html#4379545">name</a></span><span class="op" id="4379593">)</span><br>
<span class="lineno"></span><span class="op" id="4379595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4379598">type</span>&nbsp;<span class="ident" id="4379603">handler</span>&nbsp;<span class="builtintype" id="4379611">string</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="keyword" id="4379619">func</span>&nbsp;<span class="op" id="4379624">(</span><span class="ident" id="4379625">name</span>&nbsp;<span class="ident" id="4379630"><a href="/net/http/pprof/pprof.go.html#4379603">handler</a></span><span class="op" id="4379637">)</span>&nbsp;<span class="ident" id="4379639">ServeHTTP</span><span class="op" id="4379648">(</span><span class="ident" id="4379649">w</span>&nbsp;<span class="ident" id="4379651"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4379655">.</span><span class="ident" id="4379656">ResponseWriter</span><span class="op" id="4379670">,</span>&nbsp;<span class="ident" id="4379672">r</span>&nbsp;<span class="op" id="4379674">*</span><span class="ident" id="4379675"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4379679">.</span><span class="ident" id="4379680">Request</span><span class="op" id="4379687">)</span>&nbsp;<span class="op" id="4379689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379692"><a href="/net/http/pprof/pprof.go.html#4379649">w</a></span><span class="op" id="4379693">.</span><span class="ident" id="4379694">Header</span><span class="op" id="4379700">(</span><span class="op" id="4379701">)</span><span class="op" id="4379702">.</span><span class="ident" id="4379703">Set</span><span class="op" id="4379706">(</span><span class="string" id="4379707">&#34;Content-Type&#34;</span><span class="op" id="4379721">,</span>&nbsp;<span class="string" id="4379723">&#34;text/plain;&nbsp;charset=utf-8&#34;</span><span class="op" id="4379750">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379753">debug</span><span class="op" id="4379758">,</span>&nbsp;<span class="ident" id="4379760">_</span>&nbsp;<span class="op" id="4379762">:=</span>&nbsp;<span class="ident" id="4379765"><a href="/net/http/pprof/pprof.go.html#4376670">strconv</a></span><span class="op" id="4379772">.</span><span class="ident" id="4379773">Atoi</span><span class="op" id="4379777">(</span><span class="ident" id="4379778"><a href="/net/http/pprof/pprof.go.html#4379672">r</a></span><span class="op" id="4379779">.</span><span class="ident" id="4379780">FormValue</span><span class="op" id="4379789">(</span><span class="string" id="4379790">&#34;debug&#34;</span><span class="op" id="4379797">)</span><span class="op" id="4379798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379801">p</span>&nbsp;<span class="op" id="4379803">:=</span>&nbsp;<span class="ident" id="4379806"><a href="/net/http/pprof/pprof.go.html#4376653">pprof</a></span><span class="op" id="4379811">.</span><span class="ident" id="4379812">Lookup</span><span class="op" id="4379818">(</span><span class="builtintype" id="4379819">string</span><span class="op" id="4379825">(</span><span class="ident" id="4379826"><a href="/net/http/pprof/pprof.go.html#4379625">name</a></span><span class="op" id="4379830">)</span><span class="op" id="4379831">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379834">if</span>&nbsp;<span class="ident" id="4379837"><a href="/net/http/pprof/pprof.go.html#4379801">p</a></span>&nbsp;<span class="op" id="4379839">==</span>&nbsp;<span class="ident" id="4379842">nil</span>&nbsp;<span class="op" id="4379846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379850"><a href="/net/http/pprof/pprof.go.html#4379649">w</a></span><span class="op" id="4379851">.</span><span class="ident" id="4379852">WriteHeader</span><span class="op" id="4379863">(</span><span class="num" id="4379864">404</span><span class="op" id="4379867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379871"><a href="/net/http/pprof/pprof.go.html#4376587">fmt</a></span><span class="op" id="4379874">.</span><span class="ident" id="4379875">Fprintf</span><span class="op" id="4379882">(</span><span class="ident" id="4379883"><a href="/net/http/pprof/pprof.go.html#4379649">w</a></span><span class="op" id="4379884">,</span>&nbsp;<span class="string" id="4379886">&#34;Unknown&nbsp;profile:&nbsp;%s\n&#34;</span><span class="op" id="4379909">,</span>&nbsp;<span class="ident" id="4379911"><a href="/net/http/pprof/pprof.go.html#4379625">name</a></span><span class="op" id="4379915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379919">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4379927">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4379930">gc</span><span class="op" id="4379932">,</span>&nbsp;<span class="ident" id="4379934">_</span>&nbsp;<span class="op" id="4379936">:=</span>&nbsp;<span class="ident" id="4379939"><a href="/net/http/pprof/pprof.go.html#4376670">strconv</a></span><span class="op" id="4379946">.</span><span class="ident" id="4379947">Atoi</span><span class="op" id="4379951">(</span><span class="ident" id="4379952"><a href="/net/http/pprof/pprof.go.html#4379672">r</a></span><span class="op" id="4379953">.</span><span class="ident" id="4379954">FormValue</span><span class="op" id="4379963">(</span><span class="string" id="4379964">&#34;gc&#34;</span><span class="op" id="4379968">)</span><span class="op" id="4379969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4379972">if</span>&nbsp;<span class="ident" id="4379975"><a href="/net/http/pprof/pprof.go.html#4379625">name</a></span>&nbsp;<span class="op" id="4379980">==</span>&nbsp;<span class="string" id="4379983">&#34;heap&#34;</span>&nbsp;<span class="op" id="4379990">&amp;&amp;</span>&nbsp;<span class="ident" id="4379993"><a href="/net/http/pprof/pprof.go.html#4379930">gc</a></span>&nbsp;<span class="op" id="4379996">&gt;</span>&nbsp;<span class="num" id="4379998">0</span>&nbsp;<span class="op" id="4380000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380004"><a href="/net/http/pprof/pprof.go.html#4376642">runtime</a></span><span class="op" id="4380011">.</span><span class="ident" id="4380012">GC</span><span class="op" id="4380014">(</span><span class="op" id="4380015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380021"><a href="/net/http/pprof/pprof.go.html#4379801">p</a></span><span class="op" id="4380022">.</span><span class="ident" id="4380023">WriteTo</span><span class="op" id="4380030">(</span><span class="ident" id="4380031"><a href="/net/http/pprof/pprof.go.html#4379649">w</a></span><span class="op" id="4380032">,</span>&nbsp;<span class="ident" id="4380034"><a href="/net/http/pprof/pprof.go.html#4379753">debug</a></span><span class="op" id="4380039">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380042">return</span><br>
<span class="lineno"></span><span class="op" id="4380049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4380052">//&nbsp;Index&nbsp;responds&nbsp;with&nbsp;the&nbsp;pprof-formatted&nbsp;profile&nbsp;named&nbsp;by&nbsp;the&nbsp;request.</span><br>
<span class="lineno"></span><span class="comment" id="4380125">//&nbsp;For&nbsp;example,&nbsp;&#34;/debug/pprof/heap&#34;&nbsp;serves&nbsp;the&nbsp;&#34;heap&#34;&nbsp;profile.</span><br>
<span class="lineno">175</span><span class="comment" id="4380188">//&nbsp;Index&nbsp;responds&nbsp;to&nbsp;a&nbsp;request&nbsp;for&nbsp;&#34;/debug/pprof/&#34;&nbsp;with&nbsp;an&nbsp;HTML&nbsp;page</span><br>
<span class="lineno"></span><span class="comment" id="4380257">//&nbsp;listing&nbsp;the&nbsp;available&nbsp;profiles.</span><br>
<span class="lineno"></span><span class="keyword" id="4380292">func</span>&nbsp;<span class="ident" id="4380297">Index</span><span class="op" id="4380302">(</span><span class="ident" id="4380303">w</span>&nbsp;<span class="ident" id="4380305"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4380309">.</span><span class="ident" id="4380310">ResponseWriter</span><span class="op" id="4380324">,</span>&nbsp;<span class="ident" id="4380326">r</span>&nbsp;<span class="op" id="4380328">*</span><span class="ident" id="4380329"><a href="/net/http/pprof/pprof.go.html#4376624">http</a></span><span class="op" id="4380333">.</span><span class="ident" id="4380334">Request</span><span class="op" id="4380341">)</span>&nbsp;<span class="op" id="4380343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380346">if</span>&nbsp;<span class="ident" id="4380349"><a href="/net/http/pprof/pprof.go.html#4376681">strings</a></span><span class="op" id="4380356">.</span><span class="ident" id="4380357">HasPrefix</span><span class="op" id="4380366">(</span><span class="ident" id="4380367"><a href="/net/http/pprof/pprof.go.html#4380326">r</a></span><span class="op" id="4380368">.</span><span class="ident" id="4380369">URL</span><span class="op" id="4380372">.</span><span class="ident" id="4380373">Path</span><span class="op" id="4380377">,</span>&nbsp;<span class="string" id="4380379">&#34;/debug/pprof/&#34;</span><span class="op" id="4380394">)</span>&nbsp;<span class="op" id="4380396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380400">name</span>&nbsp;<span class="op" id="4380405">:=</span>&nbsp;<span class="ident" id="4380408"><a href="/net/http/pprof/pprof.go.html#4376681">strings</a></span><span class="op" id="4380415">.</span><span class="ident" id="4380416">TrimPrefix</span><span class="op" id="4380426">(</span><span class="ident" id="4380427"><a href="/net/http/pprof/pprof.go.html#4380326">r</a></span><span class="op" id="4380428">.</span><span class="ident" id="4380429">URL</span><span class="op" id="4380432">.</span><span class="ident" id="4380433">Path</span><span class="op" id="4380437">,</span>&nbsp;<span class="string" id="4380439">&#34;/debug/pprof/&#34;</span><span class="op" id="4380454">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380458">if</span>&nbsp;<span class="ident" id="4380461"><a href="/net/http/pprof/pprof.go.html#4380400">name</a></span>&nbsp;<span class="op" id="4380466">!=</span>&nbsp;<span class="string" id="4380469">&#34;&#34;</span>&nbsp;<span class="op" id="4380472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380477"><a href="/net/http/pprof/pprof.go.html#4379603">handler</a></span><span class="op" id="4380484">(</span><span class="ident" id="4380485"><a href="/net/http/pprof/pprof.go.html#4380400">name</a></span><span class="op" id="4380489">)</span><span class="op" id="4380490">.</span><span class="ident" id="4380491">ServeHTTP</span><span class="op" id="4380500">(</span><span class="ident" id="4380501"><a href="/net/http/pprof/pprof.go.html#4380303">w</a></span><span class="op" id="4380502">,</span>&nbsp;<span class="ident" id="4380504"><a href="/net/http/pprof/pprof.go.html#4380326">r</a></span><span class="op" id="4380505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380510">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380519">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380522">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380526">profiles</span>&nbsp;<span class="op" id="4380535">:=</span>&nbsp;<span class="ident" id="4380538"><a href="/net/http/pprof/pprof.go.html#4376653">pprof</a></span><span class="op" id="4380543">.</span><span class="ident" id="4380544">Profiles</span><span class="op" id="4380552">(</span><span class="op" id="4380553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4380556">if</span>&nbsp;<span class="ident" id="4380559">err</span>&nbsp;<span class="op" id="4380563">:=</span>&nbsp;<span class="ident" id="4380566"><a href="/net/http/pprof/pprof.go.html#4380638">indexTmpl</a></span><span class="op" id="4380575">.</span><span class="ident" id="4380576">Execute</span><span class="op" id="4380583">(</span><span class="ident" id="4380584"><a href="/net/http/pprof/pprof.go.html#4380303">w</a></span><span class="op" id="4380585">,</span>&nbsp;<span class="ident" id="4380587"><a href="/net/http/pprof/pprof.go.html#4380526">profiles</a></span><span class="op" id="4380595">)</span><span class="op" id="4380596">;</span>&nbsp;<span class="ident" id="4380598"><a href="/net/http/pprof/pprof.go.html#4380559">err</a></span>&nbsp;<span class="op" id="4380602">!=</span>&nbsp;<span class="ident" id="4380605">nil</span>&nbsp;<span class="op" id="4380609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4380613"><a href="/net/http/pprof/pprof.go.html#4376617">log</a></span><span class="op" id="4380616">.</span><span class="ident" id="4380617">Print</span><span class="op" id="4380622">(</span><span class="ident" id="4380623"><a href="/net/http/pprof/pprof.go.html#4380559">err</a></span><span class="op" id="4380626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4380629">}</span><br>
<span class="lineno">190</span><span class="op" id="4380631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4380634">var</span>&nbsp;<span class="ident" id="4380638">indexTmpl</span>&nbsp;<span class="op" id="4380648">=</span>&nbsp;<span class="ident" id="4380650"><a href="/net/http/pprof/pprof.go.html#4376594">template</a></span><span class="op" id="4380658">.</span><span class="ident" id="4380659">Must</span><span class="op" id="4380663">(</span><span class="ident" id="4380664"><a href="/net/http/pprof/pprof.go.html#4376594">template</a></span><span class="op" id="4380672">.</span><span class="ident" id="4380673">New</span><span class="op" id="4380676">(</span><span class="string" id="4380677">&#34;index&#34;</span><span class="op" id="4380684">)</span><span class="op" id="4380685">.</span><span class="ident" id="4380686">Parse</span><span class="op" id="4380691">(</span><span class="string" id="4380692">`&lt;html&gt;<br>
<span class="lineno"></span>&lt;head&gt;<br>
<span class="lineno"></span>&lt;title&gt;/debug/pprof/&lt;/title&gt;<br>
<span class="lineno">195</span>&lt;/head&gt;<br>
<span class="lineno"></span>/debug/pprof/&lt;br&gt;<br>
<span class="lineno"></span>&lt;br&gt;<br>
<span class="lineno"></span>&lt;body&gt;<br>
<span class="lineno"></span>profiles:&lt;br&gt;<br>
<span class="lineno">200</span>&lt;table&gt;<br>
<span class="lineno"></span>{{range&nbsp;.}}<br>
<span class="lineno"></span>&lt;tr&gt;&lt;td&nbsp;align=right&gt;{{.Count}}&lt;td&gt;&lt;a&nbsp;href=&#34;/debug/pprof/{{.Name}}?debug=1&#34;&gt;{{.Name}}&lt;/a&gt;<br>
<span class="lineno"></span>{{end}}<br>
<span class="lineno"></span>&lt;/table&gt;<br>
<span class="lineno">205</span>&lt;br&gt;<br>
<span class="lineno"></span>&lt;a&nbsp;href=&#34;/debug/pprof/goroutine?debug=2&#34;&gt;full&nbsp;goroutine&nbsp;stack&nbsp;dump&lt;/a&gt;&lt;br&gt;<br>
<span class="lineno"></span>&lt;/body&gt;<br>
<span class="lineno"></span>&lt;/html&gt;<br>
<span class="lineno"></span>`</span><span class="op" id="4381011">)</span><span class="op" id="4381012">)</span>
</div>
</body>
</html>
