<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html" class="current">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7838752">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7838808">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7838862">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7838913">package</span>&nbsp;<span class="ident" id="7838921">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838931">import</span>&nbsp;<span class="op" id="7838938">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838941">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838953">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7838963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7838966">var</span>&nbsp;<span class="ident" id="7838970">toFromBigTests</span>&nbsp;<span class="op" id="7838985">=</span>&nbsp;<span class="op" id="7838987">[</span><span class="op" id="7838988">]</span><span class="builtintype" id="7838989">string</span><span class="op" id="7838995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7838998">&#34;0&#34;</span><span class="op" id="7839001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839004">&#34;1&#34;</span><span class="op" id="7839007">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839010">&#34;23&#34;</span><span class="op" id="7839014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839017">&#34;b70e0cb46bb4bf7f321390b94a03c1d356c01122343280d6105c1d21&#34;</span><span class="op" id="7839075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7839078">&#34;706a46d476dcb76798e6046d89474788d164c18032d268fd10704fa6&#34;</span><span class="op" id="7839136">,</span><br>
<span class="lineno"></span><span class="op" id="7839138">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="7839141">func</span>&nbsp;<span class="ident" id="7839146">p224AlternativeToBig</span><span class="op" id="7839166">(</span><span class="ident" id="7839167">in</span>&nbsp;<span class="op" id="7839170">*</span><span class="ident" id="7839171">p224FieldElement</span><span class="op" id="7839187">)</span>&nbsp;<span class="op" id="7839189">*</span><span class="ident" id="7839190">big</span><span class="op" id="7839193">.</span><span class="ident" id="7839194">Int</span>&nbsp;<span class="op" id="7839198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839201">ret</span>&nbsp;<span class="op" id="7839205">:=</span>&nbsp;<span class="builtinfunc" id="7839208">new</span><span class="op" id="7839211">(</span><span class="ident" id="7839212">big</span><span class="op" id="7839215">.</span><span class="ident" id="7839216">Int</span><span class="op" id="7839219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839222">tmp</span>&nbsp;<span class="op" id="7839226">:=</span>&nbsp;<span class="builtinfunc" id="7839229">new</span><span class="op" id="7839232">(</span><span class="ident" id="7839233">big</span><span class="op" id="7839236">.</span><span class="ident" id="7839237">Int</span><span class="op" id="7839240">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839244">for</span>&nbsp;<span class="ident" id="7839248">i</span>&nbsp;<span class="op" id="7839250">:=</span>&nbsp;<span class="builtintype" id="7839253">uint</span><span class="op" id="7839257">(</span><span class="num" id="7839258">0</span><span class="op" id="7839259">)</span><span class="op" id="7839260">;</span>&nbsp;<span class="ident" id="7839262">i</span>&nbsp;<span class="op" id="7839264">&lt;</span>&nbsp;<span class="num" id="7839266">8</span><span class="op" id="7839267">;</span>&nbsp;<span class="ident" id="7839269">i</span><span class="op" id="7839270">++</span>&nbsp;<span class="op" id="7839273">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839277">tmp</span><span class="op" id="7839280">.</span><span class="ident" id="7839281">SetInt64</span><span class="op" id="7839289">(</span><span class="ident" id="7839290">int64</span><span class="op" id="7839295">(</span><span class="ident" id="7839296">in</span><span class="op" id="7839298">[</span><span class="ident" id="7839299">i</span><span class="op" id="7839300">]</span><span class="op" id="7839301">)</span><span class="op" id="7839302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839306">tmp</span><span class="op" id="7839309">.</span><span class="ident" id="7839310">Lsh</span><span class="op" id="7839313">(</span><span class="ident" id="7839314">tmp</span><span class="op" id="7839317">,</span>&nbsp;<span class="num" id="7839319">28</span><span class="op" id="7839321">*</span><span class="ident" id="7839322">i</span><span class="op" id="7839323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839327">ret</span><span class="op" id="7839330">.</span><span class="ident" id="7839331">Add</span><span class="op" id="7839334">(</span><span class="ident" id="7839335">ret</span><span class="op" id="7839338">,</span>&nbsp;<span class="ident" id="7839340">tmp</span><span class="op" id="7839343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839349">ret</span><span class="op" id="7839352">.</span><span class="ident" id="7839353">Mod</span><span class="op" id="7839356">(</span><span class="ident" id="7839357">ret</span><span class="op" id="7839360">,</span>&nbsp;<span class="ident" id="7839362">p224</span><span class="op" id="7839366">.</span><span class="ident" id="7839367">P</span><span class="op" id="7839368">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839371">return</span>&nbsp;<span class="ident" id="7839378">ret</span><br>
<span class="lineno"></span><span class="op" id="7839382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7839385">func</span>&nbsp;<span class="ident" id="7839390">TestToFromBig</span><span class="op" id="7839403">(</span><span class="ident" id="7839404">t</span>&nbsp;<span class="op" id="7839406">*</span><span class="ident" id="7839407">testing</span><span class="op" id="7839414">.</span><span class="ident" id="7839415">T</span><span class="op" id="7839416">)</span>&nbsp;<span class="op" id="7839418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839421">for</span>&nbsp;<span class="ident" id="7839425">i</span><span class="op" id="7839426">,</span>&nbsp;<span class="ident" id="7839428">test</span>&nbsp;<span class="op" id="7839433">:=</span>&nbsp;<span class="keyword" id="7839436">range</span>&nbsp;<span class="ident" id="7839442">toFromBigTests</span>&nbsp;<span class="op" id="7839457">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839461">n</span><span class="op" id="7839462">,</span>&nbsp;<span class="ident" id="7839464">_</span>&nbsp;<span class="op" id="7839466">:=</span>&nbsp;<span class="builtinfunc" id="7839469">new</span><span class="op" id="7839472">(</span><span class="ident" id="7839473">big</span><span class="op" id="7839476">.</span><span class="ident" id="7839477">Int</span><span class="op" id="7839480">)</span><span class="op" id="7839481">.</span><span class="ident" id="7839482">SetString</span><span class="op" id="7839491">(</span><span class="ident" id="7839492">test</span><span class="op" id="7839496">,</span>&nbsp;<span class="num" id="7839498">16</span><span class="op" id="7839500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839504">var</span>&nbsp;<span class="ident" id="7839508">x</span>&nbsp;<span class="ident" id="7839510">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839529">p224FromBig</span><span class="op" id="7839540">(</span><span class="op" id="7839541">&amp;</span><span class="ident" id="7839542">x</span><span class="op" id="7839543">,</span>&nbsp;<span class="ident" id="7839545">n</span><span class="op" id="7839546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839550">m</span>&nbsp;<span class="op" id="7839552">:=</span>&nbsp;<span class="ident" id="7839555">p224ToBig</span><span class="op" id="7839564">(</span><span class="op" id="7839565">&amp;</span><span class="ident" id="7839566">x</span><span class="op" id="7839567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839571">if</span>&nbsp;<span class="ident" id="7839574">n</span><span class="op" id="7839575">.</span><span class="ident" id="7839576">Cmp</span><span class="op" id="7839579">(</span><span class="ident" id="7839580">m</span><span class="op" id="7839581">)</span>&nbsp;<span class="op" id="7839583">!=</span>&nbsp;<span class="num" id="7839586">0</span>&nbsp;<span class="op" id="7839588">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839593">t</span><span class="op" id="7839594">.</span><span class="ident" id="7839595">Errorf</span><span class="op" id="7839601">(</span><span class="string" id="7839602">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&#34;</span><span class="op" id="7839617">,</span>&nbsp;<span class="ident" id="7839619">i</span><span class="op" id="7839620">,</span>&nbsp;<span class="ident" id="7839622">n</span><span class="op" id="7839623">,</span>&nbsp;<span class="ident" id="7839625">m</span><span class="op" id="7839626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839634">q</span>&nbsp;<span class="op" id="7839636">:=</span>&nbsp;<span class="ident" id="7839639">p224AlternativeToBig</span><span class="op" id="7839659">(</span><span class="op" id="7839660">&amp;</span><span class="ident" id="7839661">x</span><span class="op" id="7839662">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7839666">if</span>&nbsp;<span class="ident" id="7839669">n</span><span class="op" id="7839670">.</span><span class="ident" id="7839671">Cmp</span><span class="op" id="7839674">(</span><span class="ident" id="7839675">q</span><span class="op" id="7839676">)</span>&nbsp;<span class="op" id="7839678">!=</span>&nbsp;<span class="num" id="7839681">0</span>&nbsp;<span class="op" id="7839683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7839688">t</span><span class="op" id="7839689">.</span><span class="ident" id="7839690">Errorf</span><span class="op" id="7839696">(</span><span class="string" id="7839697">&#34;#%d:&nbsp;%x&nbsp;!=&nbsp;%x&nbsp;(alternative)&#34;</span><span class="op" id="7839726">,</span>&nbsp;<span class="ident" id="7839728">i</span><span class="op" id="7839729">,</span>&nbsp;<span class="ident" id="7839731">n</span><span class="op" id="7839732">,</span>&nbsp;<span class="ident" id="7839734">m</span><span class="op" id="7839735">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839739">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7839742">}</span><br>
<span class="lineno"></span><span class="op" id="7839744">}</span>
</div>
</body>
</html>
