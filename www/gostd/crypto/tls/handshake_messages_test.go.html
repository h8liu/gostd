<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7918525">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7918580">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7918634">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7918685">package</span>&nbsp;<span class="ident" id="7918693">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7918698">import</span>&nbsp;<span class="op" id="7918705">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7918708">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7918721">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7918732">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7918743">&#34;testing/quick&#34;</span><br>
<span class="lineno"></span><span class="op" id="7918759">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7918762">var</span>&nbsp;<span class="ident" id="7918766">tests</span>&nbsp;<span class="op" id="7918772">=</span>&nbsp;<span class="op" id="7918774">[</span><span class="op" id="7918775">]</span><span class="keyword" id="7918776">interface</span><span class="op" id="7918785">{</span><span class="op" id="7918786">}</span><span class="op" id="7918787">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918790">&amp;</span><span class="ident" id="7918791">clientHelloMsg</span><span class="op" id="7918805">{</span><span class="op" id="7918806">}</span><span class="op" id="7918807">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918810">&amp;</span><span class="ident" id="7918811">serverHelloMsg</span><span class="op" id="7918825">{</span><span class="op" id="7918826">}</span><span class="op" id="7918827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918830">&amp;</span><span class="ident" id="7918831">finishedMsg</span><span class="op" id="7918842">{</span><span class="op" id="7918843">}</span><span class="op" id="7918844">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918848">&amp;</span><span class="ident" id="7918849">certificateMsg</span><span class="op" id="7918863">{</span><span class="op" id="7918864">}</span><span class="op" id="7918865">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918868">&amp;</span><span class="ident" id="7918869">certificateRequestMsg</span><span class="op" id="7918890">{</span><span class="op" id="7918891">}</span><span class="op" id="7918892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918895">&amp;</span><span class="ident" id="7918896">certificateVerifyMsg</span><span class="op" id="7918916">{</span><span class="op" id="7918917">}</span><span class="op" id="7918918">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918921">&amp;</span><span class="ident" id="7918922">certificateStatusMsg</span><span class="op" id="7918942">{</span><span class="op" id="7918943">}</span><span class="op" id="7918944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918947">&amp;</span><span class="ident" id="7918948">clientKeyExchangeMsg</span><span class="op" id="7918968">{</span><span class="op" id="7918969">}</span><span class="op" id="7918970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918973">&amp;</span><span class="ident" id="7918974">nextProtoMsg</span><span class="op" id="7918986">{</span><span class="op" id="7918987">}</span><span class="op" id="7918988">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7918991">&amp;</span><span class="ident" id="7918992">newSessionTicketMsg</span><span class="op" id="7919011">{</span><span class="op" id="7919012">}</span><span class="op" id="7919013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919016">&amp;</span><span class="ident" id="7919017">sessionState</span><span class="op" id="7919029">{</span><span class="op" id="7919030">}</span><span class="op" id="7919031">,</span><br>
<span class="lineno"></span><span class="op" id="7919033">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7919036">type</span>&nbsp;<span class="ident" id="7919041">testMessage</span>&nbsp;<span class="keyword" id="7919053">interface</span>&nbsp;<span class="op" id="7919063">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919066">marshal</span><span class="op" id="7919073">(</span><span class="op" id="7919074">)</span>&nbsp;<span class="op" id="7919076">[</span><span class="op" id="7919077">]</span><span class="builtintype" id="7919078">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919084">unmarshal</span><span class="op" id="7919093">(</span><span class="op" id="7919094">[</span><span class="op" id="7919095">]</span><span class="builtintype" id="7919096">byte</span><span class="op" id="7919100">)</span>&nbsp;<span class="builtintype" id="7919102">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919108">equal</span><span class="op" id="7919113">(</span><span class="keyword" id="7919114">interface</span><span class="op" id="7919123">{</span><span class="op" id="7919124">}</span><span class="op" id="7919125">)</span>&nbsp;<span class="builtintype" id="7919127">bool</span><br>
<span class="lineno"></span><span class="op" id="7919132">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7919135">func</span>&nbsp;<span class="ident" id="7919140">TestMarshalUnmarshal</span><span class="op" id="7919160">(</span><span class="ident" id="7919161">t</span>&nbsp;<span class="op" id="7919163">*</span><span class="ident" id="7919164">testing</span><span class="op" id="7919171">.</span><span class="ident" id="7919172">T</span><span class="op" id="7919173">)</span>&nbsp;<span class="op" id="7919175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919178">rand</span>&nbsp;<span class="op" id="7919183">:=</span>&nbsp;<span class="ident" id="7919186">rand</span><span class="op" id="7919190">.</span><span class="ident" id="7919191">New</span><span class="op" id="7919194">(</span><span class="ident" id="7919195">rand</span><span class="op" id="7919199">.</span><span class="ident" id="7919200">NewSource</span><span class="op" id="7919209">(</span><span class="num" id="7919210">0</span><span class="op" id="7919211">)</span><span class="op" id="7919212">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919216">for</span>&nbsp;<span class="ident" id="7919220">i</span><span class="op" id="7919221">,</span>&nbsp;<span class="ident" id="7919223">iface</span>&nbsp;<span class="op" id="7919229">:=</span>&nbsp;<span class="keyword" id="7919232">range</span>&nbsp;<span class="ident" id="7919238">tests</span>&nbsp;<span class="op" id="7919244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919248">ty</span>&nbsp;<span class="op" id="7919251">:=</span>&nbsp;<span class="ident" id="7919254">reflect</span><span class="op" id="7919261">.</span><span class="ident" id="7919262">ValueOf</span><span class="op" id="7919269">(</span><span class="ident" id="7919270">iface</span><span class="op" id="7919275">)</span><span class="op" id="7919276">.</span><span class="ident" id="7919277">Type</span><span class="op" id="7919281">(</span><span class="op" id="7919282">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919287">n</span>&nbsp;<span class="op" id="7919289">:=</span>&nbsp;<span class="num" id="7919292">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919298">if</span>&nbsp;<span class="ident" id="7919301">testing</span><span class="op" id="7919308">.</span><span class="ident" id="7919309">Short</span><span class="op" id="7919314">(</span><span class="op" id="7919315">)</span>&nbsp;<span class="op" id="7919317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919322">n</span>&nbsp;<span class="op" id="7919324">=</span>&nbsp;<span class="num" id="7919326">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919330">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919334">for</span>&nbsp;<span class="ident" id="7919338">j</span>&nbsp;<span class="op" id="7919340">:=</span>&nbsp;<span class="num" id="7919343">0</span><span class="op" id="7919344">;</span>&nbsp;<span class="ident" id="7919346">j</span>&nbsp;<span class="op" id="7919348">&lt;</span>&nbsp;<span class="ident" id="7919350">n</span><span class="op" id="7919351">;</span>&nbsp;<span class="ident" id="7919353">j</span><span class="op" id="7919354">++</span>&nbsp;<span class="op" id="7919357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919362">v</span><span class="op" id="7919363">,</span>&nbsp;<span class="ident" id="7919365">ok</span>&nbsp;<span class="op" id="7919368">:=</span>&nbsp;<span class="ident" id="7919371">quick</span><span class="op" id="7919376">.</span><span class="ident" id="7919377">Value</span><span class="op" id="7919382">(</span><span class="ident" id="7919383">ty</span><span class="op" id="7919385">,</span>&nbsp;<span class="ident" id="7919387">rand</span><span class="op" id="7919391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919396">if</span>&nbsp;<span class="op" id="7919399">!</span><span class="ident" id="7919400">ok</span>&nbsp;<span class="op" id="7919403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919409">t</span><span class="op" id="7919410">.</span><span class="ident" id="7919411">Errorf</span><span class="op" id="7919417">(</span><span class="string" id="7919418">&#34;#%d:&nbsp;failed&nbsp;to&nbsp;create&nbsp;value&#34;</span><span class="op" id="7919447">,</span>&nbsp;<span class="ident" id="7919449">i</span><span class="op" id="7919450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919456">break</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919471">m1</span>&nbsp;<span class="op" id="7919474">:=</span>&nbsp;<span class="ident" id="7919477">v</span><span class="op" id="7919478">.</span><span class="ident" id="7919479">Interface</span><span class="op" id="7919488">(</span><span class="op" id="7919489">)</span><span class="op" id="7919490">.</span><span class="op" id="7919491">(</span><span class="ident" id="7919492">testMessage</span><span class="op" id="7919503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919508">marshaled</span>&nbsp;<span class="op" id="7919518">:=</span>&nbsp;<span class="ident" id="7919521">m1</span><span class="op" id="7919523">.</span><span class="ident" id="7919524">marshal</span><span class="op" id="7919531">(</span><span class="op" id="7919532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919537">m2</span>&nbsp;<span class="op" id="7919540">:=</span>&nbsp;<span class="ident" id="7919543">iface</span><span class="op" id="7919548">.</span><span class="op" id="7919549">(</span><span class="ident" id="7919550">testMessage</span><span class="op" id="7919561">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919566">if</span>&nbsp;<span class="op" id="7919569">!</span><span class="ident" id="7919570">m2</span><span class="op" id="7919572">.</span><span class="ident" id="7919573">unmarshal</span><span class="op" id="7919582">(</span><span class="ident" id="7919583">marshaled</span><span class="op" id="7919592">)</span>&nbsp;<span class="op" id="7919594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919600">t</span><span class="op" id="7919601">.</span><span class="ident" id="7919602">Errorf</span><span class="op" id="7919608">(</span><span class="string" id="7919609">&#34;#%d&nbsp;failed&nbsp;to&nbsp;unmarshal&nbsp;%#v&nbsp;%x&#34;</span><span class="op" id="7919641">,</span>&nbsp;<span class="ident" id="7919643">i</span><span class="op" id="7919644">,</span>&nbsp;<span class="ident" id="7919646">m1</span><span class="op" id="7919648">,</span>&nbsp;<span class="ident" id="7919650">marshaled</span><span class="op" id="7919659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919665">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919679">m2</span><span class="op" id="7919681">.</span><span class="ident" id="7919682">marshal</span><span class="op" id="7919689">(</span><span class="op" id="7919690">)</span>&nbsp;<span class="comment" id="7919692">//&nbsp;to&nbsp;fill&nbsp;any&nbsp;marshal&nbsp;cache&nbsp;in&nbsp;the&nbsp;message</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919740">if</span>&nbsp;<span class="op" id="7919743">!</span><span class="ident" id="7919744">m1</span><span class="op" id="7919746">.</span><span class="ident" id="7919747">equal</span><span class="op" id="7919752">(</span><span class="ident" id="7919753">m2</span><span class="op" id="7919755">)</span>&nbsp;<span class="op" id="7919757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7919763">t</span><span class="op" id="7919764">.</span><span class="ident" id="7919765">Errorf</span><span class="op" id="7919771">(</span><span class="string" id="7919772">&#34;#%d&nbsp;got:%#v&nbsp;want:%#v&nbsp;%x&#34;</span><span class="op" id="7919797">,</span>&nbsp;<span class="ident" id="7919799">i</span><span class="op" id="7919800">,</span>&nbsp;<span class="ident" id="7919802">m2</span><span class="op" id="7919804">,</span>&nbsp;<span class="ident" id="7919806">m1</span><span class="op" id="7919808">,</span>&nbsp;<span class="ident" id="7919810">marshaled</span><span class="op" id="7919819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919825">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7919834">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7919840">if</span>&nbsp;<span class="ident" id="7919843">i</span>&nbsp;<span class="op" id="7919845">&gt;=</span>&nbsp;<span class="num" id="7919848">3</span>&nbsp;<span class="op" id="7919850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7919856">//&nbsp;The&nbsp;first&nbsp;three&nbsp;message&nbsp;types&nbsp;(ClientHello,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7919907">//&nbsp;ServerHello&nbsp;and&nbsp;Finished)&nbsp;are&nbsp;allowed&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7919955">//&nbsp;have&nbsp;parsable&nbsp;prefixes&nbsp;because&nbsp;the&nbsp;extension</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7920007">//&nbsp;data&nbsp;is&nbsp;optional&nbsp;and&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7920053">//&nbsp;Finished&nbsp;varies&nbsp;across&nbsp;versions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920093">for</span>&nbsp;<span class="ident" id="7920097">j</span>&nbsp;<span class="op" id="7920099">:=</span>&nbsp;<span class="num" id="7920102">0</span><span class="op" id="7920103">;</span>&nbsp;<span class="ident" id="7920105">j</span>&nbsp;<span class="op" id="7920107">&lt;</span>&nbsp;<span class="builtinfunc" id="7920109">len</span><span class="op" id="7920112">(</span><span class="ident" id="7920113">marshaled</span><span class="op" id="7920122">)</span><span class="op" id="7920123">;</span>&nbsp;<span class="ident" id="7920125">j</span><span class="op" id="7920126">++</span>&nbsp;<span class="op" id="7920129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920136">if</span>&nbsp;<span class="ident" id="7920139">m2</span><span class="op" id="7920141">.</span><span class="ident" id="7920142">unmarshal</span><span class="op" id="7920151">(</span><span class="ident" id="7920152">marshaled</span><span class="op" id="7920161">[</span><span class="num" id="7920162">0</span><span class="op" id="7920163">:</span><span class="ident" id="7920164">j</span><span class="op" id="7920165">]</span><span class="op" id="7920166">)</span>&nbsp;<span class="op" id="7920168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920176">t</span><span class="op" id="7920177">.</span><span class="ident" id="7920178">Errorf</span><span class="op" id="7920184">(</span><span class="string" id="7920185">&#34;#%d&nbsp;unmarshaled&nbsp;a&nbsp;prefix&nbsp;of&nbsp;length&nbsp;%d&nbsp;of&nbsp;%#v&#34;</span><span class="op" id="7920231">,</span>&nbsp;<span class="ident" id="7920233">i</span><span class="op" id="7920234">,</span>&nbsp;<span class="ident" id="7920236">j</span><span class="op" id="7920237">,</span>&nbsp;<span class="ident" id="7920239">m1</span><span class="op" id="7920241">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920249">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920275">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920278">}</span><br>
<span class="lineno"></span><span class="op" id="7920280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7920283">func</span>&nbsp;<span class="ident" id="7920288">TestFuzz</span><span class="op" id="7920296">(</span><span class="ident" id="7920297">t</span>&nbsp;<span class="op" id="7920299">*</span><span class="ident" id="7920300">testing</span><span class="op" id="7920307">.</span><span class="ident" id="7920308">T</span><span class="op" id="7920309">)</span>&nbsp;<span class="op" id="7920311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920314">rand</span>&nbsp;<span class="op" id="7920319">:=</span>&nbsp;<span class="ident" id="7920322">rand</span><span class="op" id="7920326">.</span><span class="ident" id="7920327">New</span><span class="op" id="7920330">(</span><span class="ident" id="7920331">rand</span><span class="op" id="7920335">.</span><span class="ident" id="7920336">NewSource</span><span class="op" id="7920345">(</span><span class="num" id="7920346">0</span><span class="op" id="7920347">)</span><span class="op" id="7920348">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920351">for</span>&nbsp;<span class="ident" id="7920355">_</span><span class="op" id="7920356">,</span>&nbsp;<span class="ident" id="7920358">iface</span>&nbsp;<span class="op" id="7920364">:=</span>&nbsp;<span class="keyword" id="7920367">range</span>&nbsp;<span class="ident" id="7920373">tests</span>&nbsp;<span class="op" id="7920379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920383">m</span>&nbsp;<span class="op" id="7920385">:=</span>&nbsp;<span class="ident" id="7920388">iface</span><span class="op" id="7920393">.</span><span class="op" id="7920394">(</span><span class="ident" id="7920395">testMessage</span><span class="op" id="7920406">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920411">for</span>&nbsp;<span class="ident" id="7920415">j</span>&nbsp;<span class="op" id="7920417">:=</span>&nbsp;<span class="num" id="7920420">0</span><span class="op" id="7920421">;</span>&nbsp;<span class="ident" id="7920423">j</span>&nbsp;<span class="op" id="7920425">&lt;</span>&nbsp;<span class="num" id="7920427">1000</span><span class="op" id="7920431">;</span>&nbsp;<span class="ident" id="7920433">j</span><span class="op" id="7920434">++</span>&nbsp;<span class="op" id="7920437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7920442">len</span>&nbsp;<span class="op" id="7920446">:=</span>&nbsp;<span class="ident" id="7920449">rand</span><span class="op" id="7920453">.</span><span class="ident" id="7920454">Intn</span><span class="op" id="7920458">(</span><span class="num" id="7920459">100</span><span class="op" id="7920462">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920467">bytes</span>&nbsp;<span class="op" id="7920473">:=</span>&nbsp;<span class="ident" id="7920476">randomBytes</span><span class="op" id="7920487">(</span><span class="builtinfunc" id="7920488">len</span><span class="op" id="7920491">,</span>&nbsp;<span class="ident" id="7920493">rand</span><span class="op" id="7920497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7920502">//&nbsp;This&nbsp;just&nbsp;looks&nbsp;for&nbsp;crashes&nbsp;due&nbsp;to&nbsp;bounds&nbsp;errors&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920562">m</span><span class="op" id="7920563">.</span><span class="ident" id="7920564">unmarshal</span><span class="op" id="7920573">(</span><span class="ident" id="7920574">bytes</span><span class="op" id="7920579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920586">}</span><br>
<span class="lineno">95</span><span class="op" id="7920588">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7920591">func</span>&nbsp;<span class="ident" id="7920596">randomBytes</span><span class="op" id="7920607">(</span><span class="ident" id="7920608">n</span>&nbsp;<span class="builtintype" id="7920610">int</span><span class="op" id="7920613">,</span>&nbsp;<span class="ident" id="7920615">rand</span>&nbsp;<span class="op" id="7920620">*</span><span class="ident" id="7920621">rand</span><span class="op" id="7920625">.</span><span class="ident" id="7920626">Rand</span><span class="op" id="7920630">)</span>&nbsp;<span class="op" id="7920632">[</span><span class="op" id="7920633">]</span><span class="builtintype" id="7920634">byte</span>&nbsp;<span class="op" id="7920639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920642">r</span>&nbsp;<span class="op" id="7920644">:=</span>&nbsp;<span class="builtinfunc" id="7920647">make</span><span class="op" id="7920651">(</span><span class="op" id="7920652">[</span><span class="op" id="7920653">]</span><span class="builtintype" id="7920654">byte</span><span class="op" id="7920658">,</span>&nbsp;<span class="ident" id="7920660">n</span><span class="op" id="7920661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920664">for</span>&nbsp;<span class="ident" id="7920668">i</span>&nbsp;<span class="op" id="7920670">:=</span>&nbsp;<span class="num" id="7920673">0</span><span class="op" id="7920674">;</span>&nbsp;<span class="ident" id="7920676">i</span>&nbsp;<span class="op" id="7920678">&lt;</span>&nbsp;<span class="ident" id="7920680">n</span><span class="op" id="7920681">;</span>&nbsp;<span class="ident" id="7920683">i</span><span class="op" id="7920684">++</span>&nbsp;<span class="op" id="7920687">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920691">r</span><span class="op" id="7920692">[</span><span class="ident" id="7920693">i</span><span class="op" id="7920694">]</span>&nbsp;<span class="op" id="7920696">=</span>&nbsp;<span class="builtintype" id="7920698">byte</span><span class="op" id="7920702">(</span><span class="ident" id="7920703">rand</span><span class="op" id="7920707">.</span><span class="ident" id="7920708">Int31</span><span class="op" id="7920713">(</span><span class="op" id="7920714">)</span><span class="op" id="7920715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7920718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920721">return</span>&nbsp;<span class="ident" id="7920728">r</span><br>
<span class="lineno"></span><span class="op" id="7920730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="7920733">func</span>&nbsp;<span class="ident" id="7920738">randomString</span><span class="op" id="7920750">(</span><span class="ident" id="7920751">n</span>&nbsp;<span class="builtintype" id="7920753">int</span><span class="op" id="7920756">,</span>&nbsp;<span class="ident" id="7920758">rand</span>&nbsp;<span class="op" id="7920763">*</span><span class="ident" id="7920764">rand</span><span class="op" id="7920768">.</span><span class="ident" id="7920769">Rand</span><span class="op" id="7920773">)</span>&nbsp;<span class="builtintype" id="7920775">string</span>&nbsp;<span class="op" id="7920782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920785">b</span>&nbsp;<span class="op" id="7920787">:=</span>&nbsp;<span class="ident" id="7920790">randomBytes</span><span class="op" id="7920801">(</span><span class="ident" id="7920802">n</span><span class="op" id="7920803">,</span>&nbsp;<span class="ident" id="7920805">rand</span><span class="op" id="7920809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7920812">return</span>&nbsp;<span class="builtintype" id="7920819">string</span><span class="op" id="7920825">(</span><span class="ident" id="7920826">b</span><span class="op" id="7920827">)</span><br>
<span class="lineno"></span><span class="op" id="7920829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="7920832">func</span>&nbsp;<span class="op" id="7920837">(</span><span class="op" id="7920838">*</span><span class="ident" id="7920839">clientHelloMsg</span><span class="op" id="7920853">)</span>&nbsp;<span class="ident" id="7920855">Generate</span><span class="op" id="7920863">(</span><span class="ident" id="7920864">rand</span>&nbsp;<span class="op" id="7920869">*</span><span class="ident" id="7920870">rand</span><span class="op" id="7920874">.</span><span class="ident" id="7920875">Rand</span><span class="op" id="7920879">,</span>&nbsp;<span class="ident" id="7920881">size</span>&nbsp;<span class="builtintype" id="7920886">int</span><span class="op" id="7920889">)</span>&nbsp;<span class="ident" id="7920891">reflect</span><span class="op" id="7920898">.</span><span class="ident" id="7920899">Value</span>&nbsp;<span class="op" id="7920905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920908">m</span>&nbsp;<span class="op" id="7920910">:=</span>&nbsp;<span class="op" id="7920913">&amp;</span><span class="ident" id="7920914">clientHelloMsg</span><span class="op" id="7920928">{</span><span class="op" id="7920929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920932">m</span><span class="op" id="7920933">.</span><span class="ident" id="7920934">vers</span>&nbsp;<span class="op" id="7920939">=</span>&nbsp;<span class="builtintype" id="7920941">uint16</span><span class="op" id="7920947">(</span><span class="ident" id="7920948">rand</span><span class="op" id="7920952">.</span><span class="ident" id="7920953">Intn</span><span class="op" id="7920957">(</span><span class="num" id="7920958">65536</span><span class="op" id="7920963">)</span><span class="op" id="7920964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7920967">m</span><span class="op" id="7920968">.</span><span class="ident" id="7920969">random</span>&nbsp;<span class="op" id="7920976">=</span>&nbsp;<span class="ident" id="7920978">randomBytes</span><span class="op" id="7920989">(</span><span class="num" id="7920990">32</span><span class="op" id="7920992">,</span>&nbsp;<span class="ident" id="7920994">rand</span><span class="op" id="7920998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921001">m</span><span class="op" id="7921002">.</span><span class="ident" id="7921003">sessionId</span>&nbsp;<span class="op" id="7921013">=</span>&nbsp;<span class="ident" id="7921015">randomBytes</span><span class="op" id="7921026">(</span><span class="ident" id="7921027">rand</span><span class="op" id="7921031">.</span><span class="ident" id="7921032">Intn</span><span class="op" id="7921036">(</span><span class="num" id="7921037">32</span><span class="op" id="7921039">)</span><span class="op" id="7921040">,</span>&nbsp;<span class="ident" id="7921042">rand</span><span class="op" id="7921046">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921049">m</span><span class="op" id="7921050">.</span><span class="ident" id="7921051">cipherSuites</span>&nbsp;<span class="op" id="7921064">=</span>&nbsp;<span class="builtinfunc" id="7921066">make</span><span class="op" id="7921070">(</span><span class="op" id="7921071">[</span><span class="op" id="7921072">]</span><span class="builtintype" id="7921073">uint16</span><span class="op" id="7921079">,</span>&nbsp;<span class="ident" id="7921081">rand</span><span class="op" id="7921085">.</span><span class="ident" id="7921086">Intn</span><span class="op" id="7921090">(</span><span class="num" id="7921091">63</span><span class="op" id="7921093">)</span><span class="op" id="7921094">+</span><span class="num" id="7921095">1</span><span class="op" id="7921096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921099">for</span>&nbsp;<span class="ident" id="7921103">i</span>&nbsp;<span class="op" id="7921105">:=</span>&nbsp;<span class="num" id="7921108">0</span><span class="op" id="7921109">;</span>&nbsp;<span class="ident" id="7921111">i</span>&nbsp;<span class="op" id="7921113">&lt;</span>&nbsp;<span class="builtinfunc" id="7921115">len</span><span class="op" id="7921118">(</span><span class="ident" id="7921119">m</span><span class="op" id="7921120">.</span><span class="ident" id="7921121">cipherSuites</span><span class="op" id="7921133">)</span><span class="op" id="7921134">;</span>&nbsp;<span class="ident" id="7921136">i</span><span class="op" id="7921137">++</span>&nbsp;<span class="op" id="7921140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921144">m</span><span class="op" id="7921145">.</span><span class="ident" id="7921146">cipherSuites</span><span class="op" id="7921158">[</span><span class="ident" id="7921159">i</span><span class="op" id="7921160">]</span>&nbsp;<span class="op" id="7921162">=</span>&nbsp;<span class="builtintype" id="7921164">uint16</span><span class="op" id="7921170">(</span><span class="ident" id="7921171">rand</span><span class="op" id="7921175">.</span><span class="ident" id="7921176">Int31</span><span class="op" id="7921181">(</span><span class="op" id="7921182">)</span><span class="op" id="7921183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921189">m</span><span class="op" id="7921190">.</span><span class="ident" id="7921191">compressionMethods</span>&nbsp;<span class="op" id="7921210">=</span>&nbsp;<span class="ident" id="7921212">randomBytes</span><span class="op" id="7921223">(</span><span class="ident" id="7921224">rand</span><span class="op" id="7921228">.</span><span class="ident" id="7921229">Intn</span><span class="op" id="7921233">(</span><span class="num" id="7921234">63</span><span class="op" id="7921236">)</span><span class="op" id="7921237">+</span><span class="num" id="7921238">1</span><span class="op" id="7921239">,</span>&nbsp;<span class="ident" id="7921241">rand</span><span class="op" id="7921245">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921248">if</span>&nbsp;<span class="ident" id="7921251">rand</span><span class="op" id="7921255">.</span><span class="ident" id="7921256">Intn</span><span class="op" id="7921260">(</span><span class="num" id="7921261">10</span><span class="op" id="7921263">)</span>&nbsp;<span class="op" id="7921265">&gt;</span>&nbsp;<span class="num" id="7921267">5</span>&nbsp;<span class="op" id="7921269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921273">m</span><span class="op" id="7921274">.</span><span class="ident" id="7921275">nextProtoNeg</span>&nbsp;<span class="op" id="7921288">=</span>&nbsp;<span class="builtintype" id="7921290">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921299">if</span>&nbsp;<span class="ident" id="7921302">rand</span><span class="op" id="7921306">.</span><span class="ident" id="7921307">Intn</span><span class="op" id="7921311">(</span><span class="num" id="7921312">10</span><span class="op" id="7921314">)</span>&nbsp;<span class="op" id="7921316">&gt;</span>&nbsp;<span class="num" id="7921318">5</span>&nbsp;<span class="op" id="7921320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921324">m</span><span class="op" id="7921325">.</span><span class="ident" id="7921326">serverName</span>&nbsp;<span class="op" id="7921337">=</span>&nbsp;<span class="ident" id="7921339">randomString</span><span class="op" id="7921351">(</span><span class="ident" id="7921352">rand</span><span class="op" id="7921356">.</span><span class="ident" id="7921357">Intn</span><span class="op" id="7921361">(</span><span class="num" id="7921362">255</span><span class="op" id="7921365">)</span><span class="op" id="7921366">,</span>&nbsp;<span class="ident" id="7921368">rand</span><span class="op" id="7921372">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921378">m</span><span class="op" id="7921379">.</span><span class="ident" id="7921380">ocspStapling</span>&nbsp;<span class="op" id="7921393">=</span>&nbsp;<span class="ident" id="7921395">rand</span><span class="op" id="7921399">.</span><span class="ident" id="7921400">Intn</span><span class="op" id="7921404">(</span><span class="num" id="7921405">10</span><span class="op" id="7921407">)</span>&nbsp;<span class="op" id="7921409">&gt;</span>&nbsp;<span class="num" id="7921411">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921414">m</span><span class="op" id="7921415">.</span><span class="ident" id="7921416">supportedPoints</span>&nbsp;<span class="op" id="7921432">=</span>&nbsp;<span class="ident" id="7921434">randomBytes</span><span class="op" id="7921445">(</span><span class="ident" id="7921446">rand</span><span class="op" id="7921450">.</span><span class="ident" id="7921451">Intn</span><span class="op" id="7921455">(</span><span class="num" id="7921456">5</span><span class="op" id="7921457">)</span><span class="op" id="7921458">+</span><span class="num" id="7921459">1</span><span class="op" id="7921460">,</span>&nbsp;<span class="ident" id="7921462">rand</span><span class="op" id="7921466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921469">m</span><span class="op" id="7921470">.</span><span class="ident" id="7921471">supportedCurves</span>&nbsp;<span class="op" id="7921487">=</span>&nbsp;<span class="builtinfunc" id="7921489">make</span><span class="op" id="7921493">(</span><span class="op" id="7921494">[</span><span class="op" id="7921495">]</span><span class="ident" id="7921496">CurveID</span><span class="op" id="7921503">,</span>&nbsp;<span class="ident" id="7921505">rand</span><span class="op" id="7921509">.</span><span class="ident" id="7921510">Intn</span><span class="op" id="7921514">(</span><span class="num" id="7921515">5</span><span class="op" id="7921516">)</span><span class="op" id="7921517">+</span><span class="num" id="7921518">1</span><span class="op" id="7921519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921522">for</span>&nbsp;<span class="ident" id="7921526">i</span>&nbsp;<span class="op" id="7921528">:=</span>&nbsp;<span class="keyword" id="7921531">range</span>&nbsp;<span class="ident" id="7921537">m</span><span class="op" id="7921538">.</span><span class="ident" id="7921539">supportedCurves</span>&nbsp;<span class="op" id="7921555">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921559">m</span><span class="op" id="7921560">.</span><span class="ident" id="7921561">supportedCurves</span><span class="op" id="7921576">[</span><span class="ident" id="7921577">i</span><span class="op" id="7921578">]</span>&nbsp;<span class="op" id="7921580">=</span>&nbsp;<span class="ident" id="7921582">CurveID</span><span class="op" id="7921589">(</span><span class="ident" id="7921590">rand</span><span class="op" id="7921594">.</span><span class="ident" id="7921595">Intn</span><span class="op" id="7921599">(</span><span class="num" id="7921600">30000</span><span class="op" id="7921605">)</span><span class="op" id="7921606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921612">if</span>&nbsp;<span class="ident" id="7921615">rand</span><span class="op" id="7921619">.</span><span class="ident" id="7921620">Intn</span><span class="op" id="7921624">(</span><span class="num" id="7921625">10</span><span class="op" id="7921627">)</span>&nbsp;<span class="op" id="7921629">&gt;</span>&nbsp;<span class="num" id="7921631">5</span>&nbsp;<span class="op" id="7921633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921637">m</span><span class="op" id="7921638">.</span><span class="ident" id="7921639">ticketSupported</span>&nbsp;<span class="op" id="7921655">=</span>&nbsp;<span class="builtintype" id="7921657">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921664">if</span>&nbsp;<span class="ident" id="7921667">rand</span><span class="op" id="7921671">.</span><span class="ident" id="7921672">Intn</span><span class="op" id="7921676">(</span><span class="num" id="7921677">10</span><span class="op" id="7921679">)</span>&nbsp;<span class="op" id="7921681">&gt;</span>&nbsp;<span class="num" id="7921683">5</span>&nbsp;<span class="op" id="7921685">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921690">m</span><span class="op" id="7921691">.</span><span class="ident" id="7921692">sessionTicket</span>&nbsp;<span class="op" id="7921706">=</span>&nbsp;<span class="ident" id="7921708">randomBytes</span><span class="op" id="7921719">(</span><span class="ident" id="7921720">rand</span><span class="op" id="7921724">.</span><span class="ident" id="7921725">Intn</span><span class="op" id="7921729">(</span><span class="num" id="7921730">300</span><span class="op" id="7921733">)</span><span class="op" id="7921734">,</span>&nbsp;<span class="ident" id="7921736">rand</span><span class="op" id="7921740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921747">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921750">if</span>&nbsp;<span class="ident" id="7921753">rand</span><span class="op" id="7921757">.</span><span class="ident" id="7921758">Intn</span><span class="op" id="7921762">(</span><span class="num" id="7921763">10</span><span class="op" id="7921765">)</span>&nbsp;<span class="op" id="7921767">&gt;</span>&nbsp;<span class="num" id="7921769">5</span>&nbsp;<span class="op" id="7921771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921775">m</span><span class="op" id="7921776">.</span><span class="ident" id="7921777">signatureAndHashes</span>&nbsp;<span class="op" id="7921796">=</span>&nbsp;<span class="ident" id="7921798">supportedSKXSignatureAlgorithms</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921834">m</span><span class="op" id="7921835">.</span><span class="ident" id="7921836">alpnProtocols</span>&nbsp;<span class="op" id="7921850">=</span>&nbsp;<span class="builtinfunc" id="7921852">make</span><span class="op" id="7921856">(</span><span class="op" id="7921857">[</span><span class="op" id="7921858">]</span><span class="builtintype" id="7921859">string</span><span class="op" id="7921865">,</span>&nbsp;<span class="ident" id="7921867">rand</span><span class="op" id="7921871">.</span><span class="ident" id="7921872">Intn</span><span class="op" id="7921876">(</span><span class="num" id="7921877">5</span><span class="op" id="7921878">)</span><span class="op" id="7921879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921882">for</span>&nbsp;<span class="ident" id="7921886">i</span>&nbsp;<span class="op" id="7921888">:=</span>&nbsp;<span class="keyword" id="7921891">range</span>&nbsp;<span class="ident" id="7921897">m</span><span class="op" id="7921898">.</span><span class="ident" id="7921899">alpnProtocols</span>&nbsp;<span class="op" id="7921913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7921917">m</span><span class="op" id="7921918">.</span><span class="ident" id="7921919">alpnProtocols</span><span class="op" id="7921932">[</span><span class="ident" id="7921933">i</span><span class="op" id="7921934">]</span>&nbsp;<span class="op" id="7921936">=</span>&nbsp;<span class="ident" id="7921938">randomString</span><span class="op" id="7921950">(</span><span class="ident" id="7921951">rand</span><span class="op" id="7921955">.</span><span class="ident" id="7921956">Intn</span><span class="op" id="7921960">(</span><span class="num" id="7921961">20</span><span class="op" id="7921963">)</span><span class="op" id="7921964">+</span><span class="num" id="7921965">1</span><span class="op" id="7921966">,</span>&nbsp;<span class="ident" id="7921968">rand</span><span class="op" id="7921972">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7921975">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7921979">return</span>&nbsp;<span class="ident" id="7921986">reflect</span><span class="op" id="7921993">.</span><span class="ident" id="7921994">ValueOf</span><span class="op" id="7922001">(</span><span class="ident" id="7922002">m</span><span class="op" id="7922003">)</span><br>
<span class="lineno"></span><span class="op" id="7922005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7922008">func</span>&nbsp;<span class="op" id="7922013">(</span><span class="op" id="7922014">*</span><span class="ident" id="7922015">serverHelloMsg</span><span class="op" id="7922029">)</span>&nbsp;<span class="ident" id="7922031">Generate</span><span class="op" id="7922039">(</span><span class="ident" id="7922040">rand</span>&nbsp;<span class="op" id="7922045">*</span><span class="ident" id="7922046">rand</span><span class="op" id="7922050">.</span><span class="ident" id="7922051">Rand</span><span class="op" id="7922055">,</span>&nbsp;<span class="ident" id="7922057">size</span>&nbsp;<span class="builtintype" id="7922062">int</span><span class="op" id="7922065">)</span>&nbsp;<span class="ident" id="7922067">reflect</span><span class="op" id="7922074">.</span><span class="ident" id="7922075">Value</span>&nbsp;<span class="op" id="7922081">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922084">m</span>&nbsp;<span class="op" id="7922086">:=</span>&nbsp;<span class="op" id="7922089">&amp;</span><span class="ident" id="7922090">serverHelloMsg</span><span class="op" id="7922104">{</span><span class="op" id="7922105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922108">m</span><span class="op" id="7922109">.</span><span class="ident" id="7922110">vers</span>&nbsp;<span class="op" id="7922115">=</span>&nbsp;<span class="builtintype" id="7922117">uint16</span><span class="op" id="7922123">(</span><span class="ident" id="7922124">rand</span><span class="op" id="7922128">.</span><span class="ident" id="7922129">Intn</span><span class="op" id="7922133">(</span><span class="num" id="7922134">65536</span><span class="op" id="7922139">)</span><span class="op" id="7922140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922143">m</span><span class="op" id="7922144">.</span><span class="ident" id="7922145">random</span>&nbsp;<span class="op" id="7922152">=</span>&nbsp;<span class="ident" id="7922154">randomBytes</span><span class="op" id="7922165">(</span><span class="num" id="7922166">32</span><span class="op" id="7922168">,</span>&nbsp;<span class="ident" id="7922170">rand</span><span class="op" id="7922174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922177">m</span><span class="op" id="7922178">.</span><span class="ident" id="7922179">sessionId</span>&nbsp;<span class="op" id="7922189">=</span>&nbsp;<span class="ident" id="7922191">randomBytes</span><span class="op" id="7922202">(</span><span class="ident" id="7922203">rand</span><span class="op" id="7922207">.</span><span class="ident" id="7922208">Intn</span><span class="op" id="7922212">(</span><span class="num" id="7922213">32</span><span class="op" id="7922215">)</span><span class="op" id="7922216">,</span>&nbsp;<span class="ident" id="7922218">rand</span><span class="op" id="7922222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922225">m</span><span class="op" id="7922226">.</span><span class="ident" id="7922227">cipherSuite</span>&nbsp;<span class="op" id="7922239">=</span>&nbsp;<span class="builtintype" id="7922241">uint16</span><span class="op" id="7922247">(</span><span class="ident" id="7922248">rand</span><span class="op" id="7922252">.</span><span class="ident" id="7922253">Int31</span><span class="op" id="7922258">(</span><span class="op" id="7922259">)</span><span class="op" id="7922260">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922263">m</span><span class="op" id="7922264">.</span><span class="ident" id="7922265">compressionMethod</span>&nbsp;<span class="op" id="7922283">=</span>&nbsp;<span class="builtintype" id="7922285">uint8</span><span class="op" id="7922290">(</span><span class="ident" id="7922291">rand</span><span class="op" id="7922295">.</span><span class="ident" id="7922296">Intn</span><span class="op" id="7922300">(</span><span class="num" id="7922301">256</span><span class="op" id="7922304">)</span><span class="op" id="7922305">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922309">if</span>&nbsp;<span class="ident" id="7922312">rand</span><span class="op" id="7922316">.</span><span class="ident" id="7922317">Intn</span><span class="op" id="7922321">(</span><span class="num" id="7922322">10</span><span class="op" id="7922324">)</span>&nbsp;<span class="op" id="7922326">&gt;</span>&nbsp;<span class="num" id="7922328">5</span>&nbsp;<span class="op" id="7922330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922334">m</span><span class="op" id="7922335">.</span><span class="ident" id="7922336">nextProtoNeg</span>&nbsp;<span class="op" id="7922349">=</span>&nbsp;<span class="builtintype" id="7922351">true</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922359">n</span>&nbsp;<span class="op" id="7922361">:=</span>&nbsp;<span class="ident" id="7922364">rand</span><span class="op" id="7922368">.</span><span class="ident" id="7922369">Intn</span><span class="op" id="7922373">(</span><span class="num" id="7922374">10</span><span class="op" id="7922376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922380">m</span><span class="op" id="7922381">.</span><span class="ident" id="7922382">nextProtos</span>&nbsp;<span class="op" id="7922393">=</span>&nbsp;<span class="builtinfunc" id="7922395">make</span><span class="op" id="7922399">(</span><span class="op" id="7922400">[</span><span class="op" id="7922401">]</span><span class="builtintype" id="7922402">string</span><span class="op" id="7922408">,</span>&nbsp;<span class="ident" id="7922410">n</span><span class="op" id="7922411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922415">for</span>&nbsp;<span class="ident" id="7922419">i</span>&nbsp;<span class="op" id="7922421">:=</span>&nbsp;<span class="num" id="7922424">0</span><span class="op" id="7922425">;</span>&nbsp;<span class="ident" id="7922427">i</span>&nbsp;<span class="op" id="7922429">&lt;</span>&nbsp;<span class="ident" id="7922431">n</span><span class="op" id="7922432">;</span>&nbsp;<span class="ident" id="7922434">i</span><span class="op" id="7922435">++</span>&nbsp;<span class="op" id="7922438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922443">m</span><span class="op" id="7922444">.</span><span class="ident" id="7922445">nextProtos</span><span class="op" id="7922455">[</span><span class="ident" id="7922456">i</span><span class="op" id="7922457">]</span>&nbsp;<span class="op" id="7922459">=</span>&nbsp;<span class="ident" id="7922461">randomString</span><span class="op" id="7922473">(</span><span class="num" id="7922474">20</span><span class="op" id="7922476">,</span>&nbsp;<span class="ident" id="7922478">rand</span><span class="op" id="7922482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922486">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922493">if</span>&nbsp;<span class="ident" id="7922496">rand</span><span class="op" id="7922500">.</span><span class="ident" id="7922501">Intn</span><span class="op" id="7922505">(</span><span class="num" id="7922506">10</span><span class="op" id="7922508">)</span>&nbsp;<span class="op" id="7922510">&gt;</span>&nbsp;<span class="num" id="7922512">5</span>&nbsp;<span class="op" id="7922514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922518">m</span><span class="op" id="7922519">.</span><span class="ident" id="7922520">ocspStapling</span>&nbsp;<span class="op" id="7922533">=</span>&nbsp;<span class="builtintype" id="7922535">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922541">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922544">if</span>&nbsp;<span class="ident" id="7922547">rand</span><span class="op" id="7922551">.</span><span class="ident" id="7922552">Intn</span><span class="op" id="7922556">(</span><span class="num" id="7922557">10</span><span class="op" id="7922559">)</span>&nbsp;<span class="op" id="7922561">&gt;</span>&nbsp;<span class="num" id="7922563">5</span>&nbsp;<span class="op" id="7922565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922569">m</span><span class="op" id="7922570">.</span><span class="ident" id="7922571">ticketSupported</span>&nbsp;<span class="op" id="7922587">=</span>&nbsp;<span class="builtintype" id="7922589">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922595">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922598">m</span><span class="op" id="7922599">.</span><span class="ident" id="7922600">alpnProtocol</span>&nbsp;<span class="op" id="7922613">=</span>&nbsp;<span class="ident" id="7922615">randomString</span><span class="op" id="7922627">(</span><span class="ident" id="7922628">rand</span><span class="op" id="7922632">.</span><span class="ident" id="7922633">Intn</span><span class="op" id="7922637">(</span><span class="num" id="7922638">32</span><span class="op" id="7922640">)</span><span class="op" id="7922641">+</span><span class="num" id="7922642">1</span><span class="op" id="7922643">,</span>&nbsp;<span class="ident" id="7922645">rand</span><span class="op" id="7922649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922653">return</span>&nbsp;<span class="ident" id="7922660">reflect</span><span class="op" id="7922667">.</span><span class="ident" id="7922668">ValueOf</span><span class="op" id="7922675">(</span><span class="ident" id="7922676">m</span><span class="op" id="7922677">)</span><br>
<span class="lineno"></span><span class="op" id="7922679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7922682">func</span>&nbsp;<span class="op" id="7922687">(</span><span class="op" id="7922688">*</span><span class="ident" id="7922689">certificateMsg</span><span class="op" id="7922703">)</span>&nbsp;<span class="ident" id="7922705">Generate</span><span class="op" id="7922713">(</span><span class="ident" id="7922714">rand</span>&nbsp;<span class="op" id="7922719">*</span><span class="ident" id="7922720">rand</span><span class="op" id="7922724">.</span><span class="ident" id="7922725">Rand</span><span class="op" id="7922729">,</span>&nbsp;<span class="ident" id="7922731">size</span>&nbsp;<span class="builtintype" id="7922736">int</span><span class="op" id="7922739">)</span>&nbsp;<span class="ident" id="7922741">reflect</span><span class="op" id="7922748">.</span><span class="ident" id="7922749">Value</span>&nbsp;<span class="op" id="7922755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922758">m</span>&nbsp;<span class="op" id="7922760">:=</span>&nbsp;<span class="op" id="7922763">&amp;</span><span class="ident" id="7922764">certificateMsg</span><span class="op" id="7922778">{</span><span class="op" id="7922779">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922782">numCerts</span>&nbsp;<span class="op" id="7922791">:=</span>&nbsp;<span class="ident" id="7922794">rand</span><span class="op" id="7922798">.</span><span class="ident" id="7922799">Intn</span><span class="op" id="7922803">(</span><span class="num" id="7922804">20</span><span class="op" id="7922806">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922809">m</span><span class="op" id="7922810">.</span><span class="ident" id="7922811">certificates</span>&nbsp;<span class="op" id="7922824">=</span>&nbsp;<span class="builtinfunc" id="7922826">make</span><span class="op" id="7922830">(</span><span class="op" id="7922831">[</span><span class="op" id="7922832">]</span><span class="op" id="7922833">[</span><span class="op" id="7922834">]</span><span class="builtintype" id="7922835">byte</span><span class="op" id="7922839">,</span>&nbsp;<span class="ident" id="7922841">numCerts</span><span class="op" id="7922849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922852">for</span>&nbsp;<span class="ident" id="7922856">i</span>&nbsp;<span class="op" id="7922858">:=</span>&nbsp;<span class="num" id="7922861">0</span><span class="op" id="7922862">;</span>&nbsp;<span class="ident" id="7922864">i</span>&nbsp;<span class="op" id="7922866">&lt;</span>&nbsp;<span class="ident" id="7922868">numCerts</span><span class="op" id="7922876">;</span>&nbsp;<span class="ident" id="7922878">i</span><span class="op" id="7922879">++</span>&nbsp;<span class="op" id="7922882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7922886">m</span><span class="op" id="7922887">.</span><span class="ident" id="7922888">certificates</span><span class="op" id="7922900">[</span><span class="ident" id="7922901">i</span><span class="op" id="7922902">]</span>&nbsp;<span class="op" id="7922904">=</span>&nbsp;<span class="ident" id="7922906">randomBytes</span><span class="op" id="7922917">(</span><span class="ident" id="7922918">rand</span><span class="op" id="7922922">.</span><span class="ident" id="7922923">Intn</span><span class="op" id="7922927">(</span><span class="num" id="7922928">10</span><span class="op" id="7922930">)</span><span class="op" id="7922931">+</span><span class="num" id="7922932">1</span><span class="op" id="7922933">,</span>&nbsp;<span class="ident" id="7922935">rand</span><span class="op" id="7922939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7922942">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7922945">return</span>&nbsp;<span class="ident" id="7922952">reflect</span><span class="op" id="7922959">.</span><span class="ident" id="7922960">ValueOf</span><span class="op" id="7922967">(</span><span class="ident" id="7922968">m</span><span class="op" id="7922969">)</span><br>
<span class="lineno"></span><span class="op" id="7922971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7922974">func</span>&nbsp;<span class="op" id="7922979">(</span><span class="op" id="7922980">*</span><span class="ident" id="7922981">certificateRequestMsg</span><span class="op" id="7923002">)</span>&nbsp;<span class="ident" id="7923004">Generate</span><span class="op" id="7923012">(</span><span class="ident" id="7923013">rand</span>&nbsp;<span class="op" id="7923018">*</span><span class="ident" id="7923019">rand</span><span class="op" id="7923023">.</span><span class="ident" id="7923024">Rand</span><span class="op" id="7923028">,</span>&nbsp;<span class="ident" id="7923030">size</span>&nbsp;<span class="builtintype" id="7923035">int</span><span class="op" id="7923038">)</span>&nbsp;<span class="ident" id="7923040">reflect</span><span class="op" id="7923047">.</span><span class="ident" id="7923048">Value</span>&nbsp;<span class="op" id="7923054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923057">m</span>&nbsp;<span class="op" id="7923059">:=</span>&nbsp;<span class="op" id="7923062">&amp;</span><span class="ident" id="7923063">certificateRequestMsg</span><span class="op" id="7923084">{</span><span class="op" id="7923085">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923088">m</span><span class="op" id="7923089">.</span><span class="ident" id="7923090">certificateTypes</span>&nbsp;<span class="op" id="7923107">=</span>&nbsp;<span class="ident" id="7923109">randomBytes</span><span class="op" id="7923120">(</span><span class="ident" id="7923121">rand</span><span class="op" id="7923125">.</span><span class="ident" id="7923126">Intn</span><span class="op" id="7923130">(</span><span class="num" id="7923131">5</span><span class="op" id="7923132">)</span><span class="op" id="7923133">+</span><span class="num" id="7923134">1</span><span class="op" id="7923135">,</span>&nbsp;<span class="ident" id="7923137">rand</span><span class="op" id="7923141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923144">numCAs</span>&nbsp;<span class="op" id="7923151">:=</span>&nbsp;<span class="ident" id="7923154">rand</span><span class="op" id="7923158">.</span><span class="ident" id="7923159">Intn</span><span class="op" id="7923163">(</span><span class="num" id="7923164">100</span><span class="op" id="7923167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923170">m</span><span class="op" id="7923171">.</span><span class="ident" id="7923172">certificateAuthorities</span>&nbsp;<span class="op" id="7923195">=</span>&nbsp;<span class="builtinfunc" id="7923197">make</span><span class="op" id="7923201">(</span><span class="op" id="7923202">[</span><span class="op" id="7923203">]</span><span class="op" id="7923204">[</span><span class="op" id="7923205">]</span><span class="builtintype" id="7923206">byte</span><span class="op" id="7923210">,</span>&nbsp;<span class="ident" id="7923212">numCAs</span><span class="op" id="7923218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923221">for</span>&nbsp;<span class="ident" id="7923225">i</span>&nbsp;<span class="op" id="7923227">:=</span>&nbsp;<span class="num" id="7923230">0</span><span class="op" id="7923231">;</span>&nbsp;<span class="ident" id="7923233">i</span>&nbsp;<span class="op" id="7923235">&lt;</span>&nbsp;<span class="ident" id="7923237">numCAs</span><span class="op" id="7923243">;</span>&nbsp;<span class="ident" id="7923245">i</span><span class="op" id="7923246">++</span>&nbsp;<span class="op" id="7923249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923253">m</span><span class="op" id="7923254">.</span><span class="ident" id="7923255">certificateAuthorities</span><span class="op" id="7923277">[</span><span class="ident" id="7923278">i</span><span class="op" id="7923279">]</span>&nbsp;<span class="op" id="7923281">=</span>&nbsp;<span class="ident" id="7923283">randomBytes</span><span class="op" id="7923294">(</span><span class="ident" id="7923295">rand</span><span class="op" id="7923299">.</span><span class="ident" id="7923300">Intn</span><span class="op" id="7923304">(</span><span class="num" id="7923305">15</span><span class="op" id="7923307">)</span><span class="op" id="7923308">+</span><span class="num" id="7923309">1</span><span class="op" id="7923310">,</span>&nbsp;<span class="ident" id="7923312">rand</span><span class="op" id="7923316">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923319">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923322">return</span>&nbsp;<span class="ident" id="7923329">reflect</span><span class="op" id="7923336">.</span><span class="ident" id="7923337">ValueOf</span><span class="op" id="7923344">(</span><span class="ident" id="7923345">m</span><span class="op" id="7923346">)</span><br>
<span class="lineno"></span><span class="op" id="7923348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7923351">func</span>&nbsp;<span class="op" id="7923356">(</span><span class="op" id="7923357">*</span><span class="ident" id="7923358">certificateVerifyMsg</span><span class="op" id="7923378">)</span>&nbsp;<span class="ident" id="7923380">Generate</span><span class="op" id="7923388">(</span><span class="ident" id="7923389">rand</span>&nbsp;<span class="op" id="7923394">*</span><span class="ident" id="7923395">rand</span><span class="op" id="7923399">.</span><span class="ident" id="7923400">Rand</span><span class="op" id="7923404">,</span>&nbsp;<span class="ident" id="7923406">size</span>&nbsp;<span class="builtintype" id="7923411">int</span><span class="op" id="7923414">)</span>&nbsp;<span class="ident" id="7923416">reflect</span><span class="op" id="7923423">.</span><span class="ident" id="7923424">Value</span>&nbsp;<span class="op" id="7923430">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923433">m</span>&nbsp;<span class="op" id="7923435">:=</span>&nbsp;<span class="op" id="7923438">&amp;</span><span class="ident" id="7923439">certificateVerifyMsg</span><span class="op" id="7923459">{</span><span class="op" id="7923460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923463">m</span><span class="op" id="7923464">.</span><span class="ident" id="7923465">signature</span>&nbsp;<span class="op" id="7923475">=</span>&nbsp;<span class="ident" id="7923477">randomBytes</span><span class="op" id="7923488">(</span><span class="ident" id="7923489">rand</span><span class="op" id="7923493">.</span><span class="ident" id="7923494">Intn</span><span class="op" id="7923498">(</span><span class="num" id="7923499">15</span><span class="op" id="7923501">)</span><span class="op" id="7923502">+</span><span class="num" id="7923503">1</span><span class="op" id="7923504">,</span>&nbsp;<span class="ident" id="7923506">rand</span><span class="op" id="7923510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923513">return</span>&nbsp;<span class="ident" id="7923520">reflect</span><span class="op" id="7923527">.</span><span class="ident" id="7923528">ValueOf</span><span class="op" id="7923535">(</span><span class="ident" id="7923536">m</span><span class="op" id="7923537">)</span><br>
<span class="lineno"></span><span class="op" id="7923539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="7923542">func</span>&nbsp;<span class="op" id="7923547">(</span><span class="op" id="7923548">*</span><span class="ident" id="7923549">certificateStatusMsg</span><span class="op" id="7923569">)</span>&nbsp;<span class="ident" id="7923571">Generate</span><span class="op" id="7923579">(</span><span class="ident" id="7923580">rand</span>&nbsp;<span class="op" id="7923585">*</span><span class="ident" id="7923586">rand</span><span class="op" id="7923590">.</span><span class="ident" id="7923591">Rand</span><span class="op" id="7923595">,</span>&nbsp;<span class="ident" id="7923597">size</span>&nbsp;<span class="builtintype" id="7923602">int</span><span class="op" id="7923605">)</span>&nbsp;<span class="ident" id="7923607">reflect</span><span class="op" id="7923614">.</span><span class="ident" id="7923615">Value</span>&nbsp;<span class="op" id="7923621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923624">m</span>&nbsp;<span class="op" id="7923626">:=</span>&nbsp;<span class="op" id="7923629">&amp;</span><span class="ident" id="7923630">certificateStatusMsg</span><span class="op" id="7923650">{</span><span class="op" id="7923651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923654">if</span>&nbsp;<span class="ident" id="7923657">rand</span><span class="op" id="7923661">.</span><span class="ident" id="7923662">Intn</span><span class="op" id="7923666">(</span><span class="num" id="7923667">10</span><span class="op" id="7923669">)</span>&nbsp;<span class="op" id="7923671">&gt;</span>&nbsp;<span class="num" id="7923673">5</span>&nbsp;<span class="op" id="7923675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923679">m</span><span class="op" id="7923680">.</span><span class="ident" id="7923681">statusType</span>&nbsp;<span class="op" id="7923692">=</span>&nbsp;<span class="ident" id="7923694">statusTypeOCSP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923711">m</span><span class="op" id="7923712">.</span><span class="ident" id="7923713">response</span>&nbsp;<span class="op" id="7923722">=</span>&nbsp;<span class="ident" id="7923724">randomBytes</span><span class="op" id="7923735">(</span><span class="ident" id="7923736">rand</span><span class="op" id="7923740">.</span><span class="ident" id="7923741">Intn</span><span class="op" id="7923745">(</span><span class="num" id="7923746">10</span><span class="op" id="7923748">)</span><span class="op" id="7923749">+</span><span class="num" id="7923750">1</span><span class="op" id="7923751">,</span>&nbsp;<span class="ident" id="7923753">rand</span><span class="op" id="7923757">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923760">}</span>&nbsp;<span class="keyword" id="7923762">else</span>&nbsp;<span class="op" id="7923767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923771">m</span><span class="op" id="7923772">.</span><span class="ident" id="7923773">statusType</span>&nbsp;<span class="op" id="7923784">=</span>&nbsp;<span class="num" id="7923786">42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7923790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923793">return</span>&nbsp;<span class="ident" id="7923800">reflect</span><span class="op" id="7923807">.</span><span class="ident" id="7923808">ValueOf</span><span class="op" id="7923815">(</span><span class="ident" id="7923816">m</span><span class="op" id="7923817">)</span><br>
<span class="lineno"></span><span class="op" id="7923819">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="7923822">func</span>&nbsp;<span class="op" id="7923827">(</span><span class="op" id="7923828">*</span><span class="ident" id="7923829">clientKeyExchangeMsg</span><span class="op" id="7923849">)</span>&nbsp;<span class="ident" id="7923851">Generate</span><span class="op" id="7923859">(</span><span class="ident" id="7923860">rand</span>&nbsp;<span class="op" id="7923865">*</span><span class="ident" id="7923866">rand</span><span class="op" id="7923870">.</span><span class="ident" id="7923871">Rand</span><span class="op" id="7923875">,</span>&nbsp;<span class="ident" id="7923877">size</span>&nbsp;<span class="builtintype" id="7923882">int</span><span class="op" id="7923885">)</span>&nbsp;<span class="ident" id="7923887">reflect</span><span class="op" id="7923894">.</span><span class="ident" id="7923895">Value</span>&nbsp;<span class="op" id="7923901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923904">m</span>&nbsp;<span class="op" id="7923906">:=</span>&nbsp;<span class="op" id="7923909">&amp;</span><span class="ident" id="7923910">clientKeyExchangeMsg</span><span class="op" id="7923930">{</span><span class="op" id="7923931">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7923934">m</span><span class="op" id="7923935">.</span><span class="ident" id="7923936">ciphertext</span>&nbsp;<span class="op" id="7923947">=</span>&nbsp;<span class="ident" id="7923949">randomBytes</span><span class="op" id="7923960">(</span><span class="ident" id="7923961">rand</span><span class="op" id="7923965">.</span><span class="ident" id="7923966">Intn</span><span class="op" id="7923970">(</span><span class="num" id="7923971">1000</span><span class="op" id="7923975">)</span><span class="op" id="7923976">+</span><span class="num" id="7923977">1</span><span class="op" id="7923978">,</span>&nbsp;<span class="ident" id="7923980">rand</span><span class="op" id="7923984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7923987">return</span>&nbsp;<span class="ident" id="7923994">reflect</span><span class="op" id="7924001">.</span><span class="ident" id="7924002">ValueOf</span><span class="op" id="7924009">(</span><span class="ident" id="7924010">m</span><span class="op" id="7924011">)</span><br>
<span class="lineno">220</span><span class="op" id="7924013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7924016">func</span>&nbsp;<span class="op" id="7924021">(</span><span class="op" id="7924022">*</span><span class="ident" id="7924023">finishedMsg</span><span class="op" id="7924034">)</span>&nbsp;<span class="ident" id="7924036">Generate</span><span class="op" id="7924044">(</span><span class="ident" id="7924045">rand</span>&nbsp;<span class="op" id="7924050">*</span><span class="ident" id="7924051">rand</span><span class="op" id="7924055">.</span><span class="ident" id="7924056">Rand</span><span class="op" id="7924060">,</span>&nbsp;<span class="ident" id="7924062">size</span>&nbsp;<span class="builtintype" id="7924067">int</span><span class="op" id="7924070">)</span>&nbsp;<span class="ident" id="7924072">reflect</span><span class="op" id="7924079">.</span><span class="ident" id="7924080">Value</span>&nbsp;<span class="op" id="7924086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924089">m</span>&nbsp;<span class="op" id="7924091">:=</span>&nbsp;<span class="op" id="7924094">&amp;</span><span class="ident" id="7924095">finishedMsg</span><span class="op" id="7924106">{</span><span class="op" id="7924107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924110">m</span><span class="op" id="7924111">.</span><span class="ident" id="7924112">verifyData</span>&nbsp;<span class="op" id="7924123">=</span>&nbsp;<span class="ident" id="7924125">randomBytes</span><span class="op" id="7924136">(</span><span class="num" id="7924137">12</span><span class="op" id="7924139">,</span>&nbsp;<span class="ident" id="7924141">rand</span><span class="op" id="7924145">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924148">return</span>&nbsp;<span class="ident" id="7924155">reflect</span><span class="op" id="7924162">.</span><span class="ident" id="7924163">ValueOf</span><span class="op" id="7924170">(</span><span class="ident" id="7924171">m</span><span class="op" id="7924172">)</span><br>
<span class="lineno"></span><span class="op" id="7924174">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7924177">func</span>&nbsp;<span class="op" id="7924182">(</span><span class="op" id="7924183">*</span><span class="ident" id="7924184">nextProtoMsg</span><span class="op" id="7924196">)</span>&nbsp;<span class="ident" id="7924198">Generate</span><span class="op" id="7924206">(</span><span class="ident" id="7924207">rand</span>&nbsp;<span class="op" id="7924212">*</span><span class="ident" id="7924213">rand</span><span class="op" id="7924217">.</span><span class="ident" id="7924218">Rand</span><span class="op" id="7924222">,</span>&nbsp;<span class="ident" id="7924224">size</span>&nbsp;<span class="builtintype" id="7924229">int</span><span class="op" id="7924232">)</span>&nbsp;<span class="ident" id="7924234">reflect</span><span class="op" id="7924241">.</span><span class="ident" id="7924242">Value</span>&nbsp;<span class="op" id="7924248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924251">m</span>&nbsp;<span class="op" id="7924253">:=</span>&nbsp;<span class="op" id="7924256">&amp;</span><span class="ident" id="7924257">nextProtoMsg</span><span class="op" id="7924269">{</span><span class="op" id="7924270">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924273">m</span><span class="op" id="7924274">.</span><span class="ident" id="7924275">proto</span>&nbsp;<span class="op" id="7924281">=</span>&nbsp;<span class="ident" id="7924283">randomString</span><span class="op" id="7924295">(</span><span class="ident" id="7924296">rand</span><span class="op" id="7924300">.</span><span class="ident" id="7924301">Intn</span><span class="op" id="7924305">(</span><span class="num" id="7924306">255</span><span class="op" id="7924309">)</span><span class="op" id="7924310">,</span>&nbsp;<span class="ident" id="7924312">rand</span><span class="op" id="7924316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924319">return</span>&nbsp;<span class="ident" id="7924326">reflect</span><span class="op" id="7924333">.</span><span class="ident" id="7924334">ValueOf</span><span class="op" id="7924341">(</span><span class="ident" id="7924342">m</span><span class="op" id="7924343">)</span><br>
<span class="lineno"></span><span class="op" id="7924345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7924348">func</span>&nbsp;<span class="op" id="7924353">(</span><span class="op" id="7924354">*</span><span class="ident" id="7924355">newSessionTicketMsg</span><span class="op" id="7924374">)</span>&nbsp;<span class="ident" id="7924376">Generate</span><span class="op" id="7924384">(</span><span class="ident" id="7924385">rand</span>&nbsp;<span class="op" id="7924390">*</span><span class="ident" id="7924391">rand</span><span class="op" id="7924395">.</span><span class="ident" id="7924396">Rand</span><span class="op" id="7924400">,</span>&nbsp;<span class="ident" id="7924402">size</span>&nbsp;<span class="builtintype" id="7924407">int</span><span class="op" id="7924410">)</span>&nbsp;<span class="ident" id="7924412">reflect</span><span class="op" id="7924419">.</span><span class="ident" id="7924420">Value</span>&nbsp;<span class="op" id="7924426">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924429">m</span>&nbsp;<span class="op" id="7924431">:=</span>&nbsp;<span class="op" id="7924434">&amp;</span><span class="ident" id="7924435">newSessionTicketMsg</span><span class="op" id="7924454">{</span><span class="op" id="7924455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924458">m</span><span class="op" id="7924459">.</span><span class="ident" id="7924460">ticket</span>&nbsp;<span class="op" id="7924467">=</span>&nbsp;<span class="ident" id="7924469">randomBytes</span><span class="op" id="7924480">(</span><span class="ident" id="7924481">rand</span><span class="op" id="7924485">.</span><span class="ident" id="7924486">Intn</span><span class="op" id="7924490">(</span><span class="num" id="7924491">4</span><span class="op" id="7924492">)</span><span class="op" id="7924493">,</span>&nbsp;<span class="ident" id="7924495">rand</span><span class="op" id="7924499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924502">return</span>&nbsp;<span class="ident" id="7924509">reflect</span><span class="op" id="7924516">.</span><span class="ident" id="7924517">ValueOf</span><span class="op" id="7924524">(</span><span class="ident" id="7924525">m</span><span class="op" id="7924526">)</span><br>
<span class="lineno"></span><span class="op" id="7924528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="7924531">func</span>&nbsp;<span class="op" id="7924536">(</span><span class="op" id="7924537">*</span><span class="ident" id="7924538">sessionState</span><span class="op" id="7924550">)</span>&nbsp;<span class="ident" id="7924552">Generate</span><span class="op" id="7924560">(</span><span class="ident" id="7924561">rand</span>&nbsp;<span class="op" id="7924566">*</span><span class="ident" id="7924567">rand</span><span class="op" id="7924571">.</span><span class="ident" id="7924572">Rand</span><span class="op" id="7924576">,</span>&nbsp;<span class="ident" id="7924578">size</span>&nbsp;<span class="builtintype" id="7924583">int</span><span class="op" id="7924586">)</span>&nbsp;<span class="ident" id="7924588">reflect</span><span class="op" id="7924595">.</span><span class="ident" id="7924596">Value</span>&nbsp;<span class="op" id="7924602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924605">s</span>&nbsp;<span class="op" id="7924607">:=</span>&nbsp;<span class="op" id="7924610">&amp;</span><span class="ident" id="7924611">sessionState</span><span class="op" id="7924623">{</span><span class="op" id="7924624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924627">s</span><span class="op" id="7924628">.</span><span class="ident" id="7924629">vers</span>&nbsp;<span class="op" id="7924634">=</span>&nbsp;<span class="builtintype" id="7924636">uint16</span><span class="op" id="7924642">(</span><span class="ident" id="7924643">rand</span><span class="op" id="7924647">.</span><span class="ident" id="7924648">Intn</span><span class="op" id="7924652">(</span><span class="num" id="7924653">10000</span><span class="op" id="7924658">)</span><span class="op" id="7924659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924662">s</span><span class="op" id="7924663">.</span><span class="ident" id="7924664">cipherSuite</span>&nbsp;<span class="op" id="7924676">=</span>&nbsp;<span class="builtintype" id="7924678">uint16</span><span class="op" id="7924684">(</span><span class="ident" id="7924685">rand</span><span class="op" id="7924689">.</span><span class="ident" id="7924690">Intn</span><span class="op" id="7924694">(</span><span class="num" id="7924695">10000</span><span class="op" id="7924700">)</span><span class="op" id="7924701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924704">s</span><span class="op" id="7924705">.</span><span class="ident" id="7924706">masterSecret</span>&nbsp;<span class="op" id="7924719">=</span>&nbsp;<span class="ident" id="7924721">randomBytes</span><span class="op" id="7924732">(</span><span class="ident" id="7924733">rand</span><span class="op" id="7924737">.</span><span class="ident" id="7924738">Intn</span><span class="op" id="7924742">(</span><span class="num" id="7924743">100</span><span class="op" id="7924746">)</span><span class="op" id="7924747">,</span>&nbsp;<span class="ident" id="7924749">rand</span><span class="op" id="7924753">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924756">numCerts</span>&nbsp;<span class="op" id="7924765">:=</span>&nbsp;<span class="ident" id="7924768">rand</span><span class="op" id="7924772">.</span><span class="ident" id="7924773">Intn</span><span class="op" id="7924777">(</span><span class="num" id="7924778">20</span><span class="op" id="7924780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924783">s</span><span class="op" id="7924784">.</span><span class="ident" id="7924785">certificates</span>&nbsp;<span class="op" id="7924798">=</span>&nbsp;<span class="builtinfunc" id="7924800">make</span><span class="op" id="7924804">(</span><span class="op" id="7924805">[</span><span class="op" id="7924806">]</span><span class="op" id="7924807">[</span><span class="op" id="7924808">]</span><span class="builtintype" id="7924809">byte</span><span class="op" id="7924813">,</span>&nbsp;<span class="ident" id="7924815">numCerts</span><span class="op" id="7924823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924826">for</span>&nbsp;<span class="ident" id="7924830">i</span>&nbsp;<span class="op" id="7924832">:=</span>&nbsp;<span class="num" id="7924835">0</span><span class="op" id="7924836">;</span>&nbsp;<span class="ident" id="7924838">i</span>&nbsp;<span class="op" id="7924840">&lt;</span>&nbsp;<span class="ident" id="7924842">numCerts</span><span class="op" id="7924850">;</span>&nbsp;<span class="ident" id="7924852">i</span><span class="op" id="7924853">++</span>&nbsp;<span class="op" id="7924856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7924860">s</span><span class="op" id="7924861">.</span><span class="ident" id="7924862">certificates</span><span class="op" id="7924874">[</span><span class="ident" id="7924875">i</span><span class="op" id="7924876">]</span>&nbsp;<span class="op" id="7924878">=</span>&nbsp;<span class="ident" id="7924880">randomBytes</span><span class="op" id="7924891">(</span><span class="ident" id="7924892">rand</span><span class="op" id="7924896">.</span><span class="ident" id="7924897">Intn</span><span class="op" id="7924901">(</span><span class="num" id="7924902">10</span><span class="op" id="7924904">)</span><span class="op" id="7924905">+</span><span class="num" id="7924906">1</span><span class="op" id="7924907">,</span>&nbsp;<span class="ident" id="7924909">rand</span><span class="op" id="7924913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7924916">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7924919">return</span>&nbsp;<span class="ident" id="7924926">reflect</span><span class="op" id="7924933">.</span><span class="ident" id="7924934">ValueOf</span><span class="op" id="7924941">(</span><span class="ident" id="7924942">s</span><span class="op" id="7924943">)</span><br>
<span class="lineno"></span><span class="op" id="7924945">}</span>
</div>
</body>
</html>
