<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3433850">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3433905">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3433959">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3434010">package</span>&nbsp;<span class="ident" id="3434018">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3434028">import</span>&nbsp;<span class="op" id="3434035">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434038">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434047">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434057">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434064">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434070">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434081">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434092">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434103">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434114">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3434129">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3434132">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to&nbsp;functions.</span><br>
<span class="lineno">20</span><span class="comment" id="3434212">//&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two&nbsp;return&nbsp;values&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3434293">//&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the&nbsp;second&nbsp;(error)</span><br>
<span class="lineno"></span><span class="comment" id="3434365">//&nbsp;return&nbsp;value&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution&nbsp;terminates&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3434445">//&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3434476">type</span>&nbsp;<span class="ident" id="3434481">FuncMap</span>&nbsp;<span class="keyword" id="3434489">map</span><span class="op" id="3434492">[</span><span class="builtintype" id="3434493">string</span><span class="op" id="3434499">]</span><span class="keyword" id="3434500">interface</span><span class="op" id="3434509">{</span><span class="op" id="3434510">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="3434513">var</span>&nbsp;<span class="ident" id="3434517">builtins</span>&nbsp;<span class="op" id="3434526">=</span>&nbsp;<span class="ident" id="3434528">FuncMap</span><span class="op" id="3434535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434538">&#34;and&#34;</span><span class="op" id="3434543">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434550">and</span><span class="op" id="3434553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434556">&#34;call&#34;</span><span class="op" id="3434562">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434568">call</span><span class="op" id="3434572">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434575">&#34;html&#34;</span><span class="op" id="3434581">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434587">HTMLEscaper</span><span class="op" id="3434598">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434601">&#34;index&#34;</span><span class="op" id="3434608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434613">index</span><span class="op" id="3434618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434621">&#34;js&#34;</span><span class="op" id="3434625">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434633">JSEscaper</span><span class="op" id="3434642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434645">&#34;len&#34;</span><span class="op" id="3434650">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434657">length</span><span class="op" id="3434663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434666">&#34;not&#34;</span><span class="op" id="3434671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434678">not</span><span class="op" id="3434681">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434684">&#34;or&#34;</span><span class="op" id="3434688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434696">or</span><span class="op" id="3434698">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434701">&#34;print&#34;</span><span class="op" id="3434708">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3434713">fmt</span><span class="op" id="3434716">.</span><span class="ident" id="3434717">Sprint</span><span class="op" id="3434723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434726">&#34;printf&#34;</span><span class="op" id="3434734">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3434738">fmt</span><span class="op" id="3434741">.</span><span class="ident" id="3434742">Sprintf</span><span class="op" id="3434749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434752">&#34;println&#34;</span><span class="op" id="3434761">:</span>&nbsp;&nbsp;<span class="ident" id="3434764">fmt</span><span class="op" id="3434767">.</span><span class="ident" id="3434768">Sprintln</span><span class="op" id="3434776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434779">&#34;urlquery&#34;</span><span class="op" id="3434789">:</span>&nbsp;<span class="ident" id="3434791">URLQueryEscaper</span><span class="op" id="3434806">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3434810">//&nbsp;Comparisons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434826">&#34;eq&#34;</span><span class="op" id="3434830">:</span>&nbsp;<span class="ident" id="3434832">eq</span><span class="op" id="3434834">,</span>&nbsp;<span class="comment" id="3434836">//&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434843">&#34;ge&#34;</span><span class="op" id="3434847">:</span>&nbsp;<span class="ident" id="3434849">ge</span><span class="op" id="3434851">,</span>&nbsp;<span class="comment" id="3434853">//&nbsp;&gt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434860">&#34;gt&#34;</span><span class="op" id="3434864">:</span>&nbsp;<span class="ident" id="3434866">gt</span><span class="op" id="3434868">,</span>&nbsp;<span class="comment" id="3434870">//&nbsp;&gt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434876">&#34;le&#34;</span><span class="op" id="3434880">:</span>&nbsp;<span class="ident" id="3434882">le</span><span class="op" id="3434884">,</span>&nbsp;<span class="comment" id="3434886">//&nbsp;&lt;=</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434893">&#34;lt&#34;</span><span class="op" id="3434897">:</span>&nbsp;<span class="ident" id="3434899">lt</span><span class="op" id="3434901">,</span>&nbsp;<span class="comment" id="3434903">//&nbsp;&lt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3434909">&#34;ne&#34;</span><span class="op" id="3434913">:</span>&nbsp;<span class="ident" id="3434915">ne</span><span class="op" id="3434917">,</span>&nbsp;<span class="comment" id="3434919">//&nbsp;!=</span><br>
<span class="lineno"></span><span class="op" id="3434925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3434928">var</span>&nbsp;<span class="ident" id="3434932">builtinFuncs</span>&nbsp;<span class="op" id="3434945">=</span>&nbsp;<span class="ident" id="3434947">createValueFuncs</span><span class="op" id="3434963">(</span><span class="ident" id="3434964">builtins</span><span class="op" id="3434972">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="3434975">//&nbsp;createValueFuncs&nbsp;turns&nbsp;a&nbsp;FuncMap&nbsp;into&nbsp;a&nbsp;map[string]reflect.Value</span><br>
<span class="lineno"></span><span class="keyword" id="3435043">func</span>&nbsp;<span class="ident" id="3435048">createValueFuncs</span><span class="op" id="3435064">(</span><span class="ident" id="3435065">funcMap</span>&nbsp;<span class="ident" id="3435073">FuncMap</span><span class="op" id="3435080">)</span>&nbsp;<span class="keyword" id="3435082">map</span><span class="op" id="3435085">[</span><span class="builtintype" id="3435086">string</span><span class="op" id="3435092">]</span><span class="ident" id="3435093">reflect</span><span class="op" id="3435100">.</span><span class="ident" id="3435101">Value</span>&nbsp;<span class="op" id="3435107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3435110">m</span>&nbsp;<span class="op" id="3435112">:=</span>&nbsp;<span class="builtinfunc" id="3435115">make</span><span class="op" id="3435119">(</span><span class="keyword" id="3435120">map</span><span class="op" id="3435123">[</span><span class="builtintype" id="3435124">string</span><span class="op" id="3435130">]</span><span class="ident" id="3435131">reflect</span><span class="op" id="3435138">.</span><span class="ident" id="3435139">Value</span><span class="op" id="3435144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3435147">addValueFuncs</span><span class="op" id="3435160">(</span><span class="ident" id="3435161">m</span><span class="op" id="3435162">,</span>&nbsp;<span class="ident" id="3435164">funcMap</span><span class="op" id="3435171">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3435174">return</span>&nbsp;<span class="ident" id="3435181">m</span><br>
<span class="lineno"></span><span class="op" id="3435183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3435186">//&nbsp;addValueFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs,&nbsp;converting&nbsp;them&nbsp;to&nbsp;reflect.Values.</span><br>
<span class="lineno"></span><span class="keyword" id="3435277">func</span>&nbsp;<span class="ident" id="3435282">addValueFuncs</span><span class="op" id="3435295">(</span><span class="ident" id="3435296">out</span>&nbsp;<span class="keyword" id="3435300">map</span><span class="op" id="3435303">[</span><span class="builtintype" id="3435304">string</span><span class="op" id="3435310">]</span><span class="ident" id="3435311">reflect</span><span class="op" id="3435318">.</span><span class="ident" id="3435319">Value</span><span class="op" id="3435324">,</span>&nbsp;<span class="ident" id="3435326">in</span>&nbsp;<span class="ident" id="3435329">FuncMap</span><span class="op" id="3435336">)</span>&nbsp;<span class="op" id="3435338">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3435341">for</span>&nbsp;<span class="ident" id="3435345">name</span><span class="op" id="3435349">,</span>&nbsp;<span class="ident" id="3435351">fn</span>&nbsp;<span class="op" id="3435354">:=</span>&nbsp;<span class="keyword" id="3435357">range</span>&nbsp;<span class="ident" id="3435363">in</span>&nbsp;<span class="op" id="3435366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3435370">v</span>&nbsp;<span class="op" id="3435372">:=</span>&nbsp;<span class="ident" id="3435375">reflect</span><span class="op" id="3435382">.</span><span class="ident" id="3435383">ValueOf</span><span class="op" id="3435390">(</span><span class="ident" id="3435391">fn</span><span class="op" id="3435393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3435397">if</span>&nbsp;<span class="ident" id="3435400">v</span><span class="op" id="3435401">.</span><span class="ident" id="3435402">Kind</span><span class="op" id="3435406">(</span><span class="op" id="3435407">)</span>&nbsp;<span class="op" id="3435409">!=</span>&nbsp;<span class="ident" id="3435412">reflect</span><span class="op" id="3435419">.</span><span class="ident" id="3435420">Func</span>&nbsp;<span class="op" id="3435425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3435430">panic</span><span class="op" id="3435435">(</span><span class="string" id="3435436">&#34;value&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="3435449">+</span>&nbsp;<span class="ident" id="3435451">name</span>&nbsp;<span class="op" id="3435456">+</span>&nbsp;<span class="string" id="3435458">&#34;&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="3435475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3435479">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3435483">if</span>&nbsp;<span class="op" id="3435486">!</span><span class="ident" id="3435487">goodFunc</span><span class="op" id="3435495">(</span><span class="ident" id="3435496">v</span><span class="op" id="3435497">.</span><span class="ident" id="3435498">Type</span><span class="op" id="3435502">(</span><span class="op" id="3435503">)</span><span class="op" id="3435504">)</span>&nbsp;<span class="op" id="3435506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3435511">panic</span><span class="op" id="3435516">(</span><span class="ident" id="3435517">fmt</span><span class="op" id="3435520">.</span><span class="ident" id="3435521">Errorf</span><span class="op" id="3435527">(</span><span class="string" id="3435528">&#34;can&#39;t&nbsp;install&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3435578">,</span>&nbsp;<span class="ident" id="3435580">name</span><span class="op" id="3435584">,</span>&nbsp;<span class="ident" id="3435586">v</span><span class="op" id="3435587">.</span><span class="ident" id="3435588">Type</span><span class="op" id="3435592">(</span><span class="op" id="3435593">)</span><span class="op" id="3435594">.</span><span class="ident" id="3435595">NumOut</span><span class="op" id="3435601">(</span><span class="op" id="3435602">)</span><span class="op" id="3435603">)</span><span class="op" id="3435604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3435608">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3435612">out</span><span class="op" id="3435615">[</span><span class="ident" id="3435616">name</span><span class="op" id="3435620">]</span>&nbsp;<span class="op" id="3435622">=</span>&nbsp;<span class="ident" id="3435624">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3435627">}</span><br>
<span class="lineno">70</span><span class="op" id="3435629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3435632">//&nbsp;addFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs.&nbsp;It&nbsp;does&nbsp;no&nbsp;checking&nbsp;of&nbsp;the&nbsp;input&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="3435718">//&nbsp;call&nbsp;addValueFuncs&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="3435747">func</span>&nbsp;<span class="ident" id="3435752">addFuncs</span><span class="op" id="3435760">(</span><span class="ident" id="3435761">out</span><span class="op" id="3435764">,</span>&nbsp;<span class="ident" id="3435766">in</span>&nbsp;<span class="ident" id="3435769">FuncMap</span><span class="op" id="3435776">)</span>&nbsp;<span class="op" id="3435778">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3435781">for</span>&nbsp;<span class="ident" id="3435785">name</span><span class="op" id="3435789">,</span>&nbsp;<span class="ident" id="3435791">fn</span>&nbsp;<span class="op" id="3435794">:=</span>&nbsp;<span class="keyword" id="3435797">range</span>&nbsp;<span class="ident" id="3435803">in</span>&nbsp;<span class="op" id="3435806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3435810">out</span><span class="op" id="3435813">[</span><span class="ident" id="3435814">name</span><span class="op" id="3435818">]</span>&nbsp;<span class="op" id="3435820">=</span>&nbsp;<span class="ident" id="3435822">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3435826">}</span><br>
<span class="lineno"></span><span class="op" id="3435828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="3435831">//&nbsp;goodFunc&nbsp;checks&nbsp;that&nbsp;the&nbsp;function&nbsp;or&nbsp;method&nbsp;has&nbsp;the&nbsp;right&nbsp;result&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="3435910">func</span>&nbsp;<span class="ident" id="3435915">goodFunc</span><span class="op" id="3435923">(</span><span class="ident" id="3435924">typ</span>&nbsp;<span class="ident" id="3435928">reflect</span><span class="op" id="3435935">.</span><span class="ident" id="3435936">Type</span><span class="op" id="3435940">)</span>&nbsp;<span class="builtintype" id="3435942">bool</span>&nbsp;<span class="op" id="3435947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3435950">//&nbsp;We&nbsp;allow&nbsp;functions&nbsp;with&nbsp;1&nbsp;result&nbsp;or&nbsp;2&nbsp;results&nbsp;where&nbsp;the&nbsp;second&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436030">switch</span>&nbsp;<span class="op" id="3436037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436040">case</span>&nbsp;<span class="ident" id="3436045">typ</span><span class="op" id="3436048">.</span><span class="ident" id="3436049">NumOut</span><span class="op" id="3436055">(</span><span class="op" id="3436056">)</span>&nbsp;<span class="op" id="3436058">==</span>&nbsp;<span class="num" id="3436061">1</span><span class="op" id="3436062">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436066">return</span>&nbsp;<span class="builtintype" id="3436073">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436079">case</span>&nbsp;<span class="ident" id="3436084">typ</span><span class="op" id="3436087">.</span><span class="ident" id="3436088">NumOut</span><span class="op" id="3436094">(</span><span class="op" id="3436095">)</span>&nbsp;<span class="op" id="3436097">==</span>&nbsp;<span class="num" id="3436100">2</span>&nbsp;<span class="op" id="3436102">&amp;&amp;</span>&nbsp;<span class="ident" id="3436105">typ</span><span class="op" id="3436108">.</span><span class="ident" id="3436109">Out</span><span class="op" id="3436112">(</span><span class="num" id="3436113">1</span><span class="op" id="3436114">)</span>&nbsp;<span class="op" id="3436116">==</span>&nbsp;<span class="ident" id="3436119">errorType</span><span class="op" id="3436128">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436132">return</span>&nbsp;<span class="builtintype" id="3436139">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3436145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436148">return</span>&nbsp;<span class="builtintype" id="3436155">false</span><br>
<span class="lineno">90</span><span class="op" id="3436161">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3436164">//&nbsp;findFunction&nbsp;looks&nbsp;for&nbsp;a&nbsp;function&nbsp;in&nbsp;the&nbsp;template,&nbsp;and&nbsp;global&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="3436234">func</span>&nbsp;<span class="ident" id="3436239">findFunction</span><span class="op" id="3436251">(</span><span class="ident" id="3436252">name</span>&nbsp;<span class="builtintype" id="3436257">string</span><span class="op" id="3436263">,</span>&nbsp;<span class="ident" id="3436265">tmpl</span>&nbsp;<span class="op" id="3436270">*</span><span class="ident" id="3436271">Template</span><span class="op" id="3436279">)</span>&nbsp;<span class="op" id="3436281">(</span><span class="ident" id="3436282">reflect</span><span class="op" id="3436289">.</span><span class="ident" id="3436290">Value</span><span class="op" id="3436295">,</span>&nbsp;<span class="builtintype" id="3436297">bool</span><span class="op" id="3436301">)</span>&nbsp;<span class="op" id="3436303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436306">if</span>&nbsp;<span class="ident" id="3436309">tmpl</span>&nbsp;<span class="op" id="3436314">!=</span>&nbsp;<span class="ident" id="3436317">nil</span>&nbsp;<span class="op" id="3436321">&amp;&amp;</span>&nbsp;<span class="ident" id="3436324">tmpl</span><span class="op" id="3436328">.</span><span class="ident" id="3436329">common</span>&nbsp;<span class="op" id="3436336">!=</span>&nbsp;<span class="ident" id="3436339">nil</span>&nbsp;<span class="op" id="3436343">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436347">if</span>&nbsp;<span class="ident" id="3436350">fn</span>&nbsp;<span class="op" id="3436353">:=</span>&nbsp;<span class="ident" id="3436356">tmpl</span><span class="op" id="3436360">.</span><span class="ident" id="3436361">execFuncs</span><span class="op" id="3436370">[</span><span class="ident" id="3436371">name</span><span class="op" id="3436375">]</span><span class="op" id="3436376">;</span>&nbsp;<span class="ident" id="3436378">fn</span><span class="op" id="3436380">.</span><span class="ident" id="3436381">IsValid</span><span class="op" id="3436388">(</span><span class="op" id="3436389">)</span>&nbsp;<span class="op" id="3436391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436396">return</span>&nbsp;<span class="ident" id="3436403">fn</span><span class="op" id="3436405">,</span>&nbsp;<span class="builtintype" id="3436407">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3436414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3436417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436420">if</span>&nbsp;<span class="ident" id="3436423">fn</span>&nbsp;<span class="op" id="3436426">:=</span>&nbsp;<span class="ident" id="3436429">builtinFuncs</span><span class="op" id="3436441">[</span><span class="ident" id="3436442">name</span><span class="op" id="3436446">]</span><span class="op" id="3436447">;</span>&nbsp;<span class="ident" id="3436449">fn</span><span class="op" id="3436451">.</span><span class="ident" id="3436452">IsValid</span><span class="op" id="3436459">(</span><span class="op" id="3436460">)</span>&nbsp;<span class="op" id="3436462">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436466">return</span>&nbsp;<span class="ident" id="3436473">fn</span><span class="op" id="3436475">,</span>&nbsp;<span class="builtintype" id="3436477">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3436483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436486">return</span>&nbsp;<span class="ident" id="3436493">reflect</span><span class="op" id="3436500">.</span><span class="ident" id="3436501">Value</span><span class="op" id="3436506">{</span><span class="op" id="3436507">}</span><span class="op" id="3436508">,</span>&nbsp;<span class="builtintype" id="3436510">false</span><br>
<span class="lineno"></span><span class="op" id="3436516">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="3436519">//&nbsp;Indexing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3436533">//&nbsp;index&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;indexing&nbsp;its&nbsp;first&nbsp;argument&nbsp;by&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="3436609">//&nbsp;arguments.&nbsp;&nbsp;Thus&nbsp;&#34;index&nbsp;x&nbsp;1&nbsp;2&nbsp;3&#34;&nbsp;is,&nbsp;in&nbsp;Go&nbsp;syntax,&nbsp;x[1][2][3].&nbsp;Each</span><br>
<span class="lineno"></span><span class="comment" id="3436680">//&nbsp;indexed&nbsp;item&nbsp;must&nbsp;be&nbsp;a&nbsp;map,&nbsp;slice,&nbsp;or&nbsp;array.</span><br>
<span class="lineno">110</span><span class="keyword" id="3436728">func</span>&nbsp;<span class="ident" id="3436733">index</span><span class="op" id="3436738">(</span><span class="ident" id="3436739">item</span>&nbsp;<span class="keyword" id="3436744">interface</span><span class="op" id="3436753">{</span><span class="op" id="3436754">}</span><span class="op" id="3436755">,</span>&nbsp;<span class="ident" id="3436757">indices</span>&nbsp;<span class="op" id="3436765">...</span><span class="keyword" id="3436768">interface</span><span class="op" id="3436777">{</span><span class="op" id="3436778">}</span><span class="op" id="3436779">)</span>&nbsp;<span class="op" id="3436781">(</span><span class="keyword" id="3436782">interface</span><span class="op" id="3436791">{</span><span class="op" id="3436792">}</span><span class="op" id="3436793">,</span>&nbsp;<span class="builtintype" id="3436795">error</span><span class="op" id="3436800">)</span>&nbsp;<span class="op" id="3436802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3436805">v</span>&nbsp;<span class="op" id="3436807">:=</span>&nbsp;<span class="ident" id="3436810">reflect</span><span class="op" id="3436817">.</span><span class="ident" id="3436818">ValueOf</span><span class="op" id="3436825">(</span><span class="ident" id="3436826">item</span><span class="op" id="3436830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436833">for</span>&nbsp;<span class="ident" id="3436837">_</span><span class="op" id="3436838">,</span>&nbsp;<span class="ident" id="3436840">i</span>&nbsp;<span class="op" id="3436842">:=</span>&nbsp;<span class="keyword" id="3436845">range</span>&nbsp;<span class="ident" id="3436851">indices</span>&nbsp;<span class="op" id="3436859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3436863">index</span>&nbsp;<span class="op" id="3436869">:=</span>&nbsp;<span class="ident" id="3436872">reflect</span><span class="op" id="3436879">.</span><span class="ident" id="3436880">ValueOf</span><span class="op" id="3436887">(</span><span class="ident" id="3436888">i</span><span class="op" id="3436889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436893">var</span>&nbsp;<span class="ident" id="3436897">isNil</span>&nbsp;<span class="builtintype" id="3436903">bool</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436910">if</span>&nbsp;<span class="ident" id="3436913">v</span><span class="op" id="3436914">,</span>&nbsp;<span class="ident" id="3436916">isNil</span>&nbsp;<span class="op" id="3436922">=</span>&nbsp;<span class="ident" id="3436924">indirect</span><span class="op" id="3436932">(</span><span class="ident" id="3436933">v</span><span class="op" id="3436934">)</span><span class="op" id="3436935">;</span>&nbsp;<span class="ident" id="3436937">isNil</span>&nbsp;<span class="op" id="3436943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3436948">return</span>&nbsp;<span class="ident" id="3436955">nil</span><span class="op" id="3436958">,</span>&nbsp;<span class="ident" id="3436960">fmt</span><span class="op" id="3436963">.</span><span class="ident" id="3436964">Errorf</span><span class="op" id="3436970">(</span><span class="string" id="3436971">&#34;index&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3436993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3436997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437001">switch</span>&nbsp;<span class="ident" id="3437008">v</span><span class="op" id="3437009">.</span><span class="ident" id="3437010">Kind</span><span class="op" id="3437014">(</span><span class="op" id="3437015">)</span>&nbsp;<span class="op" id="3437017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437021">case</span>&nbsp;<span class="ident" id="3437026">reflect</span><span class="op" id="3437033">.</span><span class="ident" id="3437034">Array</span><span class="op" id="3437039">,</span>&nbsp;<span class="ident" id="3437041">reflect</span><span class="op" id="3437048">.</span><span class="ident" id="3437049">Slice</span><span class="op" id="3437054">,</span>&nbsp;<span class="ident" id="3437056">reflect</span><span class="op" id="3437063">.</span><span class="ident" id="3437064">String</span><span class="op" id="3437070">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437075">var</span>&nbsp;<span class="ident" id="3437079">x</span>&nbsp;<span class="ident" id="3437081">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437090">switch</span>&nbsp;<span class="ident" id="3437097">index</span><span class="op" id="3437102">.</span><span class="ident" id="3437103">Kind</span><span class="op" id="3437107">(</span><span class="op" id="3437108">)</span>&nbsp;<span class="op" id="3437110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437115">case</span>&nbsp;<span class="ident" id="3437120">reflect</span><span class="op" id="3437127">.</span><span class="ident" id="3437128">Int</span><span class="op" id="3437131">,</span>&nbsp;<span class="ident" id="3437133">reflect</span><span class="op" id="3437140">.</span><span class="ident" id="3437141">Int8</span><span class="op" id="3437145">,</span>&nbsp;<span class="ident" id="3437147">reflect</span><span class="op" id="3437154">.</span><span class="ident" id="3437155">Int16</span><span class="op" id="3437160">,</span>&nbsp;<span class="ident" id="3437162">reflect</span><span class="op" id="3437169">.</span><span class="ident" id="3437170">Int32</span><span class="op" id="3437175">,</span>&nbsp;<span class="ident" id="3437177">reflect</span><span class="op" id="3437184">.</span><span class="ident" id="3437185">Int64</span><span class="op" id="3437190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437196">x</span>&nbsp;<span class="op" id="3437198">=</span>&nbsp;<span class="ident" id="3437200">index</span><span class="op" id="3437205">.</span><span class="ident" id="3437206">Int</span><span class="op" id="3437209">(</span><span class="op" id="3437210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437215">case</span>&nbsp;<span class="ident" id="3437220">reflect</span><span class="op" id="3437227">.</span><span class="ident" id="3437228">Uint</span><span class="op" id="3437232">,</span>&nbsp;<span class="ident" id="3437234">reflect</span><span class="op" id="3437241">.</span><span class="ident" id="3437242">Uint8</span><span class="op" id="3437247">,</span>&nbsp;<span class="ident" id="3437249">reflect</span><span class="op" id="3437256">.</span><span class="ident" id="3437257">Uint16</span><span class="op" id="3437263">,</span>&nbsp;<span class="ident" id="3437265">reflect</span><span class="op" id="3437272">.</span><span class="ident" id="3437273">Uint32</span><span class="op" id="3437279">,</span>&nbsp;<span class="ident" id="3437281">reflect</span><span class="op" id="3437288">.</span><span class="ident" id="3437289">Uint64</span><span class="op" id="3437295">,</span>&nbsp;<span class="ident" id="3437297">reflect</span><span class="op" id="3437304">.</span><span class="ident" id="3437305">Uintptr</span><span class="op" id="3437312">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437318">x</span>&nbsp;<span class="op" id="3437320">=</span>&nbsp;<span class="ident" id="3437322">int64</span><span class="op" id="3437327">(</span><span class="ident" id="3437328">index</span><span class="op" id="3437333">.</span><span class="ident" id="3437334">Uint</span><span class="op" id="3437338">(</span><span class="op" id="3437339">)</span><span class="op" id="3437340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437345">default</span><span class="op" id="3437352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437358">return</span>&nbsp;<span class="ident" id="3437365">nil</span><span class="op" id="3437368">,</span>&nbsp;<span class="ident" id="3437370">fmt</span><span class="op" id="3437373">.</span><span class="ident" id="3437374">Errorf</span><span class="op" id="3437380">(</span><span class="string" id="3437381">&#34;cannot&nbsp;index&nbsp;slice/array&nbsp;with&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3437420">,</span>&nbsp;<span class="ident" id="3437422">index</span><span class="op" id="3437427">.</span><span class="ident" id="3437428">Type</span><span class="op" id="3437432">(</span><span class="op" id="3437433">)</span><span class="op" id="3437434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437444">if</span>&nbsp;<span class="ident" id="3437447">x</span>&nbsp;<span class="op" id="3437449">&lt;</span>&nbsp;<span class="num" id="3437451">0</span>&nbsp;<span class="op" id="3437453">||</span>&nbsp;<span class="ident" id="3437456">x</span>&nbsp;<span class="op" id="3437458">&gt;=</span>&nbsp;<span class="ident" id="3437461">int64</span><span class="op" id="3437466">(</span><span class="ident" id="3437467">v</span><span class="op" id="3437468">.</span><span class="ident" id="3437469">Len</span><span class="op" id="3437472">(</span><span class="op" id="3437473">)</span><span class="op" id="3437474">)</span>&nbsp;<span class="op" id="3437476">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437482">return</span>&nbsp;<span class="ident" id="3437489">nil</span><span class="op" id="3437492">,</span>&nbsp;<span class="ident" id="3437494">fmt</span><span class="op" id="3437497">.</span><span class="ident" id="3437498">Errorf</span><span class="op" id="3437504">(</span><span class="string" id="3437505">&#34;index&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="3437529">,</span>&nbsp;<span class="ident" id="3437531">x</span><span class="op" id="3437532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437542">v</span>&nbsp;<span class="op" id="3437544">=</span>&nbsp;<span class="ident" id="3437546">v</span><span class="op" id="3437547">.</span><span class="ident" id="3437548">Index</span><span class="op" id="3437553">(</span><span class="builtintype" id="3437554">int</span><span class="op" id="3437557">(</span><span class="ident" id="3437558">x</span><span class="op" id="3437559">)</span><span class="op" id="3437560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437564">case</span>&nbsp;<span class="ident" id="3437569">reflect</span><span class="op" id="3437576">.</span><span class="ident" id="3437577">Map</span><span class="op" id="3437580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437585">if</span>&nbsp;<span class="op" id="3437588">!</span><span class="ident" id="3437589">index</span><span class="op" id="3437594">.</span><span class="ident" id="3437595">IsValid</span><span class="op" id="3437602">(</span><span class="op" id="3437603">)</span>&nbsp;<span class="op" id="3437605">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437611">index</span>&nbsp;<span class="op" id="3437617">=</span>&nbsp;<span class="ident" id="3437619">reflect</span><span class="op" id="3437626">.</span><span class="ident" id="3437627">Zero</span><span class="op" id="3437631">(</span><span class="ident" id="3437632">v</span><span class="op" id="3437633">.</span><span class="ident" id="3437634">Type</span><span class="op" id="3437638">(</span><span class="op" id="3437639">)</span><span class="op" id="3437640">.</span><span class="ident" id="3437641">Key</span><span class="op" id="3437644">(</span><span class="op" id="3437645">)</span><span class="op" id="3437646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437656">if</span>&nbsp;<span class="op" id="3437659">!</span><span class="ident" id="3437660">index</span><span class="op" id="3437665">.</span><span class="ident" id="3437666">Type</span><span class="op" id="3437670">(</span><span class="op" id="3437671">)</span><span class="op" id="3437672">.</span><span class="ident" id="3437673">AssignableTo</span><span class="op" id="3437685">(</span><span class="ident" id="3437686">v</span><span class="op" id="3437687">.</span><span class="ident" id="3437688">Type</span><span class="op" id="3437692">(</span><span class="op" id="3437693">)</span><span class="op" id="3437694">.</span><span class="ident" id="3437695">Key</span><span class="op" id="3437698">(</span><span class="op" id="3437699">)</span><span class="op" id="3437700">)</span>&nbsp;<span class="op" id="3437702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437708">return</span>&nbsp;<span class="ident" id="3437715">nil</span><span class="op" id="3437718">,</span>&nbsp;<span class="ident" id="3437720">fmt</span><span class="op" id="3437723">.</span><span class="ident" id="3437724">Errorf</span><span class="op" id="3437730">(</span><span class="string" id="3437731">&#34;%s&nbsp;is&nbsp;not&nbsp;index&nbsp;type&nbsp;for&nbsp;%s&#34;</span><span class="op" id="3437760">,</span>&nbsp;<span class="ident" id="3437762">index</span><span class="op" id="3437767">.</span><span class="ident" id="3437768">Type</span><span class="op" id="3437772">(</span><span class="op" id="3437773">)</span><span class="op" id="3437774">,</span>&nbsp;<span class="ident" id="3437776">v</span><span class="op" id="3437777">.</span><span class="ident" id="3437778">Type</span><span class="op" id="3437782">(</span><span class="op" id="3437783">)</span><span class="op" id="3437784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437789">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437794">if</span>&nbsp;<span class="ident" id="3437797">x</span>&nbsp;<span class="op" id="3437799">:=</span>&nbsp;<span class="ident" id="3437802">v</span><span class="op" id="3437803">.</span><span class="ident" id="3437804">MapIndex</span><span class="op" id="3437812">(</span><span class="ident" id="3437813">index</span><span class="op" id="3437818">)</span><span class="op" id="3437819">;</span>&nbsp;<span class="ident" id="3437821">x</span><span class="op" id="3437822">.</span><span class="ident" id="3437823">IsValid</span><span class="op" id="3437830">(</span><span class="op" id="3437831">)</span>&nbsp;<span class="op" id="3437833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437839">v</span>&nbsp;<span class="op" id="3437841">=</span>&nbsp;<span class="ident" id="3437843">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437848">}</span>&nbsp;<span class="keyword" id="3437850">else</span>&nbsp;<span class="op" id="3437855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3437861">v</span>&nbsp;<span class="op" id="3437863">=</span>&nbsp;<span class="ident" id="3437865">reflect</span><span class="op" id="3437872">.</span><span class="ident" id="3437873">Zero</span><span class="op" id="3437877">(</span><span class="ident" id="3437878">v</span><span class="op" id="3437879">.</span><span class="ident" id="3437880">Type</span><span class="op" id="3437884">(</span><span class="op" id="3437885">)</span><span class="op" id="3437886">.</span><span class="ident" id="3437887">Elem</span><span class="op" id="3437891">(</span><span class="op" id="3437892">)</span><span class="op" id="3437893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437898">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437902">default</span><span class="op" id="3437909">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437914">return</span>&nbsp;<span class="ident" id="3437921">nil</span><span class="op" id="3437924">,</span>&nbsp;<span class="ident" id="3437926">fmt</span><span class="op" id="3437929">.</span><span class="ident" id="3437930">Errorf</span><span class="op" id="3437936">(</span><span class="string" id="3437937">&#34;can&#39;t&nbsp;index&nbsp;item&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3437966">,</span>&nbsp;<span class="ident" id="3437968">v</span><span class="op" id="3437969">.</span><span class="ident" id="3437970">Type</span><span class="op" id="3437974">(</span><span class="op" id="3437975">)</span><span class="op" id="3437976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3437983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3437986">return</span>&nbsp;<span class="ident" id="3437993">v</span><span class="op" id="3437994">.</span><span class="ident" id="3437995">Interface</span><span class="op" id="3438004">(</span><span class="op" id="3438005">)</span><span class="op" id="3438006">,</span>&nbsp;<span class="ident" id="3438008">nil</span><br>
<span class="lineno">150</span><span class="op" id="3438012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3438015">//&nbsp;Length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3438026">//&nbsp;length&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;item,&nbsp;with&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;defined&nbsp;length.</span><br>
<span class="lineno">155</span><span class="keyword" id="3438111">func</span>&nbsp;<span class="ident" id="3438116">length</span><span class="op" id="3438122">(</span><span class="ident" id="3438123">item</span>&nbsp;<span class="keyword" id="3438128">interface</span><span class="op" id="3438137">{</span><span class="op" id="3438138">}</span><span class="op" id="3438139">)</span>&nbsp;<span class="op" id="3438141">(</span><span class="builtintype" id="3438142">int</span><span class="op" id="3438145">,</span>&nbsp;<span class="builtintype" id="3438147">error</span><span class="op" id="3438152">)</span>&nbsp;<span class="op" id="3438154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3438157">v</span><span class="op" id="3438158">,</span>&nbsp;<span class="ident" id="3438160">isNil</span>&nbsp;<span class="op" id="3438166">:=</span>&nbsp;<span class="ident" id="3438169">indirect</span><span class="op" id="3438177">(</span><span class="ident" id="3438178">reflect</span><span class="op" id="3438185">.</span><span class="ident" id="3438186">ValueOf</span><span class="op" id="3438193">(</span><span class="ident" id="3438194">item</span><span class="op" id="3438198">)</span><span class="op" id="3438199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438202">if</span>&nbsp;<span class="ident" id="3438205">isNil</span>&nbsp;<span class="op" id="3438211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438215">return</span>&nbsp;<span class="num" id="3438222">0</span><span class="op" id="3438223">,</span>&nbsp;<span class="ident" id="3438225">fmt</span><span class="op" id="3438228">.</span><span class="ident" id="3438229">Errorf</span><span class="op" id="3438235">(</span><span class="string" id="3438236">&#34;len&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="3438256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3438259">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438262">switch</span>&nbsp;<span class="ident" id="3438269">v</span><span class="op" id="3438270">.</span><span class="ident" id="3438271">Kind</span><span class="op" id="3438275">(</span><span class="op" id="3438276">)</span>&nbsp;<span class="op" id="3438278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438281">case</span>&nbsp;<span class="ident" id="3438286">reflect</span><span class="op" id="3438293">.</span><span class="ident" id="3438294">Array</span><span class="op" id="3438299">,</span>&nbsp;<span class="ident" id="3438301">reflect</span><span class="op" id="3438308">.</span><span class="ident" id="3438309">Chan</span><span class="op" id="3438313">,</span>&nbsp;<span class="ident" id="3438315">reflect</span><span class="op" id="3438322">.</span><span class="ident" id="3438323">Map</span><span class="op" id="3438326">,</span>&nbsp;<span class="ident" id="3438328">reflect</span><span class="op" id="3438335">.</span><span class="ident" id="3438336">Slice</span><span class="op" id="3438341">,</span>&nbsp;<span class="ident" id="3438343">reflect</span><span class="op" id="3438350">.</span><span class="ident" id="3438351">String</span><span class="op" id="3438357">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438361">return</span>&nbsp;<span class="ident" id="3438368">v</span><span class="op" id="3438369">.</span><span class="ident" id="3438370">Len</span><span class="op" id="3438373">(</span><span class="op" id="3438374">)</span><span class="op" id="3438375">,</span>&nbsp;<span class="ident" id="3438377">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3438382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438385">return</span>&nbsp;<span class="num" id="3438392">0</span><span class="op" id="3438393">,</span>&nbsp;<span class="ident" id="3438395">fmt</span><span class="op" id="3438398">.</span><span class="ident" id="3438399">Errorf</span><span class="op" id="3438405">(</span><span class="string" id="3438406">&#34;len&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3438422">,</span>&nbsp;<span class="ident" id="3438424">v</span><span class="op" id="3438425">.</span><span class="ident" id="3438426">Type</span><span class="op" id="3438430">(</span><span class="op" id="3438431">)</span><span class="op" id="3438432">)</span><br>
<span class="lineno">165</span><span class="op" id="3438434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3438437">//&nbsp;Function&nbsp;invocation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3438461">//&nbsp;call&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;argument&nbsp;as&nbsp;a&nbsp;function.</span><br>
<span class="lineno">170</span><span class="comment" id="3438536">//&nbsp;The&nbsp;function&nbsp;must&nbsp;return&nbsp;1&nbsp;result,&nbsp;or&nbsp;2&nbsp;results,&nbsp;the&nbsp;second&nbsp;of&nbsp;which&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3438621">func</span>&nbsp;<span class="ident" id="3438626">call</span><span class="op" id="3438630">(</span><span class="ident" id="3438631">fn</span>&nbsp;<span class="keyword" id="3438634">interface</span><span class="op" id="3438643">{</span><span class="op" id="3438644">}</span><span class="op" id="3438645">,</span>&nbsp;<span class="ident" id="3438647">args</span>&nbsp;<span class="op" id="3438652">...</span><span class="keyword" id="3438655">interface</span><span class="op" id="3438664">{</span><span class="op" id="3438665">}</span><span class="op" id="3438666">)</span>&nbsp;<span class="op" id="3438668">(</span><span class="keyword" id="3438669">interface</span><span class="op" id="3438678">{</span><span class="op" id="3438679">}</span><span class="op" id="3438680">,</span>&nbsp;<span class="builtintype" id="3438682">error</span><span class="op" id="3438687">)</span>&nbsp;<span class="op" id="3438689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3438692">v</span>&nbsp;<span class="op" id="3438694">:=</span>&nbsp;<span class="ident" id="3438697">reflect</span><span class="op" id="3438704">.</span><span class="ident" id="3438705">ValueOf</span><span class="op" id="3438712">(</span><span class="ident" id="3438713">fn</span><span class="op" id="3438715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3438718">typ</span>&nbsp;<span class="op" id="3438722">:=</span>&nbsp;<span class="ident" id="3438725">v</span><span class="op" id="3438726">.</span><span class="ident" id="3438727">Type</span><span class="op" id="3438731">(</span><span class="op" id="3438732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438735">if</span>&nbsp;<span class="ident" id="3438738">typ</span><span class="op" id="3438741">.</span><span class="ident" id="3438742">Kind</span><span class="op" id="3438746">(</span><span class="op" id="3438747">)</span>&nbsp;<span class="op" id="3438749">!=</span>&nbsp;<span class="ident" id="3438752">reflect</span><span class="op" id="3438759">.</span><span class="ident" id="3438760">Func</span>&nbsp;<span class="op" id="3438765">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438769">return</span>&nbsp;<span class="ident" id="3438776">nil</span><span class="op" id="3438779">,</span>&nbsp;<span class="ident" id="3438781">fmt</span><span class="op" id="3438784">.</span><span class="ident" id="3438785">Errorf</span><span class="op" id="3438791">(</span><span class="string" id="3438792">&#34;non-function&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3438817">,</span>&nbsp;<span class="ident" id="3438819">typ</span><span class="op" id="3438822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3438825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438828">if</span>&nbsp;<span class="op" id="3438831">!</span><span class="ident" id="3438832">goodFunc</span><span class="op" id="3438840">(</span><span class="ident" id="3438841">typ</span><span class="op" id="3438844">)</span>&nbsp;<span class="op" id="3438846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438850">return</span>&nbsp;<span class="ident" id="3438857">nil</span><span class="op" id="3438860">,</span>&nbsp;<span class="ident" id="3438862">fmt</span><span class="op" id="3438865">.</span><span class="ident" id="3438866">Errorf</span><span class="op" id="3438872">(</span><span class="string" id="3438873">&#34;function&nbsp;called&nbsp;with&nbsp;%d&nbsp;args;&nbsp;should&nbsp;be&nbsp;1&nbsp;or&nbsp;2&#34;</span><span class="op" id="3438921">,</span>&nbsp;<span class="ident" id="3438923">typ</span><span class="op" id="3438926">.</span><span class="ident" id="3438927">NumOut</span><span class="op" id="3438933">(</span><span class="op" id="3438934">)</span><span class="op" id="3438935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3438938">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3438941">numIn</span>&nbsp;<span class="op" id="3438947">:=</span>&nbsp;<span class="ident" id="3438950">typ</span><span class="op" id="3438953">.</span><span class="ident" id="3438954">NumIn</span><span class="op" id="3438959">(</span><span class="op" id="3438960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438963">var</span>&nbsp;<span class="ident" id="3438967">dddType</span>&nbsp;<span class="ident" id="3438975">reflect</span><span class="op" id="3438982">.</span><span class="ident" id="3438983">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3438989">if</span>&nbsp;<span class="ident" id="3438992">typ</span><span class="op" id="3438995">.</span><span class="ident" id="3438996">IsVariadic</span><span class="op" id="3439006">(</span><span class="op" id="3439007">)</span>&nbsp;<span class="op" id="3439009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439013">if</span>&nbsp;<span class="builtinfunc" id="3439016">len</span><span class="op" id="3439019">(</span><span class="ident" id="3439020">args</span><span class="op" id="3439024">)</span>&nbsp;<span class="op" id="3439026">&lt;</span>&nbsp;<span class="ident" id="3439028">numIn</span><span class="op" id="3439033">-</span><span class="num" id="3439034">1</span>&nbsp;<span class="op" id="3439036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439041">return</span>&nbsp;<span class="ident" id="3439048">nil</span><span class="op" id="3439051">,</span>&nbsp;<span class="ident" id="3439053">fmt</span><span class="op" id="3439056">.</span><span class="ident" id="3439057">Errorf</span><span class="op" id="3439063">(</span><span class="string" id="3439064">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&#34;</span><span class="op" id="3439111">,</span>&nbsp;<span class="builtinfunc" id="3439113">len</span><span class="op" id="3439116">(</span><span class="ident" id="3439117">args</span><span class="op" id="3439121">)</span><span class="op" id="3439122">,</span>&nbsp;<span class="ident" id="3439124">numIn</span><span class="op" id="3439129">-</span><span class="num" id="3439130">1</span><span class="op" id="3439131">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439139">dddType</span>&nbsp;<span class="op" id="3439147">=</span>&nbsp;<span class="ident" id="3439149">typ</span><span class="op" id="3439152">.</span><span class="ident" id="3439153">In</span><span class="op" id="3439155">(</span><span class="ident" id="3439156">numIn</span>&nbsp;<span class="op" id="3439162">-</span>&nbsp;<span class="num" id="3439164">1</span><span class="op" id="3439165">)</span><span class="op" id="3439166">.</span><span class="ident" id="3439167">Elem</span><span class="op" id="3439171">(</span><span class="op" id="3439172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439175">}</span>&nbsp;<span class="keyword" id="3439177">else</span>&nbsp;<span class="op" id="3439182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439186">if</span>&nbsp;<span class="builtinfunc" id="3439189">len</span><span class="op" id="3439192">(</span><span class="ident" id="3439193">args</span><span class="op" id="3439197">)</span>&nbsp;<span class="op" id="3439199">!=</span>&nbsp;<span class="ident" id="3439202">numIn</span>&nbsp;<span class="op" id="3439208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439213">return</span>&nbsp;<span class="ident" id="3439220">nil</span><span class="op" id="3439223">,</span>&nbsp;<span class="ident" id="3439225">fmt</span><span class="op" id="3439228">.</span><span class="ident" id="3439229">Errorf</span><span class="op" id="3439235">(</span><span class="string" id="3439236">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="3439274">,</span>&nbsp;<span class="builtinfunc" id="3439276">len</span><span class="op" id="3439279">(</span><span class="ident" id="3439280">args</span><span class="op" id="3439284">)</span><span class="op" id="3439285">,</span>&nbsp;<span class="ident" id="3439287">numIn</span><span class="op" id="3439292">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439302">argv</span>&nbsp;<span class="op" id="3439307">:=</span>&nbsp;<span class="builtinfunc" id="3439310">make</span><span class="op" id="3439314">(</span><span class="op" id="3439315">[</span><span class="op" id="3439316">]</span><span class="ident" id="3439317">reflect</span><span class="op" id="3439324">.</span><span class="ident" id="3439325">Value</span><span class="op" id="3439330">,</span>&nbsp;<span class="builtinfunc" id="3439332">len</span><span class="op" id="3439335">(</span><span class="ident" id="3439336">args</span><span class="op" id="3439340">)</span><span class="op" id="3439341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439344">for</span>&nbsp;<span class="ident" id="3439348">i</span><span class="op" id="3439349">,</span>&nbsp;<span class="ident" id="3439351">arg</span>&nbsp;<span class="op" id="3439355">:=</span>&nbsp;<span class="keyword" id="3439358">range</span>&nbsp;<span class="ident" id="3439364">args</span>&nbsp;<span class="op" id="3439369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439373">value</span>&nbsp;<span class="op" id="3439379">:=</span>&nbsp;<span class="ident" id="3439382">reflect</span><span class="op" id="3439389">.</span><span class="ident" id="3439390">ValueOf</span><span class="op" id="3439397">(</span><span class="ident" id="3439398">arg</span><span class="op" id="3439401">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3439405">//&nbsp;Compute&nbsp;the&nbsp;expected&nbsp;type.&nbsp;Clumsy&nbsp;because&nbsp;of&nbsp;variadics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439466">var</span>&nbsp;<span class="ident" id="3439470">argType</span>&nbsp;<span class="ident" id="3439478">reflect</span><span class="op" id="3439485">.</span><span class="ident" id="3439486">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439493">if</span>&nbsp;<span class="op" id="3439496">!</span><span class="ident" id="3439497">typ</span><span class="op" id="3439500">.</span><span class="ident" id="3439501">IsVariadic</span><span class="op" id="3439511">(</span><span class="op" id="3439512">)</span>&nbsp;<span class="op" id="3439514">||</span>&nbsp;<span class="ident" id="3439517">i</span>&nbsp;<span class="op" id="3439519">&lt;</span>&nbsp;<span class="ident" id="3439521">numIn</span><span class="op" id="3439526">-</span><span class="num" id="3439527">1</span>&nbsp;<span class="op" id="3439529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439534">argType</span>&nbsp;<span class="op" id="3439542">=</span>&nbsp;<span class="ident" id="3439544">typ</span><span class="op" id="3439547">.</span><span class="ident" id="3439548">In</span><span class="op" id="3439550">(</span><span class="ident" id="3439551">i</span><span class="op" id="3439552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439556">}</span>&nbsp;<span class="keyword" id="3439558">else</span>&nbsp;<span class="op" id="3439563">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439568">argType</span>&nbsp;<span class="op" id="3439576">=</span>&nbsp;<span class="ident" id="3439578">dddType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439592">if</span>&nbsp;<span class="op" id="3439595">!</span><span class="ident" id="3439596">value</span><span class="op" id="3439601">.</span><span class="ident" id="3439602">IsValid</span><span class="op" id="3439609">(</span><span class="op" id="3439610">)</span>&nbsp;<span class="op" id="3439612">&amp;&amp;</span>&nbsp;<span class="ident" id="3439615">canBeNil</span><span class="op" id="3439623">(</span><span class="ident" id="3439624">argType</span><span class="op" id="3439631">)</span>&nbsp;<span class="op" id="3439633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439638">value</span>&nbsp;<span class="op" id="3439644">=</span>&nbsp;<span class="ident" id="3439646">reflect</span><span class="op" id="3439653">.</span><span class="ident" id="3439654">Zero</span><span class="op" id="3439658">(</span><span class="ident" id="3439659">argType</span><span class="op" id="3439666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439670">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439674">if</span>&nbsp;<span class="op" id="3439677">!</span><span class="ident" id="3439678">value</span><span class="op" id="3439683">.</span><span class="ident" id="3439684">Type</span><span class="op" id="3439688">(</span><span class="op" id="3439689">)</span><span class="op" id="3439690">.</span><span class="ident" id="3439691">AssignableTo</span><span class="op" id="3439703">(</span><span class="ident" id="3439704">argType</span><span class="op" id="3439711">)</span>&nbsp;<span class="op" id="3439713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439718">return</span>&nbsp;<span class="ident" id="3439725">nil</span><span class="op" id="3439728">,</span>&nbsp;<span class="ident" id="3439730">fmt</span><span class="op" id="3439733">.</span><span class="ident" id="3439734">Errorf</span><span class="op" id="3439740">(</span><span class="string" id="3439741">&#34;arg&nbsp;%d&nbsp;has&nbsp;type&nbsp;%s;&nbsp;should&nbsp;be&nbsp;%s&#34;</span><span class="op" id="3439775">,</span>&nbsp;<span class="ident" id="3439777">i</span><span class="op" id="3439778">,</span>&nbsp;<span class="ident" id="3439780">value</span><span class="op" id="3439785">.</span><span class="ident" id="3439786">Type</span><span class="op" id="3439790">(</span><span class="op" id="3439791">)</span><span class="op" id="3439792">,</span>&nbsp;<span class="ident" id="3439794">argType</span><span class="op" id="3439801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439809">argv</span><span class="op" id="3439813">[</span><span class="ident" id="3439814">i</span><span class="op" id="3439815">]</span>&nbsp;<span class="op" id="3439817">=</span>&nbsp;<span class="ident" id="3439819">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439826">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3439829">result</span>&nbsp;<span class="op" id="3439836">:=</span>&nbsp;<span class="ident" id="3439839">v</span><span class="op" id="3439840">.</span><span class="ident" id="3439841">Call</span><span class="op" id="3439845">(</span><span class="ident" id="3439846">argv</span><span class="op" id="3439850">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439853">if</span>&nbsp;<span class="builtinfunc" id="3439856">len</span><span class="op" id="3439859">(</span><span class="ident" id="3439860">result</span><span class="op" id="3439866">)</span>&nbsp;<span class="op" id="3439868">==</span>&nbsp;<span class="num" id="3439871">2</span>&nbsp;<span class="op" id="3439873">&amp;&amp;</span>&nbsp;<span class="op" id="3439876">!</span><span class="ident" id="3439877">result</span><span class="op" id="3439883">[</span><span class="num" id="3439884">1</span><span class="op" id="3439885">]</span><span class="op" id="3439886">.</span><span class="ident" id="3439887">IsNil</span><span class="op" id="3439892">(</span><span class="op" id="3439893">)</span>&nbsp;<span class="op" id="3439895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439899">return</span>&nbsp;<span class="ident" id="3439906">result</span><span class="op" id="3439912">[</span><span class="num" id="3439913">0</span><span class="op" id="3439914">]</span><span class="op" id="3439915">.</span><span class="ident" id="3439916">Interface</span><span class="op" id="3439925">(</span><span class="op" id="3439926">)</span><span class="op" id="3439927">,</span>&nbsp;<span class="ident" id="3439929">result</span><span class="op" id="3439935">[</span><span class="num" id="3439936">1</span><span class="op" id="3439937">]</span><span class="op" id="3439938">.</span><span class="ident" id="3439939">Interface</span><span class="op" id="3439948">(</span><span class="op" id="3439949">)</span><span class="op" id="3439950">.</span><span class="op" id="3439951">(</span><span class="builtintype" id="3439952">error</span><span class="op" id="3439957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3439960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3439963">return</span>&nbsp;<span class="ident" id="3439970">result</span><span class="op" id="3439976">[</span><span class="num" id="3439977">0</span><span class="op" id="3439978">]</span><span class="op" id="3439979">.</span><span class="ident" id="3439980">Interface</span><span class="op" id="3439989">(</span><span class="op" id="3439990">)</span><span class="op" id="3439991">,</span>&nbsp;<span class="ident" id="3439993">nil</span><br>
<span class="lineno">215</span><span class="op" id="3439997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440000">//&nbsp;Boolean&nbsp;logic.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3440019">func</span>&nbsp;<span class="ident" id="3440024">truth</span><span class="op" id="3440029">(</span><span class="ident" id="3440030">a</span>&nbsp;<span class="keyword" id="3440032">interface</span><span class="op" id="3440041">{</span><span class="op" id="3440042">}</span><span class="op" id="3440043">)</span>&nbsp;<span class="builtintype" id="3440045">bool</span>&nbsp;<span class="op" id="3440050">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3440053">t</span><span class="op" id="3440054">,</span>&nbsp;<span class="ident" id="3440056">_</span>&nbsp;<span class="op" id="3440058">:=</span>&nbsp;<span class="ident" id="3440061">isTrue</span><span class="op" id="3440067">(</span><span class="ident" id="3440068">reflect</span><span class="op" id="3440075">.</span><span class="ident" id="3440076">ValueOf</span><span class="op" id="3440083">(</span><span class="ident" id="3440084">a</span><span class="op" id="3440085">)</span><span class="op" id="3440086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440089">return</span>&nbsp;<span class="ident" id="3440096">t</span><br>
<span class="lineno"></span><span class="op" id="3440098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440101">//&nbsp;and&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;AND&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">225</span><span class="comment" id="3440161">//&nbsp;the&nbsp;first&nbsp;false&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3440226">func</span>&nbsp;<span class="ident" id="3440231">and</span><span class="op" id="3440234">(</span><span class="ident" id="3440235">arg0</span>&nbsp;<span class="keyword" id="3440240">interface</span><span class="op" id="3440249">{</span><span class="op" id="3440250">}</span><span class="op" id="3440251">,</span>&nbsp;<span class="ident" id="3440253">args</span>&nbsp;<span class="op" id="3440258">...</span><span class="keyword" id="3440261">interface</span><span class="op" id="3440270">{</span><span class="op" id="3440271">}</span><span class="op" id="3440272">)</span>&nbsp;<span class="keyword" id="3440274">interface</span><span class="op" id="3440283">{</span><span class="op" id="3440284">}</span>&nbsp;<span class="op" id="3440286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440289">if</span>&nbsp;<span class="op" id="3440292">!</span><span class="ident" id="3440293">truth</span><span class="op" id="3440298">(</span><span class="ident" id="3440299">arg0</span><span class="op" id="3440303">)</span>&nbsp;<span class="op" id="3440305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440309">return</span>&nbsp;<span class="ident" id="3440316">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440322">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440325">for</span>&nbsp;<span class="ident" id="3440329">i</span>&nbsp;<span class="op" id="3440331">:=</span>&nbsp;<span class="keyword" id="3440334">range</span>&nbsp;<span class="ident" id="3440340">args</span>&nbsp;<span class="op" id="3440345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3440349">arg0</span>&nbsp;<span class="op" id="3440354">=</span>&nbsp;<span class="ident" id="3440356">args</span><span class="op" id="3440360">[</span><span class="ident" id="3440361">i</span><span class="op" id="3440362">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440366">if</span>&nbsp;<span class="op" id="3440369">!</span><span class="ident" id="3440370">truth</span><span class="op" id="3440375">(</span><span class="ident" id="3440376">arg0</span><span class="op" id="3440380">)</span>&nbsp;<span class="op" id="3440382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440387">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440395">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440401">return</span>&nbsp;<span class="ident" id="3440408">arg0</span><br>
<span class="lineno"></span><span class="op" id="3440413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440416">//&nbsp;or&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;OR&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">240</span><span class="comment" id="3440474">//&nbsp;the&nbsp;first&nbsp;true&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="3440538">func</span>&nbsp;<span class="ident" id="3440543">or</span><span class="op" id="3440545">(</span><span class="ident" id="3440546">arg0</span>&nbsp;<span class="keyword" id="3440551">interface</span><span class="op" id="3440560">{</span><span class="op" id="3440561">}</span><span class="op" id="3440562">,</span>&nbsp;<span class="ident" id="3440564">args</span>&nbsp;<span class="op" id="3440569">...</span><span class="keyword" id="3440572">interface</span><span class="op" id="3440581">{</span><span class="op" id="3440582">}</span><span class="op" id="3440583">)</span>&nbsp;<span class="keyword" id="3440585">interface</span><span class="op" id="3440594">{</span><span class="op" id="3440595">}</span>&nbsp;<span class="op" id="3440597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440600">if</span>&nbsp;<span class="ident" id="3440603">truth</span><span class="op" id="3440608">(</span><span class="ident" id="3440609">arg0</span><span class="op" id="3440613">)</span>&nbsp;<span class="op" id="3440615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440619">return</span>&nbsp;<span class="ident" id="3440626">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440632">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440635">for</span>&nbsp;<span class="ident" id="3440639">i</span>&nbsp;<span class="op" id="3440641">:=</span>&nbsp;<span class="keyword" id="3440644">range</span>&nbsp;<span class="ident" id="3440650">args</span>&nbsp;<span class="op" id="3440655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3440659">arg0</span>&nbsp;<span class="op" id="3440664">=</span>&nbsp;<span class="ident" id="3440666">args</span><span class="op" id="3440670">[</span><span class="ident" id="3440671">i</span><span class="op" id="3440672">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440676">if</span>&nbsp;<span class="ident" id="3440679">truth</span><span class="op" id="3440684">(</span><span class="ident" id="3440685">arg0</span><span class="op" id="3440689">)</span>&nbsp;<span class="op" id="3440691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440696">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440704">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3440707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440710">return</span>&nbsp;<span class="ident" id="3440717">arg0</span><br>
<span class="lineno"></span><span class="op" id="3440722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440725">//&nbsp;not&nbsp;returns&nbsp;the&nbsp;Boolean&nbsp;negation&nbsp;of&nbsp;its&nbsp;argument.</span><br>
<span class="lineno">255</span><span class="keyword" id="3440778">func</span>&nbsp;<span class="ident" id="3440783">not</span><span class="op" id="3440786">(</span><span class="ident" id="3440787">arg</span>&nbsp;<span class="keyword" id="3440791">interface</span><span class="op" id="3440800">{</span><span class="op" id="3440801">}</span><span class="op" id="3440802">)</span>&nbsp;<span class="op" id="3440804">(</span><span class="ident" id="3440805">truth</span>&nbsp;<span class="builtintype" id="3440811">bool</span><span class="op" id="3440815">)</span>&nbsp;<span class="op" id="3440817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3440820">truth</span><span class="op" id="3440825">,</span>&nbsp;<span class="ident" id="3440827">_</span>&nbsp;<span class="op" id="3440829">=</span>&nbsp;<span class="ident" id="3440831">isTrue</span><span class="op" id="3440837">(</span><span class="ident" id="3440838">reflect</span><span class="op" id="3440845">.</span><span class="ident" id="3440846">ValueOf</span><span class="op" id="3440853">(</span><span class="ident" id="3440854">arg</span><span class="op" id="3440857">)</span><span class="op" id="3440858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3440861">return</span>&nbsp;<span class="op" id="3440868">!</span><span class="ident" id="3440869">truth</span><br>
<span class="lineno"></span><span class="op" id="3440875">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3440878">//&nbsp;Comparison.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3440894">//&nbsp;TODO:&nbsp;Perhaps&nbsp;allow&nbsp;comparison&nbsp;between&nbsp;signed&nbsp;and&nbsp;unsigned&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3440967">var</span>&nbsp;<span class="op" id="3440971">(</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3440974">errBadComparisonType</span>&nbsp;<span class="op" id="3440995">=</span>&nbsp;<span class="ident" id="3440997">errors</span><span class="op" id="3441003">.</span><span class="ident" id="3441004">New</span><span class="op" id="3441007">(</span><span class="string" id="3441008">&#34;invalid&nbsp;type&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3441037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441040">errBadComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3441061">=</span>&nbsp;<span class="ident" id="3441063">errors</span><span class="op" id="3441069">.</span><span class="ident" id="3441070">New</span><span class="op" id="3441073">(</span><span class="string" id="3441074">&#34;incompatible&nbsp;types&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3441109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441112">errNoComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3441133">=</span>&nbsp;<span class="ident" id="3441135">errors</span><span class="op" id="3441141">.</span><span class="ident" id="3441142">New</span><span class="op" id="3441145">(</span><span class="string" id="3441146">&#34;missing&nbsp;argument&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="3441179">)</span><br>
<span class="lineno"></span><span class="op" id="3441181">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="3441184">type</span>&nbsp;<span class="ident" id="3441189">kind</span>&nbsp;<span class="builtintype" id="3441194">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3441199">const</span>&nbsp;<span class="op" id="3441205">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441208">invalidKind</span>&nbsp;<span class="ident" id="3441220">kind</span>&nbsp;<span class="op" id="3441225">=</span>&nbsp;<span class="ident" id="3441227">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441233">boolKind</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441243">complexKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441256">intKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441265">floatKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441276">integerKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441289">stringKind</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441301">uintKind</span><br>
<span class="lineno"></span><span class="op" id="3441310">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3441313">func</span>&nbsp;<span class="ident" id="3441318">basicKind</span><span class="op" id="3441327">(</span><span class="ident" id="3441328">v</span>&nbsp;<span class="ident" id="3441330">reflect</span><span class="op" id="3441337">.</span><span class="ident" id="3441338">Value</span><span class="op" id="3441343">)</span>&nbsp;<span class="op" id="3441345">(</span><span class="ident" id="3441346">kind</span><span class="op" id="3441350">,</span>&nbsp;<span class="builtintype" id="3441352">error</span><span class="op" id="3441357">)</span>&nbsp;<span class="op" id="3441359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441362">switch</span>&nbsp;<span class="ident" id="3441369">v</span><span class="op" id="3441370">.</span><span class="ident" id="3441371">Kind</span><span class="op" id="3441375">(</span><span class="op" id="3441376">)</span>&nbsp;<span class="op" id="3441378">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441381">case</span>&nbsp;<span class="ident" id="3441386">reflect</span><span class="op" id="3441393">.</span><span class="ident" id="3441394">Bool</span><span class="op" id="3441398">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441402">return</span>&nbsp;<span class="ident" id="3441409">boolKind</span><span class="op" id="3441417">,</span>&nbsp;<span class="ident" id="3441419">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441424">case</span>&nbsp;<span class="ident" id="3441429">reflect</span><span class="op" id="3441436">.</span><span class="ident" id="3441437">Int</span><span class="op" id="3441440">,</span>&nbsp;<span class="ident" id="3441442">reflect</span><span class="op" id="3441449">.</span><span class="ident" id="3441450">Int8</span><span class="op" id="3441454">,</span>&nbsp;<span class="ident" id="3441456">reflect</span><span class="op" id="3441463">.</span><span class="ident" id="3441464">Int16</span><span class="op" id="3441469">,</span>&nbsp;<span class="ident" id="3441471">reflect</span><span class="op" id="3441478">.</span><span class="ident" id="3441479">Int32</span><span class="op" id="3441484">,</span>&nbsp;<span class="ident" id="3441486">reflect</span><span class="op" id="3441493">.</span><span class="ident" id="3441494">Int64</span><span class="op" id="3441499">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441503">return</span>&nbsp;<span class="ident" id="3441510">intKind</span><span class="op" id="3441517">,</span>&nbsp;<span class="ident" id="3441519">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441524">case</span>&nbsp;<span class="ident" id="3441529">reflect</span><span class="op" id="3441536">.</span><span class="ident" id="3441537">Uint</span><span class="op" id="3441541">,</span>&nbsp;<span class="ident" id="3441543">reflect</span><span class="op" id="3441550">.</span><span class="ident" id="3441551">Uint8</span><span class="op" id="3441556">,</span>&nbsp;<span class="ident" id="3441558">reflect</span><span class="op" id="3441565">.</span><span class="ident" id="3441566">Uint16</span><span class="op" id="3441572">,</span>&nbsp;<span class="ident" id="3441574">reflect</span><span class="op" id="3441581">.</span><span class="ident" id="3441582">Uint32</span><span class="op" id="3441588">,</span>&nbsp;<span class="ident" id="3441590">reflect</span><span class="op" id="3441597">.</span><span class="ident" id="3441598">Uint64</span><span class="op" id="3441604">,</span>&nbsp;<span class="ident" id="3441606">reflect</span><span class="op" id="3441613">.</span><span class="ident" id="3441614">Uintptr</span><span class="op" id="3441621">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441625">return</span>&nbsp;<span class="ident" id="3441632">uintKind</span><span class="op" id="3441640">,</span>&nbsp;<span class="ident" id="3441642">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441647">case</span>&nbsp;<span class="ident" id="3441652">reflect</span><span class="op" id="3441659">.</span><span class="ident" id="3441660">Float32</span><span class="op" id="3441667">,</span>&nbsp;<span class="ident" id="3441669">reflect</span><span class="op" id="3441676">.</span><span class="ident" id="3441677">Float64</span><span class="op" id="3441684">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441688">return</span>&nbsp;<span class="ident" id="3441695">floatKind</span><span class="op" id="3441704">,</span>&nbsp;<span class="ident" id="3441706">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441711">case</span>&nbsp;<span class="ident" id="3441716">reflect</span><span class="op" id="3441723">.</span><span class="ident" id="3441724">Complex64</span><span class="op" id="3441733">,</span>&nbsp;<span class="ident" id="3441735">reflect</span><span class="op" id="3441742">.</span><span class="ident" id="3441743">Complex128</span><span class="op" id="3441753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441757">return</span>&nbsp;<span class="ident" id="3441764">complexKind</span><span class="op" id="3441775">,</span>&nbsp;<span class="ident" id="3441777">nil</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441782">case</span>&nbsp;<span class="ident" id="3441787">reflect</span><span class="op" id="3441794">.</span><span class="ident" id="3441795">String</span><span class="op" id="3441801">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441805">return</span>&nbsp;<span class="ident" id="3441812">stringKind</span><span class="op" id="3441822">,</span>&nbsp;<span class="ident" id="3441824">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3441829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3441832">return</span>&nbsp;<span class="ident" id="3441839">invalidKind</span><span class="op" id="3441850">,</span>&nbsp;<span class="ident" id="3441852">errBadComparisonType</span><br>
<span class="lineno"></span><span class="op" id="3441873">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="3441876">//&nbsp;eq&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;==&nbsp;b&nbsp;||&nbsp;a&nbsp;==&nbsp;c&nbsp;||&nbsp;...</span><br>
<span class="lineno"></span><span class="keyword" id="3441931">func</span>&nbsp;<span class="ident" id="3441936">eq</span><span class="op" id="3441938">(</span><span class="ident" id="3441939">arg1</span>&nbsp;<span class="keyword" id="3441944">interface</span><span class="op" id="3441953">{</span><span class="op" id="3441954">}</span><span class="op" id="3441955">,</span>&nbsp;<span class="ident" id="3441957">arg2</span>&nbsp;<span class="op" id="3441962">...</span><span class="keyword" id="3441965">interface</span><span class="op" id="3441974">{</span><span class="op" id="3441975">}</span><span class="op" id="3441976">)</span>&nbsp;<span class="op" id="3441978">(</span><span class="builtintype" id="3441979">bool</span><span class="op" id="3441983">,</span>&nbsp;<span class="builtintype" id="3441985">error</span><span class="op" id="3441990">)</span>&nbsp;<span class="op" id="3441992">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3441995">v1</span>&nbsp;<span class="op" id="3441998">:=</span>&nbsp;<span class="ident" id="3442001">reflect</span><span class="op" id="3442008">.</span><span class="ident" id="3442009">ValueOf</span><span class="op" id="3442016">(</span><span class="ident" id="3442017">arg1</span><span class="op" id="3442021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442024">k1</span><span class="op" id="3442026">,</span>&nbsp;<span class="ident" id="3442028">err</span>&nbsp;<span class="op" id="3442032">:=</span>&nbsp;<span class="ident" id="3442035">basicKind</span><span class="op" id="3442044">(</span><span class="ident" id="3442045">v1</span><span class="op" id="3442047">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442050">if</span>&nbsp;<span class="ident" id="3442053">err</span>&nbsp;<span class="op" id="3442057">!=</span>&nbsp;<span class="ident" id="3442060">nil</span>&nbsp;<span class="op" id="3442064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442068">return</span>&nbsp;<span class="builtintype" id="3442075">false</span><span class="op" id="3442080">,</span>&nbsp;<span class="ident" id="3442082">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442090">if</span>&nbsp;<span class="builtinfunc" id="3442093">len</span><span class="op" id="3442096">(</span><span class="ident" id="3442097">arg2</span><span class="op" id="3442101">)</span>&nbsp;<span class="op" id="3442103">==</span>&nbsp;<span class="num" id="3442106">0</span>&nbsp;<span class="op" id="3442108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442112">return</span>&nbsp;<span class="builtintype" id="3442119">false</span><span class="op" id="3442124">,</span>&nbsp;<span class="ident" id="3442126">errNoComparison</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442146">for</span>&nbsp;<span class="ident" id="3442150">_</span><span class="op" id="3442151">,</span>&nbsp;<span class="ident" id="3442153">arg</span>&nbsp;<span class="op" id="3442157">:=</span>&nbsp;<span class="keyword" id="3442160">range</span>&nbsp;<span class="ident" id="3442166">arg2</span>&nbsp;<span class="op" id="3442171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442175">v2</span>&nbsp;<span class="op" id="3442178">:=</span>&nbsp;<span class="ident" id="3442181">reflect</span><span class="op" id="3442188">.</span><span class="ident" id="3442189">ValueOf</span><span class="op" id="3442196">(</span><span class="ident" id="3442197">arg</span><span class="op" id="3442200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442204">k2</span><span class="op" id="3442206">,</span>&nbsp;<span class="ident" id="3442208">err</span>&nbsp;<span class="op" id="3442212">:=</span>&nbsp;<span class="ident" id="3442215">basicKind</span><span class="op" id="3442224">(</span><span class="ident" id="3442225">v2</span><span class="op" id="3442227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442231">if</span>&nbsp;<span class="ident" id="3442234">err</span>&nbsp;<span class="op" id="3442238">!=</span>&nbsp;<span class="ident" id="3442241">nil</span>&nbsp;<span class="op" id="3442245">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442250">return</span>&nbsp;<span class="builtintype" id="3442257">false</span><span class="op" id="3442262">,</span>&nbsp;<span class="ident" id="3442264">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442274">truth</span>&nbsp;<span class="op" id="3442280">:=</span>&nbsp;<span class="builtintype" id="3442283">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442291">if</span>&nbsp;<span class="ident" id="3442294">k1</span>&nbsp;<span class="op" id="3442297">!=</span>&nbsp;<span class="ident" id="3442300">k2</span>&nbsp;<span class="op" id="3442303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3442308">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442382">switch</span>&nbsp;<span class="op" id="3442389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442394">case</span>&nbsp;<span class="ident" id="3442399">k1</span>&nbsp;<span class="op" id="3442402">==</span>&nbsp;<span class="ident" id="3442405">intKind</span>&nbsp;<span class="op" id="3442413">&amp;&amp;</span>&nbsp;<span class="ident" id="3442416">k2</span>&nbsp;<span class="op" id="3442419">==</span>&nbsp;<span class="ident" id="3442422">uintKind</span><span class="op" id="3442430">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442436">truth</span>&nbsp;<span class="op" id="3442442">=</span>&nbsp;<span class="ident" id="3442444">v1</span><span class="op" id="3442446">.</span><span class="ident" id="3442447">Int</span><span class="op" id="3442450">(</span><span class="op" id="3442451">)</span>&nbsp;<span class="op" id="3442453">&gt;=</span>&nbsp;<span class="num" id="3442456">0</span>&nbsp;<span class="op" id="3442458">&amp;&amp;</span>&nbsp;<span class="ident" id="3442461">uint64</span><span class="op" id="3442467">(</span><span class="ident" id="3442468">v1</span><span class="op" id="3442470">.</span><span class="ident" id="3442471">Int</span><span class="op" id="3442474">(</span><span class="op" id="3442475">)</span><span class="op" id="3442476">)</span>&nbsp;<span class="op" id="3442478">==</span>&nbsp;<span class="ident" id="3442481">v2</span><span class="op" id="3442483">.</span><span class="ident" id="3442484">Uint</span><span class="op" id="3442488">(</span><span class="op" id="3442489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442494">case</span>&nbsp;<span class="ident" id="3442499">k1</span>&nbsp;<span class="op" id="3442502">==</span>&nbsp;<span class="ident" id="3442505">uintKind</span>&nbsp;<span class="op" id="3442514">&amp;&amp;</span>&nbsp;<span class="ident" id="3442517">k2</span>&nbsp;<span class="op" id="3442520">==</span>&nbsp;<span class="ident" id="3442523">intKind</span><span class="op" id="3442530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442536">truth</span>&nbsp;<span class="op" id="3442542">=</span>&nbsp;<span class="ident" id="3442544">v2</span><span class="op" id="3442546">.</span><span class="ident" id="3442547">Int</span><span class="op" id="3442550">(</span><span class="op" id="3442551">)</span>&nbsp;<span class="op" id="3442553">&gt;=</span>&nbsp;<span class="num" id="3442556">0</span>&nbsp;<span class="op" id="3442558">&amp;&amp;</span>&nbsp;<span class="ident" id="3442561">v1</span><span class="op" id="3442563">.</span><span class="ident" id="3442564">Uint</span><span class="op" id="3442568">(</span><span class="op" id="3442569">)</span>&nbsp;<span class="op" id="3442571">==</span>&nbsp;<span class="ident" id="3442574">uint64</span><span class="op" id="3442580">(</span><span class="ident" id="3442581">v2</span><span class="op" id="3442583">.</span><span class="ident" id="3442584">Int</span><span class="op" id="3442587">(</span><span class="op" id="3442588">)</span><span class="op" id="3442589">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442594">default</span><span class="op" id="3442601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442607">return</span>&nbsp;<span class="builtintype" id="3442614">false</span><span class="op" id="3442619">,</span>&nbsp;<span class="ident" id="3442621">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3442645">}</span>&nbsp;<span class="keyword" id="3442647">else</span>&nbsp;<span class="op" id="3442652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442657">switch</span>&nbsp;<span class="ident" id="3442664">k1</span>&nbsp;<span class="op" id="3442667">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442672">case</span>&nbsp;<span class="ident" id="3442677">boolKind</span><span class="op" id="3442685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442691">truth</span>&nbsp;<span class="op" id="3442697">=</span>&nbsp;<span class="ident" id="3442699">v1</span><span class="op" id="3442701">.</span><span class="ident" id="3442702">Bool</span><span class="op" id="3442706">(</span><span class="op" id="3442707">)</span>&nbsp;<span class="op" id="3442709">==</span>&nbsp;<span class="ident" id="3442712">v2</span><span class="op" id="3442714">.</span><span class="ident" id="3442715">Bool</span><span class="op" id="3442719">(</span><span class="op" id="3442720">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442725">case</span>&nbsp;<span class="ident" id="3442730">complexKind</span><span class="op" id="3442741">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442747">truth</span>&nbsp;<span class="op" id="3442753">=</span>&nbsp;<span class="ident" id="3442755">v1</span><span class="op" id="3442757">.</span><span class="ident" id="3442758">Complex</span><span class="op" id="3442765">(</span><span class="op" id="3442766">)</span>&nbsp;<span class="op" id="3442768">==</span>&nbsp;<span class="ident" id="3442771">v2</span><span class="op" id="3442773">.</span><span class="ident" id="3442774">Complex</span><span class="op" id="3442781">(</span><span class="op" id="3442782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442787">case</span>&nbsp;<span class="ident" id="3442792">floatKind</span><span class="op" id="3442801">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442807">truth</span>&nbsp;<span class="op" id="3442813">=</span>&nbsp;<span class="ident" id="3442815">v1</span><span class="op" id="3442817">.</span><span class="ident" id="3442818">Float</span><span class="op" id="3442823">(</span><span class="op" id="3442824">)</span>&nbsp;<span class="op" id="3442826">==</span>&nbsp;<span class="ident" id="3442829">v2</span><span class="op" id="3442831">.</span><span class="ident" id="3442832">Float</span><span class="op" id="3442837">(</span><span class="op" id="3442838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442843">case</span>&nbsp;<span class="ident" id="3442848">intKind</span><span class="op" id="3442855">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442861">truth</span>&nbsp;<span class="op" id="3442867">=</span>&nbsp;<span class="ident" id="3442869">v1</span><span class="op" id="3442871">.</span><span class="ident" id="3442872">Int</span><span class="op" id="3442875">(</span><span class="op" id="3442876">)</span>&nbsp;<span class="op" id="3442878">==</span>&nbsp;<span class="ident" id="3442881">v2</span><span class="op" id="3442883">.</span><span class="ident" id="3442884">Int</span><span class="op" id="3442887">(</span><span class="op" id="3442888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442893">case</span>&nbsp;<span class="ident" id="3442898">stringKind</span><span class="op" id="3442908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442914">truth</span>&nbsp;<span class="op" id="3442920">=</span>&nbsp;<span class="ident" id="3442922">v1</span><span class="op" id="3442924">.</span><span class="ident" id="3442925">String</span><span class="op" id="3442931">(</span><span class="op" id="3442932">)</span>&nbsp;<span class="op" id="3442934">==</span>&nbsp;<span class="ident" id="3442937">v2</span><span class="op" id="3442939">.</span><span class="ident" id="3442940">String</span><span class="op" id="3442946">(</span><span class="op" id="3442947">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3442952">case</span>&nbsp;<span class="ident" id="3442957">uintKind</span><span class="op" id="3442965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3442971">truth</span>&nbsp;<span class="op" id="3442977">=</span>&nbsp;<span class="ident" id="3442979">v1</span><span class="op" id="3442981">.</span><span class="ident" id="3442982">Uint</span><span class="op" id="3442986">(</span><span class="op" id="3442987">)</span>&nbsp;<span class="op" id="3442989">==</span>&nbsp;<span class="ident" id="3442992">v2</span><span class="op" id="3442994">.</span><span class="ident" id="3442995">Uint</span><span class="op" id="3442999">(</span><span class="op" id="3443000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443005">default</span><span class="op" id="3443012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3443018">panic</span><span class="op" id="3443023">(</span><span class="string" id="3443024">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3443038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443043">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443047">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443051">if</span>&nbsp;<span class="ident" id="3443054">truth</span>&nbsp;<span class="op" id="3443060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443065">return</span>&nbsp;<span class="builtintype" id="3443072">true</span><span class="op" id="3443076">,</span>&nbsp;<span class="ident" id="3443078">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443087">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443090">return</span>&nbsp;<span class="builtintype" id="3443097">false</span><span class="op" id="3443102">,</span>&nbsp;<span class="ident" id="3443104">nil</span><br>
<span class="lineno"></span><span class="op" id="3443108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3443111">//&nbsp;ne&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3443150">func</span>&nbsp;<span class="ident" id="3443155">ne</span><span class="op" id="3443157">(</span><span class="ident" id="3443158">arg1</span><span class="op" id="3443162">,</span>&nbsp;<span class="ident" id="3443164">arg2</span>&nbsp;<span class="keyword" id="3443169">interface</span><span class="op" id="3443178">{</span><span class="op" id="3443179">}</span><span class="op" id="3443180">)</span>&nbsp;<span class="op" id="3443182">(</span><span class="builtintype" id="3443183">bool</span><span class="op" id="3443187">,</span>&nbsp;<span class="builtintype" id="3443189">error</span><span class="op" id="3443194">)</span>&nbsp;<span class="op" id="3443196">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3443199">//&nbsp;!=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;==.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443228">equal</span><span class="op" id="3443233">,</span>&nbsp;<span class="ident" id="3443235">err</span>&nbsp;<span class="op" id="3443239">:=</span>&nbsp;<span class="ident" id="3443242">eq</span><span class="op" id="3443244">(</span><span class="ident" id="3443245">arg1</span><span class="op" id="3443249">,</span>&nbsp;<span class="ident" id="3443251">arg2</span><span class="op" id="3443255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443258">return</span>&nbsp;<span class="op" id="3443265">!</span><span class="ident" id="3443266">equal</span><span class="op" id="3443271">,</span>&nbsp;<span class="ident" id="3443273">err</span><br>
<span class="lineno"></span><span class="op" id="3443277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="3443280">//&nbsp;lt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&lt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3443318">func</span>&nbsp;<span class="ident" id="3443323">lt</span><span class="op" id="3443325">(</span><span class="ident" id="3443326">arg1</span><span class="op" id="3443330">,</span>&nbsp;<span class="ident" id="3443332">arg2</span>&nbsp;<span class="keyword" id="3443337">interface</span><span class="op" id="3443346">{</span><span class="op" id="3443347">}</span><span class="op" id="3443348">)</span>&nbsp;<span class="op" id="3443350">(</span><span class="builtintype" id="3443351">bool</span><span class="op" id="3443355">,</span>&nbsp;<span class="builtintype" id="3443357">error</span><span class="op" id="3443362">)</span>&nbsp;<span class="op" id="3443364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443367">v1</span>&nbsp;<span class="op" id="3443370">:=</span>&nbsp;<span class="ident" id="3443373">reflect</span><span class="op" id="3443380">.</span><span class="ident" id="3443381">ValueOf</span><span class="op" id="3443388">(</span><span class="ident" id="3443389">arg1</span><span class="op" id="3443393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443396">k1</span><span class="op" id="3443398">,</span>&nbsp;<span class="ident" id="3443400">err</span>&nbsp;<span class="op" id="3443404">:=</span>&nbsp;<span class="ident" id="3443407">basicKind</span><span class="op" id="3443416">(</span><span class="ident" id="3443417">v1</span><span class="op" id="3443419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443422">if</span>&nbsp;<span class="ident" id="3443425">err</span>&nbsp;<span class="op" id="3443429">!=</span>&nbsp;<span class="ident" id="3443432">nil</span>&nbsp;<span class="op" id="3443436">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443440">return</span>&nbsp;<span class="builtintype" id="3443447">false</span><span class="op" id="3443452">,</span>&nbsp;<span class="ident" id="3443454">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443462">v2</span>&nbsp;<span class="op" id="3443465">:=</span>&nbsp;<span class="ident" id="3443468">reflect</span><span class="op" id="3443475">.</span><span class="ident" id="3443476">ValueOf</span><span class="op" id="3443483">(</span><span class="ident" id="3443484">arg2</span><span class="op" id="3443488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443491">k2</span><span class="op" id="3443493">,</span>&nbsp;<span class="ident" id="3443495">err</span>&nbsp;<span class="op" id="3443499">:=</span>&nbsp;<span class="ident" id="3443502">basicKind</span><span class="op" id="3443511">(</span><span class="ident" id="3443512">v2</span><span class="op" id="3443514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443517">if</span>&nbsp;<span class="ident" id="3443520">err</span>&nbsp;<span class="op" id="3443524">!=</span>&nbsp;<span class="ident" id="3443527">nil</span>&nbsp;<span class="op" id="3443531">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443535">return</span>&nbsp;<span class="builtintype" id="3443542">false</span><span class="op" id="3443547">,</span>&nbsp;<span class="ident" id="3443549">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443557">truth</span>&nbsp;<span class="op" id="3443563">:=</span>&nbsp;<span class="builtintype" id="3443566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443573">if</span>&nbsp;<span class="ident" id="3443576">k1</span>&nbsp;<span class="op" id="3443579">!=</span>&nbsp;<span class="ident" id="3443582">k2</span>&nbsp;<span class="op" id="3443585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3443589">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443662">switch</span>&nbsp;<span class="op" id="3443669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443673">case</span>&nbsp;<span class="ident" id="3443678">k1</span>&nbsp;<span class="op" id="3443681">==</span>&nbsp;<span class="ident" id="3443684">intKind</span>&nbsp;<span class="op" id="3443692">&amp;&amp;</span>&nbsp;<span class="ident" id="3443695">k2</span>&nbsp;<span class="op" id="3443698">==</span>&nbsp;<span class="ident" id="3443701">uintKind</span><span class="op" id="3443709">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443714">truth</span>&nbsp;<span class="op" id="3443720">=</span>&nbsp;<span class="ident" id="3443722">v1</span><span class="op" id="3443724">.</span><span class="ident" id="3443725">Int</span><span class="op" id="3443728">(</span><span class="op" id="3443729">)</span>&nbsp;<span class="op" id="3443731">&lt;</span>&nbsp;<span class="num" id="3443733">0</span>&nbsp;<span class="op" id="3443735">||</span>&nbsp;<span class="ident" id="3443738">uint64</span><span class="op" id="3443744">(</span><span class="ident" id="3443745">v1</span><span class="op" id="3443747">.</span><span class="ident" id="3443748">Int</span><span class="op" id="3443751">(</span><span class="op" id="3443752">)</span><span class="op" id="3443753">)</span>&nbsp;<span class="op" id="3443755">&lt;</span>&nbsp;<span class="ident" id="3443757">v2</span><span class="op" id="3443759">.</span><span class="ident" id="3443760">Uint</span><span class="op" id="3443764">(</span><span class="op" id="3443765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443769">case</span>&nbsp;<span class="ident" id="3443774">k1</span>&nbsp;<span class="op" id="3443777">==</span>&nbsp;<span class="ident" id="3443780">uintKind</span>&nbsp;<span class="op" id="3443789">&amp;&amp;</span>&nbsp;<span class="ident" id="3443792">k2</span>&nbsp;<span class="op" id="3443795">==</span>&nbsp;<span class="ident" id="3443798">intKind</span><span class="op" id="3443805">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3443810">truth</span>&nbsp;<span class="op" id="3443816">=</span>&nbsp;<span class="ident" id="3443818">v2</span><span class="op" id="3443820">.</span><span class="ident" id="3443821">Int</span><span class="op" id="3443824">(</span><span class="op" id="3443825">)</span>&nbsp;<span class="op" id="3443827">&gt;=</span>&nbsp;<span class="num" id="3443830">0</span>&nbsp;<span class="op" id="3443832">&amp;&amp;</span>&nbsp;<span class="ident" id="3443835">v1</span><span class="op" id="3443837">.</span><span class="ident" id="3443838">Uint</span><span class="op" id="3443842">(</span><span class="op" id="3443843">)</span>&nbsp;<span class="op" id="3443845">&lt;</span>&nbsp;<span class="ident" id="3443847">uint64</span><span class="op" id="3443853">(</span><span class="ident" id="3443854">v2</span><span class="op" id="3443856">.</span><span class="ident" id="3443857">Int</span><span class="op" id="3443860">(</span><span class="op" id="3443861">)</span><span class="op" id="3443862">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443866">default</span><span class="op" id="3443873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443878">return</span>&nbsp;<span class="builtintype" id="3443885">false</span><span class="op" id="3443890">,</span>&nbsp;<span class="ident" id="3443892">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3443914">}</span>&nbsp;<span class="keyword" id="3443916">else</span>&nbsp;<span class="op" id="3443921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443925">switch</span>&nbsp;<span class="ident" id="3443932">k1</span>&nbsp;<span class="op" id="3443935">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443939">case</span>&nbsp;<span class="ident" id="3443944">boolKind</span><span class="op" id="3443952">,</span>&nbsp;<span class="ident" id="3443954">complexKind</span><span class="op" id="3443965">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3443970">return</span>&nbsp;<span class="builtintype" id="3443977">false</span><span class="op" id="3443982">,</span>&nbsp;<span class="ident" id="3443984">errBadComparisonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444007">case</span>&nbsp;<span class="ident" id="3444012">floatKind</span><span class="op" id="3444021">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444026">truth</span>&nbsp;<span class="op" id="3444032">=</span>&nbsp;<span class="ident" id="3444034">v1</span><span class="op" id="3444036">.</span><span class="ident" id="3444037">Float</span><span class="op" id="3444042">(</span><span class="op" id="3444043">)</span>&nbsp;<span class="op" id="3444045">&lt;</span>&nbsp;<span class="ident" id="3444047">v2</span><span class="op" id="3444049">.</span><span class="ident" id="3444050">Float</span><span class="op" id="3444055">(</span><span class="op" id="3444056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444060">case</span>&nbsp;<span class="ident" id="3444065">intKind</span><span class="op" id="3444072">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444077">truth</span>&nbsp;<span class="op" id="3444083">=</span>&nbsp;<span class="ident" id="3444085">v1</span><span class="op" id="3444087">.</span><span class="ident" id="3444088">Int</span><span class="op" id="3444091">(</span><span class="op" id="3444092">)</span>&nbsp;<span class="op" id="3444094">&lt;</span>&nbsp;<span class="ident" id="3444096">v2</span><span class="op" id="3444098">.</span><span class="ident" id="3444099">Int</span><span class="op" id="3444102">(</span><span class="op" id="3444103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444107">case</span>&nbsp;<span class="ident" id="3444112">stringKind</span><span class="op" id="3444122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444127">truth</span>&nbsp;<span class="op" id="3444133">=</span>&nbsp;<span class="ident" id="3444135">v1</span><span class="op" id="3444137">.</span><span class="ident" id="3444138">String</span><span class="op" id="3444144">(</span><span class="op" id="3444145">)</span>&nbsp;<span class="op" id="3444147">&lt;</span>&nbsp;<span class="ident" id="3444149">v2</span><span class="op" id="3444151">.</span><span class="ident" id="3444152">String</span><span class="op" id="3444158">(</span><span class="op" id="3444159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444163">case</span>&nbsp;<span class="ident" id="3444168">uintKind</span><span class="op" id="3444176">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444181">truth</span>&nbsp;<span class="op" id="3444187">=</span>&nbsp;<span class="ident" id="3444189">v1</span><span class="op" id="3444191">.</span><span class="ident" id="3444192">Uint</span><span class="op" id="3444196">(</span><span class="op" id="3444197">)</span>&nbsp;<span class="op" id="3444199">&lt;</span>&nbsp;<span class="ident" id="3444201">v2</span><span class="op" id="3444203">.</span><span class="ident" id="3444204">Uint</span><span class="op" id="3444208">(</span><span class="op" id="3444209">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444213">default</span><span class="op" id="3444220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3444225">panic</span><span class="op" id="3444230">(</span><span class="string" id="3444231">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="3444245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3444249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3444252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444255">return</span>&nbsp;<span class="ident" id="3444262">truth</span><span class="op" id="3444267">,</span>&nbsp;<span class="ident" id="3444269">nil</span><br>
<span class="lineno">400</span><span class="op" id="3444273">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444276">//&nbsp;le&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;&lt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3444313">func</span>&nbsp;<span class="ident" id="3444318">le</span><span class="op" id="3444320">(</span><span class="ident" id="3444321">arg1</span><span class="op" id="3444325">,</span>&nbsp;<span class="ident" id="3444327">arg2</span>&nbsp;<span class="keyword" id="3444332">interface</span><span class="op" id="3444341">{</span><span class="op" id="3444342">}</span><span class="op" id="3444343">)</span>&nbsp;<span class="op" id="3444345">(</span><span class="builtintype" id="3444346">bool</span><span class="op" id="3444350">,</span>&nbsp;<span class="builtintype" id="3444352">error</span><span class="op" id="3444357">)</span>&nbsp;<span class="op" id="3444359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3444362">//&nbsp;&lt;=&nbsp;is&nbsp;&lt;&nbsp;or&nbsp;==.</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444381">lessThan</span><span class="op" id="3444389">,</span>&nbsp;<span class="ident" id="3444391">err</span>&nbsp;<span class="op" id="3444395">:=</span>&nbsp;<span class="ident" id="3444398">lt</span><span class="op" id="3444400">(</span><span class="ident" id="3444401">arg1</span><span class="op" id="3444405">,</span>&nbsp;<span class="ident" id="3444407">arg2</span><span class="op" id="3444411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444414">if</span>&nbsp;<span class="ident" id="3444417">lessThan</span>&nbsp;<span class="op" id="3444426">||</span>&nbsp;<span class="ident" id="3444429">err</span>&nbsp;<span class="op" id="3444433">!=</span>&nbsp;<span class="ident" id="3444436">nil</span>&nbsp;<span class="op" id="3444440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444444">return</span>&nbsp;<span class="ident" id="3444451">lessThan</span><span class="op" id="3444459">,</span>&nbsp;<span class="ident" id="3444461">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3444466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444469">return</span>&nbsp;<span class="ident" id="3444476">eq</span><span class="op" id="3444478">(</span><span class="ident" id="3444479">arg1</span><span class="op" id="3444483">,</span>&nbsp;<span class="ident" id="3444485">arg2</span><span class="op" id="3444489">)</span><br>
<span class="lineno">410</span><span class="op" id="3444491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444494">//&nbsp;gt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3444532">func</span>&nbsp;<span class="ident" id="3444537">gt</span><span class="op" id="3444539">(</span><span class="ident" id="3444540">arg1</span><span class="op" id="3444544">,</span>&nbsp;<span class="ident" id="3444546">arg2</span>&nbsp;<span class="keyword" id="3444551">interface</span><span class="op" id="3444560">{</span><span class="op" id="3444561">}</span><span class="op" id="3444562">)</span>&nbsp;<span class="op" id="3444564">(</span><span class="builtintype" id="3444565">bool</span><span class="op" id="3444569">,</span>&nbsp;<span class="builtintype" id="3444571">error</span><span class="op" id="3444576">)</span>&nbsp;<span class="op" id="3444578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3444581">//&nbsp;&gt;&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;=.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444609">lessOrEqual</span><span class="op" id="3444620">,</span>&nbsp;<span class="ident" id="3444622">err</span>&nbsp;<span class="op" id="3444626">:=</span>&nbsp;<span class="ident" id="3444629">le</span><span class="op" id="3444631">(</span><span class="ident" id="3444632">arg1</span><span class="op" id="3444636">,</span>&nbsp;<span class="ident" id="3444638">arg2</span><span class="op" id="3444642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444645">if</span>&nbsp;<span class="ident" id="3444648">err</span>&nbsp;<span class="op" id="3444652">!=</span>&nbsp;<span class="ident" id="3444655">nil</span>&nbsp;<span class="op" id="3444659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444663">return</span>&nbsp;<span class="builtintype" id="3444670">false</span><span class="op" id="3444675">,</span>&nbsp;<span class="ident" id="3444677">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3444682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444685">return</span>&nbsp;<span class="op" id="3444692">!</span><span class="ident" id="3444693">lessOrEqual</span><span class="op" id="3444704">,</span>&nbsp;<span class="ident" id="3444706">nil</span><br>
<span class="lineno">420</span><span class="op" id="3444710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444713">//&nbsp;ge&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3444752">func</span>&nbsp;<span class="ident" id="3444757">ge</span><span class="op" id="3444759">(</span><span class="ident" id="3444760">arg1</span><span class="op" id="3444764">,</span>&nbsp;<span class="ident" id="3444766">arg2</span>&nbsp;<span class="keyword" id="3444771">interface</span><span class="op" id="3444780">{</span><span class="op" id="3444781">}</span><span class="op" id="3444782">)</span>&nbsp;<span class="op" id="3444784">(</span><span class="builtintype" id="3444785">bool</span><span class="op" id="3444789">,</span>&nbsp;<span class="builtintype" id="3444791">error</span><span class="op" id="3444796">)</span>&nbsp;<span class="op" id="3444798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3444801">//&nbsp;&gt;=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444829">lessThan</span><span class="op" id="3444837">,</span>&nbsp;<span class="ident" id="3444839">err</span>&nbsp;<span class="op" id="3444843">:=</span>&nbsp;<span class="ident" id="3444846">lt</span><span class="op" id="3444848">(</span><span class="ident" id="3444849">arg1</span><span class="op" id="3444853">,</span>&nbsp;<span class="ident" id="3444855">arg2</span><span class="op" id="3444859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444862">if</span>&nbsp;<span class="ident" id="3444865">err</span>&nbsp;<span class="op" id="3444869">!=</span>&nbsp;<span class="ident" id="3444872">nil</span>&nbsp;<span class="op" id="3444876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444880">return</span>&nbsp;<span class="builtintype" id="3444887">false</span><span class="op" id="3444892">,</span>&nbsp;<span class="ident" id="3444894">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3444899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3444902">return</span>&nbsp;<span class="op" id="3444909">!</span><span class="ident" id="3444910">lessThan</span><span class="op" id="3444918">,</span>&nbsp;<span class="ident" id="3444920">nil</span><br>
<span class="lineno">430</span><span class="op" id="3444924">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3444927">//&nbsp;HTML&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3444946">var</span>&nbsp;<span class="op" id="3444950">(</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3444953">htmlQuot</span>&nbsp;<span class="op" id="3444962">=</span>&nbsp;<span class="op" id="3444964">[</span><span class="op" id="3444965">]</span><span class="builtintype" id="3444966">byte</span><span class="op" id="3444970">(</span><span class="string" id="3444971">&#34;&amp;#34;&#34;</span><span class="op" id="3444978">)</span>&nbsp;<span class="comment" id="3444980">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;quot;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445006">htmlApos</span>&nbsp;<span class="op" id="3445015">=</span>&nbsp;<span class="op" id="3445017">[</span><span class="op" id="3445018">]</span><span class="builtintype" id="3445019">byte</span><span class="op" id="3445023">(</span><span class="string" id="3445024">&#34;&amp;#39;&#34;</span><span class="op" id="3445031">)</span>&nbsp;<span class="comment" id="3445033">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;apos;&#34;&nbsp;and&nbsp;apos&nbsp;was&nbsp;not&nbsp;in&nbsp;HTML&nbsp;until&nbsp;HTML5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445096">htmlAmp</span>&nbsp;&nbsp;<span class="op" id="3445105">=</span>&nbsp;<span class="op" id="3445107">[</span><span class="op" id="3445108">]</span><span class="builtintype" id="3445109">byte</span><span class="op" id="3445113">(</span><span class="string" id="3445114">&#34;&amp;amp;&#34;</span><span class="op" id="3445121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445124">htmlLt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3445133">=</span>&nbsp;<span class="op" id="3445135">[</span><span class="op" id="3445136">]</span><span class="builtintype" id="3445137">byte</span><span class="op" id="3445141">(</span><span class="string" id="3445142">&#34;&amp;lt;&#34;</span><span class="op" id="3445148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445151">htmlGt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3445160">=</span>&nbsp;<span class="op" id="3445162">[</span><span class="op" id="3445163">]</span><span class="builtintype" id="3445164">byte</span><span class="op" id="3445168">(</span><span class="string" id="3445169">&#34;&amp;gt;&#34;</span><span class="op" id="3445175">)</span><br>
<span class="lineno">440</span><span class="op" id="3445177">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3445180">//&nbsp;HTMLEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3445260">func</span>&nbsp;<span class="ident" id="3445265">HTMLEscape</span><span class="op" id="3445275">(</span><span class="ident" id="3445276">w</span>&nbsp;<span class="ident" id="3445278">io</span><span class="op" id="3445280">.</span><span class="ident" id="3445281">Writer</span><span class="op" id="3445287">,</span>&nbsp;<span class="ident" id="3445289">b</span>&nbsp;<span class="op" id="3445291">[</span><span class="op" id="3445292">]</span><span class="builtintype" id="3445293">byte</span><span class="op" id="3445297">)</span>&nbsp;<span class="op" id="3445299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445302">last</span>&nbsp;<span class="op" id="3445307">:=</span>&nbsp;<span class="num" id="3445310">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445313">for</span>&nbsp;<span class="ident" id="3445317">i</span><span class="op" id="3445318">,</span>&nbsp;<span class="ident" id="3445320">c</span>&nbsp;<span class="op" id="3445322">:=</span>&nbsp;<span class="keyword" id="3445325">range</span>&nbsp;<span class="ident" id="3445331">b</span>&nbsp;<span class="op" id="3445333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445337">var</span>&nbsp;<span class="ident" id="3445341">html</span>&nbsp;<span class="op" id="3445346">[</span><span class="op" id="3445347">]</span><span class="builtintype" id="3445348">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445355">switch</span>&nbsp;<span class="ident" id="3445362">c</span>&nbsp;<span class="op" id="3445364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445368">case</span>&nbsp;<span class="string" id="3445373">&#39;&#34;&#39;</span><span class="op" id="3445376">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445381">html</span>&nbsp;<span class="op" id="3445386">=</span>&nbsp;<span class="ident" id="3445388">htmlQuot</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445399">case</span>&nbsp;<span class="string" id="3445404">&#39;\&#39;&#39;</span><span class="op" id="3445408">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445413">html</span>&nbsp;<span class="op" id="3445418">=</span>&nbsp;<span class="ident" id="3445420">htmlApos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445431">case</span>&nbsp;<span class="string" id="3445436">&#39;&amp;&#39;</span><span class="op" id="3445439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445444">html</span>&nbsp;<span class="op" id="3445449">=</span>&nbsp;<span class="ident" id="3445451">htmlAmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445461">case</span>&nbsp;<span class="string" id="3445466">&#39;&lt;&#39;</span><span class="op" id="3445469">:</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445474">html</span>&nbsp;<span class="op" id="3445479">=</span>&nbsp;<span class="ident" id="3445481">htmlLt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445490">case</span>&nbsp;<span class="string" id="3445495">&#39;&gt;&#39;</span><span class="op" id="3445498">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445503">html</span>&nbsp;<span class="op" id="3445508">=</span>&nbsp;<span class="ident" id="3445510">htmlGt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445519">default</span><span class="op" id="3445526">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445531">continue</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3445542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445546">w</span><span class="op" id="3445547">.</span><span class="ident" id="3445548">Write</span><span class="op" id="3445553">(</span><span class="ident" id="3445554">b</span><span class="op" id="3445555">[</span><span class="ident" id="3445556">last</span><span class="op" id="3445560">:</span><span class="ident" id="3445561">i</span><span class="op" id="3445562">]</span><span class="op" id="3445563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445567">w</span><span class="op" id="3445568">.</span><span class="ident" id="3445569">Write</span><span class="op" id="3445574">(</span><span class="ident" id="3445575">html</span><span class="op" id="3445579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445583">last</span>&nbsp;<span class="op" id="3445588">=</span>&nbsp;<span class="ident" id="3445590">i</span>&nbsp;<span class="op" id="3445592">+</span>&nbsp;<span class="num" id="3445594">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3445597">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445600">w</span><span class="op" id="3445601">.</span><span class="ident" id="3445602">Write</span><span class="op" id="3445607">(</span><span class="ident" id="3445608">b</span><span class="op" id="3445609">[</span><span class="ident" id="3445610">last</span><span class="op" id="3445614">:</span><span class="op" id="3445615">]</span><span class="op" id="3445616">)</span><br>
<span class="lineno"></span><span class="op" id="3445618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3445621">//&nbsp;HTMLEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3445703">func</span>&nbsp;<span class="ident" id="3445708">HTMLEscapeString</span><span class="op" id="3445724">(</span><span class="ident" id="3445725">s</span>&nbsp;<span class="builtintype" id="3445727">string</span><span class="op" id="3445733">)</span>&nbsp;<span class="builtintype" id="3445735">string</span>&nbsp;<span class="op" id="3445742">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3445745">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445777">if</span>&nbsp;<span class="ident" id="3445780">strings</span><span class="op" id="3445787">.</span><span class="ident" id="3445788">IndexAny</span><span class="op" id="3445796">(</span><span class="ident" id="3445797">s</span><span class="op" id="3445798">,</span>&nbsp;<span class="string" id="3445800">`&#39;&#34;&amp;&lt;&gt;`</span><span class="op" id="3445807">)</span>&nbsp;<span class="op" id="3445809">&lt;</span>&nbsp;<span class="num" id="3445811">0</span>&nbsp;<span class="op" id="3445813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445817">return</span>&nbsp;<span class="ident" id="3445824">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3445827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445830">var</span>&nbsp;<span class="ident" id="3445834">b</span>&nbsp;<span class="ident" id="3445836">bytes</span><span class="op" id="3445841">.</span><span class="ident" id="3445842">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3445850">HTMLEscape</span><span class="op" id="3445860">(</span><span class="op" id="3445861">&amp;</span><span class="ident" id="3445862">b</span><span class="op" id="3445863">,</span>&nbsp;<span class="op" id="3445865">[</span><span class="op" id="3445866">]</span><span class="builtintype" id="3445867">byte</span><span class="op" id="3445871">(</span><span class="ident" id="3445872">s</span><span class="op" id="3445873">)</span><span class="op" id="3445874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3445877">return</span>&nbsp;<span class="ident" id="3445884">b</span><span class="op" id="3445885">.</span><span class="ident" id="3445886">String</span><span class="op" id="3445892">(</span><span class="op" id="3445893">)</span><br>
<span class="lineno"></span><span class="op" id="3445895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3445898">//&nbsp;HTMLEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">480</span><span class="comment" id="3445964">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3446000">func</span>&nbsp;<span class="ident" id="3446005">HTMLEscaper</span><span class="op" id="3446016">(</span><span class="ident" id="3446017">args</span>&nbsp;<span class="op" id="3446022">...</span><span class="keyword" id="3446025">interface</span><span class="op" id="3446034">{</span><span class="op" id="3446035">}</span><span class="op" id="3446036">)</span>&nbsp;<span class="builtintype" id="3446038">string</span>&nbsp;<span class="op" id="3446045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446048">return</span>&nbsp;<span class="ident" id="3446055">HTMLEscapeString</span><span class="op" id="3446071">(</span><span class="ident" id="3446072">evalArgs</span><span class="op" id="3446080">(</span><span class="ident" id="3446081">args</span><span class="op" id="3446085">)</span><span class="op" id="3446086">)</span><br>
<span class="lineno"></span><span class="op" id="3446088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="3446091">//&nbsp;JavaScript&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3446116">var</span>&nbsp;<span class="op" id="3446120">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446123">jsLowUni</span>&nbsp;<span class="op" id="3446132">=</span>&nbsp;<span class="op" id="3446134">[</span><span class="op" id="3446135">]</span><span class="builtintype" id="3446136">byte</span><span class="op" id="3446140">(</span><span class="string" id="3446141">`\u00`</span><span class="op" id="3446147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446150">hex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446159">=</span>&nbsp;<span class="op" id="3446161">[</span><span class="op" id="3446162">]</span><span class="builtintype" id="3446163">byte</span><span class="op" id="3446167">(</span><span class="string" id="3446168">&#34;0123456789ABCDEF&#34;</span><span class="op" id="3446186">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446190">jsBackslash</span>&nbsp;<span class="op" id="3446202">=</span>&nbsp;<span class="op" id="3446204">[</span><span class="op" id="3446205">]</span><span class="builtintype" id="3446206">byte</span><span class="op" id="3446210">(</span><span class="string" id="3446211">`\\`</span><span class="op" id="3446215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446218">jsApos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446230">=</span>&nbsp;<span class="op" id="3446232">[</span><span class="op" id="3446233">]</span><span class="builtintype" id="3446234">byte</span><span class="op" id="3446238">(</span><span class="string" id="3446239">`\&#39;`</span><span class="op" id="3446243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446246">jsQuot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446258">=</span>&nbsp;<span class="op" id="3446260">[</span><span class="op" id="3446261">]</span><span class="builtintype" id="3446262">byte</span><span class="op" id="3446266">(</span><span class="string" id="3446267">`\&#34;`</span><span class="op" id="3446271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446274">jsLt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446286">=</span>&nbsp;<span class="op" id="3446288">[</span><span class="op" id="3446289">]</span><span class="builtintype" id="3446290">byte</span><span class="op" id="3446294">(</span><span class="string" id="3446295">`\x3C`</span><span class="op" id="3446301">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446304">jsGt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3446316">=</span>&nbsp;<span class="op" id="3446318">[</span><span class="op" id="3446319">]</span><span class="builtintype" id="3446320">byte</span><span class="op" id="3446324">(</span><span class="string" id="3446325">`\x3E`</span><span class="op" id="3446331">)</span><br>
<span class="lineno"></span><span class="op" id="3446333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3446336">//&nbsp;JSEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3446420">func</span>&nbsp;<span class="ident" id="3446425">JSEscape</span><span class="op" id="3446433">(</span><span class="ident" id="3446434">w</span>&nbsp;<span class="ident" id="3446436">io</span><span class="op" id="3446438">.</span><span class="ident" id="3446439">Writer</span><span class="op" id="3446445">,</span>&nbsp;<span class="ident" id="3446447">b</span>&nbsp;<span class="op" id="3446449">[</span><span class="op" id="3446450">]</span><span class="builtintype" id="3446451">byte</span><span class="op" id="3446455">)</span>&nbsp;<span class="op" id="3446457">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446460">last</span>&nbsp;<span class="op" id="3446465">:=</span>&nbsp;<span class="num" id="3446468">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446471">for</span>&nbsp;<span class="ident" id="3446475">i</span>&nbsp;<span class="op" id="3446477">:=</span>&nbsp;<span class="num" id="3446480">0</span><span class="op" id="3446481">;</span>&nbsp;<span class="ident" id="3446483">i</span>&nbsp;<span class="op" id="3446485">&lt;</span>&nbsp;<span class="builtinfunc" id="3446487">len</span><span class="op" id="3446490">(</span><span class="ident" id="3446491">b</span><span class="op" id="3446492">)</span><span class="op" id="3446493">;</span>&nbsp;<span class="ident" id="3446495">i</span><span class="op" id="3446496">++</span>&nbsp;<span class="op" id="3446499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446503">c</span>&nbsp;<span class="op" id="3446505">:=</span>&nbsp;<span class="ident" id="3446508">b</span><span class="op" id="3446509">[</span><span class="ident" id="3446510">i</span><span class="op" id="3446511">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446516">if</span>&nbsp;<span class="op" id="3446519">!</span><span class="ident" id="3446520">jsIsSpecial</span><span class="op" id="3446531">(</span><span class="builtintype" id="3446532">rune</span><span class="op" id="3446536">(</span><span class="ident" id="3446537">c</span><span class="op" id="3446538">)</span><span class="op" id="3446539">)</span>&nbsp;<span class="op" id="3446541">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3446546">//&nbsp;fast&nbsp;path:&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446577">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3446588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446592">w</span><span class="op" id="3446593">.</span><span class="ident" id="3446594">Write</span><span class="op" id="3446599">(</span><span class="ident" id="3446600">b</span><span class="op" id="3446601">[</span><span class="ident" id="3446602">last</span><span class="op" id="3446606">:</span><span class="ident" id="3446607">i</span><span class="op" id="3446608">]</span><span class="op" id="3446609">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446614">if</span>&nbsp;<span class="ident" id="3446617">c</span>&nbsp;<span class="op" id="3446619">&lt;</span>&nbsp;<span class="ident" id="3446621">utf8</span><span class="op" id="3446625">.</span><span class="ident" id="3446626">RuneSelf</span>&nbsp;<span class="op" id="3446635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3446640">//&nbsp;Quotes,&nbsp;slashes&nbsp;and&nbsp;angle&nbsp;brackets&nbsp;get&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3446693">//&nbsp;Control&nbsp;characters&nbsp;get&nbsp;written&nbsp;as&nbsp;\u00XX.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446741">switch</span>&nbsp;<span class="ident" id="3446748">c</span>&nbsp;<span class="op" id="3446750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446755">case</span>&nbsp;<span class="string" id="3446760">&#39;\\&#39;</span><span class="op" id="3446764">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446770">w</span><span class="op" id="3446771">.</span><span class="ident" id="3446772">Write</span><span class="op" id="3446777">(</span><span class="ident" id="3446778">jsBackslash</span><span class="op" id="3446789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446794">case</span>&nbsp;<span class="string" id="3446799">&#39;\&#39;&#39;</span><span class="op" id="3446803">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446809">w</span><span class="op" id="3446810">.</span><span class="ident" id="3446811">Write</span><span class="op" id="3446816">(</span><span class="ident" id="3446817">jsApos</span><span class="op" id="3446823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446828">case</span>&nbsp;<span class="string" id="3446833">&#39;&#34;&#39;</span><span class="op" id="3446836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446842">w</span><span class="op" id="3446843">.</span><span class="ident" id="3446844">Write</span><span class="op" id="3446849">(</span><span class="ident" id="3446850">jsQuot</span><span class="op" id="3446856">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446861">case</span>&nbsp;<span class="string" id="3446866">&#39;&lt;&#39;</span><span class="op" id="3446869">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446875">w</span><span class="op" id="3446876">.</span><span class="ident" id="3446877">Write</span><span class="op" id="3446882">(</span><span class="ident" id="3446883">jsLt</span><span class="op" id="3446887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446892">case</span>&nbsp;<span class="string" id="3446897">&#39;&gt;&#39;</span><span class="op" id="3446900">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446906">w</span><span class="op" id="3446907">.</span><span class="ident" id="3446908">Write</span><span class="op" id="3446913">(</span><span class="ident" id="3446914">jsGt</span><span class="op" id="3446918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3446923">default</span><span class="op" id="3446930">:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446936">w</span><span class="op" id="3446937">.</span><span class="ident" id="3446938">Write</span><span class="op" id="3446943">(</span><span class="ident" id="3446944">jsLowUni</span><span class="op" id="3446952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446958">t</span><span class="op" id="3446959">,</span>&nbsp;<span class="ident" id="3446961">b</span>&nbsp;<span class="op" id="3446963">:=</span>&nbsp;<span class="ident" id="3446966">c</span><span class="op" id="3446967">&gt;&gt;</span><span class="num" id="3446969">4</span><span class="op" id="3446970">,</span>&nbsp;<span class="ident" id="3446972">c</span><span class="op" id="3446973">&amp;</span><span class="num" id="3446974">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3446983">w</span><span class="op" id="3446984">.</span><span class="ident" id="3446985">Write</span><span class="op" id="3446990">(</span><span class="ident" id="3446991">hex</span><span class="op" id="3446994">[</span><span class="ident" id="3446995">t</span>&nbsp;<span class="op" id="3446997">:</span>&nbsp;<span class="ident" id="3446999">t</span><span class="op" id="3447000">+</span><span class="num" id="3447001">1</span><span class="op" id="3447002">]</span><span class="op" id="3447003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447009">w</span><span class="op" id="3447010">.</span><span class="ident" id="3447011">Write</span><span class="op" id="3447016">(</span><span class="ident" id="3447017">hex</span><span class="op" id="3447020">[</span><span class="ident" id="3447021">b</span>&nbsp;<span class="op" id="3447023">:</span>&nbsp;<span class="ident" id="3447025">b</span><span class="op" id="3447026">+</span><span class="num" id="3447027">1</span><span class="op" id="3447028">]</span><span class="op" id="3447029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447034">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447038">}</span>&nbsp;<span class="keyword" id="3447040">else</span>&nbsp;<span class="op" id="3447045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3447050">//&nbsp;Unicode&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447070">r</span><span class="op" id="3447071">,</span>&nbsp;<span class="ident" id="3447073">size</span>&nbsp;<span class="op" id="3447078">:=</span>&nbsp;<span class="ident" id="3447081">utf8</span><span class="op" id="3447085">.</span><span class="ident" id="3447086">DecodeRune</span><span class="op" id="3447096">(</span><span class="ident" id="3447097">b</span><span class="op" id="3447098">[</span><span class="ident" id="3447099">i</span><span class="op" id="3447100">:</span><span class="op" id="3447101">]</span><span class="op" id="3447102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447107">if</span>&nbsp;<span class="ident" id="3447110">unicode</span><span class="op" id="3447117">.</span><span class="ident" id="3447118">IsPrint</span><span class="op" id="3447125">(</span><span class="ident" id="3447126">r</span><span class="op" id="3447127">)</span>&nbsp;<span class="op" id="3447129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447135">w</span><span class="op" id="3447136">.</span><span class="ident" id="3447137">Write</span><span class="op" id="3447142">(</span><span class="ident" id="3447143">b</span><span class="op" id="3447144">[</span><span class="ident" id="3447145">i</span>&nbsp;<span class="op" id="3447147">:</span>&nbsp;<span class="ident" id="3447149">i</span><span class="op" id="3447150">+</span><span class="ident" id="3447151">size</span><span class="op" id="3447155">]</span><span class="op" id="3447156">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447161">}</span>&nbsp;<span class="keyword" id="3447163">else</span>&nbsp;<span class="op" id="3447168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447174">fmt</span><span class="op" id="3447177">.</span><span class="ident" id="3447178">Fprintf</span><span class="op" id="3447185">(</span><span class="ident" id="3447186">w</span><span class="op" id="3447187">,</span>&nbsp;<span class="string" id="3447189">&#34;\\u%04X&#34;</span><span class="op" id="3447198">,</span>&nbsp;<span class="ident" id="3447200">r</span><span class="op" id="3447201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447211">i</span>&nbsp;<span class="op" id="3447213">+=</span>&nbsp;<span class="ident" id="3447216">size</span>&nbsp;<span class="op" id="3447221">-</span>&nbsp;<span class="num" id="3447223">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447227">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447231">last</span>&nbsp;<span class="op" id="3447236">=</span>&nbsp;<span class="ident" id="3447238">i</span>&nbsp;<span class="op" id="3447240">+</span>&nbsp;<span class="num" id="3447242">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447248">w</span><span class="op" id="3447249">.</span><span class="ident" id="3447250">Write</span><span class="op" id="3447255">(</span><span class="ident" id="3447256">b</span><span class="op" id="3447257">[</span><span class="ident" id="3447258">last</span><span class="op" id="3447262">:</span><span class="op" id="3447263">]</span><span class="op" id="3447264">)</span><br>
<span class="lineno"></span><span class="op" id="3447266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="3447269">//&nbsp;JSEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="3447355">func</span>&nbsp;<span class="ident" id="3447360">JSEscapeString</span><span class="op" id="3447374">(</span><span class="ident" id="3447375">s</span>&nbsp;<span class="builtintype" id="3447377">string</span><span class="op" id="3447383">)</span>&nbsp;<span class="builtintype" id="3447385">string</span>&nbsp;<span class="op" id="3447392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3447395">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447427">if</span>&nbsp;<span class="ident" id="3447430">strings</span><span class="op" id="3447437">.</span><span class="ident" id="3447438">IndexFunc</span><span class="op" id="3447447">(</span><span class="ident" id="3447448">s</span><span class="op" id="3447449">,</span>&nbsp;<span class="ident" id="3447451">jsIsSpecial</span><span class="op" id="3447462">)</span>&nbsp;<span class="op" id="3447464">&lt;</span>&nbsp;<span class="num" id="3447466">0</span>&nbsp;<span class="op" id="3447468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447472">return</span>&nbsp;<span class="ident" id="3447479">s</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447485">var</span>&nbsp;<span class="ident" id="3447489">b</span>&nbsp;<span class="ident" id="3447491">bytes</span><span class="op" id="3447496">.</span><span class="ident" id="3447497">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3447505">JSEscape</span><span class="op" id="3447513">(</span><span class="op" id="3447514">&amp;</span><span class="ident" id="3447515">b</span><span class="op" id="3447516">,</span>&nbsp;<span class="op" id="3447518">[</span><span class="op" id="3447519">]</span><span class="builtintype" id="3447520">byte</span><span class="op" id="3447524">(</span><span class="ident" id="3447525">s</span><span class="op" id="3447526">)</span><span class="op" id="3447527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447530">return</span>&nbsp;<span class="ident" id="3447537">b</span><span class="op" id="3447538">.</span><span class="ident" id="3447539">String</span><span class="op" id="3447545">(</span><span class="op" id="3447546">)</span><br>
<span class="lineno"></span><span class="op" id="3447548">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="3447551">func</span>&nbsp;<span class="ident" id="3447556">jsIsSpecial</span><span class="op" id="3447567">(</span><span class="ident" id="3447568">r</span>&nbsp;<span class="builtintype" id="3447570">rune</span><span class="op" id="3447574">)</span>&nbsp;<span class="builtintype" id="3447576">bool</span>&nbsp;<span class="op" id="3447581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447584">switch</span>&nbsp;<span class="ident" id="3447591">r</span>&nbsp;<span class="op" id="3447593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447596">case</span>&nbsp;<span class="string" id="3447601">&#39;\\&#39;</span><span class="op" id="3447605">,</span>&nbsp;<span class="string" id="3447607">&#39;\&#39;&#39;</span><span class="op" id="3447611">,</span>&nbsp;<span class="string" id="3447613">&#39;&#34;&#39;</span><span class="op" id="3447616">,</span>&nbsp;<span class="string" id="3447618">&#39;&lt;&#39;</span><span class="op" id="3447621">,</span>&nbsp;<span class="string" id="3447623">&#39;&gt;&#39;</span><span class="op" id="3447626">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447630">return</span>&nbsp;<span class="builtintype" id="3447637">true</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3447643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447646">return</span>&nbsp;<span class="ident" id="3447653">r</span>&nbsp;<span class="op" id="3447655">&lt;</span>&nbsp;<span class="string" id="3447657">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3447661">||</span>&nbsp;<span class="ident" id="3447664">utf8</span><span class="op" id="3447668">.</span><span class="ident" id="3447669">RuneSelf</span>&nbsp;<span class="op" id="3447678">&lt;=</span>&nbsp;<span class="ident" id="3447681">r</span><br>
<span class="lineno"></span><span class="op" id="3447683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3447686">//&nbsp;JSEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">565</span><span class="comment" id="3447756">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="3447792">func</span>&nbsp;<span class="ident" id="3447797">JSEscaper</span><span class="op" id="3447806">(</span><span class="ident" id="3447807">args</span>&nbsp;<span class="op" id="3447812">...</span><span class="keyword" id="3447815">interface</span><span class="op" id="3447824">{</span><span class="op" id="3447825">}</span><span class="op" id="3447826">)</span>&nbsp;<span class="builtintype" id="3447828">string</span>&nbsp;<span class="op" id="3447835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3447838">return</span>&nbsp;<span class="ident" id="3447845">JSEscapeString</span><span class="op" id="3447859">(</span><span class="ident" id="3447860">evalArgs</span><span class="op" id="3447868">(</span><span class="ident" id="3447869">args</span><span class="op" id="3447873">)</span><span class="op" id="3447874">)</span><br>
<span class="lineno"></span><span class="op" id="3447876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="comment" id="3447879">//&nbsp;URLQueryEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;value&nbsp;of&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3447957">//&nbsp;its&nbsp;arguments&nbsp;in&nbsp;a&nbsp;form&nbsp;suitable&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;URL&nbsp;query.</span><br>
<span class="lineno"></span><span class="keyword" id="3448023">func</span>&nbsp;<span class="ident" id="3448028">URLQueryEscaper</span><span class="op" id="3448043">(</span><span class="ident" id="3448044">args</span>&nbsp;<span class="op" id="3448049">...</span><span class="keyword" id="3448052">interface</span><span class="op" id="3448061">{</span><span class="op" id="3448062">}</span><span class="op" id="3448063">)</span>&nbsp;<span class="builtintype" id="3448065">string</span>&nbsp;<span class="op" id="3448072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448075">return</span>&nbsp;<span class="ident" id="3448082">url</span><span class="op" id="3448085">.</span><span class="ident" id="3448086">QueryEscape</span><span class="op" id="3448097">(</span><span class="ident" id="3448098">evalArgs</span><span class="op" id="3448106">(</span><span class="ident" id="3448107">args</span><span class="op" id="3448111">)</span><span class="op" id="3448112">)</span><br>
<span class="lineno"></span><span class="op" id="3448114">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3448117">//&nbsp;evalArgs&nbsp;formats&nbsp;the&nbsp;list&nbsp;of&nbsp;arguments&nbsp;into&nbsp;a&nbsp;string.&nbsp;It&nbsp;is&nbsp;therefore&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3448204">//&nbsp;&nbsp;&nbsp;&nbspfmt.Sprint(args...)</span><br>
<span class="lineno"></span><span class="comment" id="3448227">//&nbsp;except&nbsp;that&nbsp;each&nbsp;argument&nbsp;is&nbsp;indirected&nbsp;(if&nbsp;a&nbsp;pointer),&nbsp;as&nbsp;required,</span><br>
<span class="lineno"></span><span class="comment" id="3448299">//&nbsp;using&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;the&nbsp;default&nbsp;string&nbsp;evaluation&nbsp;during&nbsp;template</span><br>
<span class="lineno">580</span><span class="comment" id="3448372">//&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="3448386">func</span>&nbsp;<span class="ident" id="3448391">evalArgs</span><span class="op" id="3448399">(</span><span class="ident" id="3448400">args</span>&nbsp;<span class="op" id="3448405">[</span><span class="op" id="3448406">]</span><span class="keyword" id="3448407">interface</span><span class="op" id="3448416">{</span><span class="op" id="3448417">}</span><span class="op" id="3448418">)</span>&nbsp;<span class="builtintype" id="3448420">string</span>&nbsp;<span class="op" id="3448427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448430">ok</span>&nbsp;<span class="op" id="3448433">:=</span>&nbsp;<span class="builtintype" id="3448436">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448443">var</span>&nbsp;<span class="ident" id="3448447">s</span>&nbsp;<span class="builtintype" id="3448449">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3448457">//&nbsp;Fast&nbsp;path&nbsp;for&nbsp;simple&nbsp;common&nbsp;case.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448495">if</span>&nbsp;<span class="builtinfunc" id="3448498">len</span><span class="op" id="3448501">(</span><span class="ident" id="3448502">args</span><span class="op" id="3448506">)</span>&nbsp;<span class="op" id="3448508">==</span>&nbsp;<span class="num" id="3448511">1</span>&nbsp;<span class="op" id="3448513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448517">s</span><span class="op" id="3448518">,</span>&nbsp;<span class="ident" id="3448520">ok</span>&nbsp;<span class="op" id="3448523">=</span>&nbsp;<span class="ident" id="3448525">args</span><span class="op" id="3448529">[</span><span class="num" id="3448530">0</span><span class="op" id="3448531">]</span><span class="op" id="3448532">.</span><span class="op" id="3448533">(</span><span class="builtintype" id="3448534">string</span><span class="op" id="3448540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448546">if</span>&nbsp;<span class="op" id="3448549">!</span><span class="ident" id="3448550">ok</span>&nbsp;<span class="op" id="3448553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448557">for</span>&nbsp;<span class="ident" id="3448561">i</span><span class="op" id="3448562">,</span>&nbsp;<span class="ident" id="3448564">arg</span>&nbsp;<span class="op" id="3448568">:=</span>&nbsp;<span class="keyword" id="3448571">range</span>&nbsp;<span class="ident" id="3448577">args</span>&nbsp;<span class="op" id="3448582">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448587">a</span><span class="op" id="3448588">,</span>&nbsp;<span class="ident" id="3448590">ok</span>&nbsp;<span class="op" id="3448593">:=</span>&nbsp;<span class="ident" id="3448596">printableValue</span><span class="op" id="3448610">(</span><span class="ident" id="3448611">reflect</span><span class="op" id="3448618">.</span><span class="ident" id="3448619">ValueOf</span><span class="op" id="3448626">(</span><span class="ident" id="3448627">arg</span><span class="op" id="3448630">)</span><span class="op" id="3448631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448636">if</span>&nbsp;<span class="ident" id="3448639">ok</span>&nbsp;<span class="op" id="3448642">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448648">args</span><span class="op" id="3448652">[</span><span class="ident" id="3448653">i</span><span class="op" id="3448654">]</span>&nbsp;<span class="op" id="3448656">=</span>&nbsp;<span class="ident" id="3448658">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448663">}</span>&nbsp;<span class="comment" id="3448665">//&nbsp;else&nbsp;left&nbsp;fmt&nbsp;do&nbsp;its&nbsp;thing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448697">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3448701">s</span>&nbsp;<span class="op" id="3448703">=</span>&nbsp;<span class="ident" id="3448705">fmt</span><span class="op" id="3448708">.</span><span class="ident" id="3448709">Sprint</span><span class="op" id="3448715">(</span><span class="ident" id="3448716">args</span><span class="op" id="3448720">...</span><span class="op" id="3448723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3448726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3448729">return</span>&nbsp;<span class="ident" id="3448736">s</span><br>
<span class="lineno"></span><span class="op" id="3448738">}</span>
</div>
</body>
</html>
