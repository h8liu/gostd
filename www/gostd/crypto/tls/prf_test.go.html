<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html" class="current">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6549813">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6549868">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6549922">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6549973">package</span>&nbsp;<span class="ident" id="6549981">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6549986">import</span>&nbsp;<span class="op" id="6549993">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6549996">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6550012">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6550022">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6550025">type</span>&nbsp;<span class="ident" id="6550030">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="6550059">struct</span>&nbsp;<span class="op" id="6550066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550069">in</span><span class="op" id="6550071">,</span>&nbsp;<span class="ident" id="6550073">out1</span><span class="op" id="6550077">,</span>&nbsp;<span class="ident" id="6550079">out2</span>&nbsp;<span class="builtintype" id="6550084">string</span><br>
<span class="lineno"></span><span class="op" id="6550091">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6550094">var</span>&nbsp;<span class="ident" id="6550098">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6550128">=</span>&nbsp;<span class="op" id="6550130">[</span><span class="op" id="6550131">]</span><span class="ident" id="6550132">testSplitPreMasterSecretTest</span><span class="op" id="6550160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550163">{</span><span class="string" id="6550164">&#34;&#34;</span><span class="op" id="6550166">,</span>&nbsp;<span class="string" id="6550168">&#34;&#34;</span><span class="op" id="6550170">,</span>&nbsp;<span class="string" id="6550172">&#34;&#34;</span><span class="op" id="6550174">}</span><span class="op" id="6550175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550178">{</span><span class="string" id="6550179">&#34;00&#34;</span><span class="op" id="6550183">,</span>&nbsp;<span class="string" id="6550185">&#34;00&#34;</span><span class="op" id="6550189">,</span>&nbsp;<span class="string" id="6550191">&#34;00&#34;</span><span class="op" id="6550195">}</span><span class="op" id="6550196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550199">{</span><span class="string" id="6550200">&#34;0011&#34;</span><span class="op" id="6550206">,</span>&nbsp;<span class="string" id="6550208">&#34;00&#34;</span><span class="op" id="6550212">,</span>&nbsp;<span class="string" id="6550214">&#34;11&#34;</span><span class="op" id="6550218">}</span><span class="op" id="6550219">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550222">{</span><span class="string" id="6550223">&#34;001122&#34;</span><span class="op" id="6550231">,</span>&nbsp;<span class="string" id="6550233">&#34;0011&#34;</span><span class="op" id="6550239">,</span>&nbsp;<span class="string" id="6550241">&#34;1122&#34;</span><span class="op" id="6550247">}</span><span class="op" id="6550248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550251">{</span><span class="string" id="6550252">&#34;00112233&#34;</span><span class="op" id="6550262">,</span>&nbsp;<span class="string" id="6550264">&#34;0011&#34;</span><span class="op" id="6550270">,</span>&nbsp;<span class="string" id="6550272">&#34;2233&#34;</span><span class="op" id="6550278">}</span><span class="op" id="6550279">,</span><br>
<span class="lineno"></span><span class="op" id="6550281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6550284">func</span>&nbsp;<span class="ident" id="6550289">TestSplitPreMasterSecret</span><span class="op" id="6550313">(</span><span class="ident" id="6550314">t</span>&nbsp;<span class="op" id="6550316">*</span><span class="ident" id="6550317">testing</span><span class="op" id="6550324">.</span><span class="ident" id="6550325">T</span><span class="op" id="6550326">)</span>&nbsp;<span class="op" id="6550328">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6550331">for</span>&nbsp;<span class="ident" id="6550335">i</span><span class="op" id="6550336">,</span>&nbsp;<span class="ident" id="6550338">test</span>&nbsp;<span class="op" id="6550343">:=</span>&nbsp;<span class="keyword" id="6550346">range</span>&nbsp;<span class="ident" id="6550352">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="6550382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550386">in</span><span class="op" id="6550388">,</span>&nbsp;<span class="ident" id="6550390">_</span>&nbsp;<span class="op" id="6550392">:=</span>&nbsp;<span class="ident" id="6550395">hex</span><span class="op" id="6550398">.</span><span class="ident" id="6550399">DecodeString</span><span class="op" id="6550411">(</span><span class="ident" id="6550412">test</span><span class="op" id="6550416">.</span><span class="ident" id="6550417">in</span><span class="op" id="6550419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550423">out1</span><span class="op" id="6550427">,</span>&nbsp;<span class="ident" id="6550429">out2</span>&nbsp;<span class="op" id="6550434">:=</span>&nbsp;<span class="ident" id="6550437">splitPreMasterSecret</span><span class="op" id="6550457">(</span><span class="ident" id="6550458">in</span><span class="op" id="6550460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550464">s1</span>&nbsp;<span class="op" id="6550467">:=</span>&nbsp;<span class="ident" id="6550470">hex</span><span class="op" id="6550473">.</span><span class="ident" id="6550474">EncodeToString</span><span class="op" id="6550488">(</span><span class="ident" id="6550489">out1</span><span class="op" id="6550493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550497">s2</span>&nbsp;<span class="op" id="6550500">:=</span>&nbsp;<span class="ident" id="6550503">hex</span><span class="op" id="6550506">.</span><span class="ident" id="6550507">EncodeToString</span><span class="op" id="6550521">(</span><span class="ident" id="6550522">out2</span><span class="op" id="6550526">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6550530">if</span>&nbsp;<span class="ident" id="6550533">s1</span>&nbsp;<span class="op" id="6550536">!=</span>&nbsp;<span class="ident" id="6550539">test</span><span class="op" id="6550543">.</span><span class="ident" id="6550544">out1</span>&nbsp;<span class="op" id="6550549">||</span>&nbsp;<span class="ident" id="6550552">s2</span>&nbsp;<span class="op" id="6550555">!=</span>&nbsp;<span class="ident" id="6550558">test</span><span class="op" id="6550562">.</span><span class="ident" id="6550563">out2</span>&nbsp;<span class="op" id="6550568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550573">t</span><span class="op" id="6550574">.</span><span class="ident" id="6550575">Errorf</span><span class="op" id="6550581">(</span><span class="string" id="6550582">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="6550617">,</span>&nbsp;<span class="ident" id="6550619">i</span><span class="op" id="6550620">,</span>&nbsp;<span class="ident" id="6550622">s1</span><span class="op" id="6550624">,</span>&nbsp;<span class="ident" id="6550626">s2</span><span class="op" id="6550628">,</span>&nbsp;<span class="ident" id="6550630">test</span><span class="op" id="6550634">.</span><span class="ident" id="6550635">out1</span><span class="op" id="6550639">,</span>&nbsp;<span class="ident" id="6550641">test</span><span class="op" id="6550645">.</span><span class="ident" id="6550646">out2</span><span class="op" id="6550650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6550657">}</span><br>
<span class="lineno"></span><span class="op" id="6550659">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6550662">type</span>&nbsp;<span class="ident" id="6550667">testKeysFromTest</span>&nbsp;<span class="keyword" id="6550684">struct</span>&nbsp;<span class="op" id="6550691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550694">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550721">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550729">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550756">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550764">clientRandom</span><span class="op" id="6550776">,</span>&nbsp;<span class="ident" id="6550778">serverRandom</span>&nbsp;<span class="builtintype" id="6550791">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550799">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550826">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550834">clientMAC</span><span class="op" id="6550843">,</span>&nbsp;<span class="ident" id="6550845">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550861">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550869">clientKey</span><span class="op" id="6550878">,</span>&nbsp;<span class="ident" id="6550880">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550896">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6550904">macLen</span><span class="op" id="6550910">,</span>&nbsp;<span class="ident" id="6550912">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6550931">int</span><br>
<span class="lineno"></span><span class="op" id="6550935">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6550938">func</span>&nbsp;<span class="ident" id="6550943">TestKeysFromPreMasterSecret</span><span class="op" id="6550970">(</span><span class="ident" id="6550971">t</span>&nbsp;<span class="op" id="6550973">*</span><span class="ident" id="6550974">testing</span><span class="op" id="6550981">.</span><span class="ident" id="6550982">T</span><span class="op" id="6550983">)</span>&nbsp;<span class="op" id="6550985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6550988">for</span>&nbsp;<span class="ident" id="6550992">i</span><span class="op" id="6550993">,</span>&nbsp;<span class="ident" id="6550995">test</span>&nbsp;<span class="op" id="6551000">:=</span>&nbsp;<span class="keyword" id="6551003">range</span>&nbsp;<span class="ident" id="6551009">testKeysFromTests</span>&nbsp;<span class="op" id="6551027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551031">in</span><span class="op" id="6551033">,</span>&nbsp;<span class="ident" id="6551035">_</span>&nbsp;<span class="op" id="6551037">:=</span>&nbsp;<span class="ident" id="6551040">hex</span><span class="op" id="6551043">.</span><span class="ident" id="6551044">DecodeString</span><span class="op" id="6551056">(</span><span class="ident" id="6551057">test</span><span class="op" id="6551061">.</span><span class="ident" id="6551062">preMasterSecret</span><span class="op" id="6551077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551081">clientRandom</span><span class="op" id="6551093">,</span>&nbsp;<span class="ident" id="6551095">_</span>&nbsp;<span class="op" id="6551097">:=</span>&nbsp;<span class="ident" id="6551100">hex</span><span class="op" id="6551103">.</span><span class="ident" id="6551104">DecodeString</span><span class="op" id="6551116">(</span><span class="ident" id="6551117">test</span><span class="op" id="6551121">.</span><span class="ident" id="6551122">clientRandom</span><span class="op" id="6551134">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551138">serverRandom</span><span class="op" id="6551150">,</span>&nbsp;<span class="ident" id="6551152">_</span>&nbsp;<span class="op" id="6551154">:=</span>&nbsp;<span class="ident" id="6551157">hex</span><span class="op" id="6551160">.</span><span class="ident" id="6551161">DecodeString</span><span class="op" id="6551173">(</span><span class="ident" id="6551174">test</span><span class="op" id="6551178">.</span><span class="ident" id="6551179">serverRandom</span><span class="op" id="6551191">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551196">masterSecret</span>&nbsp;<span class="op" id="6551209">:=</span>&nbsp;<span class="ident" id="6551212">masterFromPreMasterSecret</span><span class="op" id="6551237">(</span><span class="ident" id="6551238">test</span><span class="op" id="6551242">.</span><span class="ident" id="6551243">version</span><span class="op" id="6551250">,</span>&nbsp;<span class="ident" id="6551252">in</span><span class="op" id="6551254">,</span>&nbsp;<span class="ident" id="6551256">clientRandom</span><span class="op" id="6551268">,</span>&nbsp;<span class="ident" id="6551270">serverRandom</span><span class="op" id="6551282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6551286">if</span>&nbsp;<span class="ident" id="6551289">s</span>&nbsp;<span class="op" id="6551291">:=</span>&nbsp;<span class="ident" id="6551294">hex</span><span class="op" id="6551297">.</span><span class="ident" id="6551298">EncodeToString</span><span class="op" id="6551312">(</span><span class="ident" id="6551313">masterSecret</span><span class="op" id="6551325">)</span><span class="op" id="6551326">;</span>&nbsp;<span class="ident" id="6551328">s</span>&nbsp;<span class="op" id="6551330">!=</span>&nbsp;<span class="ident" id="6551333">test</span><span class="op" id="6551337">.</span><span class="ident" id="6551338">masterSecret</span>&nbsp;<span class="op" id="6551351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551356">t</span><span class="op" id="6551357">.</span><span class="ident" id="6551358">Errorf</span><span class="op" id="6551364">(</span><span class="string" id="6551365">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6551401">,</span>&nbsp;<span class="ident" id="6551403">i</span><span class="op" id="6551404">,</span>&nbsp;<span class="ident" id="6551406">s</span><span class="op" id="6551407">,</span>&nbsp;<span class="ident" id="6551409">test</span><span class="op" id="6551413">.</span><span class="ident" id="6551414">masterSecret</span><span class="op" id="6551426">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6551431">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6551442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551447">clientMAC</span><span class="op" id="6551456">,</span>&nbsp;<span class="ident" id="6551458">serverMAC</span><span class="op" id="6551467">,</span>&nbsp;<span class="ident" id="6551469">clientKey</span><span class="op" id="6551478">,</span>&nbsp;<span class="ident" id="6551480">serverKey</span><span class="op" id="6551489">,</span>&nbsp;<span class="ident" id="6551491">_</span><span class="op" id="6551492">,</span>&nbsp;<span class="ident" id="6551494">_</span>&nbsp;<span class="op" id="6551496">:=</span>&nbsp;<span class="ident" id="6551499">keysFromMasterSecret</span><span class="op" id="6551519">(</span><span class="ident" id="6551520">test</span><span class="op" id="6551524">.</span><span class="ident" id="6551525">version</span><span class="op" id="6551532">,</span>&nbsp;<span class="ident" id="6551534">masterSecret</span><span class="op" id="6551546">,</span>&nbsp;<span class="ident" id="6551548">clientRandom</span><span class="op" id="6551560">,</span>&nbsp;<span class="ident" id="6551562">serverRandom</span><span class="op" id="6551574">,</span>&nbsp;<span class="ident" id="6551576">test</span><span class="op" id="6551580">.</span><span class="ident" id="6551581">macLen</span><span class="op" id="6551587">,</span>&nbsp;<span class="ident" id="6551589">test</span><span class="op" id="6551593">.</span><span class="ident" id="6551594">keyLen</span><span class="op" id="6551600">,</span>&nbsp;<span class="num" id="6551602">0</span><span class="op" id="6551603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551607">clientMACString</span>&nbsp;<span class="op" id="6551623">:=</span>&nbsp;<span class="ident" id="6551626">hex</span><span class="op" id="6551629">.</span><span class="ident" id="6551630">EncodeToString</span><span class="op" id="6551644">(</span><span class="ident" id="6551645">clientMAC</span><span class="op" id="6551654">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551658">serverMACString</span>&nbsp;<span class="op" id="6551674">:=</span>&nbsp;<span class="ident" id="6551677">hex</span><span class="op" id="6551680">.</span><span class="ident" id="6551681">EncodeToString</span><span class="op" id="6551695">(</span><span class="ident" id="6551696">serverMAC</span><span class="op" id="6551705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551709">clientKeyString</span>&nbsp;<span class="op" id="6551725">:=</span>&nbsp;<span class="ident" id="6551728">hex</span><span class="op" id="6551731">.</span><span class="ident" id="6551732">EncodeToString</span><span class="op" id="6551746">(</span><span class="ident" id="6551747">clientKey</span><span class="op" id="6551756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551760">serverKeyString</span>&nbsp;<span class="op" id="6551776">:=</span>&nbsp;<span class="ident" id="6551779">hex</span><span class="op" id="6551782">.</span><span class="ident" id="6551783">EncodeToString</span><span class="op" id="6551797">(</span><span class="ident" id="6551798">serverKey</span><span class="op" id="6551807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6551811">if</span>&nbsp;<span class="ident" id="6551814">clientMACString</span>&nbsp;<span class="op" id="6551830">!=</span>&nbsp;<span class="ident" id="6551833">test</span><span class="op" id="6551837">.</span><span class="ident" id="6551838">clientMAC</span>&nbsp;<span class="op" id="6551848">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551854">serverMACString</span>&nbsp;<span class="op" id="6551870">!=</span>&nbsp;<span class="ident" id="6551873">test</span><span class="op" id="6551877">.</span><span class="ident" id="6551878">serverMAC</span>&nbsp;<span class="op" id="6551888">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551894">clientKeyString</span>&nbsp;<span class="op" id="6551910">!=</span>&nbsp;<span class="ident" id="6551913">test</span><span class="op" id="6551917">.</span><span class="ident" id="6551918">clientKey</span>&nbsp;<span class="op" id="6551928">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551934">serverKeyString</span>&nbsp;<span class="op" id="6551950">!=</span>&nbsp;<span class="ident" id="6551953">test</span><span class="op" id="6551957">.</span><span class="ident" id="6551958">serverKey</span>&nbsp;<span class="op" id="6551968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6551973">t</span><span class="op" id="6551974">.</span><span class="ident" id="6551975">Errorf</span><span class="op" id="6551981">(</span><span class="string" id="6551982">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="6552033">,</span>&nbsp;<span class="ident" id="6552035">i</span><span class="op" id="6552036">,</span>&nbsp;<span class="ident" id="6552038">clientMACString</span><span class="op" id="6552053">,</span>&nbsp;<span class="ident" id="6552055">serverMACString</span><span class="op" id="6552070">,</span>&nbsp;<span class="ident" id="6552072">clientKeyString</span><span class="op" id="6552087">,</span>&nbsp;<span class="ident" id="6552089">serverKeyString</span><span class="op" id="6552104">,</span>&nbsp;<span class="ident" id="6552106">test</span><span class="op" id="6552110">.</span><span class="ident" id="6552111">clientMAC</span><span class="op" id="6552120">,</span>&nbsp;<span class="ident" id="6552122">test</span><span class="op" id="6552126">.</span><span class="ident" id="6552127">serverMAC</span><span class="op" id="6552136">,</span>&nbsp;<span class="ident" id="6552138">test</span><span class="op" id="6552142">.</span><span class="ident" id="6552143">clientKey</span><span class="op" id="6552152">,</span>&nbsp;<span class="ident" id="6552154">test</span><span class="op" id="6552158">.</span><span class="ident" id="6552159">serverKey</span><span class="op" id="6552168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6552172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6552175">}</span><br>
<span class="lineno">70</span><span class="op" id="6552177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6552180">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="6552265">var</span>&nbsp;<span class="ident" id="6552269">testKeysFromTests</span>&nbsp;<span class="op" id="6552287">=</span>&nbsp;<span class="op" id="6552289">[</span><span class="op" id="6552290">]</span><span class="ident" id="6552291">testKeysFromTest</span><span class="op" id="6552307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6552310">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6552314">VersionTLS10</span><span class="op" id="6552326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552330">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="6552428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552432">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="6552498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552502">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="6552568">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552572">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="6552670">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552674">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="6552716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552720">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="6552762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552766">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="6552800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552804">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="6552838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6552842">20</span><span class="op" id="6552844">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6552848">16</span><span class="op" id="6552850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6552853">}</span><span class="op" id="6552854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6552857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6552861">VersionTLS10</span><span class="op" id="6552873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552877">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="6552975">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6552979">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="6553045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553049">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="6553115">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553119">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="6553217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553221">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="6553263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553267">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="6553309">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553313">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="6553347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553351">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="6553385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6553389">20</span><span class="op" id="6553391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6553395">16</span><span class="op" id="6553397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6553400">}</span><span class="op" id="6553401">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6553404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6553408">VersionTLS10</span><span class="op" id="6553420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553424">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6553682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553686">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6553752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553756">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6553822">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553826">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="6553924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553928">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="6553970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6553974">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="6554016">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554020">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="6554054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554058">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="6554092">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6554096">20</span><span class="op" id="6554098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6554102">16</span><span class="op" id="6554104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6554107">}</span><span class="op" id="6554108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6554111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6554115">VersionSSL30</span><span class="op" id="6554127">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554131">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="6554389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554393">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="6554459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554463">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="6554529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554533">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="6554631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554635">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="6554677">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554681">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="6554723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554727">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="6554761">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6554765">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="6554799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6554803">20</span><span class="op" id="6554805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6554809">16</span><span class="op" id="6554811">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6554814">}</span><span class="op" id="6554815">,</span><br>
<span class="lineno"></span><span class="op" id="6554817">}</span>
</div>
</body>
</html>
