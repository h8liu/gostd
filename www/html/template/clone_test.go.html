<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8588991">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8589046">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8589100">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8589151">package</span>&nbsp;<span class="ident" id="8589159">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8589169">import</span>&nbsp;<span class="op" id="8589176">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8589179">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8589188">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8589198">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8589211">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8589222">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="8589244">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="8589247">func</span>&nbsp;<span class="ident" id="8589252">TestAddParseTree</span><span class="op" id="8589268">(</span><span class="ident" id="8589269">t</span>&nbsp;<span class="op" id="8589271">*</span><span class="ident" id="8589272"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8589279">.</span><span class="ident" id="8589280">T</span><span class="op" id="8589281">)</span>&nbsp;<span class="op" id="8589283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589286">root</span>&nbsp;<span class="op" id="8589291">:=</span>&nbsp;<span class="ident" id="8589294"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8589298">(</span><span class="ident" id="8589299"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8589302">(</span><span class="string" id="8589303">&#34;root&#34;</span><span class="op" id="8589309">)</span><span class="op" id="8589310">.</span><span class="ident" id="8589311">Parse</span><span class="op" id="8589316">(</span><span class="string" id="8589317">`{{define&nbsp;&#34;a&#34;}}&nbsp;{{.}}&nbsp;{{template&nbsp;&#34;b&#34;}}&nbsp;{{.}}&nbsp;&#34;&gt;&lt;/a&gt;{{end}}`</span><span class="op" id="8589376">)</span><span class="op" id="8589377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589380">tree</span><span class="op" id="8589384">,</span>&nbsp;<span class="ident" id="8589386">err</span>&nbsp;<span class="op" id="8589390">:=</span>&nbsp;<span class="ident" id="8589393"><a href="/html/template/clone_test.go.html#8589222">parse</a></span><span class="op" id="8589398">.</span><span class="ident" id="8589399">Parse</span><span class="op" id="8589404">(</span><span class="string" id="8589405">&#34;t&#34;</span><span class="op" id="8589408">,</span>&nbsp;<span class="string" id="8589410">`{{define&nbsp;&#34;b&#34;}}&lt;a&nbsp;href=&#34;{{end}}`</span><span class="op" id="8589442">,</span>&nbsp;<span class="string" id="8589444">&#34;&#34;</span><span class="op" id="8589446">,</span>&nbsp;<span class="string" id="8589448">&#34;&#34;</span><span class="op" id="8589450">,</span>&nbsp;<span class="ident" id="8589452">nil</span><span class="op" id="8589455">,</span>&nbsp;<span class="ident" id="8589457">nil</span><span class="op" id="8589460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8589463">if</span>&nbsp;<span class="ident" id="8589466"><a href="/html/template/clone_test.go.html#8589386">err</a></span>&nbsp;<span class="op" id="8589470">!=</span>&nbsp;<span class="ident" id="8589473">nil</span>&nbsp;<span class="op" id="8589477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589481"><a href="/html/template/clone_test.go.html#8589269">t</a></span><span class="op" id="8589482">.</span><span class="ident" id="8589483">Fatal</span><span class="op" id="8589488">(</span><span class="ident" id="8589489"><a href="/html/template/clone_test.go.html#8589386">err</a></span><span class="op" id="8589492">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8589495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589498">added</span>&nbsp;<span class="op" id="8589504">:=</span>&nbsp;<span class="ident" id="8589507"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8589511">(</span><span class="ident" id="8589512"><a href="/html/template/clone_test.go.html#8589286">root</a></span><span class="op" id="8589516">.</span><span class="ident" id="8589517">AddParseTree</span><span class="op" id="8589529">(</span><span class="string" id="8589530">&#34;b&#34;</span><span class="op" id="8589533">,</span>&nbsp;<span class="ident" id="8589535"><a href="/html/template/clone_test.go.html#8589380">tree</a></span><span class="op" id="8589539">[</span><span class="string" id="8589540">&#34;b&#34;</span><span class="op" id="8589543">]</span><span class="op" id="8589544">)</span><span class="op" id="8589545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589548">b</span>&nbsp;<span class="op" id="8589550">:=</span>&nbsp;<span class="builtinfunc" id="8589553">new</span><span class="op" id="8589556">(</span><span class="ident" id="8589557"><a href="/html/template/clone_test.go.html#8589179">bytes</a></span><span class="op" id="8589562">.</span><span class="ident" id="8589563">Buffer</span><span class="op" id="8589569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589572"><a href="/html/template/clone_test.go.html#8589386">err</a></span>&nbsp;<span class="op" id="8589576">=</span>&nbsp;<span class="ident" id="8589578"><a href="/html/template/clone_test.go.html#8589498">added</a></span><span class="op" id="8589583">.</span><span class="ident" id="8589584">ExecuteTemplate</span><span class="op" id="8589599">(</span><span class="ident" id="8589600"><a href="/html/template/clone_test.go.html#8589548">b</a></span><span class="op" id="8589601">,</span>&nbsp;<span class="string" id="8589603">&#34;a&#34;</span><span class="op" id="8589606">,</span>&nbsp;<span class="string" id="8589608">&#34;1&gt;0&#34;</span><span class="op" id="8589613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8589616">if</span>&nbsp;<span class="ident" id="8589619"><a href="/html/template/clone_test.go.html#8589386">err</a></span>&nbsp;<span class="op" id="8589623">!=</span>&nbsp;<span class="ident" id="8589626">nil</span>&nbsp;<span class="op" id="8589630">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589634"><a href="/html/template/clone_test.go.html#8589269">t</a></span><span class="op" id="8589635">.</span><span class="ident" id="8589636">Fatal</span><span class="op" id="8589641">(</span><span class="ident" id="8589642"><a href="/html/template/clone_test.go.html#8589386">err</a></span><span class="op" id="8589645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8589648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8589651">if</span>&nbsp;<span class="ident" id="8589654">got</span><span class="op" id="8589657">,</span>&nbsp;<span class="ident" id="8589659">want</span>&nbsp;<span class="op" id="8589664">:=</span>&nbsp;<span class="ident" id="8589667"><a href="/html/template/clone_test.go.html#8589548">b</a></span><span class="op" id="8589668">.</span><span class="ident" id="8589669">String</span><span class="op" id="8589675">(</span><span class="op" id="8589676">)</span><span class="op" id="8589677">,</span>&nbsp;<span class="string" id="8589679">`&nbsp;1&amp;gt;0&nbsp;&lt;a&nbsp;href=&#34;&nbsp;1%3e0&nbsp;&#34;&gt;&lt;/a&gt;`</span><span class="op" id="8589711">;</span>&nbsp;<span class="ident" id="8589713"><a href="/html/template/clone_test.go.html#8589654">got</a></span>&nbsp;<span class="op" id="8589717">!=</span>&nbsp;<span class="ident" id="8589720"><a href="/html/template/clone_test.go.html#8589659">want</a></span>&nbsp;<span class="op" id="8589725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8589729"><a href="/html/template/clone_test.go.html#8589269">t</a></span><span class="op" id="8589730">.</span><span class="ident" id="8589731">Errorf</span><span class="op" id="8589737">(</span><span class="string" id="8589738">&#34;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8589754">,</span>&nbsp;<span class="ident" id="8589756"><a href="/html/template/clone_test.go.html#8589654">got</a></span><span class="op" id="8589759">,</span>&nbsp;<span class="ident" id="8589761"><a href="/html/template/clone_test.go.html#8589659">want</a></span><span class="op" id="8589765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8589768">}</span><br>
<span class="lineno">30</span><span class="op" id="8589770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8589773">func</span>&nbsp;<span class="ident" id="8589778">TestClone</span><span class="op" id="8589787">(</span><span class="ident" id="8589788">t</span>&nbsp;<span class="op" id="8589790">*</span><span class="ident" id="8589791"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8589798">.</span><span class="ident" id="8589799">T</span><span class="op" id="8589800">)</span>&nbsp;<span class="op" id="8589802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8589805">//&nbsp;The&nbsp;{{.}}&nbsp;will&nbsp;be&nbsp;executed&nbsp;with&nbsp;data&nbsp;&#34;&lt;i&gt;*/&#34;&nbsp;in&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8589877">//&nbsp;In&nbsp;the&nbsp;t0&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;text&nbsp;context.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8589931">//&nbsp;In&nbsp;the&nbsp;t1&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;URL&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8589984">//&nbsp;In&nbsp;the&nbsp;t2&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;JavaScript&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590044">//&nbsp;In&nbsp;the&nbsp;t3&nbsp;template,&nbsp;it&nbsp;will&nbsp;be&nbsp;in&nbsp;a&nbsp;CSS&nbsp;context.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8590097">const</span>&nbsp;<span class="ident" id="8590103">tmpl</span>&nbsp;<span class="op" id="8590108">=</span>&nbsp;<span class="string" id="8590110">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590176">b</span>&nbsp;<span class="op" id="8590178">:=</span>&nbsp;<span class="builtinfunc" id="8590181">new</span><span class="op" id="8590184">(</span><span class="ident" id="8590185"><a href="/html/template/clone_test.go.html#8589179">bytes</a></span><span class="op" id="8590190">.</span><span class="ident" id="8590191">Buffer</span><span class="op" id="8590197">)</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590201">//&nbsp;Create&nbsp;an&nbsp;incomplete&nbsp;template&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590239">t0</span>&nbsp;<span class="op" id="8590242">:=</span>&nbsp;<span class="ident" id="8590245"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590249">(</span><span class="ident" id="8590250"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8590253">(</span><span class="string" id="8590254">&#34;t0&#34;</span><span class="op" id="8590258">)</span><span class="op" id="8590259">.</span><span class="ident" id="8590260">Parse</span><span class="op" id="8590265">(</span><span class="ident" id="8590266"><a href="/html/template/clone_test.go.html#8590103">tmpl</a></span><span class="op" id="8590270">)</span><span class="op" id="8590271">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590275">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t1.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590295">t1</span>&nbsp;<span class="op" id="8590298">:=</span>&nbsp;<span class="ident" id="8590301"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590305">(</span><span class="ident" id="8590306"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8590308">.</span><span class="ident" id="8590309">Clone</span><span class="op" id="8590314">(</span><span class="op" id="8590315">)</span><span class="op" id="8590316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590319"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590323">(</span><span class="ident" id="8590324"><a href="/html/template/clone_test.go.html#8590295">t1</a></span><span class="op" id="8590326">.</span><span class="ident" id="8590327">Parse</span><span class="op" id="8590332">(</span><span class="string" id="8590333">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}`</span><span class="op" id="8590369">)</span><span class="op" id="8590370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590373"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590377">(</span><span class="ident" id="8590378"><a href="/html/template/clone_test.go.html#8590295">t1</a></span><span class="op" id="8590380">.</span><span class="ident" id="8590381">Parse</span><span class="op" id="8590386">(</span><span class="string" id="8590387">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><span class="op" id="8590420">)</span><span class="op" id="8590421">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590425">//&nbsp;Execute&nbsp;t1.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590441"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590442">.</span><span class="ident" id="8590443">Reset</span><span class="op" id="8590448">(</span><span class="op" id="8590449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8590452">if</span>&nbsp;<span class="ident" id="8590455">err</span>&nbsp;<span class="op" id="8590459">:=</span>&nbsp;<span class="ident" id="8590462"><a href="/html/template/clone_test.go.html#8590295">t1</a></span><span class="op" id="8590464">.</span><span class="ident" id="8590465">ExecuteTemplate</span><span class="op" id="8590480">(</span><span class="ident" id="8590481"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590482">,</span>&nbsp;<span class="string" id="8590484">&#34;a&#34;</span><span class="op" id="8590487">,</span>&nbsp;<span class="string" id="8590489">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8590496">)</span><span class="op" id="8590497">;</span>&nbsp;<span class="ident" id="8590499"><a href="/html/template/clone_test.go.html#8590455">err</a></span>&nbsp;<span class="op" id="8590503">!=</span>&nbsp;<span class="ident" id="8590506">nil</span>&nbsp;<span class="op" id="8590510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590514"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8590515">.</span><span class="ident" id="8590516">Fatal</span><span class="op" id="8590521">(</span><span class="ident" id="8590522"><a href="/html/template/clone_test.go.html#8590455">err</a></span><span class="op" id="8590525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8590528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8590531">if</span>&nbsp;<span class="ident" id="8590534">got</span><span class="op" id="8590537">,</span>&nbsp;<span class="ident" id="8590539">want</span>&nbsp;<span class="op" id="8590544">:=</span>&nbsp;<span class="ident" id="8590547"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590548">.</span><span class="ident" id="8590549">String</span><span class="op" id="8590555">(</span><span class="op" id="8590556">)</span><span class="op" id="8590557">,</span>&nbsp;<span class="string" id="8590559">`&nbsp;&lt;a&nbsp;href=&#34;&nbsp;%3ci%3e*/&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;`</span><span class="op" id="8590589">;</span>&nbsp;<span class="ident" id="8590591"><a href="/html/template/clone_test.go.html#8590534">got</a></span>&nbsp;<span class="op" id="8590595">!=</span>&nbsp;<span class="ident" id="8590598"><a href="/html/template/clone_test.go.html#8590539">want</a></span>&nbsp;<span class="op" id="8590603">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590607"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8590608">.</span><span class="ident" id="8590609">Errorf</span><span class="op" id="8590615">(</span><span class="string" id="8590616">&#34;t1:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8590636">,</span>&nbsp;<span class="ident" id="8590638"><a href="/html/template/clone_test.go.html#8590534">got</a></span><span class="op" id="8590641">,</span>&nbsp;<span class="ident" id="8590643"><a href="/html/template/clone_test.go.html#8590539">want</a></span><span class="op" id="8590647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8590650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590654">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590674">t2</span>&nbsp;<span class="op" id="8590677">:=</span>&nbsp;<span class="ident" id="8590680"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590684">(</span><span class="ident" id="8590685"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8590687">.</span><span class="ident" id="8590688">Clone</span><span class="op" id="8590693">(</span><span class="op" id="8590694">)</span><span class="op" id="8590695">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590698"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590702">(</span><span class="ident" id="8590703"><a href="/html/template/clone_test.go.html#8590674">t2</a></span><span class="op" id="8590705">.</span><span class="ident" id="8590706">Parse</span><span class="op" id="8590711">(</span><span class="string" id="8590712">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;{{end}}`</span><span class="op" id="8590762">)</span><span class="op" id="8590763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590766"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8590770">(</span><span class="ident" id="8590771"><a href="/html/template/clone_test.go.html#8590674">t2</a></span><span class="op" id="8590773">.</span><span class="ident" id="8590774">Parse</span><span class="op" id="8590779">(</span><span class="string" id="8590780">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;{{end}}`</span><span class="op" id="8590813">)</span><span class="op" id="8590814">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8590818">//&nbsp;Execute&nbsp;t2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590834"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590835">.</span><span class="ident" id="8590836">Reset</span><span class="op" id="8590841">(</span><span class="op" id="8590842">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8590845">if</span>&nbsp;<span class="ident" id="8590848">err</span>&nbsp;<span class="op" id="8590852">:=</span>&nbsp;<span class="ident" id="8590855"><a href="/html/template/clone_test.go.html#8590674">t2</a></span><span class="op" id="8590857">.</span><span class="ident" id="8590858">ExecuteTemplate</span><span class="op" id="8590873">(</span><span class="ident" id="8590874"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590875">,</span>&nbsp;<span class="string" id="8590877">&#34;a&#34;</span><span class="op" id="8590880">,</span>&nbsp;<span class="string" id="8590882">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8590889">)</span><span class="op" id="8590890">;</span>&nbsp;<span class="ident" id="8590892"><a href="/html/template/clone_test.go.html#8590848">err</a></span>&nbsp;<span class="op" id="8590896">!=</span>&nbsp;<span class="ident" id="8590899">nil</span>&nbsp;<span class="op" id="8590903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8590907"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8590908">.</span><span class="ident" id="8590909">Fatal</span><span class="op" id="8590914">(</span><span class="ident" id="8590915"><a href="/html/template/clone_test.go.html#8590848">err</a></span><span class="op" id="8590918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8590921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8590924">if</span>&nbsp;<span class="ident" id="8590927">got</span><span class="op" id="8590930">,</span>&nbsp;<span class="ident" id="8590932">want</span>&nbsp;<span class="op" id="8590937">:=</span>&nbsp;<span class="ident" id="8590940"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8590941">.</span><span class="ident" id="8590942">String</span><span class="op" id="8590948">(</span><span class="op" id="8590949">)</span><span class="op" id="8590950">,</span>&nbsp;<span class="string" id="8590952">`&nbsp;&lt;p&nbsp;onclick=&#34;javascript:&nbsp;&amp;#34;\u003ci\u003e*/&amp;#34;&nbsp;&#34;&gt;&lt;/p&gt;&nbsp;`</span><span class="op" id="8591012">;</span>&nbsp;<span class="ident" id="8591014"><a href="/html/template/clone_test.go.html#8590927">got</a></span>&nbsp;<span class="op" id="8591018">!=</span>&nbsp;<span class="ident" id="8591021"><a href="/html/template/clone_test.go.html#8590932">want</a></span>&nbsp;<span class="op" id="8591026">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591030"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8591031">.</span><span class="ident" id="8591032">Errorf</span><span class="op" id="8591038">(</span><span class="string" id="8591039">&#34;t2:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8591059">,</span>&nbsp;<span class="ident" id="8591061"><a href="/html/template/clone_test.go.html#8590927">got</a></span><span class="op" id="8591064">,</span>&nbsp;<span class="ident" id="8591066"><a href="/html/template/clone_test.go.html#8590932">want</a></span><span class="op" id="8591070">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8591073">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591077">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t3,&nbsp;but&nbsp;do&nbsp;not&nbsp;execute&nbsp;t3&nbsp;yet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591124">t3</span>&nbsp;<span class="op" id="8591127">:=</span>&nbsp;<span class="ident" id="8591130"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591134">(</span><span class="ident" id="8591135"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591137">.</span><span class="ident" id="8591138">Clone</span><span class="op" id="8591143">(</span><span class="op" id="8591144">)</span><span class="op" id="8591145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591148"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591152">(</span><span class="ident" id="8591153"><a href="/html/template/clone_test.go.html#8591124">t3</a></span><span class="op" id="8591155">.</span><span class="ident" id="8591156">Parse</span><span class="op" id="8591161">(</span><span class="string" id="8591162">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;style&gt;&nbsp;{{end}}`</span><span class="op" id="8591196">)</span><span class="op" id="8591197">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591200"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591204">(</span><span class="ident" id="8591205"><a href="/html/template/clone_test.go.html#8591124">t3</a></span><span class="op" id="8591207">.</span><span class="ident" id="8591208">Parse</span><span class="op" id="8591213">(</span><span class="string" id="8591214">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;&lt;/style&gt;&nbsp;{{end}}`</span><span class="op" id="8591249">)</span><span class="op" id="8591250">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591254">//&nbsp;Complete&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591271"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591275">(</span><span class="ident" id="8591276"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591278">.</span><span class="ident" id="8591279">Parse</span><span class="op" id="8591284">(</span><span class="string" id="8591285">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;(&nbsp;{{end}}`</span><span class="op" id="8591313">)</span><span class="op" id="8591314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591317"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591321">(</span><span class="ident" id="8591322"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591324">.</span><span class="ident" id="8591325">Parse</span><span class="op" id="8591330">(</span><span class="string" id="8591331">`{{define&nbsp;&#34;rhs&#34;}}&nbsp;)&nbsp;{{end}}`</span><span class="op" id="8591359">)</span><span class="op" id="8591360">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591364">//&nbsp;Clone&nbsp;t0&nbsp;as&nbsp;t4.&nbsp;Redefining&nbsp;the&nbsp;&#34;lhs&#34;&nbsp;template&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591427">t4</span>&nbsp;<span class="op" id="8591430">:=</span>&nbsp;<span class="ident" id="8591433"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8591437">(</span><span class="ident" id="8591438"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591440">.</span><span class="ident" id="8591441">Clone</span><span class="op" id="8591446">(</span><span class="op" id="8591447">)</span><span class="op" id="8591448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8591451">if</span>&nbsp;<span class="ident" id="8591454">_</span><span class="op" id="8591455">,</span>&nbsp;<span class="ident" id="8591457">err</span>&nbsp;<span class="op" id="8591461">:=</span>&nbsp;<span class="ident" id="8591464"><a href="/html/template/clone_test.go.html#8591427">t4</a></span><span class="op" id="8591466">.</span><span class="ident" id="8591467">Parse</span><span class="op" id="8591472">(</span><span class="string" id="8591473">`{{define&nbsp;&#34;lhs&#34;}}&nbsp;FAIL&nbsp;{{end}}`</span><span class="op" id="8591504">)</span><span class="op" id="8591505">;</span>&nbsp;<span class="ident" id="8591507"><a href="/html/template/clone_test.go.html#8591457">err</a></span>&nbsp;<span class="op" id="8591511">==</span>&nbsp;<span class="ident" id="8591514">nil</span>&nbsp;<span class="op" id="8591518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591522"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8591523">.</span><span class="ident" id="8591524">Error</span><span class="op" id="8591529">(</span><span class="string" id="8591530">`redefine&nbsp;&#34;lhs&#34;:&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8591572">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8591575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591579">//&nbsp;Execute&nbsp;t0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591595"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8591596">.</span><span class="ident" id="8591597">Reset</span><span class="op" id="8591602">(</span><span class="op" id="8591603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8591606">if</span>&nbsp;<span class="ident" id="8591609">err</span>&nbsp;<span class="op" id="8591613">:=</span>&nbsp;<span class="ident" id="8591616"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591618">.</span><span class="ident" id="8591619">ExecuteTemplate</span><span class="op" id="8591634">(</span><span class="ident" id="8591635"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8591636">,</span>&nbsp;<span class="string" id="8591638">&#34;a&#34;</span><span class="op" id="8591641">,</span>&nbsp;<span class="string" id="8591643">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8591650">)</span><span class="op" id="8591651">;</span>&nbsp;<span class="ident" id="8591653"><a href="/html/template/clone_test.go.html#8591609">err</a></span>&nbsp;<span class="op" id="8591657">!=</span>&nbsp;<span class="ident" id="8591660">nil</span>&nbsp;<span class="op" id="8591664">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591668"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8591669">.</span><span class="ident" id="8591670">Fatal</span><span class="op" id="8591675">(</span><span class="ident" id="8591676"><a href="/html/template/clone_test.go.html#8591609">err</a></span><span class="op" id="8591679">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8591682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8591685">if</span>&nbsp;<span class="ident" id="8591688">got</span><span class="op" id="8591691">,</span>&nbsp;<span class="ident" id="8591693">want</span>&nbsp;<span class="op" id="8591698">:=</span>&nbsp;<span class="ident" id="8591701"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8591702">.</span><span class="ident" id="8591703">String</span><span class="op" id="8591709">(</span><span class="op" id="8591710">)</span><span class="op" id="8591711">,</span>&nbsp;<span class="string" id="8591713">`&nbsp;(&nbsp;&amp;lt;i&amp;gt;*/&nbsp;)&nbsp;`</span><span class="op" id="8591732">;</span>&nbsp;<span class="ident" id="8591734"><a href="/html/template/clone_test.go.html#8591688">got</a></span>&nbsp;<span class="op" id="8591738">!=</span>&nbsp;<span class="ident" id="8591741"><a href="/html/template/clone_test.go.html#8591693">want</a></span>&nbsp;<span class="op" id="8591746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591750"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8591751">.</span><span class="ident" id="8591752">Errorf</span><span class="op" id="8591758">(</span><span class="string" id="8591759">&#34;t0:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8591779">,</span>&nbsp;<span class="ident" id="8591781"><a href="/html/template/clone_test.go.html#8591688">got</a></span><span class="op" id="8591784">,</span>&nbsp;<span class="ident" id="8591786"><a href="/html/template/clone_test.go.html#8591693">want</a></span><span class="op" id="8591790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8591793">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591797">//&nbsp;Clone&nbsp;t0.&nbsp;This&nbsp;should&nbsp;fail,&nbsp;as&nbsp;t0&nbsp;has&nbsp;already&nbsp;executed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8591857">if</span>&nbsp;<span class="ident" id="8591860">_</span><span class="op" id="8591861">,</span>&nbsp;<span class="ident" id="8591863">err</span>&nbsp;<span class="op" id="8591867">:=</span>&nbsp;<span class="ident" id="8591870"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8591872">.</span><span class="ident" id="8591873">Clone</span><span class="op" id="8591878">(</span><span class="op" id="8591879">)</span><span class="op" id="8591880">;</span>&nbsp;<span class="ident" id="8591882"><a href="/html/template/clone_test.go.html#8591863">err</a></span>&nbsp;<span class="op" id="8591886">==</span>&nbsp;<span class="ident" id="8591889">nil</span>&nbsp;<span class="op" id="8591893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8591897"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8591898">.</span><span class="ident" id="8591899">Error</span><span class="op" id="8591904">(</span><span class="string" id="8591905">`t0.Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8591943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8591946">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8591950">//&nbsp;Similarly,&nbsp;cloning&nbsp;sub-templates&nbsp;should&nbsp;fail.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592000">if</span>&nbsp;<span class="ident" id="8592003">_</span><span class="op" id="8592004">,</span>&nbsp;<span class="ident" id="8592006">err</span>&nbsp;<span class="op" id="8592010">:=</span>&nbsp;<span class="ident" id="8592013"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8592015">.</span><span class="ident" id="8592016">Lookup</span><span class="op" id="8592022">(</span><span class="string" id="8592023">&#34;a&#34;</span><span class="op" id="8592026">)</span><span class="op" id="8592027">.</span><span class="ident" id="8592028">Clone</span><span class="op" id="8592033">(</span><span class="op" id="8592034">)</span><span class="op" id="8592035">;</span>&nbsp;<span class="ident" id="8592037"><a href="/html/template/clone_test.go.html#8592006">err</a></span>&nbsp;<span class="op" id="8592041">==</span>&nbsp;<span class="ident" id="8592044">nil</span>&nbsp;<span class="op" id="8592048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592052"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8592053">.</span><span class="ident" id="8592054">Error</span><span class="op" id="8592059">(</span><span class="string" id="8592060">`t0.Lookup(&#34;a&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8592110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8592113">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592116">if</span>&nbsp;<span class="ident" id="8592119">_</span><span class="op" id="8592120">,</span>&nbsp;<span class="ident" id="8592122">err</span>&nbsp;<span class="op" id="8592126">:=</span>&nbsp;<span class="ident" id="8592129"><a href="/html/template/clone_test.go.html#8590239">t0</a></span><span class="op" id="8592131">.</span><span class="ident" id="8592132">Lookup</span><span class="op" id="8592138">(</span><span class="string" id="8592139">&#34;lhs&#34;</span><span class="op" id="8592144">)</span><span class="op" id="8592145">.</span><span class="ident" id="8592146">Clone</span><span class="op" id="8592151">(</span><span class="op" id="8592152">)</span><span class="op" id="8592153">;</span>&nbsp;<span class="ident" id="8592155"><a href="/html/template/clone_test.go.html#8592122">err</a></span>&nbsp;<span class="op" id="8592159">==</span>&nbsp;<span class="ident" id="8592162">nil</span>&nbsp;<span class="op" id="8592166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592170"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8592171">.</span><span class="ident" id="8592172">Error</span><span class="op" id="8592177">(</span><span class="string" id="8592178">`t0.Lookup(&#34;lhs&#34;).Clone():&nbsp;got&nbsp;nil&nbsp;err&nbsp;want&nbsp;non-nil`</span><span class="op" id="8592230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8592233">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8592237">//&nbsp;Execute&nbsp;t3.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592253"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8592254">.</span><span class="ident" id="8592255">Reset</span><span class="op" id="8592260">(</span><span class="op" id="8592261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592264">if</span>&nbsp;<span class="ident" id="8592267">err</span>&nbsp;<span class="op" id="8592271">:=</span>&nbsp;<span class="ident" id="8592274"><a href="/html/template/clone_test.go.html#8591124">t3</a></span><span class="op" id="8592276">.</span><span class="ident" id="8592277">ExecuteTemplate</span><span class="op" id="8592292">(</span><span class="ident" id="8592293"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8592294">,</span>&nbsp;<span class="string" id="8592296">&#34;a&#34;</span><span class="op" id="8592299">,</span>&nbsp;<span class="string" id="8592301">&#34;&lt;i&gt;*/&#34;</span><span class="op" id="8592308">)</span><span class="op" id="8592309">;</span>&nbsp;<span class="ident" id="8592311"><a href="/html/template/clone_test.go.html#8592267">err</a></span>&nbsp;<span class="op" id="8592315">!=</span>&nbsp;<span class="ident" id="8592318">nil</span>&nbsp;<span class="op" id="8592322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592326"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8592327">.</span><span class="ident" id="8592328">Fatal</span><span class="op" id="8592333">(</span><span class="ident" id="8592334"><a href="/html/template/clone_test.go.html#8592267">err</a></span><span class="op" id="8592337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8592340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592343">if</span>&nbsp;<span class="ident" id="8592346">got</span><span class="op" id="8592349">,</span>&nbsp;<span class="ident" id="8592351">want</span>&nbsp;<span class="op" id="8592356">:=</span>&nbsp;<span class="ident" id="8592359"><a href="/html/template/clone_test.go.html#8590176">b</a></span><span class="op" id="8592360">.</span><span class="ident" id="8592361">String</span><span class="op" id="8592367">(</span><span class="op" id="8592368">)</span><span class="op" id="8592369">,</span>&nbsp;<span class="string" id="8592371">`&nbsp;&lt;style&gt;&nbsp;ZgotmplZ&nbsp;&lt;/style&gt;&nbsp;`</span><span class="op" id="8592400">;</span>&nbsp;<span class="ident" id="8592402"><a href="/html/template/clone_test.go.html#8592346">got</a></span>&nbsp;<span class="op" id="8592406">!=</span>&nbsp;<span class="ident" id="8592409"><a href="/html/template/clone_test.go.html#8592351">want</a></span>&nbsp;<span class="op" id="8592414">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592418"><a href="/html/template/clone_test.go.html#8589788">t</a></span><span class="op" id="8592419">.</span><span class="ident" id="8592420">Errorf</span><span class="op" id="8592426">(</span><span class="string" id="8592427">&#34;t3:&nbsp;got&nbsp;%q&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8592447">,</span>&nbsp;<span class="ident" id="8592449"><a href="/html/template/clone_test.go.html#8592346">got</a></span><span class="op" id="8592452">,</span>&nbsp;<span class="ident" id="8592454"><a href="/html/template/clone_test.go.html#8592351">want</a></span><span class="op" id="8592458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8592461">}</span><br>
<span class="lineno"></span><span class="op" id="8592463">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8592466">func</span>&nbsp;<span class="ident" id="8592471">TestTemplates</span><span class="op" id="8592484">(</span><span class="ident" id="8592485">t</span>&nbsp;<span class="op" id="8592487">*</span><span class="ident" id="8592488"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8592495">.</span><span class="ident" id="8592496">T</span><span class="op" id="8592497">)</span>&nbsp;<span class="op" id="8592499">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592502">names</span>&nbsp;<span class="op" id="8592508">:=</span>&nbsp;<span class="op" id="8592511">[</span><span class="op" id="8592512">]</span><span class="builtintype" id="8592513">string</span><span class="op" id="8592519">{</span><span class="string" id="8592520">&#34;t0&#34;</span><span class="op" id="8592524">,</span>&nbsp;<span class="string" id="8592526">&#34;a&#34;</span><span class="op" id="8592529">,</span>&nbsp;<span class="string" id="8592531">&#34;lhs&#34;</span><span class="op" id="8592536">,</span>&nbsp;<span class="string" id="8592538">&#34;rhs&#34;</span><span class="op" id="8592543">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8592546">//&nbsp;Some&nbsp;template&nbsp;definitions&nbsp;borrowed&nbsp;from&nbsp;TestClone.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592601">const</span>&nbsp;<span class="ident" id="8592607">tmpl</span>&nbsp;<span class="op" id="8592612">=</span>&nbsp;<span class="string" id="8592614">`<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;lhs&#34;}}{{.}}{{template&nbsp;&#34;rhs&#34;}}{{end}}<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;lhs&#34;}}&nbsp;&lt;a&nbsp;href=&#34;&nbsp;{{end}}<br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp{{define&nbsp;&#34;rhs&#34;}}&nbsp;&#34;&gt;&lt;/a&gt;&nbsp;{{end}}`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592754">t0</span>&nbsp;<span class="op" id="8592757">:=</span>&nbsp;<span class="ident" id="8592760"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8592764">(</span><span class="ident" id="8592765"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8592768">(</span><span class="string" id="8592769">&#34;t0&#34;</span><span class="op" id="8592773">)</span><span class="op" id="8592774">.</span><span class="ident" id="8592775">Parse</span><span class="op" id="8592780">(</span><span class="ident" id="8592781"><a href="/html/template/clone_test.go.html#8592607">tmpl</a></span><span class="op" id="8592785">)</span><span class="op" id="8592786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592789">templates</span>&nbsp;<span class="op" id="8592799">:=</span>&nbsp;<span class="ident" id="8592802"><a href="/html/template/clone_test.go.html#8592754">t0</a></span><span class="op" id="8592804">.</span><span class="ident" id="8592805">Templates</span><span class="op" id="8592814">(</span><span class="op" id="8592815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592818">if</span>&nbsp;<span class="builtinfunc" id="8592821">len</span><span class="op" id="8592824">(</span><span class="ident" id="8592825"><a href="/html/template/clone_test.go.html#8592789">templates</a></span><span class="op" id="8592834">)</span>&nbsp;<span class="op" id="8592836">!=</span>&nbsp;<span class="builtinfunc" id="8592839">len</span><span class="op" id="8592842">(</span><span class="ident" id="8592843"><a href="/html/template/clone_test.go.html#8592502">names</a></span><span class="op" id="8592848">)</span>&nbsp;<span class="op" id="8592850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592854"><a href="/html/template/clone_test.go.html#8592485">t</a></span><span class="op" id="8592855">.</span><span class="ident" id="8592856">Errorf</span><span class="op" id="8592862">(</span><span class="string" id="8592863">&#34;expected&nbsp;%d&nbsp;templates;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="8592894">,</span>&nbsp;<span class="builtinfunc" id="8592896">len</span><span class="op" id="8592899">(</span><span class="ident" id="8592900"><a href="/html/template/clone_test.go.html#8592502">names</a></span><span class="op" id="8592905">)</span><span class="op" id="8592906">,</span>&nbsp;<span class="builtinfunc" id="8592908">len</span><span class="op" id="8592911">(</span><span class="ident" id="8592912"><a href="/html/template/clone_test.go.html#8592789">templates</a></span><span class="op" id="8592921">)</span><span class="op" id="8592922">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8592925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592928">for</span>&nbsp;<span class="ident" id="8592932">_</span><span class="op" id="8592933">,</span>&nbsp;<span class="ident" id="8592935">name</span>&nbsp;<span class="op" id="8592940">:=</span>&nbsp;<span class="keyword" id="8592943">range</span>&nbsp;<span class="ident" id="8592949"><a href="/html/template/clone_test.go.html#8592502">names</a></span>&nbsp;<span class="op" id="8592955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8592959">found</span>&nbsp;<span class="op" id="8592965">:=</span>&nbsp;<span class="ident" id="8592968">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8592976">for</span>&nbsp;<span class="ident" id="8592980">_</span><span class="op" id="8592981">,</span>&nbsp;<span class="ident" id="8592983">tmpl</span>&nbsp;<span class="op" id="8592988">:=</span>&nbsp;<span class="keyword" id="8592991">range</span>&nbsp;<span class="ident" id="8592997"><a href="/html/template/clone_test.go.html#8592789">templates</a></span>&nbsp;<span class="op" id="8593007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8593012">if</span>&nbsp;<span class="ident" id="8593015"><a href="/html/template/clone_test.go.html#8592935">name</a></span>&nbsp;<span class="op" id="8593020">==</span>&nbsp;<span class="ident" id="8593023"><a href="/html/template/clone_test.go.html#8592983">tmpl</a></span><span class="op" id="8593027">.</span><span class="ident" id="8593028">text</span><span class="op" id="8593032">.</span><span class="ident" id="8593033">Name</span><span class="op" id="8593037">(</span><span class="op" id="8593038">)</span>&nbsp;<span class="op" id="8593040">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593046"><a href="/html/template/clone_test.go.html#8592959">found</a></span>&nbsp;<span class="op" id="8593052">=</span>&nbsp;<span class="ident" id="8593054">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8593063">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8593080">if</span>&nbsp;<span class="op" id="8593083">!</span><span class="ident" id="8593084"><a href="/html/template/clone_test.go.html#8592959">found</a></span>&nbsp;<span class="op" id="8593090">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593095"><a href="/html/template/clone_test.go.html#8592485">t</a></span><span class="op" id="8593096">.</span><span class="ident" id="8593097">Error</span><span class="op" id="8593102">(</span><span class="string" id="8593103">&#34;could&nbsp;not&nbsp;find&nbsp;template&#34;</span><span class="op" id="8593128">,</span>&nbsp;<span class="ident" id="8593130"><a href="/html/template/clone_test.go.html#8592935">name</a></span><span class="op" id="8593134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593141">}</span><br>
<span class="lineno"></span><span class="op" id="8593143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="8593146">//&nbsp;This&nbsp;used&nbsp;to&nbsp;crash;&nbsp;http://golang.org/issue/3281</span><br>
<span class="lineno"></span><span class="keyword" id="8593198">func</span>&nbsp;<span class="ident" id="8593203">TestCloneCrash</span><span class="op" id="8593217">(</span><span class="ident" id="8593218">t</span>&nbsp;<span class="op" id="8593220">*</span><span class="ident" id="8593221"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8593228">.</span><span class="ident" id="8593229">T</span><span class="op" id="8593230">)</span>&nbsp;<span class="op" id="8593232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593235">t1</span>&nbsp;<span class="op" id="8593238">:=</span>&nbsp;<span class="ident" id="8593241"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8593244">(</span><span class="string" id="8593245">&#34;all&#34;</span><span class="op" id="8593250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593253"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8593257">(</span><span class="ident" id="8593258"><a href="/html/template/clone_test.go.html#8593235">t1</a></span><span class="op" id="8593260">.</span><span class="ident" id="8593261">New</span><span class="op" id="8593264">(</span><span class="string" id="8593265">&#34;t1&#34;</span><span class="op" id="8593269">)</span><span class="op" id="8593270">.</span><span class="ident" id="8593271">Parse</span><span class="op" id="8593276">(</span><span class="string" id="8593277">`{{define&nbsp;&#34;foo&#34;}}foo{{end}}`</span><span class="op" id="8593305">)</span><span class="op" id="8593306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593309"><a href="/html/template/clone_test.go.html#8593235">t1</a></span><span class="op" id="8593311">.</span><span class="ident" id="8593312">Clone</span><span class="op" id="8593317">(</span><span class="op" id="8593318">)</span><br>
<span class="lineno">150</span><span class="op" id="8593320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8593323">//&nbsp;Ensure&nbsp;that&nbsp;this&nbsp;guarantee&nbsp;from&nbsp;the&nbsp;docs&nbsp;is&nbsp;upheld:</span><br>
<span class="lineno"></span><span class="comment" id="8593378">//&nbsp;&#34;Further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="8593436">//&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&#34;</span><br>
<span class="lineno">155</span><span class="keyword" id="8593477">func</span>&nbsp;<span class="ident" id="8593482">TestCloneThenParse</span><span class="op" id="8593500">(</span><span class="ident" id="8593501">t</span>&nbsp;<span class="op" id="8593503">*</span><span class="ident" id="8593504"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8593511">.</span><span class="ident" id="8593512">T</span><span class="op" id="8593513">)</span>&nbsp;<span class="op" id="8593515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593518">t0</span>&nbsp;<span class="op" id="8593521">:=</span>&nbsp;<span class="ident" id="8593524"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8593528">(</span><span class="ident" id="8593529"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8593532">(</span><span class="string" id="8593533">&#34;t0&#34;</span><span class="op" id="8593537">)</span><span class="op" id="8593538">.</span><span class="ident" id="8593539">Parse</span><span class="op" id="8593544">(</span><span class="string" id="8593545">`{{define&nbsp;&#34;a&#34;}}{{template&nbsp;&#34;embedded&#34;}}{{end}}`</span><span class="op" id="8593591">)</span><span class="op" id="8593592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593595">t1</span>&nbsp;<span class="op" id="8593598">:=</span>&nbsp;<span class="ident" id="8593601"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8593605">(</span><span class="ident" id="8593606"><a href="/html/template/clone_test.go.html#8593518">t0</a></span><span class="op" id="8593608">.</span><span class="ident" id="8593609">Clone</span><span class="op" id="8593614">(</span><span class="op" id="8593615">)</span><span class="op" id="8593616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593619"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8593623">(</span><span class="ident" id="8593624"><a href="/html/template/clone_test.go.html#8593595">t1</a></span><span class="op" id="8593626">.</span><span class="ident" id="8593627">Parse</span><span class="op" id="8593632">(</span><span class="string" id="8593633">`{{define&nbsp;&#34;embedded&#34;}}t1{{end}}`</span><span class="op" id="8593665">)</span><span class="op" id="8593666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8593669">if</span>&nbsp;<span class="builtinfunc" id="8593672">len</span><span class="op" id="8593675">(</span><span class="ident" id="8593676"><a href="/html/template/clone_test.go.html#8593518">t0</a></span><span class="op" id="8593678">.</span><span class="ident" id="8593679">Templates</span><span class="op" id="8593688">(</span><span class="op" id="8593689">)</span><span class="op" id="8593690">)</span><span class="op" id="8593691">+</span><span class="num" id="8593692">1</span>&nbsp;<span class="op" id="8593694">!=</span>&nbsp;<span class="builtinfunc" id="8593697">len</span><span class="op" id="8593700">(</span><span class="ident" id="8593701"><a href="/html/template/clone_test.go.html#8593595">t1</a></span><span class="op" id="8593703">.</span><span class="ident" id="8593704">Templates</span><span class="op" id="8593713">(</span><span class="op" id="8593714">)</span><span class="op" id="8593715">)</span>&nbsp;<span class="op" id="8593717">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593721"><a href="/html/template/clone_test.go.html#8593501">t</a></span><span class="op" id="8593722">.</span><span class="ident" id="8593723">Error</span><span class="op" id="8593728">(</span><span class="string" id="8593729">&#34;adding&nbsp;a&nbsp;template&nbsp;to&nbsp;a&nbsp;clone&nbsp;added&nbsp;it&nbsp;to&nbsp;the&nbsp;original&#34;</span><span class="op" id="8593784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8593790">//&nbsp;double&nbsp;check&nbsp;that&nbsp;the&nbsp;embedded&nbsp;template&nbsp;isn&#39;t&nbsp;available&nbsp;in&nbsp;the&nbsp;original</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593866">err</span>&nbsp;<span class="op" id="8593870">:=</span>&nbsp;<span class="ident" id="8593873"><a href="/html/template/clone_test.go.html#8593518">t0</a></span><span class="op" id="8593875">.</span><span class="ident" id="8593876">ExecuteTemplate</span><span class="op" id="8593891">(</span><span class="ident" id="8593892"><a href="/html/template/clone_test.go.html#8589198">ioutil</a></span><span class="op" id="8593898">.</span><span class="ident" id="8593899">Discard</span><span class="op" id="8593906">,</span>&nbsp;<span class="string" id="8593908">&#34;a&#34;</span><span class="op" id="8593911">,</span>&nbsp;<span class="ident" id="8593913">nil</span><span class="op" id="8593916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8593919">if</span>&nbsp;<span class="ident" id="8593922"><a href="/html/template/clone_test.go.html#8593866">err</a></span>&nbsp;<span class="op" id="8593926">==</span>&nbsp;<span class="ident" id="8593929">nil</span>&nbsp;<span class="op" id="8593933">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8593937"><a href="/html/template/clone_test.go.html#8593501">t</a></span><span class="op" id="8593938">.</span><span class="ident" id="8593939">Error</span><span class="op" id="8593944">(</span><span class="string" id="8593945">&#34;expected&nbsp;&#39;no&nbsp;such&nbsp;template&#39;&nbsp;error&#34;</span><span class="op" id="8593980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8593983">}</span><br>
<span class="lineno"></span><span class="op" id="8593985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8593988">//&nbsp;https://code.google.com/p/go/issues/detail?id=5980</span><br>
<span class="lineno">170</span><span class="keyword" id="8594042">func</span>&nbsp;<span class="ident" id="8594047">TestFuncMapWorksAfterClone</span><span class="op" id="8594073">(</span><span class="ident" id="8594074">t</span>&nbsp;<span class="op" id="8594076">*</span><span class="ident" id="8594077"><a href="/html/template/clone_test.go.html#8589211">testing</a></span><span class="op" id="8594084">.</span><span class="ident" id="8594085">T</span><span class="op" id="8594086">)</span>&nbsp;<span class="op" id="8594088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594091">funcs</span>&nbsp;<span class="op" id="8594097">:=</span>&nbsp;<span class="ident" id="8594100"><a href="/html/template/template.go.html#3338657">FuncMap</a></span><span class="op" id="8594107">{</span><span class="string" id="8594108">&#34;customFunc&#34;</span><span class="op" id="8594120">:</span>&nbsp;<span class="keyword" id="8594122">func</span><span class="op" id="8594126">(</span><span class="op" id="8594127">)</span>&nbsp;<span class="op" id="8594129">(</span><span class="builtintype" id="8594130">string</span><span class="op" id="8594136">,</span>&nbsp;<span class="builtintype" id="8594138">error</span><span class="op" id="8594143">)</span>&nbsp;<span class="op" id="8594145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8594149">return</span>&nbsp;<span class="string" id="8594156">&#34;&#34;</span><span class="op" id="8594158">,</span>&nbsp;<span class="ident" id="8594160"><a href="/html/template/clone_test.go.html#8589188">errors</a></span><span class="op" id="8594166">.</span><span class="ident" id="8594167">New</span><span class="op" id="8594170">(</span><span class="string" id="8594171">&#34;issue5980&#34;</span><span class="op" id="8594182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8594185">}</span><span class="op" id="8594186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8594190">//&nbsp;get&nbsp;the&nbsp;expected&nbsp;error&nbsp;output&nbsp;(no&nbsp;clone)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594235">uncloned</span>&nbsp;<span class="op" id="8594244">:=</span>&nbsp;<span class="ident" id="8594247"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8594251">(</span><span class="ident" id="8594252"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8594255">(</span><span class="string" id="8594256">&#34;&#34;</span><span class="op" id="8594258">)</span><span class="op" id="8594259">.</span><span class="ident" id="8594260">Funcs</span><span class="op" id="8594265">(</span><span class="ident" id="8594266"><a href="/html/template/clone_test.go.html#8594091">funcs</a></span><span class="op" id="8594271">)</span><span class="op" id="8594272">.</span><span class="ident" id="8594273">Parse</span><span class="op" id="8594278">(</span><span class="string" id="8594279">&#34;{{customFunc}}&#34;</span><span class="op" id="8594295">)</span><span class="op" id="8594296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594299">wantErr</span>&nbsp;<span class="op" id="8594307">:=</span>&nbsp;<span class="ident" id="8594310"><a href="/html/template/clone_test.go.html#8594235">uncloned</a></span><span class="op" id="8594318">.</span><span class="ident" id="8594319">Execute</span><span class="op" id="8594326">(</span><span class="ident" id="8594327"><a href="/html/template/clone_test.go.html#8589198">ioutil</a></span><span class="op" id="8594333">.</span><span class="ident" id="8594334">Discard</span><span class="op" id="8594341">,</span>&nbsp;<span class="ident" id="8594343">nil</span><span class="op" id="8594346">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8594350">//&nbsp;toClone&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;uncloned.&nbsp;It&nbsp;has&nbsp;to&nbsp;be&nbsp;recreated&nbsp;from&nbsp;scratch,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8594429">//&nbsp;since&nbsp;cloning&nbsp;cannot&nbsp;occur&nbsp;after&nbsp;execution.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594477">toClone</span>&nbsp;<span class="op" id="8594485">:=</span>&nbsp;<span class="ident" id="8594488"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8594492">(</span><span class="ident" id="8594493"><a href="/html/template/template.go.html#3337358">New</a></span><span class="op" id="8594496">(</span><span class="string" id="8594497">&#34;&#34;</span><span class="op" id="8594499">)</span><span class="op" id="8594500">.</span><span class="ident" id="8594501">Funcs</span><span class="op" id="8594506">(</span><span class="ident" id="8594507"><a href="/html/template/clone_test.go.html#8594091">funcs</a></span><span class="op" id="8594512">)</span><span class="op" id="8594513">.</span><span class="ident" id="8594514">Parse</span><span class="op" id="8594519">(</span><span class="string" id="8594520">&#34;{{customFunc}}&#34;</span><span class="op" id="8594536">)</span><span class="op" id="8594537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594540">cloned</span>&nbsp;<span class="op" id="8594547">:=</span>&nbsp;<span class="ident" id="8594550"><a href="/html/template/template.go.html#3339995">Must</a></span><span class="op" id="8594554">(</span><span class="ident" id="8594555"><a href="/html/template/clone_test.go.html#8594477">toClone</a></span><span class="op" id="8594562">.</span><span class="ident" id="8594563">Clone</span><span class="op" id="8594568">(</span><span class="op" id="8594569">)</span><span class="op" id="8594570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594573">gotErr</span>&nbsp;<span class="op" id="8594580">:=</span>&nbsp;<span class="ident" id="8594583"><a href="/html/template/clone_test.go.html#8594540">cloned</a></span><span class="op" id="8594589">.</span><span class="ident" id="8594590">Execute</span><span class="op" id="8594597">(</span><span class="ident" id="8594598"><a href="/html/template/clone_test.go.html#8589198">ioutil</a></span><span class="op" id="8594604">.</span><span class="ident" id="8594605">Discard</span><span class="op" id="8594612">,</span>&nbsp;<span class="ident" id="8594614">nil</span><span class="op" id="8594617">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8594621">if</span>&nbsp;<span class="ident" id="8594624"><a href="/html/template/clone_test.go.html#8594299">wantErr</a></span><span class="op" id="8594631">.</span><span class="ident" id="8594632">Error</span><span class="op" id="8594637">(</span><span class="op" id="8594638">)</span>&nbsp;<span class="op" id="8594640">!=</span>&nbsp;<span class="ident" id="8594643"><a href="/html/template/clone_test.go.html#8594573">gotErr</a></span><span class="op" id="8594649">.</span><span class="ident" id="8594650">Error</span><span class="op" id="8594655">(</span><span class="op" id="8594656">)</span>&nbsp;<span class="op" id="8594658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8594662"><a href="/html/template/clone_test.go.html#8594074">t</a></span><span class="op" id="8594663">.</span><span class="ident" id="8594664">Errorf</span><span class="op" id="8594670">(</span><span class="string" id="8594671">&#34;clone&nbsp;error&nbsp;message&nbsp;mismatch&nbsp;want&nbsp;%q&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8594716">,</span>&nbsp;<span class="ident" id="8594718"><a href="/html/template/clone_test.go.html#8594299">wantErr</a></span><span class="op" id="8594725">,</span>&nbsp;<span class="ident" id="8594727"><a href="/html/template/clone_test.go.html#8594573">gotErr</a></span><span class="op" id="8594733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8594736">}</span><br>
<span class="lineno"></span><span class="op" id="8594738">}</span>
</div>
</body>
</html>
