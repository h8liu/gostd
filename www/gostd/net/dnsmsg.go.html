<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3587883">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3587938">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3587992">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3588043">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="3588082">//</span><br>
<span class="lineno"></span><span class="comment" id="3588085">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="3588145">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="3588184">//</span><br>
<span class="lineno">10</span><span class="comment" id="3588187">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3588247">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="3588312">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="3588379">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="3588403">//</span><br>
<span class="lineno">15</span><span class="comment" id="3588406">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="3588470">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="3588540">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3588603">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="3588636">//</span><br>
<span class="lineno">20</span><span class="comment" id="3588639">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3588715">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3588782">package</span>&nbsp;<span class="ident" id="3588790">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3588795">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3588814">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3588833">const</span>&nbsp;<span class="op" id="3588839">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3588842">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588894">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3588907">=</span>&nbsp;<span class="num" id="3588909">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588912">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3588925">=</span>&nbsp;<span class="num" id="3588927">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588930">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3588943">=</span>&nbsp;<span class="num" id="3588945">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588948">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3588961">=</span>&nbsp;<span class="num" id="3588963">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588966">dnsTypeCNAME</span>&nbsp;<span class="op" id="3588979">=</span>&nbsp;<span class="num" id="3588981">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3588984">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3588997">=</span>&nbsp;<span class="num" id="3588999">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589002">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589015">=</span>&nbsp;<span class="num" id="3589017">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589020">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589033">=</span>&nbsp;<span class="num" id="3589035">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589038">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589051">=</span>&nbsp;<span class="num" id="3589053">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589056">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="3589069">=</span>&nbsp;<span class="num" id="3589071">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589075">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589088">=</span>&nbsp;<span class="num" id="3589090">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589094">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589107">=</span>&nbsp;<span class="num" id="3589109">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589113">dnsTypeHINFO</span>&nbsp;<span class="op" id="3589126">=</span>&nbsp;<span class="num" id="3589128">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589132">dnsTypeMINFO</span>&nbsp;<span class="op" id="3589145">=</span>&nbsp;<span class="num" id="3589147">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589151">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589164">=</span>&nbsp;<span class="num" id="3589166">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589170">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589183">=</span>&nbsp;<span class="num" id="3589185">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589189">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="3589202">=</span>&nbsp;<span class="num" id="3589204">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589208">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589221">=</span>&nbsp;<span class="num" id="3589223">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589228">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589261">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="3589274">=</span>&nbsp;<span class="num" id="3589276">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589281">dnsTypeMAILB</span>&nbsp;<span class="op" id="3589294">=</span>&nbsp;<span class="num" id="3589296">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589301">dnsTypeMAILA</span>&nbsp;<span class="op" id="3589314">=</span>&nbsp;<span class="num" id="3589316">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589321">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589334">=</span>&nbsp;<span class="num" id="3589336">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589342">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589371">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3589386">=</span>&nbsp;<span class="num" id="3589388">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589391">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="3589406">=</span>&nbsp;<span class="num" id="3589408">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589411">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="3589426">=</span>&nbsp;<span class="num" id="3589428">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589431">dnsClassHESIOD</span>&nbsp;<span class="op" id="3589446">=</span>&nbsp;<span class="num" id="3589448">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589451">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589466">=</span>&nbsp;<span class="num" id="3589468">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589474">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589491">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589514">=</span>&nbsp;<span class="num" id="3589516">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589519">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589542">=</span>&nbsp;<span class="num" id="3589544">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589547">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="3589570">=</span>&nbsp;<span class="num" id="3589572">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589575">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589598">=</span>&nbsp;<span class="num" id="3589600">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589603">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="3589626">=</span>&nbsp;<span class="num" id="3589628">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3589631">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3589654">=</span>&nbsp;<span class="num" id="3589656">5</span><br>
<span class="lineno"></span><span class="op" id="3589658">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="3589661">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="3589728">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="3589755">type</span>&nbsp;<span class="ident" id="3589760">dnsStruct</span>&nbsp;<span class="keyword" id="3589770">interface</span>&nbsp;<span class="op" id="3589780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589783">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589840">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589898">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3589954">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3590004">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3590060">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3590102">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3590158">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590196">Walk</span><span class="op" id="3590200">(</span><span class="ident" id="3590201">f</span>&nbsp;<span class="keyword" id="3590203">func</span><span class="op" id="3590207">(</span><span class="ident" id="3590208">v</span>&nbsp;<span class="keyword" id="3590210">interface</span><span class="op" id="3590219">{</span><span class="op" id="3590220">}</span><span class="op" id="3590221">,</span>&nbsp;<span class="ident" id="3590223">name</span><span class="op" id="3590227">,</span>&nbsp;<span class="ident" id="3590229">tag</span>&nbsp;<span class="builtintype" id="3590233">string</span><span class="op" id="3590239">)</span>&nbsp;<span class="op" id="3590241">(</span><span class="ident" id="3590242">ok</span>&nbsp;<span class="builtintype" id="3590245">bool</span><span class="op" id="3590249">)</span><span class="op" id="3590250">)</span>&nbsp;<span class="op" id="3590252">(</span><span class="ident" id="3590253">ok</span>&nbsp;<span class="builtintype" id="3590256">bool</span><span class="op" id="3590260">)</span><br>
<span class="lineno"></span><span class="op" id="3590262">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="3590265">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3590311">type</span>&nbsp;<span class="ident" id="3590316">dnsHeader</span>&nbsp;<span class="keyword" id="3590326">struct</span>&nbsp;<span class="op" id="3590333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590336">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3590371">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590379">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3590414">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590422">Qdcount</span><span class="op" id="3590429">,</span>&nbsp;<span class="ident" id="3590431">Ancount</span><span class="op" id="3590438">,</span>&nbsp;<span class="ident" id="3590440">Nscount</span><span class="op" id="3590447">,</span>&nbsp;<span class="ident" id="3590449">Arcount</span>&nbsp;<span class="builtintype" id="3590457">uint16</span><br>
<span class="lineno">90</span><span class="op" id="3590464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3590467">func</span>&nbsp;<span class="op" id="3590472">(</span><span class="ident" id="3590473">h</span>&nbsp;<span class="op" id="3590475">*</span><span class="ident" id="3590476">dnsHeader</span><span class="op" id="3590485">)</span>&nbsp;<span class="ident" id="3590487">Walk</span><span class="op" id="3590491">(</span><span class="ident" id="3590492">f</span>&nbsp;<span class="keyword" id="3590494">func</span><span class="op" id="3590498">(</span><span class="ident" id="3590499">v</span>&nbsp;<span class="keyword" id="3590501">interface</span><span class="op" id="3590510">{</span><span class="op" id="3590511">}</span><span class="op" id="3590512">,</span>&nbsp;<span class="ident" id="3590514">name</span><span class="op" id="3590518">,</span>&nbsp;<span class="ident" id="3590520">tag</span>&nbsp;<span class="builtintype" id="3590524">string</span><span class="op" id="3590530">)</span>&nbsp;<span class="builtintype" id="3590532">bool</span><span class="op" id="3590536">)</span>&nbsp;<span class="builtintype" id="3590538">bool</span>&nbsp;<span class="op" id="3590543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3590546">return</span>&nbsp;<span class="ident" id="3590553">f</span><span class="op" id="3590554">(</span><span class="op" id="3590555">&amp;</span><span class="ident" id="3590556">h</span><span class="op" id="3590557">.</span><span class="ident" id="3590558">Id</span><span class="op" id="3590560">,</span>&nbsp;<span class="string" id="3590562">&#34;Id&#34;</span><span class="op" id="3590566">,</span>&nbsp;<span class="string" id="3590568">&#34;&#34;</span><span class="op" id="3590570">)</span>&nbsp;<span class="op" id="3590572">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590577">f</span><span class="op" id="3590578">(</span><span class="op" id="3590579">&amp;</span><span class="ident" id="3590580">h</span><span class="op" id="3590581">.</span><span class="ident" id="3590582">Bits</span><span class="op" id="3590586">,</span>&nbsp;<span class="string" id="3590588">&#34;Bits&#34;</span><span class="op" id="3590594">,</span>&nbsp;<span class="string" id="3590596">&#34;&#34;</span><span class="op" id="3590598">)</span>&nbsp;<span class="op" id="3590600">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590605">f</span><span class="op" id="3590606">(</span><span class="op" id="3590607">&amp;</span><span class="ident" id="3590608">h</span><span class="op" id="3590609">.</span><span class="ident" id="3590610">Qdcount</span><span class="op" id="3590617">,</span>&nbsp;<span class="string" id="3590619">&#34;Qdcount&#34;</span><span class="op" id="3590628">,</span>&nbsp;<span class="string" id="3590630">&#34;&#34;</span><span class="op" id="3590632">)</span>&nbsp;<span class="op" id="3590634">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590639">f</span><span class="op" id="3590640">(</span><span class="op" id="3590641">&amp;</span><span class="ident" id="3590642">h</span><span class="op" id="3590643">.</span><span class="ident" id="3590644">Ancount</span><span class="op" id="3590651">,</span>&nbsp;<span class="string" id="3590653">&#34;Ancount&#34;</span><span class="op" id="3590662">,</span>&nbsp;<span class="string" id="3590664">&#34;&#34;</span><span class="op" id="3590666">)</span>&nbsp;<span class="op" id="3590668">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590673">f</span><span class="op" id="3590674">(</span><span class="op" id="3590675">&amp;</span><span class="ident" id="3590676">h</span><span class="op" id="3590677">.</span><span class="ident" id="3590678">Nscount</span><span class="op" id="3590685">,</span>&nbsp;<span class="string" id="3590687">&#34;Nscount&#34;</span><span class="op" id="3590696">,</span>&nbsp;<span class="string" id="3590698">&#34;&#34;</span><span class="op" id="3590700">)</span>&nbsp;<span class="op" id="3590702">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590707">f</span><span class="op" id="3590708">(</span><span class="op" id="3590709">&amp;</span><span class="ident" id="3590710">h</span><span class="op" id="3590711">.</span><span class="ident" id="3590712">Arcount</span><span class="op" id="3590719">,</span>&nbsp;<span class="string" id="3590721">&#34;Arcount&#34;</span><span class="op" id="3590730">,</span>&nbsp;<span class="string" id="3590732">&#34;&#34;</span><span class="op" id="3590734">)</span><br>
<span class="lineno"></span><span class="op" id="3590736">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="3590739">const</span>&nbsp;<span class="op" id="3590745">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3590748">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590767">_QR</span>&nbsp;<span class="op" id="3590771">=</span>&nbsp;<span class="num" id="3590773">1</span>&nbsp;<span class="op" id="3590775">&lt;&lt;</span>&nbsp;<span class="num" id="3590778">15</span>&nbsp;<span class="comment" id="3590781">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590813">_AA</span>&nbsp;<span class="op" id="3590817">=</span>&nbsp;<span class="num" id="3590819">1</span>&nbsp;<span class="op" id="3590821">&lt;&lt;</span>&nbsp;<span class="num" id="3590824">10</span>&nbsp;<span class="comment" id="3590827">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590845">_TC</span>&nbsp;<span class="op" id="3590849">=</span>&nbsp;<span class="num" id="3590851">1</span>&nbsp;<span class="op" id="3590853">&lt;&lt;</span>&nbsp;<span class="num" id="3590856">9</span>&nbsp;&nbsp;<span class="comment" id="3590859">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590873">_RD</span>&nbsp;<span class="op" id="3590877">=</span>&nbsp;<span class="num" id="3590879">1</span>&nbsp;<span class="op" id="3590881">&lt;&lt;</span>&nbsp;<span class="num" id="3590884">8</span>&nbsp;&nbsp;<span class="comment" id="3590887">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590909">_RA</span>&nbsp;<span class="op" id="3590913">=</span>&nbsp;<span class="num" id="3590915">1</span>&nbsp;<span class="op" id="3590917">&lt;&lt;</span>&nbsp;<span class="num" id="3590920">7</span>&nbsp;&nbsp;<span class="comment" id="3590923">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="3590946">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="3590949">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="3590965">type</span>&nbsp;<span class="ident" id="3590970">dnsQuestion</span>&nbsp;<span class="keyword" id="3590982">struct</span>&nbsp;<span class="op" id="3590989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3590992">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3590999">string</span>&nbsp;<span class="string" id="3591006">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="3591026">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591088">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="3591095">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591103">Qclass</span>&nbsp;<span class="builtintype" id="3591110">uint16</span><br>
<span class="lineno">115</span><span class="op" id="3591117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3591120">func</span>&nbsp;<span class="op" id="3591125">(</span><span class="ident" id="3591126">q</span>&nbsp;<span class="op" id="3591128">*</span><span class="ident" id="3591129">dnsQuestion</span><span class="op" id="3591140">)</span>&nbsp;<span class="ident" id="3591142">Walk</span><span class="op" id="3591146">(</span><span class="ident" id="3591147">f</span>&nbsp;<span class="keyword" id="3591149">func</span><span class="op" id="3591153">(</span><span class="ident" id="3591154">v</span>&nbsp;<span class="keyword" id="3591156">interface</span><span class="op" id="3591165">{</span><span class="op" id="3591166">}</span><span class="op" id="3591167">,</span>&nbsp;<span class="ident" id="3591169">name</span><span class="op" id="3591173">,</span>&nbsp;<span class="ident" id="3591175">tag</span>&nbsp;<span class="builtintype" id="3591179">string</span><span class="op" id="3591185">)</span>&nbsp;<span class="builtintype" id="3591187">bool</span><span class="op" id="3591191">)</span>&nbsp;<span class="builtintype" id="3591193">bool</span>&nbsp;<span class="op" id="3591198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591201">return</span>&nbsp;<span class="ident" id="3591208">f</span><span class="op" id="3591209">(</span><span class="op" id="3591210">&amp;</span><span class="ident" id="3591211">q</span><span class="op" id="3591212">.</span><span class="ident" id="3591213">Name</span><span class="op" id="3591217">,</span>&nbsp;<span class="string" id="3591219">&#34;Name&#34;</span><span class="op" id="3591225">,</span>&nbsp;<span class="string" id="3591227">&#34;domain&#34;</span><span class="op" id="3591235">)</span>&nbsp;<span class="op" id="3591237">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591242">f</span><span class="op" id="3591243">(</span><span class="op" id="3591244">&amp;</span><span class="ident" id="3591245">q</span><span class="op" id="3591246">.</span><span class="ident" id="3591247">Qtype</span><span class="op" id="3591252">,</span>&nbsp;<span class="string" id="3591254">&#34;Qtype&#34;</span><span class="op" id="3591261">,</span>&nbsp;<span class="string" id="3591263">&#34;&#34;</span><span class="op" id="3591265">)</span>&nbsp;<span class="op" id="3591267">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591272">f</span><span class="op" id="3591273">(</span><span class="op" id="3591274">&amp;</span><span class="ident" id="3591275">q</span><span class="op" id="3591276">.</span><span class="ident" id="3591277">Qclass</span><span class="op" id="3591283">,</span>&nbsp;<span class="string" id="3591285">&#34;Qclass&#34;</span><span class="op" id="3591293">,</span>&nbsp;<span class="string" id="3591295">&#34;&#34;</span><span class="op" id="3591297">)</span><br>
<span class="lineno"></span><span class="op" id="3591299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3591302">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="3591339">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="3591376">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="3591415">type</span>&nbsp;<span class="ident" id="3591420">dnsRR_Header</span>&nbsp;<span class="keyword" id="3591433">struct</span>&nbsp;<span class="op" id="3591440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591443">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3591452">string</span>&nbsp;<span class="string" id="3591459">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591480">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3591489">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591497">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3591506">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591514">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3591523">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591531">Rdlength</span>&nbsp;<span class="builtintype" id="3591540">uint16</span>&nbsp;<span class="comment" id="3591547">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="3591578">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3591581">func</span>&nbsp;<span class="op" id="3591586">(</span><span class="ident" id="3591587">h</span>&nbsp;<span class="op" id="3591589">*</span><span class="ident" id="3591590">dnsRR_Header</span><span class="op" id="3591602">)</span>&nbsp;<span class="ident" id="3591604">Header</span><span class="op" id="3591610">(</span><span class="op" id="3591611">)</span>&nbsp;<span class="op" id="3591613">*</span><span class="ident" id="3591614">dnsRR_Header</span>&nbsp;<span class="op" id="3591627">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591630">return</span>&nbsp;<span class="ident" id="3591637">h</span><br>
<span class="lineno"></span><span class="op" id="3591639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3591642">func</span>&nbsp;<span class="op" id="3591647">(</span><span class="ident" id="3591648">h</span>&nbsp;<span class="op" id="3591650">*</span><span class="ident" id="3591651">dnsRR_Header</span><span class="op" id="3591663">)</span>&nbsp;<span class="ident" id="3591665">Walk</span><span class="op" id="3591669">(</span><span class="ident" id="3591670">f</span>&nbsp;<span class="keyword" id="3591672">func</span><span class="op" id="3591676">(</span><span class="ident" id="3591677">v</span>&nbsp;<span class="keyword" id="3591679">interface</span><span class="op" id="3591688">{</span><span class="op" id="3591689">}</span><span class="op" id="3591690">,</span>&nbsp;<span class="ident" id="3591692">name</span><span class="op" id="3591696">,</span>&nbsp;<span class="ident" id="3591698">tag</span>&nbsp;<span class="builtintype" id="3591702">string</span><span class="op" id="3591708">)</span>&nbsp;<span class="builtintype" id="3591710">bool</span><span class="op" id="3591714">)</span>&nbsp;<span class="builtintype" id="3591716">bool</span>&nbsp;<span class="op" id="3591721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3591724">return</span>&nbsp;<span class="ident" id="3591731">f</span><span class="op" id="3591732">(</span><span class="op" id="3591733">&amp;</span><span class="ident" id="3591734">h</span><span class="op" id="3591735">.</span><span class="ident" id="3591736">Name</span><span class="op" id="3591740">,</span>&nbsp;<span class="string" id="3591742">&#34;Name&#34;</span><span class="op" id="3591748">,</span>&nbsp;<span class="string" id="3591750">&#34;domain&#34;</span><span class="op" id="3591758">)</span>&nbsp;<span class="op" id="3591760">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591765">f</span><span class="op" id="3591766">(</span><span class="op" id="3591767">&amp;</span><span class="ident" id="3591768">h</span><span class="op" id="3591769">.</span><span class="ident" id="3591770">Rrtype</span><span class="op" id="3591776">,</span>&nbsp;<span class="string" id="3591778">&#34;Rrtype&#34;</span><span class="op" id="3591786">,</span>&nbsp;<span class="string" id="3591788">&#34;&#34;</span><span class="op" id="3591790">)</span>&nbsp;<span class="op" id="3591792">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591797">f</span><span class="op" id="3591798">(</span><span class="op" id="3591799">&amp;</span><span class="ident" id="3591800">h</span><span class="op" id="3591801">.</span><span class="ident" id="3591802">Class</span><span class="op" id="3591807">,</span>&nbsp;<span class="string" id="3591809">&#34;Class&#34;</span><span class="op" id="3591816">,</span>&nbsp;<span class="string" id="3591818">&#34;&#34;</span><span class="op" id="3591820">)</span>&nbsp;<span class="op" id="3591822">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591827">f</span><span class="op" id="3591828">(</span><span class="op" id="3591829">&amp;</span><span class="ident" id="3591830">h</span><span class="op" id="3591831">.</span><span class="ident" id="3591832">Ttl</span><span class="op" id="3591835">,</span>&nbsp;<span class="string" id="3591837">&#34;Ttl&#34;</span><span class="op" id="3591842">,</span>&nbsp;<span class="string" id="3591844">&#34;&#34;</span><span class="op" id="3591846">)</span>&nbsp;<span class="op" id="3591848">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591853">f</span><span class="op" id="3591854">(</span><span class="op" id="3591855">&amp;</span><span class="ident" id="3591856">h</span><span class="op" id="3591857">.</span><span class="ident" id="3591858">Rdlength</span><span class="op" id="3591866">,</span>&nbsp;<span class="string" id="3591868">&#34;Rdlength&#34;</span><span class="op" id="3591878">,</span>&nbsp;<span class="string" id="3591880">&#34;&#34;</span><span class="op" id="3591882">)</span><br>
<span class="lineno"></span><span class="op" id="3591884">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="3591887">type</span>&nbsp;<span class="ident" id="3591892">dnsRR</span>&nbsp;<span class="keyword" id="3591898">interface</span>&nbsp;<span class="op" id="3591908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591911">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3591922">Header</span><span class="op" id="3591928">(</span><span class="op" id="3591929">)</span>&nbsp;<span class="op" id="3591931">*</span><span class="ident" id="3591932">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="3591945">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="3591948">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3591997">type</span>&nbsp;<span class="ident" id="3592002">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="3592014">struct</span>&nbsp;<span class="op" id="3592021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592024">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3592030">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592044">Cname</span>&nbsp;<span class="builtintype" id="3592050">string</span>&nbsp;<span class="string" id="3592057">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3592077">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592080">func</span>&nbsp;<span class="op" id="3592085">(</span><span class="ident" id="3592086">rr</span>&nbsp;<span class="op" id="3592089">*</span><span class="ident" id="3592090">dnsRR_CNAME</span><span class="op" id="3592101">)</span>&nbsp;<span class="ident" id="3592103">Header</span><span class="op" id="3592109">(</span><span class="op" id="3592110">)</span>&nbsp;<span class="op" id="3592112">*</span><span class="ident" id="3592113">dnsRR_Header</span>&nbsp;<span class="op" id="3592126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592129">return</span>&nbsp;<span class="op" id="3592136">&amp;</span><span class="ident" id="3592137">rr</span><span class="op" id="3592139">.</span><span class="ident" id="3592140">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="3592144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592147">func</span>&nbsp;<span class="op" id="3592152">(</span><span class="ident" id="3592153">rr</span>&nbsp;<span class="op" id="3592156">*</span><span class="ident" id="3592157">dnsRR_CNAME</span><span class="op" id="3592168">)</span>&nbsp;<span class="ident" id="3592170">Walk</span><span class="op" id="3592174">(</span><span class="ident" id="3592175">f</span>&nbsp;<span class="keyword" id="3592177">func</span><span class="op" id="3592181">(</span><span class="ident" id="3592182">v</span>&nbsp;<span class="keyword" id="3592184">interface</span><span class="op" id="3592193">{</span><span class="op" id="3592194">}</span><span class="op" id="3592195">,</span>&nbsp;<span class="ident" id="3592197">name</span><span class="op" id="3592201">,</span>&nbsp;<span class="ident" id="3592203">tag</span>&nbsp;<span class="builtintype" id="3592207">string</span><span class="op" id="3592213">)</span>&nbsp;<span class="builtintype" id="3592215">bool</span><span class="op" id="3592219">)</span>&nbsp;<span class="builtintype" id="3592221">bool</span>&nbsp;<span class="op" id="3592226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592229">return</span>&nbsp;<span class="ident" id="3592236">rr</span><span class="op" id="3592238">.</span><span class="ident" id="3592239">Hdr</span><span class="op" id="3592242">.</span><span class="ident" id="3592243">Walk</span><span class="op" id="3592247">(</span><span class="ident" id="3592248">f</span><span class="op" id="3592249">)</span>&nbsp;<span class="op" id="3592251">&amp;&amp;</span>&nbsp;<span class="ident" id="3592254">f</span><span class="op" id="3592255">(</span><span class="op" id="3592256">&amp;</span><span class="ident" id="3592257">rr</span><span class="op" id="3592259">.</span><span class="ident" id="3592260">Cname</span><span class="op" id="3592265">,</span>&nbsp;<span class="string" id="3592267">&#34;Cname&#34;</span><span class="op" id="3592274">,</span>&nbsp;<span class="string" id="3592276">&#34;domain&#34;</span><span class="op" id="3592284">)</span><br>
<span class="lineno"></span><span class="op" id="3592286">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="3592289">type</span>&nbsp;<span class="ident" id="3592294">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="3592306">struct</span>&nbsp;<span class="op" id="3592313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592316">Hdr</span>&nbsp;<span class="ident" id="3592320">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592334">Cpu</span>&nbsp;<span class="builtintype" id="3592338">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592346">Os</span>&nbsp;&nbsp;<span class="builtintype" id="3592350">string</span><br>
<span class="lineno">170</span><span class="op" id="3592357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592360">func</span>&nbsp;<span class="op" id="3592365">(</span><span class="ident" id="3592366">rr</span>&nbsp;<span class="op" id="3592369">*</span><span class="ident" id="3592370">dnsRR_HINFO</span><span class="op" id="3592381">)</span>&nbsp;<span class="ident" id="3592383">Header</span><span class="op" id="3592389">(</span><span class="op" id="3592390">)</span>&nbsp;<span class="op" id="3592392">*</span><span class="ident" id="3592393">dnsRR_Header</span>&nbsp;<span class="op" id="3592406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592409">return</span>&nbsp;<span class="op" id="3592416">&amp;</span><span class="ident" id="3592417">rr</span><span class="op" id="3592419">.</span><span class="ident" id="3592420">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3592424">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3592427">func</span>&nbsp;<span class="op" id="3592432">(</span><span class="ident" id="3592433">rr</span>&nbsp;<span class="op" id="3592436">*</span><span class="ident" id="3592437">dnsRR_HINFO</span><span class="op" id="3592448">)</span>&nbsp;<span class="ident" id="3592450">Walk</span><span class="op" id="3592454">(</span><span class="ident" id="3592455">f</span>&nbsp;<span class="keyword" id="3592457">func</span><span class="op" id="3592461">(</span><span class="ident" id="3592462">v</span>&nbsp;<span class="keyword" id="3592464">interface</span><span class="op" id="3592473">{</span><span class="op" id="3592474">}</span><span class="op" id="3592475">,</span>&nbsp;<span class="ident" id="3592477">name</span><span class="op" id="3592481">,</span>&nbsp;<span class="ident" id="3592483">tag</span>&nbsp;<span class="builtintype" id="3592487">string</span><span class="op" id="3592493">)</span>&nbsp;<span class="builtintype" id="3592495">bool</span><span class="op" id="3592499">)</span>&nbsp;<span class="builtintype" id="3592501">bool</span>&nbsp;<span class="op" id="3592506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592509">return</span>&nbsp;<span class="ident" id="3592516">rr</span><span class="op" id="3592518">.</span><span class="ident" id="3592519">Hdr</span><span class="op" id="3592522">.</span><span class="ident" id="3592523">Walk</span><span class="op" id="3592527">(</span><span class="ident" id="3592528">f</span><span class="op" id="3592529">)</span>&nbsp;<span class="op" id="3592531">&amp;&amp;</span>&nbsp;<span class="ident" id="3592534">f</span><span class="op" id="3592535">(</span><span class="op" id="3592536">&amp;</span><span class="ident" id="3592537">rr</span><span class="op" id="3592539">.</span><span class="ident" id="3592540">Cpu</span><span class="op" id="3592543">,</span>&nbsp;<span class="string" id="3592545">&#34;Cpu&#34;</span><span class="op" id="3592550">,</span>&nbsp;<span class="string" id="3592552">&#34;&#34;</span><span class="op" id="3592554">)</span>&nbsp;<span class="op" id="3592556">&amp;&amp;</span>&nbsp;<span class="ident" id="3592559">f</span><span class="op" id="3592560">(</span><span class="op" id="3592561">&amp;</span><span class="ident" id="3592562">rr</span><span class="op" id="3592564">.</span><span class="ident" id="3592565">Os</span><span class="op" id="3592567">,</span>&nbsp;<span class="string" id="3592569">&#34;Os&#34;</span><span class="op" id="3592573">,</span>&nbsp;<span class="string" id="3592575">&#34;&#34;</span><span class="op" id="3592577">)</span><br>
<span class="lineno"></span><span class="op" id="3592579">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3592582">type</span>&nbsp;<span class="ident" id="3592587">dnsRR_MB</span>&nbsp;<span class="keyword" id="3592596">struct</span>&nbsp;<span class="op" id="3592603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592606">Hdr</span>&nbsp;<span class="ident" id="3592610">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592624">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="3592628">string</span>&nbsp;<span class="string" id="3592635">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3592655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3592658">func</span>&nbsp;<span class="op" id="3592663">(</span><span class="ident" id="3592664">rr</span>&nbsp;<span class="op" id="3592667">*</span><span class="ident" id="3592668">dnsRR_MB</span><span class="op" id="3592676">)</span>&nbsp;<span class="ident" id="3592678">Header</span><span class="op" id="3592684">(</span><span class="op" id="3592685">)</span>&nbsp;<span class="op" id="3592687">*</span><span class="ident" id="3592688">dnsRR_Header</span>&nbsp;<span class="op" id="3592701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592704">return</span>&nbsp;<span class="op" id="3592711">&amp;</span><span class="ident" id="3592712">rr</span><span class="op" id="3592714">.</span><span class="ident" id="3592715">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3592719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592722">func</span>&nbsp;<span class="op" id="3592727">(</span><span class="ident" id="3592728">rr</span>&nbsp;<span class="op" id="3592731">*</span><span class="ident" id="3592732">dnsRR_MB</span><span class="op" id="3592740">)</span>&nbsp;<span class="ident" id="3592742">Walk</span><span class="op" id="3592746">(</span><span class="ident" id="3592747">f</span>&nbsp;<span class="keyword" id="3592749">func</span><span class="op" id="3592753">(</span><span class="ident" id="3592754">v</span>&nbsp;<span class="keyword" id="3592756">interface</span><span class="op" id="3592765">{</span><span class="op" id="3592766">}</span><span class="op" id="3592767">,</span>&nbsp;<span class="ident" id="3592769">name</span><span class="op" id="3592773">,</span>&nbsp;<span class="ident" id="3592775">tag</span>&nbsp;<span class="builtintype" id="3592779">string</span><span class="op" id="3592785">)</span>&nbsp;<span class="builtintype" id="3592787">bool</span><span class="op" id="3592791">)</span>&nbsp;<span class="builtintype" id="3592793">bool</span>&nbsp;<span class="op" id="3592798">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592801">return</span>&nbsp;<span class="ident" id="3592808">rr</span><span class="op" id="3592810">.</span><span class="ident" id="3592811">Hdr</span><span class="op" id="3592814">.</span><span class="ident" id="3592815">Walk</span><span class="op" id="3592819">(</span><span class="ident" id="3592820">f</span><span class="op" id="3592821">)</span>&nbsp;<span class="op" id="3592823">&amp;&amp;</span>&nbsp;<span class="ident" id="3592826">f</span><span class="op" id="3592827">(</span><span class="op" id="3592828">&amp;</span><span class="ident" id="3592829">rr</span><span class="op" id="3592831">.</span><span class="ident" id="3592832">Mb</span><span class="op" id="3592834">,</span>&nbsp;<span class="string" id="3592836">&#34;Mb&#34;</span><span class="op" id="3592840">,</span>&nbsp;<span class="string" id="3592842">&#34;domain&#34;</span><span class="op" id="3592850">)</span><br>
<span class="lineno"></span><span class="op" id="3592852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592855">type</span>&nbsp;<span class="ident" id="3592860">dnsRR_MG</span>&nbsp;<span class="keyword" id="3592869">struct</span>&nbsp;<span class="op" id="3592876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592879">Hdr</span>&nbsp;<span class="ident" id="3592883">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3592897">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="3592901">string</span>&nbsp;<span class="string" id="3592908">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3592928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592931">func</span>&nbsp;<span class="op" id="3592936">(</span><span class="ident" id="3592937">rr</span>&nbsp;<span class="op" id="3592940">*</span><span class="ident" id="3592941">dnsRR_MG</span><span class="op" id="3592949">)</span>&nbsp;<span class="ident" id="3592951">Header</span><span class="op" id="3592957">(</span><span class="op" id="3592958">)</span>&nbsp;<span class="op" id="3592960">*</span><span class="ident" id="3592961">dnsRR_Header</span>&nbsp;<span class="op" id="3592974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3592977">return</span>&nbsp;<span class="op" id="3592984">&amp;</span><span class="ident" id="3592985">rr</span><span class="op" id="3592987">.</span><span class="ident" id="3592988">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="3592992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3592995">func</span>&nbsp;<span class="op" id="3593000">(</span><span class="ident" id="3593001">rr</span>&nbsp;<span class="op" id="3593004">*</span><span class="ident" id="3593005">dnsRR_MG</span><span class="op" id="3593013">)</span>&nbsp;<span class="ident" id="3593015">Walk</span><span class="op" id="3593019">(</span><span class="ident" id="3593020">f</span>&nbsp;<span class="keyword" id="3593022">func</span><span class="op" id="3593026">(</span><span class="ident" id="3593027">v</span>&nbsp;<span class="keyword" id="3593029">interface</span><span class="op" id="3593038">{</span><span class="op" id="3593039">}</span><span class="op" id="3593040">,</span>&nbsp;<span class="ident" id="3593042">name</span><span class="op" id="3593046">,</span>&nbsp;<span class="ident" id="3593048">tag</span>&nbsp;<span class="builtintype" id="3593052">string</span><span class="op" id="3593058">)</span>&nbsp;<span class="builtintype" id="3593060">bool</span><span class="op" id="3593064">)</span>&nbsp;<span class="builtintype" id="3593066">bool</span>&nbsp;<span class="op" id="3593071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593074">return</span>&nbsp;<span class="ident" id="3593081">rr</span><span class="op" id="3593083">.</span><span class="ident" id="3593084">Hdr</span><span class="op" id="3593087">.</span><span class="ident" id="3593088">Walk</span><span class="op" id="3593092">(</span><span class="ident" id="3593093">f</span><span class="op" id="3593094">)</span>&nbsp;<span class="op" id="3593096">&amp;&amp;</span>&nbsp;<span class="ident" id="3593099">f</span><span class="op" id="3593100">(</span><span class="op" id="3593101">&amp;</span><span class="ident" id="3593102">rr</span><span class="op" id="3593104">.</span><span class="ident" id="3593105">Mg</span><span class="op" id="3593107">,</span>&nbsp;<span class="string" id="3593109">&#34;Mg&#34;</span><span class="op" id="3593113">,</span>&nbsp;<span class="string" id="3593115">&#34;domain&#34;</span><span class="op" id="3593123">)</span><br>
<span class="lineno"></span><span class="op" id="3593125">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="3593128">type</span>&nbsp;<span class="ident" id="3593133">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="3593145">struct</span>&nbsp;<span class="op" id="3593152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593155">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3593161">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593175">Rmail</span>&nbsp;<span class="builtintype" id="3593181">string</span>&nbsp;<span class="string" id="3593188">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593209">Email</span>&nbsp;<span class="builtintype" id="3593215">string</span>&nbsp;<span class="string" id="3593222">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="3593242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593245">func</span>&nbsp;<span class="op" id="3593250">(</span><span class="ident" id="3593251">rr</span>&nbsp;<span class="op" id="3593254">*</span><span class="ident" id="3593255">dnsRR_MINFO</span><span class="op" id="3593266">)</span>&nbsp;<span class="ident" id="3593268">Header</span><span class="op" id="3593274">(</span><span class="op" id="3593275">)</span>&nbsp;<span class="op" id="3593277">*</span><span class="ident" id="3593278">dnsRR_Header</span>&nbsp;<span class="op" id="3593291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593294">return</span>&nbsp;<span class="op" id="3593301">&amp;</span><span class="ident" id="3593302">rr</span><span class="op" id="3593304">.</span><span class="ident" id="3593305">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3593309">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="3593312">func</span>&nbsp;<span class="op" id="3593317">(</span><span class="ident" id="3593318">rr</span>&nbsp;<span class="op" id="3593321">*</span><span class="ident" id="3593322">dnsRR_MINFO</span><span class="op" id="3593333">)</span>&nbsp;<span class="ident" id="3593335">Walk</span><span class="op" id="3593339">(</span><span class="ident" id="3593340">f</span>&nbsp;<span class="keyword" id="3593342">func</span><span class="op" id="3593346">(</span><span class="ident" id="3593347">v</span>&nbsp;<span class="keyword" id="3593349">interface</span><span class="op" id="3593358">{</span><span class="op" id="3593359">}</span><span class="op" id="3593360">,</span>&nbsp;<span class="ident" id="3593362">name</span><span class="op" id="3593366">,</span>&nbsp;<span class="ident" id="3593368">tag</span>&nbsp;<span class="builtintype" id="3593372">string</span><span class="op" id="3593378">)</span>&nbsp;<span class="builtintype" id="3593380">bool</span><span class="op" id="3593384">)</span>&nbsp;<span class="builtintype" id="3593386">bool</span>&nbsp;<span class="op" id="3593391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593394">return</span>&nbsp;<span class="ident" id="3593401">rr</span><span class="op" id="3593403">.</span><span class="ident" id="3593404">Hdr</span><span class="op" id="3593407">.</span><span class="ident" id="3593408">Walk</span><span class="op" id="3593412">(</span><span class="ident" id="3593413">f</span><span class="op" id="3593414">)</span>&nbsp;<span class="op" id="3593416">&amp;&amp;</span>&nbsp;<span class="ident" id="3593419">f</span><span class="op" id="3593420">(</span><span class="op" id="3593421">&amp;</span><span class="ident" id="3593422">rr</span><span class="op" id="3593424">.</span><span class="ident" id="3593425">Rmail</span><span class="op" id="3593430">,</span>&nbsp;<span class="string" id="3593432">&#34;Rmail&#34;</span><span class="op" id="3593439">,</span>&nbsp;<span class="string" id="3593441">&#34;domain&#34;</span><span class="op" id="3593449">)</span>&nbsp;<span class="op" id="3593451">&amp;&amp;</span>&nbsp;<span class="ident" id="3593454">f</span><span class="op" id="3593455">(</span><span class="op" id="3593456">&amp;</span><span class="ident" id="3593457">rr</span><span class="op" id="3593459">.</span><span class="ident" id="3593460">Email</span><span class="op" id="3593465">,</span>&nbsp;<span class="string" id="3593467">&#34;Email&#34;</span><span class="op" id="3593474">,</span>&nbsp;<span class="string" id="3593476">&#34;domain&#34;</span><span class="op" id="3593484">)</span><br>
<span class="lineno"></span><span class="op" id="3593486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="3593489">type</span>&nbsp;<span class="ident" id="3593494">dnsRR_MR</span>&nbsp;<span class="keyword" id="3593503">struct</span>&nbsp;<span class="op" id="3593510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593513">Hdr</span>&nbsp;<span class="ident" id="3593517">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593531">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="3593535">string</span>&nbsp;<span class="string" id="3593542">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3593562">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="3593565">func</span>&nbsp;<span class="op" id="3593570">(</span><span class="ident" id="3593571">rr</span>&nbsp;<span class="op" id="3593574">*</span><span class="ident" id="3593575">dnsRR_MR</span><span class="op" id="3593583">)</span>&nbsp;<span class="ident" id="3593585">Header</span><span class="op" id="3593591">(</span><span class="op" id="3593592">)</span>&nbsp;<span class="op" id="3593594">*</span><span class="ident" id="3593595">dnsRR_Header</span>&nbsp;<span class="op" id="3593608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593611">return</span>&nbsp;<span class="op" id="3593618">&amp;</span><span class="ident" id="3593619">rr</span><span class="op" id="3593621">.</span><span class="ident" id="3593622">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3593626">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593629">func</span>&nbsp;<span class="op" id="3593634">(</span><span class="ident" id="3593635">rr</span>&nbsp;<span class="op" id="3593638">*</span><span class="ident" id="3593639">dnsRR_MR</span><span class="op" id="3593647">)</span>&nbsp;<span class="ident" id="3593649">Walk</span><span class="op" id="3593653">(</span><span class="ident" id="3593654">f</span>&nbsp;<span class="keyword" id="3593656">func</span><span class="op" id="3593660">(</span><span class="ident" id="3593661">v</span>&nbsp;<span class="keyword" id="3593663">interface</span><span class="op" id="3593672">{</span><span class="op" id="3593673">}</span><span class="op" id="3593674">,</span>&nbsp;<span class="ident" id="3593676">name</span><span class="op" id="3593680">,</span>&nbsp;<span class="ident" id="3593682">tag</span>&nbsp;<span class="builtintype" id="3593686">string</span><span class="op" id="3593692">)</span>&nbsp;<span class="builtintype" id="3593694">bool</span><span class="op" id="3593698">)</span>&nbsp;<span class="builtintype" id="3593700">bool</span>&nbsp;<span class="op" id="3593705">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593708">return</span>&nbsp;<span class="ident" id="3593715">rr</span><span class="op" id="3593717">.</span><span class="ident" id="3593718">Hdr</span><span class="op" id="3593721">.</span><span class="ident" id="3593722">Walk</span><span class="op" id="3593726">(</span><span class="ident" id="3593727">f</span><span class="op" id="3593728">)</span>&nbsp;<span class="op" id="3593730">&amp;&amp;</span>&nbsp;<span class="ident" id="3593733">f</span><span class="op" id="3593734">(</span><span class="op" id="3593735">&amp;</span><span class="ident" id="3593736">rr</span><span class="op" id="3593738">.</span><span class="ident" id="3593739">Mr</span><span class="op" id="3593741">,</span>&nbsp;<span class="string" id="3593743">&#34;Mr&#34;</span><span class="op" id="3593747">,</span>&nbsp;<span class="string" id="3593749">&#34;domain&#34;</span><span class="op" id="3593757">)</span><br>
<span class="lineno"></span><span class="op" id="3593759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593762">type</span>&nbsp;<span class="ident" id="3593767">dnsRR_MX</span>&nbsp;<span class="keyword" id="3593776">struct</span>&nbsp;<span class="op" id="3593783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593786">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3593791">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593805">Pref</span>&nbsp;<span class="builtintype" id="3593810">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3593818">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3593823">string</span>&nbsp;<span class="string" id="3593830">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3593850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593853">func</span>&nbsp;<span class="op" id="3593858">(</span><span class="ident" id="3593859">rr</span>&nbsp;<span class="op" id="3593862">*</span><span class="ident" id="3593863">dnsRR_MX</span><span class="op" id="3593871">)</span>&nbsp;<span class="ident" id="3593873">Header</span><span class="op" id="3593879">(</span><span class="op" id="3593880">)</span>&nbsp;<span class="op" id="3593882">*</span><span class="ident" id="3593883">dnsRR_Header</span>&nbsp;<span class="op" id="3593896">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593899">return</span>&nbsp;<span class="op" id="3593906">&amp;</span><span class="ident" id="3593907">rr</span><span class="op" id="3593909">.</span><span class="ident" id="3593910">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3593914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3593917">func</span>&nbsp;<span class="op" id="3593922">(</span><span class="ident" id="3593923">rr</span>&nbsp;<span class="op" id="3593926">*</span><span class="ident" id="3593927">dnsRR_MX</span><span class="op" id="3593935">)</span>&nbsp;<span class="ident" id="3593937">Walk</span><span class="op" id="3593941">(</span><span class="ident" id="3593942">f</span>&nbsp;<span class="keyword" id="3593944">func</span><span class="op" id="3593948">(</span><span class="ident" id="3593949">v</span>&nbsp;<span class="keyword" id="3593951">interface</span><span class="op" id="3593960">{</span><span class="op" id="3593961">}</span><span class="op" id="3593962">,</span>&nbsp;<span class="ident" id="3593964">name</span><span class="op" id="3593968">,</span>&nbsp;<span class="ident" id="3593970">tag</span>&nbsp;<span class="builtintype" id="3593974">string</span><span class="op" id="3593980">)</span>&nbsp;<span class="builtintype" id="3593982">bool</span><span class="op" id="3593986">)</span>&nbsp;<span class="builtintype" id="3593988">bool</span>&nbsp;<span class="op" id="3593993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3593996">return</span>&nbsp;<span class="ident" id="3594003">rr</span><span class="op" id="3594005">.</span><span class="ident" id="3594006">Hdr</span><span class="op" id="3594009">.</span><span class="ident" id="3594010">Walk</span><span class="op" id="3594014">(</span><span class="ident" id="3594015">f</span><span class="op" id="3594016">)</span>&nbsp;<span class="op" id="3594018">&amp;&amp;</span>&nbsp;<span class="ident" id="3594021">f</span><span class="op" id="3594022">(</span><span class="op" id="3594023">&amp;</span><span class="ident" id="3594024">rr</span><span class="op" id="3594026">.</span><span class="ident" id="3594027">Pref</span><span class="op" id="3594031">,</span>&nbsp;<span class="string" id="3594033">&#34;Pref&#34;</span><span class="op" id="3594039">,</span>&nbsp;<span class="string" id="3594041">&#34;&#34;</span><span class="op" id="3594043">)</span>&nbsp;<span class="op" id="3594045">&amp;&amp;</span>&nbsp;<span class="ident" id="3594048">f</span><span class="op" id="3594049">(</span><span class="op" id="3594050">&amp;</span><span class="ident" id="3594051">rr</span><span class="op" id="3594053">.</span><span class="ident" id="3594054">Mx</span><span class="op" id="3594056">,</span>&nbsp;<span class="string" id="3594058">&#34;Mx&#34;</span><span class="op" id="3594062">,</span>&nbsp;<span class="string" id="3594064">&#34;domain&#34;</span><span class="op" id="3594072">)</span><br>
<span class="lineno">245</span><span class="op" id="3594074">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594077">type</span>&nbsp;<span class="ident" id="3594082">dnsRR_NS</span>&nbsp;<span class="keyword" id="3594091">struct</span>&nbsp;<span class="op" id="3594098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594101">Hdr</span>&nbsp;<span class="ident" id="3594105">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594119">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="3594123">string</span>&nbsp;<span class="string" id="3594130">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="3594150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594153">func</span>&nbsp;<span class="op" id="3594158">(</span><span class="ident" id="3594159">rr</span>&nbsp;<span class="op" id="3594162">*</span><span class="ident" id="3594163">dnsRR_NS</span><span class="op" id="3594171">)</span>&nbsp;<span class="ident" id="3594173">Header</span><span class="op" id="3594179">(</span><span class="op" id="3594180">)</span>&nbsp;<span class="op" id="3594182">*</span><span class="ident" id="3594183">dnsRR_Header</span>&nbsp;<span class="op" id="3594196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594199">return</span>&nbsp;<span class="op" id="3594206">&amp;</span><span class="ident" id="3594207">rr</span><span class="op" id="3594209">.</span><span class="ident" id="3594210">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3594214">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="3594217">func</span>&nbsp;<span class="op" id="3594222">(</span><span class="ident" id="3594223">rr</span>&nbsp;<span class="op" id="3594226">*</span><span class="ident" id="3594227">dnsRR_NS</span><span class="op" id="3594235">)</span>&nbsp;<span class="ident" id="3594237">Walk</span><span class="op" id="3594241">(</span><span class="ident" id="3594242">f</span>&nbsp;<span class="keyword" id="3594244">func</span><span class="op" id="3594248">(</span><span class="ident" id="3594249">v</span>&nbsp;<span class="keyword" id="3594251">interface</span><span class="op" id="3594260">{</span><span class="op" id="3594261">}</span><span class="op" id="3594262">,</span>&nbsp;<span class="ident" id="3594264">name</span><span class="op" id="3594268">,</span>&nbsp;<span class="ident" id="3594270">tag</span>&nbsp;<span class="builtintype" id="3594274">string</span><span class="op" id="3594280">)</span>&nbsp;<span class="builtintype" id="3594282">bool</span><span class="op" id="3594286">)</span>&nbsp;<span class="builtintype" id="3594288">bool</span>&nbsp;<span class="op" id="3594293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594296">return</span>&nbsp;<span class="ident" id="3594303">rr</span><span class="op" id="3594305">.</span><span class="ident" id="3594306">Hdr</span><span class="op" id="3594309">.</span><span class="ident" id="3594310">Walk</span><span class="op" id="3594314">(</span><span class="ident" id="3594315">f</span><span class="op" id="3594316">)</span>&nbsp;<span class="op" id="3594318">&amp;&amp;</span>&nbsp;<span class="ident" id="3594321">f</span><span class="op" id="3594322">(</span><span class="op" id="3594323">&amp;</span><span class="ident" id="3594324">rr</span><span class="op" id="3594326">.</span><span class="ident" id="3594327">Ns</span><span class="op" id="3594329">,</span>&nbsp;<span class="string" id="3594331">&#34;Ns&#34;</span><span class="op" id="3594335">,</span>&nbsp;<span class="string" id="3594337">&#34;domain&#34;</span><span class="op" id="3594345">)</span><br>
<span class="lineno"></span><span class="op" id="3594347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="3594350">type</span>&nbsp;<span class="ident" id="3594355">dnsRR_PTR</span>&nbsp;<span class="keyword" id="3594365">struct</span>&nbsp;<span class="op" id="3594372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594375">Hdr</span>&nbsp;<span class="ident" id="3594379">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594393">Ptr</span>&nbsp;<span class="builtintype" id="3594397">string</span>&nbsp;<span class="string" id="3594404">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3594424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="3594427">func</span>&nbsp;<span class="op" id="3594432">(</span><span class="ident" id="3594433">rr</span>&nbsp;<span class="op" id="3594436">*</span><span class="ident" id="3594437">dnsRR_PTR</span><span class="op" id="3594446">)</span>&nbsp;<span class="ident" id="3594448">Header</span><span class="op" id="3594454">(</span><span class="op" id="3594455">)</span>&nbsp;<span class="op" id="3594457">*</span><span class="ident" id="3594458">dnsRR_Header</span>&nbsp;<span class="op" id="3594471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594474">return</span>&nbsp;<span class="op" id="3594481">&amp;</span><span class="ident" id="3594482">rr</span><span class="op" id="3594484">.</span><span class="ident" id="3594485">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3594489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594492">func</span>&nbsp;<span class="op" id="3594497">(</span><span class="ident" id="3594498">rr</span>&nbsp;<span class="op" id="3594501">*</span><span class="ident" id="3594502">dnsRR_PTR</span><span class="op" id="3594511">)</span>&nbsp;<span class="ident" id="3594513">Walk</span><span class="op" id="3594517">(</span><span class="ident" id="3594518">f</span>&nbsp;<span class="keyword" id="3594520">func</span><span class="op" id="3594524">(</span><span class="ident" id="3594525">v</span>&nbsp;<span class="keyword" id="3594527">interface</span><span class="op" id="3594536">{</span><span class="op" id="3594537">}</span><span class="op" id="3594538">,</span>&nbsp;<span class="ident" id="3594540">name</span><span class="op" id="3594544">,</span>&nbsp;<span class="ident" id="3594546">tag</span>&nbsp;<span class="builtintype" id="3594550">string</span><span class="op" id="3594556">)</span>&nbsp;<span class="builtintype" id="3594558">bool</span><span class="op" id="3594562">)</span>&nbsp;<span class="builtintype" id="3594564">bool</span>&nbsp;<span class="op" id="3594569">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594572">return</span>&nbsp;<span class="ident" id="3594579">rr</span><span class="op" id="3594581">.</span><span class="ident" id="3594582">Hdr</span><span class="op" id="3594585">.</span><span class="ident" id="3594586">Walk</span><span class="op" id="3594590">(</span><span class="ident" id="3594591">f</span><span class="op" id="3594592">)</span>&nbsp;<span class="op" id="3594594">&amp;&amp;</span>&nbsp;<span class="ident" id="3594597">f</span><span class="op" id="3594598">(</span><span class="op" id="3594599">&amp;</span><span class="ident" id="3594600">rr</span><span class="op" id="3594602">.</span><span class="ident" id="3594603">Ptr</span><span class="op" id="3594606">,</span>&nbsp;<span class="string" id="3594608">&#34;Ptr&#34;</span><span class="op" id="3594613">,</span>&nbsp;<span class="string" id="3594615">&#34;domain&#34;</span><span class="op" id="3594623">)</span><br>
<span class="lineno"></span><span class="op" id="3594625">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594628">type</span>&nbsp;<span class="ident" id="3594633">dnsRR_SOA</span>&nbsp;<span class="keyword" id="3594643">struct</span>&nbsp;<span class="op" id="3594650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594653">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3594661">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594675">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3594683">string</span>&nbsp;<span class="string" id="3594690">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594711">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3594719">string</span>&nbsp;<span class="string" id="3594726">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594747">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="3594755">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594763">Refresh</span>&nbsp;<span class="builtintype" id="3594771">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594779">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3594787">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594795">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="3594803">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3594811">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="3594819">uint32</span><br>
<span class="lineno"></span><span class="op" id="3594826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594829">func</span>&nbsp;<span class="op" id="3594834">(</span><span class="ident" id="3594835">rr</span>&nbsp;<span class="op" id="3594838">*</span><span class="ident" id="3594839">dnsRR_SOA</span><span class="op" id="3594848">)</span>&nbsp;<span class="ident" id="3594850">Header</span><span class="op" id="3594856">(</span><span class="op" id="3594857">)</span>&nbsp;<span class="op" id="3594859">*</span><span class="ident" id="3594860">dnsRR_Header</span>&nbsp;<span class="op" id="3594873">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594876">return</span>&nbsp;<span class="op" id="3594883">&amp;</span><span class="ident" id="3594884">rr</span><span class="op" id="3594886">.</span><span class="ident" id="3594887">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3594891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3594894">func</span>&nbsp;<span class="op" id="3594899">(</span><span class="ident" id="3594900">rr</span>&nbsp;<span class="op" id="3594903">*</span><span class="ident" id="3594904">dnsRR_SOA</span><span class="op" id="3594913">)</span>&nbsp;<span class="ident" id="3594915">Walk</span><span class="op" id="3594919">(</span><span class="ident" id="3594920">f</span>&nbsp;<span class="keyword" id="3594922">func</span><span class="op" id="3594926">(</span><span class="ident" id="3594927">v</span>&nbsp;<span class="keyword" id="3594929">interface</span><span class="op" id="3594938">{</span><span class="op" id="3594939">}</span><span class="op" id="3594940">,</span>&nbsp;<span class="ident" id="3594942">name</span><span class="op" id="3594946">,</span>&nbsp;<span class="ident" id="3594948">tag</span>&nbsp;<span class="builtintype" id="3594952">string</span><span class="op" id="3594958">)</span>&nbsp;<span class="builtintype" id="3594960">bool</span><span class="op" id="3594964">)</span>&nbsp;<span class="builtintype" id="3594966">bool</span>&nbsp;<span class="op" id="3594971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3594974">return</span>&nbsp;<span class="ident" id="3594981">rr</span><span class="op" id="3594983">.</span><span class="ident" id="3594984">Hdr</span><span class="op" id="3594987">.</span><span class="ident" id="3594988">Walk</span><span class="op" id="3594992">(</span><span class="ident" id="3594993">f</span><span class="op" id="3594994">)</span>&nbsp;<span class="op" id="3594996">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595001">f</span><span class="op" id="3595002">(</span><span class="op" id="3595003">&amp;</span><span class="ident" id="3595004">rr</span><span class="op" id="3595006">.</span><span class="ident" id="3595007">Ns</span><span class="op" id="3595009">,</span>&nbsp;<span class="string" id="3595011">&#34;Ns&#34;</span><span class="op" id="3595015">,</span>&nbsp;<span class="string" id="3595017">&#34;domain&#34;</span><span class="op" id="3595025">)</span>&nbsp;<span class="op" id="3595027">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595032">f</span><span class="op" id="3595033">(</span><span class="op" id="3595034">&amp;</span><span class="ident" id="3595035">rr</span><span class="op" id="3595037">.</span><span class="ident" id="3595038">Mbox</span><span class="op" id="3595042">,</span>&nbsp;<span class="string" id="3595044">&#34;Mbox&#34;</span><span class="op" id="3595050">,</span>&nbsp;<span class="string" id="3595052">&#34;domain&#34;</span><span class="op" id="3595060">)</span>&nbsp;<span class="op" id="3595062">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595067">f</span><span class="op" id="3595068">(</span><span class="op" id="3595069">&amp;</span><span class="ident" id="3595070">rr</span><span class="op" id="3595072">.</span><span class="ident" id="3595073">Serial</span><span class="op" id="3595079">,</span>&nbsp;<span class="string" id="3595081">&#34;Serial&#34;</span><span class="op" id="3595089">,</span>&nbsp;<span class="string" id="3595091">&#34;&#34;</span><span class="op" id="3595093">)</span>&nbsp;<span class="op" id="3595095">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595100">f</span><span class="op" id="3595101">(</span><span class="op" id="3595102">&amp;</span><span class="ident" id="3595103">rr</span><span class="op" id="3595105">.</span><span class="ident" id="3595106">Refresh</span><span class="op" id="3595113">,</span>&nbsp;<span class="string" id="3595115">&#34;Refresh&#34;</span><span class="op" id="3595124">,</span>&nbsp;<span class="string" id="3595126">&#34;&#34;</span><span class="op" id="3595128">)</span>&nbsp;<span class="op" id="3595130">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595135">f</span><span class="op" id="3595136">(</span><span class="op" id="3595137">&amp;</span><span class="ident" id="3595138">rr</span><span class="op" id="3595140">.</span><span class="ident" id="3595141">Retry</span><span class="op" id="3595146">,</span>&nbsp;<span class="string" id="3595148">&#34;Retry&#34;</span><span class="op" id="3595155">,</span>&nbsp;<span class="string" id="3595157">&#34;&#34;</span><span class="op" id="3595159">)</span>&nbsp;<span class="op" id="3595161">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595166">f</span><span class="op" id="3595167">(</span><span class="op" id="3595168">&amp;</span><span class="ident" id="3595169">rr</span><span class="op" id="3595171">.</span><span class="ident" id="3595172">Expire</span><span class="op" id="3595178">,</span>&nbsp;<span class="string" id="3595180">&#34;Expire&#34;</span><span class="op" id="3595188">,</span>&nbsp;<span class="string" id="3595190">&#34;&#34;</span><span class="op" id="3595192">)</span>&nbsp;<span class="op" id="3595194">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595199">f</span><span class="op" id="3595200">(</span><span class="op" id="3595201">&amp;</span><span class="ident" id="3595202">rr</span><span class="op" id="3595204">.</span><span class="ident" id="3595205">Minttl</span><span class="op" id="3595211">,</span>&nbsp;<span class="string" id="3595213">&#34;Minttl&#34;</span><span class="op" id="3595221">,</span>&nbsp;<span class="string" id="3595223">&#34;&#34;</span><span class="op" id="3595225">)</span><br>
<span class="lineno"></span><span class="op" id="3595227">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595230">type</span>&nbsp;<span class="ident" id="3595235">dnsRR_TXT</span>&nbsp;<span class="keyword" id="3595245">struct</span>&nbsp;<span class="op" id="3595252">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595255">Hdr</span>&nbsp;<span class="ident" id="3595259">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595273">Txt</span>&nbsp;<span class="builtintype" id="3595277">string</span>&nbsp;<span class="comment" id="3595284">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="3595303">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595306">func</span>&nbsp;<span class="op" id="3595311">(</span><span class="ident" id="3595312">rr</span>&nbsp;<span class="op" id="3595315">*</span><span class="ident" id="3595316">dnsRR_TXT</span><span class="op" id="3595325">)</span>&nbsp;<span class="ident" id="3595327">Header</span><span class="op" id="3595333">(</span><span class="op" id="3595334">)</span>&nbsp;<span class="op" id="3595336">*</span><span class="ident" id="3595337">dnsRR_Header</span>&nbsp;<span class="op" id="3595350">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595353">return</span>&nbsp;<span class="op" id="3595360">&amp;</span><span class="ident" id="3595361">rr</span><span class="op" id="3595363">.</span><span class="ident" id="3595364">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3595368">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595371">func</span>&nbsp;<span class="op" id="3595376">(</span><span class="ident" id="3595377">rr</span>&nbsp;<span class="op" id="3595380">*</span><span class="ident" id="3595381">dnsRR_TXT</span><span class="op" id="3595390">)</span>&nbsp;<span class="ident" id="3595392">Walk</span><span class="op" id="3595396">(</span><span class="ident" id="3595397">f</span>&nbsp;<span class="keyword" id="3595399">func</span><span class="op" id="3595403">(</span><span class="ident" id="3595404">v</span>&nbsp;<span class="keyword" id="3595406">interface</span><span class="op" id="3595415">{</span><span class="op" id="3595416">}</span><span class="op" id="3595417">,</span>&nbsp;<span class="ident" id="3595419">name</span><span class="op" id="3595423">,</span>&nbsp;<span class="ident" id="3595425">tag</span>&nbsp;<span class="builtintype" id="3595429">string</span><span class="op" id="3595435">)</span>&nbsp;<span class="builtintype" id="3595437">bool</span><span class="op" id="3595441">)</span>&nbsp;<span class="builtintype" id="3595443">bool</span>&nbsp;<span class="op" id="3595448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595451">return</span>&nbsp;<span class="ident" id="3595458">rr</span><span class="op" id="3595460">.</span><span class="ident" id="3595461">Hdr</span><span class="op" id="3595464">.</span><span class="ident" id="3595465">Walk</span><span class="op" id="3595469">(</span><span class="ident" id="3595470">f</span><span class="op" id="3595471">)</span>&nbsp;<span class="op" id="3595473">&amp;&amp;</span>&nbsp;<span class="ident" id="3595476">f</span><span class="op" id="3595477">(</span><span class="op" id="3595478">&amp;</span><span class="ident" id="3595479">rr</span><span class="op" id="3595481">.</span><span class="ident" id="3595482">Txt</span><span class="op" id="3595485">,</span>&nbsp;<span class="string" id="3595487">&#34;Txt&#34;</span><span class="op" id="3595492">,</span>&nbsp;<span class="string" id="3595494">&#34;&#34;</span><span class="op" id="3595496">)</span><br>
<span class="lineno">310</span><span class="op" id="3595498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595501">type</span>&nbsp;<span class="ident" id="3595506">dnsRR_SRV</span>&nbsp;<span class="keyword" id="3595516">struct</span>&nbsp;<span class="op" id="3595523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595526">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3595535">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595549">Priority</span>&nbsp;<span class="builtintype" id="3595558">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595566">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3595575">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595583">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3595592">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595600">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3595609">string</span>&nbsp;<span class="string" id="3595616">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3595636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="3595639">func</span>&nbsp;<span class="op" id="3595644">(</span><span class="ident" id="3595645">rr</span>&nbsp;<span class="op" id="3595648">*</span><span class="ident" id="3595649">dnsRR_SRV</span><span class="op" id="3595658">)</span>&nbsp;<span class="ident" id="3595660">Header</span><span class="op" id="3595666">(</span><span class="op" id="3595667">)</span>&nbsp;<span class="op" id="3595669">*</span><span class="ident" id="3595670">dnsRR_Header</span>&nbsp;<span class="op" id="3595683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595686">return</span>&nbsp;<span class="op" id="3595693">&amp;</span><span class="ident" id="3595694">rr</span><span class="op" id="3595696">.</span><span class="ident" id="3595697">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3595701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595704">func</span>&nbsp;<span class="op" id="3595709">(</span><span class="ident" id="3595710">rr</span>&nbsp;<span class="op" id="3595713">*</span><span class="ident" id="3595714">dnsRR_SRV</span><span class="op" id="3595723">)</span>&nbsp;<span class="ident" id="3595725">Walk</span><span class="op" id="3595729">(</span><span class="ident" id="3595730">f</span>&nbsp;<span class="keyword" id="3595732">func</span><span class="op" id="3595736">(</span><span class="ident" id="3595737">v</span>&nbsp;<span class="keyword" id="3595739">interface</span><span class="op" id="3595748">{</span><span class="op" id="3595749">}</span><span class="op" id="3595750">,</span>&nbsp;<span class="ident" id="3595752">name</span><span class="op" id="3595756">,</span>&nbsp;<span class="ident" id="3595758">tag</span>&nbsp;<span class="builtintype" id="3595762">string</span><span class="op" id="3595768">)</span>&nbsp;<span class="builtintype" id="3595770">bool</span><span class="op" id="3595774">)</span>&nbsp;<span class="builtintype" id="3595776">bool</span>&nbsp;<span class="op" id="3595781">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3595784">return</span>&nbsp;<span class="ident" id="3595791">rr</span><span class="op" id="3595793">.</span><span class="ident" id="3595794">Hdr</span><span class="op" id="3595797">.</span><span class="ident" id="3595798">Walk</span><span class="op" id="3595802">(</span><span class="ident" id="3595803">f</span><span class="op" id="3595804">)</span>&nbsp;<span class="op" id="3595806">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595811">f</span><span class="op" id="3595812">(</span><span class="op" id="3595813">&amp;</span><span class="ident" id="3595814">rr</span><span class="op" id="3595816">.</span><span class="ident" id="3595817">Priority</span><span class="op" id="3595825">,</span>&nbsp;<span class="string" id="3595827">&#34;Priority&#34;</span><span class="op" id="3595837">,</span>&nbsp;<span class="string" id="3595839">&#34;&#34;</span><span class="op" id="3595841">)</span>&nbsp;<span class="op" id="3595843">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595848">f</span><span class="op" id="3595849">(</span><span class="op" id="3595850">&amp;</span><span class="ident" id="3595851">rr</span><span class="op" id="3595853">.</span><span class="ident" id="3595854">Weight</span><span class="op" id="3595860">,</span>&nbsp;<span class="string" id="3595862">&#34;Weight&#34;</span><span class="op" id="3595870">,</span>&nbsp;<span class="string" id="3595872">&#34;&#34;</span><span class="op" id="3595874">)</span>&nbsp;<span class="op" id="3595876">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595881">f</span><span class="op" id="3595882">(</span><span class="op" id="3595883">&amp;</span><span class="ident" id="3595884">rr</span><span class="op" id="3595886">.</span><span class="ident" id="3595887">Port</span><span class="op" id="3595891">,</span>&nbsp;<span class="string" id="3595893">&#34;Port&#34;</span><span class="op" id="3595899">,</span>&nbsp;<span class="string" id="3595901">&#34;&#34;</span><span class="op" id="3595903">)</span>&nbsp;<span class="op" id="3595905">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595910">f</span><span class="op" id="3595911">(</span><span class="op" id="3595912">&amp;</span><span class="ident" id="3595913">rr</span><span class="op" id="3595915">.</span><span class="ident" id="3595916">Target</span><span class="op" id="3595922">,</span>&nbsp;<span class="string" id="3595924">&#34;Target&#34;</span><span class="op" id="3595932">,</span>&nbsp;<span class="string" id="3595934">&#34;domain&#34;</span><span class="op" id="3595942">)</span><br>
<span class="lineno">330</span><span class="op" id="3595944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3595947">type</span>&nbsp;<span class="ident" id="3595952">dnsRR_A</span>&nbsp;<span class="keyword" id="3595960">struct</span>&nbsp;<span class="op" id="3595967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595970">Hdr</span>&nbsp;<span class="ident" id="3595974">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3595988">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3595992">uint32</span>&nbsp;<span class="string" id="3595999">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="3596012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3596015">func</span>&nbsp;<span class="op" id="3596020">(</span><span class="ident" id="3596021">rr</span>&nbsp;<span class="op" id="3596024">*</span><span class="ident" id="3596025">dnsRR_A</span><span class="op" id="3596032">)</span>&nbsp;<span class="ident" id="3596034">Header</span><span class="op" id="3596040">(</span><span class="op" id="3596041">)</span>&nbsp;<span class="op" id="3596043">*</span><span class="ident" id="3596044">dnsRR_Header</span>&nbsp;<span class="op" id="3596057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596060">return</span>&nbsp;<span class="op" id="3596067">&amp;</span><span class="ident" id="3596068">rr</span><span class="op" id="3596070">.</span><span class="ident" id="3596071">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3596075">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="3596078">func</span>&nbsp;<span class="op" id="3596083">(</span><span class="ident" id="3596084">rr</span>&nbsp;<span class="op" id="3596087">*</span><span class="ident" id="3596088">dnsRR_A</span><span class="op" id="3596095">)</span>&nbsp;<span class="ident" id="3596097">Walk</span><span class="op" id="3596101">(</span><span class="ident" id="3596102">f</span>&nbsp;<span class="keyword" id="3596104">func</span><span class="op" id="3596108">(</span><span class="ident" id="3596109">v</span>&nbsp;<span class="keyword" id="3596111">interface</span><span class="op" id="3596120">{</span><span class="op" id="3596121">}</span><span class="op" id="3596122">,</span>&nbsp;<span class="ident" id="3596124">name</span><span class="op" id="3596128">,</span>&nbsp;<span class="ident" id="3596130">tag</span>&nbsp;<span class="builtintype" id="3596134">string</span><span class="op" id="3596140">)</span>&nbsp;<span class="builtintype" id="3596142">bool</span><span class="op" id="3596146">)</span>&nbsp;<span class="builtintype" id="3596148">bool</span>&nbsp;<span class="op" id="3596153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596156">return</span>&nbsp;<span class="ident" id="3596163">rr</span><span class="op" id="3596165">.</span><span class="ident" id="3596166">Hdr</span><span class="op" id="3596169">.</span><span class="ident" id="3596170">Walk</span><span class="op" id="3596174">(</span><span class="ident" id="3596175">f</span><span class="op" id="3596176">)</span>&nbsp;<span class="op" id="3596178">&amp;&amp;</span>&nbsp;<span class="ident" id="3596181">f</span><span class="op" id="3596182">(</span><span class="op" id="3596183">&amp;</span><span class="ident" id="3596184">rr</span><span class="op" id="3596186">.</span><span class="ident" id="3596187">A</span><span class="op" id="3596188">,</span>&nbsp;<span class="string" id="3596190">&#34;A&#34;</span><span class="op" id="3596193">,</span>&nbsp;<span class="string" id="3596195">&#34;ipv4&#34;</span><span class="op" id="3596201">)</span><br>
<span class="lineno"></span><span class="op" id="3596203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="3596206">type</span>&nbsp;<span class="ident" id="3596211">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="3596222">struct</span>&nbsp;<span class="op" id="3596229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596232">Hdr</span>&nbsp;&nbsp;<span class="ident" id="3596237">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596251">AAAA</span>&nbsp;<span class="op" id="3596256">[</span><span class="num" id="3596257">16</span><span class="op" id="3596259">]</span><span class="builtintype" id="3596260">byte</span>&nbsp;<span class="string" id="3596265">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3596278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3596281">func</span>&nbsp;<span class="op" id="3596286">(</span><span class="ident" id="3596287">rr</span>&nbsp;<span class="op" id="3596290">*</span><span class="ident" id="3596291">dnsRR_AAAA</span><span class="op" id="3596301">)</span>&nbsp;<span class="ident" id="3596303">Header</span><span class="op" id="3596309">(</span><span class="op" id="3596310">)</span>&nbsp;<span class="op" id="3596312">*</span><span class="ident" id="3596313">dnsRR_Header</span>&nbsp;<span class="op" id="3596326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596329">return</span>&nbsp;<span class="op" id="3596336">&amp;</span><span class="ident" id="3596337">rr</span><span class="op" id="3596339">.</span><span class="ident" id="3596340">Hdr</span><br>
<span class="lineno"></span><span class="op" id="3596344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3596347">func</span>&nbsp;<span class="op" id="3596352">(</span><span class="ident" id="3596353">rr</span>&nbsp;<span class="op" id="3596356">*</span><span class="ident" id="3596357">dnsRR_AAAA</span><span class="op" id="3596367">)</span>&nbsp;<span class="ident" id="3596369">Walk</span><span class="op" id="3596373">(</span><span class="ident" id="3596374">f</span>&nbsp;<span class="keyword" id="3596376">func</span><span class="op" id="3596380">(</span><span class="ident" id="3596381">v</span>&nbsp;<span class="keyword" id="3596383">interface</span><span class="op" id="3596392">{</span><span class="op" id="3596393">}</span><span class="op" id="3596394">,</span>&nbsp;<span class="ident" id="3596396">name</span><span class="op" id="3596400">,</span>&nbsp;<span class="ident" id="3596402">tag</span>&nbsp;<span class="builtintype" id="3596406">string</span><span class="op" id="3596412">)</span>&nbsp;<span class="builtintype" id="3596414">bool</span><span class="op" id="3596418">)</span>&nbsp;<span class="builtintype" id="3596420">bool</span>&nbsp;<span class="op" id="3596425">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3596428">return</span>&nbsp;<span class="ident" id="3596435">rr</span><span class="op" id="3596437">.</span><span class="ident" id="3596438">Hdr</span><span class="op" id="3596441">.</span><span class="ident" id="3596442">Walk</span><span class="op" id="3596446">(</span><span class="ident" id="3596447">f</span><span class="op" id="3596448">)</span>&nbsp;<span class="op" id="3596450">&amp;&amp;</span>&nbsp;<span class="ident" id="3596453">f</span><span class="op" id="3596454">(</span><span class="ident" id="3596455">rr</span><span class="op" id="3596457">.</span><span class="ident" id="3596458">AAAA</span><span class="op" id="3596462">[</span><span class="op" id="3596463">:</span><span class="op" id="3596464">]</span><span class="op" id="3596465">,</span>&nbsp;<span class="string" id="3596467">&#34;AAAA&#34;</span><span class="op" id="3596473">,</span>&nbsp;<span class="string" id="3596475">&#34;ipv6&#34;</span><span class="op" id="3596481">)</span><br>
<span class="lineno"></span><span class="op" id="3596483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3596486">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="3596512">//</span><br>
<span class="lineno">360</span><span class="comment" id="3596515">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="3596577">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="3596644">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="3596706">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="3596772">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="3596794">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3596840">var</span>&nbsp;<span class="ident" id="3596844">rr_mk</span>&nbsp;<span class="op" id="3596850">=</span>&nbsp;<span class="keyword" id="3596852">map</span><span class="op" id="3596855">[</span><span class="builtintype" id="3596856">int</span><span class="op" id="3596859">]</span><span class="keyword" id="3596860">func</span><span class="op" id="3596864">(</span><span class="op" id="3596865">)</span>&nbsp;<span class="ident" id="3596867">dnsRR</span><span class="op" id="3596872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596875">dnsTypeCNAME</span><span class="op" id="3596887">:</span>&nbsp;<span class="keyword" id="3596889">func</span><span class="op" id="3596893">(</span><span class="op" id="3596894">)</span>&nbsp;<span class="ident" id="3596896">dnsRR</span>&nbsp;<span class="op" id="3596902">{</span>&nbsp;<span class="keyword" id="3596904">return</span>&nbsp;<span class="builtinfunc" id="3596911">new</span><span class="op" id="3596914">(</span><span class="ident" id="3596915">dnsRR_CNAME</span><span class="op" id="3596926">)</span>&nbsp;<span class="op" id="3596928">}</span><span class="op" id="3596929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596932">dnsTypeHINFO</span><span class="op" id="3596944">:</span>&nbsp;<span class="keyword" id="3596946">func</span><span class="op" id="3596950">(</span><span class="op" id="3596951">)</span>&nbsp;<span class="ident" id="3596953">dnsRR</span>&nbsp;<span class="op" id="3596959">{</span>&nbsp;<span class="keyword" id="3596961">return</span>&nbsp;<span class="builtinfunc" id="3596968">new</span><span class="op" id="3596971">(</span><span class="ident" id="3596972">dnsRR_HINFO</span><span class="op" id="3596983">)</span>&nbsp;<span class="op" id="3596985">}</span><span class="op" id="3596986">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3596989">dnsTypeMB</span><span class="op" id="3596998">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597003">func</span><span class="op" id="3597007">(</span><span class="op" id="3597008">)</span>&nbsp;<span class="ident" id="3597010">dnsRR</span>&nbsp;<span class="op" id="3597016">{</span>&nbsp;<span class="keyword" id="3597018">return</span>&nbsp;<span class="builtinfunc" id="3597025">new</span><span class="op" id="3597028">(</span><span class="ident" id="3597029">dnsRR_MB</span><span class="op" id="3597037">)</span>&nbsp;<span class="op" id="3597039">}</span><span class="op" id="3597040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597043">dnsTypeMG</span><span class="op" id="3597052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597057">func</span><span class="op" id="3597061">(</span><span class="op" id="3597062">)</span>&nbsp;<span class="ident" id="3597064">dnsRR</span>&nbsp;<span class="op" id="3597070">{</span>&nbsp;<span class="keyword" id="3597072">return</span>&nbsp;<span class="builtinfunc" id="3597079">new</span><span class="op" id="3597082">(</span><span class="ident" id="3597083">dnsRR_MG</span><span class="op" id="3597091">)</span>&nbsp;<span class="op" id="3597093">}</span><span class="op" id="3597094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597097">dnsTypeMINFO</span><span class="op" id="3597109">:</span>&nbsp;<span class="keyword" id="3597111">func</span><span class="op" id="3597115">(</span><span class="op" id="3597116">)</span>&nbsp;<span class="ident" id="3597118">dnsRR</span>&nbsp;<span class="op" id="3597124">{</span>&nbsp;<span class="keyword" id="3597126">return</span>&nbsp;<span class="builtinfunc" id="3597133">new</span><span class="op" id="3597136">(</span><span class="ident" id="3597137">dnsRR_MINFO</span><span class="op" id="3597148">)</span>&nbsp;<span class="op" id="3597150">}</span><span class="op" id="3597151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597154">dnsTypeMR</span><span class="op" id="3597163">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597168">func</span><span class="op" id="3597172">(</span><span class="op" id="3597173">)</span>&nbsp;<span class="ident" id="3597175">dnsRR</span>&nbsp;<span class="op" id="3597181">{</span>&nbsp;<span class="keyword" id="3597183">return</span>&nbsp;<span class="builtinfunc" id="3597190">new</span><span class="op" id="3597193">(</span><span class="ident" id="3597194">dnsRR_MR</span><span class="op" id="3597202">)</span>&nbsp;<span class="op" id="3597204">}</span><span class="op" id="3597205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597208">dnsTypeMX</span><span class="op" id="3597217">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597222">func</span><span class="op" id="3597226">(</span><span class="op" id="3597227">)</span>&nbsp;<span class="ident" id="3597229">dnsRR</span>&nbsp;<span class="op" id="3597235">{</span>&nbsp;<span class="keyword" id="3597237">return</span>&nbsp;<span class="builtinfunc" id="3597244">new</span><span class="op" id="3597247">(</span><span class="ident" id="3597248">dnsRR_MX</span><span class="op" id="3597256">)</span>&nbsp;<span class="op" id="3597258">}</span><span class="op" id="3597259">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597262">dnsTypeNS</span><span class="op" id="3597271">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597276">func</span><span class="op" id="3597280">(</span><span class="op" id="3597281">)</span>&nbsp;<span class="ident" id="3597283">dnsRR</span>&nbsp;<span class="op" id="3597289">{</span>&nbsp;<span class="keyword" id="3597291">return</span>&nbsp;<span class="builtinfunc" id="3597298">new</span><span class="op" id="3597301">(</span><span class="ident" id="3597302">dnsRR_NS</span><span class="op" id="3597310">)</span>&nbsp;<span class="op" id="3597312">}</span><span class="op" id="3597313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597316">dnsTypePTR</span><span class="op" id="3597326">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597330">func</span><span class="op" id="3597334">(</span><span class="op" id="3597335">)</span>&nbsp;<span class="ident" id="3597337">dnsRR</span>&nbsp;<span class="op" id="3597343">{</span>&nbsp;<span class="keyword" id="3597345">return</span>&nbsp;<span class="builtinfunc" id="3597352">new</span><span class="op" id="3597355">(</span><span class="ident" id="3597356">dnsRR_PTR</span><span class="op" id="3597365">)</span>&nbsp;<span class="op" id="3597367">}</span><span class="op" id="3597368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597371">dnsTypeSOA</span><span class="op" id="3597381">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597385">func</span><span class="op" id="3597389">(</span><span class="op" id="3597390">)</span>&nbsp;<span class="ident" id="3597392">dnsRR</span>&nbsp;<span class="op" id="3597398">{</span>&nbsp;<span class="keyword" id="3597400">return</span>&nbsp;<span class="builtinfunc" id="3597407">new</span><span class="op" id="3597410">(</span><span class="ident" id="3597411">dnsRR_SOA</span><span class="op" id="3597420">)</span>&nbsp;<span class="op" id="3597422">}</span><span class="op" id="3597423">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597426">dnsTypeTXT</span><span class="op" id="3597436">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597440">func</span><span class="op" id="3597444">(</span><span class="op" id="3597445">)</span>&nbsp;<span class="ident" id="3597447">dnsRR</span>&nbsp;<span class="op" id="3597453">{</span>&nbsp;<span class="keyword" id="3597455">return</span>&nbsp;<span class="builtinfunc" id="3597462">new</span><span class="op" id="3597465">(</span><span class="ident" id="3597466">dnsRR_TXT</span><span class="op" id="3597475">)</span>&nbsp;<span class="op" id="3597477">}</span><span class="op" id="3597478">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597481">dnsTypeSRV</span><span class="op" id="3597491">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597495">func</span><span class="op" id="3597499">(</span><span class="op" id="3597500">)</span>&nbsp;<span class="ident" id="3597502">dnsRR</span>&nbsp;<span class="op" id="3597508">{</span>&nbsp;<span class="keyword" id="3597510">return</span>&nbsp;<span class="builtinfunc" id="3597517">new</span><span class="op" id="3597520">(</span><span class="ident" id="3597521">dnsRR_SRV</span><span class="op" id="3597530">)</span>&nbsp;<span class="op" id="3597532">}</span><span class="op" id="3597533">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597536">dnsTypeA</span><span class="op" id="3597544">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3597550">func</span><span class="op" id="3597554">(</span><span class="op" id="3597555">)</span>&nbsp;<span class="ident" id="3597557">dnsRR</span>&nbsp;<span class="op" id="3597563">{</span>&nbsp;<span class="keyword" id="3597565">return</span>&nbsp;<span class="builtinfunc" id="3597572">new</span><span class="op" id="3597575">(</span><span class="ident" id="3597576">dnsRR_A</span><span class="op" id="3597583">)</span>&nbsp;<span class="op" id="3597585">}</span><span class="op" id="3597586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597589">dnsTypeAAAA</span><span class="op" id="3597600">:</span>&nbsp;&nbsp;<span class="keyword" id="3597603">func</span><span class="op" id="3597607">(</span><span class="op" id="3597608">)</span>&nbsp;<span class="ident" id="3597610">dnsRR</span>&nbsp;<span class="op" id="3597616">{</span>&nbsp;<span class="keyword" id="3597618">return</span>&nbsp;<span class="builtinfunc" id="3597625">new</span><span class="op" id="3597628">(</span><span class="ident" id="3597629">dnsRR_AAAA</span><span class="op" id="3597639">)</span>&nbsp;<span class="op" id="3597641">}</span><span class="op" id="3597642">,</span><br>
<span class="lineno"></span><span class="op" id="3597644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3597647">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="3597687">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="3597737">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3597796">func</span>&nbsp;<span class="ident" id="3597801">packDomainName</span><span class="op" id="3597815">(</span><span class="ident" id="3597816">s</span>&nbsp;<span class="builtintype" id="3597818">string</span><span class="op" id="3597824">,</span>&nbsp;<span class="ident" id="3597826">msg</span>&nbsp;<span class="op" id="3597830">[</span><span class="op" id="3597831">]</span><span class="builtintype" id="3597832">byte</span><span class="op" id="3597836">,</span>&nbsp;<span class="ident" id="3597838">off</span>&nbsp;<span class="builtintype" id="3597842">int</span><span class="op" id="3597845">)</span>&nbsp;<span class="op" id="3597847">(</span><span class="ident" id="3597848">off1</span>&nbsp;<span class="builtintype" id="3597853">int</span><span class="op" id="3597856">,</span>&nbsp;<span class="ident" id="3597858">ok</span>&nbsp;<span class="builtintype" id="3597861">bool</span><span class="op" id="3597865">)</span>&nbsp;<span class="op" id="3597867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3597870">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3597913">if</span>&nbsp;<span class="ident" id="3597916">n</span>&nbsp;<span class="op" id="3597918">:=</span>&nbsp;<span class="builtinfunc" id="3597921">len</span><span class="op" id="3597924">(</span><span class="ident" id="3597925">s</span><span class="op" id="3597926">)</span><span class="op" id="3597927">;</span>&nbsp;<span class="ident" id="3597929">n</span>&nbsp;<span class="op" id="3597931">==</span>&nbsp;<span class="num" id="3597934">0</span>&nbsp;<span class="op" id="3597936">||</span>&nbsp;<span class="ident" id="3597939">s</span><span class="op" id="3597940">[</span><span class="ident" id="3597941">n</span><span class="op" id="3597942">-</span><span class="num" id="3597943">1</span><span class="op" id="3597944">]</span>&nbsp;<span class="op" id="3597946">!=</span>&nbsp;<span class="string" id="3597949">&#39;.&#39;</span>&nbsp;<span class="op" id="3597953">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3597957">s</span>&nbsp;<span class="op" id="3597959">+=</span>&nbsp;<span class="string" id="3597962">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3597967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3597971">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3598012">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3598058">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3598093">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598139">tot</span>&nbsp;<span class="op" id="3598143">:=</span>&nbsp;<span class="builtinfunc" id="3598146">len</span><span class="op" id="3598149">(</span><span class="ident" id="3598150">s</span><span class="op" id="3598151">)</span>&nbsp;<span class="op" id="3598153">+</span>&nbsp;<span class="num" id="3598155">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598158">if</span>&nbsp;<span class="ident" id="3598161">off</span><span class="op" id="3598164">+</span><span class="ident" id="3598165">tot</span>&nbsp;<span class="op" id="3598169">&gt;</span>&nbsp;<span class="builtinfunc" id="3598171">len</span><span class="op" id="3598174">(</span><span class="ident" id="3598175">msg</span><span class="op" id="3598178">)</span>&nbsp;<span class="op" id="3598180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598184">return</span>&nbsp;<span class="builtinfunc" id="3598191">len</span><span class="op" id="3598194">(</span><span class="ident" id="3598195">msg</span><span class="op" id="3598198">)</span><span class="op" id="3598199">,</span>&nbsp;<span class="builtintype" id="3598201">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3598212">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598268">begin</span>&nbsp;<span class="op" id="3598274">:=</span>&nbsp;<span class="num" id="3598277">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598280">for</span>&nbsp;<span class="ident" id="3598284">i</span>&nbsp;<span class="op" id="3598286">:=</span>&nbsp;<span class="num" id="3598289">0</span><span class="op" id="3598290">;</span>&nbsp;<span class="ident" id="3598292">i</span>&nbsp;<span class="op" id="3598294">&lt;</span>&nbsp;<span class="builtinfunc" id="3598296">len</span><span class="op" id="3598299">(</span><span class="ident" id="3598300">s</span><span class="op" id="3598301">)</span><span class="op" id="3598302">;</span>&nbsp;<span class="ident" id="3598304">i</span><span class="op" id="3598305">++</span>&nbsp;<span class="op" id="3598308">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598312">if</span>&nbsp;<span class="ident" id="3598315">s</span><span class="op" id="3598316">[</span><span class="ident" id="3598317">i</span><span class="op" id="3598318">]</span>&nbsp;<span class="op" id="3598320">==</span>&nbsp;<span class="string" id="3598323">&#39;.&#39;</span>&nbsp;<span class="op" id="3598327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598332">if</span>&nbsp;<span class="ident" id="3598335">i</span><span class="op" id="3598336">-</span><span class="ident" id="3598337">begin</span>&nbsp;<span class="op" id="3598343">&gt;=</span>&nbsp;<span class="num" id="3598346">1</span><span class="op" id="3598347">&lt;&lt;</span><span class="num" id="3598349">6</span>&nbsp;<span class="op" id="3598351">{</span>&nbsp;<span class="comment" id="3598353">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598397">return</span>&nbsp;<span class="builtinfunc" id="3598404">len</span><span class="op" id="3598407">(</span><span class="ident" id="3598408">msg</span><span class="op" id="3598411">)</span><span class="op" id="3598412">,</span>&nbsp;<span class="builtintype" id="3598414">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598428">msg</span><span class="op" id="3598431">[</span><span class="ident" id="3598432">off</span><span class="op" id="3598435">]</span>&nbsp;<span class="op" id="3598437">=</span>&nbsp;<span class="builtintype" id="3598439">byte</span><span class="op" id="3598443">(</span><span class="ident" id="3598444">i</span>&nbsp;<span class="op" id="3598446">-</span>&nbsp;<span class="ident" id="3598448">begin</span><span class="op" id="3598453">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598458">off</span><span class="op" id="3598461">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598467">for</span>&nbsp;<span class="ident" id="3598471">j</span>&nbsp;<span class="op" id="3598473">:=</span>&nbsp;<span class="ident" id="3598476">begin</span><span class="op" id="3598481">;</span>&nbsp;<span class="ident" id="3598483">j</span>&nbsp;<span class="op" id="3598485">&lt;</span>&nbsp;<span class="ident" id="3598487">i</span><span class="op" id="3598488">;</span>&nbsp;<span class="ident" id="3598490">j</span><span class="op" id="3598491">++</span>&nbsp;<span class="op" id="3598494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598500">msg</span><span class="op" id="3598503">[</span><span class="ident" id="3598504">off</span><span class="op" id="3598507">]</span>&nbsp;<span class="op" id="3598509">=</span>&nbsp;<span class="ident" id="3598511">s</span><span class="op" id="3598512">[</span><span class="ident" id="3598513">j</span><span class="op" id="3598514">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598520">off</span><span class="op" id="3598523">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598529">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598534">begin</span>&nbsp;<span class="op" id="3598540">=</span>&nbsp;<span class="ident" id="3598542">i</span>&nbsp;<span class="op" id="3598544">+</span>&nbsp;<span class="num" id="3598546">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3598553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598556">msg</span><span class="op" id="3598559">[</span><span class="ident" id="3598560">off</span><span class="op" id="3598563">]</span>&nbsp;<span class="op" id="3598565">=</span>&nbsp;<span class="num" id="3598567">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3598570">off</span><span class="op" id="3598573">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3598577">return</span>&nbsp;<span class="ident" id="3598584">off</span><span class="op" id="3598587">,</span>&nbsp;<span class="builtintype" id="3598589">true</span><br>
<span class="lineno"></span><span class="op" id="3598594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3598597">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="3598622">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="3598687">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3598752">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="3598813">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="3598874">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="3598937">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="3599006">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="3599044">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="3599093">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="3599159">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="3599205">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="3599267">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="3599328">func</span>&nbsp;<span class="ident" id="3599333">unpackDomainName</span><span class="op" id="3599349">(</span><span class="ident" id="3599350">msg</span>&nbsp;<span class="op" id="3599354">[</span><span class="op" id="3599355">]</span><span class="builtintype" id="3599356">byte</span><span class="op" id="3599360">,</span>&nbsp;<span class="ident" id="3599362">off</span>&nbsp;<span class="builtintype" id="3599366">int</span><span class="op" id="3599369">)</span>&nbsp;<span class="op" id="3599371">(</span><span class="ident" id="3599372">s</span>&nbsp;<span class="builtintype" id="3599374">string</span><span class="op" id="3599380">,</span>&nbsp;<span class="ident" id="3599382">off1</span>&nbsp;<span class="builtintype" id="3599387">int</span><span class="op" id="3599390">,</span>&nbsp;<span class="ident" id="3599392">ok</span>&nbsp;<span class="builtintype" id="3599395">bool</span><span class="op" id="3599399">)</span>&nbsp;<span class="op" id="3599401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599404">s</span>&nbsp;<span class="op" id="3599406">=</span>&nbsp;<span class="string" id="3599408">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599412">ptr</span>&nbsp;<span class="op" id="3599416">:=</span>&nbsp;<span class="num" id="3599419">0</span>&nbsp;<span class="comment" id="3599421">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="3599452">Loop</span><span class="op" id="3599456">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599459">for</span>&nbsp;<span class="op" id="3599463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599467">if</span>&nbsp;<span class="ident" id="3599470">off</span>&nbsp;<span class="op" id="3599474">&gt;=</span>&nbsp;<span class="builtinfunc" id="3599477">len</span><span class="op" id="3599480">(</span><span class="ident" id="3599481">msg</span><span class="op" id="3599484">)</span>&nbsp;<span class="op" id="3599486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599491">return</span>&nbsp;<span class="string" id="3599498">&#34;&#34;</span><span class="op" id="3599500">,</span>&nbsp;<span class="builtinfunc" id="3599502">len</span><span class="op" id="3599505">(</span><span class="ident" id="3599506">msg</span><span class="op" id="3599509">)</span><span class="op" id="3599510">,</span>&nbsp;<span class="builtintype" id="3599512">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599524">c</span>&nbsp;<span class="op" id="3599526">:=</span>&nbsp;<span class="builtintype" id="3599529">int</span><span class="op" id="3599532">(</span><span class="ident" id="3599533">msg</span><span class="op" id="3599536">[</span><span class="ident" id="3599537">off</span><span class="op" id="3599540">]</span><span class="op" id="3599541">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599545">off</span><span class="op" id="3599548">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599553">switch</span>&nbsp;<span class="ident" id="3599560">c</span>&nbsp;<span class="op" id="3599562">&amp;</span>&nbsp;<span class="num" id="3599564">0xC0</span>&nbsp;<span class="op" id="3599569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599573">case</span>&nbsp;<span class="num" id="3599578">0x00</span><span class="op" id="3599582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599587">if</span>&nbsp;<span class="ident" id="3599590">c</span>&nbsp;<span class="op" id="3599592">==</span>&nbsp;<span class="num" id="3599595">0x00</span>&nbsp;<span class="op" id="3599600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599606">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599625">break</span>&nbsp;<span class="ident" id="3599631">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599644">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599665">if</span>&nbsp;<span class="ident" id="3599668">off</span><span class="op" id="3599671">+</span><span class="ident" id="3599672">c</span>&nbsp;<span class="op" id="3599674">&gt;</span>&nbsp;<span class="builtinfunc" id="3599676">len</span><span class="op" id="3599679">(</span><span class="ident" id="3599680">msg</span><span class="op" id="3599683">)</span>&nbsp;<span class="op" id="3599685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599691">return</span>&nbsp;<span class="string" id="3599698">&#34;&#34;</span><span class="op" id="3599700">,</span>&nbsp;<span class="builtinfunc" id="3599702">len</span><span class="op" id="3599705">(</span><span class="ident" id="3599706">msg</span><span class="op" id="3599709">)</span><span class="op" id="3599710">,</span>&nbsp;<span class="builtintype" id="3599712">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3599721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599726">s</span>&nbsp;<span class="op" id="3599728">+=</span>&nbsp;<span class="builtintype" id="3599731">string</span><span class="op" id="3599737">(</span><span class="ident" id="3599738">msg</span><span class="op" id="3599741">[</span><span class="ident" id="3599742">off</span><span class="op" id="3599745">:</span><span class="ident" id="3599746">off</span><span class="op" id="3599749">+</span><span class="ident" id="3599750">c</span><span class="op" id="3599751">]</span><span class="op" id="3599752">)</span>&nbsp;<span class="op" id="3599754">+</span>&nbsp;<span class="string" id="3599756">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3599763">off</span>&nbsp;<span class="op" id="3599767">+=</span>&nbsp;<span class="ident" id="3599770">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599774">case</span>&nbsp;<span class="num" id="3599779">0xC0</span><span class="op" id="3599783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599788">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599828">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599869">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599916">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3599962">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3599990">if</span>&nbsp;<span class="ident" id="3599993">off</span>&nbsp;<span class="op" id="3599997">&gt;=</span>&nbsp;<span class="builtinfunc" id="3600000">len</span><span class="op" id="3600003">(</span><span class="ident" id="3600004">msg</span><span class="op" id="3600007">)</span>&nbsp;<span class="op" id="3600009">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600015">return</span>&nbsp;<span class="string" id="3600022">&#34;&#34;</span><span class="op" id="3600024">,</span>&nbsp;<span class="builtinfunc" id="3600026">len</span><span class="op" id="3600029">(</span><span class="ident" id="3600030">msg</span><span class="op" id="3600033">)</span><span class="op" id="3600034">,</span>&nbsp;<span class="builtintype" id="3600036">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600050">c1</span>&nbsp;<span class="op" id="3600053">:=</span>&nbsp;<span class="ident" id="3600056">msg</span><span class="op" id="3600059">[</span><span class="ident" id="3600060">off</span><span class="op" id="3600063">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600068">off</span><span class="op" id="3600071">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600077">if</span>&nbsp;<span class="ident" id="3600080">ptr</span>&nbsp;<span class="op" id="3600084">==</span>&nbsp;<span class="num" id="3600087">0</span>&nbsp;<span class="op" id="3600089">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600095">off1</span>&nbsp;<span class="op" id="3600100">=</span>&nbsp;<span class="ident" id="3600102">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600114">if</span>&nbsp;<span class="ident" id="3600117">ptr</span><span class="op" id="3600120">++</span><span class="op" id="3600122">;</span>&nbsp;<span class="ident" id="3600124">ptr</span>&nbsp;<span class="op" id="3600128">&gt;</span>&nbsp;<span class="num" id="3600130">10</span>&nbsp;<span class="op" id="3600133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600139">return</span>&nbsp;<span class="string" id="3600146">&#34;&#34;</span><span class="op" id="3600148">,</span>&nbsp;<span class="builtinfunc" id="3600150">len</span><span class="op" id="3600153">(</span><span class="ident" id="3600154">msg</span><span class="op" id="3600157">)</span><span class="op" id="3600158">,</span>&nbsp;<span class="builtintype" id="3600160">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600169">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600174">off</span>&nbsp;<span class="op" id="3600178">=</span>&nbsp;<span class="op" id="3600180">(</span><span class="ident" id="3600181">c</span><span class="op" id="3600182">^</span><span class="num" id="3600183">0xC0</span><span class="op" id="3600187">)</span><span class="op" id="3600188">&lt;&lt;</span><span class="num" id="3600190">8</span>&nbsp;<span class="op" id="3600192">|</span>&nbsp;<span class="builtintype" id="3600194">int</span><span class="op" id="3600197">(</span><span class="ident" id="3600198">c1</span><span class="op" id="3600200">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600204">default</span><span class="op" id="3600211">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3600216">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600249">return</span>&nbsp;<span class="string" id="3600256">&#34;&#34;</span><span class="op" id="3600258">,</span>&nbsp;<span class="builtinfunc" id="3600260">len</span><span class="op" id="3600263">(</span><span class="ident" id="3600264">msg</span><span class="op" id="3600267">)</span><span class="op" id="3600268">,</span>&nbsp;<span class="builtintype" id="3600270">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600278">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600284">if</span>&nbsp;<span class="ident" id="3600287">ptr</span>&nbsp;<span class="op" id="3600291">==</span>&nbsp;<span class="num" id="3600294">0</span>&nbsp;<span class="op" id="3600296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600300">off1</span>&nbsp;<span class="op" id="3600305">=</span>&nbsp;<span class="ident" id="3600307">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600315">return</span>&nbsp;<span class="ident" id="3600322">s</span><span class="op" id="3600323">,</span>&nbsp;<span class="ident" id="3600325">off1</span><span class="op" id="3600329">,</span>&nbsp;<span class="builtintype" id="3600331">true</span><br>
<span class="lineno">485</span><span class="op" id="3600336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3600339">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3600409">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3600470">func</span>&nbsp;<span class="ident" id="3600475">packStruct</span><span class="op" id="3600485">(</span><span class="ident" id="3600486">any</span>&nbsp;<span class="ident" id="3600490">dnsStruct</span><span class="op" id="3600499">,</span>&nbsp;<span class="ident" id="3600501">msg</span>&nbsp;<span class="op" id="3600505">[</span><span class="op" id="3600506">]</span><span class="builtintype" id="3600507">byte</span><span class="op" id="3600511">,</span>&nbsp;<span class="ident" id="3600513">off</span>&nbsp;<span class="builtintype" id="3600517">int</span><span class="op" id="3600520">)</span>&nbsp;<span class="op" id="3600522">(</span><span class="ident" id="3600523">off1</span>&nbsp;<span class="builtintype" id="3600528">int</span><span class="op" id="3600531">,</span>&nbsp;<span class="ident" id="3600533">ok</span>&nbsp;<span class="builtintype" id="3600536">bool</span><span class="op" id="3600540">)</span>&nbsp;<span class="op" id="3600542">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600545">ok</span>&nbsp;<span class="op" id="3600548">=</span>&nbsp;<span class="ident" id="3600550">any</span><span class="op" id="3600553">.</span><span class="ident" id="3600554">Walk</span><span class="op" id="3600558">(</span><span class="keyword" id="3600559">func</span><span class="op" id="3600563">(</span><span class="ident" id="3600564">field</span>&nbsp;<span class="keyword" id="3600570">interface</span><span class="op" id="3600579">{</span><span class="op" id="3600580">}</span><span class="op" id="3600581">,</span>&nbsp;<span class="ident" id="3600583">name</span><span class="op" id="3600587">,</span>&nbsp;<span class="ident" id="3600589">tag</span>&nbsp;<span class="builtintype" id="3600593">string</span><span class="op" id="3600599">)</span>&nbsp;<span class="builtintype" id="3600601">bool</span>&nbsp;<span class="op" id="3600606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600610">switch</span>&nbsp;<span class="ident" id="3600617">fv</span>&nbsp;<span class="op" id="3600620">:=</span>&nbsp;<span class="ident" id="3600623">field</span><span class="op" id="3600628">.</span><span class="op" id="3600629">(</span><span class="keyword" id="3600630">type</span><span class="op" id="3600634">)</span>&nbsp;<span class="op" id="3600636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600640">default</span><span class="op" id="3600647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3600652">println</span><span class="op" id="3600659">(</span><span class="string" id="3600660">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3600692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600697">return</span>&nbsp;<span class="builtintype" id="3600704">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600712">case</span>&nbsp;<span class="op" id="3600717">*</span><span class="builtintype" id="3600718">uint16</span><span class="op" id="3600724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600729">i</span>&nbsp;<span class="op" id="3600731">:=</span>&nbsp;<span class="op" id="3600734">*</span><span class="ident" id="3600735">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600741">if</span>&nbsp;<span class="ident" id="3600744">off</span><span class="op" id="3600747">+</span><span class="num" id="3600748">2</span>&nbsp;<span class="op" id="3600750">&gt;</span>&nbsp;<span class="builtinfunc" id="3600752">len</span><span class="op" id="3600755">(</span><span class="ident" id="3600756">msg</span><span class="op" id="3600759">)</span>&nbsp;<span class="op" id="3600761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600767">return</span>&nbsp;<span class="builtintype" id="3600774">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600783">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600788">msg</span><span class="op" id="3600791">[</span><span class="ident" id="3600792">off</span><span class="op" id="3600795">]</span>&nbsp;<span class="op" id="3600797">=</span>&nbsp;<span class="builtintype" id="3600799">byte</span><span class="op" id="3600803">(</span><span class="ident" id="3600804">i</span>&nbsp;<span class="op" id="3600806">&gt;&gt;</span>&nbsp;<span class="num" id="3600809">8</span><span class="op" id="3600810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600815">msg</span><span class="op" id="3600818">[</span><span class="ident" id="3600819">off</span><span class="op" id="3600822">+</span><span class="num" id="3600823">1</span><span class="op" id="3600824">]</span>&nbsp;<span class="op" id="3600826">=</span>&nbsp;<span class="builtintype" id="3600828">byte</span><span class="op" id="3600832">(</span><span class="ident" id="3600833">i</span><span class="op" id="3600834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600839">off</span>&nbsp;<span class="op" id="3600843">+=</span>&nbsp;<span class="num" id="3600846">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3600850">case</span>&nbsp;<span class="op" id="3600855">*</span><span class="builtintype" id="3600856">uint32</span><span class="op" id="3600862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600867">i</span>&nbsp;<span class="op" id="3600869">:=</span>&nbsp;<span class="op" id="3600872">*</span><span class="ident" id="3600873">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600879">msg</span><span class="op" id="3600882">[</span><span class="ident" id="3600883">off</span><span class="op" id="3600886">]</span>&nbsp;<span class="op" id="3600888">=</span>&nbsp;<span class="builtintype" id="3600890">byte</span><span class="op" id="3600894">(</span><span class="ident" id="3600895">i</span>&nbsp;<span class="op" id="3600897">&gt;&gt;</span>&nbsp;<span class="num" id="3600900">24</span><span class="op" id="3600902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600907">msg</span><span class="op" id="3600910">[</span><span class="ident" id="3600911">off</span><span class="op" id="3600914">+</span><span class="num" id="3600915">1</span><span class="op" id="3600916">]</span>&nbsp;<span class="op" id="3600918">=</span>&nbsp;<span class="builtintype" id="3600920">byte</span><span class="op" id="3600924">(</span><span class="ident" id="3600925">i</span>&nbsp;<span class="op" id="3600927">&gt;&gt;</span>&nbsp;<span class="num" id="3600930">16</span><span class="op" id="3600932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600937">msg</span><span class="op" id="3600940">[</span><span class="ident" id="3600941">off</span><span class="op" id="3600944">+</span><span class="num" id="3600945">2</span><span class="op" id="3600946">]</span>&nbsp;<span class="op" id="3600948">=</span>&nbsp;<span class="builtintype" id="3600950">byte</span><span class="op" id="3600954">(</span><span class="ident" id="3600955">i</span>&nbsp;<span class="op" id="3600957">&gt;&gt;</span>&nbsp;<span class="num" id="3600960">8</span><span class="op" id="3600961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600966">msg</span><span class="op" id="3600969">[</span><span class="ident" id="3600970">off</span><span class="op" id="3600973">+</span><span class="num" id="3600974">3</span><span class="op" id="3600975">]</span>&nbsp;<span class="op" id="3600977">=</span>&nbsp;<span class="builtintype" id="3600979">byte</span><span class="op" id="3600983">(</span><span class="ident" id="3600984">i</span><span class="op" id="3600985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600990">off</span>&nbsp;<span class="op" id="3600994">+=</span>&nbsp;<span class="num" id="3600997">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601001">case</span>&nbsp;<span class="op" id="3601006">[</span><span class="op" id="3601007">]</span><span class="builtintype" id="3601008">byte</span><span class="op" id="3601012">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601017">n</span>&nbsp;<span class="op" id="3601019">:=</span>&nbsp;<span class="builtinfunc" id="3601022">len</span><span class="op" id="3601025">(</span><span class="ident" id="3601026">fv</span><span class="op" id="3601028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601033">if</span>&nbsp;<span class="ident" id="3601036">off</span><span class="op" id="3601039">+</span><span class="ident" id="3601040">n</span>&nbsp;<span class="op" id="3601042">&gt;</span>&nbsp;<span class="builtinfunc" id="3601044">len</span><span class="op" id="3601047">(</span><span class="ident" id="3601048">msg</span><span class="op" id="3601051">)</span>&nbsp;<span class="op" id="3601053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601059">return</span>&nbsp;<span class="builtintype" id="3601066">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601075">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3601080">copy</span><span class="op" id="3601084">(</span><span class="ident" id="3601085">msg</span><span class="op" id="3601088">[</span><span class="ident" id="3601089">off</span><span class="op" id="3601092">:</span><span class="ident" id="3601093">off</span><span class="op" id="3601096">+</span><span class="ident" id="3601097">n</span><span class="op" id="3601098">]</span><span class="op" id="3601099">,</span>&nbsp;<span class="ident" id="3601101">fv</span><span class="op" id="3601103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601108">off</span>&nbsp;<span class="op" id="3601112">+=</span>&nbsp;<span class="ident" id="3601115">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601119">case</span>&nbsp;<span class="op" id="3601124">*</span><span class="builtintype" id="3601125">string</span><span class="op" id="3601131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601136">s</span>&nbsp;<span class="op" id="3601138">:=</span>&nbsp;<span class="op" id="3601141">*</span><span class="ident" id="3601142">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601148">switch</span>&nbsp;<span class="ident" id="3601155">tag</span>&nbsp;<span class="op" id="3601159">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601164">default</span><span class="op" id="3601171">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3601177">println</span><span class="op" id="3601184">(</span><span class="string" id="3601185">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3601215">,</span>&nbsp;<span class="ident" id="3601217">tag</span><span class="op" id="3601220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601226">return</span>&nbsp;<span class="builtintype" id="3601233">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601242">case</span>&nbsp;<span class="string" id="3601247">&#34;domain&#34;</span><span class="op" id="3601255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601261">off</span><span class="op" id="3601264">,</span>&nbsp;<span class="ident" id="3601266">ok</span>&nbsp;<span class="op" id="3601269">=</span>&nbsp;<span class="ident" id="3601271">packDomainName</span><span class="op" id="3601285">(</span><span class="ident" id="3601286">s</span><span class="op" id="3601287">,</span>&nbsp;<span class="ident" id="3601289">msg</span><span class="op" id="3601292">,</span>&nbsp;<span class="ident" id="3601294">off</span><span class="op" id="3601297">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601303">if</span>&nbsp;<span class="op" id="3601306">!</span><span class="ident" id="3601307">ok</span>&nbsp;<span class="op" id="3601310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601317">return</span>&nbsp;<span class="builtintype" id="3601324">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601339">case</span>&nbsp;<span class="string" id="3601344">&#34;&#34;</span><span class="op" id="3601346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3601352">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601390">if</span>&nbsp;<span class="builtinfunc" id="3601393">len</span><span class="op" id="3601396">(</span><span class="ident" id="3601397">s</span><span class="op" id="3601398">)</span>&nbsp;<span class="op" id="3601400">&gt;</span>&nbsp;<span class="num" id="3601402">255</span>&nbsp;<span class="op" id="3601406">||</span>&nbsp;<span class="ident" id="3601409">off</span><span class="op" id="3601412">+</span><span class="num" id="3601413">1</span><span class="op" id="3601414">+</span><span class="builtinfunc" id="3601415">len</span><span class="op" id="3601418">(</span><span class="ident" id="3601419">s</span><span class="op" id="3601420">)</span>&nbsp;<span class="op" id="3601422">&gt;</span>&nbsp;<span class="builtinfunc" id="3601424">len</span><span class="op" id="3601427">(</span><span class="ident" id="3601428">msg</span><span class="op" id="3601431">)</span>&nbsp;<span class="op" id="3601433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601440">return</span>&nbsp;<span class="builtintype" id="3601447">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601457">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601463">msg</span><span class="op" id="3601466">[</span><span class="ident" id="3601467">off</span><span class="op" id="3601470">]</span>&nbsp;<span class="op" id="3601472">=</span>&nbsp;<span class="builtintype" id="3601474">byte</span><span class="op" id="3601478">(</span><span class="builtinfunc" id="3601479">len</span><span class="op" id="3601482">(</span><span class="ident" id="3601483">s</span><span class="op" id="3601484">)</span><span class="op" id="3601485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601491">off</span><span class="op" id="3601494">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601501">off</span>&nbsp;<span class="op" id="3601505">+=</span>&nbsp;<span class="builtinfunc" id="3601508">copy</span><span class="op" id="3601512">(</span><span class="ident" id="3601513">msg</span><span class="op" id="3601516">[</span><span class="ident" id="3601517">off</span><span class="op" id="3601520">:</span><span class="op" id="3601521">]</span><span class="op" id="3601522">,</span>&nbsp;<span class="ident" id="3601524">s</span><span class="op" id="3601525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601530">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601538">return</span>&nbsp;<span class="builtintype" id="3601545">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601551">}</span><span class="op" id="3601552">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601555">if</span>&nbsp;<span class="op" id="3601558">!</span><span class="ident" id="3601559">ok</span>&nbsp;<span class="op" id="3601562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601566">return</span>&nbsp;<span class="builtinfunc" id="3601573">len</span><span class="op" id="3601576">(</span><span class="ident" id="3601577">msg</span><span class="op" id="3601580">)</span><span class="op" id="3601581">,</span>&nbsp;<span class="builtintype" id="3601583">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601593">return</span>&nbsp;<span class="ident" id="3601600">off</span><span class="op" id="3601603">,</span>&nbsp;<span class="builtintype" id="3601605">true</span><br>
<span class="lineno"></span><span class="op" id="3601610">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="3601613">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:] into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3601678">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3601739">func</span>&nbsp;<span class="ident" id="3601744">unpackStruct</span><span class="op" id="3601756">(</span><span class="ident" id="3601757">any</span>&nbsp;<span class="ident" id="3601761">dnsStruct</span><span class="op" id="3601770">,</span>&nbsp;<span class="ident" id="3601772">msg</span>&nbsp;<span class="op" id="3601776">[</span><span class="op" id="3601777">]</span><span class="builtintype" id="3601778">byte</span><span class="op" id="3601782">,</span>&nbsp;<span class="ident" id="3601784">off</span>&nbsp;<span class="builtintype" id="3601788">int</span><span class="op" id="3601791">)</span>&nbsp;<span class="op" id="3601793">(</span><span class="ident" id="3601794">off1</span>&nbsp;<span class="builtintype" id="3601799">int</span><span class="op" id="3601802">,</span>&nbsp;<span class="ident" id="3601804">ok</span>&nbsp;<span class="builtintype" id="3601807">bool</span><span class="op" id="3601811">)</span>&nbsp;<span class="op" id="3601813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601816">ok</span>&nbsp;<span class="op" id="3601819">=</span>&nbsp;<span class="ident" id="3601821">any</span><span class="op" id="3601824">.</span><span class="ident" id="3601825">Walk</span><span class="op" id="3601829">(</span><span class="keyword" id="3601830">func</span><span class="op" id="3601834">(</span><span class="ident" id="3601835">field</span>&nbsp;<span class="keyword" id="3601841">interface</span><span class="op" id="3601850">{</span><span class="op" id="3601851">}</span><span class="op" id="3601852">,</span>&nbsp;<span class="ident" id="3601854">name</span><span class="op" id="3601858">,</span>&nbsp;<span class="ident" id="3601860">tag</span>&nbsp;<span class="builtintype" id="3601864">string</span><span class="op" id="3601870">)</span>&nbsp;<span class="builtintype" id="3601872">bool</span>&nbsp;<span class="op" id="3601877">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601881">switch</span>&nbsp;<span class="ident" id="3601888">fv</span>&nbsp;<span class="op" id="3601891">:=</span>&nbsp;<span class="ident" id="3601894">field</span><span class="op" id="3601899">.</span><span class="op" id="3601900">(</span><span class="keyword" id="3601901">type</span><span class="op" id="3601905">)</span>&nbsp;<span class="op" id="3601907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601911">default</span><span class="op" id="3601918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3601923">println</span><span class="op" id="3601930">(</span><span class="string" id="3601931">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="3601963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601968">return</span>&nbsp;<span class="builtintype" id="3601975">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601983">case</span>&nbsp;<span class="op" id="3601988">*</span><span class="builtintype" id="3601989">uint16</span><span class="op" id="3601995">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602000">if</span>&nbsp;<span class="ident" id="3602003">off</span><span class="op" id="3602006">+</span><span class="num" id="3602007">2</span>&nbsp;<span class="op" id="3602009">&gt;</span>&nbsp;<span class="builtinfunc" id="3602011">len</span><span class="op" id="3602014">(</span><span class="ident" id="3602015">msg</span><span class="op" id="3602018">)</span>&nbsp;<span class="op" id="3602020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602026">return</span>&nbsp;<span class="builtintype" id="3602033">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602047">*</span><span class="ident" id="3602048">fv</span>&nbsp;<span class="op" id="3602051">=</span>&nbsp;<span class="builtintype" id="3602053">uint16</span><span class="op" id="3602059">(</span><span class="ident" id="3602060">msg</span><span class="op" id="3602063">[</span><span class="ident" id="3602064">off</span><span class="op" id="3602067">]</span><span class="op" id="3602068">)</span><span class="op" id="3602069">&lt;&lt;</span><span class="num" id="3602071">8</span>&nbsp;<span class="op" id="3602073">|</span>&nbsp;<span class="builtintype" id="3602075">uint16</span><span class="op" id="3602081">(</span><span class="ident" id="3602082">msg</span><span class="op" id="3602085">[</span><span class="ident" id="3602086">off</span><span class="op" id="3602089">+</span><span class="num" id="3602090">1</span><span class="op" id="3602091">]</span><span class="op" id="3602092">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602097">off</span>&nbsp;<span class="op" id="3602101">+=</span>&nbsp;<span class="num" id="3602104">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602108">case</span>&nbsp;<span class="op" id="3602113">*</span><span class="builtintype" id="3602114">uint32</span><span class="op" id="3602120">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602125">if</span>&nbsp;<span class="ident" id="3602128">off</span><span class="op" id="3602131">+</span><span class="num" id="3602132">4</span>&nbsp;<span class="op" id="3602134">&gt;</span>&nbsp;<span class="builtinfunc" id="3602136">len</span><span class="op" id="3602139">(</span><span class="ident" id="3602140">msg</span><span class="op" id="3602143">)</span>&nbsp;<span class="op" id="3602145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602151">return</span>&nbsp;<span class="builtintype" id="3602158">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602167">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602172">*</span><span class="ident" id="3602173">fv</span>&nbsp;<span class="op" id="3602176">=</span>&nbsp;<span class="builtintype" id="3602178">uint32</span><span class="op" id="3602184">(</span><span class="ident" id="3602185">msg</span><span class="op" id="3602188">[</span><span class="ident" id="3602189">off</span><span class="op" id="3602192">]</span><span class="op" id="3602193">)</span><span class="op" id="3602194">&lt;&lt;</span><span class="num" id="3602196">24</span>&nbsp;<span class="op" id="3602199">|</span>&nbsp;<span class="builtintype" id="3602201">uint32</span><span class="op" id="3602207">(</span><span class="ident" id="3602208">msg</span><span class="op" id="3602211">[</span><span class="ident" id="3602212">off</span><span class="op" id="3602215">+</span><span class="num" id="3602216">1</span><span class="op" id="3602217">]</span><span class="op" id="3602218">)</span><span class="op" id="3602219">&lt;&lt;</span><span class="num" id="3602221">16</span>&nbsp;<span class="op" id="3602224">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3602230">uint32</span><span class="op" id="3602236">(</span><span class="ident" id="3602237">msg</span><span class="op" id="3602240">[</span><span class="ident" id="3602241">off</span><span class="op" id="3602244">+</span><span class="num" id="3602245">2</span><span class="op" id="3602246">]</span><span class="op" id="3602247">)</span><span class="op" id="3602248">&lt;&lt;</span><span class="num" id="3602250">8</span>&nbsp;<span class="op" id="3602252">|</span>&nbsp;<span class="builtintype" id="3602254">uint32</span><span class="op" id="3602260">(</span><span class="ident" id="3602261">msg</span><span class="op" id="3602264">[</span><span class="ident" id="3602265">off</span><span class="op" id="3602268">+</span><span class="num" id="3602269">3</span><span class="op" id="3602270">]</span><span class="op" id="3602271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602276">off</span>&nbsp;<span class="op" id="3602280">+=</span>&nbsp;<span class="num" id="3602283">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602287">case</span>&nbsp;<span class="op" id="3602292">[</span><span class="op" id="3602293">]</span><span class="builtintype" id="3602294">byte</span><span class="op" id="3602298">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602303">n</span>&nbsp;<span class="op" id="3602305">:=</span>&nbsp;<span class="builtinfunc" id="3602308">len</span><span class="op" id="3602311">(</span><span class="ident" id="3602312">fv</span><span class="op" id="3602314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602319">if</span>&nbsp;<span class="ident" id="3602322">off</span><span class="op" id="3602325">+</span><span class="ident" id="3602326">n</span>&nbsp;<span class="op" id="3602328">&gt;</span>&nbsp;<span class="builtinfunc" id="3602330">len</span><span class="op" id="3602333">(</span><span class="ident" id="3602334">msg</span><span class="op" id="3602337">)</span>&nbsp;<span class="op" id="3602339">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602345">return</span>&nbsp;<span class="builtintype" id="3602352">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3602366">copy</span><span class="op" id="3602370">(</span><span class="ident" id="3602371">fv</span><span class="op" id="3602373">,</span>&nbsp;<span class="ident" id="3602375">msg</span><span class="op" id="3602378">[</span><span class="ident" id="3602379">off</span><span class="op" id="3602382">:</span><span class="ident" id="3602383">off</span><span class="op" id="3602386">+</span><span class="ident" id="3602387">n</span><span class="op" id="3602388">]</span><span class="op" id="3602389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602394">off</span>&nbsp;<span class="op" id="3602398">+=</span>&nbsp;<span class="ident" id="3602401">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602405">case</span>&nbsp;<span class="op" id="3602410">*</span><span class="builtintype" id="3602411">string</span><span class="op" id="3602417">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602422">var</span>&nbsp;<span class="ident" id="3602426">s</span>&nbsp;<span class="builtintype" id="3602428">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602438">switch</span>&nbsp;<span class="ident" id="3602445">tag</span>&nbsp;<span class="op" id="3602449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602454">default</span><span class="op" id="3602461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3602467">println</span><span class="op" id="3602474">(</span><span class="string" id="3602475">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="3602505">,</span>&nbsp;<span class="ident" id="3602507">tag</span><span class="op" id="3602510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602516">return</span>&nbsp;<span class="builtintype" id="3602523">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602532">case</span>&nbsp;<span class="string" id="3602537">&#34;domain&#34;</span><span class="op" id="3602545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602551">s</span><span class="op" id="3602552">,</span>&nbsp;<span class="ident" id="3602554">off</span><span class="op" id="3602557">,</span>&nbsp;<span class="ident" id="3602559">ok</span>&nbsp;<span class="op" id="3602562">=</span>&nbsp;<span class="ident" id="3602564">unpackDomainName</span><span class="op" id="3602580">(</span><span class="ident" id="3602581">msg</span><span class="op" id="3602584">,</span>&nbsp;<span class="ident" id="3602586">off</span><span class="op" id="3602589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602595">if</span>&nbsp;<span class="op" id="3602598">!</span><span class="ident" id="3602599">ok</span>&nbsp;<span class="op" id="3602602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602609">return</span>&nbsp;<span class="builtintype" id="3602616">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602626">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602631">case</span>&nbsp;<span class="string" id="3602636">&#34;&#34;</span><span class="op" id="3602638">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602644">if</span>&nbsp;<span class="ident" id="3602647">off</span>&nbsp;<span class="op" id="3602651">&gt;=</span>&nbsp;<span class="builtinfunc" id="3602654">len</span><span class="op" id="3602657">(</span><span class="ident" id="3602658">msg</span><span class="op" id="3602661">)</span>&nbsp;<span class="op" id="3602663">||</span>&nbsp;<span class="ident" id="3602666">off</span><span class="op" id="3602669">+</span><span class="num" id="3602670">1</span><span class="op" id="3602671">+</span><span class="builtintype" id="3602672">int</span><span class="op" id="3602675">(</span><span class="ident" id="3602676">msg</span><span class="op" id="3602679">[</span><span class="ident" id="3602680">off</span><span class="op" id="3602683">]</span><span class="op" id="3602684">)</span>&nbsp;<span class="op" id="3602686">&gt;</span>&nbsp;<span class="builtinfunc" id="3602688">len</span><span class="op" id="3602691">(</span><span class="ident" id="3602692">msg</span><span class="op" id="3602695">)</span>&nbsp;<span class="op" id="3602697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602704">return</span>&nbsp;<span class="builtintype" id="3602711">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602721">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602727">n</span>&nbsp;<span class="op" id="3602729">:=</span>&nbsp;<span class="builtintype" id="3602732">int</span><span class="op" id="3602735">(</span><span class="ident" id="3602736">msg</span><span class="op" id="3602739">[</span><span class="ident" id="3602740">off</span><span class="op" id="3602743">]</span><span class="op" id="3602744">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602750">off</span><span class="op" id="3602753">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602760">b</span>&nbsp;<span class="op" id="3602762">:=</span>&nbsp;<span class="builtinfunc" id="3602765">make</span><span class="op" id="3602769">(</span><span class="op" id="3602770">[</span><span class="op" id="3602771">]</span><span class="builtintype" id="3602772">byte</span><span class="op" id="3602776">,</span>&nbsp;<span class="ident" id="3602778">n</span><span class="op" id="3602779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602785">for</span>&nbsp;<span class="ident" id="3602789">i</span>&nbsp;<span class="op" id="3602791">:=</span>&nbsp;<span class="num" id="3602794">0</span><span class="op" id="3602795">;</span>&nbsp;<span class="ident" id="3602797">i</span>&nbsp;<span class="op" id="3602799">&lt;</span>&nbsp;<span class="ident" id="3602801">n</span><span class="op" id="3602802">;</span>&nbsp;<span class="ident" id="3602804">i</span><span class="op" id="3602805">++</span>&nbsp;<span class="op" id="3602808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602815">b</span><span class="op" id="3602816">[</span><span class="ident" id="3602817">i</span><span class="op" id="3602818">]</span>&nbsp;<span class="op" id="3602820">=</span>&nbsp;<span class="ident" id="3602822">msg</span><span class="op" id="3602825">[</span><span class="ident" id="3602826">off</span><span class="op" id="3602829">+</span><span class="ident" id="3602830">i</span><span class="op" id="3602831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602837">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602843">off</span>&nbsp;<span class="op" id="3602847">+=</span>&nbsp;<span class="ident" id="3602850">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602856">s</span>&nbsp;<span class="op" id="3602858">=</span>&nbsp;<span class="builtintype" id="3602860">string</span><span class="op" id="3602866">(</span><span class="ident" id="3602867">b</span><span class="op" id="3602868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602878">*</span><span class="ident" id="3602879">fv</span>&nbsp;<span class="op" id="3602882">=</span>&nbsp;<span class="ident" id="3602884">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602888">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602892">return</span>&nbsp;<span class="builtintype" id="3602899">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602905">}</span><span class="op" id="3602906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602909">if</span>&nbsp;<span class="op" id="3602912">!</span><span class="ident" id="3602913">ok</span>&nbsp;<span class="op" id="3602916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602920">return</span>&nbsp;<span class="builtinfunc" id="3602927">len</span><span class="op" id="3602930">(</span><span class="ident" id="3602931">msg</span><span class="op" id="3602934">)</span><span class="op" id="3602935">,</span>&nbsp;<span class="builtintype" id="3602937">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602944">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602947">return</span>&nbsp;<span class="ident" id="3602954">off</span><span class="op" id="3602957">,</span>&nbsp;<span class="builtintype" id="3602959">true</span><br>
<span class="lineno"></span><span class="op" id="3602964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3602967">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3603034">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="3603054">func</span>&nbsp;<span class="ident" id="3603059">printStruct</span><span class="op" id="3603070">(</span><span class="ident" id="3603071">any</span>&nbsp;<span class="ident" id="3603075">dnsStruct</span><span class="op" id="3603084">)</span>&nbsp;<span class="builtintype" id="3603086">string</span>&nbsp;<span class="op" id="3603093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603096">s</span>&nbsp;<span class="op" id="3603098">:=</span>&nbsp;<span class="string" id="3603101">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603106">i</span>&nbsp;<span class="op" id="3603108">:=</span>&nbsp;<span class="num" id="3603111">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603114">any</span><span class="op" id="3603117">.</span><span class="ident" id="3603118">Walk</span><span class="op" id="3603122">(</span><span class="keyword" id="3603123">func</span><span class="op" id="3603127">(</span><span class="ident" id="3603128">val</span>&nbsp;<span class="keyword" id="3603132">interface</span><span class="op" id="3603141">{</span><span class="op" id="3603142">}</span><span class="op" id="3603143">,</span>&nbsp;<span class="ident" id="3603145">name</span><span class="op" id="3603149">,</span>&nbsp;<span class="ident" id="3603151">tag</span>&nbsp;<span class="builtintype" id="3603155">string</span><span class="op" id="3603161">)</span>&nbsp;<span class="builtintype" id="3603163">bool</span>&nbsp;<span class="op" id="3603168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603172">i</span><span class="op" id="3603173">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603178">if</span>&nbsp;<span class="ident" id="3603181">i</span>&nbsp;<span class="op" id="3603183">&gt;</span>&nbsp;<span class="num" id="3603185">1</span>&nbsp;<span class="op" id="3603187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603192">s</span>&nbsp;<span class="op" id="3603194">+=</span>&nbsp;<span class="string" id="3603197">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603208">s</span>&nbsp;<span class="op" id="3603210">+=</span>&nbsp;<span class="ident" id="3603213">name</span>&nbsp;<span class="op" id="3603218">+</span>&nbsp;<span class="string" id="3603220">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603226">switch</span>&nbsp;<span class="ident" id="3603233">tag</span>&nbsp;<span class="op" id="3603237">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603241">case</span>&nbsp;<span class="string" id="3603246">&#34;ipv4&#34;</span><span class="op" id="3603252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603257">i</span>&nbsp;<span class="op" id="3603259">:=</span>&nbsp;<span class="op" id="3603262">*</span><span class="ident" id="3603263">val</span><span class="op" id="3603266">.</span><span class="op" id="3603267">(</span><span class="op" id="3603268">*</span><span class="builtintype" id="3603269">uint32</span><span class="op" id="3603275">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603280">s</span>&nbsp;<span class="op" id="3603282">+=</span>&nbsp;<span class="ident" id="3603285">IPv4</span><span class="op" id="3603289">(</span><span class="builtintype" id="3603290">byte</span><span class="op" id="3603294">(</span><span class="ident" id="3603295">i</span><span class="op" id="3603296">&gt;&gt;</span><span class="num" id="3603298">24</span><span class="op" id="3603300">)</span><span class="op" id="3603301">,</span>&nbsp;<span class="builtintype" id="3603303">byte</span><span class="op" id="3603307">(</span><span class="ident" id="3603308">i</span><span class="op" id="3603309">&gt;&gt;</span><span class="num" id="3603311">16</span><span class="op" id="3603313">)</span><span class="op" id="3603314">,</span>&nbsp;<span class="builtintype" id="3603316">byte</span><span class="op" id="3603320">(</span><span class="ident" id="3603321">i</span><span class="op" id="3603322">&gt;&gt;</span><span class="num" id="3603324">8</span><span class="op" id="3603325">)</span><span class="op" id="3603326">,</span>&nbsp;<span class="builtintype" id="3603328">byte</span><span class="op" id="3603332">(</span><span class="ident" id="3603333">i</span><span class="op" id="3603334">)</span><span class="op" id="3603335">)</span><span class="op" id="3603336">.</span><span class="ident" id="3603337">String</span><span class="op" id="3603343">(</span><span class="op" id="3603344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603348">case</span>&nbsp;<span class="string" id="3603353">&#34;ipv6&#34;</span><span class="op" id="3603359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603364">i</span>&nbsp;<span class="op" id="3603366">:=</span>&nbsp;<span class="ident" id="3603369">val</span><span class="op" id="3603372">.</span><span class="op" id="3603373">(</span><span class="op" id="3603374">[</span><span class="op" id="3603375">]</span><span class="builtintype" id="3603376">byte</span><span class="op" id="3603380">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603385">s</span>&nbsp;<span class="op" id="3603387">+=</span>&nbsp;<span class="ident" id="3603390">IP</span><span class="op" id="3603392">(</span><span class="ident" id="3603393">i</span><span class="op" id="3603394">)</span><span class="op" id="3603395">.</span><span class="ident" id="3603396">String</span><span class="op" id="3603402">(</span><span class="op" id="3603403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603407">default</span><span class="op" id="3603414">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603419">var</span>&nbsp;<span class="ident" id="3603423">i</span>&nbsp;<span class="ident" id="3603425">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603434">switch</span>&nbsp;<span class="ident" id="3603441">v</span>&nbsp;<span class="op" id="3603443">:=</span>&nbsp;<span class="ident" id="3603446">val</span><span class="op" id="3603449">.</span><span class="op" id="3603450">(</span><span class="keyword" id="3603451">type</span><span class="op" id="3603455">)</span>&nbsp;<span class="op" id="3603457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603462">default</span><span class="op" id="3603469">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3603475">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603503">s</span>&nbsp;<span class="op" id="3603505">+=</span>&nbsp;<span class="string" id="3603508">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603529">return</span>&nbsp;<span class="builtintype" id="3603536">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603544">case</span>&nbsp;<span class="op" id="3603549">*</span><span class="builtintype" id="3603550">string</span><span class="op" id="3603556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603562">s</span>&nbsp;<span class="op" id="3603564">+=</span>&nbsp;<span class="op" id="3603567">*</span><span class="ident" id="3603568">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603574">return</span>&nbsp;<span class="builtintype" id="3603581">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603589">case</span>&nbsp;<span class="op" id="3603594">[</span><span class="op" id="3603595">]</span><span class="builtintype" id="3603596">byte</span><span class="op" id="3603600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603606">s</span>&nbsp;<span class="op" id="3603608">+=</span>&nbsp;<span class="builtintype" id="3603611">string</span><span class="op" id="3603617">(</span><span class="ident" id="3603618">v</span><span class="op" id="3603619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603625">return</span>&nbsp;<span class="builtintype" id="3603632">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603640">case</span>&nbsp;<span class="op" id="3603645">*</span><span class="builtintype" id="3603646">bool</span><span class="op" id="3603650">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603656">if</span>&nbsp;<span class="op" id="3603659">*</span><span class="ident" id="3603660">v</span>&nbsp;<span class="op" id="3603662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603669">s</span>&nbsp;<span class="op" id="3603671">+=</span>&nbsp;<span class="string" id="3603674">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603685">}</span>&nbsp;<span class="keyword" id="3603687">else</span>&nbsp;<span class="op" id="3603692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603699">s</span>&nbsp;<span class="op" id="3603701">+=</span>&nbsp;<span class="string" id="3603704">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603716">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603722">return</span>&nbsp;<span class="builtintype" id="3603729">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603737">case</span>&nbsp;<span class="op" id="3603742">*</span><span class="builtintype" id="3603743">int</span><span class="op" id="3603746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603752">i</span>&nbsp;<span class="op" id="3603754">=</span>&nbsp;<span class="ident" id="3603756">int64</span><span class="op" id="3603761">(</span><span class="op" id="3603762">*</span><span class="ident" id="3603763">v</span><span class="op" id="3603764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603769">case</span>&nbsp;<span class="op" id="3603774">*</span><span class="builtintype" id="3603775">uint</span><span class="op" id="3603779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603785">i</span>&nbsp;<span class="op" id="3603787">=</span>&nbsp;<span class="ident" id="3603789">int64</span><span class="op" id="3603794">(</span><span class="op" id="3603795">*</span><span class="ident" id="3603796">v</span><span class="op" id="3603797">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603802">case</span>&nbsp;<span class="op" id="3603807">*</span><span class="builtintype" id="3603808">uint8</span><span class="op" id="3603813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603819">i</span>&nbsp;<span class="op" id="3603821">=</span>&nbsp;<span class="ident" id="3603823">int64</span><span class="op" id="3603828">(</span><span class="op" id="3603829">*</span><span class="ident" id="3603830">v</span><span class="op" id="3603831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603836">case</span>&nbsp;<span class="op" id="3603841">*</span><span class="builtintype" id="3603842">uint16</span><span class="op" id="3603848">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603854">i</span>&nbsp;<span class="op" id="3603856">=</span>&nbsp;<span class="ident" id="3603858">int64</span><span class="op" id="3603863">(</span><span class="op" id="3603864">*</span><span class="ident" id="3603865">v</span><span class="op" id="3603866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603871">case</span>&nbsp;<span class="op" id="3603876">*</span><span class="builtintype" id="3603877">uint32</span><span class="op" id="3603883">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603889">i</span>&nbsp;<span class="op" id="3603891">=</span>&nbsp;<span class="ident" id="3603893">int64</span><span class="op" id="3603898">(</span><span class="op" id="3603899">*</span><span class="ident" id="3603900">v</span><span class="op" id="3603901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603906">case</span>&nbsp;<span class="op" id="3603911">*</span><span class="ident" id="3603912">uint64</span><span class="op" id="3603918">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603924">i</span>&nbsp;<span class="op" id="3603926">=</span>&nbsp;<span class="ident" id="3603928">int64</span><span class="op" id="3603933">(</span><span class="op" id="3603934">*</span><span class="ident" id="3603935">v</span><span class="op" id="3603936">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603941">case</span>&nbsp;<span class="op" id="3603946">*</span><span class="builtintype" id="3603947">uintptr</span><span class="op" id="3603954">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603960">i</span>&nbsp;<span class="op" id="3603962">=</span>&nbsp;<span class="ident" id="3603964">int64</span><span class="op" id="3603969">(</span><span class="op" id="3603970">*</span><span class="ident" id="3603971">v</span><span class="op" id="3603972">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603982">s</span>&nbsp;<span class="op" id="3603984">+=</span>&nbsp;<span class="ident" id="3603987">itoa</span><span class="op" id="3603991">(</span><span class="builtintype" id="3603992">int</span><span class="op" id="3603995">(</span><span class="ident" id="3603996">i</span><span class="op" id="3603997">)</span><span class="op" id="3603998">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604006">return</span>&nbsp;<span class="builtintype" id="3604013">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604019">}</span><span class="op" id="3604020">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604023">s</span>&nbsp;<span class="op" id="3604025">+=</span>&nbsp;<span class="string" id="3604028">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604033">return</span>&nbsp;<span class="ident" id="3604040">s</span><br>
<span class="lineno"></span><span class="op" id="3604042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604045">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="3604072">func</span>&nbsp;<span class="ident" id="3604077">packRR</span><span class="op" id="3604083">(</span><span class="ident" id="3604084">rr</span>&nbsp;<span class="ident" id="3604087">dnsRR</span><span class="op" id="3604092">,</span>&nbsp;<span class="ident" id="3604094">msg</span>&nbsp;<span class="op" id="3604098">[</span><span class="op" id="3604099">]</span><span class="builtintype" id="3604100">byte</span><span class="op" id="3604104">,</span>&nbsp;<span class="ident" id="3604106">off</span>&nbsp;<span class="builtintype" id="3604110">int</span><span class="op" id="3604113">)</span>&nbsp;<span class="op" id="3604115">(</span><span class="ident" id="3604116">off2</span>&nbsp;<span class="builtintype" id="3604121">int</span><span class="op" id="3604124">,</span>&nbsp;<span class="ident" id="3604126">ok</span>&nbsp;<span class="builtintype" id="3604129">bool</span><span class="op" id="3604133">)</span>&nbsp;<span class="op" id="3604135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604138">var</span>&nbsp;<span class="ident" id="3604142">off1</span>&nbsp;<span class="builtintype" id="3604147">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604152">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604195">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604232">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604288">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604314">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604336">off1</span><span class="op" id="3604340">,</span>&nbsp;<span class="ident" id="3604342">ok</span>&nbsp;<span class="op" id="3604345">=</span>&nbsp;<span class="ident" id="3604347">packStruct</span><span class="op" id="3604357">(</span><span class="ident" id="3604358">rr</span><span class="op" id="3604360">.</span><span class="ident" id="3604361">Header</span><span class="op" id="3604367">(</span><span class="op" id="3604368">)</span><span class="op" id="3604369">,</span>&nbsp;<span class="ident" id="3604371">msg</span><span class="op" id="3604374">,</span>&nbsp;<span class="ident" id="3604376">off</span><span class="op" id="3604379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604382">off2</span><span class="op" id="3604386">,</span>&nbsp;<span class="ident" id="3604388">ok</span>&nbsp;<span class="op" id="3604391">=</span>&nbsp;<span class="ident" id="3604393">packStruct</span><span class="op" id="3604403">(</span><span class="ident" id="3604404">rr</span><span class="op" id="3604406">,</span>&nbsp;<span class="ident" id="3604408">msg</span><span class="op" id="3604411">,</span>&nbsp;<span class="ident" id="3604413">off</span><span class="op" id="3604416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604419">if</span>&nbsp;<span class="op" id="3604422">!</span><span class="ident" id="3604423">ok</span>&nbsp;<span class="op" id="3604426">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604430">return</span>&nbsp;<span class="builtinfunc" id="3604437">len</span><span class="op" id="3604440">(</span><span class="ident" id="3604441">msg</span><span class="op" id="3604444">)</span><span class="op" id="3604445">,</span>&nbsp;<span class="builtintype" id="3604447">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604457">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604517">rr</span><span class="op" id="3604519">.</span><span class="ident" id="3604520">Header</span><span class="op" id="3604526">(</span><span class="op" id="3604527">)</span><span class="op" id="3604528">.</span><span class="ident" id="3604529">Rdlength</span>&nbsp;<span class="op" id="3604538">=</span>&nbsp;<span class="builtintype" id="3604540">uint16</span><span class="op" id="3604546">(</span><span class="ident" id="3604547">off2</span>&nbsp;<span class="op" id="3604552">-</span>&nbsp;<span class="ident" id="3604554">off1</span><span class="op" id="3604558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604561">packStruct</span><span class="op" id="3604571">(</span><span class="ident" id="3604572">rr</span><span class="op" id="3604574">.</span><span class="ident" id="3604575">Header</span><span class="op" id="3604581">(</span><span class="op" id="3604582">)</span><span class="op" id="3604583">,</span>&nbsp;<span class="ident" id="3604585">msg</span><span class="op" id="3604588">,</span>&nbsp;<span class="ident" id="3604590">off</span><span class="op" id="3604593">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604596">return</span>&nbsp;<span class="ident" id="3604603">off2</span><span class="op" id="3604607">,</span>&nbsp;<span class="builtintype" id="3604609">true</span><br>
<span class="lineno"></span><span class="op" id="3604614">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3604617">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="3604646">func</span>&nbsp;<span class="ident" id="3604651">unpackRR</span><span class="op" id="3604659">(</span><span class="ident" id="3604660">msg</span>&nbsp;<span class="op" id="3604664">[</span><span class="op" id="3604665">]</span><span class="builtintype" id="3604666">byte</span><span class="op" id="3604670">,</span>&nbsp;<span class="ident" id="3604672">off</span>&nbsp;<span class="builtintype" id="3604676">int</span><span class="op" id="3604679">)</span>&nbsp;<span class="op" id="3604681">(</span><span class="ident" id="3604682">rr</span>&nbsp;<span class="ident" id="3604685">dnsRR</span><span class="op" id="3604690">,</span>&nbsp;<span class="ident" id="3604692">off1</span>&nbsp;<span class="builtintype" id="3604697">int</span><span class="op" id="3604700">,</span>&nbsp;<span class="ident" id="3604702">ok</span>&nbsp;<span class="builtintype" id="3604705">bool</span><span class="op" id="3604709">)</span>&nbsp;<span class="op" id="3604711">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604714">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604773">var</span>&nbsp;<span class="ident" id="3604777">h</span>&nbsp;<span class="ident" id="3604779">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604793">off0</span>&nbsp;<span class="op" id="3604798">:=</span>&nbsp;<span class="ident" id="3604801">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604806">if</span>&nbsp;<span class="ident" id="3604809">off</span><span class="op" id="3604812">,</span>&nbsp;<span class="ident" id="3604814">ok</span>&nbsp;<span class="op" id="3604817">=</span>&nbsp;<span class="ident" id="3604819">unpackStruct</span><span class="op" id="3604831">(</span><span class="op" id="3604832">&amp;</span><span class="ident" id="3604833">h</span><span class="op" id="3604834">,</span>&nbsp;<span class="ident" id="3604836">msg</span><span class="op" id="3604839">,</span>&nbsp;<span class="ident" id="3604841">off</span><span class="op" id="3604844">)</span><span class="op" id="3604845">;</span>&nbsp;<span class="op" id="3604847">!</span><span class="ident" id="3604848">ok</span>&nbsp;<span class="op" id="3604851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3604855">return</span>&nbsp;<span class="ident" id="3604862">nil</span><span class="op" id="3604865">,</span>&nbsp;<span class="builtinfunc" id="3604867">len</span><span class="op" id="3604870">(</span><span class="ident" id="3604871">msg</span><span class="op" id="3604874">)</span><span class="op" id="3604875">,</span>&nbsp;<span class="builtintype" id="3604877">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3604884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3604887">end</span>&nbsp;<span class="op" id="3604891">:=</span>&nbsp;<span class="ident" id="3604894">off</span>&nbsp;<span class="op" id="3604898">+</span>&nbsp;<span class="builtintype" id="3604900">int</span><span class="op" id="3604903">(</span><span class="ident" id="3604904">h</span><span class="op" id="3604905">.</span><span class="ident" id="3604906">Rdlength</span><span class="op" id="3604914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604918">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3604961">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605012">mk</span><span class="op" id="3605014">,</span>&nbsp;<span class="ident" id="3605016">known</span>&nbsp;<span class="op" id="3605022">:=</span>&nbsp;<span class="ident" id="3605025">rr_mk</span><span class="op" id="3605030">[</span><span class="builtintype" id="3605031">int</span><span class="op" id="3605034">(</span><span class="ident" id="3605035">h</span><span class="op" id="3605036">.</span><span class="ident" id="3605037">Rrtype</span><span class="op" id="3605043">)</span><span class="op" id="3605044">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605047">if</span>&nbsp;<span class="op" id="3605050">!</span><span class="ident" id="3605051">known</span>&nbsp;<span class="op" id="3605057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605061">return</span>&nbsp;<span class="op" id="3605068">&amp;</span><span class="ident" id="3605069">h</span><span class="op" id="3605070">,</span>&nbsp;<span class="ident" id="3605072">end</span><span class="op" id="3605075">,</span>&nbsp;<span class="builtintype" id="3605077">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3605083">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605086">rr</span>&nbsp;<span class="op" id="3605089">=</span>&nbsp;<span class="ident" id="3605091">mk</span><span class="op" id="3605093">(</span><span class="op" id="3605094">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605097">off</span><span class="op" id="3605100">,</span>&nbsp;<span class="ident" id="3605102">ok</span>&nbsp;<span class="op" id="3605105">=</span>&nbsp;<span class="ident" id="3605107">unpackStruct</span><span class="op" id="3605119">(</span><span class="ident" id="3605120">rr</span><span class="op" id="3605122">,</span>&nbsp;<span class="ident" id="3605124">msg</span><span class="op" id="3605127">,</span>&nbsp;<span class="ident" id="3605129">off0</span><span class="op" id="3605133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605136">if</span>&nbsp;<span class="ident" id="3605139">off</span>&nbsp;<span class="op" id="3605143">!=</span>&nbsp;<span class="ident" id="3605146">end</span>&nbsp;<span class="op" id="3605150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605154">return</span>&nbsp;<span class="op" id="3605161">&amp;</span><span class="ident" id="3605162">h</span><span class="op" id="3605163">,</span>&nbsp;<span class="ident" id="3605165">end</span><span class="op" id="3605168">,</span>&nbsp;<span class="builtintype" id="3605170">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3605176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605179">return</span>&nbsp;<span class="ident" id="3605186">rr</span><span class="op" id="3605188">,</span>&nbsp;<span class="ident" id="3605190">off</span><span class="op" id="3605193">,</span>&nbsp;<span class="ident" id="3605195">ok</span><br>
<span class="lineno">710</span><span class="op" id="3605198">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3605201">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3605244">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="3605290">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="3605338">type</span>&nbsp;<span class="ident" id="3605343">dnsMsgHdr</span>&nbsp;<span class="keyword" id="3605353">struct</span>&nbsp;<span class="op" id="3605360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605363">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605383">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605391">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605411">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605417">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605437">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605442">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605462">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605468">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605488">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605494">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605514">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605520">recursion_available</span>&nbsp;<span class="builtintype" id="3605540">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605546">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3605566">int</span><br>
<span class="lineno">725</span><span class="op" id="3605570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3605573">func</span>&nbsp;<span class="op" id="3605578">(</span><span class="ident" id="3605579">h</span>&nbsp;<span class="op" id="3605581">*</span><span class="ident" id="3605582">dnsMsgHdr</span><span class="op" id="3605591">)</span>&nbsp;<span class="ident" id="3605593">Walk</span><span class="op" id="3605597">(</span><span class="ident" id="3605598">f</span>&nbsp;<span class="keyword" id="3605600">func</span><span class="op" id="3605604">(</span><span class="ident" id="3605605">v</span>&nbsp;<span class="keyword" id="3605607">interface</span><span class="op" id="3605616">{</span><span class="op" id="3605617">}</span><span class="op" id="3605618">,</span>&nbsp;<span class="ident" id="3605620">name</span><span class="op" id="3605624">,</span>&nbsp;<span class="ident" id="3605626">tag</span>&nbsp;<span class="builtintype" id="3605630">string</span><span class="op" id="3605636">)</span>&nbsp;<span class="builtintype" id="3605638">bool</span><span class="op" id="3605642">)</span>&nbsp;<span class="builtintype" id="3605644">bool</span>&nbsp;<span class="op" id="3605649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3605652">return</span>&nbsp;<span class="ident" id="3605659">f</span><span class="op" id="3605660">(</span><span class="op" id="3605661">&amp;</span><span class="ident" id="3605662">h</span><span class="op" id="3605663">.</span><span class="ident" id="3605664">id</span><span class="op" id="3605666">,</span>&nbsp;<span class="string" id="3605668">&#34;id&#34;</span><span class="op" id="3605672">,</span>&nbsp;<span class="string" id="3605674">&#34;&#34;</span><span class="op" id="3605676">)</span>&nbsp;<span class="op" id="3605678">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605683">f</span><span class="op" id="3605684">(</span><span class="op" id="3605685">&amp;</span><span class="ident" id="3605686">h</span><span class="op" id="3605687">.</span><span class="ident" id="3605688">response</span><span class="op" id="3605696">,</span>&nbsp;<span class="string" id="3605698">&#34;response&#34;</span><span class="op" id="3605708">,</span>&nbsp;<span class="string" id="3605710">&#34;&#34;</span><span class="op" id="3605712">)</span>&nbsp;<span class="op" id="3605714">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605719">f</span><span class="op" id="3605720">(</span><span class="op" id="3605721">&amp;</span><span class="ident" id="3605722">h</span><span class="op" id="3605723">.</span><span class="ident" id="3605724">opcode</span><span class="op" id="3605730">,</span>&nbsp;<span class="string" id="3605732">&#34;opcode&#34;</span><span class="op" id="3605740">,</span>&nbsp;<span class="string" id="3605742">&#34;&#34;</span><span class="op" id="3605744">)</span>&nbsp;<span class="op" id="3605746">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605751">f</span><span class="op" id="3605752">(</span><span class="op" id="3605753">&amp;</span><span class="ident" id="3605754">h</span><span class="op" id="3605755">.</span><span class="ident" id="3605756">authoritative</span><span class="op" id="3605769">,</span>&nbsp;<span class="string" id="3605771">&#34;authoritative&#34;</span><span class="op" id="3605786">,</span>&nbsp;<span class="string" id="3605788">&#34;&#34;</span><span class="op" id="3605790">)</span>&nbsp;<span class="op" id="3605792">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605797">f</span><span class="op" id="3605798">(</span><span class="op" id="3605799">&amp;</span><span class="ident" id="3605800">h</span><span class="op" id="3605801">.</span><span class="ident" id="3605802">truncated</span><span class="op" id="3605811">,</span>&nbsp;<span class="string" id="3605813">&#34;truncated&#34;</span><span class="op" id="3605824">,</span>&nbsp;<span class="string" id="3605826">&#34;&#34;</span><span class="op" id="3605828">)</span>&nbsp;<span class="op" id="3605830">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605835">f</span><span class="op" id="3605836">(</span><span class="op" id="3605837">&amp;</span><span class="ident" id="3605838">h</span><span class="op" id="3605839">.</span><span class="ident" id="3605840">recursion_desired</span><span class="op" id="3605857">,</span>&nbsp;<span class="string" id="3605859">&#34;recursion_desired&#34;</span><span class="op" id="3605878">,</span>&nbsp;<span class="string" id="3605880">&#34;&#34;</span><span class="op" id="3605882">)</span>&nbsp;<span class="op" id="3605884">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605889">f</span><span class="op" id="3605890">(</span><span class="op" id="3605891">&amp;</span><span class="ident" id="3605892">h</span><span class="op" id="3605893">.</span><span class="ident" id="3605894">recursion_available</span><span class="op" id="3605913">,</span>&nbsp;<span class="string" id="3605915">&#34;recursion_available&#34;</span><span class="op" id="3605936">,</span>&nbsp;<span class="string" id="3605938">&#34;&#34;</span><span class="op" id="3605940">)</span>&nbsp;<span class="op" id="3605942">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605947">f</span><span class="op" id="3605948">(</span><span class="op" id="3605949">&amp;</span><span class="ident" id="3605950">h</span><span class="op" id="3605951">.</span><span class="ident" id="3605952">rcode</span><span class="op" id="3605957">,</span>&nbsp;<span class="string" id="3605959">&#34;rcode&#34;</span><span class="op" id="3605966">,</span>&nbsp;<span class="string" id="3605968">&#34;&#34;</span><span class="op" id="3605970">)</span><br>
<span class="lineno"></span><span class="op" id="3605972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3605975">type</span>&nbsp;<span class="ident" id="3605980">dnsMsg</span>&nbsp;<span class="keyword" id="3605987">struct</span>&nbsp;<span class="op" id="3605994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3605997">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606008">question</span>&nbsp;<span class="op" id="3606017">[</span><span class="op" id="3606018">]</span><span class="ident" id="3606019">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606032">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3606041">[</span><span class="op" id="3606042">]</span><span class="ident" id="3606043">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606050">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606059">[</span><span class="op" id="3606060">]</span><span class="ident" id="3606061">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606068">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3606077">[</span><span class="op" id="3606078">]</span><span class="ident" id="3606079">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="3606085">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="3606088">func</span>&nbsp;<span class="op" id="3606093">(</span><span class="ident" id="3606094">dns</span>&nbsp;<span class="op" id="3606098">*</span><span class="ident" id="3606099">dnsMsg</span><span class="op" id="3606105">)</span>&nbsp;<span class="ident" id="3606107">Pack</span><span class="op" id="3606111">(</span><span class="op" id="3606112">)</span>&nbsp;<span class="op" id="3606114">(</span><span class="ident" id="3606115">msg</span>&nbsp;<span class="op" id="3606119">[</span><span class="op" id="3606120">]</span><span class="builtintype" id="3606121">byte</span><span class="op" id="3606125">,</span>&nbsp;<span class="ident" id="3606127">ok</span>&nbsp;<span class="builtintype" id="3606130">bool</span><span class="op" id="3606134">)</span>&nbsp;<span class="op" id="3606136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606139">var</span>&nbsp;<span class="ident" id="3606143">dh</span>&nbsp;<span class="ident" id="3606146">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606158">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606214">dh</span><span class="op" id="3606216">.</span><span class="ident" id="3606217">Id</span>&nbsp;<span class="op" id="3606220">=</span>&nbsp;<span class="ident" id="3606222">dns</span><span class="op" id="3606225">.</span><span class="ident" id="3606226">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606230">dh</span><span class="op" id="3606232">.</span><span class="ident" id="3606233">Bits</span>&nbsp;<span class="op" id="3606238">=</span>&nbsp;<span class="builtintype" id="3606240">uint16</span><span class="op" id="3606246">(</span><span class="ident" id="3606247">dns</span><span class="op" id="3606250">.</span><span class="ident" id="3606251">opcode</span><span class="op" id="3606257">)</span><span class="op" id="3606258">&lt;&lt;</span><span class="num" id="3606260">11</span>&nbsp;<span class="op" id="3606263">|</span>&nbsp;<span class="builtintype" id="3606265">uint16</span><span class="op" id="3606271">(</span><span class="ident" id="3606272">dns</span><span class="op" id="3606275">.</span><span class="ident" id="3606276">rcode</span><span class="op" id="3606281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606284">if</span>&nbsp;<span class="ident" id="3606287">dns</span><span class="op" id="3606290">.</span><span class="ident" id="3606291">recursion_available</span>&nbsp;<span class="op" id="3606311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606315">dh</span><span class="op" id="3606317">.</span><span class="ident" id="3606318">Bits</span>&nbsp;<span class="op" id="3606323">|=</span>&nbsp;<span class="ident" id="3606326">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606331">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606334">if</span>&nbsp;<span class="ident" id="3606337">dns</span><span class="op" id="3606340">.</span><span class="ident" id="3606341">recursion_desired</span>&nbsp;<span class="op" id="3606359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606363">dh</span><span class="op" id="3606365">.</span><span class="ident" id="3606366">Bits</span>&nbsp;<span class="op" id="3606371">|=</span>&nbsp;<span class="ident" id="3606374">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606382">if</span>&nbsp;<span class="ident" id="3606385">dns</span><span class="op" id="3606388">.</span><span class="ident" id="3606389">truncated</span>&nbsp;<span class="op" id="3606399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606403">dh</span><span class="op" id="3606405">.</span><span class="ident" id="3606406">Bits</span>&nbsp;<span class="op" id="3606411">|=</span>&nbsp;<span class="ident" id="3606414">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606419">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606422">if</span>&nbsp;<span class="ident" id="3606425">dns</span><span class="op" id="3606428">.</span><span class="ident" id="3606429">authoritative</span>&nbsp;<span class="op" id="3606443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606447">dh</span><span class="op" id="3606449">.</span><span class="ident" id="3606450">Bits</span>&nbsp;<span class="op" id="3606455">|=</span>&nbsp;<span class="ident" id="3606458">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3606466">if</span>&nbsp;<span class="ident" id="3606469">dns</span><span class="op" id="3606472">.</span><span class="ident" id="3606473">response</span>&nbsp;<span class="op" id="3606482">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606486">dh</span><span class="op" id="3606488">.</span><span class="ident" id="3606489">Bits</span>&nbsp;<span class="op" id="3606494">|=</span>&nbsp;<span class="ident" id="3606497">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3606502">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606506">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606541">question</span>&nbsp;<span class="op" id="3606550">:=</span>&nbsp;<span class="ident" id="3606553">dns</span><span class="op" id="3606556">.</span><span class="ident" id="3606557">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606567">answer</span>&nbsp;<span class="op" id="3606574">:=</span>&nbsp;<span class="ident" id="3606577">dns</span><span class="op" id="3606580">.</span><span class="ident" id="3606581">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606589">ns</span>&nbsp;<span class="op" id="3606592">:=</span>&nbsp;<span class="ident" id="3606595">dns</span><span class="op" id="3606598">.</span><span class="ident" id="3606599">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606603">extra</span>&nbsp;<span class="op" id="3606609">:=</span>&nbsp;<span class="ident" id="3606612">dns</span><span class="op" id="3606615">.</span><span class="ident" id="3606616">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606624">dh</span><span class="op" id="3606626">.</span><span class="ident" id="3606627">Qdcount</span>&nbsp;<span class="op" id="3606635">=</span>&nbsp;<span class="builtintype" id="3606637">uint16</span><span class="op" id="3606643">(</span><span class="builtinfunc" id="3606644">len</span><span class="op" id="3606647">(</span><span class="ident" id="3606648">question</span><span class="op" id="3606656">)</span><span class="op" id="3606657">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606660">dh</span><span class="op" id="3606662">.</span><span class="ident" id="3606663">Ancount</span>&nbsp;<span class="op" id="3606671">=</span>&nbsp;<span class="builtintype" id="3606673">uint16</span><span class="op" id="3606679">(</span><span class="builtinfunc" id="3606680">len</span><span class="op" id="3606683">(</span><span class="ident" id="3606684">answer</span><span class="op" id="3606690">)</span><span class="op" id="3606691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606694">dh</span><span class="op" id="3606696">.</span><span class="ident" id="3606697">Nscount</span>&nbsp;<span class="op" id="3606705">=</span>&nbsp;<span class="builtintype" id="3606707">uint16</span><span class="op" id="3606713">(</span><span class="builtinfunc" id="3606714">len</span><span class="op" id="3606717">(</span><span class="ident" id="3606718">ns</span><span class="op" id="3606720">)</span><span class="op" id="3606721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606724">dh</span><span class="op" id="3606726">.</span><span class="ident" id="3606727">Arcount</span>&nbsp;<span class="op" id="3606735">=</span>&nbsp;<span class="builtintype" id="3606737">uint16</span><span class="op" id="3606743">(</span><span class="builtinfunc" id="3606744">len</span><span class="op" id="3606747">(</span><span class="ident" id="3606748">extra</span><span class="op" id="3606753">)</span><span class="op" id="3606754">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606758">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606807">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606853">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606891">msg</span>&nbsp;<span class="op" id="3606895">=</span>&nbsp;<span class="builtinfunc" id="3606897">make</span><span class="op" id="3606901">(</span><span class="op" id="3606902">[</span><span class="op" id="3606903">]</span><span class="builtintype" id="3606904">byte</span><span class="op" id="3606908">,</span>&nbsp;<span class="num" id="3606910">2000</span><span class="op" id="3606914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3606918">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606962">off</span>&nbsp;<span class="op" id="3606966">:=</span>&nbsp;<span class="num" id="3606969">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3606972">off</span><span class="op" id="3606975">,</span>&nbsp;<span class="ident" id="3606977">ok</span>&nbsp;<span class="op" id="3606980">=</span>&nbsp;<span class="ident" id="3606982">packStruct</span><span class="op" id="3606992">(</span><span class="op" id="3606993">&amp;</span><span class="ident" id="3606994">dh</span><span class="op" id="3606996">,</span>&nbsp;<span class="ident" id="3606998">msg</span><span class="op" id="3607001">,</span>&nbsp;<span class="ident" id="3607003">off</span><span class="op" id="3607006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607009">for</span>&nbsp;<span class="ident" id="3607013">i</span>&nbsp;<span class="op" id="3607015">:=</span>&nbsp;<span class="num" id="3607018">0</span><span class="op" id="3607019">;</span>&nbsp;<span class="ident" id="3607021">i</span>&nbsp;<span class="op" id="3607023">&lt;</span>&nbsp;<span class="builtinfunc" id="3607025">len</span><span class="op" id="3607028">(</span><span class="ident" id="3607029">question</span><span class="op" id="3607037">)</span><span class="op" id="3607038">;</span>&nbsp;<span class="ident" id="3607040">i</span><span class="op" id="3607041">++</span>&nbsp;<span class="op" id="3607044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607048">off</span><span class="op" id="3607051">,</span>&nbsp;<span class="ident" id="3607053">ok</span>&nbsp;<span class="op" id="3607056">=</span>&nbsp;<span class="ident" id="3607058">packStruct</span><span class="op" id="3607068">(</span><span class="op" id="3607069">&amp;</span><span class="ident" id="3607070">question</span><span class="op" id="3607078">[</span><span class="ident" id="3607079">i</span><span class="op" id="3607080">]</span><span class="op" id="3607081">,</span>&nbsp;<span class="ident" id="3607083">msg</span><span class="op" id="3607086">,</span>&nbsp;<span class="ident" id="3607088">off</span><span class="op" id="3607091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607094">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607097">for</span>&nbsp;<span class="ident" id="3607101">i</span>&nbsp;<span class="op" id="3607103">:=</span>&nbsp;<span class="num" id="3607106">0</span><span class="op" id="3607107">;</span>&nbsp;<span class="ident" id="3607109">i</span>&nbsp;<span class="op" id="3607111">&lt;</span>&nbsp;<span class="builtinfunc" id="3607113">len</span><span class="op" id="3607116">(</span><span class="ident" id="3607117">answer</span><span class="op" id="3607123">)</span><span class="op" id="3607124">;</span>&nbsp;<span class="ident" id="3607126">i</span><span class="op" id="3607127">++</span>&nbsp;<span class="op" id="3607130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607134">off</span><span class="op" id="3607137">,</span>&nbsp;<span class="ident" id="3607139">ok</span>&nbsp;<span class="op" id="3607142">=</span>&nbsp;<span class="ident" id="3607144">packRR</span><span class="op" id="3607150">(</span><span class="ident" id="3607151">answer</span><span class="op" id="3607157">[</span><span class="ident" id="3607158">i</span><span class="op" id="3607159">]</span><span class="op" id="3607160">,</span>&nbsp;<span class="ident" id="3607162">msg</span><span class="op" id="3607165">,</span>&nbsp;<span class="ident" id="3607167">off</span><span class="op" id="3607170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607176">for</span>&nbsp;<span class="ident" id="3607180">i</span>&nbsp;<span class="op" id="3607182">:=</span>&nbsp;<span class="num" id="3607185">0</span><span class="op" id="3607186">;</span>&nbsp;<span class="ident" id="3607188">i</span>&nbsp;<span class="op" id="3607190">&lt;</span>&nbsp;<span class="builtinfunc" id="3607192">len</span><span class="op" id="3607195">(</span><span class="ident" id="3607196">ns</span><span class="op" id="3607198">)</span><span class="op" id="3607199">;</span>&nbsp;<span class="ident" id="3607201">i</span><span class="op" id="3607202">++</span>&nbsp;<span class="op" id="3607205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607209">off</span><span class="op" id="3607212">,</span>&nbsp;<span class="ident" id="3607214">ok</span>&nbsp;<span class="op" id="3607217">=</span>&nbsp;<span class="ident" id="3607219">packRR</span><span class="op" id="3607225">(</span><span class="ident" id="3607226">ns</span><span class="op" id="3607228">[</span><span class="ident" id="3607229">i</span><span class="op" id="3607230">]</span><span class="op" id="3607231">,</span>&nbsp;<span class="ident" id="3607233">msg</span><span class="op" id="3607236">,</span>&nbsp;<span class="ident" id="3607238">off</span><span class="op" id="3607241">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607247">for</span>&nbsp;<span class="ident" id="3607251">i</span>&nbsp;<span class="op" id="3607253">:=</span>&nbsp;<span class="num" id="3607256">0</span><span class="op" id="3607257">;</span>&nbsp;<span class="ident" id="3607259">i</span>&nbsp;<span class="op" id="3607261">&lt;</span>&nbsp;<span class="builtinfunc" id="3607263">len</span><span class="op" id="3607266">(</span><span class="ident" id="3607267">extra</span><span class="op" id="3607272">)</span><span class="op" id="3607273">;</span>&nbsp;<span class="ident" id="3607275">i</span><span class="op" id="3607276">++</span>&nbsp;<span class="op" id="3607279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607283">off</span><span class="op" id="3607286">,</span>&nbsp;<span class="ident" id="3607288">ok</span>&nbsp;<span class="op" id="3607291">=</span>&nbsp;<span class="ident" id="3607293">packRR</span><span class="op" id="3607299">(</span><span class="ident" id="3607300">extra</span><span class="op" id="3607305">[</span><span class="ident" id="3607306">i</span><span class="op" id="3607307">]</span><span class="op" id="3607308">,</span>&nbsp;<span class="ident" id="3607310">msg</span><span class="op" id="3607313">,</span>&nbsp;<span class="ident" id="3607315">off</span><span class="op" id="3607318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607324">if</span>&nbsp;<span class="op" id="3607327">!</span><span class="ident" id="3607328">ok</span>&nbsp;<span class="op" id="3607331">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607335">return</span>&nbsp;<span class="ident" id="3607342">nil</span><span class="op" id="3607345">,</span>&nbsp;<span class="builtintype" id="3607347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607357">return</span>&nbsp;<span class="ident" id="3607364">msg</span><span class="op" id="3607367">[</span><span class="num" id="3607368">0</span><span class="op" id="3607369">:</span><span class="ident" id="3607370">off</span><span class="op" id="3607373">]</span><span class="op" id="3607374">,</span>&nbsp;<span class="builtintype" id="3607376">true</span><br>
<span class="lineno"></span><span class="op" id="3607381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="3607384">func</span>&nbsp;<span class="op" id="3607389">(</span><span class="ident" id="3607390">dns</span>&nbsp;<span class="op" id="3607394">*</span><span class="ident" id="3607395">dnsMsg</span><span class="op" id="3607401">)</span>&nbsp;<span class="ident" id="3607403">Unpack</span><span class="op" id="3607409">(</span><span class="ident" id="3607410">msg</span>&nbsp;<span class="op" id="3607414">[</span><span class="op" id="3607415">]</span><span class="builtintype" id="3607416">byte</span><span class="op" id="3607420">)</span>&nbsp;<span class="builtintype" id="3607422">bool</span>&nbsp;<span class="op" id="3607427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3607430">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607442">var</span>&nbsp;<span class="ident" id="3607446">dh</span>&nbsp;<span class="ident" id="3607449">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607460">off</span>&nbsp;<span class="op" id="3607464">:=</span>&nbsp;<span class="num" id="3607467">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607470">var</span>&nbsp;<span class="ident" id="3607474">ok</span>&nbsp;<span class="builtintype" id="3607477">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607483">if</span>&nbsp;<span class="ident" id="3607486">off</span><span class="op" id="3607489">,</span>&nbsp;<span class="ident" id="3607491">ok</span>&nbsp;<span class="op" id="3607494">=</span>&nbsp;<span class="ident" id="3607496">unpackStruct</span><span class="op" id="3607508">(</span><span class="op" id="3607509">&amp;</span><span class="ident" id="3607510">dh</span><span class="op" id="3607512">,</span>&nbsp;<span class="ident" id="3607514">msg</span><span class="op" id="3607517">,</span>&nbsp;<span class="ident" id="3607519">off</span><span class="op" id="3607522">)</span><span class="op" id="3607523">;</span>&nbsp;<span class="op" id="3607525">!</span><span class="ident" id="3607526">ok</span>&nbsp;<span class="op" id="3607529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3607533">return</span>&nbsp;<span class="builtintype" id="3607540">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3607547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607550">dns</span><span class="op" id="3607553">.</span><span class="ident" id="3607554">id</span>&nbsp;<span class="op" id="3607557">=</span>&nbsp;<span class="ident" id="3607559">dh</span><span class="op" id="3607561">.</span><span class="ident" id="3607562">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607566">dns</span><span class="op" id="3607569">.</span><span class="ident" id="3607570">response</span>&nbsp;<span class="op" id="3607579">=</span>&nbsp;<span class="op" id="3607581">(</span><span class="ident" id="3607582">dh</span><span class="op" id="3607584">.</span><span class="ident" id="3607585">Bits</span>&nbsp;<span class="op" id="3607590">&amp;</span>&nbsp;<span class="ident" id="3607592">_QR</span><span class="op" id="3607595">)</span>&nbsp;<span class="op" id="3607597">!=</span>&nbsp;<span class="num" id="3607600">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607603">dns</span><span class="op" id="3607606">.</span><span class="ident" id="3607607">opcode</span>&nbsp;<span class="op" id="3607614">=</span>&nbsp;<span class="builtintype" id="3607616">int</span><span class="op" id="3607619">(</span><span class="ident" id="3607620">dh</span><span class="op" id="3607622">.</span><span class="ident" id="3607623">Bits</span><span class="op" id="3607627">&gt;&gt;</span><span class="num" id="3607629">11</span><span class="op" id="3607631">)</span>&nbsp;<span class="op" id="3607633">&amp;</span>&nbsp;<span class="num" id="3607635">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607640">dns</span><span class="op" id="3607643">.</span><span class="ident" id="3607644">authoritative</span>&nbsp;<span class="op" id="3607658">=</span>&nbsp;<span class="op" id="3607660">(</span><span class="ident" id="3607661">dh</span><span class="op" id="3607663">.</span><span class="ident" id="3607664">Bits</span>&nbsp;<span class="op" id="3607669">&amp;</span>&nbsp;<span class="ident" id="3607671">_AA</span><span class="op" id="3607674">)</span>&nbsp;<span class="op" id="3607676">!=</span>&nbsp;<span class="num" id="3607679">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607682">dns</span><span class="op" id="3607685">.</span><span class="ident" id="3607686">truncated</span>&nbsp;<span class="op" id="3607696">=</span>&nbsp;<span class="op" id="3607698">(</span><span class="ident" id="3607699">dh</span><span class="op" id="3607701">.</span><span class="ident" id="3607702">Bits</span>&nbsp;<span class="op" id="3607707">&amp;</span>&nbsp;<span class="ident" id="3607709">_TC</span><span class="op" id="3607712">)</span>&nbsp;<span class="op" id="3607714">!=</span>&nbsp;<span class="num" id="3607717">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607720">dns</span><span class="op" id="3607723">.</span><span class="ident" id="3607724">recursion_desired</span>&nbsp;<span class="op" id="3607742">=</span>&nbsp;<span class="op" id="3607744">(</span><span class="ident" id="3607745">dh</span><span class="op" id="3607747">.</span><span class="ident" id="3607748">Bits</span>&nbsp;<span class="op" id="3607753">&amp;</span>&nbsp;<span class="ident" id="3607755">_RD</span><span class="op" id="3607758">)</span>&nbsp;<span class="op" id="3607760">!=</span>&nbsp;<span class="num" id="3607763">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607766">dns</span><span class="op" id="3607769">.</span><span class="ident" id="3607770">recursion_available</span>&nbsp;<span class="op" id="3607790">=</span>&nbsp;<span class="op" id="3607792">(</span><span class="ident" id="3607793">dh</span><span class="op" id="3607795">.</span><span class="ident" id="3607796">Bits</span>&nbsp;<span class="op" id="3607801">&amp;</span>&nbsp;<span class="ident" id="3607803">_RA</span><span class="op" id="3607806">)</span>&nbsp;<span class="op" id="3607808">!=</span>&nbsp;<span class="num" id="3607811">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607814">dns</span><span class="op" id="3607817">.</span><span class="ident" id="3607818">rcode</span>&nbsp;<span class="op" id="3607824">=</span>&nbsp;<span class="builtintype" id="3607826">int</span><span class="op" id="3607829">(</span><span class="ident" id="3607830">dh</span><span class="op" id="3607832">.</span><span class="ident" id="3607833">Bits</span>&nbsp;<span class="op" id="3607838">&amp;</span>&nbsp;<span class="num" id="3607840">0xF</span><span class="op" id="3607843">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3607847">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607859">dns</span><span class="op" id="3607862">.</span><span class="ident" id="3607863">question</span>&nbsp;<span class="op" id="3607872">=</span>&nbsp;<span class="builtinfunc" id="3607874">make</span><span class="op" id="3607878">(</span><span class="op" id="3607879">[</span><span class="op" id="3607880">]</span><span class="ident" id="3607881">dnsQuestion</span><span class="op" id="3607892">,</span>&nbsp;<span class="ident" id="3607894">dh</span><span class="op" id="3607896">.</span><span class="ident" id="3607897">Qdcount</span><span class="op" id="3607904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607907">dns</span><span class="op" id="3607910">.</span><span class="ident" id="3607911">answer</span>&nbsp;<span class="op" id="3607918">=</span>&nbsp;<span class="builtinfunc" id="3607920">make</span><span class="op" id="3607924">(</span><span class="op" id="3607925">[</span><span class="op" id="3607926">]</span><span class="ident" id="3607927">dnsRR</span><span class="op" id="3607932">,</span>&nbsp;<span class="num" id="3607934">0</span><span class="op" id="3607935">,</span>&nbsp;<span class="ident" id="3607937">dh</span><span class="op" id="3607939">.</span><span class="ident" id="3607940">Ancount</span><span class="op" id="3607947">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607950">dns</span><span class="op" id="3607953">.</span><span class="ident" id="3607954">ns</span>&nbsp;<span class="op" id="3607957">=</span>&nbsp;<span class="builtinfunc" id="3607959">make</span><span class="op" id="3607963">(</span><span class="op" id="3607964">[</span><span class="op" id="3607965">]</span><span class="ident" id="3607966">dnsRR</span><span class="op" id="3607971">,</span>&nbsp;<span class="num" id="3607973">0</span><span class="op" id="3607974">,</span>&nbsp;<span class="ident" id="3607976">dh</span><span class="op" id="3607978">.</span><span class="ident" id="3607979">Nscount</span><span class="op" id="3607986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3607989">dns</span><span class="op" id="3607992">.</span><span class="ident" id="3607993">extra</span>&nbsp;<span class="op" id="3607999">=</span>&nbsp;<span class="builtinfunc" id="3608001">make</span><span class="op" id="3608005">(</span><span class="op" id="3608006">[</span><span class="op" id="3608007">]</span><span class="ident" id="3608008">dnsRR</span><span class="op" id="3608013">,</span>&nbsp;<span class="num" id="3608015">0</span><span class="op" id="3608016">,</span>&nbsp;<span class="ident" id="3608018">dh</span><span class="op" id="3608020">.</span><span class="ident" id="3608021">Arcount</span><span class="op" id="3608028">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608032">var</span>&nbsp;<span class="ident" id="3608036">rec</span>&nbsp;<span class="ident" id="3608040">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608048">for</span>&nbsp;<span class="ident" id="3608052">i</span>&nbsp;<span class="op" id="3608054">:=</span>&nbsp;<span class="num" id="3608057">0</span><span class="op" id="3608058">;</span>&nbsp;<span class="ident" id="3608060">i</span>&nbsp;<span class="op" id="3608062">&lt;</span>&nbsp;<span class="builtinfunc" id="3608064">len</span><span class="op" id="3608067">(</span><span class="ident" id="3608068">dns</span><span class="op" id="3608071">.</span><span class="ident" id="3608072">question</span><span class="op" id="3608080">)</span><span class="op" id="3608081">;</span>&nbsp;<span class="ident" id="3608083">i</span><span class="op" id="3608084">++</span>&nbsp;<span class="op" id="3608087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608091">off</span><span class="op" id="3608094">,</span>&nbsp;<span class="ident" id="3608096">ok</span>&nbsp;<span class="op" id="3608099">=</span>&nbsp;<span class="ident" id="3608101">unpackStruct</span><span class="op" id="3608113">(</span><span class="op" id="3608114">&amp;</span><span class="ident" id="3608115">dns</span><span class="op" id="3608118">.</span><span class="ident" id="3608119">question</span><span class="op" id="3608127">[</span><span class="ident" id="3608128">i</span><span class="op" id="3608129">]</span><span class="op" id="3608130">,</span>&nbsp;<span class="ident" id="3608132">msg</span><span class="op" id="3608135">,</span>&nbsp;<span class="ident" id="3608137">off</span><span class="op" id="3608140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608146">for</span>&nbsp;<span class="ident" id="3608150">i</span>&nbsp;<span class="op" id="3608152">:=</span>&nbsp;<span class="num" id="3608155">0</span><span class="op" id="3608156">;</span>&nbsp;<span class="ident" id="3608158">i</span>&nbsp;<span class="op" id="3608160">&lt;</span>&nbsp;<span class="builtintype" id="3608162">int</span><span class="op" id="3608165">(</span><span class="ident" id="3608166">dh</span><span class="op" id="3608168">.</span><span class="ident" id="3608169">Ancount</span><span class="op" id="3608176">)</span><span class="op" id="3608177">;</span>&nbsp;<span class="ident" id="3608179">i</span><span class="op" id="3608180">++</span>&nbsp;<span class="op" id="3608183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608187">rec</span><span class="op" id="3608190">,</span>&nbsp;<span class="ident" id="3608192">off</span><span class="op" id="3608195">,</span>&nbsp;<span class="ident" id="3608197">ok</span>&nbsp;<span class="op" id="3608200">=</span>&nbsp;<span class="ident" id="3608202">unpackRR</span><span class="op" id="3608210">(</span><span class="ident" id="3608211">msg</span><span class="op" id="3608214">,</span>&nbsp;<span class="ident" id="3608216">off</span><span class="op" id="3608219">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608223">if</span>&nbsp;<span class="op" id="3608226">!</span><span class="ident" id="3608227">ok</span>&nbsp;<span class="op" id="3608230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608235">return</span>&nbsp;<span class="builtintype" id="3608242">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608254">dns</span><span class="op" id="3608257">.</span><span class="ident" id="3608258">answer</span>&nbsp;<span class="op" id="3608265">=</span>&nbsp;<span class="builtinfunc" id="3608267">append</span><span class="op" id="3608273">(</span><span class="ident" id="3608274">dns</span><span class="op" id="3608277">.</span><span class="ident" id="3608278">answer</span><span class="op" id="3608284">,</span>&nbsp;<span class="ident" id="3608286">rec</span><span class="op" id="3608289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608292">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608295">for</span>&nbsp;<span class="ident" id="3608299">i</span>&nbsp;<span class="op" id="3608301">:=</span>&nbsp;<span class="num" id="3608304">0</span><span class="op" id="3608305">;</span>&nbsp;<span class="ident" id="3608307">i</span>&nbsp;<span class="op" id="3608309">&lt;</span>&nbsp;<span class="builtintype" id="3608311">int</span><span class="op" id="3608314">(</span><span class="ident" id="3608315">dh</span><span class="op" id="3608317">.</span><span class="ident" id="3608318">Nscount</span><span class="op" id="3608325">)</span><span class="op" id="3608326">;</span>&nbsp;<span class="ident" id="3608328">i</span><span class="op" id="3608329">++</span>&nbsp;<span class="op" id="3608332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608336">rec</span><span class="op" id="3608339">,</span>&nbsp;<span class="ident" id="3608341">off</span><span class="op" id="3608344">,</span>&nbsp;<span class="ident" id="3608346">ok</span>&nbsp;<span class="op" id="3608349">=</span>&nbsp;<span class="ident" id="3608351">unpackRR</span><span class="op" id="3608359">(</span><span class="ident" id="3608360">msg</span><span class="op" id="3608363">,</span>&nbsp;<span class="ident" id="3608365">off</span><span class="op" id="3608368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608372">if</span>&nbsp;<span class="op" id="3608375">!</span><span class="ident" id="3608376">ok</span>&nbsp;<span class="op" id="3608379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608384">return</span>&nbsp;<span class="builtintype" id="3608391">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608399">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608403">dns</span><span class="op" id="3608406">.</span><span class="ident" id="3608407">ns</span>&nbsp;<span class="op" id="3608410">=</span>&nbsp;<span class="builtinfunc" id="3608412">append</span><span class="op" id="3608418">(</span><span class="ident" id="3608419">dns</span><span class="op" id="3608422">.</span><span class="ident" id="3608423">ns</span><span class="op" id="3608425">,</span>&nbsp;<span class="ident" id="3608427">rec</span><span class="op" id="3608430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608436">for</span>&nbsp;<span class="ident" id="3608440">i</span>&nbsp;<span class="op" id="3608442">:=</span>&nbsp;<span class="num" id="3608445">0</span><span class="op" id="3608446">;</span>&nbsp;<span class="ident" id="3608448">i</span>&nbsp;<span class="op" id="3608450">&lt;</span>&nbsp;<span class="builtintype" id="3608452">int</span><span class="op" id="3608455">(</span><span class="ident" id="3608456">dh</span><span class="op" id="3608458">.</span><span class="ident" id="3608459">Arcount</span><span class="op" id="3608466">)</span><span class="op" id="3608467">;</span>&nbsp;<span class="ident" id="3608469">i</span><span class="op" id="3608470">++</span>&nbsp;<span class="op" id="3608473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608477">rec</span><span class="op" id="3608480">,</span>&nbsp;<span class="ident" id="3608482">off</span><span class="op" id="3608485">,</span>&nbsp;<span class="ident" id="3608487">ok</span>&nbsp;<span class="op" id="3608490">=</span>&nbsp;<span class="ident" id="3608492">unpackRR</span><span class="op" id="3608500">(</span><span class="ident" id="3608501">msg</span><span class="op" id="3608504">,</span>&nbsp;<span class="ident" id="3608506">off</span><span class="op" id="3608509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608513">if</span>&nbsp;<span class="op" id="3608516">!</span><span class="ident" id="3608517">ok</span>&nbsp;<span class="op" id="3608520">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608525">return</span>&nbsp;<span class="builtintype" id="3608532">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608544">dns</span><span class="op" id="3608547">.</span><span class="ident" id="3608548">extra</span>&nbsp;<span class="op" id="3608554">=</span>&nbsp;<span class="builtinfunc" id="3608556">append</span><span class="op" id="3608562">(</span><span class="ident" id="3608563">dns</span><span class="op" id="3608566">.</span><span class="ident" id="3608567">extra</span><span class="op" id="3608572">,</span>&nbsp;<span class="ident" id="3608574">rec</span><span class="op" id="3608577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3608583">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3608608">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3608671">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608677">return</span>&nbsp;<span class="builtintype" id="3608684">true</span><br>
<span class="lineno"></span><span class="op" id="3608689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3608692">func</span>&nbsp;<span class="op" id="3608697">(</span><span class="ident" id="3608698">dns</span>&nbsp;<span class="op" id="3608702">*</span><span class="ident" id="3608703">dnsMsg</span><span class="op" id="3608709">)</span>&nbsp;<span class="ident" id="3608711">String</span><span class="op" id="3608717">(</span><span class="op" id="3608718">)</span>&nbsp;<span class="builtintype" id="3608720">string</span>&nbsp;<span class="op" id="3608727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608730">s</span>&nbsp;<span class="op" id="3608732">:=</span>&nbsp;<span class="string" id="3608735">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="3608743">+</span>&nbsp;<span class="ident" id="3608745">printStruct</span><span class="op" id="3608756">(</span><span class="op" id="3608757">&amp;</span><span class="ident" id="3608758">dns</span><span class="op" id="3608761">.</span><span class="ident" id="3608762">dnsMsgHdr</span><span class="op" id="3608771">)</span>&nbsp;<span class="op" id="3608773">+</span>&nbsp;<span class="string" id="3608775">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608781">if</span>&nbsp;<span class="builtinfunc" id="3608784">len</span><span class="op" id="3608787">(</span><span class="ident" id="3608788">dns</span><span class="op" id="3608791">.</span><span class="ident" id="3608792">question</span><span class="op" id="3608800">)</span>&nbsp;<span class="op" id="3608802">&gt;</span>&nbsp;<span class="num" id="3608804">0</span>&nbsp;<span class="op" id="3608806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608810">s</span>&nbsp;<span class="op" id="3608812">+=</span>&nbsp;<span class="string" id="3608815">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608834">for</span>&nbsp;<span class="ident" id="3608838">i</span>&nbsp;<span class="op" id="3608840">:=</span>&nbsp;<span class="num" id="3608843">0</span><span class="op" id="3608844">;</span>&nbsp;<span class="ident" id="3608846">i</span>&nbsp;<span class="op" id="3608848">&lt;</span>&nbsp;<span class="builtinfunc" id="3608850">len</span><span class="op" id="3608853">(</span><span class="ident" id="3608854">dns</span><span class="op" id="3608857">.</span><span class="ident" id="3608858">question</span><span class="op" id="3608866">)</span><span class="op" id="3608867">;</span>&nbsp;<span class="ident" id="3608869">i</span><span class="op" id="3608870">++</span>&nbsp;<span class="op" id="3608873">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608878">s</span>&nbsp;<span class="op" id="3608880">+=</span>&nbsp;<span class="ident" id="3608883">printStruct</span><span class="op" id="3608894">(</span><span class="op" id="3608895">&amp;</span><span class="ident" id="3608896">dns</span><span class="op" id="3608899">.</span><span class="ident" id="3608900">question</span><span class="op" id="3608908">[</span><span class="ident" id="3608909">i</span><span class="op" id="3608910">]</span><span class="op" id="3608911">)</span>&nbsp;<span class="op" id="3608913">+</span>&nbsp;<span class="string" id="3608915">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608922">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3608925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608928">if</span>&nbsp;<span class="builtinfunc" id="3608931">len</span><span class="op" id="3608934">(</span><span class="ident" id="3608935">dns</span><span class="op" id="3608938">.</span><span class="ident" id="3608939">answer</span><span class="op" id="3608945">)</span>&nbsp;<span class="op" id="3608947">&gt;</span>&nbsp;<span class="num" id="3608949">0</span>&nbsp;<span class="op" id="3608951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3608955">s</span>&nbsp;<span class="op" id="3608957">+=</span>&nbsp;<span class="string" id="3608960">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3608977">for</span>&nbsp;<span class="ident" id="3608981">i</span>&nbsp;<span class="op" id="3608983">:=</span>&nbsp;<span class="num" id="3608986">0</span><span class="op" id="3608987">;</span>&nbsp;<span class="ident" id="3608989">i</span>&nbsp;<span class="op" id="3608991">&lt;</span>&nbsp;<span class="builtinfunc" id="3608993">len</span><span class="op" id="3608996">(</span><span class="ident" id="3608997">dns</span><span class="op" id="3609000">.</span><span class="ident" id="3609001">answer</span><span class="op" id="3609007">)</span><span class="op" id="3609008">;</span>&nbsp;<span class="ident" id="3609010">i</span><span class="op" id="3609011">++</span>&nbsp;<span class="op" id="3609014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609019">s</span>&nbsp;<span class="op" id="3609021">+=</span>&nbsp;<span class="ident" id="3609024">printStruct</span><span class="op" id="3609035">(</span><span class="ident" id="3609036">dns</span><span class="op" id="3609039">.</span><span class="ident" id="3609040">answer</span><span class="op" id="3609046">[</span><span class="ident" id="3609047">i</span><span class="op" id="3609048">]</span><span class="op" id="3609049">)</span>&nbsp;<span class="op" id="3609051">+</span>&nbsp;<span class="string" id="3609053">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3609066">if</span>&nbsp;<span class="builtinfunc" id="3609069">len</span><span class="op" id="3609072">(</span><span class="ident" id="3609073">dns</span><span class="op" id="3609076">.</span><span class="ident" id="3609077">ns</span><span class="op" id="3609079">)</span>&nbsp;<span class="op" id="3609081">&gt;</span>&nbsp;<span class="num" id="3609083">0</span>&nbsp;<span class="op" id="3609085">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609089">s</span>&nbsp;<span class="op" id="3609091">+=</span>&nbsp;<span class="string" id="3609094">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3609116">for</span>&nbsp;<span class="ident" id="3609120">i</span>&nbsp;<span class="op" id="3609122">:=</span>&nbsp;<span class="num" id="3609125">0</span><span class="op" id="3609126">;</span>&nbsp;<span class="ident" id="3609128">i</span>&nbsp;<span class="op" id="3609130">&lt;</span>&nbsp;<span class="builtinfunc" id="3609132">len</span><span class="op" id="3609135">(</span><span class="ident" id="3609136">dns</span><span class="op" id="3609139">.</span><span class="ident" id="3609140">ns</span><span class="op" id="3609142">)</span><span class="op" id="3609143">;</span>&nbsp;<span class="ident" id="3609145">i</span><span class="op" id="3609146">++</span>&nbsp;<span class="op" id="3609149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609154">s</span>&nbsp;<span class="op" id="3609156">+=</span>&nbsp;<span class="ident" id="3609159">printStruct</span><span class="op" id="3609170">(</span><span class="ident" id="3609171">dns</span><span class="op" id="3609174">.</span><span class="ident" id="3609175">ns</span><span class="op" id="3609177">[</span><span class="ident" id="3609178">i</span><span class="op" id="3609179">]</span><span class="op" id="3609180">)</span>&nbsp;<span class="op" id="3609182">+</span>&nbsp;<span class="string" id="3609184">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609191">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609194">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3609197">if</span>&nbsp;<span class="builtinfunc" id="3609200">len</span><span class="op" id="3609203">(</span><span class="ident" id="3609204">dns</span><span class="op" id="3609207">.</span><span class="ident" id="3609208">extra</span><span class="op" id="3609213">)</span>&nbsp;<span class="op" id="3609215">&gt;</span>&nbsp;<span class="num" id="3609217">0</span>&nbsp;<span class="op" id="3609219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609223">s</span>&nbsp;<span class="op" id="3609225">+=</span>&nbsp;<span class="string" id="3609228">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3609243">for</span>&nbsp;<span class="ident" id="3609247">i</span>&nbsp;<span class="op" id="3609249">:=</span>&nbsp;<span class="num" id="3609252">0</span><span class="op" id="3609253">;</span>&nbsp;<span class="ident" id="3609255">i</span>&nbsp;<span class="op" id="3609257">&lt;</span>&nbsp;<span class="builtinfunc" id="3609259">len</span><span class="op" id="3609262">(</span><span class="ident" id="3609263">dns</span><span class="op" id="3609266">.</span><span class="ident" id="3609267">extra</span><span class="op" id="3609272">)</span><span class="op" id="3609273">;</span>&nbsp;<span class="ident" id="3609275">i</span><span class="op" id="3609276">++</span>&nbsp;<span class="op" id="3609279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3609284">s</span>&nbsp;<span class="op" id="3609286">+=</span>&nbsp;<span class="ident" id="3609289">printStruct</span><span class="op" id="3609300">(</span><span class="ident" id="3609301">dns</span><span class="op" id="3609304">.</span><span class="ident" id="3609305">extra</span><span class="op" id="3609310">[</span><span class="ident" id="3609311">i</span><span class="op" id="3609312">]</span><span class="op" id="3609313">)</span>&nbsp;<span class="op" id="3609315">+</span>&nbsp;<span class="string" id="3609317">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609324">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3609327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3609330">return</span>&nbsp;<span class="ident" id="3609337">s</span><br>
<span class="lineno"></span><span class="op" id="3609339">}</span>
</div>
</body>
</html>
