<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>archive/zip</h2>
<ul>
<li><a href="/gostd/archive/zip/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/archive/zip/reader.go.html">reader.go</a></li>
<li><a href="/gostd/archive/zip/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/archive/zip/register.go.html">register.go</a></li>
<li><a href="/gostd/archive/zip/struct.go.html">struct.go</a></li>
<li><a href="/gostd/archive/zip/writer.go.html">writer.go</a></li>
<li><a href="/gostd/archive/zip/writer_test.go.html" class="current">writer_test.go</a></li>
<li><a href="/gostd/archive/zip/zip_test.go.html">zip_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7398328">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7398383">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7398437">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7398488">package</span>&nbsp;<span class="ident" id="7398496">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7398501">import</span>&nbsp;<span class="op" id="7398508">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398511">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398520">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398526">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398539">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398552">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7398558">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7398568">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="7398571">//&nbsp;TODO(adg):&nbsp;a&nbsp;more&nbsp;sophisticated&nbsp;test&nbsp;suite</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7398618">type</span>&nbsp;<span class="ident" id="7398623">WriteTest</span>&nbsp;<span class="keyword" id="7398633">struct</span>&nbsp;<span class="op" id="7398640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398643">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7398650">string</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398658">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7398665">[</span><span class="op" id="7398666">]</span><span class="builtintype" id="7398667">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398673">Method</span>&nbsp;<span class="builtintype" id="7398680">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398688">Mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7398695"><a href="/gostd/archive/zip/writer_test.go.html#7398552">os</a></span><span class="op" id="7398697">.</span><span class="ident" id="7398698"><a href="/gostd/os/types.go.html#2473113">FileMode</a></span><br>
<span class="lineno"></span><span class="op" id="7398707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7398710">var</span>&nbsp;<span class="ident" id="7398714">writeTests</span>&nbsp;<span class="op" id="7398725">=</span>&nbsp;<span class="op" id="7398727">[</span><span class="op" id="7398728">]</span><span class="ident" id="7398729"><a href="/gostd/archive/zip/writer_test.go.html#7398623">WriteTest</a></span><span class="op" id="7398738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398745"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7398749">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7398753">&#34;foo&#34;</span><span class="op" id="7398758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398762"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7398766">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7398770">[</span><span class="op" id="7398771">]</span><span class="builtintype" id="7398772">byte</span><span class="op" id="7398776">(</span><span class="string" id="7398777">&#34;Rabbits,&nbsp;guinea&nbsp;pigs,&nbsp;gophers,&nbsp;marsupial&nbsp;rats,&nbsp;and&nbsp;quolls.&#34;</span><span class="op" id="7398837">)</span><span class="op" id="7398838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398842"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7398848">:</span>&nbsp;<span class="ident" id="7398850"><a href="/gostd/archive/zip/struct.go.html#5668864">Store</a></span><span class="op" id="7398855">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398859"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7398863">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7398867">0666</span><span class="op" id="7398871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398874">}</span><span class="op" id="7398875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398882"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7398886">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7398890">&#34;bar&#34;</span><span class="op" id="7398895">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398899"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7398903">:</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7398907">nil</span><span class="op" id="7398910">,</span>&nbsp;<span class="comment" id="7398912">//&nbsp;large&nbsp;data&nbsp;set&nbsp;in&nbsp;the&nbsp;test</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398944"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7398950">:</span>&nbsp;<span class="ident" id="7398952"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="7398959">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398963"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7398967">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7398971">0644</span><span class="op" id="7398975">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398978">}</span><span class="op" id="7398979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7398982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7398986"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7398990">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7398994">&#34;setuid&#34;</span><span class="op" id="7399002">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399006"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7399010">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7399014">[</span><span class="op" id="7399015">]</span><span class="builtintype" id="7399016">byte</span><span class="op" id="7399020">(</span><span class="string" id="7399021">&#34;setuid&nbsp;file&#34;</span><span class="op" id="7399034">)</span><span class="op" id="7399035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399039"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7399045">:</span>&nbsp;<span class="ident" id="7399047"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="7399054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399058"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7399062">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7399066">0755</span>&nbsp;<span class="op" id="7399071">|</span>&nbsp;<span class="ident" id="7399073"><a href="/gostd/archive/zip/writer_test.go.html#7398552">os</a></span><span class="op" id="7399075">.</span><span class="ident" id="7399076"><a href="/gostd/os/types.go.html#2474149">ModeSetuid</a></span><span class="op" id="7399086">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399089">}</span><span class="op" id="7399090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399093">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399097"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7399101">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7399105">&#34;setgid&#34;</span><span class="op" id="7399113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399117"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7399121">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7399125">[</span><span class="op" id="7399126">]</span><span class="builtintype" id="7399127">byte</span><span class="op" id="7399131">(</span><span class="string" id="7399132">&#34;setgid&nbsp;file&#34;</span><span class="op" id="7399145">)</span><span class="op" id="7399146">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399150"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7399156">:</span>&nbsp;<span class="ident" id="7399158"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="7399165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399169"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7399173">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7399177">0755</span>&nbsp;<span class="op" id="7399182">|</span>&nbsp;<span class="ident" id="7399184"><a href="/gostd/archive/zip/writer_test.go.html#7398552">os</a></span><span class="op" id="7399186">.</span><span class="ident" id="7399187"><a href="/gostd/os/types.go.html#2474210">ModeSetgid</a></span><span class="op" id="7399197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399200">}</span><span class="op" id="7399201">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399208"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7399212">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7399216">&#34;symlink&#34;</span><span class="op" id="7399225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399229"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7399233">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7399237">[</span><span class="op" id="7399238">]</span><span class="builtintype" id="7399239">byte</span><span class="op" id="7399243">(</span><span class="string" id="7399244">&#34;../link/target&#34;</span><span class="op" id="7399260">)</span><span class="op" id="7399261">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399265"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7399271">:</span>&nbsp;<span class="ident" id="7399273"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="7399280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399284"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7399288">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="7399292">0755</span>&nbsp;<span class="op" id="7399297">|</span>&nbsp;<span class="ident" id="7399299"><a href="/gostd/archive/zip/writer_test.go.html#7398552">os</a></span><span class="op" id="7399301">.</span><span class="ident" id="7399302"><a href="/gostd/os/types.go.html#2473870">ModeSymlink</a></span><span class="op" id="7399313">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399316">}</span><span class="op" id="7399317">,</span><br>
<span class="lineno"></span><span class="op" id="7399319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7399322">func</span>&nbsp;<span class="ident" id="7399327">TestWriter</span><span class="op" id="7399337">(</span><span class="ident" id="7399338">t</span>&nbsp;<span class="op" id="7399340">*</span><span class="ident" id="7399341"><a href="/gostd/archive/zip/writer_test.go.html#7398558">testing</a></span><span class="op" id="7399348">.</span><span class="ident" id="7399349"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7399350">)</span>&nbsp;<span class="op" id="7399352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399355">largeData</span>&nbsp;<span class="op" id="7399365">:=</span>&nbsp;<span class="builtinfunc" id="7399368">make</span><span class="op" id="7399372">(</span><span class="op" id="7399373">[</span><span class="op" id="7399374">]</span><span class="builtintype" id="7399375">byte</span><span class="op" id="7399379">,</span>&nbsp;<span class="num" id="7399381">1</span><span class="op" id="7399382">&lt;&lt;</span><span class="num" id="7399384">17</span><span class="op" id="7399386">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399389">for</span>&nbsp;<span class="ident" id="7399393">i</span>&nbsp;<span class="op" id="7399395">:=</span>&nbsp;<span class="keyword" id="7399398">range</span>&nbsp;<span class="ident" id="7399404"><a href="/gostd/archive/zip/writer_test.go.html#7399355">largeData</a></span>&nbsp;<span class="op" id="7399414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399418"><a href="/gostd/archive/zip/writer_test.go.html#7399355">largeData</a></span><span class="op" id="7399427">[</span><span class="ident" id="7399428"><a href="/gostd/archive/zip/writer_test.go.html#7399393">i</a></span><span class="op" id="7399429">]</span>&nbsp;<span class="op" id="7399431">=</span>&nbsp;<span class="builtintype" id="7399433">byte</span><span class="op" id="7399437">(</span><span class="ident" id="7399438"><a href="/gostd/archive/zip/writer_test.go.html#7398539">rand</a></span><span class="op" id="7399442">.</span><span class="ident" id="7399443"><a href="/gostd/math/rand/rand.go.html#2926699">Int</a></span><span class="op" id="7399446">(</span><span class="op" id="7399447">)</span><span class="op" id="7399448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399451">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399454"><a href="/gostd/archive/zip/writer_test.go.html#7398714">writeTests</a></span><span class="op" id="7399464">[</span><span class="num" id="7399465">1</span><span class="op" id="7399466">]</span><span class="op" id="7399467">.</span><span class="ident" id="7399468"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span>&nbsp;<span class="op" id="7399473">=</span>&nbsp;<span class="ident" id="7399475"><a href="/gostd/archive/zip/writer_test.go.html#7399355">largeData</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399486">defer</span>&nbsp;<span class="keyword" id="7399492">func</span><span class="op" id="7399496">(</span><span class="op" id="7399497">)</span>&nbsp;<span class="op" id="7399499">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399503"><a href="/gostd/archive/zip/writer_test.go.html#7398714">writeTests</a></span><span class="op" id="7399513">[</span><span class="num" id="7399514">1</span><span class="op" id="7399515">]</span><span class="op" id="7399516">.</span><span class="ident" id="7399517"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span>&nbsp;<span class="op" id="7399522">=</span>&nbsp;<span class="builtintype" id="7399524">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399529">}</span><span class="op" id="7399530">(</span><span class="op" id="7399531">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7399535">//&nbsp;write&nbsp;a&nbsp;zip&nbsp;file</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399556">buf</span>&nbsp;<span class="op" id="7399560">:=</span>&nbsp;<span class="builtinfunc" id="7399563">new</span><span class="op" id="7399566">(</span><span class="ident" id="7399567"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7399572">.</span><span class="ident" id="7399573"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><span class="op" id="7399579">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399582">w</span>&nbsp;<span class="op" id="7399584">:=</span>&nbsp;<span class="ident" id="7399587"><a href="/gostd/archive/zip/writer.go.html#5677192">NewWriter</a></span><span class="op" id="7399596">(</span><span class="ident" id="7399597"><a href="/gostd/archive/zip/writer_test.go.html#7399556">buf</a></span><span class="op" id="7399600">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399604">for</span>&nbsp;<span class="ident" id="7399608">_</span><span class="op" id="7399609">,</span>&nbsp;<span class="ident" id="7399611">wt</span>&nbsp;<span class="op" id="7399614">:=</span>&nbsp;<span class="keyword" id="7399617">range</span>&nbsp;<span class="ident" id="7399623"><a href="/gostd/archive/zip/writer_test.go.html#7398714">writeTests</a></span>&nbsp;<span class="op" id="7399634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399638"><a href="/gostd/archive/zip/writer_test.go.html#7400289">testCreate</a></span><span class="op" id="7399648">(</span><span class="ident" id="7399649"><a href="/gostd/archive/zip/writer_test.go.html#7399338">t</a></span><span class="op" id="7399650">,</span>&nbsp;<span class="ident" id="7399652"><a href="/gostd/archive/zip/writer_test.go.html#7399582">w</a></span><span class="op" id="7399653">,</span>&nbsp;<span class="op" id="7399655">&amp;</span><span class="ident" id="7399656"><a href="/gostd/archive/zip/writer_test.go.html#7399611">wt</a></span><span class="op" id="7399658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399661">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399665">if</span>&nbsp;<span class="ident" id="7399668">err</span>&nbsp;<span class="op" id="7399672">:=</span>&nbsp;<span class="ident" id="7399675"><a href="/gostd/archive/zip/writer_test.go.html#7399582">w</a></span><span class="op" id="7399676">.</span><span class="ident" id="7399677"><a href="/gostd/archive/zip/writer.go.html#5677642">Close</a></span><span class="op" id="7399682">(</span><span class="op" id="7399683">)</span><span class="op" id="7399684">;</span>&nbsp;<span class="ident" id="7399686"><a href="/gostd/archive/zip/writer_test.go.html#7399668">err</a></span>&nbsp;<span class="op" id="7399690">!=</span>&nbsp;<span class="builtintype" id="7399693">nil</span>&nbsp;<span class="op" id="7399697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399701"><a href="/gostd/archive/zip/writer_test.go.html#7399338">t</a></span><span class="op" id="7399702">.</span><span class="ident" id="7399703"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7399708">(</span><span class="ident" id="7399709"><a href="/gostd/archive/zip/writer_test.go.html#7399668">err</a></span><span class="op" id="7399712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7399719">//&nbsp;read&nbsp;it&nbsp;back</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399736">r</span><span class="op" id="7399737">,</span>&nbsp;<span class="ident" id="7399739">err</span>&nbsp;<span class="op" id="7399743">:=</span>&nbsp;<span class="ident" id="7399746"><a href="/gostd/archive/zip/reader.go.html#5654283">NewReader</a></span><span class="op" id="7399755">(</span><span class="ident" id="7399756"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7399761">.</span><span class="ident" id="7399762"><a href="/gostd/bytes/reader.go.html#1418136">NewReader</a></span><span class="op" id="7399771">(</span><span class="ident" id="7399772"><a href="/gostd/archive/zip/writer_test.go.html#7399556">buf</a></span><span class="op" id="7399775">.</span><span class="ident" id="7399776"><a href="/gostd/bytes/buffer.go.html#1384454">Bytes</a></span><span class="op" id="7399781">(</span><span class="op" id="7399782">)</span><span class="op" id="7399783">)</span><span class="op" id="7399784">,</span>&nbsp;<span class="builtintype" id="7399786">int64</span><span class="op" id="7399791">(</span><span class="ident" id="7399792"><a href="/gostd/archive/zip/writer_test.go.html#7399556">buf</a></span><span class="op" id="7399795">.</span><span class="ident" id="7399796"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7399799">(</span><span class="op" id="7399800">)</span><span class="op" id="7399801">)</span><span class="op" id="7399802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399805">if</span>&nbsp;<span class="ident" id="7399808"><a href="/gostd/archive/zip/writer_test.go.html#7399739">err</a></span>&nbsp;<span class="op" id="7399812">!=</span>&nbsp;<span class="builtintype" id="7399815">nil</span>&nbsp;<span class="op" id="7399819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399823"><a href="/gostd/archive/zip/writer_test.go.html#7399338">t</a></span><span class="op" id="7399824">.</span><span class="ident" id="7399825"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7399830">(</span><span class="ident" id="7399831"><a href="/gostd/archive/zip/writer_test.go.html#7399739">err</a></span><span class="op" id="7399834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399837">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399840">for</span>&nbsp;<span class="ident" id="7399844">i</span><span class="op" id="7399845">,</span>&nbsp;<span class="ident" id="7399847">wt</span>&nbsp;<span class="op" id="7399850">:=</span>&nbsp;<span class="keyword" id="7399853">range</span>&nbsp;<span class="ident" id="7399859"><a href="/gostd/archive/zip/writer_test.go.html#7398714">writeTests</a></span>&nbsp;<span class="op" id="7399870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399874"><a href="/gostd/archive/zip/writer_test.go.html#7400596">testReadFile</a></span><span class="op" id="7399886">(</span><span class="ident" id="7399887"><a href="/gostd/archive/zip/writer_test.go.html#7399338">t</a></span><span class="op" id="7399888">,</span>&nbsp;<span class="ident" id="7399890"><a href="/gostd/archive/zip/writer_test.go.html#7399736">r</a></span><span class="op" id="7399891">.</span><span class="ident" id="7399892"><a href="/gostd/archive/zip/reader.go.html#5653528">File</a></span><span class="op" id="7399896">[</span><span class="ident" id="7399897"><a href="/gostd/archive/zip/writer_test.go.html#7399844">i</a></span><span class="op" id="7399898">]</span><span class="op" id="7399899">,</span>&nbsp;<span class="op" id="7399901">&amp;</span><span class="ident" id="7399902"><a href="/gostd/archive/zip/writer_test.go.html#7399847">wt</a></span><span class="op" id="7399904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7399907">}</span><br>
<span class="lineno"></span><span class="op" id="7399909">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="7399912">func</span>&nbsp;<span class="ident" id="7399917">TestWriterFlush</span><span class="op" id="7399932">(</span><span class="ident" id="7399933">t</span>&nbsp;<span class="op" id="7399935">*</span><span class="ident" id="7399936"><a href="/gostd/archive/zip/writer_test.go.html#7398558">testing</a></span><span class="op" id="7399943">.</span><span class="ident" id="7399944"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7399945">)</span>&nbsp;<span class="op" id="7399947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7399950">var</span>&nbsp;<span class="ident" id="7399954">buf</span>&nbsp;<span class="ident" id="7399958"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7399963">.</span><span class="ident" id="7399964"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7399972">w</span>&nbsp;<span class="op" id="7399974">:=</span>&nbsp;<span class="ident" id="7399977"><a href="/gostd/archive/zip/writer.go.html#5677192">NewWriter</a></span><span class="op" id="7399986">(</span><span class="keyword" id="7399987">struct</span><span class="op" id="7399993">{</span>&nbsp;<span class="ident" id="7399995"><a href="/gostd/archive/zip/writer_test.go.html#7398520">io</a></span><span class="op" id="7399997">.</span><span class="ident" id="7399998"><a href="/gostd/io/io.go.html#1422314">Writer</a></span>&nbsp;<span class="op" id="7400005">}</span><span class="op" id="7400006">{</span><span class="op" id="7400007">&amp;</span><span class="ident" id="7400008"><a href="/gostd/archive/zip/writer_test.go.html#7399954">buf</a></span><span class="op" id="7400011">}</span><span class="op" id="7400012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400015">_</span><span class="op" id="7400016">,</span>&nbsp;<span class="ident" id="7400018">err</span>&nbsp;<span class="op" id="7400022">:=</span>&nbsp;<span class="ident" id="7400025"><a href="/gostd/archive/zip/writer_test.go.html#7399972">w</a></span><span class="op" id="7400026">.</span><span class="ident" id="7400027"><a href="/gostd/archive/zip/writer.go.html#5681934">Create</a></span><span class="op" id="7400033">(</span><span class="string" id="7400034">&#34;foo&#34;</span><span class="op" id="7400039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400042">if</span>&nbsp;<span class="ident" id="7400045"><a href="/gostd/archive/zip/writer_test.go.html#7400018">err</a></span>&nbsp;<span class="op" id="7400049">!=</span>&nbsp;<span class="builtintype" id="7400052">nil</span>&nbsp;<span class="op" id="7400056">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400060"><a href="/gostd/archive/zip/writer_test.go.html#7399933">t</a></span><span class="op" id="7400061">.</span><span class="ident" id="7400062"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400067">(</span><span class="ident" id="7400068"><a href="/gostd/archive/zip/writer_test.go.html#7400018">err</a></span><span class="op" id="7400071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400077">if</span>&nbsp;<span class="ident" id="7400080"><a href="/gostd/archive/zip/writer_test.go.html#7399954">buf</a></span><span class="op" id="7400083">.</span><span class="ident" id="7400084"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7400087">(</span><span class="op" id="7400088">)</span>&nbsp;<span class="op" id="7400090">&gt;</span>&nbsp;<span class="num" id="7400092">0</span>&nbsp;<span class="op" id="7400094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400098"><a href="/gostd/archive/zip/writer_test.go.html#7399933">t</a></span><span class="op" id="7400099">.</span><span class="ident" id="7400100"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7400106">(</span><span class="string" id="7400107">&#34;Unexpected&nbsp;%d&nbsp;bytes&nbsp;already&nbsp;in&nbsp;buffer&#34;</span><span class="op" id="7400146">,</span>&nbsp;<span class="ident" id="7400148"><a href="/gostd/archive/zip/writer_test.go.html#7399954">buf</a></span><span class="op" id="7400151">.</span><span class="ident" id="7400152"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7400155">(</span><span class="op" id="7400156">)</span><span class="op" id="7400157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400160">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400163">if</span>&nbsp;<span class="ident" id="7400166">err</span>&nbsp;<span class="op" id="7400170">:=</span>&nbsp;<span class="ident" id="7400173"><a href="/gostd/archive/zip/writer_test.go.html#7399972">w</a></span><span class="op" id="7400174">.</span><span class="ident" id="7400175"><a href="/gostd/archive/zip/writer.go.html#5677436">Flush</a></span><span class="op" id="7400180">(</span><span class="op" id="7400181">)</span><span class="op" id="7400182">;</span>&nbsp;<span class="ident" id="7400184"><a href="/gostd/archive/zip/writer_test.go.html#7400166">err</a></span>&nbsp;<span class="op" id="7400188">!=</span>&nbsp;<span class="builtintype" id="7400191">nil</span>&nbsp;<span class="op" id="7400195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400199"><a href="/gostd/archive/zip/writer_test.go.html#7399933">t</a></span><span class="op" id="7400200">.</span><span class="ident" id="7400201"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400206">(</span><span class="ident" id="7400207"><a href="/gostd/archive/zip/writer_test.go.html#7400166">err</a></span><span class="op" id="7400210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400216">if</span>&nbsp;<span class="ident" id="7400219"><a href="/gostd/archive/zip/writer_test.go.html#7399954">buf</a></span><span class="op" id="7400222">.</span><span class="ident" id="7400223"><a href="/gostd/bytes/buffer.go.html#1384893">Len</a></span><span class="op" id="7400226">(</span><span class="op" id="7400227">)</span>&nbsp;<span class="op" id="7400229">==</span>&nbsp;<span class="num" id="7400232">0</span>&nbsp;<span class="op" id="7400234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400238"><a href="/gostd/archive/zip/writer_test.go.html#7399933">t</a></span><span class="op" id="7400239">.</span><span class="ident" id="7400240"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400245">(</span><span class="string" id="7400246">&#34;No&nbsp;bytes&nbsp;written&nbsp;after&nbsp;Flush&#34;</span><span class="op" id="7400276">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400279">}</span><br>
<span class="lineno"></span><span class="op" id="7400281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7400284">func</span>&nbsp;<span class="ident" id="7400289">testCreate</span><span class="op" id="7400299">(</span><span class="ident" id="7400300">t</span>&nbsp;<span class="op" id="7400302">*</span><span class="ident" id="7400303"><a href="/gostd/archive/zip/writer_test.go.html#7398558">testing</a></span><span class="op" id="7400310">.</span><span class="ident" id="7400311"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7400312">,</span>&nbsp;<span class="ident" id="7400314">w</span>&nbsp;<span class="op" id="7400316">*</span><span class="ident" id="7400317"><a href="/gostd/archive/zip/writer.go.html#5676985">Writer</a></span><span class="op" id="7400323">,</span>&nbsp;<span class="ident" id="7400325">wt</span>&nbsp;<span class="op" id="7400328">*</span><span class="ident" id="7400329"><a href="/gostd/archive/zip/writer_test.go.html#7398623">WriteTest</a></span><span class="op" id="7400338">)</span>&nbsp;<span class="op" id="7400340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400343">header</span>&nbsp;<span class="op" id="7400350">:=</span>&nbsp;<span class="op" id="7400353">&amp;</span><span class="ident" id="7400354"><a href="/gostd/archive/zip/struct.go.html#5670169">FileHeader</a></span><span class="op" id="7400364">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400368"><a href="/gostd/archive/zip/struct.go.html#5670368">Name</a></span><span class="op" id="7400372">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7400376"><a href="/gostd/archive/zip/writer_test.go.html#7400325">wt</a></span><span class="op" id="7400378">.</span><span class="ident" id="7400379"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7400383">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400387"><a href="/gostd/archive/zip/struct.go.html#5670463">Method</a></span><span class="op" id="7400393">:</span>&nbsp;<span class="ident" id="7400395"><a href="/gostd/archive/zip/writer_test.go.html#7400325">wt</a></span><span class="op" id="7400397">.</span><span class="ident" id="7400398"><a href="/gostd/archive/zip/writer_test.go.html#7398673">Method</a></span><span class="op" id="7400404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400410">if</span>&nbsp;<span class="ident" id="7400413"><a href="/gostd/archive/zip/writer_test.go.html#7400325">wt</a></span><span class="op" id="7400415">.</span><span class="ident" id="7400416"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span>&nbsp;<span class="op" id="7400421">!=</span>&nbsp;<span class="num" id="7400424">0</span>&nbsp;<span class="op" id="7400426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400430"><a href="/gostd/archive/zip/writer_test.go.html#7400343">header</a></span><span class="op" id="7400436">.</span><span class="ident" id="7400437"><a href="/gostd/archive/zip/struct.go.html#5674812">SetMode</a></span><span class="op" id="7400444">(</span><span class="ident" id="7400445"><a href="/gostd/archive/zip/writer_test.go.html#7400325">wt</a></span><span class="op" id="7400447">.</span><span class="ident" id="7400448"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7400452">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400455">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400458">f</span><span class="op" id="7400459">,</span>&nbsp;<span class="ident" id="7400461">err</span>&nbsp;<span class="op" id="7400465">:=</span>&nbsp;<span class="ident" id="7400468"><a href="/gostd/archive/zip/writer_test.go.html#7400314">w</a></span><span class="op" id="7400469">.</span><span class="ident" id="7400470"><a href="/gostd/archive/zip/writer.go.html#5682372">CreateHeader</a></span><span class="op" id="7400482">(</span><span class="ident" id="7400483"><a href="/gostd/archive/zip/writer_test.go.html#7400343">header</a></span><span class="op" id="7400489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400492">if</span>&nbsp;<span class="ident" id="7400495"><a href="/gostd/archive/zip/writer_test.go.html#7400461">err</a></span>&nbsp;<span class="op" id="7400499">!=</span>&nbsp;<span class="builtintype" id="7400502">nil</span>&nbsp;<span class="op" id="7400506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400510"><a href="/gostd/archive/zip/writer_test.go.html#7400300">t</a></span><span class="op" id="7400511">.</span><span class="ident" id="7400512"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400517">(</span><span class="ident" id="7400518"><a href="/gostd/archive/zip/writer_test.go.html#7400461">err</a></span><span class="op" id="7400521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400524">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400527">_</span><span class="op" id="7400528">,</span>&nbsp;<span class="ident" id="7400530"><a href="/gostd/archive/zip/writer_test.go.html#7400461">err</a></span>&nbsp;<span class="op" id="7400534">=</span>&nbsp;<span class="ident" id="7400536"><a href="/gostd/archive/zip/writer_test.go.html#7400458">f</a></span><span class="op" id="7400537">.</span><span class="ident" id="7400538"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7400543">(</span><span class="ident" id="7400544"><a href="/gostd/archive/zip/writer_test.go.html#7400325">wt</a></span><span class="op" id="7400546">.</span><span class="ident" id="7400547"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7400551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400554">if</span>&nbsp;<span class="ident" id="7400557"><a href="/gostd/archive/zip/writer_test.go.html#7400461">err</a></span>&nbsp;<span class="op" id="7400561">!=</span>&nbsp;<span class="builtintype" id="7400564">nil</span>&nbsp;<span class="op" id="7400568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400572"><a href="/gostd/archive/zip/writer_test.go.html#7400300">t</a></span><span class="op" id="7400573">.</span><span class="ident" id="7400574"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400579">(</span><span class="ident" id="7400580"><a href="/gostd/archive/zip/writer_test.go.html#7400461">err</a></span><span class="op" id="7400583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400586">}</span><br>
<span class="lineno"></span><span class="op" id="7400588">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7400591">func</span>&nbsp;<span class="ident" id="7400596">testReadFile</span><span class="op" id="7400608">(</span><span class="ident" id="7400609">t</span>&nbsp;<span class="op" id="7400611">*</span><span class="ident" id="7400612"><a href="/gostd/archive/zip/writer_test.go.html#7398558">testing</a></span><span class="op" id="7400619">.</span><span class="ident" id="7400620"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7400621">,</span>&nbsp;<span class="ident" id="7400623">f</span>&nbsp;<span class="op" id="7400625">*</span><span class="ident" id="7400626"><a href="/gostd/archive/zip/reader.go.html#5653616">File</a></span><span class="op" id="7400630">,</span>&nbsp;<span class="ident" id="7400632">wt</span>&nbsp;<span class="op" id="7400635">*</span><span class="ident" id="7400636"><a href="/gostd/archive/zip/writer_test.go.html#7398623">WriteTest</a></span><span class="op" id="7400645">)</span>&nbsp;<span class="op" id="7400647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400650">if</span>&nbsp;<span class="ident" id="7400653"><a href="/gostd/archive/zip/writer_test.go.html#7400623">f</a></span><span class="op" id="7400654">.</span><span class="ident" id="7400655"><a href="/gostd/archive/zip/struct.go.html#5670368">Name</a></span>&nbsp;<span class="op" id="7400660">!=</span>&nbsp;<span class="ident" id="7400663"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7400665">.</span><span class="ident" id="7400666"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span>&nbsp;<span class="op" id="7400671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400675"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7400676">.</span><span class="ident" id="7400677"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7400683">(</span><span class="string" id="7400684">&#34;File&nbsp;name:&nbsp;got&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7400712">,</span>&nbsp;<span class="ident" id="7400714"><a href="/gostd/archive/zip/writer_test.go.html#7400623">f</a></span><span class="op" id="7400715">.</span><span class="ident" id="7400716"><a href="/gostd/archive/zip/struct.go.html#5670368">Name</a></span><span class="op" id="7400720">,</span>&nbsp;<span class="ident" id="7400722"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7400724">.</span><span class="ident" id="7400725"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7400729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400732">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400735"><a href="/gostd/archive/zip/reader_test.go.html#7392493">testFileMode</a></span><span class="op" id="7400747">(</span><span class="ident" id="7400748"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7400749">,</span>&nbsp;<span class="ident" id="7400751"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7400753">.</span><span class="ident" id="7400754"><a href="/gostd/archive/zip/writer_test.go.html#7398643">Name</a></span><span class="op" id="7400758">,</span>&nbsp;<span class="ident" id="7400760"><a href="/gostd/archive/zip/writer_test.go.html#7400623">f</a></span><span class="op" id="7400761">,</span>&nbsp;<span class="ident" id="7400763"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7400765">.</span><span class="ident" id="7400766"><a href="/gostd/archive/zip/writer_test.go.html#7398688">Mode</a></span><span class="op" id="7400770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400773">rc</span><span class="op" id="7400775">,</span>&nbsp;<span class="ident" id="7400777">err</span>&nbsp;<span class="op" id="7400781">:=</span>&nbsp;<span class="ident" id="7400784"><a href="/gostd/archive/zip/writer_test.go.html#7400623">f</a></span><span class="op" id="7400785">.</span><span class="ident" id="7400786"><a href="/gostd/archive/zip/reader.go.html#5656135">Open</a></span><span class="op" id="7400790">(</span><span class="op" id="7400791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400794">if</span>&nbsp;<span class="ident" id="7400797"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span>&nbsp;<span class="op" id="7400801">!=</span>&nbsp;<span class="builtintype" id="7400804">nil</span>&nbsp;<span class="op" id="7400808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400812"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7400813">.</span><span class="ident" id="7400814"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400819">(</span><span class="string" id="7400820">&#34;opening:&#34;</span><span class="op" id="7400830">,</span>&nbsp;<span class="ident" id="7400832"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span><span class="op" id="7400835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400838">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400841">b</span><span class="op" id="7400842">,</span>&nbsp;<span class="ident" id="7400844"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span>&nbsp;<span class="op" id="7400848">:=</span>&nbsp;<span class="ident" id="7400851"><a href="/gostd/archive/zip/writer_test.go.html#7398526">ioutil</a></span><span class="op" id="7400857">.</span><span class="ident" id="7400858"><a href="/gostd/io/ioutil/ioutil.go.html#3765117">ReadAll</a></span><span class="op" id="7400865">(</span><span class="ident" id="7400866"><a href="/gostd/archive/zip/writer_test.go.html#7400773">rc</a></span><span class="op" id="7400868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400871">if</span>&nbsp;<span class="ident" id="7400874"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span>&nbsp;<span class="op" id="7400878">!=</span>&nbsp;<span class="builtintype" id="7400881">nil</span>&nbsp;<span class="op" id="7400885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400889"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7400890">.</span><span class="ident" id="7400891"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400896">(</span><span class="string" id="7400897">&#34;reading:&#34;</span><span class="op" id="7400907">,</span>&nbsp;<span class="ident" id="7400909"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span><span class="op" id="7400912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400918"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span>&nbsp;<span class="op" id="7400922">=</span>&nbsp;<span class="ident" id="7400924"><a href="/gostd/archive/zip/writer_test.go.html#7400773">rc</a></span><span class="op" id="7400926">.</span><span class="ident" id="7400927"><a href="/gostd/io/io.go.html#1422583">Close</a></span><span class="op" id="7400932">(</span><span class="op" id="7400933">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400936">if</span>&nbsp;<span class="ident" id="7400939"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span>&nbsp;<span class="op" id="7400943">!=</span>&nbsp;<span class="builtintype" id="7400946">nil</span>&nbsp;<span class="op" id="7400950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7400954"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7400955">.</span><span class="ident" id="7400956"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7400961">(</span><span class="string" id="7400962">&#34;closing:&#34;</span><span class="op" id="7400972">,</span>&nbsp;<span class="ident" id="7400974"><a href="/gostd/archive/zip/writer_test.go.html#7400777">err</a></span><span class="op" id="7400977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7400980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7400983">if</span>&nbsp;<span class="op" id="7400986">!</span><span class="ident" id="7400987"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7400992">.</span><span class="ident" id="7400993"><a href="/gostd/bytes/bytes_decl.go.html#1414806">Equal</a></span><span class="op" id="7400998">(</span><span class="ident" id="7400999"><a href="/gostd/archive/zip/writer_test.go.html#7400841">b</a></span><span class="op" id="7401000">,</span>&nbsp;<span class="ident" id="7401002"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7401004">.</span><span class="ident" id="7401005"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7401009">)</span>&nbsp;<span class="op" id="7401011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401015"><a href="/gostd/archive/zip/writer_test.go.html#7400609">t</a></span><span class="op" id="7401016">.</span><span class="ident" id="7401017"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7401023">(</span><span class="string" id="7401024">&#34;File&nbsp;contents&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7401051">,</span>&nbsp;<span class="ident" id="7401053"><a href="/gostd/archive/zip/writer_test.go.html#7400841">b</a></span><span class="op" id="7401054">,</span>&nbsp;<span class="ident" id="7401056"><a href="/gostd/archive/zip/writer_test.go.html#7400632">wt</a></span><span class="op" id="7401058">.</span><span class="ident" id="7401059"><a href="/gostd/archive/zip/writer_test.go.html#7398658">Data</a></span><span class="op" id="7401063">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401066">}</span><br>
<span class="lineno"></span><span class="op" id="7401068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7401071">func</span>&nbsp;<span class="ident" id="7401076">BenchmarkCompressedZipGarbage</span><span class="op" id="7401105">(</span><span class="ident" id="7401106">b</span>&nbsp;<span class="op" id="7401108">*</span><span class="ident" id="7401109"><a href="/gostd/archive/zip/writer_test.go.html#7398558">testing</a></span><span class="op" id="7401116">.</span><span class="ident" id="7401117"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7401118">)</span>&nbsp;<span class="op" id="7401120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401123"><a href="/gostd/archive/zip/writer_test.go.html#7401106">b</a></span><span class="op" id="7401124">.</span><span class="ident" id="7401125"><a href="/gostd/testing/benchmark.go.html#5453061">ReportAllocs</a></span><span class="op" id="7401137">(</span><span class="op" id="7401138">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401141">var</span>&nbsp;<span class="ident" id="7401145">buf</span>&nbsp;<span class="ident" id="7401149"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7401154">.</span><span class="ident" id="7401155"><a href="/gostd/bytes/buffer.go.html#1383251">Buffer</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401163">bigBuf</span>&nbsp;<span class="op" id="7401170">:=</span>&nbsp;<span class="ident" id="7401173"><a href="/gostd/archive/zip/writer_test.go.html#7398511">bytes</a></span><span class="op" id="7401178">.</span><span class="ident" id="7401179"><a href="/gostd/bytes/bytes.go.html#1405494">Repeat</a></span><span class="op" id="7401185">(</span><span class="op" id="7401186">[</span><span class="op" id="7401187">]</span><span class="builtintype" id="7401188">byte</span><span class="op" id="7401192">(</span><span class="string" id="7401193">&#34;a&#34;</span><span class="op" id="7401196">)</span><span class="op" id="7401197">,</span>&nbsp;<span class="num" id="7401199">1</span><span class="op" id="7401200">&lt;&lt;</span><span class="num" id="7401202">20</span><span class="op" id="7401204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401207">for</span>&nbsp;<span class="ident" id="7401211">i</span>&nbsp;<span class="op" id="7401213">:=</span>&nbsp;<span class="num" id="7401216">0</span><span class="op" id="7401217">;</span>&nbsp;<span class="ident" id="7401219"><a href="/gostd/archive/zip/writer_test.go.html#7401211">i</a></span>&nbsp;<span class="op" id="7401221">&lt;</span>&nbsp;<span class="ident" id="7401223"><a href="/gostd/archive/zip/writer_test.go.html#7401106">b</a></span><span class="op" id="7401224">.</span><span class="ident" id="7401225"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="7401226">;</span>&nbsp;<span class="ident" id="7401228"><a href="/gostd/archive/zip/writer_test.go.html#7401211">i</a></span><span class="op" id="7401229">++</span>&nbsp;<span class="op" id="7401232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401236"><a href="/gostd/archive/zip/writer_test.go.html#7401145">buf</a></span><span class="op" id="7401239">.</span><span class="ident" id="7401240"><a href="/gostd/bytes/buffer.go.html#1385417">Reset</a></span><span class="op" id="7401245">(</span><span class="op" id="7401246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401250">zw</span>&nbsp;<span class="op" id="7401253">:=</span>&nbsp;<span class="ident" id="7401256"><a href="/gostd/archive/zip/writer.go.html#5677192">NewWriter</a></span><span class="op" id="7401265">(</span><span class="op" id="7401266">&amp;</span><span class="ident" id="7401267"><a href="/gostd/archive/zip/writer_test.go.html#7401145">buf</a></span><span class="op" id="7401270">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7401274">for</span>&nbsp;<span class="ident" id="7401278">j</span>&nbsp;<span class="op" id="7401280">:=</span>&nbsp;<span class="num" id="7401283">0</span><span class="op" id="7401284">;</span>&nbsp;<span class="ident" id="7401286"><a href="/gostd/archive/zip/writer_test.go.html#7401278">j</a></span>&nbsp;<span class="op" id="7401288">&lt;</span>&nbsp;<span class="num" id="7401290">3</span><span class="op" id="7401291">;</span>&nbsp;<span class="ident" id="7401293"><a href="/gostd/archive/zip/writer_test.go.html#7401278">j</a></span><span class="op" id="7401294">++</span>&nbsp;<span class="op" id="7401297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401302">w</span><span class="op" id="7401303">,</span>&nbsp;<span class="ident" id="7401305">_</span>&nbsp;<span class="op" id="7401307">:=</span>&nbsp;<span class="ident" id="7401310"><a href="/gostd/archive/zip/writer_test.go.html#7401250">zw</a></span><span class="op" id="7401312">.</span><span class="ident" id="7401313"><a href="/gostd/archive/zip/writer.go.html#5682372">CreateHeader</a></span><span class="op" id="7401325">(</span><span class="op" id="7401326">&amp;</span><span class="ident" id="7401327"><a href="/gostd/archive/zip/struct.go.html#5670169">FileHeader</a></span><span class="op" id="7401337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401343"><a href="/gostd/archive/zip/struct.go.html#5670368">Name</a></span><span class="op" id="7401347">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7401351">&#34;foo&#34;</span><span class="op" id="7401356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401362"><a href="/gostd/archive/zip/struct.go.html#5670463">Method</a></span><span class="op" id="7401368">:</span>&nbsp;<span class="ident" id="7401370"><a href="/gostd/archive/zip/struct.go.html#5668884">Deflate</a></span><span class="op" id="7401377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401382">}</span><span class="op" id="7401383">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401388"><a href="/gostd/archive/zip/writer_test.go.html#7401302">w</a></span><span class="op" id="7401389">.</span><span class="ident" id="7401390"><a href="/gostd/io/io.go.html#1422334">Write</a></span><span class="op" id="7401395">(</span><span class="ident" id="7401396"><a href="/gostd/archive/zip/writer_test.go.html#7401163">bigBuf</a></span><span class="op" id="7401402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7401410"><a href="/gostd/archive/zip/writer_test.go.html#7401250">zw</a></span><span class="op" id="7401412">.</span><span class="ident" id="7401413"><a href="/gostd/archive/zip/writer.go.html#5677642">Close</a></span><span class="op" id="7401418">(</span><span class="op" id="7401419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7401422">}</span><br>
<span class="lineno"></span><span class="op" id="7401424">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
